                              NBER WORKING PAPER SERIES




              OPTIMAL SPATIAL POLICIES, GEOGRAPHY AND SORTING

                                       Pablo Fajgelbaum
                                        Cecile Gaubert

                                      Working Paper 24632
                              http://www.nber.org/papers/w24632


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                           May 2018, Revised November 2019




We thank the editor, Pol Antràs, and 5 anonymous referees. We thank Arnaud Costinot, Rebecca
Diamond, Jonathan Dingel, Robert Staiger, Costas Arkolakis, and Adrien Bilal for their
conference discussions. We also thank David Atkin, Lorenzo Caliendo, Stephen Redding, and
Frederic Robert-Nicoud for helpful comments. We thank Sam Leone and Wan Zhang for
excellent research assistance. Cecile Gaubert thanks the Clausen Center for International
Business and Policy and the Fisher Center for Real Estate and Urban Economics at UC Berkeley
for financial support. The views expressed herein are those of the authors and do not necessarily
reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2018 by Pablo Fajgelbaum and Cecile Gaubert. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Optimal Spatial Policies, Geography and Sorting
Pablo Fajgelbaum and Cecile Gaubert
NBER Working Paper No. 24632
May 2018, Revised November 2019
JEL No. F12,H21,H71,R13

                                           ABSTRACT

We study optimal spatial policies in a quantitative trade and geography framework with spillovers
and spatial sorting of heterogeneous workers. We characterize the spatial transfers that must hold
in efficient allocations, as well as labor subsidies that can implement them. There exists scope for
welfare-enhancing spatial policies even when spillovers are common across locations. Using data
on U.S. cities and existing estimates of the spillover elasticities, we find that the U.S. economy
would benefit from a reallocation of workers to currently low-wage cities. The optimal allocation
features a greater share of high skill workers in smaller cities relative to the observed allocation.
Inefficient sorting may lead to substantial welfare costs.


Pablo Fajgelbaum
Department of Economics
University of California, Los Angeles
Bunche Hall 8283
315 Portola Plaza
Los Angeles, CA 90095
and NBER
pfajgelbaum@gmail.com

Cecile Gaubert
Department of Economics
University of California, Berkeley
687 Evans Hall
Berkeley, CA 94720
and NBER
cecile.gaubert@berkeley.edu
1       Introduction
    A long tradition in economics argues that the concentration of economic activity leads to
spillovers. For instance, dense cities are more productive thanks to agglomeration economies,
but are also more congested. These spillovers shape the distribution of city size and productivity.
Groups of workers with different skills arguably vary in how much they contribute to these spillovers
and in how much they are impacted by them, so that these forces also shape how heterogeneous
workers sort across cities. Being external in nature, spillovers likely lead to inefficient spatial out-
comes. In this paper, we ask: is the observed spatial distribution of economic activity inefficient?
If so, what policies would restore efficiency and what would be their welfare impact? Would an
optimal spatial distribution feature stronger, or weaker, spatial disparities and sorting by skill than
what is observed?
    To answer these questions, we develop and implement a new approach. Our framework nests
two recent strands of general-equilibrium spatial research with spillovers: location choice models in
the tradition of Rosen (1979)-Roback (1982) with sorting of heterogeneous workers as in Diamond
(2016), and economic geography models in the tradition of Helpman (1998) applied to quantitative
setups as in Allen and Arkolakis (2014) and Redding (2016). Crucially, we generalize these models
to allow for arbitrary transfers across agents and regions. We characterize the set of transfers needed
to attain first-best allocations, alongside the labor income subsidies that would implement them.
We then combine the framework with data across metropolitan statistical areas (MSAs) in the
United States, and evaluate quantitatively the impact of implementing optimal spatial policies on
sorting by skill, wage inequality, and welfare. Under existing estimates of the spillover elasticities,
the results suggest that inefficient sorting may lead to substantial welfare costs, and that spatial
efficiency calls for more redistribution to low-wage cities and a greater share of high skill workers
in these locations.
    The framework incorporates many key determinants of the spatial distribution of economic
activity. Firms produce differentiated tradeable commodities and non-tradeables using labor, in-
termediate inputs, and land. Locations may differ in fundamental components of productivity and
amenities, bilateral trade frictions, and housing supply elasticities. Productivity and amenities are
endogenous through agglomeration and congestion spillovers that may depend on the composition
of the workforce.1 Different types of workers may vary in how productive they are in each loca-
tion, in their ownership of fixed factors such as land, in their preference for each location, and
in the efficiency and amenity spillovers they generate on other workers. In the market allocation,
government policies may redistribute income across agents and regions.2
    1
       As summarized by Duranton and Puga (2004), efficiency spillovers may result from several forces such as knowl-
edge externalities, labor market pooling, or scale economies in the production of tradeable commodities. A key
assumption of our analysis is that these effects are not internalized by the firms making hiring decisions. Amenity
spillovers may result from congestion through traffic or environmental factors such as noise or pollution; availabil-
ity of public services such as education, health, and public transport; availability of public amenities such as parks
and recreation; or specialization thanks to scale effects in the provision of urban amenities such as restaurants or
entertainment.
     2
       A wide range of government policies lead to spatial transfers. Some of these are explicit “place-based policies”,


                                                           1
    In the model, the spillovers have complex general-equilibrium ramifications through factor mo-
bility and trade linkages. However, in the spirit of the “principle of targeting” pointed out by Dixit
(1985), the first-best allocation can be implemented by policies acting only upon inefficient margins.
Here, these margins consist of labor supply and demand decisions: workers do not internalize the
impact of their location choice on city-level amenities, and firms do not internalize the impact of
their hiring decisions on city-level productivity. We derive a necessary efficiency condition on the
joint distribution of expenditures, wages and employment across worker types and regions. Using
this condition we then characterize the transfers that must hold in an efficient allocation. Further-
more, we identify a condition on the distributions of spillover and housing supply elasticities under
which these optimal transfers are also sufficient to implement the efficient allocation.
    This characterization generalizes the standard efficiency requirement from non-spatial envi-
ronments such as Hsieh and Klenow (2009), whereby the marginal product of labor should be
equalized across productive units. Here, the optimal spatial allocation balances the net benefit of
spillovers (in production or amenities) against the opportunity cost of attracting workers to each
location. Because the location and consumption decisions are not separable, these opportunity
costs are measured in terms of local consumption expenditures, and they vary across locations due
to the compensating differentials born of geographic forces (congestion in housing, amenities, trade
costs, and non-traded goods). Therefore, determining whether an observed allocation is efficient
and whether specific cities are too large requires information about expenditure per capita across
locations, in addition to the standard requirement of observing wages and employment.
    We characterize the policies that lead to optimal transfers in special cases. We first apply the
results to a case where the elasticities of spillovers (in both amenities and productivity) are constant
with respect to population and identical across cities. Studies of place-based policies such as Glaeser
and Gottlieb (2008) and Kline and Moretti (2014a) suggest that, in this environment, there are no
gains from implementing policies that reallocate workers.3 We show that this prevailing view relies
on assuming away policies that redistribute income across space. When transfers are allowed, the
laissez-faire allocation without transfers is inefficient even under constant-elasticity spillovers that
are identical across locations, as long as there are compensating differentials across regions (such
as differences in amenities). Intuitively, starting from an equilibrium without transfers, differences
in marginal utility of consumption lead to gains from transferring tradeable goods. These transfers
in turn incentivize workers to move, leading to gains from reallocation. Under these assumptions,
we derive the labor income subsidies that restore efficiency.

such as tax relief schemes targeted at distressed areas (e.g. New Markets Tax Credit, or Enterprise Zones) or direct
public investment in specific areas (e.g. Tennessee Valley Authority). Other policies are not explicitly spatial, but end
up redistributing income to specific places (e.g., nominal income taxes and credits, state and local tax deductions, or
sectoral subsidies). Neumark et al. (2015) review the recent empirical literature on place-based policies and conclude
that the evidence on their success at creating local jobs in the U.S. is mixed depending on the specific policy and
area being treated. While some local enterprise programs have been found to be unsuccessful at attracting local jobs,
larger programs such as federal empowerment zones in high-poverty rate areas of the U.S. or the Tennessee Valley
Authority have been found to have positive effects (Busso et al., 2013; Kline and Moretti, 2014a).
    3
      This view is echoed in literature reviews of the place-based policy literature, such as Kline and Moretti (2014b),
Neumark et al. (2015) and Duranton and Venables (2018).


                                                           2
    We apply our results to establish the normative properties of well-known economic geography
models corresponding to special cases of our framework with inelastic housing supply, a single worker
type, constant elasticity spillovers and no intermediate inputs. In this context, global efficiency is
characterized by the distribution of trade imbalances between regions. This distribution can be
implemented by a simple transfer rule that is independent from the distribution of fundamentals
or trade costs. We show that, because these models make different assumptions about transfers
in the laissez-faire allocation, they have different implications for whether the optimal government
intervention should redistribute income from high- to low-wage regions, or the reverse.
    In the more general case with asymmetric spillovers, allocations without transfers are still
generically inefficient. In addition to the forces described in the case with homogeneous workers,
there are also gains from reallocating workers that generate positive spillovers to places where they
are more scarce. Thus, inefficient sorting creates an additional rationale for spatial transfers and
reallocation. For example, if low skill workers benefit in terms of productivity from high skill
workers, the decentralized pattern of sorting by skill may be too strong. The optimal subsidies
then increase the degree of mixing across locations relative to the competitive allocation.
    Our theoretical analysis complements a body of research on optimal city sizes following Hender-
son (1974) that typically assumes homogeneous workers and limited heterogeneity across locations.4
Helsley and Strange (2014) characterize properties of the optimal sorting with heterogeneous work-
ers and spillovers, under the assumptions of homogeneous locations. We make progress by studying
the optimal allocation of a national planner who can implement transfers across cities, in an envi-
ronment with several dimensions of spatial heterogeneity and different sources of spillovers across
heterogeneous workers.5 A key feature of our approach is to provide a simple characterization of
efficiency in terms of the expenditure distribution. Being only a function of observable variables
and elasticities, this condition allows us to characterize optimal policies despite the generality of the
underlying framework, and to determine the set of statistics in the data that suffice to numerically
compute the optimal allocation.
    We also show how to extend this approach to settings with richer spillovers, such as environ-
ments with cross-location spillovers in the spirit of Desmet and Rossi-Hansberg (2014) or with
commuting as in Monte et al. (2018). In the latter, individuals decide both where to work (sub-
ject to productivity spillovers) and where to live (subject to amenity spillovers). We find that
with only constant-elasticity productivity spillovers, optimal policies are identical to our bench-
mark case without commuting. When both amenity and productivity spillovers are present, the
first-best policies combine two location-specific transfers, one varying by residence and the other

   4
      Flatters et al. (1974) and Helpman and Pines (1980) are early studies of optimal city sizes in models with
heterogeneous cities in either amenity or productivity. See Abdel-Rahman and Anas (2004) for a review. More recent
studies include Albouy (2012), Albouy et al. (2019) and Eeckhout and Guner (2017). A focus in some of these papers
is to study the extensive margin of city creation. We abstract from studying this margin, and take the number of
potentially populated locations as given.
    5
      We only inspect policies set by a national government. Canonical frameworks of fiscal competition, such as
Wilson (1986) and Zodrow and Mieszkowski (1986), include features that are not present in our analysis such as
mobile capital across regions and local financing of public goods that are valued by individuals or firms.


                                                        3
by workplace.
    We quantify the model using data on the distribution of economic activity across MSAs in the
United States. A key motivation for our application is the well known empirical evidence on urban
premia: larger cities in the U.S. feature higher wages, higher share of skilled workers, and higher
skill premium, as documented among others by Behrens and Robert-Nicoud (2015). Moretti (2012)
points out a “great divergence” in these outcomes over the last decades. We ask whether, in the
presence of spillovers, these observed patterns of spatial disparities in the U.S. are too strong from
the perspective of spatial efficiency.6
    In our benchmark analysis we allow for two skills groups, high skill (college) and low skill (non
college) workers. We combine data on labor and non-labor income, taxes and transfers at the city
level from the BEA, with Census data that allows us to break down these MSA-level totals by
skill group within cities. To parametrize the spillover elasticities we rely on existing estimates in
the U.S. based on spillover equations that are consistent with our model. We draw the amenity
spillovers and the heterogeneity in spillovers across workers from Diamond (2016), and the city-level
elasticity of labor productivity with respect to employment density from Ciccone and Hall (1996).
    The quantification yields welfare gains of roughly 2% to 6% across a range of specifications of
the spillover elasticities. In our benchmark parametrization, these gains are attained through a
reallocation of 11% of the population. With homogeneous workers the welfare gains are negligible,
suggesting that inefficient sorting drives the welfare costs. We find similar welfare gains across alter-
native quantifications that incorporate three groups of skill, migration frictions based on worker’s
region of birth, and land regulations. We find that the distortions caused by land regulations may
be quantitatively as important as those caused by inefficient sorting due to spillovers.
    These welfare gains are achieved by increasing income redistribution towards low-wage cities.
The optimal transfers can be implemented via higher labor income taxes in high-wage cities. In the
case of low skill workers, the higher taxes in high-wage cities arise because these workers generate
congestion and small productivity spillovers. In contrast, for high skill workers, they arise because
these workers generate positive spillovers onto low skill workers, who are more prevalent in low-
wage cities. This second force offsets the strong positive spillovers that high skill workers generate
among each other, which would call for a subsidy in high-wage cities.
    The effect of these transfers is a reallocation of workers from currently large high-wage cities to
small low-wage cities. In terms of skill mix, the initially less skill intensive cities grow and see an
increase in the share of high-skill workers. The largest and the most skill intensive cities shrink, but
they too increase their skill share. The resulting optimal allocation features a greater share of high
skill workers in small cities compared to the observed allocation as well as lower wage inequality in
large cities, to the point that the urban skill premium (i.e., the higher return to high-skill labor in
larger cities) vanishes. In sum, in the optimal allocation, the patterns of urban premia described
before are all weakened: larger cities feature relatively lower wages, lower share of skilled workers,

   6
     Recent papers such as Eeckhout et al. (2014), Behrens et al. (2014), and Davis and Dingel (2012) include spatial
sorting of heterogeneous individuals to rationalize some of these patterns.


                                                         4
and lower skill premium compared to the observed allocation.
    To further identify the key spillovers driving these results, we assume that the observed equi-
librium is efficient and use our optimal-transfers formulas to infer the spillover elasticities that best
rationalize the data. This procedure yields negative amenity spillovers of similar magnitude for
both skill groups, whereas the existing estimates used in the calibration imply that low-skill and
high-skill workers generate spillovers of opposite signs. In this sense, we identify a key role for the
heterogeneous amenity spillovers across skill types.7
    The rest of the paper is structured as follows. Section 2 presents a stylized model to drive
intuition, then presents the general environment. Section 3 characterizes the optimal policies,
teases out their implications in specific cases of the theory corresponding to the models from the
literature, and determines the data that suffice to implement the model. Section 4 describes the data
and the calibration. Section 5 presents the quantitative implementation and Section 6 concludes.
Proofs, additional derivations and data construction are detailed in the appendix.


2     Economic Geography Model with Worker Sorting and Spillovers
2.1    A Simple Example with Homogeneous Workers
    We start with a simple case nested in the environment we detail next. We use this case to show
that, starting from a market allocation without policies, there are gains from reallocating workers
across space. This is true even under identical and constant elasticity spillovers across space.
    Suppose that workers are homogeneous and that utility per worker in a location j equals uj =
aj cj , where aj is city-level amenities and cj is consumption of tradeable output. Amenities take
the form aj = Aj Lγj A , where Aj is exogenous and Lγj A is a spillover that depends on the population
Lj of j with constant elasticity γA . Similarly, output per worker zj = Zj Lγj P depends on exogenous
productivity Zj and on agglomeration economies governed by the constant elasticity γP .
    An approach in the placed-based policy literature, such as Glaeser and Gottlieb (2008) and
Kline and Moretti (2014a), is to characterize efficiency assuming that cj = zj ; i.e., per capita
consumption of traded goods equals output in every location. Utility per worker in j becomes
vj (Lj ) = Aj Zj Lγj A +γP , and it is equalized across locations in equilibrium because workers are
perfectly mobile. In turn, the solution to a planner’s problem who chooses Lj subject to the
same no-transfers restriction also delivers equalization of utility.8 Given this formulation of the
planner’s problem, the market allocation is efficient. This result follows from the fact that, as long

     7
       In our parametrization, these spillovers rely on numbers from Diamond (2016), who estimates a positive response
of an urban amenity index (including congestion in transport, crime, environmental indicators, supply per capita of
different public services, and variety of retail stores) to the relative supply of college workers, as well as a higher
marginal valuation for these amenitiesP for college than for non-college workers.
     8
       If the planner maximizes u ≡ j Lj vj (Lj ), the marginal return to adding a worker in j is 1 + γ A + γ P vj .
                                                                                                                   

Using a different notation, Proposition 1 of Glaeser and Gottlieb (2008) solves this planner problem, which leads to
equalization of marginal returns and therefore of vj . Kline and Moretti (2014a) make the similar point that if dL
workers are reallocated from i to j, then there are no gains from reallocation starting from any market allocation
with free mobility.


                                                          5
as consumption equals output and there are constant elasticity spillovers, welfare is a constant-
elasticity function of city size. Then, equalization of marginal returns (the planner’s efficiency
condition) is equivalent to equalization of average returns (the market allocation). This result is
often described by saying that there are no gains to reallocation because the marginal productivity
gain in one location is exactly offset elsewhere.9
    This analysis is made under a strong restriction in the planning problem, namely that each
region must consume the same amount of traded output it produces. This restriction rules out
government policies that tax and redistribute income across locations. When transfers of resources
between locations are allowed, the result and intuition described above no longer hold, as welfare
is no longer a constant elasticity function of city size.10
    We now assume that the government can implement spatial transfers. With transfers, the
distribution of consumption per capita cj changes and workers move to equalize utility in space.
As shown in Appendix A.1, starting from transfers tj ≡ cj − zj received by workers in j, when a
transfer is implemented the common level of utility across workers changes according to:

                                     γP                  + γA
                                           P                    P                     P
                                du            j zj dLj              j cj dLj      −   j tj dLj
                                   =                                                             ,                    (1)
                                u                               Y

where dx is the infinitesimal change in x and Y is aggregate output. The no-transfers equilibrium
implies tj = 0. Combined with the definition of output (Yj = zj Lj ), this leads to:
                                                                             
                                         du           X                 Yj       dLj
                                            = γP + γA                                 .                               (2)
                                         u                               Y        Lj
                                                                j


Therefore, a transfer leading to a reallocation of dL workers from j to location i yields

                                           du                        dL
                                              = γ P + γ A (zi − zj )
                                                         
                                                                        .                                             (3)
                                           u                         Y

From (3), there are gains from implementing a reallocation whenever the market allocation without
transfers yields differences in output per worker (zi 6= zj ). In turn, this will be the case whenever
there are differences in amenities (ai 6= aj ), as the initial allocation without transfers equalizes
utility (ai zi = aj zj ).
    This analysis shows that the laissez-faire allocation is inefficient even when spillovers have
constant elasticity, as long as there is dispersion in compensating differentials through amenities,
aj . In a more general model where the compensating differentials arise through costly trade or non-
    9
      For instance, Duranton and Venables (2018) write: “When cluster expansion occurs because of labour relocation
from other areas, agglomeration gains in the targeted area will come at the expense of agglomeration losses elsewhere.
In the specific case where the agglomeration elasticity is constant, the gains in the targeted area will be exactly offset
by the losses elsewhere.”
   10
      Intuitively, the no-transfer market allocation equates amenities times consumption per capita aj cj across loca-
tions, where consumption equals output, cj = zj . With constant elasticities and no transfers, the planner equates
(1 + γA + γP ) aj cj across locations, which gives the same result. But starting from this allocation, cj may be re-
allocated to locations with high amenity value. So there are incentives to transfer output, which in turn leads to
reallocation of workers.


                                                            6
traded goods, the allocation is inefficient even with no dispersion in amenities. What matters is that
amenities, non-traded goods, or trade frictions lead to compensating differentials between cities.11
This result holds regardless of whether the source of the spillovers is amenities, productivities, or
both. If, for instance, congestion forces dominate (γ P + γ A < 0) then it is optimal to implement
transfers that reallocate workers to places with low output per worker and high marginal utility of
consumption. With this intuition at hand, we now set out to characterize first-best spatial policies
in the context of a more general spatial equilibrium model.

2.2     Environment
    We consider a closed economy with a discrete number J of locations indexed by j or i. Each
worker belongs to one of Θ different types. Among other things, the type indexes each worker’s
preference and productivity in each location, as well as each worker’s capacity to generate and
absorb productivity and amenity spillovers. Workers are free to choose where to live. National
labor market clearing is:
                                                     X
                                                           Lθj = Lθ ,                                                  (4)
                                                       j

where Lθ is the fixed aggregate supply of group θ. The utility of a worker of type θ in location j is:

                                                                   θ θ
                                          uθj = aθj L1j , .., LΘ
                                                               j U cj , hj .                                           (5)

The function aθj (·) captures the valuation of a worker of type θ for location j’s amenities. Workers
may vary in how much they value amenities associated with exogenous features of each location, and
also in how much they value amenity spillovers created by each type. For example, a demographic
group may prefer living in locations with higher density of their own demographic group, or may
value urban amenities generated or congested by specific groups. To capture this feature, aθj (·)
depends on the distribution of workers of different types living in j. Workers also derive utility
from a bundle of differentiated tradeable commodities (cθj ) and from non-tradeable services including
housing (hθj ). The utility function U (c, h) is homogeneous of degree 1.
    Every location
                  produces
                             traded and non-traded goods. Tradeable output uses an aggregate
                 Y   Y
technology Yj Nj , Ij requiring services of labor NjY and intermediates IjY . Similarly, production
                                       
in the non-traded sector is Hj NjH , IjH . The functions Yj and Hj may be city-specific and feature
constant or decreasing returns to scale, due to the use of fixed factors such as land. Therefore,
the framework allows for heterogeneous housing supply elasticities across cities through the city
specific decreasing returns to scale in Hj (·). The feasibility constraint in the non-traded sector in
j is:
                                                          X θ θ
                                             Hj NjH , IjH = Lj hj .                                                    (6)
                                                                   θ

   11
     Our analysis assumes that the planner values the utility of ex-ante-identical workers in the same way, regardless
of where they live. The no-transfer allocation could be efficient if the planner had different Pareto weights for identical
workers who live in different locations, for a particular distribution of those weights.


                                                             7
Goods in the traded sector can be shipped domestically or to other locations. The country’s
geography is captured by iceberg trade frictions dji ≥ 1. These frictions mean that dji Qji units
must be shipped from location j to i for Qji units to arrive. The feasibility constraint of traded
goods dictates:
                                                      X
                                         Yj NjY , IjY =  dji Qji .                                        (7)
                                                              i

   Traded goods may be differentiated by origin, reflecting either industrial specialization at the
regional level or variety specialization at the plant level.12 Specifically, the traded goods arriving
in i are combined through the homothetic and concave aggregator Q (Q1i , .., QJi ). This bundle
of traded commodities may be used for final consumption or as an intermediate input in local
production:
                                                         X
                                  Q (Q1i , .., QJi ) =       Lθi cθi + IiY + IiH .                        (8)
                                                         θ

The standard assumptions in Rosen (1979)-Roback (1982) models is that products are perfect
                                               P
substitutes, which implies Q (Q1i , .., QJi ) = j Qji . Economic geography models assume differen-
tiation by origin using constant-elasticity of substitution (CES) functional forms. For now, we do
not impose these restrictions.
   All workers supply one unit of labor with efficiency that may vary by worker type and location.
Each type-θ worker in location j supplies

                                             zjθ = zjθ L1j , .., LΘ
                                                                      
                                                                  j                                       (9)

efficiency units. The function zjθ captures exogenous differences in productivity between locations
and skill groups, as well as productivity spillovers across workers. Spillovers take place outside the
firm at the level of the city. For instance, the concentration of activity in a city gives rise to thick
local labor markets that allows better matches between firms and workers, as well as knowledge
spillovers –workers learn from each other through social interactions (see e.g. Duranton and Puga
(2004)). As with amenities, these spillovers may depend on the distribution of types. For example,
high-skill workers may benefit more than low-skill workers from being employed in the same city
as other high-skill workers, or in more densely populated areas. In both traded and non-traded
sectors, the services zjθ Lθj of the various types of labor are combined through the possibly non-
                                            
homothetic aggregator N zj1 L1j , .., zjΘ LΘ
                                           j . This aggregator also captures imperfect substitution
across workers. Feasibility in the use of labor services then implies

                                    NjY + NjH = N zj1 L1j , .., zjΘ LΘ
                                                                       
                                                                     j .                                 (10)

   We highlight two key features relative to an otherwise standard neoclassical environment with
a representative worker-consumer. First, the location of a worker drives both her marginal product

  12
      We abstract from modeling multiple traded sectors with input-output linkages across them. Rossi-Hansberg
et al. (2019) studies optimal spatial policies in a framework with these features.


                                                         8
(because productivity is place specific) and her marginal utility of consumption (through local
amenities). Therefore, production and consumption decisions are not separable.13 Second, the
framework features two potential sources of non-convexities through the amenity and productivity
spillover functions. The utility of each agent may change with the number of other agents in the
same location through aθj and the labor aggregator N (·) may feature increasing returns to the
                                                                
number of workers in a particular group through zjθ L1j , .., LΘ
                                                               j   Lθj .
    At this stage, it is convenient to define the productivity and the amenity spillover elasticities:
                                                          0                                            0
                                  P,j          Lθj ∂zjθ                         A,j         Lθj ∂aθj
                                 γθ,θ 0    ≡     0            ,     and        γθ,θ 0   ≡     0            .   (11)
                                               zjθ ∂Lθj                                     aθj ∂Lθj

These elasticities capture the marginal spillover of a type θ worker on the efficiency and utility of
                                                                           P,j      A,j
each type θ0 worker in city j. The case without spillovers corresponds to γθ,θ 0 = γθ,θ 0 = 0. So far

we have not imposed functional forms, so that these elasticities can be variable.

2.3    Competitive Allocation
    In the decentralized equilibrium each worker chooses location and consumption to maximize
utility, while competitive producers hire labor and buy intermediate inputs to maximize profits.
Being atomistic,
              these    agents donot take 
                                            into account the impact of their choices on the spillover
           θ   1       Θ        θ   1     Θ
functions aj Lj , .., Lj and zj Lj , .., Lj .


Workers      Conditional on living in j, a type-θ worker with expenditure level xθj solves
                                               
                                max U cθj , hθj                    s.t.   Pj cθj + Rj hθj = xθj ,              (12)
                                cθj ,hθj


where Pj is the price of the bundle of traded goods and Rj is the unit price in the non-traded
sector. As a result, utility per worker is

                                                                                   xθj
                                           uθj = aθj L1j , .., LΘ
                                                                          
                                                                j                           ,                  (13)
                                                                               ψ (Pj , Rj )

where ψ (P, R) is the price index associated with U . In equilibrium, all type-θ workers attain the
same utility uθ . Workers’ location choice implies that

                                                                  uθj ≤ uθ ,                                   (14)

with equality if Lθj > 0.


  13
     Allowing for commuting (as in Section 3.5) makes the production and consumption locations distinct. However,
they are still non separable, so long as commuting costs are non zero, because the choice of workplace depends on
the residential choice through commuting access.


                                                                      9
Firms    Producers of traded and non-traded commodities maximize profits:



                          ΠYj = max pj Yj NjY , IjY − Wj NjY − Pj IjY ,
                                                   
                                                                                               (15)
                                 NjY ,IjY

                          ΠH              H H
                                                   − Wj NjH − Pj IjH ,
                                                 
                           j = max Rj Hj Nj , Ij                                               (16)
                                 NjH ,IjH


where pj is the domestic price of the tradeable commodity produced in j and Wj is the wage
per efficiency unit of labor. Workers collectively own a national portfolio of these returns, which
amounts to Π = j ΠYj + ΠH
                  P
                              j .             n o
   Given a distribution of wages per worker wjθ , the wage of type-θ workers in location j equals
                                                                             n o
the value of its marginal product taking as given the efficiency distribution zjθ :
                                                                           
                                                    ∂N zj1 L1j , .., zjΘ LΘ
                                                                          j
                                   wjθ = Wj                                      .             (17)
                                                                 ∂Lθj

We assume a no-arbitrage condition, so that the price in location i of the traded good from j
equals dji pj . Free entry of intermediaries who can buy and resell goods between regions ensures
this condition holds. Given these prices, the trade flows are:

                                            ∂Q (Q1i , .., QJi )
                                       Pi                       = dji pj ,                     (18)
                                                 ∂Qji

where pj is the domestic price of the tradeable commodity produced in j. In the competitive
equilibrium the prices of final goods, Pj and Rj , adjust so that the corresponding goods markets
clear.

Expenditure Per Worker The only component of the competitive allocation left to define is
the per capita expenditure for a type-θ worker who lives in j, xθj . Each type-θ worker in location
j earns the wage wjθ and owns a fraction bθ of the national returns to fixed factors Π. Workers
of different types may differ in their ownership of fixed factors, but they hold the same portfolio
regardless of where they locate. In addition, we allow for government policies that tax and transfer
income across locations. As a result, expenditure per capita is

                                                xθj = wjθ + bθ Π + tθj ,                       (19)

where tθj is the net government transfer to a type-θ worker living in j. Using balanced budget for
the government, expenditure equals net income:
                                 XX                         XX
                                                Lθj xθj =               Lθj wjθ + Π.           (20)
                                   j        θ                j    θ




                                                            10
Definition 1. A competitive allocation consists of quantities cθj , hθj , Lθj , Qij , NjY , IjY , NjH , IjH , utility
levels uθ , prices Pj , Rj , pj , returns to fixed factors Π, wages per efficiency unit Wj , and wages per
worker wjθ such that
    (i) the consumption choices cθj , hθj are a solution to (12) for expenditures xθi satisfying (19), and
employment Lθj is consistent with the spatial mobility constraint (14);
    (ii) the labor, intermediate input choices NjY , IjY , NjH , IjH and profits Π are such that producers
maximize profits, labor demand is given by (17), and trade flows Qji are given by (18);
    (iii) the government budget constraint is satisfied; i.e. (20) holds, and
    (iv) all markets clear, i.e. (4) to (10) hold.

2.4    Planning Problem
    Our aim is to contrast this decentralized allocation with the solution to the planner’s problem.
We consider
          n a planning
              o        problem where the planner chooses the distribution
                                                                      n of workers
                                                                           o       over locations
and types   Lθj , consumption of traded and non-traded commodities cθj , hθj , trade flows {Qij },
                                                               n                     o
and the allocation of efficiency units and intermediate inputs, NjY , IjY , NjH , IjH . The planner
implements policies that treat all individuals within a type in the same way, and is bound by the
spatial mobility constraint (14). Along with that constraint, the market clearing conditions (4) to
(10) define a set U of attainable utility levels. The optimal planning problem is

                                           max uθ
                                                    0      0
                                           s.t.: uθ = uθ        for θ0 6= θ
                                                    0
                                                 uθ ∈ U        for all θ0

                                                                                                             0
    The set of solutions of this problem given an arbitrary θ for all feasible values of uθ ∈ U
for θ0 6= θ defines the utility frontier. Existence is guaranteed, since the planner optimizes a
continuous objective function over the compact nonempty set defined by the feasibility constraints.
Competitive equilibria according to Definition 1 may not correspond to a point on the frontier due
to spatial inefficiencies: workers do not internalize the impact of their location choice on amenities
through aθj and firms do not internalize the impact of their hiring decisions on efficiency through
zjθ . We turn next to the solution and implementation of this planning problem.


3     Optimal Transfers
    Before characterizing the optimal allocation in a general setup, we build intuition by augment-
ing our simple example from Section 2.1 with heterogeneous workers, which helps illustrate the
additional role played by inefficient sorting.




                                                         11
3.1    Simple Example with Heterogeneous Workers
    We return to the simplified setup of Section 2.1, now augmented with several worker types.14
We examine the effect of implementing small spatial transfers, starting from a market allocation
without transfers, such that the the welfare of every group but one (θ0 ) is kept constant. As shown
in Appendix A.2, the utility of this group changes according to:
                                                                                                     0
                                                                                                         !
                           duθ0    1 XX              X
                                                              P            A               0   Lθj
                                                                                       wjθ                   dLθj ,
                                                                                   
                                =                            γθ,θ 0   +   γθ,θ 0                                      (21)
                           uθ0    Y θ0                                                         Lθj
                                           j   θ∈Θ   θ0 ∈Θ

where dLθj is the population change triggered by the transfers, wjθ is the wage of type-θ workers in
j, and Y θ0 are the aggregate wages of θ0 workers.
    Naturally, it is better to reallocate workers into cities where they generate larger spillovers.
If type θ generates positive spillovers on type θ0 (γθ,θ
                                                     P + γA
                                                         0 θ,θ0 > 0), it is desirable to reallocate
                                                                                               0
type θ into cities where type θ0 is more productive (i.e., where wjθ is high), much as in (2) in the
one-group case. Hence, as in the case with homogeneous workers from Section 2.1, the allocation
without transfers is generically inefficient even with constant-elasticity spillovers.
    Furthermore, it is profitable to reallocate workers that generate positive spillovers into locations
                                                      0
where they are relatively scarce (i.e., where Lθj /Lθj is low), reflecting that sorting in the undistorted
equilibrium can be inefficient. This gain from reallocation happens even without compensating
differentials through amenities, which were necessary to obtain gains in the homogeneous-worker
case discussed in Section 2.1. Therefore, inefficient sorting creates an additional rationale for gains
from spatial transfers.

3.2    Efficiency Condition and Optimal Transfers
    To characterize efficiency in the general model, it is useful to note that the
                                                                                 n competitive
                                                                                      o        alloca-
                                                                                    θ
tion can be determined given an arbitrarily chosen expenditure distribution xj over types and
locations. We can then choose the transfers tθj to implement the arbitrarily chosen xθj using (19).
Therefore, we can obtain a condition over the expenditure distribution xθj that must hold in any
efficient allocation, regardless of what particular policy tools are used to achieve it. Comparing an
allocation with expenditures xθj to the outcomes of the planning problem, detailed in Definition 2
of Appendix A.3, we obtain the following result.




  14
     Compared to the full framework, we assume that only tradeable output is valued in consumption (uθj = aθj cθj ),
labor is the only factor of production, goods are perfect substitutes across origins and traded without frictions, and
                                                          P,j      P          A,j      A
the spillover elasticities defined in (11) are constant, γθ,θ 0 = γθ,θ 0 and γθ,θ 0 = γθ,θ 0 .




                                                          12
Proposition 1. If a competitive equilibrium is efficient, then

                dNj               X Lθj 0 A,j 0
            Wj θ               +           γ xθ
                                         θ θ,θ0 j
                                                    =        xθj       +        Eθ
                dLj                  0
                                       L j
                                                                               |{z}
                                  |θ
                                                            |{z}
            | {z }                       {z      }
                                                      consumption cost   opportunity cost
     marginal product of labor   marginal amenities                         of type θ
                                                          (private)
      (private+spillovers)          (spillovers)
                                                                                                    (22)

if Lθj > 0, for all j and θ and some constants E θ . If the planner’s problem is globally concave
                                              

and (22) holds for some specific E θ , then the competitive equilibrium is efficient.
                                  


    Condition (22) defines a relationship between expenditure per capita and the labor allocation
that must hold in any efficient allocation. This condition shows the equalization of the marginal
benefits and costs of type-θ workers across inhabited locations. The first term on the left is the
value of the marginal product of labor, including both the direct output effect and the productivity
spillovers. Using the labor demand condition (17) we obtain that the value of the marginal product
of labor can be written as function of wages, employment and elasticities:

                               dNj              X Lθ0
                                     θ      P,j          j P,j θ0
                             Wj θ = wj 1 + γθ,θ +          γ w .
                                                         θ θ,θ0 j
                                                                                                  (23)
                               dLj                 0
                                                  θ 6=θ
                                                        Lj


The second term in (22) is the marginal benefit (or costs if negative) through amenity spillovers on
each group of workers living in j, measured in expenditure equivalent terms.
    These marginal benefits from allocating a type θ worker to location j are equated to the marginal
costs on the right. The first term, xθj , results from the non-separability between a worker’s location
and consumption: each type-θ worker in j requires xθj units of expenditures in that particular
location. From a social planning perspective this is a cost, because each additional worker in j
translates into lower consumption of traded and non-traded commodities for other workers in that
location. The last term, E θ , is the multiplier of the national market clearing constraint (4) in the
planner’s problem and measures the opportunity cost of employing a type-θ worker elsewhere.
    We can draw several useful implications from this result. First, asking whether the spatial
allocation is efficient is equivalent to asking whether the expenditure distribution in the market
allocation lines up with (22), because the set of equations defining the competitive allocation
coincides with the set defining the planner’s allocation, except potentially for the expenditure
distribution. Therefore, despite the multiple general-equilibrium ramifications of the spillovers,
market inefficiencies can be fully tackled through policies acting on xθj . This compartmentalization
of the inefficiencies reflects a broader “principle of targeting” noted by Bhagwati and Johnson
(1960) in trade-policy contexts and by Sandmo (1975) and Dixit (1985) in economies with external
effects.
    Second, Proposition 1 extends a familiar efficiency condition from the misallocation literature


                                                  13
to spatial environments. In our economy, “space” enters through trade costs, non-traded goods,
congestion and amenities. In the absence of these forces, there would be no compensating differ-
entials across locations and, as a result, the equilibrium would exhibit the same expenditure per
capita xθj for each type θ across locations. In that case, the model would be equivalent to one
describing the allocation of workers across firms, and (22) would collapse to the familiar condition
that the marginal value-product of labor is equalized across locations.
    Third, information about the distribution of expenditure per capita xθj is needed to assess
the economy’s efficiency. In studies of misallocation across firms (Hsieh and Klenow, 2009), the
absence of compensating differentials justifies the practice of inferring allocative inefficiencies from
differences in income per worker. In our spatial environment with compensating differentials, the
non-separability of consumption and production means that the net marginal benefit of reallocating
a worker includes the local expenditure of that worker. As a result, assessing the efficiency of the
allocation requires data on the distribution of expenditure per capita xθj . Given knowledge of
this distribution, further information on how the returns to fixed factors Π are distributed is not
necessary to assess efficiency.15
    Finally, we note that (22) is a necessary but not sufficient condition for efficiency. Even if
this condition holds, inefficient market equilibria could exist. However, the inefficient allocations
consistent with (22) can be ruled out if the planner’s problem is globally concave, as in that case only
one allocation that satisfies the first order conditions of the planner. In Section 3.6 we introduce
conditions for global concavity of the planner’s problem.16
    Given the efficiency conditions (22), we now derive transfers that implement them. Combining
(19) and the definitions of the spillover elasticities (11) with Proposition 1 and labor demand (17),
we obtain the following proposition:

Proposition 2. The optimal allocation can be implemented by the transfers

                              X                                Lθ0 ∗                
                                    P,j θ0 ∗        A,j θ0 ∗      j
                    tθ∗
                     j    =        γθ,θ 0 wj   +   γθ,θ 0 xj             − bθ Π∗ + E θ     if Lθ∗
                                                                                               j > 0,              (24)
                              θ0
                                                                 Lθ∗
                                                                  j

                                             
                         xθ∗   θ∗   θ∗    ∗
                                                                                                              θ
where the terms           j , wj , Lj , Π         are the outcomes at the efficient allocation, and           E      are
constants equal to the multipliers on the resource constraint of each type in the planner’s allocation.

   The optimal transfers tθ∗
                          j take care of inefficiencies due to spillovers as well as of distributional
          17 In the absence of spillovers we would still have tθ∗            θ ∗      θ
                                                                                        
concerns.                                                        j = − b Π + E , so that the

   15
      As it was noted early on in studies of optimal city size, assumptions about ownership of fixed factors are relevant
to determine the efficiency of the market allocation (Pines and Sadka, 1986). The expenditure distribution implied by
(22) that implements the efficient allocation is invariant to assumptions about ownership of fixed factors. A different
rule to distribute Π from that assumed in (19) would imply a different set of optimal transfers tθj to implement the
optimal expenditure distribution, but would not affect (22).
   16
      At the current level of generality, it is possible that a market allocation does not exist or exhibits multiplicity
for an arbitrarily chosen distribution of expenditures. However, if a solution to the planner’s problem exists, then
there is a market allocation consistent with (22).
   17
      These optimal transfers apply to populated locations. The planner could choose not to allocate some types to


                                                                14
transfers would take care of redistribution across types, as implied by the second welfare theorem.
The burden of dealing with the spatial inefficiencies falls on the spatial component of the optimal
transfers, corresponding to the first term in (24).
    We will use conditions (19) and (24) for two separate quantitative goals in Section 5. First, given
the spillover elasticities, we use them to determine the efficiency of the observed allocation from
data on wages, expenditures, and employment. Second, under the assumption          n that the    o observed
                                                                                     P,j     A,j
allocation is efficient, we use the condition to recover the spillover elasticities γθ,θ0 , γθ,θ0 from the
observed data.

3.3    Optimal Subsidies with Constant Elasticity Spillovers
    The optimal subsidies formula takes a simple form when spillovers have constant elasticities.
                                                 P,j      P          A,j       A
We make this assumption from now on, and write: γθ,θ 0 = γθ,θ 0 and γθ 0 ,θ = γθ 0 ,θ . The optimal

transfers in (24) then simplify to tθj = sθj wj − T θ , where

                                                                        0       0
                                        P + γA
                                       γθ,θ                P w θ + γ A xθ
                                                        X γθ,θ              θ0
                                             θ,θ               0 j  θ,θ0 j Lj
                             sθj   =         A
                                                    +                     A
                                                                                                           (25)
                                        1 − γθ,θ        θ0 6=θ
                                                                     1 − γθ,θ       wjθ Lθj

and
                                                                    Eθ
                                              T θ = bθ Π +             A
                                                                           .                               (26)
                                                                  1 − γθ,θ
This representation readily implies that the optimal transfers can be implemented by labor income
subsidies sθj coupled with lump-sum tax T θ . The labor income subsidy sθj is a function of wages,
expenditures and population. The labor subsidies tackle spatial inefficiencies due to spillovers,
while the lump-sum transfers take care of distributional concerns. Differences in the holdings of
the national portfolio across types affect the level of lump-sum transfers only. They do not create
a rationale for spatially differentiated policies. We now draw the implications of this formula in
special cases.

No Spillover Across Types              We consider first a case with several worker types, but with γθP0 ,θ =
γθA0 ,θ = 0 for θ0 6= θ, so that there are no spillovers across types. The optimal subsidy (25) becomes:

                                                            P + γA
                                                           γθ,θ  θ,θ
                                                   sθ =           A
                                                                            .                              (27)
                                                             1 − γθ,θ

                                                                                                       γ P +γ A
In the special case of a single worker type, the policy is further simplified to (s, T ) with s =       1−γ A
                                                                                                                .
This formula has a simple interpretation. Under negative congestion spillovers for type θ            A
                                                                                                   (γθ,θ < 0),
                                                                P < −γ A ), then all workers of type
if the agglomeration spillover of that type is not too strong (γθ,θ   θ,θ
θ should pay as tax the same fraction of their income everywhere (a negative subsidy, sθ < 0).

some locations or to leave some locations empty. Implementing this extensive margin entails taxing away all the
income of those types.


                                                             15
In this case, the net transfer tθj received by type-θ workers is smaller, and potentially negative, in
cities where their wage is higher.
   The presence of compensating differentials is the key reason why, even with constant elasticity
spillovers, the laissez-faire allocation is generically inefficient. We made this point in Section 2.1
in a special case starting at an equilibrium without transfers. We have now shown that the global
optimum is obtained using a constant subsidy-cum-lump sum transfer scheme sθ , T θ that does
                                                                                     

not vary across space. To see why this policy distorts the spatial allocation despite being space-
independent, we must again consider the role of the compensating differentials. From the mobility
constraint (14), indifference across populated locations j and j 0 implies:

                      ψ Pj 0 , Rj 0 /aθj0 Lj 0         1 + sθ Wj 0 zjθ0 Lj 0 + T θ + bθ Π
                                                                         
                                                   =                                         .               (28)
                       ψ (Pj , Rj ) /aθj (Lj )         (1 + sθ ) Wj zjθ (Lj ) + T θ + bθ Π

The left hand side is the relative compensating differential (amenity-adjusted cost of living) and the
right hand side is the relative expenditure (equal to relative after-tax income) between locations
j 0 and j for type θ. In the presence of amenities, non-traded goods or trade costs, the relative
compensating differentials vary across space. As a result, changes to the policy scheme (sθ , T θ )
lead to changes in the employment distribution of type θ. In the absence of these compensating
differentials, the indifference condition would collapse to Wj zj (Lj ) = Wj 0 zj 0 Lj 0 for any sθ , T θ ,
                                                                                                        

and these policies would cease to impact the spatial allocation.

Spillovers Across Types          We already saw in the example at the beginning of this section that
inefficient sorting creates a rationale for transfers. To see how the optimal subsidies look like,
consider a polar case without amenity spillovers and without efficiency spillover on the same type.
Assume, furthermore, that there are only two types, θ = U, S for unskilled and skilled. Then, the
optimal subsidy to type-θ workers located in j simplifies to
                                                                  0       0
                                                                              !
                                                            wjθ Lθj
                                            sθj = γθ,θ
                                                   P
                                                       0                          .                          (29)
                                                                wjθ Lθj

In this special case, the optimal subsidy for workers in group θ varies across locations according to
the distribution of relative wage bills, wjθ Lθj . A positive cross efficiency spillover implies a higher
marginal gain from attracting a given worker type to locations where the economic size of the other
type is relatively larger. The result is a higher optimal subsidy for the types that generate spillovers
where they are more scarce. Relative to a laissez-faire equilibrium, this policy tempers the degree
                                                                 dsS
                                                                   j              P γ P > 0, so that subsidies of
of sorting across cities. Condition (29) also implies            dsU
                                                                          < 0 ←→ γS,U U,S
                                                                   j
both types are negatively correlated across cities if both types generate positive efficiency spillovers.
These basic intuitions will help us rationalize the quantitative findings about the spatial efficiency
of the current transfer scheme in the U.S. economy.




                                                           16
Link to Henry George Theorem                  We discussed above an implementation of the optimal trans-
fers (24) with labor income subsidies (25) and lump-sum taxes (26). However, other implementa-
tions are possible. Is it possible, in our context, to tax only the returns to fixed factors Π (instead
of raising lump-sum taxes) in order to finance place-specific subsidies to mobile factors? This
question is motivated by the Henry George Theorem, which says that, in some environments, land
taxes raise just enough revenue to finance efficient government expenditures.18 This question is
only meaningful when the optimal labor income subsidies are positive, as otherwise the tax system
necessarily entails taxing mobile factors. Then, under some regularity conditions, our model implies
that the returns to the fixed factors Π add up to more than the total lump-sum taxes in (26).19
In this case, the tax system implementing optimal subsidies may feature aggregate redistribution
from fixed factors to mobile factors.

3.4     Economic Geography Frameworks
    The environment laid out in Section 2 nests standard economic geography models, such as
Helpman (1998), Allen and Arkolakis (2014) and Redding (2016).20 These models are the basis
of a growing body of quantitative research studying the spatial implications of regional shocks,
summarized by Redding and Turner (2015) and Redding and Rossi-Hansberg (2017). However,
their normative implications have barely been explored.21 We now apply the previous results to
shed light on optimal policies in these environments.
    To specialize our setup to these models we assume a single worker type, Cobb-Douglas prefer-
ences with weight αC on traded goods, and a constant amenity spillover elasticity γ A . Utility per
worker in location j then is
                                                             A
                                             uj = Aj L1+γ
                                                      j   cαj C h1−α
                                                                 j
                                                                    C
                                                                                                                   (30)

   18
       See Arnott (2004) for a review. In systems-of-cities models following Henderson (1974), if public goods are the
source of agglomeration then it is efficient to tax land rents and use the proceeds to finance public expenditures.
With increasing returns to scale in production, the theorem is cast as an equality between land rents and the value of
output times the degree of returns to scale at the level of a city (see Section III of Arnott, 2004). These results hold
at the city level, and are derived in models with homogeneous workers, identical locations, no spatial interactions
among cities, and free entry of cities.
    19                        P θ θ            P Lθ E θ                                                           θ
       Using (26) we obtain:     θL T = Π+        θ 1−γ A . Hence if the planning problem is convex (implying E < 0),
                                                       θ,θ
                                                       A
                                                           < 1), we get Π > θ Lθ T θ .
                                                                            P
and own-congestion spillovers are not too strong (γθ,θ
    20
       Our presentation so far has assumed that each location sells a different product under perfect competition. In
Online Appendix A we show that the analysis would be the same assuming free entry of producers of differentiated
varieties under monopolistic competition as in the standard Krugman (1980) model. The key reason why this
equivalence holds is that under CES preferences the number of producers Mj and the bilateral trade flows are
efficient given the allocation of labor Lj . Therefore, the labor allocation remains the only inefficient margin and our
propositions and results from Section 3.4 go through. These properties would not go through under monopolistic
competition outside of CES. In that case, the entry and bilateral pricing decisions would be inefficient (Zhelobodko
et al., 2012).
    21
       In his review of the policy implications of empirical economic-geography studies, Combes (2011) notes the lack
of a general-equilibrium analysis of the optimal allocation of employment in a model of regional trade allowing for
geographic inter-dependencies. Other recent papers studying spatial policies in geography models include Allen et al.
(2015) who consider zoning restrictions within a city, Fajgelbaum and Schaal (2017) who consider transport network
investment, and Gaubert (2015) who characterizes the optimal allocation in a model heterogeneous firms and a
complementarity between city size and firm productivity.


                                                          17
Production only uses labor and the efficiency spillover has a constant elasticity γ P , so that tradeable
output in region j is
                                                          P
                                            Yj = Zj L1+γ
                                                     j   .                                                (31)

Supply of non-traded goods in location j is inelastic and equal to Hj . In a competitive allocation,
workers in j receive a wage wj equal to tradeable output per worker.
   Applying Proposition 1 under these assumptions, we find that a linear relationship between
expenditure and wages implements the efficient allocation

                                         xj = (1 − η)wj + η w̄,                                           (32)

                                                              αC (1+γ P )
where w̄ is the average wage in the economy and η ≡ 1−          1−γ A
                                                                            combines the spillover elasticities
and the expenditure share in traded goods. The corresponding optimal transfers are linear in wages:
tj = η (w̄ − wj ). Barring knife-edge cases on the parameters (η = 0) or the fundamentals (such
that wj = w), the efficient allocation generically features trade imbalances. In particular, under
the empirically consistent case of η < 0, efficiency requires net trade deficits in high-wage regions.
   Should the optimal policy that implements (32) redistribute towards or away from high-wage
locations? The answer depends on the distribution of non-labor income (the returns to land Hj ).
To answer this question, we can assume like Caliendo et al. (2018) that a fraction ω of the returns to
fixed factors is distributed locally to the Lj workers in j and the remainder is evenly split across all
workers. The optimal policy can again be expressed as a constant labor subsidy s that is common
across locations and equal to

                                        1 + γP
                                   s=          [1 − (1 − αC ) ω] − 1,                                     (33)
                                        1 − γA

with lump-sum transfer equal T = −sw̄. Even in the absence of spillovers, the equilibrium is
inefficient as long as there is some local ownership (ω > 0). In this case, we obtain a non-zero subsidy
that corrects the distortion introduced by local ownership. With spillovers, the optimal policy
redistributes income away from low-wage regions when s > 0, and into low-wage regions under a
labor tax (s < 0). Assuming common ownership of the national portfolio (ω = 0) as in Helpman
(1998), and continuing to assume that η < 0, spatial efficiency requires income redistribution to
regions with above-average wage (s > 0). In contrast, assuming away trade imbalances as in Allen
and Arkolakis (2014) and Redding (2016), the optimal policy redistributes income to low-wage
regions (s < 0).
   In sum, the details of the microeconomic structure and the country’s economic geography (rep-
resented by bilateral trade costs) do not impact the relationship between optimal trade imbalances
and wages, nor the policies that implement them, whereas the ownership of fixed factors determines
whether the optimal policies should redistribute income towards or away from high-wage regions.




                                                   18
3.5   Additional Forces
   Our results on optimal transfers can be extended to economic geography environments that
incorporate additional margins. We review here some of these extensions that correspond to popular
modeling choices in the literature.

Preference Draws within Types To incorporate that workers may have idiosyncratic prefer-
ences for location, we extend the model to assume that a worker l of type θ derives utility uθj lj
from living in location j, where lj captures idiosyncratic preferences that are i.i.d. and distributed
                          −1/σθ
Fréchet, Pr lj < x = e−x        . The preference draws are eliminated when σθ = 0, in which case
we return to the original formulation of the model. Every other aspect of the model remains the
same except for the spatial mobility constraint (14), which is is now replaced with the following
labor-supply equation:
                                                        !1/σθ
                                          Lθj     uθj
                                              =                 .                                 (34)
                                          Lθ      uθ

Taking into account this difference, we can compute the optimal allocation and define optimal
transfers using the same definition of the planner’s problem as in 2.4. Then, Propositions 1 and
                                                     A,j
2 go through with only one modification: instead of γθ,θ , the relevant amenity spillover elasticity
                          A,j    A,j
on the own type becomes γ̃θ,θ ≡ γθ,θ − σθ . Hence, without spillovers we obtain a (negative) labor
                σθ
subsidy sθ = − 1+σ θ
                     . These subsidies tackle distributional concerns rather than inefficiencies. The
incentives for redistribution arise from the combination of two reasons: i) different individuals l
within a group θ receive the same planner’s weight; and ii) the planner conditions outcomes on
location j and type θ, but not on individual preference draws εθj . As a result, the planner will
have incentives to re-distribute to locations where individuals have a higher marginal utility of
consumption of tradeables, driven by their preference draw. Because on average individuals have
higher draws conditional on having sorted into lower wage locations, the planner has incentives to
redistribute towards those locations.

Commuting       We apply the analysis to a framework with commuting in the style of Ahlfeldt et al.
(2015) and Monte et al. (2018). We assume only one type of agent. The difference with our bench-
mark model is that now an individual l chooses the commuting pattern ji consisting of a residence
location j and a workplace i. The amenity spillovers depend on the number of residents LR
                                                                                        j , and the
productivity spillovers depend on the number of workers LW
                                                         i . The productivity
                                                                            of a commuter from
              W                                                        R
                
j to i is zi Li , and the common component of utility (5) is uji = aj Lj Uji (cji , hji ), where the
function Uji may vary by ji to capture disutility from commuting travel time.    We also
                                                                                         allow−1/σ
                                                                                                 for
                                     l                                            l
an idiosyncratic worker-level shock ji according to a Fréchet distribution, Pr ji < x = e−x      ,
so that the utility of a commuter l from j to i is uji lji . The resulting flow of commuters from j to
              u 1/σ
i is Lji = L uji      . In the market allocation, each of these commuters makes total expenditures
xji at j. Every other aspect of the model is the same as in the benchmark.



                                                  19
    We show in Appendix A.5 that the optimal transfers can be decomposed as the sum of two
types of transfers. The first component depends on the workplace,

                                                              γiP − σ ∗
                                                    tW
                                                     i =             w ,                                                (35)
                                                               1+σ i

and the second component depends on the residence,

                                                        γjA X L∗ji0 x∗ji0
                                               tR
                                                j =                       .                                             (36)
                                                       1+σ 0
                                                            i
                                                                 LR j

The optimal transfer is t∗ji = tW    R
                                i + tj − T , where T is a lump-sum transfer that adjusts for
government budget balance.22 The workplace policy tW
                                                   i is the Pigouvian tax fixing the inefficiency
in production, while the residence policy tR
                                           j isolates the role of amenity spillovers. The two policies
are additive. That is, even with commuting, the optimal transfer still varies by place rather than
by bilateral commuting pattern.23 Absent amenity spillovers (γ A = 0), the workplace transfer tW
                                                                                               i
is the only one active and takes the same form as in the benchmark model without commuting.

Spillovers Across Locations                 Recent studies such as Lucas and Rossi-Hansberg (2002) and
Rossi-Hansberg (2005) emphasize that economic activity in one location may generate spillovers in
other locations. We now derive the optimal transfers in this case. To simplify the exposition, we
consider a special case of our model with homogeneous workers and constant-elasticity spillovers
in amenities. However, we now extend our model to allow for the efficiency of location j to be an
                                                                            
arbitrary function of the number of workers in every location: zj = zj Lj 0 . This formulation
accommodates a commonly used specification where spillovers decay with distance between spatial
units.24 We define the efficiency spillover elasticity across locations,

                                                          0     ∂zj 0 Lj
                                                    γ P,j,j =            ,                                              (37)
                                                                ∂Lj zj 0

as the elasticity of the efficiency of workers at j 0 with respect to the number of workers located in
j. Following similar steps to propositions 1 and 2, the optimal transfers now are:
                                                                             0
                                         γ P,j,j + γ A       X γ P,j,j Lj 0 wj 0
                                  tj =                 w j +                     + T.                                   (38)
                                            1 − γA           0
                                                               1 − γ A Lj
                                                               j 6=j


We find as before that the optimal transfers can be characterized as a function of spillover elasticities
and outcomes such as wages and employment, regardless of micro heterogeneity in fundamentals.

   22
      These expressions assume that the returns to fixed factors Π are evenly distributed in the population.
   23
      This result abstracts from congestion in commuting, which would bring a rationale to impose tax based on
commuting patterns.
   24
      This type of spillovershas been usedto study economic activity at different spatial scales. For instance, Ahlfeldt
                                                α
                                        −δtjj 0
                                                  where tjj 0 is travel time between blocks j and j 0 within a city and δ is a
                              P
et al. (2015) assume zj 0 =      j Lj e
decay parameter, while Desmet et al. (2018) study these spillovers at a broader scale.


                                                              20
In particular, non-localized spillovers lead to the intuitive implication that the optimal transfers
should be higher in places that generate strong spillovers to larger locations, as measured by their
total wage bill.

3.6   Quantitative Implementation
   Having established the theoretical characterization of an optimal allocation, we now lay out
a methodology to bring it to the data. Doing so requires imposing functional-form assumptions,
and identifying conditions under which the quantitative methodology is well-behaved - that is,
conditions under which optimal spatial policies lead to a unique equilibrium that can therefore be
unambiguously recovered. Finally, we identify the data requirement of the procedure. We will later
implement this quantitative methodology.

Functional Forms On the demand side, we assume that preferences for traded and non-traded
goods are Cobb-Douglas:
                                         U (c, h) = cαC h1−αC ,                                    (39)

while the aggregator of traded commodities is CES,
                                                                           !     σ
                                                          X         σ−1         σ−1
                                                                     σ
                                 Q (Q1i , .., QJi ) =          Qji                      ,          (40)
                                                           i

where σ > 0 is the elasticity of substitution across products from different origins. On the supply
side, the production functions of traded and non-traded goods are
                                                1−bIY,j Y bIY,j
                         Yj NjY , IjY = zjY NjY
                                     
                                                         Ij       ,                                (41)
                                                                    1
                             H H
                                         H
                                                   I
                                                H 1−bH,j
                                                               I
                                                             H bH,j
                                                                     1+dH,j
                         Hj Nj , Ij = zj      Nj            Ij              ,                      (42)

                  n         o
where dH,j ≥ 0 and zjY , zjH are TFP shifters. Traded goods are produced under constant returns
to scale, but we allow for decreasing returns in the housing sector. The coefficient dH,j is the inverse
housing supply elasticity of location j in the market allocation, which may vary across regions. The
aggregator of labor types is CES,
                                                                          1
                                           I                                   ρi
                                           X         X             ρ i
                                    Nj =                 zjθ Lθj                  ,              (43)
                                           i=1   θ∈Θi




                                                     21
         1
where   1−ρi   > 0 is the elasticity of substitution across types of workers. Finally, we impose constant-
elasticity forms for the spillovers:

                                                                                Y       0
                                                                                             γ P0
                                       zjθ   L1j , .., LΘ               Zjθ          Lθj
                                                                                                θ ,θ
                                                                
                                                        j           =                                  ,                          (44)
                                                                                θ0
                                                                Y  0 γθA0 ,θ
                                       aθj L1j , .., LΘ       θ
                                                                   Lθj
                                                        
                                                      j   ≡ A j                .                                                  (45)
                                                                                θ0

    These functional forms are consistent with studies that estimate spillover elasticities, allowing
us to draw from existing estimates. The Zjθ capture exogenous comparative advantages in produc-
                                                                                    n         o
tion across types and Aθj capture preferences for location across types. We refer to Zjθ , Aθj as
fundamental components of productivity or amenities. Together with the assumptions on produc-
tion technologies, these functional forms impose Inada conditions, which imply that all locations
are populated in the optimal allocation if the planner’s problem is convex.

Concavity Condition             To ease the notation, we introduce the following composite elasticities of
efficiency and congestion spillovers:
                                        (                   )                                  (                          )
                                         X                                                             X
                            P
                          Γ = max                 γθP0 ,θ       , and Γ = min − A
                                                                                                                γθA0 ,θ       .
                                   θ                                                    θ
                                             θ0                                                            θ0

Also, we let D = minj {dH,j } be the lowest inverse elasticity of housing supply. Under the functional
form assumptions (39) to (45) we have the following property.

Proposition 3. The planning problem is concave if

                                                                ΓA > ΓP ,                                                         (46)

            A > 0 for θ 6= θ 0 . Under a single worker type (Θ = 1), the planning problem is
ΓA ≥ 0 and γθ,θ 0

quasi-concave if:                                                                                     
                                             A                      P
                                                                               1 − αC
                                       1−γ > 1+γ                                       + αC                .                      (47)
                                                                                1+D
    Condition (46) ensures that congestion forces are at least as large as agglomeration forces.
Specifically, the congestion from the type that generates the weakest congestion, measured by ΓA ,
dominates the agglomeration from the type that generates the strongest agglomeration, measured
by ΓP . These conditions are sufficient but not necessary for uniqueness, as the planner’s problem
can be concave outside of these strong parameter restrictions. In the case of a single type, condition
(46) simplifies to γ P + γ A < 0 ; further assuming Cobb-Douglas preferences over traded and non-
traded goods we obtain a weaker restriction that allows for spillovers to be net agglomerative
(equation (47)).    25

  25
    The CES restriction (40) on the aggregator of trade flows Q (· ) is not needed for these results. Therefore, these
condition holds regardless of product differentiation across locations. Numerical simulations confirm the intuition


                                                                    22
    Proposition 3 establishes conditions under which the market allocation is unique given the
optimal spatial policies. It extends existing uniqueness results in two dimensions. First, it comple-
ments results that characterize uniqueness of the spatial equilibrium under no policy intervention
and trade balance (Allen et al., 2014). Second, it holds in a context with heterogeneous workers and
cross-groups spillovers. We note that our uniqueness condition applies at the optimal expenditure
distribution. Multiplicity is still possible for sub-optimal policies or no policy intervention, but this
poses no limitation for our approach.

Implementation in Changes and Data Requirements                              To bring the model to the data, we
take the following steps. First, we assume that the observed data allocation is consistent with
our model. That is, it is generated by a decentralized equilibrium consistent with Definition 1,
subject to the functional form assumptions (39) to (45). Second, we solve for the planner problem
described in Section 2.4. We show in that section that, in the spirit of the exact-hat algebra
method developed by Dekle et al. (2008), this problem in levels is equivalent to a problem where
                                                                                                   x0
the endogenous variables are expressed relative to their initial value. Letting x̂ =               x,   where x is
the value of a variable in the observed equilibrium and  0
                                                      n x is the value in an alternative      o equilibrium,
                                                        ˆθ                        ˆθ       ˆθ
we solve for the changes in the endogenous variables x , P̂ , pˆ , Ŷ , Ŵ , N̂ , L , R̂ , u to maximize
                                                                 j   i   i     i   i   j   j   i

the welfare gains of one group, uˆθ , for arbitrarily chosen welfare changes of the remaining groups.
We then vary the welfare changes of the other groups to trace the utility frontier relative to the
initial equilibrium. The following proposition summarizes our approach and the corresponding data
requirements.

Proposition 4. Assume that the observed data is generated by a competitive equilibrium consistent
with Definition 1 under the functional forms (39) to (45). Then, relative to the initial equilibrium,
the optimal allocation can be fully characterized as function of:
    i) the distributions of wages, employment and expenditures across labor types and locations;
    ii) the distribution of bilateral import and export shares
                                                         n     across locations; o
    iii) the utility and production function parameters αC , σ, ρ, bIY,j , bIH,j , dH,j ; and
                                   n                o
    iv) the spillover elasticities γθA0 ,θ , γθP0 ,θ .

    This exact-hat algebra approach is convenient to take the model to the data
                                                                           n because
                                                                                o    it sidesteps
the estimation of many parameters (the city-type shifters of amenities Zjθ , Aθj , TFP shifters
n         o
 zjY , zjH , and bilateral trade costs {dij }). These parameters turn out not to appear in the formu-
lation of the model solution in changes relative to the observed equilibrium. It is important to point
out that this approach is not without limitations. First, it assumes away measurement error. This
means that the procedure implicitly calibrates a combination of the previous parameters to exactly
match the data in points i) and ii) of Proposition 4 as an equilibrium outcome of the model from
Definition 1. Second, these parameters are treated as exogenous fundamentals which are invariant

that the amount of product differentiation between regions governed by the aggregator Q(.) helps make the planner’s
problem concave.


                                                        23
between equilibria. Therefore, this approach ignores the possibility that some of these parameters
could change in response to reallocation of workers.
     Importantly, the quantitative implementation laid out in Proposition 4 does not impose restric-
tions on the distributional policies across locations in the observed equilibrium. The net transfers
that generate the expenditure distribution xθj exactly match those in the data. In particular, they
are not constrained to match a specific tax rule. Nor do we impose that the observed allocation is
inefficient: the efficiency of the observed allocation depends on whether the distribution of expen-
ditures lines up with condition (22) in Proposition 1. It could be that the transfers in place are
such that the empirical relationship between expenditures, wages and employment is not far from
that relationship, in which case our implementation of the planner’s problem would predict small
welfare gains from implementing optimal policies.


4        Data and Calibration
     To take the model to the data, we use as an empirical setting the distribution of economic
activity across Metropolitan Statistical Areas (MSAs) in the United States in the year 2007. We
identify worker types θ with observable skill groups. Specifically, following Diamond (2016), our
benchmark analysis studies the spatial allocation of two skill groups, high skill (college) and low
skill (non college) workers. Because of data limitations, our analysis abstracts from more detailed
definitions of skill types.26

4.1      Data
     As established in point i) of Proposition 4, we need data on income and expenditures by group
and MSA. To that end, we rely on the BEA’s Regional Accounts, which report labor income, capital
income and welfare transfers by MSA. A complementary BEA dataset for the years 2000 to 2007
reports total taxes paid by individuals and MSA (Dunbar, 2009). Taken together, these sources
give us a dataset at the MSA level. We then apportion each of these MSA-level totals into two
labor groups: high skill, defined as workers who have completed at least four years of college, and
low skill, defined as every other working age individual. To implement this apportionment, we use
shares of labor income, capital income transfers corresponding to each group in each MSA from
the American Community Survey (IPUMS-ACS, Ruggles et al. (2017)) collected by the Census,
and use shares of taxes for each group in each MSA from the March supplement of the Current
Population Survey (IPUMS-CPS, Flood et al., 2017) . Our dataset covers 209 MSAs for which we
have both BEA and Census information.27
     The model accommodates an arbitrary number of finely defined skill types θ. When going to
the data, to implement the analysis we reduce the number of types to only two groups defined by
    26
      See Baum-Snow and Pavan (2013) and Roca and Puga (2017) for evidence on the role of heterogeneity within
observable types in accounting for wage dispersion and sorting.
   27
      These areas correspond to 95% of the population and 96% of income of all US metropolitan areas. Metropolitan
areas in the US in turn cover 78% of the population, and 83% of personal income.


                                                       24
education. Having made this choice, an important concern when measuring these variables is that
the model does not include heterogeneity across individuals within each group of skill θ, whereas in
reality these groups are heterogeneous across cities. If we did not control for this heterogeneity, our
procedure to implement the model would interpret the observed variation in net individual transfers
across MSAs within a group as place-based transfers, when they reflect, in part, differences in the
types of workers within each group across MSAs. In principle, this concern can be mitigated by
allowing for several θ groups corresponding to the fine individual characteristics observed in the
ACS. While potentially feasible, such an approach would increase the dimension of the problem
and the number of elasticities to calibrate. Alternatively, we choose to purge the observed measures
of income, expenditure, taxes and transfers by skill and MSA from compositional effects using a
set of socio-demographic controls at the MSA-group level built from individual level Census data
(IPUMS) on age, educational attainment, sector of activity, race, and labor force participation
status of individuals in a given MSA-group. In the quantification we then use measures of income,
expenditures, taxes and transfers that are net of variation in socio-demographic composition within
groups across MSAs. We discuss the details of this step in Online Appendix B.
    We use the variables above to construct expenditure per capita, xθi , using its definition (19) as
labor plus capital income net of taxes and transfers, which also corresponds to the BEA’s definition
of disposable income. In the model we assume no variation in capital income across cities for each
type. Therefore, we use a group-specific measure of capital income consistent with the fact that
52% of non-labor income is owned by high skill workers according to the BEA/ACS data.28
    As implied by ii) of Proposition 4, quantifying the model also requires data on trade flows
between MSAs. The Commodity Flow Survey (CFS) reports the flow of manufacturing goods
shipped between CFS zones in the US every five years. The CFS zones correspond to larger
geographic units than our unit of observation, the MSA. To overcome this data limitation, we
adapt the approach in Allen and Arkolakis (2014), who use estimates of trade frictions as function
of geography to project CFS-level flows to the MSA level. In our context, we use the gravity
equation predicted by the model to find the unique estimates of trade flows between MSAs that are
consistent with actual distance between MSAs, existing estimates of trade frictions with respect to
distance, and observed trade imbalances, computed as the difference between income in the traded
sector and expenditure on traded goods (for both final and intermediate use) in each MSA.
    Finally, to calibrate the labor shares in production in part iii) of Proposition 4, we use ACS
data on employment in traded and non-traded sectors by MSA.29 We also adjust this measure to
remove variation from compositional effects following a similar approach to the one described above
for income, expenditure, taxes and transfers.




   28
      This step involves setting a national share of profits in GDP consistent with the general equilibrium of the model.
See Online Appendix B for details.
   29
      We define employment in the following NAICS sectors as corresponding to the non-traded sector in the model:
retail, real estate, construction, education, health, entertainment, hotels and restaurants.


                                                           25
4.2    Calibration
    Our model is consistent with Diamond (2016) and generates similar estimating equations to
those used in her analysis. We use the same definition of geographic units (MSA) and skill groups
(College and Non College), and we rely on similar data sources for quantification. Therefore, her
estimates constitute a natural benchmark to parametrize the model. In what follows, we discuss
these elasticities and several alternative specifications that are also used in the quantitative section.
                                                                n                                o
Utility and Production Function Parameters                       αC , σ, ρ, bIY,j , bIH,j , dH,j   We use the Dia-
mond (2016) estimate of the Cobb-Douglas share of traded goods in expenditure (αC = 0.38), of
the inverse housing supply elasticity (dH,j in (42)) for each MSA, and of the elasticity of substitution
between high and low skill, estimated at 1.6 and implying ρ = 0.392.30
    We calibrate the Cobb-Douglas share of intermediates in traded good production (bIY,j = 0.468
for all j in (41)) using the share of material intermediates in all private good industries production
in 2007 from the U.S. KLEMS data. Having calibrated the previous parameters, the Cobb-Douglas
share of labor in non-traded production in each city (1 − bH,j in (42)) can be chosen to match the
share of workers in the non-traded sector of each MSA, as detailed in Section B.2. We assume an
elasticity of substitution σ among traded varieties in (40) equal to 5, corresponding to a central
value of the estimates reported by Head and Mayer (2014).
                             n        o
Efficiency Spillovers         γθP0 ,θ   Previous empirical studies, such as Ciccone and Hall (1996),
Combes et al. (2008), and Kline and Moretti (2014a), estimate elasticities of labor productivity with
respect to employment density. Across specifications, these studies find elasticities in the range of
(0.02, 0.2).31 Hence, we set a a properly weighted average of the elasticities γθP0 ,θ , corresponding to
what the empirical specifications of these previous studies would recover in data generated by our
model, to match the benchmark value for the U.S. economy of 0.06 from Ciccone and Hall (1996).
In addition, Diamond (2016) estimates an elasticity of MSA wages with respect to population by
skill group. As detailed in Online Appendix B.2, under the previous normalization, these estimates
                                             P parameters using the wage equation (17) and the
can be mapped to the relative values of our γθ,θ 0

elasticity of substitution between skilled and unskilled workers ρ.
    As a result we obtain γUP U , γSU
                                   P , γP , γP
                                               
                                         U S SS = (.003, .044, .02, .053). This approach preserves
an aggregate elasticity of labor productivity with respect to density that is consistent with standard
estimates. It is also consistent with the cross-spillover elasticities implied by Diamond (2016), who
recovers there cross-spillovers from the elasticity of city-level wages by skill group with respect to
the supply of workers of each skill. These parameters imply stronger efficiency spillovers generated
by high skill workers, and close to zero spillovers from low skill workers.32

  30
     For MSAs that we cannot match to Diamond (2016) we use the average housing supply elasticity across MSAs.
  31
     Most of the studies reviewed by Combes and Gobillon (2015) and Melo et al. (2009) also fall in this range.
  32
     Micro studies of peer effects note that policies designed to implement an optimal mixing of heterogeneous workers
may deliver undesired outcomes due to endogenous group formation decisions after the policy is implemented (e.g.,
Carrell et al., 2013). Our city-level analysis abstracts from these considerations.


                                                         26
                  n        o
Amenity Spillovers γθA0 ,θ   Diamond (2016) estimates elasticities of labor supply by skill group
with respect to an MSA-level amenity index that includes congestion in transport, crime, environ-
mental indicators, supply per capita of different public services, and variety of retail stores. She
estimates a higher marginal valuation for these amenities for college than for non-college work-
ers. In addition, she estimates a positive elasticity for the supply of this MSA-level amenity
index with respect to the relative supply of college workers. As detailed in Online Appendix
B.2, we can combine these estimates and map them to our amenity spillovers γθA0 ,θ using the
labor-supply equation implied by the spatial mobility constraint (14). As a result we obtain
 γUAU , γSU
         A , γA , γA
                     
              U S SS = (−.43, .18, −1.24, .77). These parameters imply strong positive amenity
spillovers generated by high skill workers and negative spillovers generated by low skill workers.33

Alternative Parametrizations of the Spillover Elasticities We implement all our coun-
terfactuals under different parametrizations of the spillover elasticities. The alternatives deviate
from the benchmark described so far in terms of the efficiency or amenity spillover elasticities.
In particular, we implement the model under: i) a more conservative parametrization that scales
                                         A by 50% (referred to as the “Low amenity spillover”
down the amenity spillover elasticities γθ,θ 0
                                                          A assuming values of the elasticity of
parametrization); ii) mappings of the amenity spillovers γθ,θ 0

city amenities to the share of college workers that are either one standard deviation above or be-
low Diamond (2016) point estimates (referred to “High cross amenity spillover” and “Low cross
amenity spillover” parametrizations, respectively); iii) a less conservative parametrization that
                                                 P
scales up the efficiency spillover elasticities γθ,θ 0 to 0.12, i.e., twice the benchmark of 0.06 from

Ciccone and Hall (1996) (referred to “High efficiency spillover” parametrization); iv) a more con-
servative parametrization that scales down the efficiency spillover elasticities by a factor 2 (referred
to “Low efficiency spillover” parametrization); and v) parametrizations of efficiency spillovers that
correspond to alternative values of the complementarity parameter ρ, as detailed in the Online
Appendix D.5. The values of these alternative parametrizations are reported in Online Appendix
B.2.

4.3    Stylized Facts
    Figure 1 revisits standard stylized facts on spatial disparities and sorting in the data, as well
as a relatively less known fact on the spatial structure of net transfers between cities. These facts
will serve as a benchmark to evaluate the impact of optimal spatial policies.
    Panels A to C show the standard facts about spatial disparities and sorting as function of city
size, or “urban premia”. Panel A documents the urban wage premium, defined as the increase in

    33
       At these values, all but one of the concavity conditions implied by Proposition 3 are satisfied. Specifically,
                                                                   0
the conditions that ΓA > ΓP , ΓA > 0, and γθ,θ   P
                                                   0 > 0 for θ 6= θ are all satisfied, as well as the condition that
  A                                             A
γSU > 0. However, our parametrization sets γU S < 0. In principle, therefore, concavity of the planner’s problem
is not guaranteed. However, in the quantitative exercise we check for the possibility of multiple local maxima by
repeating the welfare maximization algorithm starting from 100 spatial allocations taken at random. Reassuringly,
we fail to find any alternative local maximum.


                                                         27
                                             Figure 1: Urban Premia




                (a) Urban Wage Premium                                           (b) Sorting




                 (c) Urban Skill Premium                                     (d) Net Transfers
Note: each figure shows data across MSAs. All the city level outcomes reported on the vertical axes of panels (a) to
(c) are adjusted by socio-demographic characteristics of each city, as detailed in Online Appendix B.1.


average nominal wages with city size. The elasticity of wages to city size is 5.8%.34 Panel B shows
spatial sorting, in terms of the share of high-skill workers. The semi-elasticity of the share of high
skill workers with respect to city size is 2.5%. I.e., doubling population increases the skill share by
2.5 percentage points. Panel C shows the urban skill premium, defined as the increase in the ratio
of high- to low-skill wage as city size increases. The slope of 0.03 means that larger cities feature
a more unequal nominal wage distribution. The first fact suggests differences in productivity and
cost of living across cities, while the last two suggest complementarities between city size and skill.
    Panel D shows a somewhat less known fact, the relationship between city size and net imbal-
ances. For each city we construct the net imbalance as the difference between expenditures and
total income (from labor and non-labor sources). The graph shows net imbalance relative to la-

   34
      This elasticity includes the composition effect due to a higher share of high skill workers in larger cities. Con-
trolling for composition, the elasticity is 3.2%.


                                                          28
bor income at the MSA level across MSAs. Given our construction of the expenditure variable,
these differences in imbalances across cities result purely from the government policies that we
measure (taxes and transfers). The negative slope reflects that government policies redistribute in-
come from larger, high wage, high skill cities to smaller, low wage, low skill cities. These transfers
are net of compositional effects according to detailed demographic characteristics in IPUMS, as
mentioned above. Therefore, distributive government policies that vary with these characteristics
across individuals do not underlie these patterns across cities.


5     Optimal Spatial Policies in the U.S. Economy
    With this data in hand, we use the methodology laid out in Section 3.6 to solve numerically
for optimal spatial allocations in the empirical context of the U.S. Economy. We contrast these
optimal allocations with the current spatial equilibrium of the U.S., and quantify the corresponding
welfare gains.

5.1   Optimal Transfers, Reallocations, and Welfare Gains
   To quantify an optimal allocation, we solve the planner’s problem in changes relative to the
observed equilibrium. We maximize over the change in utility of skilled workers, uˆS , subject to a
lower bound for the change in utility of unskilled worker, uˆU . Varying this lower bound traces the
Pareto frontier.

Aggregate Welfare Gains          The left panel of Figure 2 shows the utility frontier of the U.S. econ-
omy in the benchmark parametrization, expressed in changes relative to the observed equilibrium.
The point (1,1) represented with a red diamond corresponds to allocations where the welfare of
skilled and unskilled workers is unchanged compared to the calibrated equilibrium. When the wel-
fare gain of unskilled and skilled workers is restricted to be the same, optimal transfers lead to a 4%
welfare gain for both types of workers. When only the welfare of one group is maximized subject
to a constant level of welfare for the other group, we find gains of 9.4% for high skill workers and
of 7.1% for low skill workers.
    The right panel of Figure 2 shows the utility frontier for the benchmark and for each of the
alternative parametrizations discussed in Section 4.2. The frontier shifts up and down with little
change in slope. The welfare gains from implementing optimal policies are larger in the two frontiers
in red, corresponding to high efficiency and amenity spillovers. The gains are lower with low
amenity spillovers. Table 1 shows the welfare gains corresponding to the intersection between these
frontiers and the 45 degree line, such that skilled and unskilled workers gain the same. Across these
specifications, the common welfare gains range from roughly 2% to 6%. Lowering the amenity
spillover by 50% brings the common welfare gain down to 2.8%, while multiplying the efficiency
spillovers by 2 increases the gain to 4.3%.



                                                  29
        Figure 2: Utility Frontier of the U.S. Economy between High and Low Skill Workers
          (a) Benchmark                                            (b) Alternative Parametrizations




                                                      
The figure shows the optimal welfare changes uˆL , uˆH between the optimal and observed allocation, corresponding
to the solution of the planner’s problem in relative changes described in Appendix A.7. Each point corresponds to
a maximization of uˆH subject to a different lower bound on uˆL . The benchmark parametrization on the left panel
corresponds to the black line on the right panel. The circles in the right panel represent intersections with the 45
degree line where the welfare of skilled and unskilled workers increase by the same amount.


    Hence, we find sizable welfare gains from the optimal spatial reallocation. Inefficiencies in
sorting are a key driver of this magnitude. With homogeneous workers, the welfare gains from
implementing the optimal allocation are negligible at 0.06%. Similarly, implementing the analysis
on counterfactual data without differences across skill groups (with no spatial sorting by skill,
no urban skill premium, and no relative differences in expenditures), the welfare gains fall to
0.25%.35 Accounting for skill heterogeneity is therefore important for the aggregate welfare effects
of spatial policies. Our results also suggest significantly higher welfare gains compared to estimates
of removing dispersion in spatial polices or other spatial wedges in the U.S.36




   35
      Figure A.3 in Online Appendix D.1 shows that, assuming homogeneous workers, the observed transfers across
MSAs in the optimal allocation are quite close the data. Figure A.4 shows that the welfare gains can be substantial
under counterfactual data with high wage dispersion. Section D.1 in the online appendix describes the details of the
calibration with homogeneous workers.
   36
      Desmet and Rossi-Hansberg (2013) find welfare gains of 0.9% from eliminating frictions across U.S. cities, Albouy
(2009) finds losses of 0.2% from the tax dispersion created by federal income taxes, and Fajgelbaum et al. (2018)
find gains of of 0.6% from harmonizing state taxes. The small welfare gains to optimal reallocation without worker
heterogeneity are in line with results in Eeckhout and Guner (2017) and Ossa (2018).


                                                          30
                       Table 1: Welfare gains under different levels of the spillovers

                                            Spillovers                 Welfare Gain (%)
                             (1)           Benchmark                          4.0
                             (2)     High efficiency spillover                4.3
                             (3)     Low efficiency spillover                 3.9
                             (4)      Low amenity spillover                   2.8
                             (5)   High cross-amenity spillover               5.6
                             (6)   Low cross-amenity spillover                3.1
                             (7)   Lower production elasticity              2.4-3.9
The table reports the common welfare gains for skilled and unskilled workers under alternative parametrizations
described in Section 4.2. Row (2) corresponds to γθP0 θ that are twice as large as in the benchmark. Row (3) corresponds
to γθP0 θ 50% lower than the benchmark. Row (4) corresponds to γθA0 ,θ 50% lower than the benchmark. Rows (5) and
(6) are configurations assuming higher or lower cross-amenity spillovers corresponding to the plus or less one standard
deviation of the estimates in Diamond (2016). See Online Appendix B.2 for details on these parametrizations. Row
(7) corresponds to efficiency spillovers calibrated using different values of the production function parameter ρ, as
detailed in Table A.3 in Online Appendix D.5.


Actual versus Optimal Transfers                 How does the optimal spatial income redistribution compare
to the data? Let      tθj   be the optimal transfers received by type θ according to (24) in Proposition
2. Figure 3 shows the net transfers per capita relative to wages tθj /wjθ by MSA and worker type
on the vertical axis, against the wage wjθ of each MSA in both the data (blue circles) and the
optimal allocation (red diamonds), for low skill workers (hollow markers) and high skill workers
(solid markers). We represent the optimal allocation corresponding to the point on the Pareto
frontier in the left panel of Figure 2 where welfare gains are equal for both types of workers.37
    The transfers in the data present a clear pattern of redistribution from high skill workers and
high-wage cities towards low skill workers and low-wage cities. Net average transfers are positive
for low skill workers and negative for high skill workers in most MSAs. Within skill groups, net
transfers decrease with the wage of the MSA. On average across MSAs, they equal 1.8 thousand
dollars for low-skill workers, or 12% of their average wage. For high skill workers, the corresponding
numbers are -3.8 thousand dollars or -10% of the average wage. In cities where high skill workers
earn on average more than $50k per year, net transfers of high skill workers are -8.9 thousand
dollars or -15% of wages. The observations in red show the efficient allocation, which satisfies
the optimality condition from Proposition 1. Across cities, the optimal transfers relative to labor
income decrease more steeply with wages than in the data for both labor types, implying a stronger
redistribution towards low-wage cities than what is observed empirically.38
    To understand what drives these optimal transfers, we return to the expression for optimal
subsidies (25). The first term of (25) is driven by own spillovers, while the second term is shaped

   37
      The main impact of a different Pareto weight is to shift the transfer schedules up and down depending on the
Planner’s preference for each group, without changing the qualitative patterns we discuss.
   38
      Figure A.1 in Online Appendix C plots the optimal transfer scheme against labor income. It shows that income
alone is an imperfect predictor of the optimal tax, suggesting that second-best policies based on income alone could
not perfectly replicate it. Characterizing second best policies in our framework is an interesting avenue left for future
research.


                                                           31
       Figure 3: Per Capita Transfers by Skill Level and MSA, Data and Optimal Allocation




Note: each point in the figure corresponds to an MSA-skill group combination. The vertical axis shows the difference
between the average transfer relative to wage and the horizontal axis shows the average wage. For details of how the
data is constructed see Online Appendix B. The slopes of each linear fit (with SE) are: Low Skill, Data: -0.02 (0.001);
Low Skill, Optimum: -0.095 (0.004); High Skill, Data: -0.002 (0.001); High Skill, Optimum: -0.05 (0.002). The figure
corresponds to planner’s weights such that both types of workers experience the same welfare gain in Figure 2.


by cross spillovers. In our parametrization of spillovers for low skill workers, both of these terms
are negative. The negative cross-spillovers through amenities lead to the higher tax of low skill
workers in large, high-wage cities where a larger share of expenditures accrues to high skill workers.
The logic that rationalizes a higher labor tax in high-wage cities is different for high skill workers.
In our parametrization, high skill workers generate positive own spillovers. According to the first
term in (25), these positive spillovers would call for a labor income subsidy. However, this force
is more than offset by strong positive cross spillovers onto low skill workers, which calls for more
mixing of high-skill workers with low-skill workers. A higher tax in high-wage cities directs skilled
workers into small, low-wage cities that are relatively abundant in low skill workers.
    While both low and high skill workers are on average reallocated towards lower-wage cities, it
is a priori ambiguous for which group this effect is stronger. We examine the question of optimal
sorting below.

Optimal Reallocation and Sorting                  The optimal transfers change the spatial distribution of
economic activity compared to the data. By changing the location incentives of workers, they affect
spatial sorting and the city size distribution. These reallocations in turn impact labor productiv-
ity and wages through agglomeration spillovers, and the distribution of urban amenities through
amenity spillovers. These effects feed back to location choices, changing the spatial pattern of skill

                                                          32
           Figure 4: Changes in Population, Skill Shares, and Skill Premium across MSAs




             (a) Change in Total Population                    (b) Change in Population by Skill Group




     (c) Histogram of High-Skill Shares across MSAs                  (d) Change in Skill Premium
Note: Panel (a) shows the change in population between the optimal allocation and the initially observed equilibrium
and the linear fit. Slope (SE): -0.16 (0.03); Rˆ2=0.15. Panel (b) displays the same outcomes for high and low skill
workers. Slopes (with SE): High Skill: -0.25 (0.03); Low Skill: -0.15 (0.03). Panel (d) displays in the vertical axis
the difference in the skill premium between the optimal and initial allocation. Slope (SE): -0.4 (0.07). The figures
correspond to planner’s weights such that both types of workers experience the same welfare gain in Figure 2.


premia and inequality. We now describe the spatial equilibrium resulting from this process. Figure
4 shows the pattern of reallocation. First, Panel (a) shows the initial total population of each MSA
on the horizontal axis and the change in population implied by the optimal allocation relative to
the initial allocation on the vertical axis, defined as L̂j − 1. The stronger redistribution to low-wage
locations discussed in the previous section implies that, on average, there is reallocation from large
to small cities. However, there is also considerable heterogeneity in growth rates over the size
distribution, including middle- and small-MSAs that shrink alongside large MSA’s that grow, so
that initial city size is a poor predictor of whether a city is too large or too small in the observed




                                                         33
allocation (the R2 of the linear regression is 15%).39
    Even though the tax changes are large, only 11% of the population is reallocated to reach the
optimum. When moving to the optimal allocation, a regression of population changes on the change
in the net-of-tax rate (i.e., one minus the tax rate) across locations yields an elasticity of 1.2.40
    Second, panels (b) and (c) illustrate changes in sorting patterns. Panel (b) shows changes in
population by skill, alongside the linear fit from panel (a), while panel (c) shows the histogram of
skill shares across MSAs in the initial and optimal allocation. On average, reallocations towards
initially smaller places is stronger within the high-skill group. As a result, the skill share distribution
becomes more compressed at the bottom of the distribution (panel (c)). However, the optimal
reallocations also result in more intensively high-skilled cities at the top of the distribution. These
shifts reflects that the share of high-skill workers grows both in cities with initially very low skill
share and in some large cities with very high skill share.41
    At the same time, we find in panel (d) that the skill premium tends to increase in initially less
unequal cities, which tend to be smaller cities, and to decrease in initially more unequal and larger
cities. Together with the sorting patterns described above, this result suggests that two different
mechanisms drive the optimal sorting by skill. At the bottom of the city size distribution, optimal
sorting is dominated by the positive cross-spillovers generated by high-skill workers on low-skill
workers. At the top, optimal sorting is driven by positive amenity spillovers generated by high-skill
workers on their own group. This force leads to higher skill concentration in those locations, but
also to a lower skill premium.

The Urban Premia in the Optimal Allocation Changes in the spatial allocation can be
conveniently summarized by coming back to the urban premia from Figure 1 and computing them in
the optimal allocation. We contrast them in Figure 5: each pair of linked observations corresponds
to the same MSA in the data and in the optimal allocation.42 The optimal allocation features a
higher absolute value of the imbalances at the city level (panel (d)), since redistribution to smaller
MSAs is stronger in the optimal allocation.
    The optimal allocation features a higher share of high skill workers in smaller cities (panel
(b)). At the same time, the figure shows that the initially largest MSAs shrink and become more

  39
      Albouy et al. (2019) and Eeckhout and Guner (2017) argue that large cities are too small in models with
homogeneous workers, one-dimensional heterogeneity and spillover elasticities only.
   40
      This general-equilibrium elasticity of population to taxes implied by the model falls within the [0, 2] range
corresponding to the quasi-experimental estimates of migration responses to taxes summarized by Kleven et al.
(2019). This literature estimates an elasticity of migration to taxes that does not account for general-equilibrium
outcomes. Our quantification relies in part on the labor supply elasticity estimated by Diamond (2016), who estimates
an elasticity of migration to wage changes (rather than taxes) of approximately 2 and 4 for college and non-college
workers, respectively.
   41
      This pattern is illustrated in Figure A.2 in Online Appendix C. Weighting by initial population MSA, the
relationship between initial skill share and optimal growth in the skill share is U-shaped.
   42
      Here, we compare the data to an optimal allocation corresponding to the same welfare gains to all workers.
The patterns of urban premia are almost identical as we move to extreme points of the utility frontier, because these
points are implemented through lump-sum transfers across types which have small effects on the urban premia. These
patterns are also similar under alternative parametrizations of the spillovers from Table 1.


                                                         34
skill-intensive. Specifically, 8 of the 10 initially largest cities increase their skill share.43 The urban
skill premium vanishes (panel (c)), implying that the sorting pattern from panel (b) ends up being
detached from the urban skill premium. Instead, it is driven by stronger preferences for urban
amenities among high skill workers. As seen in panel (a), the wage premium in the large cities
is still noticeable, but lower than in the data. It is driven by an average productivity advantage
across both skill groups in larger cities, rather than by a relatively higher productivity of high-skill
workers in these places.
    In sum, in the optimal allocation the urban premia are weakened: larger cities feature relatively
lower average wages, share of skilled workers, and skill premium compared to the data.

                         Figure 5: Urban Premia, Data and Optimal Allocation
               (a) Urban Wage Premium                                        (b) Sorting




                (c) Urban Skill Premium                                   (d) Net Transfers




Note: each panel reports outcomes across MSAs in the data and in the optimal allocation. Each linked pair of
observations corresponds to the same MSA.

  43
     If the top 10 cities are excluded, the relationship between the share of high-skill workers and MSA population
in the optimal allocation becomes flat.


                                                        35
                Figure 6: Optimal Population Reallocation and Change in Skill Share
                                            (a) Population




                                            (b) Skill Share




The maps show the growth in population (top panel) and share of college workers (bottom panel) from the observed
to the optimal allocation. Cities are weighted by initial population. Red means positive growth and blue is negative
growth.


Regional Patterns Figure 6 shows the growth in population (left panel) and skill shares (right).
Cities are weighted by initial population, with darker red circles representing more positive growth.
As the economy moves to the optimal allocation, population tends to be reallocated away from
coastal regions. For example, in California cities like Los Angeles and San Francisco lose population
while smaller cities inland next to them grow. In terms of the skill shares, the 5 largest MSA’s (New
York, Los Angeles, Chicago, Dallas, and Philadelphia) as well as some other large MSA’s (such as
Washington, Boston and San Francisco) become more skill intensive despite losing population. In
these MSA’s the skill premium falls, reflecting the higher preferences of high-skill workers for those
locations. A few large MSA’s (such as Miami, Atlanta, and Detroit) shrink both in terms of overall
population and the skill share. Many small cities grow in their skill share, ultimately driving down
the urban skill share in Panel (b) of Figure 5.

                                                        36
5.2         Inferring the Spillover Elasticities assuming Efficiency in the Data
    Our logic so far was to discipline the model with existing estimates of the spillover elasticities,
and then use it to compute the efficient allocation. We now invert this logic, and instead ask:
what spillover elasticities would be consistent with assuming that the observed spatial allocation is
efficient? By comparing these inferred spillover elasticities with those used in the calibration, this
exercise allows us to identify the key elasticities behind our results.
    Proposition 4 establishes that any observed allocation can be rationalized as an equilibrium
from the model. However, nothing guarantees that an observed allocation can be rationalized as
an efficient equilibrium for some set of spillover elasticities. Therefore, for this exercise, we have to
make further assumptions. First, we assume that there is measurement error in the data. Second,
we assume that the elasticities are constant. Assuming that the observed allocation is optimal, the
condition on optimal transfers (24) must hold. Combined with the definition of expenditure per
worker in (19), we obtain the following optimal relationship between transfers, wages, expenditures,
and employment:
                                                      0         0                    0         0
                                                   wjθ 6=θ Lθj 6=θ               xθj 6=θ Lθj 6=θ
                                                                     !                             !
                       tθj = aθ0 + aθ1 wjθ + aθ2                         + aθ3                         + εθj ,            (48)
                                                          Lθj                            Lθj

for θ ∈ {U, S}, where εθj is a measurement error term, and the reduced-form parameters have
                                                                                 θ                 γ P +γ A      γP   0
the following structural interpretations: aθ0 ≡ −bθ Π∗ − 1−γ  E      θ
                                                                A , a1 ≡
                                                                          θ,θ
                                                                              A
                                                                               θ,θ
                                                                          1−γθ,θ
                                                                                   , aθ2 ≡ 1−γ
                                                                                             θ,θ
                                                                                               A , and
                                                                θ,θ                            θ,θ
        A
       γθ,θ 0
aθ3 = 1−γ
                                           θ
          A . We estimate the parameters   ai by running (48) as a regression in the cross-section,
          θ,θ                            n             o
                                            A , γP
and then infer the spillover elasticities γθ,θ           up to a normalization for each type.44 We
                                               0 θ,θ 0

normalize the own-spillover elasticity for productivity to the benchmark level for the U.S. used in
Section 4.2.
    This exercise yields γUAU , γSU
                                 A , γA , γA                                 P      P     P      P
                                             
                                      U S SS = (−.09, −.16, .06, −.32) and (γU U , γSU , γU S , γSS ) =
(.003, .20, . − 08, .053) .45 The average level of both types of spillovers is similar to the parameters
implied by the empirical estimates used in the calibration. In both these inferred elasticities and the
calibrated ones, the amenity spillovers are larger than the agglomeration spillovers, and high-skill
workers generate stronger efficiency spillovers than low-skill workers. However, the assumption that
the observed allocation is optimal implies negative amenity spillovers both across and within skill
groups, whereas the calibrated elasticities imply positive amenity spillovers generated by high skilled
workers. Therefore, heterogeneity in the sign of spillovers across groups plays an important role in
   44
     This normalization is needed because from (48) the own-spillover elasticities for productivity and amenities are
                                                    P                                                             A
not separately identified. Assuming values for γθ,θ     we can then infer the remaining elasticities as follows: γθ,θ =
 θ   P
a1 −γθ,θ    P       θ      A
                                     A       θ       A
                                                        
 1+aθ
         , γθ,θ0 = a2 1 − γθ,θ , and γθ,θ0 = a3 1 − γθ,θ .
        1
   45
     The regressions have an R-squared of 0.32 for high skill and of 0.15 for low skill. Therefore, the first-order
conditions of the planner are not exactly satisfied in the data even after choosing the revealed-optimal elasticities
that best fit (48). However, when we use these revealed-optimal elasticities to compute the efficient allocation relative
to the observed allocation, we obtain negligible welfare gains of 0.07%. Hence, the procedure confirms that, under
the revealed-optimal elasticities, the observed allocation is very close to optimal.


                                                                37
shaping optimal policies. This result is consistent with our previous finding that heterogeneity in
spillovers between groups matters, obtained from the contrast between the quantified model under
homogeneous and heterogeneous workers.

5.3   Alternative Specifications
   To gauge the sensitivity of our findings, we now turn to implementing the calibration and
counterfactuals for alternative specifications. Each of these cases formally extend our benchmark
quantification. We re-calibrate the model each time, compute the welfare gain common to all
workers on the utility frontier, and compare it to the benchmark case. We defer the details of the
implementation to the online appendix.

Land Use Regulations        Several papers (Bunten, 2017; Herkenhoff et al., 2018; Hsieh and Moretti,
2019; Parkhomenko, 2018) argue that local land use regulations create spatial distortions by low-
ering the housing supply elasticity. In our benchmark procedure, we have interpreted the housing
supply elasticity as a technological restriction in the planner’s problem. We now extend the model
to capture the notion that the housing supply elasticity can be endogenous to local regulations,
and to allow the federal planner to change these regulations. We model land use regulations as a
local tax rate imposed on the sales of non-traded goods in each city j:

                                               1
                                      1−             (Rj Hj )−τH,j                              (49)
                                            1 − τH,j

As a result, the housing supply elasticity becomes:

                                          ∂ ln Hj    1 − τH,j
                                                  =             .                               (50)
                                          ∂ ln Rj   dH,j + τH,j

This specification microfounds a housing supply elasticity that includes both a technology constraint
dH,j due geographic characteristics as in Saiz (2010) as well as land regulations τH,j as in the
previous papers. The higher the parameter τH,j , the lower the housing supply elasticity compared
to its undistorted level. Our benchmark parametrization is nested when τH,j = 0 for all locations,
in which case there is a zero tax rate.
   We evaluate the welfare effects of two policy exercises: (i) implementing optimal transfers while
keeping local taxes τH,j unchanged (τ̂H,j = 1); and (ii) implementing optimal transfers while at the
same time removing distortions (τ̂H,j = 0). The first exercise asks whether accounting for wedges
in the initial allocation due to land regulations matters for the welfare gains from implementing
optimal transfers designed to deal with spillovers. In turn, by construction, the second exercise
must deliver greater gains than implementing optimal transfers alone.




                                                    38
    Table 2: Welfare gains of Implementing Optimal Transfers under alternative specifications

                                             Cases                                  Welfare Gain (%)
                    (1)    Benchmark                                                       4.0
                    (2)    Land Regulations, keeping distortions                           3.7
                    (3)    Land Regulations, removing distortions                          8.6
                    (4)    Three skill groups                                              3.9
                    (5)    Imperfect Mobility                                              4.3
Note: The table shows the welfare gains from implementing the optimal transfers in different parametrizations. We
report the common welfare gains to all workers on the utility frontier. See the online appendix for details.


    The results are presented in rows (2) and (3) of Table 2. Implementing optimal transfers while
keeping the initial distortions lowers the welfare gains to 3.7% from 4.0%. Hence, accounting for
land regulations does not fundamentally affect the gains from optimal redistribution. However,
row (3) shows that removing land distortions on top of implementing optimal transfers more than
doubles the welfare gains compared to leaving local regulations unchanged. This result suggests
that both margins (optimal redistribution, and land use regulations) are roughly equally important
sources of misallocation.46

Multiple Skills with Non-Homothetic Production The benchmark calibration features two
skill groups (college and non-college graduates). We now implement an extension with three skill
groups. Instead of the aggregator (43) applied to unskilled and skilled workers, we model three skill
groups indexed by their ability, θ = {L, M, H} standing for low-, medium-, and high-skill workers.
Their output is aggregated to the city level according to:
                                                     ρ               ρ λ              ρ
                                 Nj =        zjL LL
                                                  j        + zjH LH
                                                                  j            + zjM LM
                                                                                      j        .                    (51)

This production function follows Eeckhout et al. (2014), who propose this nesting to capture that
larger cities disproportionally attract both high- and low-skill workers, while smaller cities feature
relatively more medium-skill workers. Assuming λ > 1, this production function is non-homothetic
between the medium-skill workers and the nest of low and high-skill workers. Hence, as production
increases, the relative demand for the second group increases. Empirically, we define high skilled
workers H in the same way as the skilled workers in our two-groups case, but split our previous group
of unskilled workers (without complete college) into those with some college education (M ) and
those with no college education (L). We continue to assume the same structure for the spillovers
as in our benchmark case, on the basis of U = {L, M } and S = {H} types.As shown in row

   46
     In terms of optimal city sizes, in the counterfactual that removes the wedges in addition to implementing
optimal transfers we find that larger cities grow relative to small cities, reverting the pattern from panel (a) of Figure
4. Therefore, the positive impact of removing wedges on the growth of the largest cities more than offsets the negative
impact of the optimal transfers. In this case, the flattening of the urban wage premium and the pattern of sorting
from panels (a) and (b) of Figure 5 is even stronger due to an inflow of low-skill workers to large cities. This inflow in
turn leads to lower wages for low-skill workers in large cities, and to an increase in the urban skill premium relative
to the data.


                                                              39
(4) of Table 2 the welfare effects are very similar to the benchmark case, while Figure A.5 in
the Online Appendix shows that the patterns of transfers and reallocation are also similar. The
optimal transfers on average reallocate workers to smaller cities but even more so for skilled workers,
without a strong difference between the reallocation patterns of low- and medium-skilled workers.
This result suggests that our conclusions are robust to refining the substitution patterns between
skills in the production function. We note that, compared to the two-groups case, this extension
has only changed the production function but not the spillovers structure. It would be interesting
in future work to re-visit our analysis in a context with richer spillovers across extreme skill groups.

Imperfect Mobility            Our benchmark case assumed that workers are perfectly mobile across
regions. We now incorporate two forces to account for imperfect mobility. First, we redefine a type θ
to include not only a worker’s skill but also her region of origin o ∈ O. Workers from different origins
may vary in their preference for locations and productivity. Specifically, to account for migration
frictions, we assume that a worker may face a disutility cost from living in a place different from
her region of origin. This additional margin of heterogeneity allows the model to capture a salient
fact from the data, namely that that place of birth is a strong predictor of region of residence.
In production, we assume that workers with the same skill level are perfect substitutes regardless
of origin. Second, following our discussion in Section (3.5), we also incorporate preference draws
within types according to a Fréchet distribution with parameter σθ .47 Turning to the quantification,
we classify workers as being born in one of 5 different Census regions, and compute the welfare
gains of implementing optimal transfers taking into account heterogeneous preferences for location
of workers of different origins. As shown in Table 2, we find welfare gains across all groups of 4.3%,
close to the 4% from the baseline case. Furthermore, once aggregated by skill across origins, the
reallocation patterns are also similar to the baseline case. We conclude that the main takeaways of
the benchmark analysis are robust to incorporating this form of mobility frictions.

Other specifications We have also implemented the analysis under additional alternative as-
sumptions. First, our theoretical results imply that matching the observed expenditures distribu-
tion is relevant. Indeed, when we ignore the transfers in the data and set worker expenditures
equal to income, the welfare gains increase to 6.3% from 4% in the baseline.48 Second, we re-do
the quantification assuming that the returns to fixed factors are locally distributed to residents
of each location.49 Our theoretical discussion from Section 3.4 shows that this assumption entails
   47
      This formulation nests our benchmark specification in the case of a single origin of workers and σθ → 0. Because
we have assumed that workers are perfect substitutes in production regardless of origin, the curvature introduced by
these draws allows us to pin down the number of workers from each origin living in a given destination. Formally,
these draws introduce a notion of congestion at bilateral level. An alternative assumption leading to a similar
property would have been assume that workers of different origins are imperfect substitutes in production. Our
current specification with extreme-value draws is closer to static models capturing migration frictions such as Bryan
and Morten (2015) and Diamond (2016).
   48
      Because the transfers tend to be negative in larger cities, ignoring transfers leads to an under-estimation of the
amenity levels implied by the model in larger cities.
   49
      The weak correlation between capital income in the data and a proxy for housing profits across cities computed
as γj /(γj + 1)Xj , where Xj is total expenditure in the city from the data and γj is the housing supply elasticity in


                                                          40
an additional distortion. Consistent with this result, we find that the common welfare gains of
implementing optimal expenditures increases to 4.9% relative to 4% in the baseline. Finally, the
welfare results are quantitatively very close to the baseline if we assume away trade costs. In this
case, we use counterfactual data in which expenditure shares are equally distributed across cities
of origin, rather than relying on bilateral trade shares that decay with distance as in our baseline
quantification. The reason why the welfare implications of both quantifications are very similar
is that the procedure fully recalibrates the model (including amenities and productivity), so that
wages, transfers and employment are perfectly matched in all cities in both cases. These moments
play a key role in pinning down the potential welfare gains of moving to an efficient allocation.


6     Conclusion
    We study optimal policies in a spatial framework with spillovers and sorting of heterogeneous
workers. The framework accommodates many key determinants of the spatial distribution of eco-
nomic activity such as geographic frictions and asymmetric amenity and productivity spillovers
across workers.
    We derive the set of optimal transfers across workers and regions. There exists scope for welfare-
enhancing spatial policies even when spillovers are common across locations. In that case, constant
labor income subsidies and lump-sum transfers over space implement the efficient allocation, re-
gardless of micro heterogeneity in fundamentals. When workers are heterogeneous and there are
spillovers across different types of workers, spatial efficiency requires place-specific subsidies to
attain optimal sorting.
    We apply the model to the distribution of economic activity across MSAs in the U.S. using
existing estimates of the spillover elasticities. The results suggest that inefficient sorting may lead
to substantial welfare costs. Spatial efficiency calls for more redistribution to low-wage cities and
a higher share of high-skill workers in these locations. It also calls for the currently largest MSAs
to shrink and to become more skill intensive, but with lower wage inequality.
    Overall, we find that accounting for skill heterogeneity and spillovers across different types of
workers is important for the design and aggregate welfare effects of spatial policies. Our analysis
abstracted from various margins that could be important for future work. We implemented the
analysis in a closed economy, but optimal spatial policies within a country could interact with
international migration and trade. We only considered first-best policies set by a national planner
and abstracted from second-best policies or from fiscal competition between local jurisdictions.
Finally, we only considered a static model, where each worker type is fixed regardless of location.
We leave it to future work to study dynamic and long-run implications of spatial policies when
worker productivity or tastes can change over time through skill formation or as a function of the
skill mix in the community.

city j, suggests that the assumption of common ownership is a reasonable benchmark. Other assumptions on the
distribution of profits with some degree of local ownership generate an inefficiency. Results are formally equivalent
under local ownership and in a model with absentee landlords where the planner maximizes welfare of workers.


                                                         41
References
Abdel-Rahman, H. and M. Fujita (1990). Product variety, marshallian externalities, and city sizes. Journal
  of regional science 30 (2), 165–183.
Abdel-Rahman, H. M. and A. Anas (2004). Theories of systems of cities. Handbook of regional and urban
  economics 4, 2293–2339.
Ahlfeldt, G. M., S. J. Redding, D. M. Sturm, and N. Wolf (2015). The economics of density: Evidence from
  the berlin wall. Econometrica 83 (6), 2127–2189.
Albouy, D. (2009). The unequal geographic burden of federal taxation. Journal of Political Economy 117 (4),
  635–667.
Albouy, D. (2012). Evaluating the efficiency and equity of federal fiscal equalization. Journal of Public
  Economics 96 (9-10), 824–839.
Albouy, D., K. Behrens, F. Robert-Nicoud, and N. Seegert (2019). The optimal distribution of population
  across cities. Journal of Urban Economics 110, 102–113.
Allen, T. and C. Arkolakis (2014). Trade and the topography of the spatial economy. Quarterly Journal of
  Economics 1085, 1139.
Allen, T., C. Arkolakis, and X. Li (2015). Optimal city structure. Yale University, mimeograph.
Allen, T., C. Arkolakis, and Y. Takahashi (2014). Universal gravity. Technical report, National Bureau of
  Economic Research.
Arnott, R. (2004). Does the henry george theorem provide a practical guide to optimal city size? American
  Journal of Economics and Sociology 63 (5), 1057–1090.
Baum-Snow, N. and R. Pavan (2013). Inequality and city size. Review of Economics and Statistics 95 (5),
  1535–1548.
Behrens, K., G. Duranton, and F. Robert-Nicoud (2014). Productive cities: Sorting, selection, and agglom-
  eration. Journal of Political Economy 122 (3), 507–553.
Behrens, K. and F. Robert-Nicoud (2015). Agglomeration theory with heterogeneous agents. In Handbook
  of regional and urban economics, Volume 5, pp. 171–245. Elsevier.
Bhagwati, J. and H. G. Johnson (1960). Notes on some controversies in the theory of international trade.
  The Economic Journal 70 (277), 74–93.
Bryan, G. and M. Morten (2015). Economic development and the spatial allocation of labor: Evidence from
  indonesia. Manuscript, London School of Economics and Stanford University, 1671–1748.
Bunten, D. (2017). Is the rent too high? aggregate implications of local land-use regulation.
Busso, M., J. Gregory, and P. Kline (2013). Assessing the incidence and efficiency of a prominent place based
  policy. American Economic Review 103 (2), 897–947.
Caliendo, L., F. Parro, E. Rossi-Hansberg, and P.-D. Sarte (2018). The impact of regional and sectoral
  productivity changes on the us economy. Review of Economic Studies 85, 2042–2096.
Carrell, S. E., B. I. Sacerdote, and J. E. West (2013). From natural variation to optimal policy? the
  importance of endogenous peer group formation. Econometrica 81 (3), 855–882.
Ciccone, A. and R. E. Hall (1996). Productivity and the density of economic activity. The American
  Economic Review , 54–70.
Combes, P.-P. (2011). The empirics of economic geography: how to draw policy implications? Review of
  World Economics 147 (3), 567–592.
Combes, P.-P., G. Duranton, and L. Gobillon (2008). Spatial wage disparities: Sorting matters! Journal of
  Urban Economics 63 (2), 723–742.

                                                     42
Combes, P.-P. and L. Gobillon (2015). The empirics of agglomeration economies. In Handbook of regional
  and urban economics, Volume 5, pp. 247–348. Elsevier.
Davis, D. R. and J. I. Dingel (2012). A spatial knowledge economy. Technical report, National Bureau of
  Economic Research.
Dekle, R., J. Eaton, and S. Kortum (2008). Global rebalancing with gravity: Measuring the burden of
  adjustment. Technical Report 3, International Monetary Fund.
Desmet, K., D. K. Nagy, and E. Rossi-Hansberg (2018). The geography of development. Journal of Political
  Economy 126 (3), 903–983.
Desmet, K. and E. Rossi-Hansberg (2013).        Urban accounting and welfare.       American Economic Re-
  view 103 (6), 2296–2327.
Desmet, K. and E. Rossi-Hansberg (2014). Spatial development. American Economic Review 104 (4), 1211–
  43.
Diamond, R. (2016). The determinants and welfare implications of us workers’ diverging location choices by
  skill: 1980–2000. The American Economic Review 106 (3), 479–524.
Dixit, A. (1985). Tax policy in open economies. Handbook of public economics 1, 313–374.
Dunbar, A. E. (2009). Metropolitan area disposable personal income: Methodology and results for 2001-2007.
Duranton, G. and D. Puga (2004). Micro-foundations of urban agglomeration economies. In Handbook of
  regional and urban economics, Volume 4, pp. 2063–2117. Elsevier.
Duranton, G. and A. J. Venables (2018). Pace-based policies for development. Technical report, National
  Bureau of Economic Research.
Eeckhout, J. and N. Guner (2017). Optimal spatial taxation: Are big cities too small?
Eeckhout, J., R. Pinheiro, and K. Schmidheiny (2014). Spatial sorting. Journal of Political Economy 122 (3),
  554–620.
Fajgelbaum, P. D., E. Morales, J. C. Suárez Serrato, and O. Zidar (2018). State taxes and spatial misallo-
  cation. The Review of Economic Studies 86 (1), 333–376.
Fajgelbaum, P. D. and E. Schaal (2017). Optimal transport networks in spatial equilibrium. Technical
  report, National Bureau of Economic Research.
Flatters, F., V. Henderson, and P. Mieszkowski (1974). Public goods, efficiency, and regional fiscal equaliza-
  tion. Journal of Public Economics 3 (2), 99–112.
Flood, S., M. King, S. Ruggles, and J. R. Warren (2017). Integrated public use microdata series, current
  population survey: Version 5.0.[dataset]. minneapolis: University of minnesota, 2017.
Gaubert, C. (2015). Firm sorting and agglomeration. University of California, Berkeley.
Glaeser, E. L. and J. D. Gottlieb (2008). The economics of place-making policies. Brookings Papers on
  Economic Activity 39 (1 (Spring)), 155–253.
Head, K. and T. Mayer (2014). Gravity equations: Workhorse, toolkit, and cookbook. Handbook of Inter-
  national Economics, Vol. 4 .
Helpman, E. (1998). The size of regions: transport and housing as factors in agglomeration. In D. Pines,
  E. Sadka, and I. Zilcha (Eds.), Topics in Public Economics, pp. 33–54. Cambridge University Press
  Cambridge.
Helpman, E. and D. Pines (1980). Optimal public investment and dispersion policy in a system of open
  cities. The American Economic Review 70 (3), 507–514.
Helsley, R. W. and W. C. Strange (2014). Coagglomeration, clusters, and the scale and composition of cities.
  Journal of Political Economy 122 (5), 1064–1093.

                                                     43
Henderson, J. V. (1974). The sizes and types of cities. The American Economic Review , 640–656.
Herkenhoff, K. F., L. E. Ohanian, and E. C. Prescott (2018). Tarnishing the golden and empire states:
  Land-use restrictions and the us economic slowdown. Journal of Monetary Economics 93, 89–109.
Hsieh, C.-T. and P. J. Klenow (2009). Misallocation and manufacturing TFP in China and India. Quarterly
  Journal of Economics 124 (4), 1403–1448.

Hsieh, C.-T. and E. Moretti (2019). Housing constraints and spatial misallocation. American Economic
  Journal: Macroeconomics 11 (2), 1–39.

Khajavirad, A., J. J. Michalek, and N. V. Sahinidis (2014). Relaxations of factorable functions with convex-
  transformable intermediates. Mathematical Programming 144 (1-2), 107–140.
Kleven, H., C. Landais, M. Muñoz, and S. Stantcheva (2019). Taxation and migration: Evidence and policy
  implications. Technical report, National Bureau of Economic Research.
Kline, P. and E. Moretti (2014a). Local economic development, agglomeration economies and the big push:
  100 years of evidence from the Tennessee Valley Authority. Quarterly Journal of Economics.
Kline, P. and E. Moretti (2014b). People, places, and public policy: Some simple welfare economics of local
  economic development programs. Annual Review of Economics 6 (1), 629–662.
Krugman, P. (1980). Scale economies, product differentiation, and the pattern of trade. American Economic
  Review , 950–959.
Lucas, R. E. and E. Rossi-Hansberg (2002). On the internal structure of cities. Econometrica 70 (4), 1445–
  1476.
Melo, P. C., D. J. Graham, and R. B. Noland (2009). A meta-analysis of estimates of urban agglomeration
 economies. Regional science and urban Economics 39 (3), 332–342.
Meyer, B., W. Mok, and J. Sullivan (2009). The under-reporting of transfers in household surveys: Its nature
 and consequences. National Bureau of Economic Research, Inc, NBER Working Papers.
Monte, F., S. J. Redding, and E. Rossi-Hansberg (2018). Commuting, migration, and local employment
 elasticities. American Economic Review 108 (12), 3855–90.
Moretti, E. (2012). The new geography of jobs. Houghton Mifflin Harcourt.
Neumark, D., H. Simpson, et al. (2015). Place-based policies. Handbook of Regional and Urban Economics 5,
  1197–1287.
Ossa, R. (2018). A quantitative analysis of subsidy competition in the us. Technical report, National Bureau
  of Economic Research.
Parkhomenko, A. (2018). The rise of housing supply regulation in the us: Local causes and aggregate
  implications. University of Southern California.
Pines, D. and E. Sadka (1986). Comparative statics analysis of a fully closed city. Journal of Urban
  Economics 20 (1), 1–20.
Redding, S. J. (2016). Goods trade, factor mobility and welfare. Journal of International Economics 101,
  148–167.
Redding, S. J. and E. A. Rossi-Hansberg (2017). Quantitative spatial economics. Annual Review of Eco-
  nomics 9 (1).
Redding, S. J. and M. A. Turner (2015). Transportation costs and the spatial organization of economic
  activity. Handbook of Regional and Urban Economics 5, 1339–1398.
Roback, J. (1982). Wages, rents, and the quality of life. Journal of Political Economy, 1257–1278.
Roca, J. D. L. and D. Puga (2017). Learning by working in big cities. The Review of Economic Studies 84 (1),
  106–142.


                                                    44
Rosen, S. (1979). Wage-based indexes of urban quality of life. Current issues in urban economics 3, 324–345.
Rossi-Hansberg, E. (2005). A spatial theory of trade. American Economic Review 95 (5), 1464–1491.
Rossi-Hansberg, E., P.-D. Sarte, and F. Schwartzman (2019). Cognitive hubs and spatial redistribution.
  Technical report, National Bureau of Economic Research.
Ruggles, S., S. Flood, R. Goeken, J. Grover, E. Meyer, J. Pacas, and M. Sobek (2017). Ipums usa: Version
  8.0 [dataset]. minneapolis, mn.
Saiz, A. (2010). The geographic determinants of housing supply. The Quarterly Journal of Economics 125 (3),
  1253–1296.
Sandmo, A. (1975). Optimal taxation in the presence of externalities. The Swedish Journal of Economics,
  86–98.
Wilson, J. D. (1986). A theory of interregional tax competition. Journal of urban Economics 19 (3), 296–315.
Zhelobodko, E., S. Kokovin, M. Parenti, and J.-F. Thisse (2012). Monopolistic competition: Beyond the
  constant elasticity of substitution. Econometrica 80 (6), 2765–2784.
Zodrow, G. R. and P. Mieszkowski (1986). Pigou, tiebout, property taxation, and the underprovision of local
  public goods. Journal of urban economics 19 (3), 356–370.



A      Proofs and Additional Derivations
A.1     Appendix to Section 2.1
    We show that (1) holds. The market allocation in the case considered in this section is defined by the following
conditions:

                                                           u = aj (Lj ) cj ,                                       (A.1)
                                                 X             X
                                                      L j cj =     Lj z j ,                                        (A.2)
                                                  j               j
                                                   X
                                                          Lj = L.                                                  (A.3)
                                                      j


The first condition says that utility is equalized, the second condition is goods market clearing, and the last condition
is labor market clearing. Solving for cj from the first condition and replacing in (A.2) we obtain the following
expression for utility:                                   P
                                                            j Lj zj (Lj )
                                                     u= P          Lj
                                                                          .                                        (A.4)
                                                              j aj (Lj )

The planner maximizes this term subject to (A.3). Totally differentiating this expression with respect to employment,
after a few manipulations we obtain:

                                                                       j a1 dLj
                                                                        P
                                              P zj dLj 
                                            P     j                 A         j
                                 û = 1 + γ     P            − 1−γ        P Lj .
                                                   j L j z j
                                                                               j aj


Further using (A.1) and (A.2) we obtain (1).




                                                             45
A.2      Appendix to Section 3.1
    We derive (21). The market allocation is the solution to the following conditions:

                                                                                        uθ = aθj cθj ,                                             (A.5)
                                                       XX                               
                                                                     Lθj        cθj − zjθ ≤ 0,                                                     (A.6)
                                                         θ       j
                                                                                  X
                                                                                         Lθj = Lθ .                                                (A.7)
                                                                                    j


Combining the first two conditions and following similar steps to Section (A.1), utility of group θ0 can be written:
                                                                                                                       0
                                                                                                          0         Lθ
                                                                         Lθj zjθ −                   uθ              j
                                                        P P                           P                       P
                                                             θ       j                    θ 0 6=θ0                j aθ 0
                                            u θ0 =
                                                                                                                     j
                                                                                           θ
                                                                                                                                                   (A.8)
                                                                                  P      Lj 0
                                                                                        j aθ0
                                                                                           j

                                                                                                              0
Taking a first order approximation to this expression while keeping uθ constant and using the mobility constraints
(A.5) we obtain:
                                                             θ0                                           θ0
                                                                                                          
                         P P θ θ dLθj          P      P dLj           P P θ θ dLθj          P       A dLj
                                L j z j      +    0 γ  0
                                                      θ ,θ Lθ 0    −         c j L j      −     0 γ  0
                                                                                                   θ ,θ Lθ 0
                 duθ0      θ  j            θ
                                          Lj    θ                        θ j            θ
                                                                                       Lj     θ
                                                            j                                            j
                   θ
                       =                                    P θ0 θ0                                            . (A.9)
                 u   0
                                                                j c j L j


which, after some manipulations, becomes:
                                      P P h                              P                                                             dLθ
                                                                                                0    0                     0   0
                                                                                                                                   i
                                                      −tθj Lθj +                 γθP0 ,θ0 Lθj zjθ + γθA0 ,θ0 cθj Lθj                      j
                            duθ0        θ      j                           θ0                                                           Lθ
                                                                                                                                         j
                                 =                                               P θ0 θ0                                                      ,   (A.10)
                            uθ0                                                    j c j Lj


where tθj ≡ cθj − zjθ is the transfer to group θ in j. Imposing no transfers (cθj = zjθ ) and using that zjθ = wjθ in a market
allocation gives the result (21).


A.3      Planning Problem and Proofs of Propositions 1 to 3
    The planning problem can be described as follows.

Definition 2. The planning problem is
                                                                          max Lθ uθ

subject to (i) the spatial mobility constraints
                                                                        
                                Lθj uθ ≤ Lθj aθj L1j , .., LΘ
                                                            j   U cθj , hθj for all j;
                                  0  0       0
                                                                        
                              Lθj uθ ≤ Lθj aθj L1j , .., LΘ  j  U cθj , hθj for all j and θ0 6= θ;

    (ii) the tradable and non-tradable goods feasibility constraints
                                             X                        
                                                 dji Qji ≤ Yj NjY , IjY for all j, i;
                                                         i
                                      X
                                            Lθj cθj   + IjY + IjH ≤ Q (Q1j , .., QJj ) for all j;
                                       θ
                                                         X                            
                                                                 Lθj hθj ≤ Hj NjH , IjH for all j;
                                                             θ




                                                                                 46
    (iii) local and national labor-market clearing,
                                                                                      
                          NjY + NjH = N z1θ L1j , .., LΘ
                                                       j   L1j , .., zjΘ L1j , .., LΘ
                                                                                    j   LΘ
                                                                                         j   for all j;
                              X θ
                                  Lj = Lθ for all θ; and
                                                  j


    (iv) non-negativity constraints on consumption, trade flows, intermediate inputs, and labor.

Proposition 1. If a competitive equilibrium is efficient, then
                                                                                                0       0         0
                                                                      dNj X xθj Lθj ∂aθj
                                                          Wj               +       θ0
                                                                                           = xθj + E θ                                      if Lθj > 0,                                (A.11)
                                                                      dLθj     0
                                                                                 a j  ∂Lθj
                                                                             θ


for all j and θ and some constants E θ . If the planner’s problem is globally concave and (A.11) holds for some
                                   
          θ
specific E , then the competitive equilibrium is efficient.

Proof. First we present the system of necessary first order conditions in the planner’s problem. Then we contrast
it with the market allocation. The Lagrangian of the planning problem is:


                                                      0                      0
                              X                                                                    0        0
                                                                                                                  
             L = uθ −                     ωjθ Lθj             uθ − aθj                L1j , .., LΘ
                                                                                                 j  U cθj , hθj
                                  j
                                              0       0           0           0
                    XX                                                                             0        0
                                                                                                                  
                −                     ωjθ Lθj                 uθ − aθj                L1j , .., LΘ
                                                                                                 j  U cθj , hθj
                    θ 0 6=θ   j
                                                                                                    !
                    X                 X                                                        
                −         p∗j                     dji Qji − Yj                    NjY   , IjY
                      j                   i
                                                                                                                          !                                                        !
                    X                 X                                                                                           X              X                               
                −         Pj∗                     Lθj cθj         +   IjY   +     IjH   − Q (Q1j , .., QJj )                  −            Rj∗           Lθj hθj          H     H
                                                                                                                                                                   − H j Nj , I j
                      j                    θ                                                                                           j             θ
                    X                                                                                                                                   
                −         Wj∗             NjY         +   NjH         −N          zj1       L1j , .., LΘ
                                                                                                       j          L1j , .., zjΘ       L1j , .., LΘ
                                                                                                                                                 j       LΘ
                                                                                                                                                          j
                      j
                                                                       !
                    X                 X
                −         Eθ                      Lθj − Lθ                  + ...                                                                                                      (A.12)
                      θ                    j


where we omit notation for the non-negativity constraints. The first-order conditions with respect to trade flows,
labor services and intermediate inputs are:

                                                                                                         ∂Q (Q1i , .., QJi )
                                                                                      [Qji ]                Pi∗              ≤ p∗j τji ,                                               (A.13)
                                                                                                              ∂Qji
                                                              h                    i                 ∂Yj               ∂Hj
                                                                  NjY , NjH                     p∗j      ≤ Wj∗ ; Rj∗         ≤ Wj∗ ,                                                   (A.14)
                                                                                                    ∂NjY              ∂NjH
                                                                       h                i                   ∂Yj             ∂Hj
                                                                           IjY , IjH                p∗j          ≤ Pj∗ ; Rj∗ H ≤ Pj∗ ,                                                 (A.15)
                                                                                                            ∂IjY            ∂Ij

each holding with equality in an interior solution. The first-order conditions with respect to individual consumption
of traded and non-traded goods can be written:
                                                              θ    θ
                                                                     
                                                      θ θ ∂U cj , hj
                                         h i
                                            θ
                                           cj      ω j aj              cθj = Pj∗ cθj
                                                             ∂cθj
                                                              θ    θ
                                                                     
                                                     θ θ ∂U cj , hj
                                        h i
                                          hjθ
                                                   ω j aj              hθj = Rj∗ hθj
                                                            ∂hθj




                                                                                                              47
Adding up the last two expressions and using degree-1 homogeneity of U gives
                                                                
                                              ωjθ aθj U cθj , hθj = xθ∗
                                                                     j ,                                                                             (A.16)

where
                                                                               ∗ θ       ∗ θ
                                                                        xθ∗
                                                                         j ≡ R j h j + P j cj .                                                      (A.17)

Therefore, we can write

                                                                                        αC cθj , hθj θ∗
                                                              h i                                   
                                                               cθj                cθj =               xj                                             (A.18)
                                                                                            Pj∗
                                                                                        1 − αC cθj , hθj θ∗
                                                          h         i                                    
                                                              hθj                 hθj =                    xj                                        (A.19)
                                                                                              Rj∗

where αC (c, h) ≡ ∂U∂c
                    (c,h)    c
                          U (c,h)
                                  is the elasticity of U with respect to c.
    Using (A.17) and the slackness condition on the spatial mobility constraint, the first-order condition of the
planning problem with respect to Lθj is:
                                                          0
                                                   ∂aθj         L1j , .., LΘ
                                                                              
                                 X        0    0                           j       0     0
                                                                                              dNj
                                       ωjθ Lθj                       θ
                                                                              U cθj , hθj + Wj∗ θ ≤ xθ∗  θ
                                                                                                     j +E ,                                          (A.20)
                                                                ∂Lj                            dLj
                                  θ0


with equality if Lθj > 0. Further using (A.16), if Lθj > 0 then:
                                                                            0 θ 0       0
                                                  dNj                 X xθ∗
                                                                         j       Lj ∂aθj
                                               Wj∗ θ                +          0           = xθ∗  θ
                                                                                              j +E .                                                 (A.21)
                                                  dLj                      aθj      ∂Lθj
                                                                      θ0


In locations with Lθj = 0 then cθj = hθj = xθ∗                 θ
                                            j = 0. Therefore, Lj = 0 for all locations such that:

                                                                                     0 θ 0      0
                                                           dNj            X xθ∗   j      Lj ∂aθj
                                                        Wj∗ θ           +             θ0        θ
                                                                                                   ≤ Eθ .                                            (A.22)
                                                           dLj                      a j     ∂L  j
                                                                          θ 0 6=θ


     An optimal allocation is given by quantities Qji , NjY , NjH , IjY , IjH , cθj , hθj , Lθj , uθ and multipliers Pj∗ , p∗j , Rj∗ , Wj∗ , ωjθ
                                                                                                                   

such that the first-order conditions (A.13)-(A.21) and the constraints enumerated in (i) to (iii) in Definition 2 hold.
     It is straightforward to show that (A.13) to (A.15), (A.18) and (A.19) coincide with the optimality conditions
of producers and consumers (i) and (ii) in the competitive equilibrium from Definition 1 given competitive prices
{Pj , pj , Rj , Wj } equal to the multipliers Pj∗ , p∗j , Rj∗ , Wj∗ and decentralized expenditure xθj equal to xθ∗
                                              
                                                                                                                      j . In addition,
the restrictions (i) to (iii) from definition 2 of the planning problem are the same as restriction (iii) from the competitive
equilibrium. Therefore, the system characterizing the competitive solution for Qji , NjY , NjH , IjY , IjH , cθj , hθj , Lθj given
                                                                                            

the prices {Pj , pj , Rj , Wj } and the expenditure xθj is the same as the system characterizing the planner allocation
for those same quantities given the multipliers Pj∗ , p∗j , Rj∗ , Wj∗ and xθ∗
                                                        
                                                                                   j . As a result, if the competitive allocation
is efficient, then xθj = xθ∗ j  where x θ∗
                                        j  is given  by   (A.21).   Conversely, if xθj = xθ∗           θ∗
                                                                                               j for xj defined in (A.11) given the
W θ that solves the planner’s problem, there is a solution for the competitive allocation such that {Pj , pj , Rj , Wj } =
 ∗ ∗ ∗
  Pj , pj , Rj , Wj∗ . If the planning problem is concave then there is a unique solution to the system characterizing the
planner’s allocation, in which case {Pj , pj , Rj , Wj } = Pj∗ , p∗j , Rj∗ , Wj∗ is the only competitive equilibrium.
                                                                 




Proposition 2. The optimal allocation can be implemented by the transfers

                                               X                         0                     0
                                                                                                         Lθ 0 ∗            
                                                                              ∗                     ∗      j
                                       tθ∗
                                        j =
                                                               P,j
                                                              γθ,θ    θ
                                                                   0 wj
                                                                                     A,j θ
                                                                                  + γθ,θ 0 xj              θ∗
                                                                                                                − bθ Π∗ + E θ ,                      (A.23)
                                                                                                          Lj
                                                   θ0

                                ∗
where the terms xθ∗   θ∗   θ∗
                                    are the outcomes at the efficient allocation, and E θ
                                                                                    
                 j , wj , Lj , Π                                                                                                  are constants equal to the



                                                                                          48
multipliers on the resource constraint of each type in the planner’s allocation.

Proof. Combining 23 and condition (22) we get:
                                                              X                  0              0
                                                                                                      Lθ 0
                                                                                                        j
                                       wjθ − xθj +                      P,j
                                                                       γθ,θ    θ    A,j θ
                                                                            0 wj + γθ,θ 0 xj                = Eθ .               (A.24)
                                                                                                       Lθj
                                                              ∀θ 0


Combining this last expression with (19) gives the result.



Proposition 3. The planning problem is concave if ΓA > ΓP , ΓA ≥ 0 and γθ,θ    A
                                                                                     > 0 for θ 6= θ0 . Under a single
                                                                                 h0           i
worker type (Θ = 1), the planning problem is quasi-concave if 1 + γ A > 1 + γ P 1−α
                                                                                      C
                                                                                    1+D
                                                                                         + αC .

Proof. We consider the following planning problem defined in section 2.4:

                                                          max uθ
                                                                         0        0
                                                          s.t.: uθ = uθ                   for θ0 6= θ
                                                                         0
                                                                      uθ ∈ U          for all θ0
                                                                                     0
where θ is a given type, U is the set of attainable utility levels uθ and uθ for θ0 6= θ is an arbitrary attainable
                                                                        

utility level for group θ0 . U is characterized by a set of feasibility constraints which are defined in the main text, and
which we come back to below. We show here that this problem, noted P, can be recast as a concave problem, under
the condition stated in proposition 2. Therefore, a local maximum of P is necessarily its unique global maximum.
The planning problem P can be recast as the following equivalent problem P 0 , after simple algebraic manipulations:

                                                                         max                           vθ                        (A.25)
                                                   {vθ ,Ujθ ,Cjθ ,Hjθ ,Le θj ,Nejk ,Ijk ,Qij ,Mj ,Sj }
subject to the set of constraints C:


                                                                                            γA
                                                                                                    
                                                    θ0 Q            00  θ00 ,θ0
                                                                      eθ    1+ΓP
                                                                                                     
                                                    Uj  θ 00 6=θ 0 Lj
                                                θ0
                                                                                                     
                                               v −F                                                  ≤ 0 for all j and θ 0 ;    (A.26)
                                                                                                    
                                                                  1−γ A0 0                          
                                                                      θ ,θ                          
                                                           e θ0
                                                               
                                                          L          1+ΓP
                                                                             j
                                                                                                   
                                                                                  θ          θ    θ
                                                                                 Uj − U     Cj , Hj ≤ 0                           (A.27)
                                                                       1
                                                      Y βY        Y βY  βY
                                                                
                                                  N           I
                                  X
                                       dji Qji − bY Nj     + bY Ij         ≤ 0 for all j, i;                                      (A.28)
                                   i
                                                                        
                                                    θ         Y          H
                                           X                                                  
                                                   Cj + Ij            + Ij   − Q Q1j , .., QJj ≤ 0 for all j;                     (A.29)
                                           θ
                                                                               1
                                                              H βH        H βH  βH
                                                                        
                                               θ          N           I
                                       X
                                           Hj −          bH Nj     + bH Ij         ≤0                                             (A.30)
                                       θ
                                                                        ρ  1
                                                     γP
                                     
                                                                             ρ
                                                     θ0 ,θ        1
                                                  0
                                            
                                                          P
                                   X  θ Y                      
                                                θ    1+Γ        θ 1+ΓP    
                              Mj − 
                                   
                                      Zj
                                            Lj
                                              e              Lj
                                                              e        .  ≤ 0 for all j;
                                                                                                                                (A.31)
                                       θ             θ0

                                                                                      Y      H
                                                                                 Nj + Nj − Mj ≤ 0                                 (A.32)
                                                                             X  θ 1 P    θ
                                                                                L
                                                                                e   1+Γ − L = 0 for all θ                         (A.33)
                                                                                  j
                                                                             j



    To reach these expressions, we have introduced the auxiliary variables Mj and Ujθ and we have used the following
                                                                                    P
                                                                      e θj = Lθj 1+Γ for all j and θ, where the function
change of variables: v θ = F uθ , Hjθ = Lθj hθj , Cjθ = Lθj cθj , and L
                                                                               
                                            P                             0                               0
F(.) is defined by F(x) = −xb for b = Γ1+Γ
                                         P −ΓA . Problems P and P are equivalent: any solution to P is a solution
                                                                   00                    0
to P and vice-versa. We then consider the relaxed problem P that is identical to P except that the last constraint



                                                                                 49
of P 0 is relaxed into an inequality constraint:
                                                               X               1
                                                                               1+ΓP
                                                        Lθ −        e θj
                                                                    L                    ≤ 0 for all θ.                         (A.34)
                                                               j


We now show that problem P 00 has a concave objective and convex constraints under the assumptions of proposition
2. To that end, we show that under these assumptions, each constraint of P 00 is convex.
    Consider first the constraint (A.26), and examine specifically the expression:

                                                                           γ 0                     A         A
                                               n    o n 0o                  θ ,θ 
                                                                  Y  θ0  1+Γ P
                                                                                        − 1−γθ,θ
                                                                                            1+ΓP
                                  fjθ (Ujθ ,       L , Lθ ) = Ujθ
                                                    θ
                                                                     L
                                                                     ej            e θj
                                                                                   L              .                             (A.35)
                                                                               θ 0 6=θ


This expression is a multivariate function of the form f (y, z) = ki=1 yiai z −b where ai > 0, b > 0 and ki=1 ai < b.
                                                                   Q                                    P

By proposition 11 of Khajavirad et al. (2014), such functions are G-concave, meaning that the function G(f (y, z)) is
                                                                       P 1
concave in (y, z), for functions G(x) that are concave transforms of −x ai −b . Assumptions made on parameter values
                                                                                     γθA0 ,θ          A
                                                                                                   1−γθ,θ
in Proposition 3 ensure that γθA0 ,θ ≥ 0 for all θ0 6= θ and 1 +                 , which follows from ΓA > ΓP . Therefore,
                                                                                    1+ΓP
                                                                                               <   1+ΓP
                                                                                                                    
                                                                                         1+ΓP )/ ΓP − σθ + θ0 γθA0 ,θ
by Proposition 11 of Khajavirad et al. (2014), the transformation Gθ (x) = −x(
                                                                                                          P
                                                                                                                         ensures
that Gθ (fjθ (.)) is concave. Finally, given the definition of ΓA , F(.) is a concave transform of Gθ (.). Therefore, (A.26)
is convex for all θ0 .                                 hP        iρ
     Second, functions of the form f (x1 , ..., xn ) =    ai xβi    are concave whenever β ∈ (0, 1) and ρβ ≤ 1. Therefore,
constraints (A.28), (A.30) and (A.34) are convex.
     The constraint (A.27) is convex because U (.) is concave. The constraint (A.29) is convex because the aggregator
Q(.) is concave.
     Next, consider the constraint (A.31). The second term is the negative of a composition of an increasing CES
function with exponent ρ ≤ 1, which is concave, and a series of functions of the form
                                                                            γ 0           P
                                                                             θ ,θ 
                                                                   Y  θ0  1+Γ        1P
                                                                                P
                                               f (x1 , ..., xΘ ) =    x             xθ 1+Γ .
                                                                      θ0

                                                                                                            1+ θ0 γ P0
                                                                                                              P
                                                                                                        θ ,θ
As concave transforms of a geometric mean, these functions are concave, whenever                    1+ΓP
                                                                                                              ∈ (0, 1). This restriction
                          P
holds by definition of Γ . We finally invoke that the vector composition of a concave function that is increasing in
all its elements with a concave function is concave. Therefore, constraint (A.31) is convex. Finally, constraint (A.32)
is linear hence convex.
     It follows that the relaxed problem P 00 is a maximization problem with concave objective and convex inequality
constraints. It admits at most one global maximum, and a vector satisfying its first order conditions is necessarily
the global maximum. If at this unique optimal point for P 00 the relaxed constraint (A.34) binds, so that (A.33) holds,
we guarantee that the solution to P 00 is also the unique global maximizer of P’ and the unique global maximizer of
the equivalent problem P.50
     We now specialize to the case of a single type of workers (Θ = 1) where the decreasing returns to scale in the
production of housing help make the problem concave. The relaxed planner’s problem P 00 can be further simplified
in this case to:                                                                                            A
                                                                                 αC   1−αC  − 1−γθ,θ
                                                                                  θ      θ 1+dH,j   θ   1+ΓP
                                              max                           minj Cj    Hj
                                                                                       e          Lj
                                                                                                  e
                        {vθ ,Ujθ ,Cjθ ,Hjθ ,Le θj ,Nejk ,Ijk ,Qij ,Mj ,Sj }
subject to the constraints (A.28), (A.29), (A.31), (A.32) and (A.34), which are unchanged except that they now hold
                                                                                 0
for only one group. We have used the following change of variable H   e jθ = Hjθ 1+dH,j . The modified constraint for



   50
      We have not proven that (A.34) necessarily binds at the optimal solution for P 00 . Therefore, we verify that this
is indeed the case in the solution to P 00 in the implementation.


                                                                               50
housing production is:
                                                        βH (1+D)        (1+D)βH  β1H                                       1
                                                                                                                                1+D
                                            e jθ − bN
                                            H       H N
                                                      g H
                                                                    + b I  H
                                                                        H Ij
                                                                           f                                                          ≤ 0.                            (A.36)
                                                        j


The modified housing market constraint (A.36) is convex. The objective of the planner is quasi-concave as the
                                                                                                                                                     1−γ A
minimum of a ratio of a concave and a convex function, as long as (1 − αC ) 1+d10     + αC ≤ 1+Γθ,θ
                                                                                                 P in each city. The
                                                                                  H,j
constraints are convex. Therefore, the problem is a quasi-concave maximization problem as long as the parameter
restriction in (ii) holds.




A.4      Preference Draws within Types
    The Lagrangian of planning problem in Section 3.5 is a special case of (A.12), except that now the spillover
            0                                 0    −σθ
function aθj L1j , .., LΘ   is replaced by aθi Lθi
                          
                        j                               . Following the same steps as in the proof of Proposition 1, we find
that condition (22) is extended to
                                                                            0       0       0
                                                      dNj X xjθ Lθj ∂aθj
                                                Wj         +      θ0
                                                                          = xθj (1 + σθ ) + E θ                               if Lθj > 0.                             (A.37)
                                                      dLθj      a j  ∂L θ
                                                                        j
                                                             θ0


Following the same steps as in the proof of Proposition 2, we find that (24) is extended to

                                                                                                                           Lθ 0 ∗ 
                                                                                                  θ0 ∗        A,j θ 0 ∗
                                                                              X                                                             
                                                                                                                             j
                               tθj   =    P,j
                                         γθ,θ   +        A,j
                                                        γθ,θ   − σθ +                      P,j
                                                                                          γθ,θ 0 wj      +   γθ,θ 0 xj       θ∗
                                                                                                                                  − bθ Π∗ + E θ .                     (A.38)
                                                                                                                            Lj
                                                                                θ 0 6=θ


The general-equilibrium structure underlying propositions 3 and 4 under the assumptions of the quantitative model
can be expressed exactly as in the proof of Proposition 3 and as in the planning problem in relative changes from
                                                              A                   A
Section A.7 below, the only modification being that the term γθ,θ is replaced by γθ,θ − σθ .


A.5      Commuting
    The Lagrangian of the planning problem described in the extension to spillovers across locations in Section 3.5 is
                                                              
                             ωji u − L−σ
               XX
    L =u−                                 σ    R
                                      ji L aj Lj Uji (cji , hji )
                 j       i
                                                                !                                                                                !
           X         X                                                    X             X
               p∗j           dji Qji − Yj NjY , IjY                               Pj∗           Lji cji + IjY + IjH − Q Q1j , .., QJj
                                                                                                                                                
       −                                                                −
           j             i                                                  j               i
                                                                                                                               !                            
           X                                                            X             X                                             XX
       −       Wj∗       NjI    +    NjH   − zj       LW
                                                       j       LW
                                                                j       −         Rj∗           Lji hji − Hj NjH , IjH             −E               Lji − L + ...   (A.39)
           j                                                                j               i                                               j    i



where LR                       W
              P                     P
         j =    i0 Lji , and Li
                      0          = j 0 Lj 0 i are the residents and workers at j and i are, respectively. The planner
optimizes over the bilateral flows Lji from place of residence j to place of work i, the consumption of tradeables and
non-tradeables cji and hji of each of these commutersi, and the same remaining margins as in the benchmark model
(trade flows Qji and allocation of inputs into production of tradeables and non-tradeables). The first-order condition
with respect to Lji is:
                                                                                                 
                −σ−1
                                               ωji0 L−σ
                                             X
                     aj LR                              a0 LR  Uji0 cji0 , hji0 +Wi∗ zi0 LW   LW       W
                                                                                                            = Pj∗ cji +Rj∗ hji +E
                                                                               
[Lji ] : −σωji Lji       j Uji (cji , hji )+         ji0 j  j                             i    i + zi Li
                                                                i0

                                                                                                                     (A.40)
In addition, the first order conditions over cji and hji and homogeneity of degree 1 of Uji imply ωji L−σ−1
                                                                                                       ji    aj L Rj Uji (cji , hji ) =
                                                                                                          z 0 (LW )
x∗ji . Combining this expression with (A.40), using the definition of spillover elasticities γiP = zi LiW LW         i  and
                                                                                                           i( i )




                                                                                                51
        a0j (LR
              j )
γjA =   aj (LR
                    LR
                     j , and re-arranging we get:
             j )



                                                γjA X Lji0 x∗ji0             1 + γiP ∗  W     E
                                       x∗ji =                            +          Wi zi Li −     .                           (A.41)
                                                1+σ             LR
                                                                 j            1+σ              1+σ
                                                        i0


To reach (35) we further use that the wage received by a commuter who works in i is wi∗ = Wi∗ zi LW
                                                                                                    
                                                                                                  i   , and the
                                          ∗
definition of expenditures x∗ji = wi∗ + ΠL + t∗ji .


A.6        Spillovers Across Locations
    The Lagrangian of the planning problem described in the extension to spillovers across locations in Section 3.5 is a
special case of (A.12), except that now the the supply of efficiency units in j is Nj ({Lj 0 }) = zj ({Lj 0 }) Lj . Compared
to our derivation of Proposition 1, the only difference is the first-order condition with respect to employment. Now,
instead of (A.21) we reach:
                                                 X             dNj 0       Lj ∂aj
                                                        Wj∗0         + x∗j        = x∗j + E.                                  (A.42)
                                                               dLj         aj ∂Lj
                                                  j0


In addition, we now have:
                                                         
                                                         wj 0 Lj 0 γ P,j,j 0                  if j 0 6= j,
                                                   dNj         Lj
                                                Wj     =                                                                      (A.43)
                                                   dLj   wj γ P,j,j + 1                      if j 0 = j.

Combining the last two expressions with (19) gives (38).


A.7        Planning Problem in Relative Changes and Proof of Proposition 4
     We show how to express the solution for the competitive allocation under an optimal new policy relative to an
initial equilibrium consistent with Definition 1, and then define the planning problem over the policy space.


Preliminaries We adopt the functional forms from Section 3.6. From the profit maximization problem of
producers and market clearing in the housing market we obtain the following sectoral labor demand conditions:
                                                          
                                         Wi NiY = 1 − bIY,i pi Yi ,                                        (A.44)
                                                                      1 − bIH,i
                                                       Wi NiH =                 (1 − αC ) Xi .                                (A.45)
                                                                      1 + dH,i

                                                                NiH
These terms imply the non-traded labor share,                   Ni
                                                                      , as function of the share of gross expenditures over tradeable
income pX i
        i Yi
             :
                                                                   1−bI
                                                                                                  
                                                                      H,i 1−αC              Xi
                                                   NiH             1+dH,i 1−bI
                                                                             Y,i
                                                                                           pi Yi
                                                       =                                                  .                   (A.46)
                                                                 1−bI
                                                                                              
                                                   Ni               H 1−αC              Xi
                                                                                                   + 1.
                                                                1+dH,i 1−bI            pi Yi
                                                                          Y,i

Using (A.44) and (A.45) along with labor-market clearing (A.14), we can further express final consumption expendi-
tures over tradeable income as a function of the shares of wages in expenditures:

                                                     Xi                      1 − bIY,i
                                                           =                                           .                      (A.47)
                                                    p i Yi       Wi Ni        1−bI
                                                                                 H,i
                                                                  Xi
                                                                         −    1+dH,i
                                                                                        (1 − αC )

   We now re-formulate some of the equilibrium from Definition 1 conditions to include prices. Consider first the
market clearing condition (8). Multiplying both sides by the price of the traded bundle Pj , letting EjY ≡ Pj Qj be


                                                                             52
the gross expenditures in tradeable goods in j (used both as intermediate and for final consumption), and using
equilibrium in the housing market and the optimality condition for the choice of intermediate inputs in the traded
sector, we can re-write that condition as
                                                               !
                                    Y                   bIH,j
                                 Ej = αC + (1 − αC )             Xj + bIY (pj Yj ) ,                        (A.48)
                                                      dH,j + 1

                       0  0
where Xj = θ0 Lθj xθj are the aggregate expenditures of workers in region j. This condition says that aggregate
                P

expenditures in traded goods results from the aggregation of expenditures by consumers and final producers. Second,
consider the market condition (7) for traded commodities. Multiplying both sides by the price of traded commodities
at j, pj , this condition is equivalent to
                                                    X X
                                                        sji = 1,                                             (A.49)
                                                                           i
                             
                       Ei
where   sX
         ji   ≡       pj Yj
                                  sM
                                   ji   is region i’s share of j’s sales of tradeable goods (i.e., the export share of i in j) and
        pji Qji                     0
sM
 ji≡      Ei
             is region j s share of i’s purchases of tradeable goods (i.e., the import share of region j in i). Finally,
aggregating the budget constraints of individual consumers gives
                                                                         X
                                                                               sM
                                                                                ji ≡ 1.                                        (A.50)
                                                                          j



Equilibrium in Relative Changes We now express the solution for the competitive allocation from Defi-
nition 1 under the new policy relative to an initial equilibrium. Consider a policy change that affects the equilibrium
expenditure distribution xθi . We now show that the outcomes in the new equilibrium relative to the initial equi-
                         
                                                   n           o       n o                            n o
librium are given by a set of changes in prices P̂i , pˆi , R̂i , wages Ŵi , employment by group Lˆθi , supply of
                n o                                      n o                     n o
efficiency units N̂i , production of tradeable goods Ŷi , and utility levels uˆθ that satisfy a set of conditions
                                                                      n o
given the change in expenditure per capita by group and location xˆθi . The planner’s problem in relative changes
                             n o
will then choose the optimal xˆθi .
     From the previous expressions we obtain the following system in relative changes:
                                                                    !1−σ
                                                                pˆi
                                                                          EˆjY = pˆi Ŷi for all i,
                                                        X
                                                            sX
                                                             ij                                                                (A.51)
                                                      j         Pˆj
                                                          X M  pˆj 1−σ
                                                             sji               = 1 for all i,                                  (A.52)
                                                          j          P̂i
                                                      NH              NH
                                                         
                                                    1− i    pˆi Ŷi + i X̂i = Ŵi N̂i for all i,                               (A.53)
                                                       Ni              Ni
                                                                        1−bI
                                                                           Y,i         bI
                                                                                        Y,i
                                                                  Ŵi            P̂i          = pˆi for all i,                 (A.54)
              P X,θ ˆθ ˆθ
where X̂j =      θ sj xj Lj is the change in aggregate expenditures by region and sX,θ  j   is group θ’s share in the
consumer expenditures in j in the initial equilibrium. Equations (A.51) and (A.52) follow from expressing (A.49) and
(A.50) in relative changes and using the CES functional form (40). In condition (A.51), using (A.48) implies that
the change in expenditures in tradeable commodities is:
                                                            
                                            EˆjY = 1 − bIY,j
                                                         ˜ X̂j + bI˜ pˆj Yˆj .
                                                                   Y,j                                         (A.55)

where
                                               ˜ ≡ bI   pj Y j                                   bIY
                                             bIY,j  Y          =                                                              (A.56)
                                                        EjY
                                                                                                           
                                                                                                   bI
                                                                                                    H,j         Xj
                                                                        αC + (1 − αC )           dH,j +1       pj Yj
                                                                                                                       + bIY

      Condition (A.53) follows from expressing labor-market clearing (10) in relative changes together with (A.44) and


                                                                                 53
                                                                NH
(A.45), where the non-traded labor share Nii is defined in (A.46). Condition (A.54) follows from optimization of
producers of tradeable commodities.                   n                     o
    The system (A.51) to (A.54) defines a solution for Pˆj , pˆj , Yˆj , Ŵj given the change in the number of efficiency
units N̂i and expenditures in each region X̂i , and independently from heterogeneity across groups or spillovers.
Heterogeneous groups and spillovers enter through N̂i . To reach an explicitly expression for N̂i , we first note that the
labor demand expression in the market allocation (17) allows us to back out the efficiency of each group:
                                                                                                       ρ1
                                                                                 wθ            Lθi
                                                                                          
                                                                         ziθ    = i                          ,                            (A.57)
                                                                                 Wi            Ni

Expressing the CES functional form for the aggregation of labor types in (43) in relative changes and using (A.57)
we obtain:                                                          !1
                                                 X W,θ           ρ ρ
                                          N̂i =      si     ˆθ ˆθ
                                                           z i Li      ,                                    (A.58)
                                                                                θ

where
                                                                                    Y             γ P0
                                                                         zˆiθ =           Lˆθi
                                                                                               0       θ ,θ
                                                                                                                                          (A.59)
                                                                                    θ0

                                wjθ Lθ
and where sW,θ
           j   =                     j
                                      0      0   is group θ share of wages in city j. Expression (A.58) relates the total change in
                                    wjθ Lθ
                           P
                               θ0        j
efficiency units in a location to the distribution of wage bills in the observed allocation, the changes in employment
by group, and the production function andnspillover
                                                 o     elasticity parameters.
     The change in the number of workers Lˆθi of each type in every location that is initially populated must also
be consistent with the spatial mobility constraint, (14),

                                                                                               xˆθi
                                                                     uˆθ = aˆθi           αC          1−αC       ,                        (A.60)
                                                                                    P̂i        R̂i
where
                                                                                    Y             γ A0
                                                                         aˆθi =           Lˆθi
                                                                                               0       θ ,θ
                                                                                                                                          (A.61)
                                                                                    θ0

and where R̂i is the change in the price of non-traded goods in location i. This relative price can be expressed as
solely a function of the changes in the price of the own traded good, the price index of traded commodities, and the
aggregate expenditures in i:
                                         1−bI                1−bI
                                                                           1+d1
                                                                   H,i                            H,i                           H,i
                                                                                bI     I
                                                                                 H,i −bY,i                           dH,i
                                                                1−bI                           1−bI
                                                   R̂i = pˆi      Y,i    P̂i                     Y,i        X̂i                     .   (A.62)

To obtain this expression, we first solved for the rental rate Ri from the equilibrium in the housing market, used the
zero-profit condition in the traded sector and expressed the resulting expression in relative changes.
    Finally, the national labor market must clear for each labor type is

                                                                               ˆθ
                                                                     X
                                                                          sL,θ
                                                                           j Lj = 1 for all θ,                                            (A.63)
                                                                     j


                   Lθ
where sL,θ
       j   =        j
                           0   is group θ’s share of employment in city j.
                      Lθ
               P
                 θ0    j
     In sum, the systemnof equilibriumoequations can be broken into two distinct blocks. The system (A.51) to (A.54)
defines a solution for Pˆj , pˆj , Yˆj , Ŵj given the change in the number of efficiency units N̂i and expenditures in
each region X̂i independently
                      n             from
                                       o heterogeneity
                                              n         nacross
                                                             o groups
                                                                   o           or spillovers. In turn, the system (A.58) to (A.63)
defines a solution for N̂j , L̂θj , uˆθ given pˆi ,P̂i , xˆθi , X̂i . As a result, an equilibrium in changes given a change
                          n o                   n                                        o
in expenditure per capita xˆθj consists of P̂i , pˆi , Ŷi , Ŵi , N̂j , Lˆθj , R̂i , uˆθ such that equations (A.51) to (A.63) hold.
These equations conform a system of 5J + ΘJ + Θ equations in equal number of unknowns, where J is the number



                                                                                         54
of locations and Θ is the number of types.

                                                                                                                          n   o
Planner’s Problem in Relative Changes In the implementation, we solve an optimization over xˆθj
             n                                                    o
subject to       P̂i , pˆi , Ŷi , Ŵi , N̂j , Lˆθj , R̂i , uˆθ
                                             consistent with (A.51) to (A.63) in order to maximize the utility of a given
group θ, u , subject to a lower bound for the change in utility of the other groups (uˆθ0 ≥ uˆθ0 for θ0 6= θ). This
           ˆθ

problem (call it P200 ) differs formally from the baseline problem in Definition 2 (call it P2 ) for two reasons. First, it
features prices, expenditures and incomes rather than being expressed in terms of quantities alone, as in conditions
(A.44) to (A.50). We denote by P20 an intermediary problem expressed in terms of income and expenditure rather
than quantities, but still in levels. Second, P200 is expressed in changes relative to an initial equilibrium rather than in
levels. We show here that the two problems are nevertheless equivalent. Therefore, the problem that we implement
has a unique maximizer under the conditions of Proposition 2.
     To see that the two problems have the same solutions, we first focus on the first order conditions of problem P2
and compare them to the problem in levels P20 expressed in income and expenditures terms rather than in quantities.
Conditions (A.13) and (A.15) define the Lagrange multipliers corresponding to good and factor prices for P2 . They are
identical to the price index definition constraint of problem P20 . Furthermore, manipulating these equations together
with the constraints expressed in quantities leads to the constraints expressed in terms of income and expenditure.
Therefore, a vector satisfies the first order conditions for P2 if and only if it satisfies the first order conditions for P2 ’.
Then, note that the problem in relative changes stated here is simply the problem P20 modified through the changes of
variable x → xo xb for all variables, where xo is a constant corresponding to the observed data and x       b the optimization
              0                                                                             0
variable in P2 . The problem in relative changes considered here and the problem P2 , and in turn problem P2 , have
therefore the same solutions, subject to the appropriate change of variables. In particular, a point that satisfies the
first order conditions under the conditions of Proposition 3 is the (unique) global maximizer for both problems.


Proof of Proposition 4 Proposition 4 follows from inspecting (A.51) to (A.63) under the planner’s problem
in relative changes defined above. Note that, given the elasticities αC , ρ, bIY,j , bIH,j , dH,j , and as long as bIY > 0,
                                                                    

computing the change in tradeable expenditures requires information about gross expenditures over tradeable income,
 Xj                                                                                  NH
pj Yj
      . This information is also needed to compute the non-traded labor share Nii in (A.53). However, as shown in
                      X
(A.46) and (A.47), pj Yjj can be constructed from the elasticities αC , bIY , bIH , dH,j and the share of wages in gross
                                                                  
                    Wi Ni
expenditures,        Xi
                          .




                                                                      55
       Optimal Spatial Policies, Geography and Sorting
                                  Appendices for Online Publication

                                   Pablo D. Fajgelbaum, Cecile Gaubert


A      Equivalence with Monopolistic Competition
     Consider the economic geography environment from Section 3.4. As a reminder, that environment starts from
the general model from Section 2 and imposes only one labor type, inelastic housing supply (Hj NjH , IjH = Hj is a
                                                                                                           

constant), and only labor used in production of traded goods (Yj NjY , IjY = NjY = Nj = zj (Lj ) Lj ). Now suppose
                                                                                

that, in addition, the production structure in the traded sector is the same as in Krugman (1980): in each location
j, Mj homogeneous plants produce differentiated varieties with constant elasticity of substitution κ across them, and
setting up a plant in location j requires Fj units of labor. The resulting environment corresponds to Redding (2016)
or Helpman (1998) in the absence of individual preference shocks (σ = 0).
     We now show that the competitive allocation of such an extended model, as well as their normative implications,
are equivalent to the model with homogeneous products analyzed in Section 3.4 under an aggregate production
function equal to:
                                                                           κ
                                             Y
                                             fj (Lj ) = Kj (zj (Lj ) Lj ) κ−1 ,                                 (A.1)
                         1
where Kj ≡ κ−1 κ
                  (κFj ) 1−κ is a constant. Therefore, a monopolistic competition model with no productivity spillovers
is equivalent to a homogeneous-product model with perfect competition and spillover elasticity equal to γ P = κ−1   1
                                                                                                                      .
This property relates to the result, dating back to at least Abdel-Rahman and Fujita (1990) and also shown by
Allen and Arkolakis (2014), that CES product differentiation with monopolistic competition has the same aggregate
implications as a constant-elasticity aggregate production function with increasing returns. We demonstrate that the
equivalence extends to the welfare implications summarized in Proposition 1.


Environment We start by describing how the physical environment of this        κ
                                                                                   model differs from the environments
from Section 2. Now, the input to the aggregator Q ({Qji }) is Qji = Mjκ−1 qji , where Mj is the number of plants
in j and qji is the quantity exported by each of these from j to i. The feasibility constraint for traded goods (7)
                           P                
becomes zj (Lj ) Lj = Mj      i τji qji + Fj to account for the use of labor in setting up plants. Combining these two
expressions, that constraint can be further expressed:
                                            1                             X
                                       Mjκ−1 (zj (Lj ) Lj − Fj Mj ) =            τji Qji .                          (A.2)
                                                                            i


Competitive Equilibrium Now we describe how the market allocation differs from the baseline environments.
First, the producers’ profit maximization condition is now:
                                                      X
                                                max       (p˜ji − τji Wj ) qji                                      (A.3)
                                                      i

                        −κ                       1
                         p˜                       1−κ
subject to qji = Qji pji  ji
                                , where p ji = Mj     p˜ji is the price index corresponding to the exports from j to i and
p˜ji is the price at which each firm from j sells in i. The solution to this problem yields the standard constant markup
                  κ
rule, p˜ji = τji κ−1 Wj . We have as before that the price in location i of the aggregate traded good from j, pji , can
be expressed according to the “mill pricing” rule as τji pj , where now the price index corresponding to the domestic
sales of traded goods in j is:
                                                               1
                                                                    κ
                                                    pj ≡ Mj1−κ          Wj .                                         (A.4)
                                                                  κ−1



                                                             56
As a result, condition (18) still determines the flows in the competitive equilibrium. Combining these pricing rules
with (A.3), imposing zero profits and using (7) we obtain the number of producers in a competitive allocation:

                                                                     zj (Lj ) Lj
                                                           Mj =                  .                                            (A.5)
                                                                         κFj

And further combining with (A.2), we can write
                                                                          X
                                                          Y
                                                          fj (Lj ) =          τij Qij                                         (A.6)
                                                                          j


for Yfj given in (A.1).
      We conclude that the competitive allocation can be represented as in the model without product differentiation
from Definition 1 under the restrictions from Section 3.4 and assuming the aggregate production function Y                 fj (Lj ).
I.e., it is given by quantities {cj , hj , Lj , Qij , Lj } and prices Pj , Rj , pj , such that: (i) consumers optimize (i.e., cj , hj
are a solution to (12) given expenditures xi ); (ii) trade flows are given by (18); (iii) employment Lj is consistent with
the spatial mobility constraint (14); and (iv) all markets clear, i.e. (4), (6) and (A.6) hold.51


Planning Problem       The planning problem from Definition (2) is now associated with the Lagrangian
                                                            −σ !
                          X                                 Lj
                   L =u−      ωj u − aj (Lj ) U (cj , hj )
                            j
                                                            L
                                                                         !
                       X ∗ X                  1
                                             κ−1
                     −   pj      dji Qji − Mj     (zj (Lj ) Lj − Fj Mj )
                          j           i
                                                                                                                 !
                          X                                          X                              X
                      −       Pj∗   (Lj cj − Q (Q1j , .., QJj )) −        Rj∗   (Lj hj − Hj ) − W       Lj − L       + ...    (A.7)
                          j                                           j                             j


Relative to Definition 2, now the planner also chooses the number of firms Mj in each location and faces the constraint
(A.2) instead of (7). Entry is efficient since the first-order condition with respect to Mj implies (A.5). As a result,
the market clearing constraint in the second line of (A.7) can be replaced by (A.6). The resulting planning problem
is equivalent to Definition 2 applied to the economic geography model in Section 3.4 under the production function
Y
fj (Lj ) in (A.1).



B        Data Appendix
    We detail the construction of the variables used to implement the counterfactuals. We rely on four primary
data sources: i) BEA regional economic accounts, CA4 Personal Income and Employment by Major Component
(https://www.bea.gov/regional/downloadzip.cfm); ii) estimates of disposable income by MSA from Dunbar (2009)
based on BEA regional economic accounts;52 iii) March CPS based on the IPUMS-CPS, ASEC 2007-2012 samples
and iv) IPUMS-ACS, 2007-2012 samples.


B.1      Appendix to Section 4.1 (Data)
MSA-Level Outcomes We first extract from Dunbar (2009) the following information: population, personal
income, and personal taxes paid by MSA, in 2007. To split personal income by source of income, we merge this data
with the BEA Regional Economic Accounts. We compute the share of personal income corresponding to each possible

    51
      The definition of the competitive allocation can dispense with the wage Wj , which can be determined residually
from (A.4).
   52
      https://www.bea.gov/papers/xls/dpi msa working paper 2001 2007 results.xls


                                                                     57
source: labor income, capital income, and transfers. Specifically, we measure labor income as BEA’s earning by place
of work ;53 capital income as the sum of proprietor’s income, and dividends, interests and rents; and transfers as
current transfer receipts.54 Combining these shares with the total personal income and taxes by MSA from Dunbar
(2009) provides us with a measure of labor income, capital income, transfers and taxes at the MSA level.


Break-Down By Skill Group We split these totals at the MSA level into two groups, high skill and low
skill. To that end, we use the ACS data, part of the Integrated Public Use Microdata Series (Flood et al., 2017), for
the years 2007-2012. The ACS reports, at the individual level: labor income, capital income, government transfers,
MSA of residence, and level of education. Consistent with Diamond (2016), we define as high skill those workers who
have completed 4 years of college or more; and as low skill those who have completed less than 4 years of college or
not gone to college. We aggregate individual level data from the ACS to the MSA-group level, to get an MSA-level
estimate of capital income, labor income and transfers by group, as well as the population of both groups.55 We
follow a similar procedure to compute taxes paid by group and city, using the taxes reported in the March CPS.56
As the MSA aggregates from individual-level data might be noisy, we use this information to construct the shares
of the MSA-level outcomes from the BEA corresponding to each group of workers. For each MSA i, we compute
           eL
           X
sL
 i = X
             i
        e L +X
                         eθ
               e H where Xi denotes capital income, labor income, transfers, taxes or population in the census data
        i   i
corresponding to group θ in city i. We use the share sL
                                                      i , together with the MSA-level dataset for income described
                              θ      θ
above, to build our measure Xi = Xi si of MSA-group level population, labor income, capital income, transfers, and
                                                                                          Xθ
taxes. We also compute the corresponding per-capita measures for each MSA-group: xθi = Lθi .
                                                                                                i



Controlling for Heterogeneity within Groups We purge the raw data described above from composi-
tional effects across MSAs. We use the ACS data to obtain the share of individuals with the following characteristics
for each MSA-skill group: age by bins: <20, 20-40, 40-60, >60; detailed level of educational attainment: less that 8th
grade, grade 9-12, some college (those are relevant for the low skill group) and bachelor, masters or professional degree
(for the high skill group); share black; share male; share unemployed; share out of the labor force; and share working
in manufacturing, services, or agriculture. We also use hours worked per capita as a control. We then proceed as
follows: denoting by xθi the per-capita measure in MSA i and group θ we constructed above, we run the following
MSA level regression, separately for each group θ:
                                                          X
                                            xθi = xθ0 +       βjθ DEMij
                                                                     θ
                                                                        + εθi ,                                    (A.8)
                                                          j




   53
       The BEA’s earning by place of work is comprised of: wages and salaries, supplements to wages and salaries,
proprietor’s income, net of contributions for government social insurance, plus adjustment for residence.
    54
       Current transfer receipts is defined as the sum of government social benefits and net current transfer receipts
from business (https://www.bea.gov/glossary/glossary p.htm).
    55
       One may be worried that the ACS transfers measure suffer from under-reporting (Meyer et al., 2009). An
alternative way to compute transfers is to use an accounting approach. If one allocates social security (old age) to
65+ in proportion of labor earnings, Medicare in proportion of +65 individuals, and the remaining transfers (including
Medicaid, UI, VA) to low skill only, we obtain a measure of transfers per capita with a very high correlation (0.96)
with the one we use.
    56
       Specifically, in the ACS, we aggregate the following categories to measure capital income: income from inter-
est, from dividends, from rents. We aggregate the following categories to measure labor income: wage and salary
income, non-farm business income, farm income, income from worker’s compensation, alimony and child support.
We aggregate the following categories to measure transfers: welfare income, social security income, income from SSI,
income from unemployment benefits, income from veteran’s, survivor’s, disability benefit, income from educational
assistance. We aggregate the following categories in the CPS to measure taxes paid: federal income tax liability, after
all credits, and state income tax liability, after all credits.


                                                              58
           θ
where DEMij  is the demographic variable j enumerated above in MSA i and group θ.We then adjust the observed
 θ
xi from compositional differences across cities by expressing it as a deviation from the population mean:
                                                    X θ                      
                                       x̃θi ≡ xθi −   β̂j DEMij   θ
                                                                    − DEMjθ                               (A.9)
                                                        j


                                                             θ 57
where β̂jθ is the estimate from (A.8) and DEMjθ ≡ I1 i DEMij      The corresponding MSA-level variable is x̃θi Lθi .
                                                    P
                                                              .
The resulting data is our MSA-group level dataset, where X stands for labor income, capital income, transfers and
taxes.


Expenditure per Capita We construct expenditure by group and by MSA, xθi in the model, as disposable
income by group. Disposable income is
                                                xθi = wiθ − τiθ + ωiθ + bθ ΠH .                                   (A.10)
                θ θ θ
The variables wi , τi , ωi , respectively labor income per capita, tax paid per capita, and transfer received per capita,
are directly taken from the BEA/ACS dataset constructed above. We measure bθ as the average fraction of national
capital income owned by each type θ worker in BEA/ACS dataset. This step gives bS LS = 0.52 and bU LU = 0.48.
Finally, we set a value for national profits and returns to land ΠH that is consistent with the general equilibrium
of the model. Using profit maximization and market clearing in the non-tradeable sector we obtain the following
expression for ΠH as function of calibrated elasticities and observable outcomes:
                                                           dH,i
                                                                   Lθi wiθ − τiθ + ωiθ
                                                        P           P                  
                                            (1 − αC )   i dH,i +1   θ
                                    H
                                  Π     =                     P dH,i P θ θ               .                        (A.11)
                                                 1 − (1 − αC ) i dH,i +1   θ b Li


Using xθi we then construct Xi (aggregate expenditure by MSA) as Xi =       Li xi and sX,θ
                                                                         P θ θ
                                                                                       j    (share of expenditures by
type within MSA). Following these adjustments, we still must ensure that the sum of transfers paid by the government
equal the sum of taxes levied, as we have assumed in the model. To that end, we scale all transfers uniformly so that
they add up to the sum of taxes.58


Traded and Non-Traded Sectors We need data on the relative size of the non-traded sector in each city
to calibrate the labor shares by sector. The ACS data also reports the sector of activity of workers. We measure at
the MSA level the share of workers who work in the non traded sector by counting all workers in the following NAICS
sectors: retail, real estate, construction, education, health, entertainment, hotels and restaurants. This measure is
not group-specific. To remove unmodeled heterogeneity in this measure, we compute a series of MSA-level socio-
demographic characteristics, as above, and regress the share of workers in the non-traded sector on these demographic
characteristics. We compute, as above, the predicted share of workers in the non-traded sector in each city, assuming
that demographic characteristics of the city are at the nationwide mean.


Trade Shares We need data on trade shares between MSAs, sM       X
                                                         ij and sij (import and export shares). These
flows are observed in the CFS data, but not at the finer geographic level that we consider here (MSA). Therefore,
we adapt the procedure in Allen and Arkolakis (2014), whereby the import shares from the CFS data are used to
parametrize the elasticity of trade with respect to distance. In particular, the model implies the following expression




   57
     I.e., we define x̂θi ≡ x̂θ0 + j β̂jθ DEMjθ + ε̂θi , where ε̂θi is the estimated residual from (A.8).
                                  P
   58
     This step implies that transfers are uniformly scaled down by 35%. The fact that total taxes and transfers do
not match in our dataset comes in part from having removed heterogeneity that is not place-specific from the data,
and in part from our treatment of capital to be consistent with the model-based sources of capital income, which
only include profits from housing rents.


                                                              59
for share of location i’s imports originating from j:
                                                           1−σ
                                                   1−bI bI
                                              dji Wj Y Pj Y                   1−σ
                                     sM
                                      ji   =                   ≡ dji δjD δiO      ,                                  (A.12)
                                              Pi     zj

where δiO and δjD are origin and destination fixed effects. We assume that trade costs have the form ln dji =
ψ ln distji + eji , where distji is the great circle distance between MSAs j and i. We the use Allen and Arkolakis
(2014) estimate for ψ and set trade costs to dji = distψ                                                     M
                                                          ji . We then construct the smoothed import shares sji between
                                                                        D  O
MSAs using (A.12). To that end we must obtain the values of {δj , δi }, which are uniquely pinned down, up to a
normalization, by considering the identity that sales equals income,
                                                                 X
                                                      pj Y j =           sM
                                                                          ji Ei ,                                      (A.13)
                                                                     i


together with equation (A.12) and the definition of the price index, leading to:
                                                  σ−1 X         1−σ
                                                  δiO  =   dji δjD      .                                              (A.14)
                                                                 j


Plugging (A.12) and (A.14) in (A.13), we get a system N equations in N unknowns,
                                                                                     which we solve to recover
                                                                                 Ei
{δj , δi } and in turn sji . The export shares are then constructed using sji ≡ pj Yj sM
  D    O                M                                                  X
                                                                                       ji , where spending Ei and
traded income pj Yj .


B.2      Appendix to Section 4.2 (Calibration)
Intermediate Input Shares We provide details about the calibration of the intermediate input share in
non-traded goods. We use the following equilibrium relationship from the market clearing condition in the non
traded sector in city j:
                                                    Wj NjH
                                     1 − bIH,j =             (1 + dH,j ) .                             (A.15)
                                                 (1 − αC )Xj
We compute this expression using the observed wage bill of workers in non-traded sectors Wj NjH and total expenditure
Xj described in the previous subsection, and our calibrated values for αC and dH,j described in Section 4.2.


Efficiency Spillover Elasticities The standard estimate of city-level spillovers reviewed by Combes and
Gobillon (2015) are obtained from a regression of average city wages wj on city population Lj . In log-changes, such
an equation would take the form: ŵj = γ P Lˆj + ψj , where ψj is a city effect and γ P is the city-level spillover elasticity.
In our environment, city-level wages are wj Lj = Nj Wj . Under the assumptions of the quantitative model, applying
(A.58), an exogenous shift in the total population of city j keeping its composition across groups constant would then
imply:                          h                                              i
                          ŵj = sW,S
                                  j
                                         P
                                        γS,S    P
                                             + γU,S    + 1 − sW,S
                                                               j
                                                                         P
                                                                       γS,U      P
                                                                             + γU,U    Lˆj + Ŵj ,                     (A.16)

where sW,S
       j    is the share of skilled workers in wages in city j. Hence, through the lens of our model, the coefficient γ P es-
                                                                                  P       P
                                                                                                        
                                                                                                               P       P
                                                                                                                           
timated at the city level in the empirical literature would correspond to sW,S γS,S   + γU,S  + 1 − sW,S γS,U      + γU,U    ,
where sW,S is the average skilled worker share across cities. Therefore, we uniformly normalize the distribution of the
 P                                                              P      P
                                                                                      
                                                                                           P      P
                                                                                                        = γ P . We set
                                                                                                      
γθ,θ0 coefficients such that, under their scaled values, s W,S γS,S + γU,S + 1 − s  W,S   γS,U + γU,U
γ P = 0.06, which is consistent with the standard estimate for the U.S. from Ciccone and Hall (1996), and sW,S = 0.49
as observed in our data.
                                      P
     Having chosen the level of the γθ,θ 0 coefficients, we must still choose their distribution. Under the assumptions

of the quantitative model, the labor demand condition (17) gives the following expression for the log wage of type-θ
worker:                   h               i                   0
                 ln wjθ = ρ 1 + γθ,θP
                                        − 1 ln Lθj + ργθP0 ,θ ln Lθj + ln Wj − (ρ − 1) ln Nj + ln εθj ,          (A.17)


                                                                 60
where ln εθj = ρ ln Zjθ captures productivity shocks at the worker-city level. In data generated by this model and
expressed in differences over time, we would have
                                h              i                       0
                      ∆ ln wjθ = ρ 1 + γθ,θ
                                         P
                                              − 1 ∆ ln Lθj + ργθP0 ,θ ∆ ln Lθj + ∆κj + ∆ ln εθj ,           (A.18)

where ∆κj = ∆ ln Wj − (ρ − 1) ∆ ln Nj is a city effect. We can use (A.18) to map estimates from Diamond (2016).
Specifically, she estimates equations (27) and (28) in her paper using Bartik shocks as instruments. The only difference
between these equations in her paper and (A.18) is the fixed effect ∆κj here. Assuming that the inclusion of the fixed
effect ∆κj would not alter Diamond (2016) estimates, we can directly map her estimates from Column 3 of Table 5,
             P                     P                   P                      P
                                                          
i.e. ρ 1 + γS,S   − 1 = 0.229, ργU,S  = 0.312, ρ 1 + γU,U    − 1 = −0.552, ργS,U = 0.697.
     The elasticities resulting from this procedure are reported in the first row of Table A.1. The second row reports
the coefficients from an alternative parametrization used in the quantitative section where we target γ P = 0.12
instead of γ P = 0.06.

                                                                P           P           P          P
                                Parametrization                γU U        γSU         γU S       γSS
                                Benchmark                      0.003       0.044       0.020     0.053
                                High Efficiency Spillover      0.007       0.087       0.039     0.106

                     Table A.1: Alternative Parametrizations of Efficiency Spillovers


Amenity Spillover Elasticities Diamond (2016) reports estimates for equation (31) in her paper, which
(using our notation for the variables in common with her analysis) has the form:
                                                 !
                                             wjθ
                                                              
                                 θ     θ              θ       Rj              
                           ∆ ln Lj = a0 ∆ ln       + a1 ∆ ln       + aθ2 ∆ ln aD
                                                                               j + ∆ξjθ ,                                    (A.19)
                                             Pj               Pj

                         a
                      U γ
where aD         S
          j ≡ Lj /Lj         is the endogenous component of amenities in her analysis59 and (a0 , a1 , a2 ) are estimated
coefficients. Column (3) of Table 5 of Diamond (2016) reports the following estimates: aU               S    U    S     a
                                                                                                                          
                                                                                                   0 , a0 , a2 , a2 , γ     =
(4.026, 2.116, 0.274, 1.012, 2.6). We generate equation (A.19) in our setup and match the coefficients from our model
to these estimates. For generality, we do so allowing for idiosyncratic preference draws within each type as in Section
3.5 (i.e., assuming σθ > 0). The labor-supply equation implied by (34) is
                                             !
                                         xθj
                                                               
                                 θ                             Rj                          
                         σθ ln Lj = ln         − (1 − αC ) ln     + ln aθj + σθ ln Lθ − ln uθ .                       (A.20)
                                         Pj                    Pj

Let ζ A,S = γ a and ζ A,U = −γ a , and then redefine our amenity index aθj for θ = U, S in (45) as a function of
                                                                           A
                                                                         θ γθ,θ −β
                                                                                   a,θ A,θ
                                                                                      ζ                       γθA0 ,θ
the amenity index aD                                          θ
                    j from Diamond (2016) as follows: aj = Aj Lj
                                                                     θ
                                                                                           aD
                                                                                            j , where β
                                                                                                        a,θ
                                                                                                            ≡ ζ A,θ 0 is by

construction constant over θ0 . Using this equivalence in (A.20), re-arranging and expressing that equation in changes
we obtain

                                                                      !
                                                                xθj
                                                                                                                        
                                          1                                          1 − αC                         Rj
                  ∆ ln Lθj   =                        ∆ ln              −                            ∆ ln
                                      A
                                σθ − γθ,θ + β a,θ ζ A,θ         Pj                   A
                                                                               σθ − γθ,θ   + β a,θ ζ A,θ            Pj

                                       β a,θ              
                             +                     ∆ ln aD
                                                           j + ∆ξjθ ,                                                        (A.21)
                                     A
                               σθ − γθ,θ + β ζ
                                             a,θ A,θ




   59
     This index captures congestion in transport, crime, environmental indicators, supply per capita of different
public services, and variety of retail stores. See Table 4 of Diamond (2016).


                                                               61
where ∆ξjθ ≡             1               ln Aθj + σθ ln Lθ − ln uθ . Comparing (A.19) with (A.21) readily allows us to map
                                                                   
               
                     A
                σθ −γθ,θ   +β a,θ ζ A,θ
Diamond (2016) estimates to our parameters as follows:

                                                      A              aθ2 A,θ   1
                                                     γθ,θ − σθ =         ζ   − θ,                                    (A.22)
                                                                     aθ0      a0
                                                                     aθ2 A,θ0
                                                         γθA0 ,θ =       ζ                                           (A.23)
                                                                     aθ0

for θ = U, S. Conditional the estimates of aU     S    U    S     a                               A
                                                                    
                                             0 , a0 , a2 , a2 , γ     , we back out the value of γθ,θ − σθ but are unable to
              A
distinguish γθ,θ from −σθ . Our benchmark model is presented assuming σθ = 0. However, as discussed in Section
       A
3.5, γθ,θ − σθ is the relevant combination of parameters to characterize optimal allocations and policies under the
definition of the planner problem with idiosyncratic preference draws defined in that section.
     The resulting numbers are reported in the first row of Table A.2. The second row reports the coefficients from
an alternative parametrization used in the quantitative section where we scale all amenity spillovers down by 50%
relative to the benchmark. The third and fourth rows report parametrizations that, instead the coefficient γ a = 2.6
reported in Column (3) of Table 5 of Diamond (2016), use that point estimate plus or minus the standard deviation
reported in that table, respectively.

                                                                        A        A      A       A
                                                                       γU U     γSU    γU S    γSS
                                  Benchmark                            -0.43    0.18   -1.24   0.77
                                  Low amenity spillover                -0.21    0.09   -0.62   0.38
                                  High cross-amenity spillover         -0.46    0.22   -1.51   1.04
                                  Low cross-amenity spillover          -0.39    0.14   -0.97   0.50

                        Table A.2: Alternative Parametrizations of Amenity Spillovers




                                                                 62
C       Additional Figures and Table to Section 5.1
    x

                     Figure A.1: Optimal Transfers as a Function of Labor Income.




Note: each point in the figure corresponds to an MSA-skill group pair. The black line is a non-linear polynomial fit
of the net transfer relative to the wage as a function of the average wage.



                  Figure A.2: Optimal Growth in Skill Share versus Initial Skill Share
                                                               60
                             Optimal Growth in Skill Share (%)
                                 -20    0      20
                                                -40     40




                                                                    .1    .2                     .3          .4
                                                                         Skill Share (Observed Allocation)

                                                                               Unweighted
                                                                               Population Weighted
                                                                               Top-10 MSAs by Population



Note: each point in the figure corresponds to an MSA. The figure shows unweighted and initial population-weighted
non-parametric curves. The 10 largest cities in the initial allocation are shown as red squares.



D       Alternative Model Specifications
     For each alternative specification we first discuss how the system (A.51) to (A.63) in Appendix Section A.7 used
to solve for the optimal allocation is modified. In each case, we only refer to the equations that are modified compared
to the baseline. We then describe for each case the details of the calibration.




                                                                                    63
D.1     Homogeneous Workers
Model The system (A.51) to (A.63) remains the same but is applied for the case of only one skill type.

Calibration We use the same aggregate MSA-level variables constructed for the case with heterogeneous workers.
To determine the spillover elasticities, we set one-group elasticities γ A , γ P to the value that would be estimated
                                                                                

through the lens of the labor supply and demand equations of the single-group model, if one were to use an MSA-level
dataset generated by the model with heterogeneous groups and elasticities γθP0 ,θ and γθP0 ,θ calibrated above. This
                                                                                        

procedure by construction delivers γ P = 0.06, equal to the value drawn from Ciccone and Hall (1996). To set γ A we
note that under a single worker type, the labor-supply equation implied by (14) expressed in time differences becomes
                                                                          
                                           1         xj                        Rj
                             ∆ ln Lj = − A ∆ ln           − (1 − αC ) ∆ ln           + ∆ξj                      (A.24)
                                          γ          Pj                        Pj

where ∆ξj includes changes in aggregate labor supply and exogenous components of amenities, Aj . In turn, under
multiple worker types, the labor supply equation at the city level results from aggregating the supply of multiple
workers:
                                        !                    ! X
              θ
                    X sL,θ
                         j          xθj                      Rj            L,θ
                                                                               X γθA0 ,θ         0
        ∆ ln Lj = −      A
                              ∆ ln        − (1 − α C ) ∆ ln       −      s j       A
                                                                                         ∆ ln Lθj + ∆ξjθ   (A.25)
                        γθ,θ        Pj                       Pj                0
                                                                                 γθ,θ
                     θ                                                             θ       θ 6=θ


where ∆ξjθ includes changes in the labor supply of type-θ workers and in the exogenous component of amenities,
Aθj . We can draw an equivalence between the aggregate elasticity that would be estimated assuming homogeneous
workers (i.e., using (A.24)) when the true model includes heterogeneous workers, so that the data is generated by
(A.25). In the latter, assuming a shock that exogenously changes population and expenditure per capita in the same
proportion for every worker, aggregating the labor supplies by skill we obtain:
                                                       
                                      P sL,θ
                                           j
                                        θ γA                                           
                     Lˆj =                              xˆj − Pˆj − (1 − αC ) R̂j − Pˆj
                                          θ,θ
                           −                  L,θ A
                                              sj γ 0                                        + ∆ξj ,        (A.26)
                                                   θ ,θ
                                   P P
                              1 + θ θ0 6=θ γ A
                                                θ,θ



where sL,θ is the share of type θ workers in j and ∆ξj ≡ θ sL,θ   θ
                                                        P
        j                                                   j ∆ξj . Comparing (A.24) with (A.26), we obtain that,
at the average share of type-θ workers in the economy sL,θ = J1 j sL,θ
                                                                P
                                                                    j , the coefficient that would be recovered is:

                                                                           L,θ A
                                                       P P                sj  γθ0 ,θ
                                                  1+    θ       θ 0 6=θ       A
                                                                            γθ,θ
                                           γA =                     L,θ
                                                                                       .                       (A.27)
                                                            P     sj
                                                             θ γA
                                                                θ,θ


When implementing the model with a single worker type we use this expression to determine γ A . This procedure
delivers an aggregate amenity elasticity of γ A = −0.19.




                                                            64
            Figure A.3: Optimal Transfers and Reallocation under Homogeneous Workers




Note: This figure shows the transfer per worker relative to the wage in the optimal allocation and in the data. As
                                                                                                            P
                                                                                     t                        +γ A
implied by Section 3.3, the optimal net transfer relative to the wage takes the form wjj = s + wTj for s = γ1−γ A . The
                                     tj
solid lines shows the relationship   wj
                                           = a + b w1j under parameters a and b that correspond to the best fit in an OLS
regression.



Figure A.4: Gains from Optimal Policies given Different Initial Equilibria under Homogeneous
Workers




Note: We simulate laissez-faire equilibria with no government transfers under different fundamentals such that the
joint distribution of wages and city sizes differs from the data in terms of the variance of the wage distribution across
MSAs and the correlation between wages and city sizes across MSAs. In all the equilibria the distribution of city
sizes has the same variance as in the data. Correlation and variances are reported in relative terms compared to
the data. For each variance-correlation combination we draw 400 random distributions of wages and city sizes, and
report the mean welfare gains from implementing optimal policies across these simulations.


D.2     Land Regulations
Model The system changes as a function of the distortion in the initial equilibrium,τjH and its change in a
counterfactual τˆjH . Equation A.53 becomes

                                              1−τjH τˆH
                                                       j                      !
                         NjH             X̂j                            NjH
                                                                 +   1−           Ŵj NˆjY = Ŵj N̂j for all i.
                                                    τjH τˆ
                                                            
                         Nj                              H
                                                         j −1           Nj
                               ((1 − αC ) Xj )




                                                                     65
Equations (A.55) and (A.56) become
                        
                               bI
                                                                    −τjH τˆH 
                                H,j                                         j
                        α C + 1+dH,j
                                      (1  − α C )  (1 − α C ) Xj X̂j                                   
                  ˆY
                      
                 Ej = 
                                                                               1 − b˜I X̂j + b˜I pˆj Yˆj                                     (A.28)
                                    I
                                   bH,j                                 H              Y         Y
                                          (1 − αC ) ((1 − αC ) Xj )−τj
                                                                               
                            αC + 1+d  H,j



and
                              ˜ =                                        bIY
                            bIY,j                                                                                           .                 (A.29)
                                                bI                                                 H        Xj
                                      αC +       H,j
                                              1+dH,j
                                                         (1 − αC ) ((1 − αC ) Xj )−τj                      pj Yj
                                                                                                                     + bIY

Finally, (A.62) becomes:
                                               1−bI                        1−bI
                                                                                                   1+d1
                                                   H,i                         H,i                         H,i
                                                               bI     I
                                                                H,i −bY,i                  dH,i
                                                1−bI                        1−bI
                                   R̂i = pˆi      Y,i   P̂i                   Y,i   X̂i                        .                             (A.30)



Calibration Diamond (2016) decomposes the housing supply elasticity between a part driven by geography γjgeo
                                                                                                                                 dH,j +τjH
and a part driven by regulation γjreg for each city j. The mapping to our model is: γjgeo + γjreg =                               1−τjH
                                                                                                                                             , so that
we set:
                                                                γjreg
                                                       τjH =           ,
                                                             1 + γjreg
                                                                         
                                                    dH,j   = γjgeo 1 − τjH .

The tax rate on sales Rj Hh paid by non tradable producers is 1 − 1−τ1H,j (Rj Hj )−τH,j . To calibrate scale of the
tax, we normalize the scale of Rj Hh so that the tax share of housing expenditures equals 10%. We have checked
that results are fairly insensitive to the specific value of this re-scaling. We assume revenues from the tax on housing
are rebated to firms. This assumption implies that the tax rate only distorts housing supply without distorting any
additional margin. The rest of the model is calibrated following the same steps as in the benchmark except for a few
steps. Specifically, we must recompute the total profits made by firms ΠH :
                                                         "                                  #
                                  H
                                        X                                    1
                                 Π =        (1 − αC ) Xj 1 −                                  ,
                                                                                       τjH
                                         j                      dHj + 1 ((1 − αC ) Xj )


where
                                                X                           X                
                                       Xj =         wjθ Lθj + ΠH +                   τjθ − Tjθ Lθj .

The values of Xj and ΠH are calibrated so that these equations hold. In addition, the calibration of the non traded
shares is amended to:                                         !
                                    i      1 + dH,j Wj NjN T                    H
                               1 − ηH,I =                       ((1 − αC ) Xj )τj .
                                            1 − αC      Xj
The rest of the calibration is unaffected.


D.3     Production with 3 Skill Groups
Model We continue to assume the same structure for the spillovers as in our benchmark case, on the basis of
U = {L, M } and S = {H} types, so that (44) and (45) now become:
                                                                P
                                                               γU,θ     P
                                                                      γS,θ
                                             zjθ = Zjθ LU    M
                                                        j + Lj        LH
                                                                       j     ,                                                                 (A.31)
                                                              A 
                                                             γU,θ      A
                                                                      γS,θ
                                           aθj ≡ Aθj LU    M
                                                      j + Lj       LH
                                                                    j       ,                                                                  (A.32)




                                                                     66
                                      j      j       j       j                     j       j         j      j
where we have noted, for j = P, A, γU,θ  = γU,U and γS,θ = γS,U  for θ = {L, M }, γU,θ = γU,S  and γS,θ = γS,S for
θ = {H}. Following similar steps as in the benchmark model, the total number of efficiency units (A.58) becomes
                                        θ θ
                          P                   
                             θ∈{U,H} wi Li        /δ                                    wiM LM
                                                                       δ
              N̂i =               θ θ
                                                              NiˆU H        +P                i           zˆiM LˆM
                                                                                                                   i ,   (A.33)
                                                  wiM LM                                wiθ Lθi /δ + wiM LM
                      P
                        θ∈{U,H} wi Li /δ +             i                      θ∈{U,H}                     i


where NiˆU H is the change in the efficiency units supplied by low and high skill workers:
                                 "                                                                       #1
                                                                                                           ρ
                                          wiU LU              ρ         wiM LM               ρ
                      NiˆU H =       P         i
                                                 θ0 θ0
                                                        ziUˆLU
                                                             i    +P           i
                                                                                 θ0 θ0
                                                                                         ziMˆLM
                                                                                              i                .         (A.34)
                                     θ 0 ∈{U,H} wi Li                θ 0 ∈{U,H} wi Li


In turn, the spillover functions (A.59) and (A.61) become:
                                                                                     P
                                                                                   !γS,θ
                                                    P
                                                γU,θ           LM       LH
                                         zˆiθ = LˆU                 LˆM      LˆM
                                                                  j        j
                                                  j               S   j +      j           ,                             (A.35)
                                                                 Lj       LS
                                                                           j
                                                                                     A
                                                                                   !γS,θ
                                                    A
                                                γU,θ           LM       LH
                                         aˆθi = LˆU                 LˆM      LˆM
                                                                  j        j
                                                  j               S   j +      j           .                             (A.36)
                                                                 Lj       LS
                                                                           j




                        Figure A.5: Change in Population by Skill Group (3 skills)




Calibration To calibrate this version of the model, we extend our dataset to 3 skill groups. Using the same
procedure as described in the main text, we build a Census/BEA dataset for three skill group. We define L as low-skill
workers, with no college education; M as medium-skill workers, with some college education; and H and high-skill
workers, with 4 years of college or more. To calibrate the production function parameter, we follow Eeckhout et al.
(2014). We use the same value of ρ as in our benchmark calibration (ρ = 0.392) and back out δ using the same
formula as in Eeckhout et al. (2014), which gives λ = 1.124.60 The rest of the calibration is unchanged.




   60
     See Eeckhout et al. (2014), section VIII. Quantifying the Production Technology. Given a value for ρ (denoted
γ in Eeckhout et al. (2014)), equation (A27) of their Appendix A gives the expression for λ, as a function of ρand of
summary statistics from the data on wages and population by skill group.


                                                                   67
D.4      Imperfect Mobility
Model In this case, the type θ = (s, o) indexes both skill and origin. City amenity and productivity are now not
only skill- but also origin-specific:
                                                                                             !γ P0
                                                                  Y         X                   s ,s

                                            zjs,o   =   Zjs,o                      Ls,o
                                                                                    j                               (A.37)
                                                                s0 ∈{U,S}   o∈O
                                                                                             !γ A0
                                                                  Y         X                   s ,s

                                            as,o
                                             j      =   As,o
                                                         j                         Ls,o
                                                                                    j                               (A.38)
                                                                s0 ∈{U,S}   o∈O


In production, we further assume that workers from the same origin are perfect substitutes in production. Specifically,
rather than (43) we now impose
                                                                    !ρ  ρ1
                                                 X       X s,o s,o
                                        Nj =               z j Lj       .
                                                        s∈{U,S}       o∈O

Following similar steps as in the benchmark model, the total number of efficiency units (A.58) becomes
                                                                                                         1
                                                                                                              ρ
                                                    X  o∈O wis,o Ls,o
                                                       P                                           ρ
                                                                   i
                                        N̂i =                                                Nˆis                 (A.39)
                                                                      Wi Ni
                                                s∈{U,S}


where the change in the efficiency units supplied by workers with skill s is
                                                                        !
                                                          wis,o Ls,o
                                                                          Lˆs,o
                                                  X
                                          ˆs   ˆs
                                         N i = zi                i
                                                       P      s,o0 s,o0     i .                                     (A.40)
                                                  o∈O    o0 wi     Li

The spillover functions (A.59) and (A.61) take the same form as before, where now the change in the number of
workers in skill group s is:
                                                   X  Ls,o 
                                                              Lˆs,o
                                              ˆs         j
                                             Lj =         s     j .                                    (A.41)
                                                   o∈O
                                                        L j

Finally, (A.60) becomes:
                                                      −σs                         ˆ
                                                                                   xs,o
                                             ˆ = Lˆs,o
                                            us,o   j        aˆsj                  αC
                                                                                    j
                                                                                             1−αC    .              (A.42)
                                                                            Pˆj        R̂j

Calibration The ACS reports the state of birth. To limit computational burden, we use as origin the region of
birth corresponding to one of five Census regions (NW,SW,NE,SE and foreign-born). For each MSA, we compute the
share of workers born in each of these 5 regions, and the corresponding share of total wages. We then split the total
population and wage bill for each skill group and MSA (as calibrated in the benchmark) into these 5 regions of origins
using these shares. We assume that total disposable income for each skill and MSA, as calibrated in the benchmark
exercise, is split into recipients from these 5 regions according to their share of the wage bill. To calibrate the Frechet
parameter that governs idiosyncratic preferences for location we use a value of σ = 1/3, which corresponds to a
median value across existing estimates reported in Fajgelbaum et al. (2018). The rest of the calibration is unchanged.


D.5      Other specifications
Expenditure vs wage The calibration that ignores the transfers in the data and sets worker expenditures
equal to income simply sets xθj = wjθ and tθj = 0.




                                                                     68
Local ownership of fixed factors Under the assumption that land ownership is local, we construct expen-
diture by group and by MSA, xθi in the model, similarly to Equation A.10, except that now profits are city-specific:

                                                    xθi = wiθ − τiθ + Tiθ + bθ ΠH
                                                                                i .                                                     (A.43)

The local returns to land ΠH
                           i that are consistent with the general equilibrium of the model are:


                                                                 γiH
                                                                          
                                                  ΠH
                                                   j   =        H
                                                                                (1 − αC ) Xi ,
                                                               γi + 1

                                                                                                                                  (wiθ −τiθ!+Tiθ )Lθi
                                                                                                                          P
                      xθi is total final expenditure in the city. We combine these expressions, to calibrate Xi =             θ
               P
where Xi =        θ                                                                                                                  γH
                                                                                                                                                        ,
                                                                                                                          1−          i     (1−αC )
                                                                                                                                   γ H +1
                                                                                                                                    i
where wiθ , τiθ , Tiθ , Lθi
     
                              are taken from the data. The rest of the procedure is unchanged.


Assuming away trade costs Absent trade costs, the price of tradables is the same in all cities. All desti-
nation cities buy the same share of output coming from various origin cities. In particular, the share of location i’s
imports originating from j is proportional to total output of j Yj , so that:

                                                                      Yj
                                                               sM
                                                                ji = P      ,                                                           (A.44)
                                                                       k Yk
                                                                          
                                                                    Ei
The export shares are then constructed using sX
                                              ji ≡                 pj Yj
                                                                               sM
                                                                                ji , where spending Ei and traded income pj Yj .



Complementarity vs spillovers In the baseline calibration, we also explore results for alternative values
for the complementarity between H and L, captured by the elasticity of substitution parameter ρ. The weaker the
complementarity parameter, the stronger the calibrated values of the cross-productivity spillovers. Table A.3 shows
the welfare gains corresponding to different values of ρ, recalibrating the productivity spillovers each time. The first
row is the baseline. The second row takes a complementarity parameter twice as small as in the baseline. The third
row takes an elasticity of substitution twice as small as in the baseline. The last row take a very low value for the
complementarity parameter, proxying for the limit case ρ = −∞. The stronger the productivity spillovers, the less
congestion there is to correct for in the economy. As a result, welfare gains decrease when productivity spillovers get
stronger.

                                Table A.3: Gains for Different Substitution Elasticities

                                  Specification    Elasticity of substitution              Welfare Gain (%)
                                    ρ = 0.392                      1.65                          4.0
                                  ρ = 0.392/2                      1.25                          3.9
                                   ρ = −0.216                   1.65/2                           3.7
                                    ρ = −10                        0.09                          2.4




                                                                       69
