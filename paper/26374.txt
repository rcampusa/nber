                              NBER WORKING PAPER SERIES




          INFERENCE FOR LINEAR CONDITIONAL MOMENT INEQUALITIES

                                        Isaiah Andrews
                                         Jonathan Roth
                                          Ariel Pakes

                                      Working Paper 26374
                              http://www.nber.org/papers/w26374


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                   October 2019




We thank Gary Chamberlain, Ivan Canay, Kirill Evdokimov, Jerry Hausman, Bulat Gafarov,
Hiroaki Kaido, Adam McCloskey, Francesca Molinari, Whitney Newey, Ashesh Rambachan,
Jesse Shapiro, Brit Sharoni, Xiaoxia Shi, Joerg Stoye, and participants at several seminars for
helpful comments, and thank Thomas Wollmann for helpful discussion of his application.
Andrews gratefully acknowledges financial support from the NSF under Grant 1654234. Roth
gratefully acknowledges financial support from an NSF Graduate Research Fellowship under
Grant DGE1144152. The views expressed herein are those of the authors and do not necessarily
reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2019 by Isaiah Andrews, Jonathan Roth, and Ariel Pakes. All rights reserved. Short sections of
text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
Inference for Linear Conditional Moment Inequalities
Isaiah Andrews, Jonathan Roth, and Ariel Pakes
NBER Working Paper No. 26374
October 2019
JEL No. C12

                                         ABSTRACT

We consider inference based on linear conditional moment inequalities, which arise in a wide
variety of economic applications, including many structural models. We show that linear
conditional structure greatly simplifies confidence set construction, allowing for computationally
tractable projection inference in settings with nuisance parameters. Next, we derive least
favorable critical values that avoid conservativeness due to projection. Finally, we introduce a
conditional inference approach which ensures a strong form of insensitivity to slack moments, as
well as a hybrid technique which combines the least favorable and conditional methods. Our
conditional and hybrid approaches are new even in settings without nuisance parameters. We find
good performance in simulations based on Wollmann (2018), especially for the hybrid approach.


Isaiah Andrews                                  Ariel Pakes
Department of Economics                         Department of Economics
Harvard University                              Harvard University
Littauer M18                                    Littauer Room 117
Cambridge, MA 02138                             Cambridge, MA 02138
and NBER                                        and NBER
iandrews@fas.harvard.edu                        apakes@fas.harvard.edu

Jonathan Roth
Harvard University
jonathanroth@g.harvard.edu




A data appendix is available at http://www.nber.org/data-appendix/w26374
                  Inference for Linear Conditional
                        Moment Inequalities
               Isaiah Andrews            Jonathan Roth            Ariel Pakes

                                   September 17, 2019


                                           Abstract
          We consider inference based on linear conditional moment inequalities, which
      arise in a wide variety of economic applications, including many structural mod-
      els. We show that linear conditional structure greatly simplifies confidence set
      construction, allowing for computationally tractable projection inference in set-
      tings with nuisance parameters. Next, we derive least favorable critical values
      that avoid conservativeness due to projection. Finally, we introduce a condi-
      tional inference approach which ensures a strong form of insensitivity to slack
      moments, as well as a hybrid technique which combines the least favorable and
      conditional methods. Our conditional and hybrid approaches are new even in
      settings without nuisance parameters. We find good performance in simulations
      based on Wollmann (2018), especially for the hybrid approach.
      Keywords: Moment Inequalities, Subvector Inference, Uniform Inference
      JEL Codes: C12



1     Introduction
Moment inequalities are an important tool in empirical economics, enabling researchers
to use the most direct implications of utility or profit maximization for inference in
   
    We thank Gary Chamberlain, Ivan Canay, Kirill Evdokimov, Jerry Hausman, Bulat Gafarov,
Hiroaki Kaido, Adam McCloskey, Francesca Molinari, Whitney Newey, Ashesh Rambachan, Jesse
Shapiro, Brit Sharoni, Xiaoxia Shi, Joerg Stoye, and participants at several seminars for helpful
comments, and thank Thomas Wollmann for helpful discussion of his application. Andrews gratefully
acknowledges financial support from the NSF under Grant 1654234. Roth gratefully acknowledges
financial support from an NSF Graduate Research Fellowship under Grant DGE1144152. Andrews:
iandrews@fas.harvard.edu. Roth: jonathanroth@g.harvard.edu. Pakes: apakes@fas.harvard.edu


                                               1
both single-agent settings and games. Moment inequalities have also been used to
weaken parametric, behavioral, measurement, and selection assumptions in a range of
problems.1
   Inference based on moment inequalities raises a number of challenges. First, calcu-
lating tests and confidence sets can be computationally taxing in settings with more
than a few nuisance parameters (for instance, coefficients on control variables). Sec-
ond, a simple approach to inference in settings with nuisance parameters is to use
projection, but this can yield imprecise results. Finally, it is often unclear ex-ante
which of the many moments implied by an economic model will be informative, and
inclusion of uninformative or slack moments yields wide confidence sets for some pro-
cedures.
   This paper proposes new methods which address these three implementation chal-
lenges for an important class of moment inequalities, which we term linear conditional
moment inequalities. These are conditional moment inequalities that (a) are linear in
nuisance parameters and (b) have conditional variance (given the instruments) that
does not depend on the nuisance parameters. Such inequalities arise naturally when
the nuisance parameters enter the moments linearly and interact only with exogenous
variables. This occurs, for example, in regression and instrumental variables settings
with interval-valued outcomes and exogenous controls. Linear conditional structure
also appears in a number of structural applications of moment inequalities in the
empirical literature. We next discuss how linear conditional structure allows us to
overcome the challenges discussed above and construct powerful, tractable inference
procedures.
   The first challenge discussed above, computational burden, often arises from the
   1
     For recent overviews of research involving moment inequalities, and partial identification more
broadly, see Ho & Rosen (2017) and Molinari (2019). For the behavioral and measurement assump-
tions underlying the use of moment inequalitieis in problems where agents are assumed to maximize
utility or profit see Pakes (2010) and Pakes et al. (2015). For examples of inequalities generated by
first order conditions see Dickstein & Morales (2018) on export decisions and Holmes (2011) on Wal-
mart's location decisions. For examples of inequalities generated by Nash equilibrium conditions see
Ciliberto & Tamer (2009), Eizenberg (2014), or Wollman (2018) on entry and exit decisions. For ex-
amples of the use of inequalities to weaken assumptions see Haile & Tamer (2003) on auctions, Chetty
(2012) on labor supply, and Kline & Tartari (2016) on a welfare reform experiment. For moment
inequalities used to overcome measurement problems see Manski & Tamer (2002) on interval-valued
outcome variables and Ho & Pakes (2014) on errors in regressors in discrete choice models. For the
use of inequalities to overcome selection problems see Blundell et al. (2007) on changes in inequality
and Kreider et al. (2012) on take-up of SNAP. There is also closely related work in other fields, for
example on computation of bounds for competing risk models (e.g. Honore & Lleras-Muney (2006)
on the war on cancer).


                                                  2
use of test inversion. A common approach evaluates a test statistic on a grid of
parameter values and defines the confidence set as the set where the statistic falls
below a parameter-specific critical value. The computational cost of this approach
scales with the number of grid points, which typically grows exponentially in the
dimension of the parameter vector. Hence, these methods become very difficult to
apply in problems with more than a few parameters. We show that in settings with
linear conditional moment inequalities the nuisance parameters can be eliminated by
solving a simple linear program, so it suffices to specify a grid for the parameters of
interest. This allows us to easily compute confidence sets for the parameters of interest
even in cases where the dimension of the nuisance parameters renders traditional grid-
based techniques impractical.2
   The second challenge discussed above stems from the fact that many existing tech-
niques deliver joint confidence sets for all parameters entering the moment inequalities,
which must then be projected to obtain confidence sets for lower-dimensional parame-
ters of interest. For examples of projection in the theoretical and empirical literature,
see Canay & Shaikh (2017). As discussed by Bugni et al. (2017) and Kaido et al.
(2019a), however, projection can yield very conservative tests and confidence sets. We
show that in settings with linear conditional moment inequalities, it is straightforward
to derive computationally tractable least favorable critical values that account for the
presence of nuisance parameters, and so construct non-conservative confidence sets for
the parameters of interest.3
    The final challenge discussed above, sensitivity to slack moments, arises from the
fact that the distribution of moment inequality test statistics depends on the (un-
known) degree to which the moments are slack. As discussed by D. Andrews & Soares
(2010), the degree of slackness cannot be uniformly consistently estimated, so the least
favorable approach calculates critical values under the worst-case assumption that all
moments bind. The resulting procedures may have low power when this assumption
is false and many moments are slack. We show that in settings with linear conditional
moment inequalities, one can derive tests that condition on the set of binding mo-
ments in the data. Conditional tests are simple to implement and insensitive to slack
   2
     Note, however, that our asymptotic results (developed in the appendix) hold the number of
parameters and moments fixed. Hence, our analysis does not address settings that are "high-
dimensional" in the sense that the number of parameters or moments grows with the sample size.
   3
     In cases where some nuisance parameters enter the moments nonlinearly, these techniques deliver
confidence sets for the parameters of interest together with the nonlinear nuisance parameters.



                                                 3
moments in the strong sense that, as a subset of the moments becomes arbitrarily
slack, the conditional test converges to the test that drops these moments ex-ante.
Unlike the approach of e.g. D. Andrews & Soares (2010), conditional tests achieve
this insensitivity without a sequence of sample size-dependent tuning parameters. To
improve power in cases where conditional tests underperform, we further introduce
hybrid tests that combine least favorable and conditional techniques. Tests based on
a similar hybridization are used by Andrews et al. (2018) for inference following a
data-driven choice of a target parameter.
   For simplicity of exposition, the main text develops our results in a finite sample
normal model motivated as an asymptotic approximation. In the supplement, we
translate these finite sample results to uniform asymptotic results. We show that our
least favorable approach (with its critical value increased by an infinitesimal uniformity
factor as in D. Andrews & Shi (2013)) is uniformly asymptotically valid under minimal
conditions. Under additional conditions, which still allow for any combination of
binding and nonbinding moments in the population, we show uniformity for the least
favorable approach without the infinitesimal uniformity factor, and for versions of the
conditional and hybrid approaches which do not reject when the moments are far from
binding.
   To explore the numerical performance of our methods, we apply our techniques in
simulations calibrated to Wollman (2018)'s study of the US auto bailout. We consider
designs with up to ten nuisance parameters, and find that our approach remains
tractable throughout. We find substantial power improvements for our least favorable
critical values relative to the projection method. We find further improvements for
our conditional approach at most parameter values. Finally, we find that our hybrid
approach performs well, with power never substantially below and often exceeding the
other procedures considered. Hence, we recommend the hybrid approach.

Related Literature Uniform inference on subsets of parameters based on linear
moment inequalities was previously studied by Cho & Russell (2019) and Gafarov
(2019). Flynn (2019) further allows for the possibility of a continuum of linear mo-
ments. Unlike our approach these papers consider unconditional moment inequalities,
but do not discuss the case where the parameters of interest may enter the moments
nonlinearly. Hsieh et al. (2017) propose a conservative form of projection inference
for settings which include linear unconditional moment inequalities. Kaido et al.


                                            4
(2019a) develop techniques for eliminating projection conservativeness, while Bugni
et al. (2017) develop an alternative approach for inference on subsets of parameters,
and Belloni et al. (2018) build on this approach to develop results for subset inference
with high-dimensional unconditional moments. All three techniques are more widely
applicable than those we develop, requiring neither linearity nor conditional moment
inequalities. At the same time, all can be computationally intensive in settings with a
large number of nuisance parameters.4 Chernozhukov et al. (2015) develop techniques
for subset inference based on conditional moment inequalities, which unlike our ap-
proach do not require linearity. Romano & Shaikh (2008) discuss subvector inference
based on subsampling. Chen et al. (2018) discuss confidence sets for the identified set
for subvectors based on a quasi-posterior Monte Carlo approach.
    Finally, there is a large literature on techniques which seek to reduce sensitivity
to the inclusion of slack moments in settings without nuisance parameters, including
D. Andrews & Soares (2010), D. Andrews & Barwick (2012), Romano et al. (2014a),
and Cox & Shi (2019). Chernozhukov et al. (2015), Bugni et al. (2017), Belloni et al.
(2018), and Kaido et al. (2019a) build on related ideas to reduce sensitivity to slack
moments in models with nuisance parameters. If applied in our setting, however, these
techniques would eliminate the linear structure which simplifies computation. Even in
settings without nuisance parameters our conditioning approach appears to be new,
and a small set of simulations without nuisance parameters (described in Appendix
F) finds our hybrid approach neither dominates nor is dominated by the test proposed
by Romano et al. (2014a).

Preview of Paper The next section introduces our linear conditional setting. Sec-
tion 3 develops a conditional asymptotic approximation that motivates our analysis,
and discusses the relationship between our approach and the literature on conditional
moment inequalities. Section 4 introduces projection and least favorable tests, while
Section 5 introduces conditional and hybrid tests. Section 6 discusses the practical
details of implementing our approach, while Section 7 reports Monte Carlo results. A
reader looking to apply our methods but not interested in the theory can skip from
Section 3 to Section 6. Additional technical results are stated in Appendices A and
B, while proofs for all results in the main text are provided in Appendix C. Uniform
   4
    Kaido et al. (2019a) propose the use of a response surface technique to facilitate computation,
and find that it yields substantial improvements. See Kaido et al. (2019a) and Gafarov (2019) for
further evidence on computational performance.


                                                5
asymptotic results are stated Appendix D and proved in Appendix E. Results from
a small simulation study without nuisance parameters are reported in Appendix F,
while additional details and results for the simulations in the main text are reported
in Appendix G.


2    Linear Conditional Moment Inequalities
Throughout the paper, we assume that we observe independent and identically dis-
tributed data Di , i = 1, ..., n drawn from a distribution P . We are interested in
parameters identified by k -dimensional conditional moment inequalities

                        EP [g (Di , , ) |Zi ]  0 almost surely                     (1)

assumed to hold at the true parameter value, for g (Di , , ) a known function of the
data and parameters. Going forward we leave the "almost surely" implicit for brevity.
We seek tests and confidence sets for , while the p-dimensional vector is a nuisance
parameter. Formally, we want to test the null that a given value 0 belongs to the
                e 0 : 0 2 BI (P ), where
identified set, H

           BI (P ) = { : there exists     such that EP [g (Di , , ) |Zi ]  0}

is the set of all values such that there exists which makes (1) hold.
    We assume that the moment function g (Di , , ) is of the form

                        g (Di , , ) = g (Di , , 0)     X (Zi , )                   (2)

for some k  p matrix-valued function X (Zi , ) of the instruments and the parameter
of interest . This imposes two key restrictions. First, (2) requires that the nuisance
parameter enter the moments linearly. Since linear models are widely used in eco-
nomics, this holds in a wide variety of applications. Second, (2) requires that the
derivative of the moments with respect to be non-random conditional on the in-
struments Zi . Stated differently, we require that the moment inequalities (1) hold
conditional on the Jacobian of the moments with respect to . This implies that

                   V arP (g (Di , , ) |Zi ) = V arP (g (Di , , 0) |Zi ),


                                            6
so the conditional variance of the moments does not depend on . This condition
plays a crucial role in the asymptotic approximation developed in Section 3 below.
   We call moment inequalities satisfying (1) and (2) linear conditional moment in-
equalities. They can be understood as a generalization of the linear model with ex-
ogenous regressors and outcome Yi ,

                            Yi = Xi0 + "i where EP ["i |Xi ] = 0,                   (3)

to the moment inequality setting. Specifically, for linear conditional moment inequal-
ities we can define
                            (Yi , Xi ) = (g (Di ,    0 , 0) , X   (Zi ,   0 ))      (4)

for   0   again the null value of . If   0   2 BI (P ), then we can write

                            Yi = Xi + "i where EP ["i |Zi ]  0.                     (5)

Thus, the linear conditional moment inequality model resembles a generalization of
the traditional linear regression model, where we (a) allow the possibility that there
are instruments Zi beyond the regressors Xi and (b) relax the conditional moment
restriction on the errors "i to an inequality. We show below that the restriction to
linear conditional moment inequalities yields important simplifications in the problem
of testing He 0 : 0 2 BI (P ). Before developing these results, we motivate our study
of linear conditional moment inequalities by showing that moment inequalities of this
form arise in a variety of economic examples.

Example 1 Linear conditional moment inequalities arise naturally from the linear
regression model (3), and its instrumental variables generalization, when we only
observe bounds on the outcome Yi . Consider the model

                            Yi = Ti + Vi0 + "i , EP ["i |Zi ] = 0

where Vi is exogenous in the sense that it is a function of Zi , while Ti may be endoge-
nous. For instance, may be a causal effect of interest, whereas Vi represents a set
of control variables. This is a linear instrumental variables model where the error is
mean-independent of the instrument.
    As in e.g. Manski & Tamer (2002), suppose that rather than observing Yi , we

                                                 7
instead observe bounds YiL and YiU where YiL  Yi  YiU with probability one. The
linear model (2) implies that E [YiL Ti  Vi0 |Zi ]  0 and E [Ti + Vi0 YiU |Zi ]  0,
so we obtain conditional moment inequalities. To cast these inequalities into our
framework, suppose we are interested in inference on , and for any vector of non-
negative functions of the instruments f (Zi ) let Yi ( ) = (YiL Ti , Ti    YiU )0  f (Zi ),
and Xi = (Vi  (1, 1)0 )  f (Zi ), for " " the Kroneker product. This yields the moments
E [Yi ( ) Xi |Zi ]  0, as desired.5 4

Example 2 Katz (2007) studies the impact of travel time on supermarket choice.
Katz assumes that agent utilities are additively separable in utility from the basket of
goods bought (Bi ), the travel time to the supermarkets chosen (Ti,s ), and the cost of
the basket ( (Bi , s)). Normalizing coefficient on cost to one, agent i's realized utility
is assumed to be

                                               0
                     Ui (Bi , s) = Ui (Bi ) + Cs       ( + i )Ti,s      (Bi , s),

where Cs are observed characteristics of the supermarket, Ti,s is the travel time for i
going to s, and + i is its impact on utility, where i has mean zero given supermarket
characteristics and travel times.
    Katz assumes travel times and store characteristics are known to the shopper.
For s~ a supermarket with Ti,s ~ > Ti,s that also marketed Bi , he divides the difference

                     ~) by Ti,s Ti,s
Ui (Bi , s) Ui (Bi , s             ~ and notes that a combination of expected utility

maximization and revealed preference implies that E [Yi ( ) Xi |Zi ]  0, for

                   [ (Bi , s)    (Bi , s
                                       ~)]              Cs    Cs~
 Yi ( )                                    , Xi                    , and Zi  (Ti,s , Ti,s
                                                                                        ~, Cs , Cs
                                                                                                   0
                                                                                                 ~) .
                        Ti,s    Ti,s
                                   ~                   Ti,s   Ti,s
                                                                 ~


By adding an analogous inequality which uses a store closer to the agent, Katz obtains
both upper and lower bounds for .
   A similar approach can be used in any ordered choice problem, including those
with interacting agents; see Pakes et al. (2015), who also provide a way to handle the
   5
     Our approach to this application relies on the conditional moment restriction EP ["i |Zi ] = 0.
As discussed by Ponomareva & Tamer (2011), this means that the identified set may be empty if
the linear model is incorrect. For Zi = (Ti , Vi0 )0 , Beresteanu & Molinari (2008) assume only that
E ["i Zi ] = 0, and their approach yields inference on the (necessarily nonempty) set of best linear
predictors. Bontemps et al. (2012) study identification and inference, including specification tests,
for a class of linear models with unconditional moment restrictions.


                                                   8
boundaries of the choice set (as would occur in Katz's case if there were no closer
supermarket for some observations). 4

Example 3 Wollman (2018) considers the bailout of GM and Chrysler's commercial
truck divisions during the 2008 financial crisis and asks what would have happened
had they instead been allowed to either fail or merge with another firm. This example
is the basis for our simulations below.
   Merger analysis focuses on price differences pre- and post-merger. Wollmann notes
that some commercial truck production is modular (it is possible to connect different
cab types to different trailers), so some products would likely have been repositioned
after the change in the environment. To analyze product repositioning he requires
estimates for the fixed costs of marketing a product. His estimated demand and cost
systems enable him to estimate counterfactual profits from adding or deleting prod-
ucts. Assuming firms maximize expected profits, differences in the expected profits
from adding or subtracting products imply bounds on fixed costs.
    To illustrate, let Jf,t be the set of models that firm f marketed in year t and
let Jf,t /j be that set excluding product j , while  (Jf,t , Jf,t /j ) is the difference in
expected profits between marketing Jf,t and Jf,t /j . Denote the fixed cost to firm f
of marketing product j at time t by Xj,f,t ( ) where the X 's are product charac-
teristics and is a scalar which differentiates between marketing costs for products
that were and were not marketed in the prior year. Then if Zf,t represents a set of
variables known to the the firm when marketing decisions were made (which includes
the variables used to form Xj,f,t ( )), the equilibrium condition ensures that

                           E [Yj,f,t   Xj,f,t ( ) |Zf,t ]   0 for all j,

where

Yj,f,t     (Jf,t , Jf,t /j )·1{j 2 Jf,t , j 2 Jf,t 1 }, Xj,f,t ( )  Xf,j ( )·1{j 2 Jf,t , j 2 Jf,t 1 }

and 1{A} is an indicator for the event A. Additional inequalities can be added for
marketing a product that was not marketed in the prior period, for withdrawing
products, and for combining the withdrawal of one product with adding another. See
Section 7 below for details. 4
   Other recent applications that use linear conditional moment inequalities include

                                                 9
Ho & Pakes (2014), who study the effect of physician incentives on hospital referrals,
and Morales et al. (2019), who develop and estimate an extended gravity model of
trade flows. As the variety of examples illustrates, linear conditional moment inequal-
ities arise in a range of economic contexts.


3     Conditional Asymptotics
In this section we derive a normal asymptotic approximation that motivates the pro-
cedures developed in the rest of the paper. For (Yi , Xi ) = (g (Di , 0 , 0) , X (Zi , 0 )) as
in (4), recall that we can write the moments evaluated at 0 as g (Di , 0 , ) = Yi Xi .
We consider procedures that test H  e 0 : 0 2 BI (P ) based on the scaled sample average
of the moments evaluated at 0 ,

                                    1 X
                      gn ( 0 , ) = p     g ( Di ,   0,   ) = Yn    Xn ,
                                     n i
               P                      P
for Yn = p  1
             n   i Yi and Xn =
                                  p1
                                    n   i Xi . As in Bugni et al. (2017), we will form
confidence sets for by testing a grid of values 0 . Hence, for the moment we fix
a null value 0 and suppress dependence on 0 in our notation, deferring further
discussion of test inversion to Section 6 below.
    Similar to Abadie et al. (2014) we consider asymptotic approximations that con-
dition on the instruments {Zi } = {Zi }1 i=1 . If we define


                                 µi = µ (Zi ) = EP [Yi |Zi ]
                                                       P
as the conditional mean of Yi given Zi , and µn = p 1
                                                     n   i µi as the scaled sample average
                   e 0 : 0 2 BI (P ) there exists a value such that µn Xn  0 (for
of µi , then under H
almost every {Zi }). Since µn and Xn are nonrandom once we condition on {Zi }, to
test 0 2 BI (P ) we will test the implied hypothesis H0 : µn 2 M0 for

                 M0 = {µn : There exists       such that µn       Xn  0 } .               (6)

Note that 0 2 BI (P ) implies that µn 2 M0 for almost every {Zi }, so tests of
H0 : µn 2 M0 with correct size also control size as tests of He 0 : 0 2 BI (P ). Note
further that H0 : µn 2 M0 holds trivially conditional on {Zi } if the column span of
Xn contains a strictly negative vector. Hence, going forward we assume that Xn has

                                             10
at least one non-negative element for all .
   To derive asymptotic approximations useful for testing H0 , note that Yn µn has
mean zero conditional on {Zi } by construction. Thus, under mild conditions we can
apply the central limit theorem conditional on {Zi }.

Lemma 1 (Lindeberg-Feller) Suppose that as n ! 1, conditional on {Zi } we have
                                         
                1X                           1
                    EP [Yi Yi0 |Zi ] 1      p kYi k > "   ! 0 for all " > 0,
                n i                           n

                     1X
                         V arP (Yi |Zi ) !  = EP [V arP (Yi |Zi )].
                     n i

Then Yn    µn !d N (0, ).

   The first condition of Lemma 1 requires that the average of Yi given Zi not be
dominated by a small number of large observations, while the second requires that the
average conditional variance converge.
   Under these conditions, Lemma 1 suggests the normal approximation

                          Yn    Xn |{Zi } d N (µn         X n , ) ,                 (7)

where we use d to denote approximate equality in distribution, and we have used
that Xn is non-random conditional on {Zi } to put it on the right hand side in (7). In
the next three sections we assume this approximation holds exactly for known  and
derive finite-sample results. We return to the issue of approximation error in Appendix
D. There, we show that we can consistently estimate , and that the finite-sample
properties of our procedures in the normal model translate to uniform asymptotic
properties over large classes of data generating processes.

Choice of Moments Our asymptotic approximations focus on a fixed choice of
moments g (Di , , ), which we take as given. This is common in practice, including
in all of the empirical papers using conditional moment inequalities that we discuss
above, and is without loss of generality if the instruments Zi have finite support.
    For Zi continuously distributed, however, a single conditional moment inequality
implies an uncountable family of possible moments. Specifically, given a moment



                                               11
function g
         ~(Di , , ) that satisfies (1), for f (Zi ) non-negative

                                   g (Di , , ) = g
                                                 ~(Di , , )f (Zi )

also satisfies (1). To obtain consistent tests (that is, tests that reject all values
  0 62 BI (P ) with probability going to one as n ! 1), one may need to consider an

infinite number of inequalities in large samples.6 Motivated by this fact, the literature
on conditional moment inequalities, including D. Andrews & Shi (2013), Armstrong
(2014b) and Chetverikov (2018), has primarily focused on consistent and efficient in-
ference on ( , ) jointly, based on checking (at least asymptotically) an infinite number
of inequality restrictions. More recently, Chernozhukov et al. (2015) have developed
results that can be used for subvector inference with conditional moment inequalities.
Whether one can combine the results we develop here with results from the previous
literature on conditional moment inequalities to obtain tests that are consistent in
settings with continuously distributed Zi is an interesting topic for future work.


3.1       Comparison to Unconditional Approximation
In many empirical applications using conditional moment inequalities, inference is
based on asymptotic approximations that do not condition on {Zi }. This section
explores the relationship between such unconditional asymptotic approximations and
our conditional approach.

Lemma 2 Suppose that EP [Yi Yi0 ] and EP [Xi Xi0 ] are both finite. Then for all ,

                         Yn      Xn      E P [ Yn    Xn ] !d N (0, ( ))

for ( ) = V arP (Yi       Xi ) .

       This suggests the approximation

                            Yn      X n  d N ( E P [ Yn   Xn ], ( ))                            (8)

where He 0 : 0 2 BI (P ) implies that EP [Yn Xn ]  0 for some . Many commonly-
used approaches to testing joint hypotheses on ( , ), including D. Andrews & Soares
   6
    In particular, for a fixed, finite set of moments we may have µn 2 M0 with probability approach-
ing one even though 0 62 BI (P ).


                                                    12
(2010), D. Andrews & Barwick (2012), and Romano et al. (2014a), can be interpreted
as applications of this approximation.7
    Both (7) and (8) imply that the moments gn ( ) = Yn                     Xn are approximately
normal, but the means and variances differ. Considering first the mean vectors, note
that by the law of iterated expectations

                                 E P [ µn    X n ] = E P [ Yn     Xn ] .

Thus, the mean vectors in (7) and (8) coincide on average, but the mean vector in (7)
is random from an unconditional perspective while that in (8) is fixed.
    Turning next to the variance matrices, by the law of total variance

                 ( ) = EP [V arP (Yi          Xi |Zi )] + V arP (EP [Yi        Xi |Zi ])

                                     =  + V arP (µi          Xi ) .

Hence, we see that  ( ) is always weakly larger than  in the usual matrix order,
and will typically be strictly larger. Thus, using the conditional approximation (7) we
obtain a smaller variance matrix.8 While the smaller variance matrix in the conditional
approximation (7) will often lead to more powerful tests, one can show that this is
not universally the case for the procedures we consider.9 Critically for our results,
however,  does not depend on , whereas V arP (µi Xi ) . does.


4       Least Favorable Tests
Recall that we are interested in testing the hypothesis H0 : µn 2 M0 under the linear
normal model (7). The unknown parameter appears in the null hypothesis, and
is a nuisance parameter that needs to be dealt with to allow testing. A common
approach to handling nuisance parameters in moment inequality settings is the pro-
    7
     The main text in Romano et al. (2014a) uses bootstrap critical values, but the appendix, Romano
et al. (2014b), develops results for the normal model.
   8
     Conditional variances were previously considered by e.g. Chetverikov (2018) for inference with
conditional moment inequalities, and by Kaido et al. (2019b) and Barseghyan et al. (2019) for settings
with a discrete instrument. We discuss estimation of  in Section 6 below.
   9
     Though the diagonal terms in  are smaller than those in ( ), and this will lead to larger
values of the the test statistics introduced below, their off diagonal correlations also differ, which can
generate larger critical values.



                                                   13
jection method (see Canay & Shaikh 2017 for examples). We begin by describing the
projection method in our setting. We then explain why linear conditional structure
allows us to eliminate the computational problems which can arise for the projection
method. Finally, to avoid the conservativeness of the projection method, we derive
(non-conservative) least-favorable critical values.


4.1       A Projection Method Test
The projection method tests the family of hypotheses

                                  H0 ( ) : µn       Xn  0 ,     2 Rp                               (9)

and rejects H0 : µn 2 M0 if and only if we reject H0 ( ) for all . Provided our tests of
H0 ( ) control size the projection method test does as well, since one of the hypotheses
tested corresponds to the true .
    Note that under H0 ( ), Yn Xn is normally distributed with a weakly negative
mean. Thus, testing H0 ( ) reduces to testing that the mean of a multivariate normal
vector is less than or equal to zero. A number of tests have been proposed for this
hypothesis, but here we focus on tests that reject for large values of the max statistic
                                             n                           p        o
                        S (Yn    Xn , ) = max (Yn,j           Xn,j ) /       jj
                                                j


where Yn,j Xn,j denotes the j th element of the vector Yn Xn and jj is the j th
diagonal element of , which we assume throughout is strictly positive for all j.10
This choice of test statistic will allow us to compute projection tests of the composite
hypothesis H0 : µn 2 M0 via linear programming. That said, many of the results
of this section (though not those in the following section) extend directly to other
statistics S (·, ·) that are elementwise increasing in the first argument.
    To test H0 ( ) based on S (Yn Xn , ) , we need a critical value. As discussed in
e.g. Rosen (2008) and D. Andrews & Guggenberger (2009), to ensure correct size we
can compare S (Yn Xn , ) to the maximum of its 1  quantile over data generating
processes consistent with H0 ( ). Formally, let c ( , ) be the 1 -quantile of S ( , )
 10
      Desirable properties for tests based on this statistic are discussed by Armstrong (2014a).




                                                    14
for   N ( , ). The least favorable critical value is then

                           c,LF P () = sup c ( , ) = c (0, ),
                                               0


where the fact that the sup is achieved at                     = 0 follows from the fact that S is
elementwise increasing in its first argument. We subscript by LF P to emphasize that
this is the least favorable critical value for testing H0 ( ), which is in turn part of the
projection test for H0 .
    If we define the test of H0 ( ) to reject when S (Yn Xn , ) exceeds c,LF P (),

                         LF (   ) = 1{S (Yn          Xn , ) > c,LF P ()},

where we use = 1 and = 0 to denote rejection and non-rejection respectively, then
it follows from the argument above that LF ( ) has size  as a test of H0 ( ):

                                    sup            E µn [   LF (   )] = .
                                 µn :µn Xn 0


The least favorable projection test of H0 rejects if and only if              LF (   ) rejects for all ,
                                                                         
              LF P   = inf LF ( ) = 1 min S Yn                     Xn ~,  > c,LF P () .
                                               ~


For any µn 2 M0 we know that there exists (µn ) such that µn                     Xn (µn )  0, so

                                     sup Eµn [            LF P ]    .
                                    µn 2 M 0

                                                          
   As we now show, the fact that neither min ~ S Yn Xn ~,  nor the critical value
c,LF P () = c (0, ) depends on makes LF P particularly easy to compute.

Lemma 3 We can write

                                   LF P   = 1 {^ > c,LF P ()}

for ^ the solution to

                                               min, 
                                                       p                                           (10)
                         subject to (Yn,j       Xn,j )/ jj   8j.

                                                     15
Thus, to calculate LF P we need only solve a linear programming problem and calcu-
late c,LF P (). Hence, LF P remains tractable even when the dimension of is large.11
The linear normal model (7) plays a key role in this result in two ways, first through
linearity in and second, perhaps less obviously, through the fact that the covariance
 (and thus the critical value c,LF P ()) does not depend on .
    If we instead considered projection tests based on the unconditional normal ap-
proximation (8), this corresponds to substituting ( ) for  in our expressions for
  LF ( ) and LF P , and implies the unconditional projection method test

                           n                                                      o
                 U
                 LF P   = 1 min (S (Yn          Xn , ( ))        c,LF P (( ))) > 0 .

The dependence of ( ) on means that evaluating this test requires nonlinear opti-
mization. While this problem can be solved numerically when the dimension of is
low, when the dimension is high this becomes computationally taxing.12
    Thus, we see that the linear conditional structure we assume allows us to easily
calculate the least favorable projection method test LF P . As discussed by Bugni
et al. (2017) and Kaido et al. (2019a), however, projection method tests are typically
conservative,
                                       sup Eµn [       LF P ]   < ,
                                     µn 2 M 0

and can be severely so when the dimension of the nuisance parameter                    is large.


4.2     A Least Favorable Test
To see why the projection test LF P is conservative, recall that that its critical value
is calculated as the 1  quantile of S ( , ) where   N (0, ). By contrast,           ^ is
equal to min S (Yn Xn , ). Hence, c,LF P () does not account for minimization
over . In this section we use the structure of the normal linear model (7) to derive
smaller, non-conservative least favorable critical values that account for minimization
over .
  11
     Other recent applications of linear programming in set-identified settings include Mogstad et al.
(2018), Khan et al. (2019), Tebaldi et al. (2019), and Torgovitsky (2019).
  12
     Kaido et al. (2019a) discuss a response surface approach to speed this optimization in a more
general setting.




                                                  16
   Specifically, define c (µn , Xn , ) as the 1        quantile of

                                     min, 
                                             p                                      (11)
                        subject to (j Xn,j )/ jj   8j.

when   N (µn , ). The (non-conservative) least favorable critical value is

                         c,LF (Xn , ) = sup c (µn , Xn , ) .
                                           µn 2 M 0


Note that the least favorable projection critical value c,LF P () corresponds to set-
ting = 0 in (11), rather than minimizing. Hence, by construction c,LF (Xn , ) 
c,LF P (). If we define the least favorable test to reject when the max statistic exceeds
c,LF (Xn , ),
                n                                          o
         LF   = min S (Yn     Xn , ) > c,LF (Xn , ) = {^ > c,LF (Xn , )} ,

then provided ^ is continuously distributed this test has size ,

                                  sup Eµn [       LF ]   = .
                                 µn 2M 0


If instead the distribution of  ^ has point mass, the size is bounded above by .
    While describing the least favorable critical value c,LF (Xn , ) is conceptually
straightforward, to derive it in practice we need to maximize the quantile c (µn , Xn , )
over the set of µn values consistent with the null. The linear structure of the problem
implies that the maximum is attained at µn = 0.

Proposition 1
                             c,LF (Xn , ) = c (0, Xn , ) .

This result follows immediately from the observations that (i) c (µn , Xn , ) is invari-
ant to shifting µn by Xn ~, in the sense that for all ~,
                                                           
                        c (µn , Xn , ) = c µn + Xn ~, Xn ,  ,

(ii) that c (µn , Xn , ) is non-decreasing in µn , and (iii) that for every µn 2 M0 there
exists (µn ) such that µn Xn (µn )  0.
     To calculate the LF critical value we can simulate draws   N (0, ), solve the

                                             17
linear programming problem (11) for each draw, and take the 1           quantile of the
resulting optimized values. While the need to repeatedly solve the problem (11) means
that this approach requires more computation than the projection method, it remains
highly tractable and yields a non-conservative test.


5    Conditional and Hybrid Tests
While less conservative than the projection approach, least favorable critical values
still assume that all the moments are binding, µn = 0. In practice we may suspect that
some of the moments are far from binding, and the data may be informative about this.
Motivated by this fact, D. Andrews & Soares (2010), D. Andrews & Barwick (2012),
Romano et al. (2014a), and related papers propose techniques that use information
from the data to either select moments or shift the mean of the distribution from
which the critical values are calculated. This allows them to construct tests with
higher power in empirically relevant cases where many of the moments are slack.
    In our setting one can test H0 : µn 2 M0 by first using one of the aforementioned
approaches to test H0 ( ) as defined in (9) for all and then applying the projec-
tion method. This yields a conservative test, but Kaido et al. (2019a) show how to
eliminate this conservativeness when considering projections based on D. Andrews &
Soares (2010). Unfortunately, however, projection tests based on moment-selection
procedures break the linear structure discussed in the last section. Implementing
these approaches consequently requires solving a nonlinear, non-convex optimization
problem.
    To obtain procedures which both perform well when we have slack moments and
preserve linearity, we introduce a novel conditional testing approach. When there is
a unique, non-degenerate solution in the linear program (10), exactly p + 1 of the
inequality constraints bind at the optimum. We propose tests which condition on the
identity of these binding moments, and on a sufficient statistic for the slackness of the
remaining moments. These tests control size both conditional on the set of binding
moments and unconditionally, and are highly computationally tractable. Moreover,
these tests are insensitive to the presence of slack moments in the sense that as a subset
of the moments grows arbitrarily slack the conditional test approaches the test which
drops the slack moments ex-ante. Conditional tests thus automatically incorporate a
strong form of moment selection.


                                           18
   When the solution to (10) is non-unique or degenerate the set of binding moments
is no longer uniquely defined, which would seem to pose a problem for the conditional
test as described above. We show, however, that a reformulation of the conditional
approach based on the dual linear program continues to apply in such settings. This
approach is equivalent to conditioning on the set of binding moments in (10) when
there is a unique, non-degenerate solution but remains valid and easy to implement
even when these conditions fail.
   In what follows, we first introduce the test in a special case where there are no
nuisance parameters      before turning to our results for the general case with a unique,
non-degenerate solution. Results for the formulation based on the dual linear program,
which allow for non-unique or degenerate solutions, are discussed in Section 5.3 and
formally developed in Appendix A.


5.1    Special Case: No Nuisance Parameters
To develop intuition for our conditional approach we first consider a model without
nuisance parameters . To further simplify, we assume that the variance is equal to
the identify matrix,  = I . Our problem then reduces to that of testing µn  0 based
on Yn  N (µn , I ), which has been well-studied in the previous literature.
   In this setting, ^ is simply the max of the moments,   ^ = S (Yn , I ) = maxj {Yn,j }.
With probability one there is a unique binding constraint in the linear program (10),
corresponding to the largest moment. Once we condition on the identity of the largest
moment, ^     j = arg maxj Yn,j , the problem becomes one of inference based on a normal
vector conditional on the max occurring at a particular location, ^      j = j.
    Unfortunately, the distribution of                                ^
                                                    j conditional on j = j still depends on
                                             ^ = Yn,^
the full vector µn . This dependence comes from the fact that ^    j = j if and only if Yn,j
max~ j 6=j Yn,~j , where the distribution of the lower bound depends on {µn,~
                                                                                    ~
                                                                                j : j 6= j }. To
eliminate this dependence, we further condition on the value of the second largest
moment. Once we condition on ^         j = j and on the value of the second largest moment,
say max~            j = V ,  ^ follows a truncated normal distribution
                          lo
           j 6=j Yn,~

                          
                        ^| ^
                                          j = V
                           j = j & max Yn,~     lo
                                                           | V lo  
                                       ~
                                       j 6=j


for   N (µn,j , 1).


                                               19
    Lemma A.1 of Lee et al. (2016) shows that this truncated normal distribution
is increasing in µn,j , so since µn,j  0 under the null, the 1  quantile of the
conditional distribution under µn,j = 0 is a valid conditional critical value. We denote
this conditional critical value by c,C (j, V lo , I ). The conditional test
                                                             
                               C   =1 ^ > c,C ^
                                              j, max Yn,~
                                                        j, I
                                                       ~
                                                       j 6=^
                                                           j


has maximal rejection probability equal to  under the null, conditional on ^     j = j
and max~        j = V . By the law of iterated expectations its unconditional rejection
       j 6=j Yn,~
                     lo

probability under the null is thus bounded above by  as well, and this bound is
achieved at µn = 0. Thus, C is a size  test of H0 : µn  0.
    The simplicity of the present setting allows us to highlight some important features
of the conditional test. When the second largest element of µn , say max~             j , is very
                                                                             j 6=j µn,~
negative while the largest element (µn,j ) is not, ^    j = j with high probability. In this
case, the lower truncation  point is very small   with high probability, so the truncated
normal critical value c,C ^ j, max~         j , I is close to the level 1  standard normal
                                       j Yn,~
                                   j 6=^
critical value with high probability. Thus, when the largest element of µn is well
separated from the remaining elements, the conditional test closely resembles the test
which limits attention to the j th moment ex-ante, j = 1{Yn,j > c } for c the level
1  standard normal critical value. The power of j lies on the power envelope for
tests of H0 : µn  0 when all the other elements of µn are negative (see Romano et al.
2014b). Thus, the conditional test has power approaching the power envelope when
we take all moments but one to be slack. More broadly, Proposition 3 below shows
that if we take a subset of elements of µn to 1, the conditional test converges to
the conditional test which drops the corresponding moments ex-ante.
    The only other test that we know of which shares this strong insensitivity property,
while also controlling size in the finite sample normal model, is that of Cox & Shi
(2019).13 In particular, while the tests of D. Andrews & Barwick (2012) and Romano
et al. (2014a) are relatively insensitive to the presence of slack moments, they are both
affected by the addition of slack moments.14 While the test of Cox & Shi (2019) is
  13
     Specifically, the baseline test discussed in that paper, not the modification discussed in their
Remark 3. Interestingly, this test is also based on conditioning, though in the present example their
approach conditions on the identity of the non-negative moments, {j : Yj > 0}, while we condition
on the identity of the largest moment and the value of the second-largest moment.
  14
     Through the size correction factor in D. Andrews & Barwick (2012), and the first-stage critical


                                                 20
strongly insensitive to slack moments, its power does not in general converge to the
power envelope in the case where all moments but one are slack.
    This example also highlights a less desirable feature of our conditional test. When
the largest element of µn is not well-separated, µn,j  max~          j 6=j µn,j , the second-largest
moment max~            j will 
                  j Yn,~
              j 6=^           often be nearly as large as the largest moment. Since the con-
                                                    
ditional critical value c ^    j, max~      Y
                                          j n,~
                                      j 6=^   j , I  is always strictly larger than max~        j Yn,~
                                                                                            j 6=^    j,
this can lead to poor power for the conditional test. We illustrate this issue in simu-
lation in Appendix F.

Hybrid Tests To address power declines for the conditional test when the largest
element of µn is not well-separated we introduce what we call a hybrid test. This
modifies the conditional test to reject whenever the max statistic        ^ exceeds a level
 2 (0, ) least-favorable critical value, c,LF (I ). If   ^  c,LF (I ) we then consider a
conditional test, where we (i) further condition on the event that       ^  c,LF (I ) and
(ii) modify the level of the conditional test to reflect the first step. By the arguments
above the distribution of ^, conditional on not rejecting in the first stage, is again
truncated normal, now truncated both from below and above,
                  
             ^|
                     ^             j = V & 
                     j = j, max Yn,~    lo
                                           ^  c,LF (I )                   |V lo    c,LF (I )
                           ~
                           j 6=j


for   N (µn,j , 1). For c~ ,H (j, V , I ) the 1
                                   lo
                                                             ~ quantile of this distribution,
                                                             
                     
       inf P rµn       ^  c
                                     lo     ^
                           ~ ,H (j, V , I )|j = j, max Yn,~
                                                               lo
                                                          j = V , ^  c,LF (I )          =1      ~.
      µn 0                                           ~
                                                     j 6=j


To form hybrid tests, we set   ~=   1 
                                      
                                         to account for the first-step comparison to the
least favorable critical value. Since c~ ,H (j, V , I )  c,LF by definition, we can thus
                                                 lo

write the hybrid test as
                                                                    
                                   H   =1            ^
                                          ^ > c   ,H j, max Yn,~
                                                               j, I  .
                                                1               ~
                                                                j 6=^
                                                                    j


This test again has rejection probability under the null bounded above by , and this
bound is attained at µn = 0. By construction this test rejects whenever the level 
least favorable test does, which improves power relative to the conditional test when
value in Romano et al. (2014a).


                                                     21
the largest element of µn is not well-separated. While the hybrid test retains many
of the properties of the conditional test, its dependence on the least-favorable critical
value means that it is affected by the inclusion of even arbitrarily slack moments.
Similar to the test of Romano et al. (2014a), however, the impact is small when  is
close to zero.
    To illustrate the performance of hybrid tests in the present simplified setting,
Appendix F reports simulation results for cases with two, ten, and fifty moments. We
also calculate results for the test proposed by Romano et al. (2014a) for comparison.
We find that the hybrid approach improves power relative to the conditional test in
the poorly-separated case, while still improving power relative to the least favorable
test in the well-separated case. Neither the hybrid test nor the test of Romano et al.
(2014a) dominates the other: the test of Romano et al. (2014a) has better performance
in the poorly-separated case, while the hybrid test has slightly higher power when the
largest moment is moderately well-separated. Unlike the test of Romano et al. (2014a)
however, the hybrid and conditional tests easily extend to the case with nuisance
parameters . Simulation results based on Wollman (2018), reported in Section 7,
demonstrate that the power gains of the hybrid test are borne out in more realistic
settings with nuisance parameters.


5.2    Conditional Tests with Nuisance Parameters
We next discuss our conditional approach in the case with nuisance parameters and a
covariance matrix  which may not equal the identity. In this section we assume that
the linear program (10) has a unique, non-degenerate solution with probability one,
while Appendix A develops an alternative formulation for the conditioning approach,
based on the dual linear program, that does not impose these conditions. The primal
and dual approaches are numerically equivalent when the solution to (10) is unique
and non-degenerate (as we expect will often be the case in applications), so we focus
on the primal approach here for ease of exposition.15
   To define our conditional approach, note that we can rewrite (10) as

                                        min, 
                                                                                     (12)
                             subject to Yn Wn ( , 0 )0  0.
 15
    Degeneracy means that for Wn as defined below, the rows of Wn corresponding to binding
constraints are linearly dependent. See Section 10.4 of Schrijver (1986).


                                           22
                                                       p                    
for Wn the matrix with row j equal to Wn,j =              jj Xn,j . Let      ^, ^ denote
the optimal values in (12), which we assume for the moment are unique, and let
Bb  {1, ..., k } collect the indices corresponding to the binding constraints at these
optimal solutions, so Yn,j Wn,j (^                                  b Let Y b and W b
                                     , ^0 )0 = 0 if and only if j 2 B.     n,B       n,B
collect the corresponding rows of Yn and Wn .

                                                               b | = p + 1, and
Lemma 4 If the solution to (12) is unique and non-degenerate, |B
   b has full rank.
Wn,B

Since Yn,B  b   Wn,B                                      b Lemma 4 implies that (^
                        , ^0 )0 = 0 by the definition of B,
                    b (^                                                           , ^0 )0 =
Wn,B1                                                            b
          b . Thus, given a particular set of binding moments B = B, we can write       ^ as
     b Yn,B
a linear function of Yn ,
                                         0
                                    ^ = n,B Yn = e01 Wn,B
                                                        1
                                                          Yn,B ,

for e1 the first standard basis vector.
    We next consider under what conditions there exists a solution with moments B
binding.

Lemma 5 For B  {1, ..., k } such that Wn,B is a square, full-rank matrix, there exists
a solution with the moments B binding if and only if

                                  Yn         1
                                       Wn Wn,B Yn,B  0.                                 (13)

Thus we see that there exists a solution with the moments B binding if and only if
the implied (^ , ^0 )0 make the constraints in (12) hold.
   Our conditional test will condition on the existence of a solution with the moments
B binding and reject when      ^ is large relative to the resulting conditional distribution
under the null. The set of values Yn such that (13) holds is a polytope (a convex set
with flat sides, also known as a polyhedron­ see Schrijver 1986 pages 87-88), and as
noted above we can write     ^ as a linear function of Yn conditional on this event. Thus,
we are interested in the distribution of a linear function of a normal vector conditional
on that vector falling in a polytope. Lee et al. (2016) consider problems of this form,
and we can use their results to derive conditional critical values. We first calculate
the range of possible values for    ^ conditional on Yn falling in this polytope. We then
determine the distribution of     ^ over this range conditional on a sufficient statistic for
the part of µn not corresponding to      ^.


                                             23
       To this end we use the following result, which is an immediate consequence of
Lemma 5.1 of Lee et al. (2016).

Lemma 6 Let MB be the selection matrix which selects rows corresponding to B. Sup-
pose that Wn,B is a square, full-rank matrix, and let n,B be the vector with MB n,B =
  0 1
Wn,B  e1 , and zeros elsewhere. Assume n,B
                                         0
                                              n,B > 0. Let n,B = I Wn Wn,B      1
                                                                                  MB ,
and define
                                                         n,B
                                            n,B   =   0
                                                               ,
                                                      n,B  n,B

and Sn,B = I             0
                     n,B n,B   Yn . Further define

                                                                    (n,B Sn,B )j
                          V lo (Sn,B ) =          max                                                      (14)
                                           j :(n,B    n,B   )j <0   (n,B      n,B )j



                                                                    (n,B Sn,B )j
                         V up (Sn,B ) =           min                                                      (15)
                                           j :(n,B    n,B   )j >0   (n,B      n,B )j



                         V 0 (Sn,B ) =            min               (n,B Sn,B )j .
                                           j :(n,B n,B ) =0
                                                            j


The set of values Yn such that there exists a solution with the moments B binding is

                    1                                                0
 Yn : Yn      Wn Wn,B Yn,B  0 = Yn : V lo (Sn,B )                    n,B Yn    V up (Sn,B ), V 0 (Sn,B )    0 .

    This result shows that there exists a solution with the moments B binding if and
only if n,B
         0
              Yn lies between the data-dependent bounds V lo (Sn,B ) and V up (Sn,B ) and,
in addition, V 0 (Sn,B ) 0. When such a solution exists, however, our arguments above
show that    ^ = n,B0
                       Yn . Thus, whenever there exists a solution with the moments B
binding,   ^ lies between V lo (Sn,B ) and V up (Sn,B ) by construction.
    Lemma 6 assumes that n,B     0
                                     n,B > 0. This implies that      ^ has a non-degenerate
distribution conditional on the set of binding moments. While not necessary for our
conditional testing approach, this simplifies a number of statements in what follows,
so going forward we maintain a sufficient condition for n,B     0
                                                                   n,B > 0.16

Assumption 1 For all           with Wn
                                     0
                                       = e1 and                     0,   0
                                                                              > 0.
  16
    If this condition fails, we can define our conditional test to reject whenever n,B
                                                                                   0
                                                                                        n,B = 0 and
^ > 0, but this results in tests with size bounded above by , rather than exactly correct size.




                                                      24
One can show that          n,B   as defined in Lemma 6 has Wn
                                                            0
                                                                     n,B   = e1 and   n,B   0 for any
set of binding moments B . A sufficient, but not necessary, condition for Assumption
1 is that the variance matrix  is positive-definite.
       Lemma 6 clarifies what it means to condition on the existence of a solution with the
moments B binding, and thus the inference problem we need to solve. We are inter-
ested in the behavior of        0
                          ^ = n,B   Yn conditional on the set of binding moments, but as
in the simplified example above this conditional distribution depends on the full mean
vector µn , rather than just on n,B 0
                                       µn , due to the influence of the bounds V lo (Sn,B )
and V up (Sn,B ). Moreover, this conditional distribution is not in general monotonic in
µn , making it difficult to find least favorable values. To eliminate dependence on µn
other than through n,B 0
                          µn , we thus follow Lee et al. (2016) and further condition on
Sn,B , which is the minimal sufficient statistic for the part of µn other than n,B
                                                                                0
                                                                                     µn .17
Note that n,B0
                 Yn and Sn,B are jointly normal and uncorrelated by construction, and
thus independent. Hence,      ^ follows a truncated normal distribution conditional on
Sn,B and the set of binding moments.

Lemma 7 If the solution to (12) is unique and nondegenerate with probability one,
the conditional distribution of         b = B and Sn,B = s is truncated normal,
                                ^ given B
                        n                 o                        
                      ^| B
                          b = B & Sn,B = s   | 2 V lo (s), V up (s) ,

for   N (      0
               n,B µn ,
                          0
                          n,B  n,B ),   provided we consider a value s such that V 0 (s)        0.

   As in Section 5.1 above, this truncated distribution is increasing in the mean
 0
 n,B µn .Since n,B      0, n,B
                           0
                               Xn = 0,18 and µn Xn  0 under the null, the largest
value of n,B
           0
             µn possible under the null is zero. We define the conditional critical value
c,C ( , V , V up , ) to equal the 1  quantile of the truncated normal distribution
          lo


                                                             
                                            |  2 V lo , V up

for   N (0,      0
                 n,B  n,B ).     We can write this critical value as
                                               p
                   c,C ( , V lo , V up , ) =       0    ·   1
                                                                (1   )  up +  lo                (16)
  17
     In particular, Sn,B is minimal sufficient for I    n,B n,B µn and µn is a one-to-one transfor-
                                                             0

mation of n,B µn , I
              0
                            n,B n,B µn , since µn = I
                                0                               0
                                                            n,B n,B µn +  n,B n,B µn .
                                                                               0
  18
     This follows from Lemma 10 and Proposition 5 in Appendix A, but can also be verified directly
using the Kuhn-Tucker conditions for optimality of (^ , ^).


                                                   25
for   1
          the inverse of the standard normal distribution function, and
                                                   p                           p       
                     lo ,  up =           V lo /       0         ,    V up /       0       .

Thus, conditional critical values are easy to compute in practice.
   Assuming the solution to (12) is unique and nondegenerate with probability one
and Assumption 1 holds, the results above imply that the conditional test which
compares ^ to the conditional critical value,
                           n                                                           o
                    C   =1 ^ > c,C              b, V
                                              n,B
                                                        lo                up
                                                                 b ), V (Sn,B
                                                             (Sn,B          b ),           ,   (17)

                                                 b = B under the null, and thus has
rejects with probability at most  conditional on B
unconditional size  as well.

Proposition 2 If the solution to (12) is unique and non-degenerate with probability
                                                                                 b
one and Assumption 1 holds, the conditional test C has size  both conditional on B,
                                   h             i       h                     i
                        sup Eµn        C | b
                                           B = B   = E 0             C | b
                                                                         B = B   =
                     µn 2M 0

                         n      o
for all B such that P rµn Bb = B > 0, and unconditionally,

                                  sup Eµn [        C]   = E0 [       C]   = .
                               µn 2 M 0


5.3    Conditional Tests Without Uniqueness
In our discussion of conditional tests so far we have relied on the uniqueness and
non-degeneracy of the solution to ensure both that the set of binding moments B      b is
uniquely defined and that the matrix Wn,B is invertible. While these assumptions allow
us to obtain simple expressions for conditional tests, they are not essential. Even when
the solution (^ , ^) is nonunique or degenerate,  ^ is unique. Our conditioning approach
for the normal model remains valid in such cases, but we need to work with the dual
linear program to (12). This dual conditioning approach is numerically equivalent to
that described above when the primal solution is unique and non-degenerate. Since
formally developing the dual approach requires additional notation and adds little
intuition relative to the results above, we defer this development to Appendix A. There
we formally establish the numerical equivalence of the primal and dual approaches

                                                       26
when the former is valid, as well as conditional and unconditional size control for our
conditional tests based on the dual in the normal model, even when the primal solution
may be non-unique or degenerate. To prove asymptotic validity of the conditional
approach with non-normal data, our results in Appendix D require that the primal
solution be nondegenerate with probability one asymptotically, though it may be
non-unique. A sufficient condition for non-degeneracy is that  has full rank, so this
condition can be made to hold mechanically by adding a small amount of full-rank
noise to Yn .
   It is often not obvious whether the solution to (12) will be unique and non-
degenerate with probability one in a given setting. Fortunately, the results in Ap-
pendix A suggest a simple way to proceed in practice, based on the fact that the
widely-used dual-simplex algorithm for solving the primal problem (12) automatically
generates a vertex ^ of the dual solution set as well. Proposition 5 in Appendix A
shows that so long as ^ has exactly p + 1 strictly positive entries, and the rows of Wn
corresponding to these positive entries have full rank, we can take B   b to collect the
corresponding indicies and apply the results developed above. If this condition fails,
then we should use the more general expressions developed in Appendix A.


5.4     Performance with Slack Moments
We motivated our study of conditional tests by a desire to reduce sensitivity to slack
moments. To formally understand the behavior of conditional tests in cases where
some of the moments are slack, we will consider a sequence of mean vectors µn,m ,
indexed by m, such that a subset of the moments grow arbitrarily slack as m ! 1
while the remaining moments are unchanged. This yields the following result, which
generalizes the insensitivity to slack moments noted in Section 5.1 for the special case
without nuisance parameters to our general setting.

Proposition 3 Consider a sequence of mean vectors µn,m where µn,m,j  µn,j 2 R
for all m if j 2 B , while µn,m,j ! 1 as m ! 1 if j 62 B . Let us further suppose that
there exists B      0 with Wn,0
                                B B = e1 . Under Assumption 1, for Yn,m  N (µn,m , ),

  C,m the conditional test based on (Yn,m , Wn , ), and C,m the conditional test based
                                                         B

                                                  19
on (Yn,m,B , Wn,B , B ), C,m !p B   C,m as m ! 1.

  19
    Indeed, the same conclusion holds if there exists a sequence m and a vector such that µn,m,j
Xn,j m = µn,j Xn,j 2 R for all m if j 2 B , while µn,m,j Xn,j m ! 1 as m ! 1 if j 62 B .


                                               27
The restriction on Wn,B ensures that the feasible set in the dual problem based on
(Yn,m,B , Wn,B , B ) is non-empty, and thus that the solution in the primal problem is
finite (see Section 7.4 of Schrijver (1986)). When this condition fails, the optimal
value  ^ diverges to 1.
       Proposition 3 shows that the conditional tests we consider are robust to the pres-
ence of slack moments in a very strong sense. In particular, when a subset of moments
become arbitrarily slack, the conditional test converges in probability to the test which
drops these moments ex-ante. As noted above, even in settings without nuisance pa-
rameters the only other test we are aware of with this property in the normal model is
that of Cox & Shi (2019), and their approach does not address settings with nuisance
parameters (other than through projection).


5.5       Hybrid Tests
In Section 5.1 above, we noted that in the special case without nuisance parameters
conditional tests can have poor power in settings where the lower bound used by the
conditional test is large with high probability. The same issue arises more broadly,
and as in the case without nuisance parameters we can obtain improved performance
by considering hybrid tests.
   For some  2 (0, ) the hybrid test rejects whenever        ^ exceeds the level  least-
                                       20
favorable critical value c,LF (Xn , ). When      ^ is less than this conditional critical
value, the hybrid test compares    ^ to a modification of the conditional critical value
that also conditions on  ^  c,LF (Xn , ). This reduces V up (s) to

                           V up,H (s) = min {V up (s), c,LF (Xn , )} .

The level  hybrid test rejects whenever  ^ exceeds the level 1 
                                                               
                                                                 conditional critical
value based on the modified truncation points, where we define this quantile to equal
  1 if V lo exceeds V up,H ,
                           n                                                    o
                      H   =  ^ > c   
                                      ,C      ^ , V lo (Sn,B
                                                           b ), V
                                                                  up,H
                                                                           b ), 
                                                                       (Sn,B        .
                                   1 

  20
   Similar to Romano et al. (2014a), we consider  = /10 in our simulations below. Either
c,LF P () or c,LF (Xn , ) could be used here, the tradeoff being that c,LF (Xn , ) will provide a
smaller critical value but will have a somewhat higher computational burden.




                                                   28
Since
                                                        
           c 
              ,C      ^ , V lo (Sn,B
                                   b ), V
                                          up,H
                                                   b ),   V
                                               (Sn,B        up,H
                                                                     b )  c,LF (Xn , ),
                                                                 (Sn,B
           1 



this test always rejects when ^ > c,LF (Xn , ), as claimed above. The hybrid test
has size equal to 1  conditional on 
                   
                                    ^  c,LF and the set of binding moments, and
unconditional size equal to .

Proposition 4 If the solution to (12) is unique and non-degenerate with probability
one, and Assumption 1 holds, the hybrid test H has size   1 
                                                            
                                                              conditional on  ^ 
                 b = B,
c,LF (Xn , ) and B
           h                              i     h                                 i
 sup Eµn       H |^                  b = B = E0
                       c,LF (Xn , ), B                   H |^                  b=B = 
                                                                 c,LF (Xn , ), B
                                                                                          
                                                                                           ,
µn 2 M 0                                                                             1    
                         n                         o
for all B such that P rµn                   b = B > 0, and has unconditional size
                           ^  c,LF (Xn , ), B
,
                             sup Eµn [ H ] = E0 [ H ] = .
                                 µn 2 M 0

Thus, we see that our hybrid approach yields a non-conservative level  test. Due
to the inclusion of the least favorable critical value c,LF (Xn , ) this test no longer
shares the strong insensitivity to slack moments established for the conditional test
by Proposition 3. That said, as a set of moments becomes slack the power of the
hybrid test is bounded below by the power of the size 1 
                                                        
                                                         conditional test that drops
these moments ex-ante. Moreover, the Monte Carlo results in Section 7 show that
the hybrid does noticeably better than both the conditional and least favorable tests
in some cases with slack moments. Appendix A establishes size control for hybrid
tests based on the dual approach even when the solution to (12) is non-unique or
degenerate.


6       Implementation
This section provides guidance for researchers seeking to implement the methods de-
scribed in this paper. As in our theoretical results above, we assume that the researcher
has a moment function
                              g (Di , , ) = Yi ( ) Xi ( )                            (18)

                                                29
for Yi ( ) 2 Rk , 2 Rp , and Xi ( ) a k p matrix. We assume that at the true parameter
values EP [Yi ( ) Xi ( ) |Zi ]  0, where Zi is a vector of instruments and Xi ( ) is
non-random given Zi . We suppose the researcher wishes to compute confidence sets
for . This is often done by discretizing the parameter space for as { 1 , . . . , L },
and then testing pointwise whether each l in the grid is contained in BI (P ). The
confidence set then collects the non-rejected points.
   Sections 6.1 to 6.4 provide guidance on how to test whether a single value of       is
in the identified set, which can then be applied to all points in the grid. Sections 6.5
and 6.6 discuss implementation in extensions of this basic setting, such as when the
researcher wishes to conduct inference on (functions of) linear parameters, or when
there are non-linear nuisance parameters.

Alternative Procedures While the linear conditional structure assumed in this
paper is present in a variety of moment inequality settings, there are practically im-
portant cases where our results do not apply but alternatives are available. First, one
may have unconditional moment inequalities that are nonetheless linear in the param-
eters, in which case one can use the approaches of Cho & Russell (2019) or Gafarov
(2019). Alternatively, in settings with unconditional moment inequalities that may or
may not be linear in the nuisance parameters , or where we may be interested in a
nonlinear function of the parameters, one can use the approaches of e.g. Bugni et al.
(2017) and Kaido et al. (2019a). For more discussion of the comparison among these
options, see Kaido et al. (2019a) and Gafarov (2019). Other alternatives include the
procedures discussed by Romano & Shaikh (2008) and Chen et al. (2018).
     Asymptotic validity for the procedures discussed above (and for the present paper
­ see Appendix D) are established under the assumption that the number of moments
is fixed as the sample size tends to infinity. This assumption may yield unsatisfactory
performance if the number of moments is large relative to the sample size. By contrast,
the approach of Belloni et al. (2018) gives guarantees even in high-dimensional settings,
while the approach of Flynn (2019) allows a continuum of moments. Finally, the
results of Chernozhukov et al. (2015) apply in conditional moment settings where the
moments may be nonlinear in the nuisance parameters, and dimension of g (Di , , )
may be large.




                                           30
6.1     Estimating 
All of the tests for whether    2 BI (P ) described in this paper require an estimate of
the average conditional variance ( ) = EP [V arP (Yi ( )|Zi )]. It is important to note
that ( ) depends on the non-linear parameter , and thus must be estimated at each
grid point; for ease of exposition, however, we fix and drop the explicit dependence
of , Y , and X on         for the remainder of the section.
   The average conditional variance  can be estimated using the matching procedure
proposed by Abadie et al. (2014). To do this, define Z = V dar(Zi ).21 For each i, find
the nearest neighbor using the Mahalanobis distance in Zi :

                    `Z (i) = argminj 2{1,...,n},j 6=i (Zi   Z j ) 0  Z 1 ( Zi   Zj ) .

The estimate of  is then:

                                  X     n
                            b= 1
                                      Yi          Y`Z (i)   Yi    Y`Z (i) .
                                                                           0
                               2n i=1

Proposition 10 in Appendix D proves that, under additional assumptions, b consis-
tently estimates .


6.2     Implementing the LF and LFP Tests
We can test whether a particular value is in the identified set using the LF or LFP
tests by solving the linear program (10) and rejecting if and only if the optimal value
^ exceeds a critical value.

    To compute the least-favorable projection critical value via simulation, draw a
k  S matrix  of independent standard normals.22 Let max denote the S  1 vector
where the sth element is the maximum of the sth column of     b 1/2 . Set c,LF P (b ) to
the 1  quantile of max .
  21
      The matching procedure described below assumes that V d ar(Zi ) is invertible. In certain applica-
tions, such as in our Monte Carlo, elements of Zi may be linearly dependent by construction, leading
Vdar(Zi ) to be singular. In this case conditioning on a maximal linearly independent subset of Zi
is equivalent to conditioning on the full vector, so one can drop dependent elements from Zi until
Vdar(Zi ) is invertible.
   22
      Note that  need only be drawn once, and can be reused for many iterations of the LFP test,
as well as for the LF test. Holding the simulation draws fixed as we vary is likely to produce
confidence sets with smoother boundaries and may ease the computational burden.



                                                  31
    Similarly, to compute the least favorable critical value, again let  be a k  S matrix
of independent standard normal draws. Denote by s the sth column of            b 1/2 . For
each s = 1, . . . , S , calculate

                                                min, 
                       s =                                 q
                               subject to (s      Xn,j   )/  b jj   8j.


Set c,LF (b ) to the 1       quantile of {1 , . . . , S }.


6.3     Implementing the Conditional Test
To implement the conditional test in practice, we recommend taking the following
steps:

   1. Solve the primal LP (10) using the dual-simplex method, which generates as a
      byproduct multipliers ^ corresponding to a vertex of the solution set in the dual
      problem (see Appendix A).

   2. Check whether there are exactly p +1 positive multipliers in ^ , and if so, whether
      the rows of the constraint matrix corresponding with the positive multipliers,
      Wn,B , are full-rank.

   3. If the conditions checked in step 2 hold, compute V lo and V up using the analytical
      formulas in (14) and (15), replacing  by     b . Otherwise, V lo and V up must be
      calculated using the definition in (22) and (23) in Appendix A. This can be
      done using a bisection method, which we describe in Appendix H.

   4. Compute the 1      quantile
                             q     of the truncated
                                               q standard normal distribution with
       truncation points V /
                          lo     0b and V / up    0b .23 Reject the null if and only if
          q
       ^/    0b exceeds this critical value.24
  23
     In our implementation, we do this via simulation using the method of Botev (2017) to efficiently
simulate truncated normal draws. The critical value can also be calculated by inverting a normal
CDF, as in equation (16), but we found the former method less prone to numerical precision errors.
  24
     To apply the asymptotic uniformity resultsq developed in Appendix D, here and for the hybrid
test below we should reject if and only if  ^/   0b exceeds the maximum of this critical value and
  C , for C a user-selected positive constant.




                                                 32
6.4    Implementing the Hybrid Test
To implement the hybrid test, for  2 (0, ) (we use  = /10 in our simulations),

  1. Solve the primal LP (10) using the dual-simplex method, which generates as a
      byproduct multipliers ^ corresponding to a vertex of the solution set to the dual
      problem.

  2. Compare the resulting value    ^ to c,LF (Xn ,  b ( )), calculated as described in
     Section 6.2. If ^ exceeds this critical value, reject; otherwise continue the pro-
     cedure.

  3. Follow steps 2 and 3 from the conditional approach to compute V lo and V up .

  4. Compute the 1           quantile of the truncated standard normal distribution
                               
                              1        q
      with lower truncation point V /
                                    lo    0b and upper truncation point

                                  q                                  q
                   V   up,H
                              /       0b          up            b
                                           = min V , c,LF (Xn , ( )) / 0b .

                                                q
      Reject the null if and only ^/                0b    exceeds this critical value.


6.5    Inference with Non-Linear Nuisance Parameters
In some cases, we may have moments of the form

                         g (Di ,      1,   2,   ) = Yi ( 1 ,   2)   Xi ( 1 ,   2)


and be interested in conducting inference only on 1 . In this case, we can conduct
pointwise inference over a grid for = ( 1 , 2 ). We then reject for a particular value
of 1 if and only if for all values of 2 we reject the hypothesis that ( 1 , 2 ) is in the
identified set (that is, we apply the projection method to eliminate 2 , while applying
the methods developed in this paper to eliminate ). Alternatively, one could use one
of the methods discussed above which can directly address nonlinear parameters.


6.6    Inference on Linear Parameters
In certain applications, we may have linear moments of the form EP [Yi Xi |Zi ]  0,
where Yi and Xi do not explicitly depend on a non-linear parameter, and we may be

                                                         33
interested in conducting inference on a linear combination of the parameters, = l0
(or l(Xn )0 ). For instance we might be interested in constructing confidence intervals
for the coefficient on Xj , in which case we would set l = ej , the vector with a 1 in the
j th position and zeros elsewhere. If we did this once for every parameter we would
obtain confidence intervals for each of the individual coefficients. Linear combinations
of         may be of interest in other settings as well ­ e.g., in Wollman (2018) and our
Monte Carlo, the average cost of marketing a new product is a linear combination of
 .
    We first note that we can recast this problem into the standard form (18) and then
use any of the methods described above. To see this, let B be a full rank matrix with
l in the first row, so that B = ( , ~0 )0 for some ~. If we let M 1 be the selection
matrix that selects all but the first column of a matrix we have25

           Y      X =Y             X (B 1 B ) = Y          XB 1 e1             XB 1 M 1 ~  Y
                                                                                           ~( )          ~ ~.
                                                                                                         X

    Since V arP (Yi Xi |Zi ) does not depend on ,  need only be estimated once
and confidence sets for l0 using the LF and LFP methods can be obtained from a
linear program (there is no need for point-wise grid test inversion). For example to
compute the upper bound of the confidence set for = l0 one can solve


                                                      max l0
                                                 q                                                              (19)
               subject to (Yn,j         Xn,j   )/  b jj  c 8j, where c 2 {c,LF , c,LF P }.

    So far we have discussed the case without non-linear nuisance parameters, but this
approach extends to the case where we are interested in 1 = l0 and Y and X depend
on the non-linear nuisance parameter 2 . In this case, one can recast the problem as
described above so that the moments can be written as m(( 1 , 2 ), ~), and then follow
the approach in Section 6.5 for non-linear nuisance parameters. Given our assump-
tion that the conditional covariance matrix does not depend on the linear nuisance
parameters, computational shortcuts are still available and confidence intervals can
be calculated by running a linear program analogous to (19) for each 2 and taking
the maximum of the resulting values as the final upper bound.
     25
          M 0 1 = [0, Ik   1]   where 0 is the zero vector, and Ik   1   is the k   1 dimensional identity matrix.




                                                            34
7     Simulations
Our simulations are calibrated to Wollman (2018)'s study of the bailouts of GM and
Chryslers' truck divisions. To estimate the effect of the bailouts while allowing product
repositioning, Wollmann needs to know the fixed cost of marketing a product. He
obtains bounds based on conditional moment inequalities.
    We adopt the notation of Example 3 above, so Jf,i,t is the set of products marketed
by firm f in market i in period t, and  (Jf,i,t , Jf,i,t     0
                                                               ) is the difference in expected
profits from marketing Jf,i,t rather then Jf,i,t
                                            0
                                                 . Jf,i,t \ j and Jf,i,t [ j are the sets obtained
by deleting and adding product j from the set Jf,i,t respectively. Following Wollman
(2018), the fixed cost to firm f of marketing product j at time t is ( c,f + g gj ) if the
product was marketed last year (j 2 Jf,i,t 1 ), and c,f + g gj otherwise. Here c,f is a
per-product cost which is constant across products but may differ across firms, while
gj is the gross weight rating of product j .
    If we begin with the case where fixed costs are constant across firms ( c,f = c
for all f ) and again let 1{·} denote the indicator function, we obtain four conditional
moment inequalities by adding and subtracting one product at a time from the set
marketed. For instance, similar to the Example 3 above, if firm f markets product j
at both t 1 and t, then for

    m1 ()j,f,i,t      [  (Jf,i,t , Jf,i,t \ j )     (   c   +       g gj )    ]  1 {j 2 Jf,i,t , j 2 Jf,i,t   1, } ,

                                   
we must have E ml ()j,f,i,t |Vf,i,t  0 for all variables Vf,i,t in the firm's information
set when time-t production decisions were made, since otherwise the firm would have
chosen not to market product j in period t. Analagously, considering products that
were marketed at time t but not time t 1 yields moment function

      m2 ()j,f,i,t      [  (Jf,i,t , Jf,i,t \ j )           c        g gj ]    1 {j 2 Jf,i,t , j 2
                                                                                                 / Jf,i,t 1 } ,

while considering products not marketed at time t yields moment functions

    m3 ()j,f,i,t      [  (Jf,i,t , Jf,i,t [ j ) + (     c       +   g gj )    ]  1 {j 2
                                                                                      / Jf,i,t , j 2 Jf,i,t 1 } ,

      m4 ()j,f,i,t      [  (Jf,i,t , Jf,i,t [ j ) +  1 {j 2
                                                          / Jf,i,t , j 2
                                                            c   +      / Jf,i,t 1 } .
                                                                     g gj ]
                                                                                
If the observed data result from a Nash equilibrium then E ml ()j,f,i,t |Vf,i,t  0 for


                                                    35
l 2 {1, 2, 3, 4} and all variables Vf,i,t in the firm's information set at the time of the
decision.
   We obtain two further conditional moment inequalities by considering heavier and
lighter models than the firm actually marketed. To state them formally, define

                        J (j, f, i, t)  {j 0 |gj 0 < gj , j 0 2
                                                              / Jf,i,t , j 0 2
                                                                             / Jf,i,t 1 },

                         J + (j, f, i, t)  {j 0 |gj 0 > g, j 0 2
                                                               / Jf,i,t , j 0 2
                                                                              / Jf,i,t 1 }.
and let
                  P                                                                                 !
                      j 0 2J (j,f,i,t)   [  (Jf,i,t , (Jf,i,t \ j ) [ j 0 )       g (gj   gj 0 )]
m5
 j,f,i,t ( )                                                                                            1 {j 2 Jf,i,t , j 2
                                                                                                                          / Jf,i,t   1} ,
                                                  #J (j, f, i, t)

                  P                                                                                 !
                      j 0 2J + (j,f,i,t) [    (Jf,i,t , (Jf,i,t \ j ) [ j 0 ) +   g (gj   gj 0 )]
m6
 j,f,i,t ( )                                                                                            1 {j 2 Jf,i,t , j 2
                                                                                                                          / Jf,i,t   1} .
                                                  #J + (j, f, i, t)


    We calibrate our simulation designs using estimates based on Wollmann's data (for
details see Appendix G). In each simulation draw we generate data from a cross-section
of 500 independent markets.26 This is substantially larger than the 27 observations
used by Wollmann, but allows us to consider specifications with a widely varying
number of moments. As in Wollmann, f 2 {1, . . . , F }, and there are nine firms so
F = 9. To generate data we model the expected and observed profits for firm f from
marketing product j in market i in period t, denoted by j,f,i,t 
                                                                      and j,f,i,t respectively,
as
              
             j,f,i,t = j,i,t + j,f,i,t , and j,f,i,t = j,f,i,t
                                                       
                                                               + j,i,t + j,f,i,t ,

where the  terms are mean zero disturbances that arise from expectational and
measurement error and the  and  terms represent product-, market-, and firm-
specific profit shifters known to the firm when marketing decisions are made. The
distributions of these errors are calibrated to match moments in Wollmann's data, as
described in Appendix G.27
  26
     The data in Wollman (2018) are a time-series but his variance estimates assume no serial corre-
lation, so we adopt a simulation design consistent with this.
  27
     The terms j,i,t and j,i,t reflect product/market/time "shocks" that are known and unknown to
the firms, respectively, when they make their decisions. Shocks of this sort are an important aspect
of Wollmann's setting. Note that Wollmann also estimates (point-identified) demand and variable
cost parameters in a first step, while for simplicity we treat the variable profits j,f,i,t as known to
the econometrican.


                                                                 36
       The moments used to estimate our model are averages (over markets i) of

                                     1 X l                0
                                                    ~j,f,i ,
                                         mj,f,i ()  Z                                                 (20)
                                     J j

where we also average over all firms assumed to share the same fixed cost f,c . Since we
consider a single cross-section of markets we suppress the time subscript. We present
results both for the case where Z ~j,f,i includes only a constant and for the case where
the last two moments are interacted with a constant but the first four moments are
interacted with both a constant and the common profit-shifters  ,

                                         ~j,f,i = (1,  + ,  ),
                                         Z            j,i j,i


for q + = max{q, 0} and q = min{q, 0}. In the model with a single constant term,
 c,f = c for all f , this generates 6 and 14 moment inequalities. We also present results

when the nine firms are divided into three groups each with a separate constant term,
and when each firm has a separate constant term. For each specification we consider
the first four moments separately for the firm(s) associated with distinct parameters
 c,f , but average the last two moments across all firms as they do not depend on the

constant terms. This generates 14 and 38 moments for the three group classification,
and 38 and 110 moments when each firm has a separate constant term. To estimate
the conditional variance , in each specification we define the value of the instrument
Zi in market i as the Jacobian of (20) with respect to the linear parameters ( g , { c,f }).
    We consider inference on three parameters of interest: the cost of marketing the
truck of mean weight when it was marketed in the prior year;28 the incremental cost
of changing the weight of a product, g ; and the non-linear parameter , where 1
represents the proportional cost savings from marketing a product that was previously
marketed relative to a new product. For the first two parameters, each of which can be
written as a linear combination of the vector , we hold fixed at its true value to allow
us to examine performance in the linear case discussed in Section 6.6. As discussed
in Section 6.5, if we instead treated as unknown we could form joint confidence sets
  28
     When we assume c,f is common across firms this is c + g µg , where µg is the population average
weight of trucks. When we allow the estimated c parameters to vary across groups, we estimate l0 ,
for l = ( G
          1       1
            ,..., G , µg )0 , where G denotes the number of groups and = ( c,1 , ..., c,G , g )0 . Note that
since the simulation DGP holds the true value of c constant across groups, the true value of the
parameter is the same in all specifications.



                                                    37
for    along with the linear combination of interest, and could form confidence sets for
the linear parameter alone by projection. For inference on we treat the entire vector
  as a nuisance parameter. All results are based on 500 simulation runs.
    We begin our discussion of the results with Figure 1, which shows rejection prob-
abilities for the cost of the mean-weight truck.29 The vertical dashed lines denote the
conservative estimates for the bounds of the identified set, and the four curves repre-
sent the probability that each of the four methods considered rejects a given null value
of the parameter of interest.30 There is a clear ranking of the power of the LFP, LF,
and Hybrid procedures in Figure 1. In all specifications, the LF test has noticeably
higher power than the LFP. The hybrid test has power comparable to or above the LF
test in all specifications, with substantial differences emerging in cases with a larger
number of moments and parameters. The performance of the conditional test is more
nuanced. When the number of moments per parameter is small, the conditional test
performs very similarly to the hybrid, and is at least as good as the LF and LFP.
When we increase the number of moments holding the number of parameters fixed,
the conditional again performs similarly to the hybrid for parameter values close to
the identified set bounds, but can have power substantially below any of the other
methods far away from the identified set (see for instance Panel (d) of Figure 1).
   The power declines for the conditional test reflect that the set of binding moments is
not well-separated in this example. In particular, one can show that in this simulation
design, when the parameter of interest is the cost of the mean-weight truck we have
a multiplicity of solutions to the population moments when the number of moments
per parameter is large. As a result, we often have multiple near-solutions to the linear
program (10) in sample.31 As noted in Section 5, the conditional test may perform
poorly in such settings, and this prediction is borne out in this application. Our hybrid
test eliminates these problems, as intended.
  29
     Note that all of our simulation results in this section hold the data generating process constant
but vary the parameter values considered. Hence, the curves plotted should be interpreted as rejection
probabilities for tests of different null hypotheses, or one minus the coverage probability for confidence
sets.
  30
     We cannot solve for the true identified set analytically, so we approximate it by the set satisfying
the sample (unconditional) moment inequalities based on a simulation run with five million obser-
vations. To ensure that our estimate of the identified set is conservative,
                                                                          p      we follow Chernozhukov
et al. (2007) and add a correction factor to the moments of log (n)/ n  .003 when n=5,000,000.
Hence, our estimate of the identified is conservative in these simulations due to both (a) the Cher-
nozhukov et al. (2007) correction factor and (b) the use of unconditional rather than conditional
moment inequalities.
  31
     Less frequently, we have multiple exact solutions, in which case we apply the dual approach.


                                                   38
       Figure 2 reports rejection probabilities for testing hypotheses on the nonlinear pa-
rameter . Unlike in our simulations for the linear parameters, when testing nonlinear
parameters it is sometimes the case that no procedure has rejection probability going
to one over the grid we consider, though this phenomenon disappears in all but the
conditional power curves when we interact the conditional moments with the profit
shifters (j,i
          +
              , j,i ). Regardless, we see that the LF test has higher power than the LFP,
and that the power of the hybrid test is higher still. The conditional test performs
reasonably well in cases with a small number of moments and parameters (e.g. in
Panel (a)) but it has power well below any of the other tests considered at many
parameter values in some cases with more moments and/or parameters.
    Rejection probabilities for testing hypotheses on g are similar to those for testing
the cost of the average weight truck, though with better performance for the condi-
tional test, and so are reported in Appendix G to conserve space. One notable feature
of these results is that the identified set for g does not change across specifications, so
unlike for our analysis of the other parameters, the specifications with more than six
moments are adding moments and nuisance parameters without changing the iden-
tified set. The results in this case confirm that the hybrid approach appears less
sensitive to the addition of parameters and slack moments than the LF or LFP.
    Table 1 reports the size (formally, the maximal null rejection probability over the
estimated identified set) for all the tests considered. As expected all tests approxi-
mately control size, with the maximal null rejection probabilities for nominal 5% tests
bounded above by 8%, and this bound is reached only in cases with 110 moments.32
Our estimates for the identified set are conservative, so those rejection probabilities
should, if anything, overestimate the true maximal rejection probability.
    Table 1 also reports the median excess length of each confidence set, defined as the
difference between the length of the confidence interval and that of the identified set.
This provides a summary measure of the extent to which the confidence interval is
longer than the identified set. The ranking of confidence sets based on median excess
length agrees with the ranking from Figures 1 and 2, with the median excess length
for the hybrid comparable to or below that for the LF, which is strictly below that
  32
    We also ran simulations defining the identified set without the conservative Chernozhukov et al.
(2007) correction factor, and the only designs for which this resulted in a difference of maximal
rejection probabilities of more than 0.01 were two of the runs with 110 moments, where the bounds
with the correction implied probabilities of 0.07 and 0.08, compared to 0.02 and 0.01 without the
correction.



                                                39
Figure 1: Rejection probabilities for 5% tests of fixed cost for truck of mean weight
       (a) 2 Parameters, 6 Moments                 (b) 2 Parameters, 14 Moments




       (c) 4 Parameters, 14 Moments                (d) 4 Parameters, 38 Moments




      (e) 10 Parameters, 38 Moments               (f) 10 Parameters, 110 Moments




                                         40
                                                         Figure 2: Rejection probabilities for 5% tests of
                                        (a) 3 Parameters, 6 Moments                                                                           (b) 3 Parameters, 14 Moments
                         1                                                                                                         1

                        0.9                                                                                                       0.9

                        0.8                                                                                                       0.8

                        0.7                                                                                                       0.7
Rejection Probability




                                                                                                          Rejection Probability
                        0.6                                                                                                       0.6

                        0.5                                                                                                       0.5

                        0.4                                                                                                       0.4

                        0.3                                                                                                       0.3

                        0.2                                                                                                       0.2

                        0.1                                                                                                       0.1

                         0                                                                                                         0
                              0     20         40          60       80       100        120     140                                     0         2          4          6           8            10
                                  LFP     LF    Conditional        Hybrid    Identified Set Bound                                           LFP   LF   Conditional   Hybrid   Identified Set Bound


                                    (c) 5 Parameters, 14 Moments                                                                              (d) 5 Parameters, 38 Moments
                         1                                                                                                         1

                        0.9                                                                                                       0.9

                        0.8                                                                                                       0.8

                        0.7                                                                                                       0.7
Rejection Probability




                                                                                                          Rejection Probability




                        0.6                                                                                                       0.6

                        0.5                                                                                                       0.5

                        0.4                                                                                                       0.4

                        0.3                                                                                                       0.3

                        0.2                                                                                                       0.2

                        0.1                                                                                                       0.1

                         0                                                                                                         0
                              5     10         15             20    25       30         35          40                                  0         2          4          6           8            10
                                  LFP     LF        Conditional    Hybrid    Identified Set Bound                                           LFP   LF   Conditional   Hybrid   Identified Set Bound


                                   (e) 11 Parameters, 38 Moments                                                                             (f) 11 Parameters, 110 Moments
                         1                                                                                                         1

                        0.9                                                                                                       0.9

                        0.8                                                                                                       0.8

                        0.7                                                                                                       0.7
Rejection Probability




                                                                                                          Rejection Probability




                        0.6                                                                                                       0.6

                        0.5                                                                                                       0.5

                        0.4                                                                                                       0.4

                        0.3                                                                                                       0.3

                        0.2                                                                                                       0.2

                        0.1                                                                                                       0.1

                         0                                                                                                         0
                              0           2               4              6          8               10                                  0         2          4          6           8            10
                                  LFP     LF        Conditional    Hybrid    Identified Set Bound                                           LFP   LF   Conditional   Hybrid   Identified Set Bound

                                                                                                         41
               Table 1: Median Excess Length and Size
                       (a) Parameter: Cost of Mean-Weight Truck
                             Median Excess Length                      Max Size

#Parameters #Moments      LFP       LF Cond. Hybrid             LFP     LF Cond. Hybrid
         2         6      5.32     3.99    4.07          3.75     0    0.02   0.02   0.02
         2        14     12.75    10.48   10.49          8.54     0       0   0.02   0.02
         4        14      7.56     5.91    4.07          4.37     0       0   0.02   0.02
         4        38     19.08    16.33   14.68         11.60     0       0   0.03   0.03
        10        38     12.70    10.20    4.71          4.71     0       0   0.02   0.01
        10       110     25.61    22.36   17.91         14.34     0       0   0.08   0.07
                                  (b) Parameter:    g

                             Median Excess Length                      Max Size

#Parameters #Moments      LFP       LF Cond. Hybrid             LFP     LF Cond. Hybrid
         2         6       6.02    4.28     4.18         3.93   0.01   0.04   0.05   0.06
         2        14       6.91    5.40     4.43         4.18      0   0.02   0.05   0.05
         4        14          7    5.19     4.43         4.18      0   0.03   0.05   0.06
         4        38       7.97    6.68     4.43         4.43      0      0   0.05   0.05
        10        38       8.10    6.58     4.43         4.43      0   0.01   0.05   0.05
        10       110       9.11    7.69     5.18         5.18      0      0   0.03   0.03
                                   (c) Parameter:
                             Median Excess Length                      Max Size

#Parameters #Moments      LFP       LF Cond. Hybrid             LFP     LF Cond. Hybrid
         3         6     118.69 61.87     41.67         36.62     0      0       0      0
         3        14      0.76   0.56      0.45          0.35     0      0    0.01   0.01
         5        14     10.25   7.78      6.01           5.3     0      0    0.01   0.01
         5        38      0.86   0.66      0.96          0.45     0      0    0.03   0.03
        11        38      1.41   1.01      1.01          0.81     0      0    0.01   0.01
        11       110      0.86   0.66      2.57          0.56     0      0    0.05   0.04




                                    42
of the LFP. The conditional performs comparably to the hybrid in cases with a low
number of moments per parameter, but sometimes performs distinctly worse when the
number of moments per parameter is higher. We report results for other quantiles of
the excess length distribution in Appendix G.
   Lastly, Table 2 reports runtimes in minutes to calculate confidence sets for each
parameter. Notably, all runtimes, even those for the non-linear parameter when there
are eleven parameters in total, are well within acceptable limits for most empirical
projects.
         A few comparisons between the procedures are worth noting. When conducting
inference on the linear parameters, the LF and LFP procedures are substantially faster
than the hybrid and conditional approaches. This is because confidence intervals for
the former can be computed using linear programming, as described in Section 6.6,
whereas the latter approaches rely on test inversion over a grid. All procedures become
slower when conducting inference on a non-linear parameter, since they all rely on an
estimate of the conditional covariance matrix, which now needs to be computed at
each grid point; additionally, the LF and LFP now rely on test inversion over a grid as
well. For the non-linear parameter, the LFP and conditional approaches are typically
faster than the LF and hybrid, since the former need only calculate one linear program
for each grid point, whereas the latter methods require simulating the results of the
linear program many times for each grid point.33 We stress, however, that at least for
the simulation designs we consider, all four procedures remain highly tractable, and
runtimes could be improved using parallelization.


8         Conclusion
This paper considers the problem of inference based on linear conditional moment in-
equalities, which arise in a wide variety of economic applications. Using linear condi-
tional structure, we develop inference procedures which remain both computationally
tractable and powerful in the presence of nuisance parameters, including conditional
and hybrid procedures which are insensitive to the presence of slack moments. We
find good performance for our least favorable, conditional, and hybrid procedures un-
der a variety of simulation designs based on Wollman (2018), with especially good
    33
     If computation times are an issue for the hybrid, the LF first stage can be replaced with a LFP
first stage, yielding a faster but somewhat less powerful test.


                                                43
                                Table 2: Computation Times
                           (a) Parameter: Cost of Mean-Weight Truck
                                                         Runtime - Minutes

  #Parameters #Moments                     LFP                  LF Conditional         Hybrid
               2               6            0.11               0.18        0.44           0.41
               2              14            0.05               0.13        5.44           1.67
               4              14            0.08               0.15        6.56           2.12
               4              38            0.07               0.15        5.06            1. 3
              10              38            0.13               0.22        4.77           0.99
              10             110            0.13               0.21        4.47           0.92
                                        (b) Parameter:    g

                                                         Runtime - Minutes

  #Parameters #Moments                     LFP                  LF Conditional         Hybrid
               2               6            0.08               0.16        6.69           2.54
               2              14            0.05               0.13         5. 2          2.14
               4              14            0.08               0.15        6.01           1.96
               4              38            0.07               0.15        4.78           1.63
              10              38            0.13               0.22        3.77           1.03
              10             110            0.13               0.21        3.87           1.04
                                        (c) Parameter:
                                                         Runtime - Minutes

  #Parameters #Moments                     LFP                  LF Conditional         Hybrid
               3               6           5.24               13.68        5.27          13.69
               3              14           5.65               14.02        5.68          14.02
               5              14            6.9               15.36        6.93          15.37
               5              38           8.16               17.12        8.17          17.12
              11              38          11.94               20.95       11.95          20.96
              11             110          16.78               32.95       16.74          32.96
This table shows runtimes to calculate confidence sets based on one simulated dataset for each
specification, without parallelization, on a 2014 Macbook Pro with a 2.6 GHz Intel i5 Processor and
16GB of RAM. For the linear parameters (Panels a and b), the confidence sets for the LF and LFP
are computed using linear programming, as described in Section 6.6, and we use a grid of 1,001
parameter values for the hybrid and conditional approaches. For the non-linear parameter , all
four procedures use a grid of length 100. See Appendix G for additional details on the simulation
specification.


                                                44
performance for the hybrid.


References
Abadie, A., Imbens, G. W. & Zheng, F. (2014), `Inference for misspecified models with
  fixed regressors', Journal of the American Statistical Association 109(508), 1601­
  1614.

Andrews, D. W. & Barwick, P. J. (2012), `Inference for parameters defined by mo-
  ment inequalities: A recommended moment selection procedure', Econometrica
  80(6), 2805­2826.

Andrews, D. W. & Guggenberger, P. (2009), `Hybrid and size-corrected subsampling
  methods', Econometrica 77(3), 721­762.

Andrews, D. W. & Shi, X. (2013), `Inference based on conditional moment inequali-
 ties', Econometrica 81(2), 609­666.

Andrews, D. W. & Soares, G. (2010), `Inference for parameters defined by moment
  inequalities using generalized moment selection', Econometrica 78(1), 119­159.

Andrews, I., Kitagawa, T. & McCloskey, A. (2018), Inference on winners. Working
  Paper.

Armstrong, T. B. (2014a), A note on minimax testing and confidence intervals in
  moment inequality models. Working Paper.

Armstrong, T. B. (2014b), `Weighted ks statistics for inference on conditional moment
  inequalities', Journal of Econometrics 181(2), 92­116.

Barseghyan, L., Coughlin, M., Molinari, F. & Teitelbaum, J. C. (2019), Heterogenous
  choice sets and preferences. Working Paper.

Belloni, A., Bugni, F. & Chernozhukov, V. (2018), Subvector inference in PI models
  with many moment inequalities. Working Paper.

Beresteanu, A. & Molinari, F. (2008), `Asymptotic properties for a class of partially
  identified models', Econometrica 76(4), 763­814.


                                         45
Blundell, R., Gosling, A., Ichimura, H. & Meghir, C. (2007), `Changes in the distri-
  bution of male and female wages accounting for employment composition', Econo-
  metrica 75, 323­363.

Bontemps, C., Magnac, T. & Maurin, E. (2012), `Set identified linear models', Econo-
  metrica 80(3), 1129­1155.

Botev, Z. I. (2017), `The normal law under linear restrictions: simulation and es-
  timation via minimax tilting', Journal of the Royal Statistical Society: Series B
  (Statistical Methodology) 79(1), 125­148.

Bugni, F., Canay, I. & Shi, X. (2017), `Inference for subvectors and other functions
  of partially identified parameters in moment inequality models', Quantitative Eco-
  nomics 8(1), 1­38.

Canay, I. & Shaikh, A. (2017), Practical and theoretical advances in inference for
  partially identified models, in B. Honore, A. Pakes, M. Piazessi, & L. Samuelson,
  eds, `Advances in Economics and Econometrics', Cambridge University Press.

Chen, X., Christensen, T. & Tamer, E. (2018), `Monte carlo confidence sets for iden-
  tified sets', Econometrica 86(6), 1965­2018.

Chernozhukov, V., Hong, H. & Tamer, E. (2007), `Estimation and confidence regions
  for parameter sets in econometric models', Econometrica 75(5), 1243­1284.

Chernozhukov, V., Newey, W. & Santos, A. (2015), Constrained conditional moment
  restriction models. Working Paper.

Chetty, R. (2012), `Bounds on elasticities with optimization frictions: A synthesis of
  micro and macro evidence on labor supply', Econometrica 80(3), 969­1018.

Chetverikov, D. (2018), `Adaptive test of conditional moment inequalities', Economet-
 ric Theory 34(1), 186­227.

Cho, J. & Russell, T. M. (2019), Simple inference on functionals of set-identified
  parameters defined by linear moments. Working Paper.

Ciliberto, F. & Tamer, E. (2009), `Market structure and multiple equilibria in airline
  markets', Econometrica 77(6), 1791­1828.


                                         46
Cox, G. & Shi, X. (2019), A simple uniformly valid test for inequalities. Working
  Paper.

Dickstein, M. & Morales, E. (2018), `What do exporters know?', Quarterly Journal of
  Economics 133(4), 1753­1801.

Eizenberg, A. (2014), `Upstream innovation and product variety in the U.S. home pc
  market', Review of Economic Studies 81(3), 1003­1045.

Flynn, Z. (2019), Inference based on continuous linear inequalities via semi-infinite
  programming. Working Paper.

Gafarov, B. (2019), Inference in high-dimensional set-identified affine models. Working
  Paper.

Haile, P. A. & Tamer, E. (2003), `Inference with an incomplete model of english
  auctions', Journal of Political Economy 111(1), 1­51.

Ho, K. & Pakes, A. (2014), `Hospital choices, hospital prices and financial incentives
  to physicians', American Economic Review 104(12), 3841­84.

Ho, K. & Rosen, A. (2017), Partial identification in applied research, in B. Honore,
  A. Pakes, M. Piazessi, & L. Samuelson, eds, `Advances in Economics and Econo-
  metrics', Cambridge University Press.

Holmes, T. (2011), `The diffusion of Wal-Mart and economies of density', Economet-
  rica 79(1), 253­302.

Honore, B. & Lleras-Muney, A. (2006), `Bounds in competing risks models and the
  war on cancer', Econometrica 74(6), 1675­1698.

Hsieh, Y.-W., Shi, X. & Shum, M. (2017), Inference on estimators defined by mathe-
  matical programming. Working Paper.

Kaido, H., Molinari, F. & Stoye, J. (2019a), `Confidence intervals for projections of
 partially identified parameters', Econometrica 87(4), 1397­1432.

Kaido, H., Molinari, F. & Stoye, J. (2019b), Online appendix to "confidence intervals
 for projections of partially identified parameters ". Supplementary Material.


                                          47
Katz, M. (2007), Supermarkets and zoning laws. Ph.D. dissertation, Harvard Univer-
  sity.

Khan, S., Ponomareva, M. & Tamer, E. (2019), Identification of dynamic panel binary
  response models. Working Paper.

Kline, P. & Tartari, M. (2016), `Bounding the labor supply response to a randomized
  welfare experiment: A revealed preference approach', American Economic Review
  106(4), 972­1014.

Kreider, B., Pepper, J., Gundersen, C. & Jolliffe, D. (2012), `Identifying the effects of
  snap (food stamps) on child health outcomes when participation is endogenous and
  misreported', Journal of the American Statistical Association 107, 958­975.

Lee, J. D., Sun, D. L., Sun, Y. & Taylor, J. E. (2016), `Exact post-selection inference,
  with application to the lasso', Annals of Statistics 44(3), 907­927.

Manski, C. F. & Tamer, E. (2002), `Inference on regressions with interval data on a
 regressor or outcome', Econometrica 70(2), 519­546.

Mogstad, M., Santos, A. & Torgovitsky, A. (2018), `Using instrumental variables for
 inference about policy relevant treatment parameters', Econometrica 86(5), 1589­
 1619.

Molinari, F. (2019), Econometrics with partial identification. Working Paper.

Morales, E., Sheu, G. & Zahler, A. (2019), `Extended gravity', Review of Economic
 Studies Forthcoming.

Pakes, A. (2010), `Alternative models for moment inequalities', Econometrica
  78(6), 1783­1822.

Pakes, A., Porter, J. & Ishii, K. H. J. (2015), `Moment inequalities and their applica-
  tion', Econometrica 83(1), 315­334.

Ponomareva, M. & Tamer, E. (2011), `Misspecification in moment inequality models:
  Back to moment equalities?', Econometrics Journal 14(2), 186­203.

Romano, J. P. & Shaikh, A. (2008), `Inference for identifiable parameters in par-
  tially identified econometric models', Journal of Statistical Planning and Inference
  138(9), 2786­2807.

                                           48
Romano, J. P., Shaikh, A. & Wolf, M. (2014a), `A practical two-step method for
  testing moment inequalities', Econometrica 82(5), 1979­2002.

Romano, J. P., Shaikh, A. & Wolf, M. (2014b), `Supplement to `a practical two-step
  method for testing moment inequalities", Econometrica 82.

Rosen, A. (2008), `Confidence sets for partially identified parameters that satisfy a
  finite number of moment inequalities', Journal of Econometrics 146(1), 107­117.

Schrijver, A. (1986), Theory of Linear and Integer Programming, Wiley-Interscience.

Tebaldi, P., Torgovitsky, A. & Yang, H. (2019), Nonparametric estimates of demand
  in the california health insurance exchange. Working Paper.

Torgovitsky, A. (2019), `Partial identification by extending subdistributions', Quanti-
  tative Economics 10(1), 105­144.

Wollman, T. (2018), `Trucks without bailouts: Equilibrium product characteristics for
 commercial vehicles', American Economic Review 108(6), 1364­1406.




                                          49
