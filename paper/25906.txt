                              NBER WORKING PAPER SERIES




                     AFFORDABLE HOUSING AND CITY WELFARE

                                         Jack Favilukis
                                         Pierre Mabille
                                   Stijn Van Nieuwerburgh

                                      Working Paper 25906
                              http://www.nber.org/papers/w25906


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                    May 2019




We thank Hae-Kang Lee for superb research assistance. We thank John Humphries, Timothy
McQuade, Adam Guren, Charles Nathanson (discussants), and Morris Davis for valuable
comments. We have benefited from participants at the 2018 Society for Economic Dynamics
conference in Mexico City, the Urban Economics Association conference at Columbia
University, the 2019 American Economic Association in Atlanta, the Macro Finance Society
meeting at Kellogg, the Conference on Low-Income Housing Supply and Housing Affordability
in Madrid, and seminar participants at the University of Miami, Columbia GSB, Atlanta Fed and
Emory University, NYU Stern, University of Connecticut, University of Luxembourg, John's
Hopkins University, PUC in Santiago, Boston College, London Business School, and the San
Francisco Federal Reserve Bank. The views expressed herein are those of the authors and do not
necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2019 by Jack Favilukis, Pierre Mabille, and Stijn Van Nieuwerburgh. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.
Affordable Housing and City Welfare
Jack Favilukis, Pierre Mabille, and Stijn Van Nieuwerburgh
NBER Working Paper No. 25906
May 2019
JEL No. E21,E6,G11,G12,G18,H2,H76,R1,R13,R21,R28,R3,R31,R41,R51

                                          ABSTRACT

Housing affordability is the main policy challenge for many large cities in the world. Zoning
changes, rent control, housing vouchers, and tax credits are the main levers employed by policy
makers. But how effective are they at combatting the affordability crisis? We build a new
framework to evaluate the effect of these policies on the well-being of its citizens. It endogenizes
house prices, rents, construction, labor supply, output, income and wealth inequality, as well as
the location decisions of households. Its main novel features are risk, risk aversion, and
incomplete risk-sharing. We calibrate the model to the New York MSA, incorporating current
zoning and affordable housing policies. Housing affordability policies carry substantial insurance
value but cause misallocation in labor and housing markets. Housing affordability policies that
enhance access to this insurance especially for the neediest households create large net welfare
gains.

Jack Favilukis                                   Stijn Van Nieuwerburgh
Sauder School of Business                        Columbia University
University of British Columbia                   Graduate school of Business
Henry Angus Building 2053 Main Mall              Uris Hall, office 809
Office 867                                       3022 Broadway
Vancouver, BC V6T 1Z2                            New York, NY 10027
Canada                                           and NBER
jack.favilukis@sauder.ubc.ca                     svnieuwe@gsb.columbia.edu

Pierre Mabille
New York University
Stern School of Business
Kaufman Management Center
44 West 4th Street
New York, NY 10012
pmabille@stern.nyu.edu
1      Introduction
The increasing appeal of major urban centers has brought on an unprecedented housing
affordability crisis. Ever more urban households are burdened by rents or mortgage pay-
ments that take up a large fraction of their paycheck and/or by long commutes. The share
of cost-burdened renters in the United States has risen from 23.8% in the 1960s to 47.5%
in 2016. Over this period, median home value rose 112%, far outpacing the 50% increase
in the median owner income (Joint Center for Housing Studies of Harvard University,
2018). Hsieh and Moretti (2019) argue that our most productive cities are smaller than
they should be because of lack of affordable housing options, underscoring the impor-
tance of the issue.
     Policy makers are under increasing pressure to improve affordability. 1 They employ
policy tools ranging from rent control, inclusionary zoning, land use restrictions, housing
vouchers, to tax credits for developers. While there is much work, both empirical and
theoretical, on housing affordability, what is missing is a general equilibrium model that
quantifies the impact of such policies on prices and quantities of owned and rented hous-
ing, the spatial distribution of housing and households, commuting patterns, incentives
to work, income and wealth inequality within and across neighborhoods, output, and
ultimately on individual and city-wide welfare. This paper provides such a model. We
carefully calibrate the model and use it as a laboratory to conduct a number of housing
policy experiments.
     Our overarching finding is that expansion of housing affordability policies can be wel-
fare improving. In an incomplete markets model like ours with risk and risk aversion,
affordability policies play a quantitatively important role as an insurance device, espe-
cially benefitting low income households. Those insurance benefits trade off against the
housing and labor market distortions that usually accompany such policies. Our results
highlight the importance of general equilibrium effects, which often reverse partial equi-
librium logic, and of how the affordability policies are financed. In the spirit of Diamond
and Saez (2011), we aim to evaluate policy reforms that are extensions of existing poli-
cies, limited in complexity, and potentially politically feasible, rather than characterizing
first-best policy.

    1 Fifteencities in California have rent control. A November 2018 California state ballot initiative pro-
posed to overturn the 1995 Costa-Hawkins Act, clearing the way for more rent control. Oregon is the first
U.S. state to impose statewide rent control. The New York State legislature is discussing expansion of rent
control laws up for renewal in June 2019. So is Massachusetts. Bill de Blasio, the mayor of New York City,
was elected on a platform to preserve or add 200,000 affordable housing units. Affordable housing is a key
policy issue in large cities throughout the world.


                                                     1
   We model a metropolitan area that consists of two zones, the central business district
(zone 1) and the rest of the metropolitan area (zone 2). Working-age households who live
in zone 2 commute to zone 1 for work. Commuting entails both an opportunity cost of
time and a financial cost. Zones have different sizes, captured by limits on the maximum
amount of housing that can be built. Finally, zones provide different levels of amenities.
The spatial aspect of the model is important since affordable housing policies interfere
with the optimal spatial allocation of labor and housing.
   The city is populated by overlapping generations of risk averse households who face
idiosyncratic labor productivity risk and mortality risk. They make dynamic decisions
on location, non-housing and housing consumption, labor supply, tenure status (own or
rent), savings in bonds, primary housing, investment property, and mortgage debt. Since
households cannot perfectly hedge labor income and longevity risk, markets are incom-
plete. This incompleteness opens up the possibility for housing affordability policies to
provide insurance. Progressive tax-and-transfer and social security systems capture im-
portant insurance mechanisms aside from affordable housing policies. The model gen-
erates a rich cross-sectional distribution over age, labor income, tenure status, housing
wealth, and financial wealth. This richness is paramount to understanding both the dis-
tributional and aggregate implications of housing affordability policies.
   On the firm side, the city produces tradable goods and residential housing in each
zone, subject to decreasing returns to scale. As a zone approaches its maximum build-
able housing limit, construction becomes increasingly expensive, and the housing supply
elasticity falls. Wages, house prices, and market rents are determined in the city’s equi-
librium.
   We calibrate the model to the New York metropolitan area, designating Manhattan as
the urban core, or zone 1, and the rest of the metropolitan area (MSA) as zone 2. Our cal-
ibration targets key features of the data, including the relative size of Manhattan versus
the rest of the MSA, the income distribution in the New York MSA, observed commut-
ing times and costs, the housing supply elasticity, current zoning laws, the current size
and scope of the affordable housing system, and the current federal, state, and local tax-
and-transfer system. The baseline model generates realistic income, wealth, and home
ownership patterns over the life-cycle for various percentiles of the income distribution.
It matches both income and wealth inequality. The model also matches house price and
rent levels for the MSA. It generates a large wedge between the prices and rents in the
two zones.
   We model rent control (RC) as mandatory inclusionary housing, a policy that requires
developers to set aside a fraction of rental housing to low-income households at below

                                            2
market rates and is allocated by lottery. Such policies are common in large U.S. cities like
New York. We believe that the insights from our RC experiments apply more broadly to
other government-provided or regulated housing units that rent at below-market rates.
RC provides insurance in the model. We define access to insurance as the likelihood that
a household in the bottom half of the income distribution that experiences a negative
productivity shock gains access to an affordable housing unit. We define the stability of
insurance as the likelihood that a household in the bottom half of the income distribution
already in an affordable unit can remain there. The value of insurance depends on the size
of the affordable unit, how deeply the rent is discounted, and on household risk aversion.
   The RC system creates several distortions which trade off with the insurance bene-
fits. Households who win the model’s affordable housing lottery and wish to accept the
win must satisfy an income qualification as well as a maximum unit size requirement
upon first entry. By sheer luck, low-productivity households may end up in RC units
in the city center, crowding out high-productivity households with a higher opportunity
cost of time from commuting. This is a first source of misallocation. Second, the income
qualification requirement leads to distortions in labor supply. We choose the income qual-
ification parameter to match the observed position of RC tenants in the city-wide income
distribution. A third source of misallocation is that a household that would otherwise
live in zone 1 accepts an affordable housing unit in zone 2 or vice versa. Fourth, the
maximum size constraint generates misallocation of housing. Households may choose
RC units that are too small or too large because of the below-market rent. Fifth, once a
household is in an affordable unit, it needs not requalify (with high probability). Subse-
quent positive productivity shocks or deterministic age-related increases in income cause
further misallocation since households often choose to remain in their subsidized units
despite a growing mismatch. RC tenancy in the model matches data on the fraction of
RC residents who live in their unit for more than twenty years. When less needy house-
holds occupy scarce RC units, needy households have a lower chance of gaining access.
Sixth, and maybe most prominently, the affordable housing mandate affects the supply of
housing. Landlords earn lower average rents, lowering the price of rental property, and
weakening the incentives for residential development. This in turn leads to higher rents
and prices for market units.
   In the first set of experiments, we study policies aimed at reducing the misallocation
caused by RC. The first policy counter-factual tightens the income qualification require-
ment imposed upon first entry. By more explicitly targeting low-income households, the
policy improves access to insurance for those who need it most. A second policy change
is aimed at reducing the misallocation that occurs after first entry. It abolishes priority

                                             3
for incumbents and forces RC tenants to re-apply and re-qualify for RC each period. Re-
qualification replaces less needy insiders with needier outsiders. However, by creating
more churn in the RC system, it lowers the stability of insurance, which hurts risk averse
households. Combining tighter income requirements with re-qualification addresses mis-
allocation both at first entry and thereafter. This combination experiment results in a large
welfare gain of 3.59% in consumption equivalent units per average New Yorker. The gain
arises from a large increase in access to insurance and a smaller reduction in the stability
of that insurance. Policies that improve the targeting of affordable housing benefit young,
low-productivity, low-income, and low-wealth households the most, thereby reducing in-
come and wealth inequality. Because they do not expand the footprint of the RC system,
such policies reduce rather than magnify the labor and housing market distortions. Be-
cause they result in a larger population in the urban core, they reduce the deadweight
losses incurred by commuting.
   A second set of policy experiments changes the scope of the affordable housing man-
date. A 50% increase in the share of square footage that developers must set aside for
affordable units increases welfare by 0.66%. With more affordable housing units, access
to insurance increases while the stability of insurance is unaffected. The benefits this
brings to lower-income households outweigh the costs that arise from weaker incentives
to construct housing, higher rents in market units, and from more spatial misallocation
of labor and housing. We explore both smaller and larger fractions of affordable hous-
ing units and find that welfare increases monotonically with the scope of the affordable
housing mandate.
   In contrast to received wisdom, increasing the affordable housing mandate symmet-
rically in both zones does not lead to a decline in the overall quantity of housing in the
MSA. The housing stock declines in the urban core, consistent with partial equilibrium
logic and empirical evidence from local estimates (Autor, Palmer, and Pathak, 2014; Di-
amond, McQuade, and Qian, 2019). But, in spatial equilibrium, the population and the
demand for housing in zone 2 rise, where housing is cheaper and supply more elastic.
The expansion of the housing stock in zone 2 more than offsets the fall in the housing
stock in zone 1.
   Another interesting finding, common across several experiments, is that standard
housing affordability metrics, such as the average rent-to-income ratio and the fraction of
rent-burdened households, do not capture the improved availability of affordable hous-
ing. The increase in the rent-to-income ratio in zone 1 reflects not only the higher rents
resulting from a smaller housing stock in zone 1 but also the lower average income of the
zone 1 population after endogenous relocation in response to the policy.

                                             4
   The third main policy experiment increases the maximum amount of residential build-
ing in zone 1, for example through a relaxation of land use or height restrictions. The “up-
zoning” policy we study increases the equilibrium population share of zone 1 by 9.28%
and the housing stock by nearly as much. It generates a welfare gain of 0.37%. The pol-
icy creates benefits for all age, productivity, income, and wealth groups, at least in the
long-run (when comparing steady states). In other words, it involves less redistribution
compared to the previous policies. Rents fall, which benefits both market and RC renters.
The affordability improvements are widespread but modest. The surprisingly small ag-
gregate welfare gain reflects the modest improvement in the fate of low-income, high
marginal-utility households.
   The last main policy experiment studies an expansion of the housing voucher sys-
tem. Vouchers are subsidies provided through the tax and transfer system to low income
households to be used for housing expenditures. An expansion of the voucher system is
strongly welfare increasing (1.04%). The policy completes markets, in that households’
marginal utility growth of housing and non-housing consumption becomes less volatile.
Because the vouchers redistribute wealth from low- to high-marginal utility households,
they reduce inequality. There are substantial costs from this policy since we assume, con-
sistent with reality, that a voucher expansion must be financed via a more progressive
tax system. Since labor income taxation is distortionary, high-and middle-productivity
households reduce labor supply, and the city suffers a decline in output. The voucher ex-
pansion, whose direct effects are independent of location, triggers an interesting spatial
response. Since the housing stock in the city center falls, due to a tax-induced reduction in
housing demand, some high- and middle-productivity households move out of the city
center. In equilibrium, the vouchers do not allow poor households to “move to oppor-
tunity” (zone 1) but rather seem to “remove from opportunity” some high-productivity
households who end up farther from their jobs after the policy change, a sign of stronger
labor misallocation.
   A tax credit policy of the same magnitude as the voucher expansion, discussed in
the appendix, suffers from similar tax-induced distortions on labor supply and housing
demand, but without producing large gains for high-marginal utility households. It is
only marginally welfare increasing (0.02%). The voucher and tax credit experiments un-
derscore the importance of modeling how housing affordability policies are paid for, an
aspect that has received little consideration in the literature.
   The appendix discusses several more policy experiments. The most interesting result
is for a policy that relocates all affordable housing units in zone 1 to zone 2. Despite allow-
ing more high-productivity households with a high time cost of commuting to live closer

                                               5
to work, the policy also causes higher financial costs of commuting for more low-income
households. The net welfare effect is essentially zero. In contrast, when the relocation is
accompanied by free transportation for RC tenants, there is a substantial welfare gain.


Related Literature    Our work is at the intersection of the macro-finance and urban eco-
nomics literatures. On the one hand, a large literature in finance solves partial-equilibrium
models of portfolio choice between housing (extensive and intensive margin), financial
assets, and mortgages. Examples are Campbell and Cocco (2003), Cocco (2005), Yao
and Zhang (2004), and Berger, Guerrieri, Lorenzoni, and Vavra (2017). Davis and Van
Nieuwerburgh (2015) summarize this literature. Recent work in macro-finance has solved
such models in general equilibrium, adding aggregate risk, endogenizing house prices
and sometimes also interest rates. E.g., Landvoigt, Piazzesi, and Schneider (2015), Fav-
ilukis, Ludvigson, and Van Nieuwerburgh (2017), Guren and McQuade (2019), and Ka-
plan, Mitman, and Violante (2019). Imrohoroglu, Matoba, and Tuzel (2016) study the
effect of the 1978 passage of Proposition 13 which lowered property taxes in California.
Like the former literature, our model features a life-cycle and a rich portfolio choice prob-
lem and captures key quantitative features of observed wealth accumulation and home
ownership over the life-cycle. Like the latter literature, house prices, rents, and wages
are determined in equilibrium. We abstract from aggregate risk which is not central to
the question at hand. Our contribution to the macro-finance literature is to add a spa-
tial dimension to the model by introducing commuting costs, differing housing supply
elasticities, and local amenities.
   On the other hand, a voluminous literature in urban economics studies the spatial
location of households in urban areas. Brueckner (1987) summarizes the Muth-Mills
monocentric city model. This literature studies the trade-off between the commuting
costs and housing expenditures. Rappaport (2014) introduces leisure as a source of util-
ity and argues that the monocentric model remains empirically relevant. Rosen (1979)
and Roback (1982) introduce spatial equilibrium. Recent work on spatial sorting includes
Van Nieuwerburgh and Weill (2010), Behrens, Duranton, and Robert-Nicoud (2014) and
Eeckhout, Pinheiro, and Schmidheiny (2014). Guerrieri, Hartley, and Hurst (2013) study
house price dynamics in a city and focus on neighborhood consumption externalities, in
part based on empirical evidence in Rossi-Hansberg, Sarte, and Owens (2010). Couture,
Gaubert, Handbury, and Hurst (2018) uses a similar device to explain the return of rich
households to the urban core over the past decades, reversing an earlier wave of suburban
flight. Our model also features such luxury amenities in the city center. Urban models
tend to be static, households tend to be risk neutral or have quasi-linear preferences, and

                                             6
landlords are absentee (outside the model). The lack of risk, investment demand for hous-
ing by local residents, and wealth effects makes it hard to connect these spatial models to
the macro-finance literature. There is no insurance role of affordability policies.
   Hizmo (2015) and Ortalo-Magné and Prat (2016) bridge some of the gap between these
two literatures by studying a problem where households are exposed to local labor in-
come risk, make a once-and-for-all location choice, and then make an optimal financial
portfolio choice. Their models are complementary to ours in that they solve a richer port-
folio choice problem in closed-form, but don’t have preferences that admit wealth effects
nor allow for consumption and location choice each period. Studying the welfare effects
of housing affordability policies requires incorporating wealth effects and considering
landlords that are inside the city.
   Because it is a heterogeneous-agent, incomplete-markets model, agents choices and
equilibrium prices depend on the entire wealth distribution. Because of the spatial di-
mension, households’ location is an additional state variable that needs to be kept track
of. We use state-of-the-art methods to solve the model. We extend the approach of Fav-
ilukis et al. (2017), which itself extends Gomes and Michaelides (2008) and Krusell and
Smith (1998) before that. The solution approach can accommodate aggregate risk, though
we abstract from it in this model.
   The resulting model is a new laboratory that can be used to study how place-based
policies affect the spatial distribution of people, labor supply, house prices, output, and
inequality. Favilukis and Van Nieuwerburgh (2018) use a related framework to study the
effect of out-of-town investors on residential property prices.
   Finally, our model connects to a growing empirical literature that studies the effect of
rent control and zoning policies on rents, house prices, and housing supply. Autor et al.
(2014); Autor, Palmer, and Pathak (2017) find that the elimination of the rent control man-
date on prices in Cambridge increased the value of decontrolled units and neighboring
properties in the following decade, by allowing constrained owners to raise rents and in-
creasing the amenity value of those neighborhoods through housing market externalities.
The price increase spurred new construction, increasing the rental stock. Diamond et al.
(2019) show that the expansion of the RC mandate in San Francisco led to a reduction in
the supply of available housing, by decreasing owners’ incentives to rent below market
prices, paradoxically contributing to rising rents and the gentrification of the area. While
beneficial to tenants in RC, it resulted in an aggregate welfare loss. We also find a lower
housing stock and higher rents from a RC expansion, but an aggregate welfare gain for
the entire MSA in spatial equilibrium. Davis, Gregory, Hartley, and Tan (2017) study the
effect of housing vouchers on location choice and of location choice on children’s school-

                                              7
ing outcomes in a rich model of the Los Angeles housing market. In a related model
of neighborhood choice, Davis, Gregory, and Hartley (2018) study Low Income Housing
Tax Credits and their effect on demographic composition, rent, and children’s adult earn-
ings. Diamond and McQuade (2019) find that LIHTC buildings in high- (low-)income
neighborhoods have negative (positive) effects on neighboring property prices. 2
     The rest of the paper is organized as follows. Section 2 sets up the model. Section 3 de-
scribes the calibration to the New York metropolitan area. Section 4 discusses the bench-
mark model’s implications for quantities and prices, the distribution of households, and
housing affordability. Section 5 studies the main counter-factual policy experiments. Sec-
tion 6 concludes. Several appendices provide model derivations (A), additional detail on
the data (B), additional calibration details and output from the benchmark model (C-F),
six additional policy experiments (G), robustness analysis that investigates the sensitivity
of our policy results to changes in the key parameters (H), and transitional dynamics (I).


2      Model
The model consists of two geographies, the “urban core” and the “periphery”, whose
union forms the “metropolitan area” or “city.” The urban core, which we refer to as zone
1, is the central business district where all employment takes place. The periphery, or
zone 2, contains the outer boroughs of the city as well as the suburban areas that belong
to the metropolitan area. While clearly an abstraction of the more complex production
and commuting patterns in large cities, the monocentric city assumption captures the
essence of commuting patterns (Rappaport, 2014) and is the simplest way to introduce a
spatial aspect in the model. The two zones are allowed to differ in size. The city has a
fixed population.3
    2 Earlier
            work by Baum-Snow and Marion (2009) focuses on the effects of LIHTCs on low income neigh-
borhoods and Freedman and Owens (2011) specifically focuses on crime. Luque, Ikromov, and Noseworthy
(2019) summarize various financing methods for low-income housing development.
   3 Future work could study interactions between affordability policies and migration in a multi-city

model. Such a model would need to take a stance on a reservation utility of moving and on the mov-
ing costs across MSAs. These reservation utilities would naturally differ by age, productivity, and wealth,
leading to a proliferation of free parameters. The lack of guidance from the literature would pose a sub-
stantial challenge to calibration. Furthermore, the empirical evidence for the New York metropolitan area,
discussed in Appendix B.6, suggests that our zero net migration assumption fits the data well. Finally,
welfare would be affected by the outside option. These three considerations motivate the closed-city model
assumption.




                                                    8
2.1   Households
Preferences     The economy consists of overlapping generations of risk averse house-
holds. There is a continuum of households of a given age a. Each household maximizes
a utility function u over consumption goods c, housing h, and labor supply n. Utility
depends on location ` and age a, allowing the model to capture commuting time and
amenity differences across locations.
   The period utility function is a CES aggregator of c and h and leisure l:
                                            h                            i 1− γ
                                                χt`,a C(ct , ht , lt )
              U (ct , ht , nt , `t , a) =                                         ,                          (1)
                                                         1−γ
                                            h                                                 η       i η1
                                                                                                  η
                     C(ct , ht , lt ) =         (1 − αn ) ((1 − αh )cet + αh het ) e + αn lt
                                 ht ≥ h                                                                      (2)
                                      (
                                                  1 − φT` − lt ≥ n                if a < 65
                                 nta =                                                                       (3)
                                                  0                               if a ≥ 65
                                          
                                          
                                          
                                           χ1                  if ` = 1 and ct < c
                                          
                                           χ 1 χW              if ` = 1 and a < 65 and ct ≥ c
                               χ`t ,a   =                                                                    (4)
                                          
                                          
                                           χ1 χ R              if ` = 1 and a ≥ 65 and ct ≥ c
                                          
                                           1                   if ` = 2

The coefficient of relative risk aversion is γ. The parameter e controls the intra-temporal
elasticity of substitution between housing and non-housing consumption.
   Equation (2) imposes a minimum house size requirement (h), capturing the notion that
a minimum amount of shelter is necessary for a household. The city’s building code often
contains such minimum size restrictions.
   Total non-sleeping time in equation (3) is normalized to 1 and allocated to work (nt ),
leisure (lt ), and commuting time φT` . We normalize commuting time for zone 1 residents
to zero: φT2 > φT1 = 0. Since we will match income data that exclude the unemployed,
we impose a minimum constraint on the number of hours worked (n) for working-age
households. This restriction will also help us match the correlation between income and
wealth. There is an exogenous retirement age of 65. Retirees supply no labor.
   The age- and location-specific taste-shifter χ`,a (ct ) is normalized to one for all zone
2 residents. The shifter χ1 captures the amenity value of zone 1 relative to zone 2, in-
cluding for example relative school quality. The shifter χW (χ R ) increases the utility for
working-age (retired) households that live in zone 1 and consume above a threshold c.
This creates a complementarity between living in zone 1 and high consumption levels.

                                                            9
This modeling device captures that luxury amenities such as high-end entertainment,
restaurants, museums, or art galleries are concentrated in the urban core. Assuming that
the benefit from such luxury amenities only accrues above a certain consumption thresh-
old, provides an extra pull for rich households to live in the city center beyond the pull
provided by the opportunity cost of commuting. Guerrieri et al. (2013) achieve a similar
outcome through a neighborhood consumption externality. A special case of the model
arises for χ1 = χ R = χW = 1; location choice is solely determined by commuting costs.
Another special case is c = 0, which gives the same amenity value of the city center χ1 to
all households, regardless of consumption level. We solve and discuss these special cases
in Appendices H.2 and H.3.
   There are two types of households in terms of the time discount factor. One group
of households have a high degree of patience β H while the rest have a low degree of
patience β L . This preference heterogeneity helps the model match observed patterns of
wealth inequality and wealth accumulation over the life cycle. A special case of the model
with β H = β L is discussed in Appendix H.4.


Endowments      A household’s labor income ylab
                                            t depends on the number of hours worked
n, the wage per hour worked W, a deterministic component G a which captures the hump-
shaped pattern in average labor income over the life-cycle, and an idiosyncratic labor
productivity z, which is stochastic and persistent.
   After retirement, households earn a retirement income which is the product of an ag-
gregate component Ψ and an idiosyncratic component ψ a,z . The idiosyncratic component
has cross-sectional mean of one, and is determined by productivity during the last year
of work. Labor income is taxed linearly at rate τ SS to finance retirement income. All other
taxes and transfers are captured by the function T (∙) which maps total pre-tax income
into a net tax (negative if transfer). Net tax revenue goes to finance a public good which
does not enter in household utility.
   Households face mortality risk which depends on age, p a . Although there is no in-
tentional bequest motive, households who die leave accidental bequests. We assume that
the number of agents who die with positive wealth leave a bequest to the same number
of agents alive of ages 21 to 65. These recipient agents are randomly chosen, with one
restriction. Patient agents (β H ) only leave bequests to other patient agents and impatient
agents (β L ) only leave bequests to other impatient agents. One interpretation is that atti-
tudes towards saving are passed on from parents to children. Conditional on receiving a
bequest, the size of the bequest b
                                 bt+1 is a draw from the relevant distribution, which dif-
fers for β H and β L types. Because housing wealth is part of the bequest, the size of the

                                             10
bequest is stochastic. Agents know the distribution of bequests, conditional on β type.
This structure captures several features of real-world bequests: many households receive
no bequest, bequests typically arrive later in life and at different points in time for differ-
ent households, households anticipate bequests to some degree, and there is substantial
heterogeneity among bequest sizes for those who receive a bequest.


Affordable Housing           We model mandatory inclusionary zoning which requires devel-
opers to set aside a fraction η ` of rental housing units in zone ` for low-income households
at below-market rents.4 The rent per square foot is a fraction κ1 < 1 of the free-market
rent.5 Every household in the model enters the affordable housing lottery every period.
A household that wins the lottery in a zone can choose to turn down the affordable unit,
and rent or own in the location of its choice on the free market. 6 If the household accepts
the RC lottery win, it must abide by two conditions: (i) its income must be below a cutoff,
expressed as a fraction κ2 of area median income (AMI), when it first moves into the unit
– not in subsequent periods – and (ii), the rent paid on the unit must be below a fraction κ3
of AMI. The latter condition effectively restricts the maximum size of the affordable unit.
These conditions capture typical rent regulation and affordable housing specifications.
We refer to this system as the RC system and to the housing as RC units.
    Households that lived in an affordable housing unit in a given zone in the previous
period have an exogenously set, high probability of winning the lottery in the current
period, p RC,exog .7 This parameter value determines the persistence of the RC system. For
households that were not previously in RC, the probability of winning the lottery for
each zone is endogenously determined to equate the residual demand (once accounting
for persistent RC renters) and the supply of RC units in each zone. Households form
   4 Examples    of incentives provided for the development of affordable housing in NYC are (i) the 80/20
new construction housing program, a state program that gives low-cost financing to developers who set
aside at least 20% of the units in a property for lower-income families; (ii) the 421a program, which gives tax
breaks (up to 25 years) for the development of under-utilized or vacant sites often conditional on providing
at least 20% affordable units (i.e., used in conjunction with the 80-20 program), (iii) the Federal Low Income
Housing Tax Credits (LITCH) program, which gives tax credits to developers directly linked to the number
of low-income households served, and (iv) Mandatory Inclusionary Housing, a New York City program
that lets developers build bigger buildings and gives them tax breaks if they reserve some of the units for
(permanently) affordable housing.
    5 Since our model is stationary, this is equivalent to assuming that RC rents grow at the same rate as

private market rents. We think this is a reasonable approximation to capture a mixture of units that have a
nominal rent cap and units that are rent stabilized in that rents grow at a low and stable rate. We discuss
how we map our model to the NYC affordable housing data in the calibration section below.
    6 There is a single lottery for all affordable housing units. A certain lottery number range gives access to

affordable housing housing in zone 1, while a second range gives access to housing in zone 2. Households
with lottery numbers outside these ranges lose the housing lottery.
    7 For these households, the probability of winning the RC lottery in the other zone is set to zero.




                                                      11
beliefs about this probability. This belief must be consistent with rational expectations,
and is updated as part of the equilibrium determination. The affordable housing mandate
distorts labor supply, location choice, housing demand, and housing supply, as discussed
in the introduction.


Location and Tenure Choice        Denote by p RC,` the probability of winning the affordable
housing lottery and being offered a unit in zone `. The household chooses whether to
accept the RC option with value VRC,` , or to turn it down and go to the private housing
market with value Vf ree . The value function V is:

                                                                               
   V = p RC,1 max VRC,1 , Vf ree + p RC,2 max VRC,2 , Vf ree + 1 − p RC,1 − p RC,2 Vf ree .

A household that loses the lottery or wins it but turns it down, freely chooses in which
location ` ∈ {1, 2} to live and whether to be an owner (O) or a renter (R).

                             Vf ree = max {VO,1 , VR,1 , VO,2 , VR,2 } .

The Bellman equations for VRC,` , VR,` and VO,` are defined below.
   Let St be the vector which includes the wage Wt , the housing price Pt` , the market
rent Rt` and previous housing stock Ht`−1 for each location `. The household forms beliefs
about St . The household’s individual state variables are: its net worth at the start of the
period xt , its idiosyncratic productivity level zt , its age a, and its RC status in the previous
period d (equal to 0 if the household was not in RC, 1 if it was in RC in zone 1, and 2
if it was in RC in zone 2). The latter affects the probabilities of winning the lottery, and
whether the income constraint applies in the current period conditional on choosing RC.
We suppress the dependence on β-type in the problem formulation below, but note here
that there is one set of Bellman equations for each β-type.


Market Renter Problem         A renter household on the free rental market in location `
chooses non-durable consumption ct , housing consumption ht , and working hours nt




                                                 12
to solve:

     VR,` ( xt , zt , a, dt ) =       max            U (ct , ht , nt , `t ) + (1 − p a ) βE t [V ( xt+1 , zt+1 , a + 1, 0)]
                                  ct ,ht ,nt ,bt+1
      s.t.
                                                                
     ct + Rt` ht + Qbt+1 + φF` = 1 − τ SS ylab     z          tot ,
                                           t + Ψt ψ + xt − T yt
     ylab         a
      t = Wt n t Gz t ,            
                            1
     ytot
      t      =   ylab
                  t     +   Q   − 1 xt ,
     x t +1 = bt +1 + b
                      bt+1 ≥ 0,
      and equations (1), (2), (3), (4).

The renter’s savings in the risk-free bond, Qbt+1 , are obtained from the budget constraint.
Pre-tax labor income ylab
                      t is the product of wages W per efficiency unit of labor, the num-
ber of hours n, and the productivity per hour G a z. Total pre-tax income, ytot , is comprised
of labor income and financial income. Financial income for renters is the interest income
on bonds. The function T (∙) transforms total before-tax income into a net tax, and cap-
tures all insurance provided through the tax code. Additionally, a Social Security tax τ SS
is applied to labor income. Next period’s financial wealth xt+1 consists of savings bt+1
plus any accidental bequests b
                             bt+1 . Housing demand and labor supply choices are subject
to minimum constraints discussed above. In addition to a time cost, residents of zone
2 face a financial cost of commuting φ2F . As we did for the time cost, we normalize the
financial cost of commuting in zone 1 to zero: φ1F = 0.


RC Renter Problem                A renter household in the RC system in location ` chooses non-
durable consumption ct , housing consumption ht , and working hours nt to solve:

    VRC,` ( xt , zt , a, dt ) =         max           U (ct , ht , nt , `t ) + (1 − p a ) βE t [V ( xt+1 , zt+1 , a + 1, `)]
                                   ct ,ht ,nt ,bt+1
     s.t.
                                                                     
                                 ` = 1 − τ SS ylab + Ψ ψz + x − T ytot ,
    ct + κ1 R`t ht + Qbt+1 + φF,t              t      t      t     t
    x t + 1 = bt + 1 + b
                       bt+1 ≥ 0,
    ylab
     t ≤ κ2 Y t if dt = 0,
             κ3 Y t
    ht ≤     κ1 R`t
                    ,
     and equations (1), (2), (3), (4).

The per square foot rent of a RC unit is a fraction κ1 of the market rent Rt` . For households
who were not previously in the RC system (dt = 0) to qualify for RC, labor income must
not exceed a fraction κ2 of area median income (AMI), Y t = Median [ylab,i
                                                                     t     ], the median

                                                                   13
across all residents in the metro area. The last inequality says that expenditures on rent
(κ1 R`t ht ) must not exceed a fraction κ3 of AMI.8 We impose the same minimum house size
constraint in the RC system. We note that a household in RC in the current period carries
over her priority status for RC into the next period; the value function next period has RC
flag dt+1 = `.


Owner’s Problem    An owner in location ` chooses non-durable consumption ct , housing
consumption ht , working hours nt , and investment property b
                                                            ht to solve:

   VO,` ( xt , zt , a, dt ) =        max               U (ct , ht , nt , `t , a) + (1 − p a ) βEt [V ( xt+1 , zt+1 , a + 1, 0)]
                                ct ,ht ,b
                                        ht ,nt ,bt+1
    s.t.
                                                           
                                           ` = 1 − τ SS ylab + Ψ ψz + x + κ ` R` b
                                                                                                      
                                                                                                   tot ,
   ct + Pt` ht + Qbt+1 + κ4` Pt` bht + φF,t                     t        t       t     4 t ht − T yt
                      bt+1 + Pt`+1 ht (1 −δ` − τ P,` ) + κ4` Pt`+1 b
   x t + 1 = bt + 1 + b                                              ht (1 − δ` − τ P,` ),
   − Qt bt+1 ≤ Pt` θres ht + θinv κ4` b               ht − (ytot
                                         ht − κ4` Rt` b        t − c t ),
   b
   ht ≥ 0,
   κ4` = 1 − η ` + η ` κ1 ,
    and equations (1), (2), (3), (4).

    Local home owners are the landlords to the local renters. This is a departure from
the typical assumption of absentee landlords. 9 Our landlords are risk-averse households
inside the model. For simplicity, we assume that renters cannot buy investment property
and that owners can only buy investment property in the zone of their primary residence.
Landlords earn rental income κ ` R` b
                                    ht on their investment units b
                                                 4     t         ht . Per the affordable hous-
ing mandate, investment property is a bundle of η ` square feet of RC units and 1 − η `
square feet of free-market units. The effective rent earned per square foot of investment
property is κ4` R`t . Since the average rent is a multiple κ4 ≤ 1 of the market rent, the aver-
age price of rental property must be the same multiple of the market price, κ4` Pt` . Because
prices and rents scale by the same constant, the return on investing in rental property is
   8 In the implementation, we assume that the income and size qualification cutoffs for RC are constants.
We then compute what fractions κ2 and κ3 of AMI they represent. This allows us to sidestep the issue that
the AMI may change with RC policies.
   9 The majority of rentals in the urban core are multi-family units owned by corporations. According to

2015 Real Capital Analytics data, 81% of the Manhattan multifamily housing stock is owned by owner-
operator-developers which tend to be overwhelmingly local. Non-financial firms, some of which are also
local, own 3%. The remaining 16% is owned by financial firms, private equity funds or publicly listed
REITs. Since at least some of the investors in private equity funds or publicly listed REITs which hold New
York multifamily apartments are locals, the local ownership share is even higher than 81%. The majority of
rentals in the rest of the metro area are single-family rentals. About 99% of those are owned by small, local
owners.


                                                                     14
the same as that on owner-occupied housing. As a result, landlords are not directly af-
fected by RC regulation. However, the lower average price for rental property (κ4 < 1)
has important effects on housing supply/development, as discussed below.
    The physical rate of depreciation for housing units is δ` . The term P` hδ` is a financial
costs, i.e., a maintenance cost. As shown in equation (10) below, the physical depreciation
can be offset by residential investment undertaken by the construction sector. 10
    Property taxes on the housing owned in period t are paid in year t + 1; the tax rate
is τ P,` . Property tax revenue finances local government spending which does not confer
utility to the households.11
    Housing serves as a collateral asset for debt. For simplicity, mortgages are negative
short-term safe assets. In practice, mortgage rates are higher than bond rates but mort-
gage interest is also tax deducible. We assume these two effects cancel out. Households
can borrow a fraction θres of the market value of their primary residence and a poten-
tially different fraction θinv against investment property. The empirically relevant case
is θres ≥ θinv . We exclude current-period rental income and savings from the pledgable
collateral. In light of the fact that one period is four years in the calibration, we do not
want to include four years worth of (future) rental income and savings for fear of making
the borrowing constraint too loose.12
    Appendix A shows that, for renters, the choices of ht and nt are analytic functions of
ct . Therefore, the renter’s problem can be rewritten with just two choices: consumption
ct and location `. For owners, the choices of ht and nt are analytic functions of ct and b
                                                                                         ht .
Therefore, the owner’s problem can be rewritten with just three choices: consumption ct ,
investment property size b
                         ht , and location `.


2.2    Firms
Goods Producers         There are a large number n f of identical, competitive firms located in
the urban core (zone 1), all of which produce the num éraire consumption good.13 This
  10 The  model can accommodate a higher rate of depreciation for renter-occupied properties, possibly to
reflect the higher rate of depreciation for affordable housing units. We are not aware of empirical evidence
that shows that mandatory inclusionary housing results in higher depreciation of the affordable units. Tra-
ditional rent control is often associated with under-maintenance. We also note that the model captures that
the RC system results in lower rents and fewer units being built.
   11 This is equivalent to a model where public goods enter in the utility function, but in a separable way

from private consumption. A model where the public good enters non-separably in the utility function
would require taking a stance on the elasticity of substitution between private and public consumption.
   12 This assumptions helps the model match the home ownership rate. However, the affordable housing

policies would have similar effects without it.
   13 We assume that the number of firms is proportional to the number of households in the city when

solving the model. With this assumption, our numerical solution is invariant to the number of households.

                                                    15
good is traded nationally; its price is unaffected by events in the city and normalized
to 1. The firms have decreasing returns to scale and choose efficiency units of labor to
maximize profit each period:

                                                         ρ
                                    Πc,t = max Nc,tc − Wt Nc,t                                     (5)
                                             Nc,t


Developers and Affordable Housing Mandate                     In each location ` there is a large num-
ber n f of identical, competitive construction firms (developers) which produce new hous-
ing units and sell them locally. All developers are headquartered in the urban core, re-
gardless of where their construction activity takes place.
     The cost of the affordable housing mandate is born by developers. Affordable housing
regulation stipulates that for every 1 − η ` square foot of market rental units built in zone
`, η ` square feet of RC units must be built. Developers receive an average price per foot
for rental property of κ4` Pt` , while they receive a price per foot of Pt` for owner-occupied
units. Given a home ownership rate in zone ` of hot` , developers receive an average price
           `
per foot Pt :                                              
                                    `
                                  Pt = hot` + (1 − hot` )κ4` Pt` .                          (6)

The cost of construction of owner-occupied and rental property in a given location is the
same. After completion of construction but prior to sale, some of the newly constructed
housing units are designated as rental units and the remainder as ownership units. The
renter-occupancy designation triggers affordable housing regulation. It results in a lower
rent and price than for owner-occupied units. Developers would like to sell ownership
units rather than rental units, but the home ownership rate is determined in equilibrium.
                                                                                                   `
Developers are price takers in the market for space, and face an average sale price of Pt .
     A special case of the model is the case without rent control: κ4` = 1 either because
                                      `
η ` = 0 or κ1 = 1. In that case, Pt = Pt` . Without rent control, the higher sale price for
housing increases incentives to develop more housing.


Zoning     Given the existing housing stock in location `, Ht`−1 , and average sale price of
 `
Pt , construction firms have decreasing returns to scale and choose labor to maximize
profit each period:                                           !
                                         `           Ht`−1          ρ
                          Π`h,t =   max Pt   1−                   N`,th − Wt N`,t                  (7)
                                    N`,t                 H`
Due to decreasing return to scale, the numerical solution would depend on the number of households
otherwise.



                                                    16
The production function of housing has two nonlinearities. First, as for consumption
good firms, there are decreasing returns to scale because ρh < 1.
    Second, construction is limited by zoning laws. The maximal amount of square footage
zoned for residential use in zone ` is given by H ` . We interpret H ` as the total land area
zoned for residential use multiplied by the maximum permitted number of floors that
could be built on this land, the floor area ratio (FAR). This term captures the idea that,
the more housing is already built in a zone, the more expensive it is to build additional
housing. For example, additional construction may have to take the form of taller struc-
tures, buildings on less suitable terrain, or irregular infill lots. Therefore, producing twice
as much housing requires more than twice as much labor. Laxer zoning policy, modeled
as a larger H ` , makes development cheaper, and all else equal, will expand the supply of
housing.
    When H ` is sufficiently high, the model’s solution becomes independent of H ` , and
the supply of housing is governed solely by ρh . When H ` is sufficiently low, the housing
supply elasticity depends on both H ` and ρh .14
    Per capita profits from tradeable and construction sectors are:

                                        Πt = Πc,t + Π1h,t + Π2h,t

We assume that goods and construction firms are owned by equity holders outside the
city. Appendix H.5 considers a model where profits are redistributed to locals.


2.3       Equilibrium
Given parameters, a competitive equilibrium is a price vector (Wt , Pt` , R`t ) and an alloca-
tion, namely aggregate residential demand by market renters HtR,` , RC renters HtRC,` , and
owners H O,` , aggregate investment demand by owners H
            t
                                                      b ` , aggregate housing supply, ag-
                                                                     t
gregate labor demand by goods and housing producing firms (Nc,t , N`,t ), and aggregate
labor supply Nt such that households and firms optimize and markets clear.
    The following conditions characterize the equilibrium. First, given wages and aver-
age prices given by (6), firms optimize their labor demand, resulting in the first-order
  14 Inthis sense, the model captures that construction firms must pay more for land when land is scarce or
difficult to build on due to regulatory constraints. This scarcity is reflected in equilibrium house prices.




                                                    17
conditions:
                                                                                                1
                                                                                                 1− ρ h
                                                                             Ht`−1        `
                                                                 1 − H`                 Pt ρh 
                                      1
                             ρc       1− ρ c
                Nc,t =                          and    N`,t    =
                                                                
                                                                                               
                                                                                                         .    (8)
                             Wt                                       Wt


Second, labor demand equals labor supply:
                                                                    !
                                           nf     Nc,t + ∑ N`,t         = Nt .                                 (9)
                                                           `

Third, the housing market clears in each location `:
                                                                    !
                                                           Ht`−1
                                                                        N`,th = HtO,` + H
                                                                         ρ
                     (1 − δ   `
                                  ) Ht`−1      + nf   1−                                b t` .                (10)
                                                               H`

The left-hand-side is the supply of housing which consists of the non-depreciated hous-
ing stock and new residential construction. The right-hand-side is the demand for those
housing units by owner-occupiers and landlords. Fourth, the supply of rental units in
each location ` must equal the demand, from market tenants and RC tenants, respec-
tively:
                                  b t` (1 − η ` ) = H R,` ,
                                  H                                 b t` η ` = H RC,`
                                                                    H                                         (11)
                                                     t                          t

Fifth, total pension payments equal to total Social Security taxes collected:

                                                Ψt Nret = τ SS Nt Wt ,                                        (12)

where Nret is the total number of retirees, which is a constant, and Nt are total efficiency
units of labor. Sixth, the aggregate state St evolves according to rational expectations.
Seventh, the value of all bequests received is equal to the wealth of all agents who die. We
focus on the model’s steady state where all aggregate quantities and prices are constant.


2.4   Welfare Effects of Affordability Policies
We compute the welfare effect of an affordability policy using the following procedure.
Denote agent i’s value function under benchmark policy θb as Vi ( x, z, a, S; θb ). Consider
an alternative policy θ a with value function Vi ( x, z, a, S; θ a ). The alternative policy im-
plies a change in value functions, which we express in consumption equivalent units. We


                                                         18
compare steady state welfare for agents belonging to a group g with cardinality G:

                                           1
                                                                 !        1

                                           G   ∑i∈ g Vi (θ a )       (1−γ)(1−αn )
                                Wg =       1
                                                                                    − 1.                 (13)
                                           G   ∑i∈ g Vi (θb )

We focus on the following groups: the entire population, age groups, productivity groups,
income quartiles, and wealth quartiles. Since we equally weight all households, we as-
sume a utilitarian social welfare function. 15 The groups always have the same cardinality
(number of members) under the benchmark and alternative policies. Income and wealth
are endogenously determined. Therefore, different policies may lead to different house-
holds in a given income or wealth quartile. We do not aggregate welfare by tenure status,
except in the transition exercise discussed in Appendix I.16


3      Calibration
We calibrate the model to the New York MSA. Data sources are described in Appendix B.
Table 1 summarizes the chosen model parameters.


Geography        The New York metro consists of 25 counties located in New York (12), New
Jersey (12), and Pennsylvania (1). We assume that Manhattan (New York County) repre-
sents zone 1 and the other 24 counties make up zone 2. 17 The zones differ in size, mea-
sured by the maximum buildable residential square footage permitted by existing zoning
rules, H ` . Appendix B describes detailed calculations on the relative size of Manhattan
and the rest of the metro area, which imply that H 1 = 0.0238 × H 2 . We then choose H 2
such that the fraction of households living in zone 1 equals 10.5% of the total, the frac-
tion observed in in the data. Since the model has no vacancy, we equate the number of
    15 Because of the curvature of the value function, lower-income households implicitly receive a larger
weight. We have also computed our results assuming a welfare criterion that first transforms the value
functions V into V b before aggregation, where b can be chosen to over- or under-weight the poor vs. the
rich, relative to the utilitarian social welfare function. These results are available upon request.
   16 Tenure status groups do not have fixed cardinality and tenure status is strongly policy-dependent.

For example, a policy may increase the number of households who obtain a RC unit, but RC units may
be smaller in the alternative economy. Comparing the welfare of RC households in the steady state of
the benchmark to that of RC households in the steady state of the alternative economy may show a welfare
reduction because of the smaller unit size. It misses the potentially much larger welfare gain for households
who were not in RC in the benchmark but are in RC under the alternative policy.
   17 Alternative choices are to designate (i) New York City (five counties coinciding with the five boroughs

of NYC) as zone 1 and the rest of the metro as zone 2, or (ii) Manhattan as zone 1 and the other four counties
in New York City as zone 2. Both choices ignore that the dominant commuting pattern is from the rest of
the metro area to Manhattan.


                                                        19
households in the model with the number of occupied housing units in the data.


Demographics      The model is calibrated so that one model period is equivalent to 4 years.
Households enter the model at age 21, work until age 64, and retire with a pension at age
65. Survival probabilities p a are calibrated to mortality data from the Census Bureau.
People age 65 and over comprise 19.1% of the population age 21 and over in the data. In
the model, we get 21.8%. The average New York metro resident above age 21 is 47.6 years
old in the data and 47.4 years old in the model.


Labor Income     Recall that pre-tax labor income for household i of age a is ylab     i a i
                                                                               t = Wt nt G zt ,
where the household takes wages as given and chooses labor supply nit . The choice of
hours is subject to a minimum hours constraint, which is set to 0.5 times average hours
worked. This constraint rules out a choice of a positive but very small number of hours,
which we do not see in the data given the indivisibility of jobs. It also rules out unem-
ployment since our earnings data are for the (part-time and full-time) employed. This
constraint binds for only 6.15% of workers in equilibrium.
   Efficiency units of labor G a zit consist of a deterministic component that depends on
age (G a ) and a stochastic component zi that captures idiosyncratic income risk. The G a
function is chosen to enable the model to match the mean of labor earnings by age. We
use data from ten waves of the Survey of Consumer Finances (1983-2010) to estimate G a .
   The idiosyncratic productivity process z is chosen to both match earnings inequality
in the NY MSA data and to generate realistic persistence in earnings. We discretize z
as a 4-state Markov chain. The four states vary by age to capture the rising variance of
earnings with age. We use the SCF data to discipline the increase in variance by age. The
four grid points at the average age are chosen to match the NY metro pre-tax earnings
distribution from the Census Bureau. We choose annual household-level earnings cutoffs
in the data of $41,000, $82,000, and $164,000. This results in four earnings groups with
average earnings of $28,125, $60,951, $116,738, and $309,016. Average New York MSA
household earnings are $124,091; the median is $88,988. The four point grid for produc-
tivity z is chosen to match the average earnings in each group. This is an iterative process
since labor supply is endogenous and depends on all other parameters and features of
the model.
   The 4 × 4 transition probability matrix for zi is age-invariant, but is allowed to depend
on β type. Specifically, the expected duration of the highest productivity state is higher
for the more patient agents. There are five unique parameters governing transition prob-
abilities which are pinned down by five moments in the data. The four income groups

                                             20
have population shares in the data of 16.1%, 29.8%, 34.2%, and 19.9%, respectively. Since
the shares sum to 1, that delivers three restrictions on the transition matrix. Matching the
persistence of labor income to 0.9 delivers a fourth restriction. Finally, the dependence on
β is calibrated to deliver the observed correlation between income and wealth in the SCF
data. Appendix C contains the parameter values and further details.


Taxation      Since our model is an incomplete markets model, housing affordability poli-
cies can act as an insurance device and help to “complete the market.” Therefore, it is
important to realistically calibrate the redistribution provided through the tax code. We
follow Heathcote, Storesletten, and Violante (2017) and choose an income tax schedule
that captures the observed progressivity of the U.S. tax code in a parsimonious way. Net
taxes are given by the function T (∙):

                                        T (ytot ) = ytot − λ(ytot )1−τ

The parameter τ governs the progressivity of the tax and transfer system. We set τ = 0.17
to match the average income-weighted marginal tax rate of 34% for the U.S. It is close to
the value of 0.18 estimated by Heathcote et al. (2017). We set λ to match federal, state, and
local government spending to aggregate income in the NY metro area, equal to 15-20%. 18
This delivers λ = 0.75. Appendix D shows the resulting tax and after-tax income along
the before-tax income distribution.


Retirement Income           Social Security taxes and receipts are treated separately from the tax
and transfer system.19 Social Security taxes are proportional to labor earnings and set to
τ SS = 0.10, a realistic value. Retirement income is increasing in the household’s last pro-
ductivity level prior to retirement, but is capped for higher income levels. We use actual
Social Security rules to estimate each productivity group’s pension relative to the aver-
age pension. The resulting pension income states are ψz = [0.50, 1.03, 1.13, 1.13], where
z reflects the last productivity level prior to retirement. They are multiplied by average
retirement income Ψ, which is endogenously determined in equation (12) to balance the
social security budget. Average retirement income Ψ is $44364, which corresponds to 36%
of average earnings.
  18 Depending   on what share of NY State spending goes to the NY metro area, we get a different number
in this range.
  19 Social security is not in T ( y ) because a large part of it is not a transfer, but rather an inter-temporal

savings vehicle.




                                                       21
                                                                      Table 1: Calibration

     Description                                Parameter                         Value                                             Target
     Panel A: Geography and Income
     Productivity states                        Z                               [0.255 0.753 1.453 3.522]                    Income inequality - see App. C
     Transition prob.                           ( p11 , p22 , p33 , p44 , p H ) (0.93,0.92,0.92,0.82,0.02) Pop. shares of income groups, persistence of income - see App. C
     Tax progressivity                          τ                                           0.17                                 Heathcothe et al. (16)
     Tax burden                                 λ                                           0.75                                  Pension tax revenue
     Average pension                            Ψ                                           0.16                            Average replacement rate of 35%
     Pension distr.                             ψz                                 [0.50 1.03 1.13 1.13]                           U.S. pension rules
     Available space                            ( H1 , H2 )                             (0.05,2.11)             Max. residential buildable area, pop. share Manhattan
     Time-Commuting cost                        φT2                                        0.037                              Average commuting time NY
     Financial-Commuting cost                   φ2F                                         0.01                              Average commuting cost NY
     Panel B: Preferences
     Risk aversion                              γ                                     5                                        Standard value
     Leisure weight                             αn                                  0.63                                  Average NY work week
     Housing consumption weight                 αh                                  0.41                                Avg. rent/avg. income of 23%
     CES parameter consumption/housing          e                                  -0.50                  Elasticity of substitution consumption/housing of 2/3
     Minimum hours worked                       n                                   0.15                        Min. hours worked of 15% of available time
     Time Preference (4yr)                      (βH , βL )                     (1.281,0.985)             Average wealth/income 5.69 and wealth Gini 0.80 in SCF




22
     Cons. externality threshold                c                                   0.45                      House-price/income ratio of zones in NY data
     Extra utility zone 1 workers               χW                                 1.004                              Income ratio of zones in NY data
     Extra utility zone 1 retirees              χR                                 1.038                       Fraction of retirees ratio of zones in NY data
     Extra utility zone 1 all                   χ1                                 1.080                           Rent per sqft ratio of zones in NY data
     Panel C: Finance, Housing, Construction
     Bond Price (4yr)                           Q                                   0.89                               Price/rent ratio in NYC area
     Maximum residential LTV                    θres                                0.80                            Median mortgage downpayment
     Maximum investment LTV                     θinv                                0.80                            Mortgage underwriting standards
     Property tax (4yr)                         (τ P,1 , τ P,2 )               (0.029,0.053)                Property tax rate in Manhattan and NY metro area
     Depreciation rate                          ( δ1 , δ2 )                    (0.058,0.096)                              Res. depreciation BEA
     Minimum housing size                       h                                   0.25                               Legal minimum housing size
     Panel D: Production
     Return to scale consumption sector         ρc                                 0.66                                 Labor income share of 2/3
     Return to scale housing sector             ρh                                 0.66                               Housing supply elasticity for NY
     Panel E: Affordable Housing
     Fraction rent control                      (η 1 , η 2 )                 (24.46%,15.97%)                  Fraction of households in RC of 13% and 4.7%
     Probability to win RC lottery when in RC   p RC,exog                          0.76                   Fraction of RC households in same unit for ≥ 20 years
     Rental discount                            κ1                                 50%                                   Observed rental discount
     Income threshold for RC                    κ2                                 0.40                             Income distribution of RC tenants
     Rental share threshold for RC              κ3                                 0.35                                  Standard program value
Commuting Cost         We choose the time cost to match the time spent commuting for the
average New York metro area resident. This time cost is the average of all commutes, in-
cluding those within Manhattan. Since the model normalizes the commuting time within
zone 1 to zero, we target the additional commuting time of zone 2 residents. The addi-
tional commuting time amounts to 25 minutes per trip for 10 commuting trips per week. 20
The 4.2 hours represent 3.7% of the 112 hours of weekly non-sleeping time. Hence, we set
φT2 = 0.037.
   The financial cost of commuting φ2F is set to 1.8% of average labor earnings, or $2281
per household per year. This is a reasonable estimate for the commuting cost in excess of
the commuting cost within Manhattan, which is normalized to zero. 21
   We assume that retirees have time and financial commuting costs that are 1/3 of those
of workers. This captures that retirees make fewer trips, travel at off-peak hours, and
receive transportation discounts.


Preferences     The functional form for the utility function is given in equation (1). We set
risk aversion γ = 5, a standard value in the macro-finance literature. Since risk aversion
governs the value of insurance against risk, it is a key parameter. In Appendix H.1, we
redo the analysis for a risk aversion value of 2. We assume Cobb-Douglas preferences
between consumption (of non-durable goods and housing services) and leisure.
   The observed average workweek for New York metro residents is 42.8 hours or 38.2%
of available non-sleeping time. Since there are 1.64 workers on average per household,
household time spent working is 38.2% × 1.64/2=31.3%. We set αn to match household
time spent working. The model generates 30.9% of time worked.
   Our model generates an (endogenous) average Frisch elasticity of 0.65, with 25th and
75th percentiles of 0.56 and 0.76. This is in line with estimates based on the intensive
margin of labor supply in micro data. This is an important object because misallocation
coming from workers’ persistent location and labor supply decisions partly depend on
how sensitive labor supply is to wage changes.
   We set αh in order to match the ratio of average market rent to metro-wide average
  20 The 25 minute additional commute results from a 15 minute commute within Manhattan and a 40

minute commute from zone 2 to zone 1. With 10.5% of the population living in Manhattan, the average
commuting time is 37.4 minutes per trip or 6.2 hours a week. This is exactly the observed average for the
New York metro from Census data.
  21 In NYC, an unlimited subway pass costs around $1,400 per year per person. Rail passes from the

suburbs cost around $2400 per year per person, depending on the railway station of departure. If zone 1
residents need a subway pass while zone 2 residents need a rail pass, the cost difference is about $1000
per person. With 1.64 workers per household, the cost difference is $1640 per household. The cost of
commuting by car is at least as high as the cost of rail once the costs of owning, insuring, parking, and
fueling the car and tolls for roads, bridges, and tunnels are factored in.


                                                   23
income. Income data discussed above and rental data from Zillow, detailed in Appendix
B, indicate that this ratio is 23.0% for the New York MSA in 2015. The model generates
24.1%.
    We set β H = 1.281 (1.064 per year) and β L = 0.985 (0.996 per year). A 25% share
of agents has β H , the rest has β L . This delivers an average β of 1.06, chosen to match
the average wealth-income ratio which is 5.69 in the 1998-2010 SCF data. The model
generates 5.95. The dispersion in betas delivers a wealth Gini coefficient of 0.79, close to
the observed wealth Gini coefficient of 0.80 for the U.S. 22 Note that because of mortality,
the effective time discount rate is (1 − p( a)) β.
    The taste-shifter for zone 1 is parameterized as: χ1 = 1.080, χW = 1.004, χ R = 1.038,
c = 0.45. Living in Manhattan gives a substantial utility boost, equivalent to a 8%
higher consumption bundle. About 28% of the Manhattan population consumes above
the threshold c. This group derives extra utility from living in Manhattan, especially the
retirees in this group (χ1 χ R = 1.121). We chose these four parameters to get our model
to better match the following four ratios of zone 1 relative to zone 2 variables, given all
other parameters: the relative fraction of retirees of 0.91, a relative household income ra-
tio of 1.66, the relative ratio of market rents per square foot of 2.78, and the relative home
ownership rate of 0.42. In the model, these ratios are 1.00, 1.69, 2.77, and 0.76, respectively.


Housing       The price for the one-period (4-year) bond is set to Q = 0.89 to match the
average house price to rent ratio for the New York MSA, which is 17.79. The model
delivers 16.94. Under the logic of the user cost model, the price-to-rent ratio depends on
the interest rate, the depreciation rate, and the property tax rate.
    The property tax rate in Manhattan is τ P,1 = 0.029 or 0.73% per year, and that in zone
2 is τ P,2 = 0.053 or 1.33% per year. These match the observed tax rates averaged over
2007-2011 according to the Brookings Institution. 23
    The housing depreciation rate in Manhattan is δ1 = 0.058 or 1.45% per year, and that
in zone 2 is δ2 = 0.096 or 2.41% per year. This delivers a metro-wide average depreciation
rate of 2.39% per year, equal to the average depreciation rate for privately-held residential
property in the BEA Fixed Asset tables for the period 1972-2016. The annual depreciation
wedge of 0.96% between zones 1 and 2 is chosen to match the relative fraction of buildings
that were built before 1939.24
  22 No wealth data is available for the NY metro. We believe it is likely that wealth inequality is at least as

high in the NY metro than in the rest of the U.S.
  23 The zone-2 property tax rate is computed as the weighted average across the 24 counties, weighted by

the number of housing units.
  24 Data from the 5-year American Community Survey from 2017 give the distribution of housing units




                                                      24
    We set the maximum loan-to-value ratio (LTV) for the primary residence at 80% (θres =
0.8), implying a 20% down payment requirement. This is the median down-payment in
the U.S. data on purchase mortgages. The LTV for investment property is also set at 80%
(θinv = 0.8) for simplicity.
    Finally, we impose a minimum housing size of 557 square feet, or 39% of the average
housing unit size of 1445 square feet. This is a realistic value for New York given the
model is solved at the household level (with 1.64 members on average).


Production and Construction             We assume that the return to scale ρc = 0.66. This value
implies a labor share of 66% of output, consistent with the data.
    For the housing sector, we also set ρh = 0.66 in order to match the housing supply
elasticity, given the other parameters. The long-run housing supply elasticity in the model
is derived in Appendix E. Saiz (2010) reports a housing supply elasticity for the New York
metro area of 0.76. The model delivers 0.71. The housing supply elasticity is much lower
in zone 1 (0.08) than in zone 2 (0.73), because in zone 1 the housing stock is much closer to
H (11% from the constraint) than in zone 2 (71% from the constraint). Since the housing
stock of the metro area is concentrated in zone 2, the city-wide elasticity is dominated by
that in zone 2.


Affordable Housing          Rent regulation plays a major role in the New York housing mar-
ket, as discussed above. Direct measurement on the number of mandatory inclusionary
housing units is not available. Nor is it appropriate given that there are many more af-
fordable housing units from a range of programs. We define RC housing as all housing
units that are (i) rent controlled, (ii) public housing, (iii) Mitchell Lama housing, (iv) all
other government-assisted or regulated housing. We find that 13.0% of zone 1 house-
holds and 4.7% of zone 2 households live in RC units. The metro-wide average is 5.57%,
the ratio of zone 1 to zone 2 is 2.77. Appendix B.5 contains a detailed description of data
and definitions.25
    We set the share of square feet of rental housing devoted to RC units, η 1 = 24.46% and
η 2 = 15.97%, to match the share of households in the entire population that are in RC units
by year built for each of the 25 counties in the New York MSA. In Manhattan, 42.8% of units are built
before 1939. The housing-weighted average among the 24 counties of zone 2 is 26.6%. Assuming geometric
depreciation, matching this fraction requires a 0.96% per year depreciation wedge.
  25 We chose to exclude rent stabilized units from this definition. Rents on rent stabilized units are in be-

tween those on market rentals and RC rentals. An alternative definition of RC that includes rent-stabilized
units would have a higher η ` and a lower rent discount (κ1 = 0.70, or 30% below the market rent). We solve
such a model as a robustness check. Below, we also study a range of policies that increase η ` .



                                                     25
in each zone. This fraction is endogenous since housing size and ownership are choice
variables.
      According to the same definition and data sources, the average rent in RC units is 50%
below that in all other rentals. We set the rent discount parameter κ1 = 50%. It follows
that κ41 = 1 − η 1 + η 1 κ1 = 0.88 and κ42 = 0.92, so that landlords earn 12% lower rents in
zone 1 and 8% lower rents in zone 2 than they would in an unregulated market.
      We set the income qualification threshold to a fraction κ2 = 40% of AMI. We set κ3 =
35% so that households in affordable housing spend no more than 35% of AMI on rent, a
standard value. These two parameters affect the composition of households who live in
RC housing. The lower κ2 , the larger the share of RC tenants that come from the bottom
of the income distribution. Similarly, κ3 affects who lives in RC. High-income agents in
the model want to live in a house that is larger than the maximum allowed size under
RC and would turn down a RC lottery win. We use data from the New York Housing
and Vacancy Survey to study where in the NYC income distribution the RC tenants are
located. The model matches the relative income of RC tenants for these choices of κ2 and
κ3 . Table 5 in Appendix B.5 provides more detail.
      Finally, we calibrate the persistence of the RC system. We assume that households
who were in RC in the previous period have a probability of 76.4% to qualify for RC in
the same zone this period. The value is chosen to match the fraction of RC tenants who
have lived in a RC unit for 20 years or more. That number in the data is 23.1%. 26 It is
25.2% in the model.


4       Baseline Model Results
We start by discussing the implications of the baseline model for the spatial distribution
of population, housing, income, and wealth. We also discuss house prices and rents for
the city as a whole and for the two zones. Then we look at the model’s implications for
income, wealth, and home ownership over the life-cycle.


4.1      Demographics, Income, and Wealth
Demographics             The first three rows of Table 2 show that the model matches basic demo-
graphic moments. In the data, retirees represent 19.1% of Manhattan residents, and the
model matches this share. On the one hand, retirees have lower time and financial costs
of commuting, giving them a comparative advantage to living in zone 2. On the other
    26 See   Table H of the NYU Furman Institutes’ 2014 “Profile of Rent-Stabilized Units and Tenants in NYC.”

                                                        26
hand, retirees tend to be wealthier making living in Manhattan financially feasible. Ab-
sent a taste for Manhattan, the commuting cost effect would drive most retirees to zone
2. A fairly strong preference for living in Manhattan is needed to offset the commuting
effect (χ1 = 1.080, χ R = 1.038) and match the relative share of retirees in zone 1 to zone 2.

                           Table 2: New York Metro Data Targets and Model Fit

                                                                             Data                             Model
                                                                 metro     ratio zone 1/zone 2    metro     ratio zone 1/zone 2
          1    Households (thousands)                            7124.9            0.12           7124.9            0.12
          2    Avg. hh age, cond over 20                           47.6            0.95            47.4             0.86
          3    People over 65 as % over 20                         19.1            0.91            21.8             1.00
          4    Avg. house size (sqft)                             1445             0.59            1449             0.64
          5    Avg. pre-tax lab income ($)                       124091            1.66           124320            1.69
          6    Home ownership rate (%)                             51.5            0.42            58.4             0.76
          7    Median mkt price per unit ($)                     510051            3.11           506420            2.34
          8    Median mkt price per sqft ($)                       353             5.24             344             3.57
          9    Median mkt rent per unit (monthly $)               2390             1.65            2491             1.82
          10   Median mkt rent per sqft (monthly $)                1.65            2.78            1.69             2.77
          11   Median mkt price/median mkt rent (annual)          17.79            1.89            16.94            1.29
          12   Mkt price/avg. income (annual)                      3.99            1.71            4.08             1.38
          13   Avg. rent/avg. income (%)                           23.0            1.00            24.1             1.07
          14   Avg. rent/income ratio for renters (%)              42.1            0.81            29.1             0.97
          15   Rent burdened (%)                                   53.9            0.79            48.7             0.93
          16   % Rent regulated of all housing units               5.57            2.77            5.98             2.61


Notes: Columns 2-3 report the values for the data of the variables listed in the first column. Data sources and construction are described
in detail in Appendix B. Column 3 reports the ratio of the zone 1 value to the zone 2 value in the data. Column 5 reports the same
ratio in the model.




Housing Units              In the data, the typical housing unit is much smaller in Manhattan than
in the rest of the metro area. We back out the typical house size (in square feet) in each
county as the ratio of the median house value and the median house value per square
foot, using 2015 year-end values from Zillow. We obtain an average housing unit size of
897 sqft in Manhattan and 1,510 sqft in zone 2; their ratio is 0.59. In the model, households
freely choose their housing size subject to a minimum house size constraint. The model
generates a similar ratio of house size in zone 1 to zone 2 of 0.64.
     Figure 1 shows the distribution of house sizes. The model (left panel) matches the
data (right panel) quite well, even though these moments are not targeted by the calibra-
tion. The size distribution of owner-occupied housing is shifted to the right from the size
distribution of renter-occupied housing units in both model and data.


Mobility         The model implies realistic moving rates from zone 1 to zone 2 and vice versa,
despite the absence of moving costs. Mobility rates are not targeted by the calibration.


                                                                   27
                                                     Figure 1: House size distribution in Model (L) and Data (R)

                                                                                             All                                                                                                                                     All
            Number of households    1000                                                                                                                                1000




                                                                                                                                                Number of households
                                              500                                                                                                                                 500




                                                0                                                                                                                                   0




                                                                                                                                                                                         49
                                                     49




                                                                                                                                                                                                                                                                                 0
                                                                                                                                       0




                                                                                                                                                                                                        9
                                                                9




                                                                                                                                                                                                                     9


                                                                                                                                                                                                                                9


                                                                                                                                                                                                                                              9


                                                                                                                                                                                                                                                         9


                                                                                                                                                                                                                                                                       9
                                                                              9


                                                                                         9


                                                                                                      9


                                                                                                                 9


                                                                                                                              9




                                                                                                                                                                                                                                                                             00
                                                                                                                                   00




                                                                                                                                                                                                    99
                                                               99




                                                                                                                                                                                                                 49


                                                                                                                                                                                                                               99


                                                                                                                                                                                                                                          49


                                                                                                                                                                                                                                                        99


                                                                                                                                                                                                                                                                   99
                                                                          49


                                                                                       99


                                                                                                  49


                                                                                                               99


                                                                                                                          99




                                                                                                                                                                                        <7
                                                    <7




                                                                                                                                                                                                                                                                            >4
                                                                                                                                  >4




                                                                                                                                                                                                   0-
                                                           0-




                                                                                                                                                                                                              -1


                                                                                                                                                                                                                           -1


                                                                                                                                                                                                                                         -2


                                                                                                                                                                                                                                                    -2


                                                                                                                                                                                                                                                                  -3
                                                                         -1


                                                                                    -1


                                                                                                 -2


                                                                                                            -2


                                                                                                                         -3




                                                                                                                                                                                               75
                                                          75




                                                                                                                                                                                                            00


                                                                                                                                                                                                                          00


                                                                                                                                                                                                                                     00


                                                                                                                                                                                                                                                   00


                                                                                                                                                                                                                                                              00
                                                                     00


                                                                                  00


                                                                                             00


                                                                                                          00


                                                                                                                     00




                                                                                                                                                                                                         10


                                                                                                                                                                                                                      15


                                                                                                                                                                                                                                    20


                                                                                                                                                                                                                                               25


                                                                                                                                                                                                                                                             30
                                                                    10


                                                                               15


                                                                                            20


                                                                                                       25


                                                                                                                    30
                                                                                       Sqft                                                                                                                                   Sqft
                                                                                    Homeowners                                                                                                                             Homeowners
                                              500                                                                                                                                 500
                       Number of households




                                                                                                                                                           Number of households
                                              400                                                                                                                                 400

                                              300                                                                                                                                 300

                                              200                                                                                                                                 200

                                              100                                                                                                                                 100

                                                0                                                                                                                                   0
                                                     49




                                                                                                                                                                                         49
                                                                                                                                       0




                                                                                                                                                                                                                                                                        0
                                                                9




                                                                                                                                                                                                    9
                                                                              9


                                                                                         9


                                                                                                      9


                                                                                                                 9


                                                                                                                              9




                                                                                                                                                                                                                 9


                                                                                                                                                                                                                           9


                                                                                                                                                                                                                                     9


                                                                                                                                                                                                                                                   9


                                                                                                                                                                                                                                                             9
                                                                                                                                   00




                                                                                                                                                                                                                                                                       00
                                                               99




                                                                                                                                                                                                   99
                                                                          49


                                                                                       99


                                                                                                  49


                                                                                                               99


                                                                                                                          99




                                                                                                                                                                                                             49


                                                                                                                                                                                                                          99


                                                                                                                                                                                                                                    49


                                                                                                                                                                                                                                               99


                                                                                                                                                                                                                                                            99
                                                    <7




                                                                                                                                                                                        <7
                                                                                                                                  >4




                                                                                                                                                                                                                                                                   >4
                                                           0-




                                                                                                                                                                                               0-
                                                                         -1


                                                                                    -1


                                                                                                 -2


                                                                                                            -2


                                                                                                                         -3




                                                                                                                                                                                                            -1


                                                                                                                                                                                                                      -1


                                                                                                                                                                                                                                -2


                                                                                                                                                                                                                                              -2


                                                                                                                                                                                                                                                        -3
                                                          75




                                                                                                                                                                                              75
                                                                     00


                                                                                  00


                                                                                             00


                                                                                                          00


                                                                                                                     00




                                                                                                                                                                                                        00


                                                                                                                                                                                                                     00


                                                                                                                                                                                                                               00


                                                                                                                                                                                                                                          00


                                                                                                                                                                                                                                                       00
                                                                    10


                                                                               15


                                                                                            20


                                                                                                       25


                                                                                                                    30




                                                                                                                                                                                                    10


                                                                                                                                                                                                                 15


                                                                                                                                                                                                                           20


                                                                                                                                                                                                                                         25


                                                                                                                                                                                                                                                   30
                                                                                          Sqft                                                                                                                                   Sqft
                                                                                         Renters                                                                                                                                Renters
                       Number of households




                                                                                                                                                           Number of households
                                              800                                                                                                                                 800

                                              600                                                                                                                                 600

                                              400                                                                                                                                 400

                                              200                                                                                                                                 200

                                                0                                                                                                                                   0
                                                     49




                                                                                                                                                                                         49
                                                                                                                                       0




                                                                                                                                                                                                                                                                        0
                                                                9




                                                                                                                                                                                                    9
                                                                              9


                                                                                         9


                                                                                                      9


                                                                                                                 9


                                                                                                                              9




                                                                                                                                                                                                                 9


                                                                                                                                                                                                                           9


                                                                                                                                                                                                                                     9


                                                                                                                                                                                                                                                   9


                                                                                                                                                                                                                                                             9
                                                                                                                                   00




                                                                                                                                                                                                                                                                       00
                                                               99




                                                                                                                                                                                                   99
                                                                          49


                                                                                       99


                                                                                                  49


                                                                                                               99


                                                                                                                          99




                                                                                                                                                                                                             49


                                                                                                                                                                                                                          99


                                                                                                                                                                                                                                    49


                                                                                                                                                                                                                                               99


                                                                                                                                                                                                                                                            99
                                                    <7




                                                                                                                                                                                        <7
                                                                                                                                  >4




                                                                                                                                                                                                                                                                   >4
                                                           0-




                                                                                                                                                                                               0-
                                                                         -1


                                                                                    -1


                                                                                                 -2


                                                                                                            -2


                                                                                                                         -3




                                                                                                                                                                                                            -1


                                                                                                                                                                                                                      -1


                                                                                                                                                                                                                                -2


                                                                                                                                                                                                                                              -2


                                                                                                                                                                                                                                                        -3
                                                          75




                                                                                                                                                                                              75
                                                                     00


                                                                                  00


                                                                                             00


                                                                                                          00


                                                                                                                     00




                                                                                                                                                                                                        00


                                                                                                                                                                                                                     00


                                                                                                                                                                                                                               00


                                                                                                                                                                                                                                          00


                                                                                                                                                                                                                                                       00
                                                                    10


                                                                               15


                                                                                            20


                                                                                                       25


                                                                                                                    30




                                                                                                                                                                                                    10


                                                                                                                                                                                                                 15


                                                                                                                                                                                                                           20


                                                                                                                                                                                                                                         25


                                                                                                                                                                                                                                                   30
                                                                                             Sqft                                                                                                                                   Sqft




Notes: Left panel: model. Right panel: data. Data source: American Housing Survey for the New York MSA, U.S. Census Bureau,
2015.



Figure 9 in Appendix F shows that mobility is highest for the young (21-25) and for
middle-aged households (35-40). For these two groups, the annual mobility rate is 4%
annually. The overall mobility rate across neighborhoods in the model is about 2% annu-
ally. These data are consistent with the facts for the NY MSA, where 2.1% of households
move between counties within the MSA annually. 27


Income                                        Average income in the metro area matches the data (row 5 of Table 2) by virtue
of the calibration. The ratio of average income in zone 1 to zone 2 is 1.69 in the model and
1.66 in the data.
    The productivity distribution is substantially different in the two zones. Zone 1 con-
tains workers that are on average 80% more productive than in zone 2. Productive working-
age households have a high opportunity cost of time and prefer to live close to work given
the time cost of commuting. Mitigating the high opportunity cost of time is the high cost
of living in Manhattan. Indeed, some high-productivity workers may still be early in
  27 Data   from the U.S. Census Bureau on annual average county-to-county migration rates for 2012-2016.



                                                                                                                                           28
the life-cycle when earnings are lower and accumulated wealth smaller. Only 29.7% of
working-age, top-productivity households live in zone 1. Since χW is close to 1, the lux-
ury amenity value of living in Manhattan for working-age households is not needed to
explain the observed income gap between zone 1 and zone 2. The commuting cost alone
is a strong enough force.
   Figure 2 plots how households of different productivity types sort across space (left
panel is zone 1, right panel is zone 2) and across tenure status. The vertical axes measures
the total square footage devoted to the various types of housing in each zone. Values
reported on the top of the bars correspond to the percentage of households in each category.
These percentages add up to 100% across the six housing categories. Colors correspond
to productivity levels: increasing in shade from yellow (low, z = 1) to red (high, z = 4)
for working-age households, and green for retirees. The graph shows many (wealthy)
retirees in zone 1 as well as many top-productivity households. The only bottom- and
lower middle-productivity households (z = 1, 2) that live in zone 1 are in RC housing.
Low-productivity households cluster in zone 2.
Figure 2: Geographic distribution of households in the benchmark model: zone 1 (left
panel) versus zone 2 (right panel).

                     Zone 1                                            Zone 2
  25                                               250


                                                                53.3



  20                                               200




  15           5.6                                 150




  10                                               100


                                                                         30.7


                       3.5
   5                                                50


                                1.4
                                                                                  5.5


   0                                                 0
             Owner   Renter    RC                              Owner   Renter    RC




   The top panel of Figure 3 shows household labor income over the life-cycle, measured
as pre-tax earnings during the working phase and as social security income in retirement.
We plot average income for the bottom 25% of the income distribution, for the middle
of the income distribution (25-50%), and for the top 25% of the distribution, as well as
the overall average income. Labor income has the familiar hump-shaped profile over the
life-cycle inherited from the deterministic productivity process G a . The model generates

                                            29
a large amount of income inequality at every age. The model’s earnings Gini of 0.45
matches the 0.47 value in the 2015 NY metro data. 28 Earnings inequality in the model is
lower within zone 1 (Gini of 0.38) than within zone 2 (Gini of 0.45).


Wealth     The model makes predictions for average wealth, the distribution of wealth
across households, as well as how that wealth is spatially distributed. Average wealth
to average total income (ytot ) in the metro area is 5.95. Wealth inequality is high, with a
wealth Gini coefficient of 0.79. Both are close to the data by virtue of the calibration.
    The middle panel of Figure 3 shows household wealth over the life cycle at the same
income percentiles as in the top panel. It shows that the model endogenously generates
substantial wealth accumulation for the average New York resident as well as a large
amount of wealth inequality between income groups. Wealth inequality grows with age
during the working phase.


4.2    Home Ownership, House Prices, and Rents
Next, we discuss the model’s predictions for home ownership, house prices, and rents.
The model manages to drive a large wedge between house prices, rents, and home own-
ership rates between zones 1 and 2 for realistic commuting costs.


Home Ownership           The model generates a home ownership rate of 58.4%, fairly close to
the 51.5% in the New York MSA. The bottom panel of Figure 3 plots the home ownership
rate over the life-cycle. It displays a hump-shape over the life-cycle with variation across
income groups. High-income households become home owners at a younger age than
low-income households, achieve a higher ownership rate, and remain home owners for
longer during retirement. These patterns are broadly consistent with the data.
    Row 6 of Table 2 shows that the observed home ownership rate in Manhattan, at 23.1%,
is far below that in the rest of the metro area, at 54.9%. The ratio of these two numbers is
0.42. The model generates a home ownership rate of 45.1% for Manhattan, which is sub-
stantially lower than the predicted 59.6% for zone 2. While its prediction for home owner-
ship in zone 2, where 89.5% of the population lives, is close to the data, the model fails to
generate the very low home ownership rate in Manhattan. The insufficiently large wedge
in home ownership rates across zones is connected to the insufficiently large wedge in
  28 The Gini in the data is calculated by fitting a log-normal distribution to the mean and median of earn-

ings.




                                                    30
          Figure 3: Income, Wealth, and Home Ownership over the Life-Cycle



                                      400                                               Mean
                                                                                        Bottom 25% income



                       Labor Income
                                      300                                               Middle 50% income
                                                                                        Top 25% income
                                      200

                                      100

                                           0
                                            20   30     40     50        60   70   80                       90



                               4000
                   Net Worth




                               3000

                               2000

                               1000

                                           0
                                            20   30     40     50        60   70   80                       90


                                           1
                          Homeownership




                                          0.8

                                          0.6

                                          0.4

                                          0.2

                                           0
                                            20   30     40     50        60   70   80                       90




the price-rent ratios across zones. Intuitively, since owning is only somewhat more ex-
pensive than renting in zone 1 relative to zone 2, the home ownership rate in zone 1 is
only somewhat lower than in zone 2. We discuss the price-rent ratio wedge further below.


Market Prices and Rents                          Row 7 of Table 2 shows the median price per housing unit, row
8 the median price per square foot, row 9 the median rent per unit, and row 10 the median
rent per square foot. For the data, we use the Zillow home value index (ZHVI) to measure


                                                                    31
the median price of owner-occupied units, the Zillow median home value per square foot,
and the Zillow rental index (ZRI) for the median rent per unit. These indices are available
for each county in the New York metro, and we use the year-end 2015 values. 29 The ratio
of the ZHVI to the ZRI in a county, is the price-rent ratio, reported in row 11 of the table.
    The median house value in the NY metro area is $510,051 in the data compared to
$506420 in the model.30 The median is $1.3 million in Manhattan and $417,000 outside
Manhattan in the data, a ratio of 3.11. This 3.11 house value ratio is the product of a house
size ratio of 0.59 and a price per sqft ratio of 5.24. The model generates a ratio of prices
per unit of 2.34, the product of a house size ratio of 0.64 and a price per sqft ratio of 3.57.
    The data indicate a monthly rent on a typical market-rate unit of $2,390 per month in
the metro area. The model predicts $2491. The ratio of rents per square foot in zone 1 to
zone 2 is 2.78 in the data and matches the 2.77 in the model by virtue of the calibration.
The ratio of rents per unit in zone 1 to zone 2 is 1.65 in the data, with a somewhat higher
value of 1.82 obtained by the model.
    The proximity to jobs and amenities is the reason why the model generates higher
demand for Manhattan housing. Because of the highly inelastic housing supply in Man-
hattan, this translates into higher house prices and higher rents.
    The model also comes close to matching the metro-wide price/rent ratio level of 17.79
(row 11). A simple user cost model would imply a steady state 4-year price-rent ratio
of (1 − Q × (1 − δ − τ P ))−1 . Plugging in for Q and the zone-specific property tax and
depreciation parameters, the user cost formula generates price-rent ratios of 20.8 for zone
1 and 16.2 for zone 2. The price-rent ratios in the model are well approximated by the
user cost formula. In the data, the price-rent ratio in Manhattan is 29.3, or 1.89 times the
15.5 value in zone 2. In the model that ratio is 1.29. In other words, the property tax and
depreciation wedges generate too little spatial variation in price-to-rent ratios. Several
factors outside of the model would help bridge the gap. First, houses in Manhattan may
be less risky than in zone 2 which would increase the price-rent ratio wedge. 31 Second,
  29 Zillow excludes non-arms’ length transactions and rent-controlled rentals. To aggregate across the 24
counties in zone 2, we calculate the median price as the weighted average of the median prices in each
county, where the weights are the shares of housing units. Similarly, for the median rent of zone 2, we
average median rents of the 24 counties using housing unit shares as weights. Zillow uses a machine-
learning algorithm that ensures that the ZHVI and ZRI pertain to the same, typical, constant-quality unit,
in a particular geography.
  30 To ensure consistency with the empirical procedure, we calculate the median house size in each zone

including both owner- and renter-occupied units (but excluding RC units) in the model. Call these hˉ ` . We
form the median price per unit as the product of the market price times the typical unit size P` hˉ ` . The
market rent is R` hˉ ` . The price-rent ratio is simply P` hˉ ` /R` hˉ ` = P` /R` . To form metro-wide averages, we
use the number housing units in each zone as weights, just like in the data.
  31 The model has no aggregate risk and risk aversion is only 5. To generate meaningful variation in hous-




                                                        32
owner-occupied housing in Manhattan may be of higher quality than in zone 2. The lower
depreciation rate in zone 1 than in zone 2 may not fully capture such quality differences.
Third, price-inelastic out-of-town investors may well be pushing up relative prices since
they are disproportionately active in Manhattan (Favilukis and Van Nieuwerburgh, 2018).
Fourth, the higher price of a Manhattan apartment may partly stem from its value as a
shared/part-time rental via platforms such as AirBnB.


4.3    Housing Affordability
Price-Income and Rent-Income             Row 12 of Table 2 reports the ratio of the median value
of owner-occupied housing to average earnings in each zone. Average earnings are pre-
tax and refer to all working-age residents in a zone, both owners and renters. The median
home price to the average income is an often-used metric of housing affordability. In the
NY metro data, the median owner-occupied house costs 3.99 times average income. Price-
income is 6.7 in Manhattan compared to 3.6 outside Manhattan, a ratio of 1.87. The model
generates a price-income ratio of 4.08 for the MSA, very close to the data. It generates a
ratio across zones of 1.38. While generating a substantial spatial wedge in this housing
affordability metric, the model’s understatement is a direct consequence of not generating
enough spatial variation in median house values, as noted above.
    Row 13 reports average rent paid by market renters divided by average income of
all residents in a zone; 23% in the data. This moment was the target for the housing
preference parameter αh . To get at the household-level rent burden, we compute two
additional moments reported in rows 14-15 of Table 2. We use PUMS-level data from the
American Community Survey for this analysis. The first statistic computes household-
level rent to income ratio for renters with positive income, caps the ratios at 101%, and
takes the average across households. For this calculation, income is earnings for working-
age households and social security income for retirees. The observed average share of
income spent on rent by renters is is 42.1% in the metro area; 35.4% in Manhattan and
43.5% in zone 2. The model generates an average rent-income ratio for renters of 29.1%,
higher than the city-wide average among all residents of 23%, but lower than in the data. 32
The second statistic computes the fraction of renters with positive income whose rent is
over 30% of income. These households are known as rent-burdened. In the data, 53.9%
ing risk premia would require, for example, changes in mortgage lending standards as in Favilukis et al.
(2017). If homeowners in Manhattan are exposed less to changes in mortgage lending standards, housing
in Manhattan would carry a lower risk premium. This would increase the price-rent ratio in Manhattan,
and increase the wedge with the price-rent ratio in zone 2.
  32 Within the class of homothetic preferences over housing and non-housing consumption it is difficult to

generate large deviations in the housing expenditure ratio without preference heterogeneity in αh .


                                                    33
of households are rent-burdened; 44.1% in Manhattan and 55.9% in zone 2. The fraction
of rent burdened households is 48.7% in the model, only slightly lower than in the data.
Like in the data, there are fewer rent-burdened households in zone 1 than in zone 2.
Taken together, the model generates a large “housing affordability crisis,” with nearly
half of renters spending more than 30% of their income on rent.


Affordable Housing           By virtue of the calibration, the model generates the right share of
RC households in the population in each zone (row 16 of Table 2). Furthermore, the in-
come qualification threshold κ2 was chosen to match the observed position of RC tenants
in the overall income distribution of the metro area. This ensures that the model generates
the right amount of misallocation of RC in terms of income.
    In Figure 4 we study the allocation of RC further and zoom in on the age dimension.
It plots the fraction of households that are in RC for the bottom 25%, middle 50% and
top 25% of the income distribution against age. Fractions are plotted for the model (left
panel) and for data (right panel, from the New York City Housing and Vacancy Survey).
In the model, some younger households in the middle of the income distribution (condi-
tional on age) obtain RC, and even 3% of top-income young households are in RC. Their
(endogenous) incomes are low enough to qualify. At later ages, those middle- and high-
income households find staying in RC housing increasingly unattractive as they would
like to consume more housing. This is not possible because of the constraint on RC hous-
ing size. Also middle- and high-income who were not yet in RC housing no longer satisfy
the income requirement as their labor productivity grows with age. They would have to
reduce labor supply too much to qualify, which is too costly. The share of RC that goes to
the bottom-25% of the income and wealth distribution rises. Still, because of persistence
in the RC system, a large fraction of middle-income households remains in the system for
a very long time. In sum, the RC system generates a lot of misallocation.
    Relative to the data, the model implies that the fraction of RC households decreases
with age while it rises in the data. The elderly in RC in the data may still be the first
generation of occupants and not yet reflect the steady state of the RC system, while the
model describes the steady state.33 Overall, the model captures much of the misallocation
engendered by the RC system.
  33 RC regulations in New York have been weakened several times since 1993, resulting in a gradual loss
of affordable housing units. Usually, incumbents are grand-fathered in and allowed to remain in place.
The RC stock in the model is calibrated to the 2015 level. This naturally leads to more older households in
RC. Also, the data may feature even stronger persistence in RC duration for incumbents than in the model,
where RC tenants have a 25% chance of having to re-apply each 4-year period. Finally, retirees may prefer
to age in place due to social ties (Cocco and Lopes, 2017) even if it is not in their best financial interest, a
channel absent in our model.


                                                      34
    Affordable housing acts as an insurance device in our incomplete markets model. We
calculate the probability of getting a RC unit in the current period for a household that
was not in a RC unit in the previous period and that suffered a negative productivity
shock from the second to the first or from the third to the second productivity level. This
probability measures access to the insurance that RC provides for middle- and low-income
households who fall on hard times. If it is difficult for a low-income household to get into
the RC system, then the value of that insurance is low. The access to insurance metric
is 6.8% in the metro area. This breaks down into 1.6% for zone 1 and 5.2% for zone 2
RC housing. Including low-income households that already were in RC, the likelihood
of getting RC housing is 14.3%. We also define the stability of the insurance RC offers
as the probability of staying in a RC unit for a household that was in a RC unit in the
previous period and that currently is in the bottom quartile of the income distribution.
This probability is 72.5% in the baseline model. Risk averse households prefer a stable
housing situation, i.e., a low volatility of changes in the marginal utility of housing. In
a complete market, households can perfectly smooth consumption and marginal utility
ratios are constant over time; their volatility is zero. Our benchmark model displays
severe incompleteness with volatilities of 0.45 for both the marginal utility growth of
non-housing consumption and housing consumption. 34

Figure 4: Distribution of RC agents by age and income quartiles. Left panel: model. Right
panel: data, calculated for the five New York City boroughs, from the New York City
Housing and Vacancy Survey.

                                    0.25                                                                         0.25
                                           Mean
                                           Bottom 25% income
                                           Middle 50% income
                                           Top 25% income
                                     0.2                                                                          0.2
                                                                                        Share of RC households
           Share of RC households




                                    0.15                                                                         0.15




                                     0.1                                                                          0.1




                                    0.05                                                                         0.05




                                      0                                                                            0
                                           30   40     50      60   70   80   90                                        30   40   50     60   70   80   90
                                                            Age                                                                        Age




  34 The volatilities of marginal utility growth ignore the risk of being born as a low productivity household.

The housing policies we study below play a role in insuring this risk.



                                                                                   35
5     Affordability Policies
Having developed a quantitatively plausible dynamic stochastic spatial equilibrium model
of the New York housing market, we now turn to policy counterfactuals. We run 12 policy
experiments. Six main ones are discussed in this section; the remaining six are relegated
to Appendix G and summarized at the end of this section. Table 3 summarizes how key
moments of the model change under the six main policy experiments. The first column
reports the benchmark model, while the other columns report the percentage change in
moments relative to the benchmark for each of the policy experiments. Figure 5 plots the
associated welfare changes. Welfare changes are changes in value functions, expressed in
consumption equivalent units; see equation (13). These are steady-state welfare compar-
isons. Appendix I discusses welfare along the transition path. The six policies have in
common that they are all revenue neutral.


5.1   Improving the Targeting of RC
As shown above, RC in the benchmark model suffers from misallocation. The first three
policies we consider aim to improve the allocation of a given amount (square footage) of
affordable housing by better targeting it on the most needy households.


5.1.1 Tightening the Income Qualification Requirement

The first experiment, reported in column 1 of Table 3, lowers the income qualification
threshold. Specifically, we lower κ2 from 40% to 30% of AMI. This policy is strongly ben-
eficial, generating an aggregate welfare gain of 1.17% (row 31). The policy is successful
at allocating affordable housing units to low-income households. There is a 28.97% in-
crease in the fraction of Q1-income households in RC (row 4), which exceeds the overall
increase in the fraction of households in RC of 16.93% (row 3). Because the households in
RC choose smaller apartment units (rows 6 & 7), the RC system can accommodate more
households in the same square feet of affordable housing space.
    The large welfare gain arises because RC becomes a better insurance device. Rows
27-30 of Table 3 provide several metrics that capture insurance provision. Row 27 re-
ports that lowering the income qualification threshold greatly improves access to insur-
ance for lower-income households who have fallen on hard times (54.35%). Row 28 re-
ports that lowering κ2 leaves the stability of insurance nearly unaffected (0.23%) from the
benchmark likelihood of 72.5%. Rows 29 and 30 report the time-series standard deviation
of marginal utility growth of non-housing and housing consumption, averaged across

                                            36
Table 3: Main moments of the model under affordability policies that modify features of
the RC system and the spatial allocation of housing.

                                                              (1)        (2)           (3)       (4)          (5)          (6)
                                                 Benchm.    Low κ2    Re-qualify    Low κ2     RC share    Zoning Z1    Vouchers
                                                                                   +re-qual.
 1     Avg(rent/inc.) among renters, Z1 (%)         28.3      6.89%     11.36%      20.18%        8.75%       0.47%      -1.12%
 2     Avg(rent/inc.) among renters, Z2 (%)         29.2     -1.27%     -1.12%      -3.77%       -0.69%       0.03%       0.00%
 3     Fraction of hhs in RC (%)                    5.98     16.93%     30.98%      45.46%       46.17%       0.93%      -2.08%
 4     Frac. in RC of those in inc. Q1 (%)         14.24     28.97%     70.88%      86.56%       43.32%       0.58%      -2.20%
 5     Frac. rent-burdened (%)                      48.7     -0.62%      0.73%      -5.40%        8.32%      -0.76%      -1.93%
 6     Avg. size of RC unit in Z1 (sqft)            683      -9.31%    -16.66%     -18.87%       -0.29%       0.04%      -0.11%
 7     Avg. size of RC unit in Z2 (sqft)           1173     -21.34%    -37.19%     -54.50%        0.15%       0.76%       0.95%
 8     Avg. size of a Z1 mkt unit (sqft)            999       0.25%      0.13%       0.58%       -1.71%      -0.48%       2.95%
 9     Avg. size of a Z2 mkt unit (sqft)           1521       1.32%      2.38%       3.84%        1.40%       0.40%      -1.37%
 10    Frac. of population living in Z1 (%)         10.5      0.84%      2.25%       2.05%        3.96%       9.28%      -3.22%
 11    Frac. of retirees living in Z1 (%)           21.5     -1.93%     -4.44%      -0.19%       -9.11%      -1.05%       9.92%
 12    Housing stock in Z1                            –      -0.06%      0.13%       0.08%       -0.35%       8.86%      -0.22%
 13    Housing stock in Z2                            –      -0.04%     -0.30%      -0.35%        0.18%      -0.73%      -0.91%
 14    Rent/sqft Z1 ($)                             4.21     -0.07%     -0.16%      -0.28%        1.19%      -0.70%      -0.67%
 15    Rent/sqft Z2 ($)                             1.52     -0.09%     -0.21%      -0.35%        1.40%      -0.86%      -0.71%
 16    Price/sqft Z1 ($)                           1050      -0.07%     -0.17%      -0.29%        1.18%      -0.71%      -0.66%
 17    Price/sqft Z2 ($)                            294      -0.09%     -0.21%      -0.35%        1.40%      -0.86%      -0.71%
 18    Home ownership rate in Z1 (%)                45.1     -0.07%     -1.37%      -0.95%      -10.44%      -2.40%       6.23%
 19    Home ownership rate in Z2 (%)                59.6     -0.34%     -0.77%      -2.33%       -1.72%       0.30%       0.28%
 20    Avg. inc. Z1 among working-age hhs ($)     164422     -1.52%     -3.49%      -3.98%       -4.66%      -3.65%      -2.46%
 21    Avg. inc. Z2 among working-age hhs ($)     100154      0.24%      0.23%       0.52%        0.53%       0.05%      -0.14%
 22    Frac. of top-productivity hhs in Z1 (%)      29.7     -0.24%      0.52%      -0.04%        0.97%      -0.49%      -8.08%
 23    Total hours worked in economy                  –      -0.13%     -0.98%      -0.99%       -0.21%      -0.00%      -1.07%
 24    Total hours worked in efficiency units         –       0.05%     -0.33%      -0.08%       -0.11%      -0.01%      -1.02%
 25    Total output                                   –       0.02%     -0.22%      -0.06%       -0.05%      -0.03%      -0.67%
 26    Total commuting time across all hhs            –      -0.14%     -0.36%      -0.25%       -0.66%      -1.17%       0.57%
 27    Access to RC insurance (%)                    5.6     54.35%    145.90%     185.91%       52.21%      -0.24%      -3.18%
 28    Stability of RC insurance (%)                72.5      0.23%    -78.20%     -31.07%        0.19%      -0.04%       0.20%
 29    Std. MU growth, nondurables                  0.45     -0.14%     -0.91%      -2.28%        0.62%      -0.11%      -1.29%
 30    Std. MU growth, housing                      0.45     -1.03%      0.08%      -5.02%        0.58%       3.04%      -2.50%
 31    Aggregate welfare change (CEV)                 –       1.17%     1.66%       3.59%        0.66%       0.37%       1.04%


Notes: Column “Benchmark” reports values of the moments for the benchmark model. Columns “Low κ2 ” to “Vouchers” report
percentage changes of the moments in the policy experiments relative to the benchmark for the six main policy experiments. Rows 1-9
report housing affordability moments , rows 10-26 aggregate moments across the two zones, rows 27-30 capture insurance provision,
and row 31 is the percentage aggregate welfare change, in CEV units, between the alternative and the benchmark economy. Z1 stands
for zone 1 (Manhattan), Z2 for the rest of the metro area.



households. The policy lowers the volatility of the marginal utility growth of housing (-
1.03%), thereby offering households more housing stability, bringing the economy closer
to complete markets.
      The policy also creates welfare gains from a reduction in commuting time (-0.14%, row
26). Commuting in the model wastes time, which can now be spent on leisure or work,
and money, which can now be spent on consumption. The reduction in commuting re-
flects the larger population share of the city center (0.84%, row 10) due to the larger num-
ber of households living in smaller zone-1 RC units. Many of the new zone-1 households
are of working age (the share of retirees in zone 1 falls; -1.93%, row 11). The improving

                                                               37
spatial allocation of labor can also be seen from the wedge between the change in the
number of hours worked (-0.13%, row 23) and the change in the number of hours worked
in efficiency units (0.05%, row 24). Total output increases modestly (0.02%, row 25) as
does leisure.
   This policy does not affect developer distortions, and has minor implications for the
housing stock, rents, house prices, and home ownership rates in both zones (rows 11-
19). Because there are fewer middle- and high-income households in RC, there are fewer
households who are choosing sub-optimally small apartments. The average size of mar-
ket units (renter- or owner-occupied) increases in both zones (rows 8 and 9). The higher
housing consumption increases utility for these non-RC households.
   Rent-income ratios among renters increase substantially in zone 1 (6.89%, row 1) and
fall in zone 2 (-1.27%, row 2). These changes reflect the new socio-economic make-up of
the two zones. There are more low-income households in zone 1 because of the policy
change, so that the average income of zone 1 changes (-1.52%, row 20). The opposite is
true in zone 2 (0.24%, row 21). This suggests that rent-income ratios, the most common
metric of housing affordability, must be interpreted carefully as they reflect both equi-
librium rents and the income of the people who have sorted into each zone in spatial
equilibrium.


5.1.2 Re-qualifying for RC

A second approach to improve the targeting of RC is to force incumbent households to
re-qualify periodically. In the benchmark model, RC tenants were allowed to stay in RC
for another 4 years with very high probability rather than having to go through the RC
lottery again. As we showed, this induces much persistence in the RC system and results
in some households staying for decades. In the second policy experiment, we force every
household to go through the lottery and re-qualify each period (four years). There are no
more insiders or outsiders, everyone has equal probability of winning the housing lottery.
By removing the preference for insiders, i.e., by setting the parameter p RC,exog = 0, the
endogenously determined probability of winning the RC lottery increases substantially.
   The policy experiment results in a large average welfare gain of 1.66% per New Yorker
(column 2 of Table 3). Like the previous policy, re-qualification improves access to RC in-
surance (145.90%, row 27). In contrast with the previous policy, it dramatically lowers
the stability of this insurance (-78.20%, row 28). Housing consumption become more un-
stable over time (0.08%, row 30). The policy results in more households in RC (30.98%),
choosing smaller units. The fraction of low-income households in RC grows much more


                                            38
(70.88%), showing the improved targeting of the RC system. There is a major reduction
in the misallocation of RC housing. The intuition for this result is as follows. When the
income qualification threshold is fairly tight, as it is in our benchmark model (κ2 = 40%),
there is only modest misallocation in RC housing at the time of first entry. But misallo-
cation grows over time as incomes rise deterministically with age or stochastically due
to positive productivity shocks. Making RC less persistent helps reduce the misalloca-
tion since it replaces high-income insiders with low-income outsiders. In contrast, when
κ2 is higher (e.g., 60% or more), re-qualification is much less effective since undeserving
tenants are often replaced by other undeserving tenants.
   The policy improves the spatial allocation of labor. The overall population of zone 1
grows (2.25%, row 10), the fraction of top-productivity, working-age households who live
in zone 1 grows (0.52%, row 22), and the fraction of retirees falls ( -4.44%, row 11). Labor
supply falls, but much less in efficiency units. Closer inspection reveals that productivity
type-2 households reduce hours the most and this reduction is concentrated in zone 1.
Lower-productivity households have a strong financial incentive to live in zone 1, given
that the fixed cost of commuting represents a large share of their income. If they live
in zone 2, they must work harder to make up for the cost of commuting. If they live
in zone 1, they reduce labor supply. This reduction in labor supply is larger in the re-
qualify experiment than in the benchmark economy because (i) type-2 households now
have a better chance of getting into RC housing in zone 1, (ii) rents are lower even if
they do not get in, and (iii) there are more type-2 households living in zone 1 in the
re-qualify experiment. In sum, the improved insurance value of RC combined with the
spatial reallocation it causes, leads to a reduction in labor supply and output. The income
panel of Figure 5 shows that second-income quartile households gain the most from the
policy change.


5.1.3 Combining the Previous Two Policy Changes

Introducing re-qualification in an economy with tighter income qualification require-
ments such as those in Section 5.1.1 brings large welfare gains. Column 3 of Table 3 shows
the results from combining the reduction in κ2 and the re-qualification experiments. We
find a large welfare gain of 3.59%. The gain is larger than the sum of the welfare gains
from the separate experiments, suggesting amplification effects. Making the RC alloca-
tion fairer by forcing tenants to re-qualify pays large dividends when only the needy
qualify in the first place. This policy produces larger welfare gains than any other policy
we study. Yet, it requires no expansion of the scope of the RC program nor additional


                                            39
taxes.
    Figure 5 shows that households in the bottom quartile of the productivity and income
distribution overwhelmingly gain from the policy while households in the top half lose.
The gains are fairly uniform across age and monotonically declining in wealth.

Figure 5: Welfare effects of affordability policies by age, productivity groups, income
quartiles, and net worth quartiles.
                             Welfare Relative to Benchmark (%)




                                                                                                                      Welfare Relative to Benchmark (%) Welfare Relative to Benchmark (%)
                                                                 8                                                                                                                     10
                                                                                                                                                                                                                   Inc. cutoff
                                                                 6                                                                                                                          8                      Re-qualify
                                                                                                                                                                                                                   Inc. cutoff+re-qual.
                                                                                                                                                                                            6                      RC share
                                                                 4                                                                                                                                                 Zoning Z1
                                                                                                                                                                                                                   Vouchers
                                                                                                                                                                                            4
                                                                 2
                                                                                                                                                                                            2
                                                                 0
                                                                                                                                                                                            0
                                                                 -2
                                                                      30   40     50     60       70   80   90                                                                                   1      2          3             4
                                                                                       Age                                                                                                           Productivity Level
           Welfare Relative to Benchmark (%)




                                                             20                                                                                                                             6


                                                                                                                                                                                            4
                                                             10

                                                                                                                                                                                            2
                                                                 0
                                                                                                                                                                                            0

                                                -10                                                                                                                                         -2
                                                                       1         2            3         4                                                                                        1      2          3             4
                                                                                Income Quartile                                                                                                      Net Worth Quartile

Notes: The baseline model has the following parameters: η 1 = 24.46, η 2 = 15.97, κ1 = 50%, κ2 = 0.40, κ3 = 0.35. Policy experiments,
each panel: decrease the RC income cutoff by 50%, enforce re-qualification for RC every period, both, increase share of RC sqft by
50%, increase available Z1 sqft by 10%, housing vouchers. Top left panel: by age. Top right panel: by productivity level. Bottom left
panel: by income quartile. Bottom right panel: by net worth quartile. The welfare changes are measured as consumption equivalent
variations for an average household in each group.




5.2      Expanding the Affordable Housing Mandate
The second policy instrument we study is the scope of the affordable housing mandate.
We symmetrically change η ` in each zone, the fraction of rental square footage that must
be set aside for affordable units. Column 4 of Table 3 increase η ` by 50%. The fraction of
households in RC increases by 46.17%. The fraction of households from the bottom 25% of
the income distribution that obtains RC grows by less (43.32%), implying a slight rise in
the misallocation of RC housing.
    The average effect of increasing the size of the RC program is a welfare gain of 0.66%
in CEV units. This modest welfare gain is the net effect of the increased insurance benefits

                                                                                                                 40
afforded by the expansion of the RC program and the increased costs of the housing and
labor market distortions. Access to RC insurance increases substantially (52.21%), while
the stability of the insurance is unaffected (0.19%). The increase in RC weakens develop-
ers’ incentives to build since it lowers the average sale price they earn. Housing supply in
zone 1 decreases (-0.35%). This is consistent with the empirical literature, which finds that
increased incentives of landlords to renovate their properties and of developers to invest
in new construction generate a modest housing boom in decontrolled areas (Autor et al.,
2014; Diamond et al., 2019). Rents increase by 1.19% in zone 1 reflecting the increased
housing scarcity. The population in zone 1 increases (3.96%) because zone 1 residents
choose smaller housing units both in the market and RC rental segments.
   Developer incentives are also blunted in zone 2. Nevertheless, the equilibrium hous-
ing stock in zone 2 increases by 0.18%. The reason is the increased demand for housing in
zone 2. The larger housing units offset the decreased population share of zone 2. Rents in-
crease by 1.40% in zone 2. Developers “pass through” the increased housing affordability
targets into the market rent.
   Increasing the affordable housing mandate city-wide triggers an increase in the city-
wide housing stock because the increase in the housing stock in zone 2 exceeds the decline
in zone 1. This surprising results arises from optimal relocation choices in response to the
policy in spatial equilibrium.
   Standard housing affordability metrics deteriorate, even though many more house-
holds are helped by cheap RC housing. Average rents increase in both zones. The rent-
income ratio increases in zone 1 (8.75%). The fraction of rent-burdened renters increases
by 8.32% metro-wide. These increases reflect that low- and middle-income households
who do not win the RC lottery face higher rents. House prices also rise in both zones.
   The policy results not only in a smaller but also in a different population in Manhat-
tan. With the 46.17% growth in RC households, Manhattan becomes a more “mixed”
neighborhood with lower average income (-4.66%). The reallocation of the housing stock
towards affordable housing units pushes some middle- and upper-middle-income house-
holds out of the urban core. This pattern is consistent with the empirical evidence in Au-
tor et al. (2014), who show that richer households moved into units previously occupied
by poorer RC tenants after a reduction in control in Cambridge, MA.
   Increasing the size of the RC program also distorts labor supply. Time spent working
(-0.21%) and total efficiency units of labor (-0.11%) fall despite the reduction in time spent
commuting. Expanding RC generates a drop in output (-0.05%). These are the distortions
from RC emphasized by economists; we find that they are quantitatively modest, even
though RC is highly persistent.

                                             41
     How does welfare change with the scope of RC? Figure 6 presents a sequence of exper-
iments that vary η ` . The blue line shows that aggregate welfare, expressed as a percent-
age change relative to the benchmark, increases with the scope of the affordable housing
mandate. The insurance benefits from expanding the RC system continue to outweigh the
costs until all households that want RC obtain such a unit. 35 It is worth pointing out that
the experiment with a 50% increase in the amount of sqft in RC (the first point on the blue
line to the right of the benchmark) already constitutes a large expansion. It implies that
landlords lose $7.3 billion in forgone rent because of the RC rent discount. The voucher
experiment below generates a larger welfare benefit but only costs $730 million.
     Figure 6 also plots the result of the same changes in the RC system in a (recalibrated)
economy featuring a lower value for risk aversion, γ = 2. The case for increasing the
affordable housing mandate is qualitatively unaffected, but the welfare gains are less
steeply increasing since the benefit of RC insurance is lower when risk aversion is lower.
Appendix H.1 discusses the model with lower risk aversion in detail.

      Figure 6: Welfare effects of varying the scope of the affordable housing mandate.

                                                                          2.5
                        Aggregate Welfare Relative to Benchmark (CEV,%)




                                                                            2



                                                                          1.5



                                                                            1



                                                                          0.5



                                                                            0



                                                                          -0.5
                                                                                                                                                Risk aversion=5
                                                                                                                                                Risk aversion=2
                                                                                                                                                Benchmark
                                                                           -1
                                                                            0.1   0.15   0.2   0.25         0.3       0.35         0.4   0.45    0.5          0.55
                                                                                                      RC as share of Rented Sqft

Notes: The baseline model has the following parameters: η 1 = 24.46, η 2 = 15.97, κ1 = 50%, κ2 = 0.40, κ3 = 0.35. The share of RC
rented sqft is calculated as a (total sqft-)weighted average of η 1 , η 2 . The larger dots on the right-hand side of the graph represent the
maximum RC share above which markets do not clear. The welfare changes are measured as consumption equivalent variations for
an average household.



  35 Consistent with the result that increasing η ` increases welfare, we find that an alternative calibration
that includes rent-stabilized apartments in the RC sector and excludes them from the market rental sector
(the opposite assumption as in the benchmark), and correspondingly adjusts the rental discount to 30%
(from 50% in the benchmark) results in a 0.23% higher CEV welfare level than the benchmark model. In
other words, this modeling choice makes little quantitative difference.




                                                                                                              42
5.3    Relaxing Zoning Rules in the Urban Core
The fifth experiment studies a favorite policy among economists: allowing for more hous-
ing in the city center. We think of this policy as relaxing height or other land use restric-
tions (increasing allowable floor-area ratios), often referred to as upzoning. In the model,
                                                                            1
more construction is permitted in zone 1 when we increase H . As in the benchmark
model, for every square foot of rental housing built in zone 1, a fraction η 1 must be af-
fordable. This policy is akin to NYC’s policy of awarding developers zoning variances
in exchange for affordable units. This policy has no direct fiscal outlay. 36 However, its
affects all equilibrium prices and quantities indirectly.
                     1
   We increase H by 10%. The equilibrium housing stock in Manhattan increases by
8.86%, as shown in the column 5 of Table 3. Rents and prices in zone 1 fall (-0.70% for
rents). The average unit size changes by -0.40% so that the population share of Manhattan
rises by 9.28%. Because of the population reallocation, average income in Manhattan
decreases (-3.65%). More middle-income households can now afford Manhattan and the
additional affordable housing that is associated with the new construction also brings
in lower-income households. With more working-age households in zone 1, aggregate
commuting time falls substantially (-1.17%). In equilibrium, most of the aggregate time
saved commuting goes towards leisure. The increase in leisure boosts utility.
   The housing stock in zone 2 falls (-0.73%) as developers shift their resources towards
zone 1 where the population has swelled. Rents in zone 2 also fall (-0.86%) because of the
weaker demand for housing in zone 2 due to the population pivot to Manhattan.
   Housing affordability metrics deteriorate slightly. Average rent-to-income among renters
increases by 0.47% in zone 1 and by 0.03% in zone 2. These metrics fail to capture that
more households can now afford to live close to work. They mostly reflect compositional
changes in the income profile of each neighborhood.
   The zoning experiment leads to a small decrease in output (-0.03%). Output in the
Manhattan construction sector increases substantially (8.88%), but is offset by an output
loss in the much larger construction sector of zone 2 (-0.76%).
   Relaxing zoning rules in zone 1 generates a modest aggregate welfare gain of 0.37%.
This aggregate gain is smaller than in the previous experiments. In contrast to the pre-
ceding policies, upzoning is much less redistributive in nature. As can be seen in Fig-
  36 The model ignores additional costs or benefits from increased density in the city center. There could
be additional utility gains from having more households live in the city center (productivity gains from
agglomeration are already maximal given that everyone works in the city center), or additional utility
losses from congestion. The model can be extended to incorporate such considerations. Specifically, the
parameter χ1 could be allowed to depend on the endogenous density of zone 1.



                                                   43
ure 5, the upzoning policy brings uniform benefits to all age, productivity, income, and
wealth groups. The steady state comparison suggests a Pareto improvement. Along the
transition path, some home owners are hurt by the house price declines that accompany
upzoning. However, Appendix I shows that the average home owner still benefits from
the policy change even along the transition path.


5.4       Vouchers
One important pillar of U.S. housing policy is the Section 8 voucher program, housing
assistance provided by the federal government to low-income households. Since this
policy is part of the tax and transfer system, it is already captured by the function T (∙).
We now study the effects of increasing the size of the voucher program. 37 We engineer
the increase by increasing the tax progressivity parameter τ from 0.1700 to 0.1783 while
changing the overall size of the tax and transfer system from λ of 0.7500 to 0.7440. Be-
cause of the increased progressivity, the experiment generates both higher tax revenues
and higher transfers. The policy translates into a $738 million increase in spending on
vouchers in the New York metropolitan area. 38 As in the previous experiments, there is no
direct fiscal outlay associated with the voucher expansion. We impose that all households
who receive an additional transfer spend at least the amount of the additional transfer on
housing. This captures the institutional reality that vouchers must be used for housing
expenses. The RC system remains in place with the benchmark parameter values.
    The last column of Table 3 shows that aggregate welfare increases substantially when
the housing voucher program is expanded (1.04%). Figure 5 shows that young, low-
productivity, low-income, and low-wealth households gain substantially from the pol-
icy. The substantial reduction in the volatility of marginal utility growth (-1.29% for non-
housing and -2.50% for housing) is consistent with the improved provision of insurance
in society. These results are directionally consistent with the RC expansion experiments
  37 We  increase the value of housing vouchers by an amount equal to the value of Low Income Housing
Tax Credit (LIHTC) subsidies, to make the two experiments comparable quantitatively. LIHTC subsidies are
designed to cover approximately 30% of developers’ construction costs associated with affordable housing
(see appendix G.6).
   38 Data compiled from the Housing and Urban Development department show that the housing authori-

ties responsible for the 25 counties in the New York MSA disbursed $2.06 billion in 246,000 Section 8 vouch-
ers in the year 2013 (latest available). This amounts to an average of $8,300 per year per voucher. The policy
exercise we consider raises tax revenues from $5.434 billion to $6.215 billion, an increase of $738 million. At
the cost of $8,300 per voucher, this translates into 94,100 additional vouchers. The experiment increases the
size of the transfer of those who already received transfers before. The transfer increase is higher the lower
is household income. It also creates new beneficiaries who now receive a transfer while they were paying
a tax in the benchmark. Thus, the policy both increases the amount of the existing vouchers and disburses
additional smaller vouchers.


                                                      44
in Section 5.2, but the redistribution in the voucher experiment is starker. This is because
the vouchers are better targeted to the poor. Because RC is not as well targeted in the
baseline model as it could be (as shown in Section 5.1), the RC expansion generates much
smaller welfare increases dollar-for-dollar.
   The large welfare gain in the voucher experiment occurs despite severe distortions.
Chief among them is tax-induced labor supply distortions. In the model, as in the real
world, vouchers must be paid for with distortionary labor income taxes. Because of tax
progressivity, high-productivity households are disproportionately affected. Total hours
worked fall sharply (-1.07% and -1.02% in efficiency units) and total output falls by a
sizeable -0.67%.
   The voucher expansion, which is location-neutral in its design, has interesting spatial
equilibrium effects. The policy leads to a reduction in the population share of zone 1 (-
3.22%) and an increase in commuting (0.57%). It also reduces the average income of zone
1 (-2.46%) and the fraction of top-productivity households who live there (-8.08%). In
sum, the voucher expansion has unintended consequences for the efficiency of the labor
allocation because of how it is financed. In addition, low income households who receive
a larger housing voucher are not more likely to live in zone 1, close to “opportunity,”
in spatial equilibrium. This is consistent with the empirical evidence in Collinson and
Ganong (2018) that vouchers not “move” lower-income households “to opportunity.” But,
surprisingly, they even crowd out higher productivity households from the city center,
“removing” them “from opportunity.”
   Finally, a change to one housing affordability program may affect the benefits from
other programs. Increasing vouchers reduces the number of households benefitting from
RC because RC tenants choose larger RC units on average (across zones 1 and 2).


5.5   Other Affordable Housing Policies
Appendix G discusses six more policies that change the various policy levers of the RC
system. We start with the opposite policy of that in section 5.2: a reduction in the size of
the RC system by half. We find a welfare loss (-0.62%), similar to the welfare gain from
expanding the RC system by the same percentage.
   Second, we lower the rent subsidy, governed by κ1 . The policy reduces welfare by a
similar amount (-0.49%). It results in more households gaining access to RC but the value
of the insurance provided by the RC system falls because the rent discount is smaller and
RC households live in much smaller RC units.
   Third, reducing the size limit on RC units, governed by κ3 , increases welfare modestly


                                               45
(0.23%). The policy improves the targeting of RC housing towards the neediest house-
holds, but is not as effective as tightening the income requirement or re-qualification,
discussed in Section 5.1.
     Fourth, we explore the spatial dimension of the affordable housing system and con-
duct a policy experiment that shifts all RC households from zone 1 to zone 2. The urban
core gentrifies with more high-income and top-productivity households, fewer retirees,
and a higher home ownership rate. Despite the improvements in the spatial allocation of
labor, aggregate welfare does not increase (-0.03%). Relocation of RC housing to zone 2 is
welfare increasing once accompanied by free transportation. The aggregate welfare gain
of this fifth experiment is 0.37%, a substantial increase from the -0.03% aggregate wel-
fare without free transit. The reason is that financial transportation costs are important
for low-income households and were the source of the welfare loss in the fourth experi-
ment39 .
     Finally, appendix G.6 studies a policy that subsidizes construction costs associated
with affordable housing development. This tax credit policy, modeled after the federal
                                                                                               `
Low Income Housing Tax Credit (LIHTC) program, increases the average price P devel-
opers earn, thereby stimulating new construction. The policy is sized to to have the same
cost of the voucher expansion experiment. It generates a small welfare gain of 0.02%. The
envisioned increase in the housing stock materializes in equilibrium, but is blunted by a
reduction in housing demand. The latter arises from the distortionary taxation imposed
to pay for the tax credits. Tax credits in difficult to develop areas, like New York City,
create too few additional affordable housing units to make a meaningful dent in the wel-
fare of low-income households. This experiment underscores the importance of general
equilibrium effect, of targeted policies, and of how affordability programs are financed.


6      Conclusion
In a world with rising urbanization rates, the high cost of housing has surfaced as a daunt-
ing challenge. Existing affordable housing policy tools affect the supply of housing, how
the housing stock is used (owned, rented, affordable), and how it is distributed in space.
Households of different tenure status, age, income, and wealth are differentially affected
by changes in policy. This paper develops a novel dynamic stochastic spatial equilibrium
model with wealth effects and rich household heterogeneity that allows us to quantify
the welfare implications of the main housing affordability policy tools.
    39 The
         0.37% welfare gain takes into account the distortions caused by the extra tax revenue needed to
pay for the free transit for RC households.

                                                  46
   The model is calibrated to the New York metropolitan area. It matches patterns of
average earnings, wealth accumulation, and home ownership over the life-cycle, delivers
realistic house prices, rents, and wages, as well as large spatial differences in income and
rents between the urban core and the periphery. The calibration captures the key features
of New York’s affordable housing system as well as restrictions on residential land use.
   We use the model to evaluate changes to the affordable housing system, zoning policy,
an expansion of the housing voucher system, and tax credits for the development of af-
fordable housing. These policies have quantitatively important aggregate, distributional,
and spatial implications. General equilibrium effects are sometimes at odds with partial
equilibrium logic.
   Consistent with conventional wisdom, increasing the housing stock in the urban core
by relaxing zoning regulations is welfare improving. Contrary to conventional wisdom,
increasing the generosity of the affordable housing or housing voucher systems is also
welfare improving. The main reason is that housing affordability policies generate im-
portant insurance benefits which trade off against the larger housing and labor market
distortions. Increasing the housing safety net for the poorest households creates welfare
gains for society. How the affordability policies are financed has first-order effects on wel-
fare gains. Finally, the insurance view of affordability points towards large advantages
from better targeting of RC housing towards the neediest households.
   These results underscore the need for rich models of household heterogeneity to un-
derstand both the aggregate and the distributional implications of place-based policies.
In future work, we plan to use this framework to analyze investment in transportation
infrastructure which lowers the time and/or financial cost of commuting. Applying this
framework to study other cities with different institutional features is another useful di-
rection. Finally, embedding the model in a multi-city framework is a challenging but
fruitful extension for future work.




                                             47
References
A UTOR , D. H., C. J. PALMER , AND P. A. PATHAK (2014): “Housing Market Spillovers:
  Evidence from the End of Rent Control in Cambridge, Massachusetts,” Journal of Politi-
  cal Economy, 122, 661–717.
——— (2017): “Gentrification and the Amioneity Value of Crime Reductions: Evidence
 from Rent Deregulation,” .
B AUM -S NOW, N. AND J. M ARION (2009): “The Effects of Low Income Housing Tax Credit
  Developments on Neighborhoods,” Journal of Public Economics, 93, 654–666.
B EHRENS , K., G. D URANTON , AND F. R OBERT-N ICOUD (2014): “Productive Cities: Sort-
   ing, Selection, and Agglomeration,” Journal of Political Economy, 122, 507–553.
B ERGER , D., V. G UERRIERI , G. L ORENZONI , AND J. VAVRA (2017): “House prices and
   consumer spending,” Review of Economic Studies, 85, 1502–1542.
B RUECKNER , J. (1987): Handbook of Regional and Urban Economics, Amsterdam: North-
   Holland, chap. The Structure of Urban Equilibria: A Unified Treatment of the Muth-
   Mills Model.
C AMPBELL , J. Y. AND J. C OCCO (2003): “Household Risk Management and Optimal
  Mortgage Choice,” Quarterly Journal of Economics, 118, 1449–1494.
C OCCO , J. AND P. L OPES (2017): “Reverse Mortgage Design,” Working Paper London Busi-
  ness School and London School of Economics.
C OCCO , J. F. (2005): “Portfolio Choice in the Presence of Housing,” Review of Financial
  Studies, 18, 535–567.
C OLLINSON , R. AND P. G ANONG (2018): “How Do Changes in Housing Voucher Design
  Affect Rent and Neighborhood Quality?” American Economic Journal: Economic Policy,
  10, 62–89.
C OUTURE , V., C. G AUBERT, J. H ANDBURY, AND E. H URST (2018): “Income Growth
  and the Distributional Effects of Urban Spatial Sorting,” Working Paper University of
  Chicago Booth.
D AVIS , M. A., J. G REGORY, AND D. A. H ARTLEY (2018): “The Long Run Effects of Low
  Income Housing on Neighborhood Composition,” .
D AVIS , M. A., J. G REGORY, D. A. H ARTLEY, AND K. T. K. TAN (2017): “Neighborhood
  Choices, Neighborhood Effects and Housing Vouchers,” .
D AVIS , M. A. AND S. VAN N IEUWERBURGH (2015): Handbook of Regional and Urban Eco-
  nomics, North Holland, chap. Housing, Finance, and the Macroeconomy, Chapter 12.
D IAMOND , P. AND E. S AEZ (2011): “The Case for a Progressive Tax: From Basic Research
  to Policy Recommendations,” Journal of Economic Perspectives, 25, 165–190.

                                           48
D IAMOND , R. AND T. M C Q UADE (2019): “Who Wants Afordable Housing in their Back-
  yard? An Equilibrium Analysis of Low Income Property Development,” Journal of Po-
  litical Economy.

D IAMOND , R., T. M C Q UADE , AND F. Q IAN (2019): “The Effects of Rent Control Expan-
  sion on Tenants, Landlords, and Inequality: Evidence from San Francisco,” .

E ECKHOUT, J., R. P INHEIRO , AND K. S CHMIDHEINY (2014): “Spatial Sorting,” Journal of
   Political Economy, 122, 554–620.

FAVILUKIS , J., S. C. L UDVIGSON , AND S. VAN N IEUWERBURGH (2017): “The Macroeco-
  nomic Effects of Housing Wealth, Housing Finance and Limited Risk Sharing in Gen-
  eral Equilibrium,” Journal of Political Economy, 125, 140–222.

FAVILUKIS , J. AND S. VAN N IEUWERBURGH (2018): “Out-of-town Investors and City Wel-
  fare,” Working Paper Columbia GSB and UBC Sauder.

F REEDMAN , M. AND E. O WENS (2011): “Low-income Housing Development and
   Crime,” Journal of Urban Economics, 70, 115–131.

G OMES , F. AND A. M ICHAELIDES (2008): “Asset Pricing with Limited Risk Sharing and
  Heterogenous Agents,” Review of Financial Studies, 21 (1), 415–449.

G UERRIERI , V., D. H ARTLEY, AND E. H URST (2013): “Endogenous gentrification and
  housing price dynamics,” Journal of Public Economics, 100, 45–60.

G UREN , A. AND T. M C Q UADE (2019): “How Do Foreclosures Exacerbate Housing Down-
  turns?” Review of Economic Studies.

H EATHCOTE , J., K. S TORESLETTEN , AND G. L. V IOLANTE (2017): “Optimal Tax Progres-
  sivity: An Analytical Framework,” Quarterly Journal of Economics, 132, 1693–1754.

H IZMO , A. (2015): “Risk in Housing Markets: An Equilibrium Approach,” Working Pa-
  per New York University.

H SIEH , C.-T. AND E. M ORETTI (2019): “Housing Constraints and Spatial Misallocation,”
  American Economic Journal: Macroeconomics, 11.

I MROHOROGLU , A., K. M ATOBA , AND S. T UZEL (2016): “Proposition 13: An Equilibrium
   Analysis,” Working Paper University of Southern California.

J OINT C ENTER FOR H OUSING S TUDIES   OF   H ARVARD U NIVERSITY (2018): “The State of
   the Nation’s Housing 2018,” .

K APLAN , G., K. M ITMAN , AND G. V IOLANTE (2019): “Consumption and House Prices
  in the Great Recession: Model meets Evidence,” Working Paper New York University.

K RUSELL , P. AND A. A. S MITH (1998): “Income and Wealth Heterogeneity in the Macroe-
  conomy,” Journal of Political Economy, 106, 867–896.


                                            49
L ANDVOIGT, T., M. P IAZZESI , AND M. S CHNEIDER (2015): “The Housing Market(s) of
  San Diego,” American Economic Review, 105, 1371–1407.

L UQUE , J., N. I KROMOV, AND W. N OSEWORTHY (2019): Affordable Housing Development:
  Financial Feasibility, Tax Increment Financing, and Tax Credits, Springer.

O RTALO -M AGN É , F.   AND   A. P RAT (2016): “Spatial Asset Pricing: A First Step,” Econom-
  ica, 83, 130–171.

R APPAPORT, J. (2014): “Monocentric City Redux,” Working Paper Federal reserve Bank
  of Kansas City.

R OBACK , J. (1982): “Wages, rents, and the quality of life,” The Journal of Political Economy,
  90, 1257.

R OSEN , S. (1979): “Wage-based indexes of urban quality of life,” Current issues in urban
  economics, 3.

R OSSI -H ANSBERG , E., P. D. S ARTE , AND R. O WENS (2010): “Housing Externalities,” Jour-
  nal of Political Economy, 118, 485–535.

S AIZ , A. (2010): “The Geographic Determinants of Housing Supply,” Quarterly Journal of
   Economics, 1253–1296.

S TORESLETTEN , K., C. T ELMER , AND A. YARON (2006): “Asset Pricing with Idiosyn-
   cratic Risk and Overlapping Generations,” Review of Economic Dynamics, Forthcoming,
   working Paper, University of Oslo.

VAN N IEUWERBURGH , S. AND P.-O. W EILL (2010): “Why Has House Price Dispersion
 Gone Up?” Review of Economic Studies, 77, 1567–1606.

YAO , R. AND H. H. Z HANG (2004): “Optimal Consumption and Portfolio Choices with
 Risky Housing and Borrowing Constraint,” Review of Financial Studies.




                                               50
A       Model Appendix
A.1       Analytical solution for housing and labor supply choices
Preferences over non-durables, housing, and leisure are represented by a CES aggregator of non-
durable consumption and housing services, nested within a CES aggregator of consumption and
leisure. Those are embedded within a CRRA utility function, which represents preferences over
different consumption profiles over time and across states of the world. We only solve the worker’s
problem here. A retiree’s problem is analogous, but simpler because nt = 0.
                                                      C(c,h,n)1−γ
      The utility function is U (c, h, n) =              1− γ     ,   where

                                 h                                    η                         i η1
                     C(c, h, n) = (1 − α N ) [(1 − α H )ce + α H he ] e + α N [1 − Φ T − n]χ0 η

when |η |, |e| > 0 (case (i)). χ0 makes leisure nonlinear in hours (we set it to 1), and we impose a
lower bound on hours, n ≥ nmin .
                                    h                     η                      i η1
When |η | > 0, |e| = 0, u(c, h, n) = (1 − α N ) c1−α H hα H + α N [1 − Φ T − n]χ0 η (case (ii)).
                                                                              (1− α N )
When |η | = 0, |e| > 0, u(c, h, n) = [(1 − α H )ce + α H he ] e [1 − Φ T − n]χ0 α N (case (iii)).
                                              1− α N
When |η | = |e| = 0, u(c, h, n) = c1−α H hα H          [1 − Φ T − n]χ0 α N (case (iv)).


Renter First, consider the renter’s problem and let λt be the Lagrange multiplier on the budget
constraint, νt be the Lagrange multiplier on the borrowing constraint, and ξ t be the Lagrange
multiplier on the non-negativity labor constraint. The numerical strategy is to choose ct in order
to maximize the household’s utility, and lt to solve the non-linear equation for labor supply. Here
we will show that the other choices (ht and bt+1 ) can be written as analytic functions of ct and nt .
Denote Ct = C (ct , ht ). We ignore the taste shifter (which is multiplicative and raised to the power
1 − γ in the equations involving Ct ), and assume b   bt+1 = 0. The budget constraint simplifies to:
                                                                                                         1− τ
                                        z    1                                      a                 1
ct + R`t ht + Qt bt+1 + φF,t
                         `
                                = Ψt ψ + 2 −                    xt + λ Wt G zt nt +                      − 1 xt     − τ SS Wt G a zt nt
                                             Qt                                                       Qt
                                                                                                                                 (14)
The first order conditions for ct , lt , ht , bt+1 are respectively:
  1− γ − η                                                   η −e
 Ct          (1 − αn )(1 − αh )((1 − αh )ce + αhhe )         c e −1 = λ t
                                                               e
                                                                                                             
                                                                                        1      −τ
  1− γ − η
 Ct          αn (1 − φT − nt )η −1 = λt Wt G a zt                          a
                                                         λ(1 − τ ) Wt G zt 1 − φT,t − lt + Qt − 1 xt
                                                                                `                      −τ SS   + ξt
  1− γ − η                                        η −e
 Ct     (1 − αn )αh ((1h− αh )ce + αh he ) e he−1 = λt Ri`t
 λt Qt = (1 − p a ) βE t ∂x∂t+1 V ( xt+1 , zt+1 , a + 1, St+1 ) + νt
                                                                                                                                                (15)
                                                                                                                                 −τ 
                                                 1                           1                                          1
where     ∂xt V
           ∂
                  ( xt , zt , a, St ) = λt 2 −   Qt    + λ (1 − τ )          Qt   −1         Wt   Ga z   t nt   +       Qt   − 1 xt           , since
the marginal value of net worth is the same in the problem of renters, RC renters and owners,
and the probabilities to receive RC sum to 1.
    Case 1: νt = 0 and ξ t = 0. In this case the household is unconstrained. Residential housing is


                                                                    51
                                                                                                             1−1 e
obtained by combining the conditions for ct and ht : ht =                                         αh
                                                                                               (1−αh ) Rt`
                                                                                                                       ct .
Case (i) The nonlinear equation for hours nt is obtained by combining the first order conditions for
ct and nt , and substituting for ht as a function of ct in the CES aggregator:
                                                                                                          h                  i 1−e e  η −e e
     χ0 α N (1 − Φ T −    n ) χ0 η −1
                              − (1 − α N )(1 − α H ) (1 − α H ) + α H                                             αH
                                                                                                               (1− α H ) R
                                                                                                                                                  WGa z
     n                                  o                                                                                                                             (16)
       λ(1 − τ ) (WGa zn + rx )−τ − τ SS cη −1 = 0

   The Jacobian is:
                                                                                                                        h                  i 1−e e  η −e e
 −α N χ0 (χ0 η − 1)(1 − ΦT −        n ) χ0 η −2     + (1 − α N )(1 − α H ) (1 − α H ) + α H                                      αH
                                                                                                                              (1− α H ) R
                                                                                                                                                                (WGa z)2
 λ(1 − τ )τ (WGa zn + rx )−τ −1 cη −1
                                                                                                                                                                      (17)
   Absent HSV taxes, the analytic solution for hours is:
                  "                                                                                                                      #χ       1
                                                                                        1−e e  η −e e                                         0 η −1      η −1
                      (1−α N )(1−α H )                                                                                                                                (18)
  n = 1 − ΦT −            χ0 α N                (1 − α H ) + α H             αH
                                                                          (1− α H ) R
                                                                                                           WGa z(1 − τ SS )                               c χ0 η −1


   Case (ii) The nonlinear equation for hours is:
                                                                                                                   ηα H
                   χ0 α N (1 − Φ T − n)χ0 η −1 − (1 − α N )(1 − α H )                                    αH
                                                                                                      (1− α H ) R
                                                                                                                                WGa z
                   n                                     o                                                                                                            (19)
                     λ(1 − τ ) (WGa zn + rx )−τ − τ SS cη −1 = 0

   The Jacobian is:
                                                                                                                             ηα H
          −χ0 α N (χ0 η − 1)(1 − Φ T − n)χ0 η −2 + (1 − α N )(1 − α H )                                           αH
                                                                                                               (1− α H ) R
                                                                                                                                         (WGa z)2
                                                                                                                                                                      (20)
          λ(1 − τ )τ (WGa zn + rx )−τ −1 cη −1

   Absent HSV taxes, the analytic solution for hours is:
                                        h                                       ηα H                                  iχ      1
                                                                                                                                          η −1
                                            (1−α N )(1−α H )                                                                  0 η −1                                  (21)
                n = 1 − ΦT −                    χ0 α N
                                                                      αH
                                                                   (1− α H ) R
                                                                                         WGa z(1 −             τ SS )                  c χ0 η −1

   Case (iii) The nonlinear equation for hours is:
                                             1−e e 
          χ 0 α N ( 1 − α H ) + α H (1− α ) R
                                       αH
                                                        c
                                                n    H
                                                                                  o                                                                                   (22)
          −(1 − α N )(1 − α H )(1 − ΦT − n)WGa z λ(1 − τ ) (WGa zn + rx )−τ − τ SS = 0

   The Jacobian is:
                                                           hn                  o
                   (1 − α N )(1 − α H )WGa z  λ(1 − τ ) (WGa zn + rx )−τ − τ SS +
                                                                   i                                                                                                  (23)
                    (1 − Φ T − n)λ(1 − τ )τ (WGa zn + rx + Π)−τ −1




                                                                        52
    Absent HSV taxes, the analytic solution for hours is:
                                                      1−e e 
             n = 1 − Φ T − ( 1 − α H ) + α H (1− α ) R
                                                 αH
                                                                 (1− α
                                                                                                    χ0 α N
                                                                                                                            c   (24)
                                                                                           N )(1− α H )WGa z (1− τ
                                                                                                                     SS )
                                                                          H



    Case (iv) The nonlinear equation for hours is:
                                                      n                                 o
     χ0 α N c − (1 − α N )(1 − α H )(1 − Φ T − n)WGa z λ(1 − τ ) (WGa zn + rx )−τ − τ SS = 0                                    (25)

    The Jacobian is:
                                                   hn                            o
                   (1 − α N )(1 − α H )WGa z λ(1 − τ ) (WGa zn + rx + Π)−τ − τ SS +
                                                               i                                                                (26)
                   (1 − Φ T − n)λ(1 − τ )τ (WGa zn + rx )−τ −1

    Absent HSV taxes, the analytic solution for hours is:
                                                                            χ0 α N
                                    n = 1 − ΦT −                 (1−α N )(1−α H )WGa z(1−τ SS )
                                                                                                c                               (27)

    Given ct , we obtain lt (hence nt ) by numerically solving the labor supply equation.
Given ct , nt , ht , we obtain bt+1 from the budget constraint:
                                                                       1− τ                             
 bt+1 = Q1t Ψt ψz − φF,t  ` + 2− 1
                                      Qt   x t + λ   Wt G az n +
                                                            t t
                                                                   1
                                                                   Qt − 1  x t     − τ SS W G a z n − c − R` h
                                                                                           t     t t   t   t t

                                                                                                         (28)
    Case 2: νt > 0 and ξ t = 0. In this case the borrowing constraint binds and bt+1 = 0 but the
labor constraint does not. The first order conditions in the first three lines of equation 15 are still
                                                                                          1−1 e
correct. It is still the case that conditional on choosing a location `, ht = (1−ααh ) R`         ct and lt is
                                                                                                                 h      t
the solution to the nonlinear equation in Case 1. Given those, ct can be obtained from the budget
constraint:
                                                                    1− τ
                       ` + 2− 1
              Ψt ψz − φF,t                          a            1
                                                                               − τ SS Wt G a zt nt
                                 Qt xt + λ Wt G zt n t + Qt − 1 xt
         ct =                                                 1−e e                              (29)
                                          1 + R t (1− α ) R `
                                                `     αh
                                                                              h   t


    Case 3: νt = 0 and ξ t > 0. In this case the borrowing constraint does not bind, but the labor
constraint does, implying lt = 1 − φT,t     ` , hence n = 0. The first order conditions in the first, third,
                                                       t
and fourth lines of equation 15 are still correct. As in Case 1, conditional on choosing a location `,
                 1−1 e
ht = (1−ααh ) R`         ct . We obtain bt+1 from the budget constraint.
           h   t


    Case 4: νt > 0 and ξ t > 0. In this case both constraints bind, implying nt = 0 and bt+1 = 0.
The first order conditions in the first and third lines of equation 15 are still correct, so conditional
                                           1−1 e
on choosing a location `, ht = (1−ααh ) R`         ct . By plugging this into the budget constraint, we can
                                             h   t
                                                                 1− τ
                                    ` + 2− 1 x + λ
                            Ψt ψz −φF,t                      1
                                               Qt     t      Q t −1 x t
explicitly solve for ct =                                 e               .
                                                     αh     1− e
                                        1+ Rt`          `
                                                 (1− α h ) R t




                                                                     53
                                                                     Ψt ψz −φF,t
                                                                             ` +x
                                                                                    t
In the case with λ = 1, τ = 0, we simply have ct =                                 e       .
                                                                            αh        1− e
                                                                  1+ R t
                                                                       `
                                                                                 `
                                                                           (1− α h ) R t



RC renter Next, the RC renter’s problem is the same as the renter’s problem, with additional
                                                                                                 y
Lagrange multipliers on the income and the rent restriction constraints, ξ t and ξ tr , and κ1 the RC
                                                                                       y
discount multiplying Rt` wherever it appears. Note that we cannot have both ξ t , ξ t > 0 (we rule
out Wκt2GYatzt = 0). Because households are atomistic we ignore the derivative ∂Y
                                                                               ∂nt .
                                                                                  t



                            y
      Case 1: ξ t = 0 and ξ t = 0. There is an interior solution nmin < nt < Wκt2GYatzt , which solves the
same labor supply equation as the market renter (with κ1 Rt` instead of R`t ).
If ξ tr > 0, then the residential housing choice is constrained: ht = κκ3 RY`t . If ξ tr = 0, then combining
                                                                            1 t
                                                               1−1 e
the conditions for ct and for ht , we obtain ht = (1−α )κ R`
                                                         αh
                                                                       ct .
                                                                   h   1   t
If νt > 0, then savings are constrained and bt+1 = 0. If νt = 0, then given ct , nt , ht , we obtain bt+1
from the budget constraint.
                            y
   Case 2: ξ t > 0 and ξ t = 0. The leisure choice is constrained at its upper bound, and nt = 0.
Choices for ht and bt+1 as functions of ct are identical to Case 1.
                           y
   Case 3: ξ t = 0 and ξ t > 0. The labor choice is constrained at the upper bound implied by RC,
and nt = Wκt2GYatzt . Choices for ht and bt+1 as functions of ct are identical to Case 1.

Owner Finally, consider the owner’s problem and let λt be the Lagrange multiplier on the bud-
get constraint, νt be the Lagrange multiplier on the borrowing constraint, and ξ t be the Lagrange
multiplier on the labor constraint. The numerical strategy is to choose ct and b   ht in order to maxi-
mize the household’s utility (therefore, we ignore the multiplier on the non-negativity constraint
b
ht ≥ 0), and nt to solve the nonlinear equation for labor supply. Here we will show that the
other choices (ht and bt+1 ) can be written as analytic functions of ct and b
                                                                            ht . The budget constraint
simplifies to:

       ct + Pt` ht + Qt bt+1 + κ4` Pt` b
                                       ht + φF,t
                                              `
                                                                      1− τ                                   (30)
       = Ψt ψz + 2 − Q1t xt + κ4` Rt` b    ht + λ Wt G a zt nt + Q1t − 1 xt      − τ SS Wt G a zt nt

The first-order conditions for ct , lt are identical to the market renter. The first-order conditions for
ht , b
     ht , bt+1 are respectively:
            1− γ − η                                  η −e
          Ct       (1 − αn )αh ((1 − αhh )ce + αh he ) e he−1 +                  i
          (1 − p ) β(1 − δ − τ P )E t Pt`+1 ∂x∂ V ( xt+1 , zt+1 , a + 1, St+1 ) + νt θres Pt` = λt Pt`
                 a
                                         h      t +1                             i                                 (31)
          (1 − p a ) β(1 − δ − τ P )E t Pt`+1 ∂x∂ V ( xt+1 , zt+1 , a + 1, St+1 ) + νt θinv Pt` = λt ( Pt − Rt )
                                  h             t +1                   i
          λt Qt = (1 − p a ) βE t ∂x∂ V ( xt+1 , zt+1 , a + 1, St+1 ) + νt Qt
                                       t +1



    Case 1: νt = 0 and ξ t = 0. In this case the household is unconstrained. Combining the condi-
tions for ht and bht , and combining the result with the condition for ct , we can solve analytically for
                 1−1 e
ht = (1−ααh ) R`         ct , as in the market renter’s case.
           h   t



                                                             54
Then, the nonlinear labor supply equation for nt is the same.
Given ct , b
           ht , ht , nt , we obtain bt+1 from the budget constraint:
                                    h                                     
                          bt+1 = Q1t Ψt ψz − φF,t
                                               ` + 2− 1                    ` b
                                                       Qt xt + κ4 Rt − Pt ht
                                                                  `  `
                                                   1− τ                             
                                                                                                                                      (32)
                                    a         1                SS    a
                          +λ Wt G zt nt + Qt − 1 xt         − τ Wt G zt nt − ct − Pt ht
                                                                                   `



    Case 2: νt >                     0 and ξ t = 0. In this case the borrowing constraint binds implying bt+1 =
  θres Pt` ht +θinv κ4` Pt` b
                            ht
−             Qt               ,
                 but the leisure constraint does not bind. We solve for lt as in Case 1, as the
nonlinear equation for hours is unaffected. Given ct , b
                                                       ht , nt , we use the budget constraint to solve
for ht analytically:
                                                                                           1− τ
                                   1                              1
                   ht =      Pt` (1−θres )
                                                 Ψt ψz + 2 −     ht + λ Wt G z zt nt + Q1t − 1 xt
                                                    xt + κ4` Rt` bQt
                                                                      i                                                               (33)
                     ` − c − (1 − θ ) κ ` P ` b
                   −φF,t                      h   − τ SS W G z z n
                          t        inv 4 t      t         t      t  t


      In the case with λ = 1, τ = 0, we have
                         1        h                                                                                               i
                                          z                 SS        a             ` `b                                    ` `b
      ht =                          Ψ t ψ   + x t +   1 − τ      Wt G   z t n t + κ  R
                                                                                    4 t h t − φ `
                                                                                                F,t − c t − ( 1 − θ inv ) κ  P
                                                                                                                            4 t h t
                  Pt` (1 − θres )

   Case 3: νt = 0 and ξ t > 0. In this case the borrowing constraint does not bind, but the leisure
constraint does, implying nt = 0. Conditional on choosing a location `, ht is identical to Case 1.
From the budget constraint, we deduce:
                                                                                                   1− τ                 1−1 e 
                                                    1                                        1
              Ψt ψz − φF,t
                       ` +x 2−
                           t                        Qt       + κ4 ( R`t − Pt` )b
                                                                               ht + λ        Qt   − 1 xt     − 1 + (1−ααh ) R`        Pt` ct
                                                                                                                              h   t
bt + 1 =
                                                                                   Qt
                                                                                             (34)
      Case 4: νt > 0 and ξ t > 0. In this case both constraints bind, implying nt = 0 and bt+1 =
    θres Pt` ht +θinv κ4` Pt` b
                              ht
−               Qt               .
                       Eliminating bt+1 and nt from the budget constraint, we can solve analytically
for ht as a function of ct and b ht just as in case 2:
                                                               1− τ                                    
             1          z         1               b         1                                              b
 h t = P ` (1− θ ) Ψ t ψ + 2 − Q t x t + κ 4 R t h t + λ
                                              ` `
                                                            Qt − 1 xt      − φF,t − ct − (1 − θinv ) κ4 Pt ht
                                                                              `                       `  `
              t        res

                                                                                                                                      (35)
In the case with λ = 1, τ = 0, we have
                                             1        h                                                                   i
                                                              z           ` `b                                    ` `b
                             ht =                       Ψ t ψ   + x t + κ  R
                                                                          4 t h t − φ `
                                                                                      F,t − c t − ( 1 − θ inv ) κ  P
                                                                                                                  4 t h t
                                      Pt` (1 − θres )

A.2           Special case which can be solved analytically
Here we use Cobb-Douglas preferences as a special case of the CES aggregator described earlier.
Consider a perpetual renter who is facing a constant wage W and a constant rent R, who is not
choosing location, who is not constrained, who faces no idiosyncratic shocks ( A = 1), and whose
productivity and utility are not age dependent (G a = 1, αc,a = αc , and αh,a = αh ∀ a). His problem



                                                                              55
can be written as:
                                           1
                                                                                     1− γ
                v( xst , a) = max         1− γ    csαt c hsαt h (1 − nt )αn                    + βEt [v( xst+1 , a + 1)] s.t.
                              cs,hs,n                                                                                                                             (36)
                          1
                xst+1 =   Q ( xs t    + nt W − cst − hst R)

    As shown earlier, the optimal housing and labor choices satisfy: hst = ααhc R1 cst and nt = 1 −
αn 1
                       b = α1c cs and plugging these into the maximization problem, the problem is
αc W cs t . Redefining cs
rewritten as:
                            v( xst , a) = max 1−  U
                                                     b 1t −γ + βEt [v( xst+1 , a + 1)] s.t.
                                                   γ cs
                                             cs
                                             b                                                           (37)
                            xst+1 = Q1 ( xst + W − cs    b t)
                                         1− γ
where U = ααc c ααh h ααnn R−αh W −αn          . Next we can guess and verify that the value function has
                                                  1− γ
                         va
the form v( xst , a) = 1−γ ∗ xst + 1−1Qa W                where v a and Q a are constants that depend on age
a. Suppose this is true for a + 1. Then the problem is:

                                U                 1− γ        v a +1 −(1−γ) ( xs                                      Q
             v( xst , a) = max 1− γ cs
                                    bt                    +   1−γ βQ                t                + W − cs
                                                                                                           b t + W 1− Q a +1
                                                                                                                             ) 1− γ
                                 cs
                                 b
                                                                                                                                                                  (38)
                                                                                                                  Q a +1 + Q 1 − γ
                                U
                         = max 1−   b 1t −γ +
                                  γ cs
                                                              v a +1
                                                              1−γ βQ
                                                                     −( 1 − γ ) ( xst                  b t + W 1−1−
                                                                                                     − cs           Q a +1 )
                                 cs
                                 b

Define Xa+1 = v a+1 Q−(1−γ) β. Then the first order condition is: U ∗ cs
                                                                                                                         −γ
                                                                      bt                                                          = Xa+1 ∗ ( xst − cs
                                                                                                                                                   bt +
  1− Q a +1 + Q − γ
W 1−Qa+1 ) . Rearranging, we can solve for optimal consumption:
                                         X      −1/γ
                                         a +1                      
                                                         Q a +1 + Q
                          bt =
                          cs             U
                                        X    xst + W 1−1−
                                                  −1/γ    Q a +1
                                      1+ aU+1
                                                                                                                                                                (39)
                                                                      Q a +1 + Q
                          xst+1 + 1−Q1 a+1 W =  X 1 −1/γ xst + W 1−1− Q a +1
                                                              1+      a +1
                                                                      U


Plugging this back into the original problem:
                                ! 1− γ                                                           ! 1− γ                    
                            X a+1 −1/γ                                                                               1− Q    + Q 1− γ
                                                                                                               xst +W 1−aQ+1
                                                                                        1
   v( xst , a) = U         X
                              U
                                  −1/γ                   + X a +1                X          −1/γ                      a +1
                                                                                                                                   1− γ
                          1+ aU+1                                            1+        a +1
                                                                                       U
                                       −1/γ −(1−γ)                        −(1−γ)/γ                              
                                                                                                                                         1− Q a +1 + Q
                                                                                                                                                          1− γ
                                X a +1                                 X a +1                                  X a +1            xst +W    1− Q a +1              (40)
              = U 1+             U                                      U
                                                                                                       +        U                          1− γ
                                 −1/γ γ
                                                                          1− Q a +1 + Q
                                                                                             1− γ
                            X a +1                                xst +W    1− Q a +1
              = X a +1 1 + U                                                 1− γ


This verifies the conjecture. The age dependent constants take the following form:
                                                      −1/γ γ
                                                 X a +1
                      v a = X a +1 1 + U
                                                                                   γ
                                     1     )                        1     )   −1 −1/γ                                                                             (41)
                           = βQ   −(   − γ   v a+1 1 + v a+1 βQ  −(   − γ   U
                                           Q
                      Qa =            1+ Q − Q a +1




                                                                      56
                                                       −γ
                                           1   −(1−γ)
Note that Q∞ = Q and v∞ = U 1 − β Q        γ      γ           .


A.3     Commuting costs and composition of Zone 1
                                                                1
From the household’s FOC, we know that ∂U          ∂C = ∂N × w where C is the numeraire, N is hours
                                                         ∂U

worked, and w is the wage. Suppose that moving one unit of distance towards center decreases
the hourly commuting cost by φT and the financial commuting cost by φF . Also, suppose that the
price is a function of distance from center P( x ).
      First, consider time costs only (φF = 0). The cost of decreasing the commute by d is d × H ×
P ( x ) × ∂U
  0
            ∂C , this is the amount of housing consumed H, multiplied by the price increase at the
current location P0 ( x ) × d, multiplied by the marginal utility of the numeraire good. The benefit
of decreasing the commute by d is d × φT × ∂N       ∂U
                                                       = d × φT × w × ∂U∂C , this is the marginal utility of
leisure, multiplied by the extra leisure d × φT . Equating the cost to the benefit and rearranging:
                w
P 0 ( x ) = φT H  . The left hand side represents one’s willingness to pay per square foot implying that
                       w
agents with high H        are willing to pay a higher price. For a fixed amount of wealth, high income
                          w
agents have higher H         because individual productivity is stationary, therefore high income agents
                                                                                      w
tend to save relatively more and consume relatively less of their wealth ( H            would be constant
if individual productivity had permanent shocks). For a fixed income, high wealth agents have
           w
higher H     because, consistent with the Permanent Income Hypothesis, for a fixed w, high wealth
agents are willing to spend more on housing.
      Next, consider financial costs only (φT = 0). The cost of decreasing the commute is the same
as before d × H × P0 ( x ) × ∂U  ∂C . The benefit of decreasing the commute is d × φF × ∂C , this is the
                                                                                             ∂U

financial saving d × φF multiplied by the marginal utility of the numeraire. Equating the cost to
the benefit: P0 ( x ) = φF H1 . Low H agents are willing to pay a higher price. Agents who have low
wealth or low income tend to have lower housing demand H and are willing to pay more per
square foot to reduce their commute. The intuition is that the financial cost is fixed, thus agents
with low housing demand are willing to pay a much higher price per square foot to ’ammortize’
the benefit of not paying the fixed cost.


A.4     One-period case which can be solved analytically
There are m agents, mc consumption producing firms, m1 construction firms in zone 1, and m2
                                                                                   2
construction firms in zone 2. There are two zones with sizes mh1 and mh . Agents have initial
wealth W = 0 and earn a wage w. They live for one period only, and there is no resale value for
the housing that they buy.
    Conditional on a zone, a household maximizes U = cαc hαh (1 − λ − x )αn subject to c + P ∗ h =
W + w ∗ x where λ is a zone specific time cost and P is a zone specific housing price (λ = 0 in zone
1). This can be rewritten as:

                            U = max(W + w ∗ x − P ∗ h)αc hαh (1 − λ − x )αn                            (42)
                                  h,x

The first order conditions imply the following solution:

                              c = αc ((1 − λ)w + W )
                              h = αh ((1 − λ)w + W )
                                                                                                       (43)
                              x = (αc + αh )(1 − λ) − αn W
                                       α    αn αc αh αn w
                              U = P1 h w1       αc αh αn ((1 − λ)w + W )

                                                        57
Here we used αc + αh + αn = 1.
                                                                             ρ
    Each consumption producing firm chooses hours xc to maximize πc = xc c − wx    c which im-
                    ρ c −1                                                      H1       ρ
plies that w = ρc xc . Each construction firm in zone 1 maximizes π1 = 1 − 1 P1 x1 h − wx1
                                                                             mh
                                 1       ρ −1
which implies that w = 1 − H 1 P1 ρh x1 h . Each construction firm in zone 2 maximizes π2 =
                             mh                      
        2                                             2        ρ −1
  1 − H 2 P2 x2 h − wx2 which implies that w = 1 − H 2 P2 ρh x2 h . Here H 1 and H 2 are the total
              ρ
      mh                                            mh
amount of housing built in each zone.
    Equilibrium implies that the following equations must be satisfied.

                                              P2 = P1 (1 − λ)1/αh                                 (44)
Equation 44 says that for households to be indifferent between the two zones, their utility of living
in each zone must be the same.

                                                          H 1 P1
                                                  n1 =                                            (45)
                                                          αh w
                                                           H 2 P2
                                               n2 =                                               (46)
                                                       α h w (1 − λ )
                                                 n1 + n2 = m                                      (47)
Equations 45 and 46 say that the total number of households in each zone (N1 and N2 ) must equal
to the total housing in each zone, divided by the housing size an agent in that zone would demand.
The housing size comes from the solution of the agent’s problem. Equation 47 says that the sum
of agents living in zones 1 and 2 must equal to the total number of agents.
                                                              ρ −1
                                            w = ρc xc c                                     (48)
                                                    
                                                H1             ρ −1
                                    w = 1−              P1 ρh x1 h                          (49)
                                                mh 1
                                                    
                                                H2             ρ −1
                                    w = 1−              P2 ρh x2 h                          (50)
                                                mh 2

Equations 48, 49, and 50 relate each firm’s optimal behavior to the wage.
                                                       
                                                   H1
                                      H1 = 1 −
                                                                 ρ
                                                           m1 x1 h                          (51)
                                                  mh  1
                                                       
                                        2          H2            ρ
                                      H = 1−               m1 x2 h                          (52)
                                                  mh2
Equations 51 and 52 relate each firm’s output to the total output of housing in each zone. They
                                     ρ                          ρ
                            mh1 m1 x1 h                 mh2 m2 x2 h
can be rewritten as H 1 =            ρ     and H 2 =              ρ .
                            mh1 +m1 x1 h               mh2 +m2 x2 h

                         (αc + αh )(n1 + n2 (1 − λ)) = mc xc + m1 x1 + m2 x2                      (53)
Equation 53 relates labor supply, on the left side, to labor demand, on the right side.
     This is 10 equations and 10 unknowns: prices P1 , P2 ; labor demand for each firm type x1 , x2 ,
xc ; number of households living in each zone n1 , n2 ; total housing in each zone H 1 , H 2 ; and the
wage w. This can can be reduced to a single equation.


                                                         58
                                                                              ρ −1                      ρ −1
                                                                        mh1 x1 h   mh2 x2 h
    First, plug H and P into equations (49) and (50): w = P1 ρh                    ρh   = P2 ρh
                                                                                             ρ
                                                                       mh1 +m    mh2 +m2 x2 h
                                                                                1 x1
                                                               m1 x1            m2 x2
    Second, plug the wage into equations (45) and (46): n1 = αh ρh and n2 = α ρ (1−λ) .
                                                                              h h
    Third, plug n1 and n2 into equation (47) to solve for x2 in terms of x1 : x2 = 1m−2λ (mαh ρh −
m1 x1 ) = A0 + A1 x1 where A0 = 1m−2λ mαh ρh and A1 = −m1 1m−2λ .
    Fourth, plug x2 = A0 + A1 x1 into the equality between zone 1 and zone 2 firms’ wages derived
                                                         ρ −1
                                                    mh1 x1 h                                ρ −1
                                                                     1/αh mh2 ( A0 + A1 x1 ) h
earlier and use equation (44) to get rid of prices:             ρ    = (1 − λ )                                     . This is
                                                      mh1 +m1 x1 h                       mh2 +m2 ( A0 + A1 x1 )ρh
now one equation with one unknown and can be solved numerically.
     Fifth, once we have x1 we can immediately calculate x2 , n1 , n2 , H 1 , H 2 but we still need to
solve for w and P1 . We can solve for w as a function of P1 using equation (49). We can then solve
for xc as a function of P1 using equation (48). We can then plug this into equation (53) to solve for
P1 .


B     Data Appendix: New York
B.1    The New York Metro Area
U.S. Office of Management and Budget publishes the list and delineations of Metropolitan Statis-
tical Areas (MSAs) on the Census website (https://www.census.gov/population/metro/data/
metrodef.html). The current delineation is as of July 2015. New York-Newark-Jersey City, NY-
NJ-PA MSA (NYC MSA) is the most populous MSA among the 382 MSAs in the nation.
     NYC MSA consists of 25 counties, spanning three states around New York City. The complete
list of counties with state and zone information is presented in Table 4. As previously defined, only
New York County (Manhattan borough) is categorized as zone 1; the other 24 counties are cate-
gorized as zone 2. For informational purposes, the five counties of New York City are appended
with parenthesized borough names used in New York City.


B.2    Population, Housing Stock, and Land Area
The main source for population, housing stock and land area is US Census Bureau American
FactFinder (http://factfiner.census.gov). American FactFinder provides comprehensive
survey data on a wide range of demographic and housing topics. Using the Advanced Search op-
tion on the webpage, topics such as population and housing can be queried alongside geographic
filters. We select the DP02 table (selected social characteristics) for population estimates, the DP04
table (selected housing characteristics) for housing estimates, and the GCT-PH1 table (population,
housing units, area and density) for land area information. Adding 25 counties separately in the
geographic filter, all queried information is retrieved at the county level. We then aggregate the 24
columns as a single zone 2 column.
     Since the ACS (American Community Survey) surveys are conducted regularly, the survey
year must be additionally specified. We use the 2015 1-year ACS dataset as it contains the most
up-to-date numbers available. For Pike County, PA, the 2015 ACS data is not available and we
use the 2014 5-year ACS number instead. Given that Pike County accounts only for 0.3% of zone
2 population, the effect of using lagged numbers for Pike County is minimal.
     The ratio of the land mass of zone 1 (Manhattan) to the land mass of zone 2 (the other 24
counties of the NY MSA) is 0.0028. However, that ratio is not the appropriate measure of the



                                                  59
                           Table 4: Counties in the New York MSA


                              County                     State    Zone
                              New York (Manhattan)        NY     Zone 1
                              Bergen                      NJ     Zone 2
                              Bronx (Bronx)               NY     Zone 2
                              Dutchess                    NY     Zone 2
                              Essex                       NJ     Zone 2
                              Hudson                      NJ     Zone 2
                              Hunterdon                   NJ     Zone 2
                              Kings (Brooklyn)            NY     Zone 2
                              Middlesex                   NJ     Zone 2
                              Monmouth                    NJ     Zone 2
                              Morris                      NJ     Zone 2
                              Nassau                      NY     Zone 2
                              Ocean                       NJ     Zone 2
                              Orange                      NY     Zone 2
                              Passaic                     NJ     Zone 2
                              Pike                        PA     Zone 2
                              Putnam                      NY     Zone 2
                              Queens (Queens)             NY     Zone 2
                              Richmond (Staten Island)    NY     Zone 2
                              Rockland                    NY     Zone 2
                              Somerset                    NJ     Zone 2
                              Suffolk                     NY     Zone 2
                              Sussex                      NJ     Zone 2
                              Union                       NJ     Zone 2
                              Westchester                 NY     Zone 2



relative maximum availability of housing in each of the zones since Manhattan zoning allows for
taller buildings, smaller lot sizes, etc.
    Data on the maximum buildable residential area are graciously computed and shared by
Chamna Yoon from Baruch College. He combines the maximum allowed floor area ratio (FAR) to
each parcel to construct the maximum residential area for each of the five counties (boroughs) that
make up New York City. Manhattan has a maximum residential area of 1,812,692,477 square feet.
                             1
This is our measure for H . The other four boroughs of NYC combine for a maximum buildable
residential area of 4,870,924,726 square feet. Using the land area of each of the boroughs (expressed
in square feet), we can calculate the ratio of maximum buildable residential area (sqft) to the land
area (sqft). For Manhattan, this number is 2.85. For the other four boroughs of NYC it is 0.62.
For Staten Island, the most suburban of the boroughs, it is 0.32. We assume that the Staten Island
ratio is representative of the 20 counties in the New York MSA that lie outside NYC since these are
more suburban. Applying this ratio to their land area of 222,808,633,344 square feet, this delivers
a maximum buildable residential square feet for those 20 counties of 71,305,449,967 square feet.
Combining that with the four NYC counties in zone 2, we get a maximum buildable residential
                                                          2             1   2
area for zone 2 of 76,176,377,693 square feet. This is H . The ratio H /H is 0.0238. We argue that
this ratio better reflects the relative scarcity of space in Manhattan than the corresponding land
mass ratio.



                                                 60
B.3    Income
The main source for the income distribution data is the US Census Bureau’s American FactFinder.
From table DP03 (selected economic characteristics), we retrieve the number of individuals in each
of nine income brackets, ranging from “less than $10,000” for the lowest to “$100,000 or more” for
the highest bracket. The distribution suffers from top-coding problem, so we additionally estimate
the conditional means for the individuals in each income bracket. For the seven income brackets
except for the lowest and the highest, we simply assume the midpoint of the interval as the con-
ditional mean. For example, for the households in $50,000 to $64,999 bracket, the conditional
mean income is assumed to be $57,500. For the lowest bracket (less than $10,000), we assume the
conditional mean is $7,500. Then we can calculate the conditional mean of the highest income
bracket, using the average income and conditional means of the other brackets, since the reported
unconditional mean is based on all data (uncensored).
    Our concept of labor income is full-time earnings before taxes for year-round workers with
earnings. It includes income from wages, salaries, commissions, bonuses, or tips. To convert it to
household-level income, we multiply it by 1.64 household members, which is the average number
of individuals per household in the New York MSA.
    We aggregate the county-level income distribution into a zone 2 income distribution in two
steps. First, the aggregate number of households included in each income bracket is the simple
sum of county-level household numbers in the bracket. Second, we calculate the zone 2 condi-
tional mean of the income brackets using the weighted average methods. For the lower eight
income brackets, the conditional means are assumed to be constant across counties, so zone 2
conditional means are also the same. For the highest income bracket, we use the county-specific
conditional mean of the highest bracket, and calculate its weighted average over the 24 counties.
Using these conditional means, and the household distribution over 9 income brackets, the zone
2 average household income can be calculated.


B.4    House Prices, Rental Prices, and Home Ownership
Housing prices and rental prices data come from Zillow (http://www.zillow.com/research/
data) indices. Zillow publishes Zillow Home Value Index (ZHVI) and Zillow Rent Index (ZRI)
monthly. The main advantage of using Zillow indices compared to other indices is that it over-
comes sales-composition bias by constantly estimating hypothetical market prices, controlling for
hedonics such as house size. We use 2015 year-end data to be consistent with the ACS dataset.
There are a few missing counties in ZHVI and ZRI. For the five counties with missing ZHVI in-
dex price, we search those counties from Zillow (http://www.zillow.com) website, and use the
median listing prices instead. For the two counties with missing ZRI index price, we estimate the
rents using the price/rent ratio of comparable counties.
    Home ownership data is directly from American FactFinder. In table DP04 (selected housing
characteristics), the Total housing units number is divided by Occupied housing units and Vacant
housing units. Occupied housing units are further classified into Owner-occupied and Renter-occupied
housing units, which enables us to calculate the home ownership ratio.


B.5    Rent Regulation
The main source for rent regulation data is US Census Bureau New York City Housing and Va-
cancy Survey (NYCHVS; http://www.census.gov/housing/nychvs). NYCHVS is conducted ev-
ery three years to comply with New York state and New York City’s rent regulation laws. We use

                                                61
the 2014 survey data table, which is the most recent survey data. In Series IA table 14, the number
of housing units under various rent-control regulations are available for each of the five NYC bor-
oughs (corresponding to five counties). We define rent-controlled units as those units that are (i)
rent controlled, (ii) public housing, (iii) Mitchell Lama housing, (iv) all other government-assisted
or regulated housing.
     We exclude rent-stabilized units from our definition. Rent stabilized units are restricted in
terms of their annual rent increases. The vast majority of units built after 1947 that are rent sta-
bilized are so voluntarily. They receive tax abatement in lieu of subjecting their property to rent
stabilization for a defined period of time. Both rent levels and income levels of tenants in rent-
stabilized units are in between those of rent-regulated and unregulated units.
     We calculate the proportion of rent-controlled units (i.e., households) among all the renter-
occupied units. The proportion is 16.9% for Manhattan and 13.2% for the other four NYC bor-
oughs. We use a different data source for the other 20 counties outside of New York City. Affordable
Housing Online (http://affordablehousingonline.com) provides various rent-related statis-
tics at the county level. For each of the 20 counties outside NYC, we calculate the fraction of rent-
regulated units by dividing Federally Assisted Units number by Renter Households number reported
on each county’s webpage. We then multiply these %-numbers with the renter-occupied units in
ACS data set to calculate the rent-regulated units for the 20 counties. Along with the NYCHVS
numbers for the four NYC boroughs, we can aggregate all the 24 counties in zone 2 to calculate
the fraction of rent-regulated units. The four NYC boroughs have 1.53 million renter-occupied
housing units while the rest of zone 2 has 1.30 million. The resulting fraction of rent-regulated
units in zone 2 is 10.4%.
     From the NYCHVS, we also calculate the percentage difference in average rent in New York
City between our definition of regulated rentals and the others (unregulated plus rent-stabilized).
That percentage difference is 49.9%. We apply the same percentage difference to all of the MSA in
our model.
     To calibrate the income qualification parameter κ2 , we collect data on the income of tenants
in RC from the New York Housing and Vacancy Survey. For each percentile of the income distri-
bution of the RC tenants, we calculate what percentile of the overall income distribution in New
York City it represents. This is reported in the second column of Table 5 for RC income percentiles
listed in the first column. For example, a household at the 25th percentile of the income distribu-
tion among RC households is at the 7.7th percentile of the overall income distribution. Another
household at the median of the RC income distribution is at the 11th percentile in the overall in-
come distribution. The last three columns show the same statistics computed within the model,
for three different values of the RC income qualification threshold κ2 .The value of κ2 = 40% pro-
vides the best fit to the data. The higher value of κ2 = 60% has RC tenants that are too rich
compared to the data. For example, the median RC tenant sits at the 39th percentile of the overall
income distribution, while in the data the median RC tenant only sits at the 19th percentile. This
overstates the misallocation in the RC system, compared to the data. The lower value of κ2 = 30%
has RC tenants that are too poor compared to the data. It understates the amount of misalloca-
tion. In sum, the model with κ2 = 40% matches well where RC tenants sit in the overall income
distribution.


B.6    Migration
We use county-to-county migration data for 2006-2010 and 2010-2014 from the 5-year American
Community Survey for the 25 counties in the New York metropolitan area. For each county and


                                                62
                         Table 5: Income Distribution of RC Tenants


                       RC inc pctile   data   κ2 = 30%     κ2 = 40%   κ2 = 60%
                       RCp1             0.4       0.3          0.4        0.5
                       RCp5             1.9       1.0          1.4        3.4
                       RCp10            3.9       3.0          3.6        8.6
                       RCp15            5.2       3.9          8.7        9.1
                       RCp25            7.7       8.8          8.7       15.7
                       RCp33           11.0       8.8         11.2       26.8
                       RCp50           19.3      11.2         18.3       39.4
                       RCp66           30.2      14.8         27.4       39.8
                       RCp75           38.4      27.1         51.9       52.0
                       RCp85           51.5      51.7         59.9       61.2
                       RCp90           60.4      55.6         63.4       70.6
                       RCp95            74       60.9         73.8       79.7
                       RCp99           94.7      80.2         89.8       93.5



survey wave, we compute net migration rates (inflow minus outflow divided by population).
When one person enters the New York labor market and another one leaves, the model is un-
changed, so net migration is the relevant concept for the model. We aggregate net migration for
the 24 counties in zone 2. The net migration rate over the 5-year period between 2010-2014 for the
entire MSA is -0.15%, or -0.03% per year. First, this net migration rate is minuscule: only about
30,000 people moved in over a 5-year period on a MSA population of 20 million. Of course, this
masks much larger gross flows: about 824,000 came into the MSA and 854,000 left. Second, Man-
hattan (zone 1) saw a net inflow of 30,000 people coming from outside the MSA while the rest of
the MSA (zone 2) saw a net outflow to the rest of the country/world of 60,000. Third, comparing
the net migration in the 2010-2014 period to that in the 2006-2010 period, we find that the net mi-
gration rate rose, from -73,000 to -30,000. The net migration rate rises from -0.38% in 2006-2010 to
-0.15% in the 2010-2014 period. In other words, not only are the metro-wide net migration rates
tiny, they also have little cross-sectional and time-series variation.


C     Earnings Calibration
Before-tax earnings for household i of age a is given by:
                                           lab
                                          yi,a = Wt nit G a zi

where G a is a function of age and zi is the idiosyncratic component of productivity. Since en-
dogenous labor supply decisions depend on all other parameters and state variables of the model,
exactly matching earnings in model and data is a non-trivial task.
    We determine G a as follows. For each wave of the Survey of Consumer Finance (SCF, every
3 years form 1983-2010), we compute average earnings in each 4-year age bucket (above age 21),
and divide it by the average income of all households (above age 21). This gives us an average
relative income at each age. We then average this relative age-income across all 10 SCF waves.
    We also use SCF data to determine how the dispersion of income changes with age. We choose
four grid points for income, corresponding to fixed percentiles (0-25, 25-75, 75-90, 90-100). To


                                                  63
 compute the idiosyncratic income z a,i of each group i ∈ {1, 2, 3, 4} at a particular age a, relative to
 the average income of all households of that age we do the following:
Step 1: For each positive-earnings household, we compute which earnings group it belongs to
        among the households of the same age.

Step 2: For each 4-year age bucket, we compute average earnings of all earners in a group.

Step 3: We normalize each group’s income by the average income in each age group, to get each
        group’s relative income.

Step 4: Steps 1-3 above are done separately for each wave of the SCF. We compute an equal-weighted
        average across all 10 waves to get an average relative income for each age and income group.
        This gives us four 11x1 vectors z a,i since there are 11 4-year age groups between ages 21 (en-
        try into job market) and 65 (retirement). Note that the average z across all households of a
        particular age group is always one: E[z a,j | a] = 1.

Step 5: We regress each vector, on a linear trend to get a linearly fitted value for each group’s relative
        income at each age. The reason we perform Step 5, rather stopping at Step 4 is that the
        relative income at age 4 exhibits some small non-monotonicities that are likely caused by
        statistical noise (sampling and measurement error). Step 5 smoothes this out.
     We set the productivity states to zi ∈ Z = [0.255, 0.753, 1.453, 3.522] to match the observed
 mean NY household income levels, scaled by the NY metro area average, in the income groups
 below $41,000, between $41,000 and $82,000, between $82,000 and $164,000, and above $164,000.
 Those bins respectively correspond to bins for individual earnings below $25,000, between $25,000
 and $50,000, between $50,000 and $100,000, and above $100,000, adjusted for the number of work-
 ing adults in the average New York household (1.64). The NY income data is top-coded. For
 each county in the NY metro area, we observe the number of individuals whose earnings exceed
 $100,000. Because we also observe average earnings (without top-coding), we can infer the aver-
 age income of those in the top coded group.
     The transition probability matrix for z is P for β L agents. We impose the following restrictions:
                                                                           
                            p11        1 − p11         0            0
                       (1 − p22 )/2     p22      (1 − p22 )/2      0       
                    P=                                                     
                            0       (1 − p33 )/2     p33      (1 − p33 )/2 
                             0            0         1 − p44        p44

 For β H types, the transition probability matrix is the same, except for the last two entries which
 are 1 − p44 − p H and p44 + p H , where p H < 1 − p44 . We pin down the five parameters

                             ( p11 , p22 , p33 , p44 , p H ) = (0.93, 0.92, 0.92, 0.82, .02)

 to match the following five moments. We match the population shares in each of the four income
 groups defined above: 16.1%, 29.8%, 34.2%, and 19.9%, respectively (taken from the individual
 earnings data). Given that population shares sum to one, that delivers three moments. We match
 the persistence of individual labor income to a value of 0.9, based on evidence form the PSID in
 Storesletten, Telmer, and Yaron (2006). Finally, we choose p H to match the fraction of high-wealth
 households in the top 10% of the income distribution.
 Table 6 summarizes the results we obtain in the model. Average earnings are reported annually.
 Earnings autocorrelation and volatility are reported for 4 years.

                                                          64
                                                      Table 6: Labor Earnings Calibration


                                                                    Group 1             Group 2             Group 3             Group 4               All
                      Avg earnings                                   25440               66685               123460              343643
                      (Data)                                        (28125)             (60951)             (116738)            (309016)
                      Pop shares                                     21.4%               28.3%                33.3%               17.1%
                      (Data)                                        (16.1%)             (29.8%)              (34.2%)             (19.9%)
                      Earnings autocorr.                                                                                                            0.77
                      Earnings vol.                                                                                                                 0.125
                      Corr. (income,wealth)                                                                                                          0.23

Notes: Averages by bins in the data are obtained by multiplying average labor earnings ($124,091 annually) by the ratio of average earnings in each bin to the overall average (0.23,
0.50, 0.96, 2.42). Average household earnings and population shares in the data are denoted in parentheses and obtained from Census Bureau data for the year 2016.




                                                                                        65
D        Progressive Taxation
                                                                                                                                                                                                     1
Following Heathcote et al. (2017), households with income ytot < y0tot = λ τ receive transfers
T (ytot ) < 0, and those with ytot ≥ y0tot pay taxes T (ytot ) ≥ 0. We set τ = 0.17 and λ = 0.75, as dis-
cussed in the calibration section. As a result of our calibration, 35% of households are subsidized
by the progressive tax system, and 29% receive a subsidy after subtracting Social Security taxes.
Figure 7 describes the progressive taxation system. At low total income values, some households
receive a subsidy, which progressively decreases. At higher incomes, taxes increase faster than
income. This is reflected in households’ after-tax income, shown in Figure 8.

                                                                                     Figure 7: Progressive Taxes
                                                      10 4                                                                                                            10 4
                                            15                                                                                                               15




                                                                                                                   Progressive Tax and Social Security Tax
                                            10                                                                                                               10
                  Progressive Tax




                                             5                                                                                                               5




                                             0                                                                                                               0


                                                  0          0.5    1    1.5   2    2.5   3   3.5      4                                                          0          0.5    1    1.5   2   2.5   3   3.5      4
                                                                                                    10 5                                                                                                           10 5
                                                                   Total Before-Tax Income                                                                                         Total Before-Tax Income


Notes: Horizontal axis: total income (in dollars, annual), measured as the sum of labor earnings, pensions, and financial income.
Vertical axis: taxes minus transfers excluding Social Security taxes (in dollars, annual; left panel), total taxes minus transfers including
Social Security taxes (in dollars, annual; left panel). The dashed line plots the zero-tax case.




                                                                                   Figure 8: After-tax Total Income
                                                      10 5                                                                                                            10 5
                                             4                                                                                                               4




                                            3.5                                                                                                          3.5
             After Progressive Tax Income




                                             3                                                                                                               3
                                                                                                                After Total Tax Income




                                            2.5                                                                                                          2.5




                                             2                                                                                                               2




                                            1.5                                                                                                          1.5




                                             1                                                                                                               1




                                            0.5                                                                                                          0.5




                                             0                                                                                                               0
                                                  0          0.5    1    1.5   2    2.5   3   3.5      4                                                          0          0.5    1    1.5   2   2.5   3   3.5      4
                                                                                                    10 5                                                                                                           10 5
                                                                   Total Before-Tax Income                                                                                         Total Before-Tax Income


Notes: Horizontal axis: total income (in dollars, annual). Vertical axis: post-tax income excluding Social Security taxes (in dollars,
annual; left panel), post-tax income including Social Security taxes (in dollars, annual; left panel). The dashed line is the 45 degree
line.




                                                                                                           66
E     Housing Supply Elasticity Calibration
We compute the long-run housing supply elasticity. It measures what happens to the housing
quantity and housing investment in response to a 1% permanent increase in house prices. Define
housing investment for a given zone, dropping the location superscript since the treatment is
parallel for both zones, as:                       
                                     h         Ht−1    ρ
                                    Yt = 1 −          Nt h .
                                                 H
Note that Ht+1 = (1 − δ) Ht + Yth , so that in steady state, Y h = δH. Rewriting the steady state
housing investment equation in terms of equilibrium quantities using (8) delivers:
                                                  1−1ρ         ρh
                                   1          H            h    1− ρ h
                                                                             ρh      −ρh
                                H=         1−                  ρh        P 1− ρ h W 1− ρ h
                                   δ          H
Rewrite in logs, using lowercase letters to denote logs:

                                    1                             ρh        ρh
                 h = − log(δ) +          log(1 − exp( h − h)) +        p−        w
                                  1 − ρh                        1 − ρh    1 − ρh

Rearrange and substitute for p in terms of the market price p = log( ho + (1 − ho )κ4 ) + p:

                                  1 − ρh    1
                             p=          h−    log(1 − exp( h − h)) + k
                                    ρh      ρh

where
                                1 − ρh
                           k≡          log(δ) + w − log( ho + (1 − ho )κ4 )
                                  ρh
Now take the partial derivative of p w.r.t. h:

                               ∂p   1 − ρh   1 exp( h − h)       ∂k
                                  =        +                   +
                               ∂h     ρh     ρh 1 − exp( h − h) ∂h

Invert this expression delivers the housing supply elasticity:

                       ∂h                               ρ
                          =                            h h                                             i   (54)
                       ∂p               exp( h− h)                      (1−κ 4 )
                            1 − ρh +   1−exp( h− h)
                                                      + ρh ∂w
                                                           ∂h − ρ h ho +(1− ho )κ
                                                                                                 ∂ho
                                                                                                 ∂h
                                                                                             4



                                                            ∂h ≈ 0) and either the RC distortions are
If (i) the elasticity of wages to housing supply is small ( ∂w
small (κ4 ≈ 1) or the home ownership rate is inelastic to the housing supply ( ∂ho
                                                                                 ∂h ≈ 0), or (ii) if the
two terms in square brackets are positive but approximately cancel each other out, then the last
two terms are small. In that case, the housing supply elasticity simplifies to:

                                      ∂h           ρh
                                         ≈
                                      ∂p             exp( h− h)
                                           1 − ρh + 1−exp(h−h)

Since, in equilibrium, Y h = δH, ∂yh /∂p = ∂h/∂p.
   Note that h − h measures how far the housing stock is from the constraint, in percentage terms.



                                                      67
                                                          exp( h− h)
As H approaches H, the term                              1−exp( h− h)
                                                                        approaches +∞ and the elasticity approaches zero. This
is approximately the case in zone 1 for our calibration. If H is far below H, that term is close to
                                                     ρ
zero and the housing supply elasticity is close to 1−hρh . That is approximately the case for zone 2
in our calibration. Since zone 2 is by far the largest component of the New York metro housing
stock, zone 2 dominates the overall housing supply elasticity we calibrate to.
    In the calibration, we use equation (54) to measure the housing supply elasticity and set ∂w∂h =
0.25 based on evidence from Favilukis and Van Nieuwerburgh (2018), who study a model with
aggregate shocks to housing demand driven by out-of-town home buyers.


F      Mobility Rates

                                                               Figure 9: Moving Rates

                                                   All                                                                   Homeowners
                                          0.1                                                                     0.1
           Annual prob. to change zone




                                                                                   Annual prob. to change zone
                                         0.08                                                                    0.08


                                         0.06                                                                    0.06


                                         0.04                                                                    0.04


                                         0.02                                                                    0.02


                                           0                                                                       0
                                                22.5
                                                26.5
                                                30.5
                                                34.5
                                                38.5
                                                42.5
                                                46.5
                                                50.5
                                                54.5
                                                58.5
                                                62.5
                                                66.5
                                                70.5
                                                74.5
                                                78.5
                                                82.5
                                                86.5
                                                90.5
                                                94.5




                                                                                                                        22.5
                                                                                                                        26.5
                                                                                                                        30.5
                                                                                                                        34.5
                                                                                                                        38.5
                                                                                                                        42.5
                                                                                                                        46.5
                                                                                                                        50.5
                                                                                                                        54.5
                                                                                                                        58.5
                                                                                                                        62.5
                                                                                                                        66.5
                                                                                                                        70.5
                                                                                                                        74.5
                                                                                                                        78.5
                                                                                                                        82.5
                                                                                                                        86.5
                                                                                                                        90.5
                                                                                                                        94.5
                                                  Age                                                                       Age

                                                 Renters                                                                 RC Renters
                                          0.1                                                                     0.1
           Annual prob. to change zone




                                                                                   Annual prob. to change zone




                                         0.08                                                                    0.08


                                         0.06                                                                    0.06


                                         0.04                                                                    0.04


                                         0.02                                                                    0.02


                                           0                                                                       0
                                                22.5
                                                26.5
                                                30.5
                                                34.5
                                                38.5
                                                42.5
                                                46.5
                                                50.5
                                                54.5
                                                58.5
                                                62.5
                                                66.5
                                                70.5
                                                74.5
                                                78.5
                                                82.5
                                                86.5
                                                90.5
                                                94.5




                                                                                                                        22.5
                                                                                                                        26.5
                                                                                                                        30.5
                                                                                                                        34.5
                                                                                                                        38.5
                                                                                                                        42.5
                                                                                                                        46.5
                                                                                                                        50.5
                                                                                                                        54.5
                                                                                                                        58.5
                                                                                                                        62.5
                                                                                                                        66.5
                                                                                                                        70.5
                                                                                                                        74.5
                                                                                                                        78.5
                                                                                                                        82.5
                                                                                                                        86.5
                                                                                                                        90.5
                                                                                                                        94.5




                                                  Age                                                                       Age



Notes: Mobility rates by age are measured as the annual probability to move across zones.




                                                                              68
G      Additional Affordability Policies
In this appendix, we study six additional housing affordability experiments. The first five of them
change features of the RC program, generally in the direction of making the RC program less gen-
erous. We (i) reduce the size of the system (governed by η ` ), (ii) reduce the rent subsidy (governed
by κ1 ), (iii) lower the size of the RC units (governed by κ3 ), (iv) move all RC housing in zone 1 to
zone 2, and (v) move all RC housing from zone 2 to zone 1 but provide for free transportation to
RC residents (in zone 2). Experiment (vi) studies an expansion of the Low Income Housing Tax
Credit program. Table 7 and Figure 10 summarize the results.


G.1     Reducing the Amount of RC Housing
This policy is the opposite of the one discussed in Section 5.2. We reduce η ` in each zone by
50%. This allows us to study the symmetry of the welfare results. Given the curvature of the value
function at low wealth levels, poor households are more adversely affected by a discrete reduction
in the RC system than they are helped by a same-sized expansion. However, a reduction in the
scope of the RC system also reduces distortions. On balance, a 50% reduction in the scope of the
RC program leads to a -0.62% welfare loss, fairly similar in absolute value to the 0.66% gain from
a 50% expansion.
    The 50% reduction in the square footage of RC leads to a -76.78% drop in the fraction of house-
holds in RC due to endogenous changes in the size of RC units. The fraction of low-income
households in RC falls only slightly less. Thus, access to RC insurance deteriorates substantially
(-75.06%). Lower rents benefit market renters in both zones. A slight improvement in output
(0.04%) and a reduction in commuting times (-0.04%) offset, but cannot make up for the concen-
trated losses on the poor. Housing affordability metrics improve, underscoring that maximizing
welfare and improving housing affordability metrics can be conflicting objectives.


G.2     Reducing the Rent Subsidy for RC Housing
In the second additional experiment, labeled “RC discount,” we reduce the rental discount that
RC households enjoy. Specifically, we lower the rent discount from 50% to 25%; the parameter κ1
goes from 0.5 to 0.75. The total square footage that goes to RC housing in each zone (η ` ) remains
at the benchmark values. Surprisingly, the reduced generosity of the RC system leads to a 23.15%
increase in the fraction of households in RC. The reason is that RC households tend to choose a
much smaller average RC apartment size (-23.06% on average across zones). Thus, this policy
has similar effects as a policy that has more “micro units” in the affordable housing system. 40 RC
housing becomes less efficiently allocated; the share of bottom-quartile households that ends up in
RC increases by 20.00%, less than the overall increase. Not surprisingly, those in RC under the new
policy are worse off than those in RC under the benchmark policy since they are paying higher
rents (due to the smaller discount) and they live in much smaller units. On the other hand, there
are now more households benefiting from a lower rent level. Access to RC insurance improves
substantially. On net, the reduced generosity of the RC insurance results in a non-trivial welfare
loss (-0.49%). In sum, the main source of the welfare loss is the reduced value of the insurance
provided by the RC system –RC rents are not as low as before– which disproportionately hurts
  40 Sucha policy is advocated by several policy institutes, for instance the NYU Furman Center (2018).
New York City historically discouraged the development of small apartment units due to a variety of rules
and regulations.


                                                   69
low-income households. While access to insurance improves, the extent of insurance provided
deteriorates.
    Despite the reduced distortions on housing construction, the aggregate housing stock ends
up falling (due to the decrease in zone 2’s demand), illustrating the pitfalls of partial equilibrium
logic. Output falls modestly as hours worked fall.

                                      Table 7: Additional housing affordability policies

                                                         Benchmark         RC share       RC discount         RC size      RC in Z2         RC in Z2          LIHTC
                                                                                                                                           +free transit
   1      Avg(rent/income) renters, Z1 (%)                    28.3           -8.24%            9.67%            0.19%       -16.34%          -17.65%          -0.90%
   2      Avg(rent/income) renters, Z2 (%)                    29.2            0.76%            1.67%           -0.71%         0.68%            1.36%          -0.23%
   3      Frac. RC (%)                                        5.98          -76.78%           23.15%            8.36%            –                –            0.55%
   4      Frac. RC of those in inc. Q1 (%)                   14.24          -75.32%           20.00%            7.83%         0.62%           -0.30%          -0.03%
   5      Frac. rent-burdened (%)                             48.7           -9.61%           -5.26%           -0.69%         0.22%           -1.73%          -2.05%
   6      Avg. size RC unit in Z1 (sqft)                      683            -1.01%          -13.37%          -13.02%            –                –           -0.02%
   7      Avg. size RC unit in Z2 (sqft)                     1173             1.65%          -25.76%           -7.15%         0.26%            2.19%           0.47%
   8      Avg. size Z1 mkt unit (sqft)                        999            -2.06%           -1.15%            0.20%        -2.63%           -1.79%          -0.03%
   9      Avg. size Z2 mkt unit (sqft)                       1521            -0.76%            1.81%            0.49%        -0.25%           -0.54%           0.25%
   10     Frac. pop. Z1 (%)                                   10.5           -0.12%            3.63%            1.49%        -1.09%           -2.04%           0.35%
   11     Frac. retirees Z1 (%)                               21.5           -2.79%           -1.28%           -0.33%         0.21%            1.93%          -0.93%
   12     Housing stock Z1                                      –             0.18%            0.56%           -0.01%         0.58%            0.50%           0.24%
   13     Housing stock Z2                                      –            -0.08%           -0.20%           -0.10%        -0.47%           -0.52%           0.22%
   14     Rent/sqft Z1 ($)                                    4.21           -0.93%           -0.90%           -0.11%         0.10%            0.07%          -0.40%
   15     Rent/sqft Z2 ($)                                    1.52           -1.17%           -1.20%           -0.14%         0.17%            0.15%          -0.51%
   16     Price/sqft Z1 ($)                                  1050            -0.94%           -0.90%           -0.11%         0.10%            0.07%          -0.41%
   17     Price/sqft Z2 ($)                                   294            -1.18%           -1.20%           -0.14%         0.17%            0.15%          -0.52%
   18     Home ownership Z1 (%)                               45.1            5.27%           -3.51%           -1.35%         5.11%            6.73%          -0.38%
   19     Home ownership Z2 (%)                               59.6            1.96%           -1.68%           -0.20%        -0.55%           -0.66%          -0.20%
   20     Avg. income Z1 ($)                                164422            2.27%           -2.37%           -1.45%         5.01%            5.87%           0.11%
   21     Avg. income Z2 ($)                                100154           -0.33%            0.16%            0.11%        -0.88%           -1.04%          -0.02%
   22     Frac. high prod. Z1 (%)                             29.7           -1.65%           -2.65%           -0.31%         0.74%           -5.00%          -5.61%
   23     Total hours worked                                    –             0.22%           -0.12%           -0.09%        -0.07%           -0.31%           0.00%
   24     Total hours worked (efficiency)                       –             0.08%           -0.04%           -0.06%        -0.05%           -0.11%          -0.01%
   25     Total output                                          –             0.04%           -0.03%           -0.04%        -0.06%           -0.10%          -0.00%
   26     Total commuting time                                  –            -0.04%           -0.47%           -0.18%         0.13%            0.28%          -0.06%
   27     Access to RC insurance (%)                           5.6          -75.06%           19.02%           10.19%        -1.83%           -3.47%           0.13%
   28     Stability of RC insurance (%)                       72.5           -0.63%           -2.88%            0.05%         0.44%            0.69%          -0.02%
   29     Std. MU growth, nondurables                         0.45           -0.51%           -0.61%            0.07%        -0.06%            0.33%           0.30%
   30     Std. MU growth, housing                             0.45            0.99%           -0.38%           -0.15%         6.16%            5.96%           0.28%
   31     Aggregate welfare change                              –            -0.62%           -0.49%           0.23%         -0.03%           0.37%           0.02%


Notes: Column “Benchmark” reports values of the moments for the benchmark model. Columns “RC share” to “LIHTC” report percentage changes of the moments in the policy
experiments relative to the benchmark. Rows 1-8 report housing affordability moments , rows 9-24 aggregate moments across the two zones, and rows 25-26 welfare moments. Z1
stands for zone 1 (Manhattan), Z2 for the rest of the metro area. Row 20 reports what fraction of working age top-productivity households live in zone 1.




G.3          Reducing the Maximum Size of RC Housing
The third additional experiment changes how “deeply affordable” RC units must be, governed by
the parameter κ3 . In the benchmark, affordable housing units have a rent expenditure cap of 35%
of AMI on rent, or about $2400 per month. Here we change this cap to 20% of AMI or about $1400
per month. This effectively tightens the constraint on the maximum size of a RC unit.
    As shown in the column “RC housing size” of Table 7, the policy change indeed lowers the
average RC unit size, by -13.02% in zone 1 and -7.15% in zone 2. Because the total amount of


                                                                                   70
                                                                             Figure 10: Welfare effects of additional housing affordability policies

              Welfare Relative to Benchmark (%)




                                                                                                                                       Welfare Relative to Benchmark (%) Welfare Relative to Benchmark (%)
                                                                             1                                                                                                                                 1

                                                                                                                                                                                                             0.5
                                                                 0.5
                                                                                                                                                                                                               0
                                                                             0
                                                                                                                                                                                                             -0.5
                                                    -0.5
                                                                                                                                                                                                              -1

                                                                             -1                                                                                                                              -1.5
                                                                                  30   40     50     60       70     80      90                                                                                     1      2          3      4
                                                                                                   Age                                                                                                                  Productivity Level
                                         Welfare Relative to Benchmark (%)




                                                                             1                                                                                                                                 1


                                                                                                                                                                                                             0.5
                                                                             0
                                                                                                     RC share                                                                                                  0
                                                                                                     RC discount
                                                                             -1                      RC size
                                                                                                     All RC in Z2                                                                                            -0.5
                                                                                                     All RC in Z2+free transit
                                                                                                     LIHTC
                                                                             -2                                                                                                                               -1
                                                                                   1         2            3            4                                                                                            1      2          3      4
                                                                                            Income Quartile                                                                                                             Net Worth Quartile

Notes: The baseline model has the following parameters: η 1 = 24.46, η 2 = 15.97, κ1 = 50%, κ2 = 0.40, κ3 = 0.35. Policy experiments, each panel: decrease in the mandated
fraction of RC sqft by 50%, decrease in the RC discount on market rent by 50%, decreasing the qualifying rental expenses as a fraction of AMI for RC units from 0.35% to 20%,
shifting all RC units to Z2, LIHTC. Top left panel: by age. Top right panel: by productivity level. Bottom left panel: by income quartile. Bottom right panel: by net worth quartile.
The welfare changes are measured as consumption equivalent variations for an average household in each group.




square footage is unaffected by the policy change, the fraction of households in RC increases by
nearly the same amount (8.36% on average across zones). Tighter RC size requirements (lower κ3 )
are less effective at improving the targeting of the RC system than tighter income requirements
(lower κ2 ). The fraction of low-income households in RC grows at 7.83%, a slower rate than the
aggregate. This suggests that the RC size constraint has only limited bite, given the income limit
already in place.
    The policy generates a moderate welfare gain of 0.23%. Access to RC insurance expands,
commuting times are reduced, while output only falls marginally. Figure 10 shows that the welfare
gains are declining in productivity and income, and uniformly positive among age groups. These
results are similar to those for the policies we studied in Section 5.1, which also aimed at improving
targeting. But clearly, reducing the house size is a less potent way of addressing the inefficiencies
in the RC system.


G.4           Spatial Allocation of RC Housing
In the fourth additional experiment, we explore the spatial dimension of our model by studying
the effects of a policy that shifts all RC units from Manhattan to zone 2. That is, η 1 is now set to

                                                                                                                                  71
zero and η 2 is increased to make up for the loss of RC housing in zone 1 until the overall number
of households that enjoy RC is the same as in the benchmark model. As a result of this relocation,
the average RC unit becomes 10.47% larger. This is a composition effect because RC units in zone
1 were much smaller than in zone 2 in the benchmark model. Thus, this policy requires a modest
expansion in the square feet of RC housing.
    The removal of the affordable housing mandate in Manhattan spurs on housing development.
The housing stock in zone 1 increases (0.58%). The space formerly occupied by RC units in zone
1 is absorbed by market renters and owners. With the departure of RC tenants, the population
of Manhattan becomes more affluent. Average income in zone 1 is 5.01% higher and the average
dwelling size across all units increases (1.67%). Reflecting the more affluent population, the home
ownership rate increases 5.11%. Zone 1 sees a small increase in rents (0.10%) reflecting the greater
equilibrium housing demand. Because of higher average income and despite slightly higher rents,
the rent-income ratio among renters in zone 1 falls substantially (-16.34%). Clearly, this does not
mean that housing became more affordable in zone 1. In fact, there are no more affordable housing
units in zone 1 left and the market rent went up.
    The expansion of RC in zone 2 reduces developer incentives to build in zone 2. The housing
stock decreases (-0.47%) along with average unit size (-0.60%), while rents increase (0.17%). Av-
erage rent-to-income increases by 0.68% in zone 2. As measured by the fraction of rent-burdened
households metro-wide (+0.22%), and rent-to-income ratios, overall housing affordability deteri-
orates with this spatial reallocation of RC. With fewer households in zone 1 (-1.09%) and more
retirees, total commuting time increases (0.13%). The policy attains its presumed goal, which is to
attract more top-productivity households to zone 1. But the gain is small (0.74%).
    The policy generates a small welfare loss (-0.03%). The main reasons for the loss are, first,
smaller housing units in both zones, as zone 1 and zone 2 market rate rental units become smaller
and more expensive. Second, the probability of first-time access for low-income households with a
negative income shock drops (-1.83%). Incumbents are now more reluctant to voluntarily give up
their RC apartment given that it is larger than the average RC unit in the benchmark model. Most
importantly, low income households in RC now must pay for commuting expenses which affects
their budgets disproportionally. Figure 10 summarizes the welfare effects. Young households lose
while older households gain. The welfare losses would be larger still if households had an explicit
preference for socio-economic diversity in every neighborhood.


G.5    Spatial Allocation of RC Housing with Free Transit
Fifth, we consider a policy that combines the relocation of RC housing from zone 2 to zone 1 with
a policy that provides free transportation to all RC tenants. This policy is reported in the fifth
column of Table 7. To finance the free transportation, taxes are increased on everyone. This is
accomplished by changing the parameter λ in the tax and transfer function by the right amount.
The total cost of providing this free transportation for all RC residents is $974 million; this is
the amount of additional taxes raised. We find that relocation of RC housing to zone 2 is wel-
fare increasing once accompanied by free transportation; the aggregate welfare gain is 0.37%, a
substantial increase from the -0.03% aggregate welfare without free transit. The reason is that fi-
nancial transportation costs are meaningful for low-income households and were the source of
the welfare loss in the previous experiment. For comparison, a policy that provides free transport
but leaves the spatial distribution of RC housing unchanged generates a welfare gain of 0.29%. In
sum, conditional on providing free transportation, moving RC housing from zone 2 to zone 1 is
good for welfare.


                                                72
G.6     Low-Income Housing Tax Credits
The final policy experiment studies a common policy tool in affordable housing: tax credits for
developers. Tax credits directly incentivize the development of affordable housing units by giving
developers subsidies to offset the cost of affordable housing construction.

G.6.1   Institutional Background
Developers who receive tax credits for affordable housing development can sell them to other
profitable firms; they fetch prices above 90 cents on the dollar. In other words, they are (nearly)
equivalent to cash subsidies.
     The main program, the federal Low Income Housing Tax Credit (LIHTC) subsidizes 30% of
the construction cost associated with affordable housing units. This is known as the 4% program.
A 4% subsidy of construction costs is given over a 10-year period, and is worth 30% in present-
value terms. There is a second program, the 9% subsidy for 10 years, which is worth 70% in
present-value terms, which is aimed at more deeply affordable housing units. We focus on the
4% program. Total spending on LIHTC is $9 billion annually nationwide; about $50 million in
the New York MSA. Additional programs, like Tax Incremental Financing, are ran by municipal
governments. We focus on LIHTC.
     LIHTCs are often used to subsidize mixed market rate-affordable housing projects. In practice,
it is up to the states to decide how to spend their federal LIHTC allocations depending on which
areas and which points of the income distribution they want to target. In places like Manhattan
with high costs of land and high construction costs, the only way to break even on an affordable
housing development through tax credits, given the rules of the LIHTC, is to build a mixed prop-
erty with market-rate and affordable units. Such areas are known as Difficult to Develop Areas.
They are our focus. Davis et al. (2017) study instead low-income tracts with a poverty rate above
25%, the so-called the QRT areas.

G.6.2   Modeling Tax Credits
In our model, developers in a given zone earn a price per sqft built equal to the market price times
a discount; recall equation (6), repeated here for convenience:
                                                             
                                      `
                                    Pt = hot` + (1 − hot` )κ4` Pt` .

The discount depends on the fraction of units that are owned (hot` ) and the rent discount due to
RC housing κ4` . We now assume that developers receive a subsidy to help offset the rent discount
due to RC:
                               κ4` = 1 − η ` + η ` κ1 (1 + LI HTC ).
In the benchmark model, the parameter LI HTC = 0. In the LIHTC experiment, we choose LI HTC
such that the total value of LIHTC subsidies, aggregated first across all firms within each zone and
then across zones, is equal to 30% of the construction costs associated with the construction of RC
housing. We compute the construction costs of RC housing as follows. Since the only input is
labor, we take the total wage bill in each zone (aggregating across firms) and multiply it by the
share of RC sqft to compute the construction costs associated with RC housing in that zone; then
we sum across zones and multiply by 30%. That gives us the total value of LIHTC subsidies.
Matching the construction costs of RC housing requires a value for the parameter LI HTC of 0.39
or 39%. We assume it is identical across zones. When accounting for ownership rates and shares

                                                73
                                                                            `
of RC sqft in each zone, the tax credits increases the average price Pt earned by developers in
zone 1 by 18.41% in zone 1 and 13.99% in zone 2. We then change the value of λ in the tax-and
-transfer function to generate enough additional tax revenue to exactly pay for the aggregate tax
credit outlay. The policy is budget neutral, like the previous experiments. The size of the program,
the extra tax dollars raised (and spent), is calibrated to be the same as for the voucher program
discussed in Section 5.4, and equals $738mi. Hence, these two programs are directly comparable.
Developers continue to build market rate and affordable units in proportions 1 − η ` and η ` .

G.6.3   Results
The LIHTC policy has only very modest aggregate welfare benefits (0.02%). Most households
gain across age, productivity, and income groups; while the wealthy suffer minor welfare losses.
The policy succeeds in its intended purpose, to increase the equilibrium housing stock (0.24% in
zone 1 and 0.22% in zone 2). While developer incentives to build are strengthened, equilibrium
housing demand becomes weaker because of the higher tax burden to pay for the tax credits. The
increase in supply and fall in demand for housing results in lower rents and house prices. The
reduction in house prices is consistent with Diamond and McQuade (2019), who find negative
spillovers on house prices in higher-income neighborhoods from LIHTC properties, since Man-
hattan and the average county in zone 2 of the New York metro area represent fairly wealthy
areas.41 Higher taxes reduce labor supply, but a negative wealth effect from lower house prices
counters the effect, leaving hours and output are nearly unaffected. The policy only leads to a
modest improvement in housing affordability (small decreases in the rent-income ratios and frac-
tion of rent-burdened households). Poor, high-marginal utility households gain only modestly.
The volatility of marginal utility growth increases, suggesting a deterioration in risk sharing.
    One reason for the modest success is that the LIHTC policy in Difficult to Develop Areas in-
creases developers’ incentives to build in general, rather than directly targeting low-income hous-
ing. Thus, the benefits are diffuse and offset by the negative effects from distortionary taxation.




  41 Theyfind the opposite effect in low-income neighborhoods, and attribute the positive spillovers to
neighborhood revitalization and crime reductions which attract a different population. We are holding the
amenity value of a neighborhood constant.


                                                   74
H     Robustness
We study how our policy results change with key model parameters. For each parameteriza-
tion, we first do a comparative statics exercise describing how the equilibrium differs from the
equilibrium in our benchmark calibration. Then, we conduct a difference-in-difference exercise,
describing the responses of welfare, prices, and quantities to the main policy experiments, and
contrasting them with the responses in the main text. For reasons of space, Table 8 reports a sub-
set of the moments, where the row numbers refer to the full table (see Table 3). The complete set
of moments for each of the exercises are available upon request.


H.1    Lower Risk Aversion
In the benchmark calibration, the coefficient of relative risk aversion is γ = 5. We study an alter-
native economy where γ = 2 and compare it to the benchmark economy. For this case (only), we
recalibrate the other parameters to match the model’s targets, in particular the average level of the
time discount factor β, to match average net worth/income, and its dispersion, to match the Gini
coefficient for net worth. This calibration matches the targets about equally well as the benchmark
calibration. We then compute the main experiments within this new economy.
    There are a few important differences in the benchmark model with γ = 2 compared to the
benchmark model with γ = 5. The home ownership rate in zone 1 is more than 10 percentage
points higher than in the γ = 5 case, while that of zone 2 is mostly unchanged. As a result,
the ownership rate wedge between zones decreases, a counterfactual implication which does not
occur for γ = 5. This is because average income of zone 1 and the share of top-productivity people
living in zone 1 are noticeably higher when γ = 2. Most importantly, a lower value for γ lowers
the value of insurance provided by affordable housing programs. The volatilities of marginal utility
growth of non-housing (0.26 vs. 0.45) and housing consumption (0.26 vs. 0.45) fall substantially,
as a result of the reduced curvature of the utility function.
    Turning to the economy’s response to the policy experiments, we generally find qualitatively
consistent but quantitatively smaller welfare changes. The combination policy of lowering the in-
come qualification threshold and abolishing incumbent priority still generates the largest welfare
gains. Expanding the scope of the affordable housing mandate and upzoning are about equally
welfare improving. The voucher experiment changes the most, from strongly welfare increasing
to mildly welfare decreasing. Starting off from a lower level of incompleteness and lower marginal
utility for low-productivity households, improving risk sharing opportunities is not as valuable
as in the γ = 5 world. However, the distortions engendered by the RC system and the taxes to
pay for the voucher expansion remain as large.


H.2    No Taste Shifter for Zone 1 Living
We solve a special case of the model where χ1 = χW = χ R = 1, so that there is no extra utility
from living in zone 1. All other parameters are the same as in the benchmark economy. We do
not recalibrate the model. Relative to our benchmark calibration, more households choose to live
in zone 1. This is because the cost of housing in zone 1 is about 40% lower as in the benchmark
calibration. Zone 1 residents tend to be younger, less productive, and poorer. Average income in
zone 1 is now substantially lower than in zone 2, with the magnitudes essentially reversed from
the benchmark calibration. There are a lot fewer retirees in zone 1 because luxury amenities were
key to attract them in the benchmark calibration. They do not work, and are no longer willing


                                                 75
to spend more on housing to live in zone 1 when χ1 = χ R = 1. The higher population share
of Manhattan is due to general equilibrium effects: zone 1 is less desirable, so housing becomes
cheaper, attracting more households. Because financial commuting costs represent a larger share
of poor households’ expenditures, more of those households choose to live in zone 1 to avoid those
costs. As a result, the spatial misallocation of labor increases, as nearly all of the top-productivity,
working-age households live in zone 2 and commute to zone 1 for work. Without extra ameni-
ties in zone 1, the location choice solely depends on purchasing power considerations; based on
comparing house prices, rents, commuting costs, and income. Thus, prices and rents induce more
low-productivity households to live in zone 1, and more high-productivity households to live in
zone 2. Because of its lower-income and lower-wealth residents, zone 1 now has a home owner-
ship rate that is 10% points lower than in our baseline calibration. Income inequality within zone
1 is dramatically lower; the earnings Gini is 0.17 compared to 0.46 in the baseline calibration. This
exercise underscores the importance of the amenity value of zone 1 in the baseline model.
     Next, we turn to the policy experiments. In the first three experiments, which improve the tar-
geting of RC, the gains are even larger than before. The population growth of zone 1 is larger and
so is the reduction in commuting time. Even more low-income households can live in zone 1 and
save the commuting cost. Access to insurance increases substantially. In the fourth experiment,
increasing the scope of RC has about the same welfare gain as in the model with amenity shifters.
The population of zone 1 now falls in response to the policy, while it rose in the baseline cali-
bration, but in both cases the population of zone 1 becomes poorer in response to the policy. The
upzoning policy in zone 1 naturally creates a smaller welfare gain in the absence of preferences for
living in zone 1 since upzoning not only creates better access to jobs for more households but also
enjoyment of city-center amenities for more households. Ignoring the amenity value of housing
in the city center leads to weaker welfare results. Finally, the voucher experiment creates much
smaller welfare gains than in the baseline calibration. The reason is that there is less (housing)
inequality, and therefore less benefit from redistribution.


H.3     No Luxury Taste Shifter for Manhattan
We now keep the overall taste shifter for zone 1, χ1 > 1, at its benchmark value, and set χ R =
χW = 1, so that there is no extra taste shifter for zone 1 for wealthy households (ct > c). In the
benchmark calibration, the luxury taste shifter for retirees χ R = 1.038 was substantially above 1
while that for workers χW = 1.004 was not.
    The main change compared to the original calibration is that there are very few retirees who
choose to live in zone 1 now. Because they do not work and face lower time and financial com-
muting costs, they do not value the time and financial savings of living close to work. The model
features a larger overall fraction of households live in zone 1 in equilibrium, like in Section H.2,
and dwellings that are even smaller in Manhattan relative to zone 2. Manhattan now contains
more young households and also significantly more working-age top-productivity households.
Put differently, the luxury taste shifter in the main text acts as a barrier to entry in the Manhattan
housing market for young, high-productivity households. Once the barrier removed, the spatial
misallocation of labor is lower than in the baseline calibration. Average income in Manhattan is
slightly lower than in the baseline calibration and so is income inequality between the two zones.
However, the reversal in the relative incomes of zone 1 and zone 2 we saw for the case with no
taste shifters is now gone. This shows that χ1 > 1 is crucial for generating higher average income
in zone 1, and that luxury taste shifters (esp. χ R ) mostly affect the fraction of wealthy retirees in
the city center. Price and rent per unit fall with the reduction in unit size, but the price and rent


                                                  76
per square foot as well as their ratio across zones are not affected. We also observe lower mobility
rates after initial location choices have been made because more young high-productivity people
already live in zone 1 rather than having to move there later once they have accumulated sufficient
wealth.
    Turning to the difference-in-difference results in Panel D of Table 8, we find that the first three
experiments that improve the targeting of RC have nearly the same effect as in the benchmark
model. Increasing the share of RC sqft by 50% also has nearly the same positive welfare effect as
in the benchmark calibration. One difference is that the population of zone 1 now falls rather than
rises because the size of a zone 1 market units becomes larger rather than smaller. This occurs
because the policy change triggers a smaller reduction in the average income of zone 1 residents.
There were already more low-income residents in Manhattan to start with in the model without
luxury taste shifters. The effects of upzoning in the urban core remain positive and of similar mag-
nitude. The absence of wealthy and/or old households who live in zone 1 for preference reasons
permits an increase of top-productivity households who move to zone 1 after the upzoning. The
voucher experiment has nearly unchanged welfare effects from those that start from the baseline
calibration.


H.4     No Discount Factor Heterogeneity
We now impose that all agents have the same discount factor, β H = β L , and recalibrate the average
β to keep the same net worth to income ratio as in the benchmark model. As a result, wealth
inequality is much lower (the Gini coefficient for net worth decreases from 0.80 to 0.60 in the
metro area), and so is inequality between zones (the ratio of zone 1 to zone 2 net worth decreases
from about 1.16 to 0.68). With less wealth inequality, the investment demand for housing from
the richest households falls. As a result, the price-to-rent ratios fall in both zones, and home
ownership rates are significantly higher than in the baseline calibration. The model has a slightly
larger share of households living in zone 1. The fraction of retirees is smaller, because there are
fewer high-wealth retirees for whom the luxury amenity value of living in the city center kicks in.
But there are also substantially fewer working-age, top-productivity households living in zone 1.
Thus, the spatial allocation of labor is worse than in the model with beta heterogeneity. The equal-
beta economy features somewhat better risk sharing than in our main model. With less wealth
inequality, there are fewer low-wealth, high-MU households with volatile MU growth. Finally,
the fraction of households in RC is much lower than in the baseline; access to RC insurance is
much lower. This occurs because RC tenants choose larger units, again reflecting the fact that
there are fewer low-wealth households in this economy.
     The equal-β economy’s reaction to the various experiments is qualitatively similar to that of
the heterogeneous-β economy. Quantitatively, the results are slightly weakened. Increasing the
generosity of affordable housing programs is less valuable in societies with lower wealth inequal-
ity.


H.5     Profit Redistribution
In the benchmark model, all profits from tradeable and construction firms left the city because
we assumed that their shareholders were outside the city. In reality, some goods firms and con-
struction firms may be locally owned. As a last robustness check, we assume that 50% of profits
are redistributed to local households. We assume that this profit redistribution occurs uniformly
across households and lump sum. This generates conservative estimates for the effects on wealth


                                                  77
inequality, as the empirical distribution of profit shares is likely to be right-skewed. All other
parameters are kept at the benchmark level.
    We find that zone 1 is smaller than in the benchmark and contains many more retirees. Wealth
inequality between zones increase. Essentially, there are more high-net-worth households in Man-
hattan, living in much larger apartments than before. House prices are much higher in both zones
but especially in zone 1. Zone 1 is less affordable as measured by price-income and rent-income
ratios, and there are substantially more rent-burdened households in this economy. More house-
holds crowd into much smaller RC units. The profit redistribution economy features less market
incompleteness, so that risk sharing is better than in our main model. The volatility of marginal
utility growth decreases because the profit income provides an extra buffer for households, mak-
ing it easier to smooth consumption.
    The economy’s reaction to the various experiments is qualitatively similar, except for the
vouchers experiment. Quantitatively, the results are similar to those in the equal-beta economy
which also featured less wealth inequality. The largest difference is for the voucher experiment,
where welfare increases by much less than in the baseline calibration and in the equal-beta cali-
bration. As for the other redistributive experiments, a larger voucher program has less value in
an economy where poor households have a lower marginal utility of consumption because they
are richer. Additionally, the distortions from progressive taxation of the voucher expansion are
larger. Because the redistributed profits increases the tax base, the progressive tax system now
hurts middle-income households more. Some households switch from receiving a transfer to pay-
ing a tax. Because those taxes make households poorer, they end up demanding less housing in
equilibrium.


I    Transitional Dynamics
Figure 11 plots the results from a transition experiment. For each policy change discussed in the
main text, we solve the following model. We start the model off in the benchmark economy B.
With some small probability (set to 1%), the economy transitions to the alternative economy (A)
which has undergone the policy change. With the same small probability it transitions back from
A to B at some future date. Agents in the model take into account the possibility of the policy
change; it is reflected in all their actions and in their value function. After having solved for policy
and value functions, we simulate the economy for 5,000 periods and 2,000 households. We select
all transitions where the economy switches from B to A. We then plot the change in value function
V ( A)/V ( B), expressed as a CEV. We average this change across all households in a group and
across all switches we observe in the simulation. The first four panels plot the change in value
function by age, productivity, income, and net worth. The identity of the households, who enters
in which group, is determined based on the value in the baseline economy B in the last period
before the switch. For example, we follow a group with the same households in the bottom of
the income distribution in the baseline economy. In the bottom left panel, we sort households into
market renters, owners, and RC renters, based on their status just prior to the policy change. We
note that it is possible that some policy may change the tenure status of a given household. If one
wants to understand how upzoning affects home owners, one needs to hold the identity fixed of
a group of households who were homeowners just prior to the policy change. The bottom right
panel plots house prices in zone 1 and zone 2, and rents in zone 1 and 2. Like value functions,
house prices are forward looking and their change in the first period of the transition reflects the
expected discounted present value of what happens in future periods.
     We note that upzoning reduces house prices. This affects homeowners; the more primary and

                                                  78
investment housing they own, the larger the hit their net worth takes. The average owner still
gains from upzoning (by a small amount), even after taking into account the house price. But
some owners lose. Also, not every income group gains. We conclude that the zoning experiment
is not quite a Pareto improvement.
    The second interesting take-away from the transitional graph is that households who are in RC
in the benchmark economy suffer from a policy that tightens income requirements with or without
re-qualification. This is the classic insider-outsider problem. The same is true for an expansion of
RC. Even though these policies increase access to RC insurance on average, the incumbents may
lose their access after the policy change.

                                                                Figure 11: Welfare in a Model with Transitions.
              Welfare Relative to Benchmark (%)




                                                  2                                                        4
                                                                                                                                                Inc. cutoff
                                                                                                                                                Inc. cutoff+re-qual.
                                                                                                                                                RC share
                                                  1                                                        2                                    Zoning Z1
                                                                                                                                                Vouchers



                                                  0                                                        0
                                                      30   40    50      60       70   80       90                 1          2          3                 4
                                                                      Age                                                  Productivity Level
                                                  2
                                                                                                           1
                                                  1                                                       0.5

                                                                                                           0
                                                  0
                                                       1         2            3             4                      1          2          3                 4
                                                                Income Quartile                                            Net Worth Quartile
                                                                                                           1
                                                  1

              0.5
                                                                                                           0
                                                  0

                                                                                                          -1
                                                      Renter          Owner            RC                       Price Z1   Price Z2   Rent Z1         Rent Z2



Notes: The baseline model has the following parameters: η 1 = 24.46, η 2 = 15.97, κ1 = 50%, κ2 = 0.40, κ3 = 0.35. Policy experiments,
each panel: decrease the RC income cutoff by 50%, enforce re-qualification for RC every period, both, increase share of RC sqft by 50%,
increase available Z1 sqft by 10%, housing vouchers. Top left panel: by age. Top right panel: by productivity level. Middle left panel:
by income quartile. Middle right panel: by net worth quartile. Bottom left panel: by tenure status. Bottom right panel: prices and
rents in each zone. The welfare changes are measured as consumption equivalent variations for an average household in each group.




                                                                                                     79
                  Table 8: Policy Experiments under Alternative Parametrizations

                                                   Bench.    Low κ2    Re-qual        Low κ2     RC share Zoning    Voucher
                                                                                     +re-qual.
                                                                          Panel A: Baseline Calibration
       31   Aggregate welfare change (CEV)            –       1.17%      1.66%        3.59%        0.66%  0.37%      1.04%
                                                                          Panel B: Lower Risk Aversion
       10   Frac. of population living in Z1 (%)     10.6     1.64%       3.56%        3.92%       4.99%   6.16%     -0.66%
       25   Total output                               –     0.02%       -0.22%       -0.05%      -0.04%  -0.02%     -0.67%
       26   Total commuting time across all hhs        –     -0.27%      -0.58%       -0.56%      -0.86%  -0.57%      0.22%
       27   Access to RC insurance (%)                5.5    54.01% 132.90%          179.29%      52.82%   0.50%     -3.49%
       28   Stability of RC insurance (%)            70.6     0.59%     -89.51%      -37.68%       0.73%   0.44%      0.64%
       29   Std. MU growth, nondurables              0.26     0.75%       1.08%        0.29%       0.83%  -0.10%     -1.81%
       30   Std. MU growth, housing                  0.26    -0.17%       7.47%       -1.31%       2.93%   0.30%     -0.82%
       31   Aggregate welfare change (CEV)             –      0.28%      0.13%        0.71%        0.27%  0.26%      -0.05%
                                                                    Panel C: No Taste Shifter for Manhattan
       10   Frac. of population living in Z1 (%)     14.4     2.20%       3.37%        6.71%      -2.86%   7.52%     -1.77%
       25   Total output                               –     0.01%       -0.23%       -0.09%      -0.06%  0.00%      -0.80%
       26   Total commuting time across all hhss       –     -0.39%      -0.72%       -1.15%       0.75%  -1.59%      0.30%
       27   Access to RC insurance (%)                5.6    53.00% 146.86%          191.51%      50.11%  -1.45%      3.90%
       28   Stability of RC insurance (%)            73.1     0.26%     -77.54%      -25.93%       0.14%  -0.05%     -0.39%
       29   Std. MU growth, nondurables              0.45    -0.52%      -1.33%       -3.85%       0.54%  -0.06%      0.33%
       30   Std. MU growth, housing                  0.41    -0.49%       0.93%       -4.27%       1.98%   0.03%      0.86%
       31   Aggregate welfare change (CEV)             –      1.41%      2.12%        4.78%        0.71%  0.24%      0.24%
                                                                Panel D: No Luxury Taste Shifter for Manhattan
       10   Frac. of population living in Z1 (%)     14.4    -0.15%       2.30%        2.47%      -1.30%   9.93%     -0.18%
       25   Total output                               –     0.08%       -0.21%       -0.06%      -0.08%  0.02%      -0.69%
       26   Total commuting time across all hhs        –     -0.09%      -0.52%       -0.46%       0.37%  -2.12%     -0.03%
       27   Access to RC insurance (%)                5.6    56.64% 145.07%          185.21%      54.53%   0.02%     -5.08%
       28   Stability of RC insurance (%)            72.5     0.22%     -79.20%      -31.87%        0.03    0.12       0.01
       29   Std. MU growth, nondurables              0.45     0.43%      -0.69%       -1.81%       0.76%  -0.13%     -1.33%
       30   Std. MU growth, housing                  0.49    -0.10%       0.84%       -2.43%       0.30%   0.36%     -1.00%
       31   Aggregate welfare change (CEV)             –      1.13%      1.55%        3.48%        0.72%  0.34%      1.04%
                                                                  Panel E: No Discount Factor Heterogeneity
       10   Frac. of population living in Z1 (%)     12.6     1.07%       1.78%        2.20%       1.34%   8.30%      3.57%
       25   Total output                               –     0.02%       -0.06%       -0.01%      -0.03%  0.00%      -0.51%
       26   Total commuting time across all hhs        –     -0.17%      -0.36%       -0.37%      -0.20%  -1.37%     -0.72%
       27   Access to RC insurance (%)                3.2    37.82% 140.22%          168.89%      47.31%   1.50%      0.53%
       28   Stability of RC insurance (%)            72.5     0.75%    -146.48% -108.24%           0.84%   0.33%      0.54%
       29   Std. MU growth, nondurables              0.40    -0.07%      -0.17%       -0.99%       0.41%  -0.20%     -1.63%
       30   Std. MU growth, housing                  0.42    -0.31%       1.52%        0.92%       0.29%   2.86%      4.50%
       31   Aggregate welfare change (CEV)             –      0.52%      0.74%        1.21%        0.44%  0.36%      0.82%
                                                                           Panel F: Profit Redistribution
       10   Frac. of population living in Z1 (%)      6.8     1.12%       1.71%        2.13%       4.18%   8.92%     -1.72%
       25   Total output                               –     0.09%       -0.21%        0.10%      -0.05%   0.01%     -0.65%
       26   Total commuting time across all hhs        –     -0.08%      -0.17%       -0.16%      -0.38%  -0.62%     0.00%
       27   Access to RC insurance (%)                8.4    78.53% 133.56%          176.89%      52.55%   1.75%     -0.73%
       28   Stability of RC insurance (%)            73.2     1.43%     -50.38%      -12.76%       0.65%   0.01%      0.30%
       29   Std. MU growth, nondurables              0.32    -0.92%      -2.44%       -4.48%       0.19%   0.10%     -1.03%
       30   Std. MU growth, housing                  0.39    -0.25%      10.31%       -0.55%       2.91%   0.56%     -0.49%
       31   Aggregate welfare change (CEV)             –      0.97%      0.46%        1.69%        0.24%  0.39%      0.19%


Notes: Panel A reports the aggregate welfare changes for the six main policy experiments under the benchmark calibration. They are
taken from Table 3. Panels B-F study the same policy experiments under different calibrations of the model, as described in Appendix
H




                                                                80
