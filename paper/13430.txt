                                NBER WORKING PAPER SERIES




                    LINEARITY-GENERATING PROCESSES:
         A MODELLING TOOL YIELDING CLOSED FORMS FOR ASSET PRICES

                                            Xavier Gabaix

                                        Working Paper 13430
                                http://www.nber.org/papers/w13430


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    September 2007




Konstantin Milbradt and Oleg Rytchkov provided very good research assistance. For helpful conversations,
I thank Marco Avellaneda, John Campbell, Peter Carr, Sylvain Champonnois, George Constantinides,
John Cox, Greg Duffee, Darrell Duffie, Pierre Collin-Dufresne, Alex Edmans, Ralph Koijen, Francis
Longstaff, Sydney Ludvigson, Antonio Mele, Lasse Pedersen, Monika Piazzesi, José Scheinkman,
Pietro Veronesi (a discussant), and seminar participants at Carnegie-Mellon, MIT, NYU, Princeton,
Urbana-Champaign, and the NBER. I thank the NSF for support. The views expressed herein are those
of the author(s) and do not necessarily reflect the views of the National Bureau of Economic Research.

© 2007 by Xavier Gabaix. All rights reserved. Short sections of text, not to exceed two paragraphs,
may be quoted without explicit permission provided that full credit, including © notice, is given to
the source.
Linearity-Generating Processes: A Modelling Tool Yielding Closed Forms for Asset Prices
Xavier Gabaix
NBER Working Paper No. 13430
September 2007
JEL No. E43,G12,G13

                                              ABSTRACT

This methodological paper presents a class of stochastic processes with appealing properties for theoretical
or empirical work in finance and macroeconomics, the "linearity-generating" class. Its key property
is that it yields simple exact closed-form expressions for stocks and bonds, with an arbitrary number
of factors. It operates in discrete and continuous time. It has a number of economic modeling applications.
These include macroeconomic situations with changing trend growth rates, or stochastic probability
of disaster, asset pricing with stochastic risk premia or stochastic dividend growth rates, and yield
curve analysis that allows flexibility and transparency. Many research questions may be addressed
more simply and in closed form by using the linearity-generating class.

Xavier Gabaix
New York University
Finance Department
Stern School of Business
44 West 4th Street, 9th floor
New York, NY 10012
and NBER
xgabaix@stern.nyu.edu
1     Introduction
This methodological paper defines and analyzes a class of stochastic processes that has a
number of attractive properties for economics and finance, the “linearity-generating” (LG)
processes. It is generates closed-form solutions for the prices of stocks and bonds. It is simple
and flexible, applies to an arbitrary number of factors with a rich correlation structure, and
works in discrete or continuous time. These features make it an easy-to-use tool for pure
and applied financial modelling.
    The main advantage of the LG class is that it generates, with very little eﬀort, tractable
multifactor stock and bond models, in a way that incorporates stochastic growth rates of
dividends, and a stochastic equity premium. Stock and bond prices are linear in the factors
— hence the name “linearity-generating” processes.
    Economically, a process is in the LG class if it satisfies two moment conditions: the
expected growth rate of the stochastic discount factor (multiplied by the dividend, if one
prices stocks), is linear in the factor. And, the expected growth rate of the stochastic
discount factor, times the vector of factors next period, is also linear in the factors (Eq. 9-
10). Given only those moments, one can price stocks and bonds (i.e., finite maturity claims
on dividends). Higher order moments do not matter. In many applications, the variance of
processes can be changed almost arbitrarily and the prices will not change. The fact that a
few moments are enough to derive prices makes modelling easier.
    Linearity-generating processes are meant to be a practical tool for several areas in eco-
nomics. They are likely to be useful in: macroeconomics, with models with stochastic trend
growth rate or probability of disaster; asset pricing, with models with stochastic equity
premium, interest rate, or earnings growth rate.
    Several literatures motivate the need for a tool such as the LG process. Many recent
studies investigate the importance of long-term risk for asset pricing and macroeconomics,
e.g., Bansal and Yaron (2004), Barro (2006), Croce, Lettau and Ludvigson (2006), Gabaix
and Laibson (2002), Hansen, Heaton and Li (2005), Hansen and Scheinkman (2006), Julliard
and Parker (2004), Lettau and Wachter (2007). The LG process oﬀers a way to model long-
term risk, while keeping a closed form for stock prices. In addition, there is debate about the
existence and mechanism of the time-varying expected stock market returns, e.g., Boudoukh

                                               2
et al. (forth.), Campbell and Shiller (1988), Cochrane (forth.) and many others. Because
of the lack of closed forms, the literature relies on simulations and approximations. The LG
process oﬀers closed forms for stocks with time-varying equity premium, which is useful for
thinking about those issues.
      The motivation for the LG class is inspired by the broad applicability and empirical
success of the aﬃne class identified by Duﬃe and Kan (1996), and further developed by
Dai and Singleton (2000) and Duﬃe, Pan and Singleton (2000), which includes the Vasicek
(1977) and the Cox, Ingersoll, Ross (1985) processes as special cases. Much theoretical and
empirical work is done with the aﬃne class. Some of this could be done with the LG class.
Section 6.2 develops the link between the LG class and the aﬃne class. The two classes
give the same quantitative answers to a first order. The main advantage of the LG class is
for stocks. The LG class gives a simple closed-form expression for stocks, whereas the aﬃne
class needs to express stocks as an infinite sum. Hence, while the aﬃne class can be expected
to be remain for long the central model for options and bonds, one can think that the LG
class may be a auxiliary technique for bonds, but will be particularly useful for stocks.
      Closed forms for stocks, or perpetuities, are not available with the current popular
processes, such as the aﬃne models those of Ornstein-Uhlenbeck / Vasicek (1977) and Cox,
Ingersoll, Ross (1985), or models in the aﬃne class (Duﬃe and Kan 1996). Those models
simply generate infinite sum of terms.
      Several papers have derived closed forms for stocks. Bakshi and Chen (1996) derive a
closed form, which is an exponential-aﬃne function of a square root process. Mamayski
(2002) derives another closed form, though in a non-stationary setting. Cochrane, Longstaﬀ
and Pedro Santa (forth.) contains nice closed form solutions. We confirm results from Mele
(2003, forth.), who obtains general results (particularly with one factor) for having bond and
stock prices that are convex, concave, or linear in the factors. LG processes satisfy Mele’s
conditions for linearity. Mele, however, did not derive the closed forms for stocks and bonds
in the linear case.
      Linear expressions are in Bhattacharya (1978), Menzly, Santos and Veronesi (2004), San-
tos and Veronesi (2006), Buraschi and Jiltsov (2007).1 Their process turns out to be to

  1
      It is indeed the Menzly, Santos and Veronesi (2004) paper that alerted me to the possibility of a class


                                                      3
belong to the LG class (see Example 10). Indeed, we show that if processes yield linear ex-
pressions for bond prices, they belong to the LG class. In view of those earlier findings, the
present paper does two things. First, it defines and analyzes the unified class that underlines
disparate results of the literature (as Duﬃe and Kan did for aﬃne processes). Second, it pro-
poses what appears to be some novel processes, such as those using the “linearity-generating
twist” (see Example 1, and many others).
    Finally, we contribute to the vast literature on interest rate processes, by presenting a
new, flexible process. The main advantage is probably that, because the LG processes are so
easy to analyze, they lend themselves easily to economic analysis. As a secondary advantage,
they naturally exhibit “unspanned volatility”. Using the LG class, Gabaix (2007) develops
a model of stocks and bonds, and Farhi and Gabaix (2007) a model of exchange rates and
the forward premium puzzle.
    This paper follows a productive literature that (proudly) reverse-engineers processes for
preferences and payoﬀs, e.g., Campbell and Cochrane (1999), Cox, Ingersoll, Ross (1985),
Pastor and Veronesi (2005), Ross (1978), Sims (1990), Liu (2007), and, particularly, Menzly,
Santos and Veronesi (2004). Indeed, the two LG moments conditions of Definition 1 gives a
recipe to “reverse-engineer” processes to ensure tractability.
    Section 2 is a gentle introduction to LG processes. Section 3 presents the discrete-time
version of the process, and contains the main results of the paper. Section 4 presents the
continuous-time version of the LG process. The next sections are less essential. Section 5
studies the range of admissible initial conditions. Section 6 presents some additional results.
Section 7 concludes.

with closed forms for stocks. On the economic side, this article originates from a lunch with Robert Barro,
who was expressing the desirability of a model with stochastic probability of disaster (Gabaix 2007). That
conversation made me search for tractable ways to address this question, and led me to LG processes.




                                                    4
2         A simple introduction to linearity-generating processes
To motivate LG processes, this section presents a very simple, almost trivial example — the
Gordon formula in discrete time.2 We want to calculate the price:
                                                 "∞            #
                                                  X Dt+s
                                         Pt = Et
                                                  s=0
                                                      (1 + r)s

of a stock with dividend growth:

                                           Dt+1
                                                = 1 + gt + εt+1                                             (1)
                                            Dt

where εt+1 has mean 0, and gt is the trend growth rate of the stock, and we want it to
be autocorrelated (the i.i.d. case is trivial). This is a prototypical example of stock with
stochastic trend growth. Even in this example, the usual processes for gt typically give
untractable expressions, as they yield infinite sums of exponential terms.
        Let us reverse engineer the process for gt , and see if the P/D ratio can have the form:

                                               Pt
                                                  = A + Bgt                                                 (2)
                                               Dt
                                                                                                  1
for some constants A and B. The arbitrage equation for the stock is Pt = Dt +                       E
                                                                                                 1+r t
                                                                                                         [Pt+1 ]
i.e.                                              ∙           ¸
                                    Pt      1       Dt+1 Pt+1
                                       =1+     Et               .                                           (3)
                                    Dt     1+r       Dt Dt+1
Plugging in (1) and (2), and assuming that E [εt+1 ] = Et [εt+1 gt+1 ] = 0, the arbitrage
equation reads:
                                            1
                         A + Bgt = 1 +         Et [(1 + gt ) (A + Bgt+1 )] , i.e.
                                           1+r
                                          A               B
                        A + Bgt = 1 +        (1 + gt ) +     (1 + gt ) Et [gt+1 ]                           (4)
                                         1+r             1+r

    2
     This example is so simple that it would not be surprising if it had already been done elsewhere, even
though I did not find it in the previous literature. However, it seems quite certain that the class of LG
processes (including the general structure with several factors, stocks bonds and continuous time), as a class,
is identified and analyzed in the present paper for the first time.



                                                      5
If gt is an AR(1), i.e. Et [gt+1 ] = ρgt , then (4) cannot hold: we have linear terms on the
left-hand side, and non-linear terms on the right-hand side.
   However, (4) can hold if we postulate that gt follows the following “twisted” AR(1), with
|ρ| < 1:
                                                                        ρgt
                           Linearity-generating twist: Et [gt+1 ] =                          (5)
                                                                       1 + gt
If gt is close to 0, then to a first order, Et [gt+1 ] ∼ ρgt , so that gt+1 behaves approximately
like an AR(1). It’s a twisted AR(1), because of the term 1 +gt in the denominator. However,
in many applications, gt will be within a few percentage points from 0, so materially, the
twist is small (more on this later). If (5) holds, then (4) reads:

                                                 A               B
                             A + Bgt = 1 +          (1 + gt ) +     ρgt
                                                1+r             1+r

which features only linear terms, and admits a solution. Indeed, we obtain A = 1+A/ (1 + r),
i.e. A = (1 + r) /r, and B = A/ (1 + r) + Bρ/ (1 + r), i.e. B = A/ (1 + r − ρ). Finally,
plugging those values of A and B back in (2) gives:
                                                 µ                 ¶
                                   Pt   1+r                gt
                                      =           1+                                         (6)
                                   Dt    r               r+1−ρ

We conclude that (6) solves (3). It is actually easy to show that the stock price satisfies (6).
                                                                 ³           ´
                                                                       1−ρT
By induction on T , one shows that for all T ≥ 0, Et [Dt+T ] = 1 + 1−ρ gt Dt , and direct
calculation yields (6).

Example 1 (Simple stock example with LG stochastic trend growth rate) Consider a stock
with dividend growth rate gt , with Dt+1 /Dt = 1 + gt + εt+1 ,where εt+1 has mean 0 and is
uncorrelated with gt+1 , with the linearity-generating “twist” for the growth rate:

                                                         ρgt
                                         Et [gt+1 ] =          ,                             (7)
                                                        1 + gt
                     "∞                     #
                      X                 s
with price Pt = Et         Dt+s / (1 + r) . Suppose that, with probability 1, ∀t, gt > −1. Then,
                     s=0




                                                   6
the price-dividend ratio, Pt /Dt is:
                                                  µ             ¶
                                    Pt   1+r                gt
                                       =           1+             .                                      (8)
                                    Dt    r               r+1−ρ

The rest of the paper develops this systematically.

       This example illustrates many general traits of LG processes.
       Eq. 7 imposes just one moment conditions. Higher order moments do not matter for the
price. For instance, we could have a complicated nonlinear function for the variance of the
growth rate, but it would not aﬀect the stock price. Likewise, the distribution of the noise
does not matter, so that one can have jumps and the like, without changing the price.
       We need restrictions on the domain of gt . Mostly obviously, one needs gt > −1. Actually,
the stronger condition gt > ρ − 1 is needed (section 21) gives gt > ρ − 1. In particular, the
                                                     3
variance has to go to 0 near that boundary.
       With the aﬃne models of Duﬃe and Kan (1996), we might model: Dt+1 /Dt = egt , gt+1 =
ρgt +εt+1 . That would lead to Et [Dt+T /Dt ] = ea(T )+b(T )gt , for some functions a (T ) , b (T ), and
         Pt
               P a(T )+b(T )gt
finally: D t
             =   e             (Burnside 1998, Ang and Liu 2004). We get a infinite sum over
maturities, rather than the compact expression (6). Hence, LG processes are particularly
tractable for stocks.
       The twisted process (7) is similar to an AR(1), Et gt+1 = ρgt , up to second order terms.
Hence, the behavior is likely to be close to an AR(1). To illustrate this, the Online Appendix
to this paper reports the simulation of the above example, with and without the twisted
terms. The values for the growth rates are quite close (within 0.1 standard deviation of each
other), and hard to distinguish visually. Likewise, the associated price-dividend ratios are
quite close, and despite compounding, so are the dividend processes. Of course, even if they
had been quite diﬀerent, this would not have been a important drawback for LG processes.
We do not want to say that the true model is an AR(1), that a LG process approximates. It
could as well be that the true model is a LG process, than an AR(1) model approximates.
Or rather, as a model is just approximation of a complex economic reality, the respective

   3
    The reason is that the function g 7→ ρg/ (1 + g) has two fixed points, 0 and ρ − 1, and the process needs
to stay on the right side of the repelling fixed point, ρ − 1.


                                                     7
advantage of LG vs aﬃne models depends on the specific task at hand. The modeler should
be able to pick whichever modelling approximation is most expedient, and LG processes oﬀer
one such choice.
        We now start our systematic treatment of LG processes. As several factors are needed
to capture the dynamics of stocks (Campbell and Shiller 1988, Fama and French 1996) and
bonds (Litterman and Scheinkman 1991), we study the multifactor case.



3         Linearity-generating processes in discrete time
This section studies the discrete-time LG processes. We want to price an asset with dividend
Dt , given a discount factor Mt .4 The"price at time t of
                                                       # a claim yielding a stochastic dividend
                                        X
                                        ∞
Dt+T at maturity T ≥ 0 is: Pt = E           Mt+T Dt+T /Mt . For instance, the price at t of a
                                                T =0
(“zero coupon”) bond yielding 1 in T periods is: Zt (T ) = Et [Mt+T ] /Mt .


3.1        Definition and main properties
The state vector is Xt ∈ Rn (n ∈ N∗ ) and can be generally thought of as stationary, while
Mt Dt generally trends, and is not stationary. The definition of the LG process is the follow-
ing.

Definition 1 The process Mt Dt (1, Xt0 )t=0,1,2,... , with Mt Dt ∈ R∗ and Xt ∈ Rn , is a linearity-
generating process if there are constants α ∈ R, γ, δ ∈ Rn , Γ ∈ Rn×n , such that the following
relations hold at all t ∈ N:
                                            ∙        ¸
                                           Mt+1 Dt+1
                                       Et              = α + δ 0 Xt                                         (9)
                                             Mt Dt
                                     ∙               ¸
                                       Mt+1 Dt+1
                                  Et             Xt+1 = γ + ΓXt                                            (10)
                                        Mt Dt

                                               −t                              P
    The simplest example is Mt = (1 + r) . If a consumer with utility t δ t U (Ct ) prices assets, then
    4

Mt = δ t U 0 (Ct ). Also, some authors call “stochastic discount factor” Mt+1 /Mt . In this context, there is no
confusion.




                                                       8
   To interpret (9), consider first the case of bonds, Dt ≡ 1. Eq. 9 says that the properly-
defined interest is linear in the factors. When Mt = (1 + r)−t , (9) says that expected dividend
growth is linear in the factors. In general, (9) means that the expected value of the (dividend
augmented) stochastic discount factor growth is linear in the factors.
   Condition (10) mean that, Xt follows “twisted” AR(1). It behaves in some sense like
                                                    Mt+1 Dt+1
Et [Xt+1 ] = γ + ΓXt , but it is twisted by the      Mt Dt
                                                                term. Another useful interpretation
of (10) is that it specifies the factor dynamics under the risk-neutral measure induced by
Mt Dt .
   What kinds of models are compatible with Definition 1? As the examples below show,
it is not diﬃcult to write toy economic models satisfying conditions (9)-(10), e.g. in Lucas
(1978) and Campbell-Cochrane (1999) economies with exogenous consumption, dividend or
marginal utility processes, or models with learning. Farhi and Gabaix (2007) and Gabaix
(2007) presents a fully worked-out economic model satisfying the conditions of Definition 1.
   Indeed, conditions (9)-(10) give a prescription to “reverse-engineer” macro or micro fun-
damentals, so as to make the model tractable: The modeler has to make sure that the
endowment, technology etc. is such that (9)-(10) hold.
   In addition, models that to not directly fit into the conditions of Definition 1, could be
approximated by projected linearly in (9)-(10). Also, by extending the state vector, equations
(9)-(10) could hold to an arbitrary degree of precision. The Online Appendix to this paper
illustrates how to approximate a non-LG process with an LG process, even to an arbitrary
degree of precision.
   There is a more compact way to think about LG processes. Define the (n + 1) × (n + 1)
matrix, which we will call the “generator” of the process:
                                            ⎛            ⎞
                                                  α δ0
                                       Ω=⎝               ⎠                                     (11)
                                                  γ Γ




                                                9
and the process with values in Rn+1
                                                                ⎛              ⎞
                                       ⎛               ⎞               Mt Dt
                                                    ⎜                          ⎟
                                               Mt Dt⎜ MDX                      ⎟
                                 Yt := ⎝          ⎠=⎜
                                                    ⎜
                                                       t t 1t                  ⎟
                                                                               ⎟,                 (12)
                                                    ⎜     ..                   ⎟
                                         Mt Dt Xt   ⎝      .                   ⎠
                                                      Mt Dt Xnt

so that with vector ν 0 = (1, 0, ..., 0),
                                                   Mt = ν 0 Yt                                    (13)

                                                                                        5
Yt stacks all the information relevant to the prices of the claims derived below.           Conditions
(9)-(10) can be written:
                                                Et [Yt+1 ] = ΩYt .                                (14)

Hence, the (dividend-augmented) stochastic discount factor of a LG process is simply the
projection (Eq. 13) of an autoregressive process, Yt . The tractability of LG processes comes
from the tractability of autoregressive processes.
       The basic pricing properties are the following two Theorems.

Theorem 1 (Bond prices, discrete time) The price-dividend ratio of a zero-coupon equity
or bond of maturity T , Zt (T ) = Et [Mt+T Dt+T ] / (Mt Dt ), is
                                                            ⎛          ⎞T ⎛         ⎞
                                           ³           ´        α δ0            1
                            Zt (T ) =          1 0n        ·⎝          ⎠ ·⎝         ⎠             (15)
                                                                γ Γ            Xt
                                                    αT In − ΓT
                                      = αT + δ 0               Xt when γ = 0                      (16)
                                                     αIn − Γ

where In the identity matrix of dimension n, and 0n is the row vector with n zeros.

       For instance, when Dt ≡ 1, the above Theorem can price bonds, with n factors, in closed
form.
       In many applications (e.g., the examples in this paper), γ = 0, which means the state
variables are re-centered around 0. For instance, the state variable is the deviation of the

   5
       Other assets, e.g. options, require of course to know more moments.

                                                           10
equity premium from its trend value.
       The second main result is the most useful property of LG processes: the existence of a
closed-form formula for stock prices.

Theorem 2 (Stock prices, discrete time) Suppose that all eigenvalues of Ω have a modulus
less than 1 (finiteness of the price). Then, the price-dividend ratio of the stock, Pt /Dt =
    P
Et [ ∞ s=t Ms Ds ] / (Mt Dt ), is:


                                          1           ¡                      ¢
                        Pt /Dt =               0  −1   1 + δ 0 (In − Γ)−1 Xt                                   (17)
                                1 − α − δ (In − Γ) γ
                                           ⎛        ⎛         ⎞⎞−1 ⎛          ⎞
                                ³       ´              α δ 0
                                                                          1
                              =   1 0n · ⎝In+1 − ⎝            ⎠⎠ · ⎝          ⎠.                               (18)
                                                       γ Γ                Xt

       Theorem 2 allows to generate stock prices with an arbitrary number of factors, including
time-varying growth rate, and risk premia.
       To make formulas concrete, consider the case where Γ is a diagonal matrix: Γ ≡ Diag (Γ1 , ..., Γn ),
i.e.                                           ⎛                        ⎞
                                                   α   δ1 · · ·    δn
                                            ⎜                         ⎟
                                            ⎜ γ Γ1            0    0⎟
                                            ⎜ 1                       ⎟
                                          Ω=⎜ .              ...      ⎟.
                                            ⎜ .. 0                 0⎟
                                            ⎝                         ⎠
                                             γn 0            0     Γn
          αT In+1 −ΓT
                                 ¡¡ T     ¢           ¢
Then,      αIn+1 −Γ
                        = Diag     α − ΓTi / (α − Γi ) ,6 so that (16) and (17) read:

                                                 Xn
                                                     αT − ΓTi
                              Zt (T ) = αT +                      δ i Xti if γ = 0                             (19)
                                                 i=1
                                                      α − Γ  i
                                                  Pn δi Xi
                                              1 + i=1 1−Γi
                                 Pt /Dt   =         P                                                          (20)
                                            1 − α − ni=1 1−Γ
                                                          δi γ i
                                                                i



Finally, the following Propositions show that one can price claims that have dividend a linear
function of Dt Xt . In bond applications, they show that futures price obtain in closed form.

   6
                                                                    P∞          n
                                                                                                   P∞
   If A matrix, and f : R → R, is analytic with f (x) =                 n=0 fn x    then f (A) =    n=0   fn An . If
A = Diag (a1 , .., an ), f (A) = Diag (f (a1 ) , ..., f (an ))


                                                        11
The proofs are exactly identical to those of the previous two Theorems.

Proposition 1 (Value of a single-maturity claim yielding Dt+T δ 0 Xt+T ). Given the LG
                                                                         X
                                                                         n
process Mt Dt (1, Xt ), the price of a claim yielding a dividend dt = Dt   fi Xit = Dt (f 0 Xt ),
                                                                              i=1
Pt = Et [Mt+T dt+T ] /Mt , is:
                                    ⎛ ⎞0 ⎛      ⎞T ⎛    ⎞
                                     0     α δ0      1
                             Pt   = ⎝ ⎠⎝        ⎠ ⎝     ⎠ Dt                                (21)
                                     f     γ Γ       Xt
                                  = f 0 ΓT Xt Dt when γ = 0.                                (22)


Proposition 2 (Value of an asset yielding Dt δ 0 Xt at each period) Under the conditions
                                                               X n
of Theorem 2, the price of a claim yielding a dividend dt = Dt      fi Xit = Dt f 0 Xt , Pt =
    P                                                           i=1
Et [ ∞
     s=t M D
          s s ] /Mt is,
       ⎛ ⎞0 ⎛      ⎛       ⎞⎞−1 ⎛ ⎞
                         0              0        −1
        0            α δ         1
  Pt = ⎝ ⎠ ⎝In+1 − ⎝       ⎠⎠ ⎝ ⎠ Dt = f (In − Γ) (γ + (1 − α) Xt ) Dt .                    (23)
        f            γ Γ         Xt       1 − a − δ 0 (In − Γ)−1 γ

   For instance, when Γ ≡ Diag (Γ1 , ..., Γn ), Eq. 22 and 23 read:

                                         X
                                         n
                             Pt /Dt =           fi ΓTi Xit Dt if γ = 0
                                          i=1
                                         X
                                         n
                                                 fi
                                                1−Γi
                                                       (γ i + (1 − α) Xit )
                                          i=1
                             Pt /Dt =                      Pn     δi γ i
                                                1−α−          i=1 1−Γi


3.2    Some examples
We now work out some examples. The derivations are in Appendix B.

Example 2 A Gordon growth formula with time-varying dividend growth.




                                                  12
   In this example, we generalize our introductory stock example. Suppose that the interest
rate is constant at r, dividend Dt , and the growth rate of dividend is:

                            Dt+1                      ¡          ¢
                                 = (1 + g∗ ) (1 + xt ) 1 + η t+1
                             Dt
                                     ρxt
                            xt+1 =         + εt+1                                           (24)
                                   1 + xt

where η t is some unimportant i.i.d. noise, greater than -1, independent of the innovation to
εt+1 . xt is the deviation from the trend growth rate. If xt was an AR(1), it would follow
Et [xt+1 ] = ρxt . Instead, the process is slightly modified, to (24), to make the process LG.
Indeed, with Mt = (1 + r)−t , and using the notation 1 + R = (1 + r) / (1 + g∗ ), we calculate
the two LG moments:
               ∙           ¸
                Mt+1 Dt+1
             Et              = (1 + xt ) / (1 + R)
                   Mt Dt
           ∙               ¸      ∙            ¸
             Mt+1 Dt+1              Mt+1 Dt+1                 (1 + xt ) ρxt    ρxt
        Et             xt+1 = Et                 Et [xt+1 ] =               =
               Mt Dt                 Mt Dt                     1 + R 1 + xt   1+R

In the above equation, the 1 + xt terms cancel out, because of the 1 + xt term in the
denominator of (24). We designed the  ⎛ process so that the LG equation
                                                                      ⎞ ⎛ (10) holds.⎞
                                         1/ (1 + R) 1/ (1 + R)                α δ0
    So Mt Dt (1, xt ) is LG, with Ω = ⎝                               ⎠=⎝            ⎠. Hence, we
                                                0        ρ/ (1 + R)           γ Γ
apply Theorem 2, with a dimension n = 1, γ = 0, α = 1/ (1 + R), δ = Γ = αρ. We obtain,
                                                         ¡                     ¢
for the price-dividend ratio, Pt /Dt = 1−α−δ0 (I1 −Γ)−1 γ 1 + δ 0 (In − Γ)−1 Xt , i.e.
                                               n


                                          µ            ¶
                                      1+R       1
                             Pt /Dt =      1+       xt                                      (25)
                                       R      1+R−ρ

   Hence we see how Example 1 comes from the general structure of LG processes.

Example 3 Stock price with stochastic growth rate and stochastic equity premium




                                               13
       Consider a dividend and discount factor process:

                                  Dt+1
                                       = 1 + gt + η t+1
                                   Dt
                                               Ã                         !
                                  Mt+1     1              πt
                                       =         1−       ¡      ¢ η t+1
                                  Mt     1+r          vart η t+1

so that gt is the stochastic trend growth rate of the dividend, and πt is a risk premium.7
Decompose gt into a fixed and a variable part, as in gt = g∗ +b                               bt ,
                                                              gt , do the same for πt = π ∗ + π
and postulate the following processes:

                                             1 + g∗ − π ∗
                                gt+1 = g∗ +               ρ (gt − g∗ ) + εgt+1
                                             1 + gt − π t g
                                             1 + g∗ − π∗
                               πt+1   = π∗ +              ρ (π t − π∗ ) + επt+1
                                             1 + gt − πt π

where at time t εgt+1 and επt+1 have expected values 0 and are uncorrelated with η t+1 .The
         (1+g∗ −π∗ )
term      1+gt −πt
                       will be close to 1 in many applications. Defining: α = (1 + g∗ − π ∗ ) / (1 + r),
the Gordon discount factor. Theorem 2 yields:
                                                      µ                     ¶
                                          1+r             gt − g∗   πt − π∗
                              Pt /Dt =                 1+         +                                  (26)
                                       r + π ∗ − g∗       1 − αρg 1 − αρπ

In the limit of small times, with ρg = 1 − φg , ρπ = 1 − φπ , with r and φ small (φg is the
speed of mean-reversion of g to its trend), we obtain:
                                   µ                    ¶
                                 1     gt − g∗ πt − π ∗
                        Pt /Dt =    1+        −           with R ≡ r + π ∗ − g∗                      (27)
                                 R     R + φg   R + φπ

This equation nests the three main sources of variations of stock prices in a simple and
natural way. Stock prices can increase because the level of dividends increases (that’s the Dt
terms), because the expected future growth rate of dividend increases (the gt − g∗ term), or
because the equity premium decreases (the π t −π ∗ terms). The two growth or discount factors
(gt and π t ) enter linearly, weighted by their duration (e.g., 1/ (R + φπ )), which depends on

   7
    The risk premium is on the innovations to dividends. One could also have a risk premium on the
innovation to dividend growth rate (as in Bansal and Yaron 2004), an exercise that we leave to the reader.


                                                       14
the speed of mean-reversion of the each process (parametrized by φπ , φg ), and the eﬀective
discount rate, R. The volatility terms do not enter in (27), and the price does not change if
one changes the correlation between the instantaneous innovation in gt and π t .

Example 4 A multifactor bond model with bond risk premia (in discrete time).

   There are n factors rit . The stochastic discount factor is:
                                                         Ã                    !
                                   Mt+1     1                    X
                                                                 n
                                        =                   1−          rjt                                (28)
                                   Mt     1 + r∗                 j=1

                                    h          i                P
                                        Mt+1
The short term rate is rt = 1/Et         Mt
                                                   − 1 ' r∗ +         rit if the r’s are small. Each factor rit
is postulated to evolve as:
                                                      ρi ri,t
                                     ri,t+1 =           P     + η i,t+1                                    (29)
                                                    1 − rjt
where Et η i,t+1 = 0, but the η i,t+1 can otherwise have any correlation structure. This is a LG
process. The bond price is:
                                                        Ã                               !
                                           1                    X
                                                                n
                                                                  1 − ρT      i
                             Zt (T ) =                    1−                      rit                      (30)
                                       (1 + r∗ )T               i=1
                                                                       1 − ρi

   This expression is quite simple, and accommodates a wide variety of specifications for
the factors, Eq. 29. Furthermore, it accommodates bonds with risk premia. Just take
                                         ³  Pn      ´
                              Mt+1    1
a stochastic discount factor: Mt = 1+r∗ 1 − j=1 rjt + εt+1 , where Et εt+1 = 0, but
                                                                                                      ρr
otherwise εt+1 is unspecified, and can be heteroskedastic. and postulate: ri,t+1 = 1−iSi,trjt +
          Et [εt+1 ·ηi,t+1 ]
η i,t+1 − Et [Mt+1 /M    t]
                             , which means that rit follow the process (29) under the risk-neutral
measure. Then, Eq. 30 holds. The risk premium on the T maturity bond is:

                                                              P 1−ρTi −1    ¡               ¢
                        cov (εt+1 , Zt+1 (T − 1))   (1 + r∗ )    1−ρi
                                                                         cov εt+1 , η i,t+1
         Risk premium =                           =               P 1−ρTi
                                 Zt (T )                       1−            r
                                                                         1−ρ it             i


                                                                                   ¡              ¢
   Hence we easily generate an explicit yield curve. With a parametrization for cov εt+1 , η i,t+1 ,
the above expression makes predictions for bond risk premia across maturities (see Gabaix
2007).

                                                       15
Example 5 Markov chains, and some economies with learning

      There are n states. In state i the factor-augmented dividend grows at a rate Gi : Mt+1 Dt+1 / (Mt Dt ) =
Gi . Call Xit ∈ {0, 1}, equal to 1 if the state is i, 0 otherwise. The probability of going from
state j to state i is called pij . Then, Mt Dt (1, X1 , ..., Xn ) is a LG process. Hence, a Markov
chain belongs to the LG class.8 As many processes are (arbitrarily) well-approximated by
discrete Markov chains, they are (arbitrarily) well-approximated by LG processes.
      Markov chains induced by learning naturally lead to LG processes. For a complete
example, the reader is encouraged to read Veronesi (2005). He finds that if Xit is the agents’
probability estimate that the economy is in state i, under canonical models with Gaussian
filtration of information, then vector Xt follows an autoregressive process. He works out
the prices of stocks and bonds in an economy, and finds that they are linear function of Xt .
Hence, some canonical structural with learning models naturally give rise to LG processes.

Example 6 Flexible LG parametrization of state variables the stochastic discount factor

      Take an n−dimensional process Xt , such that:

                         Mt+1 Dt+1
                                   = a + β 0 Xt + εt+1
                          Mt Dt
                                                             £          ¤
                                     γ + ΓXt              Et εt+1 η t+1
                              Xt+1 =            + η t+1 −                                        (31)
                                     a + β 0 Xt             a + β 0 Xt
                       £     ¤
with Et [εt+1 ] = 0, Et η t+1 = 0. Then, Eq. 9-10 are satisfied. Section 5 provides conditions
to ensure Mt Dt > 0 for all times.
                                                 £          ¤
      To interpret (31), consider the case γ = Et εt+1 η t+1 = 0. Eq. 31 expresses that, when
                             ΓXt
Xt is small, Et [Xt+1 ] =   a+β 0 Xt
                                       ∼ Γa xt , which means that Xt follows approximately at AR(1).
The corrective 1 + β 0 /a · Xt in the denominator is often small in practice, but ensures that
the process is LG.
                                                                                   £          ¤
      In many applications, there is no risk premium on the factor risk, so that Et εt+1 η t+1 =
0. However, when there is a risk-premium equation (31) means that it is enough to know
that the process under the “risk-neutral” measure.

  8
    Veronesi and Yared (2000) and David and Veronesi (2006) have already seen that this type of Markov
chain yielded prices that are linear in the factors.

                                                    16
    We next turn to the continuous time version of what we have seen so far.



4     Linearity-generating processes in continuous time
                          ¡         ¢
We fix a probability space ΩP , F, P and an information filtration Ft satisfying the usual
technical conditions (see, for example, Karatzas and Shreve 1991). The stochastic discount
factor is Mt . For applications, we will express the results in terms of a dividend-augmented
stochastic discount factor, Mt Dt . Often, it is better to imagine Dt ≡ 1.


4.1    Definition and main properties
A notation. The following notation is useful when using LG processes. For xt , μt processes
in a vector space V , we say Et [dxt ] = μt dt, or Et [dxt ] /dt = μt , to signify that there exists
                                                             Rt
a martingale Nt with values in V such that: xt = x0 + 0 μs ds + Nt .
    The definition in continuous time is analogous to the definition in discrete time. The
vector of factors is Xt .

Definition 2 The process Mt Dt (1, Xt )0t∈R+ , with Mt Dt ∈ R and Xt ∈ Rn , is a linearity-
generating process if there are constants with a ∈ R, b, β ∈ Rn , Φ ∈ Rn×n , such that the
following relations hold at all t ∈ R+ ,


                              Et [d (Mt Dt )] = − (a + β 0 Xt ) Mt Dt dt                       (32)
                            Et [d (Mt Dt Xt )] = − (b + ΦXt ) Mt Dt dt                         (33)


    The interpretation is exactly the same as for Definition 1. Eq. 32 means that the expected
growth rate of Mt Dt is linear in the factors. Eq. 33 means that Xt follows a twisted AR(1).
Loosely speaking, it describes the process for Xt under the “risk-neutral” measure induced
by Mt Dt .
    For instance, in the case Dt ≡ 1 and dMt /Mt = − (a + β 0 Xt ) dt, Eq. 33 gives:


                       dXt = −bdt − (Φ − aIn ) Xt dt + (β 0 Xt ) Xt dt + dNt                   (34)



                                                17
where Nt ∈ Rn is a martingale. Hence, the process contains an AR(1) term, −b−(Φ − aIn ) Xt ,
plus a “twist” quadratic term, (β 0 Xt ) Xt . It is a “twisted” AR(1). In many applications, Xt
represents a small deviation from trend, and the quadratic term (β 0 Xt ) Xt is small. We are
agnostic about how empirically relevant the “twist” is. It could be that it is absent in the
physical probability, but present under the risk-neutral measure.
   So Et [dNt ] = 0, but its components dNit , dNjt can be correlated. The simplest type of
martingale is dNt = σ (Xt ) dBt , for Bt a Brownian motion, but richer structures, e.g. with
jumps, are allowed. As in the one-factor process, the volatility of dNt must go to zero in
some limit regions for the process to be well-defined. We defer this more technical issue until
section 5.
   As in the discrete-time case, we define the “generator” of the process:
                                            ⎛         ⎞
                                                α β
                                        ω=⎝           ⎠                                   (35)
                                                b Φ

                        ⎛           ⎞
                            Mt Dt
and the process Yt = ⎝              ⎠ ∈ Rn+1 , as in (12), which encodes the information
                          Mt Dt Xt
needed for prices. Conditions (32)-(33) write more compactly as:


                                     Et [dYt ] = −ωYt dt.                                 (36)


which is the analogue of (14). The above process leads to a LG discrete-time process with
time increments ∆t, with a generator Ω = e−ω∆t .
   Hence, there is a (n + 1) dimensional process Yt , and a vector ν 0 = (1, 0, ..., 0), such
that (36) holds, and Mt = ν 0 Yt . In other terms, there is a autoregressive process Yt in
the background, following (36). The (dividend-augmented) stochastic discount factor is the
one-dimensional projection of it. LG processes are tractable, because they are the one-
dimensional projection of an AR(1) process.
   The next Theorem prices claims of finite maturity.

Theorem 3 (Bond prices, continuous time). The price-dividend of a claim on a dividend


                                                18
of maturity T , Zt (T ) = Et [Mt+T Dt+T ] / (Mt Dt ), is:
                                                             ⎡ ⎛                ⎞ ⎤ ⎛          ⎞
                                       ³          ´                      a β0             1
                     Zt (T ) =             1 0n       · exp ⎣− ⎝                ⎠T⎦ · ⎝        ⎠   (37)
                                                                         b Φ              Xt
                                                   e−ΦT − e−aT In
                                 = e−aT + β 0                     Xt when b = 0                    (38)
                                                      Φ − aIn

where In the identity matrix of dimension n, and 0n is the row vector with n zeros.

    As an example, bond prices come from Dt = 1. In many applications, b = 0, which can
generically be obtained by re-centering the variables.
    Theorem 4 is probably the most useful of this section.

Theorem 4 (Stock prices, continuous time). Suppose that all eigenvalues of ω have pos-
itive real part (finite stock price). Then, the price/dividend ratio of the stock, Pt /Dt =
    £R ∞         ¤
Et t Ms Ds ds / (Mt Dt ) , is:

                                         1 − β 0 Φ−1 Xt
                              Pt /Dt   =                                                           (39)
                                          a − β 0 Φ−1 b
                                                       ⎛       ⎞−1 ⎛    ⎞
                                         ³         ´     a β 0
                                                                     1
                                       =   1 0n · ⎝            ⎠ ·⎝     ⎠                          (40)
                                                         b Φ         Xt

    To make things more concrete, consider the case where Φ is a diagonal matrix: Φ =
Diag (Φ1 , ..., Φn ), i.e.:                       ⎛                            ⎞
                                                      a     β1 · · ·      βn
                                              ⎜                              ⎟
                                              ⎜b1 Φ1                0     0⎟
                                              ⎜                              ⎟
                                            ω=⎜.                   ...       ⎟                     (41)
                                              ⎜ .. 0                      0⎟
                                              ⎝                              ⎠
                                               bn 0                0      Φn
                 ¡      ¢
Then, e−ΦT = Diag e−Φi T , and then (16) and (17) read:

                                                    Xn
                                                        e−Φi T − e−aT
                                            −at
                          Zt (T ) = e             +                   β i Xit if b = 0             (42)
                                                    i=1
                                                            Φi − a
                                                  Pn β i Xit
                                            1−        i=1  Φi
                          Pt /Dt =                Pn      β i bi
                                                                                                   (43)
                                            a−        i=1 Φi


                                                            19
   Finally, the following Propositions show that one can price claims that have dividend
a linear function of Dt Xt . The proofs are exactly identical to those of the previous two
Theorems.

Proposition 3 (Value of a single-maturity claim yielding Dt+T f 0 Xt+T ). Given the LG
                                                                         X
                                                                         n
process Mt Dt (1, Xt ), the price of a claim yielding a dividend dt = Dt   fi Xit = Dt (f 0 Xt ),
                                                                          i=1
Pt = Et [Mt+T dt+T ] /Mt , is:
                             ⎛ ⎞0      ⎡ ⎛        ⎞ ⎤ ⎛      ⎞
                                                0
                              0             a β           1
                      Pt   = ⎝ ⎠ · exp ⎣− ⎝       ⎠T⎦ · ⎝    ⎠ Dt                             (44)
                              f             b Φ           Xt
                           = f 0 e−ΦT Dt Xt when b = 0.                                       (45)


Proposition 4 (Value of an asset yielding Dt f 0 Xt at each period) Under the conditions
                                                               X n
of Theorem 4, the price of a claim yielding a dividend dt = Dt      fi Xit = Dt f 0 Xt , Pt =
   £R ∞      ¤                                                  i=1
Et t Ms ds ds /Mt , is,
                            ⎛ ⎞0     ⎛ ⎞
                             0        1       f 0 Φ−1 (−b + aXt )
                       Pt = ⎝ ⎠ ω −1 ⎝ ⎠ Dt =                     Dt .                        (46)
                             f        Xt           a − β 0 Φ−1 b


4.2    Some examples
We start with some stock-like examples.

Example 7 Simple stock example with LG stochastic trend growth rate, in continuous time
                                                                                     ³R          ´
                                                                                        T
   We study Example 1 in continuous time. Suppose MT = e−rT , DT = D0 exp               0
                                                                                            gt dt ,
with the continuous time limit of (5):

                                      ¡          ¢
                                 dgt = −φgt − gt2 dt + σ (gt ) dzt                            (47)




                                                20
In the equation above, the coeﬃcient on gt2 has to be −1. Theorem 4 yields:9
                                                    µ       ¶
                                                  1      gt
                                         Pt /Dt =    1+       .                                             (48)
                                                  r     r+φ

Section 5 will present the condition gt ≥ −φ for the process to be well defined. We next
generalize the example to n factors.

Example 8 Dividend growth rate as a sum of mean-reverting processes (e.g., a slow and a
fast process).

   We extend the previous example to a several factors. Suppose MT = e−rT , DT =
      ³R      ´                P
         T
D0 exp 0 gt dt , with gt = g∗ + ni=1 Xit and


                                Et [dXit ] /dt = −φi Xit + (g∗ − gt ) Xit dt.


The growth rate gt is a steady state value g∗ , plus the sum of mean-reverting processes Xit .
Each Xit mean-reverts with speed φi , and also has the quadratic perturbation (g∗ − gt ) Xit dt.
The price-dividend ratio is
                                                    Ã                            !
                                           1                 X
                                                             n
                                                                       Xit
                                Pt /Dt =              1+                             .                      (49)
                                         r − g∗              i=1
                                                                   r − g∗ + φi

Each component Xit perturbs the baseline Gordon expression 1/ (r − g∗ ). The perturbation
is Xit , times the duration of Xi , discounted at rate r−g∗ , which is the term 1/ (r − g∗ + φi ).10

   9
      The result in Example 7 appear new to the literature. The Fisher-Wright process does contain a quadratic
term, but it has not been applied to the pricing bonds or stocks. Also, it is more special than the LG class,
because it imposes a specific functional form on the variance. Cochrane, Longstaﬀ, and Santa-Clara (forth.)
apply the Fisher-Wright process. Mele (2003, forth.) identifies a condition for the process to be linear in the
factor, but does not derive stocks and bond prices such as (48). Other papers introduce diﬀerent quadratic
terms in stochastic process, for instance Ahn et al. (2002), and Constantidines (1992) but they do not take
the form of this paper.
   10
      The formula suggests the following non-LG variant. Suppose we have a process with dψ t =
(rt ψ t + αrt − β) dt+dNt ,where dNt is an adapted martingale, and is essentially arbitrary except for technical
conditions. Then Vt = (ψ t + α) /β is a solution of the perpetuity arbitrage equation: 1−rt Vht +E [dVt ] /dt = 0.
                                                                                                                i
                                                                                               R ∞ Us
If the process well-defined for t ≥ 0, then Vt is the price of a perpetuity, Vt = Et t e− t ru du ds .
For instance, with the process d (1/rt ) = φ (rt − r∗ ) dt + dNt , the price of a perpetuity is: Vt =
(1/rt + φ/r∗ ) / (1 + φ).

                                                        21
Terms that mean-revert more slowly have a higher impact on the the price. Finally, Theorem
3 yields:                                      Ã                       !
                                                     X
                                                     n
                                                       1 − e−φi T
                          Et [Dt+T ] = eg∗ T    1+                  Xit Dt .
                                                     i=1
                                                              φi

Example 9 Generalized Gordon formula, with stochastic trend in dividend growth, and sto-
chastic equity premium, in continuous time.

       We present the continuous time version of Example 3. The stochastic discount factor Mt
and the dividend process Dt follow

                                              πt
                       dMt /Mt = −rdt −          dzt and dDt /Dt = gt dt + σdzt
                                              σ
                                      £R ∞           ¤
The price of the stock is Pt = Et       t
                                             Ms Ds ds /Mt . π t is a the stochastic equity premium,
and gt is the stochastic growth rate of dividends.
       We assume that π t and gt follow the following LG process, best expressed in terms of
                            bt = π t − π ∗ , b
their deviation from trend, π                gt = gt − g∗ :


                        gt = −φg b
                       db                 πt − b
                                 gt dt + (b    gt ) b
                                                    gt dt + σ γ (b    bt ) · dBt
                                                                 gt , π
                                  bt dt + (b
                        π t = −φπ π
                       db                  πt − gbt ) π
                                                      bt dt + σ π (b    bt ) · dWt
                                                                   gt , π


where the (Bt , Wt ) is a Wiener process independent of zt , that can have arbitrary time- or
state-dependent correlations, and σ γ and σ π are vector-valued processes. We suppose that
the process is defined in [t, ∞). Again the processes db
                                                       gt and db
                                                               π t are to a first order linear,
                                         πt − b
but with quadratic “twist” terms added, (b    gt ) gbt dt and (b
                                                               π t − gbt ) π
                                                                           bt dt. The stock price is
                              µ                    ¶
                         Dt       gt − g∗ πt − π ∗
                    Pt =       1+        −           with R ≡ r + π∗ − g∗                        (50)
                         R        R + φg   R + φπ

where R is the traditional Gordon rate.11 As in Example 3, this example nests the three
sources of variation in prices, movements in dividends (Dt ), in expected growth rate of
dividends (gt ), and of discount factor (π t ).

  11
    It is a good and simple exercise to derive the above formula directly, from the arbitrage equation
1 − (r + π t − gt ) (P/D)t + E [d (P/D)t ] /dt = 0.

                                                   22
Example 10 The aggregate model of Menzly, Santos and Veronesi (2004), and the Bhat-
tacharya (1978) mean-reverting process, belong to the linearity-generating class.

      The following point is simple and formal. Menzly, Santos and Veronesi (MSV, 2004)
rely on an Ornstein-Uhlenbeck. The inverse of their consumption-surplus ratio, yt , follows:
                                                                                        £R ∞           ¤
Et [dyt ] = k (y − yt ) dt. The price-consumption ratio in their economy is Vt = yt−1 Et 0 e−ρs yt+s ds .
In terms of the LG process, the state variable is yt , and Mt = e−ρt . We have Et [dMt /dt] /Mt =
−ρdt, and⎛Et [d (Mt yt ) /dt]⎞/Mt = −ρyt + k (y − yt ). So Mt (1, yt ) is a LG process with gener-
                  ρ       0
ator ω = ⎝                   ⎠. The MSV pricing equation 17 comes directly from Proposition
             −kY ρ + k
4 of the present article, yt Vt = (ky + ρyt ) / [ρ (ρ + k)]. Hence, in retrospect, the MSV (2004)
process is tractable because it belongs to the LG class. This remark, also, immediately
suggest a way to formulate the MSV paper to discrete time. In a simpler context, Bhat-
tacharya (1978) models the dividend yt as an Ornstein-Uhlenbeck, yielding the same closed
form solution for the price.

Example 11 A LG process where the stock price is convex (not linear) in the growth rate
of dividends

      This “academic” example shows how one can obtain asset prices that are increasing in
their variance, which is important in some applications (Johnson 2002, Pastor and Veronesi
2003). Consider an economy with constant discount rate r (i.e. Mt = e−rt ), and a stock with
                      ³R    ´                                      p
                         t
dividend Dt = D0 exp 0 gs ds , where12 dgt = − (gt2 /2 + φgt ) dt + k (G2 − g2 )dzt . Then,
the price-dividend ratio is:

                                   2(φ + r)(2φ + k + r) + 2(2φ + k + r)gt + gt2
                        Pt /Dt =                                                                        (51)
                                          2r (φ + r) (2φ + k + r) − kG2

which is increasing in the parameter G of the volatility. In this example, the state vector
is (gt , gt2 ), which makes the price quadratic and convex in gt . More generally, by expanding
the state vector, the price could be a polynomial of arbitrary order in g.
      We next present some bond-like examples. We start with a very simple example.

 12
      We assume 0 < G < 2 (φ − k), and that the support of gt is (−G, G), with end points natural boundaries.

                                                      23
Example 12 A one-factor bond model, with an always positive nominal rate.

   The following example is simply illustrates LG processes. It has just one factor, whereas
                                                                                ³ R       ´
                                                                                     t
multifactor models are necessary to capture the yield curve. Suppose Mt = exp − 0 rs ds ,
with rt = r∗ + rbt , with
                                   rt = − (φ − rbt ) rbt dt + dNt
                                  db

where φ > 0, rbt ≤ φ, and Nt is a martingale, which could include a diﬀusive part and a jump
part. The bond price is:                         µ               ¶
                                         −r∗ T       e−φT − 1
                              Zt (T ) = e         1+          rbt .                         (52)
                                                        φ
   The independence of bond prices from volatility greatly simplifies the analysis. In par-
ticular, dNt could have jumps, which model a decision by the central bank, or fat-tailed
innovations of other kinds (Gabaix et al. 2006). One does not need to specify the volatility
process to obtain the prices of bonds: only the drift part is necessary. This leaves a high
margin of flexibility to calibrate volatility, for instance on interest rate derivatives, a topic
we do not pursue here.
   How can we ensure that the interest rate always remains positive? That is very easy
(with r∗ > 0). For instance, we could have dNt = σ (rt ) dzt , where zt is a Brownian process,
                   0
with σ (r) ∼ k0 rκ , κ0 > 1/2 for r in a right neighborhood of 0, and k0 > 0, so that the
local drift at rt = 0 is positive. By the usual Feller conditions on natural boundaries, the
process admits a strong solution, and rt ≥ 0 always (Cheridito and Gabaix 2007 spell out
the technical conditions). And, the bond price (52) is not changed by this assumption about
the volatility process. One can indeed change the lower bound for the process (if it is less
than r∗ ) without changing the bond price.
   Section 5 will detail the conditions for the existence of the process. The interest rate
needs to remains below some upper bound r ∈ (r∗ , r∗ + φ], so as to not explode. One way is
to assume that σ (r) ∼ k (r − r)κ , for r in a left neighborhood of r, κ > 1/2 and k > 0. Given
the drift is negative around r, that will ensure that r is a natural boundary, and {∀t, rt ≤ r}
almost surely, as detailed in Cheridito and Gabaix (2007). We next turn to the canonical
LG bond case.

Example 13 A multifactor bond model, with bond risk premia (continuous time).

                                                  24
   The following is Example 4 in continuous time. Suppose dMt /Mt = −rt dt + dNt , where
                                                             P
Nt is a martingale, and decompose the short rate in rt = r∗ + ni=1 rit , with r∗ a constant
and:
                       Et [drit ] + hdrit , dMt /Mt i = [−φi rit + (rt − r∗ ) rit ] dt                          (53)

where we use the notation hdxt , dyt i is the usual bracket, e.g. hσ 1 · dBt , σ 2 · dBt i = σ 1 · σ 2
dt.
      Hence, it is enough to specify the process “under the risk-neutral measure”. One does not
need to separately specify the dynamics of Et [drit ] and its risk premium, the hdrit , dMt /Mt i
term. Only the sum matters. The process Mt (1, r1t , ..., rnt ) is LG13 , and the bond price is
                                                    Ã                           !
                                                               X
                                                               n
                                                                 1 − e−φi T
                                 Zt (T ) = e−r∗ T       1−                    rit .                             (54)
                                                                i=1
                                                                      φi

                                                                                      D                  E
                                                                                          dZt (T ) dMt
      The risk-premium at t on the T −maturity zero coupon, π (T ) := −                     Zt
                                                                                                  , Mt       /dt can
be simply expressed too.

Example 14 Lucas economy where stocks, bonds, and a continuum of moments can be
calculated.
                                                                  ¡ C¢
   We consider a Lucas economy with: dC      t
                                               = gt dt+dNt
                                                          C
                                                            , var  dNt = σ 2 dt, dgt = −φgt dt+
      D           E                        Ct
dNtg , dgt , dC
              Ct
                t
                    = −gt (gt − A) dt, with A > 0, and Ntg , NtC are martingales, and gt ≤ A.
Then:                                                   µ                     ¶
                                 £ α ¤               2
                                          α α(α−1) σ2 t     1 − e−(φ−αA)T
               ∀α ≤ 0, ∀T ≥ 0, Et Ct+T = Ct e            1+               αgt                                   (55)
                                                              (φ − αA)
              σ2
The eα(α−1)      t
              term is the expected Jensen’s inequality term. The novel term is the gt term.
               2
                                   R
This way, if the agent has utility e−ρt Ct1−γ / (1 − γ) dt, one can calculate all the bonds
prices in a Lucas economy, and the price of a claim on consumption.
                         ⎛                                 ⎞
                            r∗       1     ···      1
                          ⎜0      r + φ1    0       0      ⎟
  13                      ⎜                                ⎟
     The generator is ω = ⎜                ..              ⎟.
                          ⎝0        0         .      0     ⎠
                            0       0       0     r + φn




                                                         25
5     Conditions to keep the process well-defined
The results of this paper require that the process be defined for t ≥ 0, and in particular
that Mt Dt > 0, which ensures the above-derived prices are positive. This section provide
simple suﬃcient conditions to ensure that. They are meant to be practical and easy to verify.
Cheridito and Gabaix (2007) provide more abstract and general conditions.


5.1    Discrete time
                                                                                    ρg +σ(g )η
We start with Example 1. We want the process to be well-defined. Write gt+1 = t 1+gtt t+1 ,
       £     ¤
with Et η t+1 = 0 and σ (gt ) ≥ 0. First, take the case where there is no noise, ∀t, η t+1 = 0.
The application g 7→ ρg/ (1 + g) has two fixed points, an attractive one g = 0, and a repelling
one that, g = ρ − 1. To ensure that the process is economically meaningful, we require that
g0 be on the right side of the repelling point, g0 > ρ − 1. That will ensure (when there is no
noise) that for all t ≥ 0, gt > ρ − 1, and in particular gt > −1. If g0 < ρ − 1, then for some
time t, gt < −1, not a meaningful economic outcome. In conclusion, in the deterministic
growth rate case, we want to impose


                                        gt > g = ρ − 1.                                      (56)


    When the growth rate is stochastic, we want that for all gt+1 > ρ−1, i.e. gt +σ (gt ) η t+1 >
g. This is possible if η t+1 has a lower bound, and the volatility σ (g) goes to 0 fast enough
near the boundary g, a fact formalized in the next Lemma.

Lemma 1 (Conditions of existence of the process in the 1-dimensional, discrete time case).
                                          g +σ(g )η             £     ¤
Consider the process in Example 1: gt+1 = t 1+gt t t+1 , with Et η t+1 = 0. Assume that (i)
                                                                                             g−g
there is an m > 0 such that, almost surely, for all t, η t+1 > −m ; and (ii) 0 ≤ σ (g) ≤      m
                                                                                                 ,
i.e. the volatility goes to 0 fast enough close to g = ρ − 1. Suppose g0 > g. Then, almost
surely, for all t ≥ 0, gt > g, and the process is defined for all times t.

    The principle generalizes to several factors. Consider the discrete-time case where the




                                               26
generator Ω is of the form (??), with α > 0 and α > Γi for all i, and γ = 0.14 Parametrize
the noise in (14) by Yt+1 = ΩYt + Yt0 ut+1 , where Et [ut+1 ] = 0. The n−factor generalization
of the criterion (56) above is the following:

Proposition 5 (Condition to ensure a well-behaved process, with positive stochastic discount
factor, discrete time) Suppose that M0 D0 > 0, and that at t = 0, X0 satisfies:

                                                                 X
                                                                 n
                                                                   min (δ i Xit /α, 0)
                Condition C at time t (discrete time): 1 +                               >0            (57)
                                                                 i=1
                                                                          1 − Γi /α

Suppose also that the noise ut+1 is bounded and goes to 0 fast enough near the boundary of
(57). Then, for all times t ≥ 0, Mt Dt > 0, so that the process is well-defined, and prices
Et [Mt+T Dt+T ] are positive. In addition, for all times t, Xt satisfies the condition (57).

       The first part of the Proposition implies that, if the noise is small enough, then all prices
derived above will be positive. The second part, means that if Condition C is satisfied at
t = 0, then it will be satisfied for all future t’s. This “self-perpetuating” property makes it
potentially useful for applied work.
       Condition C means δ i Xit terms should not be too negative. It means that growth rates
terms should not be too low, and interest rate terms should not be too high. This makes
sense, because, in view of (19), if the terms δ i Xit are too negative, then prices could be
threaten to be negative.
       To illustrate this, consider first Example 2. Then, δ = 1, α = 1/ (1 + R), Γ1 = ρα, and
the condition reads: 1+min (xt , 0) / (1 − ρ) > 0, i.e. xt > 1−ρ. This is exactly the condition
(56) derived above. The deviation of the growth rate from trend cannot be too low.
   Next, consider Example 4. Then, α = 1/ (1 + r∗ ), δ = α (−1, ..., −1), and Γ = α (ρ1 , ..., ρn ).
                      P
Condition C reads: 1 + ni=1 min(−r
                               1−ρ
                                  it ,0)
                                         > 0, i.e.
                                         i



                                             X
                                             n
                                               max (rit , 0)
                                       1−                      > 0.                                    (58)
                                             i=1
                                                    1 − ρi

  14
    This case is not very restrictive, as more general case can be reduced to it by diagonalization, if Ω is
diagonalizable in R.


                                                    27
This condition means that the components of the interest rate state vector cannot be too
positive. Each component is weighted by its duration 1/ (1 − ρi ), i.e. more persistent com-
ponents count for more.
                                                                                      ¡      ¢
    Finally, consider the hybrid Example 3. The condition reads: 1+min (gt − g∗ , 0) / 1 − ρg −
max (π t − π ∗ , 0) / (1 − ρπ ) > 0. This means that the growth rate should not be too low, or
the risk premium should not be too high.


5.2    Continuous time
The same condition carries over to continuous time. In the case where ω is equal to (41)
with b = 0, and a < Φi for all i, the condition is:

                                                        Xn
                                                            max (β i Xit /a, 0)
           Condition C at time t (continuous time): 1 −                         >0        (59)
                                                        i=1
                                                                Φi − a

    For instance, for the simple growth model of Example 7, we have Xt = gt , a = r, β = −1,
Φ = φ + r, so Condition C gives: 1 − max (−gt , 0) /φ > 0, i.e. gt > −φ, the continuous time
limit of (56).
    Likewise, for the interest rate model of Example 12, the condition is rbt < φ. The interest
rate should not be too high.
    In the multi-factor model of Example 13, a = r∗ , β = 1, Φi = r∗ + φi , so the Condition
        P
is: 1 − ni=1 max (rit , 0) /φi > 0, which is just the continuous time analogue of (58).
    This conclude our simple, practical suﬃcient conditions for processes to be well-defined.
More abstract and general conditions are provided in Cheridito and Gabaix (2007).



6     Extensions
This section presents additional results and remarks on LG processes.




                                              28
6.1      LG processes are the only ones that generate linearity
We show that, in a certain sense, if bond prices are linear in the factors, then they come
from an LG process. To see that, let us first consider the 1-factor case. Call Xt the factor,
and suppose that for T = 1, 2, Zt (T ) = αT + β T Xt , for some numbers α1 , β 1 6= 0, α2 , β 2 .
With T = 1, we get Et [Mt+1 /Mt ] = α1 + β 1 xt , so that condition (9) holds. Also,
                               ∙ ¸         ∙             ∙      ¸¸      ∙                      ¸
                            Mt+2             Mt+1          Mt+2           Mt+1
       α2 + β 2 Xt    = Et           = Et           Et+1           = Et        (α1 + β 1 Xt+1 )
                             Mt               Mt           Mt+1           Mt
                                                   ∙           ¸
                                                     Mt+1
                      = α1 (α1 + β 1 Xt ) + β 1 Et        Xt+1
                                                     Mt
                      ∙            ¸
                          Mt+1        1
                 Et            Xt+1 =    (α2 + β 2 Xt − α1 (α1 + β 1 Xt )) = a00 + b00 Xt
                          Mt          β1
hence (10) holds. We conclude that if both the 1 and 2-period maturity bonds are aﬃne in
Xt , then Mt (1, Xt ) is a LG process. The next Proposition shows that the property holds
with n factors15

Proposition 6 (LG processes are the only processes generating linear bond prices) Sup-
pose that there are coeﬃcients for some coeﬃcients (αT , β T , )T ≥0 , with {(αT , β T ) , T = 1, 2..}
spanning Rn+1
          .   , such that ∀t, T ≥ 0, Et [Mt+T /Mt ] = αT + β 0T Xt , Then, Mt (1, Xt ) is a LG
process, i.e. there is a matrix Ω, such that Yt = Mt (1, Xt )0 follows: Et [Yt+1 ] = ΩYt .


6.2      Relation to the aﬃne-yield class
The aﬃne class (Duﬃe and Kan 1996; Dai and Singleton 2000; Duﬃe, Pan and Singleton
2000; Duﬀee 2002; Cheridito, Filipovic and Kimmel 2007) is a very important class, that
contains the processes of Vasicek and Cox, Ingersoll, Ross (1985). It is a workhorse of
much empirical and theoretical in asset pricing. It comprises processes of the type: dXt =

  15
    The property that {(αT , β T ) , T = 1, 2..} spans Rn+1
                                                          .   means that Et [Mt+T /Mt ] = αT + β 0T Xt is the
most compact representation of the process. More precisely, if it didn’t span Rn+1    .     , one could find a stricly
lower dimensional process xt ∈ Rm  . , m <  n, and  constants  AT , BT  , such that E   t [M                     0
                                                                                              t+T /Mt ] = AT + BT xt .
                     ¡       ¢
                            0 0                                                                      n+1
Indeed, call γ T = αT , β T , and V = Span {γ T , T ≥ 0}. If V is a strict subset of R. , decompose
Rn+1
  .   = V ⊕ V ⊥ , call B : V → Rn+1
                                 .     the natural injection, and h·, ·i the restriction of the Euclidean product
                                     0            0                                       0
on V . Then, γ 0 (T ) Yt = (Bγ (T )) Yt = γ (T ) B 0 Yt , so we have Zt (T ) = γ (T ) (B 0 Yt ). Vector B 0 Yt has
dimension dim V < n + 1.

                                                         29
(b − ΦXt ) dt + wt dzt , with wt wt0 = σ 2 (H10 Xt + H0 ), with b, Xt ∈ Rn , Φ ∈ Rn×n , (H0 , H1 ) ∈
Rn×n × Rn×n×n , σ ∈ R, zt is a n−dimensional Brownian motion. The interest rate is rt =
r∗ + β 0 (Xt − X∗ ), where X∗ = Φ−1 b, is assumed to exist. Under mild technical conditions,
bond prices have the expression:

                                      ¡                                       ¢
                       ZtAﬀ (T ) = exp −r∗ T + Γ (T )0 (Xt − X∗ ) + σ 2 a (T ) ,


where a (T ) and Γ (T ) satisfy coupled ordinary diﬀerential equations, that typically need
to be solved numerically. This is not a problem for empirical work, but that does hinder
theoretical work. The situation is simpler if H1 = 0. In that case, Γ (T ) = γ (T ), with
             ¡        ¢                         ¡                                       ¢
γ (T )0 = β 0 e−ΦT − 1 /Φ. Then: ZtAﬀ (T ) = exp −r∗ T + γ (T )0 (Xt − X∗ ) + σ 2 a (T ) . This
expression can be contrasted with the expression for the LG process (38),

                                                 ¡                      ¢
                               ZtLG (T ) = e−r∗ T 1 + γ (T )0 (Xt − X∗ ) .                                (60)


If γ (T )0 Xt is small, the two expressions are the same, up to terms of second order in γ (T )0 Xt ,
and second order in σ. Hence, a LG process is a good approximation if the underlying process
is in fact aﬃne, and vice-versa. In most cases, the two values are likely to be close, so that
existing estimates of parameters in the aﬃne class can be used to calibrate LG processes.16
       What are the respective merits of the LG and aﬃne classes? First, quantitatively, they
will often make close predictions, as the two models yield the same prices to a first or-
der. Hence, for many situations, the choice of aﬃne vs LG processes is just a matter of
convenience.
       In terms of the economic diﬀerences, as LG bond prices are independent of volatility
(controlling for the covariances, see Eq. 54), LG processes generate “unspanned volatility,”
a relevant feature of the data, as shown by Collin-Dufresne and Goldstein (2002), Andersen
and Benzoni (2007) and Joslin (2007). By contrast, aﬃne models typically impose a tight

  16
     That equivalence gives a useful way to calculate easily functionals of LG processes, that can be expressed
as a linear combination of bonds. One first works with the aﬃne process, setting volatility to 0, doing a
first order Taylor
                 ¡ 2expansion
                     ¢         of terms in (Xt − X∗ ). One gets an expression: PtAﬀ = a + b (Xt − X∗ ) +
o (Xt − X∗ ) + o σ , for some constant a, b. Then, one knows that for the corresponding LG process, the
value of the asset is: PtLG = a + b (Xt − X∗ ), exactly.


                                                      30
link between bond prices and volatility.
   On the other hand, a potential drawback of pricing bonds with the LG process, is that,
in the simplest version at least, bonds have no mechanically-induced convexity in the LG
framework. However, this may not be such a problem, as Joslin (2007) estimates that bond
convexity plays a small role in bond prices. In addition, multifactor LG processes can have
some convexity (Example 11).
   Coming now to the diﬀerence in terms of tractability, the distinctive advantage of the
LG class is for stocks. LG yield simple closed forms for stock prices. However, with the
                                                             P
aﬃne class, a stock price can be only be expressed PtAﬀ /Dt = ∞    Aﬀ
                                                              t=0 Zt (T ) (Burnside 1998,

Ang and Liu 2004). Those are infinite sums of exponentials, which is a great progress over
stochastic sums, but are still not very tractable.
   Beyond their advantage for stocks, LG processes have two lesser virtues. First, bond
prices are quite simple, which should prove useful to theorize on bonds (Gabaix 2007).
Second, LG processes allow a free functional form for the innovations dNt , which can include
jumps and non-Gaussian behavior, and a free type of heteroskedascity.
   On the other hand, aﬃne processes are the central technique to price derivatives, whereas
this paper is silent about options (pricing options with LG processes is an open challenge).
Finally, aﬃne models are now well-understood, and they have been estimated. It would be
very desirable to do the same for LG models (see Binsbergen and Koijen 2007)
   In conclusion, LG processes have a good advantage for stocks, and aﬃne processes have
a strong advantage for options. For bonds, aﬃne models will continue to be tremendously
useful, but LG models may complement them, particularly in theoretical research.


6.3    Processes with time-dependent coeﬃcients
It is simple to extend the process to time-dependent deterministic coeﬃcients, i.e. in Defin-
                                                                     >
ition 1, to have
              ⎛ α, δ, γ, Γ⎞functions of time. With Yt = (Mt , Mt Xt ) , this is Et [Yt+1 ] = Ωt Yt ,
                 αt δ 0t                               Y
                                                       T −1
where Ωt =    ⎝           ⎠ . That implies E0 [YT ] =       Ωt Y0 . Hence, in the zero-coupon
                 γ t Γt                                t=0
                                              Y
                                              T −1
expressions, it is enough to replace ΩT by           Ωt .
                                              t=0


                                                31
6.4    Closedness under addition and multiplication
   The product of two uncorrelated LG processes is LG. The product of two un-
correlated LG processes with respective dimensions d1 , d2 (i.e., with d1 − 1 and d2 − 1 factor
respectively) is LG, with dimension d1 d2 (i.e., with d1 d2 − 1 factors). The idea is simple,
though it requires somewhat heavy notations.
   We start in discrete time. Take two LG processes characterized by Mti , Yti , Ωi , and con-
sider a process with discount factor Mt = Mt1 Mt2 . Assume that, for any index i, j of the com-
              ³             ´
                 1(i)  2(j)
ponents, cov Yt+1 , Yt+1 = 0. The innovations between processes are uncorrelated, but,
importantly, not necessarily independent. Then, it is easy to verify that for any vector ψ i ,
  £¡      ¢¡      ¢¤     £      ¤ £       ¤
Et ψ 1 YT1 ψ 2 YT2 = Et ψ 2 YT2 Et ψ 2 YT2 . In particular, Et [MT1 MT2 ] = Et [MT1 ] Et [MT2 ].
   Then, Mt = Mt1 Mt2 is also the stochastic discount factor of a LG process. The underlying
                             1     2                                                     1(i)   2(j)
autoregressive process is Y t ⊗ Y t , i.e. the vector made of the d1 d2 components Y t Y t             ,
i = 1...d1 , j = 1...d2 . The corresponding generator Ω is Ω = Ω1 ⊗ Ω2 .
   The same reasoning holds in continuous time. Starting with processes Mti , Yti , ω i , and
         D               E
            1(i)    1(2)
assuming dYt+1 , dYt+1 = 0, then Mt1 Mt2 is also a pricing kernel that comes from a LG
                                                         1   2
process. The underlying autoregressive process is Y t ⊗ Y t (which has dimension d1 d2 ), and
it is easy to check that the generator is: ω = ω1 ⊗ Id2 + Id1 ⊗ ω 2 . To make the above concrete,
consider the following example.

Example 15 Stock with decoupled LG processes for the growth rate and the risk premium.

   Consider processes with dMt /Mt = −rt − λt dBt , dDt /Dt = gt dt + σ t dBt , where gt
follows: dgt = −φg (gt − g∗ ) dt − (gt − g∗ )2 dt + dNtg , and the risk premium, π t = λt σ t ,
follows: dπ t = −φπ (π t − π ∗ ) dt+(π t − π∗ )2 dt+dNtπ , where Ntg , Ntπ are martingales. Assume
that the processes dNtg , dNtπ and dBt are uncorrelated. Then, the price of a stock, Pt =
   £R ∞        ¤                    £R ∞     ¡ Rs                  ¢ ¤
E0 0 Mt Dt dt /M0 , is Pt /Dt = Et s=t exp − u=t (r + π u − gu ) du ds . In virtue of the
above properties,
          ∙    µZ s            ¶¸     ∙    µZ s        ¶¸ ∙    µZ s      ¶¸
        Et exp      −πu + gu du   = Et exp      −π u du Et exp      gu du .
                    t                                t                        t


For general processes, the above equation would in general require the two processes to
be independent — for instance, with stochastic volatility, the respective variance processes

                                               32
should be independent. For LG processes, the property required is the weaker hdπ t , dgt i = 0
for all t’s.
       Using the values of the LG processes, and integrating, we obtain, with R = r + π∗ − g∗ ,17
                       "                       ¡            ¢                        #
                     1     π t − π ∗ gt − g∗    2R + φπ + φg (π t − π ∗ ) (gt − g∗ )
            Pt /Dt =    1−          +        −          ¡      ¢¡                ¢ .                 (61)
                     R     R + φπ R + φg       (R + φπ ) R + φg R + φπ + φg

       The central value is again the Gordon formula, Pt /Dt = 1/R. It is modified by the current
level of the equity premium, and the growth rate of the stock. A stock with a currently high
growth rate gt exhibits a higher price-dividend ratio, and this is amplified when the equity
premium is low, as shown by the term (π t − π ∗ ) (gt − g∗ ).
       The diﬀerence between formula (61) and formula (50) is that in (61), the processes for π t
and gt are decoupled, whereas in (50), they were coupled, i.e. in their drift term there was a
term (gt − g∗ ). The decoupling forces the presence of a cross term (π t − π ∗ ) (gt − g∗ ) in the
expression of the price. In general, one obtains simpler expressions by having one multifactor
LG processes, rather than the product of many diﬀerent LG processes. With n coupled
factors, the stock price has n + 1 terms, while with n decoupled factors, the stock price has
2n terms.


       The sum of two LG processes is LG. This property is quite trivial, and mentioned
for completeness. Suppose two LG process Mti , Yti , Ωi , with Mti = ν i Yti , for i = 1, 2. Call di
the dimension of Yti . Then, Mt = Mt1 + Mt2 comes from      ⎛ a LG process
                                                                     ⎞     of dimension d1 + d2 .
                                                              Ω1 0
Indeed, define Yt = (Yt1 , Yt2 ), ν = (ν 1 , ν 2 ), and Ω = ⎝        ⎠. Then, Et [Yt+1 ] = ΩYt ,
                                                              0 Ω2
            0
and Mt = ν Yt .


7        Conclusion
Linearity-generating processes are very tractable, as they yield closed forms for stocks and
bonds, and prices that are linear in factors. They are likely to be useful in several parts of

  17
    Menzly, Santos and Veronesi (2004, Eq. 20) obtain a similar expression. This is natural because the LG
class embeds their model, as Example 10 shows.

                                                   33
economics, when trend growth rates, or risk premia, are time-varying. The results of this
paper suggest the following research directions.
   Most importantly, LG processes allow the construction of paper and pencil tractable
general equilibrium models, with closed forms for stocks and bonds. Indeed they suggest a
way to “reverse engineer” the processes for endowments and technology, so that the model
is tractable. Gabaix (2007) and Farhi and Gabaix (2007) present such models.
   Second, it would be good to use the flexibility and closed forms of LG processes for
empirical work. In an ambitious new paper, Binsbergen and Koijen (2007) take up this task,
and demonstrate the fruitfulness of having closed forms for multifactor models. Also, since
the LG processes are defined by moment conditions (Eq. 9-10), they lend themselves to
estimation and testing by GMM techniques.
   Third, LG processes suggest a new way to linearize models. Given a model, one could do a
Taylor expansion expressing moments Et [Mt+1 Dt+1 /Mt Dt ] and Et [Mt+1 Dt+1 Xt+1 /Mt Dt ] as
a linear function of the factors, thereby making Eq. 9-10 hold to a first order approximation.
The projected model is then in the LG class, and its asset prices are approximations of the
prices of the initial problem. Hence the LG class oﬀers a way to derive linear approximations
of the asset prices of more complicated models. The Online Appendix to this paper studies
such an example, where a non-LG process can be approximated by an LG process to an
arbitrary degree of precision.
   Fourth, LG processes can be enriched by a decision variable, and oﬀer a way to do
multifactor, closed-form dynamic programming. I explore those issues in ongoing research.
   I conclude that LG processes might be a useful addition to the economist’s toolbox.



Appendix A. Matrix Algebra
Derivations with LG processes often use the following Lemmas, which are standard.

Lemma 2 With a ∈ R, b, c ∈ Rn , and d ∈ Rn×n , suppose that d is⎛invertible⎞ and that the
                                                                      a b0
real number a − b0 d−1 c is 6= 0. Then the (n + 1) × (n + 1) matrix ⎝      ⎠ is invertible,
                                                                      c d


                                             34
and its inverse is:
                          ⎛                   ⎞−1                         ⎛                        ⎞
                                          0                                                 0 −1
                                a b                         1            1    −b d
                          ⎝                   ⎠     =                ⎝             ⎠                            (62)
                                c d                     a − b0 d−1 c   −d−1 c ad−1

Lemma 3 With n ∈ N∗+ , a ∈ R, b ∈ Rn , and d ∈ Rn×n . Call 0n the n−dimensional vector
made of 0’s, In the n−dimensional identity matrix, and suppose that aIn − d is invertible.
Then, for T ∈ N∗ ,
                      ⎛                   ⎞T ¡      ⎛   ¢            ⎞
                           a     b0     aT b0 aT In − dT (aIn − d)−1
                      ⎝            ⎠ =⎝                              ⎠
                           0n    d      0n             dT

and, for T ∈ R,
                      ⎡⎛                      ⎞ ⎤       ⎛                 ¡             ¢                   ⎞
                                      0                     aT        0       aT   dT                  −1
                           a     b                          e     b e In − e                (aIn − d)
               exp ⎣⎝                         ⎠T⎦ = ⎝                                                       ⎠
                                                                                   dT
                           0n d                             0n                     e


Appendix B. Additional Derivations

7.1    Derivation of Theorems and Propositions
   Proof of Theorem 1 Recall (14), Et [Yt+1 ] = ΩYt . Iterating on T , it implies that for
all T ≥ 0, Et [Yt+T ] = ΩT Yt . Given Mt+T = ν 0 Yt+T ,


Zt (T ) = (Mt Dt )−1 Et [Mt+T Dt+T ] = (Mt Dt )−1 Et [ν 0 Yt+T ] = (Mt Dt )−1 ν 0 Et [Yt+T ]
                                                               ⎛     ⎞                       ⎛    ⎞
                                       ¡             ¢             1        ³           ´      1
        = (Mt Dt )−1 ν 0 ΩT Yt = ν 0 ΩT (Mt Dt )−1 Yt = ν 0 ΩT ⎝     ⎠ = 1 0n ΩT ⎝                ⎠
                                                                  Xt                           Xt

i.e. (15). The formula for γ = 0 comes from Lemma 3 in Appendix A.




                                                                 35
       Proof of Theorem 2 We use (15), which gives the perpetuity price:

                                                    Ã∞     !⎛     ⎞                    ⎛     ⎞
                            X
                            ∞                        X        1                          1
             Pt /Dt =               Zt (T ) = ν 0        ΩT ⎝     ⎠ = ν 0 (In+1 − Ω)−1 ⎝     ⎠
                            T =0                    T =0      X t                        X t


P∞
   T =0   ΩT is summable because all eigenvalues of Ω have a modulus less than 1. We use
Lemma 2 from Appendix A to calculate (In − Ω)−1 , and conclude.18


       Proof of Theorem 3 Recall the definition of ω in (35), and Et [d (Yt )] = −ωYt dt. It
is well-known that this implies19 : ∀T ≥ 0, Et [Yt+T ] = e−ωT Yt . Given Mt+T = ν 0 Yt+T ,


Zt (T ) = (Mt Dt )−1 Et [Mt+T Dt+T ] = (Mt Dt )−1 Et [ν 0 Yt+T ] = (Mt Dt )−1 ν 0 Et [Yt+T ]
                                                                     ⎛      ⎞                  ⎛    ⎞
                                           ¡             ¢              1          ³         ´   1
        = (Mt Dt )−1 ν 0 e−ωT Yt = ν 0 e−ωT (Mt Dt )−1 Yt = ν 0 e−ωT ⎝      ⎠ = 1 0n e−ωT ⎝         ⎠.
                                                                       Xt                        Xt

i.e. Eq. 37. The formula for b = 0 comes from Lemma 3 in Appendix A.


       Proof of Theorem 4 We use (37). The perpetuity price is:
                                                                               ⎛         ⎞            ⎛          ⎞
                           Z    ∞                      µZ    ∞             ¶
                                                                                    1                       1
            Pt /Dt =                Zt (T ) dT = ν 0             e−ωT dT       ·⎝        ⎠ = ν 0 ω −1 · ⎝        ⎠
                            0                            0                          Xt                      Xt

We use the Lemma 2 to calculate ω−1 , and conclude.20

  18
    There is a more elementary heuristic proof. We seek a solution of the type Pt /Dht ≡ Vt = c − 1i+ h0 Xt ,
which we know exists, by summation of (15). The arbitrage equation is: Vt = 1 + E Mt+1     Dt+1
                                                                                        Mt Dt Vt+1 , i.e.

                    ∙                         ¸
                        Mt+1 Dt+1                     ¡          ¢                                   £           ¤
c + h0 Xt = 1 + E                 (c + h0 Xt ) = 1 + c α + δ 0 Xt + h0 (γ + ΓYt ) = [1 + cα + h0 γ] + cδ 0 + h0 Γ Xt
                         Mt Dt
                          0             0     0   0                 0      0                  −1
i.e.
  h (i) c = 1 + cα + h γ    i and (ii) h = cδ + h Γ. (ii) gives h = cδ (1 − Γ) , and plugging in (i) yields
                       −1
c 1 − α − δ 0 (1 − Γ) γ = 1, hence c and (17).
   19
      In the case t = 0 (which is enough), the proof is thus: define f (T ) = E0 [YT ]. Then, df (T ) = E0 [dYT ] =
E0 [−ωYT dT ] = −ωE0 [YT ] dT = −ωf (T ) dT , which integrates to f (T ) = e−ωT f (0), i.e. E0 [YT ] = e−ωT Y0 .
   20
      The following elementary heuristic proof is useful to know. We seek a solution of the type Pt /Dt ≡ Vt =
c + h0 Xt , which we know exists, by integration of (37). The arbitrage equation is: 1 − rt Vt + E [dVt ] /dt = 0,



                                                                 36
    Proof of Proposition 5 Write Yt = (Y0t , ..., Ynt ), with Y0t = Mt Dt , and define Ht =
      P
Y0t + ni=1 min(δ i Yit ,0)
              α−Γi
                           . Start with the case of where there is no noise, i.e. ∀t, Yt+1 = ΩYt .
                                          P
Given Ω, this means Y0,t+1 = αY0t + i δ i Yit , and for i ≥ 1, Yi,t+1 = Γi Yi,t . So:

                                          X                   X min (δ i Γi Yit , 0)
                  Ht+1 = αY0t +                   δi Yit +
                                            i                   i
                                                                        α − Γi
                                                  X                      X µ                          Γi
                                                                                                             ¶
                         = αY0t +                             δ i Yit +        1+                                 δ i Yit
                                          i s.t. δ i Yit >0              i s.t. δ i Yit ≤0
                                                                                                    α − Γi
                                                  X             α
                         ≥ αY0t +                                    δ i Yit = αHt .
                                          i s.t. δ i Yit   ≤0
                                                              α − Γi

Hence, Ht+1 ≥ αHt . Hence, if H0 > 0, then ∀t ≥ 0, Ht > 0, and so that Mt Dt = Y0t ≥
Ht > 0.
       In the case with noise, say that Yt+1 = ΩYt + ut+1 , for some mean 0 noise ut+1 , and
suppose that ut+1 is bounded. By continuity, if Ht > 0, Ht+1 is positive with probability 1,
if ut+1 is small enough. And again, Mt Dt = Y0t ≥ Ht > 0.

       Proof of Proposition 6 Call Yt = Mt (1, Xt )0 , γ T = (αT , β T )0 , so that Et [Mt+T ] =
γ 0T Yt . That implies γ 0T +1 Yt = Et [Mt+T +1 ] = Et [Et+1 [Mt+T +1 ]] = Et [γ T Yt+1 ], hence: γ 0T +1 Yt =
Et [γ T Yt+1 ].
       Call ek ∈ Rn+1
                  .   , the vector with k−th coordinate equal to 1, and other coordinates equal
to 0. As{γ T , T = 1, 2, ..} spans Rn+1
                                    .   , there are reals λkT (with at most n+1 non-zero values)
                  P                         P                                X
                                                                             n+1
                                                          0
such that: ek = T λkT γ T . Define Ω = k,T ek λkT γ T +1 . Given In+1 =          ek e0k , we have:
                                                                                                             k=1

                               Ã                  !                      Ã              Ã                   !!
                                X                                         X              X
               Et [Yt+1 ] =              ek e0k       Et [Yt+1 ] =                 ek            λkT γ 0T        Et [Yt+1 ]
                                     k                                         k             T
                               X                                         X
                          =          ek λkT Et [γ 0T Yt+1 ]         =          ek λkT γ 0T +1 Yt     = ΩYt .
                               k,T                                       k,T


i.e.                         ¡           ¢                 £         ¡      ¢ ¤
                          1 − r∗ + β 0 Xt (c + h0 Xt ) + h0 b − ΦXt + β 0 Xt Xt = 0
This holds if and only if the constant and the term in Xt are zero, i.e. r∗ h0 +β 0 c+h0hΦ = 0 and 1−r∗ c+h0ib = 0.
                            −1                         −1                                                −1
Hence h0 = −β 0 c (r∗ + Φ) and 1 − cr∗ + β 0 (r∗ + Φ) b = 0, which gives c = 1/ r∗ + β 0 (r∗ + Φ) b , and
yields (39).

                                                                    37
7.2         Derivations of Examples
                      bt = π t − π ∗ , b
     Example 3 Define π                gt = gt − g∗ , so that:
                              ∙             ¸
                                  Mt+1 Dt+1      1                             bt
                                                                         gbt − π
                         Et                   =     (1 + gt − πt ) = α +
                                  Mt Dt         1+r                        1+r
     ∙                 ¸     ∙           ¸
         Mt+1 Dt+1             Mt+1 Dt+1                 1                   1 + g∗ − π ∗
Et                 b
                   gt+1 = Et               Et [b
                                               gt+1 ] =     (1 + gt − π t )·              ρbgt = αρg gbt
         Mt Dt                 Mt Dt                    1+r                  1 + gt − π t g
                                  bt . Hence The process Yt = Mt Dt (1, π
The analogue expression holds for π                                           gt )0 is LG, with
                                                                         bt , b
          ⎛                            ⎞
           α 1/ (1 + r) −1/ (1 + r)
          ⎜                            ⎟
generator ⎜
          ⎝ 0    αρ g          0       ⎟. Applying (17) yields the result.
                                       ⎠
            0     0          αρπ

                            h           i
   Example 4 We have Et MMt+1  t
                                 ri,t+1
                                             1
                                          = 1+r ρ ri,t . So process Mt (1, r1,t , ..., rn,t ) has
                                               ∗ i
                ⎛              ⎞
                 1 −1 · · · −1
                ⎜              ⎟
                ⎜0 ρ    0    0 ⎟
            1 ⎜     1          ⎟
generator: 1+r  ⎜
              ∗ ⎜      ...     ⎟. By (11) and (16), the bond price obtains.
                 0 0         0 ⎟
                ⎝              ⎠
                 0 0    0 ρn

                          h               i       P
                              Mt+1 Dt+1
     Example 5 Et              Mt Dt
                                              =   i   Gi Xit , and

     ∙                   ¸     ∙           ¸                Ã          !Ã          !
         Mt+1 Dt+1               Mt+1 Dt+1                   X           X            X
Et                 Xi,t+1 = Et               Et [Xi,t+1 ] =     Gk Xkt      pij Xjt =   pij Gj Xjt
          Mt Dt                   Mt Dt                       k           j           j


as Xkt Xjt = 0 if j 6= k, and otherwise is equal to Xkt Xjt = Xjt , as exactly one of the Xjt is
6= 0.


     Example 7 Et [d (Mt Dt ) / (Mt Dt )] = (−r + gt ) dt and

                                                                 ¡          ¢
Et d (Mt gt ) = gt ·Et [dMt ]+Mt Et dgt = gt ·(−r + gt ) Mt dt+Mt −φgt − gt2 dt = − (r + φ) gt Mt dt




                                                             38
We note that the gt2 terms cancel
                               ⎛ out, which
                                         ⎞ is their raison d’etre in (47). So Mt (1, gt ) is a
                                  r −1
LG process with generator ω = ⎝          ⎠.
                                  0 r+φ

   Example 8 We calculate the LG moments:
          ∙             ¸                     Xn
            d (Mt Dt )
       Et                 /dt = − (r − g∗ ) +      Xjt
              Mt Dt                           i=1
       ∙                ¸       "                      #     Ã          Ã n     ! !
         d (Mt Dt Xit )                        X n                       X
    Et                    /dt = − (r − g∗ ) +       Xjt Xit + −φi Xit −      Xit Xit
            Mt Dt                               i=1                      i=1
                             = − (r − g∗ + φi ) Xit ,
                                                                   ⎛                                       ⎞
                                                                    r − g∗    −1       ···         −1
                                                                   ⎜                                       ⎟
                                                                   ⎜ 0     r − g ∗ +φ1 0               0   ⎟
                                                                   ⎜                                       ⎟
so Mt Dt (1, X1t , ..., Xnt ) is a LG process, with generator: ω = ⎜                   ..                  ⎟.
                                                                   ⎜ 0         0          .            0   ⎟
                                                                   ⎝                                       ⎠
                                                                0         0           0 r − g ∗ +φn
                                              0
We apply the Theorem 3, with a = r−g∗ , β = (−1, ..., −1), Φ = Diag (r − g∗ + φ1 , ..., r − g∗ + φn ).


   Example 9 We calculate the LG moments:
           ∙             ¸
             d (Mt Dt )
       Et                  /dt = −r − π t + gt = −R − π      bt + gbt
               Mt Dt
         ∙               ¸          ∙                 ¸
           d (Mt Dt b
                    gt )              d (Mt Dt ) /dt
      Et                   /dt = Et                     gbt + Et [b
                                                                  gt ] /dt
              Mt Dt                      Mt Dt
                                                             ¡               ¢       ¡      ¢
                               = (−R − π bt + bgt ) b
                                                    gt + − φg − π    bt + bgt bgt = − R + φg gbt
                    h             i
                             et )
and likewise for Et d(M t Dt π
                      M D
                                                      bt . So Mt Dt (1, b
                                    /dt = − (R + φπ ) π                    bt ) is LG with generator
                                                                        g, π
⎛                     ⎞t t
  R     1         1
⎜                     ⎟
⎜0 R + φ          0   ⎟.
⎝           g         ⎠
  0     0      R + φπ




                                                  39
   Example 11 Calculation shows that Yt = e−rT (Dt , Dt g, Dt gt2 ) is a LG process, with
              ⎛                     ⎞
                r     −1      0
              ⎜                     ⎟
generator ω = ⎜
              ⎝ 0   r + φ    −1/2   ⎟.
                                    ⎠
                  2
               −kG    −b r + k + 2φ

   Example 12 We calculate the LG moments: dMt /Mt = −rt dt = − (r∗ + rbt ) dt, and:

           d (Mt rbt )       dMt
                       = rbt     + dXt = −b   rt (r∗ + rbt ) dt + − (φ − rbt ) rbt dt + σ t dNt
              Mt              Mt
                       = − (r∗ + φ) rbt dt + σ t dNt


Importantly, the rbt2 terms cancel out. So, using Et [dNt ] = 0, we have the LG moments:


             Et [dMt /Mt ] /dt = −r∗ − rbt and Et [d (Mt rbt ) /Mt ] /dt = − (r∗ + φ) rbt
                                          ⎛         ⎞
                                           r∗    1
So Yt = Mt (1, rbt ) is LG with generator ⎝         ⎠.
                                            0 r∗ + φ

                          α                         2
   Example 14 Et dCt
                  Cα
                     = αgt + α (α − 1) σ2 and
                          t


                  µ                   ¶             ¿           À
Et [d (Ctα gt )]                   σ2                       dCt
                 = αgt + α (α − 1)      gt − φgt + α dgt ,
    Ctα dt                         2                        Ct
                  µ                   ¶                           µ                      ¶
                                   σ2                                                 σ2
                =  αgt + α (α − 1)      gt − φgt − αgt (gt − A) = −φ + αA + α (α − 1)      gt dt
                                   2                                                  2
                                                    ⎛                                  ⎞
                                                               σ2
                                                     α (α − 1) 2             α
so, Ctα (1, gt ) is a LG process with generator ω = ⎝                                  ⎠.
                                                                            σ2
                                                          0       α (α − 1) 2 − φ + αA
The statement follows. The process is well-defined if α (gt − A) > −φ, which is ensured if
the volatility of gt goes to 0 fast enough at gt = A, so that always gt ≤ A.



References
Ahn, Dong-Hyun, Robert F. Dittmar, and A. Ronald Gallant (2002), “Quadratic Term Structure
Models: Theory and Evidence,” Review of Financial Studies, 15, 243-288.


                                                   40
   Andersen, Torben G. and Luca Benzoni (2007), “Do Bonds Span Volatility Risk in the U.S.
Treasury Market? A Specification Test for Aﬃne Term Structure Models,” NBER WP 12962.
   Ang, Andrew and Jun Liu (2004), “How to Discount Cashflows with Time-Varying Expected
Returns,” Journal of Finance, 59, 6, 2745-2783.
   Bakshi, Gurdip S. and Zhiwu Chen (1997), “An Alternative Valuation Model for Contingent
Claims,” Journal of Financial Economics, Vol 44, No. 1, 1997, 123-165.
   Bansal, Ravi and Amir Yaron (2004), “Risks for the Long Run: A Potential Resolution of Asset
Pricing Puzzles,” Journal of Finance, 59, 1481-1509.
   Barro, Robert (2006), “Rare Disasters and Asset Markets in the Twentieth Century,” Quarterly
Journal of Economics, 121, 823-866.
   Bhattacharya, S. (1978), “Project Valuation with Mean Reverting Cash Flow Streams,”Journal
of Finance, 33, 1317—31.
   Binsbergen, Jules H. van and Ralph S.J. Koijen (2007), “Predictive Regressions: A Present-
Value Approach,” Working Paper, Duke University.
   Boudoukh, Jacob, Matthew Richardson and Robert Whitelaw (forth.): “The Myth of Long-
Horizon Predictability,” Review of Financial Studies.
   Burnside, Craig (1998), “Solving Asset Pricing Models with Gaussian Shocks,” Journal of
Economic Dynamics and Control, 22, 329-40.
   Campbell, John Y., and John Cochrane (1999), “By Force of Habit: A Consumption-Based
Explanation of Aggregate Stock Market Behavior,” Journal of Political Economy, 107, 205-251.
   Campbell, John Y., and Robert J. Shiller (1988), “The Dividend-Price Ratio and Expectations
of Future Dividends and Discount Factors,” Review of Financial Studies, 1, 195-228.
   Campbell, John Y. and Shiller, Robert J. (1991), “Yield Spreads and Interest Rate Movements:
A Bird’s Eye View,” Review of Economic Studies, 58, 495—514.
   Cheridito, Patrick, Damir Filipovic and Robert L. Kimmel (2007), “Market Price of Risk Spec-
ifications for Aﬃne Models: Theory and Evidence,” Journal of Financial Economics, 83, 123-170.
    Cheridito, Patrick, and Xavier Gabaix (2007), “Regularity Conditions to Ensure the Existence
of Linearity-Generating Processes” Working Paper, New York University.
   Cochrane, John (forth.), “The Dog That Did Not Bark: A Defense of Return Predictability,”
Review of Financial Studies.


                                                  41
   Cochrane, John, Francis Longstaﬀ, Pedro Santa-Clara (forth.), “Two Trees,” Review of Finan-
cial Studies.
   Collin-Dufresne, Pierre, and R. S. Goldstein (2002), “Do Bonds Span the Fixed Income Markets?
Theory and Evidence for Unspanned Stochastic Volatility,” Journal of Finance, 57, 1685-1730.
   Constantinides, George M. (1992) “A Theory of the Nominal Term Structure of Interest Rates,”
Review of Financial Studies, 5, 531-552
   Cox, John C., J. E. Ingersoll, Jr., and Stephen A. Ross (1985), “A Theory of the Term Structure
of Interest Rates,” Econometrica, 53, 385-407.
   Croce, M., Martin Lettau, and Sydney Ludvigson (2006), “Investor Information, Long-Run
Risk, and the Duration of Risky Cash Flows,” Mimeo, New York University.
   Dai, Qiang and Kenneth J Singleton (2000), “Specification Analysis of Aﬃne Term Structure
Models,” The Journal of Finance, 55(5), 1943—1978.
   David, Alexander, and Pietro Veronesi (2006), “Inflation and Earnings Uncertainty and Volatil-
ity Forecasts,” Working Paper, University of Chicago.
   Duﬀee, G. (2002), “Term Premia and Interest Rate Forecasts in Aﬃne Models,” Journal of
Finance, 57, 405—43.
   Duﬃe, D., and R. Kan (1996), “A Yield-Factor Model of Interest Rates,” Mathematical Finance,
6, 379-406.
   Duﬃe, D., J. Pan, and K. Singleton (2000), “Transform Analysis and Asset Pricing for Aﬃne
Jump Diﬀusions,” Econometrica, 68, 1343-1376.
   Fama, E., and K. R. French (1996), “Multifactor Explanations of Asset Pricing Anomalies,”
The Journal of Finance, 51, 55-84.
   Farhi, Emmanuel and Xavier Gabaix (2007), “Rare Disasters and Exchange Rates: A Theory
of the Forward Premium Puzzle,” Working Paper, Harvard University and NYU.
   Gabaix, Xavier (2007), “A Simple, Unified, Exactly Solved Framework for Ten Puzzles in
Macro-Finance,” Working Paper, NYU.
   Gabaix, Xavier, and David Laibson (2002), “The 6D Bias and the Equity Premium Puzzle,”
NBER Macroeconomics Annual, 16, 257-312.
   Gabaix, X., P. Gopikrishnan, V. Plerou, and H. E. Stanley (2006), “Institutional Investors and
Stock Market Volatility,” Quarterly Journal of Economics, 121, 461—504.


                                                 42
   Hansen, Lars, John C. Heaton, and N. Li (2005), “Consumption Strikes Back? Measuring Long
Run Risk,” NBER WP 11476.
   Hansen, Lars, and José Scheinkman (2006), “Long Term Risk: An Operator Approach,” Mimeo,
Princeton University.
   Johnson, Timothy C. (2002), “Rational Momentum Eﬀects,” The Journal of Finance, 57 (2),
585-608.
   Joslin, Scott (2007), “Pricing and Hedging Volatility Risk in Fixed Income Markets,” Working
Paper, MIT.
   Julliard, Christian, and Jonathan Parker (2005), “Consumption Risk and the Cross-Section of
Expected Returns,”Journal of Political Economy, 113, 185-222.
   Lettau, Martin and Jessica Wachter (2007), “Why is Long-Horizon Equity Less Risky? A
Duration-Based Explanation of the Value Premium,”Journal of Finance.
   Litterman, R., and José Scheinkman (1991), “Common Factors Aﬀecting Bond Returns,” Jour-
nal of Fixed Income, 1, 54-61.
   Liu, Jun (2007), “Portfolio Selection in Stochastic Environments,” Review of Financial Studies,
20, 1-39.
   Mamaysky, Harry (2002), “A Model For Pricing Stocks and Bonds,” Yale ICF Working Paper
No. 02-10.
   Mele, Antonio (2003), “Fundamental Properties of Bond Prices in Models of the Short-Term
Rate,” Review of Financial Studies, 16, 679-716.
   Mele, Antonio (forth.), “Asymmetric Stock-Market Volatility and the Cyclical Behavior of
Expected Returns,” Journal of Financial Economics.
   Menzly, Lior, Tano Santos, and Pietro Veronesi (2004), “Understanding Predictability,” Journal
of Political Economy, 112, 1-47.
   Pastor, Lubos, and Pietro Veronesi (2003), “Stock Valuation and Learning about Profitability,”
Journal of Finance, 58, 1749-1789.
   Pastor, Lubos, and Pietro Veronesi (2005), “Rational IPO Waves,” Journal of Finance, 60,
1713 — 1757.
   Ross, Stephen A. (1978), “A Simple Approach to the Valuation of Risky Streams”, The Journal
of Business, 51,453-475.


                                               43
   Santos, T., and P. Veronesi (2006), “Labor Income and Predictable Stock Returns,” Review of
Financial Studies, 19, 1-44.
   Sims, Christopher A. (1990), “Solving the Stochastic Growth Model by Backsolving with a
Particular Nonlinear Form for the Decision Rule,” Journal of Business & Economic Statistics, 8,
45-47
   Vasicek, Oldrich (1977): “An equilibrium characterization of the term structure,” Journal of
Financial Economics, 5, 177-188
   Veronesi, Pietro (2005), “Teaching Notes on Asset Pricing,” Chapter 3.
   Veronesi, Pietro, and Pierre Yared (2000), “Short and Long Horizon Term and Inflation Risk
Premia in the US Term Structure,” mimeo, University of Chicago.




                                              44
       Online Appendix for “Linearity-Generating Processes: A
       Modelling Tool Yielding Closed Forms for Asset Prices”
                                       Xavier Gabaix
                                     September 10, 2007


    This online Appendix discusses a few additional issues related to LG processes. The
first section discusses how to approximate non-LG processes with LG processes. The sec-
ond section illustrates the diﬀerence between non-LG and LG processes, to see to what
extent the quadratic terms makes a diﬀerence. The discussion uses heuristic arguments, and
simulations.
    This online Appendix contains ideas that might be profitably developed in further papers,
notably that theme that LG processes might oﬀer a way to arbitrarily approximate non-LG
processes.



8     Approximating non-LG processes with LG processes
LG processes oﬀer a way to approximate the price of stocks and bonds with non-LG processes,
often to an arbitrary degree of precision. This section illustrates this in a particular example.
The general properties of approximation with LG processes would require a full paper, but the
present appendix simply illustrates that a preliminary investigation justifies being optimistic.
   We suppose that the dividend growth (de-trended) follows an Ornstein-Uhlenbeck process.
                                      ³R       ´
                                         t
The price with dividend Dt = D0 exp 0 gs ds , dgt = −φgt dt + σdzt . The price Pt =
  £R ∞           ¤
Et 0 e−Rs Dt+s ds is:


                Z   ∞      ∙                      µ                      ¶¸
                                  1 − e−φT     σ2        −φT   e−2φT + 3
     Pt /Dt =           exp −RT −          bt + 3 φT + 2e
                                           π                 −              dT              (63)
                0                    φ         2φ                  2

which has no known closed-form solution. We consider how to approximate with a LG
process or arbitrary precision.



                                               45
8.1     First-order approximation
We define Yt1 = e−Rt Dt , and Yt2 = e−Rt Dt gt . We have: Et [dY1,t ] /dt = (−R + gt ) Y1,t =
−RY1,t + Y2,t and dY2,t /dt = Y1,t (− (φ + R) gt + gt2 ).
   To approximate gt2 , we replace it by its steady state mean. To find it, we observe that
Et [dgt2 ] /dt = −2φgt2 +σ 2 , so that taking the expectation at time 0, we obtain limt→∞ E0 [gt2 ] =
σ 2 / (2φ). Hence we approximate dY2,t ' Y1,t (− (φ + R) gt + σ 2 / (2φ)). Hence we approxi-
mate Yt by Yt∗ , where
                                                 ⎛                         ⎞
                                                   R      −1
                           Et [dYt∗ ] /dt = − ⎝               ⎠ Yt∗
                                                 2
                                               −σ / (2φ) R + φ

Applying Theorem 4, we obtain:
                                                                   xt
                                    (1)
                                                            1+    R+φ
                                  Vt      =   Pt∗ /Dt   =          σ2
                                                                                                (64)
                                                            R−   (R+φ)2φ


   Figure 1 plots the LG approximation, and the exact expression. We find only a small
discrepancy (less than 2%) between the two expressions. We conclude that the first order
approximation of the Ornstein-Uhlenbeck process by a LG process will be rather good, and
useful for theoretical purposes. If the goal is high-level numerical accuracy, we turn to an
approximation of arbitrary order.


8.2     Approximation of arbitrary order
8.2.1   A simple truncation

In some examples, and perhaps virtually always (at least, when the processes defining the
functions are analytic), it is possible to make LG processes approximate the prices of non-LG
processes to an arbitrary degree of precision. We provide a simple illustration of this. Define




                                                     46
                                                    PD



                                                   24



                                                   22



                                                   20



                                                                                    x
                         0.04           0.02                   0.02        0.04




Figure 1: The Figure plots the true value of the P/D ratio of a stock with an Ornstein-
Uhlenbeck process (solid line, Eq. 63), and the approximation by a LG process with n = 1
factor (short dashed line, Eq. 64), and n = 2 factors (longer dashed line, Eq. 71). The
annualized values are: R = 5%, σ = 1%, φ = 15%. In the range of the Figure, the 1-factor
approximation is within 2% of the true value, while the 2-factor approximation is withinn
0.15% of the true value. The 2-factor approximation is so close to true value that it is hard
to distinguish visually.

Yit = e−rt Dt gti−1 for i = 1, 2, .... Hence, the vector of factors is Xt = (gt , gt2 , gt3 , ...). We have:
                                 µ                                                 ¶
                             −rt    i+1               i                    σ 2 i−3
       Et [dYi,t ] /dt = e Dt gt + (i − 1) (−φ) gt + (i − 1) (i − 2) gt              − rYi,t
                                                                            2
                                        σ2
                       = (i − 1) (i − 2) Yi−2,t − [r + (i − 1) φ] Yi,t + Yi+1,t
                                        2

so that Et [dYt ] = −ωYt dt, with ω i,i−2 = − (i − 1) (i − 2) σ 2 /2,ωi,i = r +(i − 1) φ, ω i,i+1 = −1
and ω ij = 0 otherwise, i.e.
                                 ⎛                                                  ⎞
                                     r      −1     0         0          0    ···
                          ⎜                                                       ⎟
                          ⎜ 0 r+φ     −1      0      0                       · · ·⎟
                          ⎜                                                       ⎟
                          ⎜                                                       ⎟
                          ⎜−σ 2 0   r + 2φ   −1      0                       · · ·⎟
                          ⎜                                                       ⎟
                        ω=⎜                                                       ⎟
                          ⎜ 0 −3σ 2    0   r + 3φ   −1                       · · ·⎟
                          ⎜                                                       ⎟
                          ⎜                                                       ⎟
                          ⎜ 0   0    −6σ 2    0   r + 4φ                     · · ·⎟
                          ⎝                                                       ⎠
                            ..  ..     ..     ..     ..                      ...
                             .   .      .      .      .


                                                       47
So the price is:
                                                         ¡                            ¢0
                         Pt /Dt = (1, 0, ..., 0, ..) ω −1 1, gt , gt2 , ..., gtn , ...         (65)

   The sum can be truncated up to step n, i.e. be take to be the restriction of the vector to
the first n dimensions. We compare the LG (65) to the exact expression (113). Numerical
results show that the approximation is very good, even for n = 5.


8.2.2   An improved truncation

There is a better way to truncate the expansion (65). This section is heuristic, not rigorous.
To study the “pure” behavior of the process, with the eﬀect of discounting, we look at the
process when r = 0. Then:


                                     Et [dY2,t ] /dt = −φY2t + Y3t                             (66)

                                Et [dY3t ] /dt = σ 2 Y1t − 2φY3t + Y4t                         (67)

Let us study the truncation to 2 terms. We replace Y3 by the value that ensures the terms
in (67) are equal to 0 (that’s the “slaving principle”), so Y3 ' σ 2 Y1t / (2φ), and injecting this
                                     σ 2 Y1t
in (66), we get: Et [dY2,t ] /dt '     2φ
                                               − (φ + R) Y2t . Hence, we approximate the OU process
by the LG process                                  ⎛                 ⎞
                                                   r     1
                                         ω∗(1) = ⎝ 2        ⎠
                                                    σ
                                                  − 2φ r + φ

and the corresponding approximation is exactly the one we’ve previously derived, Eq. 64.
   We can do the same for higher K’s.For instance, with r = 0, Et [dY4t ] /dt = 3σ 2 Y2t −
3φY4t − Y5t , so we replace Y4t ' Y2t σ 2 /φ. Injecting this in (67) we get:
                                               ⎛                           ⎞
                                                   r     −1          0
                                            ⎜              ⎟
                                   ω ∗(2) = ⎜
                                            ⎝ 0   r + φ −1 ⎟
                                                           ⎠                                   (68)
                                                2    σ2
                                             −σ − φ r + 2φ

   The corresponding approximation is (71) below.




                                                       48
    Conclusion: The successive approximations, with 0, 1, and 2 factors respectively, are:

                     (0)        1
                   Vt      =                                                            (69)
                                R
                                      xt
                     (1)
                                 1 + R+φ
                   Vt      =          σ2
                                                                                        (70)
                                R − (R+φ)2φ
                                                   σ            2
                     (2)     1     gt        gt2 + Rφ (xt + φ)
                   Vt      =   +        +          ³                            ´       (71)
                             R R (R + φ) R (R + φ) R + 2φ −                σ2
                                                                           Rφ


                                                                                             (2)
    The approximation is very good. For instance, Figure 1 plots the LG approximation Vt ,
and it is extremely close, and very hard to distinguish visually from the true value.


8.3    Conclusion
It would be good to generalize the above procedure, probably in a future paper. It suggests
that LG processes allow the evaluation of the price of many non-LG processes (e.g., those
with analytic expansions), to an arbitrary degree of precision.



9     Twisted vs Non-twisted process
The “twist” term in LG processes may at first glance be strange. On the other hand,
mathematically it is close to a simple AR(1). It may be useful to illustrate, in the same
simulations, how an AR(1) and a LG process behave.
    Consider the processes

                               (1 − φ∆t) x∗t + vx ∆t
                x∗t+∆t =                             + σ (x∗t ) (∆t)1/2 εt+∆t with      (72)
                                     1 + x∗t ∆t
                               xt+∆t = (1 − φ∆t) xt + σ (xt ) (∆t)1/2 εt+∆t             (73)


where εt+∆t is a uniformly distributed, with mean 0 distribution with variance 1. The ν x
term is an adjustment convexity, that will be determined very soon, and is analogous to the
“σ 2 / (2φ)” in section 8. The processes mean-revert with a speed φ. The starred variables
relate to the LG process, while the non-starred variables relate to the AR(1). The dividends


                                                 49
start at D0∗ = D0 = 1, and follow:

                                     ¡          ¢
                          Dt+∆t = Dt 1 + η t+∆t (1 + xt ∆t) egD ∆t
                           ∗
                                     ¡          ¢ ∗
                          Dt+∆t = Dt∗ 1 + η t+∆t ext ∆t+gD ∆t


where η has mean 0 and standard deviation σ η . In the above expressions, xt is a growth rate.
In another interpretation, useful when purely dealing with a price-dividend ratio, is that xt
is minus a risk premium. Stock prices are the net present value of dividend, discounted with
a risk-neutral rate r.
   The variance process is:


                         σ 2 (X) = 2K (1 − X/Xmin )2 (1 − X/Xmax )2


with K > 0. It goes to 0 fast enough at Xmin and Xmax , ensuring that xt is within [Xmin , Xmax ].
The average volatility of X is fairly well approximated by: vx = K 1/2 ξ, with ξ = 1.35, as
proposed in the Appendix to Gabaix (2007), “A Simple, Unified, Exactly Solved Framework
for Ten Puzzles in Macro-Finance”.
   For the simulations, each period lasts a month, ∆t = 1/12. I use annual units, and I
take R = r − gD = 0.05, for a central P/D ratio of 20. Also, (Xmin , Xmax ) = (−8%, 8%), and
φ = 0.15 (which means that xt mean-reverts with a half-life of mean-reversion of 5 years).
Finally, K = 0.1φ |Xmin | Xmax , which corresponds to a annual volatility of the log P/D
ratio of 7% (vx / (R + φ)), based solely on the eﬀect mentioned here. It is easy to increase
this volatility, for instance by introducing a positive correlation between innovations to
dividends, and innovations to dividend growth.
   I simulate 100 years of data. Figures 2-4 illustrate a typical run. They show xt and x∗t ,
the corresponding price/dividend ratio Pt /Dt and Pt∗ /Dt∗ , and the (log) dividends Dt and
Dt∗ . (For the LG process, the PD ratio is in closed form; for the AR(1) process, I solve for
it numerically). Given that the processes for xt and x∗t are similar up to second order terms,
they are close, an expectation confirmed by Figure 2. The standard deviation of xt − xt∗ is
about 0.1 standard deviation of xt .
   Figure 3 shows the price-dividend ratio of the two processes. They are also reasonably

                                               50
                      x
                  0.06

                  0.04

                  0.02

                                                                              t
                                  20      40         60       80        100
                0.02

                0.04


Figure 2: Process for xt , simulated over 100 years. The solid black line is the LG process,
and dashed purple line is the AR(1). The curves are very close, which was expected as the
two processes are identical up to second order terms.




                 PD
                28

                26

                24

                22

                20

                                                                              t
                             20         40          60       80         100


Figure 3: The price-dividend ratios, simulated over 100 years. The solid black line represents
the P/D associated with the LG process, and dashed purple line the P/D ratio associated
with the AR(1) process. The curves are quite close, which makes sense given that the two
processes are identical up to second order terms.


                                               51
                    ln D
                3.0

                2.5

                2.0

                1.5

                1.0

                0.5

                                                                              t
                             20         40         60         80        100


Figure 4: The dividend of the stock, simulated over 100 years. The solid black line represents
the dividend associated with the LG process, and dashed purple line the dividend associated
with the AR(1) process. The curves are rather close, in spite of the compounding in growth
rates.

close. Finally, Figure 4 shows the dividend. Despite the compounding, the dividends are
reasonably close.
   The conclusion is that the processes are indeed quite close.
   Of course, even if they had been quite diﬀerent, this would not have been a problem for
LG processes. We do not want to say that the true model is an AR(1), that a LG process
approximates. It could as well be that the true model is a LG process, than an AR(1) model
approximates. Or rather, as models are just approximation of a complex economic reality,
the respective advantage of LG vs aﬃne models depends on the specific task at hand. The
modeler should be able to pick whichever approximation is most convenient. It is simply
reassuring that the modelling choice does not make a large diﬀerence in terms of the economic
processes.




                                             52
