                               NBER WORKING PAPER SERIES




                         THE ORIGINS OF FIRM HETEROGENEITY:
                          A PRODUCTION NETWORK APPROACH

                                       Andrew B. Bernard
                                       Emmanuel Dhyne
                                        Glenn Magerman
                                         Kalina Manova
                                        Andreas Moxnes

                                       Working Paper 25441
                               http://www.nber.org/papers/w25441


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                    January 2019




This project has received funding from the European Research Council (ERC) under the
European Union’s Horizon 2020 research and innovation programme (grant agreements No
715147 and No 724880). The views expressed here are those of the authors and do not
necessarily reflect those of the National Bank of Belgium. We thank Julian di Giovanni, Isabelle
Mejean, Jasmine Xiao, Thomas Åstebro and two anonymous referees at the National Bank of
Belgium for helpful comments and valuable discussion. The views expressed herein are those of
the authors and do not necessarily reflect the views of the National Bureau of Economic
Research.

At least one co-author has disclosed a financial relationship of potential relevance for this
research. Further information is available online at http://www.nber.org/papers/w25441.ack

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2019 by Andrew B. Bernard, Emmanuel Dhyne, Glenn Magerman, Kalina Manova, and
Andreas Moxnes. All rights reserved. Short sections of text, not to exceed two paragraphs, may
be quoted without explicit permission provided that full credit, including © notice, is given to the
source.
The Origins of Firm Heterogeneity: A Production Network Approach
Andrew B. Bernard, Emmanuel Dhyne, Glenn Magerman, Kalina Manova, and Andreas Moxnes
NBER Working Paper No. 25441
January 2019
JEL No. F10,F12,F16,L23,L25

                                          ABSTRACT

This paper quantifies the origins of firm size heterogeneity when firms are interconnected in a
production network. Using the universe of buyer-supplier relationships in Belgium, the paper
develops a set of stylized facts that motivate a model in which firms buy inputs from upstream
suppliers and sell to downstream buyers and final demand. Larger firm size can come from high
production capability, more or better buyers and suppliers, and/or better matches between buyers
and suppliers. Downstream factors explain the vast majority of firm size heterogeneity. Firms
with higher production capability have greater market shares among their customers, but also
higher input costs and fewer customers. As a result, high production capability firms have lower
sales unconditionally and higher sales conditional on their input prices. Counterfactual analysis
suggests that the production network accounts for more than half of firm size dispersion. Taken
together, our results suggest that multiple firm attributes underpin their success or failure, and
that models with only one source of firm heterogeneity fail to capture the majority of firm size
dispersion.

Andrew B. Bernard                               Kalina Manova
Tuck School of Business at Dartmouth            Department of Economics
100 Tuck Hall                                   University College London
Hanover, NH 03755                               United Kingdom
and CEPR                                        and CEPR
and also NBER                                   k.manova@ucl.ac.uk
Andrew.B.Bernard@dartmouth.edu
                                                Andreas Moxnes
Emmanuel Dhyne                                  Department of Economics
National Bank of Belgium                        University of Oslo
Boulevard de Berlaimont, 14                     P.O box 1095 Blindern
1000 Brussels                                   0317 OSLO
Belgium                                         NORWAY
emmanuel.dhyne@nbb.be                           and CEPR
                                                andreamo@econ.uio.no
Glenn Magerman
ECARES
Université libre de Bruxelles
Avenue F.D. Roosevelt 42
1050 Brussels
Belgium
glenn.magerman@ulb.ac.be
1     Introduction
Why are firms large or small? Even within narrowly defined industries, there is evidence of
massive dispersion in firm outcomes such as revenue, employment, labor productivity and
measured total factor productivity (see Syverson, 2011 for a recent overview). In Belgium, a
firm at the 90th percentile of the size distribution has turnover more than 34 times greater
than a firm at the 10th percentile in the same industry.1 Understanding the origins of firm
size heterogeneity has important micro- and macro-economic implications. At the micro
level, bigger firms perform systematically better along many dimensions, including survival,
innovation, and participation in international trade (e.g., Bernard et al., 2012). At the macro
level, the skewness and granularity of the firm size distribution affect aggregate productivity,
the welfare gains from trade, and the impact of idiosyncratic and systemic shocks (e.g.,
Pavcnik, 2002, Gabaix, 2011, di Giovanni et al., 2014, Melitz and Redding, 2015 and Gaubert
and Itskhoki, 2016).
    While the literature has made progress in identifying underlying firm-specific supply- and
demand-side factors driving firm size (e.g., Hottman et al., 2016), much less is known about
the role of firm-to-firm linkages in production networks. In particular, the focus has been
on one-sided heterogeneity in either firm productivity on the supply side (e.g., Jovanovic,
1982, Hopenhayn, 1992, Melitz, 2003, Luttmer, 2007) or final consumer preferences on the
demand side (e.g., Foster et al., 2016, Fitzgerald et al., 2016). To the extent that the
literature has considered firm-to-firm trade, it has typically remained anchored in one-sided
heterogeneity by assuming that firms source inputs from anonymous upstream suppliers or
sell to anonymous downstream buyers, without accounting for the heterogeneity of all trade
partners in the production network.
   This paper examines how buyer-supplier connections in a complete production network
are related to the firm size distribution.2 The basic premise of the analysis is intuitive:
Firms can be large because they have inherently attractive capabilities such as productivity
or product quality, because they interact with more or better buyers, and/or because they
are particularly well matched to their buyers. Moreover, firms can have high product quality
or low marginal costs if they have good inherent capabilities, or if they buy inputs from
high-quality, efficient, and/or well-matched suppliers. There may be higher-order effects in
a production network as well, because the customers of the customers (and so on) of any
one firm may ultimately also matter for that firm’s economic performance.
   The paper makes four main contributions. First, we document new stylized facts about
1
    Averaged across all NACE 4-digit industries in 2014.
2
    Throughout the paper, firm size, sales, revenue and turnover are used interchangeably.



                                                   1
a complete production network using data on the universe of firm-to-firm domestic transac-
tions in Belgium, and present the first extensive analysis of how upstream, downstream and
final demand heterogeneity translate into firm size heterogeneity. Second, we provide a the-
oretical framework with minimal assumptions on production and demand that relates firm
size to firm-specific characteristics, buyer and supplier characteristics, and buyer-supplier
match characteristics. Third, the model allows us to develop a new methodology for infer-
ring firm primitives from production network data, overcoming a reflection problem that is
fundamental in all networked environments. Finally, we close the model in general equilib-
rium and simulate counterfactual shocks to firm capabilities and intermediate input shares
to assess the role of the production network.
   The paper leverages unique data on firm-to-firm sales between virtually all firms in a do-
mestic production network. A key feature of production network data is that sales from firm
i to j can be decomposed into seller-, buyer- and match specific components (fixed effects),
similar to the analysis of employer-employee data (Abowd et al., 1999). High dispersion in
seller effects means that firms vary in how much they sell to their customers, controlling for
demand by those customers, i.e. firms differ in their average market share across customers.
Conversely, high dispersion in buyer effects means that some firms match with large cus-
tomers while others do not, leading to larger sales even as the average market share remains
the same.
   Given estimates of these fixed effects, the total sales of a firm can be decomposed into
three distinct factors: (i) an upstream component that captures the firm’s ability to obtain
large market shares across its customers, (ii) a downstream component that captures the
firm’s ability to attract many and/or large customers, and (iii) a final demand component
that captures the firm’s ability to sell outside the domestic network, i.e., to final demand or
to foreign customers.
   The results are striking: 81 percent of the variation in firm sales within narrowly defined
(4-digit NACE) industries is associated with the downstream component, while the upstream
component contributes only 18 percent. The variation in firm size is largely unrelated to
the final demand component. These findings imply that trade in intermediate goods and
firm-to-firm connections are essential to understanding firm performance and, consequently,
aggregate outcomes.
   Motivated by these results and additional stylized facts on the Belgian production net-
work, we develop a quantitative theoretical framework that features two-sided firm hetero-
geneity in an input-output production network. In the model, firms use a constant elasticity
of substitution production technology that combines labor and inputs from upstream sup-
pliers. Firms sell their output to final consumers and to domestic producers. Firms differ in


                                                2
their production capability (a combination of efficiency and quality conditional on the firm’s
connections), as well as in their network characteristics - their upstream and downstream
connections and their match quality with each partner. Marginal costs, employment, prices,
and sales are endogenous outcomes because they depend on the outcomes of all other firms
in the economy. A link between two firms increases the total sales of both the seller and the
buyer; for the seller this occurs mechanically because it gains a customer, while for the buyer
this arises because a larger supplier base implies greater opportunities to source cheaper or
higher-quality inputs.
    The model yields three main insights. First, the estimated buyer and seller effects are a
function of the fixed effects of all other firms - in other words, the fixed effects are contami-
nated by a reflection problem, in the spirit of Manski (1993). A low labor share exacerbates
the reflection problem because purchased inputs then constitute a larger share of marginal
costs, and suppliers’ costs consequently matter more for sales. Using the model we show
how to overcome the reflection problem and isolate firms’ production capability which is
independent of characteristics of other firms in the network (Proposition 1). Second, one
can recover a firm’s input price index from the fixed effects, and this price index respects
the general equilibrium constraints of the model (Proposition 2).3 Third, there is a unique
mapping from the estimated buyer and seller effects to model parameters (Proposition 3).
This powerful result implies that our methodology can be applied in a variety of settings to
discipline and calibrate network models.
    The theoretical and empirical framework is silent about the network formation process
and instead conditions on the observed equilibrium network. This approach minimizes the
assumptions required. However, there is a potential concern that the estimated fixed effects
are a function of the network formation process itself, similar to the concern about conditional
endogenous mobility in the analysis of employer-employee data. We provide evidence, and
develop new statistical tools, to test the identifying assumptions. Overall, we find empirical
support for our approach (Section 6).
   These insights allow us to give the initial firm size decomposition a structural interpre-
tation and further decompose the upstream and downstream components. We draw two
main conclusions. First, larger firms have lower input prices, more customers, and higher
market shares among their customers relative to smaller firms, consistent with the previous
literature (e.g., Bøler et al., 2015). At the same time, firms with higher production capability
have greater market shares among their customers, but also higher input costs and fewer cus-
tomers. As a result, more productive firms have lower sales unconditionally, but nevertheless
3
    In general equilibrium, the input price index is the solution to a fixed point problem. The input price
    index obtained from the fixed effects is proportional to the general equilibrium solution.



                                                    3
higher sales conditional on their input costs. These empirical results are difficult to reconcile
with canonical models, and suggest that multiple dimensions of firm activity underpin their
success or failure. For example, one interpretation of our findings is that firm attributes that
matter for finding customers and suppliers (e.g., managerial talent and marketing capacity)
are orthogonal, or negatively related, to firm attributes that determine sales conditional on
a match (e.g., productivity or quality).
    Second, most of the downstream variance in network sales is determined by the number
of buyers and the allocation of activity towards well-matched partners of high quality, rather
than by average partner capability. The main reason why the production network enables
firms to sell more downstream is through the number of buyers, not because their buyers
tend to purchase more intermediates. Conversely, nearly all the upstream variation is driven
by own production capability rather than input purchases from the network.
   Finally, we exploit the general equilibrium structure of the model and perform two coun-
terfactual exercises to evaluate the contribution of the production network to firm size disper-
sion. In the first counterfactual, heterogeneity in production capability is shut down. This
eliminates direct heterogeneity due to variation in a firm’s production capability, but also
removes heterogeneity in the capability of upstream suppliers and downstream customers.
The remaining variation in firm size then comes from the network itself, via differences in the
number of connections and their match quality across firms. In the second counterfactual, we
focus on a key parameter in our model, the cost share of inputs purchased from the network
(goods and services) in total production costs (the network input share).The results from the
counterfactuals provide additional evidence for the importance of the production network
for firm size variation. Even after eliminating all traditional sources of firm heterogeneity,
the network explains over half (56%) the variance in firm sales. Firm size dispersion also
widens when we alternatively increase the network input cost share.
   This paper contributes to several strands of literature. Most directly, the paper adds
to the large literature on the extent, causes and consequences of firm size heterogeneity.
The vast dispersion in firm size has long been documented, with a recent emphasis on the
skewness and granularity of firms at the top end of the size distribution (e.g., Gibrat, 1931,
Syverson, 2011). This interest is motivated by the superior growth and profit performance
of bigger firms at the micro level, as well as by the implications of firm heterogeneity and
superstar firms for aggregate productivity, growth, international trade, and adjustment to
various shocks (e.g., Gabaix, 2011, Bernard et al., 2012, Freund and Pierola, 2015, Gaubert
and Itskhoki, 2016, Oberfield, 2018).
    Traditionally, this literature has analyzed own-firm characteristics on the supply side
as the driver of firm size heterogeneity. The evidence indicates an important role for firms’


                                               4
production efficiency, management ability, and capacity for quality products (e.g., Jovanovic,
1982, Hopenhayn, 1992, Melitz, 2003, Sutton, 2007, Bender et al., 2016, Bloom et al., 2017).
Recent work has built on this by also considering the role of either upstream suppliers or
downstream demand heterogeneity, but not both. Results suggest that access to inputs from
domestic and foreign suppliers matters for firms’ marginal costs and product quality, and
thereby performance (e.g., Goldberg et al., 2010, Manova et al., 2015, Fieler et al., 2018,
Bernard et al., forthcominga, Antràs et al., 2017, Boehm and Oberfield, 2018), while final
consumer preferences affect sales on the demand side (e.g., Foster et al., 2016, Fitzgerald et
al., 2016).
   By contrast, we provide a comprehensive treatment of both own firm characteristics
and production network features, on both the upstream and the downstream sides. The
paper is related to Hottman et al. (2016) who also find that demand-side factors such as
variation in firm appeal and product scope rather than prices (marginal costs) drive firm size
dispersion. However, as these authors do not observe the production network, they cannot
distinguish between the impact of serving more customers, attracting better customers, and
selling large amounts to (potentially few) customers. Since they have no information on
the supplier margin, they also cannot compare own versus network supply factors. On the
other hand, while rich in network features, our data do not provide information on prices
or products and thus do not allow for a comparable decomposition into firm appeal and
product scope.
   The paper also adds to a growing literature on buyer-supplier production networks (see
Bernard and Moxnes, forthcoming for a recent survey). Bernard et al. (forthcominga) study
the impact of domestic supplier connections on firms’ marginal costs and performance in
Japan, whereas Bernard et al. (2018), Eaton et al. (2016) and Eaton et al. (2018) explore
the matching of exporters and importers using data on firm-to-firm trade transactions for
Norway, US-Colombia and France, respectively. While we confirm some of the findings in
these papers about the distributions of buyers and suppliers, we examine transaction-level
data on a complete domestic production network and focus on the implications of two-sided
heterogeneity and production networks for the firm size distribution. Using the Belgian
production network data, Magerman et al. (2016) analyze the contribution of the network
structure of production to aggregate fluctuations, while Tintelnot et al. (2017) study the
impact of trade on the domestic production network. In recent work, Baqaee and Farhi
(2018a), Baqaee and Farhi (2018b) and Lim (2017) study the impact of microeconomic
shocks on macroeconomic outcomes in networked environments.
   Finally, the methodology in this paper is related to the econometrics of two-sided hetero-
geneity in other economic contexts (see Bonhomme et al., 2017 for a review). In particular,


                                              5
we estimate seller and buyer fixed effects from production network data in a log linear model
that is conditional on the observed network. A related recent contribution is Kramarz et al.
(2016), who estimate buyer and seller effects in a bipartite trade network. Our work also
builds on employer-employee econometric models in the labor literature (e.g., Abowd et al.,
1999, Card et al., 2013). However, each economic agent plays a unique role in the labor mar-
ket - either a firm or a worker - such that both panel data and worker transitions across firms
are necessary to identify the employer, employee and match effects. We extend the existing
empirical bipartite matching literature along important dimensions. Our setting pertains
to a many-to-many non-bipartite network, as each firm is both a buyer and a supplier in a
production network. This permits the identification of the fixed effects in the cross-section,
such that they are not required to remain constant over time. Moreover, it attenuates the
incidental parameter problem as the number of suppliers per customer and the number of
customers per supplier is relatively large.
    The rest of the paper is organized as follows. Section 2 introduces the data and presents
stylized facts about the Belgian production network. Section 3 agnostically decomposes
firm sales into upstream, downstream and final demand components. Section 4 develops
a theoretical framework with heterogeneous firms in a production network which provides
a structural interpretation of the decomposition in Section 3 and a finer model-based de-
composition of the upstream and downstream components. Section 5 presents the results
of this model-based decomposition, and Section 6 discusses potential issues with the empir-
ical framework. Section 7 introduces a general equilibrium formulation of the model and
performs counterfactual exercises. The last section concludes.


2     Data and Stylized Facts
2.1    Data

We exploit several comprehensive data sources on annual firm operations in Belgium: (i) the
NBB B2B Transactions Dataset, containing the universe of domestic firm-to-firm sales rela-
tionships, (ii) annual accounts, with typical firm characteristics for firms above a minimum
size threshold, (iii) VAT declarations, with more limited firm characteristics for small firms,
and (iv) the Crossroads Bank of Enterprises dataset, containing firms’ industry affiliation.
Unique firm identification numbers allow us to unambiguously match these datasets. We can
thus examine an entire economy in unprecedented detail observing the complete domestic
production network with information on seller firm characteristics, buyer firm characteris-
tics, and seller-buyer transaction values. We use the 2014 cross-section in the main analysis
and data for the 2002-2014 period in robustness exercises and extensions.

                                              6
    The primary data source is the NBB B2B Transactions Dataset, administered by the
National Bank of Belgium (NBB), which documents both the extensive and the intensive
margins of domestic buyer-supplier relationships in Belgium. The dataset reports the sales
relationships between any two VAT-liable enterprises across all economic activities within
Belgium.4 In particular, an observation is the sum mij of sales invoices (in euros, excluding
any value-added tax due) from enterprise i to enterprise j in a given calendar year. Obser-
vations are directed, i.e. mij 6= mji . Coverage is quasi universal, as all relationships with
annual sales of at least 250 euros must be reported, and pecuniary sanctions on late and
erroneous reporting ensure high data quality.
    Data on total sales (turnover), total input purchases, employment and labor costs come
from firm annual accounts maintained by the Central Balance Sheet Office (CBSO) at the
NBB.5 Annual accounts are collected by fiscal year and have been annualized to match
the calendar year in the NBB B2B data. Since there is a firm-size threshold for reporting
turnover and input purchases to CBSO, data on these two variables for small firms below
the threshold comes from firms’ VAT declarations. We keep only firms with at least one
full-time equivalent employee. The main economic activity of each enterprise is available at
the NACE 4-digit level (harmonized over time to the NACE Rev. 2 (2008) version).
    Firms’ sales to final demand is the difference between their turnover and the sum of
all their B2B sales to other enterprises in the domestic production network. Final demand
thus contains sales to final consumers at home, potentially unobserved links in B2B with
very small transaction values, and exports. Firms’ purchases from outside the observed
production network (including imports) is the difference between their total input costs and
the sum of all their B2B purchases.6 The labor share in production at the NACE 4-digit
level is computed as the sum of total employment expenses across all firms in an industry
divided by total production costs in that industry. Similarly, average wages by industry are
calculated as the sum of total labor costs divided by total employment. Further details on
data coverage and preparation are in Appendix A.
4
    See Dhyne et al. (2015) for details on the construction of this dataset. “Enterprise” and “firm” are used
    interchangeably in this paper. The unit of observation is the unique firm identification number, i.e. the
    legal entity of the enterprise.
5
    Total input purchases are the sum of material and service inputs, and include both new inputs and net
    changes in input stocks. Employment is reported as average full-time equivalent employees. Total labor
    costs include wages, social security, and pension contributions.
6
    The estimation procedure requires at least two customers or suppliers to identify the seller or buyer
    effect respectively. Some links (less than 1%) therefore drop out from the analysis (see Section 3).




                                                     7
                                                            Figure 1: Firm sales distribution (2014).
                                       (a) Across sectors.                                                              (b) Within NACE 4-digit industries.
       .4




                                                                                                             .4
       .3




                                                                                                             .3
    Density
      .2




                                                                                                   Density
                                                                                                             .2
       .1




                                                                                                             .1
       0




                   3          4            5       6       7            8        9        10
              10         10           10        10       10        10       10       10
                                                 Turnover (euro)

                                  Primary and Extraction           Manufacturing                             0     −4      −3    −2    −1      0       1      2    3    4
                                  Utilities                        Construction                                   10     10     10    10     10      10      10   10   10
                                  Market Services                  Non−Market Services                                                 Turnover (demeaned)




2.2                    Stylized Facts

This section documents three stylized facts about firm size and firm linkages in the Belgian
domestic production network.7 These facts provide evidence that buyer-supplier relation-
ships are key to understanding firm size dispersion and motivate the subsequent theoretical
and empirical analyses. We present cross-sectional evidence for 2014, but the patterns are
stable over each year in 2002-2014.

Fact 1. The distributions of firms’ total sales, buyer-supplier connections, and buyer-supplier
bilateral sales exhibit high dispersion and skewness.

        Firm size varies dramatically in Belgium, as in other countries. Table 1 provides sum-
mary statistics for firm sales in 2014, both overall and within six broad sectors (primary
and extraction, manufacturing, utilities, construction, market services, and non-market ser-
vices).8 Across the 109,739 firms with sales data that are active in the production network,
average turnover is 6.8 million euros, with a standard deviation of 145 million euros. Similar
patterns hold within each broad sector category.
        The cross-sectional distribution is extremely skewed. Overall, firms at the 90th percentile
generate turnover over 34 times higher than firms at the 10th percentile, while the top 10%
of firms account for 84% of total sales. Although there is some variation in average firm
size across sectors, the dispersion is similar, with large firms being up to four orders of
7
          A subset of these stylized facts echo patterns established for the extensive margin of firm-to-firm linkages
          in the domestic production network in Japan (Bernard et al., forthcominga) and for both the extensive
          and the intensive margins of firm-to-firm export transactions in Norway (Bernard et al., 2018). The
          dispersion in transaction values in a buyer-supplier production network was first documented in the
          Belgian data by Dhyne et al. (2015).
8
          See Table 14 in Appendix A for the classification of industry groups at the 2-digit NACE level.

                                                                                               8
                              Table 1: Firm sales (million euros, 2014).


    Sector                    NACE            N    Mean       St Dev   10th   50th    90th    95th    99th
    Primary & Extraction      01-09       3,061    12.0       432.6     0.2    0.8     4.8     9.5     52.0
    Manufacturing             10-33      18,077    14.4       250.8     0.2    1.1    13.8    34.6    201.8
    Utilities                 35-39         897    39.2       442.9     0.3    1.9    25.7    68.6    495.6
    Construction              41-43      20,201     2.3        13.4     0.2    0.6     3.6     6.9     25.9
    Market Services           45-82      65,175     5.5        79.9     0.2    0.8     6.3    13.4     63.9
    Non-Market Services       84-99       2,328     2.2        26.3     0.1    0.3     2.6     5.5     24.9
    All                                 109,739     6.8       145.1     0.2    0.8     6.6    14.3     78.4

    Note: Summary statistics for the matched CBSO-B2B data. 10th, 50th, etc. refers to values at the
    10th, 50th, etc. percentile of the distribution.


                       Table 2: Number of firm buyers and suppliers (2014).

                               N Mean        St Dev    10th     25th   50th   75th   90th    95th    99th
      # of buyers        590,271 29.3        394.0        1       1      4     11     42      98     400
      # of suppliers     840,607 20.6         49.5        1       3      9     22     46      71     177

     Note: Summary statistics for the B2B data. 10th, 25th, etc. refers to values at the 10th, 25th, etc.
     percentile of the distribution.



magnitude bigger than their industry mean, as shown in Figure 1a. The histogram in Figure
1b illustrates the full firm size distribution, after demeaning at the NACE 4-digit industry
level. Even within narrowly defined industries, these patterns remain.
   Turning to firm-to-firm connections in the domestic production network, the number of
downstream customers per seller (out-degree) and the number of upstream suppliers per
buyer (in-degree) are also very skewed. In 2014, there are 17.3 million sales relationships
among 859,733 firms within Belgium.9 Of these, 590,271 enterprises sell to other firms in
the network, while 840,607 buy from other firms in the network. 31.5% of firms sell only
to final demand, while a small minority of 2.2% do not purchase inputs from the domestic
production network (or do so in an amount less than 250 euros).
     Table 2 summarizes the overall distribution of buyer and supplier connections. Across all
sellers, the average number of customers is 29.3, with a standard deviation of 394. Across all
buyers, the average number of suppliers is 20.6, with a standard deviation of 49.5. The dis-
tribution of buyers per seller is more dispersed than that of suppliers per buyer. Firm-to-firm
9
      The number of firms in the B2B production network is larger than the number of firms in the matched
      B2B-CBSO sample with turnover data, because B2B also contains small firms that do not submit annual
      accounts to CBSO.


                                                      9
                            Figure 2: Distribution of firm buyer and supplier connections (2014).
                         (a) Number of downstream buyers.                                            (b) Number of upstream suppliers.
               .3                                                                         .6




               .2                                                                         .4
     Density




                                                                                Density
               .1                                                                         .2




               0     −2        −1          0         1         2      3    4
                                                                                          0     −2       −1       0          1          2       3    4
                    10        10         10        10        10      10   10                   10       10      10         10         10       10   10
                                    Number of customers (demeaned)                                            Number of suppliers (demeaned)




               Note: The number of customers and suppliers is demeaned at the NACE 4-digit level.



links in the network are also highly concentrated among a few very connected participants:
The median number of customers and suppliers is only 4 and 9 respectively, while the top
1 percent of firms transact with more than 400 buyers and 177 sellers. This dispersion and
skewness across firms within NACE 4-digit industries is also evident in the histograms in
Figure 2. Again, firms with the most customers or suppliers are several orders of magnitude
more connected than the average firm in their industry.
  The intensive margin of firm-to-firm bilateral sales is also very dispersed and skewed,
with the vast share of economic activity concentrated in a small number of buyer-supplier
transactions.10 The mean transaction amounts to 28,893 euros. At the same time, the
median purchase totals only 1,392 euros, and the top 10% of relationships account for 92%
of all domestic firm-to-firm sales by value.

Fact 2. Bigger firms have more buyers and suppliers.

               A sharp pattern in the data is that bigger firms interact with more buyers and suppliers in
the production network. Figure 3a plots the fitted line and 95% confidence band based on a
local polynomial regression of firm turnover on the number of firm downstream customers, on
a log-log scale. Both variables have been demeaned by their NACE 4-digit industry average,
such that the latter corresponds to the point with coordinates (1,1) in the graph. The dotted
line represents the 45 degree line that would obtain if the elasticity of turnover with respect
to the number of customers were 1. Figure 3b repeats the exercise for the relationship
10
               See Table 17 in Appendix B.



                                                                           10
                                                               Figure 3: Firm size and number of buyers and suppliers (2014).
                                                 (a) Firm sales and number of buyers.                                                                      (b) Firm sales and number of suppliers.
                                       3                                                                                                              3
                                  10                                                                                                             10


                                       2                                                                                                              2
     Turnover (euro), de−meaned




                                                                                                                    Turnover (euro), de−meaned
                                  10                                                                                                             10


                                       1                                                                                                              1
                                  10                                                                                                             10


                                       0                                                                                                              0
                                  10                                                                                                             10


                                   −1                                                                                                             −1
                                  10                                                                                                             10


                                           Linear slope: 0.46 ( 0.00)                                                                                     Linear slope: 1.22 ( 0.00)
                                   −2                                                                                                             −2
                                  10       R−squared: 0.23                                                                                       10       R−squared: 0.55
                                            −2                  −1               0           1            2    3                                           −2                   −1              0            1           2    3
                                           10                10                10          10            10   10                                          10                10                10           10           10   10
                                                                        Number of customers, de−meaned                                                                                 Number of suppliers, de−meaned




                                  Note: Local polynomial regressions for firm turnover and number of customers and suppliers are
                                  demeaned at the NACE 4-digit level. Graphs are trimmed at the 0.1st and 99.9th percentiles of
                                  the number of customers and suppliers respectively. The dotted line represents the 45 degree line.
                                  Implied elasticities and R-squared from OLS regressions with NACE 4-digit industry fixed effects
                                  are reported in the lower left corner of each graph.



between firm sales and number of upstream suppliers. Both figures display tightly estimated
upward-sloping lines.11

Fact 3. The distribution of sales across buyers does not vary with the number of buyers.
The distribution of purchases across suppliers widens with the number of suppliers.

                                  Figure 4a illustrates the dispersion of downstream sales across buyers within a seller. For
each firm with at least 10 customers, we take the 10th, 50th and 90th percentile values of
its bilateral sales, demean by its NACE 4-digit industry, and plot the fitted lines from local
polynomial regressions of these percentile values against firms’ out-degree, including 95%
confidence bands. The three lines are almost parallel, albeit slightly declining. The spread
of sales to the 10th percentile, median and 90th percentile customers is essentially the same
for firms with 100 customers and for firms with 10 customers. The slight decline is consistent
with the out-degree elasticity of turnover being less than one in Figure 3a. Together with
Fact 2, this suggests that larger sellers have higher sales primarily because they serve more
customers, but they do not vary sales more across buyers.
   Figure 4b shows the distribution of input purchases across upstream suppliers within
a buyer. For each firm with at least 10 input providers, we obtain the 10th, 50th and
11
                                  Results are similar using downstream sales within the B2B domestic network instead of total turnover
                                  in Appendix B.


                                                                                                               11
                                 Figure 4: Sales distribution across buyers and suppliers within firms.
                           (a) Number of buyers and bilateral sales.                   (b) Number of suppliers and bilateral purchases.
                       0
                  10

                                                                                                  0
                                                                                             10
 mij, de−meaned




                                                                            mij, de−meaned
                   −1
                  10
                                                                                              −1
                                                                                             10




                   −2                                                                         −2
                  10                                                                         10
                            1                   2                 3                                    1             2                    3
                           10                 10                 10                                   10           10                 10
                                           Number of customers                                             Number of suppliers




                  Note: Local polynomial regressions for the value of firm-to-firm transactions at the 10th, 50th and
                  90th percentile of the distribution. Firm-to-firm sales are demeaned by the NACE 4-digit industry
                  of the seller and the customer in each figure respectively. The number of customers and suppliers
                  respectively has been trimmed at the 0.1st and 99.9th percentiles.



90th percentile values of its bilateral purchases, demean by its NACE 4-digit industry, and
graph the fitted lines from local polynomial regressions of these percentile values against
firms’ in-degree, with 95% confidence bands. While purchases from the median supplier are
essentially unchanged across firms with broad and narrow supplier bases, firms that source
inputs from more suppliers systematically buy more from their larger suppliers and less from
their smallest.
    These stylized facts signal an important role for (i) downstream input demand relative to
final output demand, (ii) the number of buyers and suppliers of a firm, (iii) seller and buyer
firm characteristics, and (iv) seller-buyer match characteristics. Motivated by these facts,
we develop a theoretical framework that accommodates them by introducing two-sided firm
heterogeneity in an input-output production network. Importantly, this model enables the
decomposition of the variation in firm size into economically meaningful components related
to both firms’ own characteristics and their participation in the production network.


3                          Initial Decomposition
In this section, we develop an exact decomposition of firm sales into upstream, downstream,
and final demand margins. The downstream component reflects characteristics of a firm’s
customers (i.e., their number and size), while the upstream component captures firm charac-
teristics that remain constant across customers (i.e., average sales to customers, controlling

                                                                       12
for their size). Final demand includes factors unrelated to the domestic production network,
such as sales to final consumers or foreign customers. This approach exploits the granularity
of firm-to-firm transactions to inform the micro-foundations of firm size in a way that would
be impossible without production network data.
   In this part of the paper, the decomposition of firm sales does not rely on a specific model.
Sections 4 and 7 develop a theoretical framework that delivers reduced-form expressions
consistent with the decomposition approach here. The theory also gives the reduced-form
parameters clear economic interpretation.

3.1    Methodology
We start by estimating buyer, seller and buyer-seller match effects using data on sales between
firms in the production network. The specification is a two-way fixed effects regression for
(log) firm-to-firm sales:

                                  ln mij = ln ψi + ln θj + ln ωij ,                             (1)

where ln mij is log sales from i to j relative to the grand mean, ln mij ≡ ln m̈ij − G, where
ln m̈ij is non-demeaned log sales and G is the log of the grand mean. In this OLS regression,
the seller effect ln ψi is identified by the magnitude of sales by i to all customers j, controlling
for total purchases by j. The seller effect is thus related to the average market share of
i among her customers. Intuitively, attractive sellers account for a large share of input
expenditures across all their customers and receive a high ln ψi . Analogously, the buyer effect
ln θj is identified by the magnitude of purchases by j from all suppliers i, controlling for total
sales of i. Intuitively, attractive buyers purchase a disproportionate share of suppliers’ sales
and receive a high ln θj . A positive residual ln ωij reflects match-specific characteristics that
induce a given firm pair to trade more with each other, even if they are not fundamentally
attractive trade partners. We assign structural interpretations to the seller, buyer, and match
effects in Section 4.
   To interpret the variation in ψi and θj , consider the case where the variation in ln mij
is only due to ψi . Sellers i and i0 then differ because i sells more to every customer (while
buyers j and j 0 purchase the same amount from i). Consider next the opposite case where
the variance in ln mij is only due to θj . Sellers i and i0 now differ because i happens to match
with bigger customers than i0 (while sales to a common customer j are identical). In the
first case firm heterogeneity is driven by differences in sales ability, while in the second case
it is driven by differences in matching ability.
     To obtain unbiased OLS estimates, the assignment of suppliers to customers must be
exogenous with respect to ωij , so-called conditional exogenous mobility (Abowd et al., 1999).

                                                 13
This identification assumption, as well as tests for exogenous mobility and functional form
relevance, are discussed in Section 6. Overall, we find support for the log linear model and
the conditional exogenous mobility assumption.
   In order to estimate the two-way fixed effects model, firms must have multiple con-
nections. Specifically, identifying a seller fixed effect requires a firm to have at least two
customers, and identifying a buyer fixed effect requires a firm to have at least two suppliers.
Therefore, single-customer or single-supplier links are dropped in the estimation procedure.
Furthermore, dropping customer A might result in supplier B having only one customer left.
Supplier B would then also be removed from the sample. This iterative process continues
until a connected network component remains (i.e. a within-projection matrix of full rank),
in which each seller has at least two customers and each customer has at least two suppli-
ers. This component is known as a mobility group in the labor literature on firm-employee
matches.
   A production network is a directed graph because firms are simultaneously buyers and
sellers. Production networks are richer and more complex than typical bipartite networks
that have been studied extensively, such as the labor market for firms and workers, the
marriage market for men and women, or the organ market for donors and recipients. For
example, in employer-employee data, worker transitions across firms over time (panel data)
are necessary to identify the employer, employee and match effects. An immediate implica-
tion is that cross-sectional production network data is sufficient to identify the parameters
of interest in our setting. This has two advantages. First, it attenuates the incidental pa-
rameter problem as the number of suppliers per customer and the number of customers per
supplier is relatively large (see Section 2) compared to e.g. the number of job switchers over
time. Second, this setting does not require the typical assumption that the fixed effects are
constant over time, which might be increasingly hard to justify as the time dimension grows.
   Given estimates of Ψ = {ψi , θj , ωij }, firm sales can be exactly decomposed into up-
stream, downstream, and final demand factors. Total sales of firm i are by construction
     P
Si = j∈Ci m̈ij + Fi , where Ci is the set of firm i’s customers and Fi is final demand (i.e.,
sales outside of the domestic network). Combining this with equation (1) yields

                                  ln Si = G + ln ψi + ln ξi + ln βi ,                             (2)
             P
where ξi ≡    j∈Ci   θj ωij and βi is total sales relative to network sales, βi ≡ Si / (Si − Fi ) ≥ 1,
i.e. an inverse measure of final demand. The components ψi and ξi represent upstream
and downstream fundamentals that shape firm size, respectively. To fix ideas, consider the
case where sales dispersion is only due to variance in ψi . Then, large firms have greater
market shares among their customers than small firms. Next, consider the case where sales

                                                  14
                              Table 3: Full vs. Estimation Sample

                        Full Sample                            Estimation Sample
            # Links      # Sellers     # Buyers        Links    Value    Sellers   Buyers
           17,304,408     590,271       840,607         99%      95%       74%       88%

         Note: Summary statistics for firm-to-firm transactions in the raw B2B data and in the
         estimation sample.



dispersion is only due to variance in ξi . Then, large firms transact with more, bigger, and/or
better-matched customers than small firms (while market shares are the same).
   Note that all components of equation (2) are known: Si , βi and G come directly from
the data, while ψi and ξi are estimated from equation (1). In order to assess the role of
each margin, we follow the literature (Eaton et al., 2004, Hottman et al., 2016) and regress
each component (ln ψi , ln ξi , and ln βi ) separately on log sales. By the properties of ordinary
least squares, those three coefficients will sum to unity, and the coefficient magnitudes will
represent the share of the overall variation in firm size explained by each margin (see Ap-
pendix D). All observed and constructed variables are first demeaned by their NACE 4-digit
industry average, such that systematic variation across industries is differenced out.

3.2    Results
As mentioned above, the estimation sample is a subset of the full sample because firms are
required to have at least two customers or suppliers. In practice, the estimation sample
covers the vast majority of observations in the production network. This underlines the
highly connected structure of the production network across all economic activities, even
while it is relatively sparse. For the baseline year, 2014, the estimation spans 17,054,274
firm-to-firm transactions which represent 99% of all links in the data and 95% of their sales
value. We thus obtain seller fixed effects for 436,715 firms and buyer fixed effects for 743,326
firms. The characteristics of the initial and estimation samples are given in Table 3.
   The results from estimating equation (1) are reported in Table 4. Three patterns stand
out. First, the adjusted R2 from the regression is 0.39, showing that the buyer and seller
fixed effects explain a large share of variation in the network data. Second, the variation
in the seller effect ln ψi is larger than that in the buyer effect ln θj . Third, the correlation
between the fixed effects is close to zero, suggesting that high-ψi sellers match with both
high-θj and low-θj buyers (and vice versa).
   The results from Table 4 inform us about the variation in transaction values, mij , but


                                                  15
                                   Table 4: Buyer and Seller Effects
                                      var(lnψi )          var(lnθj )       2cov(lnψi ,lnθj )
                       N           var(lnψi +ln θj )   var(lnψi +ln θj )   var(lnψi +ln θj )
                                                                                               Adjusted R2
         ln mij    17,054,274           0.66                0.32                0.02              0.39

      Note: The table reports the (co)variances of the estimated seller and buyer fixed effects from
      equation (1). Estimation is based on the high-dimensional fixed effects estimator from Correia
      (2016).



not about the variation in firm sales, Si , which is given by the exact firm sales decomposition
in equation (2). To operationalize (2), we use the estimates of Ψ = {ψi , θj , ωij } and balance
sheet data on total sales Si .12 We calculate the network sales ratio, βi , based on total
                                                                                 P
sales and the sum of sales to other firms in the domestic network from B2B ( j∈Ci m̈ij ).
Since firm-to-firm links are only available within Belgium, sales to foreign firms (exports)
are classified as part of final demand.
     Table 5 reports the results from the decomposition of total firm sales. The downstream
side accounts for 81% of the size dispersion across firms, upstream fundamentals account
for 18%, and final demand explains only 1%. The upstream factor ln ψi represents, loosely
speaking, the average market share of i among its customers. The relatively small role for
upstream fundamentals means that average market share is not strongly correlated with total
firm sales. In other words, being an important supplier to one’s customers is only weakly
related to overall firm success. This does not mean, however, that supply-side factors in
general are unimportant in explaining firm size. Rather, the results suggest that supply-side
factors that are orthogonal to our upstream component might be important. Examples of
such factors are efficiency in marketing or skills in finding and attracting a customer base.
On the other hand, relative differences in final demand across firms, as captured by the ratio
of total sales to sales to final consumers, ln βi , account for an economically negligible 1% of
the overall variation in firm size. Thus large firms are not systematically selling relatively
more (or less) to final demand than small firms.
  The importance of each component can be illustrated using a binned scatterplot. In
Figure 5, we group log sales into 50 equal-sized bins, compute the mean of log sales and the
components ln ψi , ln ξi and ln βi within each bin, and then create a scatterplot of these data
points. The result is a non-parametric visualization of the conditional expectation function,
where the sum of the three components on the vertical axis equals log sales on the horizontal
axis. Again, the dominance of the downstream component is apparent, and the relationship
12
     The population of firms in the balance sheet data and production network
                                                                         P data is partly non-overlapping.
     All firms with estimated fixed effects enter the calculation of ξi ≡ j∈Ci θj ωij , even if they are not in
     the balance sheet data themselves.


                                                         16
                    Figure 5: Overall Decomposition.


         ξi
          c
     1   βi
10
         ψi




     0
10




 −1
10
               −1                   0                      1                        2
              10                  10                     10                     10
                                       Turnover (S)


Note: This binned scatterplot groups firms into 50 equal-sized bins by log sales,
computes the mean of log sales and the components ln ψi , ln ξi and ln βi within
each bin, and graphs these data points. The result is a non-parametric visualiza-
tion of the conditional expectation function.




                                        17
                                Table 5: Overall Decomposition.


                            N       Upstream      Downstream        Final Demand
                                      lnψi           lnξi                lnβi
                   lnSi   94,330      .18∗∗∗           .81∗∗∗             .01∗∗
                                       (.00)            (.00)             (.00)

                 Note: The table reports coefficient estimates from OLS regressions of
                 a firm size margin (as indicated in the column heading) on total firm
                 sales. All variables are first demeaned by their 4-digit NACE industry
                 average. Standard errors in parentheses. Significance: * < 5%, ** <
                 1%, *** <0.1%.



is close to linear across the entire distribution of firm sales.
   These findings suggest that key to understanding the vast firm size heterogeneity observed
in modern economies is how firms manage their sales activities, and specifically how they
match and transact with buyers in the production network.


4     Theoretical Framework
This section develops a theoretical framework that serves several purposes. First, the model
allows for various sources of firm heterogeneity both on the demand side (e.g., being con-
nected to many or large customers) and on the supply side (e.g., having access to many or
cheap intermediate inputs). Second, the framework gives a clear mapping between model
parameters and firm-level estimated coefficients from Section 3. Third, the framework per-
mits a finer model-based decomposition of firm sales into various upstream and downstream
margins with clear economic interpretations (Section 5.2). And finally, the model can be
used for counterfactual analyses (Section 7).
    Our starting point is a model in which firms are heterogeneous in productivity or quality.
Firms operate in a production network and sell to other firms and to final demand. In
addition to productivity or quality, a firm’s size can depend on its input prices and on how
many and what type of buyers it is connected to. Input prices can be low (and sales high)
if firms have many suppliers, low-price, and/or better-matched suppliers. We do not model
the firm-to-firm matching decision itself, but rather condition on the equilibrium network
structure that is observed in the data. We discuss the empirical implications of this approach
in Section 6.




                                                  18
4.1      Technology
To implement our approach, we start with the following production function of firm i:
                                                                   1−αi
                                        yi = κi zi liαi u1−γ
                                                         i
                                                            i γi
                                                             vi               ,

where yi is output (in quantities), zi is productivity, li is the amount of labor used by firm i,
αi is the labor share, ui is intermediate inputs purchased from outside the domestic network
(e.g., imported inputs), and κi > 0 is a normalization constant.13 vi is a constant elasticity
of substitution (CES) domestic network input bundle with associated cost share γi :
                                                           !σ/(σ−1)
                                    X              (σ−1)/σ
                             vi =        (φki νki )                 ,
                                            k∈Si

where νki is the quantity purchased from firm k, Si is the set of suppliers to firm i, and σ > 1
is the elasticity of substitution across suppliers.14 φki is a demand shifter that captures the
idea that firms (and industries) may have very different production technologies, and that
their purchases from a given supplier may vary. The corresponding inverse input price index
is Pi1−σ = k∈Si (pki /φki )1−σ , where pki is the price charged by supplier k to firm i. The
           P

marginal cost of the firm is then
                                                                  1−αi
                                              wiαi w̃i1−γi Piγi
                                         ci =                             ,                                  (3)
                                                        zi
where wi and w̃i are the wage and the price of non-network inputs, respectively. We allow
for firm-level heterogeneity in most of the parameters of the model (e.g., wages and the labor
share). For tractability the elasticity of substitution σ is identical across firms and inputs.15

4.2      Firm-to-Firm Sales, Total Sales and Total Purchases
Each firm faces demand from other firms as well as from final demand. Given the assumptions
about technology, sales from firm i to j are
                                        σ−1
                                         φij
                                m̈ij =        Pjσ−1 γj Mj ,                                                  (4)
                                         pij
                                               −(1−γ )(1−α )                  −γ (1−α )
13
      In particular, κi ≡ αi−αi (1 − γi ) (1 − αi )  i     i
                                                             γi (1 − αi ) i     i
                                                                                  . This normalization maps the
      production function to the cost function, and simplifies the expression for the cost function without any
      bearing on our results.
14
      The input bundle vi captures capital inputs acquired from the network (e.g. machinery, equipment).
      On the one hand, this may overstate the flow of new capital inputs used in current production, since
      new investment goods will be used over many periods. On the other hand, this may understate the flow
      of total capital inputs used in current production, since it ignores the stock of accumulated capital.
15
      For the remainder of the paper, the elasticity of substitution will play no important role, and all results
      in the paper are independent of the exact value of σ.

                                                       19
                                                                               P
where Mj are total intermediate purchases by firm j, and γj Mj =                  i∈Sj   m̈ij corresponds to
the sum of domestic network purchases by firm j, where Sj is the set of domestic network
suppliers of firm j.
   Match quality φij can be written as φij = φi φ̃ij , where φi captures the average quality of
firm i and φ̃ij is an idiosyncratic match term. Similarly, prices can be written as pij = τi τ̃ij ci ,
where ci is marginal cost, τi reflects the average markup and trade cost of i across its
customers j, and τ̃ij is the match-specific trade cost/markup term. This assumption implies
that one can separate the systematic variation across firms from the variation across matches
in sales from i to j.
     τ̃ij can contain any type of price variation, such as heterogeneous trade costs or markups
across a seller’s customers. It will be useful to collapse parameters that are related to either
the buyer, the seller, or the buyer-seller pair. Equation (4) can then be rewritten as:


                                              m̈ij = ψ̈i θ̈j ω̈ij ,                                      (5)

where
                                                                 σ−1
                                                          φi
                                             ψ̈i ≡
                                                         τ i ci
                                             θ̈j ≡ Pjσ−1 γj Mj
                                                          !σ−1
                                                     φ̃ij
                                            ω̈ij ≡             .                                         (6)
                                                     τ̃ij

     There is a well-defined mapping from the model in this section to the empirical model
from Section 3, and so we normalize the logs of ψ̈i , θ̈j , and ω̈ij by their respective means
(across all seller-buyer pairs), ln ψi ≡ ln ψ̈i − ln ψ̈, ln θj ≡ ln θ̈j − ln θ̈ and ln ωij ≡ ln ω¨ij − ln ω̈.
Firm-to-firm sales can then be written as

                                     ln mij = ln ψi + ln θj + ln ωij .                                   (7)

We refer to ψi as a seller effect, θj as a buyer effect, and ωij as a match effect. In the model,
the seller effect is decreasing in average quality adjusted prices, τi ci /φi , while the buyer effect
θj is increasing in total purchases Mj and the input price index Pj . The seller, buyer and
match-specific components are by construction mean zero.The model thus delivers a simple
log linear expression for firm-to-firm sales, just as in the reduced-form equation (1) in Section
3.
   For the model-based results in Section 5, the only required assumptions are the production
function, cost minimization and the functional forms of pij and φij . In particular, there is
no need to assume anything about market structure or firms’ pricing behavior. However,

                                                      20
a few additional elements are necessary to solve the general equilibrium and to perform
counterfactuals. These are introduced when needed in Section 7.

4.3      A Reflection Problem and Solution
While one can estimate the parameters Ψ = {ψi , θi , ωij } from production network data,
their interpretation is not straightforward because they will embody information about the
firm itself as well as information about the firm’s suppliers. This can be seen directly from
equation (6) as both the seller and the buyer effects for firm i, ψi and θi , depend on its
suppliers’ prices via the input price index Pi .
     This reflection property means that firm-level fundamentals, such as productivity or
quality, cannot be isolated directly from the seller and buyer effects. However, a manipulation
of the equations in (6) results in
                                                     σ−1                      γi (1−αi )
                                              φi zi                        θi
                                Zi ≡ ki                      = ψi                              ,                (8)
                                               τi                       γ i Mi

where Zi captures a cluster of parameters only related to the firm itself (productivity/quality,
markups/trade costs).16 Henceforth, we refer to Zi as production capability and to θi as sourc-
ing capability. Production capability Zi is a combination of efficiency and quality conditional
on the firm’s connections and can be isolated simply by multiplying the seller effect with a
transformation of the buyer effect, [θi / (γi Mi )]γi (1−αi ) , as summarized in Proposition 1:

Proposition 1. The seller and buyer effect of firm i are both functions of the prices charged
by firm i’s suppliers. The transformation Zi ≡ ψi [θi / (γi Mi )]γi (1−αi ) isolates the production
capability of firm i, which is independent of the characteristics of firm i’s suppliers.

     By exploiting the production network data, this methodology overcomes the reflection
problem. What is the economic intuition for this result? Recall that θi / (γi Mi ) is proportional
to the input price index Piσ−1 , e.g. if θi is small and total purchases Mi are large, input
purchases must be spread out over many suppliers, leading to a low input price index Pi . A
firm with low input prices will sell more to each customer, leading to a high seller effect ψi .
The seller effect for this particular firm therefore overstates its inherent production capability.
By multiplying the seller effect with θi / (γi Mi ), we penalize firms with low input prices and
therefore correct for the reflection bias. Note that the reflection problem is weaker the higher
the labor share, αi . For example, if the labor share is close to one, then input costs will
be negligible and the seller effect ψi will be highly correlated with production capability. In
                                                     1−σ
             ¯ ¯                                                   ¯     ¯
                              
                                      (1−γi )(1−αi )
16
      ki ≡ ψ̈ −1 θ̈−γi (1−αi ) wiαi w̃i                   , where ψ̈ and θ̈ are the geometric means of ψ̈i and θ¨i ,
      respectively.

                                                             21
the limit as αi → 1, i.e. when input-output linkages are absent, the bias stemming from the
reflection problem becomes zero.
   Proposition 1 will be useful in Section 5 where we back out Zi and perform additional
decompositions, as well as in Section 7 where we calibrate the model.

4.4       The Input Price Index
We next discuss the relationship between firms’ input price index and buyer effect θj . Using
the expressions for ci , Zi and ωij , the inverse input price index, Pi1−σ , can be written as

                                              X  pki 1−σ
                                  Pi1−σ   =
                                              k∈Si
                                                      φki
                                              X       (1−σ)γk (1−αk )
                                          =          Pk                 g̃k Zk ωki           ∀i,   (9)
                                              k∈Si


where g̃k is a parameter.17 The input price index of firm i depends on the input price indices
of i’s suppliers, and so on. The input price index is therefore a fixed point of the function
in equation (9). Appendix C proves that Pi1−σ retrieved from the buyer effect in equation
(6), Pi1−σ ∝ γi Mi /θi , obeys the equilibrium constraints in equation (9) as summarized in
Proposition 2:

Proposition 2. The inverse input price index is a fixed point of the function
                                                 X          (1−σ)γk (1−αk )
                                     Pi1−σ =              Pk                  g̃k Zk ωki .
                                                 k∈Si


γi Mi /θi is proportional to Pi1−σ from the fixed point of the function above.

Proof. See Appendix C.

     An immediate implication of this result is that the buyer fixed effect θi estimated in
Section 3 can be used to calculate the equilibrium Pi1−σ (up to a constant) simply by using
the formula γi Mi /θi . Figure 10 in Section 7 confirms that Proposition 2 holds perfectly in
our quantitative application.
     This concludes the first part of the model. The next section presents the first part of the
quantitative application using the insights from Propositions 1 and 2. Section 7 returns to
the theory to characterize the general equilibrium and perform counterfactuals.
             ¯¯             ¯
17
      g̃k ≡ ψ̈ θ̈γk (1−αk ) ω̈.




                                                               22
5      Model-Based Results
This section will use the insights from the theoretical model to explore in more detail the
origins of firm heterogeneity. Armed with Propositions 1 and 2, we document the correlation
between the inverse input price index, ln Pi1−σ , production capability, ln Zi , and other firm
outcomes. We then decompose the upstream and downstream margins of firm size to provide
additional evidence on its sources of variation.
    The ingredients for the analysis are the estimates from the two-way fixed effects model
in Section 3, Ψ = {ln ψi , ln θj , ln ωij }, along with balance sheet data on total sales, Si , total
purchases, Mi , the share of inputs sourced from the domestic network, γi , and the labor
share, αi .18 These enable the calculation of production capability from Proposition 1, Zi =
ψi [θi / (γi Mi )]γi (1−αi ) , and the inverse input price index from Proposition 2, Pi1−σ ∝ γi Mi /θi .

5.1      Correlations
We start by considering the correlations between various firm characteristics in our data.
Column 1 in Table 6 shows that firm sales are strongly positively correlated with both the
upstream, ln ψi , and the downstream, ln ξi , components. The correlation coefficient with the
downstream component is more than twice as large, mirroring the earlier decomposition.
The downstream and upstream components are themselves negatively correlated, implying
that firms with many customers or with particularly good customers (leading to a high ξi )
tend to have smaller average market shares among those customers (leading to a low ln ψi ).19
Our interpretation of this finding is that firms are unlikely to succeed on both the intensive
and the extensive margins: some firms become large by accumulating a customer base while
other firms become large by being important suppliers to a smaller number of firms, and few
firms manage to do both.
   Firm sales are strongly positively correlated with the inverse input price index, Pi1−σ , such
that larger firms tend to benefit from cheaper input prices. In the model, low input prices
can arise because a firm has many suppliers or matches with particularly good suppliers.
The inverse price index, Pi1−σ , is positively correlated with ψi , showing that firms with low
input prices tend to have higher average market shares among their customers. Recall from
Proposition 2 that Pi1−σ is calculated from γi Mi /θi ; seller effects ψi are therefore negatively
correlated with θi / (γi Mi ). This result confirms a theoretical prediction from Proposition
18
      The baseline case uses 4-digit industry averages of αi and γi . Section 6 shows results with firm-level
      αi and γi . Note that inputs purchased from outside the network can be either from foreign suppliers
      or from domestic suppliers outside the network estimation sample (because they supply less than 250
      euro worth of inputs or have too few network connections).
19
      Recall from Section 3 that the downstream component is large when firms transact with more, bigger
      and/or better-matched customers.

                                                     23
                                    Table 6: Correlation Matrix.

        Firm Size Component                   ln Si    ln ψi   ln ξi   ln Pi1−σ   ln nci   ln nsi   ln Zi

        Total Sales, ln Si                     1
        Upstream, ln ψi                       .23        1
        Downstream, ln ξi                     .66      -.16      1
        Inverse input price index, ln Pi1−σ   .91      .14     .61         1
        # Customers, ln nci                   .49      -.33    .85       .50        1
        # Suppliers, ln nsi                   .76      -.02    .63       .76       .57       1
        Production Capability, ln Zi          -.31      .79    -.51      -.40     -.59     -.51      1

       Note: All correlations are significant at 5%. All variables are demeaned at the NACE
       4-digit level.




1, namely that the seller and buyer effects are related because low input prices (low buyer
effect) feed into high market shares (high seller effect).
   Recall that production capability Zi is a combination of efficiency and quality conditional
on the firm’s connections. Production capability is strongly positively correlated with the
upstream component and strongly negatively correlated with the downstream component
and with the inverse input price index. Thus firms with higher production capability have
bigger market shares among their customers (high ψi ), but their input costs are higher (low
Pi1−σ ) and they have fewer or smaller downstream customers (low nci and low ξi ). As a
result, high production capability firms have lower sales unconditionally, but nevertheless
higher sales conditional on their input prices: When we regress ln Si on ln Zi controlling for
ln Pi1−σ , the coefficient estimates on production capability (0.061***) and the inverse input
price index (1.01***) are both positive and significant at 0.1%.
    These results, coupled with the initial decomposition findings in Section 3, are difficult
to reconcile with standard heterogenous firm models. They suggest that multiple upstream
and downstream dimensions of firm activity underpin sales dispersion when firms interact in
production networks. One interpretation of our findings is that firm attributes that matter
for finding customers and suppliers (e.g., managerial talent and marketing capacity) are
orthogonal, or negatively related, to firm attributes that determine sales conditional on a
match (e.g., productivity or quality).

5.2    Downstream and Upstream Decompositions
The initial decomposition results in Section 3 provide evidence for the importance of up-
stream, downstream, and final demand margins in the variance of firm sales. Downstream


                                                      24
factors contribute over 80 percent of total variance and upstream components 18 percent.
This section uses the theoretical framework developed above to further decompose the up-
stream and downstream margins, and thereby shed more light on the sources of firm size
heterogeneity.
    Starting with the downstream side, which accounts for the majority of firm sales disper-
                         P
sion, the parameter ξi ≡ j∈Ci θj ωij can be expressed as

                               ln ξi = ln nci + ln θ̄i + ln Ωci ,                            (10)
                                                Q           1/nci
       c
where ni is the number of customers and θ̄i ≡        j∈Ci θj        is the average customer capa-
bility.20 The covariance term Ωci is defined as
                                                  1 X θj
                                          Ωci ≡           ωij .
                                                  nci j∈C    θ̄i
                                                         i


     Each of these components has an intuitive economic interpretation. First, firms face
high network demand if they are linked to many customers (high nci ). Second, they face high
network demand if their average customer has high sourcing capability (high θ̄i ). Third, they
face high network demand if the covariance term Ωci is large, i.e. if large customers (high θj )
also happen to be good matches (high ωij ). These components are directly available in the
data (nci ) or can be calculated from Ψ = {ln ψi , ln θj , ln ωij } (θ̄i and Ωci ).
     Turning to the upstream decomposition, a firm may be large because it has high pro-
duction capability (high Zi ), or because it benefits from cheap or high-quality inputs (low
Pi ). In turn, the input price index can be decomposed into the number of suppliers, average
supplier capability, and a covariance term. This can be shown in three steps. First, from
equation (8), the production capability of a firm, Zi , is a function of its estimated buyer and
seller effects. Second, from equation (5), log total network purchases are
                                                          X
                             ln (γi Mi ) = G + ln θi + ln   ψk ωki .                                         (11)
                                                              k∈Si

Third, solving equation (8) for ln ψi and substituting for ln (γi Mi /θi ) using equation (11)
yields

                    ln ψi = ln Zi + γi (1 − αi ) G + ln nsi + ln ψ̄i + ln Ωsi ,
                                                                            
                                                                                                (12)
                                                         1/nsi
where nsi is the number of suppliers, ψ̄i ≡
                                              Q
                                                 k∈Si ψk        is average supplier capability, and
the covariance term Ωsi is
                                                  1 X       ψk
                                         Ωsi ≡     s
                                                         ωki .
                                                  ni k∈S    ψ̄i
                                                         i

20
                                                                                  (1/nci )
                                                                                             P
     By the  P properties of ordinary least squares, the average term                        j∈Ci   ln ωij     =
     (1/nsi ) k∈Si ln ωki = 0 and is therefore omitted from the expression.

                                                    25
                                Table 7: Downstream Decomposition.


                          # Customers    Avg Customer Capability      Customer Covariance
                             ln nci                 ln θ̄i                    ln Ωci
                  ln ξi     .71∗∗∗                 .03∗∗∗                     .26∗∗∗
                             (.00)                  (.00)                      (.00)

               Note: The table reports coefficient estimates from OLS regressions of a firm
               size margin (as indicated in the column heading) on the downstream factor,
               ln ξi . All variables are demeaned by 4-digit industry averages. Standard errors
               in parentheses. Significance: * < 5%, ** < 1%, *** <0.1%.



Detailed derivations are found in Appendix C.2. Again, each component of this expression
is either observed directly (αi , γi and nsi ) or can be calculated from Ψ = {ln ψi , ln θj , ln ωij }
(Zi , ψ̄i and Ωsi ).
     The interpretation of each element is as follows. A firm has a large market share among
its customers (high ψi ) because it is inherently productive or high-quality (high Zi ), because
it has many suppliers (high nsi ), because those suppliers are on average attractive suppliers
(high ψ̄i ), or because attractive suppliers also happen to be a good match (high Ωsi ).
     As with the overall decomposition, we regress each component in equations (10) and
(12) on ln ξi and ln ψi , respectively, to evaluate its contribution to the variation in ln ξi or
ln ψi . The coefficient estimates across components will mechanically sum to one because
the left and right hand side of equations (10) and (12) are by construction identical. As
above, all components are demeaned by their 4-digit industry average, so that variation
across industries is differenced out.21
   The limited assumptions placed on the economic environment imply that this is an ag-
nostic firm size decomposition that enables an assessment of the contribution of different
margins to the overall variation in firm size. Our approach imposes no restrictions on the
absolute or relative contribution of these margins.

5.2.1     Downstream Decomposition

Table 7 reports the results for the downstream decomposition. Much of the variation in
the downstream component across firms (71 percent) can be attributed to the extensive
margin, i.e. the number of (domestic) buyers, ln nci . On the other hand, the average sourcing
capability across a firm’s customers, ln θ̄i , and the customer covariance term, ln Ωci , contribute
21
     The term in G, the grand mean, drops out from the upstream decomposition since α and γ only vary
     at the NACE 4-digit level and we demean all components by NACE 4-digit sector.


                                                     26
                             Figure 6: Downstream decomposition.


                     c
                   ni
               1
           10      θbari
                    c
                   Ωi




               0
           10




             −1
          10


                                −1                   0                   1                      2
                              10                  10                   10                  10
                                         Downstream component (ξ)


           Note: This binned scatterplot groups firms into 50 equal-sized bins by downstream
           sales component ln ξi , computes the mean of ln ξi and its sub-components ln nci ,
           ln θ̄i and ln Ωci within each bin, and graphs these data points. The result is a
           non-parametric visualization of the conditional expectation function.



a much more modest 3% and 26%, respectively. As above, the results are displayed in a
binned scatterplot in Figure 6, which reveals that the patterns are stable across 50 bins by
firms’ downstream sales component.
   On the downstream side, the single most important advantage of large firms is that they
successfully match with many buyers. The covariance term is also substantial, suggesting
that relative to smaller firms, bigger firms more effectively concentrate sales among large
buyers with high sourcing capability that are very good bilateral matches. On the other
hand, the negligible role for average customer capability shows that large firms do not match
with more capable buyers on average.

5.2.2   Upstream Decomposition

Table 8 reports the results for the upstream decomposition. As above, the results are also
shown using a binned scatterplot in Figure 7. The seller-specific production capability, ln Zi ,
drives practically the entire upstream factor (93%). The remaining variation comes from the


                                                  27
                                 Table 8: Upstream Decomposition.

                 Own Prod Capability      # Suppliers    Avg Suppl. Capability    Suppl. Cov.
                         ln Zi               ln nsi               ln ψ̄i              ln Ωsi
         ln ψi          .93∗∗∗              -.01∗∗∗              .03∗∗∗              .06∗∗∗
                         (.00)               (.00)                (.00)               (.00)

      Note: The table reports coefficient estimates from OLS regressions of a firm size margin (as
      indicated in the column heading) on the upstream factor, ln ψi . All variables are demeaned
      by 4-digit industry averages. Standard errors in parentheses. Significance: * < 5%, ** < 1%,
      *** <0.1%.



covariance term (6%), average supplier capability (3%) and the number of suppliers (-1%).
   These results reveal that, first and foremost, inherent firm characteristics such as produc-
tivity or quality (ln Zi ) explain differences in average market shares among customers, ψi .
In addition, firms that have good suppliers (high ln ψ̄i ), or that source relatively more from
good suppliers that they are well-suited to (high ln Ωsi ), are also more successful in terms of
sales, but the economic magnitude of these effects is small.


6     Discussion
This section first discusses the empirical relevance of the functional form chosen for firm-to-
firm sales in equation (1). It then examines the necessary assumptions on the assignment
process of buyers and sellers for OLS to identify the underlying parameters of interest, and
develops a test for conditional exogenous mobility in the context of a production network.
Finally, it presents more evidence on the robustness of the results. Appendix D.5 provides
additional extensions and sensitivity checks.

6.1    Functional form
The log-linear relationship in equation (1) predicts the following: (i) expected sales from
seller i to customer j are increasing in the average sales of i to other customers k; (ii)
expected purchases by buyer j from seller i are increasing in the average purchases by j from
other suppliers k.
    Properties (i)-(ii) can be tested non-parametrically as follows. For each seller i and buyer
j, calculate the leave-out mean of log sales (s̄−l                    −l
                                                i ) and purchases (m̄j ) across its buyers and




                                                  28
                                   Figure 7: Upstream Decomposition.


                 2
             10                    s
                           Zi      ni
                                    s
                           ψbari   Ωi



                 1
             10




                 0
             10




               −1
            10
                      −1                      0                         1                         2
                     10                    10                         10                        10
                                             Upstream component (ψ)


         Note: This binned scatterplot groups firms into 50 equal-sized bins by upstream sales
         component ln ψi , computes the mean of ln ψi and its sub-components ln Zi , ln nsi , ln ψ̄i
         and ln Ωsi , and graphs these data points. The result is a non-parametric visualization of
         the conditional expectation function.



suppliers, excluding customer/supplier l, respectively:22
                                          P
                                            j∈Ci \l ln mij
                                  s̄−l
                                    i =
                                             nc − 1
                                          P i
                                            k∈Sj \l ln mkj
                                  m̄−l
                                     j =                   .
                                              nsj − 1

Then sort firms into decile groups based on s̄−l      −l
                                              i and m̄j , denoting the decile group the firm
belongs to as qs̄ = 1, .., 10 and qm̄ = 1, .., 10, respectively. Finally, calculate the mean of
ln mij for every decile group pair, ln mqs̄ ,qm̄ , e.g. the average ln mij for the seller-buyer pairs
in (qs̄ , qm̄ ) = (1, 1), and so on.
     Figure 8 illustrates the results using a heatmap. The decile groups qs̄ and qm̄ are plotted
on the horizontal and vertical axes, respectively. ln mij is increasing in the average sales from
22
     Using the overall mean generates a mechanical relationship between e.g. seller size and sales between i
     and j. We calculate s̄−l       −l
                           i and m̄j for all (i, l) and (j, l) pairs respectively. Firms with only one customer
     or supplier are by construction omitted from the sample.


                                                      29
                         Figure 8: Average log sales across seller and buyer decile groups.

                         10
                                                                                     3
                          9
                                                                                     2.5
                          8                                                          2
    Buyer decile group




                          7                                                          1.5




                                                                                            lnm (mean)
                          6                                                          1

                          5                                                          .5

                          4                                                          0

                          3                                                          −.5

                                                                                     −1
                          2
                                                                                     −1.5
                          1
                              1   2    3     4    5      6     7   8    9    10
                                             Seller decile group



Note: The figure shows the average of ln mij in all decile group pairs (qs̄ , qm̄ ).




                                                          30
i to other customers k (moving from left to right in the diagram), and ln mij is increasing
in the average purchases of j from other suppliers k (moving from bottom to top in the
diagram).

6.2      Assumptions on the Assignment Process
Equation (1) is a two-way fixed effects model similar to the models that are used in the
employer-employee literature (Abowd et al., 1999; Card et al., 2013).23 OLS estimates of
ln ψi and ln θj will identify the effect of seller and buyer characteristics if the following
moment conditions are satisfied:
                                             (
                                                 E[s0i r] = 0 ∀i
                                                                                                         (13)
                                                 E[b0j r] = 0 ∀j.
Here S = [s1 , ..., sN ] is the N ∗ × Ns seller fixed effects design matrix, B = [b1 , ..., bN ] is
the N ∗ × Nb buyer fixed effects design matrix, r is the N ∗ × 1 vector of residual match
effects, and N ∗ , Ns and Nb are the number of matches, sellers and buyers, respectively.
The first condition states that for each seller i, the average ln ωij across buyers j is zero,
while the second condition states that for each buyer j, the average ln ωij across sellers i is
zero. Intuitively, a high ln ωij that is common across customers j of i will be automatically
loaded onto i’s seller effect (and similarly for suppliers i of j). In other words, these moment
conditions require that the assignment of suppliers to customers is exogenous with respect
to ωij , so-called conditional exogenous mobility in the labor literature.
   It is instructive to review four cases when these moment conditions hold. First, they hold
if firms match based on their seller and buyer effects, e.g., highly productive firms match with
more and/or different customers/suppliers than less productive ones. Second, the assumption
holds if firms match based on idiosyncratic pair-wise shocks that are unrelated to ln ωij .One
example of this is idiosyncratic fixed costs, such as costs related to search and matching,
which affect profits for a potential match but not the value of bilateral sales.24 Third, the
moment conditions are consistent with our theory. In the model, a buyer j that receives a
favorable shock from i will get a lower CES input price index Pj .25 The estimation allows for
23
      The linear fixed-effects approach imposes no restrictions on the seller and buyer effects, unlike random
      or mixed effects models. With random effects, one also needs to model the network formation game
      to assess the plausibility of the required distributional assumptions for unobserved heterogeneity (see
      Bonhomme (Forthcoming)).
24
      Bernard et al. (forthcominga) and Lim (2017) develop models where idiosyncratic fixed costs determine
      matching. Eaton et al. (2018) develop a quasi-random matching model where matching shocks are
      unrelated to ωij .
25
      The buyer effect θj is proportional to γj Mj /Pjσ−1 and the input price index Pj is determined by ωij
      along with other variables, see Proposition 2.


                                                      31
arbitrary seller-specific correlations between ωij and θj , i.e. corr (ln ωij , ln θj ) 6= 0 ∀ i. Finally,
and along the same lines, the moment conditions also allow for a seller i to charge higher
markups (low ωij ) to certain buyers (e.g. high θj buyers), and for a buyer j to be charged
higher markups by certain sellers (e.g., high ψi sellers). Formally, corr (ln ωij , ln θj ) 6= 0 ∀ i
and corr (ln ωij , ln ψi ) 6= 0 ∀ j. The key requirement is that the average of ln ωij for every
buyer and seller is zero.
   Now consider the case of endogenous mobility. To fix ideas, assume that matching is
based on the idiosyncratic match component of sales, ωij , together with the seller effect ψi .
In that case, only high ψi sellers would want to match with low ωij buyers. OLS would
then give a downward bias in the estimated ψi , because OLS imposes that the average ln ωij
across customers is zero.
   To explore the possibility that matching shocks are correlated with sales shocks, we test
conditional exogenous mobility as follows. Consider firm i selling to customers 1 and 2. The
expected difference in bilateral sales is

∆ ln mi ≡ E [ln mi2 − ln mi1 | (i, 1) , (i, 2)] = ln θ2 − ln θ1 + E [ln ωi2 − ln ωi1 | (i, 1) , (i, 2)] .

Consider the case θ2 > θ1 . Under exogenous mobility, the last expectation term is zero, and
∆ ln mi is unrelated to firm i characteristics. Under endogenous mobility, the last expectation
term is non-zero, and ∆ ln mi is potentially a function of firm i characteristics. Now seller
i will only want to match with customer 1 if ωi1 is sufficiently large. The expectation
E [ln ωi2 − ln ωi1 | (i, 1) , (i, 2)] is then negative. Moreover, for small sellers (low ψi ), the
size of ωi1 is important for whether a match occurs or not, while for large sellers (high
ψi ), the size of ωi1 is less important (since matching is determined by both ψi and ωij ).
Under endogenous mobility, the expectation is therefore less negative for high-ψi than low-
ψi firms, so that ∆ ln mi is greater for high-ψi than low-ψi firms. Under exogenous mobility,
by contrast, ∆ ln mj should be unrelated to ψi .26
     Going back to the seller and buyer decile groups constructed above, these predictions
can be tested by looking at ln mqs̄ ,qm̄ when moving from a small to a big customer, for
different groups of sellers. Figure 9 shows the results. Each line represents the mean of log
sales for a given seller decile group (1,..,10). Within a seller group, we calculate ln mqs̄ ,qm̄
to small customers (buyer decile group 1) and to big customers (buyer decile group 10).
                                                                                       0
Under exogenous mobility, those lines should be parallel, i.e. for buyer bins qm̄ and qm̄ ,
ln mqs̄ ,qm̄ − ln mqs̄ ,qm̄
                         0  does not depend on the seller decile group. The lines are, to a large
degree, parallel, in particular for the seller decile groups 2 to 9. Parallel lines are a sufficient
26
     Card et al. (2013) test for endogenous mobility for employer-employee matches using a related, but
     different, test.


                                                   32
                Figure 9: Average log sales across seller and buyer decile groups.




                    3
                    2
               lnm (mean)
                     1




                                10


                                 9
                    0




                                 8
                                 7
                                 6
                                 5
                                 4
                                 3
                    −1




                                 2
                                 1
                            0        2            4              6            8             10
                                                 Buyer decile group


           Note: The figure shows ln m  ¯ ij across buyer decile groups qm̄ = 1, .., 10. Each line
           represents a seller decile group, qs̄ = 1, ., 10.



but not necessary condition for exogenous mobility: If the data generating process is not
linear in logs, then one could find non-parallel lines even under exogenous mobility.
    One can test for this non-parametrically as follows. Using the buyer and seller bins
defined above, exogenous mobility implies that
                                                                               
                               0 − ln mq 0 ,q
                    ln mqs̄0 ,qm̄                − ln mq    ,q 0 − ln mq ,q      = 0, (14)
                                        s̄    m̄         s̄    m̄       s̄  m̄


for any bins qs̄ , qs̄0 , qm̄ and qm̄
                                   0
                                      . We form these averages for qs̄0 = qs̄ + 1 and qm̄
                                                                                       0
                                                                                          = qm̄ + 1
and test the null hypothesis that the double difference equals zero. This yields 81 separate
hypothesis tests across all buyer-seller pair bins.27 Overall, the results mirror those in Fig-
ure 9: the double differences are not significantly different from zero in the middle of the
distribution, whereas we find significant deviations in the tails. Significant deviations are
typically relatively small: e.g. moving from a 6th to 7th decile buyer yields 12% more sales
for seller decile 9 and 14% more sales for seller decile 10. All 81 hypothesis tests are reported
in Appendix D.1.
  Separately, Appendix D.3 presents a Monte Carlo simulation to examine how well the
empirical model recovers the structural parameters.
27
     t-values are calculated using Welch’s t-test.

                                                     33
                        Table 9: Business Groups: Overall Decomposition.


                               N      Upstream      Downstream        Final Demand
                                        lnψi           lnξi                lnβi
                     lnSi   86,485      .16∗∗∗           .83∗∗∗             .01∗∗
                                         (.00)            (.00)             (.00)

                   Note: The table reports coefficient estimates from OLS regressions of
                   a firm size margin (as indicated in the column heading) on total firm
                   sales. All variables are first demeaned by their 4-digit NACE industry
                   average. Standard errors in parentheses. Significance: * < 5%, ** <
                   1%, *** <0.1%.



6.3      Business Groups
There remains the possibility that intra-firm trading and ownership structure across VAT
enterprises is affecting the results. In particular, while the VAT ID is the legal entity of a firm
in Belgium, some firms might be owned by other firms, generating intra-firm trade between
parents and affiliates, which might not be subject to typical market forces. While the VAT
ID is typically used in firm-level analysis of Belgian data (see Amiti et al., 2014, Magerman et
al., 2016 and Bernard et al., forthcomingb), we follow the procedure in Tintelnot et al. (2017)
and aggregate variables across multiple VAT IDs owned by the same firm as a robustness
check. VAT IDs are grouped into a single firm if the same parent company owns at least 50%
of their shares. Turnover, inputs, employment and labor costs are summed across subsidiaries
to the group level, after subtracting within group transactions from turnover and inputs to
avoid double counting. The NACE code of the firm with the largest turnover is assigned to
the group. There are 11,737 groups with multiple VAT IDs in the raw data in 2014, but
they account for a sizable fraction of output. The resulting decomposition is almost identical
across all components, e.g. the overall decomposition in Table 9.

6.4      Firm-specific input and labor shares
The baseline upstream decomposition uses labor (αi ) and network purchases (γi ) shares
calculated at the 4-digit industry level.28 As all firm-level outcomes are demeaned at the 4-
digit level, variation in αi and γi is differenced out. Table 10 presents results for the upstream
decomposition when using firm-specific αi and γi instead. Note that, from equation (12),
this introduces an additional margin, (1 − αi ) γi G. This term represents the variation in the
28
      Note that αi and γi are not needed for the overall and downstream decompositions.



                                                    34
                                       Table 10: Upstream Decomposition.

              Own Prod Capability        # Suppliers        Avg Suppl. Capability           Suppl. Cov.   Cluster term
                     ln Zi                     ln nsi                 ln ψ̄i                    ln Ωsi    (1 − αi ) γi G
     ln ψi          1.18∗∗∗                   -.08∗∗∗                 .03∗∗∗                    .03∗∗∗       -.16∗∗∗
                     (.00)                     (.00)                   (.00)                     (.00)        (.00)

 Note: The table reports coefficient estimates from OLS regressions of a firm size margin (as indicated
 in the column heading) on the upstream factor, ln ψi . All variables are demeaned by 4-digit industry
 averages. Standard errors in parentheses. Significance: * < 5%, ** < 1%, *** <0.1%.



seller effect ψi associated with variation in (1 − αi ) γi . As in the baseline, own production
capability is the dominant source of heterogeneity. Firms with high labor shares and low
network input shares have lower seller effects.


7        General Equilibrium and Counterfactuals
The estimation and decomposition presented in Sections 4 and 5 provide parameter values for
firm-level fundamentals. This section closes the model and solves for the general equilibrium
to perform counterfactual analyses.

7.1          General Equilibrium
Final Demand. To close the model, three additional assumptions are required on final
demand, markups and factor shares. For final demand, we choose the simplest possible case
and assume CES utility with the same elasticity of substitution σ across firms:
                                                      !σ/(σ−1)
                                   X
                            U=        (φi νi )(σ−1)/σ          .
                                                        i

Using the same functional form for final demand and firm demand means that the estimates
for production can also be used for final demand. The final consumer is an average input
                                                                       29
                          φ̃ki and τ̃ki do not appear in final demand. The value of final
consumer, so that theterms
                                       σ−1
                               φi
demand is then Fi =           τi c i
                                             P σ−1 X, where X is total income, and P is the CES consumer
price index:
                                             X  pi 1−σ          X     (1−σ)γi (1−αi )
                                  1−σ
                              P         =                    =        Pi                  g̃i Zi .                     (15)
                                              i
                                                    φi            i
29
       Since final demand is modeled as a representativePconsumer, there is by construction no match-specific
       component φki . Since φki = φk φ̃ki and (1/nci ) i φ̃ki = 1, this implies that the perceived quality of
       firm k is identical for the final consumer and the average downstream firm i.

                                                             35
     Labor shares. Factor shares are assumed to be constant across firms, αi = α and γi = γ,
i.e. identical labor and import shares. This is needed to ensure a well-defined mapping from
our firm-level moments to the equilibrium objects in the model (see Appendix C.5).
    Markups and profits. Thus far the model has been completely agnostic about market
                                               P
structure and price determination. Define p̄i ≡ pij yij /yi as the average price of firm i, i.e.
total sales relative to total quantity sold, and define µi ≡ p̄i /ci as its average markup. For
tractability, we assume that the average markup is identical across firms and constant across
equilibria, i.e. µi = µ. This restriction is needed in order to ensure that total income is
proportional to labor income (see below). The set of firms is fixed and there is no free entry.
The final consumer is the shareholder of all firms, so that aggregate profits Π become part
of consumer income. Income X is therefore the sum of labor income and aggregate profits,
X = wL + Π, where w is the wage and L is inelastically supplied labor. Appendix C.3 shows
that in equilibrium, X = (1 + (µ − 1) /α) wL. Wages are chosen as the numeraire.
     Backward fixed point. The general equilibrium can be found by solving two fixed points
sequentially. The input costs of firm i depend on the input costs of the suppliers of i. The
equilibrium input price index can be solved by iterating on a backward fixed point problem
from equation (9) (Appendix C.5 and Proposition 2):
                                      X γ(1−α)
                                P̃i =   P̃k     Zk ωki ,                                       (16)
                                                         k∈Si

where P̃i is proportional to Pi1−σ , P̃i ∝ Pi1−σ .30 Firm i’s input costs depend on the production
capability of its suppliers, Zk , the suppliers’ inverse input costs, P̃k , and the match terms
ωki .
    Forward fixed point. Sales of firm i relate to the sales of the customers of i. Total firm
                     P
sales are Si = Fi + j∈Ci mij . Using equations (3), (4) and (8), equilibrium sales can be
solved by iterating on a forward fixed point:
                                                                                       !
                                       γ(1−α)             X  γ (1 − α) X Sj
                           Si = Zi P̃i            P γ(1−α) +                     ωij       .   (17)
                                                    P̃    Zj
                                                                 µ          P̃ j
                                                   j j                 j∈Ci

A detailed derivation is found in Appendix C.4 and C.5. Firm i’s sales depend on final
demand, X, the production and sourcing capability of the firm itself, Zi and P̃i , as well as
the sales, sourcing capabilities and match effects of its customers, Sj , P̃j and ωij . Appendix
C.6 proves the existence and uniqueness of the equilibrium.
   Inspecting equations (16) and (17) above, there is a unique mapping from data and the
estimates Ψ = {ψi , θi , ωij } to the equilibrium objects P̃i and Si , summarized in the following
proposition:
                                                ¯¯         ¯
30
        Pi1−σ = g̃ 1/[1−γ(1−α)] P̃i where g̃ ≡ ψ̈ θ̈γ(1−α) ω̈.

                                                                 36
Proposition 3. Define a variable P̃i which is proportional to Pi1−σ , where Pi is the input
price index. The equilibrium P̃i is a function of the parameters Ψ = {ψi , θi , ωij } and data
{Mi , γ, α}. Equilibrium sales Si are a function of the parameters Ψ and data {Mi , γ, α, µ, X}.

     This result implies that our methodology can be applied in a variety of settings to disci-
pline and calibrate network models. Note that the equilibrium distribution of sales can be
solved for without imposing any assumption on the elasticity of substitution σ.
    Welfare. Indirect utility equals the inverse of the final demand price index P. Welfare
can be evaluated with equation (15), using estimates of production capability Zi and the
solution for P̃i from the backward fixed point.

7.2      Counterfactuals
The general equilibrium structure allows a return to the main research question of this paper,
exploring the role of the network in explaining firm size dispersion. To do so, we conduct
two counterfactuals. In the first, we turn off the traditional source of firm heterogeneity
by eliminating dispersion in ln Zi . This shuts down direct heterogeneity due to variation in
a firm’s production capability, but it also eliminates heterogeneity in the ln Zi of a firm’s
suppliers and customers. Intuitively, the remaining dispersion is then associated only with
the network itself: the variation across firms stems solely from their number of connections
and the match quality ωij . In the second counterfactual, we focus on a key parameter in
our model, namely the purchased input cost share, 1 − α. A higher input share means that
purchases from the network constitute a bigger share of production costs, such that the
network becomes more important.
    Applying Proposition 3, a baseline equilibrium is calculated using the estimated param-
eters Ψ = {ψi , θi , ωij } and data {Mi , γ, α, µ, X} and iterating on the two fixed points in
equations (16) and (17). Next, the counterfactual equilibria are constructed holding every-
thing else fixed. For the first counterfactual, all ln Zi are set equal to their sample average.
For the second counterfactual, the purchased input cost share, 1 − α, is increased by 10
percent. While the fixed point problem is conceptually straightforward, it is numerically
difficult because of the large size of the observed network. Since standard matrix operations
are not feasible in this setting, we have developed a custom algorithm using dictionary data
types in Python to solve the problem.31
   Parameterization. In addition to the estimated firm-level parameters Ψ, information
is needed on γ (share of network purchases in total purchases), α (labor cost share), µ
31
      Using the custom algorithm, the fixed points converge after 20 minutes on a standard computer. The
      algorithm is available upon request.



                                                   37
                                  Table 11: Summary of Parameters.


 Parameter    Definition                             Value               Source
                                                                                   P P
                                                                                     j   i∈Sj mij
 γ            Network purchases/total purchases      .58                 Mean of       P          (j is NACE4)
                                                                                      P j Mj
                                                                                          wj Lj
 α            Labor cost share                       .20           Mean of         P    j
                                                                                      (w L +M ) (j is NACE4)
                                                                                   Pj j Sj i j
 µ            Markup                                 1.23          Mean of           i wi Li +Mi (i is firm)
                                                     470 bln euros
                                                                   P
 X            Aggregate final demand                                i Si (βi − 1) /βi (i is firm)




(markup) and X (aggregate income). γ and α are constructed by taking the simple aver-
age of the industry-specific γ and α used in Section 5. µ is calculated as the unweighted
average of sales to total costs. X is inferred from sales going out of the network, i.e.
      P        P                                  P       P P
X = i Fi = i Si (βi − 1) /βi (or, equivalently, i Si − i j∈Ci m̈ij ). Table 11 sum-
marizes the parameters of the model, their definitions, and the values assigned to them.
     Model Fit. The model fit is shown in Figures 10 and 11. According to Proposition 2, the
equilibrium P̃i from equation (16) is proportional to the inverse input price index backed out
from the network data (Pi1−σ ∝ γi Mi /θi ). Figure 10 confirms this. There is also a strong
correlation between observed sales Si and equilibrium sales from equation (17), reported
in Figure 11. The correlation coefficient is 0.50. The primary reason why the correlation
is less than 1 is that firm-level sales to final demand are not a targeted moment in the
parameterization. This implies that prediction errors in sales to final demand propagate to
prediction errors in network sales through firm-to-firm links in the network. Appendix D.4
shows the fit between observed sales Si and equilibrium sales if sales to final demand are
also a targeted moment. In this case, the correlation coefficient is 0.96.32
    Results. The baseline and counterfactual equilibria are reported in Table 12. The first
counterfactual eliminates dispersion in firm production capabilities, ln Zi , which reduces the
standard deviation of log sales by 43%. When heterogeneity in ln Zi is eliminated, firms
become identical except for their connections to other firms. All remaining heterogeneity in
sales is entirely driven by the network, because some firms have more customers than others,
which raises their sales, or because some firms have more suppliers than others, which lowers
their costs. In the baseline calibration, the standard deviation in log sales is 1.41. The
network itself therefore explains over half (56%) of the dispersion of firm size (0.80/1.41).33
   In the second counterfactual, a 10% increase in the purchased input share increases the
32
     In addition, the assumption of homogeneous values of γ, α and µ generates prediction errors in sales,
     although this channel is quantitatively less important.
33
     The 90/10 percentile ratio of sales is roughly 6 (e1.78 ) when dispersion in ln Zi is eliminated versus 36
     (e3.59 ) in the baseline, implying that heterogeneity in network connections and in ln Zi both raise sales
     dispersion by a factor of six.


                                                      38
                         Figure 10: Model Fit: ln P̃i .




Note: The figure shows the equilibrium ln P̃i calculated from equation (16) on the
horizontal axis and the inverse price index calculated from γi Mi /θi on the vertical
axis.




                                         39
standard deviation of log sales by 2%. Thus increasing the role of the network generates
more inequality across firms. Firm size dispersion can widen for two reasons. First, large
firms may have initially lower input prices than small firms, i.e. high P̃i ’s. A lower labor
share will then benefit big relative to small firms. This can be seen by differentiating sales
Si with respect to γ (1 − α), from equation (17), holding all other P̃j ’s and Sj ’s constant.
This yields the elasticity
                                       εγ(1−α) Si = γ (1 − α) ln P̃i .

Second, large firms may experience a bigger decline in input costs relative to small firms, i.e.
the change in P̃i may be systematically related to firm size.
    Table 13 sheds light on both mechanisms operating in the second counterfactual. Column
1 first confirms that initially larger firms grow faster with a convergence regression of the
counterfactual change in firm size, ∆ ln Si , on the baseline equilibrium firm size, ln Si . The
next two columns provide evidence consistent with the first transmission channel: Bigger
firms tend to have lower input prices and thus a higher ln P̃i (Column 2),34 and producers
that start out with lower input prices expand their sales more (Column 3). The last two
columns indicate that the second channel also plays an important role: Initially larger firms
experience a bigger decline in their input price index, i.e. a higher ∆ ln P̃i (Column 4), and
greater reductions in input prices are associated with higher sales growth (Column 5). In
sum, the results reveal that reducing the labor cost share benefits especially large firms, and
this effect is quantitatively important. In other words, the production network amplifies firm
size heterogeneity. This is driven by the facts that larger firms are better at obtaining lower
input costs and that equilibrium input prices fall more for larger firms.
   Other outcomes. One might be tempted to use the last counterfactual to analyze other
outcomes such as changes in input/output prices or consumer welfare. Unfortunately, these
outcomes are not identified using our methodology. From Section 7, input prices are Pi1−σ =
g̃ 1/[1−γ(1−α)] P̃i . While P̃i is identified according to Proposition 3, Pi1−σ and the consumer
price index, P, are not, because they require information about the unobserved variable
g̃ ≡ ψ̈¯θ̈¯γ(1−α) ω̈.
                  ¯ Intuitively, only relative input prices (Pi /Pj )1−σ are identified, but their
absolute level is not. However, one would need information about the absolute price level
(relative to wages) to infer the impact of a greater labor share α on consumer welfare.


8     Conclusions
This paper quantifies the origins of firm size heterogeneity when firms are interconnected
in a production network. We first document new stylized facts about a complete produc-
34
     This is also seen from the correlation in Table 6.


                                                     40
                        Figure 11: Model Fit: ln Si .




Note: The figure shows the equilibrium ln Si calculated from equation (17) on the
horizontal axis and ln Si from balance-sheet data on the vertical axis.




    Table 12: Firm Size Dispersion. Baseline and Counterfactual.


            ln Si dispersion                St. Dev.     P90-P10

            Baseline                          1.41            3.59

            Counterfactuals
              1: var (ln Zi ) = 0             0.80            1.78
              2: 10% higher (1 − α)           1.44            3.68

            N                                        83,741

        Note: The table shows the standard deviation and the difference
        between the 90th and 10th percentile of log sales in the baseline
        and counterfactual equilibria.




                                       41
             Table 13: Firm Size Dispersion in Counterfactual 2. Mechanisms.


                                           Dependent variable:
                                ∆ ln Si   ln P̃i    ∆ ln Si      ∆ ln P̃i   ∆ ln Si
                                 (1)       (2)       (3)          (4)        (5)
                       ln Si      .02      .33                    .003
                                 (.00)    (.00)                  (.000)
                      ln P̃i                             .06
                                                        (.00)
                     ∆ ln P̃i                                                 .78
                                                                             (.00)
                        N                               83,741

              Note: The table shows regression results based on the counterfactual ex-
              ercise of raising the purchased input share by 10%. Standard errors in
              parentheses. Significance: * < 5%, ** < 1%, *** <0.1%.



tion network using data on the universe of buyer-supplier relationships among all firms in
Belgium. These stylized facts suggest that the network of buyer-supplier links is key to un-
derstanding the firm size distribution. Specifically, they signal the important roles played by
downstream input demand as distinct from final demand, by both seller- and buyer-specific
firm characteristics, and by seller-buyer match characteristics.
   Motivated by these facts, we outline a model in which firms buy inputs from upstream
suppliers and sell to downstream buyers and final demand. In the model, firms can be
large for the standard reason that they have high production capability (i.e. productivity
or product quality). However, firms can also be large because they interact with more,
better and larger buyers and suppliers and because they are better matched to their buyers
and suppliers. This framework delivers an exact decomposition of firm size into upstream
and downstream margins with firm, buyer/supplier and match components. We design an
estimation methodology that makes it possible to back out these firm size components from
data on firm-level balance sheets and firm-to-firm transactions in a production network. We
implement the methodology using detailed network data, and quantify the contribution of
each component to the overall dispersion in firm size in the economy.
   We establish three empirical results for the origins of firm size heterogeneity. First,
downstream factors explain 82 percent of firm size heterogeneity, while upstream (supply)
factors only 18 percent. Second, nearly all the variation on the demand side is driven by
network sales to other firms rather than by final demand. At the same time, nearly all


                                                   42
the variation on the supply side is driven by own production capability rather than input
purchases from other firms in the network. Third, most of the variance in network sales
is determined by the number of buyers and the allocation of sales towards well-matched
buyers of high quality, rather than by average buyer capability. Conversely, most of the
variance in network purchases comes from average supplier capability and the allocation of
purchases towards well-matched suppliers of high quality, rather than from the number of
suppliers. Counterfactual analyses also establish the importance of firm-to-firm connections:
Even in the absence of heterogeneity in production capability, dispersion in firm size is still
substantial.
   These theoretical, methodological and empirical contributions open interesting avenues
for future research. We have taken the production network as given in order to assess its
role in shaping the firm size distribution. Our results nevertheless shed light on the various
challenges and opportunities that firms face in the presence of input-output linkages in the
economy. Future work can examine how firm-specific characteristics determine the matching
of buyers and suppliers in the production network in light of our findings. Separately, we
have dissected the origins of firm size heterogeneity, but not explored its implications for the
aggregate economy. Future studies can analyze whether different sources of the dispersion
in firm size have different implications for aggregate outcomes such as growth or income
inequality. Finally, we have focused on the relationship between the production network and
firm size heterogeneity in steady state. Future research can explore how this relationship
affects the propagation and aggregate welfare impact of firm-specific and macroeconomic
shocks.




                                              43
References
Abowd, J.M., F. Kramarz, and D.N. Margolis, “High Wage Workers and High Wage
  Firms,” Econometrica, 1999, 67 (2), 251–333. 1, 3.1, 6.2

Allen, Treb, Costas Arkolakis, and Xiangliang Li, “On the Existence and Uniqueness
  of Trade Equilibria,” Technical Report, Working paper 2016. C.6

Amiti, Mary, Oleg Itskhoki, and Jozef Konings, “Importers, Exporters, and Exchange
  Rate Disconnect,” American Economic Review, July 2014, 104 (7), 1942–1978. 6.3

Antràs, P., T.C. Fort, and F. Tintelnot, “The Margins of Global Sourcing: Theory and
  Evidence from US Firms,” American Economic Review, September 2017, 107 (9), 2514–64.
  1

Baqaee, David Rezza and Emmanuel Farhi, “The Macroeconomic Impact of Microe-
  conomic Shocks: Beyond Hulten’s Theorem,” Technical Report, Working paper 2018. 1

      and   , “Productivity and Misallocation in General Equilibrium,” Technical Report,
  Working paper 2018. 1

Bender, S., D. Card, N. Bloom, J. Van Reenen, and S. Wolter, “Management
 Practices, Workforce Selection and Productivity,” NBER Working Paper, 2016, (22101).
  1

Bernard, A., A. Moxnes, and Y.U. Saito, “Production Networks, Geography and Firm
  Performance,” Journal of Political Economy, forthcoming. 1, 7, 24

Bernard, A.B., J.B. Jensen, S.J. Redding, and P.K. Schott, “The Empirics of Firm
 Heterogeneity and International Trade,” Annual Review of Economics, 2012, 4 (1), 283–
  313. 1

Bernard, Andrew B. and Andreas Moxnes, “Networks and Trade,” Annual Review of
  Economics, forthcoming. 1

  , , and Karen Helene Ulltveit-Moe, “Two-sided Heterogeneity and Trade,” Review
  of Economics and Statistics, 2018, 100 (3). 1, 7

  , Emily J. Blanchard, Ilke Van Beveren, and Hylke Y. Vandenbussche, “Carry-
  Along Trade,” Review of Economic Studies, forthcoming. 6.3




                                            44
Bloom, Nick, Kalina Manova, John Van Reenen, Stephen Sun, and Zhihong Yu,
  “Managing Trade: Evidence from China and the US,” NBER Working Paper 24718., 2017.
  1

Boehm, Johannes and Ezra Oberfield, “Misallocation in the Market for Inputs: En-
 forcement and the Organization of Producation,” Technical Report, Working paper 2018.
  1

Bøler, Esther Ann, Andreas Moxnes, and Karen Helene Ulltveit-Moe, “R&D,
  International Sourcing, and the Joint Impact on Firm Performance,” American Economic
  Review, 2015, 105 (12). 1

Bonhomme, Stéphane, “Econometric Analysis of Bipartite Networks,” Forthcoming. 23

  , Thibaut Lamadon, and Elena Manresa, “A Distributional Framework for A Distri-
  butional Framework for Matched Employer Employee Data,” 2017. 1

Card, D., J. Heining, and P. Kline, “Workplace Heterogeneity and the Rise of West
  German Wage Inequality*,” The Quarterly Journal of Economics, 2013, 128 (3), 967–
  1015. 1, 6.2, 26

Correia, Sergio, “Linear Models with High-Dimensional Fixed Effects: An Efficient and
  Feasible Estimator,” Technical Report, Working Paper 2016. 4

Dhyne, E., G. Magerman, and S. Rubinova, “The Belgian Production Network 2002-
  2012,” National Bank of Belgium Working Paper, 2015, 288. 4, 7, A.1

di Giovanni, J., A.A. Levchenko, and I. Mejean, “Firms, Destinations, and Aggregate
  Fluctuations,” Econometrica, 07 2014, 82 (4), 1303–1340. 1

Eaton, J., D. Jinkins, J. Tybout, and D.Y. Xu, “Two-sided Search in International
  Markets,” 2016. NBER. 1

  , S. Kortum, and F. Kramarz, “Dissecting Trade: Firms, Industries, and Export
  Destinations,” American Economic Review, May 2004, 94 (2), 150–154. 3.1

Eaton, Jonathan, Samuel Kortum, and Francis Kramarz, “Firm-to-Firm Trade: Im-
  ports, Exports, and the Labor Market1,” Technical Report, Working paper 2018. 1, 24

Fieler, Ana Cecília, Marcela Eslava, and Daniel Yi Xu, “Trade, Quality Upgrad-
  ing, and Input Linkages: A Theory with Evidence from Colombia,” American Economic
  Review, 2018, 108. 1

                                          45
Fitzgerald, D., S. Haller, and Y. Yedid-Levi, “How Exporters Grow,” Staff Report
  524, Federal Reserve Bank of Minneapolis January 2016. 1

Foster, L., J. Haltiwanger, and C. Syverson, “The Slow Growth of New Plants: Learn-
  ing about Demand?,” Economica, 2016, 83 (329), 91–129. 1

Freund, C. and M.D. Pierola, “Export Superstars,” The Review of Economics and Statis-
  tics, 2015, 97 (5), 1023–1032. 1

Gabaix, Xavier, “The Granular Origins of Aggregate Fluctuations,” Econometrica, 2011,
  79, 733–772. 1

Gaubert, Cecile and Oleg Itskhoki, “Granular Comparative Advantage,” 2016. Prince-
  ton. 1

Gibrat, Robert, Les inègalitès èconomiques, Librairie du Recuil Sirey, Paris, 1931. 1

Goldberg, P., A.K. Khandelwal, N. Pavcnik, and P. Topalova, “Imported Intermedi-
 ate Inputs and Domestic Product Growth: Evidence from India,” The Quarterly Journal
  of Economics, 2010, 125 (4), 1727–1767. 1

Hopenhayn, H.A., “Entry, Exit and Firm Dynamics in Long Run Equilibrium,” Econo-
 metrica, 1992, 60, 1127–1150. 1

Hottman, C. J., S.J. Redding, and D. E. Weinstein, “Quantifying the Sources of Firm
  Heterogeneity,” Quarterly Journal of Economics, 2016, 131 (3), 1291–1364. 1, 3.1

Jovanovic, Boyan, “Selection and the Evolution of Industry,” Econometrica, May 1982, 50
  (3), 649–70. 1

Kramarz, F., J. Martin, and I. Mejean, “Volatility in the Small and in the Large: The
  Lack of Diversification in International Trade,” CEPR Discussion Papers 11534, C.E.P.R.
  Discussion Papers September 2016. 1

Lim, Kevin, “Firm-to-firm Trade in Sticky Production Networks,” 2017 Meeting Papers
  280, Society for Economic Dynamics 2017. 1, 24

Luttmer, Erzo G. J., “Selection, growth and the size distribution of firms,” The Quarterly
  Journal of Economics, 2007, 122 (3), 1103–1144. 1

Magerman, Glenn, Karolien De Bruyne, Emmanuel Dhyne, and Jan Van Hove,
  “Heterogeneous Firms and the Micro Origins of Aggregate Fluctuations,” Technical Report,
  KU Leuven 2016. 1, 6.3

                                           46
Manova, Kalina, Shang-Jin Wei, and Zhiwei Zhang, “Firm Exports and Multinational
  Activity Under Credit Constraints,” The Review of Economics and Statistics, July 2015,
  97 (3), 574–588. 1

Manski, Charles F., “Identification of Endogenous Social Effects: The Reflection Prob-
  lem,” The Review of Economic Studies, 1993, 60 (3). 1

Melitz, Marc., “The Impact of Trade on Intra-Industry Reallocations and Aggregate In-
  dustry,” Econometrica, 2003, 71 (6), 1695–1725. 1

Melitz, Marc and Stephen Redding, “New Trade Models, New Welfare Implications,”
  American Economic Review, 2015, 105 (3), 1105–1146. 1

Oberfield, Ezra, “A Theory of Input-Output Architecture,” Econometrica, 2018, 86 (2),
  559–589. 1

Pavcnik, Nina, “Trade Liberalization, Exit, and Productivity Improvements: Evidence
 from Chilean Plants,” The Review of Ecnomic Studies, 2002, 69, 245–276. 1

Sutton, John, “Market Share Dynamics and the "Persistence of Leadership" Debate,”
  American Economic Review, March 2007, 97 (1), 222–241. 1

Syverson, C., “What Determines Productivity?,” Journal of Economic Literature, 2011, 49
  (2), 326–365. 1

Tintelnot, Felix, Ken Kikkawa, Magne Mogstad, and Emmanuel Dhyne, “Trade
  and Domestic Production Networks,” Technical Report, Working paper 2017. 1, 6.3




                                           47
Appendix
A      Data Sources and Data Construction
A.1      Data sources
The empirical analysis draws on three main data sources administered by the National Bank
of Belgium (NBB): (i) the NBB B2B Transactions Dataset, (ii) annual accounts from the
Central Balance Sheet Office at the NBB supplemented by VAT declarations, and (iii) the
Crossroads Bank at the NBB. Firms are identified by a unique enterprise number, which is
common across all databases and allows for unambiguous merging.


Firm-to-firm relationships The confidential NBB B2B Transactions Dataset contains the
value of yearly sales relationships among all VAT-liable Belgian enterprises for the years 2002
to 2014, and is based on the VAT listings collected by the tax authorities. The Belgian value-
added tax (VAT) system requires that the vast majority of enterprises located in Belgium
across all economic activities charge VAT on top of the delivery of their goods and services.
This includes foreign companies with a branch in Belgium and firms whose securities are
officially listed in Belgium. Enterprises that only perform financial transactions, medical or
socio-cultural activities such as education are exempt. The standard VAT rate in Belgium
is 21%, but for some goods a reduced rate of 12% or 6% applies.35
At the end of every calendar year, all VAT-liable enterprises have to file a complete listing
of their Belgian VAT-liable customers over that year.36 An observation in this dataset refers
to the value of sales in euros by enterprise i to enterprise j within Belgium, excluding the
VAT due on these sales. The reported value is the sum of invoices from i to j in a given
calendar year. Whenever this aggregated value is 250 euros or greater, the relationship has
to be reported.37 Fines for late or incomplete reporting ensure a very high quality of the
data. Note that each relationship is directed, as the observation from i to j is different from
the observation from j to i; i.e. firm i might be both a supplier to and a customer of j. The
dataset thus covers both the extensive and the intensive margins of the Belgian production
network. A detailed description of the collection and cleaning of this dataset is given in
Dhyne et al. (2015).


Firm-level characteristics We extract information on enterprises’ annual accounts from
35
     See ec.europa.eu/taxation_customs for a complete list of rates. These rates did not change over our
     sample period.
36
     Sample VAT listings forms can be found at here (French) and here (Dutch).
37
     Pecuniary sanctions are given to firms for late or erroneous reporting.


                                                  48
the Central Balance Sheet Office at the NBB for the years 2002 to 2014. Enterprises above a
certain size threshold have to file annual accounts at the end of their fiscal year.38 We retain
information on the enterprise identifier (VAT ID), turnover (total sales in euros, code 70 in
the annual accounts), input purchases (total material and services inputs in euros and net
changes in input stocks, codes 60+61), labor cost (total cost of wages, social securities and
pensions in euros, code 62), and employment (average number of full-time equivalent (FTE)
employees, code 9087). We annualize all flow variables from fiscal years to calendar years by
pro-rating the variables on a monthly basis. 39
Enterprises below a size threshold can report abbreviated annual accounts. These firms
report labor cost and employment, but are not required to report turnover or input purchases.
For these small enterprises, we supplement information on turnover and inputs from their
VAT declarations. All VAT-liable enterprises have to file periodic VAT declarations with the
tax administration.40 The VAT declaration contains the total sales value (including domestic
sales and exports), the VAT amount charged on those sales (both to other enterprises and to
final consumers), the total amount paid for inputs sourced (including domestic and imported
inputs), and the VAT paid on those input purchases. This declaration is due monthly or
quarterly depending on firm size, and it is the basis for the VAT due to the tax authorities
every period. We aggregate the VAT declarations to the annual frequency.
We obtain information on the main economic activity of each enterprise at the NACE 4-digit
level from the Crossroads Bank of Belgium for the years 2002 to 2014. We concord NACE
codes over time to the NACE Rev. 2 version to deal with changes in the NACE classification
over our panel from Rev. 1.1 to Rev. 2. Table 14 lists industry groups at the NACE 2-digit
level.

A.2      Data construction and cleaning
We calculate the final demand for enterprise i in year t as i’s turnover minus the value of
all of its B2B sales. The B2B Transactions dataset contains all seller-buyer relationships,
including both intermediate and investment goods. This implies that final demand contains
final domestic consumption, exports, and tiny business transactions below 250 euros that
are not observed in the B2B dataset. Similarly, we calculate i’s total input purchases from
the network as the value of all of its B2B purchases. We infer i’s input purchases from
outside the network as its total input purchases minus its total B2B network purchases.
38
     See here for filing requirements and exceptions. See here for the size criteria and filing requirements for
     either full-format or abridged annual accounts.
39
     In our data, 78% of firms have annual accounts that coincide with calendar years, while 98% of firms
     have fiscal years of 12 months.
40
     Sample VAT declaration forms can be found at here (French) and here (Dutch).


                                                      49
                                Table 14: NACE classification of industry groups (NACE Rev 2).


     NACE Section   NACE Division                               Description                                       Industry
          A          NACE 01-03                        Agriculture, forestry and fishing                   Primary and Extraction
          B          NACE 05-09                             Mining and quarrying                           Primary and Extraction
          C          NACE 10-33                                  Manufacturing                                 Manufacturing
          D           NACE 35                Electricity, gas, steam and air conditioning supply                  Utilities
          E          NACE 36-39     Water supply; sewage, waste management and remediation activities             Utilities
          F          NACE 41-43                                   Construction                                  Construction
          G          NACE 45-47     Wholesale and retail trade; repair of motor vehicles and motorcycles       Market Services
          H          NACE 49-53                           Transportation and storage                           Market Services
          I          NACE 55-56                  Accommodation and food service activities                     Market Services




50
          J          NACE 58-63                        Information and communication                           Market Services
          K          NACE 64-66                       Financial and insurance activities                       Market Services
          L           NACE 68                                Real estate activities                            Market Services
          M          NACE 69-75                Professional, scientific and technical activities               Market Services
          N          NACE 77-82                 Administrative and support service activities                  Market Services
          O           NACE 84         Public administration and defence; compulsory social security         Non-Market Services
          P           NACE 85                                      Education                                Non-Market Services
          Q          NACE 86-88                   Human health and social work activities                   Non-Market Services
          R          NACE 90-93                      Arts, entertainment and recreation                     Non-Market Services
          S          NACE 94-96                             Other service activities                        Non-Market Services
                                    Activities of households as employers; undifferentiated goods- and
          T          NACE 97-98                                                                                      –
                                          services-producing activities of households for own use
          U           NACE 99              Activities of extraterritorial organizations and bodies                   –
This residual, unobserved part of input expenditures, contains imports and unobserved B2B
input purchases under 250 euro.
    We drop firms that have missing employment information or less than one FTE employee,
as these may be shell companies or management companies. We also drop firms with less
than 1,000 euro sales in a given year, which only amounts to 27 firms in 2014 after applying
the other selection criteria. This is to avoid long left tails in the graphs in Section 2 of the
paper, but has no bearing on any of the results.
   Labor shares are calculated at the 4-digit NACE level,
                                                     P
                                                          as the sum of labor cost over labor
                                                              j   wLj
cost plus total input usage across all firms. αS =     P                  , where wLj is firm j’s wage
                                                           j (wLj +Mj )
bill and Mj its total expenditure on intermediate inputs (both from the annual accounts)
for all j in sector S. For the general equilibrium calculations, we use the simple average of
sector labor shares to obtain the common labor share α. We obtainP P
                                                                        the sector-level share
                                                                                  i mij
                                                                                  P
                                                                            j                       i mij
of inputs sourced from the observed domestic network as γS =                P
                                                                                  M j
                                                                                        ,   where   Mj
                                                                                                            is j’s
                                                                                j
share of inputs sourced from the domestic network. Again, we use the simple average across
industries to obtain γ for the general equilibrium analysis.
   Throughout the paper, we report statistics on both the full sample in the raw data and
the estimation sample used in the firm size decomposition. For the full sample, we keep all
B2B relationships in the NBB B2B dataset, even if there is missing firm-level information,
as these contribute to the decomposition exercise. We thus keep all enterprises that show up
in the network as either a buyer or a seller. For the estimation sample, in Step One we first
estimate the two-way fixed effects regression on the full sample. Note that if a buyer or seller
has only one business relationship, the fixed effect is not identified. This enterprise, together
with its connections, is then dropped from the sample. This is done iteratively, until only
enterprises that have at least two sellers or two buyers remain. Finally, for the decomposition
exercise to contain the same number of observations across all (sub-)components, in Step Two
and Step Three we keep only enterprises that have information on all the (sub-)components
of the decomposition. In the general equilibrium case, we need to further restrict the sample
to have a square matrix of buyers and sellers. We then iteratively drop firms and linkages
until the set of sellers is the same as the set of buyers, and all have identified fixed effects.
                                                                                                    Si
   Finally, for the counterfactual exercise, we obtain firm-level markups µi =                      Mi
                                                                                                       ,   or the
ratio of i’s sales revenue to its input expenditure, and calculate aggregate final demand wL
by summing over final demand for all enterprises that are part of the fixed point algorithm.
Note that this obtained value is very close to observed GDP in the National Accounts (420
billion euros in 2014).




                                               51
B                                      Additional Descriptive Statistics
The distributions of the number of suppliers and customers have similar features within
different sectors, but they also display some heterogeneity in line with priors. For example,
the number of buyers and suppliers is highest for firms in utilities, which are followed closely
by manufacturing firms. These numbers are intermediate for producers in primary materials
and extraction, and lowest among service providers.
   Figure 12 replicates Figure 12 in the main text using firms’ total B2B sales in the domestic
network instead of total turnover. Recall that in addition to downstream domestic network
sales, total turnover also includes domestic final demand and exports. Figure 12 plots the
fitted line and 95% confidence band from a local polynomial regression of domestic network
sales on the number of downstream customers or upstream suppliers, on a log-log scale. The
pattern is very similar to the baseline in the main text: a strong monotonic relationship with
implied elasticities of 0.78 and 1.24, respectively.

                                                        Figure 12: Firm size and number of buyers and suppliers (2014).

                                             (a) Firm sales and number of buyers.                                                                               (b) Firm sales and number of suppliers.
                 3




                                                                                                                                         3
                     10




                                                                                                                                             10
                                                                                                                                                           2
    Network sales (euro), de−meaned




                                                                                                                            Network sales (euro), de−meaned
                                   2




                                                                                                                                                        10
                                10




                                                                                                                                                   1
                           1




                                                                                                                                                10
                        10




                                                                                                                                         0
                0




                                                                                                                                      10
             10




                                                                                                                               −1
       −1




                                                                                                                            10
    10




                                                                                                                                         −2




                                       Linear slope: 0.76 ( 0.00)                                                                                              Linear slope: 1.24 ( 0.01)
                 −2




                                                                                                                                             10




                                       R−squared: 0.35                                                                                                         R−squared: 0.28
                     10




                                            −2               −1              0            1               2        3                                                −2               −1              0            1               2             3
                                       10               10                10             10          10       10                                               10               10               10               10         10            10
                                                                    Number of customers, de−meaned                                                                                          Number of suppliers, de−meaned




Note: The number of customers and suppliers is demeaned at the NACE 4-digit level. Graphs are trimmed
       at the 0.1st and 99.9th percentiles of the number of customers and suppliers respectively.



C                                      The Model
C.1                                         Proposition 2
                                                                                                                                                                                                                                       (1−σ)γk (1−αk )
Proposition. The input price index is a fixed point of the function Pi1−σ =
                                                                                                                                                                                                                      P
                                                                                                                                                                                                                         k∈Si         Pk                 g̃k Zk ωki .
γi Mi /θi is proportional to the price index Pi1−σ from the fixed point of the function above.



                                                                                                                       52
                                               Table 15: Firm sales (million euros, 2014).

      Sector                 NACE          N   Mean   St Dev   10th   25th   50th   75th   90th   95th   99th
      Primary & Extraction   01-09     3,061   12.0   432.6     0.2    0.4    0.8    1.9    4.8    9.5    52.0
      Manufacturing          10-33    18,077   14.4   250.8     0.2    0.5    1.1    3.8   13.8   34.6   201.8
      Utilities              35-39       897   39.2   442.9     0.3    0.7    1.9    6.9   25.7   68.6   495.6




53
      Construction           41-43    20,201    2.3    13.4     0.2    0.3    0.6    1.4    3.6    6.9    25.9
      Market Services        45-82    65,175    5.5    79.9     0.2    0.3    0.8    2.1    6.3   13.4    63.9
      Non-Market Services    84-99     2,328    2.2    26.3     0.1    0.2    0.3    0.8    2.6    5.5    24.9
      All                            109,739    6.8   145.1     0.2    0.3    0.8    2.1    6.6   14.3    78.4
     Note: Summary statistics for the matched CBSO-B2B data. 10th, 25th, etc. refers to values at the 10th, 25th, etc. percentile
     of the distribution.
                      Table 16: Number of firm buyers and suppliers (2014).
                                         (a) Number of downstream buyers.
 Sector                    NACE           N    Mean     St Dev    10th   25th   50th    75th   90th    95th    99th
 Primary & Extraction      01-09     50,706     12.1       60.1      1      2      4       8     18      40     154
 Manufacturing             10-33     57,976     47.5      284.9      1      2      7      26     98     192     603
 Utilities                 35-39      2,734    192.7    3,304.8      1      2      7      36    154     336   1,514
 Construction              41-43    104,566     14.6      107.9      1      2      4      10     24      45     174
 Market Services           45-82    351,773     32.9      394.6      1      1      3      11     48     112     453
 Non-Market Services       84-99     22,352     14.1      183.7      1      1      2       6     19      38     154
 All                                590,271     29.3      394.0      1      1      4      11     42      98     400

                                        (b) Number of upstream suppliers.
 Sector                    NACE           N    Mean     St Dev    10th   25th   50th    75th   90th    95th   99th
 Primary & Extraction      01-09     60,508    20.5      29.6        2      5     13      27     44      57    117
 Manufacturing             10-33     72,698    38.0      89.5        2      5     15      38     89     148    348
 Utilities                 35-39      3,401    62.8     180.7        2      4     14      55    146     235    757
 Construction              41-43    130,358    24.5      48.3        2      5     13      29     52      77    178
 Market Services           45-82    506,145    18.3      41.5        1      3      8      19     42      64    150
 Non-Market Services       84-99     60,223    10.6      39.2        1      2      4      10     20      33     97
 All                                840,607    20.6      49.5        1      3      9      22     46      71    177

    Note: Summary statistics for the B2B data. 10th, 25th, etc. refers to values at the 10th, 25th, etc.
                                     percentile of the distribution.




                     Table 17: Firm-to-firm transaction values (euros, 2014).

 Sector                              N    Mean     St Dev 10th 25th 50th 75th                  90th     95th         99th
 Primary & Extraction         613,868 39,898 5,409,863         419     840 2,490 9,150 33,789 81,626              387,573
 Manufacturing              2,755,457 44,303 2,007,421         359     613 1,661 6,185 25,436 63,467              411,379
 Utilities                    526,932 59,953 7,410,682         366     615 1,388 3,744 11,560 28,382              281,181
 Construction               1,529,078 24,500       386,201     375     676 1,926 7,000 27,186 64,585              339,523
 Market Services           11,562,445 24,373 2,886,213         341     546 1,266 4,060 15,579 37,960              224,363
 Non-Market Services          315,529     8,044    319,407     315     472      998 2739      8,395 18,908         92,879
 All                       17,304,408 28,893 2,988,881         348     571 1,392 4,669 18,280 44,770              269,153
Note: Summary statistics for the B2B data. 10th, 25th, etc. refers to values at the 10th, 25th, etc. percentile
of the distribution. Industry refers to the main industry of activity of the seller.




                                                       54
Proof. Using the expressions for ci , Zi and ωij , the input price index can be written as
                                       X  pki 1−σ
                              1−σ
                            Pi     =
                                       k∈Si
                                              φki
                                       X  τk τ̃ki ck 1−σ
                                   =
                                       k∈Si
                                               φk φ̃ki
                                       X (1−σ)γ (1−α )
                                                     k  k
                                   =        Pk            g̃k Zk ωki ,                     (18)
                                                    k∈Si

where g̃k ≡ ψ̈¯θ̈¯γk (1−αk ) ω̈
                             ¯ The equilibrium input price index is a fixed point of the function in
equation (18) above. Using the expression for Zi , one can alternatively write the input price
index as
                                                Pi1−σ = ψ̈¯ω̈
                                                              X
                                                           ¯    ψk ωki .
                                                                   k∈Si

Sales from i to j are, according to equation (1), m̈ki = eG ψk θi ωki . Summing across suppliers,
we get
                                    X               X
                                          m̈ki =            ψk θi ωki eG = γi Mi     ⇐⇒
                                   k∈Si             k∈Si
                                         γ i Mi      X
                                                = eG     ψk ωki .                                    (19)
                                            θi       k∈S      i

Therefore, the assumption of log-linear sales from equation (5) alone guarantees that γi Mi /θi
equals a weighted average of the suppliers’ seller effects. The input price index calculated
from γi Mi /θi is proportional to the equilibrium fixed point in equation (18).

C.2      The supply side decomposition
From equation (8), we get

                                ln ψi = ln Zi + γi (1 − αi ) (ln (γi Mi ) − ln θi ) .

Substituting for ln (γi Mi ) from equation (11) yields
                                                                                          !
                                                                              X
                               ln ψi = ln Zi + γi (1 − αi ) G + ln                   ψk ωki .
                                                                              k∈Si
           P
The term      k∈Si   ψk ωki can be further decomposed into
                                                                                             !
                                X                                           1 X        ψk
                          ln            ψk ωki =   ln nsi   + ln ψ̄i + ln    s
                                                                                   ωki           ,
                                k∈Si
                                                                            ni k∈S     ψ̄i
                                                                                     i

               Q               1/nsi
where ψ̄i =        k∈Si   ψk            . Combining the last two equations yields equation (12) in the
main text.

                                                                  55
C.3     Aggregate Profits
In this section, we show that aggregate income is proportional to labor income wL.
                 P
    Define p̄i ≡    pij yij /yi as the average price of firm i, i.e. total sales relative to total
quantity sold. Define µi ≡ p̄i /ci as the average markup of firm i. Profits can then be written



                                                  πi = p̄i yi − ci yi
                                                        = (µi − 1) ci yi
                                                          µi − 1
                                                        =        wLi
                                                            αi
where we used the fact that the labor cost share satisfies αi = wLi /ci yi in the last line.
Aggregate income is then
                                                  X                        X µi − 1
                             X = wL +                    πi = wL +                         wLi
                                                   i                         i
                                                                                     αi

Invoking the assumption from the main text that αi = α and µi = µ, we get
                                                    
                                 X              µ−1
                            wL +     πi = 1 +          wL.
                                  i
                                                  α

Aggregate income X is proportional to labor income wL.

C.4     Forward fixed point
                                      P
Total firm sales are Si = Fi +             j∈Ci   mij . We first derive expressions for final demand and
then demand from other firms.
   Final demand. Using equation (3) and defining P̃i ≡ Pi1−σ and P̃ ≡ P 1−σ , the final
demand price index is
                                      X  τi ci 1−σ                  X      (1−σ)γi (1−αi )
                            1−σ
                        P         =                               =        Pi                  g̃i Zi .
                                       i
                                                  φi                   i

Using equation (3), final demand is
                                                              σ−1
                                                        φi
                                      Fi =                            P σ−1 X
                                                       τi ci
                                                               (1−σ)γi (1−αi )    X
                                            = g̃i Zi Pi                                .
                                                                                 P 1−σ




                                                                 56
   Firm Demand. Using (3), (8) and (4), firm demand is
                      X                X  φij σ−1
                             mij =                            Pjσ−1 γj Mj
                      j∈Ci             j∈Ci
                                                pij
                                               (1−σ)γi (1−αi )
                                                                   X γj (1 − αj ) Sj
                                   = g̃i Zi Pi                                         ωij ,
                                                                   j∈C
                                                                          µj     Pj1−σ
                                                                        i


where we used the fact that Mi = Si (1 − αi ) /µi . Combining the two sources of demand, we
get total sales:
                                                                                                        !
                                   (1−σ)γi (1−αi )      X     X γj (1 − αj ) Sj
                   Si =   g̃i Zi Pi                         +                     ωij                           .   (20)
                                                       P 1−σ j∈C     µj     Pj1−σ
                                                                             i



C.5     Change of variables
A problem with the expression for Si in equation (20) is that it depends on g̃i = ψ̈¯θ̈¯γi (1−αi ) ω̈,
                                                                                                   ¯
                                                    ¯     ¯
which is a function of the unidentified parameters ψ̈ and θ̈. This section solves this indeter-
minacy.
   To make progress, we invoke the assumption in the main text that αi = α, γi = γ and
µi = µ. Define the fixed point
                                                      X          γ(1−α)
                                              P̃i =          P̃k            Zk ωki .                                (21)
                                                      k∈Si


It is then straightforward to show that Pi1−σ = g̃ 1/[1−γ(1−α)] P̃i , where g̃ = ψ̈¯θ̈¯γ(1−α) ω̈.
                                                                                              ¯ After
some algebra, one can then rewrite equation (20) to
                                                                                                        !
                                  γ(1−α)               X     γ (1 − α) X Sj
                    Si = Zi P̃i               P γ(1−α)     +                     ωij                        ,       (22)
                                                P̃     z̃j
                                                                 µ          P̃ j
                                               j j                     j∈Ci


which is independent of ψ̈¯ and θ̈.
                                ¯


C.6     Existence and Uniqueness
We prove existence and uniqueness by showing that the general equilibrium belongs to the
class of models analyzed by Allen et al. (2016).
    Allen et al. (2016) consider the following system of equations:
                                 K                               N               K
                                 Y         γ                    X               Y           βkh
                                        xhi kh    =    cki   +         Kijk            xhj          ,
                                 h=1                             j=1             h=1




                                                              57
where i, j ∈ {1, .., N } are firms/sectors, xhi is the type h equilibrium variable, cki is a constant
and Kijk are exogenous linkages between i and j. With K = 1 this reduces to
                                                      N
                                                      X
                                         xγi = ci +         Kij xβj .                                    (23)
                                                      j=1

    The backward fixed point in equation (21) can be written in the form of equation (23)
with γ = 1, ci = 0, β = γ (1 − α) and Kij = Zk ωki . Using their notation, A is simply
γ (1 − α) and therefore the maximum eigenvalue of Ap is also γ (1 − α) < 1. According to
their Theorem 2(i), there exists a unique and strictly positive solution to the backward fixed
point.
   The forward fixed point  Pin equation (22) can be written in the form ofequation
                                                                                     (23) with
                  γ(1−α)           γ(1−α)
γ = 1, ci = Zi P̃i       X/    j P̃j      z̃j , β = 1 and Kij = γ (1 − α) ωij / µP̃j . Using their
notation, A is 1 and therefore the maximum eigenvalue of Ap is also 1. According to their
Theorem 2(ii.a) there exists at most one strictly positive solution to the forward fixed point.


D        Additional Results and Robustness
D.1      Exogenous mobility test
We report 81 separate hypothesis tests across all buyer-seller pair bins in Table 18. Each
column refers to the change from buyer decile t to t + 1, and each row refers to the change
from seller decile t to t + 1. For example, the cell (3-2,2-1) reports the difference ln m3,2 −
                            
ln m3,1 − ln m2,2 − ln m2,1 .

                                 Table 18: Exogenous mobility test.

                                                       Buyer decile
                          2-1     3-2      4-3     5-4    6-5     7-6           8-7     9-8     10-9
                  2-1    0.01∗   0.02∗    0.02∗   0.03∗       0.02∗      0.01   0.01∗    0.01   -0.04∗
                  3-2    0.04∗   0.01∗    0.01    0.00         0.00     0.01∗   0.00     0.01    0.02∗
                  4-3     0.01   0.01∗    0.02∗   0.00        0.01       0.00   0.01     0.00   0.03∗
                  5-4     0.00   -0.01    0.00    0.01∗       0.00       0.00   0.00    0.00    0.08∗
 Seller decile    6-5    0.02∗   0.02∗    0.01    0.00         0.01     0.01    0.02∗    0.00   0.02∗
                  7-6    0.04∗   0.02∗    0.02∗   0.01∗       0.01∗      0.01   0.01    0.03∗    0.00
                  8-7     0.00   0.01∗    0.00    0.00        0.03∗     -0.01   0.00    -0.01    0.01
                  9-8    -0.01   0.02∗    0.02∗   0.01        -0.01     0.02∗   0.01    0.05∗   0.08∗
                 10-9    0.03∗   0.04∗    0.01    0.02∗       0.02∗     0.02∗   0.02∗   0.04∗   0.19∗

  Note: The table shows the double difference from equation (14) in the main text. Significance: * < 5%,
  ** < 1%, *** <0.1%. t values are based on Welsh’s t-test.



                                                   58
D.2     Variance decompositions
This section derives statistical properties of the baseline variance decomposition. Consider
the following identity:
                                                       X
                                               s≡           ak .
                                                        k

The variance of s is
                                               X               XX
                                 var (s) =             σkk +                      σki ,              (24)
                                               k                   k       i6=k

where σki = cov (ak , ai ). In the baseline decomposition, we regress each element ak on s. By
the properties of OLS, the estimate is
                                                                      !
                                 cov (ak , s)     1           X
                           βk =               =         σkk +      σki .                   (25)
                                   var (s)      var (s)       i6=k


Note that the sum of all βk ’s equals one,
                                                                                          !
                          X            1       X                   XX
                              βk =                      σkk +                      σki        = 1.
                          k
                                     var (s)       k                   k    i6=k


Also note that in the case with only two components, the covariance term in equation (25)
is split equally among components:

                                     β1 = (σ11 + σ12 ) /var (s)
                                     β2 = (σ22 + σ12 ) /var (s) .

D.3     A Monte Carlo Simulation
This section performs a Monte Carlo simulation to assess the statistical properties of the
estimating model. We simulate a random network, draw random shocks for Zi and ωij ,
and solve the model. This entails solving the full general equilibrium, which is described in
Section 7. Given simulated data on (i) network linkages and (ii) ln mij , we estimate buyer and
seller fixed effects from equation (1) as described above. Wethen test whether we can recover
the model parameters P̃i and Zi (from Pi1−σ = γi Mi / θi θ̈ and Zi = ψi (θi / (γi Mi ))γi (1−αi ) ,
see Sections 4.3 and 4.4) as well as the error term ωij .
   We summarize key parameters of the model in Table 19. Figure 13 shows the estimated
and true values for ln Zi , ln Pi1−σ and ln ωij on the horizontal and vertical axes, respectively.
The correlations between true and estimated values are between 0.95 and 0.99, showing that
the empirical model recovers the true model parameters with high precision.


                                                       59
                              Table 19: Summary of Parameters.


                  Parameter            Definition                          Value

                  Network activity:
                  ln Zi       Production capability                        Standard normal
                  ln ωij      Pair-wise sales shock                        Standard normal
                  α           Labor cost share                             0.4
                  µ           Markup                                       1.33
                  γ           Network input share                          1
                  N           Number of firms                              1,000

                  Network formation:
                  ln ij       Matching shock                              Standard normal
                  Match if ln Zi + ln z̃j + ln ij > 2.5




                              Figure 13: Monte Carlo Simulation.
                                                           lnZ
         5
Model




         0


        -5
             -2         -1             0            1                  2           3            4       5
                                                        Estimated
                                                        lnP(1- )
        20
Model




        15


        10
          -8                 -7            -6              -5                -4            -3           -2
                                                        Estimated
                                                           ln
         5
Model




         0


        -5
             -5    -4             -3       -2       -1             0         1         2            3   4
                                                        Estimated




                                                        60
                       Figure 14: Model Fit. Exogenous Final Demand.




           Note: The figure shows the equilibrium ln Si calculated from equation (17) with
           exogenous final demand on the horizontal axis and ln Si from balance-sheet data on
           the vertical axis.



D.4     Model Fit
This section explores the source of prediction error between firm-level total sales Si in the
model and in the data, as illustrated in Figure 11 in the main text.
  A potential source of error is sales to final demand, which in the model is determined by
the first term in parentheses in equation (17). Prediction errors in final demand will have
a direct and an indirect effect. The direct effect is that total sales are the sum of network
sales and final demand sales, so that errors in final demand for firm i directly translate into
errors in its total sales Si . The indirect effect is that errors in the total sales of firm i (the
direct effect) affect the network sales of all suppliers of firm i. The prediction errors will thus
propagate through the production network.
    We investigate this source of error by replacing  the endogenous final demand component
                        γ(1−α)    P γ(1−α) 
in equation (17), Zi P̃i       X/    j P̃j    z̃j , with final demand as observed in the data,
Fi , and then re-calculating the forward fixed point. The new scatterplot between model-
generated and observed total sales is shown in Figure 14. Prediction errors are significantly
reduced compared to Figure 11, and the correlation coefficient between Si in the model and
in the data is now 0.96. The remaining sources of error are heterogeneity in labor shares,
network input shares and markups (αi , γi and µi ).


                                                  61
                 Table 20: Firm Size Decomposition by Year (2002-2014).


                Year     N        Upstream    Downstream      Final Demand
                                    lnψi         lnξi              lnβi
                2002 81,399          .17∗∗∗       .78∗∗∗          .05∗∗∗
                2003 83,804          .17∗∗∗       .78∗∗∗          .05∗∗∗
                                         ∗∗∗         ∗∗∗
                2004 85,161          .18          .78             .04∗∗∗
                2005 86,602          .17∗∗∗       .78∗∗∗          .04∗∗∗
                2006 88,693          .17∗∗∗       .79∗∗∗          .04∗∗∗
                                         ∗∗∗         ∗∗∗
                2007 91,155          .18          .79             .03∗∗∗
                2008 92,451          .18∗∗∗       .79∗∗∗          .03∗∗∗
                                         ∗∗∗         ∗∗∗
                2009 92,511          .17          .79             .04∗∗∗
                2010 92,885          .17∗∗∗       .79∗∗∗          .04∗∗∗
                2011 94,257          .18∗∗∗       .80∗∗∗          .03∗∗∗
                                         ∗∗∗         ∗∗∗
                2012 95,534          .18          .79             .03∗∗∗
                2013 94,297          .18∗∗∗       .80∗∗∗          .02∗∗∗
                                         ∗∗∗         ∗∗∗
                2014 94,330          .18          .81              .01∗∗
Note: The table reports coefficient estimates from OLS regressions of a firm size margin (as
 indicated in the column heading) on total firm sales. All variables in logs. Significance: *
                                < 5%, ** < 1%, *** <0.1%.

D.5     Additional Robustness
D.5.1   Results by Year

This section performs the exact firm size decomposition for every year from 2002 to 2014.
We find that the sources of firm size heterogeneity have remained remarkably stable over
time.
   We perform the analysis from Section 3 separately for each year in the data, and report
the results in Table 20. The importance of the upstream component has stood firmly at
17-18%. The downstream component has gradually risen from 78% to 81%, closely following
a decline in final demand from 5% to 1%. We observe similarly stable patterns when we con-
sider the lower-tier decomposition of the downstream and upstream components (available
upon request). These findings suggest that there may be inherent drivers of the firm size
distribution whose relative importance persists despite the rise in production fragmentation
across firm and country boundaries over the last 15 years.

D.5.2   Results by sector

We have also explored the stability of our results across different sectors (available upon
request) by performing the decomposition exercise separately for six broad sector groups.

                                             62
Across the board, the estimated coefficients are relatively close to the baseline findings in
the main paper. One exception is construction (NACE 41 to 43), where the final demand
term βi enters with a coefficient of -0.10. However, this is expected, as large construction
firms typically sell relatively less to final demand compared to small construction firms.

D.5.3    Firm Growth

The baseline decomposition relates the variance of sales across firms to the variance of
different sales margins. A related question is what explains the variance of firm sales growth.
We proceed as follows. First, we estimate equation (7) on two cross-sections, the baseline
year 2014 (t = 1) and year 2002 (t = 0). We then calculate the change in every demeaned
variable in the decomposition. For example, the overall decomposition from (??) becomes

                          ∆T ln Si = ∆T ln ψi + ∆T ln ξi + ∆T ln βi ,

where ∆T denotes the change from t = 0 to t = 1, e.g. ∆T ln Si = ∆S ln Si1 − ∆S ln Si0 . We
then demean all variables at the NACE 4-digit level. Finally, we regress each component,
e.g. ∆T ln ψi , on ∆T ln Si . This decomposition allows us to assess the importance of the
network in explaining firm growth. Note that long differencing is only feasible for firms that
are observed with non-missing sales as well as buyer and seller effects in both years, such
that we cannot perform the decomposition on firms that enter or exit during the sample
period. However, the decomposition accounts for the adding and dropping of customers
and suppliers, i.e. the terms ∆T ln ψi and ∆T ln ξi may change because of extensive margin
adjustments.
   The results are summarized in Table 21. At a broad level, the contribution of each com-
ponent is quite close to what we found in the baseline cross-sectional analysis, yet there
are some notable differences in magnitudes. For example, the downstream component domi-
nates in the overall decomposition, with the same contribution as in the cross-section of 81%.
However, the upstream and final demand components are now equally important at 9-10%,
while final demand played a trivial role of 1% before. On the upstream side, all growth over
time comes from improvements in own production capability (100%). On the downstream
side, the number of customers is the primary driver of variation in both firm growth and
firm sales in the cross-section, but it generates 61% of the former compared to 71% of the
latter. This is counterbalanced by a greater role for the customer covariance term in the
growth decomposition (38%) relative to the levels decomposition (26%). Alternative long
differences from 2002-2008 and 2008-2014 give very similar results (available upon request).




                                              63
                     Table 21: Firm Growth Decomposition (2002-2014).


              Firm Size Component                      Sales     Downstream       Upstream
                                                        Si           ξi              ψi
              Upstream                           ψi    .09∗∗∗
         Si   Downstream                         ξi    .81∗∗∗
              Final Demand                       βi    .10∗∗∗
              # Customers                        nci                 .61∗∗∗
         ξi   Avg Customer Capability            θ̄i                 .01∗∗∗
              Customer Covariance                Ωci                 .38∗∗∗
              Own Production Capability          Zi                                .99∗∗∗
              # Suppliers                        nsi                              -.02∗∗∗
         ψi
              Avg Supplier Capability            ψ̄i                               .01∗∗∗
              Supplier Covariance                Ωci                               .02∗∗∗
              N                                        41,177       41,177          41,177

       Note: The table reports coefficient estimates from OLS regressions of a firm size margin
       (as indicated in the row heading) on total firm sales (column 3), lnξi (column 4) or lnψi
       (column 5). All variables in logs. Significance: * < 5%, ** < 1%, *** <0.1%.



   We draw three conclusions about the sources of firm growth from these patterns. First,
the vast heterogeneity in growth rates across firms stems from some firms successfully ex-
panding their sales to downstream buyers in the production network. This entails adding
more customers over time, but also effectively redirecting sales towards buyers that are both
big and well matched. The greater importance of the latter margin for firm growth relative
to the cross-section would be consistent with the presence of matching costs and ex-ante
imperfect information about buyers. Bigger firms may be able to match with more buyers at
a given point, as well as to more effectively reallocate sales among them as match qualities
are revealed over time, with both forces contributing to faster sales growth.
   Second, while the variation in final demand is not important for firms’ relative perfor-
mance in the cross-section, tapping final consumers helps surviving firms expand revenues to
a greater degree. Note that in our data, this corresponds to a rise in sales to final domestic
consumers as well as to foreign markets.
   Finally, faster growing firms enhance their efficiency and/or product quality mainly by
increasing their own production capability. While big firms do benefit from more effective
input sourcing in the cross-section, firms’ sales growth does not come from further optimizing
their sourcing behavior. To the limited extent that fast-growing firms do adjust along this
dimension, they reduce the number of input suppliers and shift purchases towards well-

                                                  64
matched suppliers in equal measure, without changing average supplier capability. The
contrasting results for the upstream and downstream network components of firm growth
indicate that firms may face different matching frictions and information asymmetries in
their interactions with buyers and suppliers, which translate into different firm dynamics on
the production and sales side.




                                             65
