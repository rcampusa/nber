                                NBER WORKING PAPER SERIES




                               EXTRAPOLATION AND BUBBLES

                                          Nicholas Barberis
                                          Robin Greenwood
                                            Lawrence Jin
                                           Andrei Shleifer

                                        Working Paper 21944
                                http://www.nber.org/papers/w21944


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     January 2016




The authors’ affiliations are Yale School of Management, Harvard Business School, California Institute
of Technology, and Harvard University, respectively. We are grateful to Alex Chinco, Charles Nathanson,
Alp Simsek, Adi Sunderam, and seminar participants at Berkeley, Caltech, Cornell, Northwestern,
Ohio State, Yale, the AEA, the Miami Behavioral Finance Conference, and the NBER for very helpful
comments. The views expressed herein are those of the authors and do not necessarily reflect the views
of the National Bureau of Economic Research.

At least one co-author has disclosed a financial relationship of potential relevance for this research.
Further information is available online at http://www.nber.org/papers/w21944.ack

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2016 by Nicholas Barberis, Robin Greenwood, Lawrence Jin, and Andrei Shleifer. All rights reserved.
Short sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.
Extrapolation and Bubbles
Nicholas Barberis, Robin Greenwood, Lawrence Jin, and Andrei Shleifer
NBER Working Paper No. 21944
January 2016
JEL No. G02,G12

                                             ABSTRACT

We present an extrapolative model of bubbles. In the model, many investors form their demand for
a risky asset by weighing two signals—an average of the asset’s past price changes and the asset’s
degree of overvaluation. The two signals are in conflict, and investors “waver” over time in the relative
weight they put on them. The model predicts that good news about fundamentals can trigger large
price bubbles. We analyze the patterns of cash-flow news that generate the largest bubbles, the reasons
why bubbles collapse, and the frequency with which they occur. The model also predicts that bubbles
will be accompanied by high trading volume, and that volume increases with past asset returns. We
present empirical evidence that bears on some of the model’s distinctive predictions.


Nicholas Barberis                                   Lawrence Jin
Yale School of Management                           California Institute of Technology
135 Prospect Street                                 1200 E. California Blvd. MC 228-77
P O Box 208200                                      Pasadena, CA 91125
New Haven, CT 06520-8200                            lawrence.jin@caltech.edu
and NBER
nick.barberis@yale.edu                              Andrei Shleifer
                                                    Department of Economics
Robin Greenwood                                     Harvard University
Harvard Business School                             Littauer Center M-9
Baker Library 267                                   Cambridge, MA 02138
Soldiers Field                                      and NBER
Boston, MA 02163                                    ashleifer@harvard.edu
and NBER
rgreenwood@hbs.edu
1     Introduction
In classical accounts of ﬁnancial market bubbles, the price of an asset rises dramatically over
the course of a few months or even years, reaching levels that appear to far exceed reason-
able valuations of the asset’s future cash ﬂows. These price increases are accompanied by
widespread speculation and high trading volume. The bubble eventually ends with a crash,
in which prices collapse even more quickly than they rose. Bubble episodes have fascinated
economists and historians for centuries (e.g., Mackay 1841, Bagehot 1873, Galbraith 1954,
Kindleberger 1978, Shiller 2000), in part because human behavior in bubbles is so hard to
explain, and in part because of the devastating side eﬀects of the crash.
    At the heart of the standard historical narratives of bubbles is the concept of extrapolation—
the formation of expected returns by investors based on past returns. In these narratives,
extrapolators buy assets whose prices have risen because they expect them to keep ris-
ing. According to Bagehot (1873), “owners of savings . . . rush into anything that promises
speciously, and when they ﬁnd that these specious investments can be disposed of at a high
proﬁt, they rush into them more and more.” These historical narratives are supported by
more recent research on investor expectations, using both survey data and lab experiments.
Case, Shiller, and Thompson (2012) show that in the U.S. housing market, homebuyers’
expectations of future house price appreciation are closely related to lagged house price ap-
preciation. Greenwood and Shleifer (2014) present survey evidence of expectations of stock
market returns and ﬁnd strong evidence of extrapolation, including during the internet bub-
ble. Extrapolation also shows up in data on expectations of participants in experimental
bubbles, where subjects can be explicitly asked about their expectations of returns. Both the
classic study of Smith, Suchanek, and Williams (1988) and more recent experiments such
as Haruvy, Lahav, and Noussair (2007) ﬁnd direct evidence of extrapolative expectations
during a well-deﬁned experimental price bubble.
    In this paper, we present a new model of bubbles based on extrapolation. In doing so, we
seek to shed light on two key features commonly associated with bubbles. The ﬁrst is what
Kindleberger (1978) called “displacement”—the fact that nearly all bubbles from tulips to
South Sea to the 1929 U.S. stock market to the late 1990s internet occur on the back of


                                               2
good fundamental news. We would like to understand which patterns of news are likely to
generate the largest bubbles, and whether a bubble can survive once the good news comes
to an end. Second, we would like to explain the crucial fact that bubbles feature very high
trading volume (Galbraith 1954, Carlos, Neal, and Wandschneider 2006, Hong and Stein
2007). At ﬁrst sight, it is not clear how extrapolation can explain this: if, during a bubble,
all extrapolators hold similarly bullish views, they will not trade with each other.
       To address these questions, we present a model in the spirit of earlier work by Cutler,
Poterba, and Summers (1990), De Long et al. (1990), Hong and Stein (1999), Barberis and
Shleifer (2003), and Barberis et al. (2015), but with some signiﬁcant new elements.1 There
is a risk-free asset and a risky asset that pays a liquidating cash ﬂow at a ﬁxed time in the
future. Each period, news about the value of the ﬁnal cash ﬂow is publicly released. There
are two types of investors. The ﬁrst type is extrapolators, who form their share demand based
on an extrapolative “growth signal”, which is a weighted average of past price changes. In a
departure from prior models, extrapolators also put some weight on a “value signal” which
measures the diﬀerence between the price and a rational valuation of the ﬁnal cash ﬂow. The
two signals, which can be interpreted as “greed” and “fear”, give the extrapolator conﬂicting
messages. If prices have been rising strongly and the asset is overvalued, the growth signal
encourages him to buy (“greed”) while the value signal encourages him to sell (“fear”).
       Our second departure from prior models is to assume that, at each date, and indepen-
dently of other extrapolators, each extrapolator slightly but randomly shifts the relative
weight he puts on the two signals. This assumption, which we refer to as “wavering”, re-
ﬂects extrapolators’ ambivalence about how to balance the conﬂicting signals they face. Such
wavering has a biological foundation in partially random allocation of attention to various
attributes of choice, which in our case are growth and value signals (see Fehr and Rangel
2011). Importantly, the degree of wavering is constant over time. We show that wavering
can plausibly account for a good deal of evidence other models have trouble with.
       As in earlier models, extrapolators are met in the market by fundamental traders who
   1
       These earlier papers use models of return extrapolation to examine excess volatility, return predictability,
and nonzero return autocorrelations. They do not discuss bubbles. Glaeser and Nathanson (2015) analyze
housing bubbles using a return extrapolation framework, albeit one that is diﬀerent from ours.



                                                          3
lean against the wind, buying the asset when its price is low relative to their valuation of
the ﬁnal cash ﬂow and selling when its price is high. Both extrapolators and fundamental
traders face short-sale constraints.
   In line with Kindleberger’s notion of displacement, a bubble forms in our model after
a sequence of large positive cash-ﬂow shocks. The bubble evolves in three stages. In the
ﬁrst stage, the cash-ﬂow news pushes up the asset’s price; extrapolators sharply increase
their demand for the risky asset, buying from fundamental traders. In the second stage, the
asset becomes suﬃciently overvalued that the fundamental traders exit the market, leaving
the asset in the hands of the exuberant extrapolators who trade with each other because of
wavering. Once the good cash-ﬂow news subsides, prices stop rising as rapidly, extrapolator
enthusiasm abates, and the bubble begins its collapse. In the third stage, prices fall far
enough that fundamental traders re-enter the market, buying from extrapolators.
   In our model, the largest bubbles arise from sequences of cash-ﬂow shocks that ﬁrst
increase in magnitude, and then decrease. Wavering can signiﬁcantly increase the size of a
bubble through a novel mechanism that we call a “price spiral”. During a bubble, the asset
can become so overvalued that even some extrapolators hit their short-sale constraints. The
bubble selects only the most bullish investors as asset holders, which leads to an even greater
overvaluation, causing even more extrapolators to leave. The bubble takes on a life of its
own, persisting well after the end of the positive cash-ﬂow news.
   The model predicts substantial volume in the ﬁrst and third stages of a bubble, as
fundamental traders sell to extrapolators and vice-versa. But it predicts particularly intense
trading during the height of the bubble as extrapolators, as a consequence of wavering, trade
among themselves. During normal times, wavering has very little impact on trading volume
because it is minor. During bubbles, in contrast, the same small degree of wavering that
generates little volume in normal times endogenously generates intense volume: the growth
and value signals that extrapolators attend to are now so large in magnitude that even tiny
shifts in their relative weights lead to large portfolio adjustments. One manifestation of
such adjustments, exempliﬁed by Isaac Newton’s participation in the South Sea bubble, is
extrapolators getting in, out, and back in the market.
   After presenting the model, we compare it to two standard approaches to modeling


                                              4
bubbles: rational bubbles (Blanchard and Watson 1982, Tirole 1985) and disagreement
(Harrison and Kreps 1978, Scheinkman and Xiong 2003). Models of rational bubbles assume
homogeneous investors and therefore cannot explain any volume, let alone highly speciﬁc
patterns of volume documented in the literature. In addition, models of rational bubbles
do not rely on Kindleberger’s displacement, which seems central to most historical episodes.
Finally, direct tests of the key prediction of rational bubbles—that payoﬀs in the inﬁnite
future have positive present value—ﬁnd no support for that prediction (Giglio, Maggiori, and
Stroebel 2015). Disagreement-based models can explain high volume during bubbles with
an exogenous increase in disagreement. In our model, in contrast, the increase in volume
is due to disagreement that grows endogenously over the course of the bubble. Indeed,
in our model, volume during a bubble is predicted by past return, a new prediction that
other bubble models do not share. Our framework is also more successful at matching the
extrapolative expectations that many investors hold during bubble periods.
   Finally, we examine empirically some of the model’s predictions. Using data from four
historical bubbles, we document that trading volume during a bubble is strongly predicted
by high past returns. For the technology bubble of the late 1990s, we also show that, as the
bubble progresses, it draws in new investors with extrapolator-like characteristics. Some of
the less obvious predictions of the model are thus consistent with empirical evidence.
   Some recent research has questioned whether bubble-like price episodes are actually ir-
rational (Pastor and Veronesi 2006) or whether bubbles in the sense of prices undeniably
and substantially exceeding fundamentals over a period of time ever exist (Fama 2014). Al-
though the existence of bubbles in this sense appears uncontroversial in experimental (Smith,
Suchanek, and Williams 1988) or some unusual market (Xiong and Yu 2011) settings, our
paper does not speak to these controversies. Rather, we show how a simple model of extrap-
olative bubbles explains a lot of evidence and makes new predictions.
   In the next section, we present our model. Sections 3 and 4 describe circumstances
under which bubbles occur and present our ﬁndings for price patterns and volume. Section 5
considers the possibility of negative bubbles. Section 6 compares our model to other models
of bubbles while Section 7 presents the empirical evidence. Section 8 concludes. All proofs
are in the Appendix.


                                             5
2     A model of bubbles
We consider an economy with T + 1 dates, t = 0, 1, . . . , T. There are two assets: one risk-free
and one risky. The risk-free asset earns a constant return which we normalize to zero. The
                                                                            T paid at the
risky asset, which has a ﬁxed supply of Q shares, is a claim to a dividend D
                             T is given by
ﬁnal date, T . The value of D

                                      T = D0 + ε1 + . . . + εT ,
                                     D                                                       (1)

where
                                  εt ∼ N(0, σε2 ), i.i.d. over time.                        (2)

The value of D0 is public information at time 0, while the value of εt is realized and becomes
public information at time t. The price of the risky asset, Pt , is determined endogenously.
    There are two types of traders in the economy: fundamental traders and extrapolators.
The time t per-capita demand of fundamental traders for shares of the risky asset is

                                   Dt − γσε2 (T − t − 1)Q − Pt
                                                               ,                             (3)
                                               γσε2
                  t
where Dt = D0 +      j=1 εj   and γ is fundamental traders’ coeﬃcient of absolute risk aversion.
    In the Appendix, we show how this expression can be derived from utility maximization.
In brief, it is the demand of an investor who, at each time, maximizes a constant absolute risk
aversion (CARA) utility function deﬁned over next period’s wealth, and who is boundedly
rational: he uses backward induction to determine his time t demand, but, at each stage
of the backward induction process, he assumes that, in future periods, the other investors
in the economy will simply hold their per-capita share of the risky asset supply. In other
words, he does not have a detailed understanding of how other investors in the economy
form their share demands. For this investor, the expression Dt − γσε2 (T − t − 1)Q in the
numerator of (3) is the expected price of the risky asset at the next date, date t + 1. The
numerator is therefore the expected price change over the next period, and the fundamental
trader’s demand is this expected price change scaled by the trader’s risk aversion and by his
estimate of the risk he is facing. If all investors in the economy were fundamental traders,
then, setting the expression in (3) equal to the risky asset supply of Q, the equilibrium price

                                                   6
of the risky asset would be
                                            Dt − γσε2 (T − t)Q.                                           (4)

We call this the “fundamental value” of the risky asset and denote it by PtF .2
       Extrapolators are the second type of trader in the economy. There are I types of extrap-
olators, indexed by i ∈ {1, 2, . . . , I}; we explain below how one type of extrapolator diﬀers
from another. We build up our speciﬁcation of extrapolator demand for the risky asset in
three steps. An initial speciﬁcation of per-capita extrapolator share demand at time t is

                    Xt                              
                                                    t−1
                         ,   where Xt ≡ (1 − θ)           θk−1 (Pt−k − Pt−k−1 ) + θt−1 X1 ,               (5)
                    γσε2                            k=1

and where 0 < θ < 1.
       In the Appendix, we show that this is the demand of an investor who, at each time,
maximizes a CARA utility function deﬁned over next period’s wealth, and whose belief
about the expected price change of the risky asset over the next period is a weighted average
of past price changes, with more recent price changes weighted more heavily. The parameter
X1 is a constant that measures extrapolator enthusiasm at time 1; in our numerical analysis,
we assign it a neutral, steady-state value. The speciﬁcation in (5) is similar to that in
previous models of extrapolative beliefs, which have been used to shed light on asset pricing
anomalies (Cutler, Poterba, and Summers 1990, De Long et al. 1990, Hong and Stein 1999,
Barberis and Shleifer 2003, Barberis et al. 2015).3
       We modify the speciﬁcation in (5) in two quantitatively small but conceptually signiﬁcant
ways. First, we make extrapolators pay at least some attention to how the price of the risky
asset compares to its fundamental value. Speciﬁcally, we change the demand function in (5)
   2
       We assume, for simplicity, that fundamental traders’ estimate of the risk they are facing is given by
fundamental risk σε2 rather than by the conditional variance of price changes. When fundamental traders
are the only traders in the economy, this approximation is exact.
   3
     The form of bounded rationality we have assumed for fundamental traders means that these traders
expect the price of the risky asset to revert to fundamental value within one period. This, in turn, means
that they trade aggressively against any mispricing—more aggressively than if they were fully rational. In the
latter case, they would recognize that extrapolator demand is persistent and would trade more conservatively
against it. Under some conditions, they may even trade in the same direction as extrapolators (De Long et
al. 1990, Brunnermeier and Nagel 2004).


                                                      7
so that the demand of extrapolator i takes the form
                                                                    
                       Dt − γσε2 (T − t − 1)Q − Pt                Xt
                  wi                                 + (1 − wi)          .                             (6)
                                   γσε2                           γσε2

Extrapolator i’s demand is now a weighted average of two components. The second compo-
nent is the expression we started with in (5), while the ﬁrst component is the fundamental
trader demand from (3); wi is the weight on the ﬁrst component. Our framework accommo-
dates any wi ∈ (0, 1], but we maintain wi < 0.5 for all i so that the extrapolative component
is weighted more heavily. In our numerical work, the value of wi is approximately 0.1. The
motivation for (6) is that even extrapolators worry about how the price of the risky asset
compares to its fundamental value. A high price relative to fundamental value exerts some
downward pressure on their demand, counteracting the extrapolative component.
       In what follows, we refer to the two components of the demand function in (6) as “signals”:
the ﬁrst component, the expression in (3), is a “value” signal; the second component, the
expression in (5), is a “growth” signal. These signals typically point in opposite directions.
If the price of the risky asset is well above fundamental value, it has usually also been rising
recently. The value signal then takes a large negative value, telling the investor to reduce
his position, while the growth signal takes a large positive value, telling the investor to
raise it. The signals can be informally interpreted in terms of “fear” and “greed”. If the
price has recently been rising, the value signal captures extrapolators’ fear that it might
fall back to fundamental value, while the growth signal captures greed, their excitement at
the prospect of more price rises. If the price has recently been falling, the growth signal
captures extrapolators’ fear of further price declines, and the value signal, their greed—their
excitement at the thought of prices rebounding toward fundamental value.4
       Our second modiﬁcation is to allow the weight wi to vary slightly over time, and in-
dependently so for each extrapolator type, so that the demand function for extrapolator i
becomes                                                                               
                                  Dt − γσε2 (T − t − 1)Q − Pt                     Xt
                       wi,t                                         + (1 − wi,t )            ,         (7)
                                              γσε2                                γσε2
where (7) diﬀers from (6) only in the t subscript added to wi,t . Since the demand function in
   4
       We use the term “growth signal” both for Xt /γσε2 and for Xt itself. When it is important to clarify
which of the two quantities is being referred to, we do so.


                                                       8
(6) is based on two signals that often point in opposite directions, the investor is likely to be
unsure of what to do—and, in particular, unsure about how to weight the signals at any point
in time. As we model it, the weight an extrapolator puts on each signal shifts or “wavers”
over time, to a small extent. Fehr and Rangel (2011) and Towal, Mormann, and Koch (2013)
argue that individual decisions are shaped by computations in the brain, which are mediated
by the allocation of attention to various attributes of choice that is in part random. We can
think of wavering as resulting from such random allocation of extrapolators’ attention to
growth and value signals.
       To model wavering, we set

                                    i,t
                       wi,t = w i + u

                       i,t ∼ N(0, σu2 ), i.i.d. over time and across extrapolators.
                       u                                                                                     (8)

Here, wi ∈ (0, 1] is the average weight that extrapolator i puts on the value signal; in our
numerical analysis, we set w i = 0.1 for all extrapolator types. The actual weight that
extrapolator i puts on the value signal at time t is the mean weight wi plus Normally-
distributed noise. To ensure that wi,t stays in the (0, 1] interval, we truncate the distribution
   i,t .5 Under our assumptions, the I types of extrapolator diﬀer only in the weight wi,t
of u
that they put on the value signal in each period. The values of the two signals themselves
are identical across extrapolators.
       We also impose short-sale constraints, so that the ﬁnal risky asset share demand of the
fundamental traders, NtF , and of extrapolator i ∈ {1, 2, . . . , I}, NtE,i , are given by
                                                                        
                           F          Dt − γσε2 (T − t − 1)Q − Pt
                       Nt = max                                       ,0                                     (9)
                                                  γσε2
and                                                                                
                                   Dt − γσε2 (T − t − 1)Q − Pt                   Xt
              NtE,i   = max wi,t                                 + (1 − wi,t )         ,0 .                 (10)
                                               γσε2                              γσε2
As we explain in Section 4, short-sale constraints are not needed for our most important
results. In contrast, the assumption that extrapolators waver slightly between a growth and
a value signal is crucial.
   5
       We truncate u
                   i,t at ±0.9 min(1 − wi, w i ), a formulation that allows the fundamental trader demand in (3)
to be a special case of the more general demand function in (7) and (8)—speciﬁcally the case where w i = 1.
The exact form of truncation is not important for our results.

                                                         9
       The proposition below lays out the equilibrium price of the risky asset in our economy.
The fundamental traders make up a fraction μ0 of the overall population, while extrapolators
                                         
of type i make up a fraction μi , so that Ii=0 μi = 1.6

Proposition 1. In the economy described above, a market-clearing price always exists and
is determined as follows. Let P i , i ∈ {0, 1, . . . , I}, be the risky asset price at which trader
i’s short-sale constraint starts to bind. Let NP i be the aggregate risky asset share demand
across all traders when the price equals P i . If maxi∈{0,1,...,I} NP i < Q, then, in equilibrium,
all traders have a positive demand for the risky asset and the asset’s price equals
                     I                                   I
                        i=1 μi (1 − wi,t )        2 (μ0 +  i=1 μi wi,t )(T − t − 1) + 1
          Pt = Dt +         I             Xt − γσε Q                                  .                    (11)
                     μ0 + i=1 μi wi,t                      μ0 + Ii=1 μi wi,t

Otherwise, let i∗ be the value of i ∈ {0, 1, . . . , I} for which NP i exceeds Q by the smallest
amount, and let I ∗ be the set of i ∈ {0, 1, . . . , I} such that trader i has strictly positive
demand for the risky asset at price P i∗ . In this case, in equilibrium, only the traders in I ∗
have a positive demand for the risky asset and the asset’s price equals7
                                                      
                       i∈I ∗ μi (1 − wi,t )        2 (   i∈I ∗ μi wi,t )(T − t − 1) + 1
           Pt = Dt +                       Xt − γσε Q                                 .                    (12)
                            i∈I ∗ μi wi,t                          i∈I ∗ μi wi,t

                                                                                                              

       The ﬁrst term on the right-hand side of each of (11) and (12) shows that the price of
the risky asset is anchored to the expected value of the ﬁnal cash ﬂow. The second term
reﬂects the impact of extrapolator demand: if past price changes have been high, so that Xt
is high, extrapolator demand at time t is high, exerting upward pressure on the price. The
third term is a price discount that compensates the holders of the risky asset for the risk
they bear.
       We deﬁne the “steady state” of our economy as the state to which the economy converges
after many periods in which the cash-ﬂow shocks equal zero. It is straightforward to show
that, in this steady state: the fundamental traders and all the extrapolators are in the
market, with each trader holding the risky asset in proportion to his weight in the population;
   6
       Here and elsewhere, we index fundamental traders by the number “0”.
   7
       If i = 0 is in the set I ∗ , the expression in (12) requires the value of w0,t , in other words, the weight
fundamental traders put on the value signal. By deﬁnition, w0,t = 1.


                                                        10
the price of the risky asset equals the fundamental value in (4); the change in price from one
date to the next is constant and equal to γσε2 Q; and the growth signal Xt , deﬁned in (5), is
also equal to γσε2 Q.


2.1        Parameter values

In Sections 3 and 4, we explore the predictions of our model through both analytical propo-
sitions and numerical analysis. We now discuss the parameter values that we use in the
numerical analysis. The asset-level parameters are D0 , Q, σε , and T . The investor-level
parameters are I, μ0 , μi and w i for i ∈ {1, . . . , I}, γ, θ, and σu .
       We begin with θ, which governs the weight extrapolators put on recent as opposed to
distant past price changes when forming beliefs about future price changes; as such, it
determines the magnitude of the growth signal Xt . In setting θ, we are guided by the survey
evidence analyzed by Greenwood and Shleifer (2014) on the beliefs of actual stock market
investors about future returns. If we assume that the time period in our model is a quarter,
the evidence and the calculations in Barberis et al. (2015) imply θ ≈ 0.9.8
       We set μ0 , the fraction of fundamental traders in the economy, to 0.3, so that fundamen-
tal traders make up 30% of the population, and extrapolators, 70%. The survey evidence
in Greenwood and Shleifer (2014) suggests that many investors in the economy are extrap-
olators. We have I = 50 types of extrapolators, where each type has the same population
weight, so that μi = (1 − μ0 )/I, for i = 1, . . . , I. As discussed earlier, we set wi to the
same low value of 0.1 for all extrapolators i. And we set γ to 0.1. We do not have strong
priors about the value of σu , which controls the degree of wavering. We assign it a low
value—speciﬁcally, 0.03—so as to show that even a small degree of wavering can generate
interesting results. This value of σu implies that, about two-thirds of the time, the weight
wi,t extrapolator i puts on the value signal is in the interval (0.07, 0.13), a very small degree
of wavering relative to the base weight wi = 0.1.
       We set the initial expected dividend D0 to 100, the standard deviation of cash-ﬂow shocks
   8
       Speciﬁcally, θ = exp(−(0.5)(0.25)) ≈ 0.9, where 0.5 is Barberis et al.’s (2015) estimate of the extrapo-
lation parameter in a continuous-time framework, and 0.25 corresponds to the one-quarter interval between
consecutive dates in our model.


                                                       11
σε to 3, the risky asset supply Q to 1, and the number of dates T to 50. Since the interval
between dates is a quarter, this value of T means that the life span of the risky asset is 12.5
years.



3         Asset prices in a bubble
Our model can generate the most essential feature of a bubble, namely a large and growing
overvaluation of the risky asset, where, by overvaluation, we mean that the price exceeds
the fundamental value in (4). In our model, bubbles are initiated by a sequence of large,
positive cash-ﬂow shocks, which here are news about the future liquidating dividend. Figure 1
illustrates this. It uses the parameter values from Section 2 and equations (1), (4), (5), (11),
and (12) to plot the price (solid line) and fundamental value (dashed line) of the risky asset
for a particular 50-period sequence of cash-ﬂow shocks, in other words, for a particular set
of values of ε1 , ε2 ,. . . , ε50 . The ﬁrst ten shocks, ε1 through ε10 , are all equal to zero. These
are followed by four positive shocks, namely 2, 4, 6, and 6; these are substantial shocks: the
last two are two-standard deviation shocks. These are followed by 36 more shocks of zero.9
        Once the positive shocks arrive, a large and sustained overpricing follows. The positive
cash-ﬂow news pushes prices up, which leads the extrapolators to sharply increase their
share demand in subsequent periods; this, in turn, pushes prices well above fundamental
value. Over the four periods of positive cash-ﬂow news, starting at date 11, the expected
ﬁnal dividend increases by 18, the sum of 2, 4, 6, and 6. The ﬁgure shows, however, that
between dates 11 and 18 prices rise by more than double this amount. After the cash-ﬂow
shocks drop back to zero at date 15, prices stop rising as rapidly; this, in turn, cuts oﬀ the
“fuel” driving extrapolator demand. These investors eventually start reducing their demand
and the bubble collapses.
        This bubble has three distinct stages deﬁned by the composition of the investor base. In
the ﬁrst stage, the fundamental traders are still in the market: even though the risky asset
    9
        We set the value of the growth signal at time 1, X1 , equal to the steady-state value of X, namely
γσε2 Q    = 0.9. This, together with the fact that the ﬁrst ten cash-ﬂow shocks are equal to zero, means that
the price of the risky asset equals the asset’s fundamental value for the ﬁrst ten periods.



                                                       12
is overvalued, the overvaluation is suﬃciently mild that the short-sale constraint does not
bind for the fundamental traders. In our example, this ﬁrst stage spans just two dates, 11
and 12. Figure 1 shows that, during this stage, the overvaluation is small in magnitude:
precisely because the fundamental traders are present in the market, they absorb much of
the demand pressure from extrapolators by selling to them.
       The second stage of the bubble begins when the risky asset becomes so overvalued that
the fundamental traders exit the market. In our example, this occurs at date 13. During
this stage, extrapolators alone trade the risky asset, which becomes progressively more over-
valued: the high past price changes make the extrapolators increasingly enthusiastic, and
there is no countering force from fundamental traders. In the absence of cash-ﬂow news,
however, the price increases eventually subside, extinguishing extrapolator enthusiasm and
causing the bubble to deﬂate.
       To see how the bubble in Figure 1 bursts, note that, from price equations (11) and (12),
the size of the bubble depends on the magnitude of the growth signal Xt , itself a measure of
extrapolator enthusiasm. From equation (5), this signal evolves as

                                     Xt+1 = θXt + (1 − θ)(Pt − Pt−1 ).                                    (13)

The ﬁrst term on the right-hand side, θXt , indicates that the bubble has a natural ten-
dency to deﬂate; recall that 0 < θ < 1. As time passes, the sharply positive price changes
that excited the extrapolators recede into the past; they are therefore downweighted, by
an amount θ, reducing extrapolator enthusiasm. However, if the most recent price change,
Pt − Pt−1 , is suﬃciently positive, both the growth signal and the bubble itself can maintain
their size. Once the good cash-ﬂow news subsides—after date 14 in our example—it becomes
increasingly unlikely that the most recent price change is large enough to oﬀset the bubble’s
tendency to deﬂate, in other words, that the second term on the right-hand side of (13)
will dominate the ﬁrst. As a consequence, the price level starts falling, sharply reducing
extrapolator enthusiasm, and setting in motion the collapse of the bubble.10
       The third stage of the bubble begins when the bubble has deﬂated to such an extent that
the fundamental traders re-enter the market. In our example, this occurs at date 23. In this
  10
       The use of leverage can amplify the eﬀects of extrapolation, leading to larger bubbles and more dramatic
collapses. See Simsek (2013) and Jin (2015) for analyses of this idea.

                                                       13
example, both the fundamental traders and the extrapolators are present in the market in
this stage. For other cash-ﬂow sequences, the price declines during the collapse of the bubble
can be so severe as to cause the extrapolators to exit the market, leaving the asset in the
hands of the fundamental traders for some period of time.
   Wavering does not play a signiﬁcant role in the evolution of the price path in Figure 1.
If we replaced the extrapolators in our model with extrapolators who all put the same,
invariant weight of 0.1 on the value signal, we would obtain a price path almost identical to
that in Figure 1. The reason is that, for the particular sequence of cash-ﬂow shocks used in
Figure 1, virtually all of the extrapolators are present in the market during all three stages
of the bubble. By the law of large numbers, the aggregate demand of I = 50 extrapolators
whose weight on the value signal equals 0.1 is approximately equal to the aggregate demand
of I = 50 extrapolators whose weight on the value signal is drawn from a distribution with
mean 0.1. As a result, the pricing of the risky asset is very similar whether the extrapolators
are homogeneous or waver.
   In some cases, however, wavering can signiﬁcantly amplify the overvaluation of the asset.
This is due to a novel bubble mechanism that we call a “price spiral”. During the second stage
of the bubble, when the fundamental traders are out of the market, the asset can become
so overvalued that even some extrapolators exit the market—speciﬁcally, those who put the
highest weight wi,t on the value signal. Once these extrapolators leave the market, the asset is
left in the hands of the more enthusiastic extrapolators, who put more weight on the growth
signal. This generates an even larger overvaluation, causing yet more extrapolators to hit
their short-sale constraints, and leaving the asset in the hands of an even more enthusiastic
group of extrapolators. Eventually, in the absence of positive cash-ﬂow shocks, the price
increases become less dramatic and extrapolator demand abates, causing the bubble to
deﬂate. At this point, extrapolators who had previously exited the market begin to re-enter.
   Figure 2 depicts a price spiral. The parameter values are the same as for Figure 1, but we
now use the cash-ﬂow sequence 2, 4, 6, 6, 12, 10 in place of 2, 4, 6, 6. The dashed line plots
the asset’s fundamental value, while the solid line plots its price. For comparison, the dash-
dot line plots the price in an economy where the extrapolators are homogeneous, placing
the same, invariant weight of 0.1 on the value signal. For this cash-ﬂow sequence, wavering


                                              14
signiﬁcantly ampliﬁes the degree of overpricing: the solid line rises well above the dash-dot
line. As explained above, this is due to some extrapolators exiting the market, starting at
date 15; at the peak of the price spiral around date 20, about half of the extrapolators are
out of the market.11
       Price spirals typically deﬂate within a few periods. In some cases, however—speciﬁcally,
for sequences of very large, positive cash-ﬂow shocks—the price spiral can lead to extremely
high prices that revert back only after many periods. We do not put much weight on this
prediction. First, the cash-ﬂow shocks required for such out-of-control spirals are so large as
to be unlikely in reality. Second, factors absent from our model, such as equity issuance by
ﬁrms, are likely to prevent these extreme spirals from arising.
       In Proposition 2 in the Appendix, we show how the magnitude of the asset’s overvaluation
at time t can be expressed as a function of the cash-ﬂow shocks that have been realized up
until that time. For example, suppose that the economy has been in its steady state up to
time l − 1 and that there is then a sequence of positive shocks εl , εl+1 ,. . ., εn that move
the economy from the ﬁrst stage of the bubble to the second stage of the bubble at some
intermediate date j with l < j < n. Suppose also that the bubble remains in the second
stage through at least date N > n, and that all the extrapolators are in the market in the
second stage, so that there is no price spiral. The proposition shows that, in this case, the
overvaluation at time t in the second stage, j ≤ t ≤ N, is approximately equal to
                                             
                                             t−1
                                                   L2 (t − m)εm ,                                        (14)
                                             m=j

where the coeﬃcients L2 (t − m) depend only on the model parameters and not on the values
of the shocks, and where the “2” subscript in L2 (·) indicates that the coeﬃcients are applied
to cash-ﬂow news that arrives during the second stage of the bubble: the summation in (14)
starts at time j, when the second stage begins.12
       The expression in (14) shows that the degree of overvaluation in the second stage has
  11
       The price spiral we have just described can also result from a type of heterogeneity that is simpler
than wavering, one where extrapolators diﬀer in the weight they put on the value signal, but this weight
is constant over time, so that wi,s = wi,t for all s, t. While the stochasticity embedded in wavering is not
required for price spirals to occur, it is crucial for the volume predictions in Section 4.
  12
     The proposition presents analogous results for the ﬁrst stage of the bubble and also for the second stage

                                                      15
a simple linear structure: it is approximately a weighted sum of the cash-ﬂow news in the
second stage, where the weights are constant. For example, if there have been eight cash-
ﬂow shocks during the second stage of the bubble, namely εt−8 , εt−7 , . . . , εt−1 , then, for the
parameter values we are using, the degree of overvaluation at time t is approximately

                       L2 (1)εt−1 + L2 (2)εt−2 + . . . + L2 (7)εt−7 + L2 (8)εt−8

 = 0.9εt−1 + 1.62εt−2 + 2.11εt−3 + 2.33εt−4 + 2.3εt−5 + 2.05εt−6 + 1.61εt−7 + 1.06εt−8 . (15)

This expression shows that the cash-ﬂow news that contributes the most to time t overvaluation—
the shock with the largest coeﬃcient—is the news from four periods earlier, εt−4 . This news
causes a price increase at time t − 4, which increases extrapolator enthusiasm at time t − 3,
thereby causing a larger price increase at that time as well; this, in turn, increases extrapola-
tor enthusiasm at time t−2, and so on. Through its accumulated eﬀect on prices over several
periods, the cash-ﬂow news εt−4 has a large impact on time t overvaluation. By contrast, the
most recent cash-ﬂow news, εt−1 , has a smaller eﬀect on time t overvaluation: much of its
impact will come after time t. The more distant cash-ﬂow news εt−8 also has a small eﬀect
on time t overvaluation. While that shock contributed to price increases at time t − 8 and
on a few subsequent dates, those price increases are now so far in the past that they have
little impact on extrapolator beliefs at time t.
    The expression in (15) helps us answer an interesting question: What kinds of cash-ﬂow
sequences generate the largest bubbles? More concretely, which sequence {εt−8 , . . . , εt−1 }
generates the largest overvaluation at time t? To generate a large bubble at time t, we want
to associate the highest value of ε with the highest value of L2 (·), namely 2.33; the second
highest value of ε with the second highest value of L2 (·), namely 2.3, and so on. Since the
highest values of the L2 (·) coeﬃcients are for lags that are temporally close—speciﬁcally, for
lags 3, 4, 5, and 6—this means that the largest bubbles occur when the biggest cash-ﬂow
shocks are clumped together in time. More generally, since, for the ﬁrst few lags, the L2 (·)
coeﬃcients rise to a peak and then decline, the largest bubble is created by a sequence of
cash-ﬂow news that itself rises to a peak and then declines. For example, if εt−8 through
in the case of a price spiral. For tractability, it assumes a continuum of extrapolators rather than a ﬁnite
number of them.


                                                    16
εt−1 take the values 1, 2, 3, 4, 5, 6, 7, 8, in some order, the above discussion suggests that
the largest time t overvaluation is generated by the ordering 2, 3, 5, 7, 8, 6, 4, 1—and this
is indeed the case.
   To compute the frequency of large bubbles in our model, we use the cash-ﬂow process in
(1) and the price processes in (11) and (12) to simulate a T = 40, 000-period price sequence
and record the number of bubbles for which the level of overvaluation—the bubble’s “size”—
exceeds a threshold such as 10 or 20, and also the length of time for which this threshold
is exceeded. To put these bubble sizes in context, recall that, in non-bubble times, a one-
standard deviation cash-ﬂow shock increases the asset’s price by approximately 3.
   In our model, bubbles are rare. For our benchmark parameter values, a bubble whose size
exceeds 10 occurs once every 17 years, on average, with the overvaluation exceeding 10 for
approximately one year. A bubble of size 20 occurs just once every 50 years, on average, and
maintains this size for approximately three quarters. Bubbles are rare for two reasons. First,
for a bubble to occur, the cash-ﬂow shocks need to be large enough to cause the fundamental
traders to exit. Second, for a large bubble to form, the cash-ﬂow shocks need to be both
large and clumped together in time. The probability of this happening is low.
   To conclude our analysis of prices, we verify, through simulations, that our model also
captures the basic asset pricing patterns that the previous generation of extrapolation models
was designed to explain. Speciﬁcally, we conﬁrm that our model generates excess volatility
(the standard deviation of price changes exceeds the standard deviation of changes in fun-
damental value); predictability (the diﬀerence between the dividend and the price at time
t, Dt − Pt , predicts the change in price over the next 12 periods, Pt+12 − Pt ); and positive
(negative) autocorrelations in price changes at short (long) lags. It is not surprising that
our framework can explain these facts: while we modify the earlier extrapolation models in
qualitatively signiﬁcant ways, these modiﬁcations are quantitatively small.




                                             17
4        Volume in a bubble
Bubbles feature very high trading volume (Ofek and Richardson 2003, Hong and Stein 2007).
A central goal of our paper is to propose a way to understand this fact.13
       Figure 3 plots the share demand NtF of the fundamental traders (dashed line) and the
share demands NtE,i of the I types of extrapolator (solid lines) for the same 50-period cash-
ﬂow sequence that we used in Figure 1, namely 10 shocks of zero, followed by four positive
shocks of 2, 4, 6, and 6, followed by 36 more shocks of zero. Recall from Figure 1 that this
sequence of cash-ﬂow shocks generates a large bubble between dates 15 and 21.
       Figure 3 shows that, during the bubble, share demands of extrapolators become very
volatile, suggesting a large increase in volume. Figure 4 conﬁrms this. The solid line in this
ﬁgure plots total trading volume at each of the 50 dates, and shows a dramatic increase
in volume between dates 12 and 25. As Figure 4 shows, our model predicts three “peaks”
in volume which correspond to the three bubble stages outlined in Section 3: a small peak
centered around date 13 in the ﬁrst stage, a much wider peak centered around date 17 in
the second stage, and a thin but tall peak centered around date 23 in the third stage. Total
volume at each date is the sum of two components: trading that takes place within the set
of I extrapolators, and trading that takes place between the extrapolators in aggregate and
fundamental traders. The dashed line in Figure 4 plots the ﬁrst component—trading volume
within the set of I extrapolators.
       The ﬁrst peak in Figure 4 centered around date 13 arises during the ﬁrst stage of the
bubble and reﬂects trading between the extrapolators in aggregate and fundamental traders.
Arrival of the good cash-ﬂow news pushes prices up, which, in turn, leads extrapolators to
buy and fundamental traders to sell the asset. Before long, however, all the fundamental
traders are out of the market and this ﬁrst wave of trading subsides.
       During the second stage, the bubble keeps growing and trading volume rises again, as
  13
       A small fraction of bubbles, often those associated with debt securities, do not exhibit very high trading
volume. Hong and Sraer (2013) explain this by noting that, if investors are over-optimistic about the value
of the asset underlying a debt security and also diﬀer in how optimistic they are, they overvalue the debt
security but do not disagree about its value—its value does not depend on beliefs about good states of the
world. Trading in the debt security is therefore muted.



                                                        18
indicated by the wide second peak centered around date 17 in Figure 4. In this stage, all of the
trading takes place among the I extrapolators. This potentially large volume generated by
our model is due to wavering. It is not surprising that, in general, wavering leads to trading
volume. What is more interesting is that, even though the degree of wavering remains fixed
over time—the value of σu in equation (8) is constant—the model endogenously generates
much greater volume during bubble periods than non-bubble periods.
       To understand this, we write the share demand of extrapolator i in equation (10) more
simply as wi,t Vt + (1 − wi,t )Gt , where Vt and Gt = Xt /γσε2 are the value and growth signals,
respectively, at time t. We ignore the short-sale constraint because it is not important for the
intuition. A unit change in the weight wi,t on the value signal changes the extrapolator’s share
demand by Vt −Gt . In “normal” times, when the cash-ﬂow shocks are neither abnormally high
nor abnormally low, the value and growth signals are both small in absolute magnitude: since
the risky asset is neither particularly overvalued nor undervalued, the value signal Vt is close
to zero in absolute magnitude; and since prices have not been rising or falling particularly
sharply in recent periods, the growth signal Gt is also close to zero in absolute magnitude.
In this case, Vt − Gt is itself low in absolute magnitude, implying that, in normal times,
wavering does not induce much variation in extrapolator demand.14
       During a bubble, the situation is very diﬀerent. At that time, the value signal Vt is large
and negative (the asset is highly overvalued), and the growth signal is large and positive (the
asset’s price has been rising sharply in recent periods). As a result, Vt − Gt is very large
in absolute value, and the same degree of wavering that generates low trading volume in
normal times now generates very high trading volume. This is the mechanism behind the
high trading volume represented by the wide peak centered around date 17 in Figure 4.
       To put this more simply, during the bubble, the extrapolators holding the risky asset
are subject to two powerful but conﬂicting investment signals. On the one hand, they
see that prices are far above fundamental value; this makes them fearful of a crash and
encourages them to sell. On the other hand, prices have recently been rising sharply, which
  14
       If the growth signal Gt rises in value, this increases the aggregate demand for the risky asset. To
counteract this increase and thus ensure that the market clears, the value signal Vt must decline. The two
signals are therefore related: the more positive one of them is, the more negative the other must be.



                                                     19
makes extrapolators expect continued price appreciation and encourages them to buy. These
two signals are so strong that even small shifts in their relative weights lead to large—and
independent across traders—portfolio adjustments, and hence trading volume.
   Once the bubble starts collapsing, the second wave of trading volume begins to subside:
as the bubble deﬂates, both the value and growth signals decline in absolute magnitude; the
quantity Vt − Gt then also declines in absolute magnitude, and the impact of wavering on
extrapolator share demands is reduced. Figure 4 shows that once the bubble’s collapse is
well under way, there is a third wave of trading, represented by the thin third peak centered
around date 23, between the selling extrapolators and the fundamental traders who re-enter
the market. The third peak is taller than the ﬁrst peak. The reason is that the ﬁrst peak
consists of extrapolators shifting from moderate holdings of the risky asset to large holdings
of the asset. The third peak consists of extrapolators shifting from large holdings of the
risky asset to low holdings of the asset as they extrapolate price declines into the future and
sell. This third volume peak thus represents more intense trading than the ﬁrst one.
   The central message in the discussion above is that a ﬁxed amount of wavering can
endogenously generate much higher trading volume during bubble periods. Proposition 3
below formalizes this idea in the following way. The change in extrapolator i’s share demand
between time t and time t + 1 has two components. The ﬁrst is unrelated to wavering; it is
present even if wi,t+1 = wi,t . Speciﬁcally, in the ﬁrst stage of the bubble, the extrapolator
buys from fundamental traders as the bubble grows, even in the absence of wavering; and
as the bubble grows further in its second stage, he buys from less bullish extrapolators if he
has a relatively low value of w i or sells to more bullish extrapolators if his w i is relatively
high—again, even in the absence of wavering.
   The second component of the change in the extrapolator’s share demand between time
t and time t + 1 is driven by wavering: it reﬂects his buying at time t + 1 during the
bubble if wi,t+1 shifts down at that time, or his selling if it shifts up. We sum the absolute
value of this second component across all extrapolators and label the sum “wavering-induced
trading volume,” V W (Xt ), a quantity that depends on Xt . Proposition 3 shows that V W (Xt )
is typically increasing in Xt , a measure of bubble size. This is the formal sense in which
wavering leads to more trading volume as the bubble grows.


                                               20
Proposition 3. Suppose that there is a continuum of extrapolators and that each extrap-
olator draws an independent weight wi,t at time t from a bounded and continuous density
function g(w), w ∈ [wl , wh ], with mean w and with 0 < wl < wh < 1. The sensitivity of
per-capita wavering-induced trading volume V W (Xt ) to the growth signal Xt , denoted by
∂V W (Xt )/∂Xt , is given by
             ⎧
             ⎪
             ⎪    sign(Xt − γσε2 Q)Δ0                         wl γσε2 Q                        γσε2 Q
             ⎪
             ⎪                              −                                      ≤ Xt <
∂V W (Xt ) ⎨ (μ0 + (1 − μ0 )w)γσε                μ0 (1 − wl ) + (1 − μ0 )(w − wl )        (1 − μ0 )(1 − w)
                                     2
           =                                                                                                 ,
   ∂Xt       ⎪
             ⎪             Δ0                                γσε2 Q                 wh γσε2 Q
             ⎪
             ⎪                                                           ≤ Xt ≤
             ⎩           wγσε2                          (1 − μ0 )(1 − w)        (wh − w)(1 − μ0 )
                                                                                              (16)
where
                                 wh                wh
                         Δ0 ≡         g(w1)dw1          |w1 − w2 |g(w2)dw2 .                  (17)
                                wl                wl

If Xt > wh γσε2 Q/[(wh − w)(1 − μ0 )], ∂V W (Xt )/∂Xt may become smaller and even turn
negative as extrapolators exit the market.                                                       

   The key part of Proposition 3 is the second row of (16). It says that, in the less extreme
part of the second stage of the bubble, when all extrapolators are in the market, wavering
induces more trading volume, the larger the size of the bubble: Δ0 is a positive quantity.
The same is true during the ﬁrst stage of the bubble—see the ﬁrst row of (16)—although the
relationship is weaker; moreover, wavering-induced volume is here a relatively small part of
overall trading volume. If, during its second stage, the bubble becomes so large that even
some extrapolators exit the market, then wavering-induced volume increases more slowly
as a function of Xt , and can even decrease, simply because there are fewer extrapolators
available to trade.
   The above analysis indicates that, during the bubble, wavering-induced volume is typi-
cally increasing in Xt . Since Xt is an average of past price changes, this suggests the following
testable prediction: during a bubble, volume is positively related to the asset’s past return.
To verify that this is a prediction of our model, we simulate a 40,000-period price sequence
from the model and extract three subsamples—the subsample where the asset price diﬀers
from fundamental value by less than γσε2 Q = 0.9; the subsample where the asset is overvalued



                                                  21
by at least γσε2 Q = 0.9; and the subsample where it is overvalued by at least 10γσε2 Q = 9.15
We ﬁnd that in these three subsamples, the correlation between volume at time t + 1 and the
price change between t − 4 and t, a year-long interval, is -0.22, 0.41, and 0.6, respectively.
These monotonically increasing correlations conﬁrm that, in our model, the relationship be-
tween trading volume and past return is stronger during bubble episodes. In Section 7.1, we
test this prediction for four historical bubbles.
       We conclude our discussion of trading volume with two points. First, alternative sources
of heterogeneity among extrapolators—sources other than wavering—do not generate nearly
as much trading volume during the bubble period. Speciﬁcally, if we turn oﬀ wavering by
setting σu in (8) to 0 and instead allow the base weights wi and the weighting parameter θ
to diﬀer across extrapolators, we no longer obtain a large second volume peak like the one
in Figure 4. The reason is that, after a sequence of price increases, extrapolators who do
not exhibit wavering would almost all like to increase their holdings of the risky asset, even
if they diﬀer in their values of wi and θ: regardless of the speciﬁc values of w i and θ, a high
growth signal means that most extrapolators ﬁnd the risky asset more attractive. Since most
extrapolators want to trade in the same direction, there is relatively little trading between
them: prices, not quantities, adjust. In our model, the speciﬁc type of heterogeneity induced
by wavering is uniquely able to generate heavy trading.16
       Second, our predictions for prices and volume during a bubble are driven primarily by
the presence of extrapolators who waver between two signals. The predictions do not depend
nearly as much on the short-sale constraints. For example, a model with extrapolators and
more sophisticated fundamental traders—traders who can short and who can forecast future
  15
       The quantity γσε2 Q is the degree of overvaluation that causes fundamental traders to exit the market;
it is therefore a natural “unit” of overvaluation.
   16
      In many bubble episodes, including two that we study in Section 7, the peak in volume coincides with
the peak in prices. This is the pattern predicted by our model so long as the degree of wavering, governed
by σu , is not too low. In the technology bubble of the late 1990s, the peak in volume precedes the peak in
prices (Hong and Stein 2007). While we do not have a full theory of this phenomenon, even here, wavering is
helpful for understanding the evidence. Although volume at the price peak is lower than it was a few months
earlier, it is still extremely high. In our model of extrapolators and fundamental traders, only wavering can
generate such intense trading.




                                                      22
extrapolator demand—would also generate a large overvaluation following good cash-ﬂow
news: the fundamental traders would recognize that extrapolator demand is persistent and
would therefore not trade aggressively against it (see Barberis et al. 2015 for a formal analysis
of this point). Moreover, there will be a lot of trading during the bubble, some of it between
fundamental traders and extrapolators, but much of it among extrapolators and driven by
wavering. We introduce short-sale constraints for simplicity and because they lead to more
realistic predictions in downturns. We discuss these predictions in the next section.



5        Negative bubbles
The behavior of prices and volume after a sequence of negative cash-ﬂow shocks are not the
“mirror image” of those for the case of positive cash-ﬂow shocks. First, our model does not
generate “negative” bubbles: while the price of the risky asset falls when bad cash-ﬂow news
arrives, it does not fall much below fundamental value. After disappointing cash-ﬂow news
push the price of the risky asset down several periods in a row, the extrapolators would, in
principle, like to short the risky asset. If they could short, they would cause the risky asset
to become undervalued. However, since they are subject to a short-sale constraint, they stay
out of the market, and there is no signiﬁcant undervaluation. Still, there is some. In bad
times, the risky asset is held only by fundamental traders. To hold the entire market supply,
these traders need the price to be lower than fundamental value, namely

                                                                γσε2
                                    Dt − γσε2 (T − t − 1)Q −         Q,
                                                                μ0

which diﬀers from the fundamental value in (4) by γσε2 Q(1 − μ0 )/μ0 . For our parameter
values, this wedge is approximately $2.17
       Our model predicts heavy trading during bubbles, but little trading during severe down-
turns. When bad cash-ﬂow news arrives, there is some trading as extrapolators sell to
fundamental traders. Once the extrapolators leave the market, however, the asset is held
only by fundamental traders, a homogeneous group. There is no more trading until the
  17
       For comparison, recall that a one-standard deviation cash-ﬂow shock moves the risky asset price by
approximately $3.



                                                    23
market recovers and extrapolators re-enter. More broadly, our model predicts much higher
trading volume during bull than bear markets, a prediction consistent with the available
evidence (Statman, Thorley, and Vorkink 2006, Griﬃn, Nardari, and Stulz 2007).18



6        Comparison with other bubble models
It is impossible to do justice here to all the important contributions in the literature on
bubbles, recently surveyed by Brunnermeier and Oehmke (2013) and Xiong (2013). Instead,
we focus on two classes of models—rational bubble models and disagreement-based models.
The former are notable for their simplicity and long tradition; the latter, like us, deal with
volume.


6.1        Rational bubble models

In models of rational bubbles, the price of a risky asset is given by

                                             Pt = PD,t + Bt ,                                      (18)

where PD,t is the present value of the asset’s future cash ﬂows and where Bt , the bubble
component, satisﬁes
                                                    E(Bt+1 )
                                             Bt =            ,                                     (19)
                                                     1+r
where r is the expected return. We note four points.
       First, the rational bubble model does not explain how a bubble gets started in the ﬁrst
place. Under limited liability, the value of B must always be non-negative. But if B is strictly
positive in any future state of the world, then, from (19), it must be positive at the current
time. Put simply, if a bubble exists, it must always have existed. In our framework, in
contrast, bubbles are initiated in a much clearer way, as a consequence of what Kindleberger
  18
       This prediction holds even if fundamental traders waver—for example, even if they have the demand
function in (7) and (8) with a base weight w0 = 0.9. Since the asset does not become very undervalued in
a downturn, the growth and value signals remain low in absolute magnitude. As a consequence, wavering
induces little trading volume.




                                                    24
(1978) calls “displacement”: a sequence of good cash-ﬂow news leads to price increases which,
in turn, cause extrapolators to raise their demand for the risky asset.
   Second, the rational bubble model has nothing to say about trading volume. In its usual
form, agents are assumed to be homogeneous; trading volume is therefore zero.
   Third, the rational bubble model does not capture the extrapolative expectations that are
often observed during bubbles. In the basic version of this framework, the return investors
expect to earn on the risky asset is constant over time.
   Finally, direct tests of the key prediction of rational bubble models—that payoﬀs in the
inﬁnite future have positive present value—reject it (Giglio, Maggiori, and Stroebel 2015).


6.2    Disagreement-based models

Building on Harrison and Kreps (1978), Scheinkman and Xiong (2003) present a model in
which two risk-neutral investors observe two signals about the fundamental value of a risky
asset, but disagree about how useful each signal is. Their disagreement leads to trading
volume. With short-sale constraints, disagreement also leads to overpricing: the price of the
risky asset can be higher than the present value of its future cash ﬂows, as perceived by the
investor holding the asset. The reason is that the holder of the asset believes that, as more
signals and cash-ﬂow news are revealed over time, the other investor will eventually become
more optimistic than he is, allowing him to sell the asset on at an attractive price.
   Both in Scheinkman and Xiong (2003) and in our model, the increase in volume during
a bubble is due to an increase in disagreement among investors. In Scheinkman and Xiong
(2003), this increase in disagreement is exogenous. In our model, disagreement grows en-
dogenously over the course of the bubble. As the bubble increases in size, the growth and
value signals in equation (10) become very large in absolute magnitude. Extrapolators who,
as a consequence of wavering, diﬀer even very slightly in the relative weight they put on the
two signals disagree sharply about the expected price change on the risky asset and therefore
trade in large quantities. Whereas in Scheinkman and Xiong (2003) an exogeneous increase
in disagreement leads to both higher volume and overpricing, in our model, the causation is
diﬀerent: overpricing leads to endogenously higher disagreement and hence higher volume.
   Our model diﬀers from disagreement models in other important ways. In our model, many

                                             25
investors hold expectations that depend positively on past returns, consistent with survey
evidence on the expectations of actual investors. In Scheinkman and Xiong (2003), however,
the holder of the asset has constant expectations about the asset’s future return. Our
framework also predicts a positive correlation between volume and past returns during bubble
episodes, a prediction that we conﬁrm empirically in the next section. Using simulations, we
ﬁnd that, in Scheinkman and Xiong (2003), this correlation is close to zero: the exogeneous
process that governs disagreement and hence volume is uncorrelated with the process for
fundamentals that is the main determinant of price movements.



7     Some evidence
We present some empirical evidence bearing on two distinctive predictions of the model. One
prediction, outlined in Section 4, is that the correlation between the trading volume in an
asset and its return over the previous year is higher during a bubble episode than at other
times. In Section 7.1, we examine this prediction for four historical bubbles. In Section
7.2, we evaluate another central prediction of our model: as a bubble develops, a growing
fraction of its investor base consists of investors with extrapolator-like characteristics.


7.1    Volume and past returns

For four bubble episodes—the U.S. stock market in 1929, technology stocks in 1998-2000,
U.S. housing in 2004-2006, and commodities in 2007-2008—we check whether, as predicted
by our model, the correlation between volume and past return for the asset in question is
higher during the bubble period than during the two-year period that follows the bubble’s
collapse.

U.S. stock market bubble of 1929

    Accounts of the stock market boom of the late 1920s suggest that the bubble began
in March 1928 (Allen 1931, Galbraith 1954, White 1990). White (1990) shows that new
industries, especially utilities, led the stock market boom. Returns in these new-industry
stocks far outpaced returns of stocks in older industries such as railroads. Panel A of Figure


                                               26
5 conﬁrms White’s account. It compares the value-weighted cumulative return of public
utilities listed in CRSP (SIC codes 4900-4990) with the cumulative return of the broader
stock market. Utilities outperformed the broader stock market by more than 80% in the
March 1928 - September 1929 period.19
       If we accept that utility stocks experienced a bubble in 1928-1929, our model predicts
that trading volume in these stocks during this time will be positively related to their past
return. Panel B of Figure 5 plots the value-weighted monthly turnover of utility stocks
over this period alongside their value-weighted 12-month past return; turnover is deﬁned as
volume divided by shares outstanding. After a spike in April 1928, the turnover of utility
stocks closely tracks their 12-month past return. For example, the second highest volume
month in the series occurs in June 1929, following a 12-month cumulative return of 86%.
From January 1927 to December 1930, the correlation between turnover and the 12-month
past return is 0.59. Over the two-year period after the bubble ends—from January 1931 to
December 1932—the correlation is -0.03.

Technology stock bubble of 1998-2000

       The explosion of volume during the technology bubble of 1998-2000 is well-known (Ofek
and Richardson 2003, Hong and Stein 2007). In Panels C and D of Figure 5, we replicate
and extend these ﬁndings. Panel C plots value-weighted monthly cumulative returns for
the sample of .com stocks used by Ofek and Richardson (2003) and compares them to the
cumulative returns of the CRSP value-weighted stock market index; returns for .com stocks
are from CRSP. Technology stocks began their climb in December 1997 with a 12% value-
weighted return. After a ﬂat month in January 1998, they climbed another 23% in February,
another 13% in March, and another 13% in April. Panel D shows that turnover increases
  19
       Wigmore (1985, p.42) describes the market for these stocks: “There is no gainsaying the enthusiasm of
the ﬁnancial markets for these public utility holding companies, however. [. . .] Their trading volume in 1929
exceeded 100% of their outstanding shares. At the high point in the market, their stocks averaged prices
57 times earnings per share, with Electric Bond and Share, which was most prominent because of its size
and its relationship with General Electric, selling at 96 times earnings per share.” Following the collapse
of the bubble, utilities were “held up by Franklin Roosevelt and others as spectacles of ﬁnancial abuse and
confusion.”



                                                      27
steadily as the bubble progresses. Turnover (measured as before, and value-weighted) peaks
in April 1999, the same point at which technology stocks reach their highest 12-month return
of 429%. Overall, the ﬁgure shows that turnover closely tracks the past 12-month return,
with a time-series correlation of 0.73 between January 1998 and December 2002. In the
24-month post-bubble period from January 2003 to December 2004, the correlation is -0.14.

U.S. housing bubble of 2004-2006

       The relationship between turnover and past returns also appears during the U.S. housing
bubble of the mid-2000s. In Panel E of Figure 5, we plot the Case-Shiller 20-City Composite
Home Price Index. This index, based on repeat transactions, seeks to measure the value of
residential real estate in the 20 largest U.S. metropolitan areas.
       The Case-Shiller Index rises from a base value of 100 in January 2000 to a peak of 206.61
in April 2006. In Panel F, we show the relationship between 12-month past returns and
volume for the U.S. housing market; we use existing-home sales by month as a measure of
volume.20 The ﬁgure shows that, as for the two stock market bubbles, volume closely tracks
the 12-month past return; the time-series correlation in monthly data from January 2003
to December 2008 is 0.96. This is higher than the correlation in the two-year post-bubble
period from January 2009 to December 2010, namely 0.2.

Commodity bubble of 2007-2008

       Whether the run-up in commodity prices in 2007 and 2008 can be easily explained by
fundamentals or was instead a bubble is subject to debate, with some authors suggesting that
the “ﬁnancialization” of derivatives markets instigated demand from institutional investors
(Irwin and Sanders 2010, Cheng and Xiong 2014, Hong, de Paula, and Singh 2015). Panel G
of Figure 5 shows the run-up in oil prices as reﬂected in the share price of USO, the largest
exchange-traded fund with exposure to oil. USO more than doubled between December
2006 and June 2008. In Panel H of Figure 5, we plot the monthly turnover and 12-month
past return of this ETF, both obtained from CRSP. As in our other examples, the turnover
of USO closely tracks the past return; the time-series correlation between April 2007 and
  20
       Existing-home sales are based on closing transactions of single-family homes, townhomes, condominiums,
and cooperative homes and are provided by the National Association of Realtors.


                                                      28
December 2009 is 0.83. During the two-year post-bubble period, the correlation is 0.15.


7.2    Composition of the investor base

In our model, as a bubble develops, extrapolators constitute a larger fraction of its investor
base. We can broaden this prediction to say that, as a bubble develops, it draws in new
extrapolators whose share demands depend positively on past returns. We here use data from
the technology bubble of the late 1990s to check: 1) that new investors are drawn in as the
bubble develops, and 2) that a signiﬁcant fraction of these new investors are extrapolators.
We focus on mutual fund investors: while mutual funds owned less than 25% of the typical
.com stock—see Griﬃn et al. (2011)—extensive data on their holdings are available for this
period. We identify .com stocks using the list of securities provided by Ofek and Richardson
(2003) and match this list to quarterly mutual fund holdings using data from Thomson
Spectrum.
   We start by analyzing how internet stocks draw in new investors as the bubble progresses
in 1998 and 1999. In each quarter t, we record the number of mutual fund owners initiating
a position in a stock i, in the sense that they held the stock in quarter t but not in quarter
t − 1, and express this as a ratio to the total number of mutual fund owners of stock i in that
quarter. We compute the equal-weighted average of this ratio across all technology stocks
for each t. One potential confounding factor in this calculation is the many IPOs during
this period. To avoid picking up “new” ownership for recently-listed stocks, we include a
stock i in our analysis only after it appears in the Thomson Spectrum dataset for at least
two consecutive quarters with at least ﬁve institutional owners in each of these quarters.
   Panel A of Figure 6 shows how the bubble draws in new investors. The ﬁgure plots the
new-owner-share in each quarter of the bubble. For comparison, it also plots the equal-
weighted new-owner-share across non-technology sector stocks. The ﬁgure shows that tech-
nology stocks draw in new holders at a greater rate than non-technology stocks. Near the
peak of the bubble, in December 1999, over 40% of owners of the typical .com stock had not
held any shares in the stock in the previous quarter. For example, in December 1997, 48
mutual funds reported positions in Yahoo! stock. One year later, 171 mutual funds reported
positions, while one year after that, 759 mutual funds reported positions.

                                              29
    Are the new owners of bubble stocks extrapolators, as our model predicts? To test this,
we examine the other securities held by .com owners and check if these owners behave like
extrapolators elsewhere in their portfolios. We sort all stocks—not only .com stocks—into
NYSE deciles according to their past 12-month return. We then measure the “growthiness”
of a mutual fund’s portfolio as the position-weighted past-return decile of the stocks in that
portfolio. A portfolio with a score of 1, for example, contains only stocks that have performed
poorly over the past 12 months, while a portfolio with a score of 10 contains only high past
return stocks. Panel B of Figure 6 shows the increasing growthiness of new owners as the
bubble progresses.
    Overall, the evidence is consistent with the prediction of our model that, as the bubble
develops, extrapolators constitute a larger fraction of its investor base.



8     Conclusion
Although historical accounts of price bubbles typically emphasize extrapolative expectations
(Kindleberger 1978, Shiller 2000), recent models of bubbles have moved away from this
feature. In this paper, we embrace it. In our model, some investors hold extrapolative
expectations, but also waver in their convictions in that they worry more or less about
the possible overvaluation of the asset. The model generates occasional bubbles in asset
prices. Such bubbles occur in response to particular patterns of good news, a phenomenon
Kindleberger (1978) called displacement. They are characterized by very high trading volume
documented in earlier literature, which to a signiﬁcant extent comes from the trading between
the wavering extrapolators. The model generates a new prediction that trading volume is
driven by high past returns which distinguishes it from some popular recent models and
appears to be consistent with some historical evidence.
    Our analysis has left several important issues to future work. First, we have not addressed
the controversy of whether bubbles actually exist, and whether investors can tell in the
middle of a rapid price increase of an asset that it is actually overpriced. Second, even in the
context of our model, we have assumed a very simple and stabilizing form of arbitrage. This
speciﬁcation does not consider the possibility of destabilizing arbitrage, whereby rational


                                              30
investors buy an overpriced asset in the hope of selling at an even higher price to extrapolators
(De Long et al. 1990, Brunnermeier and Nagel 2004). But we also have not considered other
stabilizing forces, such as arbitrage by security issuers themselves through greater issuance or
asset creation (Galbraith 1954). Perhaps most important, we have adopted a standard but
ad-hoc formulation of extrapolative beliefs by some investors. The fundamental psychological
mechanisms of extrapolation remain to be understood.




                                               31
9     Appendix
A micro-foundation for fundamental trader demand in equation (3).
    Consider an economy with the timing and asset structure described at the start of Sec-
tion 2. There are two types of trader: one type, which makes up a fraction μX of the
population, has time t per-capita demand for shares of the risky asset given by NtX ; the
other type, which makes up a fraction μF of the population with μF = 1 − μX , is a fun-
damental trader who, at time t, chooses his per-capita share demand NtF by maximizing a
utility function with constant absolute risk aversion γ and deﬁned over next period’s wealth.
In other words, his objective is
                                                                          
                                                −γ(Wt +NtF (Pet+1 −Pt ))
                               max EFt       −e                                .            (A1)
                               NtF

This trader is boundedly rational, in a way that we make precise in what follows.
    To determine his time t demand for the risky asset, the fundamental trader reasons as
follows. At the ﬁnal date, date T , the price of the risky asset PT must equal the cash ﬂow
realized on that date, so that PT = DT . At time T − 1, the fundamental trader’s ﬁrst-order
condition implies that his share demand is
                                    EFT −1 (PT ) − PT −1   DT −1 − PT −1
                       NTF−1 =                            =               ,                 (A2)
                                   γVar (PT − PT −1 )
                                        F
                                        T −1
                                                                γσε2

where we have used the fact that EFT −1 (PT ) = DT −1 and have also assumed, for simplicity,
that the fundamental trader sets the conditional variance of price changes equal to the
variance of cash-ﬂow shocks. Market clearing implies
                                              
                             F   DT −1 − PT −1
                           μ                     + μX NTX−1 = Q,                            (A3)
                                     γσε2
which, in turn, implies
                                                   γσε2
                             PT −1 = DT −1 −            (Q − μX NTX−1 ).                    (A4)
                                                   μF
    At time T − 2, the fundamental trader’s demand is
                                             EFT −2 (PT −1 ) − PT −2
                                   NTF−2   =                          .                     (A5)
                                                        γσε2
It is here that his bounded rationality comes into play. To compute EFT −2 (PT −1 ), in other
words, to compute the expectation of the quantity in (A4), he needs an estimate of EFT −2 (NTX−1 ).

                                                    32
We assume that the fundamental trader does not try to forecast the evolution of the other
traders’ demand N X , but instead sets EFT −2 (NTX−1 ) = Q; in other words, he assumes that the
other traders will simply hold an amount of the risky asset that corresponds to their weight
in the population. Under this assumption, EFT −2 (PT −1 ) = DT −2 − γσε2 Q, so that

                                           DT −2 − γσε2 Q − PT −2
                                 NTF−2 =                          .                       (A6)
                                                    γσε2

We assume that the fundamental trader continues to reason in this way, working back from
date T to the current time t, and, at each time, forecasting that the future per-capita demand
from the other traders will simply equal Q. Under these assumptions,

                                       Dt − γσε2 (T − t − 1)Q − Pt
                               NtF =                               ,                      (A7)
                                                   γσε2

which is equation (3).

A micro-foundation for extrapolator demand in equation (5).
     Consider an economy with the timing and asset structure described at the start of Sec-
tion 2. Now consider a trader who, at time t, maximizes a utility function with constant
absolute risk aversion γ and deﬁned over next period’s wealth. In other words, his objective
is
                                                                        
                                              −γ(Wt +NtX (Pet+1 −Pt ))
                                max EX
                                     t     −e                                .            (A8)
                                 X
                                Nt

From the ﬁrst-order condition, optimal demand is

                                              EX   
                                               t (Pt+1 ) − Pt
                                    NtX =                        .                        (A9)
                                             γVart (Pt+1 − Pt )
Suppose that this investor forms beliefs about future price changes by extrapolating past
price changes, so that
                                                 
                                                 ∞
                   EX        − Pt ) = (1 − θ)           θk−1 (Pt−k − Pt−k−1 ) ≡ Xt ,
                    t (Pt+1                                                             (A10)
                                                 k=1

which, for an economy that starts at time 0, can be written as

                                             
                                             t−1
                 EX                                θk−1 (Pt−k − Pt−k−1 ) + θt−1 X1 .
                  t (Pt+1 − Pt ) = (1 − θ)                                              (A11)
                                              k=1




                                                    33
Suppose also, for simplicity, that he sets the conditional variance of price changes equal to
the variance of cash-ﬂow shocks, namely σε2 . His demand then becomes
                                  t−1                                
                             1    
                      NtX =    2
                                       θk−1 (Pt−k − Pt−k−1 ) + θt−1 X1 ,                    (A12)
                            γσε k=1

as in (5).

Proof of Proposition 1. From expressions (9) and (10), we see that aggregate demand
                             
for the risky asset, μ0 NtF + Ii=1 μi NtE,i , can take an arbitrarily high value if the price Pt is
suﬃciently low, and a value as low as zero if the price is suﬃciently high. Moreover, it is a
continuous function of Pt and is strictly decreasing in Pt until it falls to zero. Taken together,
these observations imply that there is a unique price Pt at which aggregate demand at time
t equals the supply Q.
   We ﬁnd the market-clearing price in the following way. As noted in the statement of
the proposition, we deﬁne P i to be the price at which trader i’s short-sale constraint binds,
namely

                P 0 = Dt − γσε2 (T − t − 1)Q
                                                        1 − wi,t
                 P i = Dt − γσε2 (T − t − 1)Q +                  Xt , i ∈ {1, . . . , I}.   (A13)
                                                          wi,t
We now order these I + 1 “cut-oﬀ” prices, so that

                                   P i(0) ≥ P i(1) ≥ . . . ≥ P i(I) ,

where i(l) indexes the trader i ∈ {0, 1, . . . , I} with the (l + 1)’th highest cut-oﬀ price. If
NP i(l) is aggregate demand at price P i(l) , we have

                               0 = NP i(0) ≤ NP i(1) ≤ . . . ≤ NP i(I) .

Finally, let I(l) be the set of traders i who have strictly positive demand at price P i(l) . Note
that I(0) is an empty set and that I(l) is a subset of I(l + 1).
   We consider two cases. Suppose that NP i(I) < Q. This indicates that the market-clearing
price is below P i(I) , and that, in equilibrium, all traders in the economy will have strictly
positive demand. Aggregate demand at the market-clearing price Pt will therefore equal
               I                                                        
                             Dt − γσε2 (T − t − 1)Q − Pt                Xt
                   μi wi,t                                 + (1 − wi,t ) 2 ,
               i=0
                                         γσε2                           γσε

                                                  34
where w0,t ≡ 1, indicating that fundamental traders put a weight of 1 on the value signal.
Setting this aggregate demand equal to supply Q leads to the equilibrium price in (11).
    We now turn to the other case. Suppose that NP i(l) ≤ Q ≤ NP i(l+1) . We then know that
the market-clearing price is somewhere between P i(l+1) and P i(l) , and that, in equilibrium,
only the traders in the set I(l + 1), denoted I ∗ in the statement of the proposition, have
strictly positive demand for the risky asset. Aggregate demand at the market-clearing price
Pt therefore equals
                                                                                               
                                                Dt − γσε2 (T − t − 1)Q − Pt                    Xt
                                μi wi,t                                           + (1 − wi,t ) 2 .
                                                            γσε2                               γσε
                     i∈I(l+1)


Setting this equal to the risky asset supply Q, we obtain the equilibrium price in (12).                    

Proposition 2. Suppose that there is a continuum of extrapolators and that each extrap-
olator draws an independent weight wi,t at time t from a bounded and continuous density
g(w), w ∈ [wl , wh ], with mean w and with 0 < wl < wh < 1. Suppose that the economy has
been in its steady state up to time l − 1 and that there is then a sequence of positive shocks
εl , εl+1 ,. . ., εn that move the economy from the ﬁrst stage of the bubble to the second stage
at some intermediate date j with l < j < n. Also suppose that the economy remains in its
second stage through at least date N > n.
No price spiral. If all the extrapolators are in the market at all dates—we specify the
condition for this below—the overpricing generated at time t by the cash-ﬂow shocks εl ,
εl+1 ,. . ., εn is
                                                ⎧
                                                ⎨      t−1
                                                      m=l L1 (t − m)εm                  l≤t<j
                     Ot ≡ Pt −        PtF   =                                                     ,    (A14)
                                                ⎩ t−1 L (t − m)ε + O1                  j≤t≤N
                                                   m=j 2          m    t


where Ot1 is the contribution to the time t overpricing generated by the shocks {εi}j−1
                                                                                    i=l that

occurred during the ﬁrst stage of the bubble and is given by
       ⎧                                                μ0
       ⎪             −1
       ⎨ (α2 + θα2 α1 )Oj−1 − α2 Oj−2 + α2 εj−1 −                γσε2 Q                          t=j
                                                    w(1 −  μ 0 )
 Ot1 =                                      μ0 (1 − θ) 2                                               , (A15)
       ⎪
       ⎩                    1         1
                  (α2 + θ)Ot−1 − α2 Ot−2 −            γσ Q                                    j<t≤N
                                            w(1 − μ0 ) ε

where α1 ≡ (1 −θ)(1 −μ0 )(1 −w)/[μ0 + (1 −μ0 )w] and α2 ≡ (1 −θ)(1 −w)/w. The quantities


                                                              35
                                                        √                       √
{Li (j)}j≥0 are determined as follows. If αi < 2 − θ − 2 1 − θ or αi > 2 − θ + 2 1 − θ, then

        Li (j) = 2−j αi [(αi + θ)2 − 4αi ]−0.5 ×
                                               j                  j 
                                                     
                    αi + θ + (αi + θ) − 4αi − αi + θ − (αi + θ) − 4αi
                                          2                    2           . (A16)
            √                      √
If 2 − θ − 2 1 − θ < αi < 2 − θ + 2 1 − θ, then
                                                            −0.5
                          Li (j) = 2αi0.5j+1 4αi − (αi + θ)2       sin(jβ),                             (A17)
                                                       √                       √
where β = cos−1 (0.5(αi + θ)αi−0.5 ). If αi = 2 − θ + 2 1 − θ or αi = 2 − θ − 2 1 − θ, then

                                                              0.5(j+1)
                                               Li (j) = jαi              .                              (A18)

Price spiral. If, at some date j  , j ≤ j  ≤ N, the overpricing Oj  computed using (A14) is
greater than Ō ≡ [(1 − wh ) + (1 − μ0 )(wh − w̄)]γσε2 Q/[(1 − μ0 )(wh − w̄)], then a price spiral
begins at j  . During the spiral, the time t overvaluation is
                       1 − w̄(Xt )                      γσε2 Q
                Ot =               Xt + γσε2 Q −                        ,                     t ≥ j,   (A19)
                         w̄(Xt )                 (1 − μ0 )η(Xt )w̄(Xt )
where                                          
                             w∗                     w∗                                   w∗
              w̄(Xt ) =            wg(w)dw               g(w)dw ,            η(Xt ) =         g(w)dw,   (A20)
                          wl                       wl                                   wl

w ∗ (Xt ) is determined by
                                                               w∗
                              ∗
                          w       γσε2 Q   = Xt (1 − μ0 )           (w ∗ − w)g(w)dw,                    (A21)
                                                              wl

and the growth signal Xt evolves as
     ⎧
     ⎪                                  2     2
     ⎨ θ[μ0 + (1 − μ0 )w̄](Ot−1 − γσε Q) + θγσε Q
     ⎪
                                                  + (1 − θ)(Ot−1 − Ot−2 + εt−1 + γσε2 Q)                        t = j
Xt =
     ⎪               (1 −  μ 0 )(1 − w̄)                                                                                 .
     ⎪
     ⎩                    θX + (1 − θ)(O − O + ε + γσ 2 Q)
                                     t−1                 t−1         t−2       t−1       ε                      j > j
                                                                                                        (A22)
At each time t, extrapolators with wi,t < w ∗ (Xt ) stay in the market, while those with wi,t ≥
w ∗ (Xt ) stay out of the market. If the price spiral ends before time N, equations (A19), (A20),
and (A22) still apply but with w ∗ set to wh .                                                            

   Before we prove the proposition, we explain it in more detail. Equation (A14) gives the
magnitude of overvaluation in the absence of a price spiral. To understand it, suppose that,

                                                         36
up until time l − 1, the economy has been in its steady state, and that, at time l, there is
a unit cash-ﬂow shock εl = 1, after which the cash-ﬂow shocks revert to zero forever. The
quantities L1 (1), L1 (2), L1 (3),. . . are equal to the overvaluation of the risky asset 1, 2, 3,. . .
periods after the shock, in other words, at dates l + 1, l + 2, l + 3,. . ., conditional on the
bubble staying in the ﬁrst stage, so that fundamental traders and all extrapolators are in
the market. The ﬁrst row of equation (A14) shows that our model has a linear structure, in
the sense that, during the ﬁrst stage of the bubble, the total overvaluation at time t caused
by a sequence of shocks εl , εl+1, . . . , εt−1 is given by

                            L1 (1)εt−1 + L1 (2)εt−2 + . . . + L1 (t − l)εl .

   Now suppose that the bubble is in the second stage, but with no price spiral, so that
the fundamental traders are not in the market but all extrapolators are. Suppose that there
is a unit cash-ﬂow shock at time j, εj = 1, after which the shocks equal zero forever. The
quantities L2 (1), L2 (2), L2 (3),. . . measure how much additional overvaluation this shock
creates 1, 2, 3,. . . periods later, in other words, at dates j + 1, j + 2, j + 3,. . ., relative to the
case in which εj = 0, and conditional on all extrapolators staying in the market. The second
row of equation (A14) shows that, in this second stage of the bubble, the total overvaluation
at time t caused by a sequence of shocks εl , εl+1 , . . . , εn has two components. The ﬁrst is
the overvaluation created by the cash-ﬂow shocks that arise during the second stage of the
bubble. This is again linear in structure and equals

                            L2 (1)εt−1 + L2 (2)εt−2 + . . . + L2 (t − j)εj .

The second component of the overvaluation, Ot1 , is typically much smaller in magnitude.
It is the overvaluation at time t caused by the lingering eﬀect of the cash-ﬂow shocks that
occurred during the first stage of the bubble.
   Equations (A16), (A17), and (A18) provide explicit expressions for L1 (·) and L2 (·). They
show that Li (·) can take one of four shapes. The two most common shapes are a curve that
rises and then falls monotonically and a curve that oscillates with decreasing amplitude.
The other possibilities are a curve that oscillates with increasing amplitude and a curve that
increases monotonically.

                                                  37
Proof of Proposition 2. Given the assumptions about extrapolators in the statement of
Proposition 2 and the results from Proposition 1, the equilibrium price of the risky asset is
                     
                     ∞
                                                                                     γσε2 Q
      Pt = Dt + α1          θk−1 (Pt−k − Pt−k−1 ) − (T − t − 1)γσε2 Q −                              (A23)
                     k=1
                                                                                 μ0 + (1 − μ0 )w
                                                           (1−θ)(1−μ0 )(1−w)
in the ﬁrst stage of the bubble, where α1 ≡                   μ0 +(1−μ0 )w
                                                                             .   In the second stage of the
bubble, so long as all the extrapolators are in the market, the equilibrium price is
                           
                           ∞
                                                                                     γσε2 Q
        Pt = Dt + α2             θk−1 (Pt−k − Pt−k−1 ) − (T − t − 1)γσε2 Q −                  ,      (A24)
                           k=1
                                                                                   (1 − μ0 )w
              (1−θ)(1−w)
where α2 ≡        w
                           > α1 .
   From (4), (A23), and (A24), the level of overpricing Ot , deﬁned as the diﬀerence between
the price of the risky asset and its fundamental value, is
       ⎧
       ⎪
       ⎪           1−w           γσε2 Q                                              γσε2 Q
       ⎨                 Xt −              + γσε2 Q                        Xt >
                     w         (1 − μ0 )w                                       (1 − μ0 )(1 − w)
  Ot =                                                                                           . (A25)
       ⎪
       ⎪   (1 − μ0 )(1 − w)            γσε2 Q                                        γσε2 Q
       ⎩                    Xt −                   + γσε2 Q                Xt ≤
           μ0 + (1 − μ0 )w        μ0 + (1 − μ0 )w                               (1 − μ0 )(1 − w)
Note that Ot is continuous at the switching point between the ﬁrst and second stages of
the bubble; at this point, Ot = γσε2 Q. Also note that, when the value of Xt equals its
steady-state level of γσε2 Q, the overpricing is zero; in this case, the per-capita demand of
both extrapolators and fundamental traders for the risky asset equals the supply Q.
   From (A23) and (A24) it is apparent that, if the economy stays within stage one or within
stage two and if all the extrapolators are in the market, the model has a linear structure: in
stage i, a fundamental shock of εt1 at t1 and a fundamental shock of εt2 at t2 generate, at a
later time t, a total overvaluation of Li (t − t1 )εt1 + Li (t − t2 )εt2 . It is also straightforward to
check that L1 (·) and L2 (·) can be deﬁned recursively as

 Li (0) = 0, Li (1) = αi , Li (l) = (αi + θ)Li (l − 1) − αi Li (l − 2), l ≥ 2 for i = 1, 2. (A26)

This is a standard diﬀerence equation with the general solution

                                        Li (j) = A1 (K1 )j + A2 (K2 )j ,                             (A27)

where K1 and K2 are the roots of the quadratic equation

                                         K 2 − (αi + θ)K + αi = 0                                    (A28)

                                                      38
and where A1 and A2 can be obtained from the boundary conditions Li(0) = 0 and Li (1) =
αi . When (αi + θ)2 > 4αi , (A28) has two real roots; matching (A27) with the boundary
conditions gives (A16). When (αi + θ)2 < 4αi , (A28) has two complex roots with non-zero
imaginary components; matching (A27) with the boundary conditions gives (A17). When
(αi + θ)2 = 4αi , applying L’Hôpital’s rule to either (A16) or (A17) gives (A18).
    The linear structure implies that, at time t with l ≤ t < j, the overpricing caused by
     t−1
           t−1
{εi }i=l is m=l  L1 (t − m)εm ; and that, at time t with j ≤ t ≤ N, the additional overpricing
               t−1     t−1
caused by {εi }i=j is m=j   L2 (t − m)εm .
   We now derive Ot1 at time t ≥ j. For t = j,

                             Xj = (1 − θ)(Pj−1 − Pj−2 ) + θXj−1.                        (A29)

From (A14) we know

                          Pj−1 − Pj−2 = Oj−1 − Oj−2 + εj−1 + γσε2 Q                     (A30)

and                                                                         
                         μ0 + (1 − μ0 )w                  γσε2 Q          2
                Xj−1   =                     Oj−1 +                   − γσε Q .         (A31)
                         (1 − μ0 )(1 − w)             μ0 + (1 − μ0 )w
Substituting (A30) and (A31) into (A29), and then substituting (A29) back into (A25) gives
Oj1 in (A15). For j < t ≤ N, similar steps lead to Ot1 in (A15).
   Substituting the price equation (A24) into the extrapolator share demand in (10) shows
that, whenever Xt > wh γσε2 Q/[(1 − μ0 )(wh − w̄)], the extrapolator with wi,t = wh exits
the market and hence a price spiral occurs. (A25) shows that this condition is equivalent
to Ot > Ō. Applying (A25) at time j  − 1 gives Xj  −1 as a function of Oj  −1 , and further
applying (A29) and (A30) gives (A22).
   Assume that, at time t, extrapolators with wi,t ∈ [wl , w ∗ ) are in the market. Integrating
the share demands of these extrapolators in (10) and equating the result to the aggregate
per-extrapolator supply of Q/(1 − μ0 ) gives (A19) and (A20). Setting the share demand of
the extrapolator with wi,t = w ∗ to zero then gives (A21). Given that Xt > wh γσε2 Q/[(1 −
μ0 )(wh − w̄)], the left-hand side of (A21) is smaller than the right-hand side when w ∗ = wh ;
however the left-hand side of (A21) is greater than the right-hand side when w ∗ = wl . As a
result, there must exist a w ∗ that solves (A21).                                            

                                               39
Proof of Proposition 3. Substituting the equilibrium asset price in (A23) and (A24) into
extrapolator i’s share demand in (10) gives
       ⎧                                                        
       ⎪
       ⎪                            w − wi,t         wi,t Q                                    γσε2 Q
       ⎪
       ⎨                    max              Xt +             ,0                     Xt >
  E,i                                 wγσε2       (1 − μ0 )w                              (1 − μ0 )(1 − w)
Nt =                                                                                                     .
       ⎪
       ⎪          μ 0 (1 − wi,t ) + (1 − μ0 )(w − wi,t )           w i,t Q                     γσε2 Q
       ⎪
       ⎩ max                                             Xt +                 ,0     Xt ≤
                          (μ0 + (1 − μ0 )w)γσε2               μ0 + (1 − μ0 )w             (1 − μ0 )(1 − w)
                                                                                           (A32)
From (A32) we know that, when −wl γσε2 Q/[μ0 (1−wl )+(1−μ0 )(w−wl )] ≤ Xt < γσε2 Q/[(1−
μ0 )(1 − w)], both fundamental traders and extrapolators stay in the market. The component
of the change in extrapolator i’s share demand between time t and t + 1 that is due to
wavering is
                                  (wi,t+1 − wi,t )(γσε2 Q − Xt+1 )
                                                                   .                        (A33)
                                       (μ0 + (1 − μ0 )w)γσε2
Taking the absolute value of this quantity—conditional, for simplicity, on Xt+1 = Xt —and
integrating over wi,t+1 and wi,t shows that wavering-induced trading volume is equal to

                                         |Xt − γσε2 Q|Δ0
                                                             ,                              (A34)
                                       (μ0 + (1 − μ0 )w)γσε2

where Δ0 is deﬁned in (17). When γσε2 Q/[(1−μ0 )(1−w)] ≤ Xt ≤ wh γσε2 Q/[(wh −w)(1−μ0 )],
the component of the change in extrapolator i’s share demand between t and t + 1 that is
due to wavering is
                              (wi,t+1 − wi,t )(γσε2 Q − (1 − μ0 )Xt+1 )
                                                                        .                   (A35)
                                          (1 − μ0 )wγσε2
A similar calculation to the one used to obtain (A34) shows that, in this case, wavering-
induced trading volume is given by

                                     ((1 − μ0 )Xt − γσε2 Q)Δ0
                                                              .                             (A36)
                                          (1 − μ0 )wγσε2

   When Xt > wh γσε2 Q/[(wh − w)(1 − μ0 )], extrapolators with a suﬃciently high level of
w stay out of the market but may re-enter in the next period. For those extrapolators who
stay in for both periods, replace w, 1 − μ0 , and Δ0 in (A36) by w(Xt ), (1 − μ0 )η(Xt ), and




                                                  40
Δ(Xt ), respectively, where
                                              wη (Xt )
                                −1
                   w(Xt ) ≡ η (Xt )                      g(w)wdw
                                             wl
                                 wη (Xt )
                   η(Xt ) ≡                 g(w)dw
                                wl
                                 wη (Xt )                   wη (Xt )
                   Δ(Xt ) ≡                 g(w1)dw1                   |w1 − w2 |g(w2)dw2 ,
                                wl                         wl

and where wη (Xt ) is the implicit solution to
                  wη                                                       wη              
                                               2
     (1 − μ0 )wη        g(w)dw Xt − wη γσε Q = (1 − μ0 )                           g(w)wdw Xt .   (A37)
                     wl                                                      wl

For those extrapolators who are in at time t but out at time t + 1, their change in share
demand is
                          Xt     wi,t ((1 − μ0 )η(Xt )Xt − γσε2 Q)
                               −                                   ≥0                             (A38)
                          γσε2       (1 − μ0 )η(Xt )γσε2 w(Xt )
for wi,t ≤ wη (Xt ). Integrating (A38) over wi,t from wl to wη (Xt ) and then further integrating
it over wi,t+1 from wη (Xt ) to wh gives ((1−η(Xt ))Q)/(1−μ0). The trading volume generated
by extrapolators who are out at time t but in at time t + 1 can be computed in a similar
way; it also equals ((1 − η(Xt ))Q)/(1 − μ0 ). Overall, wavering-induced trading volume in
this case equals

                    (η(Xt )Xt − γσε2 Q(1 − μ0 )−1 )Δ(Xt ) 2(1 − η(Xt ))Q
                                                         +               .                        (A39)
                              η(Xt )w(Xt )γσε2                1 − μ0

   Taking the derivative of expressions (A34), (A36), and (A39) gives the results in Propo-
sition 3.                                                                                            




                                                     41
10      References

Allen, F. (1931), Only Yesterday: An Informal History of the 1920’s. Harper and Brothers,
New York.

Bagehot, W. (1873), Lombard Street: A Description of the Money Market. Wiley, New York.

Barberis, N., R. Greenwood, L. Jin, and A. Shleifer (2015), “X-CAPM: An Extrapolative
Capital Asset Pricing Model,” Journal of Financial Economics 115, 1–24.

Barberis, N., and A. Shleifer (2003), “Style Investing,” Journal of Financial Economics 68,
161–199.

Blanchard, O., and M. Watson (1982), “Bubbles, Rational Expectations, and Financial
Markets,” NBER Working Paper 945.

Brunnermeier, M., and S. Nagel (2004), “Hedge Funds and the Technology Bubble,” Journal
of Finance 59, 2013–2040.

Brunnermeier, M., and M. Oehmke (2013), “Bubbles, Financial Crises, and Systemic Risk,”
in George Constantinides, Milton Harris, and Rene Stulz, eds., Handbook of the Economics
of Finance, Volume 2, North Holland.

Carlos, A., L. Neal, and K. Wandschneider (2006), “Dissecting the Anatomy of Exchange
Alley: The Dealings of Stockjobbers during and after the South Sea Bubble,” Working paper,
University of Illinois.

Case, K., R. Shiller, and A. Thompson (2012), “What Have They Been Thinking? Home-
buyer Behavior in Hot and Cold Markets,” Brookings Papers on Economic Activity.

Cheng, I.-H., and W. Xiong (2014), “The Financialization of Commodity Markets,” Annual
Review of Financial Economics 6, 419-441.

Cutler, D., J. Poterba, and L. Summers (1990), “Speculative Dynamics and the Role of
Feedback Traders,” American Economic Review Papers and Proceedings 80, 63–68.

De Long, B., A. Shleifer, L. Summers, and R. Waldmann (1990), “Positive Feedback Invest-
ment Strategies and Destabilizing Rational Speculation,” Journal of Finance 45, 379–395.

Fama, E. (2014), “Two Pillars of Asset Pricing,” American Economic Review 104, 1467–
1485.

                                            42
Fehr, E., and A. Rangel (2011), “Neuroeconomic Foundations of Economic Choice—Recent
Advances,” Journal of Economic Perspectives 25, 3-30.

Galbraith, J. (1954), The Great Crash: 1929. Houghton Miﬄin Co., Boston, MA.

Giglio, S., M. Maggiori, and J. Stroebel (2015), “No-Bubble Condition: Model-Free Tests in
Housing Markets,” Econometrica, forthcoming.

Glaeser, E., and C. Nathanson (2015), “An Extrapolative Model of House Price Dynamics,”
NBER Working Paper 21037.

Greenwood, R., and A. Shleifer (2014), “Expectations of Returns and Expected Returns,”
Review of Financial Studies 27, 714–746.

Griﬃn, J., J. Harris, T. Shu, and S. Topaloglu (2011), “Who Drove and Burst the Tech
Bubble?,” Journal of Finance 66, 1251–1290.

Griﬃn, J., F. Nardari, and R. Stulz (2007), “Do Investors Trade More when Stocks Have
Performed Well? Evidence from 46 Countries,” Review of Financial Studies 20, 905–951.

Harrison, M., and D. Kreps (1978), “Speculative Investor Behavior in a Stock Market with
Heterogeneous Expectations,” Quarterly Journal of Economics 89, 323–336.

Haruvy, E., Y. Lahav, and C. Noussair (2007), “Traders’ Expectations in Asset Markets:
Experimental Evidence,” American Economic Review 97, 1901–1920.

Hong, H., A. de Paula, and V. Singh (2015), “Hoard Behavior and Commodity Bubbles,”
NBER Working Paper 20974.

Hong, H., and D. Sraer (2013), “Quiet Bubbles,” Journal of Financial Economics 110, 596–
606.

Hong, H., and J. Stein (1999), “A Uniﬁed Theory of Underreaction, Momentum Trading,
and Overreaction in Asset Markets,” Journal of Finance 54, 2143–2184.

Hong, H., and J. Stein (2007), “Disagreement and the Stock Market,” Journal of Economic
Perspectives 21, 109–128.

Irwin, S., and D. Sanders (2010), “The Impact of Index and Swap Funds on Commodity
Futures Markets: Preliminary Results,” OECD Food, Agriculture, and Fisheries Working
Paper.


                                           43
Jin, L. (2015), “A Speculative Asset Pricing Model of Financial Instability,” Working paper,
California Institute of Technology.

Kindleberger, C. (1978), Manias, Panics, and Crashes: A History of Financial Crises. Basic
Books.

Mackay, C. (1841), Extraordinary Popular Delusions and the Madness of Crowds. Harmony
Books, New York.

Ofek, E., and M. Richardson (2003), “DotCom Mania: The Rise and Fall of Internet Stock
Prices,” Journal of Finance 58, 1113–1138.

Pastor, L., and P. Veronesi (2006), “Was there a Nasdaq Bubble in the 1990s?” Journal of
Financial Economics 81, 61–100.

Scheinkman, J., and W. Xiong (2003), “Overconﬁdence and Speculative Bubbles,” Journal
of Political Economy 111, 1183–1219.

Shiller, R. (2000), Irrational Exuberance. Princeton University Press, New Jersey.

Simsek, A. (2013), “Belief Disagreements and Collateral Constraints,” Econometrica 81,
1-53.

Smith, V., G. Suchanek, and A. Williams (1988), “Bubbles, Crashes, and Endogeneous
Expectations in Experimental Spot Asset Markets,” Econometrica 56, 1119–1151.

Statman, M., S. Thorley, and K. Vorkink (2006), “Investor Overconﬁdence and Trading
Volume,” Review of Financial Studies 19, 1531–1565.

Tirole, J. (1985), “Asset Bubbles and Overlapping Generations,” Econometrica 53, 1071–
1100.

Towal, R.B., M. Mormann, and C. Koch (2013), “Simultaneous Modeling of Visual Saliency
and Value Computation Improves Predictions of Economic Choice,” Proceedings of the Na-
tional Academy of Sciences 110, E3858-3867.

White, E. (1990), “The Stock Market Boom and Crash of 1929 Revisited,” Journal of Eco-
nomic Perspectives 4, 67–83.

Wigmore, B. (1985), The Crash and Its Aftermath: A History of Securities Markets in the
United States, 1923-1933. Greenwood Press, Westport, CT.


                                             44
Xiong, W. (2013), “Bubbles, Crises, and Heterogeneous Beliefs,” in Jean-Pierre Fouque and
Joe Langsam, eds., Handbook for Systemic Risk, Cambridge University Press.

Xiong, W., and J. Yu (2011), “The Chinese Warrants Bubble,” American Economic Review
101, 2723–2753.




                                           45
        120


        110


        100


        90
price




        80


        70


        60


        50
              5      10       15      20      25      30      35      40       45      50
                                       time (quarters)

 Figure 1: Prices in a bubble. The solid line plots the price of the risky asset for the
 following sequence of 50 cash-ﬂow shocks: 10 shocks of zero, followed by shocks of 2, 4, 6, 6,
 followed by 36 shocks of zero. 30% of the investors are fundamental traders; the remainder
 are extrapolators with an extrapolation parameter θ of 0.9 and who also put a base weight
 wi = 0.1 on a value signal. The dashed line plots the fundamental value of the asset for
 the same cash-ﬂow sequence. The other parameters are D0 = 100, σε = 3, Q = 1, γ = 0.1,
 σu = 0.03, and I = 50.




                                              46
        220

        200

        180

        160

        140
price




        120

        100

        80

        60

        40
              5      10      15      20      25      30      35      40      45      50
                                      time (quarters)

 Figure 2: Price spiral. The solid line plots the price of the risky asset for the following
 sequence of 50 cash-ﬂow shocks: 10 shocks of zero, followed by shocks of 2, 4, 6, 6, 12, 10,
 followed by 34 shocks of zero. 30% of the investors are fundamental traders; the remainder
 are extrapolators with an extrapolation parameter θ of 0.9 and who also put a base weight
 wi = 0.1 on a value signal. The dashed line plots the fundamental value of the asset for
 the same cash-ﬂow sequence. The dash-dot line plots the price in an economy where the
 extrapolators are homogeneous, placing the same invariant weight of wi = 0.1 on the value
 signal. The other parameters are D0 = 100, σε = 3, Q = 1, γ = 0.1, σu = 0.03, and I = 50.




                                             47
                 5

                4.5

                 4

                3.5
share demands




                 3

                2.5

                 2

                1.5

                 1

                0.5

                 0
                      5   10   15   20      25     30       35      40      45      50
                                      time (quarters)


Figure 3: Share demands in a bubble. The solid lines plot the risky asset share
demands of extrapolators for the following sequence of 50 cash-ﬂow shocks: 10 shocks of
zero, followed by shocks of 2, 4, 6, 6, followed by 36 shocks of zero. The dashed line plots
the share demand of the fundamental traders for the same cash-ﬂow sequence. 30% of the
investors are fundamental traders; the remainder are extrapolators with an extrapolation
parameter θ of 0.9 and who also put a base weight wi = 0.1 on a value signal. The other
parameters are D0 = 100, σε = 3, Q = 1, γ = 0.1, σu = 0.03, and I = 50.




                                            48
         0.8


         0.7


         0.6


         0.5
volume




         0.4


         0.3


         0.2


         0.1


          0
               5    10       15      20      25     30       35       40      45      50
                                       time (quarters)


Figure 4: Volume in a bubble. The solid line plots the total trading volume in the risky
asset for the following sequence of 50 cash-ﬂow shocks: 10 shocks of zero, followed by shocks
of 2, 4, 6, 6, followed by 36 shocks of zero. The dashed line plots the trading volume between
the extrapolators for the same cash-ﬂow sequence. 30% of the investors are fundamental
traders; the remainder are extrapolators with an extrapolation parameter θ of 0.9 and who
also put a base weight w i = 0.1 on a value signal. The other parameters are D0 = 100,
σε = 3, Q = 1, γ = 0.1, σu = 0.03, and I = 50.




                                             49
         Panel A: Bubble of 1929, stock prices of utilities                 Panel B: Bubble of 1929, 12-month returns and turnover of utilities
                                                                                        2.00


                                                                                        1.50




                                                                  return or turnover
                                                                                        1.00


                                                                                        0.50


                                                                                        0.00




                                                                                               Dec-26


                                                                                                                 Jun-27


                                                                                                                               Dec-27


                                                                                                                                                 Jun-28


                                                                                                                                                               Dec-28

                                                                                                                                                                                 Jun-29


                                                                                                                                                                                                Dec-29

                                                                                                                                                                                                                   Jun-30


                                                                                                                                                                                                                                  Dec-30


                                                                                                                                                                                                                                                    Jun-31


                                                                                                                                                                                                                                                                  Dec-31
                                                                                       -0.50
                                                                                                                                           12-month return                                               turnover
                                                                                       -1.00
         Panel C: Technology stock bubble, stock prices                          Panel D: Technology stock bubble, 12-month returns and turnover
                                                                                         500%                                                                                                                                                                              0.70

                                                                                         400%                                                                                                                                                                              0.60

                                                                                         300%                                                                                                                                                                              0.50




                                                                      12-month return




                                                                                                                                                                                                                                                                                  turnover
                                                                                         200%                                                                                                                                                                              0.40

                                                                                         100%                                                                                                                                                                              0.30

                                                                                           0%                                                                                                                                                                              0.20




                                                                                                        Dec-95


                                                                                                                              Dec-96


                                                                                                                                                     Dec-97


                                                                                                                                                                        Dec-98


                                                                                                                                                                                               Dec-99


                                                                                                                                                                                                                        Dec-00


                                                                                                                                                                                                                                           Dec-01


                                                                                                                                                                                                                                                                  Dec-02
                                                                                                                     Jun-96


                                                                                                                                        Jun-97


                                                                                                                                                              Jun-98


                                                                                                                                                                                      Jun-99


                                                                                                                                                                                                          Jun-00


                                                                                                                                                                                                                                 Jun-01


                                                                                                                                                                                                                                                         Jun-02
                                                                                        -100%                                                                                                                                                                              0.10

                                                                                        -200%                                                                                                                                                                              0.00
                                                                                                                                             12-month return                                                                turnover


Figure 5: Prices, returns, and volume during bubble episodes. Prices, past 12-month returns, and value-weighted turnover during
four bubbles episodes: utility stocks in 1929; technology stocks in 1998-2000; house prices in 2004-2006 as measured by the Case-
Shiller 20-City Index; and oil in 2007-2008 as proxied by the price of the USO ETF. All data are monthly and value-weighted across
stocks. For housing, turnover is measured as the number of existing-home sales.
                                                                  50
                                                Panel E: Housing bubble of 2004-2006, price index                                                                                                                Panel F: Housing bubble of 2004-2006, 12-month returns and
                                                                                                                                                                                                                                           volume
                               250                                                                                                                                                                                             20%                                                                                                                                          8,000

                                                                                                                                                                                                                               15%                                                                                                                                          7,000




                                                                                                                                                                                                                                                                                                                                                                                    existing home sales (x1000)
                               200
  Case Shiller 20 City Index


                                                                                                                                                                                                                               10%




                                                                                                                                                                                                      12-month return (CS20)
                                                                                                                                                                                                                                                                                                                                                                            6,000
                                                                                                                                                                                                                                5%
                               150                                                                                                                                                                                                                                                                                                                                          5,000
                                                                                                                                                                                                                                0%
                                                                                                                                                                                                                                                                                                                                                                            4,000
                                                                                                                                                                                                                                -5%
                               100                                                                                                                                                                                                                                                                                                                                          3,000
                                                                                                                                                                                                                               -10%
                                                                                                                                                                                                                                                                                                                                                                            2,000
                                50                                                                                                                                                                                             -15%

                                                                                                                                                                                                                               -20%                                                                                                                                         1,000

                                0                                                                                                                                                                                              -25%                                                                                                                                         0
                                     Jan-00

                                                       Jan-01

                                                                Jan-02

                                                                                  Jan-03

                                                                                           Jan-04

                                                                                                             Jan-05

                                                                                                                        Jan-06

                                                                                                                                          Jan-07

                                                                                                                                                   Jan-08

                                                                                                                                                                     Jan-09

                                                                                                                                                                              Jan-10




                                                                                                                                                                                                                                       Jan-00
                                                                                                                                                                                                                                                   Jan-01
                                                                                                                                                                                                                                                            Jan-02
                                                                                                                                                                                                                                                                         Jan-03
                                                                                                                                                                                                                                                                                  Jan-04
                                                                                                                                                                                                                                                                                                    Jan-05
                                                                                                                                                                                                                                                                                                             Jan-06
                                                                                                                                                                                                                                                                                                                           Jan-07
                                                                                                                                                                                                                                                                                                                                    Jan-08
                                                                                                                                                                                                                                                                                                                                                 Jan-09
                                                                                                                                                                                                                                                                                                                                                          Jan-10
                                                                                                             CS20                                                                                                                                     12-month return                                                          home sales (x1000)


                                              Panel G: 2007-2008 Commodity bubble, USO price                                                                                                           Panel H: 2007-2008 Commodity bubble, 12-month returns and
                                                                                                                                                                                                                            turnover of USO
                               120                                                                                                                                                                                             150%                                                                                                                                             0.40
                                                                                                                                                                                                                                                                                                                                                                                0.35




                                                                                                                                                                                                     12-month past return
                               100                                                                                                                                                                                             100%
                                                                                                                                                                                                                                                                                                                                                                                0.30
                                80
      USO Price




                                                                                                                                                                                                                                                                                                                                                                                0.25




                                                                                                                                                                                                                                                                                                                                                                                                                  turnover
                                                                                                                                                                                                                                50%
                                60                                                                                                                                                                                                                                                                                                                                              0.20
                                                                                                                                                                                                                                 0%                                                                                                                                             0.15
                                40
                                                                                                                                                                                                                                                                                                                                                                                0.10
                                                                                                                                                                                                                               -50%
                                20                                                                                                                                                                                                                                                                                                                                              0.05

                                 0                                                                                                                                                                                             -100%                                                                                                                                            0.00
                                                                                                                                                                                                                                          Mar-07




                                                                                                                                                                                                                                                                                           Mar-08




                                                                                                                                                                                                                                                                                                                                             Mar-09
                                                                                                                                                                                                                                                                Sep-07




                                                                                                                                                                                                                                                                                                                      Sep-08




                                                                                                                                                                                                                                                                                                                                                                   Sep-09
                                              Mar-07




                                                                                                    Mar-08




                                                                                                                                                            Mar-09
                                                                         Sep-07




                                                                                                                                 Sep-08




                                                                                                                                                                                       Sep-09




                                                                                                                      USO                                                                                                                                                12-month return                                                     turnover


Figure 5: Prices, returns, and volume during bubble episodes [continued].

                                                                                                                                                                                                51
                                                               Panel A. Bubble stocks attract new investors
             100%
              90%
              80%
              70%
              60%
              50%
              40%
              30%
              20%
              10%
               0%
                                 Mar-98




                                                                         Mar-99




                                                                                                                    Mar-00




                                                                                                                                                                         Mar-01




                                                                                                                                                                                                                         Mar-02
                     Dec-97




                                                      Sep-98
                                                                Dec-98




                                                                                             Sep-99
                                                                                                        Dec-99




                                                                                                                                             Sep-00
                                                                                                                                                           Dec-00




                                                                                                                                                                                                  Sep-01
                                                                                                                                                                                                              Dec-01




                                                                                                                                                                                                                                            Sep-02
                                                                                                                                                                                                                                                     Dec-02
                                            Jun-98




                                                                                   Jun-99




                                                                                                                                Jun-00




                                                                                                                                                                                      Jun-01




                                                                                                                                                                                                                                   Jun-02
                                                      N (new) / N (total) (.com)                                                                      N (new) / N (other stocks)




                                                                         Panel B. “Growthiness” of owners
                10
                 9
                 8
                 7
                 6
                 5
                 4
                 3
                 2
                 1
                 0
                                   Mar-98




                                                                         Mar-99




                                                                                                                 Mar-00




                                                                                                                                                                Mar-01




                                                                                                                                                                                                                Mar-02
                        Dec-97


                                             Jun-98
                                                       Sep-98
                                                                Dec-98


                                                                                  Jun-99
                                                                                            Sep-99
                                                                                                      Dec-99


                                                                                                                             Jun-00
                                                                                                                                         Sep-00
                                                                                                                                                      Dec-00


                                                                                                                                                                             Jun-01
                                                                                                                                                                                         Sep-01
                                                                                                                                                                                                     Dec-01


                                                                                                                                                                                                                          Jun-02
                                                                                                                                                                                                                                   Sep-02
                                                                                                                                                                                                                                            Dec-02




                                             Owner Growthiness (.com)                                                                    Owner Growthiness (other stocks)


Figure 6: Changing ownership composition during the .com bubble. Stocks are only considered
following two quarters in which there were five or more mutual fund owners. Panel A shows the ratio of
new owners in quarter t to total owners, averaged across .com stocks and all other stocks. Panel B shows
the growthiness of new owners, where growthiness of a portfolio is defined as the position-weighted past
return decile. For .com stocks we rely on the classification by Ofek and Richardson (2003).


                                                                                                                    52
