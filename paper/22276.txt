                              NBER WORKING PAPER SERIES




                       VOLATILITY AND THE GAINS FROM TRADE

                                           Treb Allen
                                           David Atkin

                                       Working Paper 22276
                               http://www.nber.org/papers/w22276


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     May 2016




We thank Costas Arkolakis, Kyle Bagwell, Dave Donaldson, Jonathan Eaton, Marcel Fafchamps,
Pablo Fajgelbaum, Sam Kortum, Rocco Machiavello, Kiminori Matsuyama, John McLaren,
Steve Redding, Andres Rodriguez-Clare, Esteban Rossi-Hansberg, Chang-Tai Hsieh, Andy
Skrzypacz, Jon Vogel and seminar participants at Columbia University, George Washington
University, Harvard University, the NBER ITI Winter Meetings, Pennsylvania State University,
Princeton University, Princeton IES Summer Workshop, Purdue University, Stanford University,
University of British Columbia, University of California - Berkeley, University of California -
Davis, University of North Carolina, University of Toronto, and University of Virginia. We thank
Scott Fulford for kindly providing the rural bank data we use. Rodrigo Adao, Fatima Aqeel,
Masao Fukui, Annekatrin Lüdecke, and Yuta Takahashi provided exceptional research assistance.
Part of this paper was completed while Allen was a visitor at the Stanford Institute for Economic
Policy Research (SIEPR), whose hospitality he gratefully acknowledges. All errors are our own.
The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2016 by Treb Allen and David Atkin. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including ©
notice, is given to the source.
Volatility and the Gains from Trade
Treb Allen and David Atkin
NBER Working Paper No. 22276
May 2016
JEL No. F1,G11,O13,O18

                                          ABSTRACT

By reducing the negative correlation between local prices and productivity shocks, trade
liberalization changes the volatility of returns. In this paper, we explore the second moment
effects of trade. Using forty years of agricultural micro-data from India, we show that falling
trade costs increased farmer's revenue volatility, causing farmers to shift production toward crops
with less risky yields. We then characterize how volatility affects farmer's crop allocation using a
portfolio choice framework where returns are determined in general equilibrium by a many-
location, many-good Ricardian trade model with flexible trade costs. Finally, we structurally
estimate the model—recovering farmers' unobserved risk-return preferences from the gradient of
the mean-variance frontier at their observed crop choice—to quantify the second moment effects
of trade. While the expansion of the Indian highway network would have increased the volatility
of farmer's real income had their crop choice remained constant, by changing what they produced
farmers were able to avoid this increased volatility and amplify the gains from trade.


Treb Allen
Department of Economics
Northwestern University
2001 Sheridan Road
Evanston, IL 60208
and NBER
treb.allen@northwestern.edu

David Atkin
Department of Economics, E52-550
MIT
77 Massachusetts Avenue
Cambridge, MA 02139
and NBER
atkin@mit.edu
1   Introduction
    While trade liberalization increases average returns through specialization, it also af-
fects the volatility of returns by reducing the negative correlation between local prices and
productivity shocks. When production is risky, producers are risk averse, and insurance
markets are incomplete—as is the case for farmers in developing countries—the interac-
tion between trade and volatility may have important welfare implications. Yet we have
a limited understanding of the empirical importance of the relationship between trade
and volatility. In particular, does volatility magnify or attenuate the gains from trade and
how do agents respond to changes in the risk they face arising from falling trade costs?
    In this paper, we empirically, analytically, and quantitatively explore the second
moment effects of trade. Using forty years of agricultural micro-data from India, we
show empirically that trade increased farmer’s revenue volatility by reducing the respon-
siveness of local prices to local rainfall, causing farmers to shift production toward crops
with less volatile yields. We then incorporate a portfolio allocation framework—where
producers optimally allocate resources (land) across risky production technologies
(crops)—into a many location, many good, general equilibrium Ricardian trade model.
The model yields analytical expressions for the equilibrium allocation of resources and
generates straightforward relationships between observed equilibrium outcomes and
underlying structural parameters, allowing us to quantify the second moment welfare
effects of trade. Structural estimates suggest that farmers are able to avoid an increase
in volatility from falling trade costs by reallocating their production toward less risky
crops, thereby amplifying the gains from trade .
    Rural India—home to roughly one-third of the world’s poor—is an environment where
producers face substantial risk. Even today, less than half of agricultural land is irrigated,
with realized yields driven by the timing and intensity of the monsoon and other more
localized rainfall variation. Access to agricultural insurance is very limited, forcing farm-
ers—who comprise more than three quarters of the economically active population—to
face the brunt of the volatility, see e.g. Mahul, Verma, and Clarke (2012). Furthermore,
many are concerned that the substantial fall in trade costs over the past forty years (due,
in part, to expansions of the Indian highway network and reductions in tariffs) has am-
plified the risk faced by farmers. As the The New York Times writes:
     “When market reforms were introduced in 1991, the state scaled down sub-
     sidies and import barriers fell, thrusting small farmers into an unforgiving
     global market. Farmers took on new risks, switching to commercial crops and
     expensive, genetically modified seeds... They found themselves locked in a
     whiteknuckle gamble, juggling ever larger loans at exorbitant interest rates,

                                              1
     always hoping a bumper harvest would allow them to clear their debts, so
     they could take out new ones. This pattern has left a trail of human wreckage.”
     (“After Farmers Commit Suicide, Debts Fall on Families in India”, 2/22/2014).

These concerns, and the importance to policymakers of better understanding the link be-
tween trade and volatility, are encapsulated by the fact that the entire Doha round of
global trade negotiations collapsed in 2008 (and remains stalled today) precisely because
of India and China’s insistence on special safeguard mechanisms to protect their farmers
from excessive price volatility.
    Using a dataset containing the annual price, yield, and area planted for each of 15
major crops across 308 districts over 40 years matched to imputed bilateral travel times
along the evolving national highway network, we confirm that reductions in trade costs
did affect volatility. In particular, we document three stylized facts. First, reductions in
trade costs due to the expansion of the highway network raised the volatility of nominal
income across years (but not the volatility of the price index). Second, this increase in
volatility occurred because reductions in trade costs reduced the elasticity of local prices
to local supply shocks. Third, in response to this changing risk profile, farmers changed
what they produced, reallocating land toward crops with higher average yields (as tradi-
tional trade models predict) and to crops with less volatile yields (to reduce the volatility
they face), although the reallocation toward less volatile crops was less pronounced in
districts where farmers had better access to banks.
    We next develop a quantitative general equilibrium model of trade and volatility. To
do so, we first construct a many country Ricardian trade model with a finite number of
homogenous goods and arbitrary (symmetric) bilateral trade costs. To circumvent the fa-
miliar difficulties arising from corner solutions for prices and patterns of specialization,
we assume there are many (infinitesimal) traders who randomly match to farmers, each of
whom has a distinct iceberg trade cost drawn from a Pareto distribution. We show that—
consistent with the mechanism highlighted by the second stylized fact—this assumption
allows equilibrium prices to be written as a log-linear function of yields in all locations,
with the elasticities determined by the matrix of shape parameters governing the distri-
bution of bilateral trade costs. Furthermore, in the absence of volatility, we derive an
analytical expression for the equilibrium pattern of specialization across locations that
highlights the role of geography and comparative advantage (i.e. relative productivity).
    To incorporate volatility in the model, we assume that producers allocate their factor
of production across crops prior to the realization of productivity shocks. By combin-
ing our Ricardian trade model with tools from the portfolio allocation literature (see e.g.
Campbell and Viceira (2002)), we are able to derive tractable expressions for the equi-

                                             2
librium pattern of specialization given any set of average crop productivities and any
variance-covariance matrix governing the volatility of productivities across crops. The
model remains sufficiently tractable to yield comparative statics consistent with the three
stylized facts detailed above and to analytically characterize the welfare effects of trade.
We show that the model without volatility readily generalizes, with farmer crop choice
now determined by comparative advantage in risk-adjusted productivity. Trade decou-
ples the production and consumption decision which, in the presence of volatility, allows
farmers to hedge risk through their cropping decisions.
    Finally, we estimate the model and quantify the second moment welfare effects of
trade. The tractability of the model allows us to recover key model parameters from the
data in a transparent manner. First, the model implies that the unobserved trade costs
determine the elasticity of local prices to yield shocks in all locations. Conveniently, this
relationship can be reduced to a linear equation and so we can recover unobserved trade
costs via ordinary least squares. In particular, we find that expansion of the highway
network not only decreased the responsiveness of local prices to local yields (as already
shown in the second stylized fact) but also increased the responsiveness of local prices to
yields elsewhere, with the bilateral trade costs between i and j recoverable from the elas-
ticity of i’s price to j’s yield shocks. Second, farmers’ unobserved risk-return preferences
shape the gradient of the mean-variance frontier at the farmers’ observed crop choice. As
above, we show that estimates of risk-return tradeoffs can be inferred from these observed
choices via ordinary least squares. Reassuringly, the resulting estimates are strongly cor-
related with spatial and temporal variation in access to rural banks (which, by providing
access to a risk mitigating technology, should make farmers act less risk averse).
    We use these parameter estimates to quantify the welfare effects of the expansion
of the Indian highway network. We find that had farmers’ crop allocation remain un-
changed, the increased volatility caused by the expansion of the highway network would
have offset approximately 15 percent of the first moment gains from trade. However,
by changing what they produce, farmers are able to fully hedge against the increased
risk (i.e. the total gains from trade increase by approximately 15 percent compared to
the baseline where crop allocations are held constant). Highlighting the second moment
forces in our model, we find that the gains from trade were smallest in districts where the
most productive crops were more risky. Farmers in these locations chose not to take full
advantage of traditional gains from specialization in order to avoid additional risk.
    This paper relates to a number of strands of literature in both international trade and
economic development. The theoretical literature on trade and volatility goes back many
years (see Helpman and Razin (1978) and references cited therein). In a seminal paper,


                                             3
Newbery and Stiglitz (1984) develop a stylized model showing that trade may actually be
welfare decreasing in the absence of insurance (although to obtain this result, in contrast
to our model farmers and consumers must differ in their preferences and not consume
what they produce). Eaton and Grossman (1985) and Dixit (1987, 1989a,b) extend the the-
oretical analysis of Newbery and Stiglitz (1984) to incorporate imperfect insurance and
incomplete markets. Our paper incorporates the intuition developed in these seminal
works into a quantitative trade model that is sufficiently flexible (e.g. by incorporating
many goods with arbitrary variances and covariances of returns and flexible bilateral
trade costs) to be taken to the data. More recently, several papers have explored the links
between macro-economic volatility and trade, see e.g. Easterly, Islam, and Stiglitz (2001);
di Giovanni and Levchenko (2009); Karabay and McLaren (2010); Lee (2013). Our paper,
in contrast, focuses on the link between micro-economic volatility—i.e. good-location
specific productivity shocks—and trade.
    Most closely related to our paper are the works of Burgess and Donaldson (2010, 2012)
and Caselli, Koren, Lisicky, and Tenreyro (2014). Burgess and Donaldson (2010, 2012) use
an Eaton and Kortum (2002) framework to motivate an empirical strategy that studies the
relationship between famines and railroads in colonial India.1 Caselli, Koren, Lisicky, and
Tenreyro (2014) also use an Eaton and Kortum (2002) framework to quantify the relative
importance of sectoral and cross-country specialization in a world of globally sourced
intermediate goods. We see our paper as having three distinct contributions relative to
these papers. First, we depart from the Eaton and Kortum (2002) framework and develop
an alternative quantitative general equilibrium framework that allows us to analyze the
pattern of trade for a finite number of homogeneous goods. Second, by embedding a port-
folio allocation decision where real returns are determined in a general equilibrium trade
setting, we characterize the endogenous response of agents to trade-induced changes in
their risk profile. Third, we empirically validate that farmers are indeed responding as
predicted and that these responses substantially amplify the gains from trade.
    The paper is also related to a growing literature applying quantitative trade models
to the study of agriculture. Sotelo (2013), Costinot and Donaldson (2011), and Costinot,
Donaldson, and Smith (2016) examine how trade affects crop choice. In these models,
locations grow multiple crops due to heterogeneity in the productivity of different plots
   1 Despite  focusing on intra-national trade in the same country, India, there are also important differ-
ences between modern India and the colonial setting studied by Burgess and Donaldson (2010, 2012),
most notably that trade costs seem if anything to have risen between the tail end of the Colonial period
and the start of our sample, 1970. As evidence for this claim, we find that local rainfall shocks affect local
prices at the start of our sample period (consistent with substantial barriers to trade across locations),
while Donaldson (forthcoming) finds they did not post railway construction in his Colonial India sample
(consistent with low barriers to trade across locations).


                                                      4
(in contrast to wanting to diversify against risk, as in our model). As in Allen (2014), we
relax the no-arbitrage condition, although here we do so by allowing for heterogeneous
trade costs rather than information frictions.
    Finally, we also relate to two strands of the economic development literature. First, we
follow a long tradition of modeling agricultural decisions as portfolio allocation problems
(see e.g. Fafchamps (1992); Rosenzweig and Binswanger (1993); Kurosaki and Fafchamps
(2002)). Second, there is also a substantial development literature examining the effect
that access to formal credit has on farmers (see e.g. Burgess and Pande (2005) and Jay-
achandran (2006)). We contribute to these two strands of literature in two ways: first,
our rich data allows us to characterize the optimal crop choice using the observed mean,
variance, and covariance of yield shocks across crops; second, we demonstrate that rural
bank access leads farmers to choose riskier crop portfolios.
    The remainder of the paper is organized as follows. In Section 2, we describe the em-
pirical context and the data we have assembled. Section 3 presents three new stylized
facts relating trade to volatility and the resulting responses by farmers. In Section 4, we
develop the model, show that it is consistent with the reduced form results, and analyti-
cally characterize the second moment welfare effects of trade. In Section 5, we structurally
estimate the model and quantify these welfare effects. Section 6 concludes.

2     Empirical context and Data
2.1   Rural India over the past forty years
    This paper focuses on rural India over a forty year period spanning 1970 to 2009. The
majority of rural households derive income from agriculture; 85 percent of the rural work-
force was in agriculture in the 1971 Census and 72 percent in the 2011 Census. Over this
period, there were three major developments that had substantial impacts on the welfare
of rural Indians. The first set of changes were to the technology of agricultural produc-
tion. Increased use of irrigation and high-yield varieties (HYV) raised mean yields and
altered the variance of yields.2 The second major change was the policy-driven expansion
of formal banking into often unprofitable rural areas (see Burgess and Pande (2005) and
Fulford (2013)).3 The availability of credit helped farmers smooth income shocks and so

    2 Irrigation coverage rose from 23 to 49 percent of arable land and HYV use rose from 9 to 32 percent

(1970-2009 changes from ICRISAT VDSA data introduced in the next section). Some HYV crops had lower
variance due to greater resistance to pests and drought, others higher due to greater susceptibility to
weather deviations—see Munshi (2004) for further discussion.
    3 As reported in Basu (2006), the share of rural household debt from banks rose from 2.4 percent to 29

percent between 1971 and 1991. By 2003, 44 percent of large farmers (more than 4 acres, accounting for 55
percent of India’s agricultural land), 31 percent of small farmers (1-4 acres, 40 percent of land) and 13 percent
of marginal farmers (less than 1 acre, 15 percent of land) had an outstanding loan from a formal bank.


                                                       5
provided a form of insurance.4
    The third set of changes relate to reductions in inter- and particularly intra-national
trade costs. The reductions were driven by two types of national policy change. The
first—which we will exploit extensively in the empirical analysis—were major expan-
sions of the Indian inter-state highway system including the construction of the ‘Golden
Quadrilateral’ between Mumbai, Chennai, Kolkata and Delhi and the ‘North South and
East West Corridors’.5 The result was that over the sample period, India moved from
a country where most freight was shipped by rail to one dominated by roads—in 1970
less than a third of total freight was trucked on roads, four decades later road transport
accounted for 64 percent of total freight.6 The second policy change was the broad eco-
nomic liberalization program started in 1991 that gradually reduced agricultural tariffs
with the outside world and began to dismantle the many restrictions to inter-state and
inter-district trade within India as documented in Atkin (2013). This paper focuses on the
inter-state and inter-district trade that constituted the overwhelming majority of India’s
agricultural trade over our sample period, in effect treating India as a closed economy.7
2.2     Data
   We have assembled a detailed micro-dataset on agricultural production and trade
costs covering the entirety of the forty year period 1970-2009. These datasets come from
the following sources:
   Crop Choices: Data on district-level cropping patterns, crop prices8 and crop yields
come from the ICRISAT Village Dynamics in South Asia Macro-Meso Database (hence-
      4 India
            also has a subsidized crop insurance scheme. However, even today coverage is limited, with
only 6 percent of farmers voluntarily purchasing cover (a further 11 percent of farmers have agricultural
loans with mandatory insurance requirements, see Mahul, Verma, and Clarke (2012)).
    5 See Datta (2012); Ghani, Goswami, and Kerr (2016); Asturias, García-Santana, and Ramos (2014) for

estimates of the effect of the “Golden Quadrilateral” on firm inventories, manufacturing activity, and firm
competition, respectively.
    6 These figures are Indian government estimates from the 10th, 11th and 12th five-year-plans.
    7 External agricultural trade remained subject to a restrictive license system until April 2001. Focusing

on the three most traded products—rice, sugar and wheat—external trade (international exports plus
imports) equaled 0.5, 0.3 and 11 percent of production by weight in the 1970s, and 2.8, 0.7 and 3 percent
in the 2000s, respectively. Unfortunately, India only records internal trade by rail, river and air (recall
road accounted for between one and two thirds of freight); and then only for trade between 40 or so large
trading blocks in India. Using the rail, river and air data that likely severely underestimate inter-district
trade, internal trade equaled 3.8, 1.3 and 21.4 percent of production by weight in the 1970s, and 10.2, 0.9
and 16.3 percent in the 2000s.
    8 These are producer prices—i.e. the farm gate price a farmer receives. India has a system of minimum

support prices (MSPs) which, if binding, affect the farm gate price and potentially attenuate any price
response our theory will predict. Appendix figures A.1-A.4 plot the distribution of log prices alongside the
MSPs for applicable crops for 1970, 1980, 1990 and 2000. There is little evidence of price heaping just at or
above the MSPs, as well as substantial mass below the MSPs, suggesting any attenuation from excluding
MSPs from our model is limited.


                                                     6
forth VDSA) which is a compilation of various official government datasources. The
database covers 15 major crops across 308 districts from the 1966-67 crop year all the way
through to the 2009-10 crop year.9 The dataset uses 1966 district boundaries to ensure
consistency over time and covers districts in 19 States (containing 95 percent of India’s
population in the 2001 Census).
    Trade Costs: We obtained all editions of the government-produced Road Map of India,
published in the years 1962, 1969, 1977, 1988, 1996, 2004 and 2011. The maps were dig-
itized, geo-coded, and the location of highways identified using an algorithm based on
the color of digitized pixels. Figure 1 depicts the evolution of the Indian highway system
across these years; as is evident, there was a substantial expansion of the network over the
forty year period. Using these maps, we construct a “speed image” of India, assigning a
speed of 60 miles per hour on highways and 20 miles per hour elsewhere and use the Fast
Marching Method (see Sethian (1999)) to calculate travel times between any two districts
in each year in India.10
    Rural Bank Data: Data on rural bank access, an important insurance instrument in
India, come from RBI bank openings by district assembled by Fulford (2013).
    Consumer Preferences: Consumption data come from the National Sample Survey
(NSS) Schedule 1.0 Surveys produced by the Central Statistical Organization.
    Rainfall Data: Gridded weather data come from Willmott and Matsuura (2012) and
were matched to each district by taking the inverse distance weighted average of all the
grid points within the Indian subcontinent.

3    Trade and Volatility: Stylized Facts
    In this section, we present three sets of stylized facts. The first fact documents an
explicit link between trade costs and farmer income volatility: reductions in trade costs
induced by the expansion of the Indian highway system raised the volatility of nominal
income but not the price index. We then explore the mechanisms that will deliver these
predictions in our theoretical model. The second fact provides evidence for the central
link between trade costs and volatility in our model: reductions in trade costs reduced
the elasticity of local prices to local quantities thereby raising revenue volatility for farm-
    9 The 15 crops are barley, chickpea, cotton, finger millet, groundnut, linseed, maize, pearl millet, pigeon

pea, rice, rape and mustard seed, sesame, sorghum, sugarcane, and wheat. These 15 crops accounted for
an average of 73 percent of total cropped area across districts and years. The data coverage across crops
with districts is good: in the median district-decade pair, we observe at least one year of production data
for 13 of the 15 crops and at least one year of price data for 11 of the 15 crops. The data are at the annual
level and combine both the rabi and kharif cropping seasons.
   10 We linearly interpolate travel times in years between editions of the Road Map of India. See Allen and

Arkolakis (2014) for a previous application of the Fast Marching Method to estimate trade costs. The results
that follow are similar for alternative assumptions in the construction of the speed images; see below.


                                                      7
ers. The third fact provides evidence that farmers respond by making risk-reducing crop
choices consistent with a portfolio choice model: reductions in trade costs led farmers to
move into crops with higher means (a first moment effect) and less risky yields (a second
moment effect), with the latter effect attenuated by greater access to insurance.
3.1   Income volatility and trade costs
Stylized Fact 1A: The volatility of nominal income increased over time
    As discussed in Section 2.1, the period between 1970 and 2009 saw large reductions in
trade costs within India. Did this period of reductions coincide with a rise in the variance
of income? To explore this question, we calculate for each district and decade the mean
and variance of nominal (gross) income—i.e. the total revenue from the production of
all 15 crops—using annual data on agricultural revenues per hectare.11 Of course, these
are gross of crop costs which may be changing over time—an issue we confront head on
in the structural estimates. While these revenues are deflated by the all-Indian CPI, a
national price index cannot capture local variation in agricultural prices that play an im-
portant role in determining the gains from trade on the consumption side. Accordingly,
we also calculate an explicit CES price index for the 15 crops in our sample, with real
income being the ratio of nominal income and this price index.12 Figure 2 plots the log
changes in the decade-level mean and variance of each of these three variables compared
to the base decade, the 1970s (averaging the log changes over districts).
    Consistent with reductions in transport costs generating standard first moment gains
from trade, decade-district means of real income rose over time due to increases in nom-
inal incomes and reductions in the price index. However, there were second moment
effects as well. Consistent with the literature (e.g. Newbery and Stiglitz (1984)), nominal
income became more volatile (since producers faced more revenue risk) and the price in-
dex stabilized (since consumers faced less consumption risk). In net, real income became
more volatile.
Stylized Fact 1B: The volatility of nominal income increases with market access
   Given the myriad of changes over this period, the link between the reduction in trade
barriers and the real income trends documented above is, at best, suggestive. We now es-
   11 This paper focuses on the effects of yield volatility across years. Within a year, the timing of the

harvest and farm- or micro-region-specific crop failures present additional sources of volatility. Data
limitations—the Indian government produces statistics only at the district-year level—preclude us from
examining these additional sources of volatility empirically.
   12 We obtain the CES parameters from a regression of log expenditure shares on log prices using the

1987/88 NSS household surveys and assume preferences are identical across locations and time periods. As
these parameter estimates are used primarily in the structural estimates, we describe the exact specification
in Section 5.1 and show the estimated parameters in Table 4.


                                                     8
tablish a more direct link by calculating district-decade level measures of trade openness
from the digitized road maps described in Section 2.2. Recall the digitized maps allow us
estimate the bilateral travel time between any two points in India in any year. Similarly to
Donaldson and Hornbeck (forthcoming), we construct a market access measure for dis-
trict i by taking a weighted sum of the (inverse) bilateral travel times to each of the other
districts as follows:                                          
                                                      1
                                MAit = ∑                   φ
                                                                 Yjt
                                       j 6 =i   travel time ijt

where Yjt is the income of district j in period t (proxied by the total agricultural rev-
enues in our dataset) and φ > 0 determines how quickly market access declines with
increases in travel times. Higher values of market access correspond to greater trade
openness as districts are able to trade more cheaply with districts where demand is high.
To parametrize φ we draw on the gravity literature that regresses log trade flows on log
distance to estimate how quickly trade flows decline with distance. Following the meta-
analyses of Disdier and Head (2008) and Head and Mayer (2014), we set φ = 1.5—the
average gravity coefficient for developing country samples—in our preferred market ac-
cess specification.13 We also consider φ = 1, a natural benchmark and close to the average
of 1.1 found for the all country sample, as well as alternate estimates of the off-highway
speed of travel (1/4 of that on the highway rather than 1/3) for robustness.
    With these measures in hand, we regress the log of either the mean or the variance
of one of the three income measures (nominal income, the price index, and real income)
at the district-decade level on one of the three market access variants. These result are
shown in the top panel of Table 1, with each cell the coefficient from a separate regression.
All regressions include district and decade fixed effects (and hence identify off differences
within districts over time controlling for trends using time changes in other districts).
    The results are broadly consistent with the crude inference drawn from the aggregate
trends above. We find that the mean of real income rises significantly with all three mea-
sures of market access (Column 5). This comes about through a rise in nominal income
(Column 1) that far exceeds the rise in the price index (Column 3). Turning to second
moment effects, nominal income becomes significantly more volatile with market access
(Column 2). In terms of magnitudes, a rise in market access equal to the median change in
district-level market access between 1970 and 2009 raises the mean of nominal income by
  13 Head  and Mayer (2014) perform a meta-analysis of gravity estimates and report an average coefficient
on log distance of -1.1 across 159 papers and 2,508 regressions. They build off an earlier meta-analysis by
Disdier and Head (2008) which reports that estimates based on developing country samples are lower by
an average of 0.44 (Column 4 of Table 2 in Disdier and Head (2008)) consistent with distance being more
costly in developing countries as found in Atkin and Donaldson (2015).


                                                    9
37 percent and the variance of nominal income by 51 percent. In contrast to the increase
in the volatility of nominal income, the volatility of the price index is unchanged (Column
4), with real income volatility rising on net (Column 6).
    In order for these coefficients to be interpreted as causal, we require that road building
does not respond to changes in the means and variances of incomes after controlling for
location and time fixed effects. Endogeneity concerns are mitigated by the fact that, as
we detailed in Section 2.1, much the highway construction was part of centrally-planned
national programs designed to connect larger regions. However, worries remain, which
in part motivates out structural estimates which allow us to isolate the impacts of trade
cost reductions on welfare.
3.2   The responsiveness of prices to yields and trade costs
Stylized Fact 2: The elasticity of price to yield declines with market access
   We now turn to providing direct evidence for the increased responsiveness of local
prices to local supply shocks that links trade costs reductions to the increased nominal
income volatility we found in Stylized Fact 1B. To do so we regress log prices on log
yields and explore explore how the coefficient on yields—the elasticity of price to yield—
changes with the market access measures introduced above:

               ln pigtd = β 1 ln yigtd + β 2 ln yigtd × MAid + γgtd + γigd + νigdt ,

where ln pigtd is the observed local price in district i of good g in year t in decade d, ln yigtd
is the observed yield, and MAid is the decade average of market access for district i. To
control for confounds, we include two sets of fixed effects: a crop-year fixed effect γgtd
that controls for changes in the world price of the good; and a district-crop-decade fixed
effect γigd that controls for slow-moving changes in crop-specific costs, in the area allo-
cated to the crop, or in technologies. We can identify β 2 , the change in elasticity of price
to yield with market access, via ordinary least squares as long as the variation in yields of
good g in district i in time t is uncorrelated with the residual. Since farmers may invest
disproportionately more care harvesting crops that have high prices (so that the observed
yield will be positively correlated with price), we calculate a proxy for yields using local
variation in rainfall. Specifically, we regress log yield on local rainfall shocks for each
month interacted with state-crop fixed effects and include the same crop-district-decade
and crop-year fixed effects as in the specification above. This generates a predicted yield
measure that, after conditioning on the fixed effects, depends only on rainfall realizations
and time-invariant parameters (and hence is unaffected by changes in the production
technology over time).


                                                10
    The regression results are shown in Table 2. Column 1 reports the OLS, Column 2 re-
ports the IV instrumenting yields and the interaction of yields and market access with
predicted yields and its interaction, and Column 3 reports the reduced form (i.e. re-
gressing prices on predicted yields and its interaction). For all three specifications, the
elasticity of local prices to local yields increased significantly—from negative values to-
wards zero—with improvements in market access. Reassuringly, the coefficient on log
yield becomes more negative in the IV and reduced form specifications, consistent with
the bias generated by the endogeneity concern highlighted above. The IV and reduced
form specifications are almost identical as the key coefficient in each of the two first stage
regressions is close to 1. A remaining concern is that there are crop-specific technological
changes or differences in crop suitability across districts that are correlated with the in-
teraction of market access and yields. Columns 4-6 repeat the reduced form specification
but interacting with log yield either the full set of crop-decade fixed effects, the full set of
crop-district fixed effects, or both sets together.14 The β 2 coefficient declines only slightly
and remains highly significant.15 Finally, Columns 7 and 8 repeat the most saturated
specification using the two alternative market access measures introduced above.
    In terms of magnitudes, using our preferred specification in Column 6 (the one with
both sets of yield interactions), a rise in market access equal to the median 1970-2009
change in district-level market access raises the elasticity by 0.057 (from a mean in the
1970s of -0.137). Once again, in order for the coefficients on market access to be interpreted
as causal we require that road building does not respond to changes in the covariances
of yields and prices after controlling for the various fixed effects. This assumption seems
more plausible in this case than it was for the mean of nominal incomes, but caution is
still warranted. In summary, we find a weakening of the inverse relationship between lo-
cal prices and supply shocks as trade costs fell, the key mechanism in our model through
which trade costs affect volatility.
3.3   Crop choices and trade costs
Stylized Fact 3A: Farmer cropping decisions reduce the volatility of nominal income
   We expect farmers to respond to the increased elasticity of price to yield, and the cor-
responding increase in revenue volatility, by altering their cropping choices to reduce the

   14 The IV specification is infeasible once we have many hundreds of endogenous variables and many

hundreds of instruments.
   15 One concern with the reduced form is that locations whose market access increased the most also

saw the largest increases in volatility-reducing technologies such as irrigation. This would mean yields
and hence prices respond less to rainfall in these locations through technology alone. In fact, by replacing
ln pigtd with ln yigtd in the specification shown in Column 6, we find the opposite: yields respond slightly
more to rainfall-predicted yields in locations with greater market access.


                                                    11
risk they face. Suggestive evidence for this response comes from repeating the exercise in
Stylized fact 1B but calculating nominal revenues using the 1970s crop allocations rather
than the actual crop allocations. The bottom panel of Table 1 reports these results. If farm-
ers mitigate the nominal income volatility they face through their planting decisions, we
would expect volatility to be higher under the initial (i.e. 1970s) crop allocations than
under the actual crop allocations. Comparing Columns 2 and 8 provides support for this
hypothesis, with nominal income volatility increasing more under 1970s allocations for
two of the market access measures and almost unchanged for the third. Conversely, the
mean of nominal income rises less under 1970s allocations. We observe similar patterns
for real income. These increases in volatility and reductions in the mean suggest that
farmers make crop choices to be on the mean-variance frontier of real returns.
Stylized Fact 3B: Farmers move into less-risky portfolios when market access increases
   To provide more direct evidence for the portfolio choice model underlying the re-
sponses above, we now explore the planting decisions themselves. Different crops have
very different means and variances of yields, and there is also substantial variation within
crops across regions of India and across time. Equally important are the covariances of
yields across crops which allow farmers to hedge production risk in one crop by plant-
ing another crop that can survive under the agroclimatic or pest conditions which cause
the first crop to fail. Appendix Figures A.5, A.6, and A.7 highlight this heterogeneity in
means, variances, covariances, and crop choice across decades and districts.
   Farmers respond to this heterogeneity in the ways a combination of portfolio theory
and trade theory would predict. First, Column 1 of Table 3 regresses crop choice (θigd , the
decade-d-average fraction of total area planted with good g in district i) on the log mean
             y                                        y
yield, log µigd , and the log variance of yield, log vigd , for that district-crop-decade:16
                                         y              y
                       θigd = β 1 log µigd + β 2 log vigd + γgd + γid + γig + ε igd

This specification can be seen as reduced form—i.e. a regression of an endogenous vari-
able, crop choice, on exogenous ones, the mean and variance of crop yields. (Our theoret-
ical framework in Section 4 will provide such a mapping from the mean and variance of
yields to crop choice). We saturate the model by including crop-decade, district-decade,
and district-crop fixed effects. These control for both national crop-specific trends and
persistent differences in local agroclimatic conditions that could potentially be related to
local agricultural technologies and hence bias the β coefficients. To further allay worries
about endogenous movements in yields, Column 2 reports similar results when we in-

  16 As   crop choices are not independent, standard errors are clustered at the district-decade level.


                                                      12
strument for the mean and variance of yields with the mean and variance of yields as
predicted by rainfall variation.17 Consistent with farmers being risk averse, farmers allo-
cated a significantly larger fraction of their farmland to crops that had high mean yields
and, conditional on the mean yield, a significantly smaller amount to crops with a high
variance of yields.18
    We now show that these crop choices responded to the reductions in trade costs (and
corresponding increases in market access) introduced in Stylized Fact 1B. To do so, we ex-
tend the specification above by interacting both the log mean yield and the log variance
of yield with our market access measures (the main effect of market access is swept out
by the district-decade fixed effects):
                  y              y               y                         y
θigd = β 1 log µigd + β 2 log vigd + β 3 log µigd × MAid + β 4 log vigd × MAid + γgd + γid + γig + ε igd

    The regression coefficients are shown in Columns 3 and 4 of Table 3. We find a signif-
icant positive β 3 coefficient and a significant negative β 4 coefficient whether using OLS
or instrumenting for the yield terms and their interactions with predicted yields using
rainfall and interactions. Reductions in trade costs, and hence increased market access,
led farmers to further increase the share of land allocated to high yield crops and further
reduce the share allocated to high variance crops. In terms of magnitudes, a rise in market
access equal to the median 1970-2009 change in district-level market access approximately
triples the responsiveness to changes in the mean and variance of yields. Similar results
obtain for the two alternative market access measures shown in Appendix Table A.1.
    These findings are consistent with farmers responding to falls in trade costs both by
reallocating toward crops in which they are more productive (a traditional “first mo-
ment” effect of trade on specialization) and by reallocating toward crops that are risky
in response to the reduction in the insurance provided by price movements (a “second
moment” effect of trade on specialization).
Stylized Fact 3C: Bank access attenuates the movement into less risky portfolios
   Finally, we take the previous specification and include additional interactions with the
number of banks per capita in that district. As discussed in Section 2.1, the presence of
banks provides a form of insurance as farmers can take out loans in bad times and re-
   17 For mean yields we use a measure analogous to the predicted yields in Stylized Fact 2: we regress log

yields on local rainfall shocks for each month interacted with state-crop fixed effects and controlling for
crop-decade, district-decade and crop-district fixed effects. Because the variances of these predicted yields
within a decade-district-crop poorly predict the variances of actual yields, we calculate the variance using
predicted yields from a regression of log yield on local rainfall shocks interacted with state-crop-decade
fixed effects and controlling for crop-district-decade fixed effects.
   18 In terms of magnitudes, a 10 percent increase in mean yield raises the fraction of land planted with a

crop by 0.0004, while a 10 percent increase in the variance of the yield reduces the fraction planted by 0.0001.


                                                      13
pay them in good times. These triple interaction is shown in Column 5 of Table 3. The
triple interaction of the log variance of yields, banks and market access is positive and
significantly different from zero using all three market access measures. Consistent with
farmers being willing to bear more risk if insured, the presence of more insurance options
attenuated the move into less risky crops that resulted from reductions in trade costs.19

4     Modeling trade and volatility
    In this section, we develop a quantitative general equilibrium model of trade and
volatility. To do so, we first develop a many location Ricardian trade model with a finite
number of homogenous goods and arbitrary (symmetric) bilateral trade costs. We circum-
vent difficulties due to corner solutions by assuming trade costs are heterogenous which
yields tractable expressions for equilibrium prices and patterns of specialization across lo-
cations. Importantly for the task at hand, this framework allows us to incorporate volatil-
ity by applying tools from the portfolio allocation literature. The model yields qualitative
predictions consistent with the stylized facts above as well as structural estimating equa-
tions that will allow us to quantify how volatility affects the gains from trade in Section 5.
4.1   Model setup
    Geography: The world is composed of a large number of locations indexed by i ∈
{1, ..., N } (Indian districts in our empirical setting). All pairs of locations are separated by
trade costs. Each location i is inhabited by a measure Li of identical farmers, who produce
and consume goods in location i. Production: There are a finite number G homogenous

goods (“crops”) that can be produced in each location i. Land is the only factor of pro-
duction. Each farmer in each location is endowed with a unit of land and chooses how
                                                                                f
to allocate her land across the production of each of the G goods.20 Let θig denote the
fraction of land farmer f living in location i allocates ton good
                                                                o g, where the farmer’s land
                G     f                                       f
constraint is ∑ g=1 θig = 1. In what follows, we refer to θig as farmer f ’s crop choice.
                                                                          g
    Production is risky. In particular, let the (exogenous) yield of a unit of land in location
i for good g be Aig (s), where s ∈ S is the state of the world. We abstract from idiosyn-
cratic risk and assume that all farmers within a given location in a particular state of the


   19 As the first-stage F-statistic in Column 6 of Table 3 shows, the instrumentation strategy used for fact

3B fails here as the first stage is too weak when we create 8 instruments for the 8 exogenous variables using
predicted yields and interactions. Appendix Table A.1 presents similar results for the two other market
access measures.
   20 We abstract from the dynamic aspect of crop choice due to, for example, switching costs as in Scott

(2013). In the quantitative analysis, we examine the change in crop allocations across decades rather than
years, mitigating this concern.


                                                     14
world face the same yield realization for each good.21 Given her crop choice, the nominal
production income farmer f receives in state s ∈ S is:
                                               G
                                              ∑ θig Aig (s) pig (s) ,
                                     f               f
                                   Yi (s) =                                                           (1)
                                              g =1

where pig (s) is the price of good g in location i in state s (which will be determined in
equilibrium below).
                                                                    f
   Preferences: Farmer f in location i receives utility Ui (s) in state s where the utility
function displays constant relative risk aversion with a risk aversion parameter ρi > 0:
                                               1  f         1− ρ i
                                 f
                              Ui (s) ≡               Zi (s)          ,                       (2)
                                            1 − ρi
                                        σ
                         1         σ −1  σ −1
         f          G    σ f
where Zi (s) ≡ ∑ g=1 α g cig (s) σ            is a constant elasticity of substitution (CES) ag-
                      f
gregate of goods, cig (s) denotes the quantity consumed of good g in state s, and α g > 0 is
a demand shifter for good g with ∑G   g=1 α g = 1.
    Consistent with Eswaran and Kotwal (1990), we interpret the risk aversion parame-
ter ρi as the “effective risk aversion” which combines both innate risk preferences of the
farmer and any access the farmer has to ex-post risk mitigating technologies (savings,
borrowing, insurance, etc.). In Appendix A.1, we micro-found this interpretation by al-
lowing farmers to purchase insurance from perfectly competitive local money-lenders.

    Trade: As in many trade models, we assume that equilibrium prices are consistent
with a large number of traders facing iceberg trade costs arbitraging prices across loca-
tions. Rather than assuming that all traders face the same costs, however, we instead
assume that traders are both heterogeneous in their trading technology and capacity con-
strained. As a result, the standard no-arbitrage equation—that the ratio of any two prices
is bounded above by the iceberg trade cost—no longer holds as many traders of various
efficiencies engage in price arbitrage. Instead, an alternative no-arbitrage equation holds,
equation (7) below, which has a convenient log-linear form and the intuitive property that
more goods flow toward destinations with higher relative prices.
    We now describe the trading process that micro-founds this key arbitrage equation.
We note that all results in the remainder of the paper hold for any micro-foundation de-
livering this arbitrage equation (for example, in Appendix A.2 we show that the arbitrage
equation can also arise from a setup where iceberg trade costs are increasing and convex

  21 An alternative (mathematically-equivalent) interpretation is that farmers face idiosyncratic risk but
engage in perfect risk sharing arrangements with other farmers in the same location as in Townsend (1994).


                                                     15
in the quantity shipped between two locations).
    Suppose every farmer wishing to sell a good is randomly matched to a “selling” trader
and every farmer wishing to buy a good is randomly matched to a “buying” trader. Con-
sider first the case of a farmer wishing to sell some quantity of good g. The “selling”
trader she is matched to pays the farmer the local market price pig (s) and then decides
whether to sell the good locally or export it. If the trader decides to sell the good locally, he
sells it for pig (s), making zero profit. If the trader decides to export the good, he sells it to
a centralized shipper for the maximum price net of the trade costs across all destinations
to which the trader could have sold. The process works in reverse for a farmer wishing to
buy some quantity of good g: she buys for the local price pig (s) from a “buying” trader
prior to which the trader decides whether to import the good or source it locally. If the
trader decides to source it locally, he pays pig (s), earning zero profit. If he decides to
import the good, the trader buys the good from the centralized shipper for the minimum
price net of the trade costs across all origins from which the trader could have bought.
    We assume the probability that a randomly matched trader is able to buy a unit of
good from i ∈ {0, ..., N } and sell it to j ∈ {0, ..., N } with a bilateral ad valorem trade cost
less than τ̄ is Pareto distributed with shape parameter ε ij ∈ (0, ∞):
                                                           ε ij
                                                          bg
                                 Pr τijg ≤ τ̄ = 1 −               .
                                                            τ̄
The greater the value of the shape parameter ε ij , the lower the bilateral trade costs (in
particular, as ε ij → 0 trade becomes infinitely costly for all traders and as ε ij → ∞ trade
becomes costless for all traders). We assume the shape parameter is bilaterally symmetric,
i.e. ε ij = ε ji . Traders’ bilateral trade costs are identical across goods and independently
distributed across destinations (e.g. a trader having a low trade cost to one destination
does not change the probability he will have a low trade cost to another destination).
The scale parameter—bg = ϕ g (s) for “selling” traders and bg = 1/ϕ g (s) for “buying”
traders—determines whether it is relatively more costly to trade when exporting or im-
porting. The good- and state-specific scaler ϕ g (s) is an endogenous object that captures
the equilibrium “market tightness” and ensures markets clear. Intuitively, if there are
more selling traders attempting to export a good than buying traders attempting to im-
port, a value of ϕ g (s) > 1 acts as a tax on selling traders and a subsidy on buying traders.
This induces more buying traders to import and marginal selling traders to sell locally,
thereby clearing the market. Finally, because traders earn arbitrage profits in this setup,
for simplicity we assume that all trading profits are redistributed back to farmers propor-
tionally to their production income, with the (endogenous) proportion denoted by ψ (s).


                                               16
    Two points about this setup are worth noting. First, while we require that farmers both
buy and sells goods through traders, because these transactions occur at the local market
price, a farmer is happy to do so. Since farmers cannot directly trade with other locations
(and trader income is redistributed proportionally to total income), farmer income de-
pends only on local equilibrium prices which greatly simplifies the determination of the
optimal crop choice.22 Second, while we require that traders sell their goods to a central-
ized shipper rather than transact directly with other locations, because these transactions
occur at the best price a trader could have received, a trader is happy to do so. (The cen-
tralized shipper is also happy with this price as the price maximizes its surplus from the
transaction.) The centralized shipper acts as a clearing house for all imports and exports
of a good, allowing us to rely on standard market clearing conditions to solve for equilib-
rium market tightness. This assumption, however, comes at a cost: as in a standard Ricar-
dian trade model with more than two locations, only total net exports for each location-
good pair are pinned down in equilibrium with bilateral trade flows indeterminate.
4.2       Trade and equilibrium prices
    We first solve for equilibrium prices in a given state of the world and a given crop
choice, i.e. holding supply constant. The CES preferences imply that in equilibrium, the
total expenditure on good g in location i at price pig (s) will be:
                                                         1− σ
                                            α g pig (s)
                         pig (s) Cig (s) =                      Y (s) ,
                                                            1− σ i
                                                                                      (3)
                                           ∑h αh ( pih (s))
                        f
where Cig (s) = Li cig (s) is the total quantity of g consumed in a location i and Yi (s) =
      f
Li Yi (s) (1 + ψ (s)) is the total income in location i. On the production side, Qig (s) =
Li θig Aig (s) is the total quantity produced of good g in location i, where we omit the “ f ”
superscript for the location-level land allocation (since farmers are homogeneous, in equi-
            f
librium θig = θig for all f ).
    We now consider how the arbitrage behavior of traders affects the relationship be-
tween production and consumption in each location. Market clearing requires that the
quantity consumed of good g in location i that is also produced in location i must be
equal to quantity produced of good g in location i that is also consumed in location i:

                   Cig (s) × Pr {sourced locally} = Qig (s) × Pr {sold locally}                  (4)

A “buying” trader chooses to source a good locally rather than import that good only
  22 This mechanism through which farmers must sell through traders mimics agricultural marketing
boards present in many developing countries, including India. The Agricultural Produce Marketing Com-
mittee Act mandates that Indian farmers must sell exclusively through government-authorized traders.


                                                 17
if the local price is at least as low as any other location’s price inclusive of trade costs.
Because there are a continuum of farmers each randomly matched to a trader, the law
of large numbers implies that the fraction of consumption of good g in location i that is
sourced locally is equal to the probability that a “buying” trader’s trade costs are such
that sourcing locally is cheapest:
                                                                   
            Pr {sourced locally} = Pr pig (s) ≤ min τji p jg (s)
                                                         j∈{0,...,N }
                                                                   !ε ji !1{ p jg (s)≤ pig (s) ϕg (s)}
                                                 p jg (s) 1
                                     =∏                                                                  ,   (5)
                                        j 6 =i
                                                 pig (s) ϕ g (s)

where 1 {·} is an indicator function and the second line imposes the Pareto distribution
and the assumption that the realization of trade costs are independent across origins.
     Similarly, a “selling” trader chooses to sell a good locally rather than exporting it only
if the local price is at least as high as any destination price net of trade costs. Again invok-
ing the law of large numbers, the fraction of the production of good g in location i that is
sold locally is equal to the probability that the trade costs are such that selling locally is
most profitable:
                                             (                                 )
                                                                      p jg (s)
               Pr {sold locally} = Pr pig (s) ≥ max
                                                        j∈{0,...,N }     τij
                                                                 !ε ij !1{ pig (s) ϕg (s)≤ p jg (s)}
                                               pig (s)
                                   =∏                   ϕ g (s)                                      . (6)
                                      j 6 =i
                                               p jg (s)

Together, equations (4), (5), and (6) along with the bilateral symmetry of the shape param-
eter ε ij provide the following no-arbitrage condition where the ratio of local consumption
and production is the product of the ratio of the local price to prices elsewhere:
                                                                  !ε ij
                               Cig (s)           pig (s)
                                       =∏                 ϕ g (s)       .                (7)
                               Qig (s)    j 6 =i
                                                 p jg (s)

Intuitively, equation (7) states that the higher the price of a good in a location relative to
all other locations, the more of the good will flow into the location relative to how much
flows out (i.e. the location will consume more of a good relative to how much it pro-
duces). As mentioned above, all the results that follow are consistent with any alternative
setup delivering the no-arbitrage equation (7).
    Substituting the demand equation (3) into equation (7) and solving the log-linear sys-




                                                   18
tem of equations, we obtain the following expression for equilibrium prices:
                                                                     ! Tij
                                      1 N    D    ( s )
                                                j
                         pig (s) = α gσ ∏                       −
                                                         ϕ g (s) jε̄
                                                                           ,                             (8)
                                        j =1
                                             Q jg  ( s )
                         Yi (s)
where Di (s) ≡                       1− σ   is equilibrium aggregate demand and ε̄ i ≡ ∑ j6=i ε ij . The ex-
                  ∑h αh ( pih (s))
ponent Tij comes from the matrix T ≡ E−1 , where E is the N × N matrix with Eij = −ε ij
for i 6= j and Eii = σ + ε̄ i for all i ∈ {1, ..., N }. Equation (8) implies that the partial elastic-
ity of the price of g in location i to the quantity produced in location j is Tij (conditional
on D j (s) and market tightness ϕ g (s)), i.e.:
                                                     ∂ ln pig (s)
                                                 −                 = Tij .
                                                     ∂ ln Q jg (s)
Intuitively, how responsive the price in one location is to a productivity shock in another
location depends not only on the trade costs between those two locations, but on the full
geography of the system.
    There are two notable properties of the price elasticities. First, because E is diagonally
dominant with strictly positive elements on the diagonal and strictly negative elements
off the diagonal, it is an M-matrix. This implies its inverse T exists and is itself strictly
positive (see conditions F13 and N39 of Plemmons (1977)). As a result, a positive pro-
ductivity shock in any location will (weakly) decrease the equilibrium prices in all other
locations. Second, because ∑ N   j=1 Eij = σ, the sum of the elasticity of a price in location i
to all production shocks throughout the world is constant and equal to the inverse of the
elasticity of substitution: ∑ N          1
                              j=1 Tij = σ . In autarky (when ε ij = 0 for all j 6 = i), the elasticity
of the local price to local production shocks is σ1 and not responsive to production shocks
elsewhere. With free trade (as ε ij → ∞ for all j 6= i), the elasticity of the price in location i
                                                                                                  1
is equally responsive to production shocks throughout the world (with an elasticity σN               ).
More generally, as trade costs fall, local prices become less responsive to local production
shocks and more responsive to production shocks elsewhere (closely related to Stylized
Fact 2 and a prediction we will formalize in Section 4.5).
    Finally, given the vector of quantities produced of each good in each location in state
s, the equilibrium profits of traders rebated through ψ (s) and market tightness ϕ g (s) are




                                                            19
determined in general equilibrium by the aggregate goods market clearing condition:
                                           N                N
                                          ∑ Cig (s) = ∑ Qig (s)              ∀ g ∈ {1, ..., G } ⇐⇒
                                          i =1             i =1

                     −σ ∑ N
                          j=1 Tij ε̄ j
                                                                          ∑iN=1 Qig (s)
           ϕ g (s)                       (1 + ψ (s)) =                               σTij          ∀ g ∈ {1, ..., G } ,    (9)
                                                           ∑iN=1         N
                                                                       ∏ j=1 Q jg (s)         D̃i (s)

                                    1    ∑N  T ε̄ 
                                          j=1 ij j                       − Tij
                                                                               
                              ∑h αhσ ϕh         ∏N  j =1  ( Q jh ( s ) )         Qih (s)                                   
where: D̃i (s) ≡                           N
                                 1 (1−σ) ∑ j=1 Tij ε̄ j
                                                                                         . The market tightness parameters   ϕg   (s)
                                                                                Tij σ−1
                                                                                  
                                                            N
                             ∑h αh ϕh
                                 σ
                                                          ∏ j=1 ( Q jh (s))
ensure that the ratio of the total quantity produced of each good to the total quantity con-
sumed by farmers in the absence of transfers from traders is equal across all goods; the
equilibrium profits of traders rebated through ψ (s) then scale consumption upward so
that total consumption equals total production.
4.3    Optimal crop choice: no volatility
    We now characterize farmers’ optimal crop choice. Prior to discussing the general case
where productivity is stochastic, it is informative to consider the case where productivity
is constant.
    In the absence of uncertainty, the return to the farmer per unit of land (i.e. her factor
price) must be equalized across all goods she produces:23

                                                      pig Aig = ri ∀ g ∈ {1, ..., G } ,                                      (10)

for some ri > 0. Taking logs and substituting in equation (8) for the equilibrium price and
recalling that Qig = Li θig Aig yields:
                                                               !
                                   N           Dj
                     1
                        ln α g + ∑ Tij ln
                                                          ε̄ j
                                                        ϕ g + ln Aig = ln ri
                     σ           j =1
                                          θ jg A jg L j

for some ln ri ∈ R. Solving this system of equations across all locations simultaneously
and applying the land constraint ∑G g=1 θig = 1 yields:
                                                              A ε ij
                                          −ε̄ σ−1               ig
                                    α g ϕ g i Aig      ∏ j6=i A jg
                          θig =                                  ε ij             (11)
                                  G           −ε̄ i σ−1            Aih
                                ∑ h =1 h h
                                        α  ϕ       A ih ∏ j6=i A jh

(see Appendix A.3.1 for the complete derivation). Equation (11) provides an analytical
characterization of the equilibrium pattern of specialization in a Ricardian trade model

   23 It
       is straightforward to show that all goods will be produced in all locations in equilibrium as equation
(8) implies that the price of a good will go to infinity as the land allocated to that good goes to zero.


                                                                        20
with many countries separated by arbitrary trade costs who trade a finite number of ho-
mogeneous goods.24 All else equal, a country will specialize more in the production of
good g the greater its own demand for that good (the α g term), the greater its productivity
                                                    σ −1
of that good as long as goods are substitutes (the Aig   term), the lower the relative market
                                   −ε̄
tightness for “selling” (the ϕ g i term), and the greater its comparative advantage in that
                            ε
good (the ∏ j6=i Aig /A jg ij term), all relative to those same terms for all other goods. The
greater the Pareto shape parameter ε ij governing the distribution of bilateral trade costs
between i and j (i.e. the lower the bilateral trade costs), the more the relative productivity
of i and j matters for i’s specialization.
    What about the gains from trade? Given that returns to production are equalized
across all goods, the utility of farmers can be written as:
                                                     ! 1              1− ρ i
                                           G            σ −1
                                 1 
                                          ∑ αg Aigσ−1
                          f
                       Ui =                                  (1 + ψ )         .
                               1 − ρi    g =1

In the absence of volatility, the utility of farmers only depends on trade through the redis-
tributed trader profits (the 1 + ψ term). As in a standard Ricardian model, opening up to
trade increases the returns to goods that a location has a comparative advantage in, caus-
ing farmers to reallocate resources to the production of those crops. Unlike a standard Ri-
cardian trade model, as land is reallocated toward the comparative advantage crops, the
local price falls. Intuitively, if local prices were to remain constant, there would be more
“selling” traders with high trade costs wanting to sell to the local market than “buying”
traders willing to source from them. The fall in the local price returns the market to equi-
librium by increasing local demand from farmers, by inducing more “buyer” traders to
source locally, and by inducing more “selling” traders to export. For farmers to be willing
to produce all crops, they reallocate toward their comparative advantage crops only up
to the point that their returns per unit land are equalized across crops. Hence, trade does
not affect the relative prices farmers face nor the real income they earn from selling their
crops, so welfare is only affected through the gains from specialization captured by trader
profits and rebated to farmers.


   24 Typicallyin quantitative many-location general equilibrium trade models, the equilibrium patterns of
specialization do not admit analytical characterization. For example, in extensions of the Eaton and Kortum
(2002) to multiple goods, each of which is a composite of a continuum of varieties, (see e.g. Donaldson
(forthcoming), Costinot, Donaldson, and Komunjer (2012), and Costinot and Rodriguez-Clare (2013)), the
amount of a factor of production allocated to the production of each good can only be determined by
solving a nonlinear system of equations. The setup here delivers a tractable expression for the equilibrium
pattern of specialization because the elasticity of local prices to the quantity produced in all locations is
constant and depends only on the matrix of trade costs E.


                                                     21
4.4   Optimal crop choice: with volatility
    We now turn to the general case where productivity is subject to shocks (e.g. rain-
fall realizations) which occur after the land allocation decision has been made (e.g. after
planting). With volatility, farmers allocate land to maximize their expected utility. We
first characterize the mapping from the distribution of productivities across states of the
world to the distribution of farmer welfare across states of the world. We then character-
ize the optimal crop choice of a farmer maximizing her expected utility taking prices and
the crop choice of other farmers as given. Finally, we derive an analytical expression for
the equilibrium crop choice, which is a generalization of equation (11) above.
    By substituting the equilibrium price in equation (8) into the indirect utility function
implied by the preferences in equation (2), we can write the real returns of farmer f lo-
cated in location i in state of the world s as:
                                             f σ1                                                 −ε̄ j − Tij
                                                                                                      
                                       G                       N
              f
                     ( 1 + ψ ( s )) ∑      θ
                                       g=1 ig α g A ig ( s ) ∏ j =1   θ jg A  jg  ( s ) ϕ g ( s )
            Zi (s) =                                                                                          . (12)
                         
                                     1
                                                                               Tij (σ−1)  1−1 σ
                                                                          −ε̄ j
                           ∑Gg =1 α g
                                     σ
                                          ∏Nj=1 θ jg A jg ( s ) ϕ g ( s )

Under the following assumption, we can characterize the (endogenous) joint distribu-
tion of real returns across all crops in terms of the (exogenous) joint distribution of yields
across all crops and all locations.

Assumption 1 (Log normal distribution of yields). Assume that the joint distributions of
yields across goods are log normal within any location i and are independently distributed
                                                                                           across
                                                                                                 
locations. In particular, define Ai (s) as the G × 1 vector of Aig (s). Then ln Ai ∼ N µ , Σ A,i
                                                                                        A,i

for all i ∈ {1, ..., N }.25

    By applying two commonly used approximations—namely a log-linearization of loca-
tion prices around mean (log) productivity and a second-order approximation implying
that the sum of log normal variables is itself approximately log normal (see, e.g. Campbell
and Viceira (2002))26 —we can show that farmer utility is (approximately) log normally
distributed. We summarize this result in the following proposition:



   25 We note that the assumption that the distributions of yields are independent across locations is not

crucial for the results that follow but we make it in order to substantially simplify the notation.
   26 Campbell and Viceira (2002) use a second order approximation around zero returns, which is valid for

assets over a short period of time. Because our time period is a year, we instead approximate around the
mean log returns. This comes at a slight cost to tractability, but substantially improves the approximation—
in Monte Carlo simulations, we find the approximated expected utility is highly correlated (correlations
greater than 0.95) with the actual expected utility.


                                                        22
Proposition 1. The distribution of the real returns of farmer f in location i is approximately
log-normal, i.e.:                                      
                                       f
                                  ln Zi ∼ N µiZ , σi2,Z ,

where µiZ and σi2,Z are defined in Appendix A.4.

Proof. See Appendix A.4.
                                                                                    f
    Because Proposition (1) shows the log real returns Zi (s) are (approximately) log nor-
mally distributed, the expected utility of a farmer takes the following convenient form:
                                                                        1− ρ i
                       h i
                             f       1            Z    1           2,Z
                     E Ui =                exp µi + (1 − ρi ) σi                 .         (13)
                                   1 − ρi              2
           h i                          
              f                Z   1 2,Z
Because E Zi = exp µi + 2 σi               , equation (13) implies that farmer f trades off the
(log of the) mean of her real income with the variance of her (log) real income, with the
exact trade-off governed by the degree of risk aversion ρi . As a result, a farmer’s optimal
crop choice solves the following maximization problem:

                                 Z    1  2,Z       2,Z
                                                        
                                                                      f
                       maxo µi +          σi − ρi σi      s.t. ΣG
                                                                g=1 θig = 1.               (14)
                       n
                         θ
                           f          2
                                      ig


Substituting the expressions for µiZ and σi2,Z from Proposition 1 implies the following first
order conditions for all g ∈ {1, ..., G }:
                                                                   G
                                                                  ∑ θih Σz,i
                                                                            f
                                                    µz,i
                                                     g     − ρi          gh = λi ,                                        (15)
                                                                  h =1

where µz,i                                                                                 z,i
         g is the marginal contribution of crop g to the log of the mean real returns, Σ gh is
the variance-covariance matrix of real returns per unit land across crops,27 and λi is the
                                               f
Lagrange multiplier on the constraint ∑G g=1 θig = 1. Equation (15)—which is the general-
ization of the indifference condition (10) to accommodate volatility—is intuitive: a good
                                                                                              f
with a higher marginal contribution to the variance of real returns (i.e. a high ∑h=1 Σz,i
                                                                                       gh θih ),
must have higher marginal contribution to the mean real returns (i.e. a high µz,ig ) to com-
pensate for the additional risk.
   It is important to note that the equilibrium real returns for any farmer depend on the
crop choice of all other farmers since the crop choices of other farmers affect equilibrium
prices (see equation (37) in Appendix A.4). Just as in the deterministic case, we solve for
                                             n   o
                                       exp µ x,i
                                               g                               f
                                                                                                
   27 In   particular,   µz,i
                          g     ≡          f
                                                 n
                                                   x,i
                                                       o   + 12 Σ x,i
                                                                  gg  − ∑ G
                                                                             θ
                                                                          h=1 ih   Σ x,i
                                                                                     gh  − Σ z,i
                                                                                             gh , where the definitions for the
                                    ∑G
                                     g=1 θig exp µ g

vector µ x,i and variance-covariance matrices Σ x,i and Σz,i are presented in Appendix A.4.


                                                                       23
the equilibrium crop choice across all locations simultaneously by combining the farmer’s
first order conditions with the expression for log nominal revenue per crop and solve the
resulting log-linear system of equations (see Appendix A.3.2 for the full derivation). This
yields the following generalization of equation (11) to incorporate production volatility:
                                                                         !ε ij
                                             −1                   big
                                                  ϕ̄ g big ∏
                                         A,i         −ε̄ i σ
                         θig ∝ α g exp µ g                                     ,       (16)
                                                             j 6 =i
                                                                    b jg

                                     exp(µ gA,i )
where big ≡                                                             is the risk adjusted productivity of farm-
              λi − 12 Σ x,i    G         x,i    z,i       G         z,i
                        gg − ∑ h=1 θih Σ gh − Σ gh − ρi ∑ h=1 θih Σ gh

ers in location i producing crop g and the scale is determined by the constraint ∑G g=1 θig =
1. In the absence of volatility, patterns of specialization were determined by the rela-
tive productivity of different locations. With volatility, risk adjusted productivity defines
comparative advantage and determines the patterns of specialization; i.e. farmers trade
off traditional “first moment” benefits from specializing in crops with higher mean yields
against “second moment” benefits of specializing in less risky crops. As in the absence of
volatility, trade costs determine the weight that each location places on its comparative
advantage relative to each trading partner.
4.5   Qualitative implications
Explaining the stylized facts
   We now show that the model developed above is consistent with the stylized facts
presented in Section 3. We summarize the results in the following proposition.

Proposition 2. Suppose that the Pareto distribution of trade costs can be written as ε ij (t) = ε ij t,
where t ≥ 0 captures the overall level of openness of the world and an increase in t indicates a
fall in trade costs, and suppose that there are a large number of locations (so that the equilibrium
market tightness is constant across states of the world). Then:
     (1) [Stylized Fact 1] Moving from autarky to costly trade increases the volatility of nominal in-
                                                                       2 and σ2 to be the variance
come and decreases the volatility of prices. More precisely, defining σi,Y      i,P
                                                                                                      f
of the log of the numerator and the denominator, respectively, of the real returns Zi (s):
                                         2
                                       dσi,Y                         2
                                                                   dσi,P
                                               |t=0 > 0 and                 |t=0 < 0.
                                         dt                          dt
    (2) [Stylized Fact 2] Any increase in openness decreases the responsiveness of local prices to
local yield shocks:                                     !
                                    d      ∂ ln pig (s)
                                         −                < 0.
                                   dt      ∂ ln Aig (s)


                                                              24
    (3) [Stylized Fact 3] Any increase in openness causes farmers to reallocate production toward
crops with higher mean yields. Moreover, as long as farmers are sufficiently risk averse (i.e. ρi
is sufficiently large and positive), goods are substitutes (i.e. σ ≥ 1), and local prices are not too
responsive to local productivity shocks (i.e. (1 − Tii ) θig ≥ Tii α g ), then any increase in openness
causes farmers to reallocate production toward crops with less volatile yields, with the latter effect
attenuated the greater the access to insurance (i.e. the lower ρi ). Formally, for any two crops g 6= h:

                                                                         d ∂2 ln θig − ln θih
                                                                                            
     d ∂ ln θig − ln θih          d ∂ ln θig − ln θih
                  A
                           > 0,               A,i
                                                         ≤ 0, and −                 A,i
                                                                                                ≥ 0.
    dt         ∂µig              dt       ∂Σ gg                          dt     ∂Σ gg   ∂ρi

Proof. See Appendix A.5.

    Intuitively, as trade costs fall (for example, through the expansion of the highway net-
work), more traders engage in arbitrage across locations which brings the negative corre-
lation between local prices and local yields closer to zero—consistent with Stylized Fact
2. While in autarky, farmer’s nominal income is partially insured by this negative corre-
lation (since prices are high when yields are low). Because prices become less responsive
to local yield shocks, farmers face more volatile nominal incomes as trade costs fall; con-
versely, because prices become more stable, the volatility of the price index decreases—
consistent with Stylized Fact 1. Finally, consistent with Stylized Fact 3, farmers react to
the change in their mean-variance frontier induced by lower trade costs. They balance
traditional “first moment” gains from specialization by moving into crops with higher
average means against “second moment” efforts to reduce the increased risk they now
face by moving into crops with less volatile yields, with the trade-off governed by their
level of risk aversion.
Volatility and the gains from trade
   We now turn to the welfare implications of the model. We summarize the relationship
between welfare, trade costs and volatility in the following proposition:

Proposition 3. 1) Moving from autarky to costly trade (weakly) improves farmer welfare, i.e.
the gains from trade are positive. 2) Increasing the volatility of productivity (keeping constant the
average productivity) may amplify or attenuate the gains from trade.

    Part (1) of Proposition 3 arises from the standard revealed preference argument for
why trade is welfare improving (see, e.g. Dixit and Norman (1980)). Because all farmers
in a location are identical, in autarky, each consumes what she produces in all states of the
world. With trade, a farmer always has the option to make the same planting decisions;
moreover, because the farmer both buys and sells to traders at the local price, she always


                                                  25
has the option to consume what she produces. Hence, in all states of the world, a farmer
can always achieve the same level of utility as in autarky, so that across all states of the
world, her expected utility must with trade must be at least as great as in autarky.28
    Part (2) of Proposition 3 can be illustrated with two simple examples (illustrated in
Table A.2 of the Appendix). We first show how volatility can amplify the gains from
trade. Consider a world of two locations and two crops. Suppose that farmers have
Cobb-Douglas preferences over the two goods with equal expenditure shares. Suppose
too that the average productivity of each good in each district is the same. Because the
two locations are identical, in the absence of volatility there are no gains from trade. Now
suppose that the production of good A in location 1 is risky. This volatility amplifies both
the first and second moment gains from trade. The first moment gains are amplified as
differences in the relative productivities in the two countries generate gains from trade,
even if the average productivities in the two countries are identical. The second moment
gains are also amplified. In autarky, farmers in location 1 will allocate an equal amount of
land to the production of both crops even though good A is risky as the unit price elastic-
ity implies that the volatility farmers face is aggregate price index risk. With trade, how-
ever, the local price in location 1 no longer responds one-for-one to the local productivity
shock. This allows farmers in location 1 to reduce the risk they face by reallocating pro-
duction toward good B. Farmers in location 2 benefit by reallocating production toward
good A, which now has a higher relative price. Intuitively, by decoupling production and
consumption decisions, trade converts the aggregate price index risk farmers would face
in autarky into idiosyncratic crop specific risk, allowing farmers allocate their crops in
such a way so as to reduce their risk exposure.
    Volatility can also attenuate the gains from trade. As above, consider a world of two lo-
cation and two crops, where farmers have Cobb-Douglas preferences over the two goods
with equal expenditure shares. Suppose that location 1 has a comparative and absolute
advantage in good A and location 2 has a comparative and absolute advantage in good
B. In the absence of volatility, there are gains from trade through specialization. Now
suppose that the production of good A in location 1 is risky and the production of good
B in location 2 is risky. In autarky, farmers in both locations will allocate an equal amount
of land to the production of both goods. With trade, however, if farmers are sufficiently
risk averse, they will not specialize in the production of the risky crops despite their re-
spective comparative advantages. Here, second moment concerns lead farmers to forgoe

  28 This is in contrast to Newbery and Stiglitz (1984), where trade can make agents worse off in the
presence of volatility. In that paper, agents are not permitted to consume what they produce; as a result,
the autarkic consumption bundle is not necessarily always available to agents.


                                                   26
the first moment gains from specialization, attenuating the total gains from trade.

5     Quantifying the welfare effects of trade and volatility
   We now bring the model developed above to the data on rural India to quantify the
welfare effects of trade in the presence of volatility. We first estimate the preference pa-
rameters using household survey data. We then show that the model yields structural
equations that allow us to easily estimate key model parameters, namely the trade open-
ness and effective risk aversion of each district (the locations in the empirical work). Fi-
nally, we use the estimates to quantify the welfare effects of trade and volatility for India.
5.1   Estimation
    In order to quantify the welfare effects of volatility, we need to know the full set of
                                                             
structural parameters, namely: the preference parameters α g and σ, the matrix of shape
             
parameters ε ij i6= j governing trade costs, the effective risk aversion ρi in each district,
and the mean and variance-covariance matrix µ A,i and Σ A,i for the yields of all goods
produced (net of production costs). We discuss how we estimate each of these in turn.
Estimating the preference parameters from variation in budget shares and prices
                                              
   We can recover the preference parameters α g and elasticity of substitution σ by es-
timating the CES demand function implied by equation (2):
                             
                   ln Cig /Yi = (1 − σ ) ln pig − (1 − σ) ln Pi + ln α g           (17)
                                1
where Pi = (∑ g α g ( pig )1−σ ) 1−σ . We regress log budget shares on the district-level me-
dian price-per-calorie using the detailed household-level consumption surveys from the
1987-88 NSS described in Section 2.2. The elasticity is recovered from the coefficient on
local prices, the price index term is accounted for by the district fixed effects, and the pref-
erence parameters are recovered from the coefficient on the good fixed effects. As local
prices may be endogenous to local demand shocks, we instrument for prices with the log
median price-per-calorie in neighboring districts (with the identifying assumption being
that supply shocks are spatially correlated but that demand shocks are not).
   Table 4 presents the estimated demand parameters using the methodology described
above. The implied elasticity of substitution is 2.4 using our preferred IV specification.
Estimating trade openness from observed relationship between local prices and yields
    From equation (8), the observed local price in any district is a log linear combination
of yields across all districts, where the elasticities depend on the distribution of bilateral
trade costs. If we assume that crop choice is constant within a decade d and each year


                                              27
within a decade is a different state of the world, we obtain the following regression for-
mulation of equation (8):
                                            N
                         ln pigtd = − ∑ Tijd ln A jgtd + δitd + δigd + δgtd + vigtd ,                                   (18)
                                           j =1

where δitd is a district-year fixed effect capturing the weighted aggregate destination de-
mand, δigd is a district-good-decade fixed effect capturing the weighted destination de-
mand relative to supply, δgtd is a good-year fixed effect capturing the average effect of
market tightness on prices, and vigtd is a residual capturing the district deviations in the
effect of market tightness.29 While equation (18) follows directly from the structural equa-
tion (8), it also has an intuitive interpretation: conditional on the appropriate set of fixed
effects, districts are more open to trade the less responsive their local prices are to local
yield shocks and the more responsive they are to yields shocks elsewhere.
                                         
    While in principle the elasticities Tijd can be estimated non-parametrically if there
are a large number of time periods and goods relative to the number of districts, this is
not the case in our empirical context. To proceed, we instead assume that the bilateral
Pareto shape parameters are inversely related to travel times:
                                                                   −φ
                                                      ε ijd = βDijd ,                                                   (19)

where we use the same φs and travel time specifications as used in Section 3. Because E is
an M-matrix, we can write its inverse T as an infinite geometric sum (see Appendix A.6
for further details). Approximating T by the first two elements of this series and applying
the parametric assumption in equation (19), we can rewrite equation (18) as:
                                                         !
                                             −φ  A  jgtd
         ln pigtd = −γ1 ln Aigtd − γ2 ∑ Dijd ln            + δitd + δigd + δgtd + $igtd , (20)
                                      j 6 =i
                                                  Aigtd

where γ1 ≡ κ12 (2κ − σ ), γ2 ≡ κ2 for some κ > 0, and the residual $igtd includes the higher
                                           β

order terms from the infinite series expansion of T.
             −φ
   Given Dijd , the coefficients γ1 and γ2 can be identified using ordinary least squares as
long as yields are uncorrelated with the residual (as is the case in our framework where
yields are idiosyncratic); as before, since farmers may invest disproportionately more care
harvesting crops that have high prices, we construct instruments for the two yield terms
                                                                                 
   29 More      precisely, vigtd ≡ ∑ N     j =1 Tij ε̄ j − 1
                                                           N ∑ N
                                                                   ∑ N
                                                               j =1 k =1 Tjk ε̄ k   ln ϕ gt . If all districts shared the same
total level of openness (i.e. ε̄ i ≡ ∑ j6=i ε ij = ε̄ for all i), then the residual would be equal to zero since
∑N                      ε̄
  j=1 Tij ε̄ ln ϕ̄ gt = σ ln ϕ̄ gt would be absorbed by the good-year fixed effect. Hence the residual ε igt captures
only deviations of the elasticity weighted average of the total openness of a district’s trading partners from
the average.


                                                             28
using predicted yields constructed from rainfall shocks in an analogous manner to the
procedure outlined in Stylized Fact 2.30 Given the previous estimate of σ, these two pa-
rameters allow us to recover β and κ, and ultimately the bilateral shape parameter ε ijd ,
using equation (19).
    Table 5 reports the results of regression (20). As can be seen, prices are lower when
both own yields and the distance-weighted sum of other districts’ yields are higher. The
γ1 and γ2 coefficients are both negative and statistically significant regardless of whether
we use actual yields or instrument yields with rainfall-predicted yields, and regardless
of our choice of φ (either φ = 1 or φ = 1.5) or our estimate of the off-highway speed
of travel (1/3 or 1/4 of that on the highway). In our preferred IV specification (Column
2), the estimates imply that the average Pareto shape parameter between districts in 1970
was 0.06, rising to 0.09 by 2000. Intuitively, these high estimated trade costs are necessary
to explain why local prices remain more responsive to local yield shocks than yield shocks
in other districts despite there being more than 300 districts (given our assumption that
traders receive independent draws for each district).
Estimating risk aversion and costs of cultivation from the observed distribution of
yields and allocation decisions
    From Section 4.4, farmers choose a land allocation along the frontier of the (log) mean
real returns and the variance of (log) real returns, with the gradient of the frontier at the
chosen allocation equal to their effective risk-aversion parameter ρi . This implies that any
produced good that has higher mean real returns must also contribute a greater amount
to the variance of the real returns, as if this were not the case the farmer should have allo-
cated more land to that good, lowering its mean return. This relationship is summarized
in the farmer’s first order conditions from equation (15), which we re-write here:
                                                      G
                                       µz,i
                                        g     = ρi   ∑ θih Σz,i
                                                            gh + λi .                                  (21)
                                                     h =1

Equation (21) forms the basis of our estimation of both effective risk-aversion and the
costs of cultivation. Note that if we observed the distribution of real returns and the
variance-covariance matrix of real returns, we could directly regress the former on the
latter with a district-decade fixed effect in order to recover ρi . However, instead we ob-
serve the prices, yields and area allocated to each good in each year and each district
from the VDSA data which has two limitations: first, we can only calculate nominal rev-

  30 To  match the fixed effects in equation (20), we predict yields from a regression of log yield on local
rainfall shocks for each month interacted with state-crop fixed effects and controlling for district-year,
crop-district-decade and crop-year fixed effects.


                                                       29
enues not the real returns; second, these revenues are gross rather than net of costs. To
address the first problem, we note that given the distribution of trade costs estimated in
the previous subsection, we can use Proposition 1 to transform the mean covariance of
the (observed) nominal gross yields into the mean and covariance of real returns.31 To
address the second problem, we assume that each good within a district-decade has an
unobserved crop cost κigd that is constant across states of the world and log additive (so
that it enters linearly into the first order conditions). As a result, we can re-write equation
(21) solely as a function of observables (with d denoting decade-level variables):
                                        G
                           µz,id
                            g = ρid     ∑ θihd Σz,id
                                                gh + δid + δig + δgd + ζ igd ,                         (22)
                                       h =1

where δid ≡ λid is the Lagrange multiplier and the unobserved crop cost κigd is assumed
to be a combination of a district-good fixed effect δig , a crop-decade fixed effect δgd , and an
idiosyncratic district-good-decade term ζ igd . Note that given these estimated crop costs
(along with the other estimated structural parameters), the farmer’s first order conditions
will hold with equality at their observed land allocation. In other words, we calibrate the
unobserved crop costs so that farmers in all districts and all decades are producing at the
optimal point along the mean-variance frontier.32
    Equation (22) follows directly from the structural equation (21) but has a straightfor-
ward interpretation: at the optimal allocation, crops that have higher mean returns must
also have higher (marginal contributions to overall) volatility. The more risk the farmer is
willing to accept in order to increase her mean returns, the less risk averse she is (and/or
the better access to insurance she has).
    Under the assumptions about crop costs above, ρid can be estimated using equation
(22) via ordinary least squares. Table 6 reports the estimated ρid from this regression,
assuming it is common across districts and decades.33 Column 1 finds that there is a
strong positive relationship between the mean real returns and the marginal contribution
to the variance of real returns, with an effective risk-aversion parameter of roughly one.

  31 To   calculate the mean and variance-covariance matrix of yields, we aggregate across years within
district-decade, implicitly assuming that land allocations are constant within decade. Therefore, in what
follows we also construct the land allocation within a district-decade by averaging across years.
   32 Because of the presence of the Lagrange multiplier, crop costs are only identified up to scale. In the

results that follow, we normalize the cost of cultivation for one crop to zero; this normalization does not
affect the estimated change in welfare.
   33 In some districts, the VDSA records very small numbers for sparsely planted crops. In other districts,

no number is recorded. As these differences are likely measurement error, and additive measurement error
biases upward the variance of log yields, we exclude from the regression any crops which are allocated
less than 0.1 percent of land area in a district-decade; including these crops reduces the magnitude of the
estimated coefficients but does not change the qualitative results.


                                                    30
This estimate is consistent with previous estimates of risk aversion of Indian farmers (e.g.
Rosenzweig and Wolpin (1993)). To correct for (classical) measurement error bias arising,
for example, from the fact that our variance-covariance matrix is itself an estimate, we
instrument for the the variance term with the marginal contribution to the log variance
of rainfall-predicted yields.34 Column 2 shows these IV results, with the point estimates
increasing slightly consistent with measurement error creating a downward bias.
    As noted previously, the effective risk aversion parameter, ρid , captures both the inher-
ent risk aversion of farmers and their access to risk-mitigating technologies. To capture
this, we assume the inherent risk aversion is constant across districts and decades and the
risk-mitigation is a function of bank access bank id (measured as rural banks per capita):

                                          ρid = ρ A bank id + ρ B ,

so that equation (22) becomes:
                                   G                       G
            µz,id A
             g = ρ bank id ×       ∑      d z,id
                                         θih Σ gh + ρ B   ∑ θihd Σz,id
                                                                  gh + δid + δig + δgd + νigd .      (23)
                                  h =1                    h =1

If insurance improves with bank access, we expect ρ A < 0.
    Columns 3 and 4 of Table 6 provide support for this hypothesis and shows that dis-
tricts with greater access to banks had a less positive relationship between the mean real
returns and the marginal contribution to the variance of real returns, consistent with bank
access improving farmer insurance and leading them to act in a manner that appears less
risk averse (with the IV results in Column 4 the preferred estimate we use in the quantifi-
cation). Reassuringly, the combination of the fixed effects and ‘residual from regression
(23)—which we interpret as unobserved crop costs, those that ensure the crop choice ob-
served in the data is the optimal choice in the model—positively correlate with actual
crop costs we observe at the state-level for a subset of our sample period; see Table A.3 in
the appendix for further details.
5.2   Trade, volatility and welfare
    We now use our structural estimates to quantify the welfare effects of the expansion
of the Indian highway network. To isolate the gains from trade, we hold all structural
parameters except openness (i.e. the distribution of productivities, crop costs, and bank
access) constant at the estimated level for the 1970s. We then calculate the equilibrium
crop choice, the distribution of real returns and the resulting welfare under the estimated

                                A,i 1970         A,i
  34 The  instrument is ∑h=1 Σ̂ gh θih (where Σ̂ gh  is the estimated variance-covariance matrix using ob-
                               1970
served rainfall variation and θih is the observed crop allocation in the 1970s). We use the same predicted
rainfall measure used for instrumenting the variance of yields term in Table 3.


                                                     31
distribution of bilateral trade costs in the 1980s, 1990s, and 2000s; see Appendix A.7 for
a detailed description of this counterfactual procedure. Because our parameterization
in equation (19) ensures that the estimated bilateral trade costs change over time only
through travel time reductions resulting from highway expansions, this procedure iso-
lates the welfare effects of changes to the Indian highway network.
    For each district in each decade, we calculate the (log of the arithmetic) mean real
returns, the variance of the (log) real returns, and overall welfare (which, after the appro-
priate monotonic transformation, is a linear combination of the two; see equation (13)).
We also decompose the effects of trade into the effects on the production side (the mean
and variance of farmer nominal income, and the implied welfare of a “producer” who
uses this nominal income to purchase a hypothetical numeraire good) and on the con-
sumption side (the mean and variance of the inverse of the price index, and the implied
welfare of a “consumer” who uses the income from a sale of a hypothetical numeraire
good to purchase the CES consumption bundle).
    Table 7 summarizes the changes in these objects across decades by projecting the object
of interest (e.g. the log of the mean real returns) on a set of decade dummies and district
fixed effects so that the coefficients on the dummies reveal the average change within dis-
tricts over time. To highlight the effect of the endogenous crop choice of farmers, Panel
A first considers the effects of the highway expansion holding farmer crop choice fixed
at the observed 1970s allocations. Consistent with the reduced form results of Table 1,
we find that the expansion of the highway network increases both the mean and variance
of nominal income, increases the mean of the price index, and increases the mean and
variance of real returns. Given our effective risk aversion estimates (holding bank access
at 1970s levels), highway expansions between the 1970s and 2000s increase welfare by ap-
proximately 4.9 percent; however, given that the mean real returns increase by 5.8 percent,
the increase in volatility erodes the first moment gains from trade by about 15 percent.
    Panel B of Table 7 reports the results allowing farmers to optimally reallocate their
land across crops. When farmers choose their crops optimally, the effects of highway ex-
pansion are qualitatively similar to Panel A—the mean and variance of nominal income
increase, along with the mean of the price index. By altering their crop choice, however,
we estimate that farmers were able to increase their mean real returns by nearly as much
as when crop choice was constant but without increasing the volatility of real returns at
all, i.e. farmers are able to fully hedge against the increased risk of the highway expan-
sion. This led to an increase in farmer welfare by 5.7 percent—about 15 percent more than
the gains in Panel A, highlighting the importance of accounting for the ability of farmers



                                             32
to respond to changes in the risk profile they face by altering their crop choices.35
    The average gains from trade mask substantial heterogeneity across space. Figure 3
presents a visual summary, and shows that districts with greatest increase in market ac-
cess between the 1970s and the 2000s tended to have larger gains from trade over the
period (the correlation between the two figures is 0.36).
    Table 8 explores this heterogeneity more systematically. Column 1 replicates Column
9 of Table 7 Panel B. Column 2 shows that much of the gains from trade over time can
be captured by observed improvements in market access (the coefficients on the decade
dummies fall close to zero after controlling for observed market access), suggesting that
the general equilibrium spillovers to other districts are reasonably small. Column 3 of Ta-
ble 8 shows that the relationship between market access improvements and welfare gains
is far from uniform. First, districts that were initially growing fewer crops had larger gains
from increases in market access, as reductions in trade costs allowed these districts to
more easily import crops that were very costly to grow locally. Second—and more closely
related to the second moment effects that are the focus of this paper—districts whose
high-average-yield crops in the 1970s were also low-risk crops in the 1970s (i.e. districts
where the correlation between the mean and standard deviation of log yields across crops
was negative) gained more from improvements in market access than districts whose
high-average-yield crops were also high-risk crops (i.e. districts where the correlation
was positive). This finding echoes Proposition 3 which shows that volatility can attenu-
ate the gains from trade when farmers choose not to specialize in the goods they are more
productive in to avoid the extra risk they bring—i.e. the gains from trade are the largest
when the “first moment” and “second moment” forces determining crop choice align.
    Finally, we explore how the optimal crop choice responds to the expansion of the high-
way network. Figure 4 compares the observed mean and standard deviation of log yields
in the 1970s (Panels A and B, respectively) to the model’s predicted change in the optimal
allocation of land as a result of the highway expansion (Panel C). While the highway ex-
pansion does increase the overall land allocation to cash crops like cotton, it also causes
redistribution across space in production, with Northeast India increasing production of
wheat and the South increasing production of sorghum. Consistent with the model’s pre-
diction that reductions in trade costs lead districts to specialize in their risk-adjusted com-
   35 The  structural results are qualitatively consistent with the reduced form estimates and provide
quantitatively similar estimates of the increase in nominal income: Table 1 implies that the improvement in
market access for the median district between the 1970s and2000s is associated with a 37 percent increase
in nominal income, whereas the structural results imply a 34 percent increase. However, the structural
results also estimate an increase in the price index, whereas there is no statistically significant association
between market access and the price index in the reduced form. As a result, the structural estimates for the
increase in real income are smaller than the reduced form estimates (5.7 percent versus 30 percent).


                                                      33
parative advantage crops, Panels A and B show that wheat has high-mean/low-volatility
yields in Northeast India, whereas the same is true for sorghum in the South.36
    All told, the structural estimates demonstrate that, while the expansion of the Indian
highway network would have increased the risk faced by farmers through the second mo-
ment effects of trade, farmers were able to mitigate the welfare loss from this increased
risk by altering their planting decisions.

6    Conclusion
    The goal of this paper is to examine the relationship between trade and volatility. To
do so, we first document that reductions in trade costs due to the expansion of the Indian
highway network reduced in magnitude the negative relationship between local prices
and local yields, which lead farmers to reallocate their land toward crops with higher
mean yields and lower yield volatility.
    We then present a novel Ricardian trade model that incorporates a portfolio allocation
decision drawn from the finance literature. Risk averse producers choose their optimal
allocation of resources across goods and the general equilibrium distribution of real re-
turns is determined by this allocation along with the distribution of bilateral trade costs
and yields. The model yields tractable equations governing equilibrium prices and farm-
ers’ resource allocations and generates the patterns documented in the data.
    The model provides intuitive and transparent estimating equations to identify both
the bilateral trade costs—using the relationship between local prices and yield shocks in
all locations—and farmers’ risk preferences—-using the slope of the mean-variance fron-
tier at the observed crop choices. Using these estimates, we show that while increased
trade openness would have increased the volatility faced by farmers at their current al-
locations, farmers are able to hedge this risk by changing what they produce, amplifying
the gains from trade.




    36 Moregenerally, Table A.4 shows that model-predicted changes in optimal crop choice positively
correlate with 1970s mean log yields and negatively correlate with the standard deviation of log yields.


                                                  34
References
A LLEN , T. (2014): “Information frictions in trade,” Econometrica, 82(6), 2041–2083.

A LLEN , T., AND C. A RKOLAKIS (2014): “Trade and the topography of the spatial
  economy,” The Quarterly Journal of Economics.

A STURIAS , J., M. G ARCÍA -S ANTANA , AND R. R AMOS (2014): “Competition and the wel-
  fare gains from transportation infrastructure: Evidence from the Golden Quadrilateral
  of India,” Discussion paper.

ATKIN , D. (2013): “Trade, Tastes, and Nutrition in India,” American Economic Review,
 103(5), 1629–63.

ATKIN , D., AND D. D ONALDSON (2015): “Who’s Getting Globalized? The Size and
 Implications of Intra-national Trade Costs,” Working Paper 21439, National Bureau of
 Economic Research.

B ASU , P. (2006): Improving Access to Finance for India’s Rural Poor. World Bank Publications.

B URGESS , R., AND D. D ONALDSON (2010): “Can openness mitigate the effects of weather
  shocks? Evidence from India’s famine era,” The American Economic Review, 100(2),
  449–453.

        (2012): “Can openness to trade reduce income volatility? Evidence from colonial
  India’s famine era,” Discussion paper.

B URGESS , R., AND R. PANDE (2005): “Do Rural Banks Matter? Evidence from the Indian
  Social Banking Experiment,” American Economic Review, 95(3), 780–795.

C AMPBELL , J. Y., AND L. M. V ICEIRA (2002): Strategic asset allocation: portfolio choice for
  long-term investors. Oxford University Press.

C ASELLI , F., M. K OREN , M. L ISICKY, AND S. T ENREYRO (2014): “Diversification through
  trade,” Discussion paper.

C OSTINOT, A., AND D. D ONALDSON (2011): “How Large Are the Gains from Economic
  Integration? Theory and Evidence from US Agriculture, 1880-2002,” Massachusetts
  Institute of Technology. Mimeo.

C OSTINOT, A., D. D ONALDSON , AND I. K OMUNJER (2012): “What goods do countries
  trade? A quantitative exploration of Ricardo’s ideas,” The Review of Economic Studies,
  79(2), 581–608.

C OSTINOT, A., D. D ONALDSON ,        AND   C. B. S MITH (2016): “Evolving comparative


                                              35
     advantage and the impact of climate change in agricultural markets: Evidence from
     1.7 million fields around the world,” Journal of Political Economy, 124, 205–248.

C OSTINOT, A., AND A. R ODRIGUEZ -C LARE (2013): “Trade theory with numbers: Quan-
  tifying the consequences of globalization,” Discussion Paper 18896, National Bureau
  of Economic Research.

D ATTA , S. (2012): “The impact of improved highways on Indian firms,” Journal of
  Development Economics, 99(1), 46–57.

DI    G IOVANNI , J., AND A. A. L EVCHENKO (2009): “Trade openness and volatility,” The
     Review of Economics and Statistics, 91(3), 558–585.

D ISDIER , A.-C., AND K. H EAD (2008): “The puzzling persistence of the distance effect
  on bilateral trade,” The Review of Economics and statistics, 90(1), 37–48.

D IXIT, A. (1987): “Trade and insurance with moral hazard,” Journal of International
  Economics, 23(3), 201–220.

           (1989a): “Trade and insurance with adverse selection,” The Review of Economic
     Studies, 56(2), 235–247.

            (1989b): “Trade and insurance with imperfectly observed outcomes,” The
     Quarterly Journal of Economics, 104(1), 195–203.

D IXIT, A., AND V. N ORMAN (1980): Theory of international trade: A dual, general equilibrium
  approach. Cambridge University Press.

D ONALDSON , D. (forthcoming): “Railroads of the Raj: Estimating the impact of
  transportation infrastructure,” American Economic Review.

D ONALDSON , D., AND R. H ORNBECK (forthcoming): “Railroads and American Economic
  Growth: A "Market Access" Approach,” The Quarterly Journal of Economics.

E ASTERLY, W., R. I SLAM , AND J. E. S TIGLITZ (2001): “Shaken and stirred: explaining
  growth volatility,” in Annual World Bank conference on development economics, vol. 191, p.
  211.

E ATON , J., AND G. M. G ROSSMAN (1985): “Tariffs as Insurance: Optimal Commercial
  Policy When Domestic Markets Are Incomplete,” The Canadian Journal of Economics /
  Revue canadienne d’Economique, 18(2), pp. 258–272.

E ATON , J., AND S. K ORTUM (2002): “Technology, geography, and trade,” Econometrica,
  70(5), 1741–1779.


                                             36
E SWARAN , M., AND A. K OTWAL (1990): “Implications of Credit Constraints for Risk
   Behaviour in Less Developed Economies,” Oxford Economic Papers, 42(2), 473–482.

FAFCHAMPS , M. (1992): “Cash crop production, food price volatility, and rural market
  integration in the third world,” American Journal of Agricultural Economics, 74(1), 90–99.

F ULFORD , S. L. (2013): “The effects of financial development in the short and long run:
   Theory and evidence from India,” Journal of Development Economics, 104(0), 56 – 72.

G HANI , E., A. G. G OSWAMI , AND W. R. K ERR (2016): “Highway to Success: The
  Impact of the Golden Quadrilateral Project for the Location and Performance of Indian
  Manufacturing,” The Economic Journal, 126(591), 317–357.

H EAD , K., AND T. M AYER (2014): “Gravity Equations: Workhorse, Toolkit, and
  Cookbook,” in Handbook of International Economics, vol. 4, pp. 131–195. Elsevier.

H ELPMAN , E., AND A. R AZIN (1978): A Theory of International Trade Under Uncertainty.
  Academic Press.

J AYACHANDRAN , S. (2006): “Selling labor low: Wage responses to productivity shocks in
   developing countries,” Journal of political Economy, 114(3), 538–575.

K ARABAY, B., AND J. M C L AREN (2010): “Trade, offshoring, and the invisible handshake,”
  Journal of international Economics, 82(1), 26–34.

K UROSAKI , T., AND M. FAFCHAMPS (2002): “Insurance market efficiency and crop
  choices in Pakistan,” Journal of Development Economics, 67(2), 419–453.

L EE , H. (2013): “Industrial output fluctuations in developing countries: General equi-
   librium consequences of agricultural productivity shocks,” Department of Economics,
   Purdue University, West Lafayette.

M AHUL , O., N. V ERMA , AND D. C LARKE (2012): “Improving farmers’ access to
 agricultural insurance in India,” World Bank Policy Research Working Paper, (5987).

M UNSHI , K. (2004): “Social learning in a heterogeneous population: technology diffusion
 in the Indian Green Revolution,” Journal of development Economics, 73(1), 185–213.

N EWBERY, D., AND J. S TIGLITZ (1984): “Pareto inferior trade,” The Review of Economic
  Studies, 51(1), 1–12.

P LEMMONS , R. J. (1977): “M-matrix characterizations. I—nonsingular M-matrices,”
   Linear Algebra and its Applications, 18(2), 175–188.

R OSENZWEIG , M. R.,    AND   H. P. B INSWANGER (1993): “Wealth, weather risk and the


                                            37
  composition and profitability of agricultural investments,” The Economic Journal,
  103(416), 56–78.

R OSENZWEIG , M. R., AND K. I. W OLPIN (1993): “Credit market constraints, consumption
  smoothing, and the accumulation of durable production assets in low-income coun-
  tries: Investments in bullocks in India,” Journal of Political Economy, 101(2), 223–244.

S COTT, P. T. (2013): “Dynamic discrete choice estimation of agricultural land use,”
   Tolouse School of Economics.

S ETHIAN , J. (1999): Level Set Methods and Fast Marching Methods: Evolving Interfaces in
   Computational Geometry, Fluid Mechanics, Computer Vision, and Materials Science, vol. 3.
   Cambridge University Press.

S OTELO , S. (2013): “Trade frictions and agricultural productivity: Theory and evidence
   from Peru,” Unpublished manuscript, University of Chicago.

T OWNSEND , R. M. (1994): “Risk and insurance in village India,” Econometrica, 62(3),
  539–591.

W ILLMOTT, C., AND K. M ATSUURA (2012): “Terrestrial Precipitation: 1900-2010 Grid-
 ded Monthly Time Series, Version 3.02,” Discussion paper, University of Delaware,
 http://climate.geog.udel.edu/climate/.




                                            38
                                              Table 1: R EAL I NCOME AND R OADS

      Dependent variable:                                    Components of Real Income (Logged)
                                 (1)                 (2)            (3)             (4)            (5)            (6)
                                 Mean Nominal Y      Var Nominal Y Mean P Index Var P Index        Mean Real Y    Var Real Y
      Market Access              0.549***            0.755***       0.086***        0.035          0.451***       0.211
                                 (0.084)             (0.220)        (0.016)         (0.154)        (0.086)        (0.219)
      Market Access (phi=1)      0.387***            0.590***       0.058***        -0.059         0.320***       0.237*
                                 (0.049)             (0.129)        (0.009)         (0.091)        (0.050)        (0.129)
      Market Access (alt. speed) 0.536***            0.720***       0.083***        0.035          0.440***       0.186
                                 (0.087)             (0.229)        (0.016)         (0.160)        (0.089)        (0.228)
      District FE                Yes                 Yes            Yes             Yes            Yes            Yes
      Decade FE                  Yes                 Yes            Yes             Yes            Yes            Yes
      Observations               1208                1208           1208            1208           1208           1208

      Dependent variable:                    Components of Real Income (Logged, 1970s Crop Allocations)
                                 (7)            (8)              (9)           (10)         (11)                  (12)




39
                                 Mean Nominal Y Var Nominal Y Mean P Index Var P Index Mean Real Y                Var Real Y
      Market Access              0.481***       0.888***         0.086***      0.035        0.383***              0.303
                                 (0.076)        (0.212)          (0.016)       (0.154)      (0.078)               (0.213)
      Market Access (phi=1)      0.336***       0.579***         0.058***      -0.059       0.269***              0.214*
                                 (0.044)        (0.125)          (0.009)       (0.091)      (0.046)               (0.126)
      Market Access (alt. speed) 0.466***       0.821***         0.083***      0.035        0.370***              0.254
                                 (0.079)        (0.220)          (0.016)       (0.160)      (0.082)               (0.221)
      District FE                Yes            Yes              Yes           Yes          Yes                   Yes
      Decade FE                  Yes            Yes              Yes           Yes          Yes                   Yes
      Observations               1208           1208             1208          1208         1208                  1208
     Notes: Each entry corresponds to the coefficient on market access from a separate regression of a component of the
     mean and variance of real income regressed on alternative measures of market access. All regressions also include
     district and decade fixed effects. Coefficients multiplied by 100,000 for readability. Nominal income is calculated
     as agricultural revenue per hectare over the 15 sample crops. In Panel A, actual crop allocations, prices and yields
     are used for this calculation. In Panel B, actual yields and prices are used along with the average crop allocations in
     the 1970s. Price index is a CES price index of the same 15 crops using the CES parameters shown in Table 4. Each
     observation in each regression is at the district-decade level. Stars indicate statistical significance: * p<.10 ** p<.05
     *** p<.01.
                                           Table 2: P RICE -Y IELD E LASTICITIES AND R OADS

      Dependent variable:                                                                      Log Price
                                                          (1)         (2)       (3)         (4)       (5)        (6)        (7)       (8)
                                                          OLS         IV        RF          RF        RF         RF         RF        RF
      Log(Yield)                                          -0.056***   -0.158***
                                                          (0.004)     (0.008)
      Log(Yield)XMarket Access                            0.027***    0.101***
                                                          (0.005)     (0.012)
      Log(Predicted Yield)                                                      -0.166***
                                                                                (0.008)
      Log(Predicted Yield)XMarket Access                                        0.107*** 0.100*** 0.092***       0.085***
                                                                                (0.011)   (0.013) (0.018)        (0.032)
      Log(Predicted Yield)XMarket Access (phi=1)                                                                            0.034*
                                                                                                                            (0.019)




40
      Log(Predicted Yield)XMarket Access (alt. speed)                                                                               0.086***
                                                                                                                                    (0.033)
      Crop-district-decade FE                              Yes        Yes         Yes        Yes        Yes       Yes       Yes     Yes
      Crop-year FE                                         Yes        Yes         Yes        Yes        Yes       Yes       Yes     Yes
      Crop-decade Yield Interactions                       No         No          No         Yes        No        Yes       Yes     Yes
      Crop-district Yield Interactions                     No         No          No         No         Yes       Yes       Yes     Yes
      R-squared                                            0.930      0.929       0.930      0.931      0.934     0.935     0.935   0.935
      Observations                                         83413      83413       83413      83413      83413     83413     83413 83413
      First-Stage F Stat                                   .          6051        .          .          .         .         .       .
     Notes: Regressions of local log prices on local log yields interacted with market access multiplied by 100,000. Each observation is
     a crop-district-year. All regressions include crop-district-decade and crop-year fixed effects. Columns 4-8 include combinations of
     log yields interacted with crop-district and/or crop-decade fixed effects. IV columns instrument yield terms with predicted yields
     from a regression of log yield on local rainfall shocks for each month interacted with state-crop fixed effects and controlling for
     crop-district-decade and crop-year fixed effects, and with the interaction of predicted yields with market access. RF columns replace
     the yield terms with predicted yields calculated as in the IV specification, and the interaction of predicted yields with market access.
     Robust standard errors reported in parentheses. Stars indicate statistical significance: * p<.10 ** p<.05 *** p<.01.
                          Table 3: C ROP CHOICE AND OPENNESS

 Dependent variable:                      Fraction of Land Planted by Crop
                            (1)       (2)         (3)       (4)        (5)         (6)
                            OLS       IV          OLS       IV         OLS         IV
 Log(Mean Yield)            0.004*** 0.016*** -0.010*** -0.010** -0.013*** -0.013**
                            (0.001)   (0.004)     (0.002)   (0.004)    (0.003)     (0.006)
 Log(Variance Yield)        -0.001** -0.004*** 0.000        0.002      0.001*      0.003
                            (0.000)   (0.001)     (0.000)   (0.001)    (0.001)     (0.002)
 Log(Mean)XMA                                     0.019*** 0.029*** 0.023*** 0.027***
                                                  (0.003)   (0.004)    (0.003)     (0.005)
 Log(Var)XMA                                      -0.001*** -0.006*** -0.002*** -0.004*
                                                  (0.000)   (0.001)    (0.001)     (0.002)
 Log(Mean)XBank                                                        0.424       0.679
                                                                       (0.260)     (0.550)
 Log(Var)XBank                                                         -0.093      -0.398
                                                                       (0.059)     (0.294)
 Log(Mean)XMAXBank                                                     -0.526** 0.273
                                                                       (0.252)     (0.610)
 Log(Var)XMAXBank                                                      0.125**     -0.132
                                                                       (0.050)     (0.342)
 Crop-decade FE             Yes       Yes         Yes       Yes        Yes         Yes
 District-decade FE         Yes       Yes         Yes       Yes        Yes         Yes
 Crop-district FE           Yes       Yes         Yes       Yes        Yes         Yes
 R-squared                  0.974     0.974       0.974     0.974      0.974       0.973
 Observations               13791     13790       13791     13790      13765       13764
 First-Stage F Stat         .         97.903      .         36.335     .           1.824
Notes: Crop choice regressed on the log mean and variance of yields, and the log mean
and variance of yields interacted with market access multiplied by 100,000 and/or banks
per capita multiplied by 1000. Each observation is a crop-district-decade. Observations
are weighted by the number of years observed within decade. In IV columns, mean of
yield instrumented with mean of predicted yields from a regression of log yield on local
rainfall shocks for each month interacted with state-crop fixed effects and controlling
for crop-decade, district-decade and crop-district fixed effects. Variance of yield instru-
mented with variance of predicted yields from a regression of log yield on local rainfall
shocks for each month interacted with state-crop-decade fixed effects and controlling
for crop-district-decade fixed effects. Interaction terms instrumented by predicted yield
terms interacted with market access and bank access. Standard errors clustered at the
district-decade level are reported in parentheses. Stars indicate statistical significance: *
p<.10 ** p<.05 *** p<.01.




                                             41
                            Table 4: P REFERENCE PARAMETERS

                       Dependent variable:         Log Budget Share
                                                   (1)        (2)
                        Transformed Coefficients OLS          IV
                        Elasticity σ               1.598*** 2.382***
                                                   (0.022)    (0.040)
                        Rice α                     0.110*** 0.115***
                                                   (0.001)    (0.001)
                        Wheat α                    0.506*** 0.396***
                                                   (0.010)    (0.009)
                        Sorghum α                  0.516*** 0.312***
                                                   (0.015)    (0.011)
                        Pearl Millet α             0.429*** 0.311***
                                                   (0.015)    (0.012)
                        Maize α                    0.288*** 0.201***
                                                   (0.011)    (0.008)
                        Barley α                   0.199*** 0.160***
                                                   (0.021)    (0.015)
                        Finger Millet α            0.323*** 0.205***
                                                   (0.013)    (0.009)
                        Chickpea α                 0.132*** 0.195***
                                                   (0.003)    (0.005)
                        Pigeon Pea α               0.419*** 0.974
                                                   (0.012)    (0.046)
                        Rapeseed α                 0.634*** 1.433***
                                                   (0.018)    (0.065)
                        Groundnut α                0.766*** 1.661***
                                                   (0.021)    (0.073)
                        Other Oil α                0.288*** 0.417***
                                                   (0.006)    (0.011)
                        Sugarcane α                0.263*** 0.322***
                                                   (0.005)    (0.007)
                        Other α                    5.355*** 5.105***
                                                   (0.078)    (0.074)
                        Village FE                 Yes        Yes
                        First Stage F Stat                    6871.21
                        R-squared                  0.69       0.93
                        Observations               750115 750074
Notes: Estimates of the elasticity of local budget shares to village-level median prices.
Each observation is a household-good pair from the 1987 NSS household surveys.
Observations are weighted by NSS survey weights. IV estimates instrument log median
village prices with log median village prices in neighboring village. Coefficients on prices
transformed by 1 − x, good fixed effects transformed by e x . Standard errors clustered at
the village level are reported in parentheses. Stars indicate statistical significance: * p<.10
** p<.05 *** p<.01.
                                             42
                     Table 5: P RICES , O WN Y IELDS AND D ISTANCE -W EIGHTED O THERS ’ Y IELDS

      Dependent variable:                                             Log Price
                                             (1)       (2)       (3)       (4)       (5)       (6)
                                             OLS       IV        OLS       IV        OLS       IV
      ln yigt                                -0.041*** -0.082*** -0.044*** -0.101*** -0.037*** -0.078***
                                             (0.004)   (0.009)   (0.006)   (0.012)   (0.004)   (0.008)
                −φ     y
                      jgt
      ∑ j6=i Dij ln( yigt )                  -0.008*** -0.012***
                                             (0.002)   (0.005)
              −φ     y jgt
      ∑ j6=i Dij ln( yigt )   (phi=1)                            -0.002*** -0.005***
                                                                 (0.001)   (0.001)
              −φ     y jgt
      ∑ j6=i Dij ln( yigt )   (alt. speed)                                             -0.007***   -0.011**




43
                                                                                       (0.002)     (0.005)
      District-year FE                       Yes       Yes       Yes       Yes         Yes         Yes
      Crop-district-decade FE                Yes       Yes       Yes       Yes         Yes         Yes
      Crop-year FE                           Yes       Yes       Yes       Yes         Yes         Yes
      R-squared                              0.948     0.948     0.948     0.948       0.948       0.948
      Observations                           82744     82744     82744     82744       82744       82744
      First-Stage F Stat                     .         2219.93   .         2873.06     .           2498.31
     Notes: Estimates of local prices regressed on own log yields and travel time weighted average of
     other districts’ yields. Odd numbered columns instrument own and travel time weighted other
     yields with own predicted yields and travel time weighted other predicted yields, with predicted
     yields constructed from a regression of log yield on local rainfall shocks for each month interacted
     with state-crop fixed effects and controlling for district-year, crop-district-decade and crop-year fixed
     effects. Each observation is a crop-district-year. Robust standard errors reported in parentheses. Stars
     indicate statistical significance: * p<.10 ** p<.05 *** p<.01.
                 Table 6: E STIMATED RISK AVERSION AND INSURANCE

      Dependent variable:                          Mean Real Returns of a Crop
                                             (1)        (2)        (3)         (4)
                                             OLS        IV         OLS         IV
       Variance of Real Returns              0.964*** 1.354*** 1.436*** 1.820***
                                             (0.107)    (0.163)    (0.142)     (0.225)
       Rural Banks per                                             -7.455*** -7.214***
       CapitaXVariance of Real Returns                             (1.244)     (2.295)
       District-decade FE                    Yes        Yes        Yes         Yes
       District-crop FE                      Yes        Yes        Yes         Yes
       Crop-decade FE                        Yes        Yes        Yes         Yes
       First stage F-stat                               1007.360               370.589
       R-squared                             0.871      0.872      0.870       0.871
       Observations                          11630      11630      11630       11630
Notes: Each observation is a crop-district-decade triplet to which more than a tenth of
a percent of land was allocated. The independent variable is the marginal contribution
of a crop to the total variance of real returns. The IV columns report the results of an
instrumental variables regression where the variance of real returns is instrumented with
the variance of rainfall-predicted yields using observed 1970s land allocations, where the
predicted yields are from a regression of log yield on local rainfall shocks for each month
interacted with state-crop-decade fixed effects and controlling for crop-district-decade
fixed effects. Standard errors clustered at the district-decade level are reported in
parentheses. Stars indicate statistical significance: * p<.10 ** p<.05 *** p<.01.




                                            44
                            Table 7: W ELFARE GAINS FROM EXPANSION OF I NDIAN HIGHWAY NETWORK

                                      PANEL A: Crop Choice Fixed at 1970s Levels
                             Producer Gains                Consumer Gains                                           Total Gains
                      (1)       (2)       (3)      (4)        (5)       (6)                              (7)         (8)          (9)
                      Mean      Variance Welfare Mean         Variance Welfare                           Mean        Variance     Welfare
         1980s        0.020*** 0.021*** 0.001** -0.011*** -0.011*** -0.000***                            0.010***    0.001**      0.009***
                      (0.002)   (0.002)   (0.000)  (0.001)    (0.001)   (0.000)                          (0.001)     (0.000)      (0.001)
         1990s        0.048*** 0.054*** 0.004*** -0.025*** -0.026*** -0.000***                           0.027***    0.002***     0.023***
                      (0.003)   (0.003)   (0.001)  (0.002)    (0.002)   (0.000)                          (0.002)     (0.001)      (0.002)
         2000s        0.094*** 0.106*** 0.008*** -0.046*** -0.047*** -0.000***                           0.058***    0.005***     0.049***
                      (0.003)   (0.005)   (0.002)  (0.002)    (0.002)   (0.000)                          (0.005)     (0.002)      (0.003)
         District FE  Yes       Yes       Yes      Yes        Yes       Yes                              Yes         Yes          Yes
         R-squared    1.000     1.000     0.999    0.981      0.981     0.882                            1.000       1.000        1.000
         Observations 1232      1232      1232     1232       1232      1232                             1232        1232         1232




45
                                            PANEL B: Optimal Crop Choice
                             Producer Gains                Consumer Gains                                           Total Gains
                      (1)       (2)       (3)      (4)        (5)      (6)                               (7)         (8)          (9)
                      Mean      Variance Welfare Mean         Variance Welfare                           Mean        Variance     Welfare
         1980s        0.039*** 0.001*** 0.038*** -0.023*** -0.000*** -0.023***                           0.011***    0.001**      0.009***
                      (0.002)   (0.000)   (0.002)  (0.001)    (0.000)  (0.001)                           (0.001)     (0.000)      (0.001)
         1990s        0.121*** 0.002*** 0.117*** -0.086*** -0.000*** -0.086***                           0.028***    0.001***     0.026***
                      (0.004)   (0.001)   (0.004)  (0.003)    (0.000)  (0.003)                           (0.002)     (0.000)      (0.001)
         2000s        0.343*** 0.002*** 0.339*** -0.267*** -0.000*** -0.267***                           0.057***    -0.000       0.057***
                      (0.009)   (0.000)   (0.009)  (0.004)    (0.000)  (0.004)                           (0.002)     (0.001)      (0.003)
         District FE  Yes       Yes       Yes      Yes        Yes      Yes                               Yes         Yes          Yes
         R-squared    1.000     1.000     1.000    0.979      0.884    0.979                             1.000       1.000        1.000
         Observations 1232      1232      1232     1232       1232     1232                              1232        1232         1232
     Notes: Ordinary least squares. Each observation is a district-decade pair. The mean column reports the log of the mean returns; the variance
     column reports the variance of the log returns; and the welfare column uses the estimated risk aversion coefficients to combines the two to
     create the expected welfare. Columns 1-3 correspond to the nominal income and can be interpreted as the welfare of a producer who uses
     the nominal income to purchase a numeraire good; Columns 4-6 correspond to the inverse of the price index and can be interpreted as the
     welfare of a consumer who uses a constant income to purchase a CES bundle of crops; Columns 7-9 correspond to the agents in the model
     who earn a nominal income and use it to purchase a CES bundle of crops. Note that because the means are the mean of the log real returns
     (as opposed to the log of the mean returns), Columns (1) and (4) do not necessarily sum to Column (7). Standard errors clustered at the
     district level are reported in parentheses. Stars indicate statistical significance: * p<.10 ** p<.05 *** p<.01.
Table 8: E XPLAINING THE HETEROGENEITY ACROSS          DISTRICTS IN THE GAINS FROM THE
EXPANSION OF THE I NDIAN HIGHWAY NETWORK


     Dependent variable:                           Estimated Welfare Gains from Trade
                                                  (1)         (2)           (3)
      1980s                                       0.009***    -0.002        -0.001
                                                  (0.001)     (0.002)       (0.001)
      1990s                                       0.026***    -0.006        -0.003
                                                  (0.001)     (0.004)       (0.002)
      2000s                                       0.057***    0.014***      0.019***
                                                  (0.002)     (0.005)       (0.003)
      Log Market Access                                       0.066***      0.308***
                                                              (0.009)       (0.014)
      Number of CropsXLog Market Access                                     -0.019***
                                                                            (0.001)
      Correlation of Mean and Std. Dev. of                                  -0.057***
      YieldsXLog Market Access                                              (0.008)
      District FE                                 Yes         Yes           Yes
      R-squared                                   1.000       1.000         1.000
      Observations                                1232        1232          1232
Notes: Ordinary least squares. Each observation is a district-decade pair. The dependent
variable is estimated welfare in a district-decade from expanding the Indian highway
network (holding all other structural parameters fixed). Number of crops is the number
of crops with observed yields in the 1970s in a district. The correlation between mean
and standard deviation of yields is the correlation across crops within district in the
observed mean and standard deviation of log yields in the 1970s; a positive (negative)
value indicates that crops with higher means in a district also tend to be more (less) risky.
Standard errors clustered at the district level are reported in parentheses. Stars indicate
statistical significance: * p<.10 ** p<.05 *** p<.01.




                                             46
                                       Figure 1: T HE I NDIAN H IGHWAY N ETWORK OVER T IME




47
     Notes: This figure shows the expansion of the Indian highway network over time. The networks are constructed by
     geocoding the scanned Road Map of India described in Section 2.2 for each of the above years and using image processing
     to identify the pixels associated with highways. Bilateral distances between all districts are then calculated by applying the
     “Fast Marching Method algorithm (see Sethian (1999)) to the resulting speed image.
                                                               Figure 2: D ECOMPOSITION OF I NCOME V OLATILITY OVER T IME


                                                              Components of the Mean of Income                                        Components of the Variance of Income




                                                        .4
                                                                                                                                1.5




                                                        .3
                                                                                                                                1




                                                        .2
                                                                                                                                .5




                                                        .1
                                                        0
                                                                                                                                0




                         Log change relative to 1970s
                                                                                                 Log change relative to 1970s




48
                                                        -.1
                                                                                                                                -.5




                                                        -.2
                                                              1980         1990         2000                                            1980         1990          2000


                                                               Nominal (Gross) Income            Price Index                                            Real (Gross) Income


     Notes: This figure shows how the volatility of real (gross) agricultural incomes and its components have changed over
     time. The blue bar reports the log change in the volatility in total nominal agricultural revenue relative to the 1970s using
     observed crop-year-district prices, yields, and crop shares. The red bar reports the log change in the price index, a CES
     price index for the 15 crops in our sample. The green bar reports the log change in real (gross—i.e. excluding crop costs)
     income. Each of the values reported are the mean value across districts within a decade.
                                  Figure 3: T HE SPATIAL DISTRIBUTION OF THE GAINS FROM TRADE




49
     Notes: The left panel figure shows the distribution across districts in the gains from trade from the expansion of the highway
     network between the 1970s to the 2000s. To calculate the gains from trade, we hold technology and effective risk aversion
     parameters constant at their 1970s levels but allow trade costs to change as the Indian highway network expands over time.
     For each district in each decade, we then calculate the optimal reallocation of land across different crops and the associated
     change welfare. The right frame shows the spatial dispersion of change in market access between the 1970s and the 2000s,
     where the market access is measured as an inverse travel time weighted average of agricultural output in all districts, and
     travel times are calculated using the observed highway network. In both figures, the gains are reported by decile, where
     red indicates greater gains and blue indicates smaller gains.
       Figure 4: C ROP CHARACTERISTICS AND THE RESPONSE OF CROP ALLOCATIONS TO THE I NDIAN H IGHWAY E XPANSION
                                                                     PANEL A: Relative mean log yields in the 1970s




                                                           PANEL B: Relative standard deviation of log yields in the 1970s




50
                                                      PANEL C: Change in optimal crop allocation from highway expansion




     Notes: Panels A and B report the deciles of average log yields and standard deviation of log yields for each crop in each district in the 1970s, respectively. (An absence of color indicates
     that particular crop was not grown in that district the 1970s.) Panel C reports the percentage point change in land allocated to the production of each crop in each district in response
     to the expansion of the Indian highway network.
A     Appendix
A.1   A microfoundation for insurance
    In this subsection, we provide a microfoundation for the assumption that in the presence of
(costly) insurance, equilibrium real income after insurance is equal to a Cobb-Douglas combina-
tion of equilibrium real income prior to insurance and expected income. To save on notation, in
what follows, we will denote states of the world with subscripts and the probability of state of the
world s with πs . Denote the real income realization prior to insurance as Is and denote the real
income post insurance as Cs .
    The goal is to show that:
                                        Cs = κIs E ( Is )1−χ ,
                                               χ
                                                                                                (24)
                              E[ Is ]χ
where χ ∈ [0, 1] and κ ≡                 is a scalar necessary to ensure that the mean income remains
                              E[ Is ]
                                   χ

constant before and after insurance.
    To micro-found equation (24), we proceed as follows. As in the main text, farmers are as-
sume to be risk averse with constant relative risk aversion, but now we allow them the ability
to purchase insurance. A farmer can purchase insurance which pays out one unit of income in
state of the world s for price ps . Hence, consumption in state of the world s will be the sum of
the realized income in that state and the insurance payout less the money spent on insurance:
Cs = Is + qs − ∑t pt qt . A farmer’s expected utility function is:
                                                                           ! 1− ρ
                                              1
                             E [U ] = ∑ π s            Is + qs − ∑ pt qt            ,
                                      s     1 − ρ                t

where as in the main text ρ ≥ 0 is the level of risk aversion of the farmer.
    Farmers purchase their insurance from a large number of “money-lenders” (or, equivalently,
banks). Money-lenders have the same income realizations as farmers, but are distinct from farmers
in that they are less risk averse. For simplicity, we assume the money-lenders also have constant
relative risk aversion preferences with risk aversion parameter λ ≤ ρ. Because lenders are also
risk averse, farmers will not be able to perfectly insure themselves. Money lenders compete with
each other to lend money, and hence the price of purchasing insurance in a particular state of the
world is determined by the marginal cost of lending money.
    We first calculate the price of a unit of insurance in state of the world s. Since the price of
insurance is determined in perfect competition, it must be the case that each money lender is just
indifferent between offering insurance and not:

                      1                            1                                    1
              ∑ πt 1 − λ ( It + εps )1−λ + πs 1 − λ ( It + εps − ε)1−λ = ∑ πt 1 − λ It1−λ ,
              t6=s                                                                  t

where the left hand side is the expected utility of a money-lender offering an small amount ε of
insurance (which pays εps with certainty but costs ε in state of the world s) and the left hand side
is expected utility of not offering the insurance. Taking the limit as ε approaches zero yields that
the price ensures that the marginal utility benefit of receiving ps ε in all other states of the world is




                                                       1
equal to the marginal utility cost of paying ε (1 − ps ) in state of the world s.

                                ps ε ∑ πt It−λ = ε (1 − ps ) πs Is−λ ⇐⇒
                                      t6=s

                                                            πs Is−λ
                                                  ps =                .                               (25)
                                                           ∑t πt It−λ

Equation (25) is intuitive: it says that the price of insuring states of the world with low aggregate
income shocks is high.
    Now consider the farmer’s choice of the optimal level of insurance. Farmers will choose the
quantity of insurance to purchase in each period in order to maximize their expected utility:
                                                                                   !1− ρ
                                         1
                               max ∑ πs                        Is + qs − ∑ pt qt
                               {qs } s  1−ρ                               t

which yields the following FOC with respect to qs :
                                             !−ρ                                           !−ρ
                  πs   Is + qs − ∑ pt qt              = ps ∑ πt        It + qt − ∑ pt qt         ⇐⇒
                                 t                             t                    t
                                             −ρ
                                      πs Cs
                                               −ρ     = ps .                                          (26)
                                     ∑t πt Ct

Substituting the equilibrium price from equation (25) into equation (26) and noting that E [C −ρ ] =
       −ρ
∑t πt Ct and E I −λ = ∑t πt It−λ yields:
                   

                                                      −ρ
                                         Cs            Is−λ
                                                  =             .                                     (27)
                                       E [C −ρ ]     E [ I −λ ]

As in the paper, suppose that ln I ∼ N µ I , σI2 . Then we have:
                                                


                                           Is−λ
                                                                        
                                                               1 2 2 2 2
                                ln                        ∼ N − λ σI , λ σI ,
                                         E [ I −λ ]            2

so that it also is the case that ex-post insurance is log normally distributed (with an arbitrary mean
of log returns µC ):

                                     C −ρ
                                                                
                                                        1 2 2 2 2
                               ln               ∼ N − λ σI , λ σI ⇐⇒
                                    E [C −ρ ]           2
                                                          λ2
                                                             
                                          ln C ∼ N µC , 2 σI2 ,
                                                          ρ

where µC is an arbitrary mean of log returns. The arbitrary mean arises because the first order
conditions (26) are homogeneous of degree zero in consumption, i.e. the first order conditions do
not pin down the scale of ex-post real income. To ensure that access to insurance only affects the
second moment of returns, we assume that the average income after insurance is equal to average




                                                               2
income before insurance, i.e:

                                          E [C ] = E [ I ] ⇐⇒
                                                   λ2
                                                                
                                      1     2                  1 2
                             exp µC +      σ = exp µ I + σI          ⇐⇒
                                      2 ρ2 I                   2
                                                                    2 !
                                                           1 2       λ
                                             µC = µ I + σI 1 −            .
                                                           2         ρ

   As a result, we can re-write equation (27) as:
                                                   λ                1           h         i 1ρ
                                                                 −ρ − ρ               −λ
                                                           
                                                   ρ
                                         Cs = Is E C                            E I               ⇐⇒
                                         Cs = κIs E ( Is )1−χ ,
                                                       χ


                                     E[ Is ]χ
where χ ≡     λ
                  ∈ [0, 1] and κ ≡              as claimed.
                                     E[ Is ]
              ρ                           χ



A.2   An alternative derivation of the no-arbitrage equation based on convex trans-
      portation costs
   In the paper, we show that under the appropriate set of assumptions, heterogeneous traders
and a market clearing condition imply the following no-arbitrage condition:
                                                                                                  ε ij
                                          Cig (s)                           pig (s)
                                                                        

                                          Qig (s)
                                                  =            ∏            p jg (s)
                                                                                     ϕ g (s)              ,
                                                               j 6 =i

i.e. goods flow toward locations with higher relative prices. In this subsection, we provide an al-
ternative setup that generates the same no-arbitrage condition assuming that transportation costs
are increasing and convex in the quantity traded.37 For notational simplicity, we omit the good g
and state s notation in what follows.
     Suppose that iceberg trade costs τij between i and j are increasing in the quantity shipped from
i to j with the following functional form:

                                                                 1                 
                                                ln τij =             Qij + κi − κ j ,                         (28)
                                                                ε ij

where {κi } are (endogenous) constants that capture the relative cost of importing versus exporting
from a particular location (a larger κi indicates it is relatively more costly to export from a location
than for that location to import). Because these are relative costs, without loss of generality we
assume ∑iN=1 κi = 0.
    In equilibrium, trade flows from i to j, Qij , will only be positive if p j ≥ pi , in which case the
following no-arbitrage condition holds:

                              ln p j − ln pi = ln τij ⇐⇒
                                                         1                 
                              ln p j − ln pi = ln ϕ +        Qij + κi − κ j ⇐⇒
                                                        ε ij
                                                                         
                                         Qij = ε ij ln p j − ln pi − ln ϕ − κi + κ j                          (29)

  37 We   are grateful to Rodrigo Adao for pointing out this alternative setup.


                                                                            3
Similarly, trade flows from j to i, Q ji , will only be positive if pi ≥ p j , in which case the following
no-arbitrage equation holds:

                                      ln pi − ln p j = ln τji ⇐⇒
                                                                 1                  
                                      ln pi − ln p j = ln ϕ +        Q ji + κ j − κi ⇐⇒
                                                                ε ji
                                                                                  
                                                Q ji = ε ji ln pi − ln p j − ln ϕ + κi − κ j            (30)

Market clearing implies the total quantity consumed is equal to the total quantity imported:

                                                       Ci = Qii + ∑ Q ji ,
                                                                            j 6 =i

while the total quantity produced is equal to the total quantity exported:

                                                       Qi = Qii + ∑ Qij .
                                                                            j 6 =i

Hence the difference between the quantity consumed and the quantity produced is simply equal
to the net imports:

                                                  Ci − Qi =    ∑ Q ji − ∑ Qij .                         (31)
                                                               j 6 =i                j 6 =i

As in the main text, assume that ε ij = ε ji . Then substituting the no-arbitrage equations (29) and
(30) into the market clearing condition (31) yields:

       Ci − Qi = ∑ ε ji ln pi − ln p j + κi − κ j − ∑ ε ij ln p j − ln pi − κi + κ j ⇐⇒
                                                                                   
                   Q ji >0                                                    Qij >0

                   ∑ ε ij       ln pi − ln p j + ∑ κi − κ j
                                                                       
       Ci − Qi =                                                                                        (32)
                   j 6 =i                            j 6 =i

Finally, we suppose that:

                             ∑        κi − κ j = (Ci − ln Ci ) − ( Qi − ln Qi ) + ∑ ε ij ln ϕ,
                                              
                                                                                                        (33)
                             j 6 =i                                                           j 6 =i

for some ϕ > 0. Note that equation (33) can be written in matrix notation as:

                                                              A~κ = b,
                            (
                       ∑i6= j ε ij if i = j         h                                                 i
                                             and b = (Ci − ln Ci ) − ( Qi − ln Qi ) + ∑ j6=i ε ij ln ϕ . Note
          
where A = Aij =
                       −ε ij       if i 6= j
that A has rank N − 1, so with the additional constraint that ∑iN=1 κi = 0 there is a unique set of
{κi } that solve equation (33) . Furthermore, the ϕ can be determined by the aggregate market




                                                                   4
clearing constraint that:
                                                              N
                                                             ∑ (Ci − Qi ) = 0                   ⇐⇒
                                                             i =1
                                                                                   !
                 N
                 ∑ ∑ ε ij        ln pi − ln p j + ∑ κi − κ j
                                                                              
                                                                                       = 0 ⇐⇒
                i =1   j 6 =i                             j 6 =i
                                                         N                                 N
                                                        ∑∑                                ∑ ∑ ε ij
                                                                                                                         
                                                                       κi − κ j =                        ln p j − ln pi
                                                        i =1 j 6 = i                     i =1 j 6 = i

   As a result, equation (32) becomes:

                                            ∑ ε ij         ln pi − ln p j + ∑ κi − κ j ⇐⇒
                                                                                     
                                Ci − Qi =
                                            i6= j                                       i6= j

                                            ∑ ε ij
                                                                                                
                        ln Ci − ln Qi =                    ln pi − ln p j + ln ϕ                    ⇐⇒
                                            i6= j
                                                                  ε ij
                                    Ci                  pi
                                    Qi
                                       =    ∏           pj
                                                           ϕ               ,                                                  (34)
                                            i6= j

as required.
A.3     Derivation of the equilibrium crop choice
    In this subsection, we provide the full derivation of the equilibrium crop choice when yields
are both deterministic and volatile.
A.3.1    No volatility
    We begin with the fact that the returns per unit hectare of all crops that farmers produce must
be equalized for farmers to be willing to produce them. Taking logs of equation (10) yields:

                                              ln pig + ln Aig = ln wi .                                                       (35)

Recall from equation (8) that combining the no-arbitrage equation and the CES demand equation
yields the following set of equilibrium prices:
                                    N              N               N               N
                       1                                  ε̄ 
            ln pig =     ln α g + ∑ Tij ln D j − ∑ Tij ln ϕ gj − ∑ Tij ln A jg − ∑ Tij ln θ jg .                              (36)
                       σ          j =1           j =1            j =1            j =1

Note from the previous equation that because Tii > 0, as the land allocated to crop g in location
i goes to zero, its price rises to infinity, which implies that all crops will be produced in positive
amounts in all locations; intuitively, there will always be some “buying” traders with very high
trade costs that will choose to source locally regardless of the local price.
    Substituting the equilibrium price equation (36) into the farmer indifference condition equa-




                                                                       5
tion (35) yields:
              N              N               N               N
 1                                  ε̄ 
   ln α g + ∑ Tij ln D j − ∑ Tij ln ϕ gj − ∑ Tij ln A jg − ∑ Tij ln θ jg + ln Aig = ln wi ⇐⇒
 σ          j =1           j =1            j =1            j =1
                         N              N               N                                                            N
            1
              ln α g + ∑ Tij ln D j − ∑ Tij ln ϕ gj − ∑ Tij ln A jg + ln Aig − ln wi =                               ∑ Tij ln θ jg
                                                 ε̄
                                                                                                                                     ⇐⇒
            σ          j =1           j =1            j =1                                                           j =1
                                    1               ~ − T ln ϕ~gεj − T ln A
                                                               ¯
                                      ln α g + T ln D                     ~ g + ln A        ~ = T ln ~θ g ,
                                                                                   ~ g − ln w
                                    σ
where the last line writes the system of equation in matrix notation. Multiplying both sides of the
equation by T−1 = E allows us to solve for the equilibrium pattern of specialization up to scale:
                                          
               1                                  ~ − ln ϕ~gεj − ln A
                                                           ¯
   ~
 ln θ g = E                    ~
                 ln α g + ln A g − ln w  ~ + ln D                    ~ g ⇐⇒
               σ
            N                                   
                      1
ln θig = ∑ Eij          ln α g + ln A jg − ln w j + ln Di − ln ϕε̄gi − ln Aig ⇐⇒
          j =1
                      σ
                         !                                                                      
                               1                                        1
ln θig = σ + ∑ ε ij              ln α g + ln Aig − ln wi − ∑ ε ij         ln α g + ln A jg − ln w j + ln Di − ln ϕε̄gi − ln Aig ⇐⇒
                 j 6 =i
                               σ                              j 6 =i
                                                                        σ
                                                                                                                            !
ln θig = ln α g + (σ − 1) ln Aig − ln ϕε̄gi + ∑ ε ij ln Aig − ln A jg + ln Di − σ ln wi − ∑ ε ij ln wi − ln w j
                                                                                                                         
                                                                                                                               ⇐⇒
                                                                 j 6 =i                                                     j 6 =i

                                                               + ∑ ε ij ln Aig − ln A jg + Ci ⇐⇒
                                                                                                    
ln θig = ln α g + (σ − 1) ln Aig − ln                  ϕε̄gi
                                                                 j 6 =i
                                           ε ij
                                    Aig
                                
  θig ∝ α g Aig ϕg ∏
             σ−1 −ε̄ i
                                                   ,
                       j 6 =i
                                    A jg

where Ci ≡ ln Di − σ ln wi − ∑ j6=i ε ij ln wi − ln w j is a crop-invariant constant. Finally, imposing
                                                       

the land constraint that ∑G
                          g=1 θig = 1, we can solve for the scale, yielding:
                                                                                                   ε ij
                                                                     σ −1 −ε̄ i              Aig
                                                                α g Aig  ϕ g ∏ j 6 =i        A jg
                                             θig =                                                        ε ij ,
                                                                     σ −1          −ε̄              Aih
                                                           ∑hG=1 αh Aih   ϕ h i ∏ j 6 =i            A jh

as required.
A.3.2    With volatility
    The derivation of the optimal crop choice in the presence of volatility proceeds analogously to
the deterministic case, with the first order conditions of the portfolio choice problem in equation
(15) replacing the farmer indifference condition from equation (10):
                                                                           G
                                                               µz,i
                                                                g − ρi    ∑ θih Σz,i
                                                                                 gh = λi ,
                                                                          h =1




                                                                               6
                       exp{µ x,i
                             g }
                                                                                    
where µz,i
       g ≡                           x,i       + 12 Σ x,i
                                                      gg  − ∑ G
                                                                 θ
                                                              h=1 ih   Σ x,i
                                                                         gh  − Σ z,i
                                                                                 gh . Note that we can re-write this as:
                   g=1 θig exp{ µ g
                  ∑G                       }
                                                                                                                                                                          !!
                                                                                                                                G                          G
                                                                                                                     1 x,i                       
                                                                               µ x,i
                                                                                 g     = ln λi −                       Σ gg − ∑ θih Σ x,i
                                                                                                                                      gh  − Σ z,i
                                                                                                                                              gh    − ρi ∑ θih Σz,i
                                                                                                                                                                gh
                                                                                                                     2        h =1                       h =1
                                                                                                      G              n o
                                                                                         + ln        ∑        θig exp µ x,i
                                                                                                                        g   ⇐⇒
                                                                                                    g =1
                                                                                                                                                                          !!
             N                N                                                                                                 G                           G
1                                                                                                                  1 x,i                       
  ln α g − ∑ Tij ln ϕ̄ gj − ∑ Tij ln θ jg + µ g + µ gA,i = ln λi −                                                     Σ gg − ∑ θih Σ x,i                 ∑ θih Σz,i
                       ε̄                     A,j                                                                                             z,i
                                                                                                                                      gh  − Σ gh    − ρ i        gh
σ          j =1             j =1
                                                                                                                     2        h =1                        h =1
                                                                                                      G              n o
                                                                                         + ln        ∑        θig exp µ x,i
                                                                                                                        g
                                                                                                    g =1


where the second line substituted in the expression for µ x,i
                                                          g from equation (37) from Proposition
1. Rearranging this expression yields the following system of equations for the equilibrium crop
choice:
 N                          N                   N
               1
 ∑ ij jg σ                ∑ ij g ∑ Tij µg + µgA,i
                                       ε̄ j        A,j
      T ln θ =   ln α g −      T ln ϕ̄      −
 j =1                     j =1                j =1
                                                                                                                                 !!
                                                          G                           G                                                       G
                                               1 x,i                                                                                                    n         o
                      − ln λi −                  Σ gg − ∑ θih Σ x,i
                                                                gh  − Σ z,i
                                                                        gh    − ρ i ∑    θih Σz,i
                                                                                              gh                                      − ln   ∑ θig exp        µ x,i
                                                                                                                                                                g     ,
                                               2        h =1                        h =1                                                     g =1

which as in the deterministic case can be inverted to (implicitly) solve for the equilibrium crop
choice up to scale:
            N                       
                          1
 ln θig = ∑ Eij
                                                    ε̄
                            ln α g         − ln ϕ̄ gj − µ gA,i
           j =1
                          σ
                                                                                                                                             !!!
                  N                                       G                            G
                                               1 x,i                         
            + ∑ Eij         µ gA,i
                               − ln λi −         Σ gg − ∑ θih Σ x,igh − Σ z,i
                                                                          gh    − ρi ∑ θih Σz,i
                                                                                            gh                                                          − Ci ⇐⇒
              j =1
                                               2        h =1                         h =1

     ln θig = ln α g − ln ϕ̄ gj − µ gA,i + σ ln big + ∑ ε ij ln big − ln b jg − Ci
                             ε̄                                               
                                                                      j 6 =i
                                    n o
where Ci ≡ ∑ N  E
             j=1 ij ln ∑ G
                            θ
                         g=1 ig exp  µ x,i
                                       g   is a good invariant constant and:
                                                                                                                                              !!
                                                                      G                           G
                                                           1 x,i                       
                  ln big ≡    µ gA,i   − ln λi −             Σ gg − ∑ θih Σ x,i
                                                                            gh  − Σ z,i
                                                                                    gh    − ρ i ∑    θih Σz,i
                                                                                                          gh                                        .
                                                           2        h =1                        h =1

Taking the exponent of both sides, this yields:
                                                                                                                     ε ij
                                                                                                              big
                                                                            −1                          
                                               θig ∝ α g exp       µ gA,i           ϕ̄− ε̄ i σ
                                                                                      g big      ∏            b jg
                                                                                                                             ,
                                                                                                 j 6 =i

as required.



                                                                                7
A.4    Proof of Proposition 1
Proposition. [Restated with all definitions]The distribution of the real returns of farmer f in location i is
approximately log-normal, i.e.:                              
                                                                              f
                                                                     ln Zi ∼ N µiZ , σi2,Z ,

where µiZ and σi2,Z are defined in Appendix A.4.
Proposition 4. The mean of the log real returns can be expressed as:
                                                          G                                              G
                                                                     n o                           1              n o
                                                      ∑                                               ln ∑ α g exp µ g
                                                                f                                                    y,i
                                       µiZ ≡ ln               θig exp µ x,i
                                                                        g   +
                                                      g =1
                                                                                                 σ − 1 g =1
                                                                                                            !
                                                               G                             G     G
                                                      1
                                                              ∑                          ∑ ∑ θih θig Σx,i
                                                                       f                                     f     f
                                                +                    θig Σ x,i
                                                                           gg −                       gh
                                                      2       g =1                       g =1 h =1
                                                                                                                                              !
                                                                                  G                               G      G
                                                 1                                                     1
                                                                              ∑                                  ∑∑
                                                                                             p,i                                       p,i
                                                + ( σ − 1)                             α g Σ gg      −                        α g αh Σ gh
                                                 2                            g =1
                                                                                                       2         g =1 h =1

                                                + ln (1 + ψ̄) ,

where µ x,i
        g is the mean of the log nominal revenue of crop g per unit land:
                                                                             !
                                                               N                                N
                                   1                                                                                 
                                                              ∑ Tij ε̄ j              ln ϕ̄ g − ∑ Tij ln θ jg + µ g + µ gA,i ,
                                                                                                                  A,j
                        µ x,i
                                                                                             
                          g       ≡ ln α g −                                                                                                                                  (37)
                                   σ                          j =1                                         j =1

 y,i
µ g is the mean of the log price of good g (to the power of (1 − σ)):
                                                                                                 !                                                            !
                                                                                  N                                      N
                                                          1                                                                                              
                                                                                  ∑ Tij ε̄ j         ln ϕ̄ g − ∑ Tij
                        y,i                                                                                                                      A,j
                       µg        ≡ (1 − σ )                 ln α g −                                                                 ln θ jg + µ g                 ,
                                                          σ                   j =1                                     j =1


Σ x,i is the G × G variance-covariance matrix of nominal revenue across crops:
                                                                             !               !                                                           !               !0
                                                              N                                                                               N
             Σ   x,i
                       = (1 − Tii ) I −                       ∑ Tij ε̄ j           D   ϕ,i
                                                                                                 Σ   A,i
                                                                                                                 (1 − Tii ) I −           ∑ Tij ε̄ j          D    ϕ,i

                                                              j =1                                                                        j =1
                                                              !                          !                                     !                        !0
                                               N                                                                   N
                            +∑                 ∑ Tij ε̄ j         D   ϕ,j
                                                                            + Tij I Σ            A,j
                                                                                                                  ∑ Tij ε̄ j        D   ϕ,j
                                                                                                                                              + Tij I         ,
                                  j 6 =i       j =1                                                               j =1


Σ p,i is the G × G variance-covariance matrix of prices across crops:
                                                                  !                          !                                      !                         !0
                                           N          N                                                                  N
                       Σ   p,i
                                 =    ∑            ∑ Tij ε̄ j         D     ϕ,j
                                                                                  + Tij I Σ            A,j
                                                                                                                       ∑ Tij ε̄ j       D     ϕ,j
                                                                                                                                                    + Tij I        ,
                                      j =1         j =1                                                                j =1

ψ̄ is the return to farmers from traders and ϕ̄ g is the equilibrium
                                                           h          i market tightness, both evaluated at the
                                                             ∂ ln ϕ g
mean of the log realized productivity shocks, and D ≡ ∂ ln A jh
                                                     ϕ,j                is the G × G matrix of elasticities of the
                                                                                                                       gh
market tightness with respect to productivity shocks in district j, evaluated at the mean of the log realized
productivity shocks.

                                                                                             8
    The variance of the log real returns can be expressed as:
                                                                                   G    G
                                                                               ∑ ∑ θig θih Σz,i
                                                                                                  f   f
                                                            σi2,Z =                         gh ,
                                                                           g =1 h =1

where:
                                                  !                                !!                                                    !                           !!0
                                       N                                                                                    N
 Σz,i ≡    I−       Tii B +          ∑ Tij ε̄ j       BD ϕ,j + D̃ψ,i                        Σ A,i         I−     Tii B +   ∑ Tij ε̄ j          BD ϕ,j + D̃ψ,j
                                     j =1                                                                                  j =1
                                                  !                                 !                                           !                           !0
                                       N                                                                            N
          + ∑ Tij B +                ∑ Tjk ε̄ k       BD    ϕ,j
                                                                  + D̃     ψ,i
                                                                                        Σ   A,j
                                                                                                      Tij B +      ∑ Tjk ε̄ k       BD   ϕ,j
                                                                                                                                               + D̃   ψ,j
                                                                                                                                                                 ,
           j 6 =i                   k =1                                                                           k =1


B ≡ (IG − 1G~α0 ) is a G × G matrix (where 1G is an G × 1 matrix of ones and ~α ≡ α g g ) and D̃ψ,j ≡
                                                                                      
       0                 h
                            ∂ ln ψ
                                   i
1G Dψ,j , where Dψ,j ≡ ∂ ln A jg is a vector of elasticities of the return to farmers from traders to the
                                                      g
productivity shocks in district j.

Proof. We first log-linearize equilibrium market tightness and transfers from farmers.
                                                                                      From equa-
tion (9), given the crop choice of farmers, the equilibrium market tightness ϕ g and transfers
from traders to farmers ψ can be written as implicit functions of the realized productivity shocks.
As a result, we can log-linearize both around the mean of log productivities:
                                                                       n                   o      N                         
                                                                                   µ gA,i         + ∑ D ϕ,j ln A j (s) − µ A,j
                                                      
                         ln ϕ        ln Aig (s)            ≈ ln ϕ̄
                                                                                                      j =1
                                                                                      n             o        N                        
                                                                                             µ gA,i            + ∑ Dψ,j ln A j (s) − µ A,j
                                                     
             ln 1 + ψ               ln Aig (s)             ≈ ln 1 + ψ̄
                                                                                                                 j =1
                    h           i                          h               i
                        ∂ ln ϕ g                                ∂ ln ψ
where D ϕ,j ≡           ∂ ln A jh gh   and Dψ,j ≡              ∂ ln A jh       .
    We proceed by applying this approximation to log nominal revenue per unit land, ln xig (s) ≡
ln pig (s) + ln Aig (s). Using expression (8) for prices (ignoring the Di (s) term since it cancels out
in the utility function; see equation (12)), we have:
                                                  !                                        !
                                       N                          N
                          1                                                             
              ln xig (s) = ln α g − ∑ Tij ∑ ε jk      ln ϕ̄ g + ∑ D g ln A j (s) − µ A,j
                                                                     ϕ,j
                          σ          j =1   k6= j               j =1
                                       N
                                     − ∑ Tij ln θ jg + A jg (s) + ln Aig (s) .
                                                               
                                           j =1

From Assumption (1), the distribution of productivities is log-normal and the log nominal revenue
per unit land is a linear combination of the log productivities, it too is distributed log normally.
Using the familiar expression for the distribution of an affine transformation of a normally dis-
tributed variable, we have:                                 
                                      ln xi ∼ N µ x,i , Σ x,i ,




                                                                                        9
where:                                                               !
                                                         N                             N
                             1                                                                              
                                                        ∑ Tij ε̄ j           ln ϕ̄ g − ∑ Tij ln θ jg + µ g + µ gA,i
                                                                                                         A,j
                 µ x,i
                                                                                    
                   g        ≡ ln α g −
                             σ                          j =1                                 j =1

                                                                    !            !                                                                !               !0
                                                        N                                                                         N
           Σ x,i ≡     (1 − Tii ) I −                  ∑ Tij ε̄ j        D ϕ,i       Σ A,i      (1 − Tii ) I −                   ∑ Tij ε̄ j           D ϕ,i
                                                       j =1                                                                      j =1
                                                       !                        !                                    !                        !0
                                           N                                                        N
                     +∑                 ∑ Tij ε̄ j          D ϕ,j + Tij I           Σ A,j           ∑ Tij ε̄ j            D ϕ,j + Tij I               .
                           j 6 =i       j =1                                                        j =1

Similarly, define ln yig (s) = (1 − σ) ln pig (s). Again using the log-linearization of ϕ g and expres-
sion (8), we have:                                           
                                         ln yi ∼ N µy,i , Σy,i ,

where:                                                                                !                                                                   !
                                                                         N                                 N
                                                1                                                                                                
                                                                         ∑ Tij ε̄ j       ln ϕ̄ g − ∑ Tij
                 y,i                                                                                                                      A,j
                µg     ≡ (1 − σ )                 ln α g −                                                                    ln θ jg + µ g
                                                σ                        j =1                              j =1



                                                                 Σy,i = (σ − 1)2 Σ p,i
                                                            !                       !                                             !                           !0
                      N             N                                                                      N
           Σ p,i =   ∑              ∑ Tij ∑ ε jk                D ϕ,j + Tij I           Σ A,j           ∑ Tij ∑ ε jk                    D ϕ,j + Tij I              .
                     j =1           j =1       k6= j                                                    j =1          k6= j

                                                                                                                                              f
Given these definitions, note that we can write the (log of) the real returns Zi (s) as:

                                                G                                    G
                                                                               1
                                               ∑                                  ln ∑ αh yig (s) + ln (1 + ψ (s))
                            f                           f
                 ln Zi (s) = ln                        θig xig (s) +
                                               g =1
                                                                             σ − 1 h =1

As in Campbell and Viceira (2002), we now rely on a second-order approximaiton of the log real
returns around the mean log productivities. In particular, we write:
                                                 !                                        !
                     G                 G                          G              G
                            n o                        1                n o
    ln Zi (s) ≈ ln ∑ θig exp µ x,i − ∑ θig µ x,i             ln ∑ αh exp µ g − ∑ αh µ g
         f              f                  f                               y,i        y,i
                               g              g    +
                   g =1              g =1
                                                     σ−1        h =1           h =1
                       G                                         G                                             G                             G        G
                                                           1                        1                                                   1
                     ∑                                         ∑                                            ∑                               ∑ ∑ θih θig Σx,i
                                f                                                                                     f                                       f    f
                +            θig ln xig (s) +                       αh ln yih (s) +                                  θig Σ x,i
                                                                                                                           gg −                          gh
                     g =1
                                                         σ − 1 h =1                 2                      g =1
                                                                                                                                        2   g =1 h =1
                                           G                                         G      G
                     1                              1
                       (σ − 1) ∑ α g Σ gg − (σ − 1)                                 ∑ ∑ αg αh Σgh
                                       p,i                                                                     p,i
                +
                     2         g =1
                                                    2                               g =1 h =1
                                N                       
                + ln (1 + ψ̄) + ∑ Dψ,j ln A j (s) − µ A,j .
                                               j =1

                                                                     f
Again, because the log real returns ln Zi (s) are an affine transformation of log-normally dis-




                                                                                 10
tributed random variables, the log real returns are also log-normally distributed:
                                                          
                                           f
                                      ln Zi ∼ N µiZ , σi2,Z .

Taking expectations of this expression gives us the mean:
                                            G                                           G
                                                        n o                       1              n o
                                            ∑                                        ln ∑ α g exp µ g
                                                   f                                                y,i
                              µiZ ≡ ln           θig exp µ x,i
                                                           g   +
                                          g =1
                                                                                σ − 1 g =1
                                                                                         !
                                            1
                                                 ∑ θig Σx,i
                                                        gg − ∑ ∑ θih θig Σ gh
                                                         f                 x,i          f       f
                                      +
                                            2     g                     g    h
                                                                                                                            !
                                                              G                                     G   G
                                       1                                           1
                                                             ∑                                      ∑∑
                                                                          p,i                                         p,i
                                      + ( σ − 1)                    α g Σ gg     −                           α g αh Σ gh
                                       2                     g =1
                                                                                   2            g =1 h =1

                                      + ln (1 + ψ̄) ,

whereas the variance can be written as:
                                                                    G       G
                                                                  ∑ ∑ θig θih Σz,i
                                                                                    f       f
                                                       σi2,Z =                 gh ,
                                                                  g =1 h =1

where:
                                            !                       !!                                                              !                     !!0
                               N                                                                                        N
 Σz,i ≡    I−       Tii B +    ∑ Tij ε̄ j       BD ϕ,j + D̃ψ,i               Σ A,i              I−          Tii B +    ∑ Tij ε̄ j       BD ϕ,j + D̃ψ,j
                               j =1                                                                                    j =1
                                            !                        !                                                      !                    !0
                               N                                                                              N
          + ∑ Tij B +          ∑ Tjk ε̄ k       BD ϕ,j + D̃ψ,i              Σ A,j           Tij B +           ∑ Tjk ε̄ k        BD ϕ,j + D̃ψ,j        ,
           j 6 =i             k =1                                                                           k =1

as claimed.

A.5    Proof of Proposition 2
    We first restate the proposition:

Proposition. [Restated] Suppose that the Pareto distribution of trade costs can be written as ε ij (t) = ε ij t,
where t ≥ 0 captures the overall level of openness of the world and an increase in t indicates a fall in trade
costs, and suppose that there are a large number of districts (so that the equilibrium market tightness is
constant across states of the world). Then:
    (1) [Stylized Fact 1] Moving from autarky to costly trade increases the volatility of nominal income and
                                                              2 and σ2 to be the variance of the log of the
decreases the volatility of prices. More precisely, defining σi,Y     i,P
                                                                                                        f
numerator and the denominator, respectively, of the real returns Zi (s):
                                                   2
                                                 dσi,Y                             2
                                                                                 dσi,P
                                                         |t=0 > 0 and                           |t=0 < 0.
                                                  dt                                dt
    (2) [Stylized Fact 2] Any increase in openness decreases the responsiveness of local prices to local yield
shocks:
                                                ∂ ln pig (s)
                                                            
                                         d
                                              −                < 0.
                                         dt     ∂ ln Aig (s)

                                                                        11
(3) [Stylized Fact 3] Any increase in openness causes farmers to reallocate production toward crops with
higher mean yields. Moreover, as long as farmers are sufficiently risk averse (i.e. ρi is sufficiently large and
positive), goods are substitutes (i.e. σ ≥ 1), and local prices are not too responsive to local productivity
shocks (i.e. (1 − Tii ) θig ≥ Tii α g ), then any increase in openness causes farmers to reallocate production
toward crops with less volatile yields, with the latter effect attenuated the greater the access to insurance
(i.e. the lower ρi ). Formally, for any two crops g 6= h:

                                                                           d ∂2 ln θig − ln θih
                                                                                               
           d ∂ ln θig − ln θih            d ∂ ln θig − ln θih
                        A
                                  > 0,               A,i
                                                                ≤ 0, and −           A,i
                                                                                                   ≥ 0.
           dt        ∂µig                dt       ∂Σ gg                    dt     ∂Σ gg  ∂ρi

Proof. [Part 1]. From Proposition 1, nominal income xig (s) ≡ Aig (s) pig (s) is log-normally dis-
tributed:                                                   
                                      ln xi ∼ N µ x,i , Σ x,i ,

where:                                                                    !
                                                              N                              N
                                   1                                                                              
                                                             ∑ Tij ε̄ j            ln ϕ̄ g − ∑ Tij ln θ jg + µ g + µ gA,i
                                                                                                               A,j
                        µ x,i
                                                                                          
                          g       ≡ ln α g −
                                   σ                         j =1                                      j =1

                                                                         !               !                                                              !             !0
                                                            N                                                                           N
             Σ   x,i
                       ≡ (1 − Tii ) I −                     ∑ Tij ε̄ j        D    ϕ,i
                                                                                             Σ   A,i
                                                                                                          (1 − Tii ) I −               ∑ Tij ε̄ j           D   ϕ,i

                                                            j =1                                                                       j =1
                                                            !                         !                                        !                    !0
                                                N                                                                N
                           +∑                ∑ Tij ε̄ j         D ϕ,j + Tij I             Σ A,j               ∑ Tij ε̄ j           D ϕ,j + Tij I            .
                                j 6 =i       j =1                                                             j =1

Applying the same second order approximation as in Proposition 1, we have that the variance of
the log nominal income is approximately:
                                                                                  G      G
                                                                     2
                                                                    σY,i ≡        ∑ ∑ θig θih Σx,i
                                                                                               gh .
                                                                              g =1 h =1

Similarly, the variance of the log price index is approximately:
                                                                                          G       G
                                                                                         ∑ ∑ αg αh Σgh ,
                                                             2                                                           p,i
                                                            σP,i ≡ ( σ − 1)
                                                                                         g =1 h =1

where:
                                                                !                         !                                             !                         !0
                           N             N                                                                           N
            Σ   p,i
                       =   ∑             ∑ Tij ∑ ε jk               D   ϕ,j
                                                                              + Tij I Σ           A,j
                                                                                                                     ∑ Tij ∑ ε jk             D   ϕ,j
                                                                                                                                                        + Tij I        .
                           j =1          j =1       k6= j                                                            j =1      k6= j


    If there are many locations (so that D ϕ,j = 0), then these expressions simplify:

                                                        Σ x,i = (1 − Tii ) Σ A,i + ∑ Tij2 Σ A,j .
                                                                                                        j 6 =i
                                                                              N
                                                              Σ p,i =     ∑ Tij2 Σ A,j ,
                                                                          j =1



                                                                                         12
so that:
                                                                      A,i
                                           (
                               2
                             ∂σi,Y             −2 (1 − Tii ) ∑ g ∑h Σ gh  θig θih < 0 if i = j
                                       =                     A,i
                              ∂Tij             2Tij ∑ g ∑h Σ gh  θig θih > 0                                                       if i 6= j
and:
                                               2
                                             ∂σP,i                      G        G
                                                                       ∑ ∑ αg αh Σgh
                                                                                                        A,j
                                                           = 2Tij                                              > 0.
                                             ∂Tij                      g =1 h =1

    As a result, we have:
                                                                                                        !
                             2
                           dσi,Y                                2
                                                              dσi,Y                       2
                                                                                        dσi,Y
                                 1
                            dt
                               = 2
                                σ               ∑ ε ij dTij            − ∑ ε ij
                                                                                          dTii
                                                                                                              ⇐⇒
                                                j 6 =i                      j 6 =i
                                                                                                            !
                             2
                           dσi,Y 1
                            dt
                               = 22
                                σ                 ∑ ε ij Tij + ∑ ε ij (1 − Tii ) ∑ ∑ Σgh
                                                                                      A,i
                                                                                          θig θih
                                                  j 6 =i                j 6 =i                                     g       h

We also have:
                                                                                                               !
                                 2
                               dσi,P                                    2
                                                                      dσi,P                              2
                                                                                                       dσi,P
                                        1
                                   dt
                                      = 2
                                       σ                   ∑ ε ij dTij           − ∑ ε ij
                                                                                                       dTii
                                                                                                                       ⇐⇒
                                                           j 6 =i                    j 6 =i
                                                                                                  !
                                 2
                               dσi,Y                                                                    G      G
                                        1
                                                             ∑ ε ij                                     ∑ ∑ αg αh Σgh .
                                                                                                                                     A,j
                                      = 22                              Tij − Tii
                                   dt  σ                     j 6 =i                                    g =1 h =1

Finally, evaluating at t = 0 yields:
                                                                       !                               !                                       !
                  2                    σ + ∑ j6=i ε ij − 1
                ∂σi,Y                                                            1
                 ∂t
                        | t =0 = 2
                                           σ + ∑ j6=i ε ij                       σ2    ∑ ε ij                  ∑ ∑ Σgh
                                                                                                                    A,i
                                                                                                                        θig θih                    >0
                                                                                       j 6 =i                   g          h
                                                                           !                               !                                       !
                  2                        σ + ∑ j6=i ε ij − 1
                ∂σi,P                                                                1
                 ∂t
                        | t =0 = − 2
                                             σ + ∑ j6=i ε ij                         σ2       ∑ ε ij                ∑∑                A,i
                                                                                                                                    Σ gh  α g αh       < 0,
                                                                                              j 6 =i                   g       h

as claimed.
    [Part 2]. The matrix T (t) ≡ E (t)−1 , where E (t) ≡ σI + (diag (ε1 N + (ε i0 )i ) − ε) t and ε is the
N × N matrix with zeros on diagonal and ε ij off diagonal. Using the familiar expression for the
derivative of an inverse of a matrix, we have:

                                             dT (t)                dE (t)
                                                    = − E ( t ) −1        E ( t ) −1
                                              dt                    dt

Since E (t) is an M-matrix (see above), all elements of its inverse T (t) ≡ E (t)−1 are strictly posi-
tive. Hence we have:
                               dTii (t)
                                        = −T (t) diag (ε1 N + (ε i0 )i ) T (t) < 0
                                  dt
                                                                                                           
                                                                    ∂ ln p (s)                  ∂ ln p (s)
since diag (ε1 N + (ε i0 )i ) > 0. From equation (8), we have − ∂ ln Aig (s) = − Tii , so dtd − ∂ ln Aig (s) < 0
                                                                          ig                          ig
as claimed.




                                                                            13
    [Part 3]. Taking logs of equation (16) yields:

                      ln θig = ln α g − µ gA,i − ε̄ i ln ϕ g + σ ln big + ∑ ε ij t ln big − ln b jg − Ci ,
                                                                                                   
                                                                                              j 6 =i
                                                                                           
where ln big ≡ µ gA,i − ln λi − 21 Σ x,i
                                      gg −      G
                                             ∑h=1 ih θ     Σ x,i
                                                             gh  − Σ z,i
                                                                      gh   − ρ     G
                                                                                         Σ z,i
                                                                               i ∑ h=1 ih gh
                                                                                      θ           and the crop-invariant
                                          −1                   ε ij 
                                                                   big
constant Ci ≡ ln ∑G                    A,i
                         g=1 α g exp µ g        ϕ̄−
                                                  g big ∏ j6=i b jg
                                                    ε̄ i σ
                                                                             ensures the land constraint holds.
Hence, the difference in crop allocation between any two crops g 6= h can be expressed as:
                                                                                                  !
           ln θig − ln θih = ln α g − µ gA,i − ε̄ i ln ϕ g + σ ln big + ∑ ε ij ln big − ln b jg
                                                                                                
                                                                                                    −
                                                                                                           j 6 =i
                                                                                                                                               !
                                              ln αh − µhA,i         − ε̄ i ln ϕh + σ ln bih + ∑ ε ij ln bih − ln b jh
                                                                                                                                           
                                                                                                           j 6 =i


Taking the partial derivative with respect to µ gA,i (holding constant λi ) yields:
                                                                                                                   !
                                                ∂ ln θig − ln θih
                                                                              =    σ + ∑ ε ij t − 1
                                                          ∂µ gA,i                             j 6 =i

so that:                                                                 
                                                     d ∂ ln θig − ln θih
                                                     dt      ∂µ gA,i
                                                                           =            ∑ ε ij > 0,
                                                                                        j 6 =i

as required. Similarly, we have:
                                                                                                      !
                                                d ∂ ln θig − ln θih                                        ∂ ln big
                                                dt         A,i
                                                        ∂Σ gg
                                                                      =              ∑ ε ij                    A,i
                                                                                                            ∂Σ gg
                                                                                     j 6 =i

and:                                                                                                   !
                                              d ∂2 ln θig − ln θih                                         ∂2 ln big
                                                                   

                                              dt        A,i
                                                    ∂Σ gg   ∂ρi
                                                                     =              ∑ ε ij                    A,i
                                                                                                           ∂Σ gg  ∂ρi
                                                                                     j 6 =i
                                                                                                               
                                                                                                             ∂ ln big
Since ln big ≡ µ gA,i − ln λi − 21 Σ x,i
                                     gg  −  G
                                           ∑h=1 ih
                                                θ    Σ x,i
                                                       gh  − Σ z,i
                                                               gh    − ρ     G
                                                                                θ  Σ z,i
                                                                         i ∑ h=1 ih gh      , we have sign       A,i    =
                                                                                                              ∂Σ gg
                                          !
            1 x,i      G
            2 Σ gg − ∑ h=1 θih   Σ x,i    z,i       G         z,i
                                   gh − Σ gh − ρi ∑ h=1 θih Σ gh                                                                         θih Σz,i
                                                                                               
        ∂                                                                               ∂2 ln big
                                                                                      h =1     gh                               ∂ ∑G
sign                       A,i                                A,i     = −sign
                                                                        and sign           A,i     . As long as
                        ∂Σ gg                              ∂Σ gg  ∂ρi                  ∂Σ gg

                                                                                                  ∂ ∑h=1 θih Σz,i
                                                                                               G               
                                                                         ∂ ln big                             gh
ρi is sufficiently large (i.e. producers are risk averse), then sign         A,i    = −sign              A,i        .
                                                                                                                    ∂Σ gg                            ∂Σ gg
                                                                                                                            ∂ ∑hG=1 θih Σz,i
                                                                                                                                         gh
Hence, to prove the remainder of Part 3, it only remains to show that                                                              A,i         > 0, i.e. an in-
                                                                                                                                ∂Σ gg
crease in the variance of the log yield of crop g increases the total variance of real returns. To see
this, we first note that ∑hG=1 Σz,i      1 ∂      G     G     z,i
                                gh θih = 2 ∂θig ∑ g=1 ∑ h=1 Σ gh θig θih . Then, recall from Proposition 1 that




                                                                              14
the variance-covariance of real returns in location i can be written as:
                               !               !!                                                                                !                           !!0
                                     N                                                                              N
 Σz,i ≡         I−       Tii B +   ∑ Tij ε̄ j       BD ϕ,j + D̃ψ,i               Σ A,i         I−      Tii B +     ∑ Tij ε̄ j          BD ϕ,j + D̃ψ,j
                                   j =1                                                                            j =1
                                                !                            !                                          !                           !0
                                    N                                                                       N
          + ∑ Tij B +              ∑ Tjk ε̄ k       BD    ϕ,j
                                                                + D̃   ψ,i
                                                                                 Σ   A,j
                                                                                           Tij B +         ∑ Tjk ε̄ k       BD   ϕ,j
                                                                                                                                       + D̃   ψ,j
                                                                                                                                                         ,
                j 6 =i             k =1                                                                    k =1


where B ≡ (IG − 1G~α0 ) is a G × G matrix (where 1G is an G × 1 matrix of ones and ~α ≡ α g g )
                                                                                                
                   0               h
                                      ∂ ln ψ
                                             i
and D̃ψ,j ≡ 1G Dψ,j , where Dψ,j ≡ ∂ ln A jg is a vector of elasticities of the transfers to farmers
                                                                         g
from traders to the productivity shocks in district j. With a large number of districts (so that the
D matrices are equal to zero) and noting that the variance-covariance matrix of local yields only
enters the first term, we have:

          G                                     G    G
  ∂                           1     ∂2
   A,i
∂Σ gg
         ∑      Σz,i
                 gh θih =          A,i
                              2 ∂Σ gg  ∂θig
                                              ∑ ∑ Σz,i
                                                   gh θig θih                ⇐⇒
         h =1                                 g =1 h =1
                                                G     G
                              1 ∂2     ∂
                          =             A,i
                              2 ∂θig ∂Σ gg      ∑ ∑ Σz,i
                                                     gh θig θih              ⇐⇒
                                              g =1 h =1
                                                                                                       !
                            1 ∂             ∂ ~
                          =                     θ (I − Tii B) Σ A,i (I − Tii B)0 ~θi
                                             A,i i
                                                                                                            ⇐⇒
                            2 ∂θig        ∂Σ gg
                                                                                                             !
                            1 ∂         ∂ ~0                                                            0
                                            θ (1 − Tii ) I − Tii 1G~α0 Σ A,i (1 − Tii ) I − Tii 1G~α0 ~θi ⇐⇒
                                                                                                     
                          =              A,i i
                            2 ∂θig    ∂Σ gg
                                                                                                                            !   !
                                               G                                             G                      G
                            1 ∂         ∂                                                                   
                                         A,i ∑
                          =                            (1 − Tii ) Σhl − (1 − Tii ) Tii ∑ αk Σhk + Σkl + Tii ∑ Σlk αl αk θih θil
                                                                 2 A,i                            A,i    A,i   2        A,i
                            2 ∂θig ∂Σ gg     h,l =1                                        k =1                  l,k =1
                            1 ∂                                                           
                          =          (1 − Tii )2 θig2
                                                      − 2 (1 − Tii ) Tii α g θig + Tii2 α2g ⇐⇒
                            2 ∂θig
                            1 ∂                              2
                          =         (1 − Tii ) θig − Tii α g ⇐⇒
                            2 ∂θig
                                                      
                          = (1 − Tii ) θig − Tii α g (1 − Tii )

Note that Tii ≤ 1 as long as σ ≥ 1 (since ∑ N         1
                                            j=1 Tij = σ ) so we have that:

                                                                                                 G
                                                                                           ∂
                                         (1 − Tii ) θig ≥ Tii α g =⇒                      A,i
                                                                                       ∂Σ gg
                                                                                                ∑ Σz,i
                                                                                                   gh θih ≥ 0,
                                                                                                h =1

as required.

A.6      Approximating the matrix T of price elasticities
    In this subsection, we describe how we approximate the matrix T of price elasticities. Recall
that T ≡ E−1 , where:                  (
                                         ∑ j6=i ε ij + σ if i = j
                                   E=                             .
                                         −ε ij           o/w

                                                                             15
Because E is diagonally dominant with negative off-diagonal elements and positive diagonal ele-
                         Because E is an M-matrix, it can be expressed as E = κI − B, where I is an
ments, it is an M-matrix.
identity matrix, B = Bij where Bij ≥ 0, and κ is greater than the maximum eigenvalue of B (see
e.g. Plemmons (1977) for a discussion of the many properties of M-matrices). Define Ẽ ≡ κ1 E and
B̃ ≡ κ1 B. Note that Ẽ = I − B̃ is also an M-matrix and B̃ has a maximum eigenvalue smaller than 1.
                                    −1
    Note that T = E−1 = κ Ẽ            = κ1 Ẽ−1 . Furthermore, recall that because B̃ has a maximum
eigenvalue smaller than 1, the following representation its geometric infinite sum holds:
                                             ∞                         −1
                                          ∑ B̃k =           I − B̃           = Ẽ−1 .
                                          k =0

Hence we can write the matrix of price elasticities as an infinite sum of the (appropriately scaled)
matrix of bilateral Pareto shape parameters:

                                                1 ∞
                                                          k
                                                         1
                                             T = ∑ I− E .
                                                κ k =0   κ

A first order approximation of T is hence:

                                          2     1
                                  T≈        I − 2 E ⇐⇒
                                          κ     κ
                                          (                           
                                             1
                                              2 2κ − σ − ∑ j 6 =i ε ij                    if i = j
                                  Tij ≈     κ
                                             1
                                                ε
                                             κ 2 ij
                                                                                          o/w

Using this approximation in the estimating equation results in:
                            N
             ln pigt = − ∑ Tij ln A jgt + δit + δig + δgt + νigt ⇐⇒
                           j =1
                                                                                  A jgt
                                                                                         
                           1                    1
             ln pigt   = − 2 (2κ − σ) ln Aigt − 2
                          κ                    κ             ∑ ε ij ln            Aigt
                                                                                              + δit + δig + δgt + µigt
                                                             j 6 =i

Finally, if we assume that the Pareto shape parameters are parametrized by travel time Dij , i.e.
          −φ
ε ij = βDij , where β is an unknown parameter, we can write:

                                                                          A jgt
                                                                                 
                  ln pigt = −γ1 ln Aigt − γ2 ∑
                                                            −φ
                                                           Dij ln                     + δit + δig + δgt + µigt ,
                                                  j 6 =i
                                                                          Aigt

             1                        β
where γ1 ≡   κ2
                  (2κ − σ) and γ2 ≡   κ2
                                         ,   as claimed in the main text.
A.7   Counterfactual procedure
    In this subsection, we describe the counterfactual procedure used in Section 5.2.
    We first describe the inputs used
                                   in the counterfactuals. For each district and
                                                                               each decade, we
calculate the log mean yield µiA and the variance-covariance matrix Σ A,i of log yields using
variation across years within the decade in observed log yields. For crops that were not grown in
a district in a given decade, we set the mean and standard deviation of log yields equal to zero
and the area allocated to their production to a small number (10−6 ). Effectively, this implies that


                                                              16
any crops that are not grown in the data will not be grown in the counterfactuals (see Figure 4)
as the estimated crop costs will be large; alternative choices of the small number have a negligible
effect on the quantitative
                            results that follow. For the demand parameters, we use the estimated
demand shifters α g and elasticity of substitution (σ ) from Column 2 of Table 4, where the de-
mand shifters are normalized to sum to one, and the implied effective risk aversion (ρi ) given
observed bank access uses the estimates in Column 4 of Table 6. For the trade costs ε ij , we use
the estimates from Column 2 of Table 5 (which yield a quadratic equation that can be solved for
the relationship between observed travel
                                             time and trade costs).
     For any set of crop choices θig , we can use these inputs to calculate the mean real returns
                                         
  µi , the variance of real returns σi2,Z , and, given ρi and the estimated crop costs, the welfare of
   Z
     

farmers in each location using Proposition 1. Note that because Proposition 1 relies on a second or-
der approximation, the welfare results reported are also approximations. (However, Monte Carlo
simulations suggests the approximations are highly correlated with true welfare, with correlations
exceeding 0.95). Because the crop costs are only identified up to scale, we normalize the crop cost
of one crop to one; note this normalization does not affect our estimates of the gains from trade
(which are changes in welfare). To determine how the market tightness ϕ g and transfers from
traders (ψ) are affected by productivity shocks around the world (and calculate the equilibrium
mean log market tightness ϕ̄ g and log transfer ψ̄, along with the D ϕ,i and Dψ,i matrices of elas-
ticites), we rely on numerical methods where we estimate the elasticities by evaluating how the
market tightness and trader transfers respond to a small yield shock around the mean yields for
all crop-districts in the world. (To solve for the equilibrium market tightness and trader transfers
in any state of the world, we rely on the aggregate goods market clearing condition from equation
(9) and a simple tatonnement procedure based on excess demand.) Similarly, we can construct the
mean real returns, variance of real returns, and welfare of “consumers” (whose utility in a state
of the world is simply the inverse of the price index) and “producers” (whose utility in a state of
the world is simply the nominal income less the estimated crop costs). Panel A of Table 7 (where
crop costs are constant) reports the results from this procedure, holding all inputs constant at their
observed 1970s levels except for trade costs, which we let evolve with the observed evolution of
travel times and using the observed 1970s crop choices.
     For Panel B of Table 7, we repeat the same procedure, except we find the set of crop allocations
that are consistent with farmer’s first order conditions from equation (15). In practice, the con-
struction of the D matrices is computationally intensive, so we proceed in two loops: in the inner
loop, we hold constant the D matrices and use a tatonnement iterative procedure to find the set of
crop choices that satisfy all farmers first order conditions starting from the observed crop choice
(in particular, when the mean standard deviation across crops in their first order conditions is less
that 10−2 ); in the outer loop, we use a simple iterative procedure to update the estimates of the D
matrices until the norm of successive iterations of the mean log market tightness ϕ̄ g is less than
10−2 . In practice, the counterfactual takes approximately an hour on a high speed computer.




                                                 17
                                               Table A.1: C ROP CHOICE AND OPENNESS

      Dependent variable:                         Fraction of land planted by crop
                          (1)       (2)       (3)        (4)        (5)        (6)     (7)         (8)
                                  MA measure using phi=1               MA measure using alternate speed
                          OLS       IV        OLS        IV         OLS        IV      OLS         IV
      Log(Mean Yield)     -0.025*** -0.031*** -0.025*** -0.028*** -0.008*** -0.008*    -0.011*** -0.009*
                          (0.003)   (0.006)   (0.004)    (0.008)    (0.002)    (0.004) (0.003)     (0.005)
      Log(Variance Yield) 0.001*    0.005*** 0.002**     0.005      0.000      0.001   0.001*      0.002
                          (0.001)   (0.002)   (0.001)    (0.003)    (0.000)    (0.001) (0.001)     (0.002)
      Log(Mean)XMA        0.011*** 0.015*** 0.011*** 0.012*** 0.019*** 0.029*** 0.024*** 0.024***
                          (0.001)   (0.002)   (0.001)    (0.003)    (0.003)    (0.004) (0.003)     (0.006)
      Log(Var)XMA         -0.001*** -0.003*** -0.001*** -0.001      -0.001** -0.006*** -0.002*** -0.004
                          (0.000)   (0.001)   (0.000)    (0.001)    (0.000)    (0.001) (0.001)     (0.002)
      Log(Mean)XBank                          0.029      -0.441                        0.289       0.326
                                              (0.451)    (0.883)                       (0.265)     (0.610)




18
      Log(Var)XBank                           -0.148*    -0.089                        -0.083      -0.282
                                              (0.088)    (0.462)                       (0.058)     (0.260)
      Log(Mean)XMAXBank                       -0.011     0.534                         -0.634** 0.683
                                              (0.160)    (0.335)                       (0.299)     (0.816)
      Log(Var)XMAXBank                        0.059**    -0.165                        0.149*** -0.251
                                              (0.029)    (0.193)                       (0.052)     (0.329)
      Crop-decade FE      Yes       Yes       Yes        Yes        Yes        Yes     Yes         Yes
      District-decade FE  Yes       Yes       Yes        Yes        Yes        Yes     Yes         Yes
      Crop-district FE    Yes       Yes       Yes        Yes        Yes        Yes     Yes         Yes
      R-squared           0.974     0.974     0.975      0.974      0.974      0.974   0.974       0.973
      Observations        13791     13790     13769      13768      13791      13790   13764       13763
      First-Stage F Stat  .         57.075    .          2.021      .          37.290  .           2.100
     Notes: Crop choice regressed on the log mean and variance of yields, and the log mean and variance of yields interacted with market
     access multiplied by 100,000 and/or banks per capita multiplied by 1000. Each observation is a crop-district-decade. Observations
     are weighted by the number of years observed within decade. In IV columns, mean of yield instrumented with mean of yield
     predicted from rainfall variation and crop-decade, district-decade and crop-district fixed effects (allowing coefficients on rainfall to
     vary by state-crop). Variance of yield instrumented with variance of yield predicted from rainfall variation and crop-district-decade
     fixed effects (allowing coefficients on rainfall to vary by state-crop-decade). Interaction terms instrumented by predicted yield terms
     interacted with market access and bank access. Standard errors clustered at the district-decade level are reported in parentheses.
     Stars indicate statistical significance: * p<.10 ** p<.05 *** p<.01.
Table A.2: E XAMPLES     OF RELATIONSHIP BETWEEN VOLATILITY AND THE GAINS FROM
TRADE


            E XAMPLE 1: Average productivity is the same in both locations
                          Autarky Trade     Gains from Trade
            No volatility
            Location 1    0        0        0
            Location 2    0        0        0

            Volatility
            Location 1      -0.125     -0.1032   0.0218
            Location 2      0          0.0201    0.0201

                 E XAMPLE 2: Comparative advantage goods are risky
                          Autarky Trade    Gains from Trade
            No volatility
            Location 1    0       0.7273 0.7273
            Location 2    0       0.7273 0.7273

              Volatility
              Location 1      -0.125      -0.125 0
              Location 2      -0.125      -0.125 0
Notes: This table reports the welfare of each location for the examples discussed in
Proposition 2 in Section 4.5. In each example, we calculate the gains from trade (i.e.
the difference between welfare with costly trade and in autarky) when productivity is
deterministic and when productivity is volatile. In example 1, two locations have the
same (unit) mean of two goods. In autarky, e = 0, whereas in trade e = 1. With volatility,
  A,1
Σ11   = 1 and µ11 = 0.5 to keep the average yield constant. In example 2, the µ11 = 1,
µ12 = 0, µ21 = 0, and µ22 = 0 so that location 1 (2) has a comparative advantage in
                                        A,1           A,1
good A (B). With volatility, we set Σ11     = 1 and Σ22   = 1 and reduce the log mean yield
of those two goods to 0.5 to keep average yield constant. In both examples, demand is
Cobb-Douglas with equal expenditure shares and the risk aversion parameter ρ = 2. See
the text in Section 4.5 for the intuition behind the results.




                                            19
Table A.3: E STIMATED CROP COSTS AND ACTUAL CROP COSTS

 Dependent variable:                Estimated Crop Costs (Log)
                                    (1)      (2)

 Actual Crop Costs (Log)         1.495***     1.495**
                                 (0.337)      (0.603)
 Decade FE                       Yes          Yes
 Crop FE                         Yes          Yes
 State-Decade-Crop Clustered SEs No           Yes
 R-squared                       0.324        0.324
 Observations                    3021         3021
Notes: Regression of the log of estimated crop costs on the log
of actual state-level crop costs, decade fixed effects and crop
fixed effects. Each observation is a crop-district-decade log
crop cost. Estimated crop costs come from a combination of
fixed effects and residuals from regression (23) which are the
unobserved crop costs that ensure that observed crop choices
in the data are optimal crop choices in the model. Raw data on
actual crop costs in Rupees/Hectare come from the Govern-
ment publication Cost of Cultivation of Principal Crops in India.
Data are annual at the state-crop level and cover 13 of our
15 crops between 1983-2008. To match with the crop-decade
level estimated crop costs, actual costs are deflated by the
all-India CPI and averaged over decades for each crop and
state. Standard errors are reported in parentheses. As the
actual crop costs are only at the State level, Column 2 clusters
standard errors at the state-decade-crop level. Stars indicate
statistical significance: * p<.10 ** p<.05 *** p<.01.




                               20
Table A.4: C ROP CHARACTERISTICS     AND THE RESPONSE OF CROP ALLOCATIONS TO THE
I NDIAN H IGHWAY E XPANSION

   Dependent variable:            Change of the Log of the Optimal Fraction of Land
                              Change across decades Change between 1970s and 2000s
                              (1)        (2)             (3)     (4)
    Log of std.dev. of        -0.047*** -0.061***        -0.040 -0.035
    1970s log yields          (0.017)    (0.018)         (0.031) (0.034)
    Log of mean of            0.300*** 0.351***          0.176   0.083
    1970s log yields          (0.108)    (0.125)         (0.179) (0.256)
    Crop-decade FE            Yes        Yes             Yes     Yes
    District FE               No         Yes             No      Yes
    R-squared                 0.192      0.273           0.013   0.191
    Observations              10155      10155           3385    3381
Notes: Ordinary least squares. The dependent variable is the change of the log of the
optimal fraction of land (as calculated by the model) allocated between time periods in
response to the expansion of the highway network holding all other parameters fixed,
where the difference is either taken across decades (in columns 1 and 2) or between the
1970s and the 2000s (in columns 3 and 4). Each observation is a district-crop-decade
triplet. Standard errors clustered at the district level are reported in parentheses. Stars
indicate statistical significance: * p<.10 ** p<.05 *** p<.01.




                                            21
                               Figure A.1: D ISTRIBUTION OF P RICES AND MSP S IN 1970-71

                              Barley                                             Chickpea                                    Cotton                                        Finger Millet
           4




                                                             4




                                                                                                                                                               6
                                                                                                            3
           3




                                                             3




                                                                                                                                                               4
                                                                                                            2
           2




                                                             2




                                                                                                                                                               2
                                                                                                            1
           1




                                                             1
           0




                                                             0




                                                                                                            0




                                                                                                                                                               0
               3.6    3.8     4         4.2    4.4    4.6        4           4.5             5        5.5        4.5         5           5.5              6        3.5           4            4.5            5
                            Groundnut                                            Linseed                                     Maize                                                   Paddy
           4




                                                                                                            3




                                                                                                                                                               4
                                                             6
           3




                                                                                                                                                               3
                                                                                                            2
                                                             4
           2




                                                                                                                                                               2
                                                                                                            1
                                                             2
           1




                                                                                                                                                               1
 Density
           0




                                                             0




                                                                                                            0




                                                                                                                                                               0
                                                                                                                                                                           MSP
               4       4.5          5          5.5      6        4.5             5          5.5        6        3.6    3.8   4         4.2     4.4       4.6       3.5       4               4.5         5
                            Pearl Millet                                     Pigeonpea                           Rape and Mustard Seed                                               Rice
                                                             5




                                                                                                            5
           5




                                                                                                                                                               3
                                                             4




                                                                                                            4
           4




                                                                                                                                                               2
                                                             3




                                                                                                            3
           3




                                                             2




                                                                                                            2
           2




                                                                                                                                                               1
                                                             1




                                                                                                            1
           1
           0




                                                             0




                                                                                                            0




                                                                                                                                                               0
               3.6    3.8     4         4.2     4.4    4.6           4.2   4.4       4.6   4.8    5   5.2       4.5               5                      5.5       4         4.5               5             5.5
                             Sesamum                                             Sorghum                               Sugar (from cane)                                             Wheat
           6




                                                                                                            4




                                                                                                                                                               4
                                                             4




                                                                                                            3




                                                                                                                                                               3
                                                             3
           4




                                                                                                            2




                                                                                                                                                               2
                                                             2
           2




                                                                                                            1




                                                                                                                                                               1
                                                             1
           0




                                                             0




                                                                                                            0




                                                                                                                                                               0
                                                                                                                                                                                     MSP
                4.8     5     5.2        5.4    5.6    5.8       3.5             4          4.5        5          4              4.5                 5                 4   4.2         4.4         4.6   4.8

                                                                                 Log Price (Log Rs. per 100kg)

Notes: This figure plots the distribution of log prices across districts for our sample crops
in the 1970-71 crop year. Vertical lines show minimum support prices (MSPs) for crops
with MSPs in 1970-71.




                                                                                                      22
                                  Figure A.2: D ISTRIBUTION OF P RICES AND MSP S IN 1980-81

                                 Barley                                                 Chickpea                                                                 Cotton                                                Finger Millet
           8




                                                                      6




                                                                                                                             5




                                                                                                                                                                                                8 10
                                                                                                                             4
           6




                                                                      4




                                                                                                                             3




                                                                                                                                                                                                6
           4




                                                                                                                             2




                                                                                                                                                                                                4
                                                                      2
           2




                                                                                                                             1




                                                                                                                                                                                                2
           0




                                                                      0




                                                                                                                             0




                                                                                                                                                                                                0
                                                                          MSP                                                                               MSP
               4.5                     5                    5.5                         5.4   5.6     5.8         6   6.2                  5          5.5             6           6.5       7          4.4         4.6MSP    4.8          5   5.2
                             Groundnut                                                   Linseed                                                                 Maize                                                      Paddy
           8




                                                                                                                             4




                                                                                                                                                                                                3
                                                                      6
           6




                                                                                                                             3




                                                                                                                                                                                                2
                                                                      4
           4




                                                                                                                             2




                                                                                                                                                                                                1
                                                                      2
           2




                                                                                                                             1
 Density
           0




                                                                      0




                                                                                                                             0




                                                                                                                                                                                                0
               MSP                                                                                                                                                                                                MSP
                 5.4   5.6       5.8       6         6.2    6.4           5.4     5.6         5.8         6           6.2                  4                5             6             7                4.5                   5              5.5
                         Pearl Millet                                                 Pigeonpea                                             Rape and Mustard Seed                                                           Rice




                                                                                                                             6




                                                                                                                                                                                                5
           4




                                                                      4




                                                                                                                                                                                                4
           3




                                                                      3




                                                                                                                             4




                                                                                                                                                                                                3
           2




                                                                      2




                                                                                                                                                                                                2
                                                                                                                             2
           1




                                                                      1




                                                                                                                                                                                                1
           0




                                                                      0




                                                                                                                             0




                                                                                                                                                                                                0
                         MSP                                              MSP
                 4.4   4.6   4.8               5      5.2     5.4               5.4     5.6         5.8       6        6.2                 5            5.5               6             6.5                  5                5.5              6
                             Sesamum                                                    Sorghum                                                      Sugar (from cane)                                                      Wheat
                                                                                                                             1 1.5 2 2.5
           6




                                                                      5




                                                                                                                                                                                                4
                                                                      4




                                                                                                                                                                                                3
           4




                                                                      3




                                                                                                                                                                                                2
                                                                      2
           2




                                                                                                                                                                                                1
                                                                                                                             .5
                                                                      1
           0




                                                                      0




                                                                                                                             0




                                                                                                                                                                                                0
                                                                                   MSP                                                     MSP                                                                   MSP
               5.5           6                 6.5                7       4.4    4.6   4.8           5        5.2      5.4                       5              5.5           6         6.5            4.5              5           5.5        6

                                                                                         Log Price (Log Rs. per 100kg)

Notes: This figure plots the distribution of log prices across districts for our sample crops
in the 1980-81 crop year. Vertical lines show minimum support prices (MSPs) for crops
with MSPs in 1980-81.




                                                                                                                      23
                                       Figure A.3: D ISTRIBUTION OF P RICES AND MSP S IN 1990-91

                                   Barley                                                     Chickpea                                                    Cotton                                        Finger Millet
           5




                                                                       4




                                                                                                                                                                                       5
                                                                                                                                   5
           4




                                                                                                                                                                                       4
                                                                                                                                   4
                                                                       3
           3




                                                                                                                                                                                       3
                                                                                                                                   3
                                                                       2
           2




                                                                                                                                                                                       2
                                                                                                                                   2
                                                                       1
           1




                                                                                                                                                                                       1
                                                                                                                                   1
           0




                                                                       0




                                                                                                                                   0




                                                                                                                                                                                       0
               MSP
               5.2         5.4         5.6         5.8         6           6MSP       6.2         6.4         6.6    6.8       7       6        MSP
                                                                                                                                                    6.5         7             7.5                  5   MSP
                                                                                                                                                                                                       5.2     5.4      5.6     5.8   6
                                 Groundnut                                                        Linseed                                                  Maize                                              Paddy




                                                                                                                                                                                       4
                                                                       4




                                                                                                                                   3
           4




                                                                                                                                                                                       3
                                                                       3
           3




                                                                                                                                   2




                                                                                                                                                                                       2
                                                                       2
           2




                                                                                                                                   1




                                                                                                                                                                                       1
                                                                       1
           1
 Density
           0




                                                                       0




                                                                                                                                   0




                                                                                                                                                                                       0
                           MSP                                                                                                                                                                         MSP
               6             6.5              7                7.5          6         6.2         6.4     6.6       6.8    7           5      5.2     5.4     5.6       5.8    6               5             5.5          6           6.5
                                 Pearl Millet                                                Pigeonpea                                  Rape and Mustard Seed                                                      Rice
           4




                                                                       4




                                                                                                                                   4




                                                                                                                                                                                       4
           3




                                                                       3




                                                                                                                                   3




                                                                                                                                                                                       3
           2




                                                                       2




                                                                                                                                   2




                                                                                                                                                                                       2
           1




                                                                       1




                                                                                                                                   1




                                                                                                                                                                                       1
           0




                                                                       0




                                                                                                                                   0




                                                                                                                                                                                       0
                     MSP                                                                     MSP                                               MSP
               5                 5.5              6              6.5       5.5          6               6.5         7      7.5         6             6.5            7          7.5         5           5.5          6         6.5     7
                                 Sesamum                                                      Sorghum                                         Sugar (from cane)                                               Wheat
           3




                                                                       4




                                                                                                                                                                                       5
                                                                                                                                   3




                                                                                                                                                                                       4
                                                                       3
           2




                                                                                                                                   2




                                                                                                                                                                                       3
                                                                       2




                                                                                                                                                                                       2
           1




                                                                                                                                   1
                                                                       1




                                                                                                                                                                                       1
           0




                                                                       0




                                                                                                                                   0




                                                                                                                                                                                       0
                                                                                            MSP                                        MSP                                                             MSP
               6.6         6.8         7     7.2         7.4     7.6              5                       5.5                  6        5.5           6             6.5            7       5             5.5              6           6.5

                                                                                                  Log Price (Log Rs. per 100kg)

Notes: This figure plots the distribution of log prices across districts for our sample crops
in the 1990-91 crop year. Vertical lines show minimum support prices (MSPs) for crops
with MSPs in 1990-91.




                                                                                                                           24
                                          Figure A.4: D ISTRIBUTION OF P RICES AND MSP S IN 2000-01

                                       Barley                                               Chickpea                                                  Cotton                                      Finger Millet




                                                                            4




                                                                                                                                                                                      6
                                                                                                                                 6
           10




                                                                            3




                                                                                                                                                                                      4
                                                                                                                                 4
                                                                            2
           5




                                                                                                                                                                                      2
                                                                                                                                 2
                                                                            1
           0




                                                                            0




                                                                                                                                 0




                                                                                                                                                                                      0
                5.8         6 MSP         6.2     6.4           6.6             6     6.5          MSP
                                                                                                      7         7.5     8              7      MSP
                                                                                                                                                7.5              8          8.5           5.5         6MSP         6.5     7
                                    Groundnut                                                Linseed                                                  Maize                                               Paddy




                                                                                                                                 4




                                                                                                                                                                                      5
           5




                                                                            6




                                                                                                                                                                                      4
           4




                                                                                                                                 3
                                                                            4




                                                                                                                                                                                      3
           3




                                                                                                                                 2




                                                                                                                                                                                      2
           2




                                                                            2




                                                                                                                                 1




                                                                                                                                                                                      1
           1
 Density
           0




                                                                            0




                                                                                                                                 0




                                                                                                                                                                                      0
                                    MSP
                  6.8           7      7.2      7.4       7.6     7.8           6.5         7               7.5              8         5.5          6 MSP         6.5             7       5.5         6      MSP
                                                                                                                                                                                                                    6.5         7
                                    Pearl Millet                                            Pigeonpea                                   Rape and Mustard Seed                                               Rice
                                                                            4




                                                                                                                                 5
           3




                                                                                                                                                                                      8
                                                                                                                                 4
                                                                            3




                                                                                                                                                                                      6
           2




                                                                                                                                 3
                                                                            2




                                                                                                                                                                                      4
                                                                                                                                 2
           1




                                                                            1




                                                                                                                                                                                      2
                                                                                                                                 1
           0




                                                                            0




                                                                                                                                 0




                                                                                                                                                                                      0
                5.5                  6 MSP       6.5                  7         6.5         7MSP           7.5           8             6.5          7MSP          7.5             8       6.4         6.6           6.8         7
                                    Sesamum                                                 Sorghum                                          Sugar (from cane)                                            Wheat
                                                                            4




                                                                                                                                 2




                                                                                                                                                                                      5
           4




                                                                                                                                                                                      4
                                                                                                                                 1.5
                                                                            3
           3




                                                                                                                                                                                      3
                                                                            2




                                                                                                                                 1
           2




                                                                                                                                                                                      2
                                                                                                                                 .5
                                                                            1
           1




                                                                                                                                                                                      1
           0




                                                                            0




                                                                                                                                 0




                                                                                                                                                                                      0
                          MSP                                                             MSP                                                                   MSP                                       MSP
                      7               7.5             8               8.5       5.8   6         6.2       6.4     6.6   6.8             4      5            6           7         8        6    6.2         6.4     6.6   6.8

                                                                                                Log Price (Log Rs. per 100kg)

Notes: This figure plots the distribution of log prices across districts for our sample crops
in the 2000-01 crop year. Vertical lines show minimum support prices (MSPs) for crops
with MSPs in 2000-01.




                                                                                                                        25
                                                                                                                                        Figure A.5: M EAN OF YIELDS : E XAMPLES
                                                                                Chittaurgarh, Rajasthan: 1970s                                                                                                                                                                                                                Chittaurgarh, Rajasthan: 2000s
                  8                                                                                                                                                                                                                                             8

                  7                                                                                                                                                                                                                                             7

                  6                                                                                                                                                                                                                                             6

                  5                                                                                                                                                                                                                                             5

                  4                                                                                                                                                                                                                                             4
Mean log yield




                                                                                                                                                                                                                                              Mean log yield
                  3                                                                                                                                                                                                                                             3

                  2                                                                                                                                                                                                                                             2

                  1                                                                                                                                                                                                                                             1

                  0                                                                                                                                                                                                                                             0

                 −1                                                                                                                                                                                                                                            −1

                 −2                                                                                                                                                                                                                                            −2

                 −3                                                                                                                                                                                                                                            −3
                                                                                                                         Pearl Millet




                                                                                                                                                                                                                                                                                                                                                                       Pearl Millet
                                   Chickpea




                                                                                                                                                                                                                                                                                 Chickpea
                                                                      Gnut




                                                                                                  Maize




                                                                                                                                                                                                    Sesamum




                                                                                                                                                                                                                                                                                                                    Gnut




                                                                                                                                                                                                                                                                                                                                                Maize




                                                                                                                                                                                                                                                                                                                                                                                                                                                  Sesamum
                      Barley




                                                                                                                                                                                                                                                                    Barley
                                                 Cotton




                                                                                                                                                    Pigeonpea




                                                                                                                                                                                       Rmseed




                                                                                                                                                                                                                  Sorghum




                                                                                                                                                                                                                                     Wheat




                                                                                                                                                                                                                                                                                               Cotton




                                                                                                                                                                                                                                                                                                                                                                                                  Pigeonpea




                                                                                                                                                                                                                                                                                                                                                                                                                                     Rmseed




                                                                                                                                                                                                                                                                                                                                                                                                                                                                Sorghum




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Wheat
                                                                                Linseed




                                                                                                                                                                                                                                                                                                                              Linseed
                                                                                                                                                                       Rice




                                                                                                                                                                                                                             Sugar




                                                                                                                                                                                                                                                                                                                                                                                                                     Rice




                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Sugar
                                                                                     Madurai, Tamil Nadu: 1970s                                                                                                                                                                                                                    Madurai, Tamil Nadu: 2000s
                 12                                                                                                                                                                                                                                            12


                 10                                                                                                                                                                                                                                            10


                  8                                                                                                                                                                                                                                             8


                  6                                                                                                                                                                                                                                             6
Mean log yield




                                                                                                                                                                                                                                              Mean log yield




                  4                                                                                                                                                                                                                                             4


                  2                                                                                                                                                                                                                                             2


                  0                                                                                                                                                                                                                                             0


                 −2                                                                                                                                                                                                                                            −2
                                                                                                          Pearl Millet




                                                                                                                                                                                                                                                                                                                                                        Pearl Millet
                        Chickpea




                                                                                                                                                                                                                                                                      Chickpea
                                                                         Gnut


                                                                                          Maize




                                                                                                                                                                                                Sesamum




                                                                                                                                                                                                                                                                                                                       Gnut


                                                                                                                                                                                                                                                                                                                                        Maize




                                                                                                                                                                                                                                                                                                                                                                                                                                              Sesamum
                                        Cotton




                                                                                                                                        Pigeonpea




                                                                                                                                                                              Rmseed




                                                                                                                                                                                                              Sorghum




                                                                                                                                                                                                                                                                                                                                                                                      Pigeonpea




                                                                                                                                                                                                                                                                                                                                                                                                                            Rmseed




                                                                                                                                                                                                                                                                                                                                                                                                                                                            Sorghum




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Wheat
                                                      Finger Millet




                                                                                                                                                                                                                                                                                      Cotton

                                                                                                                                                                                                                                                                                                    Finger Millet
                                                                                                                                                                Rice




                                                                                                                                                                                                                            Sugar




                                                                                                                                                                                                                                                                                                                                                                                                              Rice




                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Sugar
Notes: This figure shows the mean of (log) yields across crops for two example districts—
Chittargarh, Rajasthan (top row) and Madurai, Tamil Nadu (bottom row)—in both the
1970s (left column) and the 2000s (right column).




                                                                                                                                                                                                                                             26
               Figure A.6: C OVARIANCE MATRIX OF YIELDS : E XAMPLES




Notes: This figure shows the co-variance of (log) yields across crops for two example
districts—Chittargarh, Rajasthan (top row) and Madurai, Tamil Nadu (bottom row)—in
both the 1970s (left column) and the 2000s (right column).




                                         27
                  Figure A.7: C ROP CHOICE OVER TIME : E XAMPLES

      Chittaurgarh, Rajasthan: 1970s             Chittaurgarh, Rajasthan: 2000s




       Madurai, Tamil Nadu: 1970s                 Madurai, Tamil Nadu: 2000s




           Chickpea          Cotton               Gnut               Maize
           Other             Pearl Millet         Pigeonpea          Rice
           Rmseed            Sesamum              Sorghum            Sugarcane (gur)

Notes: This figure shows the allocation of land for two example districts—Chittargarh,
Rajasthan (top row) and Madurai, Tamil Nadu (bottom row)—in both the 1970s (left
column) and the 2000s (right column).




                                            28
