                                  NBER WORKING PAPER SERIES




                COMPETITION AND EFFICIENCY IN CONGESTED MARKETS

                                            Daron Acemoglu
                                            Asuman Ozdaglar

                                          Working Paper 11201
                                  http://www.nber.org/papers/w11201


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                      March 2005




We thank Xin Huang, Ramesh Johari, Eric Maskin, Nicolas Stier Moses, Jean Tirole, John Tsitsiklis, Ivan
Werning, Muhamet Yildiz and participants at the INFORMS conference, Denver 2004 for useful comments.
The views expressed herein are those of the author(s) and do not necessarily reflect the views of the National
Bureau of Economic Research.

 © 2005 by Daron Acemoglu and Asuman Ozdaglar All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice, is
given to the source.
Competition and Efficiency in Congested Markets
Daron Acemoglu and Asuman Ozdaglar
NBER Working Paper No. 11201
March 2005
JEL No. D43, C62

                                            ABSTRACT

We study the efficiency of oligopoly equilibria in congested markets. The motivating examples are
the allocation of network flows in a communication network or of traffic in a transportation network.
We show that increasing competition among oligopolists can reduce efficiency, measured as the
difference between users' willingness to pay and delay costs. We characterize a tight bound of 5/6
on efficiency in pure strategy equilibria. This bound is tight even when the number of routes and
oligopolists is arbitrarily large. We also study the efficiency properties of mixed strategy equilibria.

Daron Acemoglu
Department of Economics
MIT, E52-380B
50 Memorial Drive
Cambridge, MA 02142-1347
and NBER
daron@mit.edu

Asuman Ozdaglar
Department of Electrical Engineering
and Computer Science
MIT
1         Introduction
We analyze price competition in the presence of congestion costs. Consider the following
environment: one unit of traffic can use one of I alternative routes. More traffic on a
particular route causes delays, exerting a negative (congestion) externality on existing
traffic.1 Congestion costs are captured by a route-specific non-decreasing convex latency
function, li (·). Profit-maximizing oligopolists set prices (tolls) for travel on each route
denoted by pi . We analyze subgame perfect Nash equilibria of this environment, where
for each price vector, p, all traffic chooses the path that has minimum (toll plus delay)
cost, li + pi , and oligopolists choose prices to maximize profits.
    The environment we analyze is of practical importance for a number of settings.
These include transportation and communication networks, where additional use of a
route (path) generates greater congestion for all users, and markets in which there are
“snob” effects, so that goods consumed by fewer other consumers are more valuable (see
for example, [38]). The key feature of these environments is the negative congestion
externality that users exert on others. This externality has been well-recognized since
the work by Pigou [27] in economics, by Samuelson [33], Wardrop [41], Beckmann et al.
[4] in transportation networks, and by Orda et. al. [23], Korilis et. al. [18], Kelly [17],
Low [20] in communication networks. More recently, there has been a growing literature
that focuses on quantification of efficiency loss (referred to as the price of anarchy) that
results from externalities and strategic behavior in different classes of problems; selfish
routing (Koutsoupias and Papadimitriou [19], Roughgarden and Tardos [31], Correa,
Schulz, and Stier-Moses [8], Perakis [26], and Friedman [12]), resource allocation by
market mechanisms (Johari and Tsitsiklis [16], Sanghavi and Hajek [32]), and network
design (Anshelevich et.al. [2]). Nevertheless, the game-theoretic interactions between
(multiple) service providers and users, or the effects of competition among the providers
on the efficiency loss has not been considered. This is an important area for analysis
since in most applications, (competing) profit-maximizing entities charge prices for use.
Moreover, we will show that the nature of the analysis changes significantly in the
presence of price competition.
    We provide a general framework for the analysis of price competition among providers
in a congested (and potentially capacitated) network, study existence of pure strategy
and mixed strategy equilibria, and characterize and quantify the efficiency properties of
equilibria. There are four sets of major results from our analysis.
    First, though the equilibrium of traffic assignment without prices can be highly
inefficient (e.g., [27], [31], [8]), price-setting by a monopolist internalizes the negative
externality and achieves efficiency.
    Second, increasing competition can increase inefficiency. In fact, changing the market
structure from monopoly to duopoly almost always increases inefficiency. This result
contrasts with most existing results in the economics literature where greater competition
tends to improve the allocation of resources (e.g. see Tirole [36]). The intuition for this
result is driven by the presence of congestion and is illustrated by the example we discuss
below.2
    1
        An externality arises when the actions of the player in a game affects the payoff of other players.
    2
        Because users are homogeneous and have a constant reservation utility in our model, in the absence


                                                      1
    Third, we provide a tight bound on the extent of inefficiency in the presence of
pricing, which applies irrespective of the number of routes, I. We show that social
surplus (defined as the difference between users’ willingness to pay and the delay cost)
in any pure strategy oligopoly equilibrium is always greater than 5/6 of the maximum
social surplus. Simple examples reach this 5/6 bound. Interestingly, this bound is
obtained even when the number of routes, I, is arbitrarily large.
    Fourth, pure strategy equilibria may fail to exist. This is not surprising in view of
the fact that what we have here is a version of a Bertrand-Edgeworth game where pure
strategy equilibria do not exist in the presence of convex costs of production or capac-
ity constraints (e.g., Edgeworth [11], Shubik [35], Benassy [6], Vives [40]). However,
in our oligopoly environment we show that when latency functions are linear, a pure
strategy equilibrium always exists, essentially because some amount of congestion ex-
ternalities remove the payoff discontinuities inherent in the Bertrand-Edgeworth game.
Non-existence becomes an issue in our environment when latency functions are highly
convex. In this case, we prove that mixed strategy equilibria always exist. We also show
that mixed strategy equilibria can lead to arbitrarily inefficient worst-case realizations;
in particular, social surplus can become arbitrarily small relative to the maximum social
surplus.
    The following example illustrates some of these results.
Example 1 Figure 1 shows a situation similar to the one first analyzed by Pigou [27]
to highlight the inefficiency due to congestion externalities. One unit of traffic will travel
from origin A to destination B, using either route 1 or route 2. The latency functions
are given by
                                              x2                2
                                     l1 (x) = ,        l2 (x) = x.
                                               3                3
It is straightforward
              P            to see that the efficient allocation [i.e., one that minimizes the total
                                   S                S
delay cost      i li (xi )xi ] is x1 = 2/3 and x2 = 1/3, while the (Wardrop) equilibrium
allocation that equates delay on the two paths is xW        1
                                                              E
                                                                ≈ .73 > xS1 and xW 2
                                                                                     E
                                                                                       ≈ .27 < xS2 .
The source of the inefficiency is that each unit of traffic does not internalize the greater
increase in delay from travel on route 1, so there is too much use of this route relative
to the efficient allocation.
    Now consider a monopolist controlling both routes and setting prices for travel to
maximize its profits. We will show in greater detail below that in this case, the monop-
olist will set a price including a markup, xi li0 (when li is differentiable), which exactly
internalizes the congestion externality. In other words, this markup is equivalent to the
Pigovian tax that a social planner would set in order to induce decentralized traffic to
choose the efficient allocation. Consequently, in this simple example, monopoly prices
will be pM1
            E
              = (2/3)3 +k and pM      2
                                        E
                                          = (2/32 )+k, for some constant k. The resulting traffic
in the Wardrop equilibrium will be identical to the efficient allocation, i.e., xM      1
                                                                                           E
                                                                                             = 2/3
       ME
and x2 = 1/3.
    Next consider a duopoly situation, where each route is controlled by a different profit-
maximizing provider. In this case, it can be shown that equilibrium prices will take the
of congestion externalities, all market structures would achieve efficiency, and a change from monopoly
to duopoly, for example, would have no efficiency consequence.

                                                  2
                                                                2
                                                         l1(x)=x /3

                       1 unit of
                        traffic

                                                         l2(x)=(2/3)x

       Figure 1: A two link network with congestion-dependant latency functions.


form pOEi   = xi (l10 + l20 ) [see Eq. (20) in Section 4], or more specifically, pOE
                                                                                  1  ≈ 0.61 and
p2 ≈ 0.44. The resulting equilibrium traffic is x1 ≈ .58 < x1 and x2 ≈ .42 > xS2 ,
  OE                                                      OE           S         OE

which also differs from the efficient allocation. We will show that this is generally the case
in the oligopoly equilibrium. Interestingly, while in the Wardrop equilibrium without
prices, there was too much traffic on route 1, now there is too little traffic because
of its greater markup. It is also noteworthy that although the duopoly equilibrium
is inefficient relative to the monopoly equilibrium, in the monopoly equilibrium k is
chosen such that all of the consumer surplus is captured by the monopolist, while in the
oligopoly equilibrium users may have positive consumer surplus.3
    The intuition for the inefficiency of duopoly relative to monopoly can be obtained as
follows. There is now a new source of (differential) monopoly power for each duopolist,
which they exploit by distorting the pattern of traffic: when provider 1, controlling route
1, charges a higher price, it realizes that this will push some traffic from route 1 to route
2, raising congestion on route 2. But this makes the traffic using route 1 become more
“locked-in,” because their outside option, travel on the route 2, has become worse.4 As
a result, the optimal price that each duopolist charges will include an additional markup
over the Pigovian markup. These are x1 l20 for route 1 and x2 l10 for route 2. Since these
two markups are generally different, they will distort the pattern of traffic away from
the efficient allocation. Naturally, however, prices are typically lower with duopoly, so
even though social surplus declines, users will be better off than in monopoly (i.e., they
will command a positive consumer surplus).
    Although there is a large literature on models of congestion both in transportation
and communication networks, very few studies have investigated the implications of
having the “property rights” over routes assigned to profit-maximizing providers. In [3],
Basar and Srikant analyze monopoly pricing under specific assumptions on the utility
and latency functions. He and Walrand [15] study competition and cooperation among
internet service providers under specific demand models. Issues of efficient allocation of
   3
     Consumer surplus is defined as the difference between users’ willingness to pay and effective costs,
pi + li (xi ), and is thus different from social surplus (which is the difference between users’ willingness
to pay and latency cost, li (xi ), thus also takes into account producer surplus/profits). See Mas-Colell,
Winston, and Green [21].
   4
     Using economics terminology, we could also say that the demand for route 1 becomes more “inelas-
tic”. Since this term has a different meaning in the communication networks literature (see [34]), we
do not use it here.

                                                     3
flows or traffic across routes do not arise in these papers. Our previous work [1] studies
the monopoly problem and contains the efficiency of the monopoly result (with inelastic
traffic and more restrictive assumptions on latencies), but none of the other results here.
To minimize overlap, we discuss the monopoly problem only briefly in this paper.
    In the rest of the paper, we use the terminology of a (communication) network,
though all of the analysis applies to resource allocation in transportation networks,
electricity markets, and other economic applications. Section 2 describes the basic en-
vironment. Section 3 briefly characterizes the monopoly equilibrium and establishes
its efficiency. Section 4 defines and characterizes the oligopoly equilibria with compet-
ing profit-maximizing providers. Section 5 contains the main results and characterizes
the efficiency properties of the oligopoly equilibrium and provide bounds on efficiency.
Section 6 contains concluding comments.
    Regarding notation, all vectors are viewed as column vectors, and inequalities are to
be interpreted componentwise. We denote by RI+ the set of nonnegative I-dimensional
vectors. Let Ci be a closed subset of [0, ∞) and let f : Ci 7→ R be a convex function. We
use ∂f (x) to denote the set of subgradients of f at x, and f − (x) and f + (x) to denote
the left and right derivatives of f at x.


2       Model
We consider a network with I parallel links. Let I = {1, . . . , I} denote the set of links.
Let xi denote the total flow on link i, and x = [x1 , . . . , xI ] denote the vector of link flows.
Each link in the network has a flow-dependent latency function li (xi ), which measures
the travel time (or delay) as a function of the total flow on link i. We denote the price
per unit flow (bandwidth) of link i by pi . Let p = [p1 , . . . , pI ] denote the vector of prices.
    We are interested in the problem of routing d units of flow across the I links. We as-
sume that this is the aggregate flow of many “small” users and thus adopt the Wardrop’s
principle (see [41]) in characterizing the flow distribution in the network; i.e., the flows
are routed along paths with minimum effective cost, defined as the sum of the latency
at the given flow and the price of that path (see the definition below). Wardrop’s prin-
ciple is used extensively in modelling traffic behavior in transportation networks ([4],
[9], [25]) and communication networks ([31], [8]). We also assume that the users have
a reservation utility R and decide not to send their flow if the effective cost exceeds
the reservation utility. This implies that user preferences can be represented by the
piecewise linear aggregate utility function u (·) depicted in Figure 2.5

Definition 1 For a given price vector p ≥ 0,6 a vector xW E ∈ RI+ is a Wardrop
    5
     This simplifying assumption implies that all users are “homogeneous” in the sense that they have
the same reservation utility, R. We discuss potential issues in extending this work to users with elastic
and heterogeneous requirements in the concluding section.
   6
     Since the reservation utility of users is equal to R, we can also restrict attention to pi ≤ R for all
i. Throughout the paper, we use p ≥ 0 and p ∈ [0, R]I interchangeably.




                                                    4
                            u (x)



                             Rd




                                                                         x
                                                  d

                           Figure 2: Aggregate utility function.


equilibrium (WE) if
                                                ( I                               )
                                                 X
                    xW E ∈ arg max                     (R − li (xW
                                                                 i
                                                                   E
                                                                     ) − pi )xi       .   (1)
                                       x≥0
                                    PI
                                         x ≤d
                                     i=1 i
                                                 i=1


We denote the set of WE at a given p by W (p).

   We adopt the following assumption on the latency functions throughout the paper.

Assumption 1 For each i ∈ I, the latency function li : [0, ∞) 7→ [0, ∞] is proper closed
convex, nondecreasing, and satisfies li (0) = 0.

    Hence, we allow the latency functions to be extended real-valued (see [7]). Let
Ci = {x ∈ [0, ∞) | li (x) < ∞} denote the effective domain of li . By Assumption 1,
Ci is a closed interval of the form [0, b] or [0, ∞). Let bCi = supx∈Ci x. Without loss of
generality, we can add the constraint xi ∈ Ci in Eq. (1). Using the optimality
                                                                           PI conditions
                                          WE
for problem (1), we see that a vector x            I
                                               ∈ R is a WE if and only if i=1 xW   E
                                                                                      ≤d
                                            PI +W E                              i
and there exists some λ ≥ 0 such that λ( i=1 xi − d) = 0 and for all i,

                       R − li (xW
                                i
                                  E
                                    ) − pi ≤ λ if xW
                                                   i
                                                     E
                                                       = 0,                               (2)
                                           = λ if 0 < xW
                                                       i
                                                         E
                                                            < bCi ,
                                           ≥ λ if xW
                                                   i
                                                     E
                                                       = bCi .

   When the latency functions are real-valued [i.e., Ci = [0, ∞)], we obtain the following
characterization of a WE, which is often used as the definition of a WE in the literature.
This lemma states that in the WE, the effective costs, defined as li (xW   i
                                                                             E
                                                                               ) + pi , are
equalized on all links with positive flows (proof omitted).

Lemma 1 Let Assumption 1 hold, and assume further that Ci = [0, ∞) for all i ∈ I.
Then a nonnegative vector x∗ ∈ W (p) if and only if

                 li (x∗i ) + pi = min{lj (x∗j ) + pj },           ∀ i with x∗i > 0,       (3)
                                       j


                                                   5
                    li (x∗i ) + pi ≤ R,          ∀ i with x∗i > 0,
                           X I
                               x∗i ≤ d,
                         i=1

       PI
with    i=1   x∗i = d if minj {lj (xj ) + pj } < R.

    Example 2 below shows that condition (3) in this lemma may not hold when the
latency functions are not real-valued. Next we establish the existence of a WE.

Proposition 1 (Existence and Continuity) Let Assumption 1 hold. For any price
vector p ≥ 0, the set of WE, W (p), is nonempty. Moreover, the correspondence W :
RI+ ⇒ RI+ is upper semicontinuous.

Proof. Given any p ≥ 0, consider the following optimization problem
                                           I ³
                                           X                       Z       xi              ´
                        maximizex≥0                (R − pi )xi −                li (z)dz       (4)
                                           i=1                         0
                                           I
                                           X
                           subject to            xi ≤ d.
                                           i=1
                                           xi ∈ Ci ,        ∀ i.

In view of Assumption (1) (i.e., li is nondecreasing for all i), it can be shown that the
objective function of problem (4) is convex over the constraint set, which is nonempty
(since 0 ∈ Ci ) and convex. Moreover, the first order optimality conditions of problem
(4), which are also sufficient conditions for optimality, are identical to the WE optimality
conditions [cf. Eq. (2)] . Hence a flow vector xW E ∈ W (p) if and only if it is an optimal
solution of problem (4). Since the objective function of problem (4) is continuous and
the constraint set is compact, this problem has an optimal solution, showing that W (p)
is nonempty. The fact that W is an upper semicontinuous correspondence at every p
follows by using the Theorem of the Maximum (see Berge [5], chapter 6) for problem
(4). Q.E.D.

  WE flows satisfy intuitive monotonicity properties given in the following proposition.
The proof follows from the optimality conditions [cf. Eq. (2)] and is omitted (see [1]).

Proposition 2 (Monotonicity) Let Assumption 1 hold. For a given p ≥ 0, let
p−j = [pi ]i6=j .
                                                         P          P
(a) For some p̄ ≤ p, let x̄ ∈ W (p̄) and x ∈ W (p). Then, Ii=1 x̄i ≥ Ii=1 xi .

(b) For some p̄j < pj , let x̄ ∈ W (p̄j , p−j ) and x ∈ W (pj , p−j ). Then x̄j ≥ xj and x̄i ≤ xi ,
     for all i 6= j.

(c) For some Ie ⊂ I, suppose that p̄j < P
                                        pj for all j ∈ Ie
                                                        Pand p̄j = pj for all j ∈
                                                                                  e and
                                                                                / I,
     let x̄ ∈ W (p̄) and x ∈ W (p). Then j∈Ie xj (p̄) ≥ j∈Ie xj (p).

                                                    6
   For a given price vector p, the WE need not be unique in general. The following
example illustrates some properties of the WE.

Example 2 Consider a two link network. Let the total flow be d = 1 and the reserva-
tion utility be R = 1. Assume that the latency functions are given by
                                            ½
                                              0 if 0 ≤ x ≤ 23
                          l1 (x) = l2 (x) =
                                              ∞ otherwise.

At the price vector (p1 , p2 ) = (1, 1), thePset of WE, W (p), is given by the set of all
vectors (x1 , x2 ) with 0 ≤ xi ≤ 2/3 and i xi ≤ 1. At any price vector (p1 , p2 ) with
p1 > p2 = 1, W (p) is given by all (0, x2 ) with 0 ≤ x2 ≤ 2/3.
     This example also illustrates that Lemma 1 need not hold when latency functions
are not real-valued. Consider, for instance, the price vector (p1 , p2 ) = (1 − ², 1 − a²)
for some scalar a > 1. In this case, the unique WE is (x1 , x2 ) = (1/3, 2/3), and clearly
effective costs on the two routes are not equalized despite the fact that they both have
positive flows. This arises because the path with the lower effective cost is capacity
constrained, so no more traffic can use that path.

    Under further restrictions on the li , we obtain the following standard result in the
literature which assumes strictly increasing latency functions.

Proposition 3 (Uniqueness) Let Assumption 1 hold. Assume further that li is
strictly increasing over Ci . For any price vector p ≥ 0, the set of WE, W (p), is a
singleton. Moreover, the function W : RI+ 7→ RI+ is continuous.

Proof. Under the given assumptions, for any p ≥ 0, the objective function of problem
(4) is strictly convex, and therefore has a unique optimal solution. This shows the
uniqueness of the WE at a given p. Since the correspondence W is upper semicontinuous
from Proposition 1 and single-valued, it is continuous. Q.E.D.

   In general, under the Assumption that li (0) = 0 for all i ∈ I, we have the following
result, which is essential in our analysis with nonunique WE flows.

Lemma 2 Let Assumption 1 hold. For a given p ≥ 0, define the set

                       Ī = {i ∈ I | ∃ x, x̄ ∈ W (p) with xi 6= x̄i }.                (5)

Then


                        li (xi ) = 0,       ∀ i ∈ Ī, ∀ x ∈ W (p),
                             pi = pj ,       ∀ i, j ∈ Ī.




                                             7
Proof. Consider some i ∈ Ī and x ∈ W (p). Since i ∈ Ī, there exists some x̂ ∈ W (p)
such that xi 6= x̂i . Assume without loss of generality that xi > x̂i . There are two cases
to consider:
                                       P              P
(a) If xk ≥ x̂k for all k 6= i, then      j∈I xj >      j∈I x̂j , which implies that the WE
      optimality conditions [cf. Eq. (2)] for x̂ hold with λ̂ = 0. By Eq. (2) and xi > x̂i ,
      we have
                                        li (xi ) + pi ≤ R,
                                           li (x̂i ) + pi ≥ R,
      which together imply that li (xi ) = li (x̂i ). By Assumption 1 (i.e., li is convex and
      li (0) = 0), it follows that li (xi ) = 0.

(b) If xk < x̂k for some k, by the WE optimality conditions, we obtain

                                     li (xi ) + pi ≤ lk (xk ) + pk ,

                                     li (x̂i ) + p̂i ≥ lk (x̂k ) + pk .
      Combining the above with xi > x̂i and xk < x̂k , we see that li (xi ) = li (x̂i ), and
      lk (xk ) = lk (x̂k ). By Assumption 1, this shows that li (xi ) = 0 (and also that
      pi = pk ).

    Next consider some i, j ∈ Ī. We will show that pi = pj . Since i ∈ Ī, there exist
x, x̂ ∈ W (p) such that xi > x̂i . There are three cases to consider:

   • xj < x̂j . Then a similar argument to part (b) above shows that pi = pj .
                                                   P
   • xj > x̂j . If xk ≥ x̂k for all k 6= i, j, then m x̂m < d, implying that the WE
     optimality conditions hold with λ̂ = 0. Therefore, we have

                                           li (xi ) + pi ≤ R,

                                          lj (x̂j ) + pj ≥ R,
      which together with li (xi ) = lj (x̂j ) = 0 imply that pi = pj .

   • xj = x̂j . Since j ∈ Ī, there exists some x̄ ∈ W (p) such that xj 6= x̄j . Repeating
     the above two steps with x̄j instead of x̂j yields the desired result.

Q.E.D.

    We next define the social problem and the social optimum, which is the routing (flow
allocation) that would be chosen by a planner that has full information and full control
over the network.




                                                 8
Definition 2 A flow vector xS is a social optimum if it is an optimal solution of the
social problem
                                                I ³
                                                X                     ´
                           maximizex≥0                    R − li (xi ) xi                (6)
                                                i=1
                                                I
                                                X
                              subject to              xi ≤ d.
                                                i=1



    In view of Assumption 1, the social problem has a continuous objective function and
a compact constraint set, guaranteeing the existence of a social optimum, xS . Moreover,
using the optimality conditions for a convex program (seePI [7],SSection 4.7), we see that
            S    I
a vector x ∈ R+ is a social optimum if and only if i=1 xi ≤ d and there exists a
                                                                    P
subgradient gli ∈ ∂li (xSi ) for each i, and a λS ≥ 0 such that λS ( Ii=1 xSi − d) = 0 and
for each i,
                       R − li (xSi ) − xSi gli ≤ λS if xSi = 0,                          (7)
                                               = λS if 0 < xSi < bCi ,
                                               ≥ λS if xSi = bCi .
   For future reference, for a given vector x ∈ RI+ , we define the value of the objective
function in the social problem,
                                         I
                                         X
                                S(x) =         (R − li (xi )) xi ,                       (8)
                                         i=1

as the social surplus, i.e., the difference between users’ willingness to pay and the total
latency.


3     Monopoly Equilibrium and Efficiency
In this section, we assume that a monopolist service provider owns the I links and
charges a price of pi per unit bandwidth on link i. We considered a related problem in
Acemoglu and Ozdaglar [1] for atomic users with inelastic traffic (i.e., the utility function
of each of a finite set of users is a step function), and with increasing, real-valued and
differentiable latency functions. Here we show that similar results hold for the more
general latency functions and the demand model considered in Section 2.
    The monopolist sets the prices to maximize his profit given by
                                                    I
                                                    X
                                    Π(p, x) =             pi xi ,
                                                    i=1

where x ∈ W (p). This defines a two-stage dynamic pricing-congestion game, where the
monopolist sets prices anticipating the demand of users, and given the prices (i.e., in
each subgame), users choose their flow vectors according to the WE.

                                                9
Definition 3 A vector (pM E , xM E ) ≥ 0 is a Monopoly Equilibrium (ME) if xM E ∈
W (pM E ) and
                Π(pM E , xM E ) ≥ Π(p, x),     ∀ p, ∀ x ∈ W (p) .


    Our definition of the ME is stronger than the standard subgame perfect Nash equi-
librium concept for dynamic games. With a slight abuse of terminology, let us associate
a subgame perfect Nash equilibrium with the on-the-equilibrium-path actions of the
two-stage game.

Definition 4 A vector (p∗ , x∗ ) ≥ 0 is a subgame perfect equilibrium (SPE) of the
pricing-congestion game if x∗ ∈ W (p∗ ) and for all p ≥ 0, there exists x ∈ W (p) such
that
                                 Π(p∗ , x∗ ) ≥ Π(p, x).



   The following proposition shows that under Assumption 1, the two solution concepts
coincide. Since the proof is not relevant for the rest of the argument, we provide it in
Appendix A.

Proposition 4 Let Assumption 1 hold. A vector (pM E , xM E ) is an ME if and only if
it is an SPE of the pricing-congestion game.

   Since an ME (p∗ , x∗ ) is an optimal solution of the optimization problem
                                                 I
                                                 X
                            maximizep≥0,   x≥0          pi xi                        (9)
                                                  i=1
                                   subject to    x ∈ W (p),

it is slightly easier to work with than an SPE. Therefore, we use ME as the solution
concept in this paper.
    The preceding problem has an optimal solution, which establishes the existence of an
ME. In the next proposition, we show that the flow allocation at an ME and the social
optimum are the same.

Proposition 5 Let Assumption 1 hold. A vector x is the flow vector at an ME if and
only if it is a social optimum.

   To prove this result, we first establish the following lemma.

Lemma 3 Let Assumption 1 hold. Let (p, x) be an ME. Then for all i with xi > 0, we
have
                              pi = R − li (xi ).




                                           10
Proof. Define Ī = {i ∈ I | xi > 0}. By the definition of a WE, for all i ∈ Ī, we have
pi + li (xi ) ≤ R. We first show that

                          li (xi ) + pi = lj (xj ) + pj ,     ∀ i, j ∈ Ī.

Suppose li (xi ) + pi < lj (xj ) + pj for some i, j ∈ Ī. Using the optimality conditions for
a WE [cf. Eq. (2)], we see that x ∈ W (pi + ², p−i ) for sufficiently small ², contradicting
the fact that (p, x) is an ME.
                             P Assume next that pi +thli (xi ) < R for some i ∈ Ī. Consider
the price vector p̃ = p + ² i∈Ī ei , where ei is the i unit vector and ² is such that

                              pi + ² + li (xi ) < R,         ∀ i ∈ Ī.

Hence, x is a WE at price p̃, and therefore the vector (p̃, x) is feasible for problem (9)
and has a strictly higher objective function value, contradicting the fact that (p, x) is an
ME. Q.E.D.

Proof of Proposition 5: In view of Lemma 3, we can rewrite problem (9) as
                                                  I ³
                                                  X                  ´
                            maximizex≥0                  R − li (xi ) xi
                                                  i=1
                                                  XI
                               subject to               xi ≤ d.
                                                  i=1

This problem is identical to the social problem [cf. problem (6)], completing the proof.
Q.E.D.

   In addition to the social surplus defined above, it is also useful to define the con-
sumer
PI      surplus, as the difference between users’ willingness to pay and effective cost, i.e.,
  i=1 (R  − li (xi ) − pi )xi (See Mas-Colell, Winston and Green, [21]). By Proposition 5
and Lemma 3, it is clear that even though the ME achieves the social optimum, all of
the surplus is captured by the monopolist, and users are just indifferent between sending
their information or not (i.e., receive no consumer surplus).
   Our major motivation for the study of oligopolistic settings is that they provide
a better approximation to reality, where there is typically competition among service
providers. A secondary motivation is to see whether an oligopoly equilibrium will achieve
an efficient allocation like the ME, while also transferring some or all of the surplus to
the consumers.


4     Oligopoly Equilibrium
We suppose that there are S service providers, denote the set of service providers by
S, and assume that each service provider s ∈ S owns a different subset Is of the links.
Service provider s charges a price pi per unit bandwidth on link i ∈ Is . Given the vector



                                                 11
of prices of links owned by other service providers, p−s = [pi ]i∈I
                                                                 / s , the profit of service
provider s is                                      X
                               Πs (ps , p−s , x) =   pi xi ,
                                                      i∈Is

for x ∈ W (ps , p−s ), where ps = [pi ]i∈Is .
    The objective of each service provider, like the monopolist in the previous section,
is to maximize profits. Because their profits depend on the prices set by other service
providers, each service provider forms conjectures about the actions of other service
providers, as well as the behavior of users, which, we assume, they do according to the
notion of (subgame perfect) Nash equilibrium. We refer to the game among service
providers as the price competition game.
                         OE  OE
Definition ¡5 A vector
                     ¢ (p , x ) ≥ 0 is a (pure strategy) Oligopoly Equilibrium (OE)
    OE       OE   OE
if x ∈ W ps , p−s and for all s ∈ S,

         Πs (pOE   OE
              s , p−s , x
                          OE
                             ) ≥ Πs (ps , pOE
                                           −s , x),     ∀ ps ≥ 0, ∀ x ∈ W (ps , pOE
                                                                                 −s ).   (10)

We refer to pOE as the OE price.

    As for the monopoly case, there is a close relation between a pure strategy OE and
a pure strategy subgame perfect equilibrium. Again associating the subgame perfect
equilibrium with the on-the-equilibrium-path actions, we have the following standard
definition.

Definition 6 A vector (p∗ , x∗ ) ≥ 0 is a subgame perfect equilibrium (SPE) of the price
competition game if x∗ ∈ W (p∗ ) and there exists a function x(p) ∈ W (p) such that for
all s ∈ S,                                               ¡         ¢
                Πs (p∗s , p∗−s , x∗ ) ≥ Πs (ps , p∗−s , x ps , p∗−s ) ∀ ps ≥ 0.     (11)



   The following proposition generalizes Proposition 4 and enables us to work with the
OE definition, which is more convenient for the subsequent analysis. The proof parallels
that of Proposition 4 and is omitted.

Proposition 6 Let Assumption 1 hold. A vector (pOE , xOE ) is an OE if and only if it
is an SPE of the price competition game.


    The price competition game is neither concave nor supermodular. Therefore, classical
arguments that are used to show the existence of a pure strategy equilibrium do not hold
(see [13], [37]). In the next proposition, we show that for linear latency functions, there
exists a pure strategy OE.

Proposition 7 Let Assumption 1 hold, and assume further that the latency functions
are linear. Then the price competition game has a pure strategy OE.


                                                12
Proof. For all i ∈ I, let li (x) = ai x. Define the set

                                    I0 = {i ∈ I | ai = 0}.

Let I0 denote the cardinality of set I0 . There are two cases to consider:

   • I0 ≥ 2: Assume that there exist i, j ∈ I0 such that i ∈ Is and j ∈ Is0 for some
     s 6= s0 ∈ S. Then it can be seen that a vector (pOE , xOE ) with pOE
                                                                       i  = 0 for all
                 OE         OE
     i ∈ I0 and x ∈ W (p ) is an OE. Assume next that for all i ∈ I0 , we have i ∈ Is
     for some s ∈ S. Then, we can assume without loss of generality that provider s
     owns a single link i0 with ai0 = 0 and consider the case I0 = 1.

   • I0 ≤ 1: Let Bs (pOE                  OE
                      −s ) be the set of ps  such that
                                                                     X
                               (pOE
                                 s ,x
                                      OE
                                         ) ∈ arg       max                  pi xi .          (12)
                                                       ps ≥0
                                                    x∈W (ps ,pOE
                                                              −s )
                                                                     i∈Is


      Let B(pOE ) = [Bs (pOE−s )]s∈S . In view of the linearity of the latency functions, it
      follows that B(pOE ) is an upper semicontinuous and convex-valued correspondence.
      Hence, we can use Kakutani’s fixed point theorem to assert the existence of a pOE
      such that B(pOE ) = pOE (see Berge [5]). To complete the proof, it remains to be
      shown that there exists xOE ∈ W (pOE ) such that Eq. (10) holds.
      If I0 = ∅, we have by Proposition 3 that W (pOE ) is a singleton, and therefore Eq.
      (10) holds and (pOE , W (pOE )) is an OE.
      Assume finally that exactly one of the ai ’s (without loss of generality a1 ) is equal
      to 0. We show that for all x̄, x̃ ∈ W (pOE ), we have x̄i = x̃i , for all i 6= 1. Let
      EC(x, pOE ) = minj {lj (xj ) + pOE
                                      j }. If at least one of


                            EC(x̃, pOE ) < R,          or    EC(x̄, pOE ) < R
                                            PI            PI
      holds,
      P        then   one can  show  that     i=1 x̃ i =   i=1 x̄i = d. Substituting x1 = d −
         i∈I, i6=1 xi in problem (4), we see that the objective function of problem (4) is
      strictly convex in x−1 = [xi ]i6=1 , thus showing that x̃ = x̄. If both EC(x̃, pOE ) = R
      and EC(x̄, pOE ) = R, then x̄i = x̃i = li−1 (R − pOE    i ) for all i 6= 1, establishing our
      claim.
                                                                     P
      For some x ∈ W (pOE ), consider the vector xOE = (d − i6=1 xi , x−1 ) . Since x−1 is
      uniquely defined and x1 is chosen such that the provider that owns link 1 has no
      incentive to deviate, it follows that (pOE , xOE ) is an OE.

Q.E.D.

    The existence result cannot be generalized to piecewise linear latency functions or
to latency functions which are linear over their effective domain, as illustrated in the
following example.


                                               13
Example 3 Consider a two link network. Let the total flow be d = 1. Assume that the
latency functions are given by
                                           ½
                                             0   if 0 ≤ x ≤ δ
                      l1 (x) = 0, l2 (x) =   x−δ
                                               ²
                                                 x ≥ δ,

for some ² > 0 and δ > 1/2, with the convention that when ² = 0, l2 (x) = ∞ for x > δ.
We first show that there exists no pure strategy oligopoly equilibrium for small ² (i.e.,
there exists no pure strategy subgame perfect equilibrium). The following list considers
all candidate oligopoly price equilibria (p1 , p2 ) and profitable unilateral deviations for ²
sufficiently small, thus establishing the nonexistence of an OE:

   1. p1 = p2 = 0: A small increase in the price of provider 1 will generate positive
      profits, thus provider 1 has an incentive to deviate.

   2. p1 = p2 > 0: Let x be the flow allocation at the OE. If x1 = 1, then provider 2
      has an incentive to decrease its price. If x1 < 1, then provider 1 has an incentive
      to decrease its price.

   3. 0 ≤ p1 < p2 : Player 1 has an incentive to increase its price since its flow allocation
      remains the same.

   4. 0 ≤ p2 < p1 : For ² sufficiently small, the profit function of player 2, given p1 , is
      strictly increasing as a function of p2 , showing that provider 2 has an incentive to
      increase its price.


    We next show that a mixed strategy OE always exists. We define a mixed strategy
OE as a mixed strategy subgame perfect equilibrium of the price competition game (see
Dasgupta and Maskin, [10]). Let B n be the space of all (Borel) probability measures
on [0, R]n . Let Is denote the cardinality of Is , i.e., the number of links controlled by
service provider s. Let µs ∈ B Is be a probability measure, and denote the vector of these
probability measures by µ and the vector of these probability measures excluding s by
µ−s .

Definition 7 (µ∗ , x∗ (p)) is a mixed strategy Oligopoly Equilibrium (OE) if the function
x∗ (p) ∈ W (p) for every p ∈ [0, R]I and
 Z
                                          ¡                        ¢
          Πs (ps , p−s , x∗ (ps , p−s )) d µ∗s (ps ) × µ∗−s (p−s )
   [0,R]I
                                           Z
                                                                                  ¡                       ¢
                                         ≥         Πs (ps , p−s , x∗ (ps , p−s ))d µs (ps ) × µ∗−s (p−s )
                                             [0,R]I


for all s and µs ∈ B Is .

    Therefore, a mixed strategy OE simply requires that there is no profitable deviation
to a different probability measure for each oligopolist.

                                                      14
    Example 3 (continued) We now show that the following strategy profile is a mixed
strategy OE for the above game when ² → 0 (a mixed strategy OE also exists when
² > 0, but its structure is more complicated and less informative):
                                
                                 0           0 ≤ p ≤ R(1 − δ),
                                      (1−δ)R
                       µ1 (p) =    1− p       R(1 − δ) ≤ p < R,
                                
                                   1          otherwise,
                                    
                                     0                       0 ≤ p ≤ R(1 − δ),
                                            1       (1−δ)R
                         µ2 (p) =           δ
                                                −     δp
                                                              R(1 − δ) ≤ p ≤ R,
                                    
                                        1                     otherwise.
Notice that µ1 has an atom equal to 1 − δ at R. To verify that this profile is a mixed
strategy OE, let µ0 be the density of µ, with the convention that µ0 = ∞ when there is
an atom at that point. Let Mi = {p | µ0i (p) > 0} . To establish that (µ1 , µ2 ) is a mixed
strategy equilibrium, it suffices to show that the expected payoff to player i is constant
for all pi ∈ Mi when the other player chooses p−i according to µ−i (see [24]). These
expected payoffs are
                                    Z R
                   Π̄ (pi | µ−i ) ≡     Πi (pi , p−i , x (pi , p−i ))dµ−i (p−i ) ,
                                            0

which are constant for all pi ∈ Mi for i = 1, 2. This establishes that (µ1 , µ2 ) is a mixed
strategy OE.

   The next proposition shows that a mixed strategy equilibrium always exists.

Proposition 8 Let Assumption 1 hold. Then the price competition game has a mixed
strategy OE, (µOE , xOE (p)).

    The proof of this proposition is long and not directly related the rest of the argument,
so it is given in Appendix B.
    We next provide an explicit characterization of pure strategy OE. Though of also
independent interest, these results are most useful for us to quantify the efficiency loss
of oligopoly in the next section.
    The following lemma shows that an equivalent to Lemma 1 (which required real-
valued latency functions) also holds with more general latency functions at the pure
strategy OE.

Lemma 4 Let Assumption 1 hold. If (pOE , xOE ) is a pure strategy OE, then

            li (xOE     OE
                 i ) + pi  = min{lj (xOE     OE
                                      j ) + pj },                       ∀ i with xOE
                                                                                  i  > 0,   (13)
                                        j

              li (x∗i ) + pOE
                           i  ≤ R,                                      ∀ i with xOE
                                                                                  i  > 0,   (14)
                     X I
                          xOE
                           i  ≤ d,                                                          (15)
                   i=1


                                                         15
       PI
with     i=1   xOE
                i  = d if minj {lj (xOE
                                     j ) + pj } < R.

Proof. Let (pOE , xOE ) be an OE. Since xOE ∈ W (pOE ), conditions (14) and (15) follow
by the definition of a WE. Consider condition (13). Assume that there exist some i, j ∈ I
with xOE
       i  > 0, xOE
                 j   > 0 such that

                                li (xOE     OE
                                     i ) + pi  < lj (xOE     OE
                                                      j ) + pj .

Using the optimality conditions for a WE [cf. Eq. (2)], this implies that xOE
                                                                            i   = bCi . Con-
                  OE        OE
sider changing pi to pi + ² for some ² > 0. By checking the optimality conditions,
we see that we can choose ² sufficiently small such that xOE ∈ W (pOE  i  + ², pOE
                                                                                −i ). Hence
                                                    OE
service provider that owns link i can deviate to pi + ² and increase its profits, contra-
dicting the fact that (pOE , xOE ) is P
                                      an OE. Finally, assume to arrive at the contradiction
                                        I
that minj {lj (xOE
                j  ) + p j } < R and         OE
                                        i=1 xi  < d. Using the optimality conditions for a
                                 PI
WE [Eq. (2) with λ = 0 since i=1 xi < d], this implies that we must have xOE
                                        OE
                                                                                   i    = bCi
                                                                    OE               OE
for some i. With a similar argument to above, a deviation to pi + ² keeps x              as a
WE, and is more profitable, completing the proof. Q.E.D.

   We need the following additional assumption for our price characterization.
Assumption 2 Given a pure strategy OE (pOE , xOE ), if for some i ∈ I with xOE
                                                                            i  > 0,
             OE
we have li (xi ) = 0, then Is = {i}.

    Note that this assumption is automatically satisfied if all latency functions are strictly
increasing or if all service providers own only one link.
Lemma 5 Let (pOE , xOE ) be a pure strategy OE. Let Assumptions 1 and 2 hold. Let
Πs denote the profit of service provider s at (pOE , xOE ).
(a) If Πs0 > 0 for some s0 ∈ S, then Πs > 0 for all s ∈ S.
(b) If Πs > 0 for some s ∈ S, then pOE OE
                                    j xj  > 0 for all j ∈ Is .

Proof.
(a) For some j ∈ Is0 , define K = pOE        OE
                                   j +lj (xj ), which is positive since Πs0 > 0. Assume
     Πs = 0 for some s. For k ∈ Is , consider the price p̄k = K − ² > 0 for some small
     ² > 0. It can be seen that at the price vector (p̄k , pOE
                                                            −k ), the corresponding WE link
     flow would satisfy x̄k > 0. Hence, service provider s has an incentive to deviate to
     p̄k at which he will make positive profit, contradicting the fact that (pOE , xOE ) is
     a pure strategy OE.

(b) Since Πs > 0, we have pOE    OE
                              m xm > 0 for some m ∈ Is . By Assumption 2, we can
     assume without loss of generality that lm (xOE
                                                 m ) > 0 (otherwise, we are done). Let
     j ∈ Is and assume to arrive at a contradiction that pOEj xj
                                                                OE
                                                                   = 0. The profit of
     service provider s at the pure strategy OE can be written as
                                         Πs = Π̄s + pOE OE
                                                     m xm ,


                                               16
      where Π̄s denotes the profits from links other than m and j. Let pOE           OE
                                                                        m = K−lm (xm )
      for some K. Consider changing the prices pOE m and pj
                                                            OE
                                                               such that the new profit is

                     Π̃s = Π̄s + (K − lm (xOE       OE
                                           m − ²))(xm − ²) + ²(K − lj (²)).

      Note that ² units of flow are moved from link m to link j such that the flows of
      other links remain the same at the new WE. Hence, the change in the profit is
               Π̃s − Πs = (lm (xOE         OE      OE         OE
                                m ) − lm (xm − ²))xm + ²(lm (xm − ²) − lj (²))).

      Since lm (xOE
                 m ) > 0, ² can be chosen sufficiently small such that the above is strictly
      positive, contradicting the fact that (pOE , xOE ) is an OE. Q.E.D.

    The following example shows that Assumption 2 cannot be dispensed with for part
(b) of this lemma.
Example 4 Consider a three link network with two providers, where provider 1 owns
links 1 and 3 and provider 2 owns link 2. Let the total flow be d = 1 and the reservation
utility be R = 1. Assume that the latency functions are given by
                          l1 (x1 ) = 0, l2 (x2 ) = x2 , l3 (x3 ) = ax3 ,
for some a > 0. Any price vector (p1 , p2 , p3 ) = (2/3, 1/3, b) with b ≥ 2/3 and (x1 , x2 , x3 ) =
(2/3, 1/3, 0) is a pure strategy OE, so p3 x3 = 0 contrary to part (b) of the lemma. To
see why this is an equilibrium, note that provider 2 is clearly playing a best response.
Moreover, in this allocation Π1 = 4/9. We can represent any deviation of provider 1 by
                              (p1 , p3 ) = (2/3 − δ, 2/3 − a² − δ) ,
for two scalars ² and δ , which will induce a WE of (x1 , x2 , x3 ) = (2/3 + δ − ², 1/3 − δ, ²) .
The corresponding profit of provider 1 at this deviation is Π1 = 4/9 − δ 2 < 4/9, estab-
lishing that provider 1 is also playing a best response and we have a pure strategy OE.

   We next establish that under an additional assumption, a pure strategy OE will
never be at a point of non-differentiability of the latency functions.
Assumption 3 There exists some s ∈ S such that li is real-valued and continuously
differentiable for all i ∈ Is .
Lemma 6 Let (pOE , xOE ) be an OE with minj {pOE j + lj (xOE            OE OE
                                                          j )} < R and pi xi  >0
for some i. Let Assumptions 1, 2 and 3 hold. Then
                               li+ (xOE     − OE
                                     i ) = li (xi ),      ∀ i ∈ I,
where li+ (xOE       − OE                                                              OE
            i ) and li (xi ) are the right and left derivatives of the function li at xi
respectively.

   Since the proof of this lemma is long, it is given in Appendix C. Note that Assumption
3 cannot be dispensed with in this lemma. This is illustrated in the next example.

                                               17
Example 5 Consider a two link network. Let the total flow be d = 1 and the reserva-
tion utility be R = 2. Assume that the latency functions are given by
                                         ½
                                           0¡      ¢ if 0 ≤ x ≤ 12
                       l1 (x) = l2 (x) =
                                           2 x − 12 otherwise.
It can be verified that the vector (pOE   OE                   OE   OE
                                     1 , p2 ) = (1, 1), with (x1 , x2 ) = (1/2, 1/2) is a
pure strategy OE, and is at a point of non-differentiability for both latency functions.
   We next provide an explicit characterization of the OE prices, which is essential in
our efficiency analysis in Section 5. The proof is given in Appendix D.
Proposition 9 Let (pOE , xOE ) be an OE such that pOE OE
                                                   i xi  > 0 for some i ∈ I. Let
Assumptions 1, 2, and 3 hold.
a) Assume that minj {pOE
                      j  + lj (xOE
                                j )} < R. Then, for all s ∈ S and i ∈ Is , we have
               OE 0 OE
               xi li (xi ),     P
                                                if lj0 (xOE
                                                         j ) = 0 for some j ∈
                                                                            / Is ,
         OE                                OE
        pi =      OE 0   OE              x                                         (16)
               xi li (xi ) + Pj∈I            , otherwise.
                                    j∈Is   j
                                            1
                                   / s 0 OE
                                          l (x   )
                                           j j



b) Assume that minj {pOE
                      j  + lj (xOE
                                j )} = R. Then, for all s ∈ S and i ∈ Is , we have
                                                 − OE
                                       pOE
                                        i  ≥ xOE
                                              i li (xi ).                                 (17)

    Moreover, if there exists some i ∈ I such that Is = {i} for some s ∈ S, then

                                         + OE                    xOE
                                                                  i
                               pOE
                                i  ≤ xOE
                                      i li (xi ) + P                 1     .              (18)
                                                            j6=1 l− (xOE )
                                                                  j   j




   If the latency functions li are all real-valued and continuously differentiable, then
analysis of Karush-Kuhn-Tucker conditions for oligopoly problem [Eq. (78) in Appendix
D] immediately yields the following result:
Corollary 1 Let (pOE , xOE ) be an OE such that pOE      i xi
                                                               OE
                                                                   > 0 for some i ∈ I. Let As-
sumptions 1 and 2 hold. Assume also that li is real-valued and continuously differentiable
for all i. Then, for all s ∈ S and i ∈ Is , we have
         OE 0 OE                                                        0  OE
         xi l(
               i (xi ),                                          ) if lj (xj ) = 0 for some j ∈
                                                                                               / Is ,
 OE                                               P
pi =                       OE      OE 0    OE        j∈Is xj
                                                            OE

         min R − li (xi ) , xi li (xi ) + Pj∈I
                                                            1
                                                    / s l0 (xOE )
                                                                   , otherwise.
                                                        j    j

                                                                                          (19)

    This corollary also implies that in the two link case with real-valued and continuously
differentiable latency functions and with minimum effective cost less than R, the OE
prices are
                              pOE
                                i  = xOE    0  OE      0  OE
                                       i (l1 (x1 ) + l2 (x2 ))                         (20)
as claimed in the Introduction.

                                              18
5    Efficiency of Oligopoly Equilibria
In this section, we study the efficiency properties of oligopoly pricing. We take as our
measure of efficiency the ratio of the social surplus of the equilibrium flow allocation to
the social surplus of the social optimum, S(x∗ )/S(xS ), where x∗ refers to the monopoly
or the oligopoly equilibrium [cf. Eq. (8)]. In Section 3, we showed that the flow alloca-
tion at a monopoly equilibrium is a social optimum. Hence, in congestion games with
monopoly pricing, there is no efficiency loss. The following example shows that this is
not necessarily the case in oligopoly pricing.

Example 6 Consider a two link network. Let the total flow be d = 1 and the reservation
utility be R = 1. The latency functions are given by
                                                                3
                                 l1 (x) = 0,            l2 (x) = x.
                                                                2
The unique social optimum for this example is xS = (1, 0). The unique ME (pM E , xM E )
is xM E = (1, 0) and pM E = (1, 1). As expected, the flow allocations at the social
optimum and the ME are the same. Next consider a duopoly where each of these links
is owned by a different provider. Using Corollary 1 and Lemma 4, it follows that the
flow allocation at the OE, xOE , satisfies

         l1 (xOE     OE 0    OE     0   OE          OE     OE 0    OE     0   OE
              1 ) + x1 [l1 (x1 ) + l2 (x2 )] = l2 (x2 ) + x2 [l1 (x1 ) + l2 (x2 )].

Solving this together with xOE
                             1  + xOE
                                   2   = 1 shows that the flow allocation at the unique
                           OE
oligopoly equilibrium is x     = (2/3, 1/3). The social surplus at the social optimum,
the monopoly equilibrium, and the oligopoly equilibrium are given by 1, 1, and 5/6,
respectively.

    Before providing a more thorough analysis of the efficiency properties of the OE, the
next proposition proves that, as claimed in the Introduction and suggested by Example
6, a change in the market structure from monopoly to duopoly in a two link network
typically reduces efficiency.

Proposition 10 Consider a two link network where each link is owned by a differ-
ent provider. Let Assumption 1 hold. Let (pOE , xOE ) be a pure strategy OE such
that pOE   OE
        i xi  > 0 for some i ∈ I and minj {pOE
                                            j  + lj (xOE            0   OE   OE
                                                      j )} < R. If l1 (x1 )/x1  6=
 0   OE    OE         OE     S
l2 (x2 )/x2 , then S(x )/S(x ) < 1 .

Proof. Combining the OE prices with the WE conditions, we have

        l1 (xOE     OE 0    OE     0   OE          OE     OE 0    OE     0   OE
             1 ) + x1 (l1 (x1 ) + l2 (x2 )) = l2 (x2 ) + x2 (l1 (x1 ) + l2 (x2 )),

where we use the fact that minj {pOE
                                   j  + lj (xOE
                                              j )} < R. Moreover, we can use optimality
                                        S    S
conditions (7) to prove that a vector (x1 , x2 ) > 0 is a social optimum if and only if

                         l1 (xS1 ) + xS1 l10 (xS1 ) = l2 (xS2 ) + xS2 l20 (xS2 ),

                                                   19
(see also the proof of Lemma 4). Since l10 (xOE   OE
                                             1 )/x1  6= l20 (xOE   OE
                                                              2 )/x2 , the result follows.
Q.E.D.

    We next quantify the efficiency of oligopoly equilibria by providing a tight bound
on the efficiency loss in congestion games with oligopoly pricing. As we have shown in
Section 4, such games do not always have a pure strategy OE. In the following, we first
provide bounds on congestion games that have pure strategy equilibria. We next study
efficiency properties of mixed strategy equilibria.

5.1     Pure Strategy Equilibria
We consider price competition games that have pure strategy equilibria (this set includes,
but is larger than, games with linear latency functions, see Section 4). We consider
latency functions that satisfy Assumptions 1, 2, and 3. Let LI denote the set of latency
functions {li }i∈I such that the associated congestion game has a pure strategy OE and
the individual li ’s satisfy Assumptions 1, 2, and 3.7 Given a parallel link network with I
                                                −−→
links and latency functions {li }i∈I ∈ LI , let OE({li }) denote the set of flow allocations
                                                              −−→
at an OE. We define the efficiency metric at some xOE ∈ OE({li }) as
                                         P           P
                                   OE   R Ii=1 xOE
                                                i  − Ii=1 li (xOE
                                                                i )xi
                                                                      OE
                       rI ({li }, x ) =   PI          P                  ,              (21)
                                         R i=1 xSi − Ii=1 li (xSi )xSi

where xS is a social optimum given the latency functions {li }i∈I and R is the reservation
utility. In other words, our efficiency metric is the ratio of the social surplus in an
equilibrium relative to the surplus in the social optimum. Following the literature on
the “price of anarchy”, in particular [19], we are interested in the worst performance in
an oligopoly equilibrium, so we look for a lower bound on

                                   inf           inf        rI ({li }, xOE ).
                                 {li }∈LI        −−
                                                  →
                                            xOE ∈OE ({li })

    We first prove two lemmas, which reduce the set of latency functions that need to
be considered in bounding the efficiency metric. The next lemma allows us to use the
oligopoly price characterization given in Proposition 9

Lemma 7 Let (pOE , xOE ) be a pure strategy OE such that pOE OE
                                                          i xi  = 0 for all i ∈ I.
      OE
Then x is a social optimum.

Proof. We first show that li (xOE                                               OE
                                   i ) = 0 for all i ∈ I. Assume that lj (xj ) > 0 for
some j ∈ I. This implies that xOE    j  > 0 and therefore pOE j    = 0. Since lj (xOE
                                                                                    j ) > 0,
                                                                    OE
it follows by Lemma 2 that for all x ∈ W (p), we have xj = xj . Consider increasing
pOE
  j   to some small ² > 0. By the upper semicontinuity of W (p), it follows that for all
x ∈ W (², pOE                    OE
            −j ), we have |xj − xj | < δ for some δ > 0. Moreover, by Lemma 2, we have,
                   OE          OE
for all x ∈ W (², p−j ), xi ≥ xi for all i 6= j. Hence, the profit of the provider that owns
   7
    More explicitly, Assumption 2 implies that if any OE (pOE , xOE ) associated with {li }i∈I has xOE
                                                                                                    i  >
0 and li (xOE
           i  ) = 0, then Is = {i}.

                                                       20
link j is strictly higher at price vector (², pOE
                                               −j ) than at p
                                                               OE
                                                                  , contradicting the fact that
   OE   OE
(p , x ) is an OE.
    Clearly xOEj  > 0 for some j and
                                   P hence     mini∈I {pOE
                                                        i   + li (xOE
                                                                    i )} = pj
                                                                             OE
                                                                                 + lj (xOE
                                                                                         j ) = 0,
which implies by Lemma 4 that i∈I xOE     i    = d.  Using l  (x
                                                             i i
                                                                 OE
                                                                    ) = 0, and 0 ∈ ∂l   (x OE
                                                                                       i i ) for
all i, we have
                          R − li (xOE       OE
                                   i ) − xi gli = R,          ∀ i ∈ I,
for some gli ∈ ∂li (xOEi ). Hence, x
                                     OE
                                        satisfies the sufficient optimality conditions for a
                                    S
social optimum [cf. Eq. (7) with λ = R], and the result follows. Q.E.D.
                                                                                 P
    The next lemma allows us to assume without loss of generality that R Ii=1 xSi −
PI          S   S
                          PI     OE
   i=1 li (xi )xi > 0 and   i=1 xi  = d in the subsequent analysis.

Lemma 8 Let {li }i∈I ∈ LI . Assume that
           P                      P
 either (i) Ii=1 li (xSi )xSi = R Ii=1 xSi for some social optimum xs ,
           P                                 −−→
 or (ii) Ii=1 xOE i     < d for some xOE ∈ OE({li }).
                     −−→
Then every xOE ∈ OE({li }) is a social optimum, implying that rI ({li }, xOE ) = 1.
                          P                    P
Proof. Assume that Ii=1 li (xSi )xSi = R Ii=1 xSi . Since xS is a social optimum and
             −−→
every xOE ∈ OE({li }) is a feasible solution to the social problem [problem (6)], we have
              I
              X                      I
                                     X                                    −−→
         0=     (R − li (xSi ))xSi ≥   (R − li (xOE   OE
                                                 i ))xi ,         ∀ xOE ∈ OE({li }).
              i=1                    i=1

By the definition of a WE, we have xOE    i  ≥ 0 and R − li (xOE     OE
                                                              i ) ≥ pi   ≥ 0 (where pOE i   is
the price of link i at the OE) for all i. This combined with the preceding relation shows
that xOE is a social optimum.
                        P                              −−→
    Assume next that Ii=1 xOE i    < d for some xOE ∈ OE({li }). Let pOE be the associated
OE price. Assume that pOE  j xj
                                OE
                                     > 0 for some j ∈ I (otherwise we are done by Lemma
          PI      OE
7). Since i=1 xi < d, we have by Lemma 4 that minj∈I {pj + lj (xOE     j } = R. Moreover,
                                  OE
by Lemma 5, it follows that pi xi > 0 for all i ∈ I. Hence, for all s ∈ S, ((pOE
                                                                              i )i∈Is , x
                                                                                          OE
                                                                                             )
is an optimal solution of the problem
                                            X
                   maximize((pi )i∈Is ,x)      p i xi
                                           i∈Is
                            subject to     pi + li (xi ) = R,     ∀ i ∈ Is ,
                                           pOE
                                            i  + li (xi ) = R,      ∀i∈ / Is ,
                                           XI
                                               xOE
                                                 i   ≤ d.
                                           i=1

Substituting for (pi )i∈Is in the above, we obtain
                                            X
                            maximizex≥0        (R − li (xi ))xi
                                             i∈Is


                                                  21
                             subject to          xi ∈ T i ,     ∀i∈
                                                                  / Is ,
                                                 XI
                                                     xOE
                                                      i     ≤ d,
                                                 i=1

where Ti = {xi | pOE
                  i  + li (xi ) = R} is either a singleton or a closed interval. Since this
is a convex problem, using the optimality conditions, we obtain

                    R − li (xOE     OE
                             i ) − xi gli = 0,               ∀ i ∈ Is , ∀ s ∈ S,

where gli ∈ ∂li (xOE
                  i ). By Eq. (7), it follows that x
                                                     OE
                                                        is a social optimum. Q.E.D.

   Hence, in finding a lower bound on the efficiency metric, we can restrict
                                                                       PI     ourselves,
without loss of generality, to latency functions {li } ∈ LI such that i=1 li (xSi )xSi <
  P                                          P                            −−→
R Ii=1 xSi for some social optimum xS , and Ii=1 xOE    = d for all xOE ∈ OE({li }). By
                                               PI i S
the following lemma, we can also assume that i=1 xi = d.

Lemma 9 For a set of latency functions {li }i∈I , let Assumption 1 hold. Let (pOE , xOE )
be an OE and xS be a social optimum. Then
                                 X           X
                                    xOE
                                     i   ≤         xSi .
                                        i∈I            i∈I

                                                         P             P
Proof. Assume to arrive at a contradiction that i∈I xOE          i  > i∈I xSi . This implies
that xOE  j  > xSj for some j. We also have lj (xOE           S
                                                   j ) > lj (xj ). (Otherwise, we would have
lj (xSj ) = lj0 (xSjP
                    ) = 0, which yields a contradiction by the optimality conditions (7) and
the fact that i∈I xSi < d). Using the optimality conditions (2) and (7), we obtain

                        R − lj (xOE     OE
                                 j ) − pj  ≥ R − lj (xSj ) − xSj glj ,

for some glj ∈ ∂lj (xSj ). Combining the preceding with lj (xOE         S        OE
                                                             j ) > lj (xj ) and pj  ≥
  OE − OE
xj lj (xj ) (cf. Proposition 9), we see that
                                           − OE
                                       xOE            S
                                        j lj (xj ) < xj glj ,

contradicting xOE
               j  > xSj and completing the proof. Q.E.D.

5.1.1   Two Links
We first consider a parallel link network with two links owned by two service providers.
The next theorem provides a tight lower bound on r2 ({li }, xOE ) [cf. Eq. (21)]. In the
following, we assume without loss of generality that d = 1. Also recall that latency
functions in L2 satisfy Assumptions 1, 2, and 3.

Theorem 1 Consider a two link network where each link is owned by a different
provider. Then
                                  5                                     −−→
                r2 ({li }, xOE ) ≥ ,          ∀ {li }i=1,2 ∈ L2 , xOE ∈ OE({li }),     (22)
                                  6

                                                  22
                                                                     −−→
and the bound is tight, i.e., there exists {li }i=1,2 ∈ L2 and xOE ∈ OE({li }) that attains
the lower bound in Eq. (22).

Proof. The proof follows a number of steps:

    Step 1: We are interested in finding a lower bound for the problem

                                          inf         inf        r2 ({li }, xOE ).                      (23)
                                         {li }∈L2 OE  −−
                                                       →
                                                 x   ∈OE ({li })

                                −−→
Given {li } ∈ L2 , let xOE ∈ P  OE({li }) andPlet xS be a social optimum. By Lemmas 8
and 9, we can assume that 2i=1 xOE     i  = 2i=1 xSi = 1. This implies that there exists
some i such that xOEi   < xSi . Since the problem is symmetric, we can restrict ourselves
to {li } ∈ L2 such that xOE
                         1    < xS1 . We claim

                                    inf          inf        r2 ({li }, xOE ) ≥ r2,t
                                                                                OE
                                                                                    ,                   (24)
                                 {li }∈L2        −−
                                                  →
                                            xOE ∈OE ({li })


where

  OE                                      R − l1 y1OE − l2 y2OE
 r2,t = minimize lSi ,       (lS )0 ≥0                                                                  (E)
                               i
                         li , l0 ≥0
                                           R − l1S y1S − l2S y2S
                                i
                       S
                      y , y    OE   ≥0
                       i       i

                subject to                liS ≤ yiS (liS )0 ,            i = 1, 2,                      (25)
                                            S     S S 0       S  S S 0
                                          l2 + y2 (l2 ) = l1 + y1 (l1 ) ,                               (26)
                                          l1S + y1S (l1S )0 ≤ R,                                        (27)
                                          X  2
                                               yiS = 1,                                                 (28)
                                          i=1
                                          l1 ≤ l1S ,                                                    (29)
                                          l10 = 0,        if l1S = 0.                                   (30)
                                          li ≤ yiOE li0 ,       i = 1, 2,                               (31)
                                          X  2
                                               yiOE = 1,                                                (32)
                                          i=1
                                          + {Oligopoly Equilibrium Constraints}t ,          t = 1, 2.

    Problem (E) can be viewed as a finite dimensional problem that captures the equilib-
rium and the social optimum characteristics of the infinite dimensional problem given in
Eq. (23). This implies that instead of optimizing over the entire function li , we optimize
over the possible values of li (·) and ∂li (·) at the equilibrium and the social optimum,
which we denote by li , li0 , liS , (liS )0 [i.e., (liS )0 is a variable that represents all possible values
of gli ∈ ∂li (yiS )]. The constraints of the problem guarantee that these values satisfy the
necessary optimality conditions for a social optimum and an OE. In particular, condi-
tions (25) and (31) capture the convexity assumption on li (·) by relating the values li , li0
and liS , (liS )0 [note that the assumption li (0) = 0 is essential here]. Condition (26) is the

                                                            23
optimality condition for the social optimum. Condition (29) captures the nondecreasing
assumption on the latency functions; since we are considering {li } such that xOE  1   < xS1 ,
we must have l1 ≤ l1 . Condition (30) captures the relation of l1 (·) and l1 (·) at xOE
                        S                                                       0
                                                                                         1 ;
since xOE
        1  <  x S
                1 , the fact that l (x
                                   1 1
                                       OE
                                          ) = l  (x
                                                1 1
                                                    S
                                                      ) = 0 implies, by Assumption 1, that  0
                                 OE
is the unique element of ∂l1 (x1 ). Finally, the last set of constraints are the necessary
conditions for a pure strategy OE. These are written separately for t = 1, 2, for the two
cases characterized in Proposition 9, giving us two bounds, which we will show to be
equal.
    More explicitly, the Oligopoly Equilibrium constraints are given by:

For t = 1: [corresponding to a lower bound for pure strategy OE, (pOE , y OE ), with
minj {pOE
       j  + lj (yjOE )} < R],

                               l1 + y1OE [l10 + l20 ] = l2 + y2OE [l10 + l20 ],                            (33)
                               l1 + y1OE [l10 + l20 ] ≤ R,
where l10 = l10 (y1OE ), l20 = l20 (y2OE ) [cf. Eq. (16)].

For t = 2: [corresponding to a lower bound for pure strategy OE, (pOE , y OE ), with
minj {pOE
       j  + lj (yjOE )} = R],

                                        R − l2 ≥ y2OE l20 ,                                                (34)
                                        R − l1 ≤ y1OE [l10 + l20 ] ,
where l10 = l1+ (y1OE ) and l20 = l2− (y2OE ) [cf. Eqs. (17), (18)]. We will show in Step 4 that
 OE      OE
r2,1  = r2,2 .
     Note that given any feasible solution of problem (23), we have a feasible solution for
problem (E) with the same objective function value. Therefore, the optimum value of
problem (E) is indeed a lower bound on the optimum value of problem (23).

    Step 2: Let (liS , yiS )i=1,2 satisfy Eqs. (25)-(28). We show that
                                              l1S y1S + l2S y2S < R.                                       (35)
Using Eqs. (26), (27), and (28), we obtain
                             l1S y1S + l2S y2S + (y1S )2 (l1S )0 + (y2S )2 (l2S )0 ≤ R.
If (y1S )2 (l1S )0 + (y2S )2 (l2S )0 > 0, then the result follows. If (y1S )2 (l1S )0 + (y2S )2 (l2S )0 = 0, then
we have using Eq. (25) that liS =0 for all i, again showing the result.
    Next, let (li , yiOE )i=1,2 satisfy Eq. (32) and one of the Oligopoly Equilibrium con-
straints [i.e., Eqs. (33) or (34)]. Using a similar argument, we can show that
                                            l1 y1OE + l2 y2OE < R.                                         (36)

     Step 3: To solve problem (E), we first relax the last constraint [Eq. (30)]. Let
 ¯S ¯S 0 ¯ ¯0
(li , (li ) , li , li , ȳiS , ȳiOE ) denote the optimal solution of the relaxed problem [problem (E)
without constraint (30)]. We show that ¯liS = 0 for i = 1, 2.

                                                        24
  Assign the Lagrange multipliers µSi , λS , γ S to Eqs. (25), (26), (27), respectively, and
multiplier θS to Eq. (28). Using the first order optimality conditions, we obtain

                            (R − ¯l1 ȳ1OE − ¯l2 ȳ2OE )
                     ȳ2S                                  + µS2 + λS = 0 if ¯l2S > 0              (37)
                             (R − ¯l1S ȳ1S − ¯l2S ȳ2S )2
                                                                      ≥ 0 if ¯l2S = 0,


                                   −µS2 ȳ2S + λS ȳ2S = 0 if (¯l2S )0 > 0                         (38)
                                                       ≥ 0 if (¯l2S )0 = 0,


                              −µS1 ȳ1S − λS ȳ1S + γ S ȳ1S = 0 if (¯l1S )0 > 0                   (39)
                                                             ≥ 0 if (¯l1S )0 = 0.

                 ¯ OE ¯ OE
        ¯lS (R − l1 ȳ1 − l2 ȳ2 ) − µS (¯lS )0 − λS (¯lS )0 + γ S (¯lS )0 + θS = 0 if ȳ S > 0    (40)
          1
             (R − ¯l1S ȳ1S − ¯l2S ȳ2S )2 1 1          1             1                  1

                                                                                ≥ 0 if ȳ1S = 0,

                      ¯ OE ¯ OE
             ¯lS (R − l1 ȳ1 − l2 ȳ2 ) − µS (¯lS )0 + λS (¯lS )0 + θS = 0 if ȳ S > 0             (41)
               2
                  (R − ¯l1S ȳ1S − ¯l2S ȳ2S )2 2 2          1                  2

                                                                       ≥ 0 if ȳ2S = 0,

    We first show that ¯l2S = 0. If ȳ2S = 0 or (¯l2S )0 = 0, we are done by Eq. (25). Assume
that ȳ2S > 0 and (¯l2S )0 > 0. By Eq. (38), this implies that λS = µS2 ≥ 0. We claim that
in this case Eq. (37) cannot be equal to 0. Assume to arrive at a contradiction that it
is. Using Step 2 and the fact that ȳ2S > 0, we have µS2 + λS < 0, which is a contradiction
and shows that Eq. (37) is strictly positive. This establishes that ¯l2S = 0.
    We next show that ¯l1S = 0. If ȳ1S = 0 or (¯l1S )0 = 0, we are done by Eq. (25). Assume
that ȳ1S > 0 and (¯l1S )0 > 0. Assume to arrive at a contradiction that ¯l1S > 0. Since ¯l2S = 0,
by Eq. (26), we have that ȳ1S (¯l1S )0 < ȳ2S (¯l2S )0 , and therefore both ȳ2S > 0 and (¯l2S )0 > 0.
Since ¯l2S = 0, these imply that Eq. (25) is slack, and hence µS2 = 0. By Eq. (38), this
shows λS ȳ2S = 0, and hence λS = 0. Furthermore, since µS2 = λS = 0, from Eq. (41)
we have θS = 0, and from Eq. (39), we have µS1 = γ S . Plugging this all in Eq. (40), we
obtain a contradiction, showing that ¯l1S = 0.

   Step 4: Since ¯l1S = 0, in view of Eq. (29), we have ¯l1 = 0. Hence we can impose the
extra constraint l1 = 0 in problem (E) without changing the optimal function value, and
we can rewrite the constraint in Eq. (30) as l10 = 0. Using in addition ¯l2S = 0, we see
that for t = 1, 2,

                             OE                                       l2 y2OE
                            r2,t ≥ minimize          l2 ,l02     1−
                                                  OE , y OE ≥0
                                                 y1
                                                                         R
                                                         2

                                           subject to            l2 ≤ y2OE l20 ,

                                                      25
                                                              l2 + y2OE l20 ≤ R,
                                                              y1OE l20 ≥ R.
                                                              X 2
                                                                  yiOE = 1,
                                                               i=1

which follows because any vector (yiOE , li , li0 ) with l1 = 0 and l10 = 0 that satisfies Eqs.
(33) or (34) is a feasible solution to the above problem. It is straightforward to show that
the optimal solution of this problem is (¯l2 , ¯l20 , ȳ1OE , ȳ2OE ) = ( R2 , 3R , 2 , 1 ), and therefore it
                                                                                2 3 3
               OE      OE
follows that r2,1 = r2,2 = 5/6. By Eq. (24), this implies that
                                                                        5
                                 inf       inf        r2 ({li }, xOE ) ≥ .
                               {li }∈L2 OE −−→                          6
                                       x  ∈OE ({li })

     We next show that this bound is tight. Consider the latency functions l1 (x) = 0,
and l2 (x) = 32 x. As shown in Example 6, the corresponding OE is xOE = ( 23 , 31 ), and the
social optimum is xS = (1, 0). Hence, the efficiency metric for these latency functions is
r2 ({li }, xOE ) = 5/6, thus showing that
                                                                             5
                                min             min        r2 ({li }, xOE ) = .
                             {li }i=1,2 ∈L2 OE  −
                                                −→                           6
                                           x   ∈OE ({li })

Q.E.D.

5.1.2     General Case
We next consider the general case where we have a parallel link network with I links
and S service providers, where provider s owns a set of links Is ⊂ I. It can be seen by
augmenting a two link network with links that have latency functions
                                     ½
                                        0 if x = 0,
                              l(x) =
                                        ∞ otherwise,

that the lower bound in the general network case can be no higher than 56 . However, this
is a degenerate example in the sense that at the OE, the flows of the links with latency
functions given above are equal to 0. We next give an example of an I link network
which has positive flows on all links at the OE and an efficiency metric of 5/6.

Example 7 Consider an I link network. Let the total flow be d = 1 and the reservation
utility be R = 1. The latency functions are given by
                                                   3
                         l1 (x) = 0,       li (x) = (I − 1)x,        i = 2, . . . , I.
                                                   2
The unique social optimum for this example is xS = [1, 0, . . . , 0]. It can be seen that the
flow allocation at the unique OE is
                                ·                            ¸
                            OE    2     1              1
                           x = ,             ,...,               .
                                  3 3(I − 1)       3(I − 1)

                                                     26
Hence, the efficiency metric for this example is
                                                                  5
                                                rI ({li }, xOE ) = .
                                                                  6



   The next theorem generalizes Theorem 1 to a parallel link network with I ≥ 2 links.

Theorem 2 Consider a general parallel link network with I links and S service providers,
where provider s owns a set of links Is ⊂ I. Then
                                   5                                          −−→
                 rI ({li }, xOE ) ≥ ,                 ∀ {li }i∈I ∈ LI , xOE ∈ OE({li }),                      (42)
                                   6
                                                                   −−→
and the bound is tight, i.e., there exists {li }i∈I ∈ LI and xOE ∈ OE({li }) that attains
the lower bound in Eq. (42).

Proof. The proof again follows a number of steps:

   Step 1: Consider the problem

                                       inf           inf        rI ({li }, xOE ).                             (43)
                                     {li }∈LI        −−
                                                      →
                                                xOE ∈OE ({li })

                                  −−→
Given {li } ∈ L2 , let xOE ∈ OE({li }) and let xS be   Pa social optimum.
                                                                   P2        By Lemmas 8 and
9, we can assume without loss of generality that 2i=1 xOE    i   =        x S
                                                                       i=1 i = 1. Hence there
                                OE     S
exists some i such that xi < xi . Without loss of any generality, we restrict ourselves
to the set of latency functions {li }i∈I ∈ LI such that xOE 1   < xS1 . Similar to the proof of
Proposition 1, it can be seen that Problem (43) can be lower bounded by the optimum
value of the following finite dimensional problem:
                                         P
    OE                               R − ni=1 li yiOE
   rI,t = minimize lSi ,(lSi )0 ≥0       P                                                (44)
                        li ,l0 ≥0
                                      R − ni=1 lis yiS
                             i
                      y S ,y OE ≥0
                       i i
                          Is ⊂I

               subject to               liS ≤ yiS (liS )0 ,                         i = 1, . . . , n,         (45)
                                        liS + yiS (liS )0 = l1S + y1S (l1S )0 ,     i = 2, . . . , n,         (46)
                                        l1S + y1S (l1S )0 ≤ R,                                                (47)
                                        X  I
                                             yiS = 1                                                          (48)
                                         i=1
                                        l1 ≤ l1S ,                                                             (49)
                                        l10 = 0,                 if l1S = 0,                                   (50)
                                        Is = {1} for some s       if l1S = 0,                                  (51)
                                          + {Oligopoly Equilibrium Constraints}t ,                      t = 1, 2.

                                                           27
The new feature relative to the two link case is the presence of Is ’s as choice variables
to allow a S
           choice over possible distribution of links across service providers (with the
constraint s Is = I left implicit). The oligopoly equilibrium constraints, which are
again written separately for t = 1, 2 for the two cases in Proposition 9, depend on Ii ’s.
In addition, we have added constraint (51) to impose Assumption 2 (recall that xOE 1  >0
by Lemma 5).

    Step 2: Let (¯liS , (¯liS )0 , ¯li , ¯li0 , ȳiS , ȳiOE ) be an optimal solution of the relaxed version of
the preceding problem [i.e., without constraint (50)].
    Note that the constraints that involve (liS , (liS )0 , yiS ) for i = 2, . . . , n are decoupled
and have the same structure as in problem (E). Therefore, by the same argument used
to show ¯l2S = 0 in Step 3 of the proof of Proposition 1, one can show that ¯liS = 0 for
each i = 2, . . . , n. Similarly, one can extend the same argument given in the proof of
Proposition 1 to show that ¯l1S = 0.

    Step 3: Since ¯l1S = 0, it follows that ¯l1 = 0 [Eq. (49)], and we can assume without
loss of generality that ¯l10 = 0 and I1 = {1}. Therefore, using the price characterization
from Proposition 9, the structure of the problem simplifies to
                                                     Pn
                                                         li y OE
            rI,t ≥ minimize li ,l0i ≥0, i=2,...,I 1 − i=2 i
              OE

                                 y OE ≥0, i=1,...,I
                                                        R
                                       i

                                subject to              li ≤ yiOE li0 ,         i = 2, . . . , I,
                                                        li + yiOE li0 ≤ R,      i = 2, . . . , I,
                                                           y1OE
                                                        PI 1 ≥ R,                                        (52)
                                                             j=2 lj0
                                                        I
                                                        X
                                                               yiOE = 1,
                                                         i=1

where we have also used the fact that ¯liS = 0, for i = 2, . . . , I.
    The first set of constraints are due to the convexity assumptions on the li . Similar
to the two link case, the second set of constraints are due to the oligopoly equilibrium
constraints (given ¯l10 = 0 see the OE price characterization in Proposition 9).

    Step 4: Let ((¯li , ¯li0 )i=2,...,I , (ȳiOE )i=1,...,I ) denote an optimal solution of the preceding
problem. Assign the Lagrange multipliers µi , λi , γ and θ consecutively to the constraints
of the problem. Using the optimality conditions, we have
                                                γ
                                            PI 1 = 0 if ȳ1OE > 0                                    (53)
                                           j=2 l̄j0

                                                      ≥ 0 if ȳ1OE = 0,

                                       ȳiOE
                                   −         + µi + λi = 0 if ¯li > 0                                    (54)
                                         R
                                                       ≥ 0 if ¯li = 0,

                                                        28
and for i = 2, . . . , I,
                                           1/(¯l0 )2
                      −µi ȳiOE + γ ȳ1OE ³P i ´2 + λi ȳiOE = 0 if ¯li0 > 0                            (55)
                                                     I    1
                                                     j=2 l̄j0

                                                                             ≥ 0 if ¯li0 = 0.
By feasibility, we have ȳ1OE > 0. Using symmetry, it can also be seen that ȳiOE > 0.
Hence, by Eq. (53), we have γ = 0, which together with Eq. (55) implies that λi = µi
for all i = 2, . . . , I.
    Moreover, by Eq. (54), we have µi > 0, showing that ¯li = ȳiOE ¯li0 for each i = 2, . . . , I
(i.e., the corresponding constraint is not slack). This implies that
                            ¯li + ȳ OE ¯l0 = R, ∀ i = 2, . . . , I.
                                         i     i

Hence ¯li =   R/2 and ȳiOE ¯li0 = R/2 for each i = 2, . . . , I. We can also see that constraint
(52) is not   slack at ((¯li , ¯li0 )i=2,...,I , (ȳiOE )i=1,...,I ) (otherwise, we can improve the objective
function value), implying that
                                                      y1OE
                                                     PI      1
                                                                     = R.
                                                        j=2 l̄j0
                                                                            PI
Combining with the feasibility constraint ȳ1OE = 1 −                        j=2   ȳji , we see that
                                                   I           I
                                                RX1           X    1
                                        1−                = R     ¯l0 ,
                                                2 j=2 ¯lj
                                                        0
                                                              j=2 j

from which we obtain                                            Ã I     !
                                       I
                                       X                         X1
                                                       R                   1
                                             ȳjOE   =               ¯l0 = 3 .
                                       j=2
                                                       2         j=2 j

Hence we have
                                                                     R1
                                                                        5
                                             rIOE     =1−            2 3
                                                                       = ,
                                                                     R  6
showing that
                                                                      5
                                 inf     inf        rI ({li }, xOE ) ≥ .
                        {li }i∈I ∈LI OE  −−
                                          →                           6
                                    x   ∈OE ({li })

    Finally, Example 7 shows that the preceding bound is tight, i.e.,
                                                                      5
                            min          min        rI ({li }, xOE ) = .
                        {li }i∈I ∈LI OE  −−
                                          →                           6
                                    x   ∈OE ({l })              i

Q.E.D.

    Although Example 7 and Theorem 2 show that the efficiency loss in an arbitrarily
large network (i.e., with I → ∞) can be as high as in the two link network, the same
is not the case if we start with a given I link network and replicate it n times (also
increasing d to nd). In this case, it can be shown, as in analyses of the limit behavior of
oligopoly models (e.g., [28], [14], [22], [39], [40]), that as n → ∞, the efficiency metric
tends to 1.

                                                                29
5.2    Mixed Strategy Equilibria
As we illustrated in Section 4, congestion games with latency functions that satisfy
Assumptions 1, 2, and 3 may not have a pure strategy oligopoly equilibrium (cf. Example
3). Nevertheless, as shown in Proposition 8, such games always have a mixed strategy
equilibrium. In this section, we discuss the efficiency properties of mixed strategy OE.
    Although there has been much less interest in the efficiency properties of mixed
strategy equilibria, two different types of efficiency metrics present themselves as natural
candidates. The first considers the worst realization of the strategies, while the second
focuses on average inefficiency across different realizations of mixed strategies. We refer
to the first metric as worst-realization metric, and denote it by r̃IW ({li }), and to the
second as the average metric, and denote it by r̃IA ({li }). We discuss both of these
briefly.
    Given a set of latency functions {li }i∈I , let OM ({li }) denote the set of mixed strategy
equilibria. For some µ ∈ OM ({li }), let Mi (µ) denote the support of µi as defined before
in Example 3 [in particular, recall that Mi = {p | µ0i (p) > 0}]. Further, let
          −−→
          OE m ({li }, µ) = {x | x ∈ W (p), for some p s.t. pi ∈ Mi (µ) for all i}.

We define the worst-realization efficiency metric as

                 r̃IW ({li }) = inf        inf              inf           rI ({li }, xOE ),
                              {li }∈LI µ∈OM ({li })        −
                                                           −→
                                                      xOE ∈OE m ({li },µ)

where rI is given by Eq. (21).
  Similarly, the average efficiency metric is defined as
                                      Z        Z
              A
            r̃I ({li }) = inf    inf      · · · rI ({li }, xOE (p))dµ1 · · · dµS .
                         {li }∈LI µ∈OM ({li })

   In the next example, we show that the worst-realization efficiency metric for games
with no pure strategy equilibrium can be arbitrarily low.

Example 3 (continued) Consider the prices p1 = R and p2 = R(1 − δ) that satisfy
pi ∈ Mi for the unique mixed strategy equilibrium given in Example 3 as ² → 0. The
WE at these prices is given by
                                  xOE = (1 − δ, δ) ,
and the worst-realization efficiency metric is

                                        r̃IW ({li }) = 1 − δ 2 ,

which as δ → 1 goes to 0.
    Next consider the average efficiency metric, r̃IA ({li }). Once again, consider the limit
as ² → 0. Recall that we have characterized the unique mixed strategy OE above, and
define r (p1 , p2 ) as the inefficiency at the price vector (p1 , p2 ), so that
                                        Z R   Z R
                            A
                          r̃I ({li }) =              r (p1 , p2 ) dµ1 × dµ2
                                       (1−δ)R    (1−δ)R


                                                  30
Clearly, using the Wardrop equilibrium flow vector derived in Example 3 before, we have
that                                   ½
                                            1         if p1 < p2
                        r (p1 , p2 ) =     δ(p1 −p2 )            ,
                                         1− R         if p1 > p2
and thus,                               Z            Z
                                             R            R
                                                                  δ (p1 − p2 )
                   r̃IA ({li })   →1−                                          dµ1 × dµ2
                                            (1−δ)R       (1−δ)R        R
Thus to calculate r̃IA ({li }), we need to compute the last integral. Denoting this by A,
we have
                Z         Z R
              δ R
      A =                       (p1 − p2 ) dµ1 × dµ2
             R (1−δ)R p2
                ·Z R        Z p1                     Z R     Z R               ¸
              δ
         =                           p1 dµ2 × dµ1 −               p2 dµ1 × dµ2
             R (1−δ)R (1−δ)R                          (1−δ)R p2
                ·Z R           µ                 ¶             Z R                       ¸
              δ                   1 (1 − δ) R
         =                  p1      −              dµ1 (p1 ) −         (1 − δ) Rdµ2 (p2 )
             R (1−δ)R             δ       δp1                   (1−δ)R

Now recall that µ1 has an atom equal to 1 − δ at R, so
             ·             Z R        µ             ¶µ           ¶               ¸
           δ                            1 (1 − δ) R    (1 − δ) R
  A =          R (1 − δ) +         p1     −                        dp1 − R(1 − δ)
           R                (1−δ)R      δ    δp1           p21
       = (1 − δ)2 − (1 − δ) + (1 − δ)[ln R − ln((1 − δ)R)]
       = − (1 − δ) δ − (1 − δ) ln (1 − δ)

It can be calculated that A reaches a maximum of approximately 0.16 for δ ≈ 0.8.
Therefore, in this example, r̃IA ({li }) reaches 0.84 ≈ 5/6 (in fact, slightly greater than
5/6). We conjecture, but are unable to prove, that 5/6 is also a lower bound for the
average efficiency metric, r̃IA ({li }), in mixed strategy OE. This is left as an open research
question.


6     Conclusions
In this paper, we presented an analysis of competition in congested networks. We es-
tablished a number of results. First, despite the potential inefficiencies of flow-routing
without prices, price-setting by a monopolist always achieves the social optimum. Sec-
ond, and in contrast to the monopoly result, oligopoly equilibria where multiple service
providers compete are typically inefficient. Third, there is a tight bound of 5/6 on ineffi-
ciency in pure strategy oligopoly equilibria. This bound is obtained even for arbitrarily
large parallel link networks. Finally, pure strategy equilibria may fail to exist when some
latency functions are highly convex. Mixed strategy equilibria can lead to arbitrarily
inefficient realizations.
    A number of concluding comments are useful:


                                                         31
• Our motivating example has been the flow of information in a communication net-
  work, but our results apply equally to traffic assignment problems and oligopoly
  in product markets with negative externalities, congestion or snob effects (as orig-
  inally suggested by Veblen [38]).

• Our analysis has been quite general, in particular, allowing for constant latencies
  and capacity constraints. Some of the analysis simplifies considerably when we
  specialize the network to increasing and real-valued (non-capacity constrained) la-
  tencies. On the other hand, the assumption that li (0) = 0 is important for our
  efficiency bounds. This can be relaxed to derive a slightly lower bound on the effi-
  ciency in pure strategy OE, but this significantly complicates the characterization
  of the form of equilibrium prices in OE (unless we assume that all latency functions
  are increasing rather than non-decreasing). We leave this for future work.

• One simplifying feature of our analysis is the assumption that users are “homo-
  geneous” in the sense that the same reservation utility, R, applies to all users. It
  is possible to conduct a similar analysis with elastic and heterogeneous users (or
  traffic), but this raises a number of new and exciting challenges. For example,
  monopoly or oligopoly providers might want to use non-linear pricing (designed
  as a mechanism subject to incentive compatibility constraints of different types of
  users, e.g., [42]). This is an important research area for understanding equilibria in
  communication networks, where users often have heterogeneous quality of service
  requirements.

• While we have established that worst-realization efficiency metric in mixed strategy
  oligopoly equilibria can be arbitrarily low, a bound for average efficiency metric is
  an open research question.




                                         32
7     Appendix A: Proof of Proposition 4
If (pM E , xM E ) is an ME, then it is an SPE by definition. Let (pM E , xM E ) be an SPE.
Assume to arrive at a contradiction that there exists some p ≥ 0 and x̃ ∈ W (p) such
that
                                  Π(pM E , xM E ) < Π(p, x̃).                          (56)
If W (p) is a singleton,
                  PI we immediately
                             PI         obtain a contradiction. Assume that W (p) is not
a singleton and i=1 xi = i=1 x̄i for all x, x̄ ∈ W (p). By Lemma 2, it follows that
Π(p, x̃) = Π(p, x) for all x ∈ W (p), which contradicts the fact that (pM E , xM E ) is an
SPE.
    Assume finally that W (p) is not a singleton and
                       I
                       X              I
                                      X
                              x̂i <          x̄i ,         for some x̂, x̄ ∈ W (p).       (57)
                        i=1           i=1


For this case, we have pi = R for all i ∈ Ī, where

                        Ī = {i ∈ I | ∃ x, x̄ ∈ W (p) with xi 6= x̄i },
                                           P
[cf. Eq. (5)]. To see this, note that since Ii=1 x̂i < d, the WE optimality conditions for
x̂ [cf. Eq. (2)] hold with λ = 0. Assume that p̃ < R. By Lemma 2, li (xi ) = 0 for all
i ∈ Ī. If bCi = ∞ for some i ∈ Ī, we get a contradiction by Eq. (2). Otherwise, Eq. (2)
                                   ¯ Since x̂i = x̄i for all i ∈
implies that x̂i = bCi for all i ∈ I.                          / Ī, this contradicts Eq. (57).
     We show that given δ > 0, there exists some ² > 0 such that

                        Π(p² , x² ) ≥ Π(p, x̃) − δ,                    ∀ x² ∈ W (p² ),    (58)

where                                                ½
                                                         pi    i∈/ Ī,
                                       p²i    =                                           (59)
                                                         R − ² i ∈ Ī.
The preceding relation together with Eq. (56) contradicts the fact that (pM E , xM E ) is
an SPE, thus establishing our claim.
   We first show that              X        X
                                      x²i ≥    x̃i .                                (60)
                                                i∈Ī            i∈Ī

Assume to arrive at a contradiction that
                                   X         X
                                       x²i <   x̃i .                                      (61)
                                                i∈Ī            i∈Ī


This implies that there exists some j ∈ Ī such that x²j < x̃j (which also implies that
x²j < bCj ). We use the WE optimality conditions [Eq. (2)] for x̃ and x² to obtain the
following:




                                                           33
   • There exists some λ̃ ≥ 0 such that for some i ∈ Ī,
                                             R − li (x̃i ) − pi = 0 ≥ λ̃,
      where we used the facts that li (x̃i ) = 0, pi = R [cf. Lemma 2] and x̃i > 0 for some
      i ∈ Ī [cf. Eq. (56)]. Since λ̃ = 0, we have, for all i ∈
                                                              / Ī,
                                    R − li (x̃i ) − pi ≤ 0 if x̃i ≤ bCi ,                            (62)
                                                       ≥ 0 if x̃i = bCi .

   • There exists some λ² ≥ 0 such that
                                                       ² − lj (x²j ) ≤ λ² ,                          (63)
      (since x²j < x̃j and pj = R − ²), and for all i ∈
                                                      / Ī,
                                    R − li (x²i ) − pi ≤ λ²                    if x²i = 0,           (64)
                                                       ≥ λ²                    if x²i > 0.

If λ² = 0, then by Eq. (63) and the fact that lj (x̃j ) = 0 (Lemma 2), we obtain
                                 lj (x²j ) ≥ ² > 0 = lj (x̃j ),
                                              P
which is a contradiction. If λ² > 0, then Ii=1 x²i = d. Assume first that x²i ≤ x̃i for all
i∈
 / Ī. Then            X               X              X          X
                           x²i = d −        x²i ≥ d −      x̃i ≥   x̃i ,
                         i∈Ī                  i∈
                                                / Ī                  i∈
                                                                       / Ī             i∈Ī

which yields a contradiction by Eq. (61). Assume next that x²k > x̃k for some k ∈
                                                                                / Ī. By
Eqs. (62) and (64), we have
                                 R − lk (x²k ) − pk ≥ λ² ,
                                         R − lk (x̃k ) − pk ≤ 0,
which together implies that lk (x̃k ) > lk (x²k ), yielding a contradiction and proving Eq.
(60).
    Since W (p) is an upper semicontinuous correspondence and the ith component of
W (p) is uniquely defined for all i ∈ / Ī, it follows that xi (·) is continuous at p for all
i∈/ Ī. Together with Eq. (5), this implies that
                                X             X                     X
                 Π(p² , x² ) =       pi x̃i +     pi (x²i − x̃i ) +   (R − ²)x²i
                                     i∈
                                      / Ī                i∈
                                                           / Ī                          i∈Ī
                                    X                 X             X
                                ≥            pi x̃i +  (R − ²)x̃i +   pi (x²i − x̃i )
                                     i∈
                                      / Ī                i∈Ī                        i∈
                                                                                       / Ī
                                    I
                                    X                      X               X
                                =            pi x̃i − ²            x̃i +           pi (x²i − x̃i )
                                     i=1                    i∈Ī           i∈
                                                                            / Ī
                                    I
                                    X
                                ≥            pi x̃i − δ,
                                     i=1

where the last inequality holds for sufficiently small ², establishing (58), and completing
the proof. Q.E.D.

                                                            34
8     Appendix B: Proof of Proposition 8
We will prove Proposition 8 using Theorem 5* of Dasgupta and Maskin [10]. We start
by stating a slightly simplified version of this theorem. Consider an S player game. Let
the strategy space of player s, denoted by Ps , be a closed interval of Rns for some ns ∈ N,
                                                                                  Q
                                                                                  S
and its payoff function by πs (ps , p−s ). We also denote p = (ps , p−s ), P =       Ps , and
                                                                                                 s=1
           Q
           S
P−s =               Ps . To state Theorem 5* in [10], we need the following three definitions.
        k=1,k6=s,
                                          P
Definition A1 Let π(p) =                      s∈S   πs (ps , p−s ). π (p) is upper semicontinuous in p if for
all p̄,
                                                 lim sup π(p) ≤ π(p̄).
                                                       p→p̄


Definition A2 The profit function πs (ps , p−s ) is weakly lower semicontinuous in ps if
for all p̄s ∈ Ps , there exists λ ∈ [0, 1] such that for all p−s ∈ P−s ,

               λ lim inf πs (ps , p−s ) + (1 − λ) lim inf πs (ps , p−s ) ≥ πs (p̄s , p−s ).
                         ps ↓p̄s                                   ps ↑p̄s



Definition A3 For each player s, let Ds ∈ N. For each D with 0 ≤ D ≤ Ds and each
                                 D
k 6= s with 1 ≤ k ≤ S, let fsk     be a one-to-one, continuous function. Let P̄ (s) be a subset
of P , such that
                ©                                                              D
                                                                                       ª
        P̄ (s) = (p1 , ..., pS ) ∈ P | ∃ k 6= s, ∃ D, 0 ≤ D ≤ Ds s.t. pk = fsk    (ps ) .


  In other words, P̄ (s) is a lower dimensional subset of P (which is also of Lebesgue
measure zero). Theorem 5* in [10] states:

Theorem A1 (Dasgupta-Maskin) Assume that πs (ps , p−s ) is continuous in p except
on a subset P ∗∗ of P̄ (s), weakly lower semicontinuous in ps for all s and bounded, and
that π(p) is upper semicontinuous in p. Then the game [(Ps , πs ) ; s = 1, 2, · · ·, S] has a
mixed strategy equilibrium.

   We show that our game satisfies the hypotheses of Theorem A1. We will select a
function x∗ (ps , p−s ) from the set of Wardrop equilibria, W (ps , p−s ), such that

                              πs (ps , p−s ) = Πs (ps , p−s , x∗ (ps , p−s )),
                                                                     ∀ s ∈ S,
                                                                          P
that will satisfy these hypotheses. First, since Ps = [0, R]Is and i xi (p) ≤ d for all p,
and all x ∈ W (p), πs (ps , p−s ) is clearly bounded.
   Since W (ps , p−s ) is an upper semicontinuous correspondence, we select x∗ (·) such
that                X                      X
           lim inf       x∗j (ps , p−s ) =    x∗j (p̄s , p−s ), ∀ p̄s ≥ 0, ∀ p−s ≥ 0. (65)
                    ps ↑p̄s
                              j∈Is                   j∈Is


                                                              35
Given p ≥ 0, since pj = pk for all j, k ∈ Ī, where Ī is defined in Eq. (5) in Lemma 2, it
follows that
                lim inf πs (ps , p−s ) = πs (p̄s , p−s ),            ∀ p̄s ≥ 0, ∀ p−s ≥ 0,
                     ps ↑p̄s

hence ensuring that πs (ps , p−s ) = Πs (ps , p−s , x∗ (ps , p−s )) is weakly lower semicontinuous.
We claim that we have
                    X              X
                        x∗j (p) ≥      xj (p),        ∀ p ≥ 0, ∀ x ∈ W (p).                    (66)
                         j             j

Assume the contrary. This implies that there exist some p̄ ≥ 0, s ∈ S, and x ∈ W (p̄)
such that                     X              X
                                   xj (p̄) >   x∗j (p̄).                        (67)
                                      j∈Is               j∈Is
                                 P        ∗ n
                                                        P           ∗
By Eq. (65), we have that           j∈Is xj (ps , p̄−s )
                                                  →          j∈Is xj (p̄s , p̄−s ) for some sequence
{pns } ↑ p̄s . Combined with Eq. (67), this implies that
                                X             X
                                    xj (p̄) >    x∗j (p̂s , p̄−s ),
                                   j∈Is             j∈Is

for some p̂s < ps , contradicting the monotonicity of WE by Proposition 2.
    Next, we show that πs (ps , p−s ) is continuous in p except on a set P ∗∗ . We define the
set
                           P ∗∗ = {p | W (p) is not a singleton}.
                                                                                        / P ∗∗ .
By the upper semicontinuity of W (p), we see that πs (ps , p−s ) is continuous at all p ∈
Moreover, by Lemma 2, it follows that P ∗∗ ⊂ P̄ , where
              P̄ = {p | pj = pk , for some j 6= k} ∪ {p | pj = R, for some j},
which is a lower dimensional set. This establishes the desired condition for Theorem A1.
   Finally, we show that
                                  X                   X
                          π(p) =     πs (ps , p−s ) =   pi x∗i (p),
                                       s∈S                        i∈I

is continuous at all p. Given some p ≥ 0, define Ī as in Eq. (5) of Lemma 2. If Ī = ∅,
then we automatically have that π is continuous at p. Assume that Ī 6= ∅. Since xOE         i (·)
is
Pcontinuous       at p for all i ∈
                                 / Ī and pj = pk for all j, k ∈ Ī, it is sufficient to show that
         ∗                                                  n         n          I       n
   i∈Ī xi (p) is continuous at p, i.e., for a sequence {p } with p ∈ [0, R] and p → p, we
show that                                X               X
                                     lim     x∗i (pn ) =   x∗i (p).
                                   n→∞
                                           i∈Ī               i∈Ī

Define                                              X
                                           ˜ n) =
                                           d(p              x∗i (pn ).
                                                    i∈
                                                     / Ī

Since xi (·) is continuous at p for all i ∈             ˜ n ) → d(p) = P xi (p). Consider
                                          / Ī, we have d(p             i∈
                                                                         / Ī
two cases:

                                                    36
        P               ˜
    •        bCi > d − d(p).
          i∈Ī                 Since x∗ (p) is the maximum l1 -normP element    of W (p) [cf.
                          ∗                                             ∗
      Eq. (66)] and li (xi )P= 0 for all i ∈ Ī, this implies that i∈I xi (p) = d and for all
      n sufficiently large i∈I x∗i (pn ) = d, establishing the claim.
      P                 ˜
    •        bCi ≤ d − d(p).
         i∈ĪP              P By the same reasoning as in the previous part, this implies
                   ∗
      that i∈I xi (p) = i∈Ī bCi . Moreover, for all ² > 0, there exists some n sufficiently
      large such that               ¯X                X ¯¯
                                    ¯        ∗ n
                                    ¯      x i (p ) −   bCi ¯ ≤ ²,
                                     i∈I           i∈Ī

        establishing the claim.

The preceding enable us to apply the theorem, completing the proof. Q.E.D.


9       Appendix C: Proof of Lemma 6
We first prove the following lemma:

Lemma 10 Let (pOE , xOE ) be an OE such that minj {pOEj  + lj (xOE
                                                                j )} < R. Let As-
                            OE OE                              OE
sumptions 1 and 2 hold. If pj xj > 0 for some j ∈ I, then W (p ) is a singleton.

Proof. Since pOE  j xj
                      OE
                          > 0 for some j ∈ I, it follows, by Lemma 5, that pOE         OE
                                                                                    i xi   >0
                                                           OE                    OE
for all i ∈ I. We first show that for all x ∈ W (p ), we have xi ≤ xi for all i. If
li (xOE
     i ) > 0, then by Lemma 2, xi = xi
                                               OE
                                                   for all x ∈ W (pOE ). If li (xOE
                                                                                 i ) = 0, then
                                              OE
Is = {i} for some s by the fact that xi > 0 and Assumption 2, which implies that
xi ≤ xiOE by the definition of an OE (cf. Definition  PI 10).
     Since minj {pOE
                   j  +  l j (x OE
                                j  )} < R,  we  have    i=1 xi
                                                              OE
                                                                 = d. Moreover, the fact that
         OE                   OE                        OE
xi ≤ x for all x ∈ W (p ) implies that minj {pj + lj (xj )} < R as well, and therefore
PI i                                   OE
    i=1 xi = d, showing that xi = xi      for all x ∈ W (pOE ), for all i ∈ I. Q.E.D.

Proof of Lemma 6. We first prove this result for a network with two links. Assume
to arrive at a contradiction that

                                    l2+ (xOE     − OE
                                          2 ) > l2 (x2 ).                                (68)

Let {²k } be a scalar sequence with ²k ↓ 0. Consider the sequence {x1 (²k )} where x1 (²k )
is the load of link 1 at a WE given price vector (pOE1  + ²k , pOE
                                                                2 ). By Proposition 1 and
Lemma 10, the WE correspondence W (p) is upper-semicontinuous and W (pOE ) is a
singleton. Therefore, it follows that x1 (²k ) → xOE
                                                  1 . Define

                           ∂ + x1 (pOE   OE
                                    1 , p2 )       x1 (²k ) − xOE
                                                               1
                                             = lim                .                      (69)
                                   ∂p1         k→∞        ²k
Similarly, let x1 (−²k ) be the load of link 1 at a WE given price vector (pOE
                                                                            1  − ²k , pOE
                                                                                       2 ).
           OE                                       k     OE
Since W (p ) is a singleton, we also have x1 (−² ) → x1 . Define
                          ∂ − x1 (pOE   OE
                                   1 , p2 )       xOE − x1 (−²k )
                                            = lim 1               .                      (70)
                                  ∂p1         k→∞      ²k

                                             37
Since minj {pOE
             j  + lj (xOE
                       j )} < R, it can be seen using Lemma 4 that


                        ∂ + x1 (pOE   OE
                                 1 , p2 )           −1
                                          ≥ − OE                 ,
                                ∂p1         l1 (x1 ) + l2+ (xOE
                                                             2 )

and
                        ∂ − x1 (pOE   OE
                                 1 , p2 )           −1
                                          ≤ + OE                 .
                                ∂p1         l1 (x1 ) + l2− (xOE
                                                             2 )

Since l1+ (xOE     − OE
            1 ) = l1 (x1 ) by Assumption 3, this combined with Eq. (68) yields

                          ∂ + x1 (pOE   OE
                                   1 , p2 )   ∂ − x1 (pOE   OE
                                                       1 , p2 )
                                            >                   .                 (71)
                                  ∂p1                 ∂p1

   Consider the profit of service provider 1, Π1 (pOE   OE     OE OE
                                                   1 , p2 ) = p1 x1 . Define

              ∂ + Π1 (pOE   OE
                       1 , p2 )       Π1 (pOE
                                           1  + ²k , pOE         OE   OE
                                                      2 ) − Π1 (p1 , p2 )
                                = lim                                     ,
                      ∂p1         k→∞                  ²k

              ∂ − Π1 (pOE   OE
                       1 , p2 )       Π1 (pOE   OE         OE
                                           1 , p2 ) − Π1 (p1  − ²k , pOE
                                                                      2 )
                                = lim                  k
                                                                          .
                      ∂p1         k→∞                 ²
Since pOE
       1  is a maximum of Π1 (·, pOE
                                  2 ), we have

                  ∂ + Π1 (pOE   OE
                           1 , p2 )
                                                 +     OE   OE
                                             OE ∂ x1 (p1 , p2 )
                                    = xOE
                                       1  + p1                  ≤ 0,              (72)
                          ∂p1                         ∂p1
and
                  ∂ − Π1 (pOE   OE
                           1 , p2 )
                                                 −     OE   OE
                                             OE ∂ x1 (p1 , p2 )
                                    = xOE
                                       1  + p1                  ≥ 0,              (73)
                          ∂p1                         ∂p1
which, when combined, yields

                          ∂ + x1 (pOE   OE
                                   1 , p2 )   ∂ − x1 (pOE   OE
                                                       1 , p2 )
                                            ≤                   ,                 (74)
                                  ∂p1                 ∂p1

which is a contradiction by Eq. (71), thus showing that we have l2+ (xOE     − OE
                                                                      2 ) = l2 (x2 ).
    We next consider a network with multiple links. As in Eqs. (69) and (70), we define
for all i ∈ I,
                            ∂ + xi (pOE )       xi (²k ) − xOE
                                                            i
                                          = lim           k
                                                               ,
                                 ∂p1        k→∞         ²
                           ∂ − xi (pOE )       xOE − xi (−²k )
                                         = lim i               .
                                ∂p1        k→∞      ²k
Using the same line of argument as above, we obtain

                         ∂ + x1 (pOE )             −1
                                       ≥ − OE                1           ,
                              ∂p1        l1 (x1 ) + P            1
                                                        i6=1 l+ (xOE )
                                                              i   i




                                            38
                          ∂ − x1 (pOE )             −1
                                        ≤ + OE                   1           .                   (75)
                               ∂p1        l1 (x1 ) + P               1
                                                            i6=1 l− (xOE )
                                                                  i   i

Let 1 ∈ Is , and without loss of any generality, assume that all li ’s for i ∈ Is are smooth
(recall Assumption 3). For all i ∈ Is , i 6= 1, we obtain

                 ∂ + xi (pOE )                          1
                               ≥            ³               ³P                      ´´ ,
                      ∂p1        li+ (xOE )  1 + l − OE
                                                    (x    )                  1
                                       i          1    1       j6=1     lj+ (xOE
                                                                              j )


                 ∂ − xi (pOE )                            1
                               ≤            ³                 ³P                    ´´ .
                      ∂p1        li− (xOE )   1 + l + OE
                                                     (x     )                1
                                       i           1    1       j6=1    lj− (xOE
                                                                              j )


   To arrive at a contradiction, assume that lj+ (xOE     − OE
                                                   j ) > lj (xj ) for some j ∈
                                                                             / Is . Then
the preceding two sets of equations imply that

                                   ∂ + xi (pOE )   ∂ − xi (pOE )
                                                 >               .                               (76)
                                        ∂p1             ∂p1
for all i ∈ Is .
    Next, Eqs. (72) and (73) for multiple link case are given by

           ∂ + Π1 (pOE )             ∂ + x1 (pOE )     X           ∂ + xi (pOE )
                         = xOE
                            1  + pOE
                                  1                +           pOE
                                                                i                ≤ 0,
                ∂p1                       ∂p1        i∈I ,i6=1
                                                                        ∂p1
                                                             s



           ∂ − Π1 (pOE )             ∂ − x1 (pOE )     X           ∂ − xi (pOE )
                         = xOE
                            1  + pOE
                                  1                +           pOE
                                                                i                ≥ 0,            (77)
                ∂p1                       ∂p1        i∈I ,i6=1
                                                                        ∂p1
                                                             s


which are inconsistent with Eq. (76), leading to a contradiction. This proves the claim
for the multiple link case. Q.E.D.


10     Appendix D: Proof of Proposition 9
We first assume that minj {pOE            OE
                                 j + lj (xj )} < R. Consider service provider s and assume
without loss of generality that 1 ∈ Is . Since pOE  j xj
                                                        OE
                                                            > 0 for some j ∈ Is0 and s0 ∈ S,
                                   OE OE
it follows by Lemma 5 that pi xi > 0 for all i ∈ I. Together with Lemma 4, this
implies that ((pOE
                i )i∈Is , x
                            OE
                                ) is an optimal solution of the problem
                                        X
           maximize((pi )i∈Is ,x)≥0         p i xi                                      (78)
                                       i∈Is
                      subject to       l1 (x1 ) + p1 = li (xi ) + pi ,           i ∈ Is − {1},
                                       l1 (x1 ) + p1 = li (xi ) + pOE
                                                                   i ,             i∈/ Is ,
                                       l1 (x1 ) + p1 ≤ R,                                        (79)
                                       X
                                            xi ≤ d.
                                       i∈I


                                                39
By Lemma 6, we have that li is continuously differentiable in a neighborhood of xOE    i
for all i (since the gradient mapping of a convex function is continuous over the set the
function is differentiable, see Rockafellar [29]). Therefore, by examining the Karush-
Kuhn-Tucker conditions of this problem, we obtain

                            pOE
                             i  = xOE 0   OE
                                   i li (xi ) − θ,                ∀ i ∈ Is ,          (80)

where                
                      0,    P
                                                 if lj0 (xOE
                                                          j ) = 0 for some j ∈
                                                                             / Is ,
                θ=                    xOE                                             (81)
                      −    P j∈Is j1
                             j ∈I
                               / s l0 (xOE )
                                               , otherwise,
                                    j j

showing the result in Eq. (16).
    We next assume that minj {pOE       OE                                   OE OE
                                j +lj (xj )} = R. Using the assumption that pj xj  >
0 for some j ∈ I and Lemma 4, this implies that

                                  pOE
                                   i  = R − li (xOE
                                                 i ),              ∀ i,

and thus for all s ∈ S, xOE is an optimal solution of
                                        X
                           maximize         (R − li (xi ))xi
                                                  i∈Is
                             subject to           xi ∈ T i ,  ∀i∈
                                                                / Is
                                                  X
                                                      xi ≤ d,                         (82)
                                                  i∈I

where Ti = {xi | pOE
                  i  + li (xi ) = R} is either a singleton or a closed interval. Since this
is a convex problem, using the optimality conditions, we obtain

                        R − li (xOE     OE
                                 i ) − xi gli = θs ,                 ∀ i ∈ Is ,

where θs ≥ 0 is the Lagrange multiplier associated with constraint (82), and gli ∈
                  − OE
∂li (xOE
      i ). Since li (xi ) ≤ gli , the preceding implies

                                           OE − OE
                     pOE
                      i  = R − li (xOE
                                    i ) ≥ xi li (xi ),                     ∀ i ∈ I,

proving (17).
    To prove (18), consider some i ∈ I with Is = {i} for some s and the sequence of price
vectors {pk } with pk = (pOE
                           i  − ²k , pOE          k                             k
                                      −i ). Let {x } be a sequence such that x ∈ W (p )
                                                                                         k
                                                                  k                   OE
for all k. By the upper semicontinuity of W (p), it follows that x → x̄ with x̄ ∈ W (p )
and x̄ ≤ xOE (see the proof of Lemma 10). Moreover, by Lemma 2, we have xki ≥ xOE      i
for all k, which implies that x̄i ≥ xOE                   k     OE
                                      i , showing that xi → xi . We can now use Eqs.
(73) and (77) (by substituting i instead of 1 and using Is = {i}) to conclude that

                                      + OE                      xOE
                                                                 i
                            pOE
                             i  ≤ xOE
                                   i li (xi ) + P                      1     .
                                                              j6=1 l− (xOE )
                                                                    j   j


Q.E.D.

                                                    40
References
 [1] Acemoglu, D., and Ozdaglar, A.,“Flow control, routing, and performance from
     service provider viewpoint,” LIDS report, WP-1696, May 2004.

 [2] Anshelevich E., Dasgupta A., Kleinberg J., Tardos E., Wexler T., and Roughgarden
     T., “The price of stability for network design with selfish agents,” IEEE Symposium
     on Foundations of Computer Science, pp. 295-304, 2004.

 [3] Basar, T. and Srikant R., “Revenue-maximizing pricing and capacity expansion in
     a many-users regime,” Proceedings of INFOCOM, 2002.

 [4] Beckmann, M., Mcguire, C. B., and Winsten, C. B., Studies in the Economics of
     Transportation. Yale University Press, 1956.

 [5] Berge, C., Topological Spaces, Dover reprint, 1963.

 [6] Benassy, J. P., “Market size and substitutability in imperfect competition: A
     Bertrand-Edgeworth- Chamberlin model,” Review of Economic Studies,vol. 56, pp.
     217-234, 1989.

 [7] Bertsekas, D. P., Nedic, A., and Ozdaglar, A., Convex Analysis and Optimization,
     Athena Scientific, Belmont, MA, 2003.

 [8] Correa, J. R., Schulz, A. S., and Stier Moses, N., “Selfish Routing in Capacitated
     Networks,” Mathematics of Operations Research, 29:4, pp. 961-976, Nov. 2004.

 [9] Dafermos, S. and Sparrow F. T., “The traffic assignment problem for a general
     network,” Journal of Research of the National Bureau of Standards-B. Mathematical
     Sciences, vol. 73(2), pp. 91-118, 1969.

[10] Dasgupta, P. and Maskin E., “The existence of equilibrium in discontinuous eco-
     nomic games. 2: Theory,” Review of Economic Studies, vol. 53, pp. 1-26, 1986.

[11] Edgeworth, F., “The pure theory of monopoly,” in Papers relating to Political
     Economy, vol. 1, pp. 111-143, London, Mc Millan, 1925.

[12] Friedman, E., “A Generic Analysis of Selfish Routing,”Proceedings of the 43rd IEEE
     Conference on Decision and Control, 2004.

[13] Fudenberg, D. and Tirole J., Game Theory. The MIT Press, 1991.

[14] Hart, O. D., “Monopolistic competition in a large economy with differentiated com-
     modities,” Review of Economic Studies, vol. 46, pp. 1-30, 1979.

[15] He, L. and Walrand, J., “Pricing internet services with multiple providers,” Pro-
     ceedings of Allerton Conference, 2003.

[16] Johari, R. and Tsitsiklis, J., “Network resource allocation and a congestion game,”
     Mathematics of Operations Research, to appear, 2004.

                                          41
[17] Kelly, F. P., Maulloo A. K., and Tan D. K.,“Rate control for communication net-
     works: shadow prices, proportional fairness, and stability,” Journal of the Opera-
     tional Research Society, vol. 49, pp. 237-252, 1998.

[18] Korilis, Y. A., Lazar, A. A., and Orda, A.,“Achieving network optima using Stack-
     elberg routing strategies,” IEEE/ACM Transactions on Networking, vol. 5(1), pp.
     161-173, 1997.

[19] Koutsoupias, E. and Papadimitriou, C.,“Worst-case Equilibria,” Proceedings of the
     16th Annual Symposium on Theoretical Aspects of Computer Science, pp. 404-413,
     1999.

[20] Low, S. and Lapsley, D. E., “Optimization flow control, I: Basic algorithm and con-
     vergence,” IEEE/ACM Transactions on Networking, vol. 7(6), pp. 861-874, 1999.

[21] Mascolell, A., Whinston, M. D., and Green, J. R., Microeconomic Theory, Oxford,
     United Kingdom: Oxford University Press, 1995.

[22] Novshek, W., “Perfectly competitive markets as the limits of Cournot markets,”
     Journal of Economic Theory, vol. 19, pp. 223-266, 1985.

[23] Orda, A., Rom, R., and Shimkin, N., “Competitive routing in multi-user commu-
     nication networks,” IEEE/ACM Transactions on Networking, vol. 1, pp. 510-521,
     1993.

[24] Osborne and Rubinstein, Game Theory, The MIT Press.

[25] Patriksson, M., The Traffic Assignment Problem: Models and Methods, VSP BV,
     Netherlands, 1994.

[26] Perakis, G., “The Price of Anarchy when Costs are Non-separable and Asymmet-
     ric”, manuscript.

[27] Pigou, A. C., The Economics of Welfare. Macmillan, 1920.

[28] Roberts, D. and Postlewaite, A., “The incentives for price taking in large exchange
     economies,” Econometrica, vol. 44, pp. 115-127, 1976.

[29] Rockafeller, Convex Analysis, Princeton, New Jersey: Princeton University Press,
     1970.

[30] Rosen, J. B., “Existence and uniqueness of equilibrium points for concave N -person
     games,” Econometrica vol. 33(3), pp. 520-534, 1965.

[31] Roughgarden, T. and Tardos, E., “How bad is selfish routing?” Journal of the
     ACM, vol. 49(2), pp. 236-259, 2002.

[32] Sanghavi S. and Hajek B., “Optimal allocation of a divisible good to strategic
     buyers,” 43rd IEEE Conference on Decision and Control - CDC 2004.


                                          42
[33] Samuelson, P. A., “Spatial price equilibrium and linear programming,” American
     Economic Review, vol. 42, pp. 283-303, 1952.

[34] Shenker, S., “Fundamental design issues for the future Internet,” IEEE Journal on
     Selected Areas in Communications, vol. 13, pp. 1176-1188, 1995.

[35] Shubik, M., Strategy and Market Structure, New York: Wiley, 1959.

[36] Tirole, J., The Theory of Industrial Organization, Cambridge: MIT Press, MA,
     1990.

[37] Topkis, D., “Equilibrium points in nonzero-sum n-person submodular games,”
     SIAM Journal of Control and Optimization, vol. 17, pp. 773-787, 1979.

[38] Veblen, T., The Theory of the Leisure Class: An Economic Study of Institutions,
     New York: Vanguard Press.

[39] Vives, X., “On the efficiency of Bertrand and Cournot equilibria with product
     differentiation,” Journal of Economic Theory, vol. 36, pp. 166-175, 1985.

[40] Vives, X., Oligopoly Pricing, Cambridge: MIT Press, MA, 2001.

[41] Wardrop, J. G., “Some theoretical aspects of road traffic research,” Proceedings of
     the Institute of Civil Engineers, Pt. II, vol. 1, pp. 325-378, 1952.

[42] Wilson, R. B., Nonlinear Pricing, New York: Oxford University Press, 1993.




                                          43
