                              NBER WORKING PAPER SERIES




        GLOBAL TRADE AND MARGINS OF PRODUCTIVITY IN AGRICULTURE

                                         Farid Farrokhi
                                       Heitor S. Pellegrina

                                       Working Paper 27350
                               http://www.nber.org/papers/w27350


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     June 2020




We thank conversations with Jonathan Eaton, Tom Hertel, David Hummels, Samreen Malik,
Lucas Scottini, Sebastian Sotelo, Farzad Taheripour, Chong Xiang, and participants in seminars
at Purdue, NYU Abu Dhabi, NOITS and NBER Agricultural Markets and Trade Policy. We
would like to thank excellent research assistance from Karolina Wilckzynska. We would like to
thank the help from the ITaP team of Purdue with our high performance computing. All errors are
our own. The views expressed herein are those of the authors and do not necessarily reflect the
views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2020 by Farid Farrokhi and Heitor S. Pellegrina. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Global Trade and Margins of Productivity in Agriculture
Farid Farrokhi and Heitor S. Pellegrina
NBER Working Paper No. 27350
June 2020
JEL No. F10,F14,F60,Q16,R14

                                          ABSTRACT

We study the effects of globalization on agricultural productivity across countries. We develop a
multi-country general equilibrium model that incorporates choices of crops and technologies in
agricultural production at the micro-level of fields covering the surface of the earth. We estimate
our model using field-level data on potential yields of crops under different technologies
characterized by factor and input intensity. We evaluate the welfare and productivity gains from
reductions in trade costs of agricultural outputs and inputs across countries between 1980 and
2015. In addition to gains from international crop specialization, we find notable gains from
access to foreign agricultural inputs. This mechanism operates through a shift from traditional
(labor-intensive) technologies to modern (input-intensive) ones.


Farid Farrokhi
Department of Economics
Purdue University
313 Krannert Building
403 West State Street
West Lafayette, IN 47907
ffarrokh@purdue.edu

Heitor S. Pellegrina
A5 Office 1995
NYU Abu Dhabi, Saadiyat Campus
bu Dhabi, UAE
heitor.pellegrina@nyu.edu
1    Introduction

In recent decades, agricultural productivity has grown remarkably around the world. This
growth has been crucial to sustain the rising global demand for food, and to increase the
economy-wide efficiency in many countries, particularly in developing ones where the share
of employment in agriculture is high. Hence, understanding drivers of agricultural produc-
tivity has been central to discussions about food consumption and welfare across countries.
In this paper, we study how the dramatic fall in the international barriers to trade in recent
decades, often referred to as globalization, shaped agricultural productivity worldwide.
    Globalization can affect agricultural productivity through the output or the input side
of agricultural markets. On the output side, it can bring productivity gains by allowing
countries to specialize in crops in which they have a comparative advantage. On the input
side, it facilitates the procurement of inputs such as machinery, fertilizers, and pesticides that
are crucial for the use of modern, input-intensive technologies. Cross-country variations
in these two margins of productivity emerge from the enormous spatial heterogeneity in
land suitability for different crops and from large differences in countries' access to foreign
agricultural inputs.
    In this paper, we develop a quantifiable, multi-country general equilibrium model of
trade with an extremely rich spatial structure that incorporates these two margins of pro-
ductivity gains in agriculture. We bring our model to micro-level data produced by agrocli-
mate scientists on agricultural productivity of crops under different technologies for more
than 1.3 million fields covering the surface of the earth. We construct, for each field, a pro-
duction possibility frontier (PPF) that governs choices of crops and technologies. Using our
framework, we address a few key questions. What were the consequences of globalization
for land and labor productivity of crops across the world geography? How important was
the access to internationally supplied inputs for technology adoption and efficiency gains
in agriculture? How important were these input-side mechanisms for productivity gains
in agriculture as opposed to output-side mechanisms that operate through comparative ad-
vantage?
    In addition to our field-level data, which comes from the Food and Agriculture Orga-
nization's Global Agro-Ecological Zones (FAO-GAEZ) project, we assemble a country-level
dataset that integrates information on bilateral trade and production of crops and agricul-
tural inputs over more than three decades. We start our analysis by documenting three
empirical patterns that emerge from these data: (i) as a global trend, agricultural produc-

                                                2
tivity and the import content of agricultural input have largely grown since 1980; (ii) across
countries, agricultural productivity is strongly and positively associated with measures of
agricultural input intensity; and (iii), at the level of fields, there are large premia in yields of
modern, input-intensive technologies over the traditional, labor-intensive ones. Such pat-
terns indicate that productivity gains in agriculture are associated with the use of input-
intensive production technologies, and that many countries by and large procure these in-
puts through imports.
    Guided by these empirical observations, we develop our theoretical framework. Agri-
culture producers in each field choose which crops to grow and with which technology to
grow them. A technology is characterized by factor and input intensities. Therefore, higher
relative wages and lower relative prices of agricultural inputs encourage the use of labor-
saving, input-intensive technologies. To manage the margins of production choices, we in-
troduce a nested choice structure based on a generalized Fréchet distribution. This parsimo-
nious formulation allows for a different elasticity for each margin of adjustment, i.e. across
crops and across technologies within crops, and a field-level productivity shifter for every
pair of crop and technology. The two elasticities govern the curvature of the PPF in every
field along the dimension of crops and technologies, and the productivity shifters tightly
map to field-level measures of agricultural productivity from FAO-GAEZ data. Country-
level supply of crops is the endogenous outcome of the aggregation of field-level produc-
tions within a country.
    We take the model to data in two steps. First, we estimate country-level parameters
related to trade and production following standard practices in the literature using data
from 2015. Second, we construct PPFs at the field level. We calibrate heterogeneous field-
level productivity shifters for every crop-technology pair based on the FAO-GAEZ data, and
estimate the elasticities that govern the curvature of PPFs using method of moments. We
construct our moments based on field-level variations in yields and cross-country variations
in input use.1 The field-level variation in actual yields identifies the elasticity that governs
choices of crops, and cross-country variation in the cost share of agricultural inputs identifies
the elasticity that governs choices of technology.
    Equipped with our quantified model, we turn to answering our questions. To this end,
we simulate a counterfactual in which we bring trade costs in agricultural outputs and in-
puts back to their estimated level in 1980, and compare the resulting equilibrium with that
   1 To construct our moments, we also use field-level data on actual yields from the United States, as we explain later.




                                                            3
in the baseline of 2015. Our results highlight that the effects of globalization in agricul-
tural inputs operate through a distinct channel compared to that in the output side. While
reductions in trade costs on the output side bring efficiency gains that stem from compara-
tive advantage forces, reductions in the trade costs of agricultural inputs induce a notable
increase in the share of land allocated to modern technologies.
      We find that due to general equilibrium effects and differences in country characteris-
tics, the resulting welfare gains were largely heterogeneous across countries. For instance,
countries that fell behind in the process of globalization, that is, countries with a low reduc-
tion in trade costs relative to others, ended up facing relatively higher prices of agricultural
inputs. Consequently, in these countries incentives for adopting modern technologies were
lower, creating a barrier for their economic development. Yet, at the global level, due to
the overall lower trade costs of agricultural outputs and inputs, yields rose by 2.4% to 9.0%
across crops, real consumption of agriculture increased by 2.83%, and overall welfare rose
by 1.63%.
      To shed light on the effects of input-side mechanisms on agricultural productivity, we
consider counterfactuals in which trade costs fall only in agricultural outputs or only in
agricultural inputs. We find that globalization in agricultural inputs account for around half
of global welfare gains from globalization in both outputs and inputs of agriculture. Not
accounting for input-side mechanisms leads to a large underestimation of the gains from
globalization in agriculture.
      This paper relates to different strands of literature. First, our theoretical framework
builds on two papers that model crop choices using tools from Eaton and Kortum (2002): (i)
Sotelo (2020) who uses regional-level data from Peru to study the effects of domestic trade
costs on agricultural productivity, and (ii) Costinot, Donaldson, and Smith (2016) who com-
bine country and field level data to evaluate the impact of climate change on agricultural
productivity.2 Both of these papers allow for a single technology choice for each crop and
estimate their frameworks using FAO-GAEZ data. We extend their framework by introduc-
ing choices of crop and technology using a nested choice structure that allows for different
elasticities governing each type of choice.3 In addition to bringing a new mechanism driving
    2 Gouel and Laborde (2018) extend Costinot, Donaldson, and Smith (2016) to a wider set of agricultural activities --
more crops as well as livestock-- incorporating a flexible demand structure with elasticities estimated in the literature on
agricultural economics.
    3 Our nested choice structure relates to a several studies using generalized extreme value distributions of productivities
in trade models (Arkolakis, Ramondo, Rodríguez-Clare, and Yeaple, 2018; Lind and Ramondo, 2018; Lashkaripour and
Lugovskyy, 2018).



                                                              4
changes in agricultural productivity related to technology choice, our modeling approach
can incorporate additional layers of field-level data on agricultural productivity related by
technology type in a theoretically consistent manner.
      More broadly, this paper provides different contributions to research on agricultural
trade and economic development (Tombe, 2015; Gafaro and Pellegrina, 2019; Porteous, 2016;
Costinot and Donaldson, 2014; Fajgelbaum and Redding, 2019; Allen and Atkin, 2016; Don-
aldson, 2018; Pellegrina, 2019; Baldos, Hertel, and Moore, 2019; Bergquist, Faber, Fally, Hoel-
zlein, Miguel, and Rodriguez-Clare, 2019; Porteous, 2020; McArthur and McCord, 2017).
First, we quantify the effects of globalization on agricultural productivity across countries,
highlighting the critical role of access to foreign intermediates for the adoption of modern
agricultural technologies. Second, we introduce the role of technology choice into general
equilibrium model.4 By examining the role of trade in agricultural inputs, we complement
papers that incorporate input-output structures into quantitative trade and economic ge-
ography models, such as Caliendo and Parro (2015).5 In contrast to this literature, which
generally assumes exogenous cost shares of inputs based on input-output tables, we allow
differences in these cost shares to reflect endogenous technology choices.
      This paper relates to a large and varied research in agricultural economics that exam-
ines farmers' response to government policies in their choices of land use or crop supply,
e.g. see Lee and Helmberger (1985) for a pioneer study, Hertel (2002) and Hertel (2013) for
a review of recent literature on the application of computation general equilibrium models
in agriculture, and Anderson (2010, 2016) for a discussion of the causes of globalization in
agricultural trade. We provide two contributions to this literature. First, we quantify the
effects of globalization on agricultural productivity using a framework that allows for farm-
ers' crop and technology responses at fine levels of geographic disaggregation. Second, we
show that international trade in agricultural inputs has been a key component of the effects
of globalization, which reinforces findings in recent papers studying the role of commodity
trade as crucial inputs to downstream sectors, including Farrokhi (2020) and Fally and Sayre
(2018).
      Lastly, our paper relates to a rich literature in macroeconomics examining the role of
     4 In a recent paper, Bergquist, Faber, Fally, Hoelzlein, Miguel, and Rodriguez-Clare (2019) analyze the general equilib-
rium effects of scaling up policy interventions using farm-level data from Uganda. In their model, they also allow farmers
to choose between modern and traditional technologies. There are two differences between their approach and ours. First,
using the method of exact hat algebra they do not require data on agricultural productivity, but their method requires
detailed farm-level data which is not available at a global scale. Second, they do not allow for different elasticities of
substitution between crops and technologies.
    5 See Costinot and Rodríguez-Clare (2014) for a survey on tools and applications in this literature.



                                                             5
agriculture productivity in the process of economic development, e.g. Caselli (2005). Among
recent studies, Lagakos and Waugh (2013) and Gollin, Lagakos, and Waugh (2014) explore
sources of cross-country labor productivity differences in agriculture, and Donovan (2017)
studies the role of insurance markets in agriculture input use across countries. Closer to our
paper is Gollin, Parente, and Rogerson (2007), who emphasize labor-saving, input-intensive
technologies as a key mechanism driving the gains in agriculture productivity and structural
change. Our contribution to these studies is two-fold. First, we put the analysis of agricul-
tural productivity into a global perspective. Second, we connect the macro-level analysis to
micro-level heterogeneity intrinsic in conditions of land and climate across the world geog-
raphy.
      The rest of this paper is organized as follows. In Section 2, we present the data and
empirical patterns that motivate our model, which we develop in Section 3. We estimate our
model in Section 4, and run quantitative exercises in Section 5.



2       Data & Empirical Patterns

This section describes the data used in our analysis and presents empirical patterns about
agricultural production and trade that inform the formulation of our model.


2.1     Data

We describe our data in two parts: at the aggregate level of countries, and at the disaggre-
gated level of fields. Here, we highlight main features of our data, and leave a thorough
description to the appendix.


2.1.1    Country-level data

We have collected information from several sources to construct a panel of country-level data
on gross output, bilateral trade, and expenditure of crops, agricultural inputs, and nonagri-
cultural goods (see Table A.1). As for agricultural inputs, we focus on fertilizers, pesticides,
and agricultural machinery, which are exclusively used as inputs into agriculture produc-
tion.6 We complement this panel data with information on employment, cropland, share of
    6 Data on these three input categories are available with sufficient coverage and quality. Furthermore, they are fre-
quently cited as the most crucial inputs. For example, FAO-STAT provides data only for these three agricultural inputs.


                                                           6
expenditure on agriculture, value added in agriculture and non-agriculture sectors as well
as standard macroeconomic indicators such as GDP and population.
     Our final dataset contains the 65 countries with the largest agricultural value added in
the world (excluding countries with missing data) plus one region that aggregates remaining
countries which we refer to as the rest of the world (ROW). We include 10 major crops in our
analysis: banana, cotton, corn, palm oil, potato, rice, soybean, sugarcane, tomato, and wheat.
     Table 1 reports summary of statistics for our country-level data. For each variable, the
table reports aggregate values in year 2015 for eight regions that cover the world geography
and the growth at the global level between 1980 and 2015. We normalize GDP per capita
and agricultural value-added per worker such that the GDP per capita in North America
is set at unity. As it has been documented in Gollin, Lagakos, and Waugh (2014), in our
data the valued added per worker in agriculture is typically lower than its economy-wide
counterpart, and the gap between the two decreases with countries' income per capita.

                                          Table 1: Summary Statistics
                                               Values for 2015                       Global
                        North East Asia East       Latin           South      West Growth Rate
                       America & Pacific Europe America MENA Asia SSA Europe 1980-2015
                          (1)     (2)      (3)      (4)        (5)   (6)  (7)  (8)      (9)
GDP per capita           1.00    0.21     0.16     0.17       0.10  0.04 0.03 0.63    281.3
VA per worker in ag      0.53    0.14     0.06     0.06       0.04  0.01 0.01 0.28    314.4
Import share of inputs   0.33    0.10     0.46     0.56       0.29  0.32 0.62 0.65     89.2
- Machinery              0.30    0.06     0.65     0.27       0.35  0.17 0.75 0.62     49.7
- Fertilizer             0.33    0.12     0.20     0.64       0.20  0.39 0.51 0.53    120.2
- Pesticide              0.42    0.15     0.64     0.68       0.51  0.30 0.75 0.82     57.5
Number of countries        2       5        6       12          6     9   12   13

Notes: Value added data are normalized such that economy-wide value added per worker in North America is
set at unity. SSA stands for Sub-Saharan Africa. MENA stands for Middle East and North Africa region. For
every region the reported number is the aggregate value for all countries in that region. Import share of inputs
is total imports divided by total expenditure.


     An inspection of the import share of agricultural inputs in Table 1 reveals large varia-
tions across countries, and across input categories within a country. Most countries depend
on international trade to procure at least one of fertilizers, pesticides, and farm machinery,
which reflects the high geographic concentration in the production of agricultural inputs.
The production of fertilizers is concentrated in a few countries that have the required natu-
ral resources, and the production of pesticides and farm machinery requires chemical- and

Another important input category is seeds, but we do not have production data to include them in our empirical analysis.


                                                           7
machinery-related technologies that might be unavailable to low-income countries. For in-
stance, countries in the Middle East and North Africa (MENA) and in the East Europe have
large endowments of raw fertilizers, and, therefore, present a small import share of fertil-
izers, but imports in these countries account for a large share of their expenditure on farm
machinery and pesticides. Import shares of all the input categories are typically the largest
among Sub-Saharan African countries and the lowest in North America and East Asia &
Pacific. For most European and Latin American countries imports account for about a half
of their expenditure on agricultural inputs. In summary, these figures suggest that interna-
tional trade plays a crucial role in the use of agricultural inputs.


2.1.2    Field-level data

The field-level data is given at the level of agro-ecological zones (AEZs). An AEZ is a 5
minute by 5 minute latitude/longitude grid, which encompasses an area of approximately
10 km by 10 km. We integrate two field-level datasets, one on potential yield of crops that
represent the agricultural suitability of crops by technology type, the other on actual yields
based on national censuses for a subset of countries.
     The field-level data on potential yields of crops is taken from Global Agro-Ecological
Zones (GAEZ) project, organized by the Food and Agriculture Organization (FAO) and
the International Institute for Applied Systems Analysis. The "potential yield" of a crop
in a field is defined as the maximum attainable yield of that crop (measured in tons per
hectare) if the entire field were allocated to that crop. Potential yields are estimated based
on agronomic models that use information on local conditions of land such as soil types,
elevation, and land gradient and of climate such as rainfall, humidity, and temperature.
These measures capture local agro-ecological characteristics of a field, but not local market
conditions related to crop and input prices. We use data on potential yields for low and
high input technologies. The low-input technology corresponds to a traditional farming ac-
tivity where production is labor intensive and there is minimum to no use of agricultural
inputs. The high-input technology corresponds to a modern system where production is
input-intensive. Hereafter, we thus call low and high input technologies, respectively, "tra-
ditional" and "modern".7 In addition, we define "modern potential yield premium" as the
    7 According to the definition from FAO-GAEZ, the low-input technology represents a production regime with "no
application of nutrients, no use of chemicals for pest and disease control" and the high-input technology a production that
is "fully mechanized with low labor intensity and uses optimum applications of nutrients and chemical pest, disease and
weed control."



                                                            8
ratio of potential yield of modern to that of traditional technology. Our data on potential
yields contain nonzero records of traditional and modern potential yields of at least one crop
for 1,300,427 fields. To illustrate the data, Figure 1 plots potential yields of soybean based on
traditional (low-input) and modern (high-input) technologies across the world geography.
      We also collect field-level data from EarthStat.8 These data contain field-level informa-
tion on actual yields of crops circa year 2000 and are constructed based on national, state,
and county level census statistics. A key limitation here is that the data does not always
capture the field-level heterogeneity that is required for our analysis. In regions where data
from agricultural censuses are not available at fine levels of disaggregation, aggregate data
from national level are downscaled to the AEZ level. In contrast, for countries where de-
tailed census information are available, the mapping is between disaggregated units, such
as counties in the USA. For these reasons, we take the EarthStat field-level data only for the
United States, which is constructed based on disaggregated information at the county level
with a sufficiently large coverage of crops.9

    Figure 1: Potential Yield of Soybean: Traditional (low-input) vs Modern (high-input)

                      a. Traditional                                                   b. Modern




Notes: FAO-GAEZ potential yields are the maximum attainable yields of soybean in every field if the entire
area of the field is allocated to soybean, using traditional (low-input) technology, and modern (high-input)
technology.

    8 EarthStat is a collaboration between the Global Landscape Initiative at The University of Minnesota's Institute on the
Environment and the Land Use and Global Environment lab at the University of British Columbia to construct field-level
dataset on agriculture at the global level.
     9 There is a growing body of research in agriculture and climate sciences using EarthStat data at a global scale. For
examples, see Deryng, Conway, Ramankutty, Price, and Warren (2014), Niedertscheider, Kastner, Fetzel, Haberl, Kroisleit-
ner, Plutzar, and Erb (2016), Foley, Ramankutty, Brauman, Cassidy, Gerber, Johnston, Mueller, OConnell, Ray, West, et al.
(2011) and Mueller, Gerber, Johnston, Ray, Ramankutty, and Foley (2012). For a detailed description of the construction of
the dataset, see Monfreda, Ramankutty, and Foley (2008).




                                                             9
2.2     Empirical Patterns

We present three empirical patterns that motivate the particular structure that we impose in
our model. The first two empirical patterns highlight the importance of agricultural input
use and their imports over time and across countries. The last empirical pattern presents
variations in the field level data which we incorporate into our model.

Empirical Pattern 1. At the global level, agricultural value added per worker and the share of imports
in agricultural input use have increased substantially between 1980 and 2015.

Agricultural value added per worker has approximately tripled at the global level by be-
tween 1980 and 2015 (Figure 2). This substantial growth in agricultural productivity was
accompanied by a striking growth of the share of imports in agricultural input use. Figure
2 panel (b) illustrates the evolution of import share in the use of agricultural inputs at the
global scale. This share grew from 20% in 1980 to 40% in 2015. Moreover, the extent to
which imports account for agricultural input use varies largely across countries and across
the three categories of inputs. We illustrate these cross-country and cross-input variations in
the appendix. This heterogeneity illustrates that many countries largely depend on imports
to procure all or at least one of the agricultural input categories.

Figure 2: Value Added per Worker & Share of Imports in Agricultural Input Use at the
Global Level (1980-2015).

      a. Value added per worker in agriculture          b. Share of imports in agricultural input use




Notes: Panel (a) presents global value added per worker in agriculture using value added data at constant
prices. Panel (b) shows global imports of agricultural inputs across countries in value divided by total
expenditure on agricultural inputs.


                                                   10
Empirical Pattern 2. Across countries, measures of agricultural input intensity are strongly corre-
lated with GDP per capita.

In the previous empirical pattern, we highlighted the increasing role of trade in the use
of agricultural inputs. We now show that agricultural input intensity across countries is
strongly associated with the level of development.
     Figure 3-a shows a strong correlation between the cost share of inputs in agriculture
against GDP per capita across countries. Figure 3-b shows that agriculture input use per
worker is also strongly correlated with GDP per capita. The cross-country variations in
measures of development and input intensity in agriculture are enormous. For example,
GDP per capita in the United States is 35 times larger than that in Ghana, with the cost share
of inputs being around 46% and 4% in the respective countries.
     The combination of Empirical Patterns 1 and 2 suggests that the increasing access to
foreign agricultural inputs is an important channel through which globalization affects agri-
cultural productivity. With this takeaway in mind, we turn to an analysis of our field-level
data.
                     Figure 3: Agricultural Input Intensity versus GDP per capita.

               a. Cost share of inputs                             b. Input expenditure per worker




Notes: This figure plots for countries in year 2015 their agricultural cost share of inputs (panel a) and agricul-
tural input expenditure per worker (panel b) against GDP per capita.



Empirical Pattern 3. The potential yield of the high-input (modern) technology over the low-input

                                                       11
                                       Figure 4: Potential yield premium

               a. Average across crops                            b. Distribution across fields for soybean




Notes: Panel (a) shows the average premium of the modern technology across fields in the world. Panel (b)
shows the distribution of the premium in the case of soybeans. Adjusted for country mean is computed as the
premium at the field level plus the global average premium minus the the country-level average premium.


(traditional) technology is typically large and varies substantially across fields and crops.

Using field-level data on potential yields, we document that substantial productivity gains
can be made by shifting the production towards input-intensive technologies. Figure 4 panel
(a) shows the average yield premium of modern (high-input) technology over traditional
(low-input) technology across fields in the world. Modern potential yield premia are, on
average, in the range of four to seven across crops. For example, an average field around
the world would yield 4.6 times more wheat using modern than traditional technology if
the entire field was allocated to wheat. This average global premium is at minimum 4 in the
case of potato, and at maximum 6.7 for soybean.
     Focusing on the case of soybeans, Figure 4 panel (b) shows that modern potential yield
premia vary substantially across the world geography. The global average premium for soy-
bean hides the vast heterogeneity across fields and the relatively fat right tail of the distribu-
tion. Specifically, the 5th, 50th, and 95th percentile are 1.9, 5.5, and 14.9. Figure 4 panel (b)
also shows that, even if we adjust the premium by the average in every country to control for
between-country variations,10 remarkable heterogeneity remains in the premia across fields.


  10 Our adjustment is given by: (field-level - country-level mean) + global mean.




                                                          12
From the empirical patterns to the theory

Our empirical patterns show that the global growth in agricultural productivity in the past
few decades has coincided with a remarkable globalization in agricultural inputs, and that
there are potentially large yield premia for the use of high-input agricultural technologies
across fields. These observations motivate the formulation of a model in which adoption of
input-intensive technologies can increase agricultural productivities and access to interna-
tionally supplied inputs encourage the adoption of these input-intensive technologies. In
addition to the facts presented here, our modeling choices are motivated by two additional
empirical patterns that are well-documented in the literature: the non-homotheticty in food
consumption and the importance of land heterogeneity to study crop specialization.11



3     Model

3.1    Environment

The global economy consists of multiple countries, indexed by i or n  N . Each country
n is endowed by a given supply of labor Nn , land Ln , and raw fertilizer Vn . Consumption
combines sector-level bundles of nonagriculture and agriculture. The nonagriculture bun-
dle consists of an outside good defined by a singleton O  {0}. The agriculture bundle
comprises multiple crops, indexed by k  K. Every crop can be produced using a technique
characterized by input and factor intensities. Specifically, technique is either traditional that
uses only land and labor, or modern that uses labor, land, and multiple agricultural inputs
indexed by j  J . We denote by G the set of all goods in the economy consisting of nona-
griculture good, agricultural inputs, and crops,

                G  OJ K =                        0        ,       1, ..., J         , J + 1, ..., J + K
                                            nonagriculture agricultural inputs jJ        crops k K


                                                      f
      A set Fn of fields f , each with area Ln , characterizes the total land in country n, where
          f
 f Fn Ln = Ln . Our setup allows for differences in agroclimatic conditions at the level of
fields, meaning that yields associated with producing a crop-technique pair (k,  ) are het-
erogeneous across fields f  Fn . Labor is homogeneous and freely mobile across productive
   11 See Comin, Lashkari, and Mestieri (2015) for an analysis of non-homothetic demands and Sotelo (2020) for evidence
on the relationship between agricultural suitability and yields.


                                                          13
activities within countries. Endowments of fertilizers are used as an input in the production
of processed fertilizers. All goods g  G are tradeable, and markets are perfectly competi-
tive.


3.2     Consumption and Trade

Every good g  G is differentiated by the origin of production. We denote by Cni,g the
consumption of good g in country n originated from country i, and by Cn,g the aggregate
consumption of good g as a CES combination of varieties across origin countries,

                                                                               g /(g -1)
                                                                  (g -1)/g
                          Cn,g =       (bni,g )   1/g
                                                          Cni,g                                                   (1)
                                     i N


Here, bni,g is a demand shifter, and g > 0 is the elasticity of substitution of good g across
                                                                                s , with
countries (e.g. US corn vs Mexican corn). Sector-level bundles of consumption, Cn
s = 0 for nonagriculture and s = 1 for agriculture, are
                             
                             Cn,0                                                   if s = 0
                             
                       s
                      Cn =                                              / ( -1)                                   (2)
                              kK (bn,k )1/ (Cn,k )( -1)/
                                                                                    if s = 1

Here, Cn,0 and Cn,k are given by equation (1), bn,k is a demand shifter, and  > 0 is the
elasticity of substitution across crops (e.g. corn vs wheat). The representative consumer
in country n receives utility from the aggregate consumption, Cn , defined implicitly by the
following non-homothetic CES representation,12

                                                 1         s -          -1

                                             s                     s
                                                                        
                                            bn       Cn           Cn         = 1,                                 (3)
                                  s{0,1}

       s is a demand shifter for sector s  {0, 1};  > 0 is the elasticity of substitution across
where bn
                                   0 and agriculture C1 given by equation (2). s > 0 is
the consumption of nonagriculture Cn                  n
the elasticity of income with respect to sector s. If  < 1, agriculture and nonagriculture are
complements; otherwise, they are substitutes. Sector s is a luxury if s > 1, and a necessity
if s < 1. When s = 1 for all s, the system collapses to CES preferences.
   12 This system of preferences has several appealing features, discussed in details in Comin, Lashkari, and Mestieri
(2015).




                                                           14
      International trade in every good g  G is subject to iceberg trade costs. To deliver
one unit of g from origin i to destination n, dni,g  1 units must be shipped under triangle
inequality. Price of g originated from i and destined at n is pni,g = pi,g dni,g , where pi,g denotes
the producer price.


3.3    Production

Every field f  Fi consists of a continuum of plots   f . The agriculture production in field
f involves allocating crops k  K, using techniques   T , to plots   f . The production
technology is given to a representative agricultural producer by

                                                                      L
                                                                      k                   N
                                                                                          k                 M
                                                                                                            k
                       f                      f            f                       f             f            
                     Q i ,k  (  )   =   ¯k  z i ,k  (  ) L i ,k  (  )
                                        q                                        Ni,k ( )      Mi , k  (  )              (4)

                                                        f
      ¯k is a constant scalar,13 zi,k ( ) is the land productivity of plot  for producing
Here, q
                                                    f                   f                 f
crop k using technique  , and Li,k ( ), Ni,k ( ), and Mi,k ( ) are respectively the use of
land, labor, and material inputs. In addition, setting up every plot  for agricultural use
                                    f                                N  [0, 1],  M  [0, 1],
requires a fixed cost zi,0 ( ) paid in units of nonagriculture good. k          k
    L = 1 -  N -  M  [0, 1] are, respectively, intensity parameters of labor, inputs, and
and k       k    k
land in production of crop k using technique  . These intensity parameters characterize
techniques which are either traditional  = 0 or modern  = 1.14 The traditional technique,
                 M = 0, is intensive in the use of labor and does not employ material inputs
characterized by k 0
          f                                                   M > 0, employs material
(i.e., Mi,k0 ( ) = 0). The modern technique, characterized by k 1
                                                            f
inputs. The aggregate input use Mi,k ( ) is a Cobb-Douglas combination of agricultural
inputs,

                                                                                          j
                                                                                          k
                                                                    
                                                 f                            j, f
                                               Mi , k  (  )     =            Mi , k  (  )                                (5)
                                                                    jJ


              j, f                                                  j                                                j
where Mi,k ( ) is the use of input j with k  [0, 1] as the share parameter, and  jJ k = 1.
                                                                                                                 f
      We now derive the rental price of every plot of land  , which we denote by ri,k ( ). Let
the producer price of good g in origin i be pi,g , the consumer price index of g in destination
i be Pi,g , and wage in country i be wi . The price index of the bundle of agricultural inputs
  13 q              L           N           M
              L ) - k
      ¯ k   ( k        (  N ) - k  (  M ) - k 
                         k           k
  14 Our modeling allows for any arbitrary number of techniques. The choice of two is made only due to data availability.




                                                                            15
                                                                  j
in destination i is given by mi,k =  jJ ( Pi, j )k . By cost minimization, the unit cost of crop k
                      f
using technique  , ci,k ( ), equals

                                                    f                 L             N                  M
                              f                    r i ,k  (  )       k             k                  k 
                            c i ,k  (  )   =         f
                                                                           wi                 m i ,k
                                                   z i ,k  (  )

Since markets are perfectly competitive, net profits in every plot are pushed down to zero.
                                                                                                               f
Combining profit maximization and zero profit condition requires ci,k ( ) = pi,k . This de-
                                                                      f
livers the gross rental price of land in plot  , ri,k ( ), if assigned to crop-technique (k,  ),

                            f                  f
                          r i ,k  (  ) = z i ,k  (  ) h i ,k                                                           (6)
                                                                            N / L
                                                                          - k                            M / L
                                                                                                       - k
                                                             wi                k              m i ,k        k
                          where hi,k = pi,k                                                                            (7)
                                                             p i ,k                           p i ,k
                                                                                    h i ,k 


                                                                                                           f
Returns to crop-technique (k,  ) depends on land productivity zi,k ( ), and a component
which we call hi,k that summarizes the effect from market prices. The price-inclusive com-
ponent, hi,k , rises in the output price pi,k , and falls in the effective relative input price hi,k .
The latter term depends on wages and prices of material inputs relative to price of output,
wi / pi,k and mi,k / pi,k , with the extent of the relationship governed by intensities of labor and
input use relative to land.
    Fixed costs are investments in units of nonagriculture bundle, with price index Pi0 . We
                                                             f
denote the net rental price of land in  by ni,k ( )

                                 f                   f                          f
                                ni,k ( ) = zi,k ( )hi,k - zi,0 ( ) Pi0                                                 (8)

The optimal allocation in every plot   f maximizes returns to plot  by selecting among
crop-technique pairs (k,  ), that is the one with the highest rents or by leaving the plot idle
if no crop-technique pair delivers positive net rents,

                                      f                                                  f
                           max zi,k ( )hi,k for all (k,  ), zi,0 ( ) Pi0

                                                                                                       f           f
The vector of investment requirement and land productivities, zi ( )  [zi,k ( ) for all (k,  ) 




                                                                 16
            f
K × T , zi,0 ( )] is randomly drawn across plots   f from a nested Fréchet distribution,

                                                                           - 1                              - 1
                                                                                     
                      f            f                                   f                           f
                Pr(zi ( )  zi ) = exp                 -¯       0 (zi,0 )         +          k ( z i ,k )
                                                                                     kK
                                             f                                       f           - 1
                                           zi,0                                  z i ,k    - 2         2

                                                                           
                               f                              f
                where      0 (zi,0 )   =     f
                                                  ,     k ( z i ,k )   =             f
                                                                                                           for all k  K
                                           ai,0                             T    a i ,k 

                                - 1                                                         f                 f           f
Here, ¯  (1 - 1/1 )                    is a normalization to ensure that E[zi,0 ( )] = ai,0 , and E[zi,k ( )] =
ai,k . Our formulation generalizes a standard Fréchet distribution as the one in Eaton and
Kortum (2002) by relaxing the assumption that productivity draws across alternatives are
independent. We achieve this extension by building on tools from the literature on discrete
choice based on generalized extreme value distributions, as studied in detail in McFadden
(1981). We present a detailed derivation in the appendix, and explain the intuition below.
       This generalized Fréchet distribution allows productivity draws to be correlated in a
structured way. In the upper nest, 1 controls the dispersion of land productivity draws
across crops. The higher 1 , the less heterogeneous the land productivity draws across crops
within a field. Consequently, producers will be more responsive in substituting across crops
when relative returns to crops change. In the lower nest, 2 controls the dispersion of pro-
ductivity draws across techniques within every crop. The larger 2 relative to 1 is, the larger
the correlation between draws are across techniques within a crop. Given a choice of crop,
at a higher 2 producers are more responsive in adopting a technology when returns to that
technology rise. All together, 1 and 2 govern the pattern of specialization respectively
regarding which crop to grow and with which technique to grow it.
       When 2 > 1  1, then productivity draws between corn-traditional and corn-modern
are more similar compared to draws between corn and wheat. Setting 1 = 2 brings the
model back to a one-nest Fréchet distribution where the correlation between draws across
techniques within a crop is zero. Then, for example, draws between corn-modern and corn-
traditional are equally dissimilar to draws between corn-modern and wheat-traditional. In
the other special case, where 2  , there will be perfect correlation between draws across
technologies within a crop. As a result, every crop will be produced using only one technol-
ogy.   15

   15 In agriculture-related studies, this one-nest version has been used for Roy-type models in labor markets (Lagakos and
Waugh, 2013), and in land allocation problems (Costinot, Donaldson, and Smith, 2016; Sotelo, 2020). In the trade literature,
recent applications that allow for correlations include Lashkaripour and Lugovskyy (2018) and Lind and Ramondo (2018).


                                                                17
       Lastly, we specify the production technology of non-crop goods consisting of nonagri-
culture and agricultural inputs. Among agricultural inputs, production of processed fertil-
izer, denoted by v  J , uses the domestic endowments of raw fertilizers, Vi . The production
of other non-crop goods (nonagriculture and non-fertilizer inputs) uses labor. Specifically,
                
                A V ,
                  i ,v i    fertilizer, g = v
      Qi, g   =                                                                                                    (9)
                 A N , nonagriculture & other agricultural inputs, g  O  J , g = v
                  i, g i, g


where production features constant returns to scale, and Ai,g is a vector of productivity
shifters.


3.4      Equilibrium

3.4.1     Prices and Expenditures

                                                                                          s,
Let En be total expenditure in country n. Price indexes of consumption aggregates Cn,g , Cn
and Cn for all g  G  O  J  K, s = {0, 1}, n  N are given by

                                                                             1

                                             bni,g ( pi,g dni,g )   1-g    1-g
                             Pn,g =                                                                               (10)
                                            i N
                                          
                                           Pn,0 ,
                                                                                   if s = 0
                                s
                               Pn =                                        1                                      (11)
                                                                          1-
                                           kK bn,k ( Pn,k )1-
                                          
                                                                               ,   if s = 1
                                                                                      1

                                              
                                                                   s                 1- 
                               Pn =                   s
                                                     bn ( En / Pn ) -1 ( Pn
                                                                          s 1- 
                                                                            )                                     (12)
                                            s{0,1}


We denote by  ni,g the share of expenditure by country n on good g  G originated from i,
by  n,k the share of expenditure by country n on crop k  K relative to aggregate agriculture
expenditure there, and by s
                          n the share of expenditure by country n on sector-level bundles

We complement these studies by illustrating how to apply the tools to Roy-type or land-use problems, and in addition we
derive several new expressions related to productivity distributions conditional on selection.




                                                          18
of nonagriculture and agriculture,

                                              bni,g ( pi,g dni,g )1-g
                                  ni,g =                                                              (13)
                                                   ( Pn,g )1-g
                                              bn,k ( Pn,k )1-
                                   n,k =             1 )1-
                                                                                                      (14)
                                                 ( Pn
                                                               s
                                          bs ( En / Pn ) -1 ( Pn
                                                               s )1- 
                                   s
                                   n    = n                                                           (15)
                                                   ( Pn )1-

     The price effects operate through substitutions in the upper tier between nonagriculture
                           s / P )1- , in the middle tier between crops within agriculture
and agriculture through ( Pn    n
                  1 )1- , and in the lower tier between varieties of different origin countries
through ( Pn,k / Pn
within a crop through ( pni,k / Pn,k )1-k .
                                                          s -1
     The income effect operates through ( En / Pn )                in the upper tier with respect to nona-
griculture (s = 0) and agriculture (s = 1) bundles of consumption. Equation (15) shows
that expenditure shares 0     1
                        n and  n depend on real total expenditure, En / Pn . In the empir-
ically relevant case, where 0 > 1 , a rise in En / Pn increases the share of expenditures on
nonagriculture.
     Our measure of welfare is utility Cn received by total consumption as implicitly defined
by equation (3). Our derivation ensures that welfare is given by Cn = En / Pn . The overall
price index, Pn , is itself a function En / Pn . Therefore, equation (12) implicitly defines the price
index, Pn , to be solved at any level of income and sector-level prices. The pair of equations
(12) and (15) characterize the non-homotheticity in demand, i.e. how the price index and
expenditure shares change by income.


3.4.2   Agricultural Output and Land Allocation at the Field Level

                                                                                                      f
For every field f , we denote the fraction of land allocated to crop-technique (k,  ) by ni,k .
               f                                                               f
Further, let i,k be the fraction of land allocated to crop k, and i,k be the fraction of land
within crop k allocated to technique  . The land shares are given by

                                         f         f       f
                                        i ,k  =  i ,k ×  i ,k                                         (16)




                                                    19
where

                                                           f                   2
                                                      a i ,k  h i ,k 
                                   f
                                  i ,k  =                      f
                                                                                                                        (17)
                                                           ( Hi,k )2
                                                                               f
                                   f                                   ( Hi,k )1
                                   i ,k       =        f                                      f
                                                                                                                        (18)
                                                  ( ai,0 Pi0 )1 + kK ( Hi,k )1

Here, hi,k is the price-inclusive component of returns to crop-technique pair (k,  ), given by
                                                                           f
equation (7), and aggregate returns to crop k, Hi,k , equals

                                                                                                  1
                                                                                        2         2

                                                               
                                          f                                f
                                       Hi,k =                      a i ,k  h i ,k                                       (19)
                                                            T


Equations (16)­(19) connect the dispersion parameters of the Fréchet distribution to elastic-
ities of land use. Specifically, 2 appears as the elasticity of substitution across techniques
within a crop choice, and 1 as the elasticity of substitution in land use across crops (and no
                                                                                                          f
agriculture). The opportunity cost of agriculture production, ai,0 Pi0 , pins down the share of
                                                                                                                    f
cropland. Within the cropland, land share of crop k increases in its average returns Hi,k , with
the extent of the relationship governed by 1 . Within the land allocated to crop k, the land
                                                                                                      f
share of technique  rises in average returns to technique  , ai,k hi,k , with the extent of the
relationship disciplined by 2 .
           f
    Let i,k be the set of plots  in field f to which crop-technique (k,  ) is optimally
allocated. Conditional on optimal selections, the average productivity of crop-technique
(k,  ) in field f equals

                           f                      f                    f           f   - 1        f           - 1
                      E [ z i ,k  (  ) |    i ,k  ] = a i ,k  (  i ,k )                  1   (  i ,k  )         2       (20)

The conditional mean productivity of crop-technique (k,  ), given by equation (20), is greater
                                                                   f                         f
than the unconditional mean productivity, E[zi,k ( )] = ai,k , due to the selection of a crop-
technique pair (k,  ) if its productivity draw is sufficiently large. A higher share of land is
                                                       f
allocated to crop k if returns to crop k, Hi,k , rise relative to those of other crops and opportu-
nity cost of agriculture. This margin of adjustment, governed by 1 , determines the pattern
of specialization across crops.
                                                                                                                    f
    In addition, conditional on selecting crop k, higher returns to technique  , ai,k hi,k ,


                                                                  20
increase the share of land for which technique  is adopted among the competing techniques
to produce crop k. Using equation (7) and equation 17, the relative share of modern to
traditional technique, conditional on producing crop k, satisfies

                 f                          f                                                 N     L                        M   L   2
                i ,k 1                    a i ,k 1                 ( w i / p i , k ) - k 1 / k 1 ( m i , k / p i , k ) - k 1 / k 1
                 f
                         =                  f                                                 N     L                        M   L
                                                                                                                                         .
                i ,k 0                    a i ,k 0                 ( w i / p i , k ) - k 0 / k 0 ( m i , k / p i , k ) - k 0 / k 0
                              relative avg productivity                                  relative input price


The term in the brackets equals the unconditional expected return of modern technique
relative to traditional, which rises when productivity of modern technique rises on average
relative to traditional, and when relative prices of inputs fall. The extent to which these
changes imply a change in relative land share of modern technique is governed by 2 . The
larger 2 is, the greater the extent of adopting modern technique in response to changes in
relative productivities and input prices.
     Discrete choices of crop-technique pairs for every plot  implies that
                                            
                                             (  L ) -1 h z f (  ),                                    i ,k 
                                                                                                                 f
                               f               k        i ,k  i ,k 
                             Q i ,k  (  ) =                                                                                                      (21)
                                            0,                                                     /  i ,k 
                                                                                                   

The optimal allocation requires each plot   f either not to be used for agriculture or fully
used for the production of one crop using one technique.16 At the field level, aggregate
                                                                                                                 f                           f     f
output of crop k using technique  in field f within country i, Qi,k , equals land use, i,k Li ,
                                                             f                                f
times average production per plot, E[ Qi,k ( ) |   i,k ]. Using equations (16), (20), (21),

                                 f                   f   f                f                                  f
                               Q i ,k  =  i ,k  L i × E Q i ,k  (  ) |    i ,k 
                                                                                                  1 -1                2 -1
                                                L -1 f                        f          f                   f
                                        = L i ( k  ) h i ,k  a i ,k  (  i ,k )
                                                                                                  1
                                                                                                         (  i ,k  )   2
                                                                                                                                                 (22)


3.4.3    Agricultural Output at the Country Level

Aggregate output of crop k in country i is then the sum across techniques and fields there,


                                                                  
                                                                                     f
                                                Q i ,k =                          Q i ,k  .                                                      (23)
                                                                 f Fi  T

   16 In addition, returns to land in plot  , h       f                             L
                                                i,k  zi,k (  ), are only a fraction k of output, with the other fraction paid to
labor and material inputs.



                                                                     21
Aggregate quantity of nonagriculture good required for fixed costs of setting up plots is
denoted by Si and equals

                                                                                 ( 1 -1) / 1
                                                                
                                         f f                           f
                          Si =          Li ai,0 1 - 1 -               i ,k                      .                     (24)
                                 f Fi                           kK


3.4.4   Market Clearing and General Equilibrium

Labor market clearing in every country i  N requires labor supply Ni to equal labor de-
mand from production of nonagriculture, non-fertilizer agricultural inputs, and crops,


                                                                                    N               f
                      wi Ni =                  pi, g Qi, g +                        k  p i ,k Q i ,k                  (25)
                                gOJ , g =v                     kK f Fi  T


Goods market clearing for nonagriculture, agricultural inputs j  J (including fertilizers),
and crops k  K require supply at the origin country to equal world demand,

                           pi,0 Qi,0 =                ni,0 0       0
                                                           n En + Pi Si                                               (26)
                                               nN

                                                                          M  j                 f
                            pi, j Qi, j =                         ni, j k k 1 p n,k Q n,k 1                           (27)
                                               f Fi nN kK

                            p i ,k Q i ,k =           ni,k  n,k 1
                                                                n En                                                  (28)
                                               nN


Finally, by national accounting of flows total expenditure in country i, Ei , equals the sum of
factor rewards and trade deficits,


                        ( k  + k ) pi,k Qi,k - Pi Si + 
                          N    L                0         f
              Ei =                                                                             p i , g Q i , g + Di   (29)
                     kK f Fi  T                                                    gOJ


The first term net of the second term in the RHS equals payments to labor and land in agri-
culture. The third term is payments to labor in nonagriculture and agricultural inputs as
well as revenues from fertilizer sales, and the fourth term is trade deficits. Equations 25-29
guarantee that trade deficits sum up to zero, iN Di = 0, and land market clearing condi-
tion holds.
    We close the layout of our model by defining the global economy and general equilib-
rium.

Definition. For all countries n, i  N , fields f  Fn , goods g  G consisting of nonagriculture,

                                                          22
agricultural inputs j  J , and crops k  K, sectors s  {0, 1}, and techniques   T , a
global economy is characterized by

                                 f
· Endowments E  { Ln , Nn , Vn , Dn };

· Production elasticity parameters A  {1 , 2 };

· Consumption elasticity parameters B  {0 , 1 ,  ,  , g };

                           L , M, N ,  , a , a                          j    f        f
· Production shifters A = {k  k k     k n,0 n,k , An, g };

                             s,b ,b
· Consumption shifters B = {bn  n,k ni, g , dni, g }



Definition. Given a global economy characterized by {E , A, B , A , B }, a general equilib-
rium consists of prices { pn,g } for all n  N , g  G such that equations 7­29 hold.


3.5     The Production Possibility Frontier in each Field

In this section, we show that the allocation of land at the field level predicted by our model
is equivalent to an alternative problem in which landowners in each field produce efficiency
units of land subject to a production possibility frontier. For a given field f in country i, the
aggregate problem of a landowner is given by:


                                                                       h i ,k  L i ,k 
                                                                                          f
                                          max
                                    f                     f
                                { L i ,k  } k ,   ,   { L i ,k } k    T kK
                                                                                                      2 -1
                                                                                               2      2

                                                                       ( L i ,k  / a i ,k  )
                                                                                 f        f                       f
                                     subject to                                                2 -1
                                                                                                              L i ,k         (30)
                                                                       T
                                                                                              1 -1
                                                                                     1        1

                                                                       ( L i ,k )
                                                                                 f                      f
                                                                                     1 -1
                                                                                                      Li                     (31)
                                                                      kK

          f             f
Here, Li,k and Li,k are efficiency units of land at the level of crop-technique k  and crop k.17
The landowner maximizes the sum of returns across uses of land given price-inclusive term
                                                                                                f                      f
hi,k described by equation (7), technology coefficients ai,k , and endowment Li .18

   17 Efficiency units L f immediately deliver production quantities Q f according to: Q f                   L         f
                         i ,k                                               i ,k                 i,k = (1/ k  ) hi,k  Li,k  , where
                                                N  L                M  L
as defined by equation (7), hi,k = (wi / pi,k )-k /k (mi,k / pi,k )-k /k is the effective relative input price.
   18 For the sake of exposition, here we have set the value of the outside option at zero.




                                                                            23
      We illustrate this problem with diagrams for two crops, which we call rice and wheat. To
save on notation, we drop country and field indicators. The production possibility frontiers
are represented in two tiers. The lower tier reflects substitution possibilities across tech-
niques within a crop, and the upper tier disciplines substitution possibilities between crops.
Figure 5 illustrates the frontier along the dimension of technology within a crop (Panel a),
and between crops (Panel b).
      In Panel (a), we show for every crop k the optimal choices of output in units of land
efficiency that are produced using traditional ( = 0) and modern ( = 1) techniques. The
maximum that could be achieved if all resources for the production of crop k was allocated to
technology  is given by ak Lk . This maximum value depends on technology coefficients ak
as well as aggregate efficiency units allocated to crop k, Lk , that is a choice variable in the up-
per tier. The slope of the frontier curve at point ( Lk0 , Lk1 ) is proportional to ( Lk0 / Lk1 )1/(2 -1) ,
governed by 2  (1, ). The smaller 2 , the greater the curvature, the less elastic choices of
technology for a given change in market conditions.19 The slope of the iso-value line in turn
equals hk0 / hk1 , which incorporates the effects from relative wages and input prices adjusted
by relative labor and input intensities.
      In Panel (b), we show the upper tier of production choices that represents the substi-
tution possibilities between rice and wheat. The slope of the frontier at point ( Lrice , Lwheat )
equals ( Lrice / Lwheat )1/(1 -1) , that is governed by 1  (1, ). A smaller 1 means a greater
curvature, hence a lower sensitivity in substitution across crops if relative prices change.20
In addition, the slope of the iso-value line is given by (- Hrice / Hwheat ). Reproducing Hk
from equation (19), it is a generalized mean of ak hk across technologies within every crop,
                           1
Hk =  ( ak hk )2           2
                               . Therefore, crop-level returns that are taken into account in the upper
tier depend on optimal decisions made in the lower tier. Moreover, the maximum efficiency
units of land that can be allocated to crop k equals total area of land. This maximum value is
not greater than total land area because the selection margin raises average land productivity
only if a fraction of land, not the entire area of it, is allocated to a crop.
      Lastly, it is remarkable that shadow prices of this aggregate problem replicate land rents
predicted by our micro-founded model. Specifically, we derive in the appendix that the
Lagrange multiplier associated with the slack constraints (30) and (31) are respectively given
    19 In one extreme where   , the frontier is a straight line, and the problem has a corner solution reflecting that
                               2
choices of technology are extremely sensitive to relative prices. In the other extreme where 2  1, the frontier collapses to
a right angle, and the optimal choice becomes insensitive to prices.
   20 Similarly, if   , the producer problem has a corner solution, and if   1, the optimal choice of ( L
                    1                                                      1                              rice , Lwheat )
becomes insensitive to price changes.


                                                            24
              1 1/1
by Hk and [k Hk ]   . That is, the shadow price of the land allocated to crop k is Hk , which
is the average returns to land used for production of crop k, and the shadow price of the
                                1 1/1
entire cropland is given by [k Hk ]   , which is precisely the average rents of cropland.21

                                    Figure 5: Production Possibility Frontier

           a. Between techniques within crop k                                    b. Between crops

       L k1                                                        Lwheat

L k a k1                     slope = -hk0 /hk1                                    slope = - Hrice / Hwheat
                                                                   L



                                                                       curvature governed by 1
            curvature governed by 2




                                             L k a k0       L k0                                             L           Lrice

Notes: Panel (a) shows the lower-tier production possibility frontier within crop k between two technologies,
1 as modern and 0 as traditional. Panel (b) shows the upper-tier production possibility frontier between
             ~ k , L
two crops. { L     ~ k } are in units of land efficiency. In Panel (a) the slope of the curve is proportional to
-( Lk0 / Lk1 )1/(2 -1) , and the maximum quantity of Lk is ak Lk where Lk is the choice variable in the upper
                                                                                                                         1
tier. In Panel (b), the slope of of the curve equals -( Lrice / Lwheat )1/(1 -1) , and Hk =            ( a k  h k  ) 2   2
                                                                                                                             for
k  {rice, wheat}. The maximum quantity of Lk is L.




4          Taking the Model to Data

In this section, we take our model to data. We first quantify country-level parameters follow-
ing standard practices in the literature. We then estimate parameters that control the shape
of field-level production possibility frontiers using FAO-GAEZ data on potential yields of
crop-technique pairs for more than 1.3 million fields across countries.
    21 For more details and full derivations for this aggregate problem, see Appendix (C.5).




                                                            25
4.1    Country-level Production and Trade Parameters

At the country-level, we calibrate demand elasticities ( , and g for g  G ), demand shifters
                                 1-g
(bn,k for k  K, and bni,g dni,g for g  G ), productivities in non-agricultural and agricultural
inputs ( Ai,g for g  {0, 1, ..., J }) and upper-tier demand elasticities and shifters ( , s , bn
                                                                                               s for

s = {0, 1}).

                                                                      1- 
Demand Elasticities and Shifters for Crops ( , k , bni,k dni,k k ). Following Costinot, Donaldson,
and Smith (2016), we estimate the elasticity of substitution between crops (k ) from the fol-
lowing gravity-type equation,

                                         Xni,k
                                log                = n,k + (1 - k ) log pi,k +          ni,k ,                       (32)
                                         Xn,k

                                                                                -k
where n,k  - log[i bni,k ( pi,k dni,k )1-k ],             ni,k   = log bni,k d1
                                                                              ni,k , Xni,k is the purchases of n
from country i of crop k, and Xn,k is total purchases of country n of crop k. Without loss of
                                                                -k
generality we set iN
                   =1           ni,k   = 0. We recover bni,k d1
                                                              ni,k from the residuals.
                                                                                       22 As in Costinot,

Donaldson, and Smith (2016), we impose the same elasticity of substitution between crops
(k = ). Due to potential correlations between demand shocks                               ni,k   and prices log pn,k , we
instrument log pi,k with the average agricultural suitability of the exporting country, using
FAO-GAEZ data. With our estimate of k , we recover demand shifters of crops from the
residuals of equation (32) and construct the country-level price index of every crop Pn,k .
With this price index in hand, we take logs of equation (14) and estimate the elasticity of
substitution between crops,  , based on

                                        Xn,k
                                log       1
                                                 = n + (1 -  ) log Pn,k +         n,k                                (33)
                                        Xn

where           = log bn,k , kK                         1 is aggregate purchases of all crops. To address
                                              = 0, and Xn
          n,k                           n,k
the endogeneity of log Pn,k , we instrument the price index using the average agricultural
suitability of each country.

                                                                                                               1-g
Demand Elasticities and Shifters for Non-agriculture and Agricultural Inputs (g , bni,g dni,g , g =
0, 1, ..., J). We set g = 4 for non-agriculture and the three categories of agricultural inputs
   22 We do not separately identify trade costs from preference shifters. All we require to compute our general equilibrium
is the combined bilateral frictions deterring trade between countries. However, for the purpose of our counterfactual
exercise in Section 5, we will also estimate trade costs.




                                                           26
based on the literature, and estimate

                                 Xni,g
                           log               - (1 - g ) log wi = n,g + i,g +     ni, g ,    (34)
                                 Xn, g

where i,g and n,g are origin and destination fixed effects, and demand shifters are given by
        1-g
bni,g dni,g = exp(   ni, g ).


Productivities in Non-agriculture and in Agricultural Inputs (Ai,g ). We recover productivity
parameters An,g from the origin fixed effect in equation (34).

Upper-tier Demand Parameters ( , 0 , 1 , bn
                                          0 , b1 ). We set income elasticities at 0 = 1.5 and
                                               n
1 = 0.5, and the substitution elasticity between agriculture and nonagriculture at  = 0.5
in line with estimates from Comin, Lashkari, and Mestieri (2015). These parameters imply
that agriculture is a necessity good whereas nonagriculture is a luxury, and that agriculture
and nonagriculture are complements in consumption. Within our estimation, as we explain
                                                  0 and b1 ) consistent with model-implied
below, we recover upper tier of demand shifters (bn      n
                                 0 and agriculture ( P1 ).
price indices of nonagriculture Pn                    n



4.2     Field-level Agriculture Production Technology

We now quantify parameters of agriculture production technology at the field level. We cali-
                                                               j
                               L ,  N ,  M and  ), then estimate the production elasticity of
brate factor and input shares (k  k k          k
substitution between crops (1 ) and between technologies within a crop (2 ). Within this es-
                                                                                           f
timation we calibrate field-level land productivity shifters for crop-technology pairs ( ai,k ),
                                         f
and the investment parameter ( an,0 ). We first explain our calibration, then our estimation.


4.2.1    Calibration

                                                    j
                         L ,  N ,  M and  ). We set the factor shares in the agricultural pro-
Factor and Input Shares (k  k k          k
duction function using a few data sources together with equations implied by our model.
                                                               M = 0. Due to data limita-
Since the traditional technique uses no material input, we set k 0
tions, we make the assumption that factor shares of land, labor, and material inputs for a
            L ,  N ,  M are common across crops. In addition, with an approximation, our
technology, k  k k
model implies that
                                                        (¯ jM  j ) - (¯ iM i )
                                      L  L
                                     (0 /1 )       =
                                                              ¯ jM - 
                                                                     ¯ iM

                                                         27
where i and j refer to any two countries, i = (1 - ¯ i,1 )/¯ i,1 is relative land share of tradi-
tional to modern technology at the aggregate in country i, and ¯ iM is the aggregate cost share
of agricultural inputs in country i. Using data for these aggregate variables for the United
States and Brazil, we calibrate the factor share of land in traditional relative to modern tech-
        L /  L . In addition to 
nology, 0                         M , we collect data from the USDA Commodity Costs and
                                ¯ USA
            1
Returns for aggregate cost shares of land   L
                                          ¯ USA and of labor   L
                                                             ¯ USA , which we use to recover
all factor and inputs shares. We also obtain the cost share of fertilizers, pesticides, and farm
machinery across crops from USDA Commodity Costs and Returns. Table (A.2) reports our
                                     L ,  N ,  M ) and the median of  across crops for the      j
calibrated factor and input shares, (                                k
three categories j of agricultural inputs.

                                                                  f         f
Productivity Parameters at the Field Level (i,k and ai,0 ). Given demand elasticities and shifters
                                                                      j
(B , B ), intensity parameters (k
                                L ,  M ,  N ,  ), and production elasticities (  ,  ), we cali-
                                   k k        k                                 1 2
           f           f
brate ( ai,k , ai,0 ) such that all equilibrium relationships hold, and the model exactly matches
calibration targets which we describe below. This calibration depends on the choice of
                                                            f     f
(1 , 2 ). As such, our calibration of ( ai,k , ai,0 ) will be nested within our estimation of (1 , 2 ).23
      We first explain how the field-level data on agricultural productivity maps into our
                               f , FAO                                                                                f , FAO
model. Define yi,k                       as the potential yield in FAO-GAEZ data. By construction, yi,k
is the yield of crop k using technique  if the land of the entire field f were allocated to
crop-technique (k,  ). According to our model, this is the quantity we would obtain by
               f           f                                                                           f
setting i,k = i,k = 1 in equation (22) divided by the entire field area Li , which equals
  L ) -1 h a           f
( k       ik i,k . Remember that here hik captures the role of input and output prices in
shaping land productivity, which in the FAO-GAEZ data are not meant to reflect country-
level market conditions. The FAO-GAEZ data can be interpreted in our model as the poten-
tial yield of a field if there were no geographic trade costs and therefore no spatial differ-
ences in output and input prices. Given these remarks, we assume the following structure
      f , FAO
for yi,k           :
                                                    f , FAO         L -1 FAO         f
                                                  y i ,k        = ( k  ) h k  a i ,k 

       FAO is consistent with some vector of global prices and a                         f
where hk                                                         i,k is the productivity shifter
                                                                                     f
that we seek to recover to construct our PPFs. Isolating ai,k in the equation above, we write:

                                                       f                   f , FAO
                                                    ai,k = k × yi,k

    23 This procedure is computationally intensive, and results in this section are currently based on five percent sample of
fields randomly drawn for each country. We will update our results for the full sample in the next version of our paper.


                                                                      28
         L / h FAO is an unobserved scale parameter. We calibrate 
where k  k     k                                                  k according to
                                                                                    f
aggregate data on agricultural production to recover ai,k . Noticed that, by doing so, the
ratio of productivity shifters in our model will reflect directly the ratios of productivities
                                       f   f         f , FAO       f , FAO
in the FAO-GAEZ data, as ai,k / ai,k = yi,k                    / y i ,k            for any field f and f . We consider
two calibration targets to pin down the 2 × K unobserved scale parameters k : the supply
quantity of every crop k in the USA, and the aggregate share of agricultural land in the USA
allocated to modern technology for every crop k.
    In addition to the agricultural productivity parameters, we also calibrate investment
                                   f
intensity parameter (an,0 ) by matching field-level data on the share of cropland which we
obtain from the EarthStat data.
    In what follows, we express the calibration problem as c(A ) = 0, reflecting that the
calibration of production technology parameters depends on A .


4.2.2   Estimation

We estimate production elasticities A = (1 , 2 ) using generalized method of moments
conditional on the calibration problem given by c(A ) = 0. In the calibration problem, we
solve, at a given value of A , the general equilibrium and calibrate parameters of production
technology as explained in the previous section. We continue by describing the moments
that we construct for our estimation.
    First, we construct a moment condition based on model predictions for yields and data
                               f
                      ^i,k be the actual yield of crop k in field f in country i. Our specification
on actual yields. Let y
allows for measurement error in the actual yield data:

                                                 f             f    f
                                                        ^ i ,k
                                               y i ,k = y          i ,k ,

         f                                                                   f
where yi,k is the true value of the actual yield, and                       i ,k   is an error term. One of our identifi-
cation assumptions requires that log of the error term is orthogonal to predicted log of land
               f           f
share, E[ln   i ,k   × ln i,k ] = 0. We construct this moment using data on actual yields across
fields within the United States, where we have more reliable data. The intuition behind this
                                                                                                        f
orthogonality condition is that, controlling for land productivity shifters ( ai,k ), land shares
are sufficient statistics for yields. Our identification assumption requires that deviations of
predicted yields from data on actual yields are not explained by land shares. In other words,
all information that is required for the model to predict yields is already summarized in land


                                                        29
shares. Since we use field-level data on actual yields from the United States where modern
technology is by far the dominant choice, the informative variations are expected to be for
choices across crops. As such, this moment condition is tightly related to the identification
of 1 . We define the resulting moment as m1 .
      We construct two additional moment conditions based on cost shares of agricultural in-
puts across countries. As we presented in the empirical pattern 2, countries with a higher
GDP per capita have higher cost shares of agricultural inputs (Fig. 3-a). Note that, if we as-
sumed a Cobb-Douglas technology with the same factor shares across countries, that would
force all countries in the model to have the same cost share of inputs, sharply contradicting
this empirical pattern. Our second set of moments is designed to capture this cross-country
heterogeneity in the cost share of inputs. In our model, the elasticity of substitution between
technologies (2 ) controls how responsive agricultural producers are to relative wages and
input prices. Higher wages and lower input prices induce agricultural producers to shift
toward modern technologies, which raises the share of input costs in agriculture. If 2 is
higher, the model generates larger differences in aggregate costs shares of agricultural in-
puts across low-income and high-income countries. Alternatively, if 2 approaches 1, then
the cost share of inputs across countries will be negligible. Given this intuition, we use the
mean cost share of agricultural inputs in the two upper deciles and the two lower decides of
income per capita across countries as targeted moments. We call these moments m2 .
      Stacking the moment conditions, we have g(A ) = [m1 (A ), m2 (A )] - [m1
                                                                             data , mdata ].
                                                                                     2
Our estimation procedure is then based on the following moment condition

                                        E( g(A )) = 0

We seek values of A = (1 , 2 ) that achieves

                                  A = arg min g(A ) g(A )
                                               A
                                  subject to    c(A ) = 0.


4.3    Estimation Results

Table 2 presents results from the estimation of the model. On the demand side, we have
estimated the elasticity of substitution for crops across supplying countries, k , at 5.1; and
the elasticity of substitution across crops at 3.1. We have taken the rest of demand elasticities


                                                30
                         Table 2: Estimation of the Key Elasticities of the Model

                                    Description                      Parameter Method Value
                A. Demand Side
                - Elast of subst across crops                                     IV      3.1
                - Elast of subst across origins within a crop           k         IV      5.1

                B. Supply Side
                - Elast of subst across crops                           1       GMM      2.05
                - Elast of subst across technologies within a crop      2       GMM      4.38

Notes: This table shows estimation results for the demand side and the supply side. See Section 4.1 and 4.2 for
the details on our estimation procedure.


from the literature, as explained in Section 4.1.
     On the supply side, our estimation implies a production elasticity of substitution across
crops, 1 , equal to 2.05, and a production elasticity of substitution across technologies within
a crop, 2 , equal to 4.38. Our estimate of 1 is in the range suggested by the literature. Using
variations in crop outputs across countries, Costinot, Donaldson, and Smith (2016) estimate
this elasticity at 2.6. Using variations in land shares and prices across regions within Peru,
Sotelo (2020) estimate this elasticity at 1.6. Using farm-level data from Uganda, Bergquist,
Faber, Fally, Hoelzlein, Miguel, and Rodriguez-Clare (2019) estimate a range of elasticities
between 1.8 and 2.9. To the best of our knowledge, we are the first to estimate 2 , so we do
not have a benchmark value for comparison. Our estimates imply that agricultural produc-
ers are more responsive in substituting between technologies within a choice of crops, than
substituting between crops.
     To illustrate the identification of 1 and 2 , we conduct a grid search exercise. Specifi-
cally, we show in Figure 6 the surface of our GMM objective function evaluated at a wide
range of (1 , 2 ). The figure demonstrates a concave function with our estimates as its global
minimum.




                                                       31
            Figure 6: Identification of Productivity Dispersion Parameters (1 and 2 ).




Notes: This figure shows the objective function of the GMM procedure used to estimate 1 and 2 , where
1 captures the dispersion of productivities between crops and 2 captures the dispersion of productivities
between technologies within a crop. The values at which the objective function is minimized are 1 = 2.05 and
2 = 4.38.



4.4    Goodness of Fit

Different from quantitative frameworks that perfectly fits production data by treating pro-
ductivities as residuals, we have the opportunity to construct PPFs from field-level on po-
tential yields without forcing a perfect fit of the model with data. In other words, we let
our model fail to fit the baseline data on agricultural production. Before using our model
for counterfactual analyses, we therefore check whether the model has a good fit with en-
dogenous variables that will be central in our counterfactual analysis, such as production
quantities, employment and trade in agriculture. In doing so, we also discuss model's pre-
dictions about technology use.
      Figure 7 compares the log quantity of crop outputs at the level of countries predicted by
                                                                                             f          f
the model versus data. In our calibration, we calibrated land productivities (ai,k1 and ai,k0 )
using potential yields from FAO-GAEZ, where we used data on production of crops only
from the United States. Therefore, the main factors driving the predictions in Figure 7 are
our calibrated land productivities as well our estimated elasticities. The model predictions
line up reasonably well with the data.


                                                    32
     Figure 8(a) shows a scatter plot of the aggregate share of land allocated to modern tech-
nology across countries against their GDP per capita. The model generates substantial vari-
ation in the share of land allocated to modern technologies. Low-income countries such
as Ethiopia, Ghana, and Burkina Faso have shares of their land in modern technologies
that are very low, which is consistent with the extremely low use of inputs observed in the
data. The share of land in modern technology is typically in the range of 40% to 90% in
middle-income countries such as Brazil, Thailand, and Turkey, and around 90% to 100% in
high-income countries such as USA, Japan, and West and North European countries. Our
calibration requires the US share to be at 95% in line with US agriculture data on the use
of agricultural inputs, but the remaining points on the scatter plot are predictions of the
model. There are two key mechanisms driving these cross-country differences in technol-
ogy choices. First, since traditional technologies are labor-intensive, low-income countries
tend to use traditional technologies due to lower wages. Second, due to import barriers,
low-income countries tend to face higher input prices, discouraging the use of modern tech-
nologies.
     Figure 8(b) shows the share of labor in agriculture predicted by the model against data.
Note that agricultural employment is entirely an out-of-sample variable since we did not
target it in our calibration or estimation. The variation and the slope that is generated by the
model is reasonably close to the data. The model under-predicts the agricultural employ-
ment share compared to the data.

                         Figure 7: Fit of the Model with respect to Crop Output




Notes: This figure shows the model fit of crop outputs at the level of countries. The red line shows the 45 degree
line. Both variables are represented in logs. Each data point represents a country-crop pair.




                                                       33
                 Figure 8: Model Predictions for Technology and Employment Share

a. Share of Land Allocated to Modern Technology              b. Share of Agricultural Employment




Notes: This figure shows the predictions of the model with respect to share of land allocated to modern tech-
nologies and share of employment in agriculture.




5     Impact of Globalization on Agricultural Productivity

Equipped with our estimated model that allows for adjustments in crop specialization and
technology choice, we now examine the quantitative contribution of different mechanisms
through which globalization shaped agricultural productivity. In particular, we ask what
would be the effects of bringing trade costs between countries to their 1980 levels on agricul-
tural productivity, food consumption, and welfare around the world. We separately examine
the reductions in trade costs in agricultural output and in agricultural inputs. We present
our results as counterfactuals relative to baseline. Before presenting our simulations, we first
describe our procedure to estimate changes to trade costs between 1980 and 2015.


5.1    Estimating Changes to Trade Costs between 1980 and 2015

To estimate changes to trade costs, we follow a common approach in the trade literature (see
Head and Mayer (2014)). We assume that the trade cost component of the demand shifters
(dni,g ) is symmetric and normalize the trade cost of a country with itself to one, dii,g = 1.
We estimate these trade costs for agricultural outputs by combining data on crops, and for


                                                     34
agricultural inputs by combining data on fertilizers, pesticides, and farm machinery. Putting
these assumption together, our model gives

                                  Xin,g   Xin,g
                           log          ×           = 2(1 - g ) log(dni,g ) +   in, g
                                  Xii,g   Xnn,g
                                                               in,g


where    in, g   = log(bni,g bin,g /bii,g bni,g ). We estimate in,g as fixed effects using bilateral expen-
diture and trade data, and then recover dni,g , for agricultural outputs and inputs in 1980 and
2015.
      Figure A.2 shows percentage changes to trade costs between 1980 and 2015 for agri-
cultural outputs and inputs, aggregated by regions. We find an average reduction of trade
costs (weighted by trade flows of 2015) of 21% for outputs and by 35% for inputs. The fall in
trade costs of agricultural inputs is typically larger than that of agricultural output. For both
cases changes to trade costs are substantially heterogeneous across countries. For example
on the input side, while the average trade costs in the sub-Saharan Africa fell by 5%, in Latin
America they fell by 15% and in East Europe by 45%.


5.2     Counterfactual Simulations of the Impact of Globalization

We simulate a counterfactual in which trade costs of agricultural outputs and inputs are set
at their 1980 levels, and all other remaining parameters are kept unchanged. Specifically, let
ni,g be the percentage change in trade cost dni,g from 2015 to 1980. We compute counter-
factual demand shifters as bni,g (ni,g dni,g )(1-g ) which we use to simulate a counterfactual
equilibrium of our model.
      Table A.3 shows the general equilibrium effects from these changes on yields, and Table
A.4 presents the resulting effects on selected variables including food consumption and wel-
fare. Yields fall by 2.4 - 9.0% across crops at the global level. The loss in yields is associated
with a fall in the imported share of expenditure on crops and on agricultural inputs, which
falls respectively by 16.08% and 52.26%, at the global scale. In addition, the global share of
land allocated to modern, input intensive technologies decreases by 7.49%. As a result of
these changes, the consumer price index of agriculture rises by a global average of 8.19%,
contributing to 2.83% reduction in food consumption and 1.63% reduction in welfare at the
global level.
      The welfare effects from moving to the counterfactual with trade costs of 1980 are

                                                      35
largely heterogeneous across countries. Countries that lose the most include some of those in
East Europe such as Hungary and Poland, in Latin America such as Colombia and Mexico,
in Asia such as Bangladesh and Malaysia. In contrast, a number of countries in Sub-Saharan
Africa, Middle East, and Latin America appear to be the ones that lose the least or even gain
in terms of food consumption and welfare.
    To study the channels at work, we report results for additional counterfactual simu-
lations where we change trade costs only in agricultural outputs and only in agricultural
inputs. Table 3 shows a summary of results these counterfactuals at the global level. First,
we find that changes in trade costs in agricultural output and in agricultural input have com-
parable effects on global welfare (-0.87% and -0.75% respectively). Therefore, not accounting
for imports of agricultural inputs and their effect on technology choice would largely under-
estimate productivity gains from globalization in agriculture. The channels through which
these two types of reductions in trade cost operate are completely different. Table 3 indicates
that globalization in agricultural inputs has a minor contribution to changes in international
crop specialization, as reflected by the changes in the import share of agricultural outputs.
Moreover, the table also shows that globalization in agricultural output has a minor effect
on input intensification, as captured by the changes in the share of land allocated to modern
agricultural technologies.

           Table 3: Welfare Effects of the Absence of Globalization at the Global Scale


                                                      Counterfactual effects from changes in trade costs of
                                          Both ag outputs and inputs            only ag outputs         only ag inputs

  Import share on ag output                            -16.1%                         -15.4%                       -1.3%
  Share of land in modern tech                         -7.5%                            0.0%                       -7.5%
  Welfare                                              -1.63%                         -0.87%                      -0.75%
  Notes: This table shows the percentage change to imported share of expenditure on agricultural outputs (crops), share of land
  allocated to modern technology, and welfare at the global scale, from the baseline of 2015 to the counterfactual with trade costs of
  1980 for both agricultural outputs and inputs, only agricultural outputs, and only agricultural inputs.




    We continue to explain these distinct channels of effects that operate through the output
side (comparative advantage) and input side (technology) in more details.




                                                                  36
Globalization Only in Agricultural Outputs

As it has been discussed in the trade literature, the effects of trade openness in agricultural
output on food consumption and welfare operate through comparative advantage forces
and their implications for international crop specialization. To isolate the role of this mech-
anism, we run a counterfactual in which we only bring trade costs in agricultural output to
their levels in 1980, while leaving trade costs in agricultural inputs at their levels in 2015.
     For a wide class of trade models, including the Armington structure that we adopt here,
changes to the share of expenditures on domestic goods (or equivalently, on imports) is a suf-
ficient statistic for changes to welfare in response to a trade shock (see Arkolakis, Costinot,
and Rodriguez-Clare (2012)). Figure 9 shows that percentage changes in food consumption
and welfare are indeed strongly associated with percentage changes to the imported share
of expenditure on crops. In addition, these figures show large differences in effects across
countries. The magnitudes of welfare loss from the move to the counterfactual with trade
costs of 1980 can be as large as 13% for Poland in terms of food consumption, and 6% for
Bangladesh in terms of welfare. At the global level, there would be 1.13% reduction in real
agricultural consumption and 0.87% reduction in welfare.

Figure 9: Welfare effects of globalization in agricultural outputs against imported share of
expenditures on crops

                a. Food Consumption                                              b. Welfare




Notes: This figure shows percentage changes to food consumption and welfare across countries from the base-
line of 2015 to the counterfactual in which trade costs of agricultural outputs are set to their 1980 levels.




                                                        37
Globalization Only in Agricultural Inputs

We now explore the efficiency gains generated by globalization in agricultural inputs. In
doing so, we show its distinct way of generating efficiency gains compared to the output
side mechanisms. In particular, gains from globalization in agricultural inputs are associated
with a higher adoption of modern, input-intensive technologies in agricultural production.
To spell out this mechanism, we run a counterfactual in which we bring trade costs in only
agricultural inputs to their levels in 1980, while leaving trade costs in agricultural output at
their levels in 2015. In a sequence of figures, we report the chain of effects from agricultural
input prices to agricultural productivity, and from there to consumption and welfare.
    First, as a result of the overall increase in trade costs of agricultural inputs, the price
index of agricultural inputs at the location of use would rise for many countries. A higher
price of inputs makes agricultural producers allocate a larger share of land to traditional
technologies. Figure (10) shows that the larger the increase in the price of agricultural in-
puts, the larger the extent to which land is allocated to traditional technologies in the coun-
terfactual relative to the baseline. Due to general equilibrium effects, the agricultural input
price index does not necessarily rise for all countries. To understand this result, consider
the case of Malaysia and Iran. Between 1980 and 2015, due to the global fall of trade costs
in agricultural inputs, the global demand rose for agricultural inputs, increasing the price
of these inputs at the location of production. In this period, trade costs in inputs reduced on
average by around 38% for Malaysia, but only by an average of 7% for Iran. Putting these
together, the price of agricultural inputs in the counterfactual compared to the baseline is
on average 38% higher for Malaysia, but on average 9% lower for Iran. Consequently, the
aggregate share of land allocated to modern technology is 16.5% smaller for Malaysia, and
4.7 percentage point larger for Iran. A takeaway from this example is that countries that fell
behind in the process of globalization ended up facing higher prices of agricultural inputs,
creating a barrier for their shift toward modern, input-intensive technologies.
    We now turn our attention to examining how shifting from traditional to modern tech-
nologies can bring about higher land productivities. Figure (10) shows, for selected crops,
the predicted change to yields against change to the share of land allocated to modern tech-
nologies. By and large across crops and countries, land productivities (yields) are smaller
in the counterfactual with trade costs of 1980 compared to the baseline. Across countries
within a crop, yields are systematically lower, the smaller the land share of modern technol-
ogy in the counterfactual outcome compared to the baseline. As reported in Table (A.3), at


                                              38
the global scale the counterfactual yields are 3 to 8 percent lower across crops, indicating no-
table global gains in agricultural land productivity as a result of globalization in agricultural
inputs.
    In addition, Figure (11) shows counterfactual changes for measures of input intensity
in agricultural production. The smaller the land share of modern technology in the coun-
terfactual compared to the baseline, the smaller the cost share of inputs and the smaller
agricultural output per worker. Hence, globalization in agricultural inputs contributes to
agricultural input-intensity through the choice of modern technologies.
    Lastly, we report the subsequent changes to agricultural prices, consumption, and wel-
fare. Figure (11) presents the scatter plot of percentage changes to real agricultural con-
sumption (Panel c) and welfare (Panel d). Comparing the counterfactual with trade costs
of 1980 to the baseline, real consumption of agriculture tends to be systematically smaller
across countries, the lower the land share of modern technology. Due to lower agricultural
productivities in the counterfactual outcome, consumers in most countries face higher price
index of agricultural good. As a result of this price effect, consumers would consume less
food. However, since real income tends to be lower in the counterfactual outcome, the in-
come effect requires a higher demand for food through non-homothetic preferences. Over-
all, these interactions would result in 1.75% reduction in the global food consumption and
0.75% reduction in the global welfare.




                                               39
             Figure 10: Effects of Globalization of Agricultural Inputs on Selected Crops

                       a. Corn                                             b. Wheat




                       c. Corn                                             d. Wheat




Notes: This figure shows how changes in key variables for selected crops if there had been no reductions in
trade cost in agricultural inputs between 1980 and 2015.




                                                     40
Figure 11: Land share allocated to modern technique vs Selected measures of productivity and
welfare

          a. Agricultural output per worker                         b. Cost share of inputs




            c. Agricultural consumption                                    d. Welfare




Notes: This figure shows the relationship between changes in agricultural consumption and the share of land
allocated to modern technology, as well as the relationship between changes in welfare and the share of land
allocated to modern technology in the absence of the reductions in trade cost in agricultural inputs between
1980 and 2015.




6    Conclusion

In this paper, we evaluated the impact of globalization on agricultural productivity across
the world geography. We developed a quantifiable, multi-country general equilibrium model
of trade with an extremely rich spatial structure that incorporates choices of crops and tech-
nologies in agricultural production. We connected our model to data on agricultural produc-
tivity for crops and technologies at the level of fields covering the surface of the earth. We
found large productivity gains at the global scale, with notable distributional gains across
countries. We found that in addition to well-studied welfare effects from the output side


                                                    41
of agriculture, the effects from the fall of trade costs in agricultural inputs on agricultural
productivity have been remarkable.
    Previous research has either evaluated the effects of international trade on agricultural
productivity without considering the role of input use and technology choice, or the effects
of input use and technology choice on agricultural productivity without considering the role
of international trade. In this paper we showed that, because agricultural inputs are largely
procured in international markets, international trade has a crucial role in shaping agricul-
tural productivity through facilitating the adoption of modern agricultural technologies.
    Finally, new and richer high-resolution datasets are becoming available at the intersec-
tions of natural and social sciences. We take a step forward in incorporating such data into
a theoretical framework that can be used for a wide range of applications. Integrating these
types pf micro-level data into economic models appears as a promising direction for future
research, particularly with applications to resources and environment.



References
A LLEN , T., AND D. ATKIN (2016): "Volatility and the Gains from Trade," Working Paper.

A NDERSON , K. (2010): "Globalization's effects on world agricultural trade, 1960­2050,"
  Philosophical Transactions of the Royal Society B: Biological Sciences, 365(1554), 3007­3021.

        (2016): Agricultural trade, policy reforms, and global food security. Springer.

A RKOLAKIS , C., A. C OSTINOT,      AND   A. R ODRIGUEZ -C LARE (2012): "New trade models,
  same old gains," American Economic Review, 102(1), 94­130.

A RKOLAKIS , C., N. R AMONDO , A. R ODRÍGUEZ -C LARE , AND S. Y EAPLE (2018): "Innovation
  and production in the global economy," American Economic Review, 108(8), 2128­73.

B ALDOS , U. L., T. W. H ERTEL ,   AND    F. C. M OORE (2019): "Understanding the spatial dis-
  tribution of welfare impacts of global warming on agriculture and its drivers," American
  Journal of Agricultural Economics, 101(5), 1455­1472.

B ERGQUIST, L. F., B. FABER , T. FALLY, M. H OELZLEIN , E. M IGUEL ,        AND   A. R ODRIGUEZ -
  C LARE (2019): "Scaling Agricultural Policy Interventions: Theory and Evidence from
  Uganda," Working Paper.


                                                42
C ALIENDO , L., AND F. PARRO (2015): "Estimates of the trade and welfare effects of NAFTA,"
  Review of Economic Studies, 82(1), 1­44.

C ASELLI , F. (2005): "Accounting for cross-country income differences," Handbook of economic
  growth, 1, 679­741.

C OMIN , D. A., D. L ASHKARI ,   AND   M. M ESTIERI (2015): "Structural change with long-run
  income and price effects," Discussion paper, National Bureau of Economic Research.

C OSTINOT, A.,   AND    D. D ONALDSON (2014): "How Large Are the Gains from Economic
  Integration: Theory and Evidence from U.S. Agriculture, 1880-1997," Working paper.

C OSTINOT, A., D. D ONALDSON ,       AND   C. S MITH (2016): "Evolving comparative advantage
  and the impact of climate change in agricultural markets: Evidence from 1.7 million fields
  around the world," Journal of Political Economy, 124(1), 205­248.

C OSTINOT, A.,   AND   A. R ODRÍGUEZ -C LARE (2014): "Trade theory with numbers: Quantify-
  ing the consequences of globalization," in Handbook of international economics, vol. 4, pp.
  197­261. Elsevier.

D ERYNG , D., D. C ONWAY, N. R AMANKUTTY, J. P RICE ,       AND   R. WARREN (2014): "Global
  crop yield response to extreme heat stress under multiple climate change futures," Envi-
  ronmental Research Letters, 9(3), 034011.

D ONALDSON , D. (2018): "Railroads of the Raj: Estimating the impact of transportation in-
  frastructure," American Economic Review, 108(4-5), 899­934.

D ONOVAN , K. (2017): "Agricultural risk, intermediate inputs, and cross-country productiv-
  ity differences," Working Paper.

E ATON , J., AND S. K ORTUM (2002): "Technology, geography, and trade," Econometrica, 70(5),
  1741­1779.

FAJGELBAUM , P.,   AND   S. J. R EDDING (2019): "External integration, structural transforma-
  tion and economic development: Evidence from argentina 1870-1914," Discussion paper,
  Working Paper.

FALLY, T., AND J. S AYRE (2018): "Commodity Trade Matters," Working Paper.




                                                43
FARROKHI , F. (2020): "Global sourcing in oil markets," Journal of International Economics, p.
  103323.

F EENSTRA , R. C., R. E. L IPSEY, H. D ENG , A. C. M A ,     AND   H. M O (2005): "World trade
  flows: 1962-2000," Discussion paper, National Bureau of Economic Research.

F OLEY, J. A., N. R AMANKUTTY, K. A. B RAUMAN , E. S. C ASSIDY, J. S. G ERBER , M. J OHN -
  STON ,   N. D. M UELLER , C. OC ONNELL , D. K. R AY, P. C. W EST,    ET AL .   (2011): "Solutions
  for a cultivated planet," Nature, 478(7369), 337.

G AFARO , M., AND H. P ELLEGRINA (2019): "Trade, Farmers' Heterogeneity and Agricultural
  Productivity: Evidence from Colombia," Working Paper.

G OLLIN , D., D. L AGAKOS , AND M. E. WAUGH (2014): "The Agricultural Productivity Gap,"
  The Quarterly Journal of Economics, 129(2), 939­993.

G OLLIN , D., S. L. PARENTE ,     AND   R. R OGERSON (2007): "The food problem and the evolu-
  tion of international income levels," Journal of Monetary Economics, 54(4), 1230­1255.

G OUEL , C.,    AND   D. L ABORDE (2018): "The crucial role of international trade in adaptation
  to climate change," Discussion paper, National Bureau of Economic Research.

H EAD , K.,     AND   T. M AYER (2014): "Gravity equations: Workhorse, toolkit, and cookbook,"
  in Handbook of international economics, vol. 4, pp. 131­195. Elsevier.

H ERTEL , T. (2013): "Global applied general equilibrium analysis using the global trade anal-
  ysis project framework," in Handbook of Computable General Equilibrium Modeling, vol. 1, pp.
  815­876. Elsevier.

H ERTEL , T. W. (2002): "Applied general equilibrium analysis of agricultural and resource
  policies," Handbook of agricultural economics, 2, 1373­1419.

L AGAKOS , D.,    AND    M. E. WAUGH (2013): "Selection, Agriculture, and Cross-Country Pro-
  ductivity Differences," The American Economic Review, 103(2), 948­980.

L ASHKARIPOUR , A., AND V. L UGOVSKYY (2018): "Scale economies and the structure of trade
  and industrial policy," Working Paper.

L EE , D. R.,   AND   P. G. H ELMBERGER (1985): "Estimating supply response in the presence of
  farm programs," American Journal of Agricultural Economics, 67(2), 193­203.

                                                 44
L IND , N.,   AND   N. R AMONDO (2018): "Trade with correlation," Discussion paper, National
  Bureau of Economic Research.

M C A RTHUR , J. W.,    AND   G. C. M C C ORD (2017): "Fertilizing growth: Agricultural inputs
  and their effects in economic development," Journal of development economics, 127, 133­152.

M C FADDEN , D. (1981): "Econometric models of probabilistic choice," Structural analysis of
  discrete data with econometric applications, 198272.

M ONFREDA , C., N. R AMANKUTTY,         AND   J. A. F OLEY (2008): "Farming the planet: 2. Geo-
  graphic distribution of crop areas, yields, physiological types, and net primary production
  in the year 2000," Global biogeochemical cycles, 22(1).

M UELLER , N. D., J. S. G ERBER , M. J OHNSTON , D. K. R AY, N. R AMANKUTTY,         AND   J. A.
  F OLEY (2012): "Closing yield gaps through nutrient and water management," Nature,
  490(7419), 254.

N IEDERTSCHEIDER , M., T. K ASTNER , T. F ETZEL , H. H ABERL , C. K ROISLEITNER ,
  C. P LUTZAR , AND K.-H. E RB (2016): "Mapping and analysing cropland use intensity from
  a NPP perspective," Environmental Research Letters, 11(1), 014008.

P ELLEGRINA , H. S. (2019): "Trade and the Spatial Organization of Agriculture: Evidence
  from Brazil ," Working Paper.

P ORTEOUS , O. (2016): "High trade costs and their consequences: An estimated dynamic
  model of African agricultural storage and trade," American Economic Journal: Applied Eco-
  nomics.

        (2020): "Trade and agricultural technology adoption: Evidence from Africa," Journal
  of Development Economics, p. 102440.

S OTELO , S. (2020): "Domestic Trade Frictions and Agriculture," Forthcoming in Journal of
  Political Economy.

T OMBE , T. (2015): "The Missing Food Problem: Trade, Agriculture, and International Pro-
  ductivity Differences," American Economic Journal: Macroeconomics, 7(3), 226­258.




                                                45
Appendix A                   Additional Figures and Tables

                           Table A.1: List of main variables and their data sources

 Variable                                                         Source
 Country-level Data
 Employment in agriculture and nonagriculture                     ILO
 Value added in agriculture and nonagriculture                    UN National Accounts
 Agricultural land                                                FAO
 Trade and production of crops                                    FAO
 Producer price of crops                                          FAO
 Trade and production of fertilizer, pesticide, farm machinery    UNIDO-IDSB, FAO, BACI
 Trade and production of nonagriculture                           BACI
 Expenditure share on agriculture                                 World Bank-Global Consumption Database, WIOD
 Gravity variables                                                CEPII
 Population and GDP                                               ILO, Penn World Tables

 Field-level Data
 Crop potential yield of low-input and high-input technologies    FAO-GAEZ
 Crop actual yield in the USA                                     EarthStat
 Crop land share worldwide                                        EarthStat
 Total land area                                                  FAO, EarthStat
 Notes. ILO: International Labor Organization, FAO: Food and Agriculture Organization, UNIDO: United Nations Industrial
 Development Organization, IDSB: Industrial Demand-Supply Balance Database at 4-digit ISIC, BACI: World trade database
 developed by the CEPII based on UN Comtrade, WIOD: World Input-Output Database, GAEZ: Global Agro-ecological zone




                                                                 46
 Table A.2: Factor Shares in Agricultural Production Technology

                        land (N)          labor (L)       material (M)
Traditional                0.51              0.49             0.00
Modern                     0.34              0.18             0.48

                      fertilizer in M   pesticide in M   machinery in M

Median across crops        0.22              0.25             0.53




                                   47
                      Table A.3: Percentage change to crops yields across countries

                        banana     cotton     corn      palm oil     potato   rice       soybean     sugarcane      tomato   wheat
Albania                             -1.9%      -1.6%                 -11.3%                -1.0%                     -0.2%    -9.8%
Argentina                 -4.2%     -6.9%      -5.1%                  -6.4%    -6.3%       -5.7%            -3.9%    -4.9%    -3.6%
Australia                -12.1%     -8.9%     -14.7%      -14.3%      -9.9%   -15.0%      -15.7%           -10.9%   -15.5%    -8.5%
Austria                                        -2.2%                   0.0%                 4.2%                     -4.1%    -2.6%
Burkina Faso                         0.4%      -0.1%                           -0.7%       -3.9%            -1.4%    13.1%
Bangladesh                14.6%     20.0%      12.6%        8.6%      14.8%    17.3%       18.6%             7.6%    15.8%    12.3%
Brazil                    -8.1%     -6.9%      -7.4%       -8.3%      -4.9%    -8.3%       -3.1%            -1.5%    -6.9%    -5.3%
Canada                                         -7.1%                  -2.0%               -14.1%                     -1.7%    -4.6%
Chile                                          -2.4%                 -10.9%                 6.5%                     -9.4%   -11.7%
China                     -5.1%     -4.7%      -8.0%       -6.3%      -4.1%    -6.4%       -3.6%            -4.2%    -6.5%    -4.1%
Cote dIvoire              -3.8%     -2.3%      -1.9%       -6.7%               -1.5%       -6.5%            -2.0%    -6.4%
Cameroon                  -3.3%     -3.6%      -0.2%        0.0%      10.6%    -0.4%        6.3%             7.7%    -1.5%     3.9%
Congo                     -2.2%      2.7%      -1.7%       -5.6%       1.0%    -1.6%       -2.1%            -1.7%    -1.7%    -0.3%
Colombia                  -9.1%    -10.1%     -10.1%       -8.6%      -8.7%   -10.2%       -9.2%            -4.2%   -12.3%   -11.7%
Costa Rica               -14.9%     -7.9%     -11.5%      -11.1%     -11.4%   -16.4%      -15.0%            -5.6%   -14.1%   -10.3%
Czech Republic                                -24.5%                 -22.7%               -29.9%                    -26.1%   -24.9%
Germany                                        -9.1%                  -8.7%                 1.7%                     -5.1%    -7.7%
Dominican Republic       -14.7%     -3.7%      -7.4%      -16.5%     -19.2%   -24.2%      -14.5%           -15.1%   -14.2%    -1.0%
Algeria                             -0.2%      -1.6%                  -3.0%                -1.3%            -5.8%    -0.5%    -3.4%
Ecuador                   -7.4%     -9.6%      -8.4%       -9.1%     -12.2%   -10.7%      -11.4%            -6.7%    -7.9%    -8.9%
Egypt                               -4.1%      -5.2%                  -3.2%                -5.5%                     -5.3%    -5.5%
Spain                               -4.5%      -7.9%                  -9.9%                -4.7%                     -3.2%    -7.2%
Ethiopia                   1.0%      2.0%       0.4%                   2.1%     0.3%        6.8%            0.8%      2.5%     0.6%
Finland                                                               -6.4%                                                   -5.0%
France                              -8.0%     -14.4%                  -9.4%   -14.3%      -15.9%                    -11.4%    -9.8%
United Kingdom            -2.7%    -14.7%     -14.2%       -5.0%     -14.3%               -16.8%           -20.2%   -18.5%   -14.0%
Ghana                     -2.2%      1.0%      -2.0%       -1.8%               -1.7%        1.0%            -3.5%    -2.0%
Greece                             -14.7%      -9.0%                 -14.3%               -11.9%                    -11.8%   -16.7%
Hungary                                       -15.5%                 -21.8%               -18.4%                    -15.9%   -16.2%
Indonesia                -14.5%     -6.3%     -14.1%      -13.1%      -8.9%   -13.1%      -10.0%            -5.1%   -10.8%    -5.8%
India                      2.1%      0.0%       2.2%        3.4%       1.0%     1.1%        0.1%             0.8%     1.0%     1.4%
Iran                                 5.4%      11.6%                   4.3%    16.8%        6.8%                      4.5%     4.5%
Italy                     -9.9%    -12.8%     -12.8%                  -9.3%    -7.8%      -11.7%            -2.7%    -7.5%    -6.4%
Japan                     -5.3%     -8.5%      -7.3%                  -7.1%    -6.5%       -7.1%            -6.2%    -5.9%    -7.0%
Kenya                     -1.7%     -0.2%      -2.9%                  -0.4%    -1.8%        6.7%            -3.2%    -1.6%     1.1%
South Korea                         -4.1%     -13.7%                  -8.8%    -9.6%       -7.0%                     -8.6%    -9.3%
Sri Lanka                 -4.7%      3.5%      -1.5%       -1.9%      -7.8%    -3.2%       -5.9%            -1.2%    -7.0%    -3.6%
Morocco                   15.7%     -3.7%      -3.2%       -3.3%       8.4%     5.9%       -3.4%             0.2%    -1.4%    13.8%
Mexico                   -11.6%    -14.6%     -10.8%      -14.0%     -10.7%   -11.1%      -15.5%            -9.0%   -10.1%   -11.4%
Mali                                -1.0%      -0.4%                           -0.4%       -6.8%             0.2%     0.4%
Mozambique                -2.2%     -1.0%      -5.6%        0.6%      -9.7%    -5.3%        3.0%            -6.9%    -5.5%   -10.1%
Malaysia                 -25.0%    -20.1%     -32.8%      -15.3%     -11.4%   -21.2%       -3.3%           -28.5%   -13.2%   -10.2%
Netherlands              -17.1%    -21.4%     -18.4%      -18.4%     -18.8%               -24.5%           -25.1%   -18.9%   -19.0%
Norway                   -11.2%     -7.7%      -9.5%       -2.0%     -11.6%                -6.9%            -6.0%   -10.5%   -11.7%
New Zealand               -4.9%     -1.3%      -8.9%                  -9.2%                -5.8%            -2.6%    -9.9%   -10.8%
Pakistan                   1.9%      3.5%       4.9%                  11.0%    11.2%       -3.2%             7.8%    -0.2%     8.3%
Peru                       1.8%      2.1%       2.9%       -0.2%       4.8%     2.2%        0.7%            -1.8%     2.9%     2.3%
Philippines                0.0%     -1.3%      -3.0%       -0.8%     -11.0%    -6.6%       -3.8%            -0.8%    -1.6%    -0.9%
Poland                                         -9.1%                 -12.9%                                         -16.2%    -5.4%
Portugal                            -4.0%     -11.1%                 -13.7%                -8.8%                    -13.7%   -13.9%
Paraguay                 -11.5%     -6.4%      -3.8%       -9.9%     -14.7%    -7.9%      -10.0%            -2.5%   -10.1%   -13.5%
Romania                              2.4%      -3.9%                 -10.1%                -2.9%                     -4.8%    -8.9%
RoW                      -14.2%     -8.1%     -12.8%      -11.8%     -18.4%   -15.7%      -16.5%            -7.7%   -18.9%   -20.6%
Senegal                             -3.2%      -0.5%                           -4.7%       -5.1%                     -0.6%
fmr USSR                  -1.9%     -8.3%      -1.4%       -4.0%      -8.0%    -7.5%       -6.0%            4.4%     -7.8%    -6.5%
Sweden                                                               -16.3%                                                  -16.2%
Thailand                 -15.3%     -9.2%     -17.8%      -13.5%      -7.4%   -15.6%       -7.4%            1.1%     -2.9%    -9.9%
Tunisia                             -0.9%       1.4%                   4.6%                 0.7%                     -1.8%     4.7%
Turkey                              -4.8%      -6.8%                  -4.1%    -7.0%       -0.6%                     -4.9%    -4.5%
Tanzania                  -2.2%     -3.2%      -2.0%       -1.5%       1.1%                -2.3%             5.9%    -2.1%    -1.3%
Uruguay                   13.3%      8.5%      -0.6%                 -14.0%    -2.4%      -11.5%             3.1%    -5.1%   -10.9%
United States             -2.9%     -2.6%      -1.9%                  -2.8%    -2.0%       -2.6%            -1.8%    -2.0%    -2.4%
Venezuela                  5.1%      3.9%       6.4%       6.2%        4.2%     6.0%       -0.8%             5.4%     4.6%     1.4%
Vietnam                   13.3%     16.2%      19.7%      15.1%        5.4%    13.8%        7.8%             3.4%    11.9%    13.2%
fmr Yugoslavia                       4.9%      -5.6%                 -11.0%    -3.6%       -8.3%                     -5.6%   -11.4%
South Africa              -3.0%      2.7%      -3.2%                 -13.9%    -2.5%       -3.8%            -2.4%    -1.6%   -17.0%
World                     -6.1%     -4.2%      -6.5%       -6.8%      -9.0%    -3.7%       -2.4%            -3.1%    -7.3%    -8.1%
Notes: This table shows the percentage change to yields (production quantity per unit of land) across crops and countries from
the baseline of 2015 to the counterfactual with trade costs of 1980 for agricultural outputs and inputs.




                                                                48
  Table A.4: Percentage changes to agriculture-related variables and welfare

countries              ISE           ISE          share of land     agriculture    agriculture     welfare
                       agr output    agr input    in modern tech    price          consumption
Albania                   -17.80%      -51.38%           -18.30%        10.38%           -3.80%     -4.57%
Argentina                  32.53%       40.91%            -6.70%         5.31%           -1.57%     -0.06%
Australia                 -14.14%       29.64%            -5.53%         9.24%           -3.92%     -0.82%
Austria                    -5.38%      -37.88%             1.47%        20.17%           -8.38%     -0.60%
Burkina Faso              -20.87%       41.47%           -85.13%         2.46%           -0.60%      0.02%
Bangladesh                -30.49%       18.35%            19.36%        19.48%           -6.58%     -6.44%
Brazil                     -2.29%       40.72%            -9.70%         1.73%           -1.87%     -1.04%
Canada                    -20.93%       21.75%            -1.77%         8.31%           -5.72%     -2.50%
Chile                      -7.90%      -17.64%            -3.03%        21.57%           -9.13%     -3.14%
China                     -52.14%      -10.97%            -2.37%         7.19%           -2.13%     -0.45%
Cote dIvoire               10.14%       93.79%            58.27%         6.61%            1.25%      3.70%
Cameroon                  -36.35%      103.28%            99.73%         1.57%            0.08%      0.55%
Congo                       8.56%      104.29%           112.95%         2.49%            0.57%      1.79%
Colombia                  -22.39%       -8.07%           -16.54%         9.62%           -3.53%     -1.30%
Costa Rica                 -9.25%        3.92%           -21.49%        12.59%           -5.83%     -2.45%
Czech Republic             -3.01%      -49.26%           -15.07%        22.37%          -10.41%     -3.16%
Germany                    -5.61%      -71.28%            -0.04%        28.22%          -12.45%     -2.22%
Dominican Republic                      80.21%           -56.41%        12.09%           -1.01%      3.71%
Algeria                    -2.30%       22.17%           -16.63%         1.39%           -0.88%     -0.53%
Ecuador                   -50.82%       62.83%           -34.15%        10.94%           -3.73%     -1.41%
Egypt                     -12.75%     -108.18%             3.45%        16.47%           -7.13%     -7.20%
Spain                     -10.42%     -131.38%            -6.47%        41.49%          -16.70%     -4.49%
Ethiopia                  -46.43%       95.05%            -3.03%        -2.48%           -0.79%     -2.11%
Finland                    -1.32%     -162.27%            -0.03%        12.10%           -6.75%     -1.92%
France                     -2.07%      -31.63%            -4.92%        10.26%           -5.39%     -1.46%
United Kingdom              1.21%      -60.49%            -1.29%         8.56%           -4.60%     -0.99%
Ghana                     -12.21%       48.21%            -5.57%         6.18%           -0.99%      0.92%
Greece                    -10.04%     -103.05%           -22.50%        19.77%           -8.82%     -2.51%
Hungary                   -11.03%      -92.38%           -32.67%        24.19%          -11.52%     -3.70%
Indonesia                 -28.43%        2.25%           -18.21%        11.60%           -4.17%     -2.53%
India                     -63.40%      -33.25%             1.31%         1.11%           -0.84%     -0.97%
Iran                      -28.19%     -417.35%             6.09%         8.03%           -3.09%     -1.62%
Italy                      -4.29%      -79.35%            -6.73%        14.68%           -7.29%     -1.83%
Japan                       1.68%       38.36%            -1.35%         6.89%           -3.23%     -0.58%
Kenya                     -28.33%       65.24%            35.04%         8.47%           -1.49%     -0.57%
South Korea               -10.23%     -123.62%            -0.59%        17.06%           -7.18%     -1.20%
Sri Lanka                  -5.69%      -50.26%           -35.63%        10.00%           -4.00%     -3.91%
Morocco                   -40.83%       64.68%            56.08%         7.38%           -2.93%     -1.21%
Mexico                    -26.66%      -64.26%           -17.38%        21.68%           -8.84%     -2.37%
Mali                        0.31%       72.04%             2.82%         1.64%            0.00%      0.25%
Mozambique                              98.78%           -64.30%         6.37%            1.02%      4.32%
Malaysia                  -20.09%      -32.78%           -18.83%        20.45%          -10.04%     -4.39%
Netherlands                -0.11%      -41.32%            -1.38%        13.66%           -7.81%     -2.89%
Norway                     -3.44%      -60.32%            -0.04%        20.28%           -9.59%     -2.37%
New Zealand               -12.98%     -161.23%             0.31%        27.47%          -11.74%     -3.19%
Pakistan                  -29.29%       39.99%            10.66%         2.16%           -0.80%     -0.59%
Peru                      -35.87%       58.65%            25.11%         5.28%           -1.97%     -0.69%
Philippines               -21.38%       35.63%           -45.58%         5.52%           -1.53%     -0.56%
Poland                    -23.72%     -103.56%            -3.05%        43.26%          -17.04%     -6.07%
Portugal                   -5.78%      -93.84%           -15.55%        33.19%          -13.92%     -4.04%
Paraguay                  -24.24%       84.22%           -27.87%         1.56%           -3.56%     -3.41%
Romania                   -16.30%      -83.89%           -13.07%        22.03%           -9.24%     -6.98%
RoW                       -17.04%       64.15%           -44.07%         7.19%           -1.84%      0.00%
Senegal                    -9.65%       18.81%           131.46%        14.15%           -5.12%     -4.22%
fmr USSR                  -39.69%      -57.02%            -5.38%        15.97%           -6.13%     -5.31%
Sweden                     -6.22%      -26.03%            -0.62%        32.53%          -13.62%     -2.81%
Thailand                   -4.68%      -35.73%           -23.16%        13.92%           -6.07%     -3.00%
Tunisia                    -9.44%       -5.63%            18.34%        10.87%           -3.11%      0.78%
Turkey                    -38.95%     -148.90%            -1.76%        33.65%          -11.83%     -5.17%
Tanzania                  -22.98%       51.58%           -83.63%         7.23%           -1.31%     -0.25%
Uruguay                   -51.34%       62.47%           -41.75%         2.05%           -2.89%     -2.13%
United States             -10.72%      -15.40%            -0.34%         3.60%           -1.71%     -0.36%
Venezuela                  -9.22%      129.68%             9.51%        -4.12%            1.90%      0.59%
Vietnam                                117.13%            19.50%        -8.26%            2.94%      0.14%
fmr Yugoslavia             -8.61%      -23.16%           -16.44%        10.72%           -4.96%     -3.05%
South Africa              -26.76%       -4.60%           -51.01%         6.52%           -3.58%     -1.18%
World                     -16.08%      -52.26%            -7.49%         8.19%           -2.83%     -1.63%
Notes: This table shows the percentage change to agriculture-related variables across countries from the
baseline of 2015 to the counterfactual with trade costs of 1980 for agricultural outputs and inputs. ISE
stands for imported share of expenditures.




                                                   49
                        Figure A.1: Import content of agricultural input use




Notes: This figure shows the share of imports in the use of fertilizers, pesticides, and agricultural machinery in
20 largest countries in terms of agricultural output for year 2015




                                                       50
Figure A.2: Trade costs changes between 1980 and 2015, for agricultural outputs and inputs,
aggregated by region




Notes: This figure shows the percentage change to trade costs of agricultural outputs (as the aggregate of crops)
and agricultural inputs (as the aggregate of fertilizers, pesticides, and farm machinery) between 1980 and 2015.


Appendix B                Data
Potential Yields. The data on potential yields (also called "maximum attainable yields") comes from
Global Agro-Ecological Zones project, which is produced by the International Institute for Applied
System Analysis (IIASA) and the Food and Organization of the United Nations (FAO). The goal of the
project is to generate global datasets about agriculture at the disaggregated level of fields to promote
studies of the conditions affecting agricultural development and food security. The first version of
the dataset was published in 2000.
     Among the different datasets produced by FAO-GAEZ, we use for our analysis data on agro-
climatically attainable biomass and yield for specific land utilization types (LUTs) by crop. The differ-
ent types of land utilization corresponds to what we denote by different technologies in our model.
The estimation of the maximum attainable yield is based on a function that maps rich climate data
into maximum attainable yields. The parameters of this function depend on each LUT and crop.
Importantly, local socio-economic conditions do not enter as an input in the estimation of maximum
attainable yields. As such, variations in maximum attainable yields across fields should only capture
differences in climatic conditions rather than levels of development of each country. Indeed, we find
little to no systematic variation between maximum attainable yields and gdp per capita in our data
once we control for a parsimonious set of geographic characteristics of a field.



                                                       51
     The land utilization types in the data are divided into three groups. First, there is a low level of
input use type, which corresponds to a farming system that is largely subsistence based. This dataset
represents the maximum attainable yield if farmers use traditional cultivars and, importantly, no
application of nutrients, no use of chemicals and minimum conservation measures. Therefore, we
denote this technology as traditional in our analysis. Second, there is an intermediate level of input
use type, which corresponds to a faming system that is partly market oriented. We do not directly
use this type of technology because we do not have enough data to identify an additional set of pa-
rameters for factor-intensity in our model. Third, the high level of input use type, which corresponds
to a farming system that is mainly market oriented. In this case, production is fully mechanized and
uses optimum applications of nutrients and chemical pest, disease and weed control.

Actual Yields and Agricultural Land. The data on actual yields come from Earthstat. Earthstat also
provides geographic datasets at the disaggregated level of fields providing information about agri-
culture. The project is a collaboration between the Global Landscapes Initiative at the University
of Minnesota's Institute on the Environment and the Land Use and Global Environment Lab at the
University of British Columbia.
     Among the several datasets organized by Earthstat, we use information on actual yields by crop
and on the share of land in agriculture. The data on actual yields use data from agricultural census
and survey information on the areas from the smallest political units from each country. The level
of disaggregation of the source data, however, varies substantially across countries. For example,
in some countries, the data on actual yields is provided in terms of smaller areas that correspond
to counties in the US, whereas in other countries data is provided at the state and province levels.
Therefore, in our estimation we restricted our sample to the data constructed only from sources with
sufficiently disaggregated information.
     In addition to the yield level data, we also bring data from Earthstat on the share of a field
dedicated to the production of crops. This dataset, different from the yields one, is constructed using
a combination of agricultural datasets and satellite imagery. In our calibration, we use the entire
sample of cropland shares coming from Earthstat.

Trade and Gross Output for Agriculture and Non-Agricultural Goods. For bilateral trade flows in non-
agriculture goods, agricultural machinery, pesticides, fertilizers and agriculture as a whole, we use
data from BACI for the years after 1995 and from Feenstra, Lipsey, Deng, Ma, and Mo (2005) before
then. Both of these datasets are constructed based on Comtrade. To select the industry codes asso-
ciated with agricultural inputs, we follow closely the guidelines specified in FAO-STAT. We adjust
aggregate values for each good (i.e., non-agriculture goods, agricultural machinery, pesticides, fertil-
izers and agriculture as a whole) in Feenstra, Lipsey, Deng, Ma, and Mo (2005) to ensure consistency
with aggregate values in BACI.

                                                   52
     For the non-agriculture sector, we construct data on gross output using data the 2 digit level
data from UNIDO. In a few cases, we complement our data with information from other sources
as follows. First, we construct domestic trade shares of country i in non-agriculture (i,nag ) using
i,nag = (Yi,nag - Xi,nag )/(Yi,nag - Xi,nag + Mi,nag ), where Yi,nag is the gross output, Xi,nag is non-
agriculture export, and Mi,nag is non-agriculture imports. If domestic trade shares are not within 0
and 1, we then bring data on domestic trade shares from the World Input-Output Database (WIOD) or
from the trade and production dataset from CEPII, depending on availability, which are constructed
to satisfy these bounds. Finally, using our data on imports and exports, we then infer the gross output
that is consistent with these domestic trade shares using Yi,nag = Xi,nag + Mi,nag i,nag /(1 - i,nag ).
     For the agricultural sector as a whole (i.e., not disaggregated by crop), we construct gross output
based mostly on data from FAO-STAT. When data from FAO-STAT is not available, we bring infor-
mation on gross output in agriculture from the STAN dataset and, when the dataset from STAN is not
available, we construct gross output combining value added from United Nations with data on total
expenditure in agricultural inputs. For a few cases, our domestic trade shares are not within 0 and
1 and we then apply the same procedure that we adopted for the non-agriculture sector to construct
gross output.
     Our data on gross output and trade flows by crop comes from FAO-STAT. We have to make
minimal adjustments to crop names and codes to ensure consistency between the values coming
from these two datasets. For each crop, we pick the codes associated with trade in less processed
goods. For example, for palm production we do not include data on bilateral trade flows in palm oil.
Our final data on trade flows and gross output crop includes only data after 1991.
     To construct our data on agricultural input sales and expenditures, we collected information on
value added per sector from United Nations, on apparent consumption by industry from UNIDO
and on exports and imports from Comtrade and BACI. We focus on three agricultural inputs: pesti-
cide, machinery and fertilizer. The construction of our data for expenditure on fertilizers follows a
slightly different approach since richer data on quantities is available from FAO. We next explain our
procedure to construct the data for machinery, which is the same that we use to the data on pesticide.
     To construct our data on gross-output in agricultural machinery, we combine the 4 digit level
data from UNIDO with our data on trade flows. Our procedure is as follows. We first compute
the ratio of exports in agricultural machinery relative to total exports in non-agriculture goods using
our trade flow data and the ratio of gross output in agricultural machinery relative to gross output
in non-agriculture goods. We then run a regression of the relative gross output agains the relative
exports with country-fixed effects, which gives us a R2 of 0.82, and use the gross output predicted
from this regression. For countries without data available in UNIDO, we run a regression without
country-fixed effects, which gives an adjusted R2 of 0.51 and use the gross output predicted from this



                                                   53
regression. This procedure provides an extremely good within sample fit: a regression of the log of
the gross output in agricultural machinery in UNIDO against the log of our constructed gross output
yields a R2 of 0.92.
      To construct our data on gross-output for fertilizers, we combine data on exports, production,
consumption and imports in fertilizer quantity from FAO-STAT with our data on trade flows in val-
ues. The data on fertilizers from FAO-STAT comes disaggregated by nutrients, i.e., nitrogren N ,
phosphate P and potassium K. To simplify our analysis we summed the weight of the total amount
of nutrients coming from each type. This summation tends to give the same sample proportion of
each ingredient per country, which is often referred to as all-purpose fertilizer. Using the data from
FAO-STAT, we construct the domestic share of consumption by diving imports in quantity by total
consumption in quantity. Using this domestic share of consumption, which we call i,F , we con-
struct gross in values output using Yi,F = Xi,F + Mi,F i,F /(1 - i,F ). Noticed here that we rely on
the assumption that domestic shares of consumption in quantity are equivalent to domestic share
of consumption in values. This is the case when the price of imported fertilizers are in average the
same as the price of fertilizers consumed from domestic source. This assumption is consistent with
the Eaton and Kortum (2002) framework, where the average price of goods coming from any source
given destination is the same.

Consumption Share and Labor Employment in Agriculture. To construct our data on consumption share in
agricultural goods, we collect data from different sources. For developing countries, we use data from
the Global Consumption database organized by the World Bank to construct the consumption shares
in agricultural goods. For the United States, we use data from the consumer expenditure survey.
For Canada, we use data from household surveys available from Queen's University of Canada. For
European countries, we bring data from Eurostat. To construct labor employment, we use data from
UN-ILO. When data from UN-ILO was not available, we infer the share of workers in agriculture
using data on the share of workers in rural areas from the World Bank.



Appendix C                 Model

C.1     Costs and Output

Unit cost. Focusing on production in a plot given a choice of agriculture activity, we drop country-
field-crop-technique indicators, and write down the cost minimization problem:

                                                               L       N       M
                          min                           ¯ zL
                                      rL + wN + mM s.t. q          N       M       =1
                       L0, N 0, M 0




                                                    54
where
                                                   L                       N                    M
                                     ¯  (  L )- (  N )- (  M )-
                                     q

The Lagrangian function is:

                                                                           L                   N               M
                        L = rL + wN + mM - µ q
                                             ¯ zL                                      N               M           -1

First order conditions are:

                                                           L           L -1            N       M
                                              ¯ L z  L 
                                         r = µq                                N I
                                                           L           L       N -1             M
                                          ¯ N z  L  N 
                                     w = µq                                                I
                                                           L           L           N       M -1
                                          ¯ M z  L  N  I 
                                     m = µq


The employment of labor and land relative to inputs are then given by:

                                               L mM        N mM
                                         L=         , N =
                                              M r         M w

                                                                   L               L                           N          M
                                                  mM                                            N mM
                                              ¯ z
Replace L and N into the production equation, q   M r                                          M w
                                                                                                                    M         = 1, delivers:

                                     L         L               N                           M       L       N       M -1
                           ¯ ) -1 z -  (  L ) -  (  N ) -  (  M )1-  r  w  m 
                      M = (q


which then results:

                                                           L    M      N           M
                                           M = (r / z )  w  m  ×
                                                                 m
                                                       L  N  M   L
                                          L = (r / z )  w  m  ×
                                                                r
                                                        L  N M  N
                                          N = (r / z )  w  m  ×
                                                                 w

Using these optimal choices of inputs, the unit cost of production equals

                                                                                   L       N           M
                              c = rL + wN + mM = (r /z) w m


Rent. Combining zero profit condition and returns to land,

                                                       L           N           M
                                   c = p  (r / z )  w  m  = p




                                                       55
which results:

                                                             1                N               M
                                                                     -L                   -L
                                                  r = zp  L w                     m           




Output. The size of each plot of land is w.l.o.g. normalized to one, and it is optimal to use the entire
plot as long as profits are non-negative. Therefore, land use L equals one. It follows that:

                                                                                                  N               M
                                                      rL  N      1
                                                                    -   -   N
                                     N =                  L
                                                            = zp L w L m L
                                                      w                     w L
                                                                      N   M
                                                      rL  M      1
                                                                    -
                                                                 L w L m
                                                                         -L 
                                                                             M
                                     M =                    = zp          
                                                      m L                   m L

Replace N , M, and L = 1 into the production equation gives output at the plot level:

                         L       N            M                  L                                    N               M    N + M
                                                                                      1
                                                                                              -L              -L                   N     N   M     M
              ¯ zL
          Q = q              N        M                ¯ z
                                                      =q                     zp  L w                      m       
                                                                                                                                   w L       m L

                     L       N            M
      ¯  ( L )- ( N )- ( M )- , and  L +  N +  M = 1,
Since q

                                                       -1    w       - N / L                  m           - M / L
                                 Q = z L
                                                             p                                p


C.2       Quantity of fixed costs
                                                                                              f
The unconditional mean of investment intensity draw, si ( ), is given by

                                                                 f                                f
                                                        E ai,0 ( ) = ai,0

      f
Let i be the set of plots within field f which are selected for agriculture use. The share of land
                                                                     f
allocated to all agricultural uses is denoted by i ,


                                                                                                        i ,k
                                                  f                               f                           f
                                              i  Pr(  i ) =
                                                                                                  k K

                 f
The mean of ai,0 ( ) conditional on plot  not being selected for agriculture is

                                          f                              f                f                       f
                                     E ai,0 ( ) |  / i                          = ai,0 (1 - i )-1/1

The conditional mean is greater than the unconditional mean because when the investment intensity
of a plot is too large, it will be less likely to select that plot for agriculture. By relating conditional and




                                                                         56
unconditional means and rearranging the resulting terms,

                 f            f                              f                     f   f           f       f
          E ai,0 ( ) = E ai,0 ( ) |   i Pr(  i ) + E ai,0 ( ) |  / i Pr( / i )

                 f            f                      1                     f               f           f       f
          E ai,0 ( ) |   i        =                      f
                                                                      E ai,0 ( ) - E ai,0 ( ) |  / i Pr( / i )
                                   Pr(                   i )
                 f            f     1 f       f        f            f
          E ai,0 ( ) |   i        = f ai,0 - ai,0 (1 - i )-1/1 (1 - i )
                                   i
                                           f
                f             f           ai,0                         f
          E    ai,0 ( )   |   i   =       f
                                                     1 - (1 -  i ) ( 1 -1) / 1
                                          i

                                                                                               f
The field-level quantity required for fixed investments in agriculture, Si , equals the average fixed
cost requirement conditional on plots being used for agriculture times the number of plots used for
                 f        f                      f       f       f
agriculture, Si = E ai,0 ( ) |   i i Li . Replacing in this equation the above one reproduces

equation (24),

                                      f          f       f                     f
                                  Si = ai,0 Li 1 - (1 - i )(1 -1)/1



C.3     Discrete Choice, Generalized Extreme Value, and Choice Probabili-
        ties

C.3.1   McFadden's Theorem

We reformulate Theorem 5.2 in "Econometric Models of Probabilistic Choice" by McFadden (1981).
Consider the following discrete choice problem


                                                                 max -qi + ui
                                                                 i 


where  is the set of alternatives, qi is the non-stochastic component of the objective function, and ui
is the stochastic term. For example, if qi = -b zi , and ui is a random variable drawn independently
from type I extreme value distribution, F (u) = exp(-e-u ), then the choice probabilities are given by

                                                           e - qi     e b zi
                                               i =                =
                                                          j e-q j    j eb z j

Theorem. Given  = {1, ..., m}, consider H (y) with y = (y1 , ..., ym ) such that

   1. H (y) is nonnegative, and it is homogeneous of degree one.


                                                                       57
   2. H (y)   as yi   for all i  .

   3. The mixed partial derivatives of H exist and are continuous, with non-positive even and non-
        negative odd mixed partial derivatives.

Then,

  (I) The following function

                                        F (u) = exp - H e-u1 , ..., e-um

        is a multivariate extreme value distribution.

 (II) Choice probabilities satisfy

                                                       
                                         i ( q ) = -       ln H e-q1 , ..., e-qm
                                                        qi


     We will use this theorem in our derivations below. For illustrative purposes, we first begin with
applying the theorem to a choice structure with one nest. Then, we focus on a two-nest structure,
that is the one in our framework.


C.3.2    Discrete choices with one nest

Suppose H is given by
                                                                 1/
                                             H (y) =       yi
                                                          i 

              1
With  =      1-  ,   as long as 0   < 1, the conditions in Mc Fadden's theorem are satisfied. Then,
according to result (I) of the theorem, the following is is a multivariate EV distribution:

                                                                           1/
                                F (u) = exp - e-u1 + ... + e-uK                                    (A.1)


where  is the correlation parameter between (u j , u j ). According to result (II) of the theorem, choice
probabilities are:

                                                             1/             e -  qi
                        i = -       ln e-q1 + ... + e-qK          =                                (A.2)
                                 qi                                   e-q1 + ... + e-qK

     By a change of variables, we can specify draws based on Type II EV (Fréchet) rather than Type
I EV. Recall that the discrete choice problem as originally formulated in McFadden's theorem was:



                                                        58
maxi -qi + ui . This problem is equivalent to


                                                               max hi zi ,
                                                                 i 


where qi = - ln hi ai , and ui =  ln(zi / ai ). Here, hi is the non-stochastic component and zi is a
realization of draw from a distribution. Replacing zi for ui in (A.1), the probability distribution of
z( ) = (z1 ( ), ..., zK ( )) is:

                                                                                             K            1

                                                                                             (zk /ak )-
                                                                                                          
                         Pr(z1 ( )  z1 , ..., zK ( )  zK )  F (z1 , ..., zK ) = exp -                         ,   (A.3)
                                                                                            k =1


which is a Fréchet (Type II EV) distribution. Replacing for qi = - ln hi ai in (A.2), choice probabilities
are:

                                                                (hi ai )
                                                       i =    K
                                                                                                                  (A.4)
                                                              k =1 ( h k a k )
                                                                               



          The case of Eaton and Kortum with independent draws is a special case in which  = 1 (or
equivalently,  = 0), and so, z1 ( ), ..., zK ( ) are independent. The probability distribution simplifies
to
                                                                               K
                                              F (z1 , ..., zK ) = exp -     ( zk / ak )-      .
                                                                           k =1

Thanks to independence, distribution of zk ( ) equals


                              Pr(zk ( )  zk )  Fk (zk ) = F (, ..., zK , , ...) = exp - (zk / ak )- ,


which is the distribution used in EK. In addition, setting  = 1 implies choice probabilities: i =
  ( hi ai )
 K                   .
 k =1 ( h i a i ) 



C.3.3           Discrete choices with two nests

The following function H satisfies the conditions in McFadden's theorem,

                                                                                      1/
                                                                  
                                                                                   
                                                       H (y) =                 yik
                                                                 kK      i k


Using result (I) of the theorem, the following is a multivariate EV distribution

                                                                                       1/
                                              F (u) = exp -                    e-uik                              (A.5)
                                                                 kK    i k




                                                                    59
and, choice probabilities are as follows, based on result (II) of the theorem,

                                                                                                      1/
                                                      1/       e-qik                       ik e-qik
          ik = -
                 qik
                     ln                      e-qik          =
                                                              ik e-qik
                                                                       ×                                   1/
                                                                                                                    (A.6)
                               kK     i k                                              k K i k     e-qik


      These changes of variables convert the formulation from EV type I to EV type II distribution:
qik = - ln( aik hik ) and ui,k =  ln(zi,k / ai,k ). Replacing these in (A.5) and (A.6) delivers the distribu-
tion function of z = {zi,k }i,k and choice probabilities:

                                                                                           1/
                                 F (z) = exp -                (zi,k /ai,k )-                                        (A.7)
                                                            kK     i k

                                                                                      1/
                                                      
                                                     hik             ak ik hik
                                   ik =                        ×                                                    (A.8)
                                                                                        1/
                                                            
                                                 ik hik            kK ik hik


C.4     Expected Value conditional on selection

C.4.1    One Nest

Reproducing equations (A.3) and (A.4),

                                                                                             K                  1

                                                                                             (zk /ak )-
                                                                                                                
             Pr(z1 ( )  z1 , ..., zK ( )  zK )  F (z1 , ..., zK ) = exp -
                                                                                            k =1


                                                              (hi ai )
                                                     i =    K
                                                            k =1 ( h k a k )
                                                                             


For notaional simplicity, and w.l.o.g. we focus on the choice of 1st alternative. Let  j = { : h j z j =
maxi hi zi }. Define
                                                                   
                                             F1 (z1 , ..., zK )        F (z1 , ..., zK )
                                                                    z1
which equals

                                                      K                   1                 K               1
                                                                           -1
                                                      (zk /ak )-                             (zk /ak )-
                                      --1
               F1 (z1 , ..., zK ) =  a1 z1
                                                                                                            
                                                                                exp -
                                                     k =1                                  k =1




                                                               60
The probability distribution of z1 ( ) conditional on selecting the 1st alternative,   1 ,


F1 (z)  Pr z1 ( )  z |   1
                 1
        =              Pr z1 ( )  z, h1 z1 ( )  h j z j ( )
            Pr(  1 )
             1                       h1
        =      Pr z1 ( )  z, z j ( )  z1 ( )
            1                        hj
                            h1        h1
            1       z       h2 z      hK   z
        =                                      f (z1 , z2 , ..., zK )dzK ...dz2 dz1
            1    z1 =0    z2 =0      z K =0
            1     z                 h1        h1
        =                F 1 ( z,      z, ..., z)dz1
            1    z1 =0              h2        hK
                    z                                       K                         1                            K                          1
            1                                      z -         h z                     -1                 z -         h z
                          a1 z--1 (                     +  ( 1 )-                                              +  ( 1 )-
                                                                                                                                              
        =                                             )                                     exp - (          )                                     dz1
            1    z1 =0                             a1          h a
                                                          k =2 k k
                                                                                                          a1          h a
                                                                                                                 k =2 k k
                    z                                K                 1                                   K                    1
            1                                              h1 a1 -      -1                                       h1 a1 -
                            -  -1
                                                    (                          exp - z- a1                (
                                                                                                                                
        =                 a1 z    1+                             )                         1+                          )            dz1
            1    z1 =0                              k =2
                                                           hk ak                                          k =2
                                                                                                                 hk ak
                    z                                         K                1                                          K               1
            1                                                                   -1
                            -  -1                        -
                                                              ( hk ak )                     - z -  a1                -
                                                                                                                          ( hk ak )
                                                                                                                                          
        =                 a1 z             ( h1 a1 )                                 exp                ( h1 a1 )                                 dz1
            1    z1 =0                                       k =1                                                        k =1
             z                                 1                               1
                       -  -1         1                                1
                                                   exp - z- a1
                                                                               
        =            a1 z                                                          dz1
            z1 =0                    1                                1

                                                                                            -1/
which is a Fréchet distribution with location parameter a1
                                                         
                                                           1                                        and dispersion parameter  . It is
straightforward to show that the expected value of a Fréchet distribution with location parameter
T and dispersion parameter  equals (1 - 1/ ) T 1/ . Putting together, the expected value of z1 ( )
conditional on   1 equals

                                                                                                    -1/
                                        E z1 ( )|   1 = (1 - 1/ ) a1 1


To make a closer connection to the notation we adopted in the main text, let 2  , and 1   .
Then,
                                                                                              K                      1

                                                                                              (zk / ak )       - 2   2
                        Pr(z1 ( )  z1 , ..., zK ( )  zK ) = exp -
                                                                                             k =1

And, the conditional expected value is given by

                                                                      -1/2
                                        E z1 ( )|   1 = (1 - 1/1 ) a1 1




                                                                          61
C.4.2     Two Nests

We first reproduce equations (A.7) and (A.6),

                                                                     K                               1             K                   1

                                                                      (z1k /a1k )-                                 (z2k /a2k )-
                                                                                                                                       
           F (z11 , ..., z1K , z21 , ..., z2K ) = exp -                                                   +
                                                                  k =1                                            k =1

                                                                                                                                       1
                       (hsk ask )       Hs 
                                                                                                                                       
               sk =                    + ... + H 
                                                  , where Hs = (hs1 as1 ) + ... + (hsK asK )
                          Hs
                                     H1         S

Here, for the sake of illustration, we are considering a choice structure with S = 2 alternatives in in
the upper nest and K sub-trees in the lower nests. For notational simplicity and w.o.l.g, we focus on
the choice of (s, k ) = (1, 1). Let F11 (z11 , ..., z1K , z21 , ..., z2K )                   
                                                                                             z11 F ( z11 , ..., z1K , z21 , ..., z2K ).    Then,

                                                 K                                 1
                                                                                    -1
                                                 (z1k /a1k )-
                                      --1
                     F11 =  a11 z11
                                                k =1
                                                     K                              1               K                         1

                                                      (z1k /a1k )-                                  (z2k /a2k )-
                                                                                                                              
                                 × exp -                                                 +
                                                  k =1                                             k =1


The probability distribution of z11 ( ) conditional on   11 ,


      F11 (z)  Pr z11 ( )  z |   11
                         1
                =                  Pr z11 ( )  z, hsk zsk ( )  h11 z11 ( )
                     Pr(  11 )
                      1                                  h11
                =       Pr z11 ( )  z, zsk ( )               z11 ( )
                     11                                  hsk
                      1   z            h11         h11 h11 h11             h11
                =              F11 (z,     z, ...,    z,     z,    z, ...,     z)dz11
                     11 z11 =0         h12         h1K h21 h22             h2K
                             z                                               K                                1
                     1                                                               h11 z -                   -1
                                     a11 z--1 (z/ a11 )- +                  (
                                     
                =                                                                             )
                     11    z11 =0                                           k =2
                                                                                    h 1k a 1k
                                                                 K                             1              K                    1
                                                                          h11 z -                                    h11 z -
                                         (z/ a11 )- +           (                                         (
                                                                                                                                   
                       × exp -                                                     )                +                         )            dz11
                                                                k =2
                                                                         h 1k a 1k                        k =1
                                                                                                                    h 2k a 2k
                             z                           K                              1
                     1                                   h11 a11 -                       -1
                =                      -  -1
                                     a11 z      1 + (           )
                     11    z11 =0                        h a
                                                    k =2 1k 1k
                                                          K                              1                          K                  1
                                                                 h11 a11                                                 h11 a11
                                        z- a11            ( h1k a1k )-                       + z- a11               ( h2k a2k )-
                                                                                                                                       
                       × exp -              
                                               1+                                                  
                                                                                                                                              dz11 ,
                                                         k =2                                                     k =1




                                                                       62
which can be further simplified to:


F11 (z)  Pr z11 ( )  z |   11
                       z                                     K                        1
             1                                                                         -1
         =
             11    z11 =0
                               -  -1
                             a11 z   (h11 a11 )-             (h1k a1k )
                                                            k =1
                                                             K                    1                       K                  1

                            - z- a11                    -
                                                             ( h 1k a 1k )                           -
                                                                                                          ( h 2k a 2k )
                                                                                                                             
               × exp              
                                           (h11 a11 )                        
                                                                                      + (h11 a11 )                        
                                                                                                                                 dz11
                                                            k =1                                         k =1
               z
                          -  -1
         =              a11 z   (h11 a11 )- ( H1
                                                    
                                                 + H2 )
              z11 =0


               × exp - z- a11
                           
                              (h11 a11 )- ( H1
                                                  
                                               + H2 )                      dz11


                                                         ( h a )- ( H  + H  ) and dispersion pa-
This is a Fréchet distribution with location parameter a11  11 11    1    2
rameter  . Note that probability of choosing (s, k) equals probability of choosing k conditional on s
times the probability of choosing s, sk = k|s s . The "inverse of location parameter" is


                            -    (h11 a11 )      - ( h11 a11 )
                                                                      1/     H1
                                                                                      - 1/
                           a11      + H
                                             = a 11                                = a11  1|1  1
                                 H1        2           H1
                                                                           H1 + H2
                                                                                 




      Similarly, the distribution of Pr z11 ( )  z |   11 is Fre´
                                                                chet, and its inverse of location
parameter is ( a- 1 1 / 2
                sk k |s s ) for 2 =  and 1 =  . Expected value of a Fréchet distributed random
variable with location parameter T and dispersion parameter  equals ¯ T 1/ with ¯  (1 - 1/ ).
Thus, here the expected value conditional on selection equals

                                                                   -1/1                           -1/2          -1/1
                                    - 1 1 / 2
              E(zsk ( )|  sk ) = ¯ ask k|s s                              =¯ ask            k|s           s



C.5     Derivations for recasting the micro to macro problem

In this section, we recast the land use problem onto crop supply. We show (i) that the following
problem reproduces equation (22), and (ii) the Lagrange multipliers reproduce returns to land. Using




                                                                 63
  f       L )h         f
Qi,k = (1/k  i,k  Li,k  , the problem of the landowner in Section 3.5 can be written as:


                                                                                      k
                                                                                      L                                        f
                                             f
                                                    max
                                                                   f
                                                                                         p i ,k Q i ,k 
                                         { Q i ,k  } k ,   ,   { Q i ,k } k      T k K
                                                                                                                                    2 -1
                                                                                                            f            2
                                                                                                    Q i ,k                          2

                                                                                       
                                                                                                                         2 -1                                f
                                              subject to                                              f
                                                                                                                                                    Q i ,k
                                                                                        T           v i ,k 
                                                                                                                               1 -1
                                                                                                                               1
                                                                                                                1

                                                                                        ( Q i ,k )
                                                                                                        f                                           f
                                                                                                                1 -1
                                                                                                                                        Li
                                                                                       k K


where

                                                                f                        fL -1
                                                           v i , k  = h i , k  a i , k  ( k ) .


The Lagrangian function is:

                                                                                                 2 -1                                                                           1 -1
                                                                            f   2
                                                                Q i ,k                           2
                                                                                                                                                                         1
                                                                                                                                                                                1

  L =   k                                                                                                                                                ( Q i ,k )
        L              f                 f                                      2 -1                                 f                     f                         f                    f
           p i ,k Q i ,k  -  i ,k                                                                           - Q i ,k               - µi                                                - Li
                                                                                                                                                                         1 -1
                                                                      f
           k                                                        v i ,k                                                                               k


Provided that the solution is interior, and quantities are all positive, the first order conditions require
that:

                                                                                                 2                             1                          1
                                   L                                        f   f       -                       f                              f    -
                                                                                                 2 -1   ( Q i , k  ) 2 -1 ( Q i , k )                    2 -1
                                   k  p i ,k =  i ,k ( v i ,k  )                                                                                                                               (A.9)
                                                                                         1                           1
                                               f                            f   f                       f -
                                              i , k = µ i ( Q i , k ) 1 -1 ( L i )                                  1 -1                                                                      (A.10)

                                     f      L ) -1 ,                f
Using equation (A.9), and vi,k = hi,k ai,k (k 

                              f                            f                                                                           f                             f
                           Q i , k  = (  i , k ) - (  2 - 1 ) ( k
                                                                L -1
                                                                   ) ( p i ,k )
                                                                                2 -1
                                                                                     ( a i ,k  h i ,k  ) 2 Q i ,k

or, equivalently,

                                     f
                                  Q i ,k                                f                                                  f                                     f
                                    f
                                                   = (  i ,k ) - ( 2 -1) ( p i ,k ) 2 -1 ( a i ,k  h i ,k  ) 2 -1 Q i ,k                                                                      (A.11)
                                  v i ,k 

                              f
Recall the definition of Hi,k from equation (19),

                                                                                                                                   1

                                                                                 ( a i ,k  p i ,k h i ,k  ) 
                                                                f                            f                                     2
                                                           Hi,k =                                                              2

                                                                                    




                                                                                         64
Using equation (A.11),

                                                 f               2       2 -1
                                           Q i ,k 
                                
                                                                 2 -1                                       f                        f       f
                                                                                             = (i,k )-(2 -1) Qi,k ( Hi,k )2 -1
                                                                         2
                                             f
                                           v i ,k 
                                                         f
                                                     Q i ,k


                                                                                 f                                                       f
which delivers the shadow price of crop k i,k precisely equal to Hi,k ,

                                                                                     f                f
                                                                             i,k = Hi,k                                                                           (A.12)


Using equation (A.10),

                                                             f               f                          f                   f
                                                     Q i ,k = (  i ,k ) 1 -1 ( µ i ) - ( 1 -1) L i                                                                (A.13)


which we use to derive the following relationship:

                                                                  1 -1                                                                       1 -1
                                                  1   

                                                                                                                       
                                        f                                            f               f                        f
                                                                                 ( µ i ) - ( 1 -1) L i
                                                                  1                                                                          1
                                    ( Q i , k ) 1 -1                     =                                                 (  i ,k ) 1
                                k                                                                                      k
                                             f
                                            Li


            f      f                                                                                                       f
Replacing i,k = Hi,k we find the shadow price of cropland, µi ,

                                                                                                                1

                                                                                         
                                                                   f                             f              1
                                                                  µi     =                   ( Hi,k )1                                                            (A.14)
                                                                                         k

       f
Plug µi from (A.14) into (A.13),

                                                                                                                                                 1 -1
                                                                                                 1 -1                            f
                                                                                             -                          ( Hi,k )1                1

                                                                  (  i ,k ) 
                       f               f                                 f                                  f                                             f
                    Q i ,k = (  i ,k ) 1 -1
                                                                                                 1
                                                                                     1
                                                                                                          Li =               f
                                                                                                                                                        Li
                                                                  k                                                    k ( Hi,k )1

Putting things together,

                                                                                                                2 -1                               1 -1
                                                                                     f                                               f
                    f             L -1 f
                                                                             ( a i ,k  h i ,k  ) 2              2
                                                                                                                               ( Hi,k )1           1
                                                                                                                                                              f
                  Q i ,k    =   ( k  ) a i ,k  h i ,k                                    f                                       f
                                                                                                                                                          Li
                                                                                     ( Hi,k )2                             k ( Hi,k )1

which is the same as equation (22).




                                                                                                 65
