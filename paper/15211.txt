                                NBER WORKING PAPER SERIES




     EVALUATING MARGINAL POLICY CHANGES AND THE AVERAGE EFFECT
             OF TREATMENT FOR INDIVIDUALS AT THE MARGIN

                                           Pedro Carneiro
                                         James J. Heckman
                                         Edward J. Vytlacil

                                        Working Paper 15211
                                http://www.nber.org/papers/w15211


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     August 2009




This research was supported by NIH R01-HD32058-3, NSF SES-0832845, NSF SES-024158, NSF
SES-05-51089, ESRC RES-000-22-2542, the Geary Institute at University College Dublin, the Leverhulme
Trust, and ESRC (NIH R01-HD054702) through the funding of the Centre for Microdata Methods
and Practice. The research was conducted in part while Edward Vytlacil was a Visiting Professor at
Hitotsubashi University. We thank the editor, two anonymous referees, Hidehiko Ichimura, Richard
Robb, Daniel Schmierer, and Azeem Shaikh for very helpful comments. We would like to thank Erica
Blom and Sukjin Han for research assistance. The views expressed herein are those of the author(s)
and do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2009 by Pedro Carneiro, James J. Heckman, and Edward J. Vytlacil. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
Evaluating Marginal Policy Changes and the Average Effect of Treatment for Individuals
at the Margin
Pedro Carneiro, James J. Heckman, and Edward J. Vytlacil
NBER Working Paper No. 15211
July 2009
JEL No. C14

                                            ABSTRACT

This paper develops methods for evaluating marginal policy changes. We characterize how the effects
of marginal policy changes depend on the direction of the policy change, and show that marginal policy
effects are fundamentally easier to identify and to estimate than conventional treatment parameters.
We develop the connection between marginal policy effects and the average effect of treatment for
persons on the margin of indifference between participation in treatment and nonparticipation, and
use this connection to analyze both parameters. We apply our analysis to estimate the effect of marginal
changes in tuition on the return to going to college.


Pedro Carneiro                                     Edward J. Vytlacil
Department of Economics                            Department of Economics
University College                                 Yale University
Gower Street                                       Box 208281
London WC1E 6BT                                    New Haven, CT 06520-8281
United Kingdom                                     and NBER
p.carneiro@ucl.ac.uk                               edward.vytlacil@yale.edu

James J. Heckman
Department of Economics
The University of Chicago
1126 E. 59th Street
Chicago, IL 60637
and NBER
jjh@uchicago.edu
1     Introduction

The Policy Relevant Treatment Effect (PRTE) is the mean effect of changing from a baseline policy
to an alternative policy that provides different incentives to participate in treatment (Heckman and
Vytlacil, 2001b, 2005). Identification and estimation of the PRTE is generally difficult. Identifi-
                                                                √
cation of the PRTE typically requires large support conditions. N -consistent estimation of the
PRTE parameter is generally not possible.
    In many cases proposed policy reforms are incremental in nature and a marginal version of the
PRTE (MPRTE) is all that is required to answer questions of economic interest. This paper develops
the MPRTE and establishes how the MPRTE depends on the direction of a proposed marginal policy
change. We establish that the support conditions required for identifying the MPRTE are very weak.
The essential requirement is availability of a continuous instrument. The MPRTE parameter can
be represented as a weighted average derivative with weights determined by the marginal policy of
                          √
interest. The parameter is N -estimable under standard regularity conditions. Thus, the MPRTE
parameter is fundamentally easier to identify and estimate than the PRTE parameter.
    We connect the MPRTE to the Average Marginal Treatment Effect (AMTE): the mean ben-
efit of treatment for people at the margin of indifference between participation in treatment and
nonparticipation. AMTE is compared to marginal cost in an aggregate benefit-cost analysis of
a program. We establish a correspondence between MPRTE parameters and AMTE parameters,
showing that the effect of a marginal policy change in a particular direction is the same as the
average effect of treatment for those at the margin of indifference. We use this correspondence to
produce new insights about the AMTE parameter.
    The paper proceeds as follows. Section 2 presents the nonparametric selection model that
underlies our analysis. Section 3 reviews the analysis of the PRTE by Heckman and Vytlacil (2005)
and presents a new interpretation of the PRTE as a function from the space of all possible policies to
the space of effects of policies. This interpretation is key to the analysis in Section 4 which introduces
and analyzes the marginal policy relevant treatment effect (MPRTE). We discuss identification and
estimation of the MPRTE in Sections 5 and 6, respectively. We define and analyze the AMTE in
Section 7. Section 8 presents an empirical application of our analysis. Section 9 concludes.


                                                    1
2     Nonparametric Selection Model and Our Assumptions

Assume that there are two potential outcomes (Y0 , Y1 ) and a binary treatment choice indicator D.
Outcome Y is written in switching regression form Y = DY1 + (1 − D) Y0 , where Y1 is the potential
outcome that is observed if the agent chooses treatment 1, and Y0 is the potential outcome that
is observed if the agent chooses treatment 0. Y1 − Y0 is the individual level treatment effect. We
keep implicit the conditioning on observed variables X that determine Y1 or Y0 , and maintain the
assumption that D does not determine X (see Heckman and Vytlacil, 2005).
    Program participation is voluntary. To link this framework to standard choice models, we
characterize the decision rule for program participation by a latent index model:


                                            D = 1[µ(Z) − V ≥ 0]                               (2.1)


where 1[·] is the indicator function taking the value 1 if its argument is true and the value 0
otherwise. From the point of view of the econometrician, Z is observed and V is unobserved.
    We maintain the following assumptions:

(A-1) (Y0 , Y1 , V ) is independent of Z;

(A-2) The distribution of V is absolutely continuous with respect to Lebesgue measure;

(A-3) The distribution of µD (Z) is absolutely continuous with respect to Lebesgue measure;

                                                                 
(A-4) supv E     |Y1 |   V = v < ∞, supv E       |Y0 |       V = v < ∞;

(A-5) 0 < Pr(D = 1) < 1.

    These conditions are discussed in Heckman and Vytlacil (2005, 2007). Under them, Vytlacil
(2002) establishes the equivalence between the nonparametric latent index model (2.1) and the
monotonicity assumption used by Imbens and Angrist (1994). A necessary condition for (A-3)
is that Z contains a continuous variable (i.e., that there is a continuous instrument for D). We
use this assumption to analyze marginal policy changes, and to identify marginal policy treatment
effects. These conditions should be interpreted as conditional on X, which we have kept implicit.


                                                         2
For example, (A-1) should be interpreted as saying that (Y0 , Y1 , V ) is independent of Z conditional
on X, while there can be dependence between (Y0 , Y1 , V ) and X.
    Define P (Z) as the probability of receiving treatment given Z, P (Z) ≡ Pr(D = 1 | Z) =
FV (µ(Z)) where FV (·) is the distribution function of V . We sometimes denote P (Z) by P , sup-
pressing the Z argument. We also use U , defined by U = FV (V ) so that U is distributed unit
uniform. In this notation, applying a monotonic transformation to both sides of the argument in
equation (2.1) allows us to write that equation as D = 1[P (Z) ≥ U ].
    The marginal treatment effect (MTE) plays a fundamental role in our analysis. MTE is defined as
MTE(u) ≡ E(Y1 − Y0 | U = u), i.e., the expected treatment effect conditional on the unobservables
which determine participation. For values of u close to zero, MTE(u) is the expected effect of
treatment on individuals who have unobservables that make them most likely to participate in
treatment and who would participate even if the mean scale utility µ (Z) is small. See Heckman
and Vytlacil (2005, 2007) for more discussion and interpretation of the MTE.
    In some of our examples, we consider the following special case of our general model:

(B-1) Suppose µ(Z) = Zγ and suppose that FV is strictly increasing. Suppose that the kth compo-
nent of Z, Z [k] , has a strictly positive coefficient, γ [k] > 0. Let Z̃ γ̃ = Zγ − Z [k] γ [k] . Suppose that
the distribution of Z [k] γ [k] conditional on Z̃ γ̃ has a density with respect to Lebesgue measure.



3     The Policy Relevant Treatment Effect

We first present the Policy Relevant Treatment Effect (PRTE) of Heckman and Vytlacil (2001b,
2005) in order to motivate our marginal version of it. We then reformulate the PRTE as a function
of the proposed policy change. This enables us to define a sequence of PRTEs corresponding to a
sequence of proposed policy changes.


3.1     Review of PRTE

Following Heckman and Vytlacil (2001b, 2005), consider a class of policies that affect P , the prob-
ability of participation in a program, but that do not affect potential outcomes or unobservables


                                                      3
related to the selection process, (Y1 , Y0 , U ).1 An example from the literature on the economic returns
to schooling would be policies that change tuition or distance to school but that do not directly
affect potential wages (Card, 2001). We ignore general equilibrium effects.
       Let D∗ be the treatment choice that would be made after the policy change. Let P ∗ be the
corresponding probability that D∗ = 1 after the policy change. D∗ is defined by D∗ = 1[P ∗ ≥ U ].
Let Y ∗ = D∗ Y1 + (1 − D∗ )Y0 be the outcome under the alternative policy. Following Heckman and
Vytlacil (2005), the mean effect of going from a baseline policy to an alternative policy per net
person shifted is the Policy Relevant Treatment Effect (PRTE), defined when E(D) 6= E(D∗ ) as


  E(Y | Alternative Policy) − E(Y | Baseline Policy)
  E(D | Alternative Policy) − E(D | Baseline Policy)
                                                                  Z 1
                                                E(Y ∗ ) − E(Y )
                                             =                  =     MTE(u) ωPRTE (u)du (3.1)
                                                E(D∗ ) − E(D)      0



where
                                                         FP (u) − FP ∗ (u)
                                        ωPRTE (u) =                           .                                     (3.2)
                                                        EFP ∗ (P ) − EFP (P )

The condition E(D) 6= E(D∗ ) is consistent with the program having a non-monotonic effect on
participation as long as the fraction switching into treatment is not exactly offset by the fraction
switching out of treatment. The PRTE parameter gives the normalized effect of a change from a
baseline policy to an alternative policy and depends on the alternative being considered.2 Heckman
and Vytlacil (2005) show that the PRTE can be identified under strong support conditions. In
Section 5, we establish that the marginal version of the PRTE parameter can be identified under
much weaker conditions than are required to identify the PRTE. In Section 6, we establish that,
                                                                             √
unlike the PRTE parameter, the MPRTE parameter is generally estimable at a N rate.
       We define PRTE as the average effect per net person shifted into treatment. With this defi-
nition, no normalization is required when taking limits to define the MPRTE, and we obtain an
equivalence between the MPRTE and the average effect for individuals at the margin of indifference
   1
     This restriction can be relaxed to a weaker policy invariance for the distribution of (Y1 , Y0 , U ), see Heckman and
Vytlacil (2005, 2007).
   2
     The PRTE can be interpreted as an economically more explicit version of Stock’s (1989) nonparametric policy
analysis parameter for a class of policy interventions with explicit agent preferences where the policies evaluated
operate solely on agent choice sets.



                                                            4
(AMTE). Under this definition, the MPRTE corresponds to a weighted average derivative and can
be estimated by a weighted average derivative estimator.
   Alternatively, we could follow Heckman and Vytlacil (2001b) in defining PRTE without nor-
malizing it by the net change in treatment status, i.e., we could define PRTE as E(Y ∗ ) − E(Y ).
However, some normalization is required when taking limits. If we were to define PRTE in that
manner, and then normalize by E(D∗ ) − E(D) when taking limits, we would obtain the same limits
as would be obtained from analyzing the marginal version of PRTE defined by equation (3.1). Using
the unnormalized version of PRTE, we can analyze alternative normalizations when taking limits.
In footnote 3 below, we discuss one such normalization which results in an alternative version of
MPRTE that is a rescaled version of the marginal version of PRTE defined by equation (3.1).


3.2     PRTE as a Function of Proposed Policy Changes

The PRTE depends on a policy change only through the distribution of P ∗ after the policy change.
Given our assumptions, FP ∗ is sufficient to summarize everything about the proposed policy change
that is relevant for calculating the average effect of the policy change. We can thus define the PRTE
function as a function mapping the proposed policy change (corresponding to a distribution of P ∗ )
to the resulting per-person change in outcomes. Expressing the PRTE this way is important in the
next step of our analysis that uses sequences of PRTEs to define a marginal version of the PRTE.
   Let G denote the space of all cumulative distribution functions for random variables that lie in
                           R         R
the unit interval such that tdG(t) 6= tdFP (t) i.e., all right-continuous, non-decreasing functions
satisfying G(t) = 1 for t ≥ 1, G(t) = 0 for t < 0, and such that the first moment of G does not
equal the first moment of FP . Any G ∈ G corresponds to a potential distribution of P ∗ and thus
corresponds to a potential alternative policy, with PRTE(G) denoting the corresponding policy
effect. We define the PRTE function, PRTE : G 7→ R, by

                                          Z     1
                             PRTE(G) =              MTE(u)ωPRTE (u; G) du                       (3.3)
                                            0



where
                                                      FP (u) − G(u)
                                 ωPRTE (u, G) =                         .                       (3.4)
                                                     EG (P ) − EFP (P )

                                                      5
    In many cases, the class of policy alternatives under consideration can be indexed by a scalar
variable. Let P0 = P denote the baseline probability for D = 1. Let M denote a subset of R with
0 ∈ M. Let {Pα : α ∈ M} denote a class of alternative probabilities corresponding to alternative
policy regimes with associated cumulative distribution functions Fα . For example, one alternative
policy could increase the probability of attending college by an amount α, so that Pα = P0 + α and
Fα (t) = F0 (t − α). An alternative policy could change each person’s probability of attending college
                                                                     t
by the proportion (1 + α), so that Pα = (1 + α)P0 and Fα (t) = F0 ( 1+α ). The policy intervention
might have an effect similar to a shift in one of the components of Z, say Z [k] . In particular,
           [k]                    [j]
suppose Zα = Z [k] + α and Zα = Z [j] for j 6= k. For example, the kth element of Z might be
college tuition, and the policy under consideration subsidizes college tuition by the fixed amount
α. Suppose that the linear latent index assumption (B-1) holds. Then Pα (Z) = FV (Zγ + αγ [k] )
and Fα (t) = FZγ (FV−1 (t) − αγ [k] ). Notice that the first two examples have the form Pα = qα (P0 ) for
some function qα , while the last example has the form Pα = FV (Z [−k] γ −[k] + qα (Z [k] )γ [k] ). We will
explore more general examples in the next section.



4     Marginal Policy Changes

The PRTE is defined for a discrete change from a baseline policy to a fixed alternative. We now
consider a marginal version of the PRTE parameter that corresponds to a marginal change from
a baseline policy. It is expositionally convenient to think of the treatment as college attendance
and the policy as a change in tuition. The marginal version of the PRTE depends on the nature
of the perturbation that defines the marginal change. For example, a policy change that subsidizes
tuition by a fixed amount has different effects than a policy change that subsidizes tuition by a
fixed proportion. The limits of these two policies for infinitesimally small subsidies are different.
    To define the marginal version of the PRTE, we could consider the limit of ∆PRTE (G) as G gets
close to FP in some metric. We could define the marginal PRTE as a directional derivative. For
ease of exposition, we do not work with this more general formulation but instead work with a
one-dimensional version of it. Thus we do not analyze general perturbations within the function
space G but only one-dimensional curves within G.


                                                    6
       Consider a class of alternative policies indexed by α, {Fα : α ∈ M}, where 0 is a limit point of
M, and 0 represents the baseline policy so that F0 = FP . Consider the effect of a marginal change
in α in a neighborhood of the current base policy of α = 0. When the limit exists, we can define
the marginal policy relevant treatment effect as


                                       MPRTE({Fα }) = lim PRTE(Fτ ),
                                                                  τ →0



where the MPRTE parameter depends on the class of alternative policies {Fα : α ∈ M}, i.e., on
the choice of a particular curve within G. Thus, the MPRTE can be seen as a path-derivative along
the path {Fα : α ∈ M}. We impose the following sufficient conditions for the limit to exist:

(A-6) For α in a neighborhood of 0, Fα has a density fα with respect to Lebesgue measure, fα is
                                   ∂
                                                     R1 ∂
differentiable in α, supt∈(0,1) | ∂α fα (t)| < ∞, and 0 t ∂α fα (t)dt 6= 0.

Under assumptions (A-1)-(A-6), MPRTE({Fα }) = limτ →0 PRTE(Fτ ) exists and is given by

                                                  Z     1
                           MPRTE({Fα }) =                   MTE(u) ωMPRTE (u; {Fα }) du,                                (4.1)
                                                    0



where ωMPRTE (u; {Fα }) is

                                                                                Ru
                                                      ∂
                                                        F (u)
                                                     ∂α 0
                                                                                   ( ∂ f (p))dp
                                                                                 0 ∂α 0
                          ωMPRTE (u; {Fα }) =      − ∂                   =   −R 1      ∂
                                                                                                   ,                    (4.2)
                                                       E (P )
                                                    ∂α F0                      0
                                                                                  p ( ∂α f0 (p))dp

                     ∂                ∂                                                     ∂                    ∂
where we write         F (p)
                    ∂α 0
                               and      f (p)
                                     ∂α 0
                                                as shorthand expressions for                  F (p)|α=0
                                                                                           ∂α α
                                                                                                          and      f (p)|α=0 ,
                                                                                                                ∂α α

respectively. An alternative way to express the form of the weights uses the property that 0 ≤ Pα ≤ 1
                 R1
so that E(Pα ) = 0 (1 − Fα (t))dt to obtain

                                                                       ∂
                                                                         F (u)
                                                                      ∂α 0
                                      ωMPRTE (u; {Fα }) =          R1 ∂         ,                                       (4.3)
                                                                     ( F (t))dt
                                                                    0 ∂α 0


which makes it clear that the weights always integrate to unity.3
   3
    An alternative way to define MPRTE that does not require the condition E(D) 6= E(D∗ ) normalizes by α instead
                            R1
of E(D) − E(D∗ ): limα→0 0 M T E(u) [Fα (u)−Fα
                                               0 (u)]
                                                      du. With this definition the corresponding weights on MTE are
                               ∂
given by ωMPRTE (u; {Fα }) = ∂α F0 (u). This change in the normalization only affects the constant of integration for
the weights, and results in an alternative MPRTE that is a rescaled version of the MPRTE analyzed in this paper.


                                                              7
   Just as the PRTE parameter depends on which particular policy counterfactual is being consid-
ered, the marginal PRTE parameter depends on which particular class of policy perturbations is
being considered. Just as the effect of a fixed dollar amount tuition subsidy will result in a different
PRTE parameter than a proportional tuition subsidy, the limit parameter for a marginal change
in an additive tuition subsidy will be different from the limit parameter for a marginal change in a
proportional tuition subsidy. Of particular interest to us are the following two cases for which we
will define classes of functions. Let Q denote the set of sequences of functions {qα (·) : α ∈ M} such
that qα (t) is strictly increasing in t for any α ∈ M; such that q0 (·) is the identity function; such
                                              ∂
that qα (t) is differentiable in α with         q (t)
                                             ∂α α
                                                        bounded; such that rα is a bounded function where
                                                                                                 ∂
rα denotes the inverse of qα ; and such that rα is differentiable in α with                        r (t)
                                                                                                ∂α α
                                                                                                           bounded. The
following examples can be trivially modified to allow qα to be monotonically decreasing.

(Ex-1) Suppose that the alternative sequence of policies have the form Pα = qα (P0 ) for some
{qα } ∈ Q. Then Fα (t) = FP (rα (t)), and

                                                           ∂                      ∂
                                                   fP (u) ∂α r0 (u)      fP (u) ∂α   r0 (u)
                      ωMPRTE (u; {Fα }) = −              ∂
                                                                    = R1           ∂
                                                                                               .                     (4.4)
                                                   EP ( ∂α q0 (P ))    0
                                                                          f P (t) ∂α
                                                                                     r 0 (t)dt

(Ex-2) Suppose that the alternative sequence of policies shifts the kth component of Z, Z [k] , to
qα (Z [k] ) for some {qα } ∈ Q. Suppose that Assumption (B-1) holds. Then

                                                                 FV−1 (t) − s
                                         Z
                              Fα (t) =       FZ [k] |Z̃ γ̃ [rα (              )]fZ̃ γ̃ (s)ds,
                                                                     γ [k]

and
                                                              F −1 (u)−Z̃ γ̃ ∂      F −1 (u)−Z̃ γ̃
                                               h                                                   i
                                        EZ̃ γ̃ fZ [k] |Z̃ γ̃ [ V γ [k] ] ∂α     r0 ( V γ [k] )
                 ωMPRTE (u; {Fα }) = R                                                             i .               (4.5)
                                                               FV−1 (t)−Z̃ γ̃ ∂     FV−1 (t)−Z̃ γ̃
                                                h
                                       1
                                      0
                                         EZ̃ γ̃ fZ [k] |Z̃ γ̃ [ γ [k] ] ∂α r0 ( γ [k] ) dt

   The expressions in equations (4.4) and (4.5) look different, but both can be represented as
weighted densities
                                 ωMPRTE (u; {Fα }) = fP (u)h(u)/E(h(P ))                                             (4.6)

                                                                                                    ∂
for some function h(·). For (Ex-1), this form is immediate, substituting h(u) =                       r (u).
                                                                                                   ∂α 0
                                                                                                               For (Ex-2),



                                                            8
note that, for ωMPRTE (u; {Fα }) given by equation (4.5),

                                                                              FV−1 (u) − s
                                                      Z                                   
                   ωMPRTE (u; {Fα }) 6= 0 ⇒               fZ [k] |Z̃ γ̃                      fZ̃ γ̃ (s)ds 6= 0
                                                                                  γ [k]
                                                ⇔ fZγ (FV−1 (u)) 6= 0

                                                ⇔ fP (u)fV (FV−1 (u)) 6= 0

                                                ⇒ fP (u) 6= 0 ,


where we use the fact that Pr[P (Z) ≤ u] = Pr[Zγ ≤ FV−1 (u)] and the chain rule to obtain fP (u) =
fZγ (FV−1 (u))
           Thus, the weights for (Ex-2) are of the form ωMPRTE (u; {Fα }) = fP (u)h(u)/C for some
fV (FV−1 (u))
               .
                                                                                 R
function h and some constant C. The weights integrate to one, because C = fP (u)h(u)du =
E(h(P )). Thus the weights for both (Ex-1) and (Ex-2) are of the form (4.6). This expression plays
an important role when we consider identification and estimation of the MPRTE.
    Special cases include qα (t) = t + α and qα (t) = (1 + α)t, for policy changes that act like
constant shifts or proportional shifts either in P or in a component of Z. For example 1, if qα (t) =
t + α then ωMPRTE (u; {Fα }) = fP (u), so that the MPRTE weights MTE according to the density
of P (Z). In contrast, if qα (t) = (1 + α)t, then ωMPRTE (u; {Fα }) = ufP (u)/E(P ). Thus, for
example, the limit form associated with increasing the probability of college attendance by a fixed
amount and the limit form associated with increasing the probability of college attendance by a
proportional amount produce different weights on MTE. The limit of the latter puts higher weight
on MTE for higher u evaluation points, i.e., puts higher weight on MTE for individuals whose
unobservables make them less likely to go to college. For example 2, setting qα (t) = t + α results
                         fZγ (FV−1 (u))       fP (u)fV (FV−1 (u))
in ωMPRTE (u; {Fα }) =    E(fV (Zγ))
                                          =       E(fV (Zγ))
                                                                  ,   which again will weight the MTE and thus
weight people with different unobserved preferences for treatment differently from the way MTE is
weighted in the other examples.




                                                             9
5       Identification

Equations (3.3)-(3.4) and (4.1)-(4.2) show that both the PRTE and MPRTE treatment parameters
can be expressed in the form

                                                             Z   1
                           Treatment Parameter (j) =                 MTE (u) ωj (u) du,                      (5.1)
                                                             0



where ωj (u) is the weighting function corresponding to treatment parameter j, and where ωj will
depend on which policy change/marginal policy change is being considered. Heckman and Vytlacil
(1999, 2005) show that, under our assumptions, the standard treatment parameters can also be
expressed in this form and that the form can be used for identification. In particular, the weights
are often easy to identify, in which case equation (5.1) implies identification of the parameter if
we can identify the MTE at any evaluation point for which the weights are non-zero. Under our
assumptions, Heckman and Vytlacil (1999, 2005) show that the MTE can be identified by the
method of local instrumental variables (LIV) at any p in the support of P (Z):

                                      ∂
                                         E(Y |P (Z) = p) = MTE (p) .4                                        (5.2)
                                      ∂p

 Any parameter that can be represented as a weighted average of MTE can be identified by first
estimating MTE over the appropriate support and then integrating the identified MTE function
using the appropriate weights. In order to identify parameter j, not only does P (Z) have to be a
continuous random variable, but in addition the support of P (Z) must contain all values of u such
that ωj (u) 6= 0. For the standard treatment parameters, identification requires strong conditions on
the support of the distribution of P (Z). For example, for the average treatment effect, E(Y1 − Y0 ),
the weights are given by ωAT E (u) = 1 for u ∈ [0, 1] so that the required support condition is that the
support of P (Z) is the full unit interval. It is possible to point-identify the parameters under only
slightly weaker conditions than those required by this strategy, as shown in Heckman and Vytlacil
    4
    LIV can be interpreted as the limit form of the Imbens and Angrist (1994) LATE parameter (see Heckman and
Vytlacil, 1999). The ideas of the marginal treatment effect and the limit form of LATE were first introduced in the
context of a parametric normal generalized Roy model by Björklund and Moffitt (1987), and were analyzed more
generally in Heckman (1997). Angrist, Graddy, and Imbens (2000) also define and develop a limit form of LATE.




                                                        10
(2001a, 2007).
       Consider identification of PRTE. Suppose that we can identify FP ∗ and thus the weights. In
order to identify the parameter using the strategy just discussed, the support of P (Z) must contain
all values of u such that FP (u) − FP ∗ (u) 6= 0. Thus, if the support of P ∗ is not contained in the
support of P , it is not possible to identify the PRTE.
       For example, suppose that the largest estimated probability of attending college is strictly less
than 1. For analyzing a tuition subsidy policy, it is possible that the largest probability of attending
college under a tuition subsidy will be greater than the largest probability of attending college
without a tuition subsidy so that the support condition for identifying the corresponding PRTE
parameter is violated. More generally, in examples (Ex-1) and (Ex-2) in Section 4, the PRTE
parameters will not be identified unless the support of P is the full unit interval. Thus, the very
strong support conditions required for identification of the standard treatment parameters are also
required for identification of the PRTE parameter.
       In contrast, the MPRTE parameter can generally be identified under weaker assumptions. The
MPRTE weights are non-zero only if the density of P (Z) is nonzero. Consider the classes of
MPRTE parameters produced from examples (Ex-1) and (Ex-2). For policy counterfactuals that
act like transformations of P (Z) as in (Ex-1), or act like transformations of Z as in (Ex-2), we
have from equation (4.6) that ωMPRTE (u; {Fα }) 6= 0 ⇒ fP (u) 6= 0, so that the MPRTE parameters
of (Ex-1) and (Ex-2) can be identified without any additional support conditions even though the
corresponding PRTE parameters cannot be identified for any α. In these examples, the marginal
PRTE parameters place positive weight on MTE(u) for values of u where the density of P is positive,
i.e., they only place positive weight on MTE(u) for values of u where we can use local instrumental
variables to point identify MTE(u). Thus, even though in each example the PRTE is not identified
for any value of α 6= 0 without large support assumptions, the marginal PRTE is identified using the
assumption that P is a continuous random variable. The MPRTE parameter is thus fundamentally
easier to identify than either the conventional treatment parameters or the PRTE parameters.5
   5
    As is clear from our analysis, Assumption (A-4) can be relaxed to only require that E(|Y1 | | V = v) and
E(|Y0 | | V = v) are bounded for v contained in any arbitrarily small enlargement of the support of FV−1 (P (Z)).




                                                       11
6     Issues in Estimation

In addition to the support requirement, an additional difficulty in estimating the standard treatment
                                                          √
parameters is that under our assumptions they are not N -estimable. Suppose that P is known.
Using equations (5.1) and (5.2), we obtain

                                          Z
                                              ∂
           Treatment Parameter (j) =             E(Y |P (Z) = p) ωj (p) dp = E(g 0 (P )qj (P )),   (6.1)
                                              ∂p

where g 0 (p) =   ∂
                  ∂p
                     E(Y   | P (Z) = p) and qj (p) = ωj (p) /fP (p), and we assume that wj (p) 6= 0 ⇒
fP (p) 6= 0 as is required for identification. A critical requirement for weighted average derivative
                   √
estimators to be N -consistent is that qj (p)fP (p) vanish on the boundary of the support of P (see
Newey and Stoker, 1993). Requiring that qj (p)fP (p) = 0 on the boundaries of the support of P (Z)
is equivalent to requiring that ωj (p) = 0 at the boundaries of the support of P . This requirement
is not satisfied by conventional treatment parameters. For example, the average treatment effect
imposes the requirement that ωATE (p) = 1 ∀ p ∈ [0, 1], so that ωAT E (p) 6= 0 at the boundaries of
                                           √
the support and E(g 0 (P )qATE (P )) is not N -estimable under our assumptions. A parallel analysis
applies to the PRTE parameters. From equation (3.4), ωP RT E (p; G) = 0 at the boundaries of the
support of P only if FP (t) − G(t) = 0 at the boundaries of the support of P . This requires equality
                                                                                                √
of the supremum of the supports of the two distributions, so that a necessary condition for N -
consistent estimation of the PRTE is that the policy counterfactual does not increase or decrease
the largest value of the probability of participation.
                                                √
   In contrast, the MPRTE parameters are N -estimable under standard regularity conditions.
Consider examples of the form of (Ex-1), policy changes that act like transformations of the P , or
examples of the form of (Ex-2), policy changes that act like transformations of Z. From equation
(4.6), ωM P RT E (·; {Fα }) 6= 0 only if fP (·) 6= 0, and so we again have that the weights will equal
zero on the boundaries of the support of P (Z) if fP goes to zero on the boundary of the support.
In each of these cases, the marginal PRTE parameter is given by a weighted average derivative,
E(g 0 (P )q(P )) with weights such that qj (p)fP (p) equals zero on the boundary of the support of P if
                                                                                         √
fP (p) = 0 on the boundary of the support of P . Thus, each of these parameters is N -estimable



                                                    12
under appropriate regularity conditions (see Newey and Stoker, 1993).
    Our discussion thus far ignores three issues. First, in general P (Z) is not known but must be
estimated. Second, the weights sometimes need to be estimated. Third, we have not analyzed how
to deal with observed regressors X that enter the outcome equations for Y0 and Y1 . If X contains
only discrete elements, then the estimation theory just presented is still valid conditional on X.
If X contains continuous elements, then we may instead work with marginal PRTE parameters
                                             √
averaged over the distribution of X to obtain N -estimates. One example of an estimator of the
weighted average derivative that applies to our problem is the sieve minimum distance estimator of
Ai and Chen (2007). We next consider identification and estimation of average marginal treatment
effects.



7     The Average Marginal Treatment Effect

We now relate the MPRTE parameter to the Average Marginal Treatment Effect (AMTE), the
average effect of treatment for the marginal person who is indifferent between participation and
nonparticipation. More precisely, for a given choice of how to measure the distance between P and
U , and thus for a given choice of how to measure how close an individual is to being indifferent
between treatment or not, we define the AMTE as the average effect of treatment for those who
are arbitrarily close to being indifferent between treatment or not. While the MPRTE depends
on the direction of the marginal policy change, the AMTE parameter depends on the metric by
which one measures how close individuals are to being indifferent. We show an equivalence between
the MPRTE and AMTE parameters. Choosing a particular distance measure for the AMTE is
equivalent to examining a particular policy direction for the MPRTE. The effect of a marginal
policy change in a particular direction is equal to the average effect of treatment for those at the
margin of indifference in the precise sense that a marginal policy change in that direction would
change their treatment participation decision.
    Consider the average effect of treatment for those who are close to being indifferent between




                                                 13
treatment or not. For any metric m(·, ·), we have

                                                        1
                                                                        Pr[m(P, u) ≤ ]
                                                   Z
                  E(Y1 − Y0 |m(P, U ) ≤ ) =                MTE(u)                       du .
                                                    0                   Pr[m(P, U ) ≤ ]

Suppose the metric m(·, ·) is such that, for some strictly monotonic and differentiable function q,
m(P, U ) = |q(P ) − q(U )|. Let r denote the inverse of q. Then, under the regularity conditions
that allow us to interchange limits and integration, the average effect for those arbitrarily close to
indifference between treatment or not is

                                                            Z   1
                     lim E(Y1 − Y0 |m(P, U ) ≤ ) =                 MTE(u)ωAM T E (u) du ,
                     →0                                    0



where
                                              fP (u)r0 (u)     fP (u)r0 (u)
                            ωAM T E (u) = R                  =              .                    (7.1)
                                              fP (u)r0 (u)du    E(r0 (P ))

The form of the weights depends on the choice of a metric. Choosing different ways to measure the
distance between P and U , and thus different ways of measuring how close individuals are to being
indifferent between treatment or not, produces different weighting functions. For any choice of q, the
weights will be positive, will integrate to unity, and will only be non-zero where the density of P is
non-zero, but otherwise the weights can be shifted around arbitrarily by picking alternative metrics.
One might think that there is a natural way to pick a particular metric. Taking m(P, U ) = |P − U |
seems more natural than taking m(P, U ) = |q P − q U | for general q(·) including FV−1 (·). However,
under assumption (B-1), it is not any more natural to pick m(P, U ) = |P − U | than it is to pick
m(P, U ) = |FV−1 (P ) − FV−1 (U )| = |Zγ − V |. Yet, the two choices of metrics give different limit
results.
   Ambiguity over which metric to use for the AMTE can be resolved by connecting the AMTE
to the marginal PRTE. The connection is natural. Marginal policy changes only affect people who
are indifferent between treatment or not. Thus there is a close connection between the two types
of parameters. An arbitrary choice of a metric to define AMTE lacks an economic motivation.
The choice of which marginal policy to study to define the AMTE is well motivated. Comparing
equations (4.6) and (7.1), we see a duality between MPRTE parameters and alternative definitions


                                                   14
of the AMTE. For example, note that AMTE taking q to be the identity function is exactly the
MPRTE expression for policy alternatives of the form Pα = P + α. If (B-1) holds, then AMTE
taking q(·) = FV−1 (·) is exactly the MPRTE expression for policy alternatives of the form of changing
one component of Z by α. Different policy alternatives define different AMTE parameters.
        Consider an analysis of college attendance. Each marginal PRTE parameter defines a different
set of “marginal people” who are indifferent between college participation or not and who would
change their college participation in response to a marginal change in the policy. Notice that any
inframarginal individual with µ(Z) > V will not be affected by any marginal policy change. Only
individuals with µ(Z) = V will be affected by a marginal change in the policy. Each marginal PRTE
parameter will correspond to a different valid definition of the average marginal treatment effect.
The average effect of college attendance on those who are on the margin defined by an infinitesimal
level shift in college tuition is different from the average effect of college attendance on those who
are on the margin defined by an infinitesimal proportional shift in college tuition.
        Since each average marginal treatment effect can be equated with a marginal PRTE parameter,
we can use the analysis of Section 4 to define the AMTE so that it can be identified without large
                                                       √
support assumptions. In addition, the parameter will be N -estimable under appropriate regularity
conditions. Thus, under our assumptions, the AMTE parameter is fundamentally easier to identify
and to estimate than are the conventional treatment parameters.



8         Applying the Analysis to Data

Following Carneiro, Heckman, and Vytlacil (2006), we estimate the MTE for a sample of white
males from the NLSY.6 Using this sample, we also estimate the weights needed to construct the
MPRTE parameters corresponding to policy perturbations in alternative directions. We group
individuals in two groups: persons with a high school education or below who do not go to college
(D = 0) and persons with some college or above (D = 1). The outcome variable is the log of the
average of non-missing values of the hourly wage between 1989 and 1993, which we interpret as an
estimate of the log hourly wage in 1991. We estimate the selection probability P (Z) using a logit.
    6
        See the Web Appendix A at http://jenni.uchicago.edu/evaluating_marginal_policy/.



                                                    15
We assume that Y1 = Xβ1 + U1 , Y0 = Xβ0 + U0 , and that U1 and U0 are independent of X, so that
the marginal treatment effect is given by M T E(x, u) = x(β1 − β0 ) + E (U1 − U0 |U = u).7
       In order to compute the MTE, we estimate E (Y |X, P ) = Xβ0 + P X(β1 − β0 ) +K (P ), and we
                                                                  ∂E(Y |X=x,P =p)
take its derivative with respect to P : M T E(x, p) =                    ∂p
                                                                                  .   We estimate β1 , β0 applying the
partially linear regression method of Robinson (1988). K (·) is estimated using locally quadratic
regression.8 We trim 2% of the observations from the extremes of the distribution of P , which
means that we are only able to identify the MTE at evaluation points between 0.1 and 0.93. Thus,
we can only identify parameters over this support. We present annualized returns, obtained by
dividing the MTE (and the parameters it generates) by 4 (corresponding to 4 years of college).
       Figure 1 plots three alternative MPRTE weights. We take two cases based on example 1,
where qαA (P ) = P + α and qαC (P ) = (1 + α)P . A third case is taken from example 2 (B), where
qαB (Z [k] ) = Z [k] + α.9 ωMPRTE
                            C                            A
                                  puts more weight than ωMPRTE on higher values of U , and both sets
of weights are zero in the region of U for which we cannot identify the MTE. The intuitive reason
for this pattern is that a proportional change in P results in larger absolute changes for high levels
of P than for low levels of P , while an additive change in P results in uniform changes in P across
the whole distribution. The MPRTE for a marginal proportional change in P is estimated to be
   7
      The components of Z are: AFQT and its square, mother’s years of schooling and its square, permanent local
earnings (average earnings between 1973 and 2000) in the county of residence at age 17 and its square, permanent
local unemployment (average unemployment between 1973 and 2000) in state of residence at age 17 and its square,
the presence of a four year college in the county of residence at age 17, average tuition in public four year colleges in
the county of residence at age 17, log average wage in the county of residence at age 17, unemployment rate in the
state of residence at age 17. The latter four variables are excluded from the set of variables in the wage equations
(X) for D = 1 and D = 0, which are: years of experience and its square, log average wage in the county of residence
in 1991, unemployment rate in the state of residence in 1991, AFQT and its square, mother’s years of schooling and
its square, permanent local earnings (average earnings between 1973 and 2000) in the county of residence at age
17 and its square, and permanent local unemployment (average unemployment between 1973 and 2000) in state of
residence at age 17 and its square.
    8
      We first run kernel regressions of each X on P̂ using a bandwidth of 0.05 and trimming 2% of the observations,
and we compute the resulting residuals. We then estimate a linear regression of the outcome variable on these
residuals and obtain estimates β̂1 and β̂0 . In order to estimate K (·) and its first derivative we run a locally quadratic
regression of Y −X β̂0 + P̂ X(β̂1 − β̂0 ) on P̂ , using a bandwidth of 0.322 (determined by cross validation),and trimming
2% of the observations. K̂ 0 (·) is constructed by taking the coefficient on the linear term of the locally quadratic
regression.
    9
      In the empirical work we impose an index sufficiency restriction when estimating fP |X : fP |X = fP |Xδ . To
estimate the scalar index Xδ, we use the fact that fP |X = fP |Xδ implies that E(P |X) = E (P |Xδ) to estimate δ
using semi-parametric least squares (Ichimura, 1993). We estimate fP |Xδ by running a locally linear regression of
                                                                                         h         i 21
                                                                                                          ∗ n(− 5 ) . We use a
                                                                                                                1
  1         P̂ −p
    
  h   ∗ K      h    on X δ̂, where K  (·)  is a    standard normal density and  h = 1.06 ∗  Vdar (P )
                              h               i 12
                                ar (I (Xδ)) ∗ n(− 5 ) . The figure fixes Xδ at X̄δ The weights are rescaled so that both
                                                         1
bandwidth equal to 1.06 ∗ Vd
the MTE and the weights fit in the figure.


                                                             16
0.1296 while the MPRTE for a marginal additive change in P is estimated to be 0.0880, since the
                                                                                      B
former puts more weight on high values of U where the MTE is estimated to be smaller.ωMPRTE
                              A         C
puts more weight than either ωMPRTE or ωMPRTE in the center of the support of U , and the MPRTE
is estimated to be 0.1274. Figure 1 also shows that corresponding to each MPRTE weight there is
an AMTE weight, defined by different choices of metric for measuring the distance between P and
U . For case A, m (P, U ) = |P − U |. For case B, m (P, U ) = |FV−1 (P ) − FV−1 (U )| = |Zγ − V |. For
case C, m (P, U ) = | UP − 1|.



9      Summary and Conclusions

This paper extends the analysis of Heckman and Vytlacil (1999, 2005, 2007) by using the marginal
treatment effect (MTE) to identify the effect of a marginal policy change, and to identify the average
effect of treatment on individuals who are indifferent between treatment or not. Conventional
treatment parameters and the Policy Relevant Treatment Effect require large support conditions
                                     √
for identification, and often are not N -estimable. Under our assumptions the marginal policy
effect parameters and the average marginal treatment effects are generally identified without large
                           √
support conditions and are N -estimable. An analysis of the effect of marginal changes in tuition
policies on college attendance illustrates the empirical relevance of this analysis.




References

Ai, C. and X. Chen (2007, November). Estimation of possibly misspecified semiparametric con-
    ditional moment restriction models with different conditioning variables. Journal of Economet-
    rics 141 (1), 5–43.

Angrist, J., K. Graddy, and G. Imbens (2000, July). The interpretation of instrumental variables
    estimators in simultaneous equations models with an application to the demand for fish. Review
    of Economic Studies 67 (3), 499–527.




                                                  17
Björklund, A. and R. Moffitt (1987, February). The estimation of wage gains and welfare gains in
  self-selection. Review of Economics and Statistics 69 (1), 42–49.

Card, D. (2001, September). Estimating the return to schooling: Progress on some persistent
  econometric problems. Econometrica 69 (5), 1127–1160.

Carneiro, P., J. J. Heckman, and E. J. Vytlacil (2006). Estimating marginal and average returns
  to education. Unpublished manuscript. University of Chicago, Department of Economics.

Heckman, J. J. (1997, Summer). Instrumental variables: A study of implicit behavioral assumptions
  used in making program evaluations. Journal of Human Resources 32 (3), 441–462. Addendum
  published vol. 33 no. 1 (Winter 1998).

Heckman, J. J. and E. J. Vytlacil (1999, April). Local instrumental variables and latent variable
  models for identifying and bounding treatment effects. Proceedings of the National Academy of
  Sciences 96, 4730–4734.

Heckman, J. J. and E. J. Vytlacil (2001a). Instrumental variables, selection models, and tight bounds
  on the average treatment effect. In M. Lechner and F. Pfeiffer (Eds.), Econometric Evaluation
  of Labour Market Policies, pp. 1–15. New York: Center for European Economic Research.

Heckman, J. J. and E. J. Vytlacil (2001b, May). Policy-relevant treatment effects. American
  Economic Review 91 (2), 107–111.

Heckman, J. J. and E. J. Vytlacil (2005, May). Structural equations, treatment effects and econo-
  metric policy evaluation. Econometrica 73 (3), 669–738.

Heckman, J. J. and E. J. Vytlacil (2007). Econometric evaluation of social programs, part II:
  Using the marginal treatment effect to organize alternative economic estimators to evaluate social
  programs and to forecast their effects in new environments. In J. Heckman and E. Leamer (Eds.),
  Handbook of Econometrics, Volume 6B, pp. 4875–5144. Amsterdam: Elsevier.

Ichimura, H. (1993, July). Semiparametric least squares (SLS) and weighted SLS estimation of
  single-index models. Journal of Econometrics 58 (1-2), 71–120.


                                                 18
Imbens, G. W. and J. D. Angrist (1994, March). Identification and estimation of local average
  treatment effects. Econometrica 62 (2), 467–475.

Newey, W. and T. M. Stoker (1993, September). Efficiency of weighted average derivative estimators
  and index models. Econometrica 61 (5), 1199–1223.

Robinson, P. M. (1988, July). Root-n-consistent semiparametric regression. Econometrica 56 (4),
  931–954.

Stock, J. H. (1989, June). Nonparametric policy analysis. Journal of the American Statistical
  Association 84 (406), 565–575.

Vytlacil, E. J. (2002, January). Independence, monotonicity, and latent index models: An equiva-
  lence result. Econometrica 70 (1), 331–341.




                                                19
                                                                             Figure 1
                                                         Alternative Definitions of the MPRTE and the AMTE
                                         0.4
                                                                             MTE

                                        0.35                                 MPRTE: Pα = P0 + α; AMTE: |P - U| ≤ ε
                                                                             MPRTE: Pα(Z) = Fv (Zγ + αγ[k] ); AMTE: |Zγ - V | ≤ ε
                                         0.3                                 MPRTE: Pα = (1 + α)P0 ; AMTE: |UP - 1| ≤ ε
         MTE; MPRTE and AMTE Weights




                                        0.25


                                         0.2


                                        0.15


                                         0.1


                                        0.05


                                           0


                                       -0.05


                                        -0.1
                                               0   0.1   0.2    0.3    0.4      0.5       0.6       0.7      0.8       0.9          1
                                                                                 u




   This figure plots the marginal treatment effect (M T E = E (Y1 − Y0 |X = x, U = u)) and the
marginal policy relevant treatment effect (MPRTE) weights for three types of policy shifts: PαA =
                                 
P + α, PaB (Z) = FV Zγ + αγ [k] , and PαC = (1 + α) P , where P is the probability of receiving
treatment conditional on the observed covariates (Z). The equivalent definitions of the AMTE
correspond, respectively, to the following three metrics for measuring the distance between P and
U (m (P, U )): |P − U |, |Zγ − V |, and | UP − 1|. The MTE, the MPRTE, and the AMTE weights
are evaluated at values of X such that E (Y1 − Y0 |X) = 0.13. The average marginal policy effects
are 0.1296 for the additive shift in P (A), 0.1274 for the additive shift in Z (B), and 0.0880 for
the proportional shift in P (C). Estimated from NLSY data (see Carneiro, Heckman, and Vytlacil,
2006, for details on estimating MTE).




                                                                                20
