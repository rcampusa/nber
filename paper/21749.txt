                              NBER WORKING PAPER SERIES

                  A DEMAND SYSTEM APPROACH TO ASSET PRICING

                                       Ralph S.J. Koijen
                                        Motohiro Yogo

                                      Working Paper 21749
                              http://www.nber.org/papers/w21749

                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                          November 2015, Revised July 2019

An earlier version was titled “An Equilibrium Model of Institutional Demand and Asset Prices.”
Koijen acknowledges financial support from the European Research Council (grant 338082) and
the Center for Research in Security Prices at the University of Chicago Booth School of Business.
For comments and discussions, we thank Marianne Andries, Malcolm Baker, Markus
Brunnermeier, John Campbell, Joost Driessen, Stefano Giglio, Valentin Haddad, Ali Hortaçsu,
Michael Johannes, Dong Lou, Tobias Moskowitz, Anna Pavlova, Hélène Rey, Andrea Vedolin,
Pierre-Olivier Weill, and four referees. We thank Joseph Abadi and Mu Zhang for research
assistance on some proofs. We also thank seminar participants at Bank of Canada, Bank of
England, Banque de France, Baruch College, Bocconi University, Boston University, Duke
University, Federal Reserve Banks of Minneapolis and New York, Harvard University, HEC
Paris, Hitotsubashi University, Imperial College London, London Business School, London
Quant Group, London School of Economics, Massachusetts Institute of Technology, Oxford
University, Pennsylvania State University, Princeton University, Stanford University, Texas
A&M University, Toulouse School of Economics, University of California Los Angeles,
University College London, University of Chicago, University of Michigan, University of
Minnesota, University of North Carolina , University of Notre Dame, University of Texas at
Austin, Yale University, 2015 Banque de France-Toulouse School of Economics Conference on
Monetary Economics and Finance, 2015 Four Nations Conference, 2015 Annual Conference of
Paul Woolley Centre, 2015 European Financial Management Association Annual Meeting, 2015
Annual SoFiE Conference, 2015 NBER Summer Institute Forecasting and Empirical Methods in
Macro and Finance, 2015 Brazilian Finance Meeting, 2015 European Finance Association
Annual Meeting, 2015 NYU Stern Five-Star Conference, 2015 NBER Market Microstructure
Meeting, 2016 NBER New Developments in Long-Term Asset Management Conference, and
2017 American Finance Association Annual Meeting. The views expressed herein are those of
the authors and do not necessarily reflect the views of the National Bureau of Economic
Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2015 by Ralph S.J. Koijen and Motohiro Yogo. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
A Demand System Approach to Asset Pricing
Ralph S.J. Koijen and Motohiro Yogo
NBER Working Paper No. 21749
November 2015, Revised July 2019
JEL No. G12,G23

                                         ABSTRACT

We develop an asset pricing model with flexible heterogeneity in asset demand across investors,
designed to match institutional and household holdings. A portfolio choice model implies
characteristics-based demand when returns have a factor structure and expected returns and factor
loadings depend on the assets’ own characteristics. We propose an instrumental variables
estimator for the characteristics-based demand system to address the endogeneity of demand and
asset prices. Using US stock market data, we illustrate how the model could be used to
understand the role of institutions in asset market movements, volatility, and predictability.


Ralph S.J. Koijen
University of Chicago
Booth School of Business
5807 S Woodlawn Ave
Chicago, IL 60637
and NBER
Ralph.koijen@chicagobooth.edu

Motohiro Yogo
Department of Economics
Princeton University
Julis Romo Rabinowitz Building
Princeton, NJ 08544
and NBER
myogo@princeton.edu
I.   Introduction

Modern asset pricing models are built on asset demand, derived from optimal portfolio choice,
and market clearing. However, the common practice is to ignore institutional or household
holdings data in estimating these models, even though these data are direct observations of
asset demand. The predominant methodology for estimating asset pricing models, based on
simplifying assumptions, uses portfolio returns alone or the joint moments of returns and
aggregate or individual consumption. Although institutional holdings data have been used
in the empirical asset pricing literature, an equilibrium model that simultaneously matches
asset demand and imposes market clearing does not exist.
   We develop an asset pricing model from the optimal portfolio choice of investors that have
heterogeneous beliefs and face short-sale constraints. The investor’s ﬁrst-order condition is
a constrained Euler equation that relates the intertemporal marginal rate of substitution to
asset returns (Lucas 1978). An approximate solution to the portfolio choice problem is the
mean-variance portfolio (Markowitz 1952), where the optimal portfolio varies across investors
because of heterogeneous beliefs. Following the empirical asset pricing literature (e.g., Fama
and French 1993), we assume that returns have a factor structure and that expected returns
and factor loadings depend on the assets’ own characteristics. Under this assumption, the
optimal portfolio simpliﬁes to a characteristics-based demand function that depends on ob-
served characteristics (e.g., market equity, book equity, proﬁtability, investment, dividends,
and market beta) and latent demand (i.e., characteristics unobserved by the econometrician).
We estimate the optimal portfolio on stock market data to show the empirical relevance of the
assumptions under which the optimal portfolio simpliﬁes to characteristics-based demand.
   Characteristics-based demand allows for ﬂexible heterogeneity in asset demand across in-
vestors and matches institutional and household holdings, including zero holdings and index
strategies. We allow the coeﬃcients on characteristics to vary across investors so that the
aggregate demand elasticity varies across assets that are held by diﬀerent sets of investors.
Characteristics-based demand allows for more ﬂexible cross-elasticities across assets than
traditional models based on simplifying assumptions that imply homogeneous asset demand
across investors (Tobin 1958). In that sense, our approach is related to an older literature
on macroeconomic models of asset demand (Brainard and Tobin 1968; Tobin 1969) and dif-
ferentiated product demand systems (Lancaster 1966; Rosen 1974), but a contribution is to
derive asset demand from optimal portfolio choice in the tradition of modern asset pricing
theory. We show that the equilibrium price vector is uniquely determined by market clear-
ing across institutions and households, under a simple condition that demand is downward
sloping for all investors.


                                              2
   We illustrate demand system asset pricing using US stock market and institutional hold-
ings data, based on Securities and Exchange Commission Form 13F. The 13F data contain
quarterly stock holdings of institutions that manage more than $100 million since 1980. The
types of 13F institutions are banks, insurance companies, investment advisors (including
hedge funds), mutual funds, pension funds, and other 13F institutions (i.e., endowments,
foundations, and nonﬁnancial corporations). These institutions collectively manage 68 per-
cent of the US stock market, with the remaining 32 percent attributed to direct household
holdings and non-13F institutions.
   To identify the characteristics-based demand system, we start with the traditional as-
sumption in asset pricing that shares outstanding and characteristics other than price are
exogenous, determined by an exogenous endowment process. To relax the traditional as-
sumption that investors are atomistic and that demand shocks are uncorrelated across in-
vestors, we propose an instrumental variables estimator to address the endogeneity of latent
demand and asset prices. Our identifying strategy is motivated by an observation that insti-
tutions hold a small set of stocks and that the set of stocks that they have held in the recent
past (e.g., over the past 3 years) hardly changes over time. This observation is consistent
with the fact that many institutions are subject to an investment mandate (i.e., a predeter-
mined rule exogenous to current demand shocks) that limits their investment universe (i.e.,
the set of stocks that they are allowed to hold). An asset that is included in the investment
universe of more investors, especially if those investors are large, has a larger exogenous
component of demand. With downward-sloping demand, a larger exogenous component of
demand generates higher prices that are unrelated to latent demand. A potential threat
to identiﬁcation is that we cannot measure the investment universe perfectly, but future
research could improve on our framework through new data or methodology that leads to
better measurement of the investment universe. For example, the secular trend from active
to passive asset management, especially the growth of exchange-traded funds, could simplify
the measurement of the investment universe for a large share of institutions in the future.
   After estimating the characteristics-based demand system, we illustrate the empirical
relevance of our approach through four asset pricing applications. First, we estimate the
price impact of demand shocks for all institutions and stocks, which arises from imperfectly
elastic aggregate demand. We ﬁnd that the price impact for the average institution has
decreased from 1980 to 2017, especially for the least liquid stocks at the 90th percentile
of the distribution. This means that the cross-sectional distribution of price impact has
signiﬁcantly compressed over this period. For example, the price impact for the average
investment advisor with a 10 percent demand shock on the least liquid stocks has decreased
from 0.64 percent in 1980 to 0.22 percent in 2017.


                                              3
    Second, we use demand system asset pricing to decompose the cross-sectional variance
of stock returns into supply- and demand-side eﬀects. The supply-side eﬀects are changes
in shares outstanding, changes in characteristics, and the dividend yield. These three eﬀects
together explain only 12 percent of the cross-sectional variance of stock returns. The demand-
side eﬀects are changes in assets under management, the coeﬃcients on characteristics, and
latent demand. Of these three eﬀects, changes in latent demand are the most important,
explaining 81 percent of the cross-sectional variance of stock returns. Thus, stock returns are
mostly explained by demand shocks that are unrelated to changes in observed characteristics
(i.e., “excess volatility” according to Shiller (1981)). These moments establish a new set of
targets for a growing literature on asset pricing models with institutional investors,1 just as
the variance decomposition of Campbell (1991) has been a useful guide for consumption-
based asset pricing.
   Third, we use a similar variance decomposition to examine whether larger institutions
explain a disproportionate share of the stock market volatility in 2008. We ﬁnd that the
30 largest institutions, which manage about a third of the stock market, explain only 4
percent of the cross-sectional variance of stock returns. Smaller institutions, which also
manage about a third of the stock market, explain 41 percent of the cross-sectional variance
of stock returns. Direct household holdings and non-13F institutions, which account for
the remaining third of the stock market, explain 47 percent of the cross-sectional variance
of stock returns. The largest institutions explain a relatively small share of stock market
volatility because they tend to be diversiﬁed buy-and-hold investors that hold more liquid
stocks with a smaller price impact.
   Fourth, we use demand system asset pricing to predict cross-sectional variation in stock
returns. The model implies mean reversion in stock prices if latent demand is mean reverting.
Under the assumption that latent demand reverts to its unconditional mean in the long run,
we estimate a long-run expected return for each stock. We then test whether our estimate
of the long-run expected return predicts the cross section of stock returns through a Fama-
MacBeth (1973) regression of monthly excess returns onto lagged characteristics, including
all characteristics in the Fama-French (2015) ﬁve-factor model and momentum. We ﬁnd that
our estimate of the long-run expected return uncovers a new source of predictability from
mean reversion in latent demand. Expected monthly returns increase by 0.18 percent per
one standard deviation in the long-run expected return with a t-statistic of 4.80.
   The remainder of the paper is organized as follows. Section II derives characteristics-
based demand from optimal portfolio choice. Section III describes the stock market and
  1
   See Vayanos (2016), Dasgupta, Prat, and Verardo (2011), Basak and Pavlova (2013), He and Krishna-
murthy (2013), and Vayanos and Woolley (2013).



                                                 4
institutional holdings data. Section IV explains our identifying assumptions and presents
estimates of the characteristics-based demand system. Section V presents the empirical
ﬁndings on the role of institutions in stock market movements, volatility, and predictability.
Section VI discusses several extensions and open issues for future research. Section VII
presents conclusions.


II.   Asset Pricing Model

We develop an asset pricing model from the optimal portfolio choice of investors that have
heterogeneous beliefs and face short-sale constraints. The optimal portfolio varies across
investors because of heterogeneous beliefs, and the portfolio weights are nonnegative because
of short-sale constraints. Following the empirical asset pricing literature, we assume that
returns have a factor structure and that expected returns and factor loadings depend on
the assets’ own characteristics. Under this assumption, we derive the main result that the
optimal portfolio simpliﬁes to characteristics-based demand, in which the portfolio weights
depend on the assets’ own characteristics.

A.    Financial Assets

There are N ﬁnancial assets indexed by n = 1, . . . , N . Let St (n) be the number of shares
outstanding of asset n at date t. Let Pt (n) and Dt (n) be the price and dividend per share
for asset n at date t. Then MEt (n) = Pt (n)St (n) is market equity at date t, and Rt (n) =
(Pt (n) + Dt (n))/Pt−1 (n) is the gross return from date t − 1 to t. Let lowercase letters
denote the logarithm of the corresponding uppercase variables. That is, st (n) = log(St (n)),
pt (n) = log(Pt (n)), met (n) = log(MEt (n)), and rt (n) = log(Rt (n)). We denote the N-
dimensional vectors corresponding to these variables in bold as st = log(St ), pt = log(Pt ),
and rt = log(Rt ). We denote a vector of ones as 1, a vector of zeros as 0, an identity matrix
as I, and a diagonal matrix as diag(·) (e.g., diag(1) = I).
   In addition to price and shares outstanding, the assets are diﬀerentiated along K char-
acteristics. In the case of stocks, for example, these characteristics could include various
measures of fundamentals such as dividends, book equity, proﬁtability, and investment. We
denote characteristic k of asset n at date t as xk,t (n). We stack these characteristics in an
N × K matrix as xt , whose nth row is xt (n) and (n, k)th element is xk,t (n). To simplify no-
tation, we follow the convention that the Kth characteristic is a constant (i.e., xK,t (n) = 1).
Following the literature on asset pricing in endowment economies (Lucas 1978), we assume
that shares outstanding, dividends, and other characteristics are exogenous. That is, only as-
set prices are endogenously determined in the model. Shares outstanding and characteristics


                                               5
could be endogenized in a production economy, as we discuss in Section VI.

B. Optimal Portfolio Choice

The ﬁnancial assets are held by I investors, indexed by i = 1, . . . , I. Each investor allocates
wealth Ai,t at date t across assets in its investment universe Ni,t ⊆ {1, . . . , N} and an outside
asset. The investment universe is a subset of assets that the investor is allowed to hold, which
in practice is determined by an investment mandate. For example, the investment universe
of an index fund is the set of assets that compose the index. We denote the number of assets
in the investment universe as |Ni,t|. The outside asset represents all wealth outside the N
assets that are the subject of our study.
   Let wi,t be an |Ni,t|-dimensional vector of portfolio weights that investor i chooses at
date t.2 The investor chooses the portfolio weights at each date to maximize expected log
utility over terminal wealth at date T :

                                          max Ei,t [log(Ai,T )],
                                           wi,t


where Ei,t denotes investor i’s expectation at date t.3 The intertemporal budget constraint
is

                                                      
                           Ai,t+1 = Ai,t (Rt+1 (0) + wi,t (Rt+1 − Rt+1 (0)1)),                           (1)

where Rt+1 (0) is the gross return on the outside asset. The investor also faces short-sale
constraints:

                                                   wi,t ≥ 0,                                             (2)
                                                  1 wi,t < 1.                                           (3)

         The Lagrangian for the portfolio choice problem is
                                                                                         
                                                  
                                                  T −1
                       Li,t = Ei,t log(Ai,T ) +          (Λi,s wi,s + λi,s (1 − 1 wi,s )) ,            (4)
                                                   s=t


where Λi,t ≥ 0 and λi,t ≥ 0 are the Lagrange multipliers on the short-sale constraints (2) and
(3) at date t. We denote the conditional mean and covariance of log excess returns, relative
     2
     Our notation presupposes that positions in redundant assets (with collinear payoﬀs) have been eliminated
through aggregation so that the covariance matrix of log excess returns is invertible.
   3
     We assume log utility for expositional purposes because the multiperiod portfolio choice problem reduces
to a one-period problem in which hedging demand is absent (Samuelson 1969).


                                                         6
to the outside asset, as

                                                 σi,t
                                                  2
               μi,t   =Ei,t [rt+1 − rt+1 (0)1] +      ,
                                                  2
              Σi,t    =Ei,t [(rt+1 − rt+1 (0)1 − Ei,t [rt+1 − rt+1 (0)1])(rt+1 − rt+1 (0)1) ],

where σi,t
       2
           is a vector of the diagonal elements of Σi,t . Without loss of generality, we group
the assets into those for which the short-sale constraint is not binding versus binding as
                                                                   
                                                                (1)
                                                              wi,t
                                                wi,t       =          ,
                                                               0
                                                                  
                                                               (1)
                                                              μi,t
                                                    μi,t   = (2) ,
                                                              μi,t
                                                                              
                                                               (1,1)     (1,2)
                                                              Σi,t      Σi,t
                                                Σi,t       = (2,1)       (2,2) .                          (5)
                                                              Σi,t      Σi,t

Lemma 1, proved in Appendix A, describes the solution to the portfolio choice problem.

   Lemma 1. The ﬁrst-order condition for the portfolio choice problem is the constrained
Euler equation:
                                           −1             
                                    Ai,t+1                             
                        Ei,t                         Rt+1 = 1 − (I − 1wi,t )(Λi,t − λi,t 1).              (6)
                                     Ai,t

An approximate solution to the portfolio choice problem is
                                                                                      
                                              (1)           (1,1)−1        (1)
                                         wi,t ≈ Σi,t                      μi,t − λi,t 1 ,                 (7)

where λi,t is given by equation (A5) in Appendix A.4

   Lemma 1 summarizes the known relation between Euler equations in asset pricing (6)
and optimal portfolio choice (7). The right side of equation (6) simpliﬁes to 1 when the
investor is unconstrained (i.e., Λi,t = 0 and λi,t = 0). Under this frictionless benchmark, we
   4
     Equation (7) is based on an approximation of expected log utility around mean-variance utility. There-
fore, we could justify equation (7) as an exact solution if we started with mean-variance utility, following a
long tradition in portfolio choice (Markowitz 1952). Another common justiﬁcation is that equation (7) is an
exact solution in the continuous-time limit (Campbell and Viceira 2002, pp. 28–29).




                                                                  7
impose rational expectations to obtain
                                                  −1        
                                           Ai,t+1
                                 Et                       Rt+1 = 1.
                                            Ai,t

The literature on consumption-based asset pricing tests this moment condition on both
aggregate and household consumption data (Mankiw and Zeldes 1991; Brav, Constantinides,
and Geczy 2002; Vissing-Jørgensen 2002). This test does not require household holdings data
under the null that investors are unconstrained and have rational expectations.

C. Characteristics-Based Demand

Motivated by the intertemporal capital asset pricing model (Merton 1973) and arbitrage pric-
ing theory (Ross 1976), a large literature has searched for a low-dimensional factor structure
in returns. A notable contribution to this literature is the three-factor model of Fama and
French (1993), in which the factors are excess market returns, small minus big (SMB) port-
folio returns, and high minus low (HML) book-to-market portfolio returns. The three-factor
model suggests that expected returns and factor loadings are well captured by three char-
acteristics: market beta, market equity (i.e., a measure of size), and book-to-market equity
(i.e., a measure of value). A more recent ﬁve-factor model of Fama and French (2015)
augments this model with two additional factors, which are robust minus weak (RMW)
proﬁtability portfolio returns and conservative minus aggressive (CMA) investment portfo-
lio returns. Thus, proﬁtability and investment are two additional characteristics that are
relevant for expected returns and factor loadings. We let xt (n) denote a vector of observed
characteristics of asset n at date t, which includes log book equity, proﬁtability, investment,
and market beta.
   Under heterogeneous beliefs, diﬀerent investors could form diﬀerent expectations about
returns based on the same observed characteristics. Furthermore, investor i could form
expectations about returns based on characteristics of asset n at date t that are unobserved
by the econometrician, which we denote as log(i,t (n)). We stack investor i’s information set
for asset n at date t as
                                                ⎡                  ⎤
                                                         met (n)
                                              ⎢                   ⎥
                                   xi,t (n) = ⎣        xt (n) ⎦ ,
                                                    log(i,t (n))

which consists of log market equity, other observed characteristics, and unobserved char-
acteristics. We then form an Mth-order polynomial of these characteristics through a


                                                     8
M
  m=1 (K     + 2)m -dimensional vector:
                                                 ⎡                         ⎤
                                                     xi,t (n)
                                              ⎢                      ⎥
                                   yi,t (n) = ⎢                     ⎥
                                              ⎣vec(xi,t (n)xi,t (n) )⎦ .
                                                         ..
                                                          .

   Motivated by our previous discussion of the empirical asset pricing literature, we assume
that returns have a one-factor structure and that expected returns and factor loadings depend
on the assets’ own characteristics.5

       Assumption 1. The covariance matrix of log excess returns is Σi,t = Γi,t Γi,t + γi,t I,
where Γi,t is a vector of factor loadings and γi,t > 0 is idiosyncratic variance. Expected
excess returns and factor loadings are polynomial functions of characteristics:

                                       μi,t (n) =yi,t (n) Φi,t + φi,t ,
                                       Γi,t (n) =yi,t (n) Ψi,t + ψi,t ,

where Φi,t and Ψi,t are vectors and φi,t and ψi,t are scalars that are constant across assets.

    The key content of Assumption 1 is that an asset’s own characteristics are suﬃcient for
its factor loadings, which also implies that they are suﬃcient for the variance of the optimal
portfolio. The following proposition, proved in Appendix A, shows that the optimal portfolio
simpliﬁes to a polynomial function of characteristics under Assumption 1.

       Proposition 1. Under Assumption 1, the optimal portfolio weight (7) on each asset n
for which the short-sale constraint is not binding is

                                      wi,t (n) = yi,t (n) Πi,t + πi,t ,                                (8)

where

                                               1
                                    Πi,t =         (Φi,t − Ψi,t κi,t ) ,                                (9)
                                              γi,t
                                               1
                                     πi,t   =      (φi,t − λi,t − ψi,t κi,t )
                                              γi,t

are constant across assets. The expressions for λi,t and κi,t are given by equations (A5) and
(A6) in Appendix A.
   5
    We could relax the one-factor assumption and generalize to a multifactor case, but the resulting expres-
sions are less intuitive and less preferable for expositional purposes.


                                                         9
   The investor ultimately cares about the trade-oﬀ between risk (i.e., the covariance matrix)
and expected return. Under Assumption 1, however, the investor indirectly cares about
characteristics because they are suﬃcient for the covariance matrix and expected returns.
As we show in Appendix A, the scalars λi,t and κi,t ultimately depend on the characteristics
of all assets. However, the key content of equation (8) is that the vector Πi,t and scalar πi,t
are constant across assets. Therefore, variation in characteristics yi,t (n) across assets is the
only source of variation in the portfolio weights.
   The expression for the coeﬃcients on characteristics (9) has an intuitive interpretation.
Because κi,t is a scalar, the investor’s demand for characteristics is simply a linear combina-
tion of the vectors on expected returns Φi,t and factor loadings Ψi,t . That is, the investor
prefers assets with characteristics that are associated with higher expected returns or smaller
factor loadings (i.e., less risk).
    In Appendix A, we show that a particular coeﬃcient restriction implies that equation
(8) is an Mth-order polynomial expansion of the exponential function. As a matter of
speciﬁcation, a model of portfolio weights that is exponential linear in characteristics is
parsimonious and pairs nicely with the fact that portfolio weights appear lognormal in the
13F data. Thus, we have the following corollary to Proposition 1.

   Corollary 1. A restricted version of the optimal portfolio (8) under Assumption 1 is
characteristics-based demand:
                                                                                
           wi,t (n)                                   
                                                      K−1
                    = δi,t (n) = exp β0,i,t met (n) +     βk,i,txk,t (n) + βK,i,t i,t (n).   (10)
           wi,t (0)                                   k=1


   We refer to equation (10) as characteristics-based demand because the portfolio weights
depend on log market equity, other observed characteristics, and unobserved characteristics.
An important question is whether the distributional assumptions and parametric restrictions
under which the optimal portfolio simpliﬁes to characteristics-based demand are empirically
relevant. In Appendix B, we conﬁrm that a benchmark implementation that uses the usual
statistical formulas for sample mean and covariance leads to poor estimates of the mean-
variance portfolio because of sampling error over many parameters. We also conﬁrm that a
more robust approach to estimating the mean-variance portfolio exploits the factor structure
in returns (MacKinlay and Pástor 2000) and the fact that expected returns and factor
loadings are well captured by a few characteristics (Brandt, Santa-Clara, and Valkanov
2009).
   Equation (10) and the budget constraint imply that investor i’s portfolio weight on asset



                                                 10
n ∈ Ni,t at date t is

                                                        δi,t (n)
                                 wi,t (n) =                                  .              (11)
                                              1+        m∈Ni,t     δi,t (m)

The portfolio weight on the outside asset is

                                                           1
                                 wi,t (0) =                                  .              (12)
                                              1+        m∈Ni,t   δi,t (m)

Although there are |Ni,t | + 1 assets including the outside asset, there are only |Ni,t | degrees
of freedom because of the budget constraint.
    Price per share enters demand only through market equity because the number of shares
outstanding is not economically meaningful. We follow the notational convention that the
Kth characteristic is a constant (i.e., xK,t (n) = 1) so that βK,i,t is the intercept. We refer to
i,t (n) as latent demand, which captures investor i’s demand for unobserved (by the econo-
metrician) characteristics of asset n. As we discuss in Section III, we do not observe short
positions in our empirical application. Therefore, we restrict i,t (n) ≥ 0 so that the portfolio
weights are nonnegative.
   We normalize the mean of latent demand i,t (n) to one for each investor, so that the
intercept βK,i,t in equation (10) is identiﬁed. Then the intercept βK,i,t and latent demand
i,t (n) play diﬀerent roles in equation (10). On the one hand, βK,i,t determines demand
for all assets in the investment universe relative to the outside asset. In equation (12), the
portfolio weight on the outside asset is decreasing in βK,i,t. On the other hand, cross-sectional
variation in i,t (n) captures relative demand across assets in the investment universe. Thus,
average latent demand for an asset across investors, weighted by assets under management,
could be constructed as an asset-level measure of sentiment. Dispersion in latent demand
for an asset across investors could be constructed as an asset-level measure of disagreement.
   Characteristics-based demand easily captures an index fund. If β0,i,t = 1, βk,i,t = 0 for
k = 1, . . . , K − 1, and i,t (n) = 1 for all assets n ∈ Ni,t , equation (11) simpliﬁes to

                                                    MEt (n)
                          wi,t (n) =                                 .                      (13)
                                       exp{−βK,i,t } + m∈Ni,t MEt (m)

This investor is an index fund whose portfolio weights are proportional to market equity,
and the intercept βK,i,t determines the weight on the outside asset (e.g., cash).




                                                   11
D. Demand Elasticities

In equation (10), the coeﬃcients on characteristics are indexed by i and therefore vary
across investors. In particular, investors have heterogeneous demand elasticities. Let qi,t =
log(Ai,t wi,t )−pt be the vector of log shares held by investor i, deﬁned only over the subvector
of strictly positive portfolio weights. The elasticity of individual demand is

                                  ∂qi,t
                              −         = I − β0,i,t diag(wi,t )−1 Gi,t ,                     (14)
                                  ∂pt
                                 
where Gi,t = diag(wi,t ) − wi,t wi,t . Demand elasticity is decreasing in β0,i,t . Returning to our
example in equation (13), an index fund with β0,i,t = 1 has inelastic demand.
                 
   Let qt = log( Ii=1 Ai,t wi,t ) − pt be the vector of log shares held across all investors,
summed only over the subvectors of strictly positive portfolio weights. The elasticity of
aggregate demand is

                                ∂qt             I
                               −  =I−     β0,i,t Ai,t H−1
                                                        t Gi,t ,                              (15)
                                ∂pt    i=1

            
where Ht = Ii=1 Ai,t diag(wi,t ). The diagonal elements of matrices (14) and (15) are strictly
positive when β0,i,t < 1 for all investors. Thus, the following assumption is suﬃcient for both
individual and aggregate demand to be downward sloping.

     Assumption 2. The coeﬃcient on log market equity satisﬁes β0,i,t < 1 for all investors.

     In most asset pricing models, demand is downward sloping for various reasons including
risk aversion, hedging motives (Merton 1973), and price impact (Wilson 1979; Kyle 1989).
As we show next, Assumption 2 is also suﬃcient for a unique equilibrium. Therefore, we
maintain Assumption 2 for convenience in our implementation of characteristics-based de-
mand.

E.    Market Clearing

We complete the asset pricing model with market clearing for each asset n:

                                                 
                                                 I
                                     MEt (n) =             Ai,t wi,t (n).                     (16)
                                                     i=1


That is, the market value of shares outstanding must equal the wealth-weighted sum of
portfolio weights across all investors. In equation (16) and throughout the paper, we follow


                                                     12
the notational convention that wi,t (n) = 0 for any asset that is not in investor i’s investment
universe (i.e., n ∈
                  / Ni,t ). If asset demand were homogeneous, market clearing (16) implies that
all investors hold the market portfolio in equilibrium, just as in the capital asset pricing model
(Sharpe 1964; Lintner 1965). In contrast, characteristics-based demand allows for ﬂexible
heterogeneity in asset demand across investors and matches institutional and household
holdings.
   We rewrite market clearing (16) in logarithms and vector notation as
                                                                    
                                                   
                                                   I
                              p = f(p) = log             Ai wi (p)       − s.                (17)
                                                   i=1


In this equation and the remainder of this section, we drop time subscripts to simplify
notation. Assumption 2 is suﬃcient for a unique price vector that solves equation (17). That
is, the equilibrium price vector is well deﬁned regardless of the distribution of characteristics,
wealth, and latent demand.

    Proposition 2. Under Assumption 2, f(p) has a unique ﬁxed point in a convex compact
deﬁned in Appendix A. Furthermore, f(p) has a unique ﬁxed point in RN if all assets have
at least one investor with β0,i ∈ (−1, 1).

   The proof of Proposition 2 in Appendix A veriﬁes the suﬃcient conditions for existence
and uniqueness under the Brouwer ﬁxed-point theorem. We emphasize that Assumption 2 is
a suﬃcient condition and that a unique equilibrium could exist even when β0,i ≥ 1 for some
investors. The stronger result for uniqueness in RN requires that all assets have at least one
investor whose coeﬃcient on log market equity is strictly greater than −1. This would be the
case, for example, if there were index funds with relatively inelastic demand that hold each
asset. Although Proposition 2 guarantees a unique equilibrium, we still need an algorithm
for computing the equilibrium price vector in applications. Appendix C describes an eﬃcient
algorithm for computing the equilibrium in any counterfactual experiment, which we have
developed for the asset pricing applications in Section V.
   Of course, characteristics-based demand can be used for policy experiments only under
the null that it is a structural model of asset demand that is policy invariant. The Lucas
(1976) critique applies under the alternative that the coeﬃcients on characteristics and latent
demand ultimately capture beliefs or constraints that change with policy. Furthermore, we
cannot answer welfare questions without taking an explicit stance on preferences, beliefs,
and constraints. However, this may not matter for most asset pricing applications in which
price (rather than welfare) is the primary object of interest. The remainder of the paper


                                               13
proceeds under the assumption that characteristics-based demand is a structural model of
asset demand that is motivated by Corollary 1.


III.      Stock Market and Institutional Holdings Data

A.       Stock Characteristics

The data on stock prices, dividends, returns, and shares outstanding are from the Center
for Research in Security Prices (CRSP) Monthly Stock Database. We restrict our sample
to ordinary common shares (i.e., share codes 10, 11, 12, and 18) that trade on the New
York Stock Exchange (NYSE), the American Stock Exchange, and Nasdaq (i.e., exchange
codes 1, 2, and 3). We further restrict our sample to stocks with non-missing price and
shares outstanding. Accounting data are from the Compustat North America Fundamentals
Annual and Quarterly Databases. We merge the CRSP data with the most recent Compustat
data as of at least 6 months and no more than 18 months prior to the trading date. The lag
of at least 6 months ensures that the accounting data were public on the trading date.
   In addition to log market equity, the characteristics in our speciﬁcation include log book
equity, proﬁtability, investment, dividends to book equity, and market beta. Our choice of
book equity, proﬁtability, and investment is motivated by the Fama-French ﬁve-factor model
that is known to describe the cross section of stock returns. Dividends and market beta have
a long tradition in empirical asset pricing as measures of fundamentals and systematic risk,
respectively. Our speciﬁcation is based on a parsimonious and relevant set of characteristics
for explaining expected returns and factor loadings, motivated by Assumption 1. We are
concerned about collinearity between characteristics and overﬁtting if we consider a larger
model with more characteristics. We stay away from return variables because they could
violate our identifying assumption that characteristics other than price are exogenous to
latent demand, as we discuss in Section IV. In addition, Hou, Xue, and Zhang (2015)
ﬁnd that characteristics that are already in our speciﬁcation absorb the explanatory power
of some return variables (e.g., proﬁtability absorbs momentum and book-to-market equity
absorbs long-term reversal).
    Our construction of these characteristics follows Fama and French (2015), which we brieﬂy
summarize here. Proﬁtability is the ratio of operating proﬁts to book equity.6 Investment
is the annual log growth rate of assets. Dividends to book equity is the ratio of annual
dividends per split-adjusted share times shares outstanding to book equity. We estimate
market beta from a regression of monthly excess returns, over the 1-month Treasury-bill
     6
     Operating proﬁts are annual revenues minus the sum of cost of goods sold; selling, general, and admin-
istrative expenses; and interest and related expenses.


                                                    14
rate, onto excess market returns using a 60-month moving window (with at least 24 months
of non-missing returns). At each date, we winsorize proﬁtability, investment, and market
beta at the 2.5th and 97.5th percentiles to reduce the impact of outliers. Since dividends
are positive, we winsorize dividends to book equity at the 97.5th percentile.
   Following Fama and French (1992), our analysis focuses on ordinary common shares that
are not foreign or a real estate investment trust (i.e., share code 10 or 11) and have non-
missing characteristics and returns. In our terminology, these are the stocks that make up
the investment universe. The outside asset includes the complement set of stocks, which
either are foreign (i.e., share code 12), are real estate investment trusts (i.e., share code 18),
or have missing characteristics or returns.

B. Institutional Stock Holdings

The data on institutional common stock holdings are from the Thomson Reuters Institutional
Holdings Database (s34 ﬁle), which are compiled from the quarterly ﬁlings of Securities
and Exchange Commission Form 13F.7 All institutional investment managers that exercise
investment discretion on accounts holding Section 13(f) securities, exceeding $100 million in
total market value, must ﬁle the form. Form 13F reports only long positions and not short
positions. We also do not know the cash and bond positions of institutions because these
assets are not 13(f) securities.
   We group institutions into six types: banks, insurance companies, investment advisors,
mutual funds, pension funds, and other 13F institutions. An investment advisor is a regis-
tered company under Securities and Exchange Commission Form ADV. Investment advisors
include many hedge funds, and we separate investment advisors that are mutual funds into a
diﬀerent group. The group of other 13F institutions includes endowments, foundations, and
nonﬁnancial corporations. Appendix D contains details of how we construct the institution
type.
   We merge the institutional holdings data with the CRSP-Compustat data by CUSIP
number and drop any holdings that do not match (i.e., 13(f) securities whose share codes
are not 10, 11, 12, or 18). We compute the dollar holding for each stock that an institution
holds as price times shares held. Assets under management is the sum of dollar holdings for
each institution. We compute the portfolio weights as the ratio of dollar holdings to assets
under management.
   7
     Since June 2013, we use the new version of the data posted on June 11, 2018 that corrects a missing
data issue (Wharton Research Data Services 2016). Unfortunately, the new version has missing data between
March 2011 and March 2013 because of migration to a new data feed (Wharton Research Data Services 2018).
Therefore, we use the previous version of the data on the WRDS SFTP archive prior to June 2013, consistent
with Ben-David et al. (2017).


                                                   15
    We deﬁne the investment universe for each institution at each date as stocks that are
currently held or ever held in the previous 11 quarters. Thus, the investment universe
includes a zero holding whenever a stock that was held in the previous 11 quarters is no
longer in the portfolio. To motivate our choice of 11 quarters, Table 1 reports the percentage
of stocks held in the current quarter that were ever held in the previous one to 11 quarters.
For the median institution in assets under management (AUM), 85 percent of stocks that
are currently held were also held in the previous quarter. This percentage increases slowly
to 94 percent at 11 quarters, so going beyond 11 quarters does not substantively change our
measure of the investment universe.
  Market clearing (16) requires that shares outstanding equal the sum of shares held across
all investors. For each stock, we deﬁne the shares held by the household sector as the
diﬀerence between shares outstanding and the sum of shares held by 13F institutions.8 The
household sector represents direct household holdings and smaller institutions that are not
required to ﬁle Form 13F. We also include as part of the household sector any institution
with less than $10 million in assets under management, no stocks in the investment universe,
or no outside assets.
    Table 2 summarizes the 13F institutions in our sample from 1980 to 2017. In the begin-
ning of the sample, 544 institutions managed 35 percent of the stock market. This number
grows steadily to 3,655 institutions that managed 68 percent of the stock market by the
end of the sample. From 2015 to 2017, the median institution managed $302 million, while
larger institutions at the 90th percentile managed $5,204 million. Most institutions hold
concentrated portfolios. From 2015 to 2017, the median institution held 67 stocks, while the
more diversiﬁed institutions at the 90th percentile held 454 stocks. Table D1 in Appendix D
contains a more detailed breakdown of Table 2 by institution type.


IV.    Estimating the Characteristics-Based Demand System

Equation (10) can be interpreted as a nonlinear regression model that relates the cross section
of portfolio weights to characteristics. A lower coeﬃcient on log market equity means that
demand is more elastic. For example, an investor that tilts its portfolio toward value stocks
would have a low coeﬃcient on log market equity and a high coeﬃcient on log book equity.
The goal of this section is to identify the coeﬃcients on characteristics in equation (10) for
each investor at each date. We drop time subscripts throughout this section to simplify
notation and to emphasize that estimation is on the cross section of assets. We impose
   8
    In a small number of cases, the sum of shares reported by 13F institutions exceeds shares outstanding
because of shorting or reporting errors (Lewellen 2011). In these cases, we proportionally scale down the
reported holdings of all 13F institutions to ensure that the sum equals shares outstanding.


                                                   16
the coeﬃcient restriction β0,i < 1 to ensure that demand is downward sloping and that
equilibrium is unique (see Proposition 2).

A.   Identifying Assumptions

1. Exogenous Characteristics

Our starting point is the identifying assumption that is implied by the literature on asset
pricing in endowment economies (Lucas 1978):

                                   E[i (n)|me(n), x(n)] = 1.                               (18)

Equation (10) could be estimated by nonlinear least squares under this moment condition,
which describes most of the empirical literature on household portfolio choice and cross-
border capital ﬂows in international ﬁnance. Following this literature, we retain the assump-
tion that shares outstanding and characteristics other than price are exogenous, determined
by an exogenous endowment process.
   The usual justiﬁcation for the exogeneity of prices (or market equity) in moment condition
(18) is that the investor is atomistic so that demand shocks have negligible price impact.
However, even if individual investors are atomistic, correlated demand shocks could have
price impact in the aggregate, so moment condition (18) rules out any factor structure in
latent demand. Because these assumptions are unlikely to hold for institutions or households,
we develop an alternative identiﬁcation strategy based on weaker assumptions.

2. Investment Mandates and the Wealth Distribution

Let ½i (n) be an indicator function that is equal to one if asset n is in investor i’s investment
universe (i.e., n ∈ Ni ). We can trivially rewrite equation (10) for any asset as
                 ⎧                            K−1                   
        wi (n)   ⎨ ½ i (n) exp   β     me(n) +      β   x
                                                     k,i k (n) + β K,i i (n) if n ∈ Ni
                                   0,i          k=1
               =                                                                        .
        wi (0) ⎩½ (n) = 0                                                     if n ∈
                                                                                   / Ni
                     i


This notation emphasizes that an investor does not hold an asset for two possible reasons.
The ﬁrst reason is that the investor is not allowed to hold the asset because it is not in its
investment universe (i.e., ½i (n) = 0). For example, an index fund cannot hold assets that
are outside the index. The second reason is that the investor chooses not to hold an asset
even though it could (i.e., i (n) = 0). For example, an index fund may choose not to hold
an asset in the index that is perceived to be overvalued. Thus, ½i (n) is exogenous under the


                                               17
maintained assumption that the investment universe is exogenous, while i (n) is endogenous
through the portfolio choice problem.
   In practice, the investment universe is deﬁned by an investment mandate, which is a
predetermined rule on the set of investable assets. For example, the investment mandate of
a technology fund limits the investment universe to technology stocks. The key economic
property of an investment mandate is that it is a predetermined rule that is plausibly ex-
ogenous to current demand shocks. Appendix E contains some examples of mutual funds
for which the prospectus clearly states the investment mandate. Other types of institutions
such as insurance companies, pension funds, and hedge funds also use investment mandates
even though they are usually not publicly disclosed (Sharpe 1981; van Binsbergen, Brandt,
and Koijen 2008; Blake et al. 2013).
    In addition to the investment universe, we maintain the assumption that the wealth
distribution across other investors is predetermined and exogenous to current demand shocks.
While this assumption ultimately appeals to a static view of portfolio choice, it has some
empirical content. Hortaçsu and Syverson (2004) ﬁnd signiﬁcant variation in assets under
management across similar mutual funds that remains unexplained by diﬀerences in fees (or
expected returns).

3. Instrumental Variables

We describe how to construct a valid instrument for log market equity in an ideal scenario in
which the investment universe is perfectly measured. In the following section, we will come
back to the issue of measuring the investment universe in practice.
     In estimating investor i’s asset demand, the instrument for log market equity of asset n
is
                                                                       
                                                      ½j (n)
                             i (n) = log
                            me                 Aj     N             .                              (19)
                                          j=i
                                                  1 +   m=1  ½ j (m)

This instrument depends only on the investment universe of other investors and the wealth
distribution, which are exogenous under our identifying assumptions. The instrument can
be interpreted as the counterfactual market equity, at the market clearing price, if other
investors were to hold an equal-weighted portfolio within their investment universe.9 For
   9
     To check the robustness of our results, we have tried an alternative instrument based on book equity
weights:
                                             ⎛                              ⎞
                                                         ½ j (n)BE(n)
                                i (n) = log ⎝
                               me                   Aj N                   ⎠.
                                               j=i     m=1    ½ j (m)BE(m)



                                                   18
example, technology funds hold an equal-weighted portfolio of technology stocks, health
care funds hold an equal-weighted portfolio of health care stocks, and so on.
   The instrument exploits variation in the investment universe across investors and the size
of potential investors across assets. An asset that is included in the investment universe of
more investors, especially if those investors are large, has a larger exogenous component of
demand. For example, a stock that is included in the S&P 500 index has a larger exogenous
component of demand coming from S&P 500 index funds (Harris and Gurel 1986; Shleifer
1986). With downward-sloping demand, a larger exogenous component of demand generates
higher prices that are unrelated to latent demand. Our identiﬁcation comes from cross-
sectional variation in the investment universe and not from time-series variation in assets
moving in and out of the investment universe.
  The instrument allows us to weaken moment condition (18) to

                                                    i (n), x(n)] = 1.
                                          E[i (n)|me                                                        (20)

This moment condition does not impose any assumptions on the correlation of latent demand
across investors or over time. Given the presence of zero holdings in the data, latent demand
has a positive mass at zero. However, a conditional mean of one in moment condition (20)
is a normalization that is fully consistent with the presence of zero holdings.10

B. Implementation Issues

1. Measuring the Investment Universe

With the exception of some mutual funds for which the investment mandate is clearly stated
(see Appendix E), most institutions do not publicly disclose investment mandates. We must
therefore measure the investment universe on the basis of observed holdings. As we described
in Section III, we measure the investment universe as stocks that are currently held or ever
held in the previous 11 quarters.
    The ideal scenario for arguing the exogeneity of the measured investment universe is
the case in which it did not change over time. A time-invariant investment universe lends
This instrument has an advantage that the cross-sectional distribution is closer to normal.
  10
     In particular, the probability that latent demand is zero depends on characteristics, which is consistent
with the portfolio choice model in Section II. To see this, we can rewrite moment condition (18) as

          E[i (n)|me
                    i (n), x(n)] = Pr(i (n) = 0|me
                                                   i (n), x(n)) E[i (n)|me
                                                                           i (n), x(n), i (n) = 0]
                                                                                  !               "
                                                                                  0
                                    + Pr(i (n) > 0|me
                                                     i (n), x(n))E[i (n)|me
                                                                            i (n), x(n), i (n) > 0] = 1.




                                                         19
credibility to our identifying assumption that it is predetermined and exogenous to current
demand shocks. Table 1 shows that the investment universe is not very far from the ideal
scenario, especially for larger institutions. For a larger institution at the 90th percentile
in assets under management, 97 percent of stocks that are currently held were also held in
the previous 11 quarters. This means that at least 97 percent of stocks in the investment
universe this quarter were also part of the investment universe in the previous quarter. Thus,
the potential threat to identiﬁcation is isolated to the 3 percent of stocks that newly entered
the investment universe. The fact that the set of stocks held hardly changes over time is
consistent with the presence of investment mandates.
   On the basis of this fact, we reﬁne the instrument to be more robust to the potential threat
to identiﬁcation. In constructing the instrument (19), we exclude the household sector and
aggregate only over institutions with little variation in the investment universe, for which at
least 95 percent of stocks that are currently held were also held in the previous 11 quarters.
On the basis of Table 1, most (especially larger) institutions have little variation in the
investment universe, so we are excluding only those institutions for which our identifying
assumption is most challenged.
   Although we have tried to make the best case for identiﬁcation, we want to summarize
our remaining concerns with the hope that future research could make further progress. By
deﬁnition, the investment universe is a broader set of stocks than those that are held in
the recent past. Therefore, we are concerned that our deﬁnition of the investment universe
may miss some stocks that could be held but have not been held in the recent past. Any
correlation between this mismeasurement and latent demand through correlated demand
shocks across investors could threaten identiﬁcation.
    Future research could improve on our framework through new data or methodology that
leads to better measurement of the investment universe. For example, exchange-traded funds
have been historically small in our sample, so we cannot reliably construct the instrument on
the basis of only exchange-traded funds. However, exchange-traded funds have been growing
and now account for 21 percent of domestic equity mutual funds and exchange-traded funds
combined (Board of Governors of the Federal Reserve System 2017). The secular trend from
active to passive management and the growth of exchange-traded funds could simplify the
measurement of the investment universe for a large share of institutions in the future.

2. Pooled Estimation

Table 2 shows that many institutions have concentrated portfolios, so the cross section of
an institution’s holdings may not be large enough to accurately estimate equation (10). We
estimate the coeﬃcients by institution whenever there are more than 1,000 strictly positive

                                              20
holdings in the cross section. For institutions with fewer than 1,000 holdings, we pool them
with similar institutions in order to estimate their coeﬃcients. As we previously described,
we group institutions by type and quantiles of assets under management conditional on type.
While the cutoﬀ of 1,000 is arbitrary, a lower cutoﬀ of 500 causes convergence problems for
our estimator in some cases. We set the total number of groups at each date to target 2,000
strictly positive holdings on average per group.

3. Weak Instruments

Cross-sectional variation in the instrument (19) is primarily driven by variation in the in-
vestment universe across investors. Put diﬀerently, the instrument would have no variation
if the investment universe were identical across investors. Fortunately, from an identiﬁcation
perspective, Table 2 shows that the investment universe is typically a small set of stocks.
From 2015 to 2017, the median institution had only 112 stocks in the investment universe,
and even institutions at the 90th percentile had only 748 stocks.
   A way to quantify the strength of the instrument is through a ﬁrst-stage regression of
log market equity onto the instrument and other characteristics. We estimate the ﬁrst-stage
regression for each institution at each date. Figure 1 reports the minimum ﬁrst-stage t-
statistic across institutions at each date. That is, all institutions have a ﬁrst-stage t-statistic
that is above the lower bound in the ﬁgure. For all institutions throughout the sample
period, the ﬁrst-stage t-statistic is well above the critical value of 4.05 for rejecting the null
of weak instruments at the 5 percent level (Stock and Yogo 2005, Table 5.2).11

C. Estimation on a Hypothetical Index Fund

We test the validity of our estimator for characteristics-based demand (10) on a hypothetical
index fund. We start with the portfolio weights of the Vanguard Group (manager number
90457), which has a fully diversiﬁed portfolio, and replace them with exact market weights.
That is, we construct an index fund that is the same size and has the same investment
universe as the Vanguard Group, whose portfolio weights are given by

                           wi (n)
                                  = exp{me(n) + βK,i }
                           wi (0)
                                   = exp{(me(n) − be(n)) + be(n) + βK,i },                                (21)
  11
     Under the null of weak instruments, the probability that the minimum ﬁrst-stage t-statistic is above the
critical value is at most 5 percent, which only attains if the t-statistics are perfectly positively correlated
across institutions.




                                                      21
where be(n) is log book equity. We then estimate characteristics-based demand (10) by
generalized method of moments (GMM) under moment condition (20). If our estimator is
valid, we should recover a coeﬃcient of one on log market equity and zero on the other
characteristics. Equivalently, we should recover a coeﬃcient of one on both log market-to-
book equity and log book equity on the basis of the alternative normalization (21).
   Figure 2 reports the estimated coeﬃcients for the hypothetical index fund. As expected,
we recover a coeﬃcient of one on both log market-to-book equity and log book equity and
zero on the other characteristics, except for small deviations because of estimation error.

D. Estimated Demand System

Figure 3 summarizes the coeﬃcients for characteristics-based demand (10), estimated by
GMM under moment condition (20). We report the cross-sectional mean of the estimated
coeﬃcients by institution type, weighted by assets under management. For ease of inter-
pretation, Figure 3 is on the same scale as Figure 2 and reports the coeﬃcients on log
market-to-book equity β0,i and log book equity β0,i + β1,i instead of β0,i and β1,i .
  A lower coeﬃcient on log market-to-book equity implies a higher demand elasticity (14).
Thus, Figure 3 shows that mutual funds have less elastic demand than other types of in-
stitutions or households for most of the sample period. Banks, insurance companies, and
pension funds have become less elastic from 1980 to 2017, while households have become
more elastic during the same period. In 2017, banks, insurance companies, mutual funds,
and pension funds have less elastic demand than investment advisors and households. This
ﬁnding is consistent with the view that large institutions cannot deviate too far from market
weights because of benchmarking or price impact.
    The coeﬃcient on log book equity captures demand for size. Especially in the second half
of the sample period, banks and insurance companies tilt their portfolio more toward larger
stocks than other types of institutions. In contrast, investment advisors tilt their portfolio
toward smaller stocks. Table D1 of Appendix D shows that the largest investment advisors
are an order of magnitude smaller than other types of large institutions. Therefore, our
ﬁndings are consistent with the fact that the size of institutions is positively related to the
average size of stocks in their portfolio (Blume and Keim 2012).
   On average, investment advisors tilt their portfolio more toward stocks with lower market-
to-book equity, higher proﬁtability, lower investment, and lower market beta than house-
holds. As we discussed in Section II, these characteristics enter the Fama-French ﬁve-factor
model and are known to generate positive abnormal returns relative to the capital asset
pricing model. Therefore, this ﬁnding is consistent with the view that some institutions are
“smart money” investors. The coeﬃcient on market beta for institutions tends to fall in

                                              22
recessions, which means that the demand for market risk is procyclical. For example, the
coeﬃcient on market beta for investment advisors is especially low in 1982:3, 2001:3, and
2009:1. Finally, households tilt their portfolio more toward higher-dividend stocks than in-
stitutions. Among institutions, banks tilt their portfolio more toward higher-dividend stocks
than other types of institutions.
   Given the estimated coeﬃcients, we recover estimates of latent demand by equation (10).
Figure 4 reports the cross-sectional standard deviation of log latent demand by institution
type, weighted by assets under management. A higher standard deviation implies more
extreme portfolio weights that are tilted away from observed characteristics. For most of
the sample period, households have less variation in latent demand than institutions. The
only exception is during the ﬁnancial crisis, when the standard deviation of latent demand
for households peaked in 2008:2.
    In Appendix F, we show that our benchmark estimates diﬀer from those estimated by
alternative estimators. We show the importance of the instrument by considering a restricted
least squares estimator that is biased if latent demand and asset prices are jointly endoge-
nous. We also show the importance of estimating in levels with zero holdings by considering
estimation of equation (10) in logarithms, which is less eﬃcient and potentially biased.


V.   Asset Pricing Applications

Let At be an I-dimensional vector of investors’ wealth, whose ith element is Ai,t . Let βt be
a (K + 1) × I matrix of coeﬃcients on characteristics, whose (k, i)th element is βk−1,i,t. Let
t be an N × I matrix of latent demand, whose (n, i)th element is i,t (n). Market clearing
(17) deﬁnes an implicit function for log price:

                                   pt = g(st , xt , At , βt , t ).                      (22)

That is, asset prices are fully determined by shares outstanding, characteristics, the wealth
distribution, the coeﬃcients on characteristics, and latent demand.
    We use equation (22) in four asset pricing applications. First, we use the model to
estimate the price impact of demand shocks for all institutions and stocks. Second, we
use the model to decompose the cross-sectional variance of stock returns into supply- and
demand-side eﬀects. Third, we use a similar variance decomposition to see whether larger
institutions explain a disproportionate share of the stock market volatility in 2008. Finally,
we use the model to predict cross-sectional variation in stock returns.




                                                 23
A.      Price Impact of Demand Shocks

If the aggregate demand for stocks is downward sloping, demand shocks could have persistent
eﬀects on prices. For example, an empirical literature documents the price impact of demand
shocks that arise from index additions and deletions (see Wurgler and Zhuravskaya 2002,
for a review). The estimated demand system in Section IV allows us to estimate the price
impact of demand shocks for all stocks, not just for those that are added or deleted from an
index.
       We deﬁne the coliquidity matrix for investor i as
                                                                −1
                        ∂pt               I
                                                          ∂w j,t                  ∂wi,t
                                                     −1                     −1
                                  =   I −     Aj,t H t        
                                                                     Ai,t H t
                    ∂ log(i,t )         j=1
                                                           ∂pt                 ∂ log(i,t )
                                                                  −1
                                          I
                                  = I−        Aj,t β0,j,t H−1
                                                            t Gj,t      Ai,t H−1
                                                                               t Gi,t .         (23)
                                           j=1


The (n, m)th element of this matrix is the elasticity of asset price n with respect to investor
i’s latent demand for asset m.12 The coliquidity matrix measures the price impact of id-
iosyncratic shocks to an investor’s latent demand. The matrix inside the inverse in equation
(23) is the aggregate demand elasticity (15), which implies a larger price impact for assets
that are held by less elastic investors. The nth diagonal element of the matrix outside the
                                                         
inverse in equation (23) is Ai,t wi,t (n)(1 − wi,t (n))/( Ij=1 Aj,t wj,t(n)). This expression implies
a larger price impact for investors whose holdings are large relative to other investors that
hold the asset.
   We estimate the price impact for each stock and institution through the diagonal elements
of matrix (23) and then average by institution type. Figure 5 summarizes the cross-sectional
distribution of price impact across stocks for the average bank, insurance company, invest-
ment advisor, mutual fund, and pension fund. Average price impact has decreased from
1980 to 2017, especially for the least liquid stocks at the 90th percentile of the distribution.
This means that the cross-sectional distribution of price impact has signiﬁcantly compressed
over this period. For example, the price impact for the average investment advisor with a 10
percent demand shock on the least liquid stocks (at the 90th percentile) has decreased from
0.64 percent in 1980:2 to 0.22 percent in 2017:2.
  12
   Kondor and Vayanos (2014) propose a liquidity measure that is a monotonic transformation of our
measure:
                          −1                                                      −1     −1
              ∂qi,t (n)            ∂pt (n)                                 ∂pt (n)
                                               = (1 − wi,t (n))   βi +                       −1     .
           ∂ log(i,t (n))     ∂ log(i,t (n))                         ∂ log(i,t (n))



                                                      24
     Summing equation (23) across all investors, we deﬁne the aggregate coliquidity matrix
as
                                                                            −1
               
               I
                          ∂pt                    
                                                 I                                 
                                                                                   I
                                    =       I−         β0,i,t Ai,t H−1
                                                                    t Gi,t               Ai,t H−1
                                                                                               t Gi,t .   (24)
                i=1
                      ∂ log(i,t )              i=1                               i=1


The aggregate coliquidity matrix measures the price impact of systematic shocks to latent
demand across all investors. The nth diagonal element of the matrix outside the inverse in
equation (24) is a holdings-weighted average of 1 − wi,t (n) across investors. This implies a
larger price impact for assets that are smaller shares of investors’ wealth, which are eﬀectively
assets with a lower market cap.
  We estimate the aggregate price impact for each stock through the diagonal elements of
matrix (24). Figure 6 summarizes the cross-sectional distribution of aggregate price impact
across stocks and how that distribution has changed over time. Aggregate price impact
for the median stock has generally decreased from 1980 to 2017. The price impact of a 10
percent aggregate demand shock for the median stock was 26 percent in 2017:2. Aggregate
price impact is countercyclical around the low-frequency trend, peaking during recessions in
1980:1, 1982:1, 1991:1, and 2009:1.

B. Variance Decomposition of Stock Returns

Following Fama and MacBeth (1973), a large literature asks to what extent characteristics
explain the cross-sectional variance of stock returns. A more recent literature asks whether
institutional demand explains the signiﬁcant variation in stock returns that remains un-
explained by characteristics (Nofsinger and Sias 1999; Gompers and Metrick 2001). We
introduce a variance decomposition of stock returns that oﬀers a precise answer to this
question.
   We start with the deﬁnition of log returns:

                                            rt+1 = pt+1 − pt + vt+1 ,

where vt+1 = log(1 + exp{dt+1 − pt+1 }). We then decompose the capital gain as

           pt+1 − pt = Δpt+1 (s) + Δpt+1 (x) + Δpt+1 (A) + Δpt+1 (β) + Δpt+1 (),




                                                           25
where

            Δpt+1 (s) =g(st+1 , xt , At , βt , t ) − g(st , xt , At , βt , t ),
            Δpt+1 (x) =g(st+1 , xt+1 , At , βt , t ) − g(st+1 , xt , At , βt , t ),
           Δpt+1 (A) =g(st+1 , xt+1 , At+1 , βt , t ) − g(st+1 , xt+1 , At , βt , t ),
           Δpt+1 (β) =g(st+1 , xt+1 , At+1 , βt+1 , t ) − g(st+1 , xt+1 , At+1 , βt , t ),
            Δpt+1 () =g(st+1 , xt+1 , At+1 , βt+1 , t+1 ) − g(st+1 , xt+1 , At+1 , βt+1 , t ).

We compute each of these counterfactual price vectors through the algorithm in Appendix C.
We then decompose the cross-sectional variance of log returns as

   Var(rt+1 ) =Cov(Δpt+1 (s), rt+1 ) + Cov(Δpt+1 (x), rt+1 ) + Cov(vt+1 , rt+1 )
                + Cov(Δpt+1 (A), rt+1 ) + Cov(Δpt+1 (β), rt+1 ) + Cov(Δpt+1 (), rt+1 ).            (25)

    According to equation (25), variation in asset returns must be explained by supply- or
demand-side eﬀects. The ﬁrst three terms represent the supply-side eﬀects due to changes
in shares outstanding, changes in characteristics, and the dividend yield. The last three
terms represent the demand-side eﬀects due to changes in assets under management, the
coeﬃcients on characteristics, and latent demand.
   Table 3 presents the variance decomposition of annual stock returns, pooled over 1981
to 2017. Because characteristics are updated in June for many stocks whose ﬁscal years
end in December, we use annual stock returns at the end of June to give characteristics
the best chance of explaining stock returns. On the supply side, shares outstanding explain
2.1 percent, and characteristics explain 9.7 percent of the cross-sectional variance of stock
returns. Dividend yield explains only 0.4 percent, which means that capital gain drives most
of the cross-sectional variance of stock returns.
    On the demand side, assets under management explain 2.3 percent, and the coeﬃcients
on characteristics explain 4.7 percent of the cross-sectional variance of stock returns. Latent
demand is clearly the most important, explaining most of the cross-sectional variance of stock
returns. The extensive margin of latent demand that captures changes in the set of stocks
held explains 23.3 percent. The intensive margin of latent demand that captures changes in
portfolio weights within the set of stocks held explains 57.5 percent. Thus, stock returns are
mostly explained by demand shocks that are unrelated to changes in observed characteristics.
This ﬁnding is consistent with the fact that cross-sectional regressions of stock returns on
characteristics have low explanatory power (Fama and French 2008; Asness, Frazzini, and
Pedersen 2013).


                                                       26
   Our variance decomposition establishes a new set of targets for a growing literature on
asset pricing models with institutional investors (see footnote 1). Because stock prices are a
nonlinear function of latent demand, our variance decomposition quantiﬁes the importance
of changes in the distribution of latent demand for the cross section of stock returns. Stock
returns depend on changes in average latent demand across investors, weighted by assets
under management, which captures changes in sentiment. In addition, stock returns depend
on changes in the dispersion of latent demand across investors, which captures changes in
disagreement. The importance of latent demand in our variance decomposition highlights the
importance of sentiment and disagreement for explaining the cross section of stock returns.

C. Stock Market Volatility in 2008

In the aftermath of the ﬁnancial crisis, various regulators have expressed concerns that large
investment managers could amplify volatility in bad times (Oﬃce of Financial Research 2013;
Haldane 2014). The underlying intuition is that even small shocks could translate to large
price movements through the sheer size of their balance sheets. Going against this intuition,
however, is the fact that large institutions tend to be diversiﬁed buy-and-hold investors
that hold more liquid stocks. We use demand system asset pricing to better understand the
relative contributions of institutions and households in explaining the stock market volatility
in 2008.
    We modify the variance decomposition (25) as

             Var(rt+1 ) =Cov(Δpt+1 (s) + Δpt+1 (x) + vt+1 , rt+1 )
                              
                              I
                          +         Cov(Δpt+1 (Ai ) + Δpt+1 (βi ) + Δpt+1 (i ), rt+1 ).
                              i=1


The ﬁrst term is the total supply-side eﬀect due to changes in shares outstanding, changes
in characteristics, and the dividend yield. The second term is the sum of the demand-side
eﬀects across all investors due to changes in assets under management, the coeﬃcients on
characteristics, and latent demand. In our implementation of the variance decomposition,
we ﬁrst order the 30 largest institutions by their assets under management at the end of
2007, then smaller institutions, and then households.
   Table 4 presents the variance decomposition of stock returns in 2008. The supply-side
eﬀects explain 8.1 percent of the cross-sectional variance of stock returns, which means that
the demand-side eﬀects explain the remainder of the variance. Barclays Bank (now part of
Blackrock) was the largest institution in 2007:4, managing $699 billion. Its assets fell by
41 percent from 2007:4 to 2008:4. During this period, its contribution to the cross-sectional


                                                  27
variance of stock returns was 0.3 percent. Summing across the 30 largest institutions, their
overall contribution to the cross-sectional variance of stock returns was 4.4 percent. Smaller
institutions explain 40.7 percent, and households explain 46.9 percent of the cross-sectional
variance of stock returns. The three groups of investors each managed about a third of the
stock market, and their assets fell by nearly identical shares in 2008. However, the relative
contribution of the 30 largest institutions to stock market volatility was much smaller than
that of smaller institutions and households. In unreported results, we ﬁnd that the variance
decomposition in Table 4 is remarkably stable over time and is not particular to the ﬁnancial
crisis.
    This ﬁnding is driven by two important aspects of larger institutions. First, larger insti-
tutions are diversiﬁed buy-and-hold investors. Therefore, their latent demand is more stable
over time than that of smaller institutions and households. Second, larger institutions hold
more liquid stocks with higher aggregate demand elasticity, for which demand shocks have
less price impact.

D. Predictability of Stock Returns

We approximate pT = g(sT , xT , AT , βT , T ) to a ﬁrst order around the conditional expec-
tation of its arguments at date t. Then the conditional expectation of the long-run capital
gain is

                 Et [pT − pt ] ≈ g(Et [sT ], Et [xT ], Et [AT ], Et [βT ], Et [T ]) − pt .

This equation implies that asset returns are predictable if any of its determinants are pre-
dictable.
    Because of the importance of latent demand in Table 3, we isolate mean reversion in
latent demand as a potential source of predictability in stock returns. We assume that
latent demand reverts to its unconditional mean of one in the long run and that all other
determinants of stock returns are random walks. That is, we assume that

                              Et [pT − pt ] = g(st , xt , At , βt , 1) − pt ,

where we compute the counterfactual price vector through the algorithm in Appendix C.
Thus, we have an estimate of the long-run expected return for each stock based on mean
reversion in latent demand. Intuitively, stocks with high latent demand, a stock-level measure
of sentiment, trade at high prices and have low expected returns in the future.
   To test whether our estimate of the long-run expected return predicts the cross section


                                                    28
of stock returns, we run a Fama-MacBeth regression of monthly excess returns, over the 1-
month Treasury-bill rate, onto lagged characteristics. That is, we estimate a cross-sectional
regression of excess returns onto lagged characteristics and then average the estimated coeﬃ-
cients in the time series over our sample period from June 1980 to December 2017. To control
for known sources of predictability, we control for all characteristics in the Fama-French ﬁve-
factor model (i.e., log market equity, book-to-market equity, proﬁtability, investment, and
market beta) and momentum (i.e., 11-month return, skipping the most recent month). We
use data that were public in month t to predict stock returns in month t + 1. For example,
our estimate of the long-run expected return in June uses the accounting data for the prior
December and the 13F ﬁling for March to leave an adequate window for reporting delays.
   Table 5 shows that expected monthly returns increase by 0.18 percent per one standard
deviation in the long-run expected return with a t-statistic of 4.80. Our estimate of the long-
run expected return uncovers a new source of predictability from mean reversion in latent
demand that is similar in magnitude to other characteristics that are known to predict stock
returns. To check the robustness of our results, we rerun the Fama-MacBeth regression
excluding microcaps, deﬁned as stocks whose market equity is below the 20th percentile for
NYSE stocks (Fama and French 2008). We continue to ﬁnd predictability with a statistically
signiﬁcant coeﬃcient of 0.11 percent. The smaller coeﬃcient, however, implies that the high
returns due to mean reversion in latent demand are more prominent for smaller stocks.


VI.     Extensions and Open Issues

We brieﬂy discuss potential extensions and open issues that are beyond the scope of this
paper, which we leave for future research.

A.     Endogenizing Supply and the Wealth Distribution

We have assumed that shares outstanding and asset characteristics are exogenous. However,
we could endogenize the supply side of demand system asset pricing, just as asset pricing in
endowment economies has been extended to production economies.13 Once we endogenize
corporate policies such as investment and capital structure, we could answer a broad set of
questions at the intersection of asset pricing and corporate ﬁnance. For example, how do
the portfolio decisions of institutions aﬀect real investment at the business cycle frequency
and growth at lower frequencies?
   We have also assumed that the wealth distribution is exogenous, or more fundamentally,
  13
    Recent work on incorporating institutional investors in production economies includes Gertler and Karadi
(2011), Adrian and Boyarchenko (2013), Brunnermeier and Sannikov (2014), and Coimbra and Rey (2017).



                                                    29
that net capital ﬂows between institutions are exogenous. By modeling how households allo-
cate wealth across institutions (e.g., Hortaçsu and Syverson 2004; Shin 2014), we could have
a more realistic demand system to better understand the relative importance of substitution
across institutions versus substitution across assets within an institution.

B. Other Holdings Data

The 13F data do not contain short positions, so we do not know short interest at the
institution level. However, data on aggregate short interest for each stock are available.
Therefore, we could construct an aggregate short interest sector and model it as one of the
investors that enter market clearing (16). While this approach is less ideal than having short
positions at the institution level, it could guide us on whether short interest matters for our
empirical results.
    Using the 13F data, we can compute only aggregate household holdings as the residual of
institutional holdings. In countries such as Sweden with complete household holdings data
(Calvet, Campbell, and Sodini 2007), asset demand for households could be estimated at a
more disaggregated level. We could then see whether households have correlated demand
shocks especially in bad times, which would explain why the standard deviation of latent
demand increased signiﬁcantly for households during the ﬁnancial crisis (see Figure 4).
   In principle, estimation of the characteristics-based demand system would improve if
we could incorporate other asset classes such as cash and ﬁxed income. Unfortunately, US
data on institutional bond holdings are incomplete because only insurance companies and
mutual funds are required to ﬁle their holdings. In addition, the bond holdings data (e.g.,
Thomson Reuters eMAXX) are not easy to merge with the 13F data. Securities Holdings
Statistics of the European Central Bank contain the complete institutional holdings across
all asset classes in the euro area (Koijen et al. 2017). These data could be used to estimate
a characteristics-based demand system for both equities and ﬁxed income in the euro area.


VII.   Conclusion

Traditional asset pricing models make strong assumptions that are not suitable for modeling
the asset demand of institutional investors. First, assumptions about preferences, beliefs,
and constraints imply asset demand with little heterogeneity across investors. Second, these
models assume that investors have no price impact because they are atomistic and their
demand shocks are uncorrelated. A more recent literature allows for some heterogeneity in
asset demand by modeling institutional investors explicitly (see footnote 1). However, it
has not been clear how to operationalize these models to take full advantage of institutional


                                              30
holdings data. Our contribution is to develop an asset pricing model with ﬂexible hetero-
geneity in asset demand that matches institutional and household holdings. We also propose
an instrumental variable estimator for the characteristics-based demand system to address
the endogeneity of demand and asset prices.
   Demand system asset pricing could answer a broad set of questions related to the role
of institutions in asset markets, which are diﬃcult to answer with reduced-form regressions
or event studies. For example, how do large-scale asset purchases aﬀect asset prices through
substitution eﬀects in institutional holdings? How would regulatory reform of banks and
insurance companies aﬀect asset prices and real investment? How does the secular shift
from deﬁned-beneﬁt to deﬁned-contribution plans aﬀect asset prices, as capital moves from
pension funds to mutual funds and insurance companies? Which institutions drive asset
pricing anomalies? We hope that our framework is useful for answering these types of
questions.




                                            31
References

Adrian, Tobias and Nina Boyarchenko. 2013. “Intermediary Leverage Cycles and Financial
 Stability.” Manuscript, Federal Reserve Bank of New York.

Asness, Cliﬀord S., Andrea Frazzini, and Lasse H. Pedersen. 2013. “Quality Minus Junk.”
  Manuscript, AQR Capital Management.

Basak, Suleyman and Anna Pavlova. 2013. “Asset Prices and Institutional Investors.” Amer-
  ican Economic Review 103 (5):1728–1758.

Ben-David, Itzhak, Francesco Franzoni, Rabih Moussawi, and John Sedunov. 2017. “The
  Granular Nature of Large Institutional Investors.” Working Paper no. 22247, NBER,
  Cambridge, MA.

Blake, David, Alberto G. Rossi, Allan Timmermann, Ian Tonks, and Russ Wermers. 2013.
  “Decentralized Investment Management: Evidence from the Pension Fund Industry.”
  Journal of Finance 68 (3):1133–1178.

Blume, Marshall E. and Donald B. Keim. 2012. “Institutional Investors and Stock Market
  Liquidity: Trends and Relationships.” Manuscript, University of Pennsylvania.

Board of Governors of the Federal Reserve System. 2017. Financial Accounts of the United
  States: Flow of Funds, Balance Sheets, and Integrated Macroeconomic Accounts. No. Z.1
  in Federal Reserve Statistical Release. Washington, DC: Board of Governors of the Federal
  Reserve System.

Brainard, William C. and James Tobin. 1968. “Pitfalls in Financial Model Building.” Amer-
  ican Economic Review: Papers and Proceedings 58 (2):99–122.

Brandt, Michael W., Pedro Santa-Clara, and Rossen Valkanov. 2009. “Parametric Portfolio
  Policies: Exploiting Characteristics in the Cross-Section of Equity Returns.” Review of
  Financial Studies 22 (9):3411–3447.

Brav, Alon, George M. Constantinides, and Christopher C. Geczy. 2002. “Asset Pricing with
  Heterogeneous Consumers and Limited Participation: Empirical Evidence.” Journal of
  Political Economy 110 (4):793–824.

Brunnermeier, Markus K. and Yuliy Sannikov. 2014. “A Macroeconomic Model with a
  Financial Sector.” American Economic Review 104 (2):379–421.



                                            32
Calvet, Laurent E., John Y. Campbell, and Paolo Sodini. 2007. “Down or Out: Assessing
  the Welfare Costs of Household Investment Mistakes.” Journal of Political Economy
  115 (5):707–747.

Campbell, John Y. 1991. “A Variance Decomposition for Stock Returns.” Economic Journal
  101 (405):157–179.

Campbell, John Y. and Luis M. Viceira. 2002. Strategic Asset Allocation: Portfolio Choice
  for Long-Term Investors. Clarendon Lectures in Economics. New York: Oxford University
  Press.

Coimbra, Nuno and Hélène Rey. 2017. “Financial Cycles with Heterogeneous Intermedi-
  aries.” Working Paper no. 23245, NBER, Cambridge, MA.

Dasgupta, Amil, Andrea Prat, and Michela Verardo. 2011. “The Price Impact of Institutional
 Herding.” Review of Financial Studies 24 (3):892–925.

DeMiguel, Victor, Lorenzo Garlappi, and Raman Uppal. 2009. “Optimal Versus Naive
  Diversiﬁcation: How Ineﬃcient Is the 1/N Portfolio Strategy?”      Review of Financial
  Studies 22 (5):1915–1953.

Fama, Eugene F. and Kenneth R. French. 1992. “The Cross-Section of Expected Stock
  Returns.” Journal of Finance 47 (2):427–465.

———. 1993. “Common Risk Factors in the Returns on Stocks and Bonds.” Journal of
  Financial Economics 33 (1):3–56.

———. 2008. “Dissecting Anomalies.” Journal of Finance 63 (4):1653–1678.

———. 2015. “A Five-Factor Asset Pricing Model.” Journal of Financial Economics
 116 (1):1–22.

Fama, Eugene F. and James D. MacBeth. 1973. “Risk, Return, and Equilibrium: Empirical
  Tests.” Journal of Political Economy 81 (3):607–636.

Gertler, Mark and Peter Karadi. 2011. “A Model of Unconventional Monetary Policy.”
  Journal of Monetary Economics 58 (1):17–34.

Gompers, Paul A. and Andrew Metrick. 2001. “Institutional Investors and Equity Prices.”
  Quarterly Journal of Economics 116 (1):229–259.

Haldane, Andrew G. 2014. “The Age of Asset Management?” Manuscript, Bank of England.

                                           33
Harris, Lawrence and Eitan Gurel. 1986. “Price and Volume Eﬀects Associated with Changes
  in the S&P 500 List: New Evidence for the Existence of Price Pressures.” Journal of
  Finance 41 (4):815–829.

He, Zhiguo and Arvind Krishnamurthy. 2013. “Intermediary Asset Pricing.” American
  Economic Review 103 (2):732–770.

Hortaçsu, Ali and Chad Syverson. 2004. “Product Diﬀerentiation, Search Costs, and Com-
  petition in the Mutual Fund Industry: A Case Study of S&P 500 Index Funds.” Quarterly
  Journal of Economics 119 (2):403–456.

Hou, Kewei, Chen Xue, and Lu Zhang. 2015. “Digesting Anomalies: An Investment Ap-
  proach.” Review of Financial Studies 28 (3):650–705.

Kellogg, R. B. 1976. “Uniqueness in the Schauder Fixed Point Theorem.” Proceedings of the
  American Mathematical Society 60 (1):207–210.

Koijen, Ralph S. J., François Koulischer, Benoı̂t Nguyen, and Motohiro Yogo. 2017. “Euro-
 Area Quantitative Easing and Portfolio Rebalancing.” American Economic Review: Pa-
 pers and Proceedings 107 (5):621–627.

Kondor, Péter and Dimitri Vayanos. 2014. “Liquidity Risk and the Dynamics of Arbitrage
  Capital.” Working Paper no. 19931, NBER, Cambridge, MA.

Kyle, Albert S. 1989. “Informed Speculation with Imperfect Competition.” Review of Eco-
 nomic Studies 56 (3):317–355.

Lancaster, Kelvin J. 1966. “A New Approach to Consumer Theory.” Journal of Political
  Economy 72 (2):132–157.

Lewellen, Jonathan. 2011. “Institutional Investors and the Limits of Arbitrage.” Journal of
  Financial Economics 102 (1):62–80.

Lintner, John. 1965. “The Valuation of Risk Assets and the Selection of Risky Investments in
  Stock Portfolios and Capital Budgets.” Review of Economics and Statistics 47 (1):13–37.

Lucas, Robert E., Jr. 1976. “Econometric Policy Evaluation: A Critique.” Carnegie-
  Rochester Conference Series on Public Policy 1:19–46.

———. 1978. “Asset Prices in an Exchange Economy.” Econometrica 46 (6):1429–1445.

MacKinlay, A. Craig and Ľuboš Pástor. 2000. “Asset Pricing Models: Implications for
 Expected Returns and Portfolio Selection.” Review of Financial Studies 13 (4):883–916.

                                            34
Mankiw, N. Gregory and Stephen P. Zeldes. 1991. “The Consumption of Stockholders and
 Nonstockholders.” Journal of Financial Economics 29 (1):97–112.

Markowitz, Harry. 1952. “Portfolio Selection.” Journal of Finance 7 (1):77–91.

Merton, Robert C. 1973. “An Intertemporal Capital Asset Pricing Model.” Econometrica
 41 (5):867–887.

Nofsinger, John R. and Richard W. Sias. 1999. “Herding and Feedback Trading by Institu-
  tional and Individual Investors.” Journal of Finance 54 (6):2263–2295.

Oﬃce of Financial Research. 2013. “Asset Management and Financial Stability.” Manuscript,
  U.S. Department of the Treasury.

Rosen, Sherwin. 1974. “Hedonic Prices and Implicit Markets: Product Diﬀerentiation in
  Pure Competition.” Journal of Political Economy 82 (1):34–55.

Ross, Stephen A. 1976. “The Arbitrage Theory of Capital Asset Pricing.” Journal of
  Economic Theory 13 (3):341–360.

Samuelson, Paul A. 1969. “Lifetime Portfolio Selection by Dynamic Stochastic Program-
  ming.” Review of Economics and Statistics 51 (3):239–246.

Santos Silva, J. M. C. and Silvana Tenreyro. 2006. “The Log of Gravity.” Review of Eco-
  nomics and Statistics 88 (4):641–658.

Sharpe, William F. 1964. “Capital Asset Prices: A Theory of Market Equilibrium under
  Conditions of Risk.” Journal of Finance 19 (3):425–442.

———. 1981. “Decentralized Investment Management.” Journal of Finance 36 (2):217–234.

Shiller, Robert J. 1981. “Do Stock Prices Move Too Much to be Justiﬁed by Subsequent
  Changes in Dividends?” American Economic Review 71 (3):421–436.

Shin, Chae Hee. 2014. “An Industrial Organization Approach to International Portfolio
  Diversiﬁcation: Evidence from the U.S. Mutual Fund Families.” Manuscript, Federal
  Reserve Board.

Shleifer, Andrei. 1986. “Do Demand Curves for Stocks Slope Down?” Journal of Finance
  41 (3):579–590.




                                           35
Stock, James H. and Motohiro Yogo. 2005. “Testing for Weak Instruments in Linear IV
  Regression.” In Identification and Inference for Econometric Models: Essays in Honor
  of Thomas Rothenberg, edited by Donald W. K. Andrews and James H. Stock, chap. 5.
  Cambridge: Cambridge University Press, 80–108.

Tobin, James. 1958. “Liquidity Preference as Behavior Towards Risk.” Review of Economic
  Studies 25 (2):65–86.

———. 1969. “A General Equilibrium Approach to Monetary Theory.” Journal of Money,
 Credit and Banking 1 (1):15–29.

Towers Watson. 2015. The World’s 300 Largest Pension Funds: Year End 2014. Arlington,
  VA: Towers Watson.

van Binsbergen, Jules H., Michael W. Brandt, and Ralph S. J. Koijen. 2008. “Optimal
  Decentralized Investment Management.” Journal of Finance 63 (4):1849–1895.

Vayanos, Dimitri. 2016. “Flight to Quality, Flight to Liquidity, and the Pricing of Risk.”
  Working Paper no. 10327, NBER, Cambridge, MA.

Vayanos, Dimitri and Paul Woolley. 2013. “An Institutional Theory of Momentum and
  Reversal.” Review of Financial Studies 26 (5):1087–1145.

Vissing-Jørgensen, Annette. 2002. “Limited Asset Market Participation and the Elasticity
  of Intertemporal Substitution.” Journal of Political Economy 110 (4):825–853.

Wharton Research Data Services. 2008. “User’s Guide to Thomson Reuters Mutual Fund
 and Investment Company Common Stock Holdings Databases on WRDS.” Manuscript,
  University of Pennsylvania.

———. 2016. “Research Note Regarding Thomson-Reuters Ownership Data Issues.”
 Manuscript, University of Pennsylvania.

———. 2018. “S12/S34 Regenerated Data (2010–2016).” Manuscript, University of Penn-
 sylvania.

Wilson, Robert. 1979. “Auctions of Shares.” Quarterly Journal of Economics 93 (4):675–689.

Wurgler, Jeﬀrey and Ekaterina Zhuravskaya. 2002. “Does Arbitrage Flatten Demand Curves
  for Stocks?” Journal of Business 75 (4):583–608.




                                           36
                                        Table 1
                         Persistence of the Set of Stocks Held


                  AUM                             Previous quarters
                  percentile     1    2     3    4        5    6    7    8   9    10 11
                  1             82   85   86    88    89      90   91   92   93   93   94
                  2             85   87   89    91    92      92   93   94   94   95   95
                  3             85   88   89    90    91      92   93   93   94   94   95
                  4             85   87   89    90    91      92   92   93   93   94   94
                  5             85   87   89    90    90      91   92   92   93   93   94
                  6             85   87   88    89    90      91   92   92   93   93   94
                  7             84   86   88    89    90      91   91   92   92   93   93
                  8             84   87   88    90    90      91   92   92   93   93   94
                  9             87   89   90    91    92      93   93   94   94   94   95
                  10            92   93   94    95    95      96   96   96   97   97   97

Note.—This table reports the percentage of stocks held in the current quarter that were ever held in the
previous one to eleven quarters. Each cell is a pooled median across time and all institutions in the given
assets under management (AUM) percentile. The quarterly sample period is from 1980:1 to 2017:4.




                                                     37
                                                                  Table 2
                                                         Summary of 13F Institutions


                                                            Assets under                                       Number of stocks
                                                            management                  Number of               in investment
                                                 % of        ($ million)                stocks held                universe
                                Number of market                         90th                      90th                       90th
                 Period        institutions held         Median     percentile     Median     percentile      Median     percentile
                 1980–1984              544         35       337         2,666          118           386          183          523




38
                 1985–1989              780         41       400         3,604          116           451          208          692
                 1990–1994              979         46       405         4,566          106           512          192          811
                 1995–1999            1,319         51       465         6,579          102           556          176          943
                 2000–2004            1,800         57       371         6,095           88           521          165          983
                 2005–2009            2,442         65       333         5,427           73           460          145          923
                 2010–2014            2,879         65       315         5,441           68           447          122          800
                 2015–2017            3,655         68       302         5,204           67           454          112          748

     Note.—This table reports the time-series mean of each summary statistic within the given period, based on Securities and Exchange Commission
     Form 13F. The quarterly sample period is from 1980:1 to 2017:4.
                                      Table 3
                       Variance Decomposition of Stock Returns


                                                                          % of
                                                                      variance
                         Supply:
                           Shares outstanding                               2.1
                                                                          (0.2)
                            Stock characteristics                           9.7
                                                                          (0.3)
                            Dividend yield                                  0.4
                                                                          (0.0)
                         Demand:
                           Assets under management                         2.3
                                                                         (0.1)
                            Coeﬃcients on characteristics                  4.7
                                                                         (0.2)
                            Latent demand: Extensive margin               23.3
                                                                         (0.3)
                            Latent demand: Intensive margin               57.5
                                                                         (0.4)
                         Observations                                  134,328

Note.—The cross-sectional variance of annual stock returns is decomposed into supply- and demand-side
eﬀects. Heteroskedasticity-robust standard errors are reported in parentheses. The annual sample period is
from 1981 to 2017.




                                                   39
                                     Table 4
                  Variance Decomposition of Stock Returns in 2008


      AUM                                                         AUM      Change in          % of
      ranking     Institution                                ($ billion)   AUM (%)          variance
                  Supply: Shares outstanding, stock
                    characteristics & dividend yield                                        8.1   (1.0)

      1           Barclays Bank                                      699           -41      0.3   (0.1)
      2           Fidelity Management & Research                     577           -63      0.9   (0.2)
      3           State Street Corporation                           547           -37      0.3   (0.0)
      4           Vanguard Group                                     486           -41      0.4   (0.0)
      5           AXA Financial                                      309           -70      0.3   (0.1)
      6           Capital World Investors                            309           -44      0.1   (0.1)
      7           Wellington Management Company                      272           -51      0.4   (0.1)
      8           Capital Research Global Investors                  270           -53      0.1   (0.1)
      9           T. Rowe Price Associates                           233           -44     -0.2   (0.1)
      10          Goldman Sachs & Company                            182           -59      0.1   (0.1)
      11          Northern Trust Corporation                         180           -46      0.1   (0.0)
      12          Bank of America Corporation                        159           -50      0.0   (0.1)
      13          J.P Morgan Chase & Company                         153           -51      0.1   (0.1)
      14          Deutsche Bank                                      136           -86      0.3   (0.1)
      15          Franklin Resources                                 135           -60      0.2   (0.1)
      16          College Retire Equities                            135           -55      0.0   (0.0)
      17          Janus Capital Management                           134           -53      0.3   (0.1)
      18          MSDW & Company                                     133            45      0.1   (0.1)
      19          Amvescap London                                    110           -42      0.0   (0.1)
      20          Dodge & Company                                     93           -65      0.0   (0.0)
      21          UBS Global Asset Management                         90           -63      0.0   (0.1)
      22          Davis Selected Advisers                             87           -54      0.0   (0.0)
      23          Neuberger Berman                                    86           -73      0.0   (0.1)
      24          Blackrock Investment Management                     86           -69      0.0   (0.0)
      25          OppenheimerFunds                                    83           -64      0.2   (0.1)
      26          Wells Fargo & Norwest Corporation                   75           -56      0.1   (0.1)
      27          MFS Investment Management                           73           -44      0.0   (0.0)
      28          Putnam Investment Management                        73           -76      0.1   (0.1)
      29          Marsico Capital Management                          73           -56      0.0   (0.0)
      30          Lord, Abbett & Company                              72           -61      0.3   (0.1)
                  Subtotal: 30 largest institutions                6,050           -48      4.4

                  Smaller institutions                            6,127            -53     40.7   (2.3)
                  Households                                      6,322            -47     46.9   (2.6)
                  Total                                          18,499            -49    100.0

Note.—The cross-sectional variance of annual stock returns in 2008 is decomposed into supply- and demand-
side eﬀects. This table reports the total demand-side eﬀect for each institution due to changes in assets under
management (AUM), the coeﬃcients on characteristics, and latent demand. The largest 30 institutions are
ranked by AUM in 2007:4. Heteroskedasticity-robust standard errors are reported in parentheses.
                                                      40
                                    Table 5
               Relation between Stock Returns and Characteristics


                                                            All Excluding
                            Characteristic               stocks microcaps
                            Expected return                0.18           0.11
                                                         (0.04)         (0.04)
                            Log market equity             -0.25          -0.15
                                                         (0.08)         (0.08)
                            Book-to-market equity          0.04           0.06
                                                         (0.04)         (0.05)
                            Proﬁtability                   0.30           0.29
                                                         (0.06)         (0.06)
                            Investment                    -0.38          -0.21
                                                         (0.03)         (0.03)
                            Market beta                    0.08           0.01
                                                         (0.08)         (0.10)
                            Momentum                       0.24           0.37
                                                         (0.08)         (0.10)

Note.—Monthly excess returns, over the 1-month T-bill rate, are regressed onto lagged characteristics. This
table reports the time-series mean and standard errors of the estimated coeﬃcients. Microcaps are stocks
whose market equity is below the 20th percentile for NYSE stocks. The monthly sample period is from June
1980 to December 2017.




                                                    41
                                   30
                                                Minimum across institutions
                                                Stock−Yogo critical value
                                   25
         First−stage t−statistic




                                   20


                                   15


                                   10


                                    5


                                    0
                                    1980:1   1985:1   1990:1   1995:1 2000:1 2005:1   2010:1   2015:1
                                                                  Year: Quarter



Figure 1. First-stage t-statistic on the instrument for log market equity. This ﬁgure reports
the minimum ﬁrst-stage t-statistic across institutions at each date. The critical value for
rejecting the null of weak instruments is 4.05 (Stock and Yogo 2005, Table 5.2). The quarterly
sample period is from 1980:1 to 2017:4.




                                                                     42
                               Log market−to−book equity                                                Log book equity
                    1                                                               1.2


                    .8
                                                                                      1
                    .6
     Coefficient




                                                                      Coefficient
                    .4                                                               .8


                    .2
                                                                                     .6
                    0


                   −.2                                                               .4
                     1995:1   2000:1   2005:1      2010:1   2015:1                    1995:1   2000:1     2005:1      2010:1   2015:1
                                       Year: Quarter                                                      Year: Quarter

                                       Profitability                                                      Investment
                    2                                                                2


                   1.5                                                              1.5


                    1                                                                1
     Coefficient




                                                                      Coefficient




                    .5                                                               .5


                    0                                                                0


                   −.5                                                              −.5


                   −1                                                               −1
                     1995:1   2000:1   2005:1      2010:1   2015:1                    1995:1   2000:1     2005:1      2010:1   2015:1
                                       Year: Quarter                                                      Year: Quarter

                                Dividends to book equity                                                 Market beta
                    15                                                               .8


                                                                                     .6
                    10

                                                                                     .4
                     5
     Coefficient




                                                                      Coefficient




                                                                                     .2

                     0
                                                                                     0

                    −5
                                                                                    −.2


                   −10                                                              −.4
                     1995:1   2000:1   2005:1      2010:1   2015:1                    1995:1   2000:1     2005:1      2010:1   2015:1
                                       Year: Quarter                                                      Year: Quarter




Figure 2. Coeﬃcients on characteristics for an index fund. Characteristics-based demand
(10) is estimated for a hypothetical index fund, which is the same size and has the same
investment universe as the Vanguard Group, at each date by GMM under moment condition
(20). The quarterly sample period is from 1997:1 to 2017:4.

                                                                     43
                                    Log market−to−book equity                                                 Log book equity
                          1                                                                   1.2


                          .8
                                                                                                1
                          .6
      Mean coefficient




                                                                           Mean coefficient
                          .4                                                                   .8


                          .2                   Banks
                                               Insurance companies
                                                                                               .6
                                               Investment advisors
                          0                    Mutual funds
                                               Pension funds
                                               Households
                         −.2                                                                   .4
                           1980:1    1990:1        2000:1        2010:1                         1980:1   1990:1         2000:1     2010:1
                                              Year: Quarter                                                        Year: Quarter

                                              Profitability                                                       Investment
                          2                                                                    2


                         1.5                                                                  1.5


                          1                                                                    1
      Mean coefficient




                                                                           Mean coefficient




                          .5                                                                   .5


                          0                                                                    0


                         −.5                                                                  −.5


                         −1                                                                   −1
                           1980:1    1990:1        2000:1        2010:1                         1980:1   1990:1        2000:1      2010:1
                                              Year: Quarter                                                       Year: Quarter

                                     Dividends to book equity                                                     Market beta
                          15                                                                   .8


                                                                                               .6
                          10

                                                                                               .4
      Mean coefficient




                                                                           Mean coefficient




                           5
                                                                                               .2

                           0
                                                                                               0


                          −5                                                                  −.2


                                                                                              −.4
                         −10
                           1980:1    1990:1         2000:1       2010:1                         1980:1   1990:1        2000:1      2010:1
                                               Year: Quarter                                                      Year: Quarter




Figure 3. Coeﬃcients on characteristics. Characteristics-based demand (10) is estimated for
each institution at each date by GMM under moment condition (20). This ﬁgure reports
the cross-sectional mean of the estimated coeﬃcients by institution type, weighted by assets
under management. The quarterly sample period is from 1980:1 to 2017:4.

                                                                          44
                               2




                              1.5
         Standard deviation




                               1


                                                                              Banks
                                                                              Insurance companies
                               .5
                                                                              Investment advisors
                                                                              Mutual funds
                                                                              Pension funds
                                                                              Households
                               0
                                1980:1   1985:1   1990:1   1995:1 2000:1 2005:1   2010:1   2015:1
                                                              Year: Quarter



Figure 4. Standard deviation of latent demand. Characteristics-based demand (10) is es-
timated for each institution at each date by GMM under moment condition (20). This
ﬁgure reports the cross-sectional standard deviation of log latent demand by institution
type, weighted by assets under management. The quarterly sample period is from 1980:1 to
2017:4.




                                                               45
                                             .16                      Banks                 90th percentile
                                                                                            Median
                                             .12                                            10th percentile

                                             .08


                                             .04
      Elasticity of price to latent demand




                                              0

                                             .16       Insurance companies               Investment advisors

                                             .12


                                             .08


                                             .04


                                              0

                                             .16                Mutual funds                  Pension funds

                                             .12


                                             .08


                                             .04


                                              0
                                               1980:1 1990:1 2000:1 2010:1     1980:1 1990:1 2000:1 2010:1
                                                                    Year: Quarter


Figure 5. Price impact across stocks and institutions. Price impact for each stock and
institution is estimated through the diagonal elements of matrix (23), then averaged by
institution type. This ﬁgure summarizes the cross-sectional distribution of price impact
across stocks for the average bank, insurance company, investment advisor, mutual fund,
and pension fund. The quarterly sample period is from 1980:1 to 2017:4.
                                           46
                                                5
         Elasticity of price to latent demand




                                                4




                                                3




                                                2

                                                            90th percentile
                                                            Median
                                                            10th percentile
                                                1
                                                1980:1   1985:1   1990:1      1995:1 2000:1 2005:1   2010:1   2015:1
                                                                                 Year: Quarter



Figure 6. Aggregate price impact across stocks. Aggregate price impact for each stock is
estimated through the diagonal elements of matrix (24). This ﬁgure summarizes the cross-
sectional distribution of aggregate price impact across stocks. The quarterly sample period
is from 1980:1 to 2017:4.




                                                                                   47
Appendix A.          Proofs

   Proof of Lemma 1. We write expected log utility over wealth at date T as

                                              
                                              T −1       #          $
                                                              Ai,s+1
      Ei,t [log(Ai,T )] = log(Ai,t ) +               Ei,t log
                                              s=t
                                                               Ai,s
                                              
                                              T −1
                                                                           
                         = log(Ai,t ) +              Ei,t [log(Rs+1 (0) + wi,s (Rs+1 − Rs+1 (0)1))].            (A1)
                                              s=t


Then the ﬁrst-order condition for the Lagrangian (4) is
                                               −1                           
               ∂Li,t                    Ai,t+1
                     = Ei,t                            (Rt+1 − Rt+1 (0)1) + Λi,t − λi,t 1 = 0.                  (A2)
               ∂wi,t                     Ai,t

                                   
Multiplying this equation by 1wi,t    and using the intertemporal budget constraint (1) to
               
subsitute out wi,t (Rt+1 − Rt+1 (0)1)), we have
                                           −1               
                                    Ai,t+1                           
                        Ei,t                       Rt+1 (0)1 = 1 + 1wi,t (Λi,t − λi,t 1).                       (A3)
                                     Ai,t

Equation (6) follows by adding equations (A2) and (A3).
   We approximate equation (A1) as

                                                      
                                                      T −1      #                                        $
                                                                                
                                                                                             wi,s Σs wi,s
           Ei,t [log(Ai,T )] ≈ log(Ai,t ) +                  Ei,t rs+1 (0) +   wi,s μi,s   −                ,
                                                       s=t
                                                                                                  2

which follows from Campbell and Viceira (2002, equation 2.23):
                                                                             2     
                     Ai,t+1                          
                                                                               σi,t   wi,t Σi,t wi,t
           log                    ≈ rt+1 (0) +      wi,t    rt+1 − rt+1 (0)1 +      −                .
                      Ai,t                                                      2           2

Then the ﬁrst-order condition for the Lagrangian (4) is

                                   ∂Li,t
                                         = μi,t − Σi,t wi,t + Λi,t − λi,t 1 = 0.
                                   ∂wi,t

Solving for the optimal portfolio, we have

                                         wi,t = Σ−1
                                                 i,t (μi,t + Λi,t − λi,t 1).                                    (A4)




                                                               48
        Partition
          %        the& short-sale constraints into those that are not binding versus binding as
Λi,t            (2)
        = 0 Λi,t . We also partition the covariance matrix (5) and write its inverse as

                                                   (1)                           (1,1)−1    (1,2)   (2)
                                                                                                           
                                                  Ωi,t                       −Σi,t          Σi,t Ωi,t
                             Σ−1
                              i,t =         (2,2)−1       (2,1)        (1)              (2)                    ,
                                        −Σi,t         Σi,t Ωi,t                       Ωi,t

where
                                                                       −1
                                      (1)    (1,1)  (1,2) (2,2)−1 (2,1)
                                     Ωi,t = Σi,t − Σi,t Σi,t     Σi,t       ,
                                                                       −1
                                      (2)    (2,2)  (2,1) (1,1)−1 (1,2)
                                     Ωi,t = Σi,t − Σi,t Σi,t     Σi,t       .

Then equation (A4) becomes
              (1)      ⎡                                                           ⎤
                               (1)(1)             (1,1)−1 (1,2) (2)    (2)  (2)
              wi,t           Ωi,tμi,t − λi,t 1 − Σi,t    Σi,t Ωi,t μi,t + Λi,t − λi,t 1
                       = ⎣ (2,2)−1 (2,1) (1)  (1)         
                                                                 (2)
                                                                     
                                                                        (2)  (2)
                                                                                        ⎦ .
                0         −Σi,t     Σi,t Ωi,t μi,t − λi,t 1 + Ωi,t μi,t + Λi,t − λi,t 1

                                                (1,1)−1        (1,2)
Multiplying the second block by Σi,t                      Σi,t          and adding the two blocks, we have
                                                                                    
                        (1)           (1,1)−1 (1,2) (2,2)−1 (2,1)    (1)   (1)
                       wi,t = I − Σi,t         Σi,t Σi,t   Σi,t     Ωi,t μi,t − λi,t 1
                                                     
                              (1,1)−1      (1)
                            =Σi,t        μi,t − λi,t 1 .

        The portfolio weight on the outside asset is

                                     wi,t (0) =1 − 1 wi,t
                                                                  (1)

                                                                                          
                                                               (1,1)−1        (1)
                                                =1 − 1         Σi,t           μi,t − λi,t 1 .

When constraint (3) binds, we have
                                                                                       
                                     1 wi,t = 1 Σi,t
                                          (1)          (1,1)−1              (1)
                                                                           μi,t − λi,t 1 = 1.

Solving for λi,t , we have
                                                                          
                                                max 1 Σi,t
                                                        (1,1)−1 (1)
                                                               μi,t − 1, 0
                                       λi,t =                           (1,1)−1
                                                                                               .                   (A5)
                                                                 1 Σi,t          1

                                                                                                                   QED



                                                                   49
                                                                         (1)       (1)
    Proof of Proposition 1. Under Assumption 1, let μi,t = yi,t Φi,t + φi,t 1 be the vector
of expected excess returns on assets for which the short-sale constraints are not binding.
               (1)      (1)
Similarly, let Γi,t = yi,t Ψi,t + ψi,t 1 be the vector of factor loadings on those assets. The
vector of optimal portfolio weights is
                                             −1                
                 (1)        (1) (1)                 (1)
                wi,t = Γi,t Γi,t + γi,t I           μi,t − λi,t 1
                                                     
                        1
                                          (1) (1)
                                         Γi,t Γi,t                      
                                                            (1)
                     =         I − (1) (1)                μi,t − λi,t 1
                       γi,t          Γi,t Γi,t + γi,t
                        1  (1)                               
                                                                  (1)
                                                                             
                     =         y Φi,t + φi,t 1 − λi,t 1 − yi,t Ψi,t + ψi,t 1 κi,t
                       γi,t i,t
                          (1)
                      =yi,t Πi,t + πi,t 1,

where the second line follows from the Woodbury matrix identity and
                                                                         
                                               (1)         (1)
                                              Γi,t         μi,t   − λi,t 1
                                     κi,t =        (1) (1)
                                                                               .                 (A6)
                                                Γi,t Γi,t + γi,t

                                                                                                 QED
                                    %      &
                               
    Proof of Corollary 1. Let βi,t    
                                   = βi,t 1 . We restrict the coeﬃcients on characteristics
in equation (8) so that
                                                   ⎡        ⎤
                                                 β
                                                   i,t
                                                           ⎥
                                     Πi,t    ⎢1
                                             ⎢
                                            = vec βi,t βi,t ⎥
                                                        
                                    wi,t (0) ⎣ 2   ..
                                                            ⎦
                                                    .

and πi,t = wi,t (0). Then equation (8) becomes

                wi,t (n)                 Πi,t
                         =1 + yi,t (n)
                wi,t (0)                wi,t (0)
                                                                                      
                                                vec(xi,t (n)xi,t (n) ) vec βi,t βi,t
                                                                                   

                        =1 + xi,t (n) βi,t +                                              ···
                                             m             2
                          M   xi,t (n) βi,t                        
                        =                        → exp xi,t (n) βi,t
                          m=0
                                     m!

in the limit as M → ∞.                                                                           QED



                                                       50
   Proof of Proposition 2. The function f(p) is continuous and continuously diﬀerentiable
                                                                               '    (
because wi (p) is continuous and continuously diﬀerentiable. We construct a set p, p ∈ RN
                   '    (           '    (
such that f(p) ∈ p, p for all p ∈ p, p . Then the Brouwer ﬁxed-point theorem implies
existence because f is a continuous function mapping a convex compact set to itself.
    Let f (p; n) be the nth element of f(p), and let wi (p; n) be the nth element of wi (p).
Since wi (p; n) < 1, we have an upper bound for each asset:
                                                               
                                              
                                              I
                         f (p; n) < log             Ai ½i (n)       − s(n) = p(n).
                                              i=1


Let B+ = {i|β0,i ∈ (0, 1)} be the set of investors for whom the coeﬃcient on log market
equity is strictly positive, and let B− = {i|β0,i ≤ 0} be the complement set of investors. We
construct a function f(p) that bounds f(p) from below as
                         ⎧                    
                         ⎨log       A w
                                     i i (p; n)   − s if {i ∈ B+ |i (n) > 0} = ∅
                                i∈B
    f (p; n) ≥ f(p; n) =       +                                               .       (A7)
                         ⎩log       A w  (p; n)   − s otherwise
                                i∈B− i i


The ﬁrst case covers the set of assets that are held by at least one investor whose coeﬃcient
on log market equity is strictly positive.
   By the mean value theorem, there is a p ∈ (p, p) such that

                                                          ∂ f (p; n)
                             f (p; n) = f (p; n) −                   (p − p).             (A8)
                                                             ∂p

Let β = maxi {β0,i } be the largest coeﬃcient on log market equity, and let β = mini {β0,i } be
the smallest coeﬃcient. In the ﬁrst case of equation (A7), the mth element of the gradient
is
                             ⎧
                             ⎪   i∈B+ β0,i Ai wi (
                                                  p;n)(1−wi (p;n))   *     +
                ∂ f (p; n)   ⎨        
                                                Ai wi (
                                                       p;n)
                                                                    ∈  0, β   if m = n
                           = i∈B −βi∈B      +
                                         0,i Ai wi (
                                                    p;n)wi (
                                                            p;m)                       .
                 ∂p(m)       ⎪
                             ⎩      +
                                                                  < 0         if m = n
                                        i∈B+  Ai wi (p;n)


In the second case of equation (A7), the mth element of the gradient is
                            ⎧
                            ⎪ i∈B− β0,i Ai wi (p;n)(1−wi (p;n)) ≤ 0
                ∂ f (p; n) ⎨         i∈B− Ai wi (  p;n)
                                                                             if m = n
                          =        −β0,i Ai wi ( p;n)wi (
                                                          p;m)     '       +          .
                 ∂p(m)      ⎪
                            ⎩ i∈B−                              ∈   0, −β   if m = n
                                        i∈B−Ai wi (p;n)

                                                                       ,    -
That is, the diagonal elements of the gradient are bounded above by max β, 0 , and the


                                                     51
                                                  ,      -
oﬀ-diagonal elements are bounded above by max −β, 0 . Therefore, we can construct a
matrix B suﬃciently large such that I − B is invertible and

                      f(p) ≥ f (p) − B(p − p) ≥ f (p) − B(p − p) = p
           '    (
for all p ∈ p, p . Solving for the lower bound, we have
                                                        
                                  p = (I − B)−1 f(p) − Bp .                                         (A9)

   We verify the two suﬃcient conditions for uniqueness in the Brouwer ﬁxed-point theorem
                                                            '   (
(Kellogg 1976). First, p = f(p) on the boundary of the set p, p by construction. Second,
one is not an eigenvalue of ∂f/∂p if
                                                      
                   ∂f                        I
                                                    ∂w i
           det I −       = det(H−1 ) det H −      Ai 
                   ∂p                       i=1
                                                    ∂p
                                         ⎛
                                                           
                         = det(H−1 ) det ⎝   Ai diag(wi ) −   β0,i Ai Gi
                                                  i∈B−                      i∈B−
                                                                                        ⎞
                                                                    
                              +          (1 − β0,i )Ai diag(wi ) +          β0,i Ai wi wi ⎠ > 0.
                                  i∈B+                               i∈B+


Note that det(H−1 ) > 0 because H−1 is symmetric positive deﬁnite. The second determinant
on the right side is also positive because the expression inside the parentheses is a sum of
four symmetric positive deﬁnite matrices.
    Suppose that all assets have at least one investor whose coeﬃcient on log market equity
is strictly greater than −1. In equation (A7), we redeﬁne B− = {i|β0,i ∈ (−1, 0]} and
β = mini∈B− {β0,i } to economize on notation. We bound the function (A8) from below on
the basis of only the positive elements of the gradient:
           ⎧
           ⎪
           ⎪              f(
             f(p; n) − ∂∂p(n)p;n)
                                  (p(n) − p(n)) ≥ f (p; n) − β(p(n) − p(n))
           ⎪
           ⎪
           ⎪
           ⎪
           ⎨       if {i ∈ B+ |i (n) > 0} = ∅
f (p; n) ≥                                                                                            .
           ⎪
           ⎪ f (p; n) − m=n ∂∂p(m) f(
                                       p;n)
                                            (p(m) − p(m)) ≥ f(p; n) + β maxm=n {p(m) − p(m)}
           ⎪
           ⎪
           ⎪
           ⎪
           ⎩       otherwise




                                                   52
         ,     -
Since max β, −β ∈ (0, 1) by assumption, there is a scalar p suﬃciently small such that
                                          ,     -            
               f (p; n) ≥ min f (p; n) − max β, −β max{p(n)} − p ≥ p                      (A10)
                           n                                   n


for all assets. Suppose that there are two ﬁxed points p1 , p2 ∈ RN . By inequality (A10),
                                                 '     (          '     (            '    (
there is a p suﬃciently small such that p1 , p2 ∈ p1, p and f(p) ∈ p1, p for all p ∈ p1, p .
                                                                              '     (
By the argument above based on Kellogg (1976), a unique ﬁxed point exists in p1, p , which
is a contradiction. Therefore, we have a stronger result that a unique ﬁxed point exists in
RN .                                                                                 QED


Appendix B.       Empirical Relevance of Characteristics-Based Demand

A benchmark implementation of the mean-variance portfolio uses the usual statistical for-
mulas for sample mean and covariance. However, this approach leads to notoriously poor
estimates of the mean-variance portfolio because of sampling error over many parameters.
    We design an exercise that illustrates the empirical relevance of the distributional as-
sumptions and parametric restrictions under which the mean-variance portfolio simpliﬁes to
characteristics-based demand. In each month from December 1979 to November 2017, we
estimate the mean-variance portfolio on the universe of S&P 500 stocks and the 1-month
Treasury-bill as the outside asset, subject to short-sale constraints. In the benchmark imple-
mentation, we estimate the sample mean and covariance of stock returns using a 60-month
moving window. The ﬁrst column of Table B1 reports that the benchmark implementation
achieves monthly returns with a mean of 1.1 percent and a standard deviation of 4.3 per-
cent. The certainty equivalent return under log utility (i.e., exp{E[log(At+1 /At )]} − 1) is 1.0
percent per month.
   Motivated by the empirical asset pricing literature, we can better estimate the mean-
variance portfolio (i.e., achieve a higher certainty equivalent return) by exploiting the factor
structure in returns and the fact that expected returns and factor loadings are well captured
by a few characteristics. In an alternative implementation, we ﬁrst estimate expected returns
and factor loadings through a pooled ordinary least squares regression of monthly excess
returns, over the 1-month Treasury-bill rate, onto excess market returns using a 60-month
moving window. The regression equation is

                    rt+1 (n) − rt+1 (0) = xt (n) Φ + xt (n) Ψft+1 + νt+1 (n),

where ft+1 is the market factor that is standardized over the 60-month moving window. The
K-dimensional vector Φ determines the relation between expected returns and characteris-


                                                53
                                    Table B1
              Three Implementations of the Mean-Variance Portfolio


                                                                     Factor
               Statistic                         Benchmark        structure Characteristics
               Mean (%)                                     1.1          1.5                   1.5
               Standard deviation (%)                       4.3          6.2                   5.9
               Certainty equivalent (%)                     1.0          1.3                   1.3
               Correlation:
                 Factor structure                         0.54
                 Characteristics                          0.50          0.93

Note.—The benchmark implementation of the mean-variance portfolio uses the sample mean and covariance
matrix. The second implementation imposes a one-factor structure on returns, where expected returns and
factor loadings are linear in characteristics (i.e., log market equity, log book equity, proﬁtability, investment,
dividends to book equity, and market beta). The third implementation approximates the portfolio weights
from the second implementation as an exponential-linear function of characteristics. The monthly sample
period is from January 1980 to December 2017.


tics, and the K-dimensional vector Ψ determines the relation between factor loadings and
characteristics. We standardize the characteristics in the cross section of stocks at each date
to address potential non-stationarity. The vector of expected returns and the covariance
matrix are

                           Et [rt+1 − rt+1 (0)1] =xt Φ,
                                               Σt =xt ΨΨ xt + diag(Var(νt+1 )).

Thus, the dimensionality of the mean-variance portfolio is reduced to only K parameters for
expected returns and K + N parameters for the covariance matrix.
    Motivated by the Fama-French ﬁve-factor model, the characteristics that we use in the
factor-structure implementation of the mean-variance portfolio are log market equity, log
book equity, proﬁtability, investment, dividends to book equity, and market beta. We refer
to Section III for a detailed description of these variables. The second column of Table B1
reports that the factor-structure implementation achieves monthly returns with a mean of
1.5 percent and a standard deviation of 6.2 percent. The certainty equivalent return under
log utility is 1.3 percent per month, which is higher than the 1.0 percent for the benchmark
implementation. Our exercise essentially replicates the known result that exploiting the
empirical relation between expected returns, factor loadings, and characteristics leads to
better estimates of the mean-variance portfolio (Brandt, Santa-Clara, and Valkanov 2009;


                                                       54
DeMiguel, Garlappi, and Uppal 2009).
   Because characteristics-based demand is derived from the mean-variance portfolio, the
substitution eﬀects implied by the model are consistent with optimal portfolio choice. To
illustrate this empirically, we consider a special case of equation (10) without latent demand
by setting i,t (n) = 1 for all assets n ∈ Ni,t . We then estimate the coeﬃcients on characteris-
tics by ordinary least squares to best match the portfolio weights under the factor-structure
implementation of the mean-variance portfolio. Again, the characteristics that we use are log
market equity, log book equity, proﬁtability, investment, dividends to book equity, and mar-
ket beta. The third column of Table B1 reports that characteristics-based demand achieves
the same mean, a lower standard deviation, and the same certainty equivalent return (up to
rounding at 0.1 percent) as the factor-structure implementation. The correlation in monthly
returns between the factor-structure implementation and characteristics-based demand is
0.93.
   In summary, Table B1 teaches us two lessons about implementing the mean-variance
portfolio. First, the improvement in the certainty equivalent return from the ﬁrst to the
second column teaches us the importance of exploiting the factor structure in returns and
the fact that expected returns and factor loadings are well captured by a few characteris-
tics. Second, the negligible diﬀerence in the certainty equivalent return between the second
and third columns teaches us that an exponential-linear function of characteristics closely
approximates the mean-variance portfolio. These results together show that characteristics-
based demand is an implementation of the mean-variance portfolio with good empirical
performance.


Appendix C.       Algorithm for Computing the Equilibrium

This appendix describes an eﬃcient algorithm for computing the equilibrium price vector
in any counterfactual experiment. Starting with any price vector pm , the Newton’s method
would update the price vector through
                                                 −1
                                          ∂f(pm )
                        pm+1   = pm + I −             (f(pm ) − pm ).
                                            ∂p




                                               55
For our application, this approach would be computationally slow because the Jacobian has
a large dimension. Therefore, we approximate the Jacobian with only its diagonal elements:
                              .             /
             ∂f(pm )             ∂f (pm )
                     ≈diag min            ,0
               ∂p                ∂p(n)
                                                                               
                                    I
                                    i=1 β0,i Ai w i (pm ; n)(1 − w i (pm ; n))
                     =diag min               I                                ,0    ,
                                                i=1 Ai wi (pm ; n)


where the minimum ensures that the elements are bounded away from one. We have found
that this algorithm is fast and reliable, converging in fewer than 100 steps in our asset pricing
applications.


Appendix D.       Institution Types

To group institutions into six types, we use the type codes from the Thomson Reuters
Institutional Holdings Database (s34 ﬁle) and manager numbers and names from the Mutual
Fund Holdings Database (s12 ﬁle). Thomson Reuters assigns each manager to a type code:
1) banks, 2) insurance companies, 3) investment companies, 4) investment advisors, and
5) other managers (i.e., pension funds, endowments, and foundations). Unfortunately, the
type codes contain errors since December 1998 (Wharton Research Data Services 2008). We
correct the type codes through the following steps.

  1. For managers that existed prior to December 1998, we replace the incorrect type code
     after December 1998 with the correct one before that date.

  2. In cases where the type code for a manager changes, we use the most recent type code
     so that a manager has a unique type code throughout the sample.

  3. We construct a database of investment advisors based on the historical archives of
      Securities and Exchange Commission Form ADV since June 2006. We use the bigram
      algorithm to match manager names to business or legal names in the investment advisor
      database. We reassign type code 5 to 4 when a valid match exists.

   On the basis of the corrected type codes, we assign type code 1 to banks and 2 to insurance
companies. We assign type codes 3 through 5 to mutual funds if the manager number and
name matches a record in the Mutual Fund Holdings Database. Otherwise, we assign type
codes 3 and 4 to investment advisors. We assign type codes 3 through 5 to pension funds
on the basis of the manager name and the list of top 300 pension funds (Towers Watson
2015). Finally, any remaining type code 5 is corrected if the CIK number matches a record

                                                56
in the Thomson Reuters Ownership Database. We assign the owner types to banks (101
and 302), insurance companies (108), investment advisors (106, 107, 113, and 402), mutual
funds (401), and pension funds (110 and 114).
  Table D1 summarizes the 13F institutions in our sample by type from 1980 to 2017.
We note that these statistics do not necessarily match the US national accounts (Board
of Governors of the Federal Reserve System 2017). The reason is that the 13F ﬁlings are
based on who exercises investment discretion over the assets, whereas the national accounts
are based on who ultimately owns the assets. For example, the assets of a pension fund
whose portfolio is managed by an investment advisor would be accounted under investment
advisors according to the 13F ﬁlings but under pension funds in the national accounts.




                                            57
                                               Table D1
                                  Summary of 13F Institutions by Type


                                               Assets under                                    Number of stocks
                                               management                 Number of             in investment
                                     % of       ($ million)               stocks held              universe
                    Number of      market                 90th                       90th                    90th
      Period       institutions      held   Median   percentile      Median     percentile    Median    percentile
                                                               A. Banks
      1980–1984            206         14      332       2,892            160         498        236          662
      1985–1989            202         14      495       4,230            203         602        323          893
      1990–1994            200         13      492       6,220            205         720        321        1,071
      1995–1999            174         11      595      15,924            226       1,055        335        1,595
      2000–2004            158         11      448      20,935            217       1,298        346        1,975
      2005–2009            154         11      403      18,069            193       1,268        302        1,976
      2010–2014            150         11      394      17,255            175       1,047        269        1,630
      2015–2017            153         11      517      27,915            211       1,355        292        1,736
                                                       B. Insurance companies
      1980–1984             60          3      380       2,286             97         355        152          480
      1985–1989             66          3      464       2,615             98         425        198          657
      1990–1994             69          3      605       3,494            118         556        225          840
      1995–1999             67          4    1,305       8,169            154         967        295        1,357
      2000–2004             57          4    1,443      12,681            201       1,669        412        1,996
      2005–2009             48          3    1,456      27,092            252       1,782        447        2,268
      2010–2014             42          2    1,209      35,187            225       1,864        386        2,168
      2015–2017             47          2    1,309      50,276            223       2,055        301        2,267
                                                       C. Investment advisors
      1980–1984            137          5      276       1,181            84            229      142          364
      1985–1989            268          8      249       1,244            73            225      142          473
      1990–1994            371          9      214       1,306            70            213      132          430
      1995–1999            661          7      265       1,408            70            207      121          415
      2000–2004          1,138          9      265       1,706            69            224      131          485
      2005–2009          1,788         16      266       2,376            63            265      126          581
      2010–2014          2,301         20      259       2,870            57            273      106          560
      2015–2017          2,987         20      257       2,921            59            308      100          563
                                                          D. Mutual funds
      1980–1984             93          8      523       3,529            143         395        233          538
      1985–1989            182         12      670       4,941            132         444        265          740
      1990–1994            283         17      874       6,524            130         516        254          883
      1995–1999            362         26    1,596      15,690            143         683        288        1,227
      2000–2004            324         30    2,330      24,704            176       1,099        375        1,775
      2005–2009            269         31    2,920      43,380            179       1,017        399        1,846
      2010–2014            238         29    3,647      42,431            176         971        354        1,682
      2015–2017            225         30    4,532      53,496            182       1,055        358        1,636
                                                          E. Pension funds
      1980–1984             23          3    1,136       3,852            110         393        147          466
      1985–1989             32          4    1,087       7,526            221         663        299          760
      1990–1994             34          4      987      14,937            283         970        450        1,171
      1995–1999             30          2    1,828      26,797            405       1,310        666        1,550
      2000–2004             35          3    4,192      39,069            562       1,958        875        2,358
      2005–2009             40          3    5,898      37,235            648       2,115        986        2,507
      2010–2014             49          3    4,947      27,341            518       1,542        734        2,108
      2015–2017             53          2    6,420      36,251            502       1,459        733        1,929
                                                               F. Other
      1980–1984             24          1      224       1,493            67            183       93          257
      1985–1989             29          1      240       1,244            66            217       98          408
      1990–1994             22          1      242       2,239            71            157      104          341
      1995–1999             24          0      262       1,921            79            135      113          357
      2000–2004             87          0      169       1,569            48            230       91          372
      2005–2009            144          1      179       2,428            36            286       85          618
      2010–2014             98          2      253       5,927            42            548       91          990
      2015–2017            190          2      239       4,817            41            480       66          710

                                                          58
Note.—This table reports the time-series mean of each summary statistic within the given period, based on Securities and
Exchange Commission Form 13F. The quarterly sample period is from 1980:1 to 2017:4.
Appendix E.        Examples of Investment Mandates

We use three examples from the mutual fund industry to illustrate the use of investment
mandates. The examples are chosen to represent diﬀerent management styles (passive versus
active) and fund sizes to illustrate the prevalence of investment mandates throughout the
industry.

  1. The Vanguard 500 Index Fund (ticker VFINX) is a passive index fund that tracks
     the S&P 500 index. Its total net assets were $329.30 billion on July 25, 2017. The
     prospectus (dated April 27, 2017) states the principal investment strategy as

            The Fund attempts to replicate the target index by investing all, or substan-
            tially all, of its assets in the stocks that make up the Index, holding each
            stock in approximately the same proportion as its weighting in the Index.

  2. State Street Global Advisors oﬀer Select Sector SPDRs (tickers XLY, XLP, XLE, XLF,
     XLV, XLI, XLB, XLRE, XLK, and XLU), which is a group of passive exchange-traded
     funds that track industry indices (i.e., consumer discretionary, consumer staples, en-
     ergy, ﬁnancial, health care, industrial, materials, real estate, technology, and utilities).
     The total net assets for this group of exchange-traded funds were $120.72 billion on
     July 25, 2017. The prospectus (dated January 31, 2017) states the principal investment
     strategy as

            In seeking to track the performance of the Index, the Fund employs a repli-
            cation strategy, which means that the Fund typically invests in substantially
            all of the securities represented in the Index in approximately the same pro-
            portions as the Index.

  3. Transamerica Dividend Focused Fund (ticker TDFAX) is an active mutual fund that
     “seeks total return gained from the combination of dividend yield, growth of dividends
     and capital appreciation.” Its total net assets were $95.52 million on July 25, 2017.
     The prospectus (dated January 31, 2017) states the principal investment strategy as

            The fund’s sub-adviser, Barrow, Hanley, Mewhinney & Strauss, LLC (the
            “sub-adviser”), deploys an active strategy that seeks large and middle capi-
            talization U.S.-listed stocks, including American Depositary Receipts, which
            make up a portfolio that generally exhibits the following value characteris-
            tics: price/earnings and price/book ratios at or below the market (S&P 500)


                                              59
            and dividend yields at or above the market. In addition, the sub-adviser con-
            siders stocks for the fund that not only currently pay a dividend, but also
            have a consecutive 25-year history of paying cash dividends. The sub-adviser
            also seeks stocks that have long established histories of dividend increases
            in an eﬀort to ensure that the growth of the dividend stream of the fund’s
            holdings will be greater than that of the market as a whole. . . If a stock held
            in the fund omits its dividend, the fund is not required to immediately sell
            the stock, but the fund will not purchase any stock that does not have a
            25-year record of paying cash dividends.


Appendix F.        Alternative Estimators

The estimation sample in our benchmark estimates of characteristics-based demand (10)
includes zero holdings (i.e., i (n) = 0). If we were to limit the estimation sample to strictly
positive holdings (i.e., i (n) > 0), we could take the logarithm of equation (10) and obtain a
linear speciﬁcation:
                                                        
                                                          K−1
                            wi (n)
                  log                    = β0,i me(n) +         βk,i xk (n) + βK,i + log(i (n)).   (F1)
                            wi (0)                        k=1


This speciﬁcation is ineﬃcient and potentially biased because the fact that an investor does
not hold certain assets could be useful for identifying the coeﬃcients on characteristics.14
   We examine how our benchmark estimates compare with those based on two alternative
estimators. The ﬁrst alternative is estimation of the linear model (F1) by restricted least
squares (imposing β0,i < 1) under the moment condition

                                           E[log(i (n))|me(n), x(n)] = 0.

The second alternative is estimation of the linear model (F1) by GMM under the moment
condition

                                          E[log(i (n))|me
                                                         i (n), x(n)] = 0.

The ﬁrst alternative shows the importance of the instrument, while the second alternative
shows the importance of estimating in levels with zero holdings.
  14
    Santos Silva and Tenreyro (2006) highlight an analogous issue in international trade that estimates of
the gravity equation depend on whether they are estimated in levels (with observations of zero bilateral
trade) or logarithms.


                                                          60
   The upper panel of Figure F1 is a scatter plot of the coeﬃcient on log market equity esti-
mated by restricted least squares versus linear GMM. We ﬁt a linear regression line through
the scatter points, both equal-weighted and value-weighted by assets under management. On
average, the least squares estimates are higher than the linear GMM estimates, especially
for larger institutions. This ﬁnding is consistent with the hypothesis that latent demand
and asset prices are jointly endogenous, which leads to a positive bias in the least squares
estimates.
    The lower panel of Figure F1 is a scatter plot of the coeﬃcient on log market equity esti-
mated by linear GMM versus nonlinear GMM. We again ﬁt a linear regression line through
the scatter points. The value-weighted regression line is close to the 45-degree line, which
means that the two alternative estimates are similar for larger institutions. However, the
equal-weighted regression line is mostly above the 45-degree line, which means that the lin-
ear GMM estimates are on average higher than the nonlinear GMM estimates. For smaller
institutions, the coeﬃcient on log market equity is lower when we estimate in levels with
zero holdings.




                                             61
                                    1




                                    .5

                   Least squares


                                    0




                                   −.5

                                                           45−degree line
                                                           Linear fit
                                                           Linear fit (AUM weighted)
                                   −1
                                         −1   −.5         0           .5               1
                                                     Linear GMM

                                    1




                                    .5
                   Linear GMM




                                    0




                                   −.5




                                   −1
                                         −1   −.5          0          .5               1
                                                    Nonlinear GMM




Figure F1. Comparison of the coeﬃcient on log market equity. The upper panel is a scatter
plot of the coeﬃcient on log market equity estimated by restricted least squares versus linear
GMM. The lower panel is a scatter plot of the coeﬃcient on log market equity estimated by
linear versus nonlinear GMM. The quarterly sample period is from 1980:2 to 2017:2.

                                                      62
