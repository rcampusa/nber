                                NBER WORKING PAPER SERIES




    UNSPANNED STOCHASTIC VOLATILITY AND THE PRICING OF COMMODITY
                            DERIVATIVES

                                         Anders B. Trolle
                                        Eduardo S. Schwartz

                                        Working Paper 12744
                                http://www.nber.org/papers/w12744


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    December 2006




The views expressed herein are those of the author(s) and do not necessarily reflect the views of the
National Bureau of Economic Research.

© 2006 by Anders B. Trolle and Eduardo S. Schwartz. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
Unspanned Stochastic Volatility and the Pricing of Commodity Derivatives
Anders B. Trolle and Eduardo S. Schwartz
NBER Working Paper No. 12744
December 2006
JEL No. G13

                                           ABSTRACT

We conduct a comprehensive analysis of unspanned stochastic volatility in commodity markets in
general and the crude-oil market in particular. We present model-free results that strongly suggest
the presence of unspanned stochastic volatility in the crude-oil market. We then develop a tractable
model for pricing commodity derivatives in the presence of unspanned stochastic volatility. The model
features correlations between innovations to futures prices and volatility, quasi-analytical prices of
options on futures and futures curve dynamics in terms of a low-dimensional affine state vector. The
model performs well when estimated on an extensive panel data set of crude-oil futures and options.

Anders B. Trolle
Copenhagen Business School
Solbjerg Plads 3 · 2000 Frederiksberg
Copenhagen DENMARK
abt.fi@cbs.dk

Eduardo S. Schwartz
Anderson Graduate School of Management
UCLA
110 Westwood Plaza
Los Angeles, CA 90095
and NBER
eduardo.schwartz@anderson.ucla.edu
1    Introduction

Volatility in commodity markets (as in most other asset markets) is obviously stochastic. Less
obvious is the extent to which volatility risk can be hedged by trading in the commodities
themselves or, more generally, their associated futures contracts; in other words, the extent
to which volatility is spanned by the futures contracts. This question is of fundamental im-
portance for the pricing, hedging and risk-management of commodity options. If, for a given
commodity, volatility is unspanned by the futures contracts, then options on futures contracts
are not redundant securities, and they cannot be fully hedged and risk-managed using only
the futures contracts.
    The purpose of this paper is to conduct a comprehensive analysis of unspanned stochastic
volatility in commodity markets in general and the crude-oil market in particular. The paper
makes a number of theoretical and empirical contributions to the literature. First, we present
results that strongly suggest the presence of unspanned stochastic volatility in the crude-oil
market. For different option maturities, we regress returns on at-the-money (ATM) option
straddles and changes in implied volatilities – both reasonable proxies for changes in the
true but unobservable volatility – on futures returns and find low R2 s, indicating that most
volatility risk cannot be hedged by trading in the futures contracts. Furthermore, there is
large common variation in regression residuals across option maturities, indicating that there
is one dominant unspanned stochastic volatility factor. These results are model-free in the
sense that no pricing model is used to derive the optimal hedge portfolios. Furthermore, the
results hold true regardless of the number of options included in the analysis, the length of
the sample and whether we run normal or “rolling” regressions.
    Second, we develop a parsimonious and highly tractable model for pricing commodity
derivatives in the presence of unspanned stochastic volatility. The model is specified di-
rectly under the risk-neutral probability measure. It is based on the Heath, Jarrow, and
Morton (1992) (HJM) framework and takes the initial futures curve as given. Futures prices
are driven by two factors, with one factor affecting the spot price of the commodity and an-
other factor affecting the forward cost of carry curve. A third (square-root) factor drives the
volatility of the futures prices; hence, options on futures contracts are driven by three factors.
We allow for correlations between innovations to the three factors which implies that volatil-
ity may be partially spanned by the futures contracts. The model features quasi-analytical
prices of European options on futures contracts based on transform techniques. By a suitable


                                                1
parametrization of the shocks to the forward cost of carry curve, the dynamics of the futures
curve can be described in terms of a four-dimensional affine state vector, which makes the
model ideally suited for pricing derivatives by simulations.
   Third, we estimate the model on an extensive panel data-set of crude-oil futures and op-
tions, involving a total of 9536 futures prices and 49001 option prices. Estimation is facilitated
by parameterizing the market prices of risk, such that the state vector is also described by
an affine diffusion under the actual probability measure. The estimation procedure is quasi-
maximum likelihood in conjunction with the extended Kalman filter. We show that the model
has an excellent fit to futures across different maturities and, generally, a good fit to op-
tions across both different moneyness categories and maturities. The model is able to match
variations in implied volatilities across time, across the maturity dimension, and, with the
exception of very short-term options, across moneyness (i.e. the implied volatility “smile”).
The parameter estimates imply that volatility is mostly unspanned, which is consistent with
our regression results.
   Fourth, as an application of the model we investigate the relative pricing of plain-vanilla
and calendar spread options – options on the price differential between two futures contracts
with different maturities. We price ATM calendar spread options out-of-sample from our
model estimated on the main data set and find, conditional on our model describing the true
dynamics of the derivatives market, that ATM calendar spread options have been overvalued
relative to plain-vanilla options on average. However, the pricing errors are also very volatile,
which renders the results insignificant for all but a few options.
   Our paper draws on the term structure literature. Using regression approaches similar to
the one applied in this paper, Collin-Dufresne and Goldstein (2002) and Heidari and Wu (2003)
document the presence of unspanned stochastic volatility in the fixed-income market. The
results for the crude-oil market are broadly consistent with the results for the bond markets
analyzed in these papers.
   Our model is related to the stochastic volatility HJM interest rate models in Casassus,
Collin-Dufresne, and Goldstein (2005) and Trolle and Schwartz (2006). It appears to be the
first stochastic volatility HJM-type model for pricing commodity derivatives. Previous HJM-
type commodity models such as Cortazar and Schwartz (1994), Amin, Ng, and Pirrong (1995),
Miltersen and Schwartz (1998), Clewlow and Strickland (1999) and Miltersen (2003) all assume




                                                2
deterministic volatilities.1
        An alternative approach for pricing commodity derivatives relies on specifying the (typi-
cally affine) dynamics of a limited set of state variables and deriving futures prices endoge-
nously. Examples of this approach include Gibson and Schwartz (1990), Schwartz (1997),
Hilliard and Reis (1998), Schwartz and Smith (2000), Richter and Sørensen (2002), Nielsen
and Schwartz (2004) and Casassus and Collin-Dufresne (2005). Of these papers only Richter
and Sørensen (2002) explicitly allow for stochastic volatility. The main drawback of these
models is that volatility will almost invariably be completely spanned by the futures contracts;
indeed, this is the case in the Richter and Sørensen (2002) model.2
        The paper is organized as follows. Section 2 discusses the crude-oil derivatives data that
we make extensive use of throughout the paper. Section 3 presents the evidence of unspanned
stochastic volatility. Section 4 describes the model for pricing commodity derivatives. Section
5 discusses the estimation procedure and estimation results. Section 6 analyses the relative
valuation of plain-vanilla and calendar spread options. Section 7 concludes. Three appendices
contain proofs and additional information.


2        Overview of crude-oil derivatives data

In the paper we repeatedly use an extensive data set of crude-oil futures and options on futures
trading on NYMEX.3 The NYMEX crude-oil derivatives market is the world’s largest and most
liquid commodity derivatives market. The range of maturities that futures and options cover
and the range of strike prices on the options are also greater than for other commodities. This
makes it an ideal market for studying commodity derivatives pricing. The raw data set consists
of daily data from January 2, 1990 until May 18, 2006 on settlement prices, open interest and
daily volume for all available futures and options.4,5
    1
        Eydeland and Geman (1998) propose a stochastic volatility Heston (1993) model for pricing energy deriva-
tives. However, they only model the evolution of the spot price, not the evolution of the entire futures curve.
    2
        Collin-Dufresne and Goldstein (2002) derive the parameter restrictions necessary for volatility to be un-
spanned in affine term structure models. Similar conditions can be derived for affine commodity models.
    3
        The New York Mercantile Exchange.
    4
        The NYMEX light, sweet crude-oil futures contract trades in units of 1000 barrels. Prices are quoted as
US dollars and cents per barrel.
    5
        Note that all computations in the paper are based on settlement prices. Settlement prices for all contracts
are determined by a “Settlement Price Committee” at the end of regular trading hours (currently 2.30 p.m.



                                                          3
       The number and maximum maturity of the futures and options have increased significantly
throughout the sample. On the first trading day in the sample, the number of futures and
options with positive open interest (trading volume) were 17 (15) and 77 (52), respectively.
The maximum maturity among the futures and options with positive open interest (trading
volume) were 499 (470) and 164 (164) days, respectively. In contrast, on the last trading day
in the sample, the number of futures and options with positive open interest (trading volume)
were 45 (26) and 1435 (199), respectively, while the maximum maturity among the futures
and options with positive open interest (trading volume) were 2372 (2372) and 2008 (1643)
days, respectively.6
       Liquidity has also increased. Open interest (daily volume) for the first future with more
than 14 days to expiration has increased from 66,925 (45,177) to 273,746 (86,622) contracts.
The combined open interest (daily volume) for the options on that future has increased from
92,083 (16,427) to 376,694 (32,820) contracts.
       We make two observations regarding liquidity. First, open interest for futures tends to
peak when expiration is a couple of weeks away, after which open interest declines sharply.
Second, among futures and options with more than a couple of weeks to expiration, the first
six monthly contracts tend to be very liquid. Beyond approximately six months, liquidity is
concentrated in the contracts expiring in March, June, September and December. Beyond
approximately one year, liquidity is concentrated in the contracts expiring in December. Due
to these liquidity patterns, we screen the available futures and options contracts according to
the following procedure: we discard all futures with 14 or less days to expiration. Among the
remaining, we retain the first six monthly contracts. Beyond these, we choose the first two
contracts with expiration in either March, June, September or December. Beyond these, we
choose the next four contracts with expiration in December. This procedure leaves us with
twelve generic futures contracts which we label M1, M2, M3, M4, M5, M6, Q1, Q2, Y1, Y2,
Y3 and Y4.
       Figure 1 displays the futures data. The run-up in crude-oil prices since 2002 is strik-

EST) and represent a very accurate measure of the true market prices at the time of close. Settlement prices
are widely scrutinized by all market participants since they are used for marking to market all account balances.
   6
       Futures expire on the third business day prior to the 25th calendar day of the month preceding the delivery
month. If the 25th calendar day of the month is a non-business day, expiration is on the third business day prior
to the business day preceding the 25th calendar day. Options expire three business days prior to the expiration
of the underlying futures.




                                                         4
ing. Using the M1 futures contract as a proxy for the spot price, the Q2 futures contract is
backwardated 82.6 percent of the time and strongly backwardated 66.3 percent of the time.7
        Figure 2 displays the implied log-normal volatility for options on the first eight of the
generic futures contracts.8 It is evident that volatility is stochastic. In the next section we
investigate to what extent stochastic volatility is unspanned.


3         Evidence of unspanned stochastic volatility

3.1        Approach

If volatility is spanned by the futures contracts, it implies that changes in volatility can be
hedged with a portfolio of futures contracts. Suppose we regress changes in volatility on the
returns of futures contracts, the R2 s will indicate the extent to which volatility is spanned.
However, this approach is not feasible since volatility is not directly observable. One alter-
native is to investigate how much of the variation in the prices of derivatives highly exposed
to stochastic volatility (so-called “straddles”) can be explained by variation in the underlying
futures prices. Another alternative is to investigate how much of the variation in log-normal
implied volatilities (which is related to expectations under the risk-neutral measure of fu-
ture volatility) can be explained by variation in the underlying futures prices. We use both
approaches to investigate the extent to which volatility is spanned. Although they are re-
lated, they do have their relative strengths and weaknesses. Both approaches have previously
been used by Collin-Dufresne and Goldstein (2002) and Heidari and Wu (2003) to investigate
unspanned stochastic volatility in the fixed income market.9
        More specifically, we proceed in three steps. Suppose we have a set of contracts (futures
and their associated options), i = 1, ..., n. First, we factor analyze the covariance matrix of the
    7
        Let S(t) denote the time-t spot price and F (t, T ) [P (t, T )] the time-t price of a futures contract [zero-coupon
bond] with maturity T − t. The futures contracts is backwardated if S(t) − P (t, T )F (t, T ) > 0 and strongly
backwardated if S(t) − F (t, T ) > 0. The numbers reported here are slightly lower than those reported in
Litzenberger and Rabinowitz (1995) for an earlier sample.
    8
        At each date we choose the options that are closest to ATM. The options are American and we invert their
prices using the Barone-Adesi and Whaley (1987) formula. More details are given in Section 5.1.
    9
        Yet a third alternative is to investigate how much of the variation in realized volatility, estimated from high-
frequency data, can be explained by variations in the underlying futures prices. Andersen and Benzoni (2005)
use this approach to investigate unspanned stochastic volatility in the fixed income market. However, our data
set does not include high-frequency data for futures prices.



                                                              5
futures returns and retain the first three principal components, P C f ut,1 , P C f ut,2 and P C f ut,3 .
These summarize virtually all of the information in the futures returns.
       Second, for each futures contract i, we regress the return on the straddle that is closest to
ATM on the first three principal components and squared principal components of the futures
returns,10

                 rtstraddle,i = β0i + β1i P Ctf ut,1 + β2i P Ctf ut,2 + β3i P Ctf ut,3 +
                                              2                    2                2
                                β4i P Ctf ut,1 + β5i P Ctf ut,2 + β6i P Ctf ut,3 + ǫit .                   (1)

A straddle consists of a put option and a call option with the same strike. The price of
a near-ATM straddle has low sensitivity to variations in the price of the underlying futures
contract (since “deltas” are close to zero for ATM straddles) but high sensitivity to variations in
volatility (since “vegas” peak for ATM straddles). Consequently, the extent to which straddle
returns can be explained by the principal components of the futures returns will indicate the
extend to which volatility is spanned by the futures contracts.
       For each futures contract i we also run regression (1) with the straddle return substituted
by the change in implied log-normal volatility. The implied log-normal volatility is related to
the average expected (under the risk-neutral measure) volatility over the life of the option.
Hence, these regressions also indicate the extend to which volatility is spanned by the futures
contracts.
       Third, we factor analyze the covariance matrices of the n time-series of residuals from
straddle return regressions and the implied volatility regressions. The principal components
of the residuals are by construction independent of those of the futures returns. If there
is unspanned stochastic volatility in the data, we should see large common variation in the
residuals. If the residuals are simply due to noisy data, we should not find much common
variation in the residuals.
       The advantage of running the regressions with straddle returns is that the results are
not conditional on a particular pricing model. The disadvantage is that even if volatility is
completely unspanned by the futures contracts, the R2 s from the regressions will not necessarily
be close to zero. The reason is that straddle returns are highly convex in the futures returns
(near-ATM straddles have high “gammas”), and we include the squared principal components
of the futures returns in the regressions. Hence, some of the variation in straddle returns will
  10
       We add the squared principal components to the set of independent variables in the regressions in an
attempt to take account of non-linearities in the relation between straddle returns and futures returns.


                                                       6
be explained by futures returns even if none of the variation in volatility can be explained
by the futures returns. In contrast, running the regressions with implied volatility should
produce R2 s close to zero if volatility is completely unspanned. However, in this case the
results will to some extent be conditional on the particular pricing model used for inverting
implied volatilities from option prices.
       A potential weakness of the procedure is that the parameters in the regressions are assumed
constant over the entire sample. In reality we would expect the parameters to be time-varying.
To take account of such time-variation, we also perform the analysis using a rolling window of
100 observations.11 That is, for each window we extract the first three principal components
of futures returns, run the regressions and factor analyze the residuals.


3.2       Data

We compute daily returns on the futures contracts. For each futures contract, we compute
daily returns on the straddle that is closest to ATM. We only search among straddles with
moneyness (strike divided by the price of the underlying futures contract) in the interval
0.95–1.05.12 The implied log-normal volatilities are computed as the averages of the implied
log-normal volatilties of the puts and calls that constitutes the straddles.13
       An important issue is that our approach requires a full set of futures and straddle returns.
The fact that the maturity range of futures and options has increased over the sample generates
a tradeoff: as we include longer contracts in the analysis, we have fewer dates with a full set of
futures and straddle returns but obtain more information about common variation in returns
across different straddles. For this reason we perform the analysis with the following five
different sets of contracts: M1–M4, M1–M6, M1–Q2, M1–Y2 and M1–Y4.


3.3       Results

We first discuss the results from the full regressions. Table 1 shows the explanatory power of the
first three principal components of the futures returns. The first principal component explains
the majority of the variation in futures returns. The importance of the second principal
  11
       We have tried window lengths of 50, 100 and 200 observations with little impact on the results.
  12
       Furthermore, we only consider options that have open interest in excess of 100 contracts.
  13
       The options are American and we invert their prices using the Barone-Adesi and Whaley (1987) formula.
More details are given in Section 5.1.




                                                         7
component increases with the number of the contracts included in the analysis. The third
principal component is not important in any of the cases.
       Table 2 shows the adjusted R2 s from regressing straddles returns on the principal compo-
nents (and squared principal components) of the straddle returns. The R2 s range from 6.6
percent to 62.5 percent, indicating that it is very difficult to hedge volatility risk using futures
contracts.14
       Table 3 shows the adjusted R2 s from regressing changes in implied volatilities on the
principal components (and squared principal components) of the straddle returns. In this
case, the R2 s range from 0.4 percent to 20.9 percent. This provides even stronger evidence of
the inability of futures contracts to hedge volatility risk.
       Table 4 displays the explanatory power of the first three principal components of the
regression residuals. For the straddle return regressions, the first principal component explains
between 50.8 percent and 79.8 percent of the variation in the residuals across maturities, while
for the implied volatility regressions, it explains between 52.6 percent and 80.1 percent. Hence,
there is large common variation in the residuals, which strongly indicates that the low R2 s
from the regressions are primarily due to an unspanned stochastic volatility factor rather than
noisy data.15
       Similar results are obtained when we perform the analyses over a rolling window of 100
observations. The tables report average results (i.e. average explanatory power of the principal
components and average R2 s from the regressions). The average explanatory power of the first
three principal components of the futures returns is virtually the same as for the full regressions.
As expected, the average regression R2 s are generally (but not always) higher than for the full
regressions. The reason is that the regressions now are able to capture time variations in the
relations between straddle returns and futures returns and between implied volatility changes
and futures returns. Importantly, we still find evidence of unspanned stochastic volatility as
the first principal component on average explains between 51.0 percent and 71.6 percent of
the variation in the residuals from the straddle return regressions and between 55.5 percent
  14
       As discussed above, in these regressions the R2 s will not necessarily be close to zero even if volatility is
completely unspanned. That the R2 s decrease with straddle maturity is consistent with the fact that “gammas”
of ATM straddles also decrease with maturity.
  15
       The correlation between the first principal component of the residuals from the straddle return regression
and the first principal component of the residuals from the implied volatility regression is consistently above
0.95.




                                                          8
and 73.1 percent of the variation in the residuals from the implied volatility regressions.16


4         A model for commodity derivatives featuring unspanned stochas-
          tic volatility

Based on the evidence presented above, we now develop a parsimonious and highly tractable
model for pricing commodity derivatives in the presence of unspanned stochastic volatility.


4.1         The model under the risk-neutral measure

Let S(t) denote the time-t spot price of the commodity. The dynamics of S(t) is given by

                                     dS(t)
                                           = δ(t)dt + σS v(t)dW1Q (t),
                                                        p
                                                                                                               (2)
                                      S(t)

where δ(t) denotes the instantaneous spot cost of carry. Let y(t, T ) denote the time-t instan-
taneous forward cost of carry at time T with y(t, t) = δ(t). The dynamics of y(t, T ) is given
by

                               dy(t, T ) = µy (t, T )dt + σy (t, T ) v(t)dW2Q (t).
                                                                    p
                                                                                                               (3)

Finally, v(t) is assumed to follow a square-root process

                                                                        v(t)dW3Q (t).
                                                                    p
                                  dv(t) = κ(θ − v(t))dt + σv                                                   (4)

W1Q (t), W2Q (t) and W3Q (t) denote correlated Wiener processes under the risk-neutral measure,
with ρ12 , ρ13 and ρ23 denoting pairwise correlations. In particular, a negative correlation
between shocks to the spot price and the cost of carry will have a mean-reverting effect on the
spot price under the risk-neutral measure.
         The forward cost of carry is given by the forward interest rate minus the forward conve-
nience yield, and we could extend the model with separate processes for the forward interest
rate and the forward convenience yield.17 However, for pricing many commodity futures it
    16
         We have repeated all the analyses using correlation matrices rather than the covariance matrices. This
yields virtually identical results, and the tables are therefore omitted.
    17
         When we allow for stochastic interest rates, we should, strictly speaking, distinguish between forward and
future convenience yields and forward and future cost of carry, see Miltersen and Schwartz (1998) for more on
this issue.




                                                           9
appears sufficient to model the cost of carry as driven by one factor.18 Furthermore, for pricing
short-term or medium-term options on many commodity futures, ignoring stochastic interest
rates results in negligible pricing errors, since the volatility of interest rates is typically or-
ders of magnitudes smaller than the volatility of futures returns and the correlation between
interest rates and futures returns tends to be very low.19
       Let F (t, T ) denote the time-t price of a futures contract maturing at time T . By definition
we have
                                                              Z       T           
                                   F (t, T ) ≡ S(t)exp                     y(t, u)du .                        (5)
                                                                   t

In the absence of arbitrage opportunities, the futures price process must be a martingale under
the risk-neutral measure, see e.g. Duffie (2001). Applying Ito’s Lemma to (5) and setting the
drift to zero, it follows that the dynamics of F (t, T ) is given by
                                                    Z T                   
                      dF (t, T ) p           Q                        Q
                                 = v(t) σS dW1 (t) +     σy (t, u)dudW2 (t) .                                 (6)
                       F (t, T )                      t

Futures prices are driven by two risk factors, W1Q (t) and W2Q (t). This should be adequate
for pricing crude-oil futures, since Table 1 shows that two factors can capture virtually all
variation in futures returns.
       Volatility of futures prices depends on v(t), which is driven by the risk factor W3Q (t).
Therefore, volatility risk and options on futures contracts cannot be completely hedged by
trading in the futures contracts. Hence, the model features unspanned stochastic volatility
consistent with the evidence presented in Section 3. To the extent that W1Q (t) and W2Q (t) are
correlated with W3Q (t), volatility risk is partly hedgeable. If ρ13 and ρ23 are both zero, volatility
risk is completely unhedgeable. The model should perform well in terms of pricing options
on crude-oil futures, since Table 4 shows that there is one dominant unspanned stochastic
  18
       See Schwartz (1997) for a comparison between the Gibson and Schwartz (1990) model (in which the spot
cost of carry is driven by one factor) and a model that assumes stochastic spot interest rate and stochastic
spot convenience yield (in which the spot cost of carry is driven by two factors). In terms of pricing crude-oil
futures, the performance of the latter model is only marginally better than that of the former model.
  19
       For instance, for the sample period January 2, 1990 to August 25, 2003, Casassus and Collin-Dufresne (2005)
estimate the (instantaneous) crude-oil spot return volatility to 0.397 and the (instantaneous) spot interest rate
volatility to 0.009. Furthermore, the (instantaneous) correlation between the spot return and the spot interest
rate is estimated to 0.051 and is insignificant. Accounting explicitly for stochastic interest rates may become
more important when pricing long-term options on futures contracts.




                                                         10
volatility factor. It is straightforward to extend the model to multiple unspanned stochastic
volatility factors, if necessary.
       From the requirement that the drift of the futures price process is zero, we obtain the
following condition on the drift of the forward cost of carry process

Proposition 1 Absence of arbitrage implies that the drift term in (3) is given by
                                                                         Z       T             
                             µy (t, T ) = −v(t)σy (t, T ) ρ12 σS +                    σy (t, u)du .                 (7)
                                                                              t

Proof: See Appendix A.
This condition is analogous to the Heath, Jarrow, and Morton (1992) drift condition in forward
rate term structure models.


4.2        An affine model for the dynamics of the futures curve

So far we have left σy (t, T ) unspecified. We obtain a highly tractable model with the following
time-homogeneous specification20,21

                                              σy (t, T ) = αe−γ(T −t) .                                             (8)

In the following proposition we show that y(t, T ) is now an affine function of two state variables,
x(t) and φ(t), where x(t) is stochastic while φ(t) is an “auxiliary” locally non-stochastic state
variable. Furthermore, x(t), φ(t) and v(t) jointly constitute a three-dimensional affine state
vector.

Proposition 2 The time-t instantaneous forward cost of carry at time T , y(t, T ), is given by

                              y(t, T ) = y(0, T ) + Ax (T − t)x(t) + Aφ (T − t)φ(t),                                (9)
  20
       In a preliminary version of the paper, we used the more general specification σy (t, T ) = (α0 + α1 (T −
       −γ(T −t)
t))e              . This specification leads to a somewhat more complex, yet still tractable, model (see Trolle and
Schwartz (2006) for an HJM-type stochastic volatility term structure model using this specification for the
shocks to the forward rate curve). However, α1 was estimated close to zero, and the pricing performance of the
two models was almost indistinguishable. Therefore, in the interest of parsimony we will work with the simpler
specification (8).
  21
       With this specification, σS , α, θ and σv are not simultaneously identified, see e.g. the discussion of invariant
affine transformations in Dai and Singleton (2000). In our empirical analysis we normalize θ to one to achieve
identification.




                                                           11
where

                                                Ax (τ ) = αe−γτ                                              (10)

                                                Aφ (τ ) = αe−2γτ                                             (11)

and x(t) and φ(t) evolve according to
                                                     
                                         α
                                           + ρ12 σS v(t) dt + v(t)dW2Q (t)
                                                             p
               dx(t) =       −γx(t) −                                                                        (12)
                                         γ
                                           
                             α
               dφ(t) =         v(t) − 2γφ(t) dt                                                              (13)
                             γ
subject to x(0) = φ(0) = 0.

Proof: See Appendix A.
It follows that the instantaneous spot cost of carry is given by

                                       δ(t) = y(0, t) + αx(t) + αφ(t).                                       (14)

From (5) we have that F (t, T ) is given by
                                       F (0, T )
                    F (t, T ) = S(t)             exp {Bx (T − t)x(t) + Bφ (T − t)φ(t)}                       (15)
                                       F (0, t)
where
                                                         α
                                                            1 − e−γτ
                                                                     
                                           Bx (τ ) =                                                         (16)
                                                         γ
                                                         α
                                                             1 − e−2γτ ,
                                                                       
                                           Bφ (τ ) =                                                         (17)
                                                         2γ
while the dynamics of F (t, T ) is given by
                 dF (t, T ) p                                     
                            = v(t) σS dW1Q (t) + Bx (T − t)dW2Q (t) .                                        (18)
                  F (t, T )
Futures prices now depend on three state variables (S(t), x(t) and φ(t)), but are still driven
by two risk-factors, since φ(t) is locally deterministic.22
  22
       To understand the model it may be helpful to note that the dynamics of the spot cost of carry is given by
                                                                p
                                  dδ(t) = γ(θ(t) − δ(t))dt + α      v(t)dW2Q (t)                             (19)

where
                                       1 ∂y(0, t)            1
                              θ(t) =              + y(0, t) − αρ12 σS v(t) − αφ(t).                          (20)
                                       γ ∂t                  γ
Therefore, the model can be seen as a stochastic volatility extension of the two factor Gibson and Schwartz (1990)
model, where the first factor is the spot price and the second factor is a mean-reverting spot convenience yield
or, equivalently, spot cost of carry (since they assume a constant spot interest rate). If we replace v(t) with a
constant, we obtain the Gibson and Schwartz (1990) model fitted exactly to the initial futures curve.


                                                          12
   It is convenient to use s(t) ≡ log(S(t)) instead of S(t) as a state vector. Using Ito’s Lemma
and substituting δ(t) by (14), the dynamics of s(t) is given by
                                                      
                                              1 2
           ds(t) = y(0, t) + αx(t) + αφ(t) − σS v(t) dt + σS v(t)dW1Q (t).
                                                                p
                                                                                             (21)
                                              2

Now, s(t), x(t), φ(t) and v(t) jointly constitute a four-dimensional affine state vector and the
log of futures prices is an affine function of s(t), x(t) and φ(t),

       logF (t, T ) = logF (0, T ) − logF (0, t) + s(t) + Bx (T − t)x(t) + Bφ (T − t)φ(t).   (22)


4.3    Pricing options on futures contracts

To price options on futures we follow Collin-Dufresne and Goldstein (2003), who extend the
analysis in Duffie, Pan, and Singleton (2000) to HJM models, and introduce the transform
                                                   h                  i
                            ψ(u, t, T0 , T1 ) = EtQ eulog(F (T0 ,T1 )) .                     (23)

This transform has an exponentially affine solution as demonstrated in the following proposi-
tion

Proposition 3 The transform in (23) is given by

                     ψ(u, t, T0 , T1 ) = eM (T0 −t)+N (T0 −t)v(t)+ulog(F (t,T1 )) ,          (24)

where M (τ ) and N (τ ) solve the following system of ODEs

          dM (τ )
                    = N (τ )κθ                                                               (25)
           dτ
          dN (τ )                                                         1
                    = N (τ ) (−κ + uσv (ρ13 σS + ρ23 Bx (T1 − T0 + τ ))) + N (τ )2 σv2
            dτ                                                            2
                        1 2
                      + (u − u)(σS2 + Bx (T1 − T0 + τ )2 + 2ρ12 σS Bx (T1 − T0 + τ ))        (26)
                        2

subject to the boundary conditions M (0) = 0 and N (0) = 0.

Proof: See Appendix A.


   As in Duffie, Pan, and Singleton (2000) and Collin-Dufresne and Goldstein (2003) we can
now price European options on a futures contract by applying the Fourier inversion theorem




                                                     13
Proposition 4 The time-t price of a European put option expiring at time T0 with strike K
on a futures contract expiring at time T1 , P(t, T0 , T1 , K), is given by
                                           h R T0                                        i
                    P(t, T0 , T1 , K) = EtQ e− t r(s)ds (K − F (T0 , T1 ))1F (T0 ,T1 )<K

                                           = P (t, T0 )(KG0,1 (log(K)) − G1,1 (log(K))),                                      (27)
                                                                                                                              √
where P (t, T0 ) denotes the time-t price of a zero-coupon bond maturing at time T0 , i =                                      −1
and Ga,b (y) is defined as
                                                                   ∞   Im ψ(a + iub, t, T0 , T1 )e−iuy
                                                                                                      
                           ψ(a, t, T0 , T1 ) 1
                                                           Z
                Ga,b (y) =                  −                                                            du.                  (28)
                                  2           π                0                   u

Proof: See Appendix A.
This formula is exact when interest rates are uncorrelated with futures prices. To the extent
that the correlation is low and the volatility of interest rates is significantly lower than the
volatility of futures prices, the formula gives a very accurate approximation of the true price
of short-term or medium-term options.23


4.4       Market price of risk specification

For estimation we also need the dynamics of the state vector under the actual probability
measure P , which are obtained by specifying the market prices of risk, Λi , that link the
Wiener processes under Q and P through

                                     dWiP (t) = dWiQ (t) − Λi (t)dt,                          i = 1, 2, 3.                    (29)

We apply the parsimonious “completely affine” specification, see e.g. Dai and Singleton (2000)
which in our setting is given by
                                                                   p
                                          Λi (t) = λiv                     v(t),      i = 1, 2, 3.                            (30)
  23
       To see this, note that in general we have
                                                                                                    
                 P(t, T0 , T1 , K)    =   P (t, T0 )EtQ (K − F (T0 , T1 ))1F (T0 ,T1 )<K
                                                                 Z       T0                                          
                                          +CovtQ exp −                          r(s)ds , (K − F (T0 , T1 ))1F (T0 ,T1 )<K .
                                                                       t

The covariance term is zero if r(t) and F (t, T1 ) are uncorrelated, in which case the formula is exact. The
covariance term is insignificant relative to the option price, provided that the correlation between r(t) and
F (t, T1 ) is low and the volatility of r(t) is low relative to the volatility of F (t, T1 ).




                                                                       14
This specification preserves the affine structure of the state vector under the change of measure.
The dynamics of s(t), x(t) and v(t) under P is now given by
                                                            
                                             1 2
                                               σS − λ1v σS v(t) dt + σS v(t)dW1Q (t) (31)
                                                                       p
     ds(t) =     y(0, t) + αx(t) + αφ(t) −
                                             2
                                                 
                              α
                                + ρ12 σS − λ2v v(t) dt + v(t)dW2Q (t)
                                                           p
     dx(t) =     −γx(t) −                                                            (32)
                              γ
     dv(t) = (κθ − (κ − λ3v σv )v(t))dt + σv v(t)dW3Q (t).
                                              p
                                                                                     (33)

The dynamics of φ(t) is given by (13) also under P , since it does not contain any stochastic
terms.24


5         Model estimation

5.1         Data

We estimate the model on an extensive panel data set of futures and options on futures. We use
weekly data to reduce the computational burden. In particular, we use data on Wednesdays.25
We include the entire set of futures contracts M1–Y4 and options on the first eight futures
contracts M1–Q2. We do not consider options on the remaining futures contracts Y1–Y4
for two reasons. Firstly, the quasi-analytical expression for option prices, that we develop in
Section 4.3, does not take stochastic interest rates into account. While it appears that ignoring
stochastic interest rates results in negligible pricing errors for short-term and medium-term
options, it may result in non-negligible pricing errors for long-term options. Secondly, and
more importantly, the main options in the data set are American, whereas our pricing formula
    24
         We have also estimated the model with the “extended affine” specification suggested by Cheredito, Filipovic,
and Kimmel (2003) and Collin-Dufresne, Goldstein, and Jones (2003) and given by
                                              λi0 + λis s(t) + λix x(t) + λiv v(t)
                                 Λi (t)   =                  p                     ,   i = 1, 2                 (34)
                                                               v(t)
                                              λ30 + λ3v v(t)
                                Λ3 (t)    =       p          .                                                  (35)
                                                    v(t)

However, most of the additional parameters turn out to be very imprecisely estimated. Furthermore, the Feller
restriction, which must be imposed to rule out arbitrage opportunities, is strongly binding under Q. This
implies that although the “extended affine” specification gives the model more flexibility under the P -measure,
it reduces the flexibility under the Q-measure which significantly affects the model’s pricing performance. For
these reasons we only work with the “completely affine” specification.
    25
         If a given Wednesday is not a business day, we choose the business day directly preceding the Wednesday.




                                                              15
is for European options.26 For computational reasons, estimation is only feasible for European
options, necessitating a conversion of American prices to European prices. This requires an
approximation of the early exercise premium (described below), and since the size of the
early exercise premium as a fraction of the total option price increases with option maturity,
any errors in the early exercise approximation becomes more serious for longer term options.
Considering options on the first eight generic futures contracts appears to strike a reasonable
balance between including information from the maturity dimension of option prices, while
limiting our exposure to the approximation errors associated with the American-to-European
conversions and not explicitly modelling stochastic interest rates.
       For each option maturity we consider eleven moneyness intervals 0.78–0.82, 0.82–0.86, 0.86–
0.90, 0.90–0.94, 0.94–0.98, 0.98–1.02, 1.02–1.06, 1.06–1.10, 1.10–1.14, 1.14–1.18 and 1.18–1.22,
where moneyness is defined as option strike divided by the price of the underlying futures
contract. Among the options within a given moneyness interval we choose the one that is
closest to mean of the interval.
       The approach that we use for converting American prices to European prices is the follow-
ing: we assume that the price of the underlying futures contract follows a geometric Brownian
motion, in which case American options can be priced using the Barone-Adesi and Wha-
ley (1987) formula. Inverting this formula for a given American option price yields an implied
volatility, from which we can price the associated European option with the Black (1976)
formula.27 Naturally, this procedure is inherently inconsistent; the whole point of the paper
is to investigate stochastic volatility, yet when approximating the early exercise premium we
assume that the underlying future follows a geometric Brownian motion with constant volatil-
ity. Note, however, that the procedure implicitly takes variations in volatility into account,
since the implied volatilities, although assumed constant, in reality vary over time and across
moneyness. To minimize the effect of any errors in the early exercise approximation, we only
consider options that are at- or out-of-the-money. More specifically, for moneyness less than
0.98 we only use put options, while for moneyness larger than 1.02 we only use call options.28,29
  26
       Recently, NYMEX has introduced European crude-oil options. However, the trading history is much shorter
and the liquidity much lower than for the American options.
  27
       We have also inverted the American prices using binomial or trinomial trees. This gives results that are
very similar to using the Barone-Adesi and Whaley (1987) formula.
  28
       Furthermore, we only consider options that have open interest in excess of 100 contracts and options with
prices larger than 0.10 dollars. The reason for the latter is that prices are quoted with a precision of 0.01 dollars.
  29
       Similar approaches for converting American options prices to European prices is used by e.g. Broadie,


                                                         16
       The discount function P (t, T ) in (27) is obtained by fitting a Nelson and Siegel (1987)
curve each date to a LIBOR/swap curve consisting of the 1mth, 3mth, 6mth, 9mth and 12mth
LIBOR rates and the 2yr swap rate.30
       In total, the data set used for estimation consists of 9536 futures and 49001 options. There
are 855 trading dates. On a given trading date, the number of futures range from 8 to 12 while
the number of options range from 23 to 87.


5.2       Estimation approach

We estimate the model by quasi maximum-likelihood (QML) in conjunction with the extended
Kalman filter.31 To apply the Kalman filter we write the model in state space form, which
consists of a measurement equation and a transition equation. The measurement equation
describes the relationship between the prices of futures and options and the state variables,
while the transition equation describes the discrete-time dynamics of the state variables.
       Let zt denote the data vector at time t and Xt the vector of state variables. The measure-
ment equation is given by

                                   zt = h(Xt ) + ut ,    ut ∼ iid. N (0, Ω),                                   (37)

Chernov, and Johannes (2004) for estimating equity derivatives models on S&P 500 futures options, Bik-
bov and Chernov (2004) for estimating term structure models on Eurodollar futures options and Richter and
Sørensen (2002) for estimating a commodity derivatives model on soybean futures options.
  30
       Let f (t, T ) denote the time-t instantaneous forward interest rate at time T . Nelson and Siegel (1987)
parameterize the forward interest rate curve as f (t, T ) = β0 + β1 e−θ(T −t) + β2 θ(T − t)e−θ(T −t) which yields the
following expression for zero-coupon bond prices
                                                                                                     
                                                               1              
                 P (t, T )   =   exp β0 (T − t) + (β1 + β2 )      1 − e−θ(T −t) + β2 (T − t)e−θ(T −t)           (36)
                                                               θ
from which we can price LIBOR and swap rates. The parameters β0 , β1 , β2 and θ are recalibrated on each
observation date by minimizing the mean squared percentage differences between the observed LIBOR and
swap rates on that date and those implied (36).
  31
       Alternative estimation procedures include MCMC, Efficient Method of Moments (EMM) and Simulated
Maximum likelihood (SML). Duffee and Stanton (2004) compare EMM, SML and QML/Kalman filter in the
context of estimating affine term structure models. Their conclusion is that the latter procedure is preferable
due to its better finite sample properties. Since the structure of our commodity model is similar to that
of affine term structure models, we conjecture that a similar conclusion also holds in the present context.
Computational considerations also speak in favor of the QML/Kalman filter approach, since the inclusion of
options in the estimation makes even this otherwise simple procedure computationally intensive. Estimating the
model with simulation based procedures such as MCMC, EMM or SML would be extremely time-consuming,
if not impossible.


                                                          17
where h is the pricing function and ut is a vector of iid. Gaussian measurement errors with
covariance matrix Ω.
       Suppose at time t we observe m futures prices, Ft,1 , ..., Ft,m , and n option prices, Pt,1 , ..., Pt,n .
We take the log of the futures prices and we divide the option prices by their Black (1976) “ve-
gas”, the sensitivities of the option prices with respect to variations in log-normal volatilities.
This is very similar to fitting the model to log-normal implied volatilities but is much faster,
since computing implied volatilities requires a numerical inversion for each option, which would
add an extra layer of complexity to the estimation procedure.32 Hence, zt is given by

                             zt = (logFt,1 , ..., logFt,m , Pt,1 /Vt,1 , ..., Pt,n /Vt,n ),                             (38)

where Vt,1 , ..., Vt,n denote the Black (1976) “vegas” for the n options, and Xt is given by

                                          Xt = (s(t), x(t), φ(t), v(t))′ .                                              (39)

The dimension of the zt -vector varies over time. This does not present a problem, however,
since the Kalman filter easily handles missing observations.
       The log of futures prices are affine functions of s(t), x(t) and φ(t), see (22). In the estimation
we assume that the initial forward cost of carry curve is flat and equal to ϕ. In other words,
we replace y(0, t) with ϕ in (31) and replace logF (0, T ) − logF (0, t) with ϕ(T − t) in (22) and
estimate ϕ as part of the estimation procedure. This reduces the model to a time-homogeneous
model where ϕ is the long-run forward cost of carry.33
       The option prices are non-linearly related to v(t) through (24) and (27). Since we price
options based on the actual futures prices, option prices are independent of the s(t), x(t) and
φ(t) state variables. This has the advantage that an imperfect fit to the futures contracts does
not get reflected in derivatives prices, which in turn should provide us with a cleaner estimate
of the volatility process.
       To reduce the number of parameters in Ω, we make the conventional assumption that the
measurement errors are cross-sectionally uncorrelated (that is, Ω is diagonal). Furthermore,
  32                   et,i and P
       To see this let P        bt,i denote the fitted and true price, respectively, for option i at time t and let σ
                                                                                                                    et,i
                                                                                    bt,i ≡
    bt,i denote the corresponding implied log-normal volatilities. Furthermore, let V
and σ                                                                                                 ∂P
                                                                                                                   denote the
                                                                                                      ∂σ σ=σ̂t,i

“vega” computed at the true option price. Then

                        et,i ≈ P
                        P      bt,i + V
                                      bt,i (σ
                                            et,i − σ
                                                   bt,i ) ⇔ σ
                                                            et,i − σ      et,i /V
                                                                   bt,i ≈ P     bt,i − P
                                                                                       bt,i /V
                                                                                             bt,i .

  33
       A similar approach is taken by de Jong and Santa-Clara (1999) and Trolle and Schwartz (2006) in their
estimation of HJM-type term structure models.


                                                              18
we assume that one variance applies to all measurement errors for the log of futures prices,
and that another variance applies to all measurement errors for scaled option prices.34
       The transition equation describes the discrete-time dynamics of the state vector implied
by the continuous-time processes (31), (32), (13) and (33)

               Xt+1 = Φ(Xt ) + wt+1 ,       wt+1 iid., E[wt+1 ] = 0, Cov[wt+1 ] = Q(vt ).                   (40)

Since Xt follows an affine diffusion, we have that Φ(Xt ) = Φ0 + ΦX Xt and Q(vt ) = Q0 +
Qv vt , where Φ0 , ΦX , Q0 and Qv are known in closed form and derived in Appendix B. The
disturbance vector wt+1 is iid. but not Gaussian.
       The Kalman filter is designed for linear Gaussian state space models. To apply the Kalman
filter we therefore need to modify (37) and (40). We linearize the h-function in (37) and make
the assumption that the disturbance term wt in (40) is Gaussian. We can then apply the
Kalman filter (now called the extended Kalman filter) to (37) and (40) and compute the
likelihood function. The use of a Gaussian distribution to approximate the true distribution
of wt+1 makes this a QML procedure.35,36
       The log-likelihood function is maximized by initially using the Nelder-Mead algorithm and
later switching to the gradient-based BFGS algorithm. The optimization is repeated with
several different plausible initial parameter guesses to minimize the risk of not reaching the
global optimum. The ODEs (25) and (26) are solved with a standard fourth-order Runge-
Kutta algorithm, and the integral in (28) is evaluated with the Gauss-Legendre quadrature
formula, using 20 integration points and truncating the integral at 400.
  34
       Note that the assumption of normally distributed additive measurement errors on the log of futures prices
implies log-normally distributed multiplicative measurement errors on futures prices.
  35
       For completeness the extended Kalman filter recursions are stated in Appendix B. Harvey (1989) and
Hamilton (1994) are classic references.
  36
       While QML estimation has been shown to be consistent in many settings, it is in fact not consistent in the
present context due to the linearization of the h-function function, and the fact that the conditional covariance
matrix Q in the recursions depends on the Kalman filter estimate vbt rather than the true, but unobservable,
vt , see Duan and Simonato (1999) and Lund (1997). However, the Monte Carlo studies in these papers as well
as Duffee and Stanton (2004) among others show the inconsistency problem to be of minor importance. This is
particularly the case when the measurement equation is almost linear in the state variables, which is the case
in our setting.




                                                        19
5.3       Results

5.3.1       Parameter estimates

Table 5 displays parameter estimates both for the entire sample 1990–2006 and for the two
sub-samples 1990–1997 and 1998–2006.37 The estimate of σS implies that the spot price
              p
volatility, σS v(t), equals 0.355 on average over the entire sample (0.306 and 0.414 over the
                                                                                           p
two sub-samples), while the estimate of α implies that the spot cost of carry volatility, α v(t),
equals 0.241 on average over the entire sample (0.302 and 0.312 over the two sub-samples).
The correlation between innovations to the spot price and innovations to the cost of carry
is estimated to be strongly negative -0.911 in the entire sample (-0.944 and -0.884 in the
two sub-samples). This implies that the spot price will exhibit mean-reversion under the risk-
neutral measure as found by Bessembinder et al. (1995). Our estimates are generally consistent
with Schwartz (1997) and Casassus and Collin-Dufresne (2005), who also estimate commodity
models on crude-oil futures data (but no options data). The estimates in Schwartz (1997)
imply spot price volatility, spot cost of carry volatility and spot price–cost of carry correlation
of 0.344, 0.372 and -0.915, respectively, while the corresponding numbers in Casassus and
Collin-Dufresne (2005) are 0.397, 0.384 and -0.793.38
       For the entire sample the volatility process is estimated to be moderately persistent under
the risk-neutral measure with a half-life of 0.80 years. The persistence is estimated to be
significantly lower in the second sub-sample with a half-life of only 0.37 years. This suggests
that the 1990-1991 Gulf War I, which is by far the largest shock to the crude-oil derivatives
market in our data set, has a significant impact on this estimate.
       The volatility of volatility parameter σv is fairly constant across the three samples. It is
often the case that stochastic volatility models fitted to equity option data lead to estimates
of σv that are wildly inconsistent with the actual volatility of v(t), see e.g. Bates (1996, 2000),
  37
       The asymptotic covariance matrix of the estimated parameters is computed from the outer-product of
the first derivatives of the likelihood function. Theoretically, it would be more appropriate to compute the
asymptotic covariance matrix from both the first and second derivatives of the likelihood function. In reality,
however, the second derivatives of the likelihood function are somewhat numerically unstable.
  38
       Schwartz (1997) and Casassus and Collin-Dufresne (2005) estimate Gaussian models that include a stochas-
tic process for both the spot convenience yield and the spot interest rate. It is straightforward to compute the
parameters of the implied spot cost of carry process. In the case of Schwartz (1997) we compare our results
with those in his Table IX, column two. The sample period in Schwartz (1997) is January 2, 1990 to February
17, 1995 while the sample period in Casassus and Collin-Dufresne (2005) is January 2, 1990 to August 25, 2003.



                                                       20
Bakshi, Cao, and Chen (1997) and Broadie, Chernov, and Johannes (2004). When stochastic
volatility models are estimated from panel data, σv is in principle identified from both the time-
series dynamics of v(t) and the cross-section of option prices, where σv determines the curvature
of the implied volatility “smile” by controlling the kurtosis of the futures return distribution.
In reality, however, σv is primarily identified from the option prices, and there is no guarantee
that the σv -estimate is consistent with the actual volatility of v(t). A rough
                                                                               estimate
                                                                                       of σv from
the time-series dynamics of v(t) over the entire sample is given by std v(t+∆)−v(t)
                                                                              √          = 1.703,39
                                                                              v(t)∆
which is certainly of the same magnitude as the actual σv -estimate of 2.502.
      The correlations between innovations to volatility and innovations to the spot price and
the cost of carry are low with ρ13 = −0.105 (-0.007 and -0.089 in the two sub-samples) and
ρ23 = −0.001 (-0.042 and -0.206 in the two sub-samples). Hence, the model implies that
most of the shocks to volatility cannot be hedged by trading in futures contracts, consistent
with the findings in Section 3. Similar to σv , ρ31 and ρ32 are in principle identified from
both the time-series dynamics of the state variables and the cross-section of option prices,
where ρ31 and ρ32 determine the skewness of the implied volatility “smile” by controlling the
skewness of the futures return distributions. However, ρ31 and ρ32 are also effectively identified
from the option prices. Rough estimates of ρ31 and ρ32from the time-series dynamics       of the
state variables over the entire sample are given by corr s(t+∆)−s(t)
                                                              √       , v(t+∆)−v(t)
                                                                           √          = 0.013 and
                                                                v(t)∆        v(t)∆
                               
corr x(t+∆)−x(t)
         √        , v(t+∆)−v(t)
                       √          = −0.057, which are close to the actual estimates.
             v(t)∆        v(t)∆


5.3.2     Model fit

Figure 3 displays the time-series of the root mean squared errors (RMSEs) and mean errors
(MEs) of the futures contracts (where the errors are the percentage differences between actual
and fitted prices) and option contracts (where the errors are the differences between actual and
fitted implied log-normal volatilities) when the model is estimated on the entire data set. We
have also highlighted the dates of four major shocks to the crude oil market. The Iraqi invasion
of Kuwait on August 2, 1990, the beginning of the US-led liberation of Kuwait (“Operation
Desert Storm”) on January 17, 1991, the September 11, 2001 terrorist attacks and the US-led
invasion of Iraq on March 20, 2003. For both futures and options, the MEs are negligible
which shows that the model tracks variations in the overall level of futures prices and implied
volatilities almost perfectly. The RMSE of futures prices mostly fluctuates between 0.5 and
 39                                   1
      Since we use weekly data ∆ =   52
                                        .


                                                21
2.5 percent with an average of 1.23 percent. However, it reaches almost five percent at the
beginning of “Operation Desert Storm”. The RMSE of the option implied volatilities mostly
fluctuate between one to three percent with an average of 2.12 percent. It spikes around all
four events that we have highlighted. The largest spike is again the beginning of “Operation
Desert Storm”, where it reaches more than 20 percent.
       The RMSE measure takes both variations and biases in the pricing errors into account. To
see if the pricing errors of the individual futures and options deviate systematically from zero,
Table 6 and Table 7 report the mean pricing errors and the associated t-statistics for all futures
and options contracts. The model performs extremely well in terms of pricing the futures curve
on average. It also generally performs well on average in terms of pricing options across the
moneyness and the maturity dimensions. The main shortcoming of the model is in the pricing
of deep in-the-money and out-of-the-money options on short term futures contracts, where
the pricing errors are strongly significant. This is also evident from Figure 4, which displays
the means of the actual and fitted implied volatility surfaces and implied “smile” surfaces.
Comparing Panel A with Panel B and particularly Panel C with Panel D shows that while
the model has a good fit to the average implied volatility “smile” for options on medium
term and longer term futures contracts, it is not able to match the average implied volatility
“smile” for options on short term futures contracts.40 This is a well known deficiency of
stochastic volatility models; as the option maturity goes to zero, the implied volatility “smile”
flattens, whereas it tends to become more pronounced in the data. In the equity derivatives
literature the solution has been to augment stochastic volatility models with jumps in the spot
price process and possibly the volatility process, see Bates (1996, 2000), Bakshi, Cao, and
Chen (1997) and Duffie, Pan, and Singleton (2000) among others. Our model can be extended
along similar lines.41
       Figure 5 shows the Kalman filtered state variables. Volatility (along with the spot price)
increased dramatically in response to the Iraqi invasion of Kuwait and stayed elevated until the
  40
       Note that in Panel A and B we simply compute the average implied volatility in each moneyness–maturity
category. Since the number of observations varies with moneyness and maturity care should be taken in
comparing average implied volatilities across moneyness and maturity. In particular, Panel A and B appears
to exaggerate the implied volatility “smile” compared to Panel C and D.
  41
       Hilliard and Reis (1998) develop a model for pricing commodity derivatives where the spot price follows
a jump-diffusion process. However, their model does not account for stochastic volatility, and they make no
attempt to fit their model to actual option data.




                                                       22
beginning of “Operation Desert Storm”. Volatility also increased sharply on September 11,
2001 (contrary to the spot price which fell dramatically as the event was perceived as negative
shock to the global economy and hence crude-oil demand). Finally, volatility increased in the
run-up to Gulf War II but decreased sharply once the invasion of Iraq commenced.


6         The relative valuation of plain-vanilla and calendar spread
          options

A popular crude-oil derivative trading on the NYMEX exchange is the calendar spread option.
Calendar spread options allow market participants to speculate on or hedge exposure to the
slope of the futures curve. In this section we price calendar spread options out-of-sample to
see if their prices are consistent with the plain-vanilla option market.


6.1         Pricing calendar spread options

The calendar spread option contract is a European style option on the price differential between
two futures contracts with different maturities (the maturities can be spaced one, two, three,
six and twelve months apart with the one-month and twelve month spreads being the most
liquid).42 At expiration the buyer of a put option contract, if choosing to exercise, will receive
a short position in the shorter-dated futures contract and a long position in the longer-dated
futures contract.43 Assuming interest rates are uncorrelated with futures prices, the time-t
price of a European put option expiring at time T0 with strike K on the price differential
between the futures contracts expiring at time T1 and T2 is

    P(t, T0 , T1 , T2 , K) = P (t, T0 )EtQ (K − (F (T0 , T1 ) − F (T0 , T2 )))1F (T0 ,T1 )−F (T0 ,T2 )<K ,
                                                                                                       
                                                                                                               (41)

where P (t, T0 ) denotes the time-t price of a zero-coupon bond maturing at time T0 .44
         In the particular case of K = 0, the calendar spread option reduces to an exchange option
which can be priced in closed form using transform techniques along the lines of Section 4.3.
This pricing formula is given in Appendix C. In the general case of K 6= 0, the calendar spread
    42
         NYMEX also lists options on “crack” spreads – the price differentials between crude-oil futures and either
heating-oil futures or gasoline futures.
    43
         Conversely, at expiration the buyer of a call option contract, if choosing to exercise, will receive a long
position in the shorter-dated futures contract and a short position in the longer-dated futures contract.
    44
         The option expires one business day before expiration of the shorter-dated futures contract.


                                                           23
option must be priced by Monte Carlo simulations. However, when K is close to zero, the
efficiency of the Monte Carlo simulations can be greatly enhanced by using the corresponding
calendar spread option with K = 0 as a control variate.


6.2       Data

The data on calendar spread options covers the period June 10, 2002 to May 18, 2006. We
consider the same weekly trading dates as in the Section 5. Furthermore, we restrict our
attention to monthly calendar spreads and only consider the following five spreads: M1–M2,
M2–M3, M3–M4, M4–M5, M5–M6, since the futures contracts that constitute these spreads
are also part of the data set used in Section 5. For each spread we select the put and the call
option with strike closest to the ATM strike.45 This leaves us with 744 put options and 746
call options.
       We price the options off the actual futures curves as in Section 5. This requires an esti-
mate of the spot price and the forward cost of carry curve at each trading date. We use a
parametrization of the forward cost of carry curve similar to the one proposed by Nelson and
Siegel (1987) for forward interest rate curves.46 This specification has the ability to fit a wide
variety of futures curve shapes while ensuring a smooth forward cost of carry curve.


6.3       Results

To address the relative valuation of plain-vanilla and calendar spread options, we first estimate
the model as in Section 5 over the period where calendar spread option data is available. We
then price the calendar spread options out-of-sample by simulations.47 Table 8 shows the mean
pricing errors for the puts and the calls. On average, the model-implied prices of ATM short-
  45
       We require that the option strike deviates no more than 0.25 dollars from the ATM strike. Furthermore,
we only consider options that have prices larger than 0.10 dollars, since prices are quoted with a precision of
0.01 dollars.
  46
       Specifically, we parameterize the forward cost of carry curve as y(t, T ) = β0 +β1 e−θ(T −t) +β2 θ(T −t)e−θ(T −t)
which yields the following expression for futures prices
                                                                                                      
                                                                  1             
                F (t, T )   =   S(t)exp β0 (T − t) + (β1 + β2 )     1 − e−θ(T −t) + β2 (T − t)e−θ(T −t) .          (42)
                                                                  θ
The spot price S(t) and the parameters β0 , β1 , β2 and θ are recalibrated on each observation date by minimizing
the mean squared percentage differences between the actual futures prices and those those given by (42).
  47
       Each calendar spread option is priced by simulations using 50,000 paths, antithetic variates and the corre-
sponding zero-strike calendar spread option as control variate.



                                                           24
term calendar spread options are lower than the actual prices. For five of the ten options that
we consider, the model-implied prices are more that ten percent lower than the actual prices,
on average, and for the put option on the M1–M2 spread the model-implied price is more
that 25 percent lower than the actual price, on average.48 At the same time, on average, the
model prices plain-vanilla ATM options almost without error.49 This implies that, on average,
ATM short-term calendar spread options have been overpriced relative to plain-vanilla ATM
options. However, the pricing errors are also very volatile which renders the apparent mis-
pricing insignificant except for put options on the M1–M2 and M2–M3 spreads. Figure 6 shows
the time series of the pricing errors. The high volatility of the pricing errors is apparent.
         One interpretation of the results is that there are temporary mis-pricing between plain-
vanilla and calendar spread options that a dynamic trading strategy might be able to exploit.
Note, however, that the liquidity of the calendar spread option market is significantly lower
than the liquidity in the plain-vanilla option market. Another possibility is that an extension
of the model with a more flexible correlation structure might be consistent with the observed
variation in the relative valuations of plain-vanilla and calendar spread options.50


7         Conclusion

We have analyzed unspanned stochastic volatility in commodity markets in general and the
crude-oil market in particular. We first present model-free regression-based results which
strongly indicate that in the crude-oil market it is very difficult to hedge volatility risk with
crude-oil futures contracts. That is, volatility appears mostly unspanned by the futures con-
tracts. These results are model-free in the sense that they are not conditional on a particular
pricing model.
         We then develop a parsimonious model for pricing commodity derivatives in the presence
of unspanned stochastic volatility. The model takes the initial futures curve as given. Futures
prices depend on two factors. The volatility of futures prices depend on a third factor implying
    48
         The median pricing errors (not reported) are generally slightly lower than the mean pricing errors so the
results are not driven by a few observations with extreme mis-valuation.
    49
         The mean pricing errors for plain-vanilla ATM options (ATM here refers to those options with moneyness
in the interval 0.98–1.02) range from -0.14 percent to 2.14 percent.
    50
         Calendar spread options are sensitive to variations in correlations between the futures contracts. In our
model the correlations are constant due to the assumption of a single volatility factor. An extension of the
model with multiple volatility factors would feature a time-varying correlation structure.


                                                          25
that options on futures contracts depend on three factors. The model features correlations
between innovations to futures prices and volatility; therefore, volatility may be partially
spanned by the futures contracts. The model is highly tractable as it has quasi-analytical
prices of European options on futures. Furthermore, the dynamics of the futures curve can be
described in terms of a four-dimensional affine state vector, which makes the model suitable for
estimation and for pricing derivatives by simulations. Estimating the model on an extensive
panel data-set of crude-oil futures and options, we show that it has an excellent fit to futures
across different maturities and generally a good fit to options across both different moneyness
categories and maturities.
   As an application of the model, we price ATM calendar spread options out-of-sample from
the model estimated on the main data set. Conditional on the model being true, ATM calendar
spread options have been overvalued relative to plain-vanilla options on average, although the
mis-pricing is insignificant for all but a few options.
   The model can be extended along several dimensions. For instance, we might include
separate processes for the forward interest rate and the forward convenience yield as well as
multiple (partially) unspanned stochastic volatility factors. Perhaps more importantly, the
model can be extended with jumps in the spot price and possibly volatility. This would
increase the ability of the model to match the implied volatility “smile” for very short-term
options.
   In the empirical parts of the paper we have used data from the crude-oil derivatives market
since this is the most important and most liquid commodity derivatives market in the world.
It is likely that markets related to crude-oil such as gasoline and heating-oil as well natural
gas also exhibit unspanned stochastic volatility. An interesting question is whether unspanned
stochastic volatility is an important feature of commodity derivatives markets less related to
crude-oil, such as metals and agricultural products. We leave these issues for future research.




                                                26
Appendix A: Proofs

Proof of Proposition 1

We introduce the process
                                                  Z       T
                                      Y (t) =                 y(t, u)du,                                 (43)
                                                      t

the dynamics of which is given by
                            Z T            
                                                 p     Z                       T
         dY (t) = −δ(t) +        µy (t, u)du dt + v(t)                             σy (t, u)dudW2 (t).   (44)
                                 t                                         t

F (t, T ) is given by

                                       F (t, T ) = S(t)eY (t)                                            (45)

which follows
   dF (t, T )     dS(t)              1             dS(t)
                =       + dY (t) + (dY (t))2 +            dY (t)
    F (t, T )      S(t)              2              S(t)
                    Z T                  Z T              2        Z T            !    !
                                       1
                =       µy (t, u)du +           σy (t, u)du + ρ12 σS     σy (t, u)du v(t) dt
                     t                 2    t                         t
                    p
                                        Z T                     
                  + v(t) σS dW1 (t) +         σy (t, u)dudW2 (t) .                         (46)
                                              t

In the absence of arbitrage, the drift must equal zero. Imposing this condition and differenti-
ating w.r.t. T yields (7).


Proof of Proposition 2

With σy (t, T ) given as (8), µy (t, T ) is given by (7) as
                                     2               2                    
                                     α −2γ(T −t)       α            −γ(T −t)
                  µy (t, T ) = v(t)     e          −      + ρ12 σS e           .                         (47)
                                     γ                  γ
Integrating (3) and using that e−γ(T −u) = e−γ(T −t) e−γ(t−u) , we obtain
                                     Z t                Z t           p
               y(t, T ) = y(0, T ) +     µy (u, T )du +     σy (u, T ) v(u)dW (u)
                                          0                            0
                         = y(0, T ) + αe−γ(T −t) x(t) + αe−2γ(T −t) φ(t),                                (48)

where
                             t                              Z t
                                     α
                         Z
                                                 −γ(t−u)
                                                                  e−γ(t−u) v(u)dW (u)
                                                                          p
            x(t) = −     v(u)          + ρ12 σS e        du +                                            (49)
                       0             γ                         0
                   Z t
                           α
            φ(t) =     v(u) e−2γ(t−u) du.                                                                (50)
                    0      γ

                                                              27
Applying Ito’s Lemma to these expressions gives the dynamics of x(t) and φ(t) stated in (12)
and (13).


Proof of Proposition 3

The proof is similar to those in Duffie, Pan, and Singleton (2000) and Collin-Dufresne and
Goldstein (2003). We can rewrite (23) as
                                                h    h                   ii
                         ψ(u, t, T0 , T1 ) = EtQ ETQ0 eulog(F (T0 ,T1 ))

                                           = EtQ [ψ(u, T0 , T0 , T1 )] .                       (51)

Therefore, the proof consists of showing that the process η(t) ≡ ψ(u, t, T0 , T1 ) is a martingale
under Q. To this end we conjecture that ψ(u, t, T0 , T1 ) is of the form (24). Applying Ito’s
Lemma to η(t) and setting τ = T0 − t, we obtain
                                        
     dη(t)          dM (τ ) dN (τ )                             dF (t, T1 )
             =    −         −        v(t) dt + N (τ )dv(t) + u
      η(t)             dτ       dτ                               F (t, T1 )
                                                            2
                  1                  1           dF (t, T1 )                   dF (t, T1 )
                + N (τ )2 (dv(t))2 + (u2 − u)                   + N (τ )udv(t)             .   (52)
                  2                  2           F (t, T1 )                     F (t, T1 )

For η(t) to be a martingale, it must hold that
                              
                  1 Q dη(t)
          0 =      E
                 dt t     η(t)
                   dM (τ ) dN (τ )                             1
             = −           −         v(t) + N (τ )κ(θ − v(t)) + N (τ )2 σv2 v(t)
                     dτ         dτ                             2
                   1 2          2               2
                 + (u − u)(σS + Bx (T1 − t) + 2ρ12 σS Bx (T1 − t))v(t)
                   2
                 +N (τ )uσv (ρ13 σS + ρ23 Bx (T1 − t))v(t)
                   dM (τ )
             = −           + N (τ )κθ
                     dτ
                  dN (τ )                                                      1
                   −         + N (τ ) (−κ + uσv (ρ13 σS + ρ23 Bx (T1 − t))) + N (τ )2 σv2
                        dτ                                                      2
                   1 2          2               2
                                                                      
                 + (u − u)(σS + Bx (T1 − t) + 2ρ12 σS Bx (T1 − t)) v(t).                       (53)
                   2

Hence, η(t) is a martingale, provided that M (τ ) and N (τ ) satisfy (25) and (26). Furthermore,
we have that

                               ψ(u, T0 , T0 , T1 ) = eulog(F (T0 ,T1 )) ,                      (54)

which is true, provided that M (0) = 0 and N (0) = 0.


                                                  28
Proof of Proposition 4

Again, we follow Duffie, Pan, and Singleton (2000) and Collin-Dufresne and Goldstein (2003).
Assuming r(t) and F (t, T1 ) are uncorrelated, the time-t price a European put option expiring
at time T0 with strike K on a futures contract expiring at time T1 , P(t, T0 , T1 , K), is given by
                        h R T0                                       i
P(t, T0 , T1 , K) = EtQ e− t r(s)ds (K − F (T0 , T1 ))1F (T0 ,T1 )<K
                                                                   h                                         i
                  = P (t, T0 ) KEtQ 1log(F (T0 ,T1 ))<log(K) − EtQ elog(F (T0 ,T1 )) 1log(F (T0 ,T1 ))<log(K)
                                                           

                   = P (t, T0 ) (KG0,1 (log(K)) − G1,1 (log(K))) ,                                         (55)

where
                                        h                                       i
                          Ga,b (y) = EtQ ealog(F (T0 ,T1 )) 1blog(F (T0 ,T1 ))<y .                     (56)

To evaluate Ga,b (y), note that its Fourier transform is given by
                                           Z
                             Ga,b (y) =        eiuy dGa,b (y)
                                             R
                                                h                    i
                                      = EtQ e(a+iub)log(F (T0 ,T1 ))

                                            = ψ(a + iub, t, T0 , T1 ),                                 (57)
            √
where i =    −1. Applying the Fourier inversion theorem we have

                        ψ(a, t, T0 , T1 ) 1 ∞ Im ψ(a + iub, t, T0 , T1 )e−iuy
                                            Z                                
             Ga,b (y) =                  −                                      du.                    (58)
                               2           π 0            u


Appendix B: Estimation by the extended Kalman filter

The extended Kalman filter

Let X̂t = Et [Xt ] and X̂t|t−1 = Et−1 [Xt ] denote expectations of Xt (respectively including
and excluding zt ), and let Pt and Pt|t−1 denote the corresponding estimation error covariance
matrices. Linearizing the h-function in (37) around X̂t|t−1 we obtain

                zt = (h(X̂t|t−1 ) − Ht′ X̂t|t−1 ) + Ht′ Xt + ut ,          ut ∼ iid. N (0, SΩ),        (59)

where

                                               δh(Xt )
                                       Ht′ =                           .                               (60)
                                                δXt′     Xt =X̂t|t−1



                                                       29
Assuming wt in (40) is Gaussian, we obtain

                       Xt+1 = Φ0 + ΦX Xt + wt+1 ,              wt+1 ∼ iid. N (0, Qt ).                  (61)

The Kalman filter applied to (59) and (61) yields

                                      X̂t+1|t = Φ0 + ΦX X̂t                                             (62)

                                         Pt+1|t = ΦX Pt Φ′X + Qt                                        (63)

and

                               X̂t+1 = X̂t+1|t + Pt+1|t Ht′ Ft−1 ǫt                                     (64)

                               Pt+1 = Pt+1|t − Pt+1|t Ht′ Ft−1 Ht Pt+1|t ,                              (65)

where

                                         ǫt = zt+1 − h(X̂t+1|t )                                        (66)

                                      Ft = Ht Pt+1|t Ht′ + SΩ.                                          (67)

   The log-likelihood function is constructed from (66) and (67):
                                          T              T                   T
                           1      X      1X            1 X ′ −1
                   logL = − log2π   Nt −    log|Ft | −    ǫt Ft ǫt ,                                    (68)
                           2             2             2
                                         i=1             i=1                i=1

where T is the number of observation dates and Nt is the dimension of zt . We follow standard
practice in the literature and initialize the Kalman filter at the unconditional values of X̂t|t−1
and Pt|t−1 .


The transition density

The dynamics of the state vector under the actual measure can be written as
                                                                p
                          dX(t) = (Ψ − KX(t))dt +                   v(t)ΣdW P (t),                      (69)
                                                                          ′
where Xt = (s(t), x(t), φ(t), v(t))′ , W P (t) = W1P (t), W2P (t), W3P (t) and
                                                                                               
                                                        1 2
               ϕ               −1 −α −α                 2 σS   − λ1v σS                  σS 0   0
                                                                                            
         0        0                              α
                                    −γ         0    γ   + ρ12 σS − λ2v       0            1 0 
      Ψ=    ,K =                                                    ,Σ =                    .     (70)
                                                                                            
         0 
            
                    0
                                    0         2γ           − αγ       
                                                                       
                                                                              0
                                                                                           0 0 
          κθ         0               0         0         κ − λ3v σv            0            0 σv

                                                         30
Applying Ito’s Lemma to eKt X(t), we obtain

                            d eKt X(t) = eKt KX(t)dt + eKt dX(t)
                                      

                                        = eKt Ψdt + eKt v(t)ΣdW P (t).
                                                       p
                                                                                                                (71)

It follows that X(s), s > t is given as
                                  Z s                Z                 s
                  −K(s−t)              −K(s−u)
                                                                           e−K(s−u)
                                                                                      p
         X(s) = e         X(t) +      e        Ψdu +                                      v(u)ΣdW P (u).        (72)
                                         t                         t

The conditional mean of X(s), given time-t information, is given by
                                 Z s
                    Et [X(s)] =      e−K(s−u) Ψdu + e−K(s−t) X(t),                                              (73)
                                             t

and the conditional covariance matrix of X(s), given time-t information, is given by
                           Z    s                              Z           s                             ′ 
                                      −K(s−u)                                      −K(s−u)
                                                 p             P
                                                                                              p            P
   Covt [X(s)] = Et         e                        v(u)ΣdW (u) e                                v(u)ΣdW (u)
                          t                                  t
                 Z s
                                                   ′
               =      Et [v(u)] e−K(s−u) ΣρΣ′ e−K (s−u) du
                 Zt s                 
                                P                              ′
               =        1 − e−κv (u−t) θvP e−K(s−u) ΣρΣ′ e−K (s−u) du
                  t
                    Z s
                            P                        ′
                 +       e−κv (u−t) e−K(s−u) ΣρΣ′ e−K (s−u) duv(t),                                             (74)
                            t

where ρ denotes the correlation matrix for the Wiener processes, i.e. dW P (t)dW P (t)′ = ρdt.
Φ0 , ΦX , Q0 and Qv can be inferred from (73) and (74).


Appendix C: Pricing zero-strike calendar spread options

To price a zero-strike European calendar spread option, we introduce the transform
                                                    h                                        i
                 ψ(u1 , u2 , t, T0 , T1 , T2 ) = EtQ eu1 log(F (T0 ,T1 ))+u2 log(F (T0 ,T2 )) ,                 (75)

which has an exponentially affine solution given in the following proposition

Proposition 5 The transform in (75) is given by

          ψ(u1 , u2 , t, T0 , T1 , T2 ) = eM (T0 −t)+N (T0 −t)v(t)+u1 log(F (t,T1 ))+u2 log(F (t,T2 )) ,        (76)




                                                          31
where M (τ ) and N (τ ) solve the following system of ODEs

dM (τ )
              = N (τ )κθ                                                                                                 (77)
 dτ
dN (τ )
              = N (τ ) (−κ + u1 σv (ρ13 σS + ρ23 Bx (T1 − T0 + τ )) + u2 σv (ρ13 σS + ρ23 Bx (T2 − T0 + τ )))
  dτ
                   1              1
                  + N (τ )2 σv2 + (u21 − u1 )(σS2 + Bx (T1 − T0 + τ )2 + 2ρ12 σS Bx (T1 − T0 + τ ))
                   2              2
                   1 2
                  + (u2 − u2 )(σS2 + Bx (T2 − T0 + τ )2 + 2ρ12 σS Bx (T2 − T0 + τ ))
                   2
                  +u1 u2 (σS2 + Bx (T1 − T0 + τ )Bx (T2 − T0 + τ )

                  +ρ12 σS (Bx (T1 − T0 + τ ) + Bx (T2 − T0 + τ ))),                                                      (78)

subject to the boundary conditions M (0) = 0 and N (0) = 0.

Proof: The proof is similar to that of Proposition 3 and therefore omitted.51


       By the Fourier inversion theorem we can now price a zero-strike European calendar spread
option.

Proposition 6 The time-t price of a European calendar spread put option expiring at time
T0 with strike K = 0 on the price differential between the futures contracts expiring at time T1
and T2 , P(t, T0 , T1 , T2 , K = 0), is given by
                                h R T0                                                                     i
P(t, T0 , T1 , T2 , K = 0) = EtQ e− t r(s)ds (0 − (F (T0 , T1 ) − F (T0 , T2 )))1F (T0 ,T1 )−F (T0 ,T2 )<0

                               = P (t, T0 )(G0,1,1,−1 (0) − G1,0,1,−1 (0)),                                       (79)
                                                                                                                 √
where P (t, T0 ) denotes the time-t price of a zero-coupon bond maturing at time T0 , i =                         −1
and Ga1 ,a2 ,b1 ,b2 (y) is defined as
                                                             ∞   Im ψ(a1 + iub1 , a2 + iub2 , t, T0 , T1 , T2 )e−iuy
                                                                                                                    
                      ψ(a1 , a2 , t, T0 , T1 , T2 ) 1
                                                         Z
Ga1 ,a2 ,b1 ,b2 (y) =                              −                                                                   du.(80)
                                   2                 π   0                             u

Proof: The proof is similar to that of Proposition 4 and therefore omitted.52



  51
       The proof is available on our web-sites.
  52
       The proof is available on our web-sites. This formula is exact when interest rates are uncorrelated with
futures prices. To the extent that the correlation is low and the volatility of interest rates is low relative to the
volatility of futures spreads, the formula gives a very accurate approximation of the true price of short-term or
medium-term options.


                                                             32
                    # obs                   Entire sample                                Rolling sample
                                   P C f ut,1   P C f ut,2    P C f ut,3    P C f ut,1     P C f ut,2   P C f ut,3
 M1 – M4            3686            98.69         1.08          0.21          99.05          0.85         0.09
                                                                              (0.10)         (0.08)       (0.01)

 M1 – M6            2664            98.69         1.17          0.11          98.72          1.16         0.10
                                                                              (0.09)         (0.09)       (0.01)

 M1 – Q2            1479            97.85         1.94          0.16          97.87          1.93         0.15
                                                                              (0.18)         (0.17)       (0.01)

 M1 – Y2            1055            96.01         3.51          0.34          96.06          3.48         0.32
                                                                              (0.40)         (0.36)       (0.04)

 M1 – Y4             162            96.77         2.94          0.20          97.15          2.59         0.19
                                                                              (0.20)         (0.19)       (0.01)

Notes: The principal components are obtained by factor analyzing the covariance matrix of the futures returns.
The table reports the percentage of futures return variation explained by the first three principal components.
We consider five different sets of futures contracts. “Entire sample” denotes that the analysis is performed
over the entire sample. “Rolling sample” denotes that the analysis is performed on a rolling window of 100
observations. The latter case yields time-series of the explanatory power of the first three principal components,
and the table reports the means of these time-series with the standard derivations of the means in parentheses
(these standard deviations are computed using Newey and West (1987) standard errors with 20 lags).

                            Table 1: Common variation in futures returns




                                                         33
                                                                             Underlying futures contract
                          M1         M2          M3          M4          M5          M6          Q1          Q2         Y1          Y2          Y3          Y4
                                                                             Entire sample
      M1 – M4           15.35       14.72       14.42       13.39        —           —           —           —           —           —          —           —
      M1 – M6           39.36       39.52       29.89       24.30       22.66      20.72         —           —           —           —          —           —
      M1 – Q2           45.46       41.65       33.47       26.28       22.45      19.15       14.19       12.27         —           —          —           —
      M1 – Y2           43.55       41.30       33.35       26.84       26.31      21.58       21.21       15.65       16.56       6.61         —           —
      M1 – Y4           62.49       61.38       58.53       54.27       53.62      51.74       50.40       43.49       44.65       28.19       34.55      37.56
                                                                            Rolling sample
      M1 – M4           49.29       47.17       36.83       33.05        —           —           —           —           —           —          —           —
34




                         (2.06)      (1.94)     (1.91)      (1.91)

      M1 – M6           53.16       51.21       38.24       35.37       34.85      30.15         —           —           —           —          —           —
                         (2.64)      (2.21)     (2.43)      (2.36)      (2.19)      (2.56)

      M1 – Q2           58.63       53.82       44.54       39.01       36.52      29.67       27.21       23.65         —           —          —           —
                         (2.32)      (2.37)     (2.48)      (2.98)      (2.74)      (3.49)      (3.29)      (3.51)

      M1 – Y2           59.45       55.94       45.39       40.34       39.72      33.35       31.16       27.10       28.05       16.69        —           —
                         (2.82)      (2.47)     (3.19)      (3.81)      (2.63)      (3.57)      (3.22)      (3.67)     (2.39)      (2.76)

      M1 – Y4           66.14       64.71       62.22       56.92       56.32      58.08       55.43       49.59       44.96       25.14       29.03      24.78
                         (0.40)      (0.13)     (1.09)      (3.00)      (2.95)      (0.61)      (1.16)      (0.45)     (0.76)      (1.29)      (0.46)      (2.03)

     Notes: The adjusted R2 s from regressing straddle returns on the first three principal components and squared principal components of the futures returns.
     We consider five different sets of futures contracts. “Entire sample” denotes that the analysis is performed over the entire sample. “Rolling sample” denotes
     that the analysis is performed on a rolling window of 100 observations. The latter case yields time-series of adjusted R2 s, and the table reports the means of
     these time-series with the standard derivations of the means in parentheses (these standard deviations are computed using Newey and West (1987) standard
     errors with 20 lags).

                                                         Table 2: R2 s from straddle return regressions
                                                                             Underlying futures contract
                         M1          M2          M3          M4         M5          M6          Q1         Q2          Y1          Y2         Y3          Y4
                                                                             Entire sample
      M1 – M4           20.88       16.89      13.86        12.89        —          —           —           —          —           —           —          —
      M1 – M6           14.95       12.81       8.15         5.23       4.80       3.45         —           —          —           —           —          —
      M1 – Q2           12.08        8.76       6.64         2.98       3.26       2.79        1.67        0.99        —           —           —          —
      M1 – Y2           11.29        9.90       7.18         5.85       6.23       3.21        4.37        2.35       3.23        0.92         —          —
      M1 – Y4           20.41       19.83      18.42        12.84      15.48       16.47      14.81       15.06       12.12       0.42        0.85       0.94
                                                                           Rolling sample
      M1 – M4           19.43       22.50      17.33        16.05        —          —           —           —          —           —           —          —
35




                         (1.66)     (1.63)      (1.62)       (1.44)

      M1 – M6           18.95       20.75      14.33        15.10      13.21       9.79         —           —          —           —           —          —
                         (1.63)     (1.52)      (1.19)       (1.22)    (1.19)      (1.17)

      M1 – Q2           20.02       20.24      16.22        16.14      12.55       9.26        8.52        7.46        —           —           —          —
                         (1.63)     (1.32)      (1.30)       (1.41)    (1.18)      (1.27)      (1.34)     (1.64)

      M1 – Y2           20.62       22.97      17.32        15.94      13.84       8.31        7.86        7.33       9.05        4.05         —          —
                         (2.22)     (1.98)      (2.27)       (1.99)    (2.17)      (1.17)      (1.48)     (1.79)      (1.73)      (2.11)

      M1 – Y4           27.02       23.46      23.91        17.24      19.50       25.35      21.92       22.89       9.62       −6.40       −6.24     −12.58
                         (2.91)     (2.23)      (2.22)       (0.76)    (2.13)      (1.08)      (0.95)     (1.86)      (1.94)      (1.26)     (0.39)      (0.70)
                            2
     Notes: The adjusted R s from regressing changes in implied log-normal volatilities on the first three principal components and squared principal components
     of the futures returns. We consider five different sets of futures contracts. “Entire sample” denotes that the analysis is performed over the entire sample.
     “Rolling sample” denotes that the analysis is performed on a rolling window of 100 observations. The latter case yields time-series of adjusted R2 s, and the
     table reports the means of these time-series with the standard derivations of the means in parentheses (these standard deviations are computed using Newey
     and West (1987) standard errors with 20 lags).

                                                         Table 3: R2 s from implied volatility regressions
                   # obs                   Entire sample                               Rolling sample
                                  P C res,1    P C res,2   P C res,3       P C res,1     P C res,2   P C res,3
                                        Straddle return regressions
 M1 – M4            3686           79.79        12.18         4.61           71.60         17.31        6.79
                                                                             (0.69)        (0.41)       (0.29)

 M1 – M6            2664           64.94        16.47         6.37           62.23         18.29        8.09
                                                                             (1.15)        (0.57)       (0.34)

 M1 – Q2            1479           53.63        17.93         7.76           54.81         18.46        8.87
                                                                             (2.28)        (0.80)       (0.49)

 M1 – Y2            1055           50.81        14.44         9.09           51.00         17.00        9.71
                                                                             (2.64)        (0.94)       (0.55)

 M1 – Y4             162           56.19        18.61        11.63           55.58         20.50        12.11
                                                                             (0.33)        (0.27)       (0.19)

                                       Implied volatility regressions
 M1 – M4            3686           80.13        12.28         4.75           73.05         15.80        6.91
                                                                             (0.76)        (0.39)       (0.29)

 M1 – M6            2664           64.75        15.23         7.26           63.56         16.48        8.41
                                                                             (1.27)        (0.47)       (0.38)

 M1 – Q2            1479           54.97        15.97         8.07           57.09         16.97        8.65
                                                                             (2.27)        (0.74)       (0.43)

 M1 – Y2            1055           52.62        13.83         7.01           55.51         15.08        8.51
                                                                             (2.57)        (0.87)       (0.49)

 M1 – Y4             162           66.31        14.42         8.03           66.84         14.36        8.44
                                                                             (0.99)        (0.91)       (0.15)

Notes: The principal components are obtained by factor analyzing the covariance matrix of the residuals from
both the straddle return regressions and the implied volatility regressions. The table reports the percentage
of the variation in residuals explained by the first three principal components. We consider five different sets
of futures contracts. “Entire sample” denotes that the analysis is performed over the entire sample. “Rolling
sample” denotes that the analysis is performed on a rolling window of 100 observations. The latter case yields
time-series of the explanatory power of the first three principal components, and the table reports the means
of these time-series with the standard derivations of the means in parentheses (these standard deviations are
computed using Newey and West (1987) standard errors with 20 lags).

                           Table 4: Common variation in regression residuals




                                                      36
                               1990–2006                     1990–1997                    1998–2006
 κ                                0.8638                       1.0813                        1.8728
                                  (0.0249)                     (0.0397)                      (0.0290)

 σv                               2.5017                       2.7276                        2.4388
                                  (0.0434)                     (0.0614)                      (0.0303)

 α                                0.1751                       0.2405                        0.2794
                                  (0.0058)                     (0.0096)                      (0.0070)

 γ                                0.7917                       1.3248                        0.8163
                                  (0.0026)                     (0.0073)                      (0.0028)

 σS                               0.2576                       0.2440                        0.3705
                                  (0.0044)                     (0.0053)                      (0.0032)

 ρ12                            −0.9112                       −0.9438                       −0.8839
                                  (0.0057)                     (0.0053)                      (0.0059)

 ρ13                            −0.1050                       −0.0066                       −0.0893
                                  (0.0036)                     (0.0062)                      (0.0043)

 ρ23                            −0.0005                       −0.0427                       −0.2064
                                  (0.0223)                     (0.0307)                      (0.0211)

 ϕ                                0.0056                       0.0179                       −0.0019
                                  (0.0002)                     (0.0002)                      (0.0003)

 λ1v                              0.3723                       0.2245                        0.7228
                                  (0.1969)                     (0.2763)                      (0.4025)

 λ2v                            −0.2383                       −0.3439                       −0.3753
                                  (0.1899)                     (0.2647)                      (0.4044)

 λ3v                              0.1882                       0.1818                        0.1866
                                  (0.0753)                     (0.1119)                      (0.1413)

 σf utures                        0.0153                       0.0109                        0.0153
                                  (0.0001)                     (0.0001)                      (0.0001)

 σoptions                         0.0271                       0.0300                        0.0235
                                  (0.0000)                     (0.0000)                      (0.0000)

 Log-likelihood                 139855.7                      52925.4                       83105.9
Notes: Maximum-likelihood estimates with outer-product standard errors in parentheses. σf utures denotes the
standard deviation of log futures price measurement errors and σoptions denotes the standard deviation of scaled
option measurement errors. θ has been normalized to one.

                                      Table 5: Parameter estimates




                                                      37
                  Futures contract                                              Pricing error
                          M1                                                       −0.07
                                                                                   (−0.25)

                          M2                                                       −0.13
                                                                                   (−0.99)

                          M3                                                       −0.11∗∗
                                                                                   (−2.04)

                          M4                                                       −0.04
                                                                                   (−0.73)

                          M5                                                          0.03
                                                                                     (0.36)

                          M6                                                          0.11
                                                                                     (0.90)

                          Q1                                                          0.22
                                                                                     (1.38)

                          Q2                                                          0.29
                                                                                     (1.51)

                          Y1                                                          0.06
                                                                                     (0.33)

                          Y2                                                       −0.46∗∗∗
                                                                                   (−4.38)

                          Y3                                                       −0.25
                                                                                   (−1.23)

                          Y4                                                          0.49
                                                                                     (1.54)

Notes: The table reports the mean percentage pricing errors for the futures contracts when the model is
estimated on the entire data set. The pricing errors are defined as the differences between the fitted and actual
prices divided by the actual prices. T -statistics corrected for serial correlation up to 12 lags are in parentheses.
Each statistic is computed using a maximum of 855 weekly observations from January 3, 1990 to May 17, 2006.
*, ** and *** denote significance at the ten, five and one percent level, respectively.

                 Table 6: Summary statistics of pricing errors for futures contracts




                                                         38
 Moneyness                                                      Contract
                        M1          M2          M3            M4         M5          M6          Q1           Q2
 0.78–0.82           −3.04∗∗ −1.50∗∗∗ −0.65∗∗ −0.19                   −0.17       −0.23       −0.32        −1.23∗∗
                     (−2.18)      (−3.41)    (−2.25)      (−0.62)     (−0.54)     (−0.64)     (−0.73)      (−1.97)

 0.82–0.86           −1.80∗∗ −1.16∗∗∗ −0.42∗              −0.03         0.05      −0.05       −0.08        −0.72
                     (−2.19)      (−3.10)     (−1.88)     (−0.14)       (0.19)    (−0.16)     (−0.20)      (−1.25)

 0.86–0.90           −1.09∗       −0.80∗∗∗ −0.17            0.14        0.17        0.03      −0.11        −0.40
                     (−1.84)      (−2.88)    (−1.05)        (0.98)      (0.93)      (0.13)    (−0.35)      (−0.75)

 0.90–0.94           −0.49        −0.38∗     −0.02          0.25 ∗∗     0.20      −0.01       −0.05        −0.46
                     (−1.05)      (−1.69)    (−0.19)        (2.24)      (1.15)    (−0.03)     (−0.17)      (−0.93)

 0.94–0.98             0.40       −0.06         0.12        0.16 ∗      0.18      −0.04       −0.10        −0.51
                       (1.08)     (−0.29)      (1.22)       (1.77)      (1.01)    (−0.19)     (−0.33)      (−1.12)

 0.98–1.02             1.16 ∗∗∗     0.04        0.13        0.17 ∗      0.16      −0.01       −0.04        −0.45
                       (3.42)      (0.16)      (1.10)       (1.85)      (1.07)    (−0.05)     (−0.12)      (−1.03)

 1.02–1.06             0.50       −0.16         0.01      −0.04         0.06      −0.09       −0.19        −0.56
                       (1.38)     (−0.64)      (0.09)     (−0.36)       (0.41)    (−0.43)     (−0.66)      (−1.20)

 1.06–1.10           −0.19        −0.44      −0.18        −0.09         0.01      −0.16       −0.08        −0.54
                     (−0.41)      (−1.57)    (−1.12)      (−0.76)       (0.06)    (−0.76)     (−0.26)      (−1.08)

 1.10–1.14           −0.95∗       −0.77∗∗ −0.33∗          −0.10         0.02        0.11         0.04      −0.17
                     (−1.67)      (−2.26)     (−1.73)     (−0.79)       (0.11)      (0.44)      (0.14)     (−0.31)

 1.14–1.18           −1.71∗∗ −1.15∗∗ −0.49∗∗ −0.35∗                     0.07        0.20         0.34        0.31
                     (−2.19)      (−2.54)    (−2.11)      (−1.93)       (0.39)      (0.82)      (1.02)       (0.56)

 1.18–1.22           −3.16∗∗∗ −1.51∗∗∗ −0.88∗∗∗ −0.46∗∗ −0.02                       0.17         0.36        0.42
                     (−2.92)      (−2.64)    (−2.84)      (−2.10)     (−0.12)       (0.65)      (1.13)       (0.86)

Notes: The table reports the mean pricing errors for the options within each moneyness–maturity category
when the model is estimated on the entire data set. The pricing errors are defined as the differences between
fitted and actual log-normal implied volatilities. T -statistics corrected for serial correlation up to 12 lags are in
parentheses. Each statistic is computed using a maximum of 855 weekly observations from January 3, 1990 to
May 17, 2006. *, ** and *** denote significance at the ten, five and one percent level, respectively.

          Table 7: Summary statistics of pricing errors for options on futures contracts




                                                         39
 Calendar spread                               Put                                          Call
 M1–M2                                      −25.41∗∗∗                                     −7.12
                                            (−4.71)                                       (−1.33)

 M2–M3                                      −13.32∗∗                                     −10.18∗
                                             (−2.04)                                      (−1.70)

 M3–M4                                      −13.01∗                                      −10.93∗
                                             (−1.67)                                      (−1.79)

 M4–M5                                       −6.11                                        −9.16
                                            (−0.64)                                       (−1.14)

 M5–M6                                       −0.59                                        −1.87
                                            (−0.06)                                       (−0.18)

Notes: The table reports the mean percentage pricing errors for ATM calendar spread options. The pricing
errors are defined as the differences between the fitted and actual prices divided by the actual prices. T -statistics
corrected for serial correlation up to 12 lags are in parentheses. The calendar spread options are priced out-
sample from the model estimated on the main option data set using weekly data from June 6, 2002 to May
17, 2006. Each calendar spread option is priced by simulations using 50,000 paths, antithetic variates and the
corresponding zero-strike calendar spread option as control variate. The number of observations range from 101
(for put options on the M5–M6 spread) to 197 (for put options on the M1–M2 spread). *, ** and *** denote
significance at the ten, five and one percent level, respectively.

Table 8: Summary statistics of out-of-sample pricing errors for ATM calendar spread options




                                                         40
            80


            70


            60


            50
  Dollars




            40


            30


            20


            10
                                                                                                                5
                                                                                                         4
            0
                                                                                                  3
            Jan06
                    Jan04                                                                   2
                            Jan02
                                    Jan00
                                            Jan98                                       1
                                                    Jan96                                       Futures maturity,
                                                            Jan94
                                                                    Jan92           0
                                                                            Jan90               years


Figure 1: Prices of futures contracts
Prices of M1, M2, M3, M4, M5, M6, Q1, Q2, Y1, Y2, Y3 and Y4 futures contracts. Along the time-dimension
there are 855 weekly observations from January 3, 1990 to May 17, 2006.




                                                                    41
            120




            100




             80
  Percent




             60




             40




             20
                                                                                                                    1.2
                                                                                                                1
             0                                                                                            0.8
            Jan06                                                                                   0.6
                    Jan04
                            Jan02                                                             0.4
                                    Jan00
                                            Jan98
                                                    Jan96                               0.2          Option maturity,
                                                            Jan94
                                                                    Jan92           0
                                                                            Jan90                    years


Figure 2: Implied log-normal volatility of futures options
Implied log-normal volatility of options on the M1, M2, M3, M4, M5, M6, Q1 and Q2 futures contracts. Implied
volatilities are computed from option prices by inverting the Barone-Adesi and Whaley (1987) formula. Along
the time-dimension there are 855 weekly observations from January 3, 1990 to May 17, 2006.




                                                                    42
                                   Panel A: RMSEs and MEs of futures prices

            5


             4


             3
  Percent




             2


             1


             0

                 Jan90   Jan92     Jan94    Jan96      Jan98      Jan00      Jan02      Jan04       Jan06




                         Panel B: RMSE and MEs of log-normal implied option volatilities

            20


            15
  Percent




            10


             5


            0

                 Jan90   Jan92     Jan94    Jan96      Jan98      Jan00      Jan02      Jan04      Jan06



Figure 3: Time-series of RMSEs and MEs of futures and options
Panel A shows time-series of root-mean-squared-errors (RMSEs) and mean errors (MEs) of the percentage
differences between actual and fitted futures prices when the model is estimated on the entire data set. Panel
B shows time-series of RMSEs and MEs of the differences between actual and fitted implied option volatilities.
—— denotes RMSEs and —— denotes MEs. The vertical dotted lines mark the Iraqi invasion of Kuwait on
August 2, 1990, the beginning of the US-led liberation of Kuwait (“Operation Desert Storm”) on January 17,
1991, the September 11, 2001 terrorist attacks and the US-led invasion of Iraq on March 20, 2003, respectively.
The number of futures at a given date varies between 8 and 12. The number of options at a given date varies
between 23 and 87. Each time-series consists of 855 weekly observations from January 3, 1990 to May 17, 2006.



                                                      43
               Panel A: Average actual vol. surface                                 Panel B: Average fitted vol. surface



             60                                                               60

             50                                                               50
   Percent




                                                                    Percent
             40                                                               40

             30                                                               30

              20                                               1               20                                                 1
             0.8                                        0.75                  0.8                                          0.75
                   0.9                            0.5                                0.9                             0.5
                         1                                                                 1
                           1.1             0.25                                               1.1             0.25
                                                  Option                                                             Option
                    Moneyness    1.2   0          maturity                             Moneyness    1.2   0          maturity




             Panel C: Average actual “smile” surface                            Panel D: Average fitted “smile” surface



              5                                                                 5

              4                                                                 4
   Percent




                                                                    Percent




              3                                                                 3

              2                                                                 2

              1                                                                 1

               0                                               1                0                                                 1
             0.8                                        0.75                  0.8                                          0.75
                   0.9                            0.5                                0.9                             0.5
                         1                                                                 1
                           1.1             0.25                                               1.1             0.25
                                                  Option                                                             Option
                    Moneyness    1.2   0          maturity                             Moneyness    1.2   0          maturity


Figure 4: Average log-normal implied volatility and “smile” surfaces
Panel A and B show averages of the actual and fitted log-normal implied volatilities. Panel C and D show
averages of the actual and fitted log-normal implied volatility “smiles”. For a given option maturity the “smile”
is the difference between the implied volatilities across moneyness and the implied volatility of the ATM option.
Moneyness is defined as option strike divided by the price of the underlying futures contract.




                                                                   44
                      Panel A: S(t)                                          Panel B: x(t)
   80                                                      3

   70                                                      2

   60
                                                           1
   50
                                                           0
   40
                                                           -1
   30
                                                           -2
   20

   10                                                      -3

    0                                                      -4
    Jan90     Jan94      Jan98     Jan02   Jan06            Jan90    Jan94      Jan98    Jan02    Jan06




                      Panel C: φ(t)                                          Panel D: v(t)
  0.8                                                     20

  0.7

  0.6                                                     15

  0.5

  0.4                                                     10

  0.3

  0.2                                                      5

  0.1

    0                                                      0
    Jan90     Jan94      Jan98     Jan02   Jan06           Jan90     Jan94      Jan98    Jan02    Jan06



Figure 5: Time-series of Kalman-filtered state variables
The Kalman-filtered state variables when the model is estimated on the entire data set. The vertical dotted
lines mark the Iraqi invasion of Kuwait on August 2, 1990, the beginning of the US-led liberation of Kuwait
(“Operation Desert Storm”) on January 17, 1991, the September 11, 2001 terrorist attacks and the US-led
invasion of Iraq on March 20, 2003, respectively. Each time-series consists of 855 weekly observations from
January 3, 1990 to May 17, 2006.




                                                    45
             150

                           M1–M2
                           M2–M3
                           M3–M4
             100
                           M4–M5
                           M5–M6


              50
  Percent




               0




             -50




            -100
                   Jun02   Dec02   Jun03    Dec03      Jun04     Dec04      Jun05       Dec05   Jun06



Figure 6: Time series of the pricing errors for ATM calendar spread options
Time-series of pricing errors for ATM options on the M1–M2, M2–M3, M3–M4, M4–M5 and M5–M6 calendar
spreads. We display averages of ATM put and ATM call option pricing errors. The pricing errors are defined as
the differences between the fitted and actual prices divided by the actual prices. The calendar spread options
are priced out-sample from the model estimated on the main option data set using weekly data from June 6,
2002 to May 17, 2006. Each calendar spread option is priced by simulations using 50,000 paths, antithetic
variates and the corresponding zero-strike calendar spread option as control variate.




                                                      46
References

Amin, K., V. Ng, and S. C. Pirrong (1995): “Valuing energy derivatives,” in, Managing
    Energy Price Risk, Risk Publications, London.

Andersen, T. G. and L. Benzoni (2005): “Can bonds hedge volatility risk in the U.S.
    treasury market? A specification test for affine term structure models,” Working paper,
    Kellogg School of Management, Northwestern University.

Bakshi, G., C. Cao, and Z. Chen (1997): “Empirical performance of alternative option
    pricing models,” Journal of Finance, 52:2003–2049.

Barone-Adesi, G. and R. Whaley (1987): “Efficient analytic approximation of american
    option values,” Journal of Finance, 42:301–320.

Bates, D. S. (1996): “Jumps and stochastic volatility: Exchange rate processes implicit in
    Deutsche Mark options,” Review of Financial Studies, 9:69–107.

           (2000): “Post-’87 crash fears in the S&P 500 futures option market,” Journal of
    Econometrics, 94:181–238.

Bessembinder, H., J. F. Coughenour, P. J. Seguin, and M. M. Smoller (1995):
    “Mean-reversion in equilibrium asset prices: Evidence from the futures term structure,”
    Journal of Finance, 50:361–375.

Bikbov, R. and M. Chernov (2004): “Term structure and volatility: Lessons from the
    Eurodollar markets,” Working paper, Columbia University.

Black, F. (1976): “The pricing of commodity contracts,” Journal of Financial Economics,
    3:167–179.

Broadie, M., M. Chernov, and M. Johannes (2004): “Model specification and risk premi-
    ums: Evidence from futures options,” Working paper, Columbia University, forthcoming
    in Journal of Finance.

Casassus, J. and P. Collin-Dufresne (2005): “Stochastic convenience yield implied from
    commodity futures and interest rates,” Journal of Finance, 60:2283–2331.




                                            47
Casassus, J., P. Collin-Dufresne, and R. Goldstein (2005): “Unspanned stochastic
    volatility and fixed income derivatives pricing,” Journal of Banking and Finance, 29:2723–
    2749.

Cheredito, P., D. Filipovic, and R. Kimmel (2003): “Market price of risk specifica-
    tions for affine models: Theory and evidence,” Working paper, Princeton University,
    forthcoming in Journal of Financial Economics.

Clewlow, L. and C. Strickland (1999): “A multi-factor model for energy derivatives,”
    Working paper, University of Technology, Sydney.

Collin-Dufresne, P. and R. Goldstein (2002): “Do bonds span the fixed income mar-
    kets? Theory and evidence for unspanned stochastic volatility,” Journal of Finance,
    57:1685–1730.

            (2003): “Generalizing the affine framework to HJM and random field models,”
    Working paper, U.C. Berkeley.

Collin-Dufresne, P., R. Goldstein, and C. Jones (2003): “Identification and estima-
    tion of ’maximal’ affine term structure models: An application to stochastic volatility,”
    Working paper, U.C. Berkeley.

Cortazar, G. and E. S. Schwartz (1994):             “The valuation of commodity contingent
    claims,” Journal of Derivatives, pages 27–39.

Dai, Q. and K. Singleton (2000): “Specification analysis of affine term structure models,”
    Journal of Finance, 55:1943–1978.

de Jong, F. and P. Santa-Clara (1999): “The dynamics of the forward interest rate curve:
    A formulation with state variables,” Journal of Financial and Quantitative Analysis,
    34:131–157.

Duan, J.-C. and J.-G. Simonato (1999): “Estimating and testing eksponential-affine term
    structure models by Kalman filter,” Review of Quantitative Finance and Accounting,
    13:111–135.

Duffee, G. and R. Stanton (2004):          “Estimation of dynamic term structure models,”
    Working paper, U.C. Berkeley.


                                             48
Duffie, D. (2001): Dynamic Asset Pricing Theory, Princeton University Press.

Duffie, D., J. Pan, and K. Singleton (2000): “Transform analysis and asset pricing for
    affine jump-diffusions,” Econometrica, 68:1343–1376.

Eydeland, A. and H. Geman (1998): “Pricing power derivatives,” Risk, September.

Gibson, R. and E. S. Schwartz (1990): “Stochastic convenience yield and the pricing of
    oil contingent claims,” Journal of Finance, 45:959–976.

Hamilton, J. D. (1994): Time Series Analysis, Princeton University Press, Princeton, New
    Jersey.

Harvey, A. C. (1989): Forecasting, Structural Time Series Models and the Kalman Filter,
    Cambridge University Press.

Heath, D., R. Jarrow, and A. Morton (1992): “Bond pricing and the term structure
    of interest rates: A new methodology for contingent claims valuation,” Econometrica,
    60:77–105.

Heidari, M. and L. Wu (2003): “Are interest rate derivatives spanned by the term structure
    of interest rates?,” Journal of Fixed Income, 13:75–86.

Heston, S. (1993): “A closed form solution for options with stochastic volatility,” Review of
    Financial Studies, 6:327–343.

Hilliard, J. E. and J. Reis (1998): “Valuation of commodity futures and options under
    stochastic convenience yields, interest rates and jump diffusions in the spot,” Journal of
    Financial and Quantitative Analysis, 33:61–86.

Litzenberger, R. H. and N. Rabinowitz (1995): “Backwardation in oil futures markets:
    Theory and empirical evidence,” Journal of Finance, 50:1517–1545.

Lund, J. (1997): “Econometric analysis of continuous-time arbitrage-free models of the term
    structure of interest rates,” Working paper, Aarhus School of Business.

Miltersen, K. (2003): “Commodity price modelling that matches current observables: A
    new approach,” Quantitative Finance, 3:51–58.




                                             49
Miltersen, K. and E. S. Schwartz (1998): “Pricing of options on commodity futures with
    stochastic term structures of convenience yields and interest rates,” Journal of Financial
    and Quantitative Analysis, 33:33–59.

Nelson, C. and A. Siegel (1987): “Parsimonious modeling of yield curves.,” Journal of
    Business, 60:473–489.

Newey, W. and K. West (1987): “A simple, positive semi-definit, heteroscedasticity and
    autocorrelation consistent covariance matrix,” Econometrica, 55:703–708.

Nielsen, M. J. and E. S. Schwartz (2004): “Theory of Storage and the Pricing of Com-
    modity Claims,” Review of Derivatives Research, 7:5–24.

Richter, M. and C. Sørensen (2002): “Stochastic volatility and seasonality in commodity
    futures and options: The case of soybeans,” Working paper, Copenhagen Business School.

Schwartz, E. S. (1997): “The stochastic behavior of commodity prices: Implications for
    valuation and hedging,” Journal of Finance, 52:923–973.

Schwartz, E. S. and J. E. Smith (2000): “Short-term variations and long-term dynamics
    of commodity prices,” Management Science, 46:893–911.

Trolle, A. and E. Schwartz (2006): “A general stochastic volatility model for the pricing
    and forecasting of interest rate derivatives,” Working paper, UCLA and NBER # 12337.




                                             50
