                               NBER WORKING PAPER SERIES




      RATIONAL HEURISTICS? EXPECTATIONS AND BEHAVIORS IN EVOLVING
           ECONOMIES WITH HETEROGENEOUS INTERACTING AGENTS

                                         Giovanni Dosi
                                        Mauro Napoletano
                                        Andrea Roventini
                                        Joseph E. Stiglitz
                                         Tania Treibich

                                       Working Paper 26922
                               http://www.nber.org/papers/w26922


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     April 2020




The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

At least one co-author has disclosed a financial relationship of potential relevance for this
research. Further information is available online at http://www.nber.org/papers/w26922.ack

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2020 by Giovanni Dosi, Mauro Napoletano, Andrea Roventini, Joseph E. Stiglitz, and Tania
Treibich. All rights reserved. Short sections of text, not to exceed two paragraphs, may be quoted
without explicit permission provided that full credit, including © notice, is given to the source.
Rational Heuristics? Expectations and Behaviors in Evolving Economies with Heterogeneous
Interacting Agents
Giovanni Dosi, Mauro Napoletano, Andrea Roventini, Joseph E. Stiglitz, and Tania Treibich
NBER Working Paper No. 26922
April 2020
JEL No. C63,D8,E32,E6,O4

                                         ABSTRACT

We analyze the individual and macroeconomic impacts of heterogeneous expectations and action
rules within an agent-based model populated by heterogeneous, interacting firms. Agents have to
cope with a complex evolving economy characterized by deep uncertainty resulting from
technical change, imperfect information, coordination hurdles and structural breaks. In these
circumstances, we find that neither individual nor macroeconomic dynamics improve when
agents replace myopic expectations with less naïve learning rules. Our results suggest that fast
and frugal robust heuristics may not be a second-best option but rather "rational" responses in
complex and changing macroeconomic environments.

Giovanni Dosi                                  Joseph E. Stiglitz
EmbeDS and Institute of Economics              Uris Hall, Columbia University
Scuola Superiore Sant'Anna                     3022 Broadway, Room 212
Piazza Martiri della Liberta', 33              New York, NY 10027
56127 Pisa, Italy                              and NBER
gdosi@santannapisa.it                          jes322@columbia.edu

Mauro Napoletano                               Tania Treibich
OFCE Sciences Po                               Maastricht University
60, rue Dostoïevski BP 85                      Tongersestraat 53
06902 Sophia Antipolis                         6211LM Maastricht
France                                         the Netherlands
and SKEMA Business School,                     and OFCE Sciences Po and
Université Côte d'Azur                         Institute of Economics,
and also Institute of Economics,               Scuola Superiore Sant'Anna
Scuola Superiore Sant'Anna                     t.treibich@maastrichtuniversity.nl
mauro.napoletano@sciencespo.fr

Andrea Roventini
EmbeDS and Institute of Economics
Scuola Superiore Sant'Anna
Piazza Martiri della Liberta', 33
56127 Pisa, Italy
and OFCE, Sciences Po,
Sophia-Antipolis, France
andrea.roventini@santannapisa.it
           1 Introduction

           In this work we study the impact of heterogeneous expectations and action rules on
individual performance and macroeconomic dynamics by means of an agent-based model populated
by heterogeneous, interacting firms. In the model we explore, agents have to cope with an
environment characterized by deep uncertainty resulting from technical change, imperfect
information coordination problems, and, as a result, endogenous structural breaks.
           Expectations have long been central in macroeconomics, from the seminal distinction be-
tween risk and uncertainty suggested by Knight (1921), to the description of "animal spirits" playing
an important role in generating multiple equilibria and coordination failures in Keynes (1936, 1937),
all the way to the rational expectations hypothesis (Muth, 1961; Lucas and Prescott, 1971). Note,
however, that before the "rational expectations (RE) revolution", there were many different views
about the nature of expectations themselves, their origin and their accuracy. 1 Only with the RE
assumption has (a significant part of) the profession taken expectations to be uniform among agents
(take or leave some noise) and on average "true". 2 Correspondingly, the "action" has been assumed
to be "right", that is the one maximizing some objective, conditional on the true expectation on the
future (with those expectations themselves conditional on all the information available). Still, the
claims on expectation or action are supported neither by empirical evidence (see e.g. Carroll, 2003;
Coibion and Gorodnichenko, 2012, 2015; Gennaioli et al., 2016) nor by experimental studies (see
e.g. Tversky and Kahneman, 1974; Schweitzer and Cachon, 2000; Kahneman, 2003; Anufriev and
Hommes, 2012). Indeed, it is not even clear what "rational" expectations means, even in principle,
in the presence of Knightian uncertainty, when there are radical changes in policies (Stiglitz, 2011,
2015) and/or structural breaks in the underlying distributions on which agents form their forecasts
(Hendry and Mizon, 2010).3
           Tentative ways forward have entailed exploring macroeconomic models with learning
(Evans and Honkapohja, 2001) and a somewhat parsimonious use of bounded rationality.4 However,
both routes continue to take Olympic rationality either as something to be achieved, possibly through
learning, or at the very least as the benchmark against which actual expectations ought to be assessed
out of the "wilderness of bounded rationality" (Sims, 1980). The "behavioral" approach does


1 Indeed, there was considerable exploration of the consequences of different ways of forming expectations (e.g. in cobweb cycles). Knight
himself was skeptical of the accuracy of expectations, even on average. Discussions of subjective probabilities made it clear that in many
of the critical instances in which expectations were being formed there was no way of even assessing the accuracy of expectations.
2 There is a large literature on the (restrictive) conditions that have to be satisfied in order for this assumption of common knowledge to

be plausible. Yet the RE literature typically ignores this issue partially because much of the literature is framed in the context of a
representative agent. Even as more recent advances have tried to break out of the representative agent assumption, they have typically not
departed from the assumption of common knowledge, which becomes less plausible in the presence of significant heterogeneity.
3 The large differences in expectations even among experts in say expectations about inflation, growth, or employment are hard to reconcile

with the assumption of common knowledge. For an assessment of risk vs. some form of uncertainty in an econometric perspective , see
also Rossi et al. (2016).
4
   Since the Great Recession, an increasing number of bounded-rationality DSGE models have appeared. See Dilaver et al. (2018) and
Fagiolo and Roventini (2016) for surveys from different theoretical perspectives.
                                                                                                                                         2
introduce meaningful restrictions, but still invokes cognitive limitations and insufficient computing
power and time as giving rise to expectations and actions which are to be assessed against the
yardstick of "full rationality". "Rationality" is typically then invoked as explaining the extent of the
limitations in information: observed behaviors result from a "rational" balancing of the trade-off
between the marginal benefits of an improvement in accuracy and the marginal costs of greater
accuracy, e.g the greater effort it entails (a general discussion is in Kahneman, 2003).5
           Here, we explore an alternative route grounded in the seminal contributions of Simon (1955),
March and Simon (1993) and Cyert and March (1992). First, in complex evolving environments,
expectations and behaviors cannot be neatly distinguished, 6 and, second, behavioral patterns are
adequately accounted for by heuristics, which under Knightian uncertainty and non-stationarity of
the fundamentals of the economy, may well be not only "reasonable" on prima facie grounds, but
also may be rational in a particular sense to be explored below--entailing the use of the term
"rational" that is markedly different from that invoked in "rational expectations". When individuals
all use these heuristics, the accuracy of their predictions and their welfare may both be higher than if
they had followed seemingly more sophisticated rules. A heuristic is "a strategy that ignores part of
the information, with the goal of making decisions more quickly, frugally and/or accurately than
more complex methods" (Gigerenzer and Gaissmaier, 2011, p. 454). The heuristics we explore below
exhibit the so-called "less-is-more" effect, which emerges as a response to the "bias-variance
dilemma" ­ basically the possible trade-off between the accuracy in the interpolation of past
observations and the accuracy of the prediction ­ also well known in machine-learning and statistical
inference (see e.g. Geman et al., 1992; Alpaydin, 2004; Hastie et al., 2001). Note that heuristics are
not "biases" based on "fast thinking" yielding suboptimal behaviors (as one would gather from
Kahneman, 2003 and from a good deal of behavioral economics), but in changing worlds
characterized by substantive and procedural uncertainty (i.e. in all interesting crises, like the financial
crisis of 2008 and the Coronavirus crisis of 2020) might well be robust strategies that result in
performance that is better than that in standards models employing purported "rational" choices (Dosi
and Egidi, 1991). One of the reasons for this seemingly anomalous result is that how expectations
are formed affects how the system performs; more "rational" expectations may lead to poorer system
performance, where the difficulties of forecasting increase, in some sense, faster than the
sophistication of the forecasting methodology.7 (Our results have one further implication, reflecting
the well-known effect that outside the extreme assumptions of the Arrow-Debreu model, what is

5 Even if individuals were to have sufficient information on the basis of which to make such a decision "rationally", the question would
arise how do they make a decision about the allocation of effort to obtain the information necessary to make that decision. Somewhere in
this infinite regression, the assumption of rationality has to break down. Incidentally, notice that the accuracy-effort trade-off is also present
in recent rational- expectations models with information frictions, see e.g. Mankiw and Reis (2002), Woodford (2003), and Sims (2003).
6 This was, of course, also true in standard subjective utility when we drop the independence axiom. It is only with that axiom that we can

infer beliefs, represented by subjective probabilities (Savage, 1972). There is a large literature explaining the deficiencies in the
independence axiom and extending the expected utility framework (see e.g. Machina, 1982).
7 This is an example of the macroeconomic externalities that have increasingly become the source of attention in macroeconomics and

help explain macroeconomic dysfunction. These are the macroeconomic manifestations of the pervasive microeconomic (pecuniary)
externalities that virtually always arise in the presence of imperfect information and incomplete risk markets. See Davila and Korinek
(2017), Jeanne and Korinek (2018), and Korinek (2018).
                                                                                                                                                3
individually rational may not be systemically rational: given that all other agents use naïve
expectations formation processes, it may pay a single agent to employ a more sophisticated
expectations process. But when all do so, system performance decreases. In this sense, it may be
lucky that (most) agents are not as "rational" as standard economics assumes; or it may be a result
of "collective learning."8
           We study individual and aggregate performances under different rules of expectation for-
mation and behavior in an agent-based framework. Agent-based models (ABM) represent the
economy as a complex, evolving system populated by heterogeneous, interacting agents (Tesfatsion
and Judd, 2006; LeBaron and Tesfatsion, 2008; Farmer and Foley, 2009; Kirman, 2010; Dosi, 2012).9
           To study particularly the effects of different rules concerning expectation formation in a
concrete general equilibrium dynamic model, we extend the Keynes + Schumpeter (K+S) model
(Dosi et al., 2010, 2013, 2015, 2016, 2017), the structure of which is particularly well suited for
accounting for heterogeneous expectation rules and adaptive learning because of the "deep
uncertainty" which is embedded in it. It is designed so that agents cannot easily learn from observing
outcomes about the underlying structure, and especially so because outcomes are a function of
actions which themselves are based on beliefs about the economy, which are heterogeneous and
evolving. The K+S model is a bridge between Keynesian theories of demand generation and
Schumpeterian theories of innovation and economic growth, with "Minskian" financial dynamics
(Greenwald and Stiglitz, 1993).                     It represents an economy characterized by endogenous and
persistent novelty, imperfect information, where Knightian uncertainty is pervasive and coordination
failures are the norm. As imperfect information is ubiquitous, the economy is never in a (constrained)
Pareto equilibrium (Greenwald and Stiglitz, 1986) and agents' current behaviors are conditioned by
(beliefs concerning) future constraints (Neary and Stiglitz, 1983). In turn, large endogenous
innovation and imperfect coordination on the demand side entail non-linearities, positive feedbacks
and, most importantly, structural breaks in the dynamics of the system. The microeconomic
foundations of the model are genuinely "behavioral" (Akerlof, 2002): heterogeneous firms and banks
behave in tune with what we know from micro-empirical evidence, and they interact without
resorting to any ex-ante commitment to the reciprocal consistency of their actions, thus implicitly
addressing the call by Solow (2008) for genuine micro-heterogeneity.
           Naturally, the very nature of the K+S model makes simply implausible a rational-expectation
equilibrium, one on which fictitious representative agents could coordinate, or even more
importantly, a dynamics which could give rise to and be generated and supported by common
knowledge. Still, we can compare the impact of heterogeneous, more or less "sophisticated",

8  That is, typically, when one agent decides to try a more sophisticated expectation formation process, others do so as well ­ ideas quickly
spread. Individuals do not fully understand the complex structure of the economy; they simply observe results; and what they observe is
that as many try these more sophisticated expectations process, performance doesn't increase. The lesson they learn from this "experiment"
is to revert to more naïve processes.
9 The literature on agent-based macroeconomics has been blossoming in the recent years, see e.g. Fagiolo and Roventini (2012, 2016) or

Dawid and Delli Gatti (2018) for recent surveys. See also Sinitskaya and Tesfatsion (2015) and Salle (2015) for two investigations of
non-RE rules in agent-based frameworks.
                                                                                                                                           4
expectations and learning rules on heterogeneous agents' performance, as well as on macroeconomic
dynamics. In addition, we evaluate the robustness of our results to alternative heuristic-based rules.
The K+S model is, of course, a highly simplified model, and not everyone may agree that it provides
a good description of the economy. But that's not the point. Rather, the point is to explore how, even
in a very simplified context, different behavioral hypotheses about expectations interact with system
dynamics, and to assess whether, in this plausible set-up, seemingly more sophisticated behaviors
lead to better performance and more accurate forecasts. If they don't in this highly idealized world,
there is little reason to believe that they would in the much more complex real world.
           We begin by introducing in the K+S model five simple expectation rules (based on the
experimental findings of Anufriev and Hommes, 2012), allowing firms to switch among them
according to their past forecasting performance (Brock and Hommes, 1997). In such a framework,
expectations are heterogeneous and evolve over time. We then allow agents to learn by employing
more "sophisticated" expectations grounded on recursive least squares (RLS, see e.g. Evans and
Honkapohja, 2001), and compare the individual and system-level performances.
           Simulation results show that in line with the K+S tradition, the model with simple ex-
pectation formation processes can account for endogenous growth and business cycles, where mild
fluctuations are punctuated by deep downturns (Fagiolo et al., 2008), as well as for a wide ensemble
of macro and micro empirical regularities (Dosi et al., 2017). Moreover, we find that compared to
simple (benchmark) myopic expectations, somewhat more complex heuristics increase the forecast
errors of the agents and do not substantially improve the performance of the system (see also Dosi et
al., 2006).
           More significant, both individual and aggregate performances, both in the short run and the
long, considerably deteriorate when firms abandon "fast and frugal" heuristics and start estimating
their future demand via recursive least squares. The volatility of business cycles and the average
value of the unemployment rate increase, while the growth potential of the economic system is
reduced, as innovation is curbed. These results are explained by the fact that the forecast errors of
RLS agents are amplified by the positive feedbacks induced by income and other constraints
(including financial constraints) . Moreover, we find that whenever agents are allowed to choose
between RLS- learning and simple invariant rules, they "rationally" adopt the latter. And the more
frequent are structural breaks, the more pronounced is this property.10
           Our results support the ecological rationality of heuristics: in complex, evolving economies
characterized by pervasive uncertainty and perpetual structural change, heuristics may provide a

10 We do not perform a "horserace" among the appropriately calibrated different specifications, for a number of reasons. First, we are not
convinced of the usefulness of such an exercise in models which are so under-identified. Second, and related to the observation made
earlier, better fits in the sample period may systematically be related to worse predictions. Third and last, we do not believe that the
standard metrics used ("goodness of fit") fully ref lect what is important. We do not care about how well a model does on average, but how
well it does at critical times, e.g. a slight increase in accuracy in normal times is of little value compared to a better prediction of turning
points and economic performance in extreme events. Rather, we focus on the question of whether, given a hypothesized structure of the
economy, increasing the sophistication of the expectations formation process leads, systemically, to increased accuracy in predictions. (In
assessing accuracy of predictions, we use standard metrics, in order to demonstrate that even using these imperfect metrics increased
sophistication in forecasting does not systemically pay off.)
                                                                                                                                              5
more accurate and robust tool for inference and action than more sophisticated forecasting
techniques; changing expectation formation processes changes the system dynamics; more so-
phisticated heuristics may result in systemically less accurate forecasts (Todd and Gigerenzer, 2012;
Luan et al., 2019). Of course the agents with an infinite amount of data and highly sophisticated
learning techniques might possibly do better. However, even if the system might be in principle
"discoverable" by the agents, the complexity of the system itself increases with the complexity of
the individual learning techniques. Heterogeneity among agents in what information they receive and
in their learning processes further complicates the ability of each to learn about the underlying
structure of the economy. Moreover, notice that the aggregate volatility observed in the model is an
essential feature of high-dimensional decentralized economies painstakingly coordinating at varying
levels of activity, and with large, endogenous technology shocks, the occurrence of which may
generate complex system dynamics. In short, the theory of the second best applies here as it does
elsewhere in economics: a seeming improvement in forecasting techniques does not lead to better
forecasts.
        The rest of the paper is organized as follows. In Section 2, we discuss the impact of expecta-
tions and agents' interactions on macroeconomic dynamics. In Section 3, we describe the K+S model.
We then empirically validate it in Section 4. The impact of heterogeneous expectation rules is studied
in Section 5, while learning is introduced in Section 6 and is further investigated in Section 7. Section
8 discusses in general the properties of heuristic-driven decisions. Finally, our concluding remarks
are in Section 9.


        2 Expectations, interactions and macroeconomic dynamics: the
general problem
        In the most general terms, the dynamics of any economy can be seen as an enormously high-
dimensional system of difference equations. They describe the "laws of motion" of the system itself
and of its multiple constituent agents, driven by the behavioral (and, relatedly, expectational)
adjustments of the agents themselves, their interactions, and some (endogenous or exogenous)
shocks. In such a "meta-model", agents' individual outcomes depend on i) their expectations based
on both their individual and the aggregate histories (which determines what they "know" from the
past), ii) their individual histories and the value of their current state variables, iii) the aggregate
history, and iv) the individual and aggregate shocks:


                    () = ([((
                              - 1), ... , ( - ); ( - 1), ... , ( - )] ;                               (1)
                                             Individual expectations

                    ( - 1), ... , ( - ) ; 
                                          ( - 1), ... , ( - ) ; (), () ; ),
                      Individual histories     Aggregate history       Shocks




                                                                                                       6
where () = [1 (), ... ,  ()] is a matrix comprising the state variables for all heterogeneous  =
1, ... ,  agents populating the economy (e.g. individual firm's capital stock, net worth, sales11, prices,
etc.), () is the vector of macroeconomic variables (e.g. GDP, total investment, unemployment
                                     
rate, etc.);12 () = [1 (), ... ,  ()] is a vector of individual expectation functions which map the

individual and system-level histories into forecasts and actions by the agents; and finally () =
[1 (), ... ,  ()] is the vector of idiosyncratic shocks hitting agents (e.g. their productivity or their
demands), while () are system-wide shocks (affecting e.g. the technological frontier of the
economy).  maps past history and current (exogenous) shocks into this period's state variables.
           Macroeconomic outcomes are determined simultaneously by individual and aggregate prior
histories and state variables, and by the result of the behavioral interaction of agents, given the shocks
experienced by the economy. There is a feedback loop from the macroeconomic aggregates to agents'
forecasts and decisions. In such a framework, it makes sense that agents form their expectations
based on the observation of the past, i.e. they are extrapolative, adaptive agents.13
           Clearly, for each individual to come to a full understanding of this dynamical system is an
extraordinarily difficult task ­ especially because the behavior of the system may be very sensitive
to how each individual forms his expectations. Even neglecting the possibility of changing
fundamentals of the economy (due to e.g. technological change), interactions generically entail
endemic externalities and non-linearities. And with that come unimaginably high informational
demands on the part of decision-makers.


             Rational expectations: avoiding the central issues
Facing all this, the prevailing response of macroeconomic theory has been to eliminate complexity
at its roots by:
      a)        eradicating interaction altogether and assuming a representative agent. (Some go
                slightly beyond this by exploring very limited forms of heterogeneity.) The fallacies of
                such a reduction have been shown in Kirman (1992, 2014) at the level of theory, and by
                Forni and Lippi (1997, 1999) at the level of econometric aggregation.
      b)        eliminating the possibility of "deep uncertainty", e.g. structural breaks arising from
                episodic innovations.14


11  In the specific model formulated here, with prices adjusting slowly, sales are a state variable. In other specifications, sales could be an
endogenous variable.
12 As the discussion below will clarify, in our model, aggregate variables are themselves the outcome of individual state variab les and

behaviors: () = (()). In most cases, these macroeconomic variables are just aggregates of the corresponding agent-level variables.
13 Rational expectations models are, in a sense extrapolative: the agent makes inferences about the future from the past. But he is assumed

to know fully the structure of the economy. He can therefore make perfect inferences about future probability distributions o f all the
relevant variables given the observed past history. Most of the models are Markovian, and the distribution of the relevant driving exogenous
shocks are assumed stationary, so that having enough information about the relevant state variables is all that is required.
14 The models might have made sense when the only source of variability was weather, and climate was not varying. By the same token,

it is not possible to embrace the possibility of climate change, with its deep uncertainty (Weitzman, 2009), within a rational expectations
model: it should be obvious that there are widely varying expectations among different groups of individuals about the future of the global
climatic system with profound implications for uncertainty about the future course of the economy. With increasing evidence of the
importance of climate change but continued uncertainty about the pace and magnitude of the changes rational expectations models seem
increasingly out of touch with current realities.
                                                                                                                                             7
Now, assuming a representative-agent economy, leaving aside all the objections, greatly simplifies
the analysis. In particular, one does not have to cope with the problem of aggregation, implying that
macroeconomics shrinks to microeconomics and we have a much lower dimensional system of the
form:
                            () = ([( - 1), ... , ( - )]; ( - 1), ... , ( - ); ()).                                                 (2)


 where the aggregate state variables only depend on the aggregate expectation, the aggregate history
and the aggregate shocks. This is akin to the basic sketch of e.g. Evans and Honkapohja (1999),
where the reduced-form model is a vector of endogenous variables (), depending on their lagged
values, on expectations of next period's values, [], and on a vector of exogenous shocks .
           The "rational expectation (RE) revolution" further suggests that actual expectations 15
correspond to the "true" statistical conditional expectations. The forward-looking representative
agent -- like the macroeconomic theorists -- know the "true" model of the economy, and hence
[( - 1), ... , ( - )] = [( + 1)] so the system further simplifies to:


                                     () = ([( + 1)]; ( - 1), ... , ( - ); ()).                                                     (3)


           However, even in this reductionist framework, there can be multiple stationary RE equilibria:
self-fulfilling expectations can affect the optimal choice of the representative agent and sunspot
equilibria can arise (among a vast literature, see the seminal contribution of Woodford, 1990 and the
survey in Benhabib and Farmer, 1999).16
           Given such a multiplicity of RE equilibria, the natural question is then "where do these
expectations come from"? In the case of a unique equilibrium, agents, believing that the world is in
a rational expectations equilibrium, and believing that others believe similarly, and act accordingly,
could ascertain the actions which maximize their expected utility. But when there is more than one
possible equilibrium, how are they to know what others will do? They ought plausibly learn what
others are doing. Yet the literature presents mixed results, with the most general analyses giving rise
to skepticism concerning the generality of results on convergence. In a nutshell, "it is not rational to
have rational expectations" (Kirman, 2016, p. 8).17
           Equally important, whether under plausible general conditions economies converge to a
Rational Expectations equilibrium or whether a rational expectations model can be calibrated with
plausible values of the relevant parameters consistent with microeconomic evidence to generate
observed macroeconomic behavior, there is considerable direct evidence against the RE hypothesis;



15 Behavior may depend on more than the expected value of a distribution, but on its entire shape. RE equilibria require that in such a
situation, the individuals' beliefs about the shape of the distribution coincide with the observed (conditional) relative frequencies.
16 Matters are even worse: Hirano and Stiglitz (2019) have shown that there may be an infinity of rational expectations trajectories.
17 Within a wide literature, see Bray (1982); Bray and Kreps (1987); Marcet and Sargent (1989) and the discussions in Evans and

Honkapohja (1999, 2001).
                                                                                                                                     8
it simply goes against (the little) we know about actual expectation formation by actual economic
agents. For instance, using the survey of professional forecasters, Coibion and Gorodnichenko (2012,
2015) reject the RE hypothesis. Similarly, employing survey data on the investment plans of the chief
financial officers of large U.S. corporations, Gennaioli et al. (2016) find evidence against the RE
benchmark, while supporting extrapolative expectations. Other researchers have identified
systematic differences between expectations of different groups (e.g. men and women forecasters),
casting doubt on the hypothesis of common knowledge (Guzm´an, 2012). Finally, the recent
evidence stemming from laboratory experiments show robust and persistent deviations from RE (see
Assenza et al., 2014, for a review).
           In the following, we explore a different route. The system dynamics of our model maintains
the complexity of the evolving systems as sketched in the "meta-model" of eq. 1. Modeling a system
similar to eq. 1 fully acknowledges the deep macroeconomic externalities associated with
heterogeneous beliefs which in turn influence the state variables of the system: it includes what Soros
has called reflexivity (Soros, 2013). At the same time, we explore the conjecture that the orderly
system-level properties that are exhibited are an emergent collective property of relatively simple,
inertial behaviors whereby agents learn how to repeatedly swim in a Heraclitus' river in which one
is literally unable to ever step in twice ­ and not the outcome of highly sophisticated individuals with
anything approaching rational expectations.18


           3 The expectation-enhanced K+S model

           This work extends the Keynes+Schumpeter (K+S) family of models that have already been
extensively explored (Dosi et al., 2010, 2013, 2015, 2016, 2017) by introducing different expec-
tation formation rules. The barebone structure of the model is portrayed in Figure 1.
           The economy is composed of 1 capital-good firms (labeled with index  ), 2
consumption-good firms (denoted by the index  ),  consumers/workers,  commercial banks
(denoted by the index  ), a Central Bank and the Government sector. The presence of a capital-good
sector and a consumption-good industry19 introduce an important source of coordination failures.20



18 Recall the infinite regress involved into any process of rational expectation formation: how do we decide about how much information
to gather for the decision about how much information to gather... Our work has some (superficial) point of contact with an increasing
stream of research which introduces information frictions in rational expectation models. For instance, Mankiw and Reis (2002) assume
that the information available to agents are sticky and agents update them infrequently, while Sims (2003) and Woodford (2003 ) build
noisy- information models, where agents continuously update their beliefs facing a signal extraction problem. However, differently from
us, such works assume a fully rational agent (with bounds on their information or information processing capacities) and do n ot account
for the "deep" Knightian uncertainty and possible coordinati on failures occurring in the presence of multiple heterogeneous interacting
agents. In those models, agents rationally understand the limits of their computational capacities, and heuristics are ration al solutions
responding to the constraints, like well-designed algorithms. All modeling involves trade-offs, in which sophistication in one direction
precludes the ability to introduce complexity in others. Focusing on the optimization problem for well-designed heuristics necessitates
simplification of the model in other dimensions.
19 This model structure is nowadays widely adopted in the endogenous growth literature: see e.g. Acemoglu and Guerrieri (2008);

Acemoglu et al. (2012).
20 In particular, as savings in this model are equal to firm profits, a decision to save does not automatically map into a corresponding

decision to invest and this gives rise to a potential deficiency in aggregate demand.
                                                                                                                                        9
         Capital-good firms invest in R&D to increase the productivity of their heterogeneous
machine-tools (with product innovation/imitation) and their own production techniques (with process
innovation/imitation). Consumption-good firms combine machines bought from capital-good firms
and labor in order to produce a homogeneous product for consumers. The banks provide credit to
consumption-good firms and buy Government bonds. The public sector levies taxes on firms' and
banks' profits, pays unemployment benefits and bails banks out in case of banking crises. The
Government can run deficits by issuing bonds, which are bought by the banking sector. Finally, the
Central Bank fixes the baseline interest rate in the economy and the macroprudential regulatory
framework.
         Let us now sketch the main characteristics and dynamics of the expectation-enhanced K+S
model. A detailed description of the model is provided in Dosi et al. (2015).




                         Figure 1. The structure of the Keynes+Schumpeter model.




         3.1 The timeline of events


         In any given time period (), the following microeconomic decisions take place in sequential
order:
             1. Policy variables (e.g. banks' capital requirement, tax rate, Central Bank interest
rate, etc.) are fixed.
             2. Banks determine the potential supply of credit.
             3. Capital-good firms perform R&D, trying to discover new products and more
efficient production techniques and to imitate their competitors.

                                                                                                     10
             4. Consumption-good firms decide how much to produce and invest according to
different expectation rules. They apply for bank credit (and may be rationed) if their internal funds
are not enough.
             5. The capital-good market opens. Given the presence of imperfect information,
capital-good firms advertise their products to an evolving subset of consumption-good firms, which
in turn choose their supplier.
             6. Firms in both industries hire workers according to their production plans and start
producing.
             7. The imperfectly competitive consumption-good market opens. Pervasive imperfect
information implies that the market shares of firms evolve according to their price competitiveness.
             8. The firms in both sectors compute their profits and pay back their bank loans.
             9. Entry and exit take place. In both sectors, firms with near zero market shares or
negative net liquid assets exit and are replaced by new ones.
             10. Banks compute their profits and net worth. If the latter is negative they fail and
are bailed out by the Government.
             11. The Government computes its surplus or deficit, the latter being financed by
sovereign debt which is bought by banks.
             12. Machines ordered at the beginning of the period are delivered and become part of
the capital stock of consumption-good firms at time  + 1.


        At the end of each time step, aggregate variables (e.g. GDP, total investment,
unemployment) are computed, summing over the corresponding microeconomic variables. As in its
direct ancestor (Dosi et al., 2015), the model is stock-flow consistent.


        3.2 The capital- and consumption-good sectors


        In both capital- and consumption good markets, information is imperfect and firms' prices
are heterogeneous. As a consequence, the economy is never constrained Pareto efficient (Greenwald
and Stiglitz, 1986, 1988) and the current behavior of firms is conditioned by various constraints. The
capital-good industry is the locus of endogenous machine-embodied innovation. The current
technology mastered by a capital-good firm is defined by  , the labor productivity of the machine
it sells to the downstream sector, and by  , the efficiency of its production technique. Capital-good
firms develop new technologies or imitate their competitors in order to produce and sell more
productive and cheaper machines that are in turn supplied to consumption-good firms. Capital-good
firms invest  , a fraction of their past sales in R&D in order to discover new machines or copy
existing ones. The innovation process has two steps: first a random draw from a Bernoulli distribution
with parameter  () = 1 -  -1 () determines whether firm  innovates or not. Therefore the
                                                                                                      11
frequency of innovations (whether successful or not) depends on 1  1 , the firms' search
capabilities, and the specific amount of R&D they have invested. If an innovation occurs, the firm
obtains a new technology, whose labor productivity levels are given by               
                                                                        () =  ()(1 +  ())

and  () =  ()(1 + 
                   ()), where  and 
                                    are two independent draws from a Beta(1 , 1 )
distribution.21 Therefore 1 and 1 define the extent of technological opportunities available to
firms, i.e. the magnitude of the innovation leaps. Capital-good firms employ only labor and set prices
with a fixed mark-up over unit costs of production.
           In the consumption-good industry, firms produce a homogeneous consumption good using
capital (composed of different vintages of machines) and labor under constant returns to scale
                                                    
employing a Leontief technology. Desired production  is based on expected demand and desired
increases in inventories ( ). Demand expectations ( ) (given prices) are adaptive and given by:


                                       () = ( ( - 1),  ( - 2),  ( - 1), ( - 1)),                                                           (4)


where  is firm's demand and  is the gross domestic product. Note that well in tune with the
evidence on organizational behavior, quantities and prices are not set simultaneously, but are subject
to different heuristics of adjustment. Morever, in our formulation here, as in some other areas of
macroeconomics, they are assumed to adjust slowly and at discrete time, (later, we shall describe the
dynamics of price adjustment). The detailed characterization of firms' expectation formation and
dynamics is discussed below (cf. section 3.3).
           The desired increase in inventories in turn is just the difference between the desired level of
inventories (  ) and the inherited stock:


                                                          () =  () -  ( - 1),


with  () =  (), the parameter   [0; 1] identical for all firms, and the desired level is simply
a fraction of expected demand.
           We can now define desired production by:


                                                            
                                                             () =  () +  ().                                                               (5)


           Given the actual stock of inventories, if the capital stock constrains the production plans of
the firm, it invests in new machines in order to expand its production capacity. 22 Thus firms'

                            
21 The draws  () and  () may well be negative (i.e. the innovation fails) in that case the firm continues to offer the "old" machine.
22 More specifically, firms invest if the desired capital stock is higher than the current one (more details in Dosi et al., 201 5). The results
of the models do not substantially change if firms cope with uncertain future demand by investing only if the difference between desired
and actual capital stock is above a given precautionary threshold (in line with Dosi et al., 2006).
                                                                                                                                            12
investment choices are affected by their demand expectations. 23 Moreover, firms also invest to
acquire state-of-the-art technologies: they replace old and obsolete machines with new ones when it
is profitable to do so.24
           The capital-good market is characterized by imperfect information and "Schumpeterian"
competition (Nelson and Winter, 1982). Upstream firms signal the price and productivity of their
machines to their current customers as well as to a set of potential new ones. Consumption-good
firms choose their supplier comparing the price and the production costs entailed by the subset of
machines they are aware of. Capital-good firms produce on demand according to the orders received
from their customers.
           As we mentioned above, demand expectations play a key role in determining the desired
production and investment plans of the firms. At the same time, their actual levels of production and
inventory accumulation may differ from the desired ones, as firms can face constraints in the
availability of external financing.25 More precisely, in the model, consumption-good firms have to
advance worker wages as well as pay for the machines they have ordered. Thus they may need
external financing. Because capital markets are imperfect (e.g. Stiglitz and Weiss, 1981; Greenwald
and Stiglitz, 1993; Hubbard, 1998), internal and external sources of finance are imperfect substitutes.
To fund their production and investment plans, firms first use their stock of liquid assets, and then
they ask credit from banks. Firms pay an interest rate on their loans, which depends on the Central
Bank interest rate (), as well as on their credit rating (more on that in Dosi et al., 2015). However,
if banks are unwilling to provide loans, firms can end up being credit constrained. In that case, they
first cut their investment and then downscale their production plans. Imperfect capital markets and
the possibility of credit rationing represent a first important constraint in our model, one of the
important ways that our model differs from those where substitution effects drive the dynamics.
           Imperfect information is pervasive also in the consumption-good market (see Rotemberg,
2008, for a survey on consumers' imperfect price knowledge). As a consequence, consumers do not
(and in fact, cannot) instantaneously switch to the most competitive producer, and this is true even if
the good is homogenous. Consumption-good firms fix their prices applying a variable idiosyncratic
mark-up on their production costs, i.e. there is a variable idiosyncratic ratio between the nominal
wage and the average labor productivity resulting from the machines employed in the production
process. 26 Mark-up dynamics are driven by the evolution of firms' market shares (in line with


23  It is important to emphasize that individual agents form expectations on the state variables which are going to affect their performance
(e.g. their demand), and building on such expectations, they determine their control variables, e.g. planned production and investments, in
a genuine "Keynesian" perspective. Conversely, they do not care about system-level variables which might have the utmost importance
for the modeler, but exert only a very indirect influence on individual agents (e.g. economy-wide levels of productivity). The two types of
forecasts, unfortunately, get confounded when one assumes the representative agent, who is also the Central Planner, who is a lso the
modeler.
24 In line with a widespread business practice, firms scrap machines according to a payback period heuristics (more details in Dosi et al.,

2015). Notice that in an equilibrium where the agent could correctly anticipate future profits, the payback rule and the inte rnal rate of
return maximization criteria would yield identical outcomes (Terborgh, 1949).
25 At the same time, it should be clear that say shortfalls in inventory accumulation in one period will be made up for in subsequent

periods, provided that the desired level of inventories remains high.
26 In this model, labor is the only variable cost.

                                                                                                                                        13
"customer market" models originally described by Phelps and Winter, 1970 and more recently
explored in Greenwald and Stiglitz, 2003): firms increase their margins whenever their market share
(f_j) is expanding:
                                                                       ,-1-,-2
                                          , = ,-1 (1 +                     ,-2
                                                                                       ),                (6)

 with 0    1.
           In turn, market shares evolve in a natural way, with more "competitive" firms expanding
while firms with a relatively lower competitiveness level shrinking, where the competitiveness of
consumption-good firms depends on the price they charge as well as in their ability to satisfy
consumer demand captured by the level of unfilled orders (more details are spelled out in the
Appendix, eq. 19).27
           At the end of every period, capital- and consumption-good firms compute their profits, pay
taxes, and update their stock of liquid assets. If the latter is positive, they increase their bank
deposits (consumption-good firms repay their debt first). If a firm's stock of liquid assets is
negative or if its market share shrinks to zero, then the firm goes bankrupt and exits the market.28
As we assume that the number of firms is fixed over time, each dead firm is replaced by a new
entrant. In line with the empirical literature on firm entry (Caves, 1998), we assume that entrants
are on average smaller than incumbents, with the stock of capital of new consumption-good firms
and the stock of liquid assets of entrants in both sectors being a fraction of the average stocks of the
incumbents. To be precise, in our simulated model, each entrant draws a random value between 0.1
and 0.9 which then multiplies the average capital and liquid assets of incumbents in the previous
period.
           Note that in the spirit of ABMs, the agents in the model have access roughly to the same
information as the agents in the real world do. And, of course, they are not anointed with some special
knowledge on "how the world truly works". So, concerning for example demand expectations, agents
form expectations about own-demand levels, making inferences based on their knowledge ­
basically, their own demand history and the history of some aggregate variables, and not much more.


           3.3 An ecology of expectation heuristics


           In the presence of imperfect information and deeply uncertain environments, we assume that
agents follow behavioral rules, or heuristics, to form their demand expectations.29 More specifically,
in line with the experimental evidence provided by Anufriev and Hommes (2012), firms can choose


27 While in our model we use a single measure of competitiveness determining the evolution of shares, the evolution of shares could as
well depend separately on price and unfilled orders/excess capacity.
28 Note that at the beginning of the period, firms may use all their liquid assets before borrowing. However, as the period ends they receive

payments from their sales and "healthy" firms first pay down a fixed fraction of their debt (1/3) and then replenish their liquid assets.
29 The use of heuristics in decision-making under uncertainty is largely documented in the psychology literature, see in particular

applications to exchange rate forecasts by banks using an adaptive heuristic in Gigerenzer (2015) and other management decisions in Luan
et al. (2019).
                                                                                                                                         14
among the following repertoire of rules.30
           First, firms may follow naïve demand expectations, according to which the past is the best
proxy for the future:31
                                                           
                                                           nai ve, () =  ( - 1).                                                       (7)


This is the common expectation assumption in the K+S model and it represents our benchmark case.
            Second, under adaptive expectations (ADA), firms correct for their past demand forecast
mistakes:
                                    
                                    , () =  ( - 1) +  ( ( - 1) -  ( - 1)),                                                             (8)


In our simulations, we assume that  = 0.65 , in accordance with the experimental evidence
provided by Hommes (2011) and Anufriev and Hommes (2012) (as in the other expectations rules).
The results appear, however, to be robust across a reasonable range of parameter values.
            Third, in the weak (WTR) and strong (STR) trend expectation rules, firms behave like
"chartist" traders, trying to ride demand patterns:
                                     
                                     , () =  ( - 1) +  ( ( - 1) -  ( - 2));                                                            (9)


                                      
                                      , () =  ( - 1) +  ( ( - 1) -  ( - 2)).                                                          (10)


The only difference between the WTR and STR expectation rules is the value of the parameter
weighing past demand changes, i.e.  = 0.4 and  = 1.3.
           Finally, firms may react to both their past demand dynamics and to some aggregate "anchor",
the GDP. The "anchor and adjustment" expectation rule (AA, see Tversky and Kahneman, 1974) is
thus:
           
           , () = [1 +  ( - 1) + (1 -  ) ( - 1)] ( - 1),                                                                              (11)


with  = 0.5.32
           We then consider a richer model of expectation formation (labeled "SWITCH" in the
attached tables) wherein rules are selected by agents on the basis of their predictive performance.
Starting from a uniform distribution of the five expectation rules described above, firms switch across
heuristics according to their past performance.33 Firms, of course, have strong incentives to forecast


30 See also Dosi et al. (2006); Hommes (2011); Assenza et al. (2014); Colasante et al. (2015). Coibion et al. (2015) find empirical evidence
supporting heterogeneity of beliefs among firms.
31 This rule belongs to the class of recency heuristics from psychology, as introduced in Brown (1838).
32 Our anchor and adjustment rule is different from that employed by Anufriev and Hommes (2012), who, in a financial market framework

employ either the fundamental price or the sample average of past prices. In order to keep the "spirit" of their rule in a macroeconomic
model, we employ the GDP, which can be considered as a proxy of the state of the whole economy.
33 Entrant firms copy the expectation rule of an incumbent and their probability to adopt any one of them is proportional to its diffusion

in the system. Simulation results presented in Section 5 are robust to the assumption that the entrants start with a uniform distribution of
expectation rules.
                                                                                                                                        15
future demand correctly so as to avoid costly accumulation of inventories or conversely to avoid
missing sales and profit opportunities.34
             Furthermore, in line with the experimental evidence in Anufriev and Hommes (2012), firms
update the performance () of each heuristic   {naive, , , , } according to the last
demand forecast error:
                                                                                        2
                                                               (-1)-, (-1)
                                           , () = - (                (-1)
                                                                    ,
                                                                                        ) + , ( - 1),      (12)

where 0    1 is a memory parameter measuring the relative weight attributed by agents to past
errors. Firms adopt a given expectation rule with a probability , (), which is updated in each
period as follows:
                                                                                            exp(,())
                                             , () = , ( - 1) + (1 - )                          ()
                                                                                                       ,   (13)

     with 0  ,   1 , and  () = =1 exp(, ()) being a normalization factor. The

parameter  captures the persistence of expectation-formation rules (the higher is , the higher is
the path dependency in terms of the weight of each expectation rule), while the parameter 
measures the impact of past performance on the choice of expectation rule (the higher is , the higher
is the impact of the relative success of an expectation rule on its probability to be chosen).
             In the SWITCH scenario, the expectation formation rules are heterogeneous and evolve over
time. In Section 6, we experiment with a more "sophisticated" expectations rule which introduces
learning and thus involves higher degrees of "rationality". More specifically, firms will behave as
econometricians, estimating the parameters of the expectation rules via recursive least squares (RLS).


             3.4 The banking sector


             In the model, the credit supply is determined endogenously by banks (among a vast body of
literature, see e.g. Stiglitz and Greenwald, 2003; Godley and Lavoie, 2007; McLeay et al., 2014).
The number of banks and the network linking firms and banks are fixed over time.35
             Banks' supply of credit is a function of their equity and is constrained by capital adequacy
requirements inspired by Basel-framework rules (see e.g. Delli Gatti et al., 2010; Ashraf et al., 2017;
Raberto et al., 2012; Popoyan et al., 2017). Moreover, banks, which gather deposits before they
provide credit, maintain a buffer over the mandatory level of capital, whose magnitude is altered over
the business cycle according to their financial fragility (Bikker and Metzemakers, 2005; Becker and
Ivashina, 2014), proxied by the ratio between accumulated bad debt (i.e. loans in default) and bank
assets (Adrian and Shin, 2010). Credit supply is thus influenced by changes in a bank's balance sheet,
which itself is affected by bank profits net of loan losses. This creates a feedback loop from loan


34   The effects of the two types of forecasting errors are indeed roughly symmetric.
35   See Dosi et al., (2015).
                                                                                                            16
losses to reductions in the amount of credit supplied to firms in the next period, via changes in banks'
equity.
           Credit demand stems from consumption-good firms' financing needs for investment and
production, net of their internal funds (see Section 3.2 above). Banks allocate credit among their
clients by ranking the applicants in terms of their creditworthiness, defined by the ratio between net
worth and sales. Banks provide credit up to their credit supply ceiling. Credit availability is the lesser
of what banks are willing to supply, based on their equity,36 and what they are allowed to supply,
based on regulatory (capital adequacy) standards.
           Banks fix the interest rate on loans applying a mark-up on the Central Bank interest rate
(),37 which is set in each period according to a Taylor rule (Howitt, 1992; Taylor, 1993). Loan
rates are changing over time, but they are also heterogeneous across borrowers, as they incorporate
a spread linked to firms' idiosyncratic credit risk.38 Banks experience loan losses whenever one of
their clients goes bankrupt and exits the market. Loan losses represent an (endogenous) negative
shock to bank profits, which may become negative. If the net worth of the bank is not sufficient to
cover such losses, the bank goes bankrupt. Whenever a bank fails, the Government steps in and bails
it out providing fresh capital; we can think of the recapitalized bank as a new bank.39


           3.5 The labor market, consumption and the government sector


           In our model, we assume there may be unemployment (the labor market may not clear). The
labor supply  is fixed and inelastic to the nominal or real wage rate. The nominal wage () is
determined by institutional and market factors.40 As a consequence, both involuntary unemployment
and labor rationing may emerge. Nominal wage dynamics depend on the gap between actual and
targeted inflation (see Table A1 in the Appendix),41 and on the dynamics of average productivity
and of the unemployment rate:


                            ()                                                         ()                  ()
                           (-1)
                                     =   + 1 (( - 1) -   ) + 2 (-1) - 3 (-1),                                                           (14)


36 In a more general model, banks' willingness to supply credit also depends, of course, on their risk perceptions. Stiglitz and Greenwald
(2003).
37 In this sense, banks are a particular class of firms ­ they supply credit: and like other firms, don't instantaneously adjust their prices

(interest rates charged for any risk class of borrowers). And because prices (interest rates) are not adjusted instantaneously to clear the
credit market, there will be credit rationing ­ even though higher risk borrowers are assumed to pay higher interest rates, the adjustment
in interest rates is assumed not to fully compensate for the additional risk, so lower risk borrowers are still preferred, as described above.
Of course, even without such constraints on adjustment, there will often be credit rationing, arising out of asymmetries of information and
costs of enforcement of credit contracts. See e.g. Stiglitz and Weiss (1981).
38 Such credit risk is asse ssed by the net worth to sales ratio of the firm, which defines its ranking in the bank's portfolio of clients, see

Dosi et al. (2015).
39 As in the case of firms, the net worth of the new bank is a random fraction of the smallest incumbent's equity, provid ed it respects the

capital adequacy ratio as set by the regulator (see also Dosi et al., 2015). Here for simplicity we assume simply that the go vernment
supports the creation of the new bank with fiat money. However, in Dosi et al. (2015) we examine the complex but more realistic case in
which public bailouts are an explicit burden on government finance.
40 We assume here that all workers get the same wage, ignoring, for simplifying reasons, the impact of firm heterogeneity on wages.

Instead, a detailed microfoundation of the labor market in the K+S models is provided in Dosi et al. (2017a,b).
41 This term reflects the effect of monetary policy, which is assumed to tighten when inflation exceeds the target rate, and to loosen

otherwise. Inflation is computed as the variation of the price of consumption-good firms weighted by their market shares.
                                                                                                                                           17
where  is the average labor productivity,  the unemployment rate, and 1,2,3 > 0.
           Unemployed workers receive a subsidy (  ) which is a fraction of the current nominal wage,
i.e.   () = () , with   [0,1] . Given the total labor demand  , the total amount of
unemployment subsidies paid by the Government ( ) is () = max{  ()( -  ()),0}.
           We assume that workers fully consume their income (which is equivalent to assuming that
workers are credit constrained and therefore cannot engage in standard consumption smoothing),42
while capitalists do not, but only save and invest. Accordingly, aggregate consumption ( )43 depends
on the income of both employed and unemployed workers:


                                                       () = () () + ().                                                               (15)


Finally, the public deficit (or surplus) in each period is the difference between Government expenses
(unemployment subsidies, public debt cost and bank bailout costs) and its revenues (taxes are levied
on firm and bank profits at the fix rate ).44 The public deficit is then equal to:


                                               
                                             =  +  +  -  .                                                                            (16)


 If  > 0, the Government issues new bonds, bought by banks with their net profits.45
           The tight relation between the dynamics of consumption and income is the second main
source of income constraints in our model (the other one being the effect of credit constraints of
firms' investments, see Section 3.2). Notice that our model is very different from other macro-models
(e.g. DSGE ones), where consumption is instead determined by an inter-temporal allocative decision
driven by the difference between the interest and inter-temporal discount rates.
           To repeat, the explicit microfoundation of the dynamics for all aggregate variables of interest
(e.g. output, investment, employment, etc.) is nested in the decisions of a multiplicity of
heterogeneous, adaptive agents and in their interaction mechanisms. 46 The model satisfies the
standard national account identities: the sum of value added of capital- and consumption goods firms
(  ) equals their aggregate production. Total production in turn coincides with the sum of
aggregate consumption, investment and inventories.


42 The above assumption is also in line with the microeconomic empirical evidence suggesting that the consumption of most households
tracks their income as their wealth is close to zero (see e.g. Wolff, 1998). Notice that the conclusions of the paper qualitative ly hold as
long as, in standard Keynesian fashion (see e.g. Kaldor, 1955), the propensity to consume out of profits is lower than that out of wages.
43 Note that there are no taxes on consumption in the model.
44 See Dosi et al. (2015) for more details on the computation of the public budget as well as a discussion on the role of fiscal rules on

macroeconomic outcomes.
45 In the rare cases in which the supply of bonds exceeds their demand, the residual quantity is bought by the Central Bank.
46 While each of these decisions is made in a plausible way, consistent with observed behavior, the decisions themselves may or may not

be based on the solution to a complex intertemporal dynamic optimization problem. There are complex trade-offs in modelling. Our
analysis focuses on lags in adjustments, the complexity of interactions among agents, and the role of income, financial and regulatory
constraints, all of which are not well captured in standard DSGE models. The richness of the dynamics our model generates suggests that
agent-based models should be viewed as, at a minimum, an important complement to these standard models.
                                                                                                                                        18
            4 Empirical validation

             The K+S model can jointly account for a large number of macro and micro stylized facts.
The ability of the model to reproduce at the same time a wide set of empirical regularities, with a
plausible set of parameters, is a procedure that both empirically corroborates the model, and
disciplines the parametrization used in the simulation experiments. It is also one of the major
advantages of agent-based vis-à-vis DSGE models (Fagiolo and Roventini, 2016), which cannot
account for many stylized facts such as those reported by Haldane and Turrell (2019).47


     Stylized facts                                                              Empirical studies (among others)

        Macroeconomic stylized facts
     SF1       Endogenous   self-sustained growth with                       Burns and Mitchell (1946); Kuznets and Murphy
                                     persistent fluctuations                 (1966);
     SF2       Fat-tailed GDP growth-rate distribution                       Zarnowitz (1985); Stock and Watson
                                                                             (1999); Fagiolo et al. (2008)
     SF3       Recession duration exponentially distributed                  Ausloos et al. (2004); Wright (2005)
     SF4       Relative volatility of GDP, consumption and                   Stock and Watson (1999); Napoletano et al.
               investment                                                    (2006)
     SF5       Cross-correlations of macro variables                         Stock and Watson (1999); Napoletano et al.
                                                                             (2006)
     SF6       Pro-cyclical aggregate R&D investment                         Walde and Woitek (2004)
     SF7       Cross-correlations of credit-related variables                Lown and Morgan (2006); Leary (2009)
     SF8       Cross-correlation between firm debt and loan                  Mendoza and Terrones (2014); Foos et al. (2010)
               losses
     SF9       Banking crises duration is right skewed                       Reinhart and Rogoff (2009)
     SF10      Fiscal costs of banking crises to GDP                         Laeven and Valencia (2008)
               distribution is fat-tailed
        Microeconomic stylized facts
     SF11      Firm (log) size distribution is right-skewed                  Dosi (2007)
     SF12      Fat-tailed firm growth-rate distribution                      Bottazzi and Secchi (2003, 2006)
     SF13      Productivity heterogeneity across firms                       Bartelsman and Doms (2000); Dosi (2007)
     SF14      Persistent productivity differential across                   Bartelsman and Doms (2000); Dosi (2007)
               firms
     SF15      Lumpy investment rates at firm-level                          Doms and Dunne (1998)
     SF16      Firm bankruptcies are counter-cyclical                        Jaimovich and Floetotto (2008)
     SF17      Firm bad-debt distribution fits a power-law                   Di Guilmi et al. (2004)
                                    Table 1. Stylized facts replicated by the K+S models.


            We briefly recall the micro- and macro regularities reproduced by the K+S model in Table
1. On the macroeconomic side, self-sustained growth is endogenously generated by the model (see
left plot in Figure 2) together with emergent business cycles (see the bandpass-filtered GDP, right
plot in Figure 2). Mild economic fluctuations are punctuated by deep downturns. As a consequence,
the GDP growth-rate distribution generated by the model exhibits fat tails (cf. Figure 3) strikingly


47 Some more recent DSGE models (see for instance Kaplan et al., 2018) attempt to artificially introduce heterogeneity by introducing
dispersion in income through idiosyncratic shocks. Yet, the way this is done does not address the issues raised here of complexity, does
not provide an adequate description of the full consequences of this heterogeneity, which depends importantly on the role of constraints,
such as that on credit availability, and does not address issues of firm heterogeneity, which play a central role in the analysis here and in
the economy.
                                                                                                                                         19
similar to those observed empirically (Fagiolo et al., 2008; Castaldi and Dosi, 2009).48 At business
cycle frequencies, the relative volatility of fluctuations between output, investment and consumption
and the comovements between GDP and the main macroeconomic time series are in line with the
empirical evidence (for the empirics and discussion cf. Stock and Watson, 1999; Napoletano et al.,
2006). In particular, aggregate R&D investment is pro-cyclical (see e.g. Walde and Woitek, 2004).




                      Figure 2. Model-generated GDP, consumption and investment time series.




                        Figure 3. GDP growth-rate distribution. Simulated data vs. Normal fit.


           Furthermore, the model also matches the major business cycle stylized facts concerning
credit (Bikker and Metzemakers, 2005; Mendoza and Terrones, 2014) and banking crises (Laeven
and Valencia, 2008; Reinhart and Rogoff, 2009). In particular, credit booms lead to higher firm
default rates, which often trigger banking crises. The impact of banking crises on the public budget
is severe, much higher than those of "standard" recessions, and not limited to bailout costs (Reinhart


48
   Note that DSGE models are not able to match such empirical regularities even if they are fed with fat-tailed shocks (Ascari et al.,
2015). This implies that they cannot jointly account for mild recessions and deep downturns (Stiglitz, 2018).
                                                                                                                                         20
and Rogoff, 2013).
          The model is also able to replicate several microeconomic empirical regularities. Note that
the properties described emerge directly from the simulations, and are not imposed by initial
conditions; all firms are initialized in the first period of the model with the same size and productivity
level. As an outcome from the simulations, firms are extremely heterogeneous in terms of size,
growth rate and productivity: firm size distributions are right skewed; firm growth-rate distributions
are fat tailed; productivity differentials among firms are persistent over time (see e.g. Bartelsman and
Doms, 2000; Dosi, 2007). Moreover, firms invest in a lumpy fashion (Doms and Dunne, 1998).
Discontinuities in investment follow from the large demand and technological shocks emerging in
the model.
          Finally, note that most of the foregoing micro ad macro regularities reproduced by the K+S
model are exactly those that DSGE models cannot account for (compare Tables 1 in this paper with
the equivalent in Haldane and Turrell, 2019).


          5 The impact of heterogeneous expectation formation rules

          After having showed the explanatory capabilities of the K+S model in the baseline scenario
with naïve expectations in the previous section, let us compare the performance of the economy
under alternative expectation formation scenarios. More specifically, we assess the impact of
different expectation heuristics on variables capturing the long-run performance of the economy
(average GDP growth), as well as short-run fluctuations (output volatility, average unemployment
rate, economic crises ­ defined here as the likelihood of GDP drops higher than three percent). We
also study the forecast mistakes of firms in alternative expectation regimes, measured as follows:


                                                                                 2
                                                          ()-( ()+ ())
                                        () = [                ()+  ()
                                                              
                                                                                ] ,                                        (17)
                                                                 




which include also expected inventories (  ).49 Then, we compute the mean squared forecast error
(MSFE), built by aggregating the individual mistakes in consumption-good firms' demand forecasts.
We consider MSFEs for sake of comparability with the incumbent literature (see e.g. Anufriev and
Hommes, 2012). However, it is crucial to note that MSFEs directly map into firms' profitability, thus
affecting their evolution and survival probability. Indeed, the correlations between MSFEs and firms'
profit margins are significantly negative, especially when they accumulate losses (see Table 2). If
firms underestimate their demand, they lose competitiveness and market shares, while in case of



49The expectation mistakes of consumption-good firms are computed at the end of the period, once realized demand is observed.
Expectational errors are normalized to be independent from firms' size. The  is then the Monte-Carlo average of the mean over all
agents' squared errors for all periods in each independent run.
                                                                                                                              21
overproduction, they have to pay wages and accumulate inventories without earning revenue.
           The results of our Monte Carlo simulation analyses are presented in Table 3, where we
report, for all the variables, the ratio between alternative expectation rules and the baseline heuristic
with naïve expectations, and mean-difference t-tests. The first four scenarios (ADA, WTR, STR and
AA) assume that all the firms in the economy follow the same expectation rule. This allows us to
understand the forecast errors of each rule as well as their impact on the economic system,
independently of other heuristics.
           The mean squared forecast errors are also reported in Table 3. The MSFEs of naïve
expectations are significantly lower than those of most other heuristics (WTR, STR, AA), with one
exception: The MSFE is lower with the adaptive expectation (ADA) regime, although the difference
is not significant.
           The reason that the forecasting performance does not improve when other rules are employed
is, as we have already noted, that the behavior of the system itself changes in ways which make
forecasting more difficult. In a sense, the adverse effect on system volatility outweighs any
improvement that might have occurred within a fixed system.
           Results show that the quality of the forecasts of alternative expectations rules does not
necessarily map into macroeconomic performance (cf. Table 3). This is another piece of evidence on
the lack of isomorphism between micro expectations/behaviors and system-level dynamics. On one
side, with strong trend heuristics (STR), higher MSFEs translate into lower long-run growth and
higher short-run instability. This result is explained by the destabilizing role in model dynamics of
additional positive feedbacks resulting from the STR rule (see e.g. Heemeijer et al., 2009; Anufriev
et al., 2013). Similarly, when firms take into account both their own demand and GDP dynamics as
in the AA case, MSFEs, output volatility and the likelihood of economic crises significantly
increase.50 On the other hand, the MSFEs of the weak trend rule (WTR) is higher than those of naïve
expectations, but the unemployment rate seems somewhat lower51 (while the performance of other
variables is not significantly different from the benchmark case). Finally, in comparison to the
benchmark scenario, the adaptive expectation rule (ADA) reduces GDP volatility and the likelihood
of crises, yet MSFEs are of a similar range.

                                                                             Avg. correlation         Std. dev.

                    Unconditional                                                   -0.147              0.023

                    Conditional on firms with negative profits                      -0.758              0.021


Table 2. Correlation between squared forecast errors and profits of individual firms. Average over 50 Monte-
Carlo runs.


50 The worse performance of AA expectations is confirmed also when firms consider only GDP growth (  = 1) in forecasting their
demand. The results are available from the authors upon request.
51 The conjecture here is that even if the weak trend rule induces a higher forecasting error of individual agents, the rule might better

capture on average for the whole economy the fact that most of the times the economy grows, and in an autocorrelated fashion. See also
the discussion below on the switching regime.
                                                                                                                                       22
            Expectation          Avg. GDP      GDP          Unemployment       Likelihood   Mean squared
            Rules                growth        volatility   rate               of crises    forecast error

            Average value
            Naïve                0.030         0.042        0.047              0.066        0.072


            Ratio wrt. Naïve
            ADA                  0.996         0.858**      1.304              0.611**      0.960
            WTR                  1.005         1.060        0.691*             1.049        1.842**
            STR                  0.966**       2.879**      2.341**            3.082**      7.731**
            AA                   1.000         1.563**      0.890              1.775**      1.321**
            SWITCH               1.008         0.947        0.395**            0.765*       1.773**



Table 3. Expectation heuristics and macroeconomic performance. Average values in the baseline (naïve) and
ratio with respect to the baseline. *: significant difference wrt. baseline (naïve) at 1% level (**) and 5% level
(*). Average over 50 Monte-Carlo runs.




         Figure 4. Share of each expectation heuristic over time. Average over 50 Monte-Carlo runs.


Choosing expectation rules


         Let us now consider the scenario (labeled SWITCH), in which agents can switch across
heuristics according to their past performance (cf. Section 3.3), thus "learning" from experience.
Because different firms will have different experiences, there will be heterogeneity in the rules they
employ. Figure 4 depicts the evolution of the share of each heuristic followed by agents over time.
With the exception of the strong trend rule (STR), the share of the other heuristics is similar and
fluctuates around a relatively stable value: firms do not converge to a single dominant expectation
rule, but rather the system grows with an ecology of rules. Such a result is robust to different values
of the parameters affecting firms' choice of the expectation heuristic (cf. ,  and , in eqs. 12 and
13). In the presence of such an ecology of expectation heuristics, the mean squared forecast errors
are considerably and significantly higher than in the benchmark naïve case (cf. Table 3). If agents
                                                                                                              23
try to improve their forecast performance by switching more actively among different heuristics
according to their past performance, forecast performance becomes worse­ again because the
behavior of the economic system itself changes. Yet, the overall performance of the economy is not
worse than the one observed under the naïve rule: on the contrary, the unemployment rate and
occurrence of crises are significantly lower. Even GDP volatility is reduced. (See Table 3). Again,
higher MSFEs do not translate into poorer performance of the economy.
           It thus does not appear that the worsened forecasting performance in this case is the result of
more economic volatility. Rather in a complex and changing environment with agents pursuing
different expectation formation strategies, there is no simple link between even average forecasting
error and systemic volatility.52 Conversely, in the opposite direction, from the micro to the system-
level dynamics, it is the ecology of different (even if relatively poor) learning rules which appears to
exert some stabilization effect. (Later experiments, described below, however question the generality
of these results.)
           The first general conclusion from this battery of simulation exercises is that the fast and
frugal naïve heuristics can (sometimes) forecast better than relatively more complex rules (in line
with the results in Gigerenzer and Brighton, 2009; Gigerenzer and Todd, 1999) ­ and did so in the
model investigated in this paper. This is partly because in most instances (the ADA rule was the
exception), such rules lead to greater volatility: the ways expectations are formed affects dynamics,
and not always in the way that might have been thought. In a second-or third-best world, as we know,
improvements in individual markets may lead to Pareto-inferior outcomes; so too here, what might
appear as an improvement in forecasting methodology leads to worst forecasting.
           Second, rules involving learning from experience (such as in the SWITCH regime) can yield
worse forecasts.
           But third, worsened individual performance in forecasting, however, is not necessarily
reflected by any deterioration of the performance of the system: on the contrary, stochastic transitions
within ecologies of rules seem to have somewhat stabilized the economy, thus possibly improving
macroeconomic dynamics. Part of the reason for this seemingly anomalous result may be related to
an observation made by Knight: excess optimism on the part of firms, he argued, had a salutary effect
on economic growth, because it led firms to invest more than they otherwise would have. In modern
parlance, there are macroeconomic externalities, resulting in under- or overinvestment, and these
may be partially corrected by forecast errors.
           Finally, while expectations do have some effect on the dynamics of the economy, some
aspects of the behavior of the economy, in particular average growth rates, are not particularly
sensitive to the assumptions of expectation formation, though others (such as the frequency of crises)
are.

52 This could easily be seen to be the case, for instance, if at least at certain times the forecast errors of those using different expectation
rules were negatively correlated. Then while on average forecasts might be (more) accurate, an increase in variability of forecasts would
lead to an increase in the mean forecast error.
                                                                                                                                            24
           In the most sophisticated exercise analyzed so far, agents just switch between fixed
parameter heuristics. Let us now explore how further increasing the sophistication of firms'
expectation formation processes affects individual and macroeconomic performances.


           6 From heuristics to learning expectations

           Let us now relax the assumption of common and stable parameters in the expectation
heuristics followed by firms, and make agents learn as if they were econometricians. We introduce
a learning process which tries to capture "a boundedly rational model of how rational expectations
can be achieved" (Evans and Honkapohja, 1999, p. 452).53 More specifically, agents are assumed to
predict their future demand estimating the parameter of their expectation rule via recursive least
squares (RLS).54 We will introduce RLS learning in the adaptive expectation (ADA) scenario (cf.
Section 5 above). In this setting expectations are based on an adaptive process according to which
agents learn from their past, and the parameter ( ) of the expectation heuristic now varies cross-
sectionally and over time, according to firms' estimations over their own demand time series (, ).
Because entrants have no data on which to formulate RLS estimates, we assume that they follow
simple heuristics. Those with enough data may switch and become sophisticated firms.55 Thus young
firms follow a heuristic, setting the parameter in eq. 8 as earlier (i.e. , =  = 0.65). Once
                                             
incumbent firms gather enough observations (  ), they become "sophisticated" and start
performing RLS (see below).
           The ("adult") sophisticated firms estimate eq. 8 by recursive least squares:


                 ( - 1) -  ( - 2) =  + , ( ( - 2) -  ( - 2)) + (),                                                                     (18)


                                                     
where the estimation sample size is between  = 5 and  = 40 observations. To account
                                                                     
for agents' limited memory, when the sample reaches the maximum size  , the firm replaces the
oldest observation with the newest one.56
           Not surprisingly, the relative share of heuristic vs. sophisticated firms (which, as shown
below, impacts both the micro- and the macroeconomic performance in the system) depends on entry
                                                                                       
and exit processes, and on the minimum number of observations required to perform RLS ( ).


53 Rational expectations models are, of course, forward looking, but they assume that individuals have been able to construct a structural
model of the economy such that, looking at pa st data, they can "rationally" anticipate what that future looks like (stochastically).
54 We also assume a simple linear structure. Below, we discuss some of the complexities that arise as we formulate non -linear models.

Much of the literature recognizes that the world is non-linear, but is predicated on the belief that linear approximations suffice.
55 As pointed out by Haltiwanger and Waldman (1985), when there is a fraction of agents which have no previous experience with a

specific situation, learning does not converge to a rational expectation equilibrium. Similarly, in our model, as we shall see, sophisticated
learning does not jettison heuristic-guided firms from the economy.
56 Moreover, the changing economy may correctly lead individuals to believe that data from the distant past is of only limited relevance


to today. After the estimation we bound the parameters such that  ,,  [-2; 2]. The presented results are robust also in the unbounded
case.
                                                                                                                                         25
           As the ADA was the regime with the lowest mean squared forecast error, we will also
compare RLS with ADA when they both co-exist . In that case we label RLS as "ADA+RLS
learning" in the tables. In that way we assess the impact of learning on macroeconomic dynamics.57
           In Table 4, we compare our target indicators under RLS learning in the adaptive expectation
scenario vis-à-vis the baseline (naïve expectations) as well as the simple heuristic ADA. Simulation
results show that RLS learning has both short- and long-run destabilizing effects on macroeconomic
dynamics, as it increases output volatility, the unemployment rate and the likelihood of economic
crises, while reducing average GDP growth.



        Expectation                            Avg. GDP          GDP             Unemployment          Likelihood       Mean squared
        rules                                  growth            volatility      rate                  of crises        forecast error

        RLS-learning experiment

        Ratio wrt. to Naïve
        ADA + RLS learning                     0.961**           1.242**         4.553**               1.623**          7.529**

        Ratio wrt. to ADA
        ADA + RLS learning                     0.965**           1.448**         3.492**               2.657**          7.847**

                                                                                  
Table 4. Macroeconomic performance under RLS-learning ADA expectations,                = 5. Ratio with respect
to the baseline (naïve, ADA). Significant difference wrt. baseline at 1% level (**) and 5% level (*). Average
over 50 Monte-Carlo runs.


            Why does the introduction of RLS-learning considerably worsen the performance of the
economy? Overall, firms make considerably larger forecasting mistakes (cf. Table 4, last column).58
Looking at what is going on more in detail, let us consider separately the mean squared demand
forecast errors of heuristic-guided and sophisticated agents. Table 5 presents such statistics. The
surge in the economy-wide MSFEs is mainly driven by sophisticated agents, whose errors are eight
times larger than heuristic ones. Moreover, the presence of sophisticated agents also inflates the
forecast errors of heuristic-guided firms, from 0.069 ­ in the ADA scenario, whereby all firms follow
the heuristic, to 0.082 ­ in the ADA+RLS scenario, in presence of sophisticated firms (the relation
between the relative share of the two types of firms and their MSFEs will be further studied below).


                             Expectation rule               all agents     sophisticated       heuristic-guided
                                                                              agents                agents

                             Naïve                            0.072               -                     -
                             ADA                              0.069               -                     -
                             ADA + RLS learning               0.544             0.685                 0.082

Table 5. Mean squared demand forecast errors under the different expectation scenarios. Average over 50
Monte-Carlo runs.

57 Implementing instead RLS in the framework of the trend rule ­ as under the RLS-learning scenario, the "weak" and "strong" trend rules
collapse into a unique one ­ yields similar results as in the case of the ADA framework shown here.
58 Note that when RLS-learning is introduced, the increases in MSFEs are much higher than the differences across alternative heuristic-

expectation scenarios. And this comes together with worse macroeconomic performances.
                                                                                                                                    26
        What can explain the huge mistakes of sophisticated firms, and the consequent lower
performance of the RLS-learning scenario vis-à-vis the naïve and ADA ones? There are four
alternative hypotheses. A straightforward explanation is simply that fast and frugal heuristic
expectations outperform RLS-learning ones in an economic environment characterized by deep
uncertainty and technical change. In such a framework, heuristics can allow one to get more accurate
forecasts than complex procedures, because they are robust to changes in the fundamentals of the
economy. This is the less-is-more principle emerging when agents must take decisions or form
forecasts in complex environment. The second hypothesis is that the larger forecast errors of
sophisticated agents are due to an insufficient number of observations employed in the estimations.
The third is that heuristic-guided firms create noise, though it should be deeply troubling if "learning"
only works when everyone is a sophisticated learner. The fourth is that in complex evolving
economies, more sophisticated rules themselves contribute to greater volatility. In order to get
insights into these alternative interpretations, we begin by exploiting the cross-sectional
heterogeneity in the size of the samples employed by the sophisticated agents to estimate their
expected demand. Indeed, depending on their age, firms rely on a variable number of observations
                     
bounded between  and  . Figure 5 (left) shows that, as the size of the sample increases
               
and approaches  = 40 , the estimates become more and more similar across firms, but the
demand forecast errors steadily rise (cf. Figure 5, right). This means that long-lasting incumbents
make larger mistakes than novel RLS-learning firms. This is a first indication that more information
does not yield more accuracy in such a setting.




Figure 5. Cross-sectional performance across agents using different number of observations required to
perform RLS. Left: Binned plot relating sample size and estimated coefficients. Right: Binned plot relating
sample size and demand forecast mistakes. Average over 50 Monte-Carlo runs.

        We then consider whether the under-performance of sophisticated agents is due to the
                                                                 
"noise" created by heuristic-based ones. By tuning the parameter  , which defines the minimum
number of observations required for RLS estimation, we exogenously change the relative share of
                                                                                                        27
sophisticated and heuristic firms in the economy. Figure 6 (bottom, left) shows that the share of RLS
                                      
learners decreases from 79% to 20% as  rises from five to thirty. At the same time, as more
heuristic followers populate the economy, output volatility and the unemployment rate steadily fall
(see Figure 6, top row). Furthermore, the analysis of the MSFEs of the two types of agents suggests
that two effects are responsible for such improvement in the performance of the economy (cf. Figure
6, bottom right). First, as heuristic agents make lower mistakes than sophisticated ones, the increase
in their relative share automatically reduces the average forecast error, due to a sheer composition
effect. At the same time, an interaction effect is at work, as both types of agents (and especially the
sophisticated ones) reduce their mistakes when the fraction of sophisticated firms is lower, which is
not surprising given that the economy behaves in a more stable way. The presence of firms following
simple heuristics stabilizes the economy. The RLS-learning firms turn out to be the source of noise
as they destabilize the forecasting performance of all agents. We shall come back below to why this
might happen.




                                                                                
Figure 6. Effect of changing the minimum number of observations to perform RLS,  . Average over 50
Monte-Carlo runs.


        In the previous setup, heuristic and sophisticated agents differ in age, and as such, they are
not really comparable. Further important insights can be gained instead by experimenting with the
evolutionary competition between heuristic and RLS agents within the same environment. In order
to do that, we assume that when firms become old enough to perform RLS regressions (i.e. 8-periods
old in the benchmark case given the estimation lags), they continue to be heuristic with probability
one half, or conversely become of the RLS type and start estimating their adaptive parameter. (In the
next section, we consider the case where, once they are "old" enough and have sufficient data to

                                                                                                    28
engage in RLS forecasting, they do so if and only if their data suggests it would be more profitable
to do so.) Such a "randomized" experiment allows us to compare the characteristics of the two types
of firms. We focus below on their relative fitness proxied by, first, the revealed profitability of the
two behavioral types, and, second, their survival rates.




Figure 7. Evolution of the logarithm of sales of RLS agents (left) and heuristic-guided agents (right) over one
simulation run.

           In terms of profitability, the greater forecasting errors make more sophisticated firms less
profitable. In addition, both types display a mean of age at death that is much higher than the median
­ evidence of a fat right-tail of distribution for firm longevity. Firms that survive longer do so either
because they are technologically more competent or simply luckier in their forecast and investment
decisions and the outcome of those decisiions. However, the sophisticated firms seem to live a more
precarious and marginal life. The volatility of their size is much higher (see Figure 7, left vs. right)
and they represent 97% of the firms in the bottom decile of the market share distribution (average
over 50 Montecarlo runs).59
           The poor performance of economies where expectations are formed with RLS learning arises
from the fact that it is not possible to bend complex, non-linear worlds into a linear framework. This
is not only the case in this model, but it is also the typical situation in contemporary economies where
the stream of innovations and the resulting perpetual structural change coevolve with Knightian
uncertainty, making the typical econometric tools employed in standard macroeconomics of limited
value or even misleading. In such a framework, the less-is-more principle holds and more
"sophistication" of the kind described in this section deteriorates the quality of the forecasts. Indeed,
in line with Box and Jenkins (1976), more complex time-series models, even when they fit better the
(training) data, can lead to higher forecast errors than simpler ones.60 Thus, in a complex evolving


59 We also experimented with different selection intensities (proxied by the parameter  governing the replicator equation, eq. 19 in the
Appendix): the median and mean age at death of RLS agents falls faster than that of heuristic ones as the selection intensity increases.
60 In time-series econometrics, simple univariate ARMA models can forecast better than larger structural macroeconometric models. See

also Hendry and Clements (2019).
                                                                                                                                     29
economy, the adoption of fast and frugal heuristics may be the "rational" response, not only of agents,
but of regulators and policy makers too (Haldane, 2012). Of course, there are many ways in which
agents can become more sophisticated in "learning", including by means of non-linear models. But
note that as non-linearities are introduced, the firm must estimate a larger number of parameters, and
thus the confidence in the correctness of the model, for a fixed data set, is lowered. But as the number
of periods of data required before it can achieve a comparable degree of confidence is increased, so
too is the likelihood of a structural break. This would not be a problem in a world without
technological change, or in which the pace of technological change never changed. But this is not
the world we live in. We have deliberately constructed a model in which the agents populating the
model would not have an easy time uncovering the process generating the changes in technology. In
the next section, we explore further the relationship between structural breaks, expectations, and
macroeconomic performance.


           7 Structural breaks, uncertainty and expectations

           In this section, we describe the results of two additional sets of experiments. First, we study
how RLS-learning expectations fare in an environment presenting a lower level of uncertainty and
complexity (low-innovation regime). This first robustness test allows us to evaluate how the
economic environment affects the performance of different expectation rules. As discussed above,
the poor performance of the RLS-learning rule might be related to the complex evolving nature of
the environment, as driven by innovation leaps. It follows that our earlier results might be affected
by an exogenous change in the size and frequency of innovation leaps.
           We exogenously reduce the uncertainty and complexity of the environment by limiting the
Schumpeterian engine of the K+S model, scaling down the frequency and magnitude of the micro-
shocks that characterize the innovation process. More specifically, we consider a low-innovation
scenario where both firm search capabilities and technological opportunities are lower with respect
to the baseline parametrization (see also Dosi et al., 2010).61 We compare the performance of the
economy under the baseline and the low-innovation regimes under the ADA + RLS expectation
formation.
           In the low-innovation regime, the short-run performance of an economy employing RLS-
learning expectations improves, in particular, rendering it less volatile. This is what we expected: in
a less complex environment, recursive least squares works relatively better, resulting also in
significantly lower MSFEs.62
           The conclusion of the foregoing exercise is that the performance of RLS-learning


61 The parameters impacting search capabilities in the innovation and imitation processes ( 1 and 2 ), are reduced from 0.3 to 0.05, and
the Beta distribution governing technological opportunities is modified from a Beta( 3,3) to a Beta( 2.7,3.3).
62 Compared to the baseline innovation regime, the low-innovation regime more than halves the growth rate in the economy, no matter

the expectation rule. Yet, the demand forecast errors of sophisticated firms only fall slightly (from 0.69 to 0.58 on average).
                                                                                                                                    30
expectations is improved if the economy is less subject to innovation shocks, and is thus more
predictable. The second experiment addresses the question: What happens instead if firms try to
check the relative accuracy of the heuristic and RLS-learning expectations, and if they account for
structural breaks when they select their forecasting rules?
           In what we call the choosing-RLS scenario, we allow firms to choose between the heuristic
and sophisticated expectation rules on the basis of the comparison of the ex-post squared errors (as
defined in eq.17) of the two rules in the previous period. We refer to this as case (a). We consider
two alternative rules: (case b) the agent chooses RLS so long as the ex-post squared errors of the
RLS rule is no greater than 20% higher than one of the heuristic rule; or (case c) chooses RLS unless
the ex-post squared errors of the RLS rule is more than twice the average ex-post squared error of
the heuristic rule (case c). Simulation results show that, not surprisingly, given a choice, agents
choose to follow heuristics most of the time. Indeed, for instance in case (a), firms decide not to
employ RLS 56% of the time, reducing the population of RLS-learning agents from 79% to 31%.63
As a consequence, the mean squared forecast error considerably contracts and the performance of
the economy improves (i.e. higher GDP growth, lower GDP volatility, unemployment rate and
likelihood of crises than in the ADA+RLS scenario; cf. Table 6, first three rows). In this particular
case, it turns out that what is individually rational is also collectively rational, but as we have noted,
this is not necessarily the case.64
           As RLS learning assumes a linear relationship between past and future individual
performance, it is inadequate if the relationship under study is characterized by sudden changes and
breaks (more on that in Hendry and Mizon, 2010). Thus in the structural-break scenario, we allow
firms to decide whether or not to use RLS expectations after performing a Chow test for structural
                                                                                 
breaks. More specifically, once a firm has accumulated enough past observations ( = 24), it
                                               
performs a Chow test, dividing the most recent  observations into two equal subsamples. If
the test rejects the null hypothesis of structural stability, the agent reverts to the heuristic rule. If no
structural break is found, it keeps on with RLS-learning expectations.
           We find that the Chow test does not accept the null hypothesis 25% of the times, resulting
in a lower share of sophisticated agents in the system (on average, 56% of firms perform RLS, against
79% when the Chow test was not present). As a consequence, when firms can choose to switch to
heuristics when they detect a structural break, the relative MSFE falls and all the macroeconomic
indicators improve (see the last row in Table 6). However, in such a case, even if firms can employ
sophisticated econometric procedures, and even when the use of RLS is endogenously determined,
the short- and long-run performance of the economy are still worse than when adaptive heuristic
rules prevail (see Table 6, and compare with the second row)!65


63 More detailed simulation results are available from the authors upon request.
64 As would be true in any model with macroeconomic externalities.
65 Notice that our analysis shows that there is no tight link between switching rules based on forecasting errors and the detection of

structural breaks.
                                                                                                                                         31
Expectation rules                                  Avg. GDP      GDP          Unemployment      Likelihood    Mean square.
                                                   growth        volatility   Rate              of crises     forecast error

Choosing-RLS experiment

Ratio wrt ADA+RLS
Direct comparison                       Case (a)   1.038**       0.641**      0.185**           0.284**       0.119**

ErrorRLS,t > 1.2 × Errorh,t             Case (b)   1.031**       0.634**      0.282**           0.272**       0.064**

ErrorRLS,t > 2 × Errorh                 Case (c)   1.020**       0.635**      0.677**           0.281**       0.429**

Structural break experiment

Ratio wrt to ADA
ADA+RLS and structural break test                  0.978**       1.021        1.974**           1.209*        3.517**

Ratio wrt ADA+RLS
ADA+RLS and structural break test                  1.014*        0.705**      0.565**           0.455**       0.448**



   Table 6. Effect of choosing between the heuristic and sophisticated rules. Ratio with respect to the ADA regime
   with RLS learning. Significant difference wrt. baseline at 1% level (**) and 5% level (*). Average over 50
   Monte-Carlo runs.


            Our findings, again, confirm that in an uncertain, complex world, characterized by frequent
   structural breaks, "less-is-more" procedures lead to more accurate forecasts and heuristic
   expectations are (ex post, and systemically) rational. Indeed, all this is quite in tune also with the
   results on organizational learning which, in turbulent environments, crucially involves learning by
   forgetting (Dosi et al., 2017).


            8 The properties of heuristic-driven decisions

            It is crucial to emphasize that in complex evolving worlds, even the analyst, as well as any
   agent with the same knowledge of the analyst, would not do any better than the heuristic agent.
   Consider the analyst who happens to be the constructor of the world, that is, us, the authors of the
   model: we know the true model and we can simulate it up to time  using relatively sophisticated
   models--as sophisticated as those typically used by econometricians. Are we able to predict what a
   state variable will be, say demand, of agent  at time  + 1, better than any heuristic agent? The
   answer is in general negative. Of course we would be very good at predicting the past ­ as Balzac
   once wrote ­ that is in fitting the data to the model, but probably poor in forecasting.
            To see this, recall that the model is a very high dimensional system: in its bare-bone structure,
   it has 1 + 2 firms, hit by endogenously-generated idiosyncratic shocks (capital-embodied
   productivity improvements) which affect the competitiveness of the firms via their unit costs, and
   through that, the dynamics of the market shares and survival probabilities. Therefore, the minimum
   dimensionality of the system is (1 + 2) ×  (i.e the number of control variables of each firm)
                                                                                                               32
×  (the system-level state variables). Furthermore, besides being high dimensional, the system is
also highly non-linear.
        First, micro technological shocks propagate in the economic system. Second, different
degrees of competitiveness introduce system-level correlations in the dynamics of firms' market
shares. Third, of course, there is yet another Keynesian system-level correlation, because the
individual demands are the market shares multiplied by the size of the whole market, but the latter
(endogenously) sums up over all employed workers multiplied by their wages. Fourth, pervasive
financial imperfections imply that firms can be constrained in their production and investment
decisions by the credit supply of banks, which endogenously evolve according to their equities,
possibly leading to emergent banking crises, leading to deep downturns. The emerging outcome is a
system which, at the level of the individual components ­ that is, the firms that make decisions ­ is
a combination between some complex non-linear dynamics and seemingly random walks. So
notionally, if we knew all the functions (including functional forms) and had a long enough history,
we might be able to infer parameter values (using non-linear estimators). However, it is the very
ontology of the worlds we are trying to model that prevents precisely this: "structural breaks" driven
by technological changes and by the ensuing changes in the competitiveness of individual firms occur
all the time. Hence, there is also no hope to observe long time series between two successive
structural breaks, even for the external analyst, let alone the individual agent. And the more complex
and non-linear the (actual and hypothesized) economic structure, the longer the required time series.
        Even in a stationary world, forming unbiased and accurate (low variance) estimates is
difficult. These well-known problems are exacerbated by the intrinsic non-stationarity and non-
linearity of the world as a whole, and especially in environments with complex interactions such as
explored here. We are not able to dissect non-linear deterministic and possibly chaotic processes vs.
the seemingly stochastic components. The very nature of the economy explored here is markedly
different from that where agents are assumed to have rational expectations (see Marcet and Sargent,
1989), presumably arrived at through some learning process. In the view presented here, the world
is too complex, and is changing too much, to be able to learn its fine structure, let alone its parameters.
In these cases, no accuracy/efforts trade-offs in information gathering/complexity of forecasting
appear: heuristics outperform RLS learning in forecasting because their forecast, while perhaps
"biased" as compared to those which an omniscient Laplacian God would make, nonetheless have a
lower variance than those which finite agents could make using seemingly sophisticated
econometrics, even, as we have seen, attempting to account for structural breaks. In this world, it
might be expected that quasi-rational agents would adopt some heuristics in forming expectations
and as the basis of decision making. Understanding the heuristics that agents use, and the systemic
properties of economies with interacting agents using such heuristics in the presence of deep
uncertainty then provides an alternative research agenda to that which has dominated
macroeconomics over the past forty years.

                                                                                                        33
        9 Concluding remarks

        In this work we have extended the Keynes+Schumpeter (K+S) family of models to account
for the impact of heterogeneous expectations and learning processes on the performance of the
economy. In particular, firms can forecast their future demand either by choosing among an ensemble
of different heuristics or via recursive least square estimations.
        Simulation results show that alternative heuristics, generating significantly different mean
squared forecast errors may not considerably affect macroeconomic performance. Furthermore,
when firms switch among heuristics based on performance, none of the heuristic rules disappear from
the market: the equilibrium entails an ecology of heuristics.
        However, when "sophisticated" firms are allowed to estimate their future demand via
recursive least squares, expectations do matter: Soros' reflexivity gains strength. And they matter for
the worse: their forecast errors increase significantly and the performance of the economy
significantly worsens as interdependencies amplify mistakes. Indeed, in models where agents are
allowed to select among heuristics vis-à-vis RLS-learning of expectations they overwhelmingly
"rationally" choose heuristics, and with fewer agents choosing RLS, the forecasts of individual
agents are more accurate - and the economic system performs better. The conclusion is that, at least
in models with high levels of non-linearity and complexity, heuristics should  be considered as
a second-best approximation, based on a trade-off of accuracy with effort in the presence of cognitive
limitations and biases. Instead, the less-is-more principle holds, and "[we] can rely on heuristics
because they are more accurate, not because they require less effort at the cost of some accuracy"
(Gigerenzer and Brighton, 2009, p. 135).
        Why does RLS learning fail in the model? We have suggested that the huge forecast errors
made by RLS-learning firms come from the fact that it is not possible to bend complex, non-linear
worlds into a linear representation. Our analysis provides a commentary on prevailing
macroeconomic analyses along two lines. First, concerning expectations: while earlier literature
(cited before in this paper) had questioned both the plausibility of the economy converging to a
rational expectations equilibrium, and the empirical relevance of the rational expectations
hypothesis, we have questioned the rationality of the rational expectations hypothesis. In the presence
of deep uncertainty, technical change and structural breaks, the best "evolutionary" response of firms
seem to be the adoption of heuristics. They are broadly consistent with loose notion of ecological
rationality in complex evolving economies ­though given the pervasive macroeconomic
externalities, almost surely the equilibrium proportions (when there is choice) which emerge are not
systematically optimal.
        We have suggested that the role of expectations may well have been overstated in
contemporary macroeconomic theory. For sure, expectations matter in influencing business cycle
                                                                                                    34
dynamics ­ in the real world and also in the model analyzed here. We have shown, however, that
similar dynamics may emerge under quite different expectations processes. The economy's dynamics
seems to be driven by other mechanisms, such as firms' heterogeneous innovation performance,
productivity dynamics and financial conditions. These interact with demand expectations to trigger
growth waves, avalanches of bankruptcies, as well as mild and deep recessions. 66 Rational
expectations seemingly provided a mechanism whereby agents plans could be coordinated and made
consistent with each other in the absence of a complete set of Arrow-Debreu state-contingent
markets. (In the Arrow-Debreu framework, nothing is assumed by rationality of expectations, or even
common knowledge.) Together with the representative agent model, the efficiency of the economy
could be assured.67
           While economic theory cast doubts about whether any results from that highly idealized
world had more general applicability (in particular, in worlds with heterogenous agents and non-
stationary processes), the hope was that nonetheless increased sophistication of agents would lead to
a world which might be well-approximated by a rational expectations model, restoring the faith in
the competitive market that had been undermined by the restrictive conditions that Arrow and Debreu
had shown had to be satisfied if markets were to be efficient. Our results cast further doubt on this
hypothesis and the more general relevance of RE models: simple and robust heuristics may not only
be better in terms of performance of individual agents and the economy as a whole, but turn out to
be also a source of predictability of behaviors (Heiner, 1983), and a "collective stabilizer", allowing
for easier coordination among heterogeneous interacting agents.
           There are different ways forward in this research path. We have explored the role of different
expectations behavior in a model which is able to exhibit many of the key macro- and macro- stylized
facts. There are undoubtedly other specifications that describe well at least some of these, and it
would be worthwhile to see if the findings here are reflected in other highly complex economic
systems in which there is fundamental uncertainty, e.g. as here, associated to the arrival of big
innovations. So too, we have shown that the problems we have identified do not disappear at least
with simple non-linear estimations, e.g. involving structural breaks. Whether the problems increase
or decrease as firms proceed to look for reasonable but still more sophisticated non-linear estimation
procedures is still an open question. If it were to turn out that plausible increases in complexity of
the estimation procedures by any single firm do not lead to significantly higher profitability, it would
suggest that it would not pay firms to continue to search for better estimation methodologies. There
are more profitable ways that the firm can employ its scarce resources. The economy might appear
"trapped" in an equilibrium in which firms are not as "rational" as they might be ­ there might be

66 Of course, even within a rational expectations framework, once one departs from the infinite-lived representative agent model with a
single homogenous fully flexible capital stock, with no financial constraints, one can generate complex dynamics that are markedly
different from the simple convergence exhibited in that model. Indeed, there is a large literature showing how variations in any one of
these dimensions (finite-lived individuals, multiple capital goods, putty-clay models, financial constraints) generate complex dynamics.
See, e.g. Cass and Stiglitz (1969) and Hirano and Stiglitz (2019).
67 Nothing, of course, was said about the stability of the system. It was simply assumed that somehow, the economy was always in

equilibrium.
                                                                                                                                    35
better estimation procedures to be discovered; but for the economy as a whole, this may be actually
a good thing, for as we have seen, systemic performance may be better with less sophisticated
estimation methodologies.68
           In practice, it should be obvious that there is not common knowledge: the most difficult
economic challenges relate to assessing the future course of economic organization, politics,
technology, and the underlying environment, about which there is never likely to be agreement, no
matter how much data we have available. Economic models should help us understand how
economies behave in such circumstances. To assume an economic framework in which none of these
challenges arise is likely to be at most of limited help. Here, we have constructed a model where the
underlying driver of technological change is sufficiently complex that it is not easily discoverable by
economic agents. The behavior of the economic system as a whole is, in turn, based on their
understandings of the workings of this complex system. The concerns we raise here are likely to
become even greater as we move towards an innovation economy, where the stochastic nature of the
innovation process itself becomes more central. At the very least, our analysis illuminates a central
aspect and insufficiently appreciated aspect of second-best economics: seemingly improving on
forecasting methodologies, using sophisticated econometrics, even working hard to identify
structural breaks, may well not improve the systemic performance of the economy.
           We also believe that our methodology may be able to contribute to the current debate about
the robustness of macroeconomic policy across different expectation frameworks and under different
hypotheses concerning the underlying economic structures.


 Acknowledgments
            We are grateful for helpful comments and discussions by Naman Garg, Gerd Gigerenzer, Roger Guesnerie,
Martin Guzman, Daniel Heymann, Cars Hommes, Seppo Honkapoja, Lenard Lieb, Haaris Manteen, Isabelle Salle, Rafael
Treibich, and several participants at seminars and conferences where the paper has been presented, including the Workshop
on Macroeconomic Coordination and Crises at Columbia Global Center, Paris, 12th November 2019; The Institute for New
Economic Thinking at the Oxford Martin School, 17th May 2017; Expectations in Dynamic Macroeconomic Models
Conference, Amsterdam, September 6th-8th, 2016; Bank of Canada, Ottawa, July 7th, 2016; International Schumpeter
Society Conference, MontrÃ©al, July 7th, 2016; Computing in Economics and Finance Conference, Bordeaux, June 27th,
2016; Istituto di Economia seminar, Pisa, February 23rd 2016; RIDGE Workshop on Macroeconomic Crises, Buenos Aires,
Dec 18th, 2015. All usual disclaimers apply. The authors gratefully acknowledge the financial support of the Horizon 2020
Framework Program of the European Union under grant agreement no 649186, ISIGrowth (Innovation-Fuelled,
Sustainable, Inclusive Growth), and the grant agreement No. 822781 ­ GROWINPRO (Growth, Welfare, Inoovation,
Productivity). Financial support from the Institute of New Economic Thinking is gratefully acknowledged.




68 It has long been known that rational expectations equilibrium are not in general (constrained) Pareto efficient (see Newbery and
Stiglitz, 1982). Accordingly, it is not that much of a surprise that deviations from RE might be welfare enhancing.
                                                                                                                                      36
References

Acemoglu, D., P. Aghion, L. Bursztyn, and D. Hemous (2012). The environment and directed technical change.
American Economic Review 102(1), 131­66.

Acemoglu, D. and V. Guerrieri (2008). Capital deepening and nonbalanced economic growth. Journal of Political
Economy 116(3), 467­498.

Adrian, T. and H. Shin (2010). Financial intermediaries and monetary economics. Staff Reports 98, Federal Reserve
Bank of New York.

Akerlof, G. A. (2002). Behavioral macroeconomics and macroeconomic behavior. American Economic Review 92, 411-
433.

Alpaydin, E. (2004). Introduction to Machine Learning. Cambridge MA, MIT Press.

Anufriev, M. and C. Hommes (2012). Evolutionary selection of individual expectations and aggregate outcomes
in asset pricing experiments. American Economic Journal: Microeconomics 4(4), 35 ­64.

Anufriev, M., C. Hommes, and R. Philipse (2013). Evolutionary selection of expectations in positive and negative
feedback markets. Journal of Evolutionary Economics 23(3), 663 ­688.

Ascari, G., G. Fagiolo, and A. Roventini (2015). Fat-tail distributions and business-cycle models. Macroeconomic
Dynamics 19, 465­476.

Ashraf, Q., B. Gershman, and P. Howitt (2017). Banks, market organization, and macroeconomic performance: an agent-
based computational analysis. Journal of Economic Behavior & Organization 135, 143 ­ 180.

Assenza, T., T. Bao, C. Hommes, and D. Massaro (2014). Experiments on expectations in macroeconomics and finance,
pp. 11­70. Emerald Group Publishing Limited.

Assenza, T., P. Heemeijer, C. Hommes, and D. Massaro (2014). Managing self-organization of expectations through
monetary policy: A macro experiment. Working Paper 14 ­07, CeNDEF, University of Amsterdam.

Ausloos, M., J. Miskiewicz, and M. Sanglier (2004). The durations of recession and prosperity: Does their distribution
follow a power or an exponential law? Physica A: Statistical Mechanics and its Applications 339, 548 ­558.

Bartelsman, E. and M. Doms (2000). Understanding productivity: Lessons from longitudinal microdata. Journal of
Economic Literature 38, 569­94.

Becker, B. and V. Ivashina (2014). Cyclicality of credit supply: Firm level evidence. Journal of Monetary Economics 62,
76­93.

Benhabib, J. and R. E. A. Farmer (1999). Indeterminacy and sunspots in macroeconomics. In J. Taylor and
M. Woodford (Eds.), Handbook of Macroeconomics. Elsevier Science: Amsterdam.

Bikker, J. and P. Metzemakers (2005). Bank provisioning behaviour and procyclicality. International Financial Markets,
Institutions and Money 15(2), 141­157.

Bottazzi, G. and A. Secchi (2003). Common properties and sectoral specificities in the dynamics of U.S. manufacturing
firms. Review of Industrial Organization 23, 217­32.

Bottazzi, G. and A. Secchi (2006). Explaining the distribution of firm growth rates. RAND Journal of Economics 37,
235­256.

Box, G. and J. Jenkins (1976). Time Series Analysis: Forecasting and Control. Holden-Day, San Francisco, CA. Bray, M.
(1982). Learning, estimation and the stability of rational expectations. Journal of Economic Theory 26,
318­339.

Bray, M. and D. Kreps (1987). Rational learning and rational expectations. In Arrow and the Ascent of Modern
Economic Theory, pp. 597­625. Springer.

Brock, W. and C. Hommes (1997). A rational route to randomness. Econometrica, 1059 ­1095. Brown, T. (1838).
                                                                                                                         37
Lectures on the Philosophy of the Human Mind. William Tait.

Burns, A. and W. Mitchell (1946). Measuring Business Cycles. NBER: New York.

Carroll, C. (2003). Macroeconomic expectations of households and professional forecasters. The Quarterly Journal of
Economics 118, 269­298.

Cass, David and J. E. Stiglitz (1969). The Implications of Alternative Saving and Expectations Hypotheses for Choices
of Technique and Patterns of Growth, Journal of Political Economy, 77, July-August, pp. 586-627

Castaldi, C. and G. Dosi (2009). The patterns of output growth of firms and countries: Scale invariances and scale
specificities. Empirical Economics 37, 475 ­495.

Caves, R. (1998). Industrial organization and new findings on the turnover and mobility of firms. Journal of Economic
Literature 36, 1947­1982.

Coibion, O. and Y. Gorodnichenko (2012). What can survey forecasts tell us about information rigidities? Journal of
Political Economy 120, 116­159.

Coibion, O. and Y. Gorodnichenko (2015). Information rigidity and the expectations formation process: A simple
framework and new facts. American Economic Review 105, 2644­2678.

Coibion, O., Y. Gorodnichenko, and S. Kumar (2015). How do firms form their expectations? New survey evidence.
NBER Working Paper 21092, National Bureau of Economic Research.

Colasante, A., A. Palestrini, A. Russo, and M. Gallegati (2015). Adaptive expectations with correction bias: Evidence
from the lab. Quaderni di Ricerca 409, Universita' Politecnica delle Marche, Dipartimento di Scienze Economiche e
Sociali.

Cyert, R. and J. March (1992). A Behavioral Theory of the Firm. Blackwell Business: Oxford.

Dávila, Eduardo, and Anton Korinek. "Pecuniary externalities in economies with financial frictions." The Review of
Economic Studies 85, No. 1 (2017): 352-395

Dawid, H. and D. Delli Gatti (2018). Agent-based macroeconomics. Handbook of Computational Economics 4, 63­156.

Delli Gatti, D., M. Gallegati, B. Greenwald, A. Russo, and J. Stiglitz (2010). The financial accelerator in an evolving
credit network. Journal of Economic Dynamics and Control 34, 1627 ­1650.

Di Guilmi, C., M. Gallegati, and P. Ormerod (2004). Scaling invariant distributions of firms' exit in OECD countries.
Physica A: Statistical and Theoretical Physics 334, 267 ­273.

Dilaver, O., R. Jump, and P. Levine (2018). Agent-based macroeconomics and dynamic stochastic general equilibrium
models: Where do we go from here? Journal of Economic Surveys, 32, 1134-1159.

Doms, M. and T. Dunne (1998). Capital adjustment patterns in manufacturing plants. Review Economic Dynamics 1,
409­29.

Dosi, G. (2007). Statistical regularities in the evolution of industries. A guide through some evidence and challenges for
the theory. In F. Malerba and S. Brusoni (Eds.), Perspectives on Innovation. Cambridge MA, Cambridge University
Press.

Dosi, G. (2012). Economic coordination and dynamics: Some elements of an alternative `evolutionary' paradigm. In
Economic Organization, Industrial Dynamics and Development, Selected Essays, Vol. 2. Edward Elgar Publishing,
Cheltenham, UK, Northampton, MA, USA.

Dosi, G. and M. Egidi (1991). Substantive and procedural uncertainty: An exploration of economic behaviours in
changing environments. Journal of Evolutionary Economics 1, 145­68.

Dosi, G., G. Fagiolo, M. Napoletano, and A. Roventini (2013). Income distribution, credit and fiscal policies in an agent-
based Keynesian model. Journal of Economic Dynamics and Control 37, 1598 ­1625.

Dosi, G., G. Fagiolo, M. Napoletano, A. Roventini, and T. Treibich (2015). Fiscal and monetary policies in complex
evolving economies. Journal of Economic Dynamics and Control 52, 166­189.

                                                                                                                          38
Dosi, G., G. Fagiolo, and A. Roventini (2006). An evolutionary model of endogenous business cycles.
Computational Economics 27, 3­34.

Dosi, G., G. Fagiolo, and A. Roventini (2010). Schumpeter meeting Keynes, a policy-friendly model of endogenous
growth and business cycles. Journal of Economic Dynamics and Control 34, 1748 ­1767.

Dosi, G., L. Marengo, E. Paraskevopoulou, and M. Valente (2017). A model of cognitive and operational memory of
organizations in changing worlds. Cambridge Journal of Economics 41, 775­806.

Dosi, G., M. Napoletano, A. Roventini, and T. Treibich (2016). The short- and long-run damages of fiscal austerity:
Keynes beyond Schumpeter. In J. Stiglitz and M. Guzman (Eds.), Contemporary Issues in Macroeconomics. Palgrave
Macmillan UK.

Dosi, G., M. Napoletano, A. Roventini, and T. Treibich (2017). Micro and macro policies in the Keynes+Schumpeter
evolutionary models. Journal of Evolutionary Economics, 63­90.

Dosi, G., M. Pereira, A. Roventini, and M. E. Virgillito (2017a). The effects of labour market reforms upon
unemployment and income inequalities: An agent-based model. Socio-Economic Review, 16, 687-720.

Dosi, G., M. Pereira, A. Roventini, and M. E. Virgillito (2017b). When more flexibility yields more fragility: The
microfoundations of keynesian aggregate unemployment. Journal of Economic Dynamics and Control 81, 162 ­186.

Evans, G. and S. Honkapohja (1999). Learning dynamics. Handbook of Macroeconomics 1, 449­542.

Evans, G. and S. Honkapohja (2001). Learning and Expectations in Macroeconomics. Princeton, NJ, Princeton
University Press.

Fagiolo, G., M. Napoletano, and A. Roventini (2008). Are output growth-rate distributions fat-tailed? Some evidence
from OECD countries. Journal of Applied Econometrics 23, 639­669.

Fagiolo, G. and A. Roventini (2012). Macroeconomic policy in agent-based and DSGE models. Revue de l'OFCE 124,
67­116.

Fagiolo, G. and A. Roventini (2016). Macroeconomic policy in DSGE and agent-based models redux: New developments
and challenges ahead. Journal of Artificial Societies and Social Simulation 20(1).

Farmer, J. D. and D. Foley (2009). The economy needs agent-based modelling. Nature 460, 685­686.

Foos, D., L. Norden, and M. Weber (2010). Loan growth and riskiness of banks. Journal of Banking and Finance 34,
2929­2940.

Forni, M. and M. Lippi (1997). Aggregation and the microfoundations of dynamic macroeconomics. Oxford, Oxford
University Press.

Forni, M. and M. Lippi (1999, February). Aggregation of linear dynamic microeconomic models. Journal of
Mathematical Economics 31, 131­158.

Geman, S., E. Bienenstock, and D. R. (1992). Neural networks and the Bias ­Variance dilemma. Neural Computation 4,
1­58.

Gennaioli, N., Y. Ma, and A. Shleifer (2016). Expectations and investment. NBER Macroeconomics Annual 30, 379­
431.

Gigerenzer, G. (2015). Risk savvy: How to make good decisions. Penguin.

Gigerenzer, G. and H. Brighton (2009). Homo heuristicus: Why biased minds make better inferences. Topics in
Cognitive Science 1, 107­143.

Gigerenzer, G. and W. Gaissmaier (2011). Heuristic decision making. Annual Review of Psychology 62, 451 ­482.

Gigerenzer, G. and P. Todd (1999). Simple Heuristics That Make Us Smart. Oxford University Press.

Godley, W. and M. Lavoie (2007). Monetary Economics: An Integrated Approach to Credit, Money, Income, Production

                                                                                                                      39
and Wealth. Palgrave Macmillan, Basingstoke, UK.

Greenwald, B. and J. Stiglitz (1986, May). Externalities in economies with imperfect information and incomplete
markets. The Quarterly Journal of Economics 101(2), 229 ­264.

Greenwald, B. and J. Stiglitz (1988). Pareto inefficiency of market economies: Search and efficiency wage models.
Working Paper 2651, National Bureau of Economic Research.

Greenwald, B. and J. Stiglitz (1993). Financial market imperfections and business cycles. Quarterly Journal of
Economics 108, 77­114.

Greenwald, B. and J. Stiglitz (2003). Macroeconomic fluctuations in an economy of phelps-winter markets. In
P. Aghion, R. Frydman, J. Stiglitz, and M. Woodford (Eds.), Knowledge, Information, and Expectations in Modern
Macroeconomics: In Honor of Edmund S. Phelps. Princeton, NJ, Princeton University Press.

Guzm´an, G. (2012). Sexonomics: Gender, wealth, and expectations in financial markets. Journal of Economic and
Social Measurement 37, 1­60.

Haldane, A. (2012). The dog and the frisbee. Central bankers' speeches, BIS.

Haldane, A. G. and A. E. Turrell (2019, Mar). Drawing on different disciplines: macroeconomic agent-based models.
Journal of Evolutionary Economics.

Haltiwanger, J. and M. Waldman (1985). Rational expectations and the limits of rationality: An analysis of heterogeneity.
American Economic Review 75, 326­340.

Hastie, T., R. Tibshirani, and J. Friedman (2001). The Elements of Statistical Learning: Data Mining, Inference, and
Prediction. Springer: New York.

Heemeijer, P., C. Hommes, J. Sonnemans, and J. Tuinstra (2009). Price stability and volatility in markets with positive
and negative expectations feedback: An experimental investigation. Journal of Economic Dynamics and Control 33,
1052­1072.

Heiner, R. (1983). The origin of predictable behavior. American Economic Review 73, 560 ­595.

Hendry, D., and M. Clements, (2019). Forecasting: an essential introduction. Yale University Press.

Hendry, D. and G. Mizon (2010). On the mathematical basis of inter-temporal optimization. Discussion Paper 497,
University of Oxford Department of Economics.

Hommes, C. (2011). The heterogeneous expectations hypothesis: Some evidence from the lab. Journal of Economic
Dynamics and Control 35(1), 1­24.

Hirano, Tomohiro and Joseph E. Stiglitz (2019) The Wobbly Economy, Columbia University, December

Howitt, P. (1992). Interest rate control and nonconvergence to rational expectations. Journal of Political Economy 100,
776­800.

Hubbard, G. R. (1998). Capital-market imperfections and investment. Journal of Economic Literature 36, 193 ­225.

Jaimovich, N. and M. Floetotto (2008). Firm dynamics, markup variations, and the business cycle. Journal of Monetary
Economics 55, 1238­1252.

Jeanne, Olivier, and Anton Korinek. "Managing credit booms and busts: A Pigouvian taxation approach." Journal of
Monetary Economics (2018).

Kahneman, D. (2003). Maps of bounded rationality: Psychology for behavioral economics. American Economic Review
93, 1449­1475.

Kaldor, N. (1955). Alternative theories of distribution. The Review of Economic Studies, 83 ­100.


Kaplan, G., B. Moll, and G. Violante (2018). Monetary policy according to hank. American Economic Review
108(3), 697­743.

                                                                                                                          40
Keynes, J. M. (1936). The General Theory of Employment, Interest, and Money. New York, Prometheus Books. Keynes,
J. M. (1937). The general theory of employment. The Quarterly Journal of Economics 51(2), 209 ­223. Kirman, A. P.
(1992). Whom or what does the representative individual represent? Journal of Economic
Perspectives 6, 117­136.

Kirman, A. P. (2010). Complex Economics. Individual and Collective Rationality. Routledge: London. Kirman, A. P.
(2014). Is it rational to have rational expectations? Mind & Society 13, 29­48.

Kirman, A. P. (2016). Ants and nonoptimal self-organization: Lessons for macroeconomics. Macroeconomic Dynamics
20, 601­621.

Knight, F. (1921). Risk, Uncertainty, and Profits. Chicago, Chicago University Press.

Korinek, Anton. "Regulating capital flows to emerging markets: An externality view." Journal of International
Economics 111 (2018): 61-80.

Kuznets, S. and J. Murphy (1966). Modern Economic Growth: Rate, Structure, and Spread. Yale University Press New
Haven.

Laeven, L. and F. Valencia (2008). Systemic banking crises: A new database. Working Paper WP/08/224, International
Monetary Fund.

Leary, M. (2009). Bank loan supply, lender choice, and corporate capital structure. The Journal of Finance 64(3), 1143 ­
1185.

LeBaron, B. and L. Tesfatsion (2008). Modeling macroeconomies as open-ended dynamic systems of interacting agents.
American Economic Review 98, 246­250.

Lown, C. and D. Morgan (2006). The credit cycle and the business cycle: New findings using the loan officer opinion
survey. Journal of Money, Credit, and Banking 38, 1575­1597.

Luan, S., J. Reb, and G. Gigerenzer (2019). Ecological rationality: Fast-and-frugal heuristics for managerial decision
making under uncertainty. Academy of Management Journal (31 January).

Lucas, R. E. and E. C. Prescott (1971). Investment under uncertainty. Econometrica 39, 659.

Machina, M. J. (1982). "expected utility" analysis without the independence axiom. Econometrica 50, 277­323. Mankiw,
G. N. and R. Reis (2002). Sticky information versus sticky prices: A proposal to replace the New Keynesian Phillips
curve. The Quarterly Journal of Economics, 1295­1328.

Marcet, A. and T. Sargent (1989). Convergence of least squares learning mechanisms in self-referential linear stochastic
models. Journal of Economic Theory 48, 337­368.

March, J. G. and H. A. Simon (1993). Organizations revisited. Industrial and Corporate Change 2, 299 ­316. McLeay, M.,
R. Amar, and T. Ryland (2014). Money creation in the modern economy. Bank of England Quarterly Bulletin 54, 14­27.

Mendoza, E. and M. Terrones (2014). An anatomy of credit booms and their demise. In M. Fuentes, C. Raddatz, and C.
Reinhart (Eds.), Capital Mobility and Monetary Policy. Central Bank of Chile, Volume 18.

Muth, J. F. (1961). Rational expectations and the theory of price movements. Econometrica 29, 315­335.

Napoletano, M., A. Roventini, and S. Sapio (2006). Are business cycles all alike? A bandpass filter analysis of the Italian
and U.S. cycles. Rivista Italiana degli Economisti 1, 87­118.

Neary, J. and J. Stiglitz (1983). Toward a reconstruction of Keynesian economics: Expectations and constrained
equilibria. The Quarterly Journal of Economics 98, 199­228.

Nelson, R. and S. Winter (1982). An Evolutionary Theory of Economic Change. The Belknap Press of Harvard
University Press: Cambridge, MA.

Newbery, D. and J. Stiglitz (1982). The choice of techniques and the optimality of market equilibrium with rational
expectations. Journal of Political Economy 90, 223­246.


                                                                                                                         41
Phelps, E. S. and S. G. Winter (1970). Optimal price policy under atomistic competition. In E. S. Phelps (Ed.),
Microeconomic Foundations of Employment and Inflation Theory. New York, Norton.

Popoyan, L., M. Napoletano, and A. Roventini (2017). Taming macroeconomic instability: Monetary and macro
prudential policy interactions in an agent-based model. Journal of Economic Behavior & Organization 134, 117 ­ 140.

Raberto, M., A. Teglio, and S. Cincotti (2012). Debt, deleveraging and business cycles: An agent-based perspective.
Economics-The Open-Access, Open-Assessment E-Journal 6, 2011­2031.

Reinhart, C. and K. Rogoff (2009). The aftermath of financial crises. American Economic Review 99, 466 ­472. Reinhart,
C. and K. Rogoff (2013). Banking crises: An equal opportunity menace. Journal of Banking & Finance 37, 4557­4573.

Rossi, B., T. Sekhposyan, and M. Soupre (2016). Understanding the Sources of Macroeconomic Uncertainty.
Working Papers 920, Barcelona Graduate School of Economics.

Rotemberg, J. (2008). Behavioral aspects of price setting, and their policy implications. NBER Working Paper 13754,
National Bureau of Economic Research.

Salle, I. (2015). Modeling Expectations in Agent-Based Models -- An Application to Central Bank's Communication
and Monetary Policy. Economic Modelling 46, 130­141.

Savage, L. J. (1972). The Foundations of Statistics. Courier Corporation: North Chelmsford USA.

Schweitzer, M. and G. Cachon (2000). Decision bias in the newsvendor problem with a known demand distribution:
Experimental evidence. Management Science 46, 404 ­420.

Simon, H. A. (1955). A behavioral model of rational choice. The Quarterly Journal of Economics 69, 99 ­118. Sims, C.
A. (1980). Macroeconomics and reality. Econometrica 48(1), 1 ­48.

Sims, C. A. (2003). Implications of rational inattention. Journal of Monetary Economics 50, 665 ­690.

Sinitskaya, E. and L. Tesfatsion (2015). Macroeconomies as Constructively Rational Games. Journal of Economic
Dynamics and Control 61, 152­182.

Solow, R. M. (2008). The state of macroeconomics. Journal of Economic Perspectives 22, 243 ­246.

Soros, G. (2013). Fallibility, reflexivity, and the human uncertainty principle. Journal of Economic Methodology 20,
309­329.

Stiglitz, J. (2015). Towards a general theory of deep downturns. Working Paper 21444, National Bureau of Economic
Research.

Stiglitz, J. and B. Greenwald (2003). Towards a New Paradigm in Monetary Economics. Cambridge : Cambridge
University Press.

Stiglitz, J. and A. Weiss (1981). Credit rationing in markets with imperfect information. American Economic Review 71,
393­410.

Stiglitz, J. E. (2011). Rethinking macroeconomics: What failed, and how to repair it. Journal of the European Economic
Association 9, 591­645.

Stiglitz, J. E. (2018). Where modern macroeconomics went wrong. Oxford Review of Economic Policy 34(1-2), 70­106.

Stock, J. and M. Watson (1999). Business cycle fluctuations in U.S. macroeconomic time series. In J. Taylor and
M. Woodford (Eds.), Handbook of Macroeconomics, pp. 3­64. Elsevier.

Taylor, J. (1993). Discretion versus policy rules in practice. Carnegie-Rochester Series on Public Policy 39, 195­214.

Terborgh, G. (1949). Dynamic Equipment Policy. McGraw-Hill, New York.

Tesfatsion, L. and K. L. Judd (Eds.) (2006). Handbook of Computational Economics, Volume 2: Agent-based
Computational Economics. North-Holland.

Todd, P. M. and G. E. Gigerenzer (2012). Ecological rationality: Intelligence in the world. Oxford University Press.

                                                                                                                         42
Tversky, A. and D. Kahneman (1974). Judgment under uncertainty: Heuristics and biases. Science 185(4157), 1124 ­
1131.

Walde, K. and U. Woitek (2004). R&D expenditure in G7 countries and the implications for endogenous fluctuations and
growth. Economic Letters 82, 91­97.

Weitzman, M. L. (2009). On modeling and interpreting the economics of catastrophic climate change. The Review of
Economics and Statistics 91(1), 1­19.

Wolff, E. N. (1998). Recent trends in the size distribution of household wealth. Journal of Economic Perspectives 12,
131­150.

Woodford, M. (1990). Learning to believe in sunspots. Econometrica 58, 277 ­307.

Woodford, M. (2003). Imperfect common knowledge and the effects of monetary policy. In P. Aghion, R. Frydman,
J. Stiglitz, and M. Woodford (Eds.), Knowledge, Information, and Expectations in Modern Macroeconomics: In Honor of
Edmund S. Phelps. Princeton, NJ, Princeton University Press.

Wright, I. (2005). The duration of recessions follows an exponential not a power law. Physica A: Statistical Mechanics
and its Applications 345, 608­610.

Zarnowitz, V. (1985). Recent works on business cycles in historical perspectives: A review of theories and evidence.
Journal of Economic Literature 23, 523­80.




                                                                                                                         43
     Appendix


                              Description                                                    Symbol       Value

                              Benchmark parameters
                              Montecarlo replications                                          MC            50
                              Time sample                                                       T           600
                              Number of firms in capital-good industry                          F1           50
                              Number of firms in consumption-good industry                      F2          200
                              Number of banks                                                   B            10
                              Capital-good firms' mark-up                                       µ1         0.04
                              Consumption-good firm initial mark-up                             µ0         0.20
                              Banks deposits interest rate mark-up                             rD             1
                              Banks reserve interest rate mark-up                              µres         0.33
                              Bond interest rate mark-up                                      µbonds         0
                              Loan interest rate mark-up                                       µdeb        0.30
                              Bank capital adequacy rate                                        b          0.08
                              Wage setting AB weight                                            1            1
                              Wage setting cpi weight                                           2          0.05
                              Wage setting U weight                                             3          0.05
                              Shape parameter of bank client distribution                    paretoa       0.08
                              Desired inventories                                                          0.10
                              Beta distribution parameters (innovation process)              (1, 1)        (3,3)
                              Firm search capabilities parameters                              1,2         0.30

                              Policy parameters
                              Inflation adjustment parameter ( TR)                                        1.10
                              Target interest rate                                              rT        0.025
                              Target inflation rate                                             T         0.02
                              Tax rate                                                          tr        0.10
                              Unemployment subsidy rate                                                   0.40

                              Expectation parameters
                              ADA adjustment                                                   wada        0.65
                              WTR adjustment                                                   wwtr         0.4
                              STR adjustment                                                   wstr         1.3
                              LAA adjustment                                                   waa          0.5
                              Memory parameter                                                              0.7
                              Intensity of choice                                                           0.4
                              Inertia parameter                                                             0.9

                                                   Table A1. Parameters


            Determination of market shares


            Market shares are positively associated with consumption-good firms' competitiveness ( ), which
reflects both their price and their amount of unfilled demand ( ) as inherited from the previous period:69




69   We normalize the price and the level of unfilled demand according to the industry average to make them comparable.

                                                                                                                          44
                                                         () = - () -  (),                           (19)
 where the unfilled demand  () is the difference between actual demand and production of the period. A

firm's market share is then driven by its relative competitiveness compared to the weighted average (),70
following a "quasi" replicator dynamics:


                                                                                    ()-()
                                                 () = 
                                                       ( - 1) (1 -                    ()
                                                                                              ).    (20)

 For our base case, we set  = 1.




                                                                           2
70   It is computed using the market shares of the previous period: () =         () ( - 1).
                                                                           =1


                                                                                                      45
