                             NBER WORKING PAPER SERIES




      NONLINEAR PRODUCTION NETWORKS WITH AN APPLICATION TO THE
                           COVID-19 CRISIS

                                       David Baqaee
                                      Emmanuel Farhi

                                     Working Paper 27281
                             http://www.nber.org/papers/w27281


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                    May 2020




We thank Veronica De Falco, Sihwan Yang, and Stephanie Kestelman for excellent research
assistance. We thank Natalie Bau for her comments. The views expressed herein are those of the
authors and do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2020 by David Baqaee and Emmanuel Farhi. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Nonlinear Production Networks with an Application to the Covid-19 Crisis
David Baqaee and Emmanuel Farhi
NBER Working Paper No. 27281
May 2020
JEL No. E0,E1,E2,E30

                                          ABSTRACT

We study the effects of negative supply shocks and shocks to the composition of final demand on
aggregate output in a disaggregated neoclassical model with multiple sectors, factors, and input-
output linkages. We show how nonlinearities associated with complementarities in consumption
and production amplify the effect of negative supply shocks by creating supply bottlenecks and
disrupting supply chain networks. These nonlinearities are particularly potent when the shocks
are more heterogeneous as the worst-affected sectors drag down the other sectors. Nonlinearities
are strengthened when changes in preferences lead households to tilt the composition of their
demand towards the crippled sectors directly and indirectly through their supply chains. And
nonlinearities are further intensified when factors cannot easily be reallocated across sectors to
reinforce weak links. A quantitative investigation suggests that nonlinearities may amplify the
impact of the Covid-19 shock by between 10\%-100\%, depending on the horizon of analysis and
the exact size of the shocks.


David Baqaee
Department of Economics
University of California at Los Angeles
Bunche Hall
Los Angeles, CA 90095
and CEPR
and also NBER
baqaee@econ.ucla.edu

Emmanuel Farhi
Harvard University
Department of Economics
Littauer Center
Cambridge, MA 02138
and CEPR
and also NBER
emmanuel.farhi@gmail.com
1     Introduction
The outbreak of the Covid-19 pandemic has focused the world’s attention on nonlineari-
ties. Thousands of pages have been written about the importance of slowing the spread
of the disease, an effort dubbed flattening the curve, in order to avoid overwhelming the
healthcare system. In this paper, we focus on a different kind of nonlinearity: the nonlin-
ear response of aggregate output to the variety of supply and demand shocks that came
with the pandemic. That is, we focus on how these shocks interact and how their effects
are amplified at the macro level. Much like the spread of the disease itself, understanding
the disease’s effect on the macroeconomy also requires grappling with nonlinearities.
    We use a general disaggregated model and aggregate up. We allow for an arbitrary
number of sectors and factors as well as arbitrary input-output linkages and elasticities
of substitution in production and in consumption. We analyze how the various micro
shocks induced by the pandemic affect macro aggregates such as output and welfare. The
nonlinear responses of these macro aggregates are shaped by the disaggregated structure
of the economy.
    We model the outbreak of the pandemic as a combination of exogenous shocks to
the quantity of factors supplied, the productivity of producers, and the composition of
final demand by consumers across sectors. One the one hand, the epidemic reduces the
quantity of factors available, as workers withdraw from the labor force due to lock-downs
or a reduced willingness to work. On the other hand, the epidemic reduces productivity
of firms by forcing them to change their production plans. Finally, the epidemic changes
the composition of final demand across goods and sectors as households rebalance their
expenditures even in the absence of price changes because their preferences have changed
or because regulations have been introduced.1
    To frame the discussion, we rely on Hulten’s theorem (Hulten, 1978). The theorem
says that to a first-order approximation, the response of real GDP ∆ log Y to productivity
shocks ∆ log Ai , factor supply shocks ∆ log L f , and shocks to the composition of final
demand is
                           ∆ log Y ≈ ∑ λi ∆ log Ai + ∑ λ f ∆ log L f ,
                                          i                  f

where λi is the sales of producer i as a share of GDP and λ f is the income of factor f as a
    1 Althoughwe take the shocks to be exogenous, we recognize that the shocks themselves can be endoge-
nous responses in a larger model. For instance, labor supplied may be falling due to nominal rigidities or
productivity may be falling due to firm exits. In fact, in a companion paper, Baqaee and Farhi (2020), we
study these endogenous mechanisms. However, conditional on the quantity of each factor supplied, the
productivity of each producer, and the composition of final demand, aggregate output is pinned down, and
we study the nonlinearities in the resulting mapping from shocks to aggregate output.


                                                    2
share of GDP. In other words, to a log-linearized first-order approximation, the change in
real GDP is the sales-share weighted sum of supply shocks. This macro envelope theorem
has surprising implications. It says that to a first-order, changes in the composition of
demand have no effect on real GDP. It also says that to a first-order, the disaggregated
structure of the economy matters only through the initial sales and factor shares.
    These serendipities disappear when we go beyond the first order to capture nonlin-
earities. Building on some earlier work in Baqaee and Farhi (2019b), we generalize this
aggregation equation to higher orders. We show that nonlinearities depend on equilib-
rium changes in sales and factor shares in response to the shocks. We also characterize the
equilibrium changes in sales and factor shares by means of propagation equations. These
propagation equations depend on all the shocks, including the shocks to the composition
of final demand.2 They also depend on the disaggregated structure of the economy such
as the elasticities of substitution in production and in consumption and the input-output
matrix.
    We emphasize two key implications. First, nonlinearities amplify negative supply
shocks if these shocks are heterogenous and if sectors are complements throughout the
input-output network, since then the worst-affected sectors become supply bottlenecks
that drag the rest down with them. These complementarities are more important for tran-
sitory shocks such as the pandemic, as firms and households find it harder to substitute
their production and consumption plans on short notice.
    Second, nonlinearities amplify negative supply shocks if these shocks come together
with shocks to the composition of final demand that shift final demand towards the worst-
affected sectors, directly and indirectly through their supply chains. Changes in final de-
mand are likely to be important during the pandemic. For instance, in the US, just as
household preferences shifted towards consumption of more meat from grocery stores,
some major meat-packing plants closed due to the pandemic. Or in France, just as house-
holds switched to more online shopping, Amazon was ordered to shutdown many of
its warehouses to protect its workers. Of course, sometimes, changes in final demand
could also mitigate the macro impact of the negative supply shocks, for example, when
households’ preferences move away from restaurants at the same time as the supply of
restaurant meals goes down.
   2 Stability of final demand or preferences is an almost universal assumption in macroeconomics, particu-
larly in the theory of aggregation. However, the Covid-19 crisis very likely changed household preferences,
and so modelling these changes in final demand is essential. We define and characterize both real GDP
and changes in welfare in this context. When final demand is unstable, real GDP acquires some very ex-
otic (path-dependent) properties. One of the novel theoretical contributions of this paper is to tackle the
problem of unstable final demand.



                                                    3
    We quantify the importance of nonlinearities using disaggregated data from the U.S.
The shocks are large and heterogeneough enough that nonlinearities can amplify the im-
pact of the shocks by 10% − 100% depending on the horizon of analysis and the size of
the underlying shocks.
    We also extend our baseline analysis by studying cases where factor supplies are en-
dogenous. In particular, we analyze the value of reallocating factors across the different
sectors. Reallocations can tame nonlinearities and mitigate the negative impact of the
shocks by reinforcing weak links.3 We also characterize the response of aggregate output
in situations where the supply of labor and amount of capital utilization vary endoge-
nously in response to changes in factor rewards. These extensions are important to assess
the tradeoffs in the policy response to the crisis, such as the extension of unemployment
insurance or the provision of business loans contingent on the preservation of payrolls.
    The outline of the paper is as follows. In Section 2, we define the environment and set
up the model. In Section 3, we state the basic comparative statics (for GDP and disaggre-
gated sales and prices), and work through some illustrative examples. In Section 4, we
extend the basic model to allow for endogenous factor supply and factor reallocation. In
Section 6, we perform some preliminary quantitative exercises to gauge the importance
of nonlinearities. We conclude in Section 7.


Related Literature
First, and foremost, the paper is part of the literature on economic effects of the Covid-
19 crisis. In particular, this paper is related to Barrot et al. (2020) who study the effect
of Covid-19 using a quantitative production network. Our approach differs from theirs
since we focus on analytical characterizations and a different set of thought experiments.
This paper is also related Bodenstein et al. (2020), who analyze optimal shutdown policies
in a two-sector model. Once again, our approach differs since we focus on positive rather
than normative questions. Bonadio et al. (2020) analyze the effects of Covid-19 in an
open-economy context.
     Other economics papers studying the effects of Covid-19 include Eichenbaum et al.
(2020a,b), Dingel and Neiman (2020), Mongey et al. (2020), Berger et al. (2020), Alvarez et
al. (2020), Atkeson (2020a,b), Bethune and Korinek (2020), Guerrieri et al. (2020), Bigio et
al. (2020), Caballero and Simsek (2020), Faria-e Castro (2020), Gourinchas (2020), Jones et
al. (2020), Jorda et al. (2020), Kaplan et al. (2020), Krueger et al. (2020), Jorda et al. (2020),
Bodenstein et al. (2020), Barrot et al. (2020), Barro et al. (2020), Fernández-Villaverde and
  3 See   e.g. Jones (2011) and Baqaee and Farhi (2019b).


                                                      4
Jones (n.d.), Hall et al. (2020), Glover et al. (2020), Fornaro and Wolf (2020), Acemoglu et
al. (2020), Cakmakli et al. (2020), and Gourinchas et al. (2020).
     This paper is also related to previous work by the authors. In particular, the pa-
per builds on the analysis of nonlinearities in production networks in Baqaee and Farhi
(2019b). We extend the analysis in that paper by studying real GDP and welfare in en-
vironments with unstable final demand, provide additional analytical characterizations,
and extend that analysis to cover endogenous factor supply and reallocation. Of course,
our quantitative application to the Covid-19 crisis is also new. Furthermore, this paper
is related to a companion paper, Baqaee and Farhi (2020), which studies how nominal
rigidities can provide an endogenous mechanism for the reductions in factor supply that
are taken as given in this paper.
     Of course, our analysis is also related to many non-Covid related papers, in particular,
the literature on production networks which are summarized in Baqaee and Farhi (2019b)
or Carvalho and Tahbaz-Salehi (2019). In future versions of this paper, we hope to expand
our discussion of this and other related literatures.


2     Setup
In this section, we set up the basic model, define the shocks, the outcomes of interest, and
the relevant notation. This section also contains a detailed discussion of how we define
real GDP and welfare.


2.1   Environment and Equilibrium
The model has a set of producers N , and a set of factors G with supply functions L f . We
write N + G for the union of these two sets. With some abuse of notation, we also denote
by N and G the cardinalities of these sets. The output of each producer is produced using
intermediate inputs and factors, and is sold as an intermediate good to other producers
and as a final good.


Final demand. Final uses ci of the different goods i arise from the maximization of a
constant-returns-to-scale final-demand aggregator

                                  max D(c1 , . . . , cN ; ωD )
                                   { ci }




                                               5
subject to the final-demand budget constraint

                                   ∑      pi ci =       ∑      pf Lf +   ∑ πi ,
                                  i ∈N                  f ∈G             i ∈N


where pi and ci are the price and final quantity of good i, p f is the wage of factor f , πi
is the profits of the producer of good i. Ordinarily, it is taken for granted that D(c; ωD )
must equal real GDP. However, and crucially for our application, we allow for a demand
shifter ωD which can change the shape of the final demand function. This can represent
how household preferences over different consumption baskets change. For instance,
if households prefer more groceries and less cruises as a result of the epidemic. If ωD
changes, then as we discuss, real GDP no longer measures changes in the final demand
index.


Producers.   The output yi of good i arises from the maximization of profits

                       πi =          max
                              {yi },{ xij },{ Li f }
                                                       pi yi −   ∑     p j xij −   ∑      p f Li f
                                                                 j∈N               f ∈G


subject to a technological constraint described by a constant-returns production function

                            yi = Ai Fi ( xi1 , . . . , xiN , Li1 , . . . , LiG ) ,

where Ai is a Hicks-neutral productivity shifter and yi is total output.


Equilibrium. Given factor supplies L f , productivities Ai , and demand shifters ωD , an
equilibrium is a set of prices pi , factor wages p f , intermediate input choices xij , factor
input choices li f , outputs yi , and final demands ci , such that: each producer maximizes
its profits subject to its technological constraint; final uses maximizes the final-demand
aggregator subject to the final-demand budget constraint; and the markets for all goods
and factors clear.


2.2   Discussion
Shocks. We will focus on three types of shocks: shocks to factor supplies, shocks to pro-
ductivities, and shocks to demand. We believe that they are all important in the current
context. Shocks to factor supplies could result, for example, from labor market retrench-
ment to avoid contagion perhaps because of confinement. Shocks to productivities could


                                                            6
result, for example, from the reorganization of production such as working from home,
or from the necessity of repurposing and repackaging some inputs for direct consump-
tion vs. in outside venues. Shocks to demand could result, for example, from changes
in consumption patterns arising from the fear of contagion. It would perhaps be more
appropriate to refer to them as shocks to the composition of demand for different goods, but
we call them shocks to demand for brevity.
    Both for shocks to factor supplies and for shocks to demand, we stress that these
changes in behavior could be voluntary if the agents modify their actions by themselves
(internal effects), or involuntary if the government induces them through policy to cor-
rect externalities (external effects). For positive questions, say about the behavior of real
GDP, this distinction is largely irrelevant. However, it matters when we turn to normative
questions in Section 5.


Variable returns to scale. Despite specifying constant-returns cost functions, our setup
can accommodate decreasing returns to scale. This is because, as pointed out by McKen-
zie (1959), variable returns to scale can be modeled with constant returns to scale and
producer-specific fixed factors.


Non-Hicks-neutral shocks. Although the model is written in terms of Hicks-neutral
productivity shocks, this is done without loss of generality. We can always capture non-
neutral (biased) productivity shocks to the use of input j by producer i by introducing a
fictitious producer buying input j and selling to producer i with a linear technology, and
by considering Hicks-neutral shocks to this fictitious producer. For example, this can be
important in the context of a pandemic because changes in the organization of production
due to confinement and protection measures are likely to affect the productivities of labor
an capital differently.


Investment. Investment can be modeled in different ways. The first possibility is to
put investments in final demand. We then apply the model within a period. Changes in
investment demand arising from expectations about future periods and states are then
captured by demand shocks. The second possibility is to think of investments as inter-
mediate goods in a dynamic stochastic model. We then apply the model inter-temporally
and across states by indexing commodities by periods and states, and by letting final de-
mand represent consumption not only within periods but also across periods and states.
See footnote 5 below for more details.



                                             7
2.3   Input-Output Definitions
We define input-output objects such as input-output matrices, Leontief inverse matrices,
and Domar weights associated with a competitive equilibrium. To make the exposition
more intuitive, we slightly abuse notation in the following way. For each factor f , we
interchangeably use the notation Li f or xi(N + f ) to denote its use by producer i, and the
notation L f or y f or to denote total factor supply. We define final demand as an additional
good produced by producer 0 according to the final demand aggregator. We interchange-
ably use the notation ci or x0i to denote the consumption of good i in final demand. We
write 1 + N for the union of the sets {0} and N , and 1 + N + G for the union of the sets
{0}, N , and G . In other words, we add final demand and the factors into the IO matrix.

Input-output matrix. We define the input-output matrix to be the (1 + N + G) × (1 +
N + G) matrix Ω whose ijth element is equal to i’s expenditures on inputs from j as a
share of its total revenues
                                       p j xij       p j xij
                               Ωij ≡           =                .
                                       pi yi     ∑k∈N +G pk xik

The input-output matrix Ω records the direct exposures of one producer to another, for-
ward from upstream to downstream in costs, and backward from downstream to up-
stream in demand.


Leontief inverse matrix.    We define the Leontief inverse matrix as

                           Ψ ≡ ( I − Ω ) −1 = I + Ω + Ω 2 + . . . .

The Leontief inverse matrix Ψ records instead the direct and indirect exposures through
the supply chains in the production network, forward from upstream to downstream in
costs, and backward from downstream to upstream in demand. This can be seen most
clearly by noting that (Ωn )ij measures the weighted sums of all paths of length n from
producer i to producer j.




                                               8
Nominal GDP and Domar weights. Nominal GDP or nominal output is the total sum
of all final expenditures
                          GDP = ∑ pi ci = ∑ pi x0i .
                                           i∈ N           i∈ N

We define the Domar weight λi of producer i to be its sales as a fraction of GDP

                                                  pi yi
                                          λi ≡          .
                                                  GDP

Note that ∑i∈ N λi > 1 in general since some sales are not final sales but intermediate
sales. Note that the Domar weight λ f of factor f is simply its total income share.
    The accounting identity pi yi = pi x0i + ∑ j∈N pi x ji = Ω0i GDP + ∑ j∈N Ω ji λ j GDP links
the Domar weights to the Leontief inverse via

                                    λi = Ψ0i =        ∑   Ω0j Ψ ji ,
                                                  j∈N


where Ω0j = ( p j x0j )/(∑k∈N +G pk x0k ) = ( p j c j )/GDP is the share of good j in final expen-
diture.


2.4   Nested-CES Economies
We call an economy nested CES if all the production functions of all the producers (in-
cluding final demand) are of the nested-CES form with Hicks-neutral technical change at
the level of each nest. Any nested-CES economy, with an arbitrary number of producers,
factors, CES nests, elasticities, and intermediate input use, can be re-written in what we
call standard form, which is more convenient to study. To write a nested-CES economy in
standard form, we simply treat each CES aggregator as though it is a distinct producer.
Since the boundaries of the firm are irrelevant, this simply amounts to a relabelling of the
set of producers.
    A CES economy in standard form is defined by a tuple (ω̄, θ, F ). The (1 + N + G) ×
(1 + N + G) matrix ω̄ is a matrix of input-output parameters. The (1 + N ) × 1 vector θ is
a vector of microeconomic elasticities of substitution. Each good i ∈ N is produced with
the production function

                                                                                  θi
                                                                ! θ i −1
                                                                          
                                                                               θ i −1
                            yi  A                        xij       θi

                               = i  ∑ ω̄ij                                             ,
                                                                           
                            yi  Āi j∈N +G                xij
                                                                           




                                                  9
where xij are intermediate inputs from j used by i. We represent final demand as the
purchase of good 0 from producer 0 producing the final good

                                                                               θ0
                                                                ! θ0 −1
                                                                         
                                                                              θ0 −1
                              y0            ω0j           x0j      θ0

                                 =  ∑ ω̄0j                                           ,
                                                                         
                              y0                          x0j
                                                                          
                                     j∈N +G
                                            ω̄0j


where ω0j is a demand shifter. In these equations, variables with over-lines are normal-
izing constants equal to the values at some initial competitive equilibrium and we then
have ω̄ = Ω̄.4 To simplify the notation below, we think of ω0 as a 1 × (1 + N + G) vector
with k-th element ω0k . Changes in ω0 are how we model changes in the composition of
demand.


2.5    Real GDP and Welfare
A main contribution of this paper is to analyze how changes in the composition of de-
mand affect real GDP (aggregate output) and welfare. Shocks to the composition of de-
mand are typically ruled out in growth-accounting, since real GDP acquires undesirable
properties when final demand is unstable. However, real GDP is what we measure, and
so in this paper, we are interested in understanding its behavior, warts and all. We start by
discussing how we define real GDP in disaggregated economies, why real GDP becomes
an exotic object when there are demand shocks, and then we discuss how we measure
welfare, and why it differs from real GDP.


Real GDP. In the next sections, we provide comparative statics describing how, starting
from an initial competitive equilibrium, the competitive equilibrium changes in response
to changes in factor supplies L f , productivities Ak , and demand shifters ω0k . We compute
real GDP using the artificial data generated by the model by applying the idealized proce-
dure used by national-income accountants with the actual data. Consider a path indexed
by s for the factor supplies L f ,s , productivities Ak,s , and demand shifters ω0k,s . Index the
corresponding competitive equilibrium by s. We provide first- and second-order approx-
imations in ds = s − s̄ around an initial equilibrium corresponding to s̄. Equivalently,
these can be thought of as first- and second-order approximations in the shocks to pro-
   4 Note that when mapping the original economy to the re-labeled economy, the different nests in final
demand are mapped intro different producers j. To simplify the exposition, we have imposed that there
are only demand shocks in the outermost nest mapped to producer 0. It is easy to generalize the results to
allow for demand shocks in all the nests corresponding to final demand.



                                                   10
ductivities ∆ log Ak = d log As , factor supplies ∆ log L f ,s = d log L f ,s , and demand
                       R                                        R

∆ log ω0k = d log ω0k,s . We also provide some exact results.
             R

    Global changes in output or real GDP are defined along this path by integrating local
changes in real GDP                         Z
                                           ∆ log Y =        d log Ys ,

where local changes in real output are obtained by deflating changes in nominal GDP
using changes in the GDP deflator

                                   d log Ys = d log GDPs − d log Ps ,

and where changes in GDP deflator are defined as the weighted average of changes in
final-demand prices with weights given by final demand shares

                                      d log Ps =    ∑ Ω0i,s d log pi,s .
                                                    i∈ N

    Defined in this way, as long as there are no demand shocks along the path (ω0k,s =
ω̄0k,s for all k and s), local changes in real GDP d log Ys coincide with local changes in
the final-demand quantity index d log y0,s . In other words, as long as the final demand
aggregator is not changing, changes in real GDP coincide with the total derivative of
the function y0 ({ L f ,s }, { Ak,s }), which defines the final-demand quantity index y0 as a
function of factor supplies L f ,s and productivities Ak,s :

                                                               
                                 ∂ log y0 { L f ,s }, { Ak,s }
  d log Ys = d log y0,s   = ∑                                    d log L f ,s
                            f ∈F
                                         ∂ log L f
                                                                                                      
                                                                        ∂ log y0 { L f ,s }, { Ak,s }
                                                             +   ∑              ∂ log Ak,s
                                                                                                        d log Ak,s .
                                                                 k∈ N

As long as the shocks evolve continuously, the same goes for global changes ∆ log Y =
∆ log y0 and so global changes in real GDP along a path depend only on the initial and
end points of the path. Basically, real GDP can be defined in levels as Ys = y0,s =
y0 ({ L f ,s }, { Ak,s }) and measures some well-defined notion of welfare.
    However, when there are demand shocks, these useful relationships no longer hold.
In general, local changes in real GDP d log Ys do not correspond anymore to changes in
the final demand quantity index, are not the total derivative of any function. Changes in
real GDP ∆ log Y must instead be interpreted as a path integral along a non-conservative
vector field. This means that real GDP along a path will depend not just on the beginning


                                                       11
and end points of the path but on the whole path itself. These complications, which are
usually ruled out, are important for our application, where household preferences over
consumption baskets have likely changed. Intuitively, the problem arises from the fact
that demand shocks directly change behavior without directly affecting transacted prices.
    Issues of path depedence disappear when we turn to normative questions, since wel-
fare can always be represented using a utility function, and so changes in utility do not
depend on the path between the two end points. The same applies to disaggregated vari-
ables such as sales and factor shares, prices, and quantities. However these subtleties
cannot be avoided for the positive questions involving aggregate output.


Welfare. Although not subject to any path-dependence problem, measuring welfare
with shocks to the composition of demand is not completely straightforward either. And
the distinction between preference-driven and policy-induced demand shocks, which did
not matter for real GDP, matters a lot for welfare. In Section 5, we give a full treatment of
both cases. Here, we limit our discussion to the case of preference-driven shocks to the
composition of demand, and try to give a sense of the sort of issues that come up.
    For example, suppose that the Covid crisis causes households to alter their ranking
of different consumption baskets. For example, the pandemic makes households prefer
more toilet paper and less cruises.
    Because of Covid, the economy moves from an initial allocation ( p, c) to a different
allocation ( p0 , c0 ), where p is the vector of prices and c is the vector of consumption goods.
Using post-Covid preferences, let y00 be the utility attained at allocation c0 and y0 the utility
attained at the allocation c. Let e( p, y0 ) be the household’s expenditure function, using the
post-Covid preferences. We define the change in welfare to be

                                                     e( p0 , y00 )
                                                                     
                                 ∆ log W = log                            .
                                                     e ( p 0 , y0 )

In other words, how much must the household’s income change to compensate them for
having to consume the initial allocation rather than the post-shock allocation.
    Note that this definition of welfare does not answer the question “how much would the
household be willing to pay to eliminate Covid?” Instead, it answers the question “how much
would the household be willing to pay to consume the original allocation?” That is, we compare
the post-shock and pre-shock allocation using the household’s new preferences. We do
not compare the initial allocation using the pre-shock preferences to the post-shock allo-
cation using the post-shock preferences. Since households cannot make a choice between
a world with Covid and a world without Covid, preferences about such a comparison are


                                               12
not revealed by any of their choices.
     When there are only shocks to preferences but no shocks to productivities or factor
supplies, the first welfare theorem necessitates that the household must prefer allocation
y00 to allocation y0 and so ∆ log W > 0.
     Since we assume that preferences are homothetic, we can write ∆ log W = log y00 −
log y0 = ∆ log y0 . This means we can measure the change in welfare by simply using the
change in the quantity-index ∆ log y0 .


3     Comparative Statics
In this section, we derive general-equilibrium comparative static results. Although we
will be mostly focused on changes in aggregate output, we will also characterize changes
in disaggregated sales an factor shares, prices, and quantities.
    We proceed in three steps. First, in Section 3.1, we derive an aggregation equation
which gives a second-order approximation of changes in output as a function of the ex-
ogenous shocks and first-order changes in equilibrium sales and factor shares. Second, in
Section 3.2, we derive a first-order approximation of changes in sales and factor shares as
a function of the exogenous shocks and of microeconomic primitives. Combining the two
first steps gives a second-order approximation of changes in output as a function of the
exogenous shocks and of microeconomic primitives. Third, in Section 3.3, we specialize
the model to provide illustrative examples as well as exact (not approximative) results.


3.1   Aggregation Equation
We start by giving a second-order approximation of changes in output as a function of the
exogenous shocks and of first-order endogenous equilibrium changes in sales and factor
shares. Here and in the rest of the paper, unless there is a risk of confusion, we use the
simpler notation Ω and Ψ instead of Ω̄ and Ψ̄ to refer to the input-output objects at the
initial equilibrium. Similarly, we use the notation and λ instead of λ̄ to refer to the initial
sales and factor shares at the initial equilibrium, and ∆ log λ to indicate their changes.

Proposition 1. Changes in output around an equilibrium can be approximated up to the second




                                              13
order by the following aggregation equation:

  ∆ log Y ≈   ∑      λk ∆ log Ak +   ∑ λ f ∆ log L f
              k ∈N                   f ∈G
                                            1                            1
                                        +      ∑
                                            2 k∈N
                                                  λk ∆ log λk ∆ log Ak +
                                                                         2             ∑ λ f ∆ log λ f ∆ log L f .
                                                                                       f ∈G


    The proof can be found in Appendix A.1. The first two terms on the right-hand side
are the first-order terms, and the last two terms are the second-order terms.
    The first-order terms are given by Hulten’s theorem, which can be thought of as a ver-
sion of the envelope theorem for output: the first-order effect on output of a productivity
or factor supply shock in general equilibrium is given by the sales share of the shocked
entity. For example, the reduction in output resulting from a reduction in the supply of a
factor is bigger if the shock is bigger of if the share of this factor is larger.
    The second order terms can be found by integrating
                           Z                       Z                              Z
              ∆ log Y =        d log Ys =    ∑         λk,s d log Ak,s +   ∑          Λ f ,s d log L f ,s
                                            k ∈N                           f ∈G


and approximating this expression to the second order. The second- and higher-order
effects are given by the interactions of the shocks with the changes in the sales shares that
take place in general equilibrium because of the shocks. For example, the reduction in
output from a reduction in the supply of a factor is bigger not only if the shock is bigger
and if the share of this factor is larger as in the first-order approximation, but also if the
share of this factor increases because of this shock and all the other shocks, and if the
shock increases the shares of the other entities hit with big negative shocks. The second-
and higher-order effects capture nonlinearities: they matter more for large shocks; and
they matter more for the interaction of the shocks.
    Demand shocks ∆ log ω0k do not appear directly in the aggregation equation. In fact,
they have no first-order effects on output, and they have no second- and higher-order
effects on output if there are no shocks to productivities and factor supplies. However,
they do matter at the second- and higher-order in the presence of shocks to productivities
and factor supplies because they induce changes in sales and factor shares. For example,
the reduction in output from the reduction in the supply of a factor is larger if demand
shifts towards goods that use this factor more directly and indirectly through their supply
chains.
    Neither the structure of the production network nor the elasticities of substitution in


                                                        14
production and in final demand appear directly int the aggregation equation. The shocks,
sales and factor shares, and changes in the equilibrium sales and factor shares caused by
the shocks are sufficient statistics. As we shall see in Section 3.2 below, the structure of
the network and the elasticities matter because they jointly influence the changes in the
equilibrium sales and factor shares ∆ log λ. We demonstrate this dependence by deriving
propagation equations characterizing changes in equilibrium sales and factor shares as
a function of microeconomic primitives. Combining the aggregation and propagation
equations gives a second-order approximation of output as a function of microeconomic
primitives.5


3.2       Propagation Equations
We now give a first-order approximation of the endogenous equilibrium changes in sales
and factor shares as a function of microeconomic primitives via propagation equations.
These equations demonstrate the importance of the network, of the elasticities, and of
their interactions.
    We make use of the following notation and definition. For a matrix M, we denote by
M(i) its i-th row by M( j) its j-th column. Given two K × 1 vectors X and Y and an 1 × K
vector of Z with Zi ∈ [0, 1] and ∑l ∈K Zl = 1, we define Cov Z ( X, Y ) = ∑l ∈K Zjl Xl Yl −
(∑l ∈K Zjl Xl )(∑l ∈K Zjl Yl ). It is a covariance of the random variables X and Y using the
elements l as realizations of random events with probabilities Zl . We will oftentimes
use this operator with Z given by the j-th row Ω( j) of the input-output matrix for some
j ∈ 1 + N , and in this context, we will call the mapping from ( X, Y ) to CovΩ( j) ( X, Y ) as
the input-output covariance operator.

Proposition 2. Changes in prices can be approximated to the first order by the following forward
propagation equations:

            ∆ log pi ≈ −   ∑      Ψik ∆ log Ak +   ∑ Ψig   ∆ log λ g − ∆ log L g + ∆ log Y .
                                                                                          
                           k ∈N                    g∈G

   5 Ifone desires to treat investments as intermediate goods rather than putting them in final demand as
explained in Section 2.2, we must slightly change our procedure. In the first step, we apply the model to
an enriched set of commodities indexed by dates and states. We compute changes in shares, prices, and
quantities in this extended model by applying the results of Section 3.2. In the second step we compute the
change in real GDP in a given period. To do so, we can still apply Proposition 1. We must use the within
period shares (the shares divided by the sum of the shares of the factors corresponding to that period)
which can easily be computed from the first step. We must also count as factors the intermediate goods
produced in previous periods and used in production in this period, the changes in the quantity of which
is easily computed from the first step.



                                                     15
Changes in sales shares and factor shares can be approximated to the first order by the following
backward propagation equations:
                                                                                             
   λi ∆ log λi ≈ θ0 CovΩ(0) ∆ log ω0 , Ψ(i) +           ∑   λ j (θ j − 1)CovΩ( j) −∆ log p, Ψ(i) .
                                                    j∈1+N


Changes in quantities can be approximated at the first order by ∆ log yi ≈ ∆ log λi − ∆ log pi +
∆ log Y.

    The forward propagation equations describes how changes in prices propagate down-
stream (forward) through costs. A negative productivity shock ∆ log Ak to a producer k
upstream from i increases the price of i in proportion to how much i buys from k directly
and indirectly as measured by Ψik . Similarly an increase ∆ log p g = ∆ log λ g − ∆ log L g +
∆ log Y in the price of factor g increases the price of i in proportion to the direct and indi-
rect exposure of i to g.




    −∆ log p, Ψ1i       −∆ log p, Ψ2i                         −∆ log p, Ψ N −1,i    −∆ log p, Ψ Ni
                                        Ω j2            Ω j,N −1

                             Ω j1                                  Ω jN
                                               j




               Figure 1: Graphical illustration of the IO covariance operator.

    The backward propagations equations describe how changes in sales propagate up-
stream (backward) through demand. The first term ∑k∈1+ N θ0 CovΩ(0) (∆ log ω0 , Ψ(i) ) on
the right-hand side is the direct effect of demand shocks on the sales of i in the ab-
sence of expenditure-switching due to substitution. The second term ∑ j∈1+N λ j (θ j −
1)CovΩ( j) (−∆ log p, Ψ(i) ) on the right-hand side captures the changes in the sales of i from
substitutions by producers j downstream from i. This is depicted in Figure 1. If producer
j has an elasticity of substitution θ j below one so that its inputs are complements, then
it shifts its expenditure towards those inputs l with higher price increases ∆ log pl , and
this increases the demand for i if those goods l buy a lot from i directly and indirectly
as measured by Ψli . These expenditure-switching patterns are reversed when θ j is above
one so that the inputs of j are substitutes, and when θ j is equal to one they disappear.

                                                   16
   The following corollary combines the forward and backward propagation equations
together to characterize changes in sales as a function of factor shares and factor shares as
the solution of a system of F linear forward-backward equations in F unknowns.

Corollary 1. First-order changes in sales and factor shares solve the following linear system of of
1 + N + G forward-backward equations in 1 + N + G unknowns in the changes in the sales and
factor shares ∆ log λi :
                                          
  λi ∆ log λi ≈ θ0 CovΩ(0) ∆ log ω0 , Ψ(i)
                                                                                                            !
          ∑                             ∑     Ψ(k) ∆ log Ak +    ∑ Ψ( g)    ∆ log λ g − ∆ log L g , Ψ(i)
                                                                                                    
   +           λ j (θ j − 1)CovΩ( j)                                                                            .
       j∈1+N                           k ∈N                     g∈G


Specializing the system to factors i = f ∈ G yields a linear system of G equations in G unknowns
in the changes factor shares ∆ log λ f for f ∈ G , with all the other sales shares explicitly solved for
as a function of changes in factor shares.

    Note that while changes in output ∆ log Y directly enter the forward propagation
equations and hence indirectly the backward propagation equations in Proposition 2, they
no longer enter the system of linear equations in sales and factor shares in Corollary 1.
The reason is that changes in aggregate output wash out in the input-output covariances
since they affect all prices in the same way.6
    Our characterization is therefore block recursive. First, we solve a linear system of
G forward-backward propagation equations in G unknowns in the changes in the factor
shares ∆ log λ f for f ∈ G from Corollary 1. Then we get changes in the sales shares also
from the forward-backward propagation equations in Corollary 1. Finally, we plug these
changes in sales and factor shares in the aggregation equation in Proposition 2. Overall,
our characterization is in closed form up to the solution of a linear system of G equations
in G unknowns in the changes in the factor shares ∆ log λ f for f ∈ G .


3.3       Illustrative Special Cases
The aggregation and propagation equations described in Sections 3.1 and 3.2 give a second-
order approximation of the effects of shocks on output as a function of the shocks, the
network, and the elasticities. This characterization is in closed form up to a system of lin-
ear equations in the changes in the factor shares. In this section, we specialize the model
   6 To see this, rewrite the forward propagation equations as ∆ log pi ≈ − ∑k∈N Ψik ∆ log Ak +
∑ g∈G Ψig (∆ log λ g − ∆ log L g ) + ∆ log Y. This uses the fact that ∑ g∈G Ψig = 1, which captures the fact that a
uniform proportional increase in all factor prices results in a uniform proportional increase in all prices.

                                                        17
in order to provide simpler versions of the second-order results and also exact (non-local)
results.
    We focus on the joint roles of the shocks, the network, and the elasticities in shaping
nonlinearities. In Section 3.3.1, we focus on Cobb-Douglas economies and illustrate the
role of the network with shocks to the composition of demand. In Section 3.3.2, we look
at economies with uniform elasticities of substitution, which we show have a surprising
network-irrelevance property, and we zoom in on the role of elasticities and shocks to
factor supplies. In Section 3.3.3, we investigate a special class of networks where the joint
roles of the elasticities, the input-output network, and the shocks can be handled in a
simple way.
    In each case, we provide general results and concrete applications in the context of
Covid. In particular, in Section 3.3.2, we present a numerical illustration demonstrating
the quantitative importance of nonlinearities.


3.3.1   Cobb-Douglas

We start with the Cobb-Douglas case where all the elasticities of substitution are equal to
one.

Proposition 3. Suppose that all the elasticities of substitution are equal to one (θ j = 1 for all
j ∈ 1 + N ). Then changes in output can be approximated up to the second order by

  ∆ log Y ≈   ∑      λk ∆ log Ak +   ∑ λ f ∆ log L f
              k ∈N                   f ∈G
                                                                                                          !
                                1
                               + CovΩ(0)
                                2
                                               ∆ log ω0 ,   ∑      Ψ(k) ∆ log Ak +   ∑ Ψ( f ) ∆ log L f       .
                                                            k ∈N                     f ∈G


Changes in sales and factor shares are given in Appendix A.3.

   In the absence of shocks to demand, output is log-linear in the shocks ∆ log Y =
∑k∈N λk ∆ log Ak + ∑ f ∈G λ f ∆ log L f . In this case, the first-order approximation provided
by Hulten’s theorem is exact. It is only when shocks to demand occur in conjunction with
shocks to productivities or factor supplies that nonlinearities appear.


Implications. To unpack the nonlinearities, consider a univariate reduction ∆ log L f < 0
in the supply of factor f and a shock to demand ∆ log ω0 . If the demand shock redirects
(directly and indirectly) expenditures towards this factor, it increases its share and am-
plifies the reduction in output. Conversely, if the demand shock redirects expenditures

                                                   18
away from this factor, it reduces its share and mitigates the reduction in output. Figure
2 illustrates such a scenario. We plot the change in output in response to a negative pro-
ductivity shock in a Cobb-Douglas model with two sectors (each with an initial spending
share of 1/2). In the ‘No demand shock’ scenario, preferences are being held constant,
whereas, in the other two scenarios, preferences change as the shock unfolds. By the end
point, when production has fallen by about 20% in the negatively affected sector, demand
for that sector’s goods have increased or fallen by about 40%.

                                         1.00
                                                                         No demand shock
                                                                         Decreased demand
                                                                         Increased demand
                 change in output Y/Ȳ




                                         0.95




                                         0.90




                                           0.00   0.05        0.10       0.15           0.20
                                                         size of shock

Figure 2: Output change ∆Y/Ȳ as a function of the size of a negative productivity shock
to one sector, with or without an accompanying preference shock.



Concrete example. Concretely, consider Amazon’s forced closure of its warehouses in
France just as household preferences change in favor of demanding more goods from
online retailers. Or meat packing plants in the US, like Smithfield (which accounts for
5% of US pork production) and JBS, closing due to an outbreak just as household pref-
erence shift in favor of consuming relatively more meat. In these cases, factors are being
withdrawn concurrent with negative demand shocks for those factors. In these cases,
nonlinearities amplify output losses because of the interaction of the two shocks .
   Of course, this is not the only type of nonlinearity that matters. In the next example,
we consider a different type of nonlinearity, one that does not rely on concurrent demand
shocks.




                                                          19
3.3.2   Uniform Elasticities and Only Shocks to Factor Supplies

To see the importance of nonlinearities in the absence of demand shocks, suppose that
all the elasticities of substitution are the same and that there are are only shocks to factor
supplies.

Proposition 4. Suppose that all the elasticities of substitution are the same (θ j = θ for all j ∈
1 + N ) and that there are only shocks to factor supplies but no shocks to productivities and no
shocks to demand. Then have an exact expression for changes in output:

                                                                             !     θ
                                                                    θ −1       θ −1

                             e∆ log Y =   ∑ λ̄ f       e∆ log L f
                                                                       θ
                                                                                        .
                                          f ∈G

We also have fully-solved-out approximations of changes in output to the second order:

                                                         1θ−1
                      ∆ log Y ≈   ∑ λ f ∆ log L f + 2      θ
                                                              Varλ (∆ log L) ,
                                  f ∈G


where Eλ (∆ log L) = ∑ f ∈G λ f ∆ log L f and Varλ (∆ log L) = ∑ f ∈G λ f (∆ log L f − Eλ (∆ log L))
are the expectation and variance of the shocks ∆ log L f using the factor shares λ f as probabilities.
Changes in sales and factor shares are given in Appendix A.3.

    Proposition 4 shows that, in this special case, we can write the output function in
closed-form, helping us to better see the nonlinearities.
    Basically, under the assumptions of Proposition 4, output is given as a function of
factor supplies by a simple CES aggregate production function with an elasticity of sub-
stitution θ. This is because substitution patterns are uniform throughout the network
between a given factor and all the other factors.
    This surprising network-irrelevance result shows that in this case, the output effects of
shocks to factor supplies are globally independent of the structure of the network. The
network matters only through the initial factor shares λ̄ f . In other words, even though
there are many sectors and potentially complex and nonlinear supply chains, this infor-
mation is entirely summarized by the initial factor income shares as long as the elasticities
of substitution are uniform. Network irrelevance breaks if elasticities are not uniform, if
there are shocks to productivities, or if there are shocks to demand.


Implications. In Proposition 3, we saw how demand shocks and supply shocks can
interact to generate nonlinear losses even in a Cobb-Douglas model. However, without



                                                 20
both types of shocks, a Cobb-Douglas model is loglinear. Once we deviate from Cobb-
Douglas, output is nonlinear even when there are no demand shocks. Consider the case
of complements (θ < 1) with univariate shocks or multivariate shocks. All the patterns
are reversed in the case of substitutes (θ > 1). Overall, a lesson that emerges is that
nonlinearities can amplify reductions in output when there are complementarities and
when shocks are heterogeneous.
     To see this, start with univariate shocks where there is only one factor f with ∆ log L f 6=
0. Then nonlinearities amplify negative shocks and mitigate positive shocks compared to
the first-order approximation. To see this, observe that the reduction in the supply of a
factor causes its share to increase and hence amplifies the impact of the shock. The rela-
tive importance of these nonlinear effects and of the first-order effects increases with the
size of the shock. This can be seen clearly using the approximations with Varλ (∆ log L) =
λ f (1 − λ f )(∆ log L f )2 . The second-order term is negative, and so changes in output are a
concave function of the shock. These patterns are reversed for increases in the supply of
a factor.
     Consider next the case of complementarities and multivariate shocks where there are
several factors f with ∆ log L f 6= 0. The nonlinearities imply that the shocks interact. This
can be seen clearly in the second-order terms where shocks enter through their variance
Varλ (∆ log L). In particular, when the shocks are homogenous so that ∆ log L f = ∆ log L g
for all f and g, then factor shares do not change, and there are no nonlinearities. Relatedly,
if all factors but f experience the same negative shock, then the marginal impact of the
same shock hitting factor f is mitigated.


Numerical illustration. We only sketch the model and how it is calibrated. We refer the
reader to Section 6 for more details on the calibration.
    We consider a stylized version of the U.S. economy with 66 industries and industrial
production functions with labor, capital, and intermediates. We focus on the short run
and assume that labor and capital cannot be reallocated across industries. We assume
uniform elasticities in production and in final demand equal to θ.
    The shock is a reduction in labor supplies calibrated to match the changes in hours
worked by industry from the May 2020 BLS Economic News release. These numbers
probably underestimate the actual reductions in hours because the underlying survey
may not appropriately classify furloughed employees as temporarily unemployed. To
allow for this possibility, we consider two scenarios: in the less extreme scenario, we
assume that in each industry, the reduction in hours worked coincides with that given
by the BLS; in the more extreme scenario, we inflate the log reduction in hours in each


                                               21
industry, reported by the BLS, by 50%. The less extreme scenario reduces aggregate hours
by around 13%, whereas the more extreme scenario reduces aggregate hours by 20%.

    0.90

                                                                              0.90
    0.80


    0.70
                                                                              0.80
    0.60




                                                                          Y
Y




    0.50
                                                                              0.70

    0.40

                                                    Disagg.                                                                  Disagg.
    0.30                                                                      0.60                                           Agg.
                                                    Agg.
                                                    Log Linearized                                                           Log Linearized

    0.20                                                                             0    0.2        0.4          0.6        0.8              1
           0     0.2        0.4          0.6        0.8              1
                       elasticity of substitution                                               elasticity of substitution


               (a) more extreme scenario                                                 (b) less extreme scenario

Figure 3: Output relative to its initial value as a function of the (uniform) elasticity of
substitution. In the less extreme scenario, the reduction in hours worked in each sector is
equal to the number reported by the BLS; in the more extreme scenario, the reduction in
hours worked in each sector is inflated by 50% compared to the number reported by the
BLS.

    We compare the outcome of this disaggregated model to that of an aggregate model
where output is produced by an aggregate production function using a labor aggregate
and a capital aggregate with the same elasticity of substitution θ. The shares of the la-
bor and capital aggregates are the total sales of all the labors and all the capitals in the
disaggregated model. The labor and capital aggregates are log-linear Cobb-Douglas ag-
gregates of the different labors and capitals with shares given by the relative shares of the
different labors and the different capitals.
    The two models produce the exact same output response in the Cobb-Douglas case
when θ = 1, and both coincide with the first-order approximation given by Hulten’s
theorem. However, Figure 3 shows that as we lower θ below one to capture complemen-
tarities, output reductions in the disaggregated model are larger than in the aggregate
model because the former is more nonlinear than the latter in both scenarios. This is be-
cause the shocks is very heterogeneous across sectors. If the shocks were homogeneous,
then both models would generate the same output reductions.
    The gap between the two models is sizable even for reasonable degrees of comple-
mentarity (θ below 0.5) and becomes very large for high degrees of complementarity (θ
close to zero). This is true for both scenarios but more so for the more extreme scenario.

                                                                     22
Which elasticity θ is empirically relevant is a tricky question, since aggregate output is
not, in practice, a single CES aggregator. Nevertheless, our quantitative results in Section
6 suggest that in the short run and at our level of industrial aggregation, it is reasonable to
assume a relatively low value of θ, say 0.4 or lower. For example, with an elasticity of 0.4:
the reduction in output under the more extreme scenario is 14% in aggregate model and
20% in the disaggregated model (a 42% amplification); and the reduction in output un-
der the less extreme scenario is 9% in the aggregate model and 11% in the disaggregated
model (a 12% amplification).
    Overall, this example demonstrates that because the shock is very heterogeneous, and
because there are complementarities, it is important to use a disaggregated model to as-
sess its impact on output. Although the two models coincide at the first order, nonlinear-
ities amplify reductions in output significantly more in the disaggregated model than in
the aggregate model that trivializes the heterogeneity in the shock.
    Of course, this network-irrelevant case with uniform elasticities and no shocks to pro-
ductivities or to the composition of demand is special. We already saw in the Cobb-
Douglas case in Section 3.3.1 an example of how the network matters with shocks to the
composition of demand. However, this example made it impossible to analyze how the
different elasticities of substitution matter together with the network. The next example
considers a class of networks where these interactions can be analyzed in a simple way.


3.3.3   Acyclic Networks

We now turn to the class of acyclic production networks, where the production network Ω
is an acyclic graph. An example is depicted in Figure 4. These examples allow us to more
easily see the importance of non-linearities in cases where the elasticities of substitution
are not all the same.
    The term acyclic here means that any two nodes are connected to one another by
exactly one undirected path. In other words, each producer has a unique direct consumer.
For a given producer j ∈ 1 + N + G , we denote its unique immediately downstream
consumers by d(i ) and the set of its immediately upstream suppliers by u(i ), with the
convention that there is no-one downstream from final demand d(0) = ∅ and no-one
upstream from factors u( f ) = ∅ for f ∈ G . We use the Kronecker symbol δij = 1 if i = j
and δij = 0 if i 6= j.7

   7 We can combine Propositions 4 and 5 to completely characterize a broader class of networks.      Start with
an acyclic production network. Each producer j is a CES nest with an elasticity θ j . Using Proposition 4, we
can create a new network by replacing producer j can be replaced by a subnetwork of producers buying
from each other and from the inputs i ∈ u( j) of producer j, and selling to each other and to the customer d( j)


                                                      23
                                        Lf           ···                      Lg
                             ···                                                       ···


                                         1           ···                      N




                                                     HH

Figure 4: An acyclic economy, where the solid arrows represent the flow of goods. The
factors are the green nodes. Each supplier (including factors) have at most one customer,
whereas a single customer may have more than one supplier. Economies without cycles
can be represented as directed trees with the household (final demand) denoted by HH
being the root.


Proposition 5. Suppose that the production network is acyclic. Then we have exact an expression
for changes in output recursively from upstream to downstream in the absence of shocks to demand:

                                                                                                                θi
                                                                                                               θ i −1
                                                                                                θ i −1
             e∆ log Y = e∆ log y0 ,    e∆ log yi = e∆ log Ai      ∑          Ω̄ij e∆ log y j
                                                                                                    θi
                                                                                                                       ,
                                                                 j ∈ u (i )


where by definition ∆ log yi = ∆ log L f if i = f ∈ G is a factor and where we define ∆ log A0 = 0.
We also have fully-solved-out approximations of changes in output to the second order even with
shocks to demand:

  ∆ log Y ≈    ∑     λk ∆ log Ak +    ∑ λ f ∆ log L f
              k ∈N                    f ∈G
                                                                                                                  !
                          1 θj − 1
              +      ∑     λ
                          2 j θj
                                   VarΩ( j)       ∑     Ψ(k) ∆ log Ak +             ∑ Ψ( f ) ∆ log L f
                  j∈1+N                          k ∈N                              f ∈G
                                                                                                                            !
                               1
                              + θ0 CovΩ(0)
                               2
                                                 ∆ log ω0 ,   ∑        Ψ(k) ∆ log Ak +             ∑ Ψ( f ) ∆ log L f           .
                                                              k ∈N                                 f ∈G


Changes in sales and factor shares are given in Appendix A.3.
of producer j. Final consumption in the sub-network corresponds to consumption by d( j) in the original
network, and factors in the sub-network correspond to the inputs i ∈ u( j) producer j. The elasticities of
substitution network are uniform and equal to θ j , and there are no shocks to productivities or to demand
in the sub-network. The characterization given in Proposition 5 remains unchanged since the sub-network
gives replicates the original CES production function of producer j.


                                                        24
    Such economies have a unique feasible allocation, because there is no option to allo-
cate a given factor or good to different uses, and this is what makes them so tractable.
    For our purposes, it is useful to think of such an economy as a probability tree. Each
node is a history of events. The root of the tree is the is producer 0 corresponding to final
demand. The leaves of the tree are the factors. Each node has a set of upstream branches
and is attached to a unique downstream branch. The probability of node 0 is one, the
conditional probability of reaching node j ∈ u(i ) in one more step conditional on being
at node i is Ωij . More generally, the probability of reaching node j in any number of steps
conditional on being at node i is Ψij . The unconditional probability of reaching node i is
given by its sales share λi . We also think of the shocks to factor productivities ∆ log Ak and
factor supplies ∆ log L f as realizations of random variables ∆ log A and ∆ log L. Finally,
we think of demand shocks ∆ log ω (0)0 as a change of probability measure.
    The different terms in Proposition 5 receive a probabilistic interpretation. The term
VarΩ( j) (∑k∈N Ψ(k) ∆ log Ak + ∑ f ∈G Ψ( f ) ∆ log L f ) is simply the variance conditional on his-
tory j of the different expectations of the random variable ∆ log A + ∆ log L conditional
on the continuing histories of j. Similarly, the term CovΩ(0) (∆ log ω0 , ∑k∈N Ψ(k) ∆ log Ak +
∑ f ∈G Ψ( f ) ∆ log L f ) is the impact of the change in probability measure on the expectation
of the random variable ∆ log A + ∆ log L.


Implications. When the elasticities are not uniform, the structure of the production net-
work matters even when there are only shocks to factor supplies. In particular, for a given
set of shocks, changes in output are decreasing in all the elasticities of substitution θ j at
the second order, and the associated nonlinearities contribute to reducing output with
complementarities (θ j < 1) and to increasing output with substituabilities (θ j > 1). How
much each elasticity θ j matters depends on the shocks and on the structure of the net-
works (the probabilities) through VarΩ( j) (∑ f ∈G Ψ( f ) ∆ log L f ) (the conditional variance of
the conditional expectation of ∆ log L).8
    When there are shocks to productivities ∆ log A or demand ∆ log ω0 , the structure of
the production network matters even when the elasticities are uniform. For example,
a univariate productivity shock ∆ log Ai to a producer i downstream from j generates
less nonlinearities at the second order than a corresponding univariate shock ∆ log A j =
(λi /λ j )∆ log Ai to j renormalized by the relative size λi /λ j of i and j so that the two
shocks have the same first-order effects. In the same example, when the elasticities are
   8 When the elasticities are uniform and equal to θ   and there are only shocks to factor supplies, the second-
order term is proportional to ∑ j∈1+N λ j VarΩ( j) (∑ f ∈G Ψ( f ) ∆ log L f ) which can be seen as a decomposition
of the unconditional variance Varλ (∆ log L) into conditional expectations of variances of conditional ex-
pectations.


                                                        25
not uniform, changes in output are independent of elasticities upstream from i at the
second order because they do not change its sales share at the first order.


Concrete example. As a concrete example imagine a simple structure with three sec-
tors: food, brick-and-mortar retail, and online retail. Imagine that all sectors produce
using different labors and that workers cannot be reallocated across sectors. Brick-and-
mortar retail (BMR) and online retail (OR) enter in a retail (R) nest 1, and that the re-
tail nest and food (F) enter in the final demand nest D. Imagine that brick-and-mortar
retail downsizes and fires some of its workers (∆ log L LMBR < 0) in an effort to mit-
igate contagion risk in a pandemic. Recognizing that brick-and-mortar retail and on-
line retail are more substitutable than retail and food (θ R > θ D ) rather than equally
substitutable (θ R = θ D ) mitigates the impact of the shock on output by (1/2)(1/θ D −
1/θ R )(λ BMR /λ R )(1 − λ BMR /λ R )(∆ log L LMBR )2 .


4     Endogenous Factor Supplies
In this section, we extend the model to allow for endogenous factor supplies. We focus
on two margins: factor reallocation and labor-leisure/factor utilization. In Appendix A.5,
we show how these two margins can also be analyzed jointly in one single model by
modeling factor supply à la Roy. In the main body, we focus on communicating the same
insights using a simpler specification.


4.1   Factor Reallocation
We start by exploring the role of factor reallocation. We use a simple second-order en-
velope analysis which can be conducted in the baseline model by either allowing or not
some factors to be reallocated. In Appendix A.5, we show how to generalize these in-
sights to endogenously smoother reallocations guided by finite elasticities of substitution
in factor supplies by extending the baseline model by adding an endogenous Roy factor
supply block.
    Take two factors h and h0 . Imagine that they are in fact the same underlying effective
factor. By this we mean that factor h0 could be used as a perfect substitute for factor h and
vice versa. Labor could therefore be reallocated not only between the different uses of h
and between the different uses of h0 separately as in the baseline model, but also between
all the different uses of h and h0 jointly. In addition, imagine that at initial equilibrium
there would be no gain from these further reallocations between h and h0 , which simply


                                             26
means that effective units of labor are getting the same wage if they are used as h or as
h0 . Without loss of generality, normalize the conversion of effective units between the two
factors as one for one. Now imagine that there is a shock to demand, productivities, and
supplies of factors.
     We consider two thought experiments which capture different forms of reallocations.
We refer to them as “sharing factor suppression” and “redeploying suppressed factors”.
Both illustrate the forces shaping the benefits of allowing factor reallocations, and con-
versely, the cost of preventing them. One of the reasons this is important is because many
policies adopted to mitigate transitory shocks have the side effect of discouraging real-
locations. For example, in a pandemic, one might be tempted to preserve organizational
capital by keeping workers and capital attached to their initial employers for the duration
of the shock. Their benefits notwithstanding, such policies also have costs and we study
these costs.


4.1.1      Sharing Factor Suppression

In the first thought experiment, we assume that in the reallocation economy, the overall
reduction in factor supply can be shared across h and h0 so that ∆ L̃h + ∆ L̃h0 = ∆Lh + ∆Lh0 .
For example, this could be because the government seeks to remove a certain number of
workers from the workforce in order to avoid the contagion of a virus. We then com-
pare the response of this reallocation economy (denoted with hats) to that of the no-
reallocation economy up to the second order:

                                              1        1       (∆ log λh − ∆ log λh0 )2
                     ∆ log Ŷ − ∆ log Y ≈         1         1
                                                                                                   ,
                                              2        +           λ h0   1
                                                           λ h0 λ h +λ 0 σ 0    +      λh    1
                                                  λh
                                                                        h h h       λh +λh0 σhh0


where the expressions for the changes in factor shares ∆ log λh and ∆ log λh0 in the no-
reallocation economy are given functions of microeconomic primitives by Corollary 1.
Here σhh0 and σh0 h are the (Morishima) macroeconomic elasticities of substitution between
h and h0 taken as separate factors in the no-reallocation economy.9
    Compared to the economy where h and h0 are stuck, the economy with reallocation
removes the misallocation between h and h0 . This misallocation is given by a Harberger
triangle: it is proportional to the harmonic average of the elasticities of substitution be-
tween h and h0 , and to the square of the implicit distortion wedges between h and h0 given
by ∆ log λh − ∆ log λh0 . Removing this misallocation increases output by the size of this
   9 For
      example σhh0 is defined as 1 − 1/σhh0 = (d log λh0 )/(d log Lh0 ) − (d log λh )/(d log Lh0 ) and can be
computed as a function of microeconomic primitves using Corollary 1.


                                                       27
triangle. Allowing these sorts of reallocations can therefore mitigate the negative impact
of the shocks on output.


4.1.2   Redeploying Suppressed Factors

In the second thought experiment, we assume that ∆ log Lh < 0 but that ∆ log Lh0 = 0.
We now interpret ∆ log Lh < 0 as a binding reduction on how much factor h can be used.
In the reallocation economy, the released supply of factor h can be reallocated to the uses
of factor h0 so that ∆ L̃h = ∆Lh and ∆ L̃h0 = −∆Lh . For example, this could be because
the government seeks to remove a certain number of workers from specific occupations
which are more prone to generating the contagion of a virus. We then compare the re-
sponse of this reallocation economy (denoted with tildes) to that of the no-reallocation
economy up to the second order by applying the results of Proposition 1 and Corollary 1
to the no-reallocation economy and to the reallocation economy.
    In the sharing-factor-suppression experiment, the gains from allowing reallocations
were only second order. By contrast, in this redeploying-suppressed-factors experiment,
there are also first-order gains −λh ∆ log Lh . Allowing these second sorts of reallocations
is therefore even more important than removing the first sorts.


4.1.3   Illustrative Examples

Sharing factor suppression. As an example of the sharing-factor-suppression experi-
ment, imagine that all elasticities of substitution are the same and equal to θ, and that
there are no shock to productivities and no shocks to demand. Then σhh0 = σh0 h = θ and
∆ log λh − ∆ log λh0 = ((θ − 1)/θ )(d log Lh − d log Lh0 ). The gains from reallocations are
then given up to the second order by

                                     1        1          ( θ − 1)2
              ∆ log Ŷ − ∆ log Y ≈       1         1
                                                                   (∆ log Lh − ∆ log Lh0 ) .
                                     2   λh   +   λ h0
                                                             θ

Reallocations spread the reductions in factor supply over h and h0 and this mitigates the
resulting output losses by taming nonlinearities at the second order. These nonlinearities
scale in (θ − 1)2 /θ and are therefore large when θ is far from one, either with strong
complementarities or with strong substituabilities.


Redeploying suppressed factors. As an example of the redeploying-suppressed-factors
experiment, continue to assume that all elasticities of substitution are the same and equal
to θ, and that there are no shock to productivities and no shocks to demand. Assume

                                                     28
in addition that there are no shocks to the factors f other than h and h0 , so that the only
shock is to the supply of factor h (see Appendix A.4 for the general case). The gains from
reallocations are then given up to the second order by

                                              θ−1
                                                           
                                                         λh        1
        ∆ log Ỹ − ∆ log Y ≈ λh0 ∆ log L̃h0 +
                                               θ
                                                  λh 1 +       ∑
                                                         λh0 j∈1+N 2
                                                                     (∆ log Lh )2 ,


where λh0 ∆ log L̃h0 = −λh ∆ log Lh + (1/2)λh (1 − λh /λh0 )(∆ log Lh )2 . There are two terms
on the right-hand side of this expression which correspond to the first- and second-order
effects of reallocations. Reallocations are always beneficial at the first order, but non-
linearities mitigate these benefits at the second order when there are complementarities
(θ < 1) because they increase the share of factor h which experiences a reduction in sup-
ply and decrease that of factor h0 which experiences an increase in supply. The results are
reversed when there are substituabilities (θ > 1) so that nonlinearities amplify the first-
order benefits of reallocations at the second order. These nonlinearities scale in (θ − 1)/θ
and are therefore potentially much stronger for complementarities than for substituabil-
ities. They also scale with (λh + λh0 )/λh0 and are therefore stronger for a given λh if the
relative number of workers in h0 vs. h is smaller.
    To shed light on the role of heterogeneous elasticities consider are no shocks to pro-
ductivities, no shocks to demand, and no shocks to the factors f other than h and h0 , so
that the only shock is to the supply of factor h (see Appendix A.4 for the general case).
The gains from reallocations are then given up to the second order by
                                                                                 2                   !
                                                1 θj − 1
                                                                                                2
                                                                          λh            
∆ log Ỹ − ∆ log Y ≈ λh0 ∆ log L̃h0 +    ∑       λ
                                                2 j θj
                                                           Ψ( jh0 )
                                                                          λ h0
                                                                                      + Ψ( jh)            (∆ log Lh )2 .
                                        j∈1+N


We focus on the nonlinearities captured by the second term on the right-hand side. These
gains are larger if there are many large nests j (as captured by λ j ) that substitute a lot
across their inputs (as captured by θ j > 1) and are directly and indirectly exposed to h
and h0 (as captured by Ψ( jh0 ) (λh /λh0 )2 + Ψ2( jh) ). Conversely, the gains are smaller if there
are large nests j that substitute little across their inputs (as captured by θ j < 1) and are
directly and indirectly exposed to h and h0 .
   As a concrete example imagine a simple structure with three sectors: restaurants,
home deliveries of prepared meals, and online retail. To capture frictions to reallocation,
imagine that all sectors produce using different labors, so that workers, who we assume
would be equally productive in all sectors, cannot be reallocated across sectors in the no-
reallocation economy. Restaurants and home deliveries of prepared meals are substitutes


                                                  29
in a food nest, and the food nest and online retail are complements in the final demand
nest. Imagine that restaurants downsize their staffs in an effort to mitigate contagion risk
in a pandemic. Restaurant workers might be reallocated to home deliveries of prepared
meals, or to the online retail sector (a likely complement to restaurants). The benefits of a
given amount of reallocation is then larger if it is of former rather than the latter kind.


4.2     Labor-Leisure/Factor Utilization
We now explore the role of endogenous factor supplies by introducing labor-leisure/
factor-utilization margins. Endogenous factor utilization/supply allows us to think about
the fact that shocks may change factor rewards, and as factor rewards change, the quan-
tity of factors supplied can change, further amplifying (or mitigating) the original shock.


4.2.1       Extending the Analysis to Endogenous Factor Supplies

Suppose factor supply curves have the form

                                              price
                        ∆ log L f = ∆ log L f         + φ f ∆ log p f /p0 − γ f ∆ log y0 ,
                                                                         


where ∆ log p f /p0 is the change in the real price of factor f , ∆ log y0 is the change in
                    
                                              price
the quantity of the final good, and ∆ log L f       is factor supply shock which could be
preference-driven or government-induced. Note that ∆ log y0 coincides with changes in
output ∆ log Y in the absence of shocks to demand, and with changes in welfare ∆ log W
with preference-driven shocks to demand. There are different possible micro-foundations
of such an equation for both labor and capital.
    When f is a form of labor, then the most obvious microfoundation is a standard labor-
leisure problem in utility. The case where φ f = γ f corresponds to the labor supply curve
that can be derived from balanced-growth preferences.10
  10 Other  microfoundations are also possible, for example, we could assume that it is supplied by a con-
tinuum of agents with balanced growth preferences who can each supply one or zero unit of labor. If they
don’t supply labor, they experience more leisure and collect some benefits b̄ f = (b f /b̄ f )(y0 /ȳ0 )1+γ f /φ f
from the government, where 1 + γ f /φ f is the degree of indexation of benefits to final output. These ben-
efits are financed by either by a uniform linear tax on factor income and benefits or by taxes on inelas-
tic factors. Natural cases to consider are then γ f = −φ f (no indexation) and γ f = 0 (full indexation).
If the utilities from leisure are Pareto distributed with parameter φ f in the population, then get exactly
the factor supply curve above with ∆ log L f = −φ f ∆ log b f . If there is a uniform increase in the prefer-
ence for leisure by ∆ log ν f , perhaps because this allows to avoid getting infected by a virus, then we get
        price
∆ log L f       = −φ f (∆ log b f + ∆ log ν f ). And if in addition the government deters work by these agents
                                                      price
with an implicit tax ∆ log τ f , then we get ∆ log L f        = −φ f (∆ log b f + ∆ log ν f + ∆ log τ f ).



                                                          30
  We can also use this relationship to model endogenous capital utilization, similar to
Christiano et al. (2005), where φ f captures the convexity of the capital utilization cost.
Under this formulation of capital utilization, we would have γ f = 0.
  The factor supply equation can also be rewritten as

                                              φf               φf − γf
               ∆ log L f = ∆ log Lshare
                                  f     +          ∆ log λ f +         ∆ log y0 ,
                                            1 + φf             1 + φf

                                            price
where ∆ log Lshare
               f    = (1/(1 + φ f ))∆ log L f   is the factor supply shock for a given factor
share and utility, which already takes into account the mitigation of the response of the
supply of the factor when its share rather than its price is held constant. Changes in the
supply of the factor ∆ log L f differs from ∆ log Lshare
                                                     f   because of endogenous changes in
factor supplies due to equilibrium changes in shares.
    We can combine these equations with the aggregation equation in Proposition 1 and
the forward-backward propagations equations in Corollary 1 to characterize the effects of
shocks on output,ales, factor shares, prices, and quantities to the first order. Note that we
do not obtain a general second-order characterization of changes in output because we
only have first-order approximation of changes in factor shares and hence of changes in
factor supplies.


4.2.2   Illustrative Examples

In this section, we give some illustrative examples.


Cobb-Douglas. We start with the case where all the elasticities of substitution in pro-
duction and in final demand are equal to one (θ j = 1 for all j ∈ 1 + N ). This case is
tractable because changes in shares are given by a simple exact log-linear closed form.
For simplicity, we also assume that φ f = γ f for all f ∈ G . To a second order, changes in
output are given by
                                                                     
                                                        φ
 ∆ log Y ≈ ∑ λk ∆ log Ak + ∑      λ f ∆ log Lshare
                                         + Covλ
                                             f              , ∆ log λ
           k ∈N            f ∈G
                                                       1+φ
                                                          !                         
  1                                                            1        φ
+ CovΩ ∆ log ω0 , ∑ Ψ(k) ∆ log Ak + ∑ Ψ( f ) ∆ log L f
       (0)                                          share                          2
                                                            + Eλ          (∆ log λ) ,
  2                k ∈N             f ∈G
                                                               2      1+φ

where the covariance and expectation on the last line are over factors f ∈ G and use initial
factor shares λ f as probabilities and where ∆ log λ f = CovΩ(0) (∆ log ω0 , Ψ( f ) /λ f ).


                                               31
    The first line is the first-order approximation, capturing the direct effect of the shocks,
as well as the endogenous reduction in factor supply. The first term accounts for the
reduction in the supply of each factor when the share rather than the price of the factor
                                                                       price
is kept constant (recall that ∆ log Lsharef   = (1/(1 + φ f ))∆ log L f ). The second term
captures the fact that overall factor supply is further reduced if the shares of more elastic
factors decrease.
    The second line is the second-order effect which captures nonlinearities. The first term
on the second line captures the nonlinear effects of changes in the composition of demand
and changes in the exogenous shocks. The final term captures the second-order effect of
endogenous labor supply. For concreteness, focus on the case of negative factor supply
shocks with ∆ log Lsharef    ≤ 0 for all f ∈ G . The first-order term Covλ (φ/(1 + φ), ∆ log λ)
shows that reductions in output are amplified if demand is redirected away (directly and
indirectly) from more elastic factors and towards less elastic factors. The reduction in
the supply of the former dominates the increase in the supply of the latter. The second-
order term 21 Eλ (φ/(1 + φ)(∆ log λ)2 ) is always positive and mitigates the reduction in
output. This is because the endogenous reduction in the supply of a factor away from
which demand is redirected comes together with a reduction in its share.
    In contrast to our analysis with inelastic factor supplies, shocks to demand do have
an effect on output even in the absence of other shocks. Indeed, the terms involving
φ/(1 + φ),which reflect the endogenous response of factor supply, remain non-zero if the
composition of demand changes, even if there are no other shocks.


Uniform elasticities and only shocks to factor supplies. We now give an illustrative
example in the case where all the elasticities of substitution in production and in final
demand are the same (θ j = θ for all j ∈ 1 + N + G ). Changes in output can then be
approximated at the first order by

  ∆ log Y =   ∑ λ f ∆ log Lshare
                           f
                                                                                      φ−γ          
                         Covλ            1
                                                    , ∆ log Lshare           Eλ          1+ φ
                                                                                                          ∑ λ f ∆ log Lshare
                                                                                                                       f
                                    1− 1+φ θ −θ 1                                     1− 1+φ θ −θ 1
                                         φ                                                φ

                     +                         1+ γ
                                                                        +                               1+ γ
                                                                                                                            ,
                                    Eλ          1+ φ
                                                                                          Eλ              1+ φ
                                             1− 1+φ θ −θ 1                                            1− 1+φ θ −θ 1
                                                 φ                                                         φ



where the covariance and expectation are over factors f ∈ G and use initial factor shares
λ f as probabilities. The first line on the right-hand side is simply Hulten’s theorem ap-
plied to the fixed-share labor supply shocks ∆ log Lshare
                                                       f   . It already contains the endoge-
nous reduction in factor supplies when shares rather than prices are held constant, and

                                                             32
when income is held constant.
    The second line contains two terms capturing the effects of endogenous changes in fac-
tor supplies arising from changes in factor shares (first term) and income (second term).
To unpack endogenous changes in factor supplies. Focus on the case of negative factor
supply shocks with ∆ log Lshare
                              f    ≤ 0 for all f ∈ G .
    We start with the first term on the second line. With complementarities (θ < 1) the
reduction in output is larger if less elastic factors are hit with larger negative ∆ log Lshare
shocks. Factors hit with larger shocks increase their income shares and those hit with
smaller shocks reduce their income shares. The change in the income shares triggers
endogenous changes in supply, and the resulting endogenous reductions in the supplies
of the latter dominate the endogenous increases in the supplies of the former if the latter
are more elastic than the former. These effects reinforce themselves, which explains the
denominator. The results are reversed with substituabilities (θ > 1).
    We now turn to the second term on the second line. There is a further reduction in
factor supplies if substitution elasticities φ f are on average greater than income elasticities
γ f because then income effect does not compensate the substitution effect on average.
    Consider the following two concrete examples. In the first example, imagine that the
factors fall into two groups: capitals K and labors W . To capture frictions in reallocation
in the short run, imagine that the different capitals cannot be reallocated one into the
other, and similarly for the labors. We assume that the supply of each of the labor is
inelastic but that the utilization of each of the capitals is endogenous with an elasticity
φ > 0 to its marginal product (but zero to income). We denote the total share of all the
capitals by λK and the total share of all the labors by λW = 1 − λK . We hit this economy
                                                                  price
with negative shocks to the supplies of the labors ∆ log L f            = ∆ log Lshare
                                                                                 f     < 0 for
f ∈ W but we do not shock the capitals. Changes in output are given at the first order by
                                                        
                                           λK φ
                                                             ∑ λ f ∈L ∆ log L f
                                                                              price
                   ∆ log Y ≈       1+                                                 .
                                      θ + (1 − λ K ) φ

Hence endogenous capital utilization amplifies the reduction in output from the negative
labor supply shocks. The effect is stronger when the elasticity of capital utilization φ is
higher, which is intuitive. The effect is also stronger when the elasticity of substitution θ
in production and in final demand is lower. This is because the negative shock to labor
lowers the marginal product of capital more when θ is lower. In particular, this means that
this effect is stronger with complementarities (θ < 1) than with substituabilities (θ > 1).
    In the second example, imagine that there are negative labor supply shocks due to
confinement efforts in a pandemic but no negative oil supply shocks. Assume that oil


                                                33
supply is less elastic than labor supplies in the short run but more elastic in the long run.
Then the share of oil drops because demand falls more than supply, more so in the short
run than in the long run. Similarly, the supply of oil drops, more so in the long run than
in the short run. As a result, output drops more in the long run than in the short run.


5           Welfare
In this section, we turn our attention to welfare. Output as measured by real GDP is not
necessarily a good measure of welfare for many reasons.11 We focus on the issue of shocks
to the composition of final demand, which matters a great deal in the context of a global
pandemic. With shocks to final demand, changes in real GDP do not reveal changes in
welfare, absent all the other usual reasons why welfare and real GDP are not the same.
    For example, if shocks to the composition of demand reflect changes in preferences,
welfare must be evaluated through a compensating variation exercise under the post-
shock preferences as explained in Section 2.5. On the other hand, if shocks to the com-
position of demand are induced by policy, say the government forces households to con-
sume a suboptimal basket, then the policy instruments represent distortions that lead to
different changes in welfare and output.12
    There are of course other (well-studied) issues that loosen the link between real GDP
and welfare, but we do not focus on them. These are: (1) real GDP ignores distribu-
tional issues;13 (2) real GDP does not measure non-market activity like leisure and home
production;14 (3) real GDP does not adequately capture the impact of new goods, disap-
    11 If
        we focus on a single period and put investments in final demand, we do not have a direct welfare
interpretation of the object that we call welfare, and we must instead interpret it as the compensating varia-
tion of the post-shock final-demand quantity index, which coincides with its change between the pre-shock
allocation and the post-shock allocation. This informative object is arguably what real GDP should seek to
measure but only measures when there are no shocks to demand, and it can be characterized. If we focus
on multiple periods at once and treat investments as intermediate goods using the model and results with
an enriched set of commodities indexed by dates and states as explained in Section 2.2, we have a direct
welfare interpretation, but the notion of real GDP that we compare it to is an inter-temporal Divisa index of
consumptions at different dates and states (we explained above how to compute real GDP within a given
period in the context of that model).
   12 These welfare calculation do not incorporate the benefits of policy interventions that correct for exter-

nalities.
   13 One imperfect way of dealing with these issues is to assume that the across-household transfers engi-

neered by the tax system are the result of welfare maximization and hence represent compensating trans-
fers. As long as preferences across households are homogenous, our propagation equations are not affected
by these transfers, and our analysis in this section continues to apply.
   14 In principle, with appropriate data, one could come up with an extended measure of real GDP that

encompasses these activities. We could then apply our results for real GDP to this extended measure and
our corrections to get welfare.



                                                      34
pearing goods, and quality adjustments. These difficult issues are well understood in the
literature, and are all very relevant in the context of the Covid crisis, but we do not have
anything to contribute about them in this paper.


5.1   Comparative Statics for Welfare
Our demand shifters ω0k /ω̄0k = exp(∆ log ω0k ) are isomorphic to subsidy wedges be-
tween transacted prices pk and perceived prices pk /(ω0k /ω̄0k ), starting from a situation
with no wedges. In this section, we find it convenient to embrace that interpretation. The
idea is that behavior is shaped not only by transacted prices but also by shadow prices.
The wedges could reflect the private internalization of some side effects associated with
the final use of the different goods or the policy interventions through taxes and quantity
restrictions.
    The distinction between preference-driven and policy-induced changes in behavior is
irrelevant for real GDP but it matters a great deal for welfare. To capture this distinc-
tion, we assume that the wedges can be decomposed accordingly. This means that we
                                  pref          pol                pref          pol
assume that ∆ log ω0k = ∆ log ω0k + ∆ log ω0k , where ∆ log ω0k and ∆ log ω0k capture
respectively preference-driven and policy-induced changes in behavior. We impose the
                                   pref                           pol
normalizations ∑k∈N Ω̄0k ∆ log ω0k = 0 and ∑k∈N Ω̄0k ∆ log ω0k = 0.


Welfare. We compute changes in welfare as compensating variation by evaluating how
much income consumers would have to give up to reach their initial utility under the
post-shock prices and preferences. Because post-shock preferences are homothetic, this
can be computed as the change in the corresponding quantity index between the pre-
shock allocation and the post-shock allocation. Under the post-shock preferences, sub-
                                     pol
sidies at the end point are ∆ log ω0k (policy distortions) and subsidies at the start point
              pref                                                                      pol
are −∆ log ω0k (mis-optimization). Equivalently, taxes at the end point are −∆ log ω0k
                                         pref
and taxes at the start point are ∆ log ω0k . We refer the reader to Appendix A.2 for more
details and for a proof of the following proposition.

Proposition 6. Changes in welfare can be approximated up to the second order by

                               1                                      
            ∆ log W ≈ ∆ log Y + ∑ Ω0k ∆ log y0k ∆ log ω0k − ∆ log ω0k ,
                                                       pref        pol
                               2 k∈N




                                             35
where

  1                                                 
  2 k∑
                                  pref           pol
        Ω 0k ∆ log y 0k   ∆ log ω 0k   − ∆ log ω 0k    ≈
     ∈N
                                                                                                      !
         1
                                                        ∑                        ∑ Ψ( f ) ∆ log L f
                                  pref            pol
        + θ0 CovΩ(0)     ∆ log ω0        − ∆ log ω0 ,          Ψ(k) ∆ log Ak +
         2                                              k ∈N                     f ∈G
                                                                                                      !
         1
                                                        ∑                        ∑ Ψ( f ) ∆ log λ f
                                pref              pol
        − θ0 CovΩ(0)     ∆ log ω0        − ∆ log ω0 ,          Ψ(k) ∆ log λk +
         2                                              k ∈N                     f ∈G
                                           1                                         
                                          + θ0 VarΩ(0) ∆ log ω pref − VarΩ(0) ∆ log ω pol ,
                                           2

where changes in output ∆ log Y, sales and factor shares ∆ log λi and ∆ log λ f are given by Propo-
sition 1 and Corollary 1.

    Starting with the first expression, we see that changes in welfare coincide with changes
in output at the first order. The corrective terms are zero when there are no shock to
                   pref           pol
demand (∆ log ω0k = ∆ log ω0k = 0 for all k ∈ 1 + N ), and so in this case, changes
in welfare and changes in output coincide at the second order, and in fact at all orders.
But these terms are not zero at the second order when there are shock to demand. In this
case, there are different nonlinearities in output and in welfare captured by the second
                                           pref          pol
term (1/2) ∑k∈N Ω0k ∆ log y0k (∆ log ω0k − ∆ log ω0k ) on the right-hand side of the first
expression. Each term k in this sum is the Harberger triangle associated with the tax
                                                                     pref          pol
on good k under the post-shock preferences. Here (1/2)(∆ log ω0k − ∆ log ω0k ) is the
average tax on good k along the path of the shocks, ∆ log y0k is the change in the final
consumption of good k along the path of the shocks, and Ω0k is the share of final good k.
    The second expression expresses the sum of these Harberger triangles as function of
the shocks and of changes in sales and expenditure shares. The first two terms on the
right-hand side capture the different interactions of shocks to demand and to productiv-
ities and factor supplies in output and in welfare. The third term captures the different
independent effect of shocks to demand in output and welfare.
    Consider for example the case when there are shocks to demand but no shocks to
productivities or to factor supplies, the first two terms are zero and we are left with the
                                      pref                   pol
third term (1/2)θ0 (VarΩ(0) (∆ log ω0 ) − VarΩ(0) (∆ log ω0 )). If the shock to demand is a
                                      pol
pure shock to preferences (∆ log ω0k = 0 for all k ∈ N ), then this term is positive. In this
case, changes in welfare ∆ log W > 0 reflect the gains from re-optimizing consumption
under the new preferences starting from a sub-optimal initial allocation. If the shock to
                                                    pref
demand is entirely induced by policy (∆ log ω0k = 0 for all k ∈ N ), then this term


                                                   36
is negative. In this case, changes in welfare ∆ log W < 0 reflect the misallocation losses
induced by the policy distortions. In both cases, there are no changes in output (∆ log Y =
0) but there are changes in welfare (∆ log W 6= 0).


Price deflators. This analysis also has dual implications for price deflators. It implies
that the GDP deflator and the CPI are poor guides to welfare when there are shock to de-
mand. For example, changes in the GDP deflator ∆ log P = ∆ log GDP − ∆ log Y coincide
with changes in the welfare deflator ∆ log PW = ∆ log GDP − ∆ log W only when there
are no shocks to demand.


5.2   Illustrative Example
We derive a fully-worked out example illustrating the difference between output and
welfare in a Cobb-Douglas economy. We refer the reader to Appendix A.2 for another
fully-worked out example with acyclic economies.
    Suppose that all the elasticities of substitution in production and in final demand are
equal to one (θ j = 1 for all j ∈ 1 + N ). Then we already saw in Proposition 3 that changes
in output can be approximated to the second order by

  ∆ log Y ≈   ∑      λk ∆ log Ak +   ∑ λ f ∆ log L f
              k ∈N                   f ∈G
                                                                                                            !
                             1
                                                              ∑                        ∑ Ψ( f ) ∆ log L f
                                                    pref
                            + CovΩ(0)        ∆ log ω0 ,              Ψ(k) ∆ log Ak +                            .
                             2                                k ∈N                     f ∈G


   We now turn to changes in welfare. If the shocks to demand are entirely induced by
policy, changes in welfare can be approximated up to the second order by

                                                  1
                         ∆ log W ≈ ∆ log Y −
                                                  2    ∑ λ f VarΞ( f ) (∆ log ω0 ) ,
                                                       f ∈G


where Ξ is the G×(1 + N + G) matrix with f i-th element Ξi f = Ω0i Ψi f /λ f which measure
the fraction of the income share of factor f coming directly and indirectly from spending
on good i in final demand. Hence for a given factor f , the term VarΞ( f ) (∆ log ω0 ) is the
variance of the different shocks to demand ∆ log ω0k using Ξk f the probability measure.
In this case, changes in welfare discount entirely the interactions between shocks to de-
mand and shocks to productivities and factor supplies. For example, reallocation of de-
mands toward expanding factors increases output but does not increase welfare because


                                                      37
these reallocations are wasteful since they reflect distortions. As already discussed above,
changes in welfare also feature independent losses from shocks to demand.
   If instead the shocks to demand are pure preference shocks, changes in welfare can be
approximated up to the second order by

                            1
                            2 g∑
    ∆ log W ≈ ∆ log Y + +         λ g VarΞ(g) (∆ log ω0 )
                               ∈G
                                                                                                      !
                         1
                                                        ∑                        ∑ Ψ( f ) ∆ log L f
                                                 pref
                        + CovΩ(0)         ∆ log ω0 ,           Ψ(k) ∆ log Ak +                            .
                         2                              k ∈N                     f ∈G


In this case, changes in welfare count the interactions between shocks to demand and
shocks to productivities and factor supplies twice compared to changes in output. For
example, reallocation of demands toward expanding factors increases welfare twice as
much as output because changes in welfare use stable post-shock preferences. As already
discussed above, changes in welfare also feature independent gains from shocks to de-
mand.


6     Quantitative Application
For our quantitative experiment, we use an input-output model to capture a stylized ver-
sion of the U.S. economy. We hit this economy with different labor supply shocks and
analyze the response of aggregate output and welfare. At present, there is no data in how
the composition of final demand changed due to the shock. In the next revision of the
paper, once this data has become available, we also quantitatively investigate the impor-
tance of changes in the composition of final demand and productivity shocks for both
welfare and real GDP.


6.1    Setup
Calibrating the economy. There are 66 industries and industrial production functions
combine labor, capital, and intermediates. The share parameters of the functions are cal-
ibrated so that at the initial pre-shock allocation, expenditure shares match those in the
input-output tables provided by the BEA. We focus on the short run and assume that
labor and capital cannot be reallocated across sectors.
   The nesting structure is the following. In each sector, labor and capital are combined
a value-added nest with an elasticity η, intermediates are combined in an intermediates


                                                 38
nest with an elasticity θ, these two nests are then combined in a sector nest with an elas-
ticity e, and final consumptions are combined in a final-demand nest with an elasticity σ.
We therefore allow for differences in the elasticities, but we do not allow them to vary by
sector, because such disaggregated estimates are not available.
    We construct the input-output matrix using the annual U.S. input-output data from
the BEA, dropping the government, noncomparable imports, and second-hand scrap in-
dustries. The dataset contains industrial output and inputs for 66 industries.
    Based on the empirical literature, there is considerable uncertainty as to what the right
values for these elasticities should be. Atalay (2017), Herrendorf et al. (2013), and Ober-
field and Raval (2014), all of use an elasticity of substitution in consumption σ slightly less
than one. Atalay (2017) estimates the elasticity of substitution across intermediates and
value added e to be between 0.4 and 0.8 and Boehm et al. (2019), who estimate this elas-
ticity to be close to 0. Atalay (2017) estimates the elasticity of substitution across interme-
diate inputs to be θ = 0.001. Finally the typical estimates for the elasticity of substitution
between capital and labor η range between 0.3 and 1.
    Not all these elasticities are estimated at the same horizon, and this matters since we
can expect elasticities to be lower in the short run than in the medium run. For instance,
Boehm et al. (2019), who estimate short-run elasticities, find lower estimates than studies
that use long-run data.
    To illustrate the range of plausible possibilities, we consider three calibrations: a cal-
ibration with very low elasticities (σ, θ, e, η ) = (0.5, 0.001, 0.3, 0.2); a calibration with
low elasticities (σ, θ, e, η ) = (0.7, 0.001, 0.3, 0.2); and a calibration with higher elastici-
ties (σ, θ, e, η ) = (0.95, 0.001, 0.7, 0.5). We think of them as being relevant in the very short
run, the short run, and the medium run. We also report the results for a log-linear Cobb-
Douglas economy with (σ, θ, e, η ) = (1, 1, 1, 1) where Hulten’s theorem holds exactly and
not just as a first-order approximation.


Calibrating the shocks. We consider shocks to labor supplies. The shock is a reduction
in labor supplies calibrated to match the changes in hours worked by sector from the
May 2020 BLS Economic News release. There are concerns that these numbers under-
estimated the actual reductions that took place because the underlying survey may not
appropriately classify furloughed or absent employees as temporarily unemployed. To
allow for this possibility, we consider different scenarios which multiply the log reduction
in hours by industry, reported by the BLS, by a scaling factor x ∈ [0, 1.5]. We refer to x
as the size of the shock. As mentioned before, when x = 1, aggregate hours falls by 13%,
whereas when x = 1.5, aggregate hours falls by 20%. For concreteness, we focus our


                                               39
attention on two scenarios: in the less extreme scenario, we assume that in each sector,
the reduction in hours worked coincides with that given by the BLS, so that x = 1; in the
more extreme scenario, we inflate the reduction in hours worked in each sector reported
by the BLS by 50%, so that x = 1.5.

                 Scenario      Very short run    Short run   Medium run    Cobb-Douglas
   Less extreme (x = 1)                  12%          11%           10%             9%
  More extreme (x = 1.5)                 28%          15%           17%            14%

     Table 1: Output reduction as a function of the size of the labor supply shock x.

   Table 1 displays the response of output for our three benchmark scenarios (short-run
or medium-run) depending on the elasticities of substitution (lower or higher), as well
as the log-linear first-order approximation implied by Hulten’s theorem (equivalently,
a Cobb-Douglas model). Figure 5 displays the same results as Table 1 but explores a
wider range of scenarios. The Cobb-Douglas economy serves as a yardstick to measure
nonlinearities: nonlinearities account for the reductions in output beyond those of the
Cobb-Douglas economy.

                1
                                                                 Cobb-Douglas
                                                                 Medium run
                                                                 Short run
             0.95                                                Very short run


              0.9



             0.85



              0.8



             0.75
                    0    0.2       0.4     0.6       0.8     1     1.2     1.4

         Figure 5: Output change ∆Y/Ȳ as a function of the size of the shock x.

   In the more extreme scenario, output drops by 14% in the Cobb-Douglas economy,

                                                40
by 17% in the economy with higher elasticities, by 25% in the economy with low elastic-
ities, and by 28% in the economy with very low elasticities. In this case, nonlinearities
considerably amplify the impact of the shock on output.
    In the less extreme scenario, output drops by 9% in the Cobb-Douglas economy, by
10% in the economy with higher elasticities, by 11% in the economy with low elasticities,
and by 12% in the economy with very low elasticities. Nonlinearities significantly amplify
the impact of the shock on output, although less than in the more extreme scenario.
    In both scenarios, and for all sets of elasticities, nonlinearities play an important role
in amplifying the reduction in output. That nonlinear amplification is greater in the more
extreme scenario is intuitive since nonlinearities matter more for larger shocks. That non-
linear amplification is greater with lower elasticities is intuitive since nonlinear amplifi-
cation of negative shocks increases with the degree of complementarities in the economy.
    At the time of writing, most forecasts for the reduction in output cluster around a
reduction of 12%. This number falls squarely in the range of the predictions of our model,
and could reflect a significant amount of nonlinear amplification. However, the reduction
in output in the data is likely to under-estimate the true decline in output. One reason is
because the GDP deflator is likely under-estimated as many goods became unavailable
during the period of March-April. One way to think about it is that the prices of these
goods increased to infinity.Because these price increases will not be recorded in the GDP
deflator, the change in the GDP deflator will be biased downwards, and, as a result, the
change in real GDP will be biased upwards. Another reason why the change in real GDP
may be biased downwards is that it the change in the GDP deflator is not computed in
continuous time but as a discrete-time approximation. It is therefore entirely possible
that “true” real GDP, measured in continuous time, is a lot lower than the official number
suggests. The more sudden is the shock, the worse is the discrete time approximation to
the continuous time change, and the more room there is for nonlinear amplification.


7    Conclusion
This paper analytically characterizes and numerically quantifies the importance of non-
linearities. We show that in the presence of nonlinear production and consumption func-
tions, heterogeneous negative supply shocks can be very costly to aggregate output. Our
results suggest that the heterogeneous nature of the shock likely significantly compounds
its negative effects. Large shocks to some sectors drag down other sectors with them.
Changes in the composition of final demand, depending on whether they increase or re-
duce spending on negatively affected sectors directly and directly through their supply

                                             41
chains, can further amplify or mitigate these nonlinearities. In future versions of the pa-
per, as more data becomes available, we hope to revise these numbers to better reflect
reality.


References
Acemoglu, Daron, Victor Chernozhukov, Iván Werning, and Michael D. Whinston, “A
 Multi-Risk SIR Model with Optimally Targeted Lockdown,” Technical Report 2020.

Alvarez, Fernando E, David Argente, and Francesco Lippi, “A simple planning problem
  for covid-19 lockdown,” Technical Report, National Bureau of Economic Research 2020.

Atalay, Enghin, “How important are sectoral shocks?,” American Economic Journal:
  Macroeconomics, 2017, 9 (4), 254–80.

Atkeson, Andrew, “How Deadly Is COVID-19? Understanding The Difficulties With Es-
  timation Of Its Fatality Rate,” Technical Report, National Bureau of Economic Research
  2020.

  , “What will be the economic impact of COVID-19 in the US? Rough estimates of disease
  scenarios,” Technical Report, National Bureau of Economic Research 2020.

Baqaee, David and Emmanuel Farhi, “A Short Note on Aggregating Productivity,”
  NBER Working Papers 25688, National Bureau of Economic Research, Inc March 2019.

  and , “The Macroeconomic Impact of Microeconomic Shocks: Beyond Hulten’s The-
  orem,” Econometrica (Forthcoming), 2019.

  and , “Keynesian Production Networks with an Application to the Covid-19 Crisis,”
  Technical Report 2020.

Barro, Robert J, José F Ursúa, and Joanna Weng, “The coronavirus and the great in-
  fluenza pandemic: Lessons from the "spanish flu" for the coronavirus’s potential effects
  on mortality and economic activity,” Technical Report, National Bureau of Economic
  Research 2020.

Barrot, Jean-Noel, Basile Grassi, and Julien Sauvagnat, “Sectoral effects of social dis-
  tancing,” Available at SSRN, 2020.




                                            42
Berger, David W, Kyle F Herkenhoff, and Simon Mongey, “An SEIR infectious disease
  model with testing and conditional quarantine,” Technical Report, National Bureau of
  Economic Research 2020.

Bethune, Zachary A and Anton Korinek, “Covid-19 Infection Externalities: Trading Off
  Lives vs. Livelihoods,” Technical Report, National Bureau of Economic Research 2020.

Bigio, Saki, Mengbo Zhang, and Eduardo Zilberman, “Transfers vs Credit Policy,” Tech-
  nical Report 2020.

Bodenstein, Martin, Giancarlo Corsetti, and Luca Guerrieri, “Social Distancing and
  Supply Disruptions in a Pandemic,” 2020.

Boehm, Christoph E, Aaron Flaaen, and Nitya Pandalai-Nayar, “Input linkages and the
  transmission of shocks: Firm-level evidence from the 2011 Tōhoku earthquake,” Review
  of Economics and Statistics, 2019, 101 (1), 60–75.

Bonadio, Barthélémy, Zhen Huo, Andrei A. Levchenko, and Nitya Pandalai-Nayar,
  “Global Supply Chains in the Pandemic,” Technical Report 2020.

Caballero, Ricardo J and Alp Simsek, “A Model of Asset Price Spirals and Aggregate
  Demand Amplification of a’COVID-19’Shock,” Available at SSRN 3576979, 2020.

Cakmakli, Cem, Selva Demiralp, Sebnem Kalemli-Ozcan, Sevcan Yesiltas, and
  Muhammed A Yildirim, “COVID-19 and Emerging Markets: An Epidemiological
  Multi-Sector Model for a Small Open Economy with an Application to Turkey,” Work-
  ing Paper 27191, National Bureau of Economic Research May 2020.

Carvalho, Vasco M and Alireza Tahbaz-Salehi, “Production networks: A primer,” An-
  nual Review of Economics, 2019, 11, 635–663.

Christiano, Lawrence J, Martin Eichenbaum, and Charles L Evans, “Nominal rigidities
 and the dynamic effects of a shock to monetary policy,” Journal of political Economy, 2005,
 113 (1), 1–45.

Dingel, Jonathan I. and Brent Neiman, “How Many Jobs Can be Done at Home?,” NBER
 Working Papers 26948, National Bureau of Economic Research, Inc April 2020.

e Castro, Miguel Faria, “Fiscal policy during a Pandemic,” Technical Report 2020.

Eichenbaum, Martin S, Sergio Rebelo, and Mathias Trabandt, “The macroeconomics of
  epidemics,” Technical Report, National Bureau of Economic Research 2020.

                                            43
  ,   , and   , “The macroeconomics of testing during epidemics,” Technical Report 2020.

Fernández-Villaverde, Jesús and Charles I Jones, “Estimating and Simulating a SIRD
  Model of COVID-19 for Many Countries, States, and Cities.”

Fornaro, Luca and Martin Wolf, “Covid-19 coronavirus and macroeconomic policy,”
  2020.

Galle, Simon, Andres Rodriguez-Clare, and Moises Yi, “Slicing the pie: Quantifying
 the aggregate and distributional effects of trade,” Technical Report, National Bureau of
 Economic Research 2017.

Glover, Andrew, Jonathan Heathcote, Dirk Krueger, and José-Víctor Ríos-Rull, “Health
 versus wealth: On the distributional effects of controlling a pandemic,” 2020.

Gourinchas, Pierre-Olivier, “Flattening the pandemic and recession curves,” Mitigating
 the COVID Economic Crisis: Act Fast and Do Whatever, 2020, p. 31.

  , Sebnem Kalemli-Ozcan, Veronika Penciakova, and Nick Sander, “COVID-19 an
  Business Failures,” Working Paper, Berkeley May 2020.

Guerrieri, Veronica, Guido Lorenzoni, Ludwig Straub, and Iván Werning, “Macroeco-
 nomic Implications of COVID-19: Can Negative Supply Shocks Cause Demand Short-
 ages?,” Technical Report, National Bureau of Economic Research 2020.

Hall, Robert E, Charles I Jones, and Peter J Klenow, “Trading off consumption and
 covid-19 deaths,” Technical Report, Working Paper 2020.

Herrendorf, Berthold, Richard Rogerson, and Akos Valentinyi, “Two perspectives on
 preferences and structural transformation,” American Economic Review, 2013, 103 (7),
 2752–89.

Hulten, Charles R, “Growth accounting with intermediate inputs,” The Review of Eco-
 nomic Studies, 1978, pp. 511–518.

Jones, Callum J, Thomas Philippon, and Venky Venkateswaran, “Optimal mitigation
  policies in a pandemic: Social distancing and working from home,” Technical Report,
  National Bureau of Economic Research 2020.

Jones, Charles I, “Intermediate goods and weak links in the theory of economic develop-
  ment,” American Economic Journal: Macroeconomics, 2011, pp. 1–28.


                                           44
Jorda, Oscar, Sanjay R Singh, and Alan M Taylor, “Longer-run economic consequences
  of pandemics,” Technical Report, National Bureau of Economic Research 2020.

Kaplan, Greg, Benjamin Moll, and Gianluca Violante, “Pandemics according to
 HANK,” 2020.

Krueger, Dirk, Harald Uhlig, and Taojun Xie, “Macroeconomic dynamics and realloca-
  tion in an epidemic,” 2020.

McKenzie, Lionel W, “On the existence of general equilibrium for a competitive market,”
 Econometrica: journal of the Econometric Society, 1959, pp. 54–71.

Mongey, Simon, Laura Philosoph, and Alex Weinberg, “Which Workers Bear the Burden
 of Social Distancing Policy?,” University of Chicago Working Paper 2020.

Oberfield, Ezra and Devesh Raval, “Micro Data and Macro Technology,” Working Paper
 20452, National Bureau of Economic Research September 2014.




                                          45
A     Appendix

A.1       Proofs
Proposition 1.          We use Hulten’s theorem

                                d log Ys =        ∑          λk,s d log Ak,s +          ∑ λ f ,s d log L f ,s .
                                                k ∈N                                    f ∈G


Integrating to get                                                             Z
                                                     ∆ log Y =                     d log Ys ,

we get                                               Z                                          Z
                           ∆ log Y =          ∑              λk,s d log Ak,s +          ∑           λ f ,s d log L f ,s ,
                                          k ∈N                                          f ∈G


                                Z                                         Z
 ∆ log Y =        ∑     λk,s̄       d log Ak,s +         ∑ λ f ,s̄             d log L f ,s
                 k ∈N                                    f ∈G
                                                         Z                                                     Z
                                          +    ∑             (λk,s − λk,s̄ )d log Ak,s +                 ∑         (λ f ,s − λ f ,s̄ )d log L f ,s ,
                                              k ∈N                                                      f ∈G



                                Z                                         Z
 ∆ log Y ≈        ∑     λk,s̄       d log Ak,s +         ∑      λ f ,s̄        d log L f ,s
                 k ∈N                                    f ∈G
                       d log λk,s
                                          Z
                                                                             d log λ f ,s      Z
      +   ∑      λk,s̄
                           ds
                                  |s=s̄       (s − s̄)d log Ak,s + ∑ λ f ,s̄
                                                                                 ds
                                                                                          |s=s̄ (s − s̄)d log L f ,s ,
          k ∈N                                                     f ∈G




 ∆ log Y ≈        ∑     λk ∆ log Ak +         ∑ λ f ∆ log L f
                 k ∈N                         f ∈G
                                                         1                            1
                                                  +         ∑
                                                         2 k∈N
                                                               λk ∆ log λk ∆ log Ak +
                                                                                      2                         ∑ λ f ∆ log λ f ∆ log L f .
                                                                                                               f ∈G


A.2       Welfare in Section 5
To compute welfare, we find it more convenient to think of demand shocks as shocks
∆ log ω0k to subsidy wedges transacted prices pk and perceived prices pk /ω0k with ω̄0k =
                                                         pref         pol
1. Changes in these subsidy wedges ∆ log ω0k = ∆ log ω0k + ∆ log ω0k reflect changes
                                                                                 pref
in preferences and government interventions captured respectively by ∆ log ω0k and


                                                                              46
       pol
∆ log ω0k . We impose the normalizations

                           ∑                             ∑
                                               pref                        pol
                                  Ω̄0k ∆ log ω0k =             Ω̄0k ∆ log ω0k = 0.
                           k ∈N                         k ∈N

    We compute changes in welfare as changes in compensating variations. To do so, we
think of the wedges as actual actual subsidies ∆ log ω0k and remove the distinction be-
tween transacted and perceived prices. Because preferences are homothetic, we can com-
pute compensating variation as the change in output along a path that starts ends at the
                                    pref                                                  pol
start point with subsidies −∆ log ω0k , at ends at the end point with subsidies ∆ log ω0k .
Doing so ensure that we compute the change in a homothetic index corresponding to the
post-shock preferences.
    For example, when shocks to demand reflect changes in preferences, subsidies are
          pref
−∆ log ω0k at the start point because the initial allocation does not minimize expendi-
ture given utility under the post-shock preferences (it minimizes expenditure under the
pre-shock preferences), and subsidies are 0 at the end point because the final allocation
minimizes expenditure under the post-shock preferences. Similarly, when shocks to de-
mand are induced by policy, subsidies are 0 at the start point because the initial allocation
minimizes expenditure given utility (since there are no policy distortions), and subsidies
            pol
are ∆ log ω0k at the end point because the final allocation do not minimize expenditure
(since there are distortions induced by policy).
    We compute changes in output along this path using the formula in derived in Baqaee
and Farhi (2019a) and get

  ∆ log W ≈     ∑       λi ∆ log Ai +   ∑ λ f ∆ log L f
              i ∈N −G                   f ∈G
                        1                               1
                  +         ∑
                        2 i∈N −G
                                 λi ∆ log λi ∆ log Ai +
                                                        2        ∑ λ f ∆ log λ f ∆ log L f
                                                                 f ∈G
                                                      1                                                 
                                                      2 k∑
                                                                                      pref           pol
                                                  +         Ω 0k ∆ log y 0k   ∆ log ω 0k   − ∆ log ω 0k    .
                                                         ∈N

We then use
                                                                                                             !
    ∆ log y0k = θ0       ∆ log ω0k +      ∑       Ψki ∆ log Ai −    ∑ Ψk f       ∆ log λ f − ∆ log L f
                                                                                                         
                                                                                                                 .
                                        i ∈N −G                     f ∈G




                                                       47
Replacing and manipulating, we get

  ∆ log W ≈     ∑       λi ∆ log Ai +    ∑ λ f ∆ log L f
              i ∈N −G                    f ∈G
                        1                               1
                  +         ∑
                        2 i∈N −G
                                 λi ∆ log λi ∆ log Ai +
                                                        2                    ∑ λ f ∆ log λ f ∆ log L f
                                                                             f ∈G
                                                                                                                                    !
         1
                                                                       ∑                                       ∑ Ψ( f ) ∆ log L f
                                pref              pol
        + θ0 CovΩ(0)     ∆ log ω0        − ∆ log ω0 ,                         Ψ(i) ∆ log Ai +
         2                                                          i ∈1+N                                    f ∈G
                                                                                                                                    !
         1
                                                                       ∑                                      ∑ Ψ( f ) ∆ log λ f
                                  pref                       pol
        − θ0 CovΩ(0)      ∆ log ω0       − ∆ log ω0 ,                         Ψ(i) ∆ log λi +
         2                                                          i ∈1+N                                    f ∈G
                                           1         
                                                              pref
                                                                             
                                                                                      pol
                                                                                          
                                          + θ0 VarΩ(0) ∆ log ω0      − VarΩ(0) ∆ log ω0      ,
                                           2

where recall that ∆ log ω0k = ∆ log ω0k .

A.2.1    Additional Illustrative Example with Acyclic Networks

Suppose now that the production network is acyclic. We already saw in Proposition 5
and exact expression for changes in output ∆ log Y when there are no shocks to demand,
as well as a second-order approximation even when there are shocks to demand. We
can strengthen the results for welfare and derive an exact recursive characterization from
upstream to downstream even when there are shocks to demand:

                                                                                                                      θ0
                                                                                                          θ0 −1        θ0 −1
                                                                              pref
                                                                      ∆ log ω0j
                                                                                                     
                e∆ log W = e∆ log y0 =           ∑          Ω̄ij e                      e∆ log y j
                                                                                                           θ0
                                                                                                                              ,
                                                j ∈ u (i )


where and we have the recursion from upstream to downstream

                                                                                                           θi
                                                                                                          θ i −1
                                                                                          θ i −1
                         e∆ log yi = e∆ log Ai          ∑          Ω̄ij e∆ log y j
                                                                                              θi
                                                                                                                  ,
                                                       j ∈ u (i )


for i 6= 0 and where ∆ log yi = ∆ log L f if i = f ∈ G is a factor . We also have fully-solved-
out approximations of changes in output to the second order using Proposition 6 and the
first-order approximations for changes in sales and factor shares given in Appendix A.3.
    In this case, the shocks do not lead to any reallocations of resources. Shocks to de-
mand therefore have no independent impact on welfare. In the presence of other shocks,
preference-driven shocks to demand only change the final-demand quantity index used

                                                               48
to evaluate changes in final consumptions given by the shocks to productivities and factor
supplies, and policy-driven shocks to demand have no impact. These results generalize
to sub-networks with uniform elasticities embedded in acyclic networks.


A.3   Expressions for Sales and Factor Shares in Section 3.3
Proposition 3.        We have exact and first-order approximations of changes in sales and
factor shares:
                                 λ̄i exp(∆ log λi ) = CovΩ̄(0) (∆ log ω0 , Ψ̄(i) ).


Proposition 4. We have exact and first-order approximations of changes in factor shares:

                                                                                          θ −1
                                                                              ∆ log L f        θ
                                                                   λ̄ f e
                                               ∆ log λ f
                                      λ̄ f e                =                                  θ −1 ,
                                                                                   ∆ log L f
                                                                ∑ f ∈G λ̄ f e
                                                                                                   θ




                                                     θ−1
                              λ f ∆ log λ f ≈            λ f ∆ log L f − Eλ (∆ log L) .
                                                                                     
                                                      θ

Proposition 5. We have exact expressions for sales and factor shares as a recursion from
downstream to upstream

                                                                                                                       θ d ( i ) −1
                                                                            δ0d(i) θ0 ∆ log ω0i
                                                                Ω̄d(i)i e                              e∆ log yi
                                                                                                                        θ d (i )
                   ∆ log λi                ∆ log λd(i)
           λ̄i e              = λ̄d(i) e                                                                                                         ,
                                                                                                                             θ d ( i ) −1
                                                                                  δ0d(i) θ0 ∆ log ω0j
                                                                                                          
                                                           ∑ j∈d(i) Ω̄d(i) j e                                e∆ log y j
                                                                                                                                      θ d (i )




where by definition ∆ log λ0 = 0. Similarly, we have fully-solved-out approximations of
changes in sales and factor shares (to the first-order):
                                         
 λi ∆ log λi ≈ θ0 CovΩ(0) ∆ log ω0 , Ψ(i)
                                                                                                                                                     !
                                         θj − 1
                        +      ∑      λj
                                            θj
                                                CovΩ( j)              ∑       Ψ(k) ∆ log Ak +                 ∑ Ψ( f ) ∆ log L f , Ψ(i)                  .
                              j∈1+N                                   k ∈N                                    f ∈G




                                                                    49
A.4     General Expression for the Redeploying-Suppressed-Factors Ex-
        periment in Section 4.1.3
The gains from reallocations with general shocks are given up to the second order by
                                                 
                                     1       λh
  ∆ log Ỹ − ∆ log Y ≈ −λh ∆ log Lh + λh 1 −        (∆ log Lh )2
                                     2       λ h0
                                                                                             !
                         1 θj − 1
             +    ∑       λ
                         2 j θj
                                  VarΩ( j)   ∑      Ψ(k) ∆ log Ak +    ∑ Ψ( f ) ∆ log L̃ f
                 j∈1+N                       k ∈N                      f ∈G
                                                                                             !
                         1 θj − 1
             −    ∑       λ
                         2 j θj
                                  VarΩ( j)   ∑      Ψ(k) ∆ log Ak +    ∑ Ψ( f ) ∆ log L f
                 j∈1+N                       k ∈N                      f ∈G
                                                                                                     
                                                     1                                   λh
                                                    − θ0 CovΩ(0)       ∆ log ω0 , Ψ(h0 )      ∆ log Lh .
                                                     2                                   λ h0

A.5     Factor Supply à la Roy
We now combine our baseline model with a labor supply block à la Roy.


A.5.1   Extending the Model

We use the Roy model of Galle et al. (2017). We assume that there are groups indexed
by h ∈ H, each of size Lh . Each group supplies one or many factors f ∈ G h , but that no
factor is supplied by two groups. The wages of the different factors are p f . The supply of
each factor f is essentially given by the equivalent of a CES production function for joint
production. This production function also has a micro-foundation where a heterogeneous
population of size Lh , each with one physical unit of labor, draws different efficiency units
of labor in the different sectors f ∈ G h according to independent Frechet distributions and
chooses the sector where it earns the most.
    We allow for tax wedges ω f between perceived wages p f /ω f and true wages p f . We
normalize these tax wedges with ∑ g∈G h λ̄hg ω g = 1. The tax wedges are equal to one at the
initial equilibrium (ω̄ f = 1). Shocks to the tax wedges are shocks to the composition of
labor. They can represent changes in labor-supply preferences. For example, a tax wedge
can open up (∆ log ω f > 0) because supplying one unit of labor f puts an agent at risk of
being infected by a virus (an internality). The tax wedges can also represent regulations
by the government. For example, a tax wedge can open up because the government is
worried that an agent supplying one unit of labor f puts others at risk of being infected by
the virus (an externality). Similarly, shocks to Lh , can represent either preference-driven


                                                    50
or policy-induced changes in overall factor supply. For example, this could come from
voluntary or mandated confinement of certain population groups based on demographics
to avoid infection and contagion.
    For both types of shocks to factor supplies, as in the baseline model, the distinction
between preference-driven and government-induced is irrelevant for the equilibrium al-
location and for real GDP or output. This distinction only becomes relevant for welfare,
and we refer the reader to Appendix A.5.3 below for the corresponding analysis.
    The supply the different types of labor is given by

                                                            p     ω̄ f
                                                                           φ h −1
                                                                  f
                                Lf         Lh                 p̄ f ω f
                                       =                                                    h
                                                                                                  ,
                                L̄ f       L̄h                                 1+φh  1+φ φh
                                                                      p g ω̄ g
                                                   ∑ g∈G h λ̄hg       p̄ g ω g


where λhg = λ g /λh and λh = ∑ g∈G h λ g , and where φh is the elasticity of substitution
between factors. We also define λhg = 0 if g ∈
                                             / G h.
Proposition 7. Changes in output can be approximated to the second order by

  ∆ log Y ≈      ∑       λi ∆ log Ai +     ∑     λh ∆ log Lh
              i ∈1+N                       h∈H
                           1                              1
                       +       ∑
                           2 i∈1+N
                                   λi ∆ log λi ∆ log Ai + ∑ λh ∆ log λh ∆ log Lh
                                                          2 h∈H
                                                  1                               
                                               + ∑ λ ∑ λ f ∆ log L f − ∆ log L ∆ log ω f ,
                                                         h      h                h
                                                  2 h∈H       h           f ∈G


where

  1                                          
  2 h∑        ∑
        λh            λhf ∆ log L f − ∆ log Lh ∆ log ω f =
     ∈H      f ∈G h

             1          h                                1        φh
                    h φ
                ∑                 ∆           ∆               ∑           h
                                                                                  h ∆ log ω f ,
                                                                                             
                  λ       Cov   h   log λ f ,   log ω f  −              λ   Var
             2 h∈H 1 + φh     λ
                                                           2 h∈H 1 + φh         λ



and where changes in sales and factor shares ∆ log λi and ∆ log λh ≈ ∑ g∈G h λhg ∆ log λ g are given
as function of microeconomic primitives by Corollary 1 combined with the factor supply equations
∆ log L f ≈ ∆ log Lh + (φh /(1 + φh ))((∆ log λ f − ∆ log ω f ) − Eλh (∆ log λ − ∆ log ω )).
   The first-order terms on the first line on the right-hand side of the first expression, as
well as the second-order terms on the second line, are familiar from the previous analysis.
Even though shocks to tax wedges do not directly appear in these terms, it is important to

                                                            51
realize that they appear indirectly by impacting changes in sales and factor shares ∆ log λi
and ∆ log λh .
    There are also new second-order terms on the third line of the first expression. These
terms account for the impact of the shocks to the wedges over and above their impact
on changes in sales and factor shares ∆ log λi and ∆ log λh on the second line. These new
effects are intuitive. It is important to realize that output is not welfare. And from the
perspective of output, tax wedges can be thought of as distortions. As explained above,
this is true whether or not they represent shocks to preferences or government interven-
tions. The reason is that they are not reflected in transacted prices and so their potential
preference benefits are not picked up by real GDP or output. Because tax wedges act as
distortions, they create misallocation, and the two new terms measure this misallocation
as the sizes of Harberger triangles (1/2) ∑h∈H λh ∑ f ∈G h λhf (∆ log L f − ∆ log Lh )∆ log ω f .
They reduce output if they discourage the supplies of factors that decrease in equilibrium.
    These new terms can be rewritten using the second expression. They result in addi-
tional output reductions if tax wedges discourage the supply of factors with decreasing
equilibrium shares as measured by (1/2) 21 ∑h∈H λh (φh /(1 + φh ))Covλh (∆ log λ f , ∆ log ω f ).
They also result in additional output reductions if they are very dispersed as measured
by (1/2) 21 ∑h∈H λh (φh /(1 + φh ))Varλh (∆ log ω f ). Both effects are proportional with the
elasticities of substitution in factor supply φh /(1 + φh ).


A.5.2   Illustrative Examples

As a concrete example, imagine that one of the sectors is restaurants (R) which is pro-
duced using a specific form of labor (LR) and which sells only to final demand. Imagine
that another of the sectors is online retail which is produced with an aggregate of two
forms of labor (LOR0 ) and (LOR) with initial shares ΩOR,LOR0 and ΩOR,LOR and with an
elasticity of substitution θ > 1. Labor LOR0 is supplied inelastically and LOR is supplied
by the same group (LR + LOR) as LR with an elasticity φ. Assume that all the elasticities
of substitution in production and in final demand are equal to one except for that between
LOR and LOR0 in the production of OR. Imagine that because of confinement measures
a pandemic, preferences shift away from restaurants (∆ log ω0R < 0) and towards online
retail (∆ log ω0OR > 0) and that there is a reduction (∆ log L LR+ LOR < 0) in the overall
supply of workers supplying LR and LOR. The impact of the shocks on output is given




                                              52
by

  ∆ log Y ≈ λ L LR+ LOR ∆ log L LR+ LOR
                                θ −1
                       1          θ λ LOR (1 − ΩOR,LOR )
                     +        φ θ −1                                  (∆ log L LR+ LOR )2
                             1+φ θ (1 − λ LOR ) (1 − ΩOR,LOR )
                       21−
                                                                                            
                                                                                φ θ −1
         1                λ LOR ∆ log ω0OR + λ R ∆ log ω0R 1 −             (1 − ΩOR,LOR )
                                                                               1+ φ θ
        + ∆ log L LR+ LOR                                                                 .
         2                            1 − 1+φ θ −θ 1 (1 − λ LOR ) (1 − ΩOR,LOR )
                                           φ



The first-order impact of the shock on output is negative. In the absence of shocks to de-
mand, the second-order terms mitigates the reduction in output, the more so, the higher
is the elasticity of reallocation φ, but even when there is no reallocation (φ = 0). When
there is no reallocation, this is because the share of LOR decreases as OR substitutes
towards LOR0 . When there is reallocation (φ > 0), LR + LOR reallocates towards LR
and away from LOR, and this further mitigates the reduction in output. When there
are also shocks to demand, these reallocation patterns can be reversed so hat LR + LOR
reallocates towards LOR and away from LR. A sufficient condition for the shock to be
further mitigated is that the shock to demand redirects demand away from LR + LOR
(λ LOR ∆ log ω0OR + λ R ∆ log ω0R < 0).


A.5.3   Welfare
                                                                                            pref
We proceed as in Appendix A.2. Changes in these tax wedges ∆ log ω f = ∆ log ω f                   +
        pol
∆ log ω f     reflect changes in preferences and policy interventions captured respectively
              pref              pol
by ∆ log ω f         and ∆ log ω f . We impose the normalizations


                              ∑ λ̄ f ∆ log ω f          ∑ λ̄ f ∆ log ω f
                                             pref                      pol
                                                    =                        = 0.
                              f ∈G                      f ∈G


For simplicity, we assume that there are no shocks to demand. The results can easily be
extended with shocks to demand by combining this analysis with that of Appendix A.2.
We get




                                                        53
∆ log W ≈     ∑       λi ∆ log Ai +   ∑     λh ∆ log Lh
            i ∈N −G                   h∈H
                  1                                 1
                +     ∑
                  2 i∈N −G
                           λi ∆ log λi ∆ log Ai + ∑ λh ∆ log λh ∆ log Lh
                                                    2 h∈H
                 1      γ −1                                                      
                + ∑ h             ∑ f
                                                             pol              pref
                                       λ ∆ log λ f   ∆ log ω f   −  ∆   log ω f
                 2 h∈H γh
                                f ∈G h
                          1       γh − 1 h                                              
                          2 h∑
                                                                 pref                   pol
                                          λ Varλh ∆ log ω f              − Varλh ∆ log ω f     .
                              ∈H
                                     γh




                                                   54
