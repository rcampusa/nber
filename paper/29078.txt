                              NBER WORKING PAPER SERIES




                              A UNIFIED THEORY OF CITIES

                                    Jacques-François Thisse
                                        Matthew Turner
                                        Philip Ushchev

                                      Working Paper 29078
                              http://www.nber.org/papers/w29078


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     July 2021




We gratefully acknowledge helpful conversations with Dan Bogart about the history of cities and
agglomeration effects and with Kiminori Matsuyama about the concept of stability. We also
thank Jonathan Dingel, Gilles Duranton, Frédéric Robert-Nicoud, Andrii Parkhomenko, Steve
Redding, Roman Zarate, and participants at HSE, the Online Spatial and Urban Seminar,
Princeton, and the 10th European Meeting of the Urban Economics Association for useful
comments. Turner is grateful for the support of a Kenen fellowship at Princeton University during
part of the time this research was conducted. Thisse and Ushchev acknowledge the support of the
HSE University Basic Research Program. The views expressed herein are those of the authors
and do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2021 by Jacques-François Thisse, Matthew Turner, and Philip Ushchev. All rights reserved.
Short sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.
A Unified Theory of Cities
Jacques-François Thisse, Matthew Turner, and Philip Ushchev
NBER Working Paper No. 29078
July 2021
JEL No. R0

                                          ABSTRACT

How do people arrange themselves when they are free to choose work and residence locations,
when commuting is costly, and when increasing returns may affect production? We consider this
problem when the location set is discrete and households have heterogenous preferences over
workplace-residence pairs. We provide a general characterization of equilibrium throughout the
parameter space. The introduction of preference heterogeneity into an otherwise conventional
urban model fundamentally changes equilibrium behavior. Multiple equilibria are pervasive
although stable equilibria need not exist. Stronger increasing returns to scale need not concentrate
economic activity and lower commuting costs need not disperse it. The qualitative behavior of the
model as returns to scale increase accords with changes in the patterns of urbanization observed
in the Western world between the pre-industrial period and the present.

Jacques-François Thisse                          Philip Ushchev
Université Catholique de Louvain                 Higher School of Economics
CORE                                             Room 405
Voie du Roman Pays 34                            Kantemirovskya 3A
1348 Louvain-la-Neuve                            Saint Petersburg 190068
Belgium                                          Russia
jacques.thisse@uclouvain.be                      ph.ushchev@gmail.com

Matthew Turner
Department of Economics
Brown University
Box B
Providence, RI 02912
and NBER
matthew_turner@brown.edu
1    Introduction

Two centuries ago, one human out of ten lived in a city, incomes were a fraction of their present
level, and commuting occurred on foot. Today, more than half of the world's population is
urbanized, and commuting by foot is a curiosity in much of the world. Conventional wisdom holds
that this process of urbanization is a contest between increasing returns to scale in production
and the cost of commuting. Returns to scale in production leads to highly concentrated
employment while commuting allows people to live at lower densities than those at which they
work: as returns to scale increase and commuting costs fall, cities grow.

We investigate how the organization of cities is related to the strength of returns to scale and to
the cost of commuting. Our problem is to understand how people arrange themselves when they
are free to choose work and residence locations, when commuting is costly, and when some form
of increasing returns may affect production. We consider this problem in a framework with
stylized discrete geography, local increasing returns to scale, and households with heterogenous
preferences over workplace-residence pairs. We provide a general characterization of equilibrium
throughout the parameter space. In particular, we describe the implications of arbitrarily strong
increasing returns to scale for the organization of cities. We investigate the stability of
equilibrium and provide a preliminary analysis of more general economies where locations have
first nature advantages or where productivity spillovers from one location to another may occur.

The contest between increasing returns to scale and commuting costs does not play out as the
conventional wisdom suggests. Qualitative features of an equilibrium city depend sensitively on
the strength of returns to scale in production. When production is not constant returns to scale,
corner equilibria, where production concentrates in a few locations, must always occur. With
constant returns to scale or weak increasing returns, there is a unique interior equilibrium,
economic activity is centralized, and stronger returns to scale increase central employment, wages
and land rents. When increasing returns to scale are moderate, multiple stable interior equilibria
may occur and stronger returns to scale may decrease central employment, wages and land rents.
When returns to scale are strong, stronger increasing returns to scale disperse employment and
equalize wages and land rent across locations. That is, the conventional intuition that returns to
scale are an agglomeration force does not hold for sufficiently strong increasing returns to scale.

Our findings about commuting costs are equally surprising. We find that employment is dispersed
both when commuting costs are high and when they are low. It is only at intermediate levels of
commuting costs that highly concentrated employment can arise. That is, when the location of
production and residence is endogenous, the standard intuition that decreases in commuting costs
must disperse economic activity need not apply.

Our investigation is important for a number of reasons. We address a foundational problem of
urban economics. While much progress has been made on this problem, existing work relies on
strong simplifying assumptions and arbitrary restrictions on the strength of agglomeration forces.
For example, the workhorse monocentric city model sets the location of work exogenously, while
recent developments based on quantitative spatial models require assumptions prohibiting
multiple equilibria. Apart from its stylized geography, our model is general and allows us to
provide the complete analytical characterization of equilibrium that has long eluded the literature.

Common theoretical approaches to the economics of cities can be usefully divided into two


                                                 1
frameworks, classical urban economics and quantitative spatial modeling (QSM). The classical
urban economics literature assumes homogenous households and stylized continuous geographies.
In contrast, QSM assumes agents with heterogeneous preferences over workplace-residence pairs;
complex, empirically founded discrete geographies; and a flexible description of the first nature
advantages of particular locations for work or residence. We consider a hybrid case. We apply a
quantitative spatial model to a stylized geography, a discrete linear city on a featureless
landscape, much like what is often studied in the classical approach. A single parameter describes
household heterogeneity in our model, as in the QSM literature, and so we are able to investigate
what happens as the heterogenous households approach the homogeneity of the older urban
economics literature. In this way, we unify the two literatures and allow for a more complete
understanding of both classes of models and their different implications for how cities behave.

The flexibility of quantitative spatial models permits an analysis of real world comparative statics
in estimated or calibrated models that the classical literature does not. However, this flexibility
comes at a price. It is not always clear whether such empirically founded comparative statics are
primarily a reflection of the data on which the exercise is based, or if, like a `theorem', they are a
direct consequence of model assumptions. By examining a simple quantitative model in a stylized
setting, we hope to develop some insight into the way that the basic forces of these models ­
commuting costs, returns to scale and preference heterogeneity ­ interact to affect equilibrium,
and hence to refine our understanding about which comparative statics are empirically ambiguous
and which are not.

While a number of our findings are surprising, two are particularly noteworthy. The heterogenous
preferences of the QSM framework imply that an average household must prefer central to
peripheral work or residence. Such preferences have no analog in the classical literature and they
encourage a concentration of work and residence in the central location even in the absence of any
other agglomeration force. Second, although the set of interior equilibria is often unique, we find
that corner equilibria exist whenever there are increasing returns to scale in production. Both
interior and corner equilibria always occur as long as there are increasing returns. Our framework
is similar enough to those typical of the QSM literature to suggest that these corner equilibria are
a general feature of these models. Given that quantitative implementations of these models often
depend on the uniqueness of equilibrium, we suspect this result may have important practical
implications for the quantitative literature.

Determining the stability of equilibria is surprisingly subtle. The notion of stability most relevant
to the quantitative literature, `an iterative process will find the equilibrium', turns out not to be
well defined. On the other hand, an analysis of a system of differential equations whose steady
states coincide with the static equilibria of our model requires that we assume an ad hoc
adjustment process and seems intractable. Given this, we rely on a more game theoretic notion of
stability, in the spirit of trembling hand perfection. Using this definition, we show that: corner
and `near corner' equilibria are always unstable; for weak increasing returns to scale there is a
unique, stable, interior equilibrium; and, in portions of the parameter space no stable equilibria
exist.

We extend our analysis to a model where, as is typical in the quantitative literature, locations
differ in first nature amenities and productivity. Our results suggest that the qualitative features
of equilibrium in our benchmark case generalize to this economy. That is, we find no evidence
that the presence of first nature differences in locations gives rise to equilibrium behavior that
does not also arise in our benchmark model where locations are identical. Our benchmark model

                                                  2
is based on a technology for which increasing returns to scale depends only on employment in a
single location. We extend this model to a case where returns to scale can `spillover' to nearby
locations. Our results suggest that corner equilibrium do not persist with small productivity
spillovers. They become `near corner' equilibria that approach a corner as spillovers become
weaker. More generally, the equilibria we find in our benchmark model appear to change
continuously with the introduction of small spatial productivity spillovers.

Finally, for the cities of the Western world, we present a simple and brief 500 year history of the
relationships between urban form and increasing returns to scale. We then compare the
qualitative features of this history with the behavior of our model as increasing returns to scale
varies over a range consistent with the approximately 13-fold increase income observed over this
period. We find a qualitative relationship between the behavior we see in our model and history.
Thus, our model appears to offer a simple theory that predicts the qualitative behavior of urban
geography in the Western world from the pre-industrial period to the present.



2    Literature

We can usefully partition the literature into an older urban economics literature and a more
recent literature on quantitative spatial models. Most papers in classical urban economics rest on
the following assumptions. Households are homogenous or there are at most a small number of
types. Space is continuous and uniform, whether on a line or in a plane, and equilibrium cities are
generally symmetric around a single exogenously selected point. The simplest, and most
influential model in this literature is the monocentric city model. It was developed by Alonso
(1964), Mills (1967) and Muth (1969), and is articulated with particular clarity in Fujita (1989).
This workhorse model rests on the assumption that the location of work is fixed exogenously at
the center and households choose only their location of residence, although the model is otherwise
quite general. In particular, firms may substitute between land and labor, and households
between land and consumption.

Beckmann (1976) presents one of the earliest models to explain the endogenous formation of a
city center. He assumes that household utility depends on land consumption and on the average
distance to all households with which the household interacts. This leads to a city with a
bell-shaped population density distribution and a similarly shaped land rent curve. Thus, the city
emerges here as a social magnet. Alternatively, in spirit of Armington (1969) where each variety
of a product is differentiated by the place where it is produced, one might think of the density of
social interaction between any two locations as the volume of trade between these two locations
whose size decreases with distance. In this case, Beckmann's model may be viewed as a
one-dimensional reduced form of Allen and Arkolakis (2014).

The first general statement of our problem is due to Ogawa and Fujita (1980). This landmark
paper considers a simple setting where firms choose only their location and households choose
only their places of work and residence. They introduce the idea that firm productivity benefits
from spillovers from every location, with distant spillovers less beneficial than those nearby. This
assumption, now conventional, requires that the productivity of any given location responds to a
distance weighted mean of employment at all locations. This creates an agglomeration externality,
while land scarcity acts as a dispersion force. As the benefits of spillovers increases relative to the
cost of commuting, they observe first a uniform, then a duocentric, and finally a monocentric

                                                  3
equilibrium.

Fujita and Ogawa (1982) builds on their first paper by considering the case where spillovers decay
exponentially rather than linearly with distance. When the spatial decay parameter is small,
numerical results indicate that the three possible configurations described above still occur.
However, when the spatial decay parameter is larger, the following may occur: (i) there exist
equilibria with several centers; (ii) there is multiplicity of equilibria; and (iii) the transition from
one equilibrium to another may be catastrophic. Lucas (2001) establishes general existence results
in a model where agglomeration economies are not too strong and where firms and households are
allowed to choose locations, subject to firms being restricted to a central business district and
households to the surrounding region. Lucas and Rossi-Hansberg (2002) revisits the problem
posed by Fujita and Ogawa (1982), but allow firms and households to make the same
substitutions between labor and land and consumption and land as in a typical monocentric city
model. They consider both constant and increasing returns to scale. They establish general
existence and uniqueness results, but otherwise rely on numerical methods and restrict attention
to `weak enough' increasing returns that the multiple equilibria observed in Fujita and Ogawa
(1982) do not arise.

Recently, a second class of models, `quantitative spatial models' (QSM), has been brought to bear
on problems of urban economics (Redding and Rossi-Hansberg, 2017). The fundamentals of these
quantitative models are different from the older urban economics literature. In the QSM
literature, model cities consist of discrete sets of locations rather than continuous spaces, and they
describe realistic rather than highly stylized geographies. More importantly, this literature
considers heterogenous rather than homogenous agents. The emphasis of QSM literature is also
different from the older literature. Where the older literature tends to focus on analytic solutions
and qualitative results, the QSM literature focuses on the numerical evaluation of particular
comparative statics in models that describe particular real world locations. Examples include the
fall of the Berlin wall (Ahlfeldt et al., 2015) and the construction of the Transmilenio Bus Rapid
Transit System in Bogota (Tsivanidis, 2019).

The QSM literature draws on a long history of scholarship on discrete choice models, and on the
well-established literature that applies discrete choice models to transportation, location,
geography, and trade problems (Anas, 1983; de Palma et al., 1985; Tabuchi and Thisse, 2002;
Eaton and Kortum, 2002). With that said, much of the recent work closely follows Ahlfeldt et al.
(2015).1 In this model, households have preferences over housing and consumption, as in the older
urban economics literature, and commute from home to work. Space is discrete and is described a
matrix of pairwise commuting costs. These matrices are typically constructed to describe
commuting costs between pairs of neighborhoods in the empirical application of interest. In the
spirit of discrete choice models, households have heterogenous preferences over work-residence
pairs and each household selects a unique pair. Locations are heterogenous in their amenities and
productivity, and the possibility of endogenous agglomeration economies is sometimes considered.
As a consequence of this realism, analytical results are limited. It is possible to derive analytic
expressions characterizing equilibrium. There are also well-known existence results, and the
uniqueness of interior equilibria has been established for the case when increasing returns are
small enough. Beyond this, most of what is known about these models results from the numerical
    1
      For example: Severen (2019); Monte et al. (2018); Dingle and Tintlenot (2020); Tsivanidis (2019); Couture et
al. (2020); Balboni et al. (2020), Heblich et al. (2020), Herzog (2020) and Allen et al. (2015).




                                                        4
evaluation of particular, empirically founded, comparative statics.2



3       A discrete city with heterogenous households

A city consists of a finite set of locations I with |I| = I and each location is endowed with one
unit of land. The city is populated by a continuum [0, 1] of households indexed by  and by a
competitive production sector whose size is endogenous. All households choose a residence i  I ,
a workplace j  I , and their consumption of housing and a tradable produced good.

In the QSM based literature, locations are typically endowed with both employment and
residential `amenities' that scale the payoffs from work and residence in each location. In the
baseline model, we omit them for two reasons. First, it restricts our QSM based model to a
stylized, featureless landscape of the sort considered in classical urban economics, and thereby
facilitates the comparison of the two literatures. Second, it allows us to concentrate our attention
on implications of the fundamental economic forces of the model, commuting costs, returns to
scale, and preference dispersion, without the distraction of idiosyncratic exogenous first nature
properties of the landscape. This simplification comes at a price. In particular, we cannot
investigate whether economic fundamentals and first nature features of the landscape interact to
lead to qualitatively different behavior. We investigate the implications of allowing for first nature
amenities and productivity in Section 9.
                                                           ×I
Each household   [0, 1] has a type z( )  (zij ( ))  RI    + . Thus, a household's type is a vector
of non-negative real numbers, one for each possible workplace-residence pair ij . The mapping
                  ×I
z( ) : [0, 1]  RI
                +    is such that the distribution of types is the product measure of I 2 identical
Fr´
  echet distributions:                                          
                                                               I   I
                                                                          -
                                         F (z)  exp -                    zij  .                                   (1)
                                                              i=1 j =1

Households have heterogenous preferences over workplace-residence pairs, and household types
will parameterize these workplace-residence preferences. Thus, types describe preferences while
  (0, ) describes the heterogeneity of preferences. An increase in  reduces preference
heterogeneity and conversely.

Households must commute between workplace and residence. Commuting from i to j involves an
iceberg cost ij  1. This cost is the same for all households and ij = 1 if and only if i = j .
Commuting costs affect household utility directly.3
    2
      Anas (1990) precedes us in efforts to unify the discrete choice framework with classical urban economics. Anas
(1990) combines the monocentric city model with a finite number of collinear locations and a population of consumers
who have heterogeneous tastes for housing and a composite good, described by a multinomial logit model. Anas
shows that more taste heterogeneity flattens the land rent and population density gradients. Hence, the city radius
expands, residential and population densities around the center decrease whereas they rise near the city edge. To put
it differently, a more heterogeneous population makes the urban structure more decentralized. We will see what this
result becomes when the location of production is also endogenous.
    3
      These preferences are widely used in quantitative models, e.g., Ahlfeldt et al. (2015), Monte et al. (2018) and
Heblich et al. (2020) to mention a few. The focus on psychic rather than real commute costs can be motivated by
appeal to the finding in Kahneman et al. (2004) that travelling between home and the workplace is reported to be
one of the most unpleasant activities in individuals' daily life. Furthermore, as Redding (2020) points out, with a
linear homogenous utility function this formulation is equivalent to one in which the budget is Wj /zij = Cij + Ri Hij



                                                          5
A household that lives at i and works at j has utility
                                                               1-
                                                    zij ( )  Hij Cij
                                         Uij ( ) =                   .
                                                   (1 -  )1-    ij

where Hij is household housing consumption and Cij is household consumption of a homogeneous
and costlessly tradable num´
                           eraire good. To simplify the model, `housing' consists entirely of land.

Given the choice of workplace and residence, ij , the household budget constraint is,

                                                Wj = Cij + Ri Hij ,

where Wj is the wage paid at location j and Ri the land rent at i. The resulting indirect utility
function is
                                                       Wj
                                     Vij ( ) = zij ( )     
                                                             .                                  (2)
                                                       ij Ri

Summing up, we have a deterministic model in which each household makes mutually exclusive
choices from a finite number of workplace-residence pairs ij in order to maximize their indirect
utility (2).

Let
                                                    ×I
                                      Sij =   z  RI
                                                  + ; Vij (z) = maxVrs (z)
                                                                   r,sI

be the set of types z such that ij is (weakly) preferred to all other location pairs rs. Then, using
(1) and (2), the share sij of households who choose the location pair ij equals
                                                                              
                                                                        
                                                               Wj /(ij Ri )
                             sij = µ z-1 (Sij ) =                                    ,                           (3)
                                                                               
                                                         rI     sI    Ws /(rs Rr )

where the last equality stems from the Fr´echet distribution assumption and µ is the Lebesgue
measure over [0, 1].4 Our model is static and so all choices occur simultaneously.

Because the Vij ( ) are Fr´
                          echet distributed, the average utility V across all households equals:
                                                                                             1/
                        1
                                                       -1       
                                                                                       
                                                                                             
               V            max Vij (z( ))d =                                 Wj / ij Ri            ,
                      0 i,j =1,...I                                                           
                                                                   iI j I


where (·) is the gamma function.5 Households that share the same type choose the same
location pair6 ij and reach the same equilibrium utility level, while households who make the
same choice may have different types and do not have the same equilibrium utility level. Likewise,
and zij does not appear directly in the utility function. This equivalence also requires that the taste parameters do
not enter the market clearing condition for land.
   4
     Note that there might be types which belong to more than one Sij as they are indifferent between their multiple
favorite choices. However, the set of such types always has a zero measure, so that they do not affect the type
distribution (1).
   5
     For the average utility to be finite, we require  > 1.
   6
     Except for the measure zero set of types that is indifferent between alternatives.



                                                         6
households that choose different location pairs do not generally enjoy the same equilibrium utility
level. In general, equilibrium utility varies with type.

We have described an explicitly static and deterministic model of heterogeneous households.
Existing formulations of this model are less clear about this issue. This can lead to questions
about households' expectations and the extent to which those expectations coincide with realized
outcomes.7 Such questions are usually resolved by informal appeals to the law of large numbers,
despite the difficulty of formulating the law of large numbers for a continuum (Judd, 1985;
Feldman and Gilles, 1985; Uhlig, 1996). By insisting on a deterministic model of heterogenous
households, we avoid these (admittedly subtle) issues. There is no need for probabilities and
expectations; our outcomes are shares and averages.

We can rewrite (3) as,
                                                       -    -
                                                sij = Ri Wj ij ,                                  (4)
for                                                                   
                                                          -1                  -
                                                                          V       .               (5)
                                                          

Let Mi and Li be the mass of residents and households at i. Labor and land market clearing
requires
                                         Li =    Mj = 1,                                   (6)
                                                iI            j I

where the residential population at i is
                                                            -                    -
                                        Mi           sij = Ri                 Wj ij ,             (7)
                                               j I                    j I

while the labor force at j is
                                                                           - -
                                        Lj           sij = Wj             Ri ij .                 (8)
                                               iI                   iI


Because each location i is endowed with one unit of land, land market clearing requires

                                                       Hi + Ni  1,                                (9)

where Hi is the amount of residential land and Ni is the amount of commercial land at location i.
Condition (9) implies that land rent is zero when the whole amount of land at i is not used.8

Applying Roy's identity to (2), we have
                                                                                Wj
                                          Hi           sij Hij =          sij      .             (10)
                                                                                Ri
                                                 j I                j I

Substituting (4) in (10) gives
                                                                                   1
                                                                                 1+
                                                                   - 
                                         Ri =                 Wj1+ ij                  .         (11)
                                               Hi
                                                        j I

  7
      These issues are stated clearly in Dingle and Tintlenot (2020).
  8
      To allow for corner equilibria, this condition should be written as (Hi + Ni - 1)Ri = 0.


                                                              7
This is the bid rent that households are willing to pay to reside at i, given (W1 , ..., WI , Hi ). Land
rent accrues to absentee landlords who play no further role in the model.

Assume that the num´
                   eraire is produced under perfect competition and the production function at
location j is
                                                   1-
                                      Yj = Aj Lj Nj   ,
where Aj is location-specific TFP and 0 <  < 1. We assume that Aj depends only on the level of
employment at j ,
                                          Aj = L j,                                      (12)
for   0, which is the same for all j .

To keep our model as simple as possible, our description of returns to scale restricts attention to
local scale economies. In Section 9, we consider the possibility of spillovers of the sort that form
the basis for important previous work such as Ogawa and Fujita (1980) or Lucas (2001).

If location j hosts a positive share of the production sector, the first-order conditions for the
production sector yields the equilibrium wage and land rent as functions of land-labor ratio:
                                                            1-
                                                       Nj
                                     Wj   = Aj                   ,                                  (13)
                                                       Lj
                                                                     
                                                            Lj
                                     Rj   = (1 - )Aj                    .                           (14)
                                                            Nj

Dividing (13) by (14) and simplifying,
                                           Wj      Nj
                                              =         .                                           (15)
                                           Rj   1 -  Lj

When  = 0, note that
                                               -                            -/(1-)
                                          Nj                     Wj
                         Rj = (1 - )               = (1 - )                          .              (16)
                                          Lj                     

This expression implies that Rj and Wj move in opposite directions under constant returns: a
higher land rent at j is equivalent to a lower wage at this location. Moreover, the land rent at j is
positive and finite if and only if Wj is positive and finite.

Our city is described by I -vectors of real numbers. To describe them, define a spatial pattern to
be an element of RI    + , a vector enumerating a non-negative real number for each location in I .
The spatial patterns that describe our model city are: the residential pattern
M  (M1 , M2 , . . . , MI ); the employment pattern L  (L1 , L2 , . . . , LI ); the housing pattern
H  (H1 , H2 , . . . , HI ); the commercial pattern N  (N1 , N2 , . . . , NI ); the wage pattern
W  (W1 , W2 , . . . , WI ); and the land rent pattern R  (R1 , R2 , . . . , RI ). A spatial pattern is
interior if none of its elements is zero. Otherwise, it is a corner pattern.

We can now define an equilibrium for our discrete city with heterogenous agents.


Definition 1 A (spatial) equilibrium is a vector {M , L , H , N , W , R } such that:

                                                   8
     i. all households make utility-maximizing choices of workplace, residence, land, and
        consumption to satisfy (3),

    ii. the first-order conditions (13) and (14) are satisfied at every location where the tradable
        good is produced,

    iii. the land market clearing condition (9) holds at each location, and

    iv. the population constraint (6) holds.


We say that an equilibrium is interior when all component patterns of {M , L , H , N , W , R }
are interior. Otherwise, it is a corner equilibrium.



4      A linear city with three locations

Our discrete city with heterogenous households is based on assumptions and functional forms
common in the QSM literature. Because the object of the QSM literature is (usually) the
numerical evaluation of particular empirically founded comparative statics, this means that our
model is more complex than we require to investigate analytic comparative statics or to compare
with the more stylized urban economics literature. Therefore, we let I  {-1, 0, 1} and restrict
our discrete city with heterogenous agents to a geography consisting of three identical locations
evenly spaced along a line.

This geography is the simplest in which to examine when activities concentrate in the center or
disperse to the periphery. Thus, it is the simplest geography in which we can consider when a city
forms a central district where activity is concentrated, and when economic activity remains
dispersed. It is also qualitatively similar to the geography of the linear monocentric city that
forms the basis for much of the urban economics literature.

For tractability and to ease comparison with the urban economics literature, we focus on
symmetric spatial patterns x = (x-1 , x0 , x1 ) where x1 = x-1 , and usually write such patterns as
(x1 , x0 , x1 ) rather than (x-1 , x0 , x1 ). We say that a symmetric spatial pattern is bell-shaped, flat,
or U-shaped as x0 is greater than, equal to, or less than x1 . Say that a symmetric spatial pattern
                                                                                                    x0   y0
(x1 , x0 , x1 ) is more centralized than a symmetric spatial pattern (y1 , y0 , y1 ) if and only if x 1
                                                                                                        >y 1
                                                                                                             .

The restriction to three locations and symmetric patterns, allows us to focus our attention on the
symmetric, three element versions of the spatial patterns listed above: (M1 , M0 , M1 ), (L1 , L0 , L1 ),
(H1 , H0 , H1 ), (N1 , N0 , N1 ), (W1 , W0 , W1 ), and (R1 , R0 , R1 ). That is, the patterns for residence,
employment, housing, industry, wages and land rents.

Our analysis below is organized around studying the centrality of these six patterns. To facilitate
this, define the corresponding centrality ratios,
                         M0          L0          H0             N0         W0          R0
                   m        ;           ;   h       ;       n      ;   w      ;   r       .
                         M1          L1          H1             N1         W1          R1

Under symmetry, given an aggregate constraint, e.g. 2x1 + x0 = 1, a spatial pattern is uniquely
determined by one more piece of information, such as the ratio x0 /x1 .

                                                        9
For this linear city, the iceberg commuting        cost matrix is
                                                                  1  2
                                                                       
                               -1,-1 -1,0           -1,1
                              0,-1    0,0           0,1  =   1   ,                                            (17)
                                1,-1  1,0           1,1           2  1
where  > 1. To ease notation, we define
                                           
                                       a       > 0,
                                          1-
                                          (1 - )(1 + )   1+
                                       b               =    ,
                                                          a
                                          - .                                                                 (18)

The parameter a is important for our analysis. Recall that  and  are the labor share of output
and the housing share of consumption. Thus, the denominator of a is the commercial land share
and the numerator is the induced residential land share in production. It follows that a measures
the relative intensity of the production sector's demand for commercial versus residential land. As
a increases, firms are relatively less reliant on commercial land, and conversely. Recalling that the
periphery is land rich and the center is land poor, it is not surprising that a plays an important
role in determining whether employment or residence is more centralized.

We will sometimes refer to   (0, 1) as the spatial discount factor. By inspection of equation
(18),  decreases with the level of commuting costs ( ) and increases with the heterogeneity of
the population ( ). Hence,  may be high (resp., low) because either commuting costs are low
(resp., high), or the population is very (resp., not very) heterogeneous, or both.9

Applying the symmetry assumption to the wage and land rent patterns W and R and using (4)
and (17), we get the following equilibrium conditions:
                                                             -    ,
                                                    s0,0 = R0   W0
                                                           -     - ,
                                        s0,1 = s0,-1 = R0    W1
                                                             -    ,
                                          s1,1 = s-1,-1 = R1 W1                                               (19)
                                                          -     -
                                     s1,-1 = s-1,1 = R1 W1   ,   2
                                                           -     - .
                                        s1,0 = s-1,0 = R1    W0

Assume that s  (sij ) is a symmetric commuting pattern. Since
                                        1                        1
                                             sij = Lj ,                sij = Mi ,
                                      i=-1                     j =-1

symmetry implies that we must determine the values of three variables to obtain the equilibrium
outcome. For example, it is sufficient to know L0 , M0 , and s00 to determine all the sij , and hence
the vector {M, L, H, N, W, R}.
   9
     It is common in the trade and geography literature with CES monopolistic competition to use a spatial discount
factor defined by    - where  is the elasticity of substitution of the CES utility function and  the trade
cost. This spatial discount factor does not differ much from ours. Indeed, the CES and the MNL are such that
µ = 1/( - 1) where µ > 0 increases with the heterogeneity of the population in the MNL (Anderson et al., 1992).
Since the logarithm of a Gumbel variable is a Fr´echet variable, we have 1/µ =  , and thus  =  - 1.


                                                          10
Setting
                                          w        and   r- ,                                       (20)
the first-order condition (16) becomes  =  a . Clearly,  > 1 means that jobs at the central area
pay a higher wage than those at the peripheries, while  > 1 means that land at the central area
is cheaper than that at the peripheries.

We can now discuss the economic forces at work in this model. To illustrate ideas, consider the
case when wages and land rents are the same in all locations and let V = W/R . In this case,
using (2), a household's discrete choice problem is
                                                 z-1,0    z-1,1  
                                     z-1,-1 V,       V,      2 V 
                                        z0,-1              z0,1
                               max            V,  z0,0 V,    V .
                                 ij  z1   ,-1     z 1,0
                                         2
                                              V,     V,   z1,1 V

This is the standard way of stating a discrete choice problem, except that we have arranged the
nine choices in a matrix so that the row choice corresponds to a choice of residence and choice of
column to a choice workplace.

In this case, because the distribution of idiosyncratic tastes is identical for all nine location pairs,
the average payoff for a household choosing a central residence is
                                                                               1/
                              z0,-1            z0,1              -1        2
                   E max            V, z0,0 V,      V        =        1+            V.              (21)
                                                                           

Similarly, the average payoff for a household choosing one of the peripheral locations as a
residence is
                                                                                         1/
                                  z-1,0 z-1,1                    -1        1   1
             E max z-1,-1 V,           V, 2 V            =            1+    
                                                                             + 2              V.    (22)
                                                                              

Because  > 1, it follows that the average payoff for a household choosing the peripheral location
is lower than that of an average household choosing the central location. By symmetry, the
corresponding statement is also true for the choice of work location. As a result, the average payoff
for a household choosing a peripheral work location is lower than that of an average household
choosing the central location for work. In this sense, the structure of the above discrete choice
problem creates what we will call an average preference for residence in the central location, and
a similar average preference for work in the central location. Note that the intensity of preference
for central location also depends on the commuting cost  and the population heterogeneity .

This is noteworthy for the following reasons. First, even in the absence of more familiar
agglomeration effects operating through production, this model has two `agglomeration' forces,
the average preference for central work and the average preference for central residence. Second,
these average preferences are not agglomeration forces in the conventional sense. They do not
incentivize geographic concentration, rather they incentivize concentration in the central location.
Third, the urban economics literature based on homogenous agents takes seriously the possibility
of differential labor productivity across locations. However, the possibility of preferences over
work locations is never considered. This is a feature of quantitative spatial models without analog
in the urban economics literature. Fourth, on the basis of the existing literature, we expect that


                                                        11
the preference for central residence will be capitalized into higher central land rents. We will also
see that the preference for central work location reduces central wages.

Against the two centralizing forces of average preferences are set two centrifugal forces. There is
twice as much land in the periphery as the center. Because land contributes to utility and
productivity, the scarcity of central land incentivizes the movement of employment and residence
to the periphery.

We can now guess at the form of a symmetric equilibrium under constant returns to scale. In
equilibrium, the centrifugal force of land scarcity and the centralizing force of average preferences
balance. Access to the center will be scarce and so land rent will be higher and wages lower in the
center. Whether the center ends up relatively specialized in residence or work will depend on
which of the two activities has the highest demand for land, and this activity will locate
disproportionately in the land abundant periphery.

We postpone a discussion of equilibrium under increasing returns to scale until after we provide a
more formal characterization of such equilibria.



5    Existence and multiplicity of equilibria

We now turn to the characterization of symmetric equilibria in our three location city. We
proceed in three main steps. In the first, we derive the demand for housing, the demand for
commercial space, the supply of workers, and the supply of residents as functions of  and . This
done, we derive a system of two equations in wages and land rent that characterize equilibrium.
In the third step, we solve this system of equations.

The next proposition shows that in equilibrium all variables can be expressed in terms of just 
and  .


Proposition 1 The equilibrium demand for housing and commercial space and the equilibrium
supply of workers and residents are:

                                  ( + 2)                               1 - M0
                  M0 =                              ,            M1 =          ,                 (23)
                            ( + 2) + 2( + 1 + 2 )                          2
                                   ( + 2 )                            1 - L0
                   L0 =                            ,             L1 =        ,                   (24)
                             ( + 2) + 2( + 1 + 2 )                       2
                                               1+
                                 a(1 + 2 -          )
                  H0 =                                   ,   N0 = 1 - H0 ,                       (25)
                                       - 1+
                            a(1 + 2           ) +  + 2
                                        1+
                                   a(        + 1 + 2 )
                  H1 =           1+                          ,       N1 = 1 - H1 .               (26)
                            a(        + 1 + 2 ) + +1 + 2


Proof: This proposition is a special case of Proposition 11, proved in Appendix K.

The derivation of these functions involves algebraic manipulation of the equilibrium conditions.
For example, each of Mi and Lj is derived from the expressions for the share of households


                                                    12
choosing each workplace-residence pair ij . In one case, we sum over workplace-residence pairs
with a common residence, and in the other over pairs with a common workplace. The identical
denominator for each of the four functions described by (23) and (24) is simply the three-location
version of the denominator on the right-hand side of equation (3). The expressions for Hi and Nj
are more complicated because they must also satisfy the land market clearing condition (9).
Notice that we write Mi , Li , Nj , and Hi exclusively in terms of price ratios, r and w, rather than
the prices themselves, Ri and Wj . This simplifies our effort to characterize equilibrium because
we need to solve for only two equilibrium quantities instead of four.

We can refine our understanding of how the average preference for central work and residence
affect equilibrium by examining the expressions for residential population and employment
(23)-(24). Assume that wages and land rents are equal across locations so that  =  = 1.
Substituting in the expressions for Mi and Li we find that M0 (1) = L0 (1) > M1 (1) = L1 (1).
Therefore, central employment and residence is greater than in the periphery even though the
different locations have the same relative pecuniary appeal. This reflects the average preference
for central residence and workplace. Note also that H0 = H1 = a/(a + 1) for  =  = 1.

We now turn to finding the equilibrium values of  and . We would like to derive a system of
equations involving only  and  that incorporates all of the equilibrium conditions given in
Definition 1. The following proposition describes such a system.

Proposition 2 Assume  = /. Then, a pair ( ,   ) is an interior equilibrium if and only if it
solves the following two equations:
                                                         1
                                                      1+ 
                         1+               - 2a               + (1 + 2 )(1 + a)
                              = f ()                     1          1            ,              (27)
                                                      1+ 
                                            (1 + a)          + 2  - a
                                                                         / 1+
                         1+                    b        + 2             1-/ 
                              = g (;  )      1-/                                     .          (28)
                                                        + 1 + 2

Proof: This proposition is a special case of proposition 11, proved in Appendix K.

Combining (27) and (28), we arrive at a single equation in terms , which determines the interior
equilibria. Thus, studying the equilibrium behavior of our discrete linear city reduces to studying
the solution(s) of one equation in one variable:
                                           f () = g (;  ).                                      (29)
We show the existence of an interior equilibrium by showing that (29) has a positive solution  .
We determine the number of possible interior equilibria by determining the number of positive
solutions of equation (29).

This argument requires two comments. First, equation (29) is not defined when  = /, so that
we will need a specific argument for this case. Second, we will see that  = / is a threshold
value of  , below which there is a unique interior equilibrium, and above which multiple interior
equilibria may occur. To ease exposition of equilibrium behavior around this threshold, define
m  /.

We now turn to a characterization of equilibrium. To begin, we establish the properties of the
functions f and g . Observe that the function f does not involve the parameter  , and thus

                                                 13
remains the same for all values of  . The following lemma states the main properties of function
the f that are important for the characterization of spatial equilibria.


Lemma 1 The function f () has a vertical asymptote at 0  (0, 1) and is equal to 0 at 1 > 1.
Furthermore, f () > 0 if and only if 0 <  < 1 and decreases over (0 , 1 ).


Proof: (i) The denominator of f () is an increasing function of , which is unbounded above and
negative at  = 0. Therefore, the equation
                                                   1          1
                                                1+ 
                              D()  (1 + a)             + 2  - a = 0

has a unique positive root 0 . Clearly, D() > 0 if and only if  > 0 . Since D(1) > 0, it must be
that 0 < 1.

(ii) It is readily verified using (27) that the numerator of f () is a concave function which is
positive at zero. It increases in the vicinity of 0 and then starts decreasing and goes to - as
  . Hence, the equation
                                                   1
                                                1+ 
                           N ()   - 2a                 + (1 + 2 )(1 + a) = 0

has a unique positive root 1 . Clearly, N () < 0 if and only if  > 1 . Since N (1) > 0, it must be
that 1 > 1.

(iii) We have f () > 0 if and only if only if the numerator N () and the denominator D() have
the same sign. This holds if and only if 0 <  < 1 . The interval (0 , 1 ) is not empty because
0 < 1 < 1 . As a result, f () > 0 if and only if   (0 , 1 ).

(iv) We show in Appendix A that f () decreases from  to 0 over (0 , 1 ). Q.E.D.

Unlike f , the function g varies with  . We show in Lemma 2 that when  < m , g is an increasing
function that converges to an increasing step function as    m . When  > m , g is a decreasing
function that converges to a decreasing step function as    m . In both limiting cases, the value
L at which the step occurs solves the equation
                                          1       + 2
                                         a             = 1.                                       (30)
                                              1 +  + 2
Because the left-hand side of (30) increases with  and is equal to 0 (resp., ) when  = 0 (resp.,
  ), L is unique and L < 1.

The following lemma provides a more formal statement of the relevant properties of g .


Lemma 2 (i) If  = m , then g (;  ) is strictly positive and finite over [0 , 1 ]. (ii) If  < m ,
then g is increasing over [0 , 1 ]. (iii) If  > m , then g is decreasing over [0 , 1 ]. (iv) As 
converges to m , we have:
                                                                     
                    0 ,                     <  L ;                     ,                     < L ;
                                 - 1+
                                                                                   - 1+ 
                                                                     
   lim g (;  ) =         L +2       
                                                      lim g (;  ) =        L +2        
   m                   1+L +2
                                           = L ;       m                 1+L +2
                                                                                             = L ; .
                                                                     
                    ,                      > L ;                       0,                    > L .
                                                                     


                                                  14
Proof: Part (i) follows from combining (28) with 0 < 0 < 1 < . Parts (ii) and (iii) are
obtained by differentiating g with respect to . Part (iv) holds because g (;  ) may be rewritten
as follows:                                                                1+
                                                   m
                                                                          -1   
                                   1  + 2          m -           + 2
                    g (;  ) =      a                     ·                        .               (31)
                                  1 +  + 2                   1 +  + 2
Q.E.D.

The four panels of figure 1 illustrate the functions f and g for various parameter values. In each
panel, the horizontal axis is  and the vertical axis is an increasing transformation of  . The
behavior of f , the red line in each panel, is relatively simple. It is a decreasing, continuous
function that has a positive asymptote at 0 < 1 and declines monotonically to 0 at 1 > 1. The
behavior of g is more complicated. The two panels on the left each describe g for three different
values of  , with dark blue the smallest, light blue the largest, medium blue in between, and all
three less than m . In every case, g is a continuous, increasing function. The right column is the
same as the left, but considers larger values of  . Here, the light blue line traces g for the smallest
value of  , dark blue uses the largest value, medium blue is intermediate value, and all three are
greater than m .

This figure makes clear that, in general, f and g cross for a positive value , and when  > m ,
they may cross more than once. On this basis, we can surmise that an interior equilibrium exists
in our model city throughout much or all of the parameter space.

Lemma 1 shows that f has an asymptote at 0 < 1 and is zero at 1 > 1. Lemma 2 shows that as
  m , g also approaches its singularity at L < 1. While Lemmas 1 and 2 guarantee that
1 > L , they do not allow us to order L and 0 . Unsurprisingly, the equilibrium configuration of
our city depends sensitively on whether or not L > 0 . Lemma 3 provides necessary and sufficient
conditions on commuting costs and the demands for commercial and residential land for L > 0 .


Lemma 3 There exists a function ()  (0, 1) and scalar a > 0 such that if  <  or a < a
then 0 < L . Conversely, if  >  and a > a then 0 > L .


Proof: See Appendix B.

Restating this lemma informally, we have 0 < L if either the spatial discount factor is low or
the demand for commercial land is sufficiently large relative to the demand for residential land.
Conversely, if the spatial discount factor is high and the demand for commercial land is low, then
0 > L .

The above equilibrium conditions imply the following relationship between land rent and
employment, which is surprisingly simple and will be useful in a number of our proofs. Using (24)
leads to
                                                + 2
                                        =                .
                                             + 1 + 2
Combining this with (28), this equation becomes
                                                             
                                                              m
                                             + 2
                                            1                m -
                                       =    a                      .                              (32)
                                             + 1 + 2

                                                  15
If  < m , then increases over (0 , 1 ) and () > 1 if and only if  > L . On the other hand,
when  > m , the opposite holds: decreases over (0 , 1 ) and () > 1 if and only if  < L .

So far, we have focused on interior equilibria. The following proposition formalizes this discussion
and characterizes the corner equilibria.


Proposition 3 If   0, an interior equilibrium always exists. Furthermore, there exist two
corner equilibria if and only if  > 0. These corner equilibria are such that the employment
patterns are given, respectively, by (0, 1, 0) and (1/2, 0, 1/2). In both corner and interior
equilibria, each location hosts a positive mass of residents.


Proof: Using the properties of f and g given in Lemmas 1 and 2, the intermediate value theorem
implies the existence of an equilibrium when  = m . The case where  = m is discussed in
Section 6.1.2. Furthermore, we show in Appendix C that there exist two corner equilibria for all
 > 0: (i)     and  = 1 , and thus employment is evenly distributed between peripheries,
and (ii)   = 0 and  = 0 , so that employment is fully concentrated at the center i = 0.

Finally, we show that Mi > 0 for all i. Assume that Ri = 0 at i. Since there is a location j  I

such that Wj > 0, workers who choose the pair ij enjoys an infinite utility level, which implies
sij > 0. These workers' land demand is thus infinite while the land supply is finite, a
contradiction. Q.E.D.

Thus, multiple equilibria always arise when there are increasing returns.



6      Comparative statics

We now turn our attention to an investigation of how the equilibrium behavior of our city changes
as fundamental characteristics of the economy change. More specifically, we focus on the
implications of changes in returns to scale,  , commuting costs,  , and preference dispersion, .


6.1     Returns to scale

We investigate changes in the equilibrium behavior of our city as returns to scale changes. To ease
exposition, we introduce terminology to describe the three important domains of returns to scale.
These ranges will correspond to qualitatively different equilibrium behavior.


Definition 2 Increasing returns to scale (IRS) are:


     i. weak  0 <  < m  /,

    ii. moderate  m    s ,

    iii. strong   > s .



                                                16
         Figure 1: Graphical demonstration of equilibrium for a range of parameter values.

               (a) 0 < L and  < m                                  (b) 0 < L and  > m




    1+                                                    1+
                                                           




                                                                                 

               (c) 0 > L and  < m                                  (d) 0 > L and  > m




    1+                                                    1+
                                                           




                                                                                 


Notes: These figures illustrate equilibrium in several different cases. In all panels, f is given by
the red line. The blue lines describe g . In the left two panels, darker colors of blue indicate
smaller values of  and in the right two panels darker colors of blue indicate larger values of  .


Production is constant returns to scale when  = 0.


This definition requires three comments. First, population must be heterogeneous ( finite) for
weak returns to scale to occur. Therefore, we cannot observe the weak increasing returns domain
cities with the homogenous households that are standard in the urban economics literature. This


                                                  17
establishes that qualitative features of the equilibrium depend on the degree of preference
heterogeneity.

Second, we will see that the threshold level of returns to scale at which the possibility of
discontinuous changes in equilibrium outcome most obviously arise is m . Recall that m = /.
In a modern economy, the labor share of production is about 0.6, while the range of commonly
used estimates for epsilon is about [5, 7]. Taking the ratio of these values, we have m in
[0.085, 0.12]. Estimates of the wage elasticity of population for modern, developed country cities
that control for sorting and first-nature productivity are typically around 0.05. However, the raw
correlation between wages and density is larger, as are estimates for developing countries. This
back of the envelope calculation, together with results presented below, will suggest that multiple
interior equilibria occur in an empirically relevant part of the parameter space.

Third, 0 must be smaller than L , i.e., commuting costs or the productivity of land sufficiently
large, for moderate returns to scale to arise. To see this, solve the equilibrium condition
f () = g (;  ) for to  to get,

                                                        log -b f ()
                                          () =                                .
                                                        +2
                                                  log   +1+2
                                                                  [f ()] 1+

The inverse of this function is the correspondence that specifies the set of interior equilibria for
each value of  .10 Denote by s the maximum of the function  () over [0 , 1 ] subject to the
condition -b f ()  1. It is readily verified that m = s when 0  L , while m < s when
0 < L . In words, the region of moderate increasing returns to scale does not exist unless
0 < L .

Figure 1 summarizes Lemmas 1-3 graphically. The top two panels describe cities where 0 < L , a
city where commuting costs are high or land is valuable in production. The bottom two panels
describe an economy where 0 > L , a city where commuting costs are low and land has a low
value in production. The two panels on the left describe cities where production involves constant
or weak increasing returns to scale. The right two panels describe cities where increasing returns
are moderate or strong. Each panel evaluates g for three different values of  . In every panel, the
light blue line describes g for a value of  close to the weak/moderate threshold m , and darker
blue lines describe g functions for values of  that are progressively further from this threshold.
Taken together, these figures permit a fairly complete description of the interior equilibria of our
linear city with three locations.

Begin with 0 < L . The case of constant or weak increasing returns to scale is illustrated in panel
(a) where high commuting costs encourage households to work where they live or land hungry
production faces pressure to disperse to the periphery (or both). We expect an equilibrium in
such an economy to exhibit low levels of commuting and dispersed production. In fact, regardless
of  , f and g cross slightly below  = 1 and at a moderate value of  . Since 0 < L , as         m
and g approaches its asymptote at L , it does so when f is well away from its asymptote at 0 .
Hence, the equilibrium value of  grows with  but remains bounded, meaning that the ratio of
central to peripheral wages can never grow too large. Thus, panel (a) describes a city where
neither employment nor residence are highly concentrated in either the center or periphery.

In panel (b), we first consider the case of moderate increasing returns described by the medium
 10
      Indeed, we use this function to construct the plots of  versus  in figure 2.


                                                          18
blue line. At this value of  , g crosses f three times. At the first intersection point, we have 1 <1
                                                
and 1 > 1; at the second one, we see that 2 approaches L as  decreases toward m ; at the
third intersection point, we have                                               
                                     3 > 1 and 3 < 1. The value 1 (resp., 3 ) in turn requires that
employment occurs primarily in the center (resp., splits between the two peripheral locations).

The light blue line in panel (b) describes g when  is just above m . As gamma approaches this
threshold, for one of the two new equilibria  grows without bound (and occurs outside the frame
of the figure) while  approaches zero in the other equilibrium. That is, just above the threshold,
these two equilibria approach corner patterns where all employment is either central or
peripheral. The dark blue line in panel (b) describes g when returns to scale are strong. As 
increases further, the remaining interior equilibrium involves a moderate value of  , that is, an
equilibrium where employment is more or less evenly distributed across the three locations.
Indeed, as households get wealthier, they consume more of the num´  eraire good and become more
sensitive to the cost of commuting. As this occurs, they bid away differences in land rent and
distribute themselves more uniformly across the three locations. Thus we arrive at the surprising
conclusion that a low degree of increasing returns leads to agglomeration while a high degree
fosters dispersion.

Summing up, in a city with 0 < L , as  increases, the city converges to an interior pattern in
which employment does not become highly concentrated in the center or periphery. When returns
to scale increases beyond the weak/moderate threshold, two new branches of equilibria arise.
These equilibria involve extreme concentration of employment in the center or in the periphery.
As  increases further, these two extreme equilibria become flatter, and ultimately, when 
crosses the moderate/strong threshold, we are left with a single equilibrium where employment is
not highly concentrated in the center or periphery.

In contrast, panels (c) and (d) show an economy where L  0 . In panel (c), low commuting
costs allow households to separate work and residence locations in response to a small wage
premium, and productivity is not sensitive to the relatively abundant land of the periphery. In
this case, increasing returns to scale compounds the average preference for central employment to
concentrate employment in the center, and that households are able to cheaply disperse their
residences to the land abundant periphery. In this city, as  approaches m = s , it does so near
the asymptote of f . As a result, the value of  at which the two curves intersects becomes large.
This reflects the fact that peripheral productivity is falling almost to zero as production
concentrates in the center and consumes progressively less peripheral land, even as central
productivity rises with agglomeration economies.

Panel (d) illustrates what occurs when returns to scale are strong in an economy where commuting
costs are low and the share of land in production is relatively low. For such an economy, there is a
unique equilibrium, and in this equilibrium most employment occurs in the periphery. As 
decreases toward the threshold, a second equilibrium arises. This equilibrium involves a large
value of  , and hence, employment highly concentrated in the center. As  increases so that
returns to scale are strong,  gradually increases, just as in panel (b) where 0 < L .

Summarizing, for 0 < L as returns to scale increase from low levels, employment concentrates in
the center. When returns to scale surpass m this bell-shaped equilibrium persists, but two new
equilibrium branches involving a higher degree of concentration in the center or periphery arise.
As returns to scale increases further the equilibrium branch with a U-shaped employment
distribution persists, but the one with centralized employment does not. As  increases still


                                                 19
further, the distribution of employment becomes more uniform as wealthier households arbitrage
away small differences in land price. Alternatively, when 0  L , there is always a unique interior
equilibrium. Along this equilibrium branch, as  increases employment first becomes more and
more agglomerated, but as  continues to increase employment becomes more and more dispersed.

We now turn to a formal statement of our results. Propositions 4 to 7 confirm and extend the
intuition about equilibrium that we take from figure 1.


6.1.1   Constant returns to scale

Under constant returns to scale equation (28) becomes g (; 0) = b so that (29) may be rewritten
as,
                                             1+
                                             = b .                                          (33)


Proposition 4 Under constant returns to scale, there exists a unique equilibrium. This
equilibrium is interior and such that 0 <  < 1 and 0 <   < 1. Furthermore, if
                                               1-
                                             <                                                (34)
                                          1+    
holds, then the equilibrium employment pattern is bell-shaped.


Proof: Proposition 3 implies that there is no corner equilibria when  = 0. Since g (; 0) increases
from 0 to 1 as  increases over [0, 1], Lemma 1 implies that the two curves must cross exactly once.
Furthermore, the intersection must occur strictly between 0 and 1, which implies 0 <  < 1.
Since g < 1 over this interval, it must be that   < 1, while (33) implies   > 0. That (34) is
sufficient for the equilibrium employment pattern to be bell-shaped is proven Appendix D. Q.E.D.

The inequalities 0 <  < 1 and 0 <   < 1 imply that all rents and wages are positive and finite.
Furthermore, the equilibrium land rent is higher in the center while the equilibrium wage is lower.
It may seem surprising that (34) does not involve  . We believe this reflects the fact that this
condition is sufficient for  > 1, but not necessary.


6.1.2   Weak increasing returns

The next two propositions describe the equilibrium when increasing returns to scale are weak.


Proposition 5 Assume that 0 <  < m . Then, there is a unique interior equilibrium and
 < 1. Furthermore, if (34) holds, then the equilibrium employment pattern is bell-shaped and
such that
                                 d            d          d 
                                     >0            <0<      .
                                 d            d          d

Proof: Under weak IRS, given Lemmas 1 and 2, f and g must intersect exactly once.
Furthermore, because f (1) < 1 < g (1;  ), the intersection must occur at  < 1. We refer to
Appendix E for a proof of the second part of the proposition. Q.E.D.

                                                20
The substance of Proposition 5 seems intuitive. As scale economies increase, the central location
attracts a larger share of workers, while both the relative land price and relative wage increase as
the land rent and wage at the center capitalize the agglomeration force resulting from increasing
scale economies.

The comparative statics in Proposition 5 hold whenever 0 <  < m . This is somewhat surprising
because, consistent with our earlier discussion of panels (a) and (c) of Figure 1, there are two
distinct types of equilibrium behavior with weak increasing returns to scale, depending on whether
0 is larger or smaller than L . More specifically, when  is slightly below m , two cases may arise:

(i) if 0 < L , then setting  = m in [f ()]1-/ = [g (;  )]1-/ yields an expression equivalent
to (30) whose unique solution given by  = L . The equilibrium wage ratio remains bounded and
the limiting employment pattern remains interior as   m ;

(ii) if 0 > L , then     and the equilibrium employment pattern converges to (0, 1, 0) as
       m , hence  = 0 .

The existence of two distinct equilibrium regimes confirms the intuition suggested by figure 1.
When commuting costs or land productivity is high and 0 < L , the full concentration of
production in the central location does not occur. The productivity advantage of the land
abundant periphery is too great, or commuting is too costly to allow such central concentration of
employment. On the other hand, when commuting costs are low and land is less productive so
that 0 > L , then almost full concentration of employment at the CBD occurs. In this case,
there is no interior equilibrium at  = m because increasing returns are strong enough to
complement the preference for central employment and generate almost full concentration of
employment at the center.


6.1.3     Moderate increasing returns

When  > m , the function f remains unchanged, but the function g changes from an increasing
to a decreasing function. When both f and g are decreasing, we are no longer assured of the
existence of a unique equilibrium.

The following proposition formalizes the intuition suggested by figure 1 and confirms its generality.


Proposition 6 Assume  is slightly above m .


   i. If 0 < L , then there exist two interior equilibria, (                 
                                                            1 , 1 ) and (3 , 3 ), such that
                                            
                                    1 > 1 > 3        and              
                                                              1 < 1 < 3 ,

        as well as a third interior equilibrium. As        m , the first two equilibrium employment
        patterns converge to (1/2, 0, 1/2) and (0, 1, 0), while the third equilibrium is interior.

  ii. If 0 > L , then there exists a unique interior equilibrium ( ,   ) such that:

                                          < 1        and       > 1.

        Furthermore, as       m , the equilibrium employment pattern converges to (1/2, 0, 1/2).

                                                   21
Proof: See Appendix F.

Part (i) of Proposition 6 establishes the existence of multiple interior equilibria when either
commuting costs are high or the productivity of land in production is relatively low. To be
precise, for any  slightly larger than m , there exists an arbitrary small  > 0 such that the
equilibrium employment patterns are given respectively by ((1 - )/2, , (1 - )/2) and
(/2, 1 - , /2). This result seems surprising as the assumption of heterogeneous agents is
generally sufficient to smooth out discontinuities in equilibrium behavior.

Proposition 6 characterizes equilibrium just above the threshold separating weak and moderate
increasing returns, m , while Proposition 7 characterizes equilibrium above s > m , the threshold
separating moderate and strong increasing returns. It is natural to expect that the behavior we
observe near m persists throughout the full range of moderate increasing returns, (m , s ), as we
observe in figure 2. We demonstrate that this is sometimes the case in the examples illustrated in
figure 2. In fact, we cannot rule out the possibility of more complicated equilibrium behavior for
values of  just below s , although we cannot find a counter example to contradict the conjecture
that the results of Proposition 6 hold throughout the range of moderate increasing returns.


6.1.4   Strong increasing returns

Figure 1 shows that only a single interior equilibrium persists when  exceeds s . More generally,
we have:


Proposition 7 If  > (11+   
                         - ) -   s , then there exists a unique interior equilibrium.
Furthermore, the equilibrium employment pattern gets flatter as  rises and converges to the
uniform pattern when   .


Proof: See Appendix G.

Surprisingly, increasing returns need not foster the concentration of activity. When increasing
returns are strong, households are rich. Since land is in fixed supply, this means that the
willingness to trade consumption for land must increase. Among other things, this will lead
households to live in places where land is less in demand. Since commuting is costly, this
peripheral migration of households will be followed by firms who can capitalize lower commute
costs into wages, and partly offset the loss in productivity from returns to scale with increased use
of commercial land. Both behaviors lead to flatter equilibrium patterns of employment and
residence as returns to scale increase.

To our knowledge, Proposition 7 is new to the literature. While it has long been understood that
increasing returns to scale could lead to multiple equilibria, the idea that sufficiently high
increasing returns leads, once again, to a unique equilibrium is novel. Even more surprising, this
equilibrium involves a growing dispersion of production as the degree of increasing returns rises.
The intuition behind this result seems straightforward. As  increases sufficiently, all else equal,
wages must rise. This makes households better-off, which in turn increases the utility loss from
commuting. As the marginal utility of income falls, households solve this trade-off by reducing
the total amount of commuting, which leads to more dispersion.


                                                 22
                      Figure 2: Equilibrium correspondence between  and  .

                            0 < L                                                   L < 0




                 m                        s                                            m= s




Notes: In both panels the x-axis is  and the y -axis is ln . The left panel illustrates all interior
equilibria as  varies when 0 < L . The right panel shows the case where L < 0 . Solid lines
indicate stable equilibria and dashed lines indicate unstable equilibria, where stability is defined as
in Section 7.


Figure 2 describes the equilibrium correspondence between  and  for numerical examples
satisfying 0 < L in panel (a) and L < 0 in panel (b). In both panels, the x-axis describes 
and the y -axis describes ln . Both figures show all interior equilibria, but not the corner
equilibria required by Proposition 3. Both figures anticipate our analysis of stability in Section 7
and indicate stable equilibria with a solid line and unstable equilibria with a dashed line.

Figure 2 illustrates equilibria for the entire range of  . This is slightly more complete than our
propositions. Our propositions establish behavior in a neighborhood above m and for  > s .
They do not eliminate the possibility of a region in (m , s ) where qualitatively different
equilibrium behavior occurs. As we noted above, while we have not been able to eliminate the
possibility of such behavior, we have never seen an example of it in our simulations.


6.2   Commuting cost and preference dispersion

We consider how interior equilibria vary as commuting cost or preference dispersion change, with
a special emphasis on the cases of a homogeneous or infinitely heterogeneous population. We
begin with figure 3. Both panels of this figure illustrate the equilibrium employment ratio
  = L0 /L1 as  varies. The left panel illustrates an example where returns to scale are weak,
 < m , and the right panel an example where they are strong,  > s . We omit the intermediate
case to avoid the complication of multiple equilibria.

In the case of weak increasing returns, the concentration of employment in the center is increasing
in commute costs for low levels of  and decreasing for high levels of  . Equilibrium employment
is uniform as  approaches either one or infinity. The peak of the employment ratio locus occurs


                                                  23
              Figure 3: Employment and residence ratios as commuting cost varies.

                               < m                                        > s




Notes: In both panels, the x-axis is  and the heavy black line shows the equilibrium value of
  = L0 /L1 . In panel (a)  = 0.07 and in panel (b)  = 0.7. Other parameters used for these
calculations are  = 0.9,  = 0.25,  = 5.


around  = 1.2, where commuting results in a 20% utility penalty. For reference, Redding and
Turner (2015) report an average round trip commute of about 50 minutes for an average
American, this is about 12% of an eight hour work day. While it would be a mistake to take
parameter magnitudes too seriously in such a stylized model, this calculation suggests that the
complicated comparative statics illustrated in panel (a) may be empirically relevant.

The case of strong returns to scale illustrated in panel (b) is about opposite. For  to the left of
the minimum of the employment ratio curve, the concentration of employment in the periphery
increases as commute costs increase. To the right of the peak, this behavior reverses. Like the
case of weak increasing returns illustrated in panel (a), as  approaches one or infinity, the
employment pattern becomes flat. Note that the scale of the x-axis in panel (b) is different from
that in panel (a) and the peak of the employment ratio curve occurs around  = 2. The
empirically relevant region of panel (b) likely lies to the left of the minimum of the employment
ratio curve. In this region, increases in  decentralize employment.

Because  and  so often appear together in the analysis (as ), it is natural to conjecture that
the comparative statics for the two parameters are similar. As we show below, this conjecture is
correct. With this said, it is more difficult to illustrate the comparative statics of  because, as
inspection of Definition 2 shows, changes in  can cause an economy to change between weak,
moderate, and strong returns to scale, and therefore leads to more complicated behavior.

With these examples in place, we turn to a characterization of equilibria as  approaches one and
infinity, and as  approaches zero or infinity.

Recalling that  =  - , it is easy to show that   1 when   1 or   0, and that   0 when
   or   . Combining this observation with inspection of equations (21) and (22), we see
that the average payoff from the choice of central versus peripheral workplace (or the
corresponding payoffs from choice of residential locations) converge toward each other when 
goes to either zero or one. This is consistent with the convergence to a flat equilibrium for
extreme values of  that we see in figure 3, and suggests that such convergence may be general.

                                                 24
To show that this is the case, set  = 0 and  = 1 in (27) and (28), to obtain:
                                                                      1
                                                                   1+ 
                                 -1- 1                      - 2a          + 2(1 + a)
                  f ()|=0 =              ,     f ()|=1 =              1          1     ,
                                                                   1+ 
                                                           (1 + a)        + 2  - a
                               1          1+ /                               b
                g (;  )|=0 = ( a +  )  1-/  ,              g (;  )|=1 =  1-/ .

Evaluating each of these functions at  = 1 shows that f (1)|=0 = g (1;  )|=0 = 1 and
f (1)|=1 = g (1;  )|=1 = 1. Hence, in both cases  = 1 is an equilibrium. As   0, we have that
m  . It follows that as   0 returns to scale must be weak. Therefore, Proposition 5 applies
and the interior equilibrium is unique.
                                                           1
When    in f ()|=0 = g (;  )|=0 , we have -1 =  a -1 whose unique solution is  = 1. It
then follows from (27) that   = 1, which implies  (1) = m (1) = h (1) = n (1) = 1 when
  . Using (23) and (24) we have L              
                                         i = Mi = 1/3 for i = -1, 0, 1 and it is easy to show that
                       
sij = 0 for i = j and sii = 1/3. Thus, as the population becomes homogeneous, the equilibrium
city consists of backyard capitalists who work where they live. In this equilibrium, land is shared
between consumption and production according to the same proportion Hi /Ni = a = /(1 - )
across locations, so that residential land consumption increases with the land share in
consumption and decreases with the land share in production.

The same patterns emerge as   0 and the population becomes infinitely heterogeneous.
However, commuting patterns vary across the two types of equilibria. When   0, the payoffs
for each of the nine location pairs become identical. As   , the payoff (22) attached to
off-diagonal pairs goes to zero. In the former case, we have symmetric cross-commuting between
any location pair, while we have no commuting at all in the latter case.

The following proposition summarizes this discussion.


Proposition 8 Interior equilibrium employment, residential, housing, and commercial patterns
converge to a flat pattern when one of the following conditions holds:

                                             1- 1
   i.   1 or    and  < m or  >               1-
                                                
                                                    - ;

  ii.   0;
                       1
 iii.    and  >       1-   - .


The intuition behind two of the cases is transparent. As   0, preference dispersion increases.
As this happens, taste heterogeneity over pairwise choices becomes increasingly important relative
to commuting costs and, in the limit, households ignore land price and wage differences, and the
distribution of households across pairs is uniform. Likewise, as    the cost of commuting
grows so high that it never makes sense to commute. Since the distribution of types is the same
across locations, households must be uniformly distributed across locations. In this case, only
autarchy is possible and all households work where they live. In both cases, the distribution of
residence and employment is uniform, although the city functions differently in the two cases.
When   0 we have `urban sprawl', where many people commute and there is no city center.
When    we have a city of backyard capitalists.

                                                    25
As   , preference dispersion disappears and households become homogenous. Simultaneously,
the range of weak returns to scale collapses toward {0}. When returns to scale are constant, there
is no longer a centralizing force in the model and the distribution of activity is uniform. The
distribution of activity is also uniform when returns to scale are strong. This is less intuitive.
When households no longer care about where they live and work,they focus on their own
consumption only. In this case, high increasing returns make households rich enough that they
prefer to work where they live at a lower wage in order to avoid larger utility losses from
commuting. In spite of strong increasing returns to scale, when the households are homogeneous
the only interior equilibrium involves a uniform distribution of production activities across
locations.

As   1 something similar occurs. In the absence of increasing returns to scale, there is no
reason for firms to concentrate, and so we arrive at a uniform distribution of activity because
location does not matter anymore to agents.

We regard these comparative statics as surprising and important for two reasons. First, in the
monocentric city model, decreases in commuting costs lead households to spread out. Our results
contradict this intuition. In our heterogenous household model, comparative statics on
commuting costs are not monotone. Second, as we describe in our review of the literature,
discrete heterogenous agent models, similar to ours, are the basis for a rapidly growing
quantitative literature. Often, such quantitative exercises evaluate the effects of counterfactual
changes in commuting costs. To the extent that these counterfactual exercises are comparative
statics of commuting costs, our results suggest the qualitative features of such counterfactual
exercises may change sign in response to changes in incidental parameters.



7    Stability

It is common to appeal to stability as a selection device in the presence of multiple equilibria.
This leads to the question of how to define stability. One candidate, particularly relevant for the
quantitative literature, is to say that an equilibrium is stable if an iterative process will converge
to it. Formally, if equilibria are defined by f () = g () then equilibria are fixed points of h() = ,
for h()  f -1 (g ()). It is well known that an iterative process will find a fixed point  if and
only if |h ( )| < 1. Surprisingly, this notion of stability is not well defined. To understand the
problem with this definition, observe that h() =  + (1 - ) also defines solutions of
f () = g (), and therefore, that fixed points of h() = [(h() - (1 - ))/] =  are also solutions
of f () = g () . However, the stability properties of this second equation may be different from
the original. By choosing  sufficiently small, we guarantee that |h ( )| > 1. Thus, an iterative
notion of stability is not invariant to different, equivalent ways of formulating the equilibrium
conditions.

A second approach to stability requires that we specify an adjustment process describing how the
three state variables for our economy, L0 , M0 and s00 , respond to a perturbation. Stability is then
well defined in the resulting dynamic system. This approach is subject to two problems. First, it
is likely to be intractable. Second, it must rest on ad hoc descriptions of the adjustment process,
and we suspect that the stability of any particular equilibrium is likely to be sensitive to these
assumptions.


                                                 26
These difficulties lead us to a more game-theoretic notion of stability. In the spirit of trembling
hand perfection, we say that an equilibrium is stable if households want to return to the
equilibrium when an arbitrarily small measure of them are displaced. This definition of stability
has three advantages. First, like our model, it is static and does not require an explicit
description of time. Second, and unlike the other candidate definitions of stability, it has explicit
behavioral foundations. Third, as we will see, it is tractable.

Let ij and kl be two arbitrary location pairs; ij = kl (location pairs are equal) when i = k and
j = l hold simultaneously and distinct otherwise. We say that an equilibrium is unstable if, for
some ij = jk , for any arbitrarily small  > 0, there is a subset of individuals of mass  who
strictly prefer the location pair kl, which differs from their utility-maximizing pair ij , when a
perturbation moves them all to kl. In other words, the subset of individuals who have been
moved away from ij do not want to move back. Otherwise, the equilibrium is stable.

The key issue is to determine the subset of individuals to use to check whether the equilibrium is
unstable. In what follows, we assume that this subset is formed by individuals whose types are
close to those of an individual indifferent between her equilibrium pair ij and another location
pair kl. Lemma 4 establishes that such an individual always exists.

Consider an equilibrium commuting pattern s (s       ij ), which could be interior or corner, and two
location pairs, ij and kl, such that ij = kl and sij > 0. We say that an individual   [0, 1] is
indifferent between ij and kl if and only if
                                                           
                                      Vij ( ) = Vkl ( )  Vod ( ),                                 (35)

for every location pair od such that od = ij and od = kl. Given this definition, we have:


Lemma 4 For any two distinct location pairs ij and kl such that s     ij > 0, there exists an
individual   [0, 1] with zij ( )  Sij and zkl ( ) > 0 who is indifferent between ij and kl.


Proof: See Appendix H.


Definition 3 Consider an arbitrarily small subset of individuals of measure  > 0 who choose ij
and have types close to z( )  Sij where  is indifferent between ij and kl = ij . If this individual
is strictly better off when she and her neighboring individuals are relocated from ij to kl, the
spatial equilibrium is unstable. Otherwise, the spatial equilibrium is stable.


The motivation for this definition is as follows. If the relocation of a small group of almost
indifferent individuals from ij to kl makes the indifferent agent strictly better off, then, by
continuity there is a non-negligible subset of individuals who strictly prefer kl to ij . Hence, these
individuals will never switch back to ij . On the contrary, if the indifferent individual never
becomes strictly better off for any small subset, no other individual strictly prefers a different
location pair. Hence, all the individuals will be willing to switch back to ij .

By relocating a small subset of individuals from ij to kl, the commuting pattern s becomes
different from the equilibrium pattern s . Hence, for our definition of stability to make sense, we
must be able to compare the equilibrium and off-equilibrium utility levels. For this to be possible,

                                                  27
we must determine the conditional equilibrium vectors of wages and land rents W(s) and R(s).
We show in Appendices J and K that, for  > 1/2, these vectors exist, are unique and continuous
in s.

Using the above definition of stability, we are now equipped to study the stability of the equilibria
identified in Proposition 9. We start with corner equilibria.

Proposition 9 The corner equilibria are always unstable.

Proof: See Appendix I.

This result is easy to understand. Consider the agglomerated corner equilibrium L = (0, 1, 0).
No single individual wants to move to, say, location 1 because her marginal productivity would be
zero. This is why (0, 1, 0) is an equilibrium employment pattern. By contrast, when a small
subset of workers happens to be at 1, equation (13) implies the income of those whose tastes are
very close to those of the indifferent individual is extremely high. As a consequence, they do not
want to move back to location 0.

If we rely on stability to select among multiple equilibria, it means that we can ignore the corner
equilibria. This result has the potential to greatly simplify quantitative exercises based on this
family of models.

By Proposition 3, interior equilibria always exist. The next proposition provides necessary and
sufficient conditions for an interior equilibrium to be stable. Denote by CR be the equilibrium
that prevails under constant returns.

Proposition 10 There exists a function F() independent of  such that an interior equilibrium
 is stable if and only if F( ) > 1. This function is continuous over (0 , CR ) and over
(CR , 1 ), satisfies F(0 ) = F(1 ) = 0, and has a vertical asymptote at  = CR .

Proof : See Appendix J where we also give the explicit form of function F.

Proposition 10 provides a simple test for checking the stability of any interior equilibria. In fact,
it also allows us to draw general conclusions about stability. The left panel of figure 4 illustrates
the function F. In this panel, the value of F is on the x-axis and ln  on the y -axis (strictly, this is
a plot of the correspondence F-1 ). The critical value F = 1 is indicated by the dotted vertical
line. As in figure 2, we transform the y -axis for legibility. From this figure, we can read off the
intervals of  where the equilibrium is stable by checking whether F > 1. These regions are
indicated by the horizontal shaded bands.

In the right panel of figure 4 we repeat the left panel of figure 2. This figure describes the
equilibrium correspondence between  and ln . Since the y -axes on the two panels agree, we can
put them next to each other and project the stable intervals onto the equilibrium correspondence
between  and ln  given in the right panel. This done, we can also read off the intervals of  for
which some or all of the possible interior equilibria are stable. As in figure 2, the heavy lines
indicate stable equilibria, and dashed lines indicate unstable equilibria.

Although figure 4 is based on a particular numerical example, it illustrates the general stability
results implied by Proposition 10. In particular, the fact that F always has a vertical asymptote

                                                  28
                        Figure 4: Graphical representation of Proposition 10.




                                                 0
                1



    F                                                                                                




                                                      ln()

Notes: The right half of this figure plots the equilibrium correspondence between ln() and 
reproduced from figure 2. The x-axis in this half of the figure is  . As in figure 2, heavy lines
indicate stable equilibria and dashed lines indicate unstable equilibria. The left half of this figure
uses the same parameter values to plot the function F (times minus one) from Proposition 10 on
the x-axis and ln() on the y -axis. From Proposition 10,  is a stable equilibrium whenever F > 1.
The F = 1 threshold is illustrated by the vertical dashed line in the left panel. Intervals of ln()
where F > 1 and equilibrium is stable are indicated by the shaded horizontal bands.


at  = 0 guarantees that for  sufficiently close to zero, equilibrium will always be stable.
Furthermore, from our discussion of equilibrium in the weak IRS case, we know that  is close to
0 or 1 if and only if the equilibrium is close enough to a corner equilibrium. Therefore, because
F(0 ) = F(1 ) = 0, it must be that equilibria close enough to corner equilibria are unstable.

We replicate the evaluation of stability reported in figure 2 for different parameter values. The
following additional features of stability, visible in figure 2 recur. First, for  sufficiently large, the
unique strong increasing returns to scale equilibrium always becomes unstable. Second, for
0 < L , the interior `weak IRS' branch of equilibrium continues to be stable for values of  > m ,
but eventually becomes unstable at about the same value of  at which the highly centralized
equilibrium becomes stable. Third, for 0 < L , the centralized moderate  equilibrium remains
stable until  increases almost to s before becoming unstable. Fourth, for 0 < L , the
decentralized branch of moderate and strong returns to scale equilibrium becomes stable for
values of  about the same as those for which the centralized branch becomes unstable, and
remains stable until  is above s .



8       A very short introduction to European urban history

Explaining the evolution of cities and their role in the process of economic growth over the course
of history has long been central to urban economics, and the literature has long looked to history
as a way to assess the relevance of our theories of cities. In what follows, we examine how an


                                                     29
equilibrium city changes as the degree of increasing returns,  , increases and compare these
changes to the history of European cities from the pre-industrial period to the present.

The historical record, surveyed below, indicates that returns to scale have increased over the past
several centuries. The evolution of urban density during this time has been non-monotonic. Cities
formed and became denser and employment more concentrated, before gradually becoming less
dense with employment less concentrated. As figure 2 demonstrates, this basic pattern of
increasing, and then decreasing density and concentration of employment can be observed along
every one of the possible equilibrium paths predicted by our model as returns to scale increase.
Thus, our model rationalizes the joint evolution of returns to scale and these basic features of
cities.

To focus on returns to scale, we ignore other important trends, e.g., decreases in transportation
cost and in the land intensity of production. We have three reasons for this. First, up until now,
the theoretical understanding of the implications of changes in returns to scale has been restricted
by the intractability of this problem. This is where our results are the most novel. Second, as we
will see, changes in returns to scale alone can explain qualitative features of the history of cities.
Finally, as important as other changes have been, increases in productivity are surely more
important. By focusing on changes returns to scale we keep attention on the central economic
force behind the industrial revolution.

The existence of various types of agglomeration effects in modern cities is well established, even if
debate continues about exactly how large they are. We do not have systematic evidence about
time series change in the importance of agglomeration effects, but three well-established facts
from economic history suggests that returns to scale are increasing. First, during the period
around 1500, de Vries (1984) reports 154 European cities with population above 10, 000, while
Bairoch (1988) reports 89 cities of at least 20, 000. At this time, Europe (without Russia) had
only between 10 and 12 cities of more than 100, 000 inhabitants. By 1800, the count of cities with
a population of at least 10, 000 and 20, 000 increased to 364 and 194, respectively. Similarly, the
share of the urban population was low and rose slowly from 10.7 in 1500 to 12.2 percent in 1750.
The urbanization rate was still around 12 percent in 1800, but grew rapidly to 19 percent in 1850,
38 percent in 1900, 51 percent in 1950, and 75 percent in 2000 (Bairoch, 1988). Before the
industrial revolution, Europe (without Russia) has no city of more than 2 million, but by 1910,
four European cities cross this threshold (Berlin, London, Paris, and Vienna). Without a doubt,
European cities have become progressively more attractive. While these increases are surely not
entirely due to increases in returns to scale in production,11 it is equally sure that stronger
returns to scale are partly responsible.

Second, economic historians have documented many small changes in pre-industrial Europe that
contributed to the productivity of cities. For example, Cantoni and Yuchtman (2014) observe the
spread of Universities in 14th century Germany and argue that, by spreading knowledge of Roman
law, these Universities contributed to larger and more productive market cities. Dittmar (2011)
documents the spread of the printing press and finds that it contributed causally to the sizes of
cities where it was introduced. Finally, de la Croix et al. (2018) argue that apprenticeship may
have played a similar role by facilitating the transmission of tacit knowledge. In all, the history of
the pre-industrial period points to slow increases in the productivity of cities.
 11
      See Nunn and Qian (2011), for example.




                                                 30
Finally, the nature of production has changed in a way that indicates an increase in returns to
scale. For the period prior to the industrial revolution, de Vries (1984) reports on the
pervasiveness of proto-industrialization in manufacturing. Under this system, rural households
performed manufacturing at home, often of textiles, using materials provided by manufacturers.
It is hard to imagine a system of industrial production that more strongly suggests constant or
decreasing returns to scale in manufacturing.

Summing up, we can be confident that agglomeration and scale economies are positive in the
modern economy and the available evidence strongly suggests that they were small and increasing
in the pre-industrial period.12 Taken together these two observations indicate a trend upwards.

We now turn to a stylized description of the evolution of cities from the pre-industrial period to
the present. de Vries (1984) describes cities in pre-industrial Europe as being organized as much
for protection as production. Much of the population was employed in agriculture, either within
city walls or without, manufacturing was at least as rural as urban, and the preponderance of
urban residents were abjectly poor. While the absolute poverty of an average urban resident is
clear, there is suggestive evidence from the us for the relative poverty of urban residents as well.
Costa (1984) reports in a survey of US soldiers in the US civil war, early in the US industrial
revolution, and finds that soldiers with urban backgrounds were shorter than those from rural
backgrounds.

Clark (1951) is the first effort to provide systematic evidence about patterns of urban density. In
this landmark study, Clark collects historical census data for twenty US and European cities.
While the precise time period he considers varies from city to city, his data often begins early in
the industrial revolution and continues until the early 20th century. His findings are unequivocal:
center city density falls and density gradients flatten over time.

Turning to the late 20th and early 21st centuries, Baum-Snow (2007) documents the decline in US
central city population from 1950 to 1990, a phenomena earlier described by Meyer et al.
(1965).13 Glaeser and Kahn (2004) find that in late 20th century US, employment follows
decentralizing population to the suburbs and that peripheral urban residents of US cities tended
to have much longer commutes than did central residents. Related to this, Garreau (1992)
documents the rise of `edge cities' in late 20th century US, while McMillen and MacDonald (1998)
provide econometric support for this idea using detailed data for Chicago. More recently, Couture
and Handbury (2017) and Couture et al. (2019) document a resurgence of central cities in the US.

Inspection of figure 2 shows that this basic pattern occurs along any possible equilibrium path as
returns to scale increases. In particular, along all equilibrium paths: (1) land rents are nearly the
same in the center and the periphery for  small; (2) as  increases central land rents enter a
region of rapid or discontinuous increase corresponding the industrial revolution; (3) as 
increases past the region of rapid or discontinuous increase, as in the late 20th century, land rents
in the center and periphery gradually equalize as employment becomes more suburban. Note that
in this region of  multiple equilibria are possible, and so this is a region where we would expect
to see more complex cities, again, like what emerged in the late 20th century.
  12
     We note the Cesaretti et al. (2020) study finding that tax collection per capita increases with city size in England
between 1450 and 1670. While this result seems relevant, it is unclear whether it reflects increases in the efficiency
or effort of tax collectors, or increases in productivity of city residents, or simply the first nature advantages of larger
pre-industrial cities.
  13
     Angel-Garcia et al. (2015) document the corresponding phenomena in European cities.



                                                            31
Summing up, while both our model and our description of history are stylized, important features
of the history of cities can be rationalized by our model and a trend upward in the strength of
returns to scale.



9     Extensions and discussion

9.1   Exogenous first-nature amenities and productivity

The QSM literature typically allows locations to differ in their exogenous productivity and
amenities. We have so far considered a geography of identical locations in order to focus attention
on the way that commuting costs, returns to scale and preference heterogeneity interact to
determine the equilibrium. This leaves open the possibility that economic fundamentals interact
with first nature advantages to give rise to qualitatively different behavior than is possible in a
homogenous geography. We here introduce such first nature advantages into our model in order
to investigate this possibility.

We change the model developed in Section 3 in exactly two ways. First, we introduce a
multiplicative location specific residential amenity Oi and work amenity Dj for each location.
This leads to the indirect utility function
                                                              Wj
                                    Vij ( ) = zij ( )Oi Dj       
                                                                     .                           (36)
                                                             ij Ri

This coincides with equation (2) in the special case when Oi = Dj = 1. Second, we generalize the
expression for location specific productivity to allow for productivity to vary with exogenous first
nature differences, Tj , so that
                                             Aj = Tj L j.                                      (37)
This coincides with equation (12) when Tj is one.

Consistent with the symmetry assumption imposed throughout, we require that O, D and T take
the same value in each of the peripheral locations, and define
                                                        
                               O0                 D0                     T0
                         o             ,   d                    and t       .
                               O1                 D1                     T1

In Proposition 11, proved in Appendix K, we derive the functions describing how residence,
employment, housing and commercial land use vary with wages and land rent. We find that these
functions are qualitatively similar to those described in Proposition 1. We also show that
equilibrium in the economy with first nature amenities and productivity is determined by similar
functions to those that determine equilibrium in an economy with a homogenous landscape. In
particular, proposition 11, presented below, generalizes Proposition 2 to an economy with first
nature advantages.


Proposition 11 Assume  = /. Then, a pair ( ,   ) is an interior equilibrium if and only if



                                                 32
it solves the following two equations:
                                                            1            1
                                                          -           1+ 
                     1+                  o - 2ao                (o)          + (1 + a)(1 + 2 )
                          d = f (o)                   1            1             1         1       ,   (38)
                                                    -           1+             - 
                                         (1 + a)o         (o)          + 2o          (o)  - a
                                                                                      / 1+
                     1+                               b         o + 2                1-/ 
                          d = g (o;  ) = (o)        1-/                                        ,       (39)
                                                                o + 1 + 2

where  > 0 is a scalar defined by

                                            /           b           1+  /
                                                    - 1-/
                                      d 1-/ o                   t     1-/     .

Proof : See Appendix K.
                                                                                      1+
In general the equilibrium condition is given by f (o) = g (o,  ) =   d, and one can show
f (·), although not identical to f (·), has all the qualitative properties of f (·): it is positive over an
open interval bounded away from both 0 and , and decreases from  to 0 over that interval. It
follows from this that the threshold at which the slope of g changes sign, m  /, is not affected
by amenities. This, together with qualitatively similar behavior for the functions f and g means
that the basic intuition behind Proposition 4 and 5 is unchanged by the addition of first nature
advantages. In particular, we expect a unique interior equilibrium in this region of the parameter
space.

Second, in the absence of residential amenities (o = 1), we have f (·) = f (·) so that the
equilibrium condition has the form f () = g (,  ). Thus, the effect of workplace amenities and
first nature productivity is to rescale g . This suggests again that the intuition behind
Propositions 6 and 7 should be unaffected.

Finally, we note that the impacts of both workplace amenity d and the production amenity t on
 are isomorphic, since they are both fully captured by the coefficient  in the equation
f (o) = g (o,  ). However, the impact of the two amenities on   is different, since d enters
                                                         1+
separately the equilibrium equation f (o) = g (o,  ) =   d.


9.2    Spillovers

It is common in the urban economics and QSM literatures to model local productivity as a
function of the amount of economic activity in a particular location and a distance discounted
sum of nearby economic activity. The mathematical representation of this idea is usually called a
potential function and was introduced by Fujita and Ogawa (1982), although the idea of
productivity enhancing local spillovers is much older. In the model presented in Section 3 we
restrict increasing returns to scale to operate only within a location. We here investigate the
implications of the more general formulation.

To accomplish this, we make a single change to the model described in Section 3. In place of the
definition of local productivity given by equation (12) we assume that productivity at j = 0, 1 is
given by:
                         A0 = (L0 + 2L1 ) ,      A1 = (L0 + (1 +  2 )L1 ) .                    (40)

                                                      33
       Figure 5: Equilibrium correspondence between  and  with productivity spillovers.




                    




                                                      

Notes: Equilibrium correspondences between ln() and  . Black line: reproduced from figure 2a,
but also showing corner equilibria. Blue line: like figure 2a, but with  = 0.02. Red line: like figure
2a, but with  = 0.04.


Here,   [0, 1) describes the rate at which spillovers decay with distance, and   0 continues to
describe the rate at which productivity increases with employment in a location. Note that
equation (40) converges to equation (12) as   0.

Recalling that the function f given in Proposition 2 does not depend on  , it should be
unsurprising that this function remains unchanged from equation (27) under the more general
technology. The function g , however, does not remain the same. In particular, following logic
similar to that used to derive equation (28), one can derive the analogous equation when
spillovers operate:
                                                                       
                               1       ( + 2) + 2 ( + 1 + 2 )           
                          = a                                            .                     (41)
                                  (1 +  2 )( + 1 + 2 ) +  ( + 2)

Note that equation (41) is now transcendental. However, when  = 0, this expression becomes
(K.27) given in Appendix K for our baseline case without spillovers.

We have focussed our efforts on numerical solutions to equations (41) and (27) for small values of
 . This is the empirically relevant range for  and provides a basis for thinking about whether
equilibrium responds continuously to the introduction of small cross location productivity
spillovers.

Figure 5 illustrates typical results. This figure is based on the same parameters as figure 2a
( = 0.6;  = 0.3;  = 7;  = 1.1). The heavy black line reproduces equilibrium correspondence
between  and  from figure 2a, where spillovers are zero. The blue and red lines are identical,
but assumes  = 0.02 and 0.04, respectively. Figure 5 suggests two conclusions. First, that the
corner equilibria are not robust to the inclusion of a small spillover. Rather, with small spillovers,
these equilibria become `near corner' interior equilibria. Second,  at a corner equilibrium
responds continuously to the introduction of a small spatial productivity spillover.


                                                 34
Summing up, numerical analysis of the economy with a small amount of spatial productivity
spillovers suggests that equilibrium responds continuously to the introduction of such spillovers.
In other words, we should not expect qualitatively different equilibrium behavior to arise as a
consequence of low levels of productivity spillovers, particularly at the interior equilibria.


9.3   Welfare

A discussion of the welfare properties of equilibrium and a characterization of optimal outcomes is
beyond the scope of this investigation. With this said, we note two important obstacles to such an
analysis.

First, since our model is populated by heterogenous agents, arriving at a measure of welfare
requires finding a way to aggregate their preferences. The difficulty of this problem is well known.
One possibility for avoiding this problem is to treat our model as a stochastic one in which ex
ante identical agents receive stochastic taste shocks. In this case, one avoids the problem of
aggregating the preferences of heterogenous preferences by evaluating the expected utility of ex
ante identical agents. This resolves the problem of aggregating preferences. However, the
stochastic model is explicitly dynamic. Households draw tastes, make location choices, and realize
prices. For such a model to be complete, we require households to formulate beliefs about future
prices, conditional on their taste draw, before choosing their location. We should also evaluate
welfare on the basis of realized rather than expected prices. This problem is common in the QSM
literature, and is typically resolved by making an informal appeal to the law of large numbers to
claim that expectations about prices must coincide with realized prices. As we noted earlier, the
application of the law of large numbers to a continuum is non-trivial.

Second, while the classical urban economic literature typically relies on aggregate land rent to
measure surplus, the QSM literature relies on some measure of average utility, often real expected
income. Obviously, these two approaches are not logically consistent. Two solutions suggest
themselves. First, in the context of the QSM framework, to find a way to dissipate land rents, say
in the production of housing. Although this leads to a logically coherent approach to welfare, we
note two problems. Fundamentally, urban land rent is an important feature of the real world and
treating it as a nuisance seems unsatisfactory. Second, to the extent that the housing production
function involves decreasing returns, it must also involve profits. As with land rent, a complete
model of welfare should account for these profits. The second solution to this problem involves,
somehow recycling land rents into household budget constraints. This is theoretically appealing,
but involves imposing important ad hoc distributional rules.


9.4   Geography

On its face, one of the more fundamental differences between the quantitative and the classical
urban economic literatures is the difference between a discrete and a continuous geography. In our
analysis, we have further restricted attention to an especially simple discrete geography. It seems
natural to wonder about the extent to which our results are a reflection of restricting households
to choose from a discrete set, and from an especially simple discrete geography in particular.

Any quantitative exercise must begin by delimiting the area to be studied. The discussion in


                                                35
Section 3 suggests that such a delimitation, together with QSM discrete choice machinery, will
generally lead to an average preference for central work and residence.14 This has two important
implications. First, our analysis has been organized around understanding the interplay of three
main economic forces, returns to scale, commuting costs, and the average preference for central
work and residence. Stipulating to the generality of the preferences for central work and residence,
and noting that commuting costs and returns to scale also (usually) operate in the more
complicated models that form the basis of quantitative exercises, we should expect that intuition
derived from our simple example will often extend to these more complicated settings. Second,
because delimiting boundaries and assuming a QSM type discrete choice framework creates
preferences for central work and residence, a researcher's decisions about study area boundaries
partly determines the first nature advantages of interior locations. In some applications, this may
not be important. The transit network assures that any model will conclude that central or lower
Manhattan is the center of the New York Metropolitan area, whether Connecticut suburbs are
included in the study area or not. However, New York has the most extensive subway network in
the world. In other applications, the decision to include or exclude a peripheral suburb could have
important implications for the resulting quantitative equilibrium. This suggests that the choice of
study area boundaries deserves careful attention in quantitative exercises.

In Proposition 3 we see that every location must always be occupied in equilibrium. This result
appears to extend to arbitrary geographies, and is one of the more noteworthy differences between
the quantitative spatial models and the classical urban economics literature. In the classical
literature, cities almost always have an edge beyond which agents will not commute in
equilibrium. As important as is the discrete geography to the behavior of our model and its more
complex quantitative cousins, we here note that the discrete geography does not appear to
responsible for this difference between the two frameworks. There are three reasons for this claim.
First, commute costs are typically additive in the classical framework. This means that, if there is
a cost of commuting, there is some distance beyond which commuting is impossible because it lies
outside the budget set. In our framework, as is typical in quantitative models, commuting costs
are multiplicative and so this hard constraint on commuting costs does not occur. Second, in
typical quantitative models, the support of individual tastes for workplace-residence pairs is
unbounded. That all locations are occupied may hold true in the case of a continuous geography
as discrete choice models, such as the logit, may be extended to a continuous choice set
(Ben-Akiva et al., 1985). Hence, a discrete geography alone is not necessary to assure an
equilibrium where all locations are occupied. Finally, inspection of the indirect utility function on
which our analysis is based, equation (2), shows that this function is linear in income and
hyperbolic in land prices. Thus, agents can accept an infinitesimal wage in return for zero land
rent and still achieve infinite utility. This feature of preferences, also common to quantitative
models, must also play a role in assuring that all locations are occupied.

We agree that no obviously better alternative appears to be available. There is no simple way to
define what a "realistic" geography should be. Furthermore, the most common alternative is to
consider a space without edges, either a circle or an unbounded line or plane. There has been a
large literature devoted to the formation of cities on such spaces. One of the hallmarks of this
literature is its mathematical sophistication. As a consequence, these models are often too
abstract to suggest themselves as a foundation for empirical or quantitative research. How to
model space remains an issue in search of a good theory.
 14
      There are obvious, empirically irrelevant, counter-examples, e.g. a ring city.



                                                            36
10    Conclusion

Understanding how people arrange themselves when they are free to choose work and residence
locations, when commuting is costly, and when increasing returns to scale affect production, is
one of the defining problems of urban economics. We address this problem by combining the
discrete choice models employed by the recent quantitative spatial models literature, with the
stylized geographies of classical urban economics. This permits a complete description of
equilibria, throughout the parameter space.

Equilibrium behavior is surprising and interesting for a number of reasons. First, we find that
corner equilibria exist in much of the parameter space. In these equilibria, employment does not
occur in all locations. Given that the support of individual tastes for workplace-residence pairs is
unbounded, this result is unexpected. Second, comparative statics as returns to scale increase
contradict the conventional wisdom: increasing returns to scale in production can cause
dispersion as well as agglomeration. Third, comparative statics on commuting costs also
contradict conventional wisdom. As in the monocentric model, reductions in commuting costs can
lead to dispersed economic activity, but they can also lead to greater concentration.

By combining classical urban economics and the QSM toolbox, we have also learned about how
the two frameworks differ. Introducing heterogeneous agents with commuting costs is not merely
a mathematical trick for solving a difficult choice problem. It is a fundamental change from
classical urban economics. Introducing agents with heterogenous preferences over work-residence
location pairs results in an average preference for central work and residence. These average
preferences lead to centralized employment and residence even in the absence of increasing
returns to scale. Neither preference is present in the older literature.

Our results also seem to have implications for quantitative exercises. We provide a basis for
thinking about the extent to which quantitative comparative statics primarily reflect features of a
particular data set, or if they are a direct consequence of the interaction of commute costs,
returns to scale, and preference heterogeneity in the model. For example, in the absence of
returns to scale our model requires lower central than peripheral wages because wages capitalize
the average preference for central employment. To match the modern day empirical regularity of
higher central than peripheral wages, we require that returns to scale be high enough to more
than offset this capitalization. It follows that the returns to scale parameter in this model does
not correspond to the elasticity we obtain from regressing wages on density, a common empirical
measure of scale economies.

The existence of corner equilibria whenever there are increasing returns to scale seems likely to
generalize to the richer models used for quantitative exercises. To the extent that calibration and
estimation techniques rely on the uniqueness of equilibria, this seems to be important. While our
notion of stability can exclude these equilibria from consideration, it is less clear whether these
equilibria will be attractive to the particular algorithm used to find equilibrium in a quantitative
exercise. This concern seems especially relevant given that the results of an iterative solution
algorithm need not be robust to different ways of stating equilibrium conditions. Furthermore, it
might be worth recalling that the uniqueness of a competitive equilibrium in general equilibrium
models is more often the rule than the exception (Arrow and Hahn, 1971). This may explain why
very specific assumptions are made in the QSM literature. Yet, we have seen that such
assumptions may not be sufficient to get rid of the riddle of multiple stable equilibria.


                                                37
Third, a back of the envelope calculation suggests than quantitative exercises may well be within
estimation error of the weak-moderate returns to scale threshold. This is the region of the
parameter space where the model's behavior is most complicated. Inspection of figure 2 indicates
that (depending on which regime the economy is in) that catastrophic discontinuities, instability,
and stable continuity are all consistent with equilibrium around this threshold. This suggests that
at least a rudimentary exploration of what happens when the economy crosses from the weak to
moderate increasing returns to scale region is of interest.

Fourth, one of the more common uses of quantitative models is to evaluate comparative statics for
commuting costs. Our results make clear that these comparative statics are complicated and may
be sensitive to changes in the values of structural parameters. Our simple model does not provide
a basis for thinking about how sensitive richer empirical models may be to this problem, but it
does suggest that the possibility should at least be considered. This suggests the importance of
robustness checks in which the values of these parameters are permitted to vary.

Finally, we show that the qualitative behavior of our model as returns to scale increase (along one
of the possible equilibrium paths), can reproduce many of the qualitative features observed over
the last 500 years of urban history in the Western world. Urbanization and increasing
productivity are surely two of the most important economic phenomena in history and they
appear to have been closely linked. That a simple economic geography model relating the two can
reproduce basic features that we observe in the history of urbanization is striking, but it should
probably not be surprising given that our model describes central issues in urban history.




                                                38
References

Ahlfeldt, G. M., Redding, S. J., Sturm, D. M., and Wolf, N. (2015). The economics of density:
 Evidence from the berlin wall. Econometrica, 83(6):2127­2189.

Allen, R. C. (2001). The great divergence in european wages and prices from the middle ages to
  the first world war. Explorations in Economic History, 38(4):411­447.

Allen, T. and Arkolakis, C. (2014). Trade and the topography of the spatial economy. The Quarterly
  Journal of Economics, 129(3):1085­1140.

Allen, T., Arkolakis, C., and Li, X. (2015). Optimal city structure. Yale University, mimeograph.

Alonso, W. (1964). Location and land use. Harvard University Press.

Anas, A. (1983). Discrete choice theory, information theory and the multinomial logit and gravity
 models. Transportation Research Part B: Methodological, 17(1):13­23.

Anas, A. (1990). Taste heterogeneity and urban spatial structure: The logit model and monocentric
 theory reconciled. Journal of Urban Economics, 28(3):318­335.

Anderson, S. P., de Palma, A., and Thisse, J.-F. (1992). Discrete choice theory of product differentiation.
 MIT Press.

Armington, P. S. (1969). A theory of demand for products distinguished by place of production.
  IMF Staff Papers, 16(1):159.

Arrow, K. J., Hahn, F., et al. (1971). General competitive analysis.

Arzaghi, M. and Henderson, J. V. (2008). Networking off madison avenue. The Review of Economic
  Studies, 75(4):1011­1038.

Bairoch, P. (1988). Cities and economic development: from the dawn of history to the present. University
  of Chicago Press.

Balboni, C. A. (2019). In Harm's Way? Infrastructure Investments and the Persistence of Coastal Cities.
  PhD thesis, London School of Economics.

Baum-Snow, N. (2007). Did highways cause suburbanization? The Quarterly Journal of Economics,
  122(2):775­805.

Beckmann, M. J. (1976). Spatial equilibrium in the dispersed city. In Environment, Regional Science
  and Interregional Modeling, pages 132­141. Springer.

Ben-Akiva, M., Litinas, N., and Tsunokawa, K. (1985). Continuous spatial choice: the continuous
  logit model and distributions of trips and urban densities. Transportation Research Part A:
  General, 19(2):119­154.

Cantoni, D. and Yuchtman, N. (2014). Medieval universities, legal institutions, and the commercial
  revolution. The Quarterly Journal of Economics, 129(2):823­887.

Cesaretti, R., Lobo, J., Bettencourt, L. M., and Smith, M. E. (2020). Increasing returns to scale in the
  towns of early tudor england. Historical Methods: A Journal of Quantitative and Interdisciplinary
  History, 53(3):147­165.

Clark, C. (1951). Urban population densities. Journal of the Royal Statistical Society, 114(4):490­496.


                                                    39
Costa, D. L. (2015). Health and the economy in the united states from 1750 to the present. Journal
  of Economic Literature, 53(3):503­70.

Couture, V., Gaubert, C., Handbury, J., and Hurst, E. (2019). Income growth and the distributional
  effects of urban spatial sorting. Technical report, National Bureau of Economic Research.

Couture, V. and Handbury, J. (2017). Urban revival in America, 2000 to 2010. Technical report,
  National Bureau of Economic Research.

de la Croix, D., Doepke, M., and Mokyr, J. (2018). Clans, guilds, and markets: Apprenticeship
  institutions and growth in the preindustrial economy. The Quarterly Journal of Economics,
  133(1):1­70.

de Palma, A., Ginsburgh, V., Papageorgiou, Y. Y., and Thisse, J.-F. (1985). The principle of
  minimum differentiation holds under sufficient heterogeneity. Econometrica, pages 767­781.

de Vries, J. (1984). European Urbanization, 1500-1800. Routledge.

Dingel, J. I. and Tintelnot, F. (2020). Spatial economics for granular settings. Technical report,
  National Bureau of Economic Research.

Dittmar, J. E. (2011). Information technology and economic change: the impact of the printing
  press. The Quarterly Journal of Economics, 126(3):1133­1172.

Eaton, J. and Kortum, S. (2002). Technology, geography, and trade. Econometrica, 70(5):1741­1779.

Feldman, M. and Gilles, C. (1985). An expository note on individual risk without aggregate
  uncertainty. Journal of Economic Theory, 35(1):26­32.

Fujita, M. (1989). Urban economic theory: Land use and city size. Cambridge University Press.

Fujita, M. and Ogawa, H. (1982). Multiple equilibria and structural transition of non-monocentric
  urban configurations. Regional Science and Urban Economics, 12(2):161­196.

Garcia-López, M.-À., Holl, A., and Viladecans-Marsal, E. (2015). Suburbanization and highways
 in Spain when the Romans and the Bourbons still shape its cities. Journal of Urban Economics,
 85:52­67.

Garreau, J. (1992). Edge city: Life on the new frontier. Anchor.

Glaeser, E. L. and Kahn, M. E. (2004). Sprawl and urban growth. In Handbook of Regional and
  Urban Economics, volume 4, pages 2481­2527. Elsevier.

Heblich, S., Redding, S. J., and Sturm, D. M. (2020). The making of the modern metropolis:
 evidence from london. The Quarterly Journal of Economics, 135(4):2059­2133.

Herzog, I. (2020). The city-wide effects of tolling downtown drivers: Evidence from london's
 congestion charge. Technical report, University of Toronto.

Judd, K. L. (1985). The law of large numbers with a continuum of iid random variables. Journal
  of Economic theory, 35(1):19­25.

Kahneman, D., Krueger, A. B., Schkade, D. A., Schwarz, N., and Stone, A. A. (2004). A survey
  method for characterizing daily life experience: The day reconstruction method. Science,
  306(5702):1776­1780.

Lucas, R. E. (2001). Externalities and cities. Review of Economic Dynamics, 4(2):245­274.

                                                  40
Lucas, R. E. and Rossi-Hansberg, E. (2002). On the internal structure of cities. Econometrica,
  70(4):1445­1476.

McMillen, D. P. and McDonald, J. F. (1998). Suburban subcenters and employment density in
 metropolitan chicago. Journal of Urban Economics, 43(2):157­180.

Meyer, J. R., Kain, J. F., and Wohl, M. (1966). The Urban Transportation Problem. Harvard University
 Press.

Mills, E. S. (1967). An aggregative model of resource allocation in a metropolitan area. The
 American Economic Review, 57(2):197­210.

Monte, F., Redding, S. J., and Rossi-Hansberg, E. (2018). Commuting, migration, and local
 employment elasticities. American Economic Review, 108(12):3855­90.

Muth, R. F. (1969). Cities and housing. University of Chicago Press. Chicago, IL.

Nunn, N. and Qian, N. (2011). The potato's contribution to population and urbanization: evidence
 from a historical experiment. The Quarterly Journal of Economics, 126(2):593­650.

Ogawa, H. and Fujita, M. (1980). Equilibrium land use patterns in a nonmonocentric city. Journal
 of Regional Science, 20(4):455­475.

Redding, S. J. (2020). Trade and geography. Technical Report w27821, National Bureau of
  Economic Research Working Paper Series.

Redding, S. J. and Rossi-Hansberg, E. (2017). Quantitative spatial economics. Annual Review of
  Economics, 9:21­58.

Redding, S. J. and Turner, M. A. (2015). Transportation costs and the spatial organization of
  economic activity. Handbook of regional and urban economics, 5:1339­1398.

Severen, C. (2018). Commuting, labor, and housing market effects of mass transportation: Welfare
  and identification. Technical report, Federal Reserve Bank of Philadelphia.

Tabuchi, T. and Thisse, J.-F. (2002). Taste heterogeneity, labor mobility and economic geography.
  Journal of Development Economics, 69(1):155­177.

Tsivanidis, N. (2019). The aggregate and distributional effects of urban transit infrastructure:
  Evidence from Bogotá's Transmilenio. Unpublished manuscript.

Uhlig, H. (1996). A law of large numbers for large economies. Economic Theory, 8(1):41­50.




                                                41
Appendix

A. Proof of Lemma 1(iv)

Step 1. We first show that
                                            (1 + a)xy + 2ax + 2y
                                 (x, y )                                                    (A.1)
                                            x + ay + (1 + a)(1 + 2 )
                                                2 . We have
is increasing in both x and y for all (x, y )  R++

      (x, y )   (1 + a)ay 2 + (1 + a)2 (1 + 2 ) + 2a2 2 - 22 y + 2a(1 + a)(1 + 2 )
              =                                                                    > 0,
     x                             [x + ay + (1 + a)(1 + 2 )]2

      (x, y )   (1 + a)ax2 + (1 + a)2 (1 + 2 ) - 2a2 2 + 22 x + 2a(1 + a)(1 + 2 )
              =                                                                   > 0,
     y                            [x + ay + (1 + a)(1 + 2 )]2
because, as 0 <  < 1,

                   (1 + a)2 (1 + 2 ) + 2a2 2 - 22 > 1 + 2 - 22 = 1 - 2 > 0,

              (1 + a)2 (1 + 2 ) - 2a2 2 + 22 > a2 (1 + 2 ) - 2a2 2 = a2 (1 - 2 ) > 0.

Step 2. It is readily verified that f () satisfies the following identity:

                                                            -
                          (1 + a)f () + 2a + 2f ()
                    =                                           = [ (, f ())]- ,
                           + af () + (1 + 2 )(1 + a)

where  is defined by (A.1). When  increases, the RHS of this expression also increases, which
means that  (, f ()) decreases with . Since  increases with  and f (), this is possible only if
f () is decreasing. Q.E.D.


B. Proof of Lemma 3

It follows from the proof of Lemma 1 that 0 is the unique solution of
                                                1+          1
                               D()  (1 + a)            + 2  - a = 0.                         (B.1)

The expressions (30) and (B.1) imply that L and 0 are functions of a. We next show that 0
and L vary with a as follows,
                                             dL
                              lim L = 1,         < 0,    lim L = 1 - ,
                             a0               da         a

                                             d0                       
                              lim 0 = 0,        > 0,     lim 0 =  1+ .
                              a0             da          a


We can show that 0 (resp., L ) increases (resp., decreases) in a by applying the implicit function
theorem to D() = 0 (resp., (30)). Observe further that, when a   (resp., a  0), dividing

                                                  42
D() = 0 by a and taking the limit yields 0 = /(1+) (resp., 0 = 1). Last, when a  
(resp., a  0), taking (B.1) at the power a and the limit yields L = 1 -  (resp., L = 1).

To determine where 0 and L intersect, we compare lima L and lima 0 by considering
the equation
                                    /(1+) +  = 1.                              (B.2)

Differentiating the LHS of (B.2) with respect to  shows that it increases from 0 to 2 when 
increases from 0 to 1. The intermediate value theorem then implies that, for any given , the
equation (B.2) has a unique solution ()  (0, 1), which increases with .

The inequality 0  L holds if /(1+)  1 - , which amounts to   (). If  <   1,
then there exists a unique value a > 0 that solves the condition L (a) = 0 (a). Consequently, if
a < a, then 0  L . If a  a, then 0 > L . Summing up, 0  L if    or a  a, and 0 > L
when both conditions fail. Q.E.D.


C. Proof of Proposition 3

Only two employment patterns may be symmetric corner equilibria: (0, 1, 0) and (1/2, 0, 1/2).

Case 1: L = (1/2, 0, 1/2). The demand for commercial land at j = 0 is zero (N0
                                                                              = 0). Hence,

the land rent equilibrium condition (11) at i = 0 and i = 1 amount to
                                                         1
                                            1+
                                                       1+
                                  R0 =    2W1                > 0,                            (C.1)
                                       H0
                                                            1
                                                 1+
                                                          1+
                                R1 =    (1 + 2 )W1              > 0.                         (C.2)
                                     H1

Multiplying both sides of the land balance conditions (C.1) and (C.2) by, respectively, R0 and R1 ,
we get:
                                           R0 H0 = R0 ,                                      (C.3)
                                                     1-
                           R1 H1 + R1 N1 = R1 H1 +        W1 L1 = R1 .                       (C.4)
                                                       
Dividing (C.3) over (C.4), we obtain:
                                        R0          R0
                                  r=       =                 .                               (C.5)
                                        R1   R1 H1 + 1-
                                                       W1 L1


It then follows from (C.1)-(C.2) that
                                               1+ -
                                        R0 = 2W1 R0 ,                                        (C.6)
                                                  1+ -
                                 R1 H1 = (1 + 2 )W1 R1 .                                     (C.7)

The labor market balance condition at j = 1 is given by
                                                         -    -
                     L1 = s11 + s01 + s-11 = W1 (1 + 2 )R1 + R0 ,

                                                43
so that
                                          1+ -            1+ -
                                W1 L1 =  W1 R0 + (1 + 2 )W1 R1 .                            (C.8)

Plugging (C.6)-(C.7) and (C.8) into (C.5), we get after simplifications:

                                                     2ar-
                                            r=                        ,
                                                 r- + (1 + a)(1 + 2 )
or, equivalently,
                                                                          -
                                                         2a
                                          =
                                                    + (1 + a)(1 + 2 )
whose unique solution is  = 1 . In other words, employment is evenly concentrated in the two
peripheries and the central location is specialized in residential activities.

Case 2: L = (0, 1, 0). Following the same argument as in Case 1, we end up with the equation:
                                                                      -
                                                      (1 + a) + 2
                                               =
                                                           a
whose unique solution is given by  = 0 . Therefore,  = 0 is an equilibrium if and only if
L0 = 1. Q.E.D.



D. Proof of Proposition 4

Assume  = 0. Since 0 <  < 1, we may assume throughout that   (0, 1). Note that the
equilibrium employment pattern is bell-shaped if and only if  > 1, while (34) is equivalent to
b > 1.

Some tedious calculations show that the equilibrium condition f () = g (; 0) may be rewritten as
follows:
                                     -1
                    a   -b + 1 -1
                   1+a       1+a        + 2       a 1+  1       1   b+ 1
                                                           +         = 1.                  (D.1)
                   a b + 1  + 1 + 2 1 + a
                          1+a       1+a
                                                             1+a


Since 1/x is convex, for every  < 1 Jensen's inequality implies
                                                           -1
                                 a -b   1                            a b    1
                                     +     -1                   <        +     <.           (D.2)
                                1+a    1+a                          1+a    1+a

Plugging (D.2) into (D.1) leads to
                                  a   b        1
                                 1+a      +   1+a    + 2         a 1+ 1    1  b+ 1
                     1<                                                 +            .
                                 a  b        1
                                                     + 1 + 2    1+a       1+a
                                1+a     +   1+a 


Using b > 1 yields
                                   a b    1     a     1
                                       +     <     +      = .
                                  1+a    1+a   1+a   1+a

                                                           44
                      x+2
Since the function   x+1+2
                             is increasing for all x  0, we obtain

                                + 2              a 1+ 1    1  b+ 1
                          1<                            +                       .            (D.3)
                                + 1 + 2         1+a       1+a

As (34) implies
                                         1     1     1
                                           <1+   <b+   ,
                                         a           
while  < 1, we have
                              a     1+ 1  1     b+ 1    1
                                 ( )  +      ( )  < ( ) a .
                             1+a         1+a

Replacing the bracketed term in (D.3), we obtain the inequality:
                                                 1    + 2
                                      1 < ( ) a               ,
                                                      + 1 + 2
which is equivalent to  > L , hence          > 1 (see (32)). Q.E.D.


E. Proof of Proposition 5

Assume 0 <  < /. Since  > L , we have

                                 f (L ) > f ( ) = g ( ;  ) > g (L )                          (E.1)

because f is decreasing by Lemma 1 and g is increasing in  by Lemma 2. As shown by (31),
g (L ) is independent of  . Combining this with (E.1), we obtain f (L ) - g (L ;  ) > 0. Since
f ( ) - g ( ;  ) = 0 while f - g is decreasing by Lemmas 1 and 2, we have L <  for all
 < /, which amounts to  > 1.

We now study the impact of  on (i)  , (ii)   and (iii)       .


(i) Since g (;  )/ > 0, applying the implicit function theorem to (29) leads to

                             d       g (;  )/
                               =                                         < 0,
                             d   f ()/ - g (;  )/                 =

where the numerator is positive because  > L while the denominator is negative because f ()
is decreasing and g (;  ) is increasing in .

(ii) Differentiating (27) with respect to  , we obtain:

                                     1 +  1 d    df d
                                               =      > 0.
                                            d    d d

(iii) Observe that, combining (32) with (31), the equilibrium condition (29) can be restated as
                                                            1+
                                    1+         + 2           
                                         =                       f ().                       (E.2)
                                               + 1 + 2

                                                     45
Since f () can be decomposed as

                                                                             2        1+ 1
                                                                           -2           
                                     - 1        + 1 +     2       1 + a 1++1+2
                          f () =           ·                  ·                      - 1
                                                                                              ,       (E.3)
                                                + 2                             
                                                                       1+   a -+2

Plugging (E.3) into (E.2) leads to
                                                              1
                                                                                 2         1+ 1
                                        - 1-
                                                     -1       
                                                                      1 + a 1+ -2            
                          1+              + 2
                                           
                                                                              +1+2
                               =                                  ·                   - 1
                                                                                                  .
                                         + 1 + 2                                       
                                                                       1 + a - 
                                                                              +2


The first term in the RHS clearly decreases in . Since the numerator (resp., denominator) of the
second term is decreasing (resp., increasing), the second term also decreases in . Hence, the RHS
is decreasing in  . Combining this with d /d < 0, we obtain d  /d > 0. Q.E.D.


F. Proof of Proposition 6

(i) Consider first the case when commuting costs are high. It then follows from (30) and Lemma 3
that 0 < L < 1 < 1 . Therefore, for  > 0 sufficiently small, we have:

                               0 +  < L -  < L +  < 1 < 1 .


If  is sufficiently close to / (but still such that  > / holds), Lemma 2 implies the following
inequalities:
                                    g (0 + ;  ) < f (0 + ),
                                        g (L - ;  ) > f (L - ),
                                        g (L + ;  ) < f (L + ),
                                           g (1 ;  ) > f (1 ) = 0,
where the last inequality holds because (28) implies that, for  > /, g (;  ) > 0 for all  > 0
while f (1 ) = 0 for any  by definition of 1 . Therefore, by continuity of f and g , the equation
(29) has at least three distinct solutions, which we denote as follows:

                                                1 > 2 > 3 .


Furthermore, the properties of function g imply the following:

                                               lim    1       = 1 ,
                                               lim    2       = L ,
                                               lim    3       = 0 .


The solution 2 matches the equilibrium of Proposition 5. As for the other two solutions,  and
3 , when  is close enough to /, we have  > 1 > 3 .

                                                      46
As      /, it follows from Lemma 1 that f ( ) and f (3 ) converge, respectively, to 0 and ,
which implies:
                             lim 1 = 0     and      lim 3 = .
                                                                    


Hence, 1 < 1 < 3 when  is close enough to . It then follows from (28) that

                              lim   1   =0      and               lim   3   = .
                                                                    



(ii) Consider now the case of high commuting costs. Then, we know from the proof of Proposition
7 that there exists a value a  (0, 1) such that

                                         L  0 < 1 < 1                                      (F.1)

is satisfied for a  a, and 0 < L < 1 < 1 holds otherwise. Under (F.1), there is a small  > 0
such that the following inequalities hold:

                                    g (1 - ;  ) < f (1 - ),
                                        g (1 ;  ) > f (1 ) = 0.

while  > 1 when  slightly exceeds /.

Furthermore,                                    
                                          1+
                                    lim (1 ) = f (1 ) = 0.
                                         

Since lim    1   = 0, 1 < 1 when  is sufficiently close to . Last, using (32), we have:

                                             lim       1   = 0.
                                                

Q.E.D.


G. Proof of Proposition 7

First, we show the existence and uniqueness of an equilibrium. Using (E.3) and (31), the
equilibrium condition (29) becomes after simplifications:

                                                            1+ 1
                                                                   
                                       1+ -2       2          
                           1      1 + a +1+2                         µ          
                                                                    =              ,       (G.1)
                                                                   
                         + 1 + 2            - 1                                + 2
                                 
                                            
                                    1 + a -+2

where  and µ are defined by

                         -                                    -  - (1 - )(1 + )
                            >0            and          µ                        .
                        +                                       ( + )

The first term of the LHS of (G.1) decreases in ; the second term also decreases because the
numerator decreases while the denominator increases in . Therefore, the LHS of (G.1) is a

                                                   47
decreasing function of . Furthermore, the RHS of (G.1) increases from 0 to  in  when µ > 0.
It is readily verified that  > 0 if and only if
                                                      1+
                                              >             - .
                                                    (1 -  )


Hence, (G.1) has a unique solution  .

We now show that        converges monotonically toward 1 when  > s increases. Using (32), we
obtain
                                           1            1
                                                           + 2
                                                log ( )
                                                        a
                            log      =-                                              .         (G.2)
                                          / - 1            + 1 + 2

Since  > L under strong increasing returns, the expression under the log is greater than 1 and
thus the RHS of (G.2) is negative. Furthermore, as  decreases with  , the RHS of (G.2)
increases with  . In addition, the first of the RHS goes to 0 when  goes to infinity.
Consequently,  increases and converges to 1. Q.E.D.


H. Proof of Lemma 4

The assumption s                                
                  ij > 0 implies Lj > 0, hence Wj > 0. Combining this with ??(??)?? and (35)
implies that any individual   [0, 1] whose type z( ) satisfies
                                                                                         
                                            Wl kl    
                                                    Ri                   Wd
                                                                            od       
                                                                                    Ro
                        zij ( ) = zkl ( )                      zod ( )                         (H.1)
                                            Wj ij    
                                                    Rk                   Wj ij       
                                                                                    Ri

is indifferent between ij and kl.

Two cases may arise. First, if s                          
                                kl > 0, then Ll > 0 and Wl > 0. (H.1) thus implies that any
individual  satisfying
                                                                          
                                                       W  kl        
                                                                   Ri
                     zkl ( ) > 0,     zij ( ) = zkl ( ) l                    ,   zod ( ) = 0
                                                       Wj ij       Rk

is indifferent between ij and kl.

Second, if s                             
             kl = 0, then Ll = 0 and Wl = 0. Therefore, (H.1) implies that any individual such
that zkl ( ) > 0 and zij ( ) = 0 for any ij = kl is indifferent between ij and kl. Q.E.D.


I. Proof of Proposition 9

Step 1. We first show the existence of a unique conditional equilibrium price for a symmetric
commuting pattern s such that either L(s) = (0, 1, 0) or L(s) = (1/2, 0, 1/2), and Mi (s) > 0 for
i = 0, ±1.

We focus on the case of a fully agglomerated labor supply pattern, i.e., such that L0 (s) = 1and
L-1 (s) = L1 (s) = 0 (the proof for the fully dispersed labor supply pattern given by L0 = 0 and


                                                      48
L-1 (s) = L1 (s) = 1/2 goes along the same lines). Plugging L0 = 1 and L-1 = L1 = 0 into the
FOCs (13) and (14) at i = 0, we obtain
                                  1-                                    -
                            W0 = N0               and       R0 = (1 - )N0 ,                       (I.1)

hence,
                                             W0    
                                                =    N0 .                                         (I.2)
                                             R0   1-

Observe that L1 (s) = L-1 (s) = 0 implies si1 = si,-1 = 0 for all i  {-1, 0, 1}. Combining this
with the land market clearing condition and the market residential demand at i = 0, we get:
                                                                             W0
                               H0 + N0 = 1          and           H0 = s00      ,
                                                                             R0
so that
                                                                    W0
                                     N0 = 1 - H0 = 1 - s00             .                          (I.3)
                                                                    R0

Plugging (I.3) into (I.2), we get a linear equation in W0 /R0 :


                    W0                       W0                   W 0 (s)       
                       =           1 - s00              =                 =            .          (I.4)
                    R0   1-                  R0                   R0 (s)    1 -  + s00

From (I.3)-(I.4), we get:
                                                       1-
                                        N 0 (s) =              .
                                                    1 -  + s00

Plugging N0 = N 0 (s) into the equilibrium condition (I.1) pins down uniquely the conditional
equilibrium wage W 0 (s) and the conditional equilibrium land rent R0 (s). As for W j (s) and Ri (s)
for i, j = ±1, zero labor supply implies W j (s) = 0 and N j (s) = 0 for j = ±1. Hence, the land
market clearing at the periphery becomes
                                                  W0
                                 Hi = 1 = si0               for      i = ±1,
                                                  Ri

which implies Ri (s) = si0 W 0 (s) for i = ±1.

Step 2. We now show that corner equilibria are unstable. Assume that L       0 = 1 (the proof for
L -1  = L  = 1/2 goes along the same lines). Consider an individual  such that, for all
          1
i  {-1, 0, 1},  's match values satisfy zij ( ) = 0 for j = 0, ±1. Clearly,  is indifferent between
working at the center and working at the periphery (in both cases, she enjoys zero utility).
Consider a positive-measure set of individuals whose tastes are close to those of  and whose
utility-maximizing choice is ij = 00. Relocating them (together with  ) from ij = 00 to kl = 01,
we have V01 (, s) > 0 because W 1 (s) > 0. Using (13), there exists a positive-measure subset of
individuals who are strictly better-off working at location 1. As a result, the corner equilibrium
L 0 = 1 is an unstable equilibrium. Q.E.D.




                                                       49
J. Proof of Proposition 10

Step 1. We first show the existence of a unique conditional equilibrium price for a symmetric
commuting s such that sij > 0 for all i, j when  > 1/2.

Since Li > 0 for i = 0, ±1, the first-order conditions for the production sector yields the
equilibrium conditions:

                                                                    1-
                                                              Nj
                                         Wj = Aj                           ,                                                (J.1)
                                                              Lj

                                                                           
                                                                   Lj
                                        Rj = (1 - )Aj                          .                                            (J.2)
                                                                   Nj

Furthermore, we also know that housing market clearing at location i yields:

                                                          n
                                                    
                                          Hi =                  sij Wj .                                                    (J.3)
                                                    Ri
                                                         j =1


Plugging (J.1) and (J.2) into (J.3), and using the land market balance condition Ni + Hi = 1, we
get:

                                                                    n                          1-
                                                          Ni                             Nj
                       Hi = 1 - Ni =                                       sij Aj                   ,
                                     (1 - )Ai             Li                             Lj
                                                                    j =1


                                                     -               n                         1-
                                               Ni                                        Nj
                       (1 - )Ai (1 - Ni )                 =                sij Aj                   ,
                                               Li                                        Lj
                                                                    j =1


                                 -                                 1-                n                   1-
                            Ni                            Ni                                        Nj
              (1 - )Ai               = (1 - )Ai Li                       +                 sij Aj             .
                            Li                            Li                                        Lj
                                                                                    j =1



Since s is symmetric, this system of equations becomes:

                            -                                                      1-                             1-
                       N0                                               N0                               N1
         (1 - )A0                = [(1 - )L0 + s00 ] A0                                 + 2s01 A1
                       L0                                               L0                               L1

                       -                        1-                                                                     1-
                  N1                      N0                                                                  N1
     (1 - )A1               = s10 A0                 + [(1 - )L1 +  (s11 + s1,-1 )] A1
                  L1                      L0                                                                  L1

Dividing one equation by the other and using Ai = Li for i = 0, ±1, we get:



                                                         50
                                                                      n 1-
                                      [(1 - )L0 + s00 ]                          + 2s01
                    n-    +
                               =                                                                 (J.4)
                                               n 1-
                                   s10                + (1 - )L1 +  (s11 + s1,-1 )

Since (J.1) and (J.2) imply

                                                               n      1-
                                   n-      +
                                               = r,        
                                                                              = w,               (J.5)

we have

                                                                       
                                                               L0
                                          w r1- =      
                                                           =              .                      (J.6)
                                                               L1

Likewise, combining (J.4) and (J.5), we get:

                                   [(1 - )L0 + s00 ] w + 2s01
                              r=                                      .                          (J.7)
                                   s10 w + (1 - )L1 +  (s11 + s1,-1 )


A sufficient condition for the system (J.6) ­ (J.7) to have a unique solution (w(s), r(s)) is that the
graph of the relationship (J.7) between w and r intersects the downward-sloping curve given by
(J.6) from below. The RHS of (J.7) is the ratio of two positive linear increasing functions of w.
Since the elasticity of a linear increasing function with a positive intercept never exceeds 1, the
elasticity of the RHS of (J.7) w.r.t. w is always larger than -1. Restating (J.6) as
                                                               
                                               r=     1-   w- 1-

shows that the elasticity of the RHS of this expression w.r.t. w equals -/(1 - ), which is
smaller than -1 when  > 1/2.

Step 2. Denote by W(s), R(s) the equilibrium price vector conditional to an arbitrary
commuting pattern s that belongs to a neighborhood of an interior equilibrium commuting
pattern s , and let w(s) and r(s) be the corresponding wage ratio and the land-price ratio:

                                           W 0 (s)                         R0 (s)
                                   w(s)               and r(s)                    .
                                           W 1 (s)                         R1 (s)


Consider the following two types of relocations: 0j  1j (changing place of residence but not the
workplace) and i0  i1 (changing the workplace but not the place of residence). Observe that, in
equilibrium, for each individual  , we have:

                                         V0j ( )   z0j ( )
                                                 =         (r(s ))- ,                            (J.8)
                                         V1j ( )   z1j ( )

                                           Vi0 ( )   zi0 (  )
                                                   =          w(s ).                             (J.9)
                                           Vi1 ( )   zi1 (  )


                                                      51
If the individual  is indifferent between 0j and 1j for some j = {-1, 0, 1}, switching from 0j to
1j makes this individual strictly worse off if and only if r(s ) decreases when a small subset of
residents (almost indifferent between 0j and 1j ) of measure  is moved from 0 to 1, i.e.,


                                         r(s ) r(s )
                                              -      <0                                      (J.10)
                                         s1j    s0j

because (J.8) and (J.10) imply that V0        
                                      j ( )/V1j ( ) increases above 1.

Likewise, using (J.9) if  is an individual indifferent between i0 and i1 for some i = {-1, 0, 1},
switching from i0 to i1 makes  strictly worse off if and only if w(s ) increases when a small
subset of workers (almost indifferent between i0 and i1) of measure  is moved from 0 to 1, i.e.,


                                        w(s ) w(s )
                                             -      > 0.                                     (J.11)
                                        si1    si0

Step 3. We show that the land-price ratio r(s ) always satisfies the equilibrium condition (J.10).
Under a relocation of residents from 0j to 1j (or, equivalently, from 1j to 0j ) for j = 0, 1, the
numerator in the RHS of (J.7) decreases pointwise, while the denominator increases pointwise.
Therefore, the curve (J.7) shifts downwards in the (w, r)-plane, while the curve (J.6) remains
unchanged. Since (J.7) intersects (J.6) from below, this implies a reduction in r(s). Hence, (J.10)
holds.

Step 4. It remains to check when (J.11) holds. To this end, we study when the relocation of a
-measure subset of workers from i0 to i1 for i = 0, ±1 leads to an increase in the relative wage
w(s). As a result, two cases must be distinguished: (i) a relocation of workers from 00 to 01 and
(ii) a relocation of workers from 10 to 11.

Taking the log-differential of (J.6) yields:


                          d log w + (1 - )d log r =  (d log L0 - d log L1 ).                 (J.12)

Case 1. Assume that


                                ds00 = -,        ds01 = ds0,-1 = /2,


                                          dsij = 0 otherwise.

In this case, (J.12) becomes:


                                                 ds00 ds01                1   1
                 d log w + (1 - ) d log r =          -          = -         +
                                                  L0   L1                2L1 L0

Taking the log-differential of (J.7) yields:

                                                  52
             d [((1 - )L0 + s00 ) w + 2s01 ] d [s10 w + (1 - )L1 +  (s11 + s1,-1 )]
 d log r =                                  -                                       . (J.13)
               [(1 - )L0 + s00 ] w + 2s01      s10 w + (1 - )L1 +  (s11 + s1,-1 )

Since



d [((1 - )L0 + s00 ) w + 2s01 ] = - (1 -  +  ) w +   + ((1 - )L0 + s00 ) wd log w,

while

                                                                         
                d [s10 w + (1 - )L1 +  (s11 + s1,-1 )] = (1 - )            + s10 wd log w,
                                                                         2
(J.13) becomes



                       - (1 -  +  ) w +       1             1-
    d log r =                               -                                     
                  ((1 - )L0 + s00 ) w + 2s01 2 s10 w + (1 - )L1 +  (s11 + s1,-1 )


                  ((1 - )L0 + s00 ) w                s10 w
        +                              -                                   d log w
             ((1 - )L0 + s00 ) w + 2s01 s10 w + (1 - )L1 +  (s11 + s1,-1 )

Plugging this expression into (J.12), we get:



                    1        1                   (1-+ )w-               1           1-
              -    2L1   +   L0   + (1 - )   ((1-)L0 +s00 )w+2s01   +   2 s10 w+(1-)L1 + (s11 +s1,-1 )
 d log w =                                                                                               .
                                          ((1-)L0 +s00 )w                 s10 w
                      + (1 - )        ((1-)L0 +s00 )w+2s01   -   s10 w+(1-)L1 + (s11 +s1,-1 )



When  > 1/2, the denominator in d log w is always positive because each bracketed term of the
denominator is smaller than 1. As a result, the stability condition d log w > 0 holds if the
numerator is positive:

      (1 -  +  ) w -        1             1-                                                    1    1
                          +                                     >                                 +      .
((1 - )L0 + s00 ) w + 2s01 2 s10 w + (1 - )L1 +  (s11 + s1,-1 )   1-                            L0 2L1
                                                                                                    (J.14)

Case 2. We now assume that


                             ds11 = -ds10 = /2,       ds-10 = -ds-1,-1 = -/2,


                                              dsij = 0 otherwise.


                                                      53
Hence, (J.12) becomes:


                                                 ds10 + ds-10 ds11                 1   1
               d log w + (1 - ) d log r =                    -     = -               +
                                                      L0       L1                 2L1 L0

Since


         d [((1 - )L0 + s00 ) w + 2s01 ] = - (1 - ) w + ((1 - )L0 + s00 ) wd log w
and

                                                                         
            d [s10 w + (1 - )L1 +  (s11 + s1,-1 )] =           w + (1 - ) + s10 wd log w,
                                                             2           2
(J.13) becomes



                           - (1 - ) w         1           1 -  + 
      d log r =                             -                                     
                  ((1 - )L0 + s00 ) w + 2s01 2 s10 w + (1 - )L1 +  (s11 + s1,-1 )


                 ((1 - )L0 + s00 ) w                s10 w
        +                             -                                   d log w.
            ((1 - )L0 + s00 ) w + 2s01 s10 w + (1 - )L1 +  (s11 + s1,-1 )

Plugging this expression for d log r into (J.12), we get:



                    1        1                       (1-)w              1          1-+
              -    2L1   +   L0   + (1 - )   ((1-)L0 +s00 )w+2s01   +   2 s10 w+(1-)L1 + (s11 +s1,-1 )
 d log w =                                                                                               .
                                          ((1-)L0 +s00 )w                 s10 w
                      + (1 - )        ((1-)L0 +s00 )w+2s01   -   s10 w+(1-)L1 + (s11 +s1,-1 )



If  > 1/2, the denominator in d log w is always positive. Hence, the stability condition
d log w > 0 becomes:



          (1 - ) w          1           1 -  +                                                  1    1
                          +                                     >                                 +      .
((1 - )L0 + s00 ) w + 2s01 2 s10 w + (1 - )L1 +  (s11 + s1,-1 )   1-                            L0 2L1
                                                                                                    (J.15)

When  > 1/2, the inequalities (J.14) and (J.15) are necessary and sufficient for an interior
equilibrium to be stable.

We now rewrite these two conditions in terms of the variable  only. Using Proposition 1 and the
                         1+
equilibrium relationship   = f (), as well as  = r- ,  = w , and a = /(1 - ), (J.14)
and (J.15) become



                                                     54
                                     1                                      
                                 -
                 f () + 12 (1 + a)
                                    [f ()] 1+                     [f ()] 1+     1
                                              >                             2
                                                                              +          ,       (J.16)
                  ((1 + a) + 2) f () + 2a       1-              2( + 1 +  )  + 2

                             1                 
                         1 -                                                
        (1 + a) f () +   2       - a [f ()] 1+                    [f ()] 1+     1
                                                   >                        2
                                                                              +          ,       (J.17)
                ((1 + a) + 2) f () + 2a              1-         2( + 1 +  )  + 2

Solving the equilibrium condition f () = g (;  ) w.r.t.  yields


                                                  log -b f ()
                                 =                                 .
                                         1 +  log   +2
                                                         [f ()] 1+
                                                       +1+2

Plugging this expression into (J.16) ­ (J.17), we get:


                                                            1           1                          
                                                        -           -
    2(1 - )(1 + )( + 1 + 2 ) f () + 2 
                                      1   + a  
                                             2    [f ()] 1+ log    +2
                                                                  +1+2
                                                                       [f ()] 1+
()                          ·                               ·                                            > 1,
    ((1 + a) + 2) f () + 2a [f ()] 1+ ( + 2) + 2( + 1 + 2 )      log (-b f ())


                                                                    1                                 
                                            1                   -
                                                - a [f ()] 1+ log   +2
    2(1 - )(1 + )( + 1 + 2 ) (1 + a) f () + 2                     +1+2
                                                                         [f ()] 1+
()                          ·                                ·                                             > 1.
    ((1 + a) + 2) f () + 2a [f ()] 1+ ( + 2) + 2( + 1 + 2 )        log (-b f ())


Last, we set:


                                         F()  min {(), ()} ,
which is independent of . Verifying F() > 1 can be done numerically for any vector of
parameters by plotting F() as a function of the variable . Q.E.D.


K. Proof of Proposition 11

Step 1. We first extend the main expressions of Section 3.1 to the case of amenities.

Since the indirect utility is given by (36), the share sij of households choosing the location pair ij :
                                                                        
                                                              
                                               Oi Dj Wj /(ij Ri )
                               sij =                                           ,
                                                                      
                                          rI      sI   Or Ds Ws /(rs Rr )

which can be rewritten as
                                                  -        -
                                         sij = Oi Dj Ri Wj ij ,                                   (K.1)



                                                       55
where
                                                           1
                                                                                   .                (K.2B)
                                                                     
                                        rI     sI     Or Ds Ws /(rs Rr )

The residential population Mi at i now given by
                                                 -                            -
                             Mi          sij = Oi Ri                 (Dj Wj ) ij ,
                                   j I                         j I

while the labor force Lj at j is
                                                                       - -
                             Lj          sij = (Dj Wj )              Oi Ri ij .
                                   iI                          iI


Housing market clearing is still given by (10). Substituting (K.1) in (10) gives
                                                                               1
                                                                             1+
                                                             - 
                               Ri =  Oi               Wj1+ Dj ij                   .                 (K.2)
                                    Hi
                                                j I


The production function at location j is given by
                                                         1-
                                             Yj = Aj Lj Nj  ,

where 0 <  < 1 and Aj is the location-specific TFP:

                                               Aj = Tj Lj,                                           (K.3)

where   0 is the same for all j , while Tj > 0 is location-specific exogenous production amenity
with T-1 = T1 .

If location j hosts a positive share of the production sector, the first-order conditions for the
production sector yields the equilibrium wage and land rent (13) by (14), while their ratio is still
given by (15).

When  = 0, we have:
                                               -                      1                -/(1-)
                                         Nj                                  Wj
                     Rj = (1 - )Tj                 = (1 - )Tj1-                                 .    (K.4)
                                         Lj                                  

Applying the symmetry assumption to the wage and land rent patterns yields (compare to (19)):

                                      s0,0 = O0  R- (D W ) ,
                                                  0    0 0
                               s0,1 = s0,-1 = O0   R- (D W )  - ,
                                                    0    1 1
                                                      -
                                 s1,1 = s-1,-1 = O1 R1 (D1 W1 ) ,
                                                                                                     (K.5)
                              s1,-1 = s-1,1 = O1   R- (D W )  -2 ,
                                                    1    1 1
                               s1,0 = s-1,0 = O1   R- (D W )  - .
                                                    1    0 0



As   w and   r- , the first-order condition (K.4) becomes  =  a .

                                                      56
Step 2. We now determine the conditions that generalize (23)-(26) to the case of amenities.

The equilibrium demand for housing and commercial space and the equilibrium supply of workers
and residents are:
                               o (d + 2)                                1 - M0
                 M0 =                             ,             M1 =           ,              (K.6)
                         o(d + 2) + 2(d + 1 + 2 )                          2
                                   (o + 2)d                                1 - L0
                     L0 =                            ,              L1 =          ,           (K.7)
                            (o + 2)d + 2(o + 1 + 2 )                          2
                                                  1+
                                   ao 1 + 2 d
                                              -    

                     H0 =                    1+
                                                            ,       N0 = 1 - H0 ,             (K.8)
                            ao 1 + 2 d
                                       -          + o + 2
                                       1+
                                a           d + 1 + 2
                 H1 =         1+
                                                                ,       N1 = 1 - H1 .         (K.9)
                        a          d + 1 + 2 + o + (1 + 2 )

Using (K.2B), symmetry and (20), we have
                                                       1
                   =      - 
                                                                                      .   (K.11)
                         O1 R1 (D1 W1 )- (2(1     + 2 ) + 2d + 2o + od)

Using (K.1), (7), symmetry, and (20), we have:
                                           - 
                        M0 = s00 + 2s01 = O1 R1 (D1 W1 )- o(2 + d).


Substituting for  from (K.10), we obtain M0 as a function of  and  . Under symmetry, the
residential pattern satisfies 2M1 + M0 = 1, which gives M1 as a function of  and  .

Using (K.1), (8), symmetry, and (20), we obtain:
                                           - 
                        L0 = s00 + 2s10 = O1 R1 (D1 W1 )- (2 + o)d.

Substituting for  from (K.11), we have L0 as a function of  and  , so that L1 = (1 - L0 )/2 also
depend of  and  .

To evaluate the expressions for residential and commercial land, we use (10):
                                 -       1+      -       1+
                      R0 H0 =  O0 R0 D0 W0  + 2O0 R0 D1 W1  ,

                              -       1+             -       1+
                   R1 H1 =  O1 R1 D0 W0  + (1 + 2 )O1 R1 D1 W1  .

Substituting from (K.11) and using (20) leads to
                                                                1
                                    W0      od + 2o - 
                            H0 =                                ,
                                    R0 od + 2o + 2d + 2(1 + 2 )
                                                  1+
                                    W1       d + (1 + 2 )
                            H1 =                                .
                                    R1 od + 2o + 2d + 2(1 + 2 )

                                                  57
Using (15) and (9), we get
                                                                 1
                                    N0      od + 2o - 
                         1 - N0 = a                             ,
                                    L0 od + 2o + 2d + 2(1 + 2 )
                                                   1+
                                    N1       d + (1 + 2 )
                         1 - N1 = a                             .
                                    L1 od + 2o + 2d + 2(1 + 2 )

Solving for N0 and N1 yields:

                                                                 1
                                    1       od + 2o - 
                       1 = N0   1+a                             ,
                                    L0 od + 2o + 2d + 2(1 + 2 )
                                                     1+
                                    1        d + (1 + 2 )
                       1 = N1   1+a                             .
                                    L1 od + 2o + 2d + 2(1 + 2 )

Using the expressions L0 and L1 from (K.7), we arrive at the commercial land use pattern:

                                                o + 2
                                N0 =                             1+   ,
                                       (1 + a)o + 2 + 2a o
                                                         d 
                                                            -     


                                              o + 1 + 2
                              N1 =            1+                          .
                                     o + a         d + (1 + a)(1 + 2 )
Substituting these expressions into the land market clearing conditions, Hi + Ni = 1, we find the
housing pattern (K.8) and (K.9).

Last, observe that the conditions (K.6)-(K.9) boil down to (23)-(26) when o = d = 1. This proves
Proposition 1.

Step 3. Finally, we prove Proposition 11.

The land rent equilibrium condition (K.3) at i = 0, 1 leads to
                                                                        1
                                                                      1+
                             R0 =   O D W 1+ + 2D1
                                                    1+
                                                   W1                         ,             (K.12)
                                  H0 0 0 0
                                                                                1
                                    1+               1+
                                                                              1+
                       R1 =   O D0 W0  + (1 + 2 )D1
                                                  
                                                    W1                              .       (K.13)
                            H1 1

Multiplying by Rj both sides of the land market balance condition (9), we get:

                                                        1-
                             R0 H0 + R0 N0 = R0 H0 +       W0 L0 = R0 ,                     (K.14)
                                                         
                                                        1-
                             R1 H1 + R1 N1 = R1 H1 +       W1 L1 = R1 .                     (K.15)
                                                         



                                                58
Dividing (K.14) over (K.15), we obtain:
                                                               1-
                                              R0   R0 H0 +       W0 L0
                                      r=         =             1-      .                   (K.16)
                                              R1   R1 H1 +       W1 L1

It then follows from (K.12) ­ (K.13) that

                                        1+ -        1+ -
                         R0 H0 = O0 D0 W0 R0 + 2D1 W1 R0 ,                                 (K.17)

                                     1+ -               1+ -
                      R1 H1 = O1 D0 W0 R1 + (1 + 2 )D1
                                                     
                                                       W1 R1 .                             (K.18)

Using (K.16), the labor market balance conditions at i = 0, 1 are given by
                                                   -        -
                         L0 = s00 + 2s10 = D0 W0 O0 R0 + 2O1 R1 ,

                                                            -       -
                    L1 = s11 + s01 + s-11 = D1 W1 (1 + 2 )O1 R1 + O0 R0 ,
so that
                                   -       1+      -       1+
                        W0 L0 =  O0 R0 D0 W0  + 2O1 R1 D0 W0  ,                            (K.19)

                                         -       1+     -       1+
                      W1 L1 =  (1 + 2 )O1 R1 D1 W1  + O0 R0 D1 W1  .                       (K.20)

Plugging into (K.16) the expressions for Rj Hj (j = 0, 1) given by (K.17)-(K.18) and the
expressions for Wj Lj ( j = 0, 1) given by (K.19)-(K.20), we get after simplifications:


                               (1 + a)or- w1+ d + 2aor- + 2w1+ d
                          r=                                     .                         (K.21)
                                  aw1+ d + or- + (1 + a)(1 + 2 )

Combining (K.4) with (13)-(14), we get:
                                          n   1-                           n   -
                                                                       
                           w=t                           and     r=t                  ,    (K.22)

where t  T0 /T1 . Dividing (K.19) by (K.20) yields:

                                                   or- + 2
                                          =                     w d.                       (K.23)
                                                 or- + (1 + 2 )

Using (K.22) and (K.23), we get:
                                                                                  
                              1-                         or- + 2
                           w r        =t         =t                   w d             ,
                                                       or- + (1 + 2 )
or, equivalently,
                                                                               
                                      1
                                          - 1-          or- + 2                
                             w=t r                                   w d          .        (K.24)
                                                      or- + (1 + 2 )

Since  > 0, the conditions (K.21) and (K.24) can be reformulated in terms of (,  ):

                                                         59
                                                  1+                   1+         -
                                (1 + a)o               d + 2ao + 2            d
                         =              1+                                                ,   (K.25)
                                    a        d + o + (1 + a)(1 + 2 )
and                                                                        
                                             1      o + 2                  
                                =t           a                  d             .               (K.26)
                                                   o + (1 + 2 )
                                 1+
Solving (K.25) and (K.26) for         yields the functions (38) and (39).

Finally, o = d = 1 in (K.25) and (K.26) yields:
                                                  1+                  1+          -
                                    (1 + a)             + 2a + 2       
                           =                      1+                                  ,       (K.27)
                                     + a                + (1 + 2 )(1 + a)

and                                                                 
                                              1      + 2            
                                      =       a                        .                      (K.28)
                                                     + 1 + 2
                               1+
Solving (K.27) ­ (K.28) for         yields the functions (27) and (28). This proves proposition 2.
Q.E.D.




                                                        60
