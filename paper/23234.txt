                               NBER WORKING PAPER SERIES




                       THE EMERGENCE OF MARKET STRUCTURE

                                        Maryam Farboodi
                                         Gregor Jarosch
                                         Robert Shimer

                                       Working Paper 23234
                               http://www.nber.org/papers/w23234


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                    March 2017




This paper was previously circulated under the title “Meeting Technologies in Decentralized
Asset Markets”. We are grateful to Fernando Alvarez, Markus Brunnermeier, Xavier Gabaix,
Ricardo Lagos, Pierre-Olivier Weill, Randall Wright, and audiences at various seminars and
conferences for their thoughts and comments. The views expressed herein are those of the authors
and do not necessarily reflect the views of the National Bureau of Economic Research.

At least one co-author has disclosed a financial relationship of potential relevance for this
research. Further information is available online at http://www.nber.org/papers/w23234.ack

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2017 by Maryam Farboodi, Gregor Jarosch, and Robert Shimer. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.
The Emergence of Market Structure
Maryam Farboodi, Gregor Jarosch, and Robert Shimer
NBER Working Paper No. 23234
March 2017
JEL No. E44,G12,G20

                                           ABSTRACT

What market structure emerges when market participants can choose the rate at which they
contact others? We show that traders who choose a higher contact rate emerge as intermediaries,
earning profits by taking asset positions that are misaligned with their preferences. Some of them,
middlemen, are in constant contact with other traders and so pass on their position immediately.
As search costs vanish, traders still make dispersed investments and trade occurs in
intermediation chains, so the economy does not converge to a centralized market. When search
costs are a differentiable function of the contact rate, the endogenous distribution of contact rates
has no mass points. When the function is weakly convex, faster traders are misaligned more
frequently than slower traders. When the function is linear, the contact rate distribution has a
Pareto tail with parameter 2 and middlemen emerge endogenously. These features arise not only
in the (inefficient) equilibrium allocation, but also in the optimal allocation. Moreover, we show
that intermediation is key to the emergence of the rest of the properties of this market structure.


Maryam Farboodi                                   Robert Shimer
26 Prospect Ave                                   Department of Economics
Bendheim Center for Finance                       University of Chicago
Princeton University                              1126 East 59th Street
Princeton, NJ 08540                               Chicago, IL 60637
farboodi@princeton.edu                            and NBER
                                                  shimer@uchicago.edu
Gregor Jarosch
Department of Economics
Stanford University
579 Serra Mall
Palo Alto, CA 94305
and NBER
gregorjarosch@gmail.com
1       Introduction
This paper examines an over-the-counter market for assets where traders periodically meet
in pairs with the opportunity to trade (Rubinstein and Wolinsky, 1987). We are interested in
understanding the origins and implications of the observed heterogeneity in these markets,
whereby we mean that some individuals trade much more frequently and with many more
partners than others do. In particular, real world trading networks appear to have a core-
periphery structure. Traders at the core of the network act as financial intermediaries,
earning profits by taking either side of a trade, while traders in the periphery trade less
frequently and their trades are more geared towards obtaining an asset position aligned with
their portfolio needs.
    We consider a model economy with a unit measure of traders each of whom seeks to
trade a single asset for an outside good (money). Following Duffie, Gârleanu and Pedersen
(2005) and a large subsequent literature, we assume traders have an intrinsic reason for trade,
differences in the flow utility they receive from holding the asset. Moreover, this idiosyncratic
valuation changes over time, creating a motive for continual trading and retrading. We add
to this a second source of heterogeneity, namely in contact rates. We allow for traders to
differ in terms of the frequency at which they meet others. In addition, we assume that the
likelihood of contacting any particular trader is proportional to her contact rate.
    Under these assumptions, we show that intermediation arises naturally. When two traders
who have the same flow valuation for the asset meet, the trader who has a higher contact
rate acts as an intermediary, leaving the meeting with holdings that are further from the
intrinsically desired one. This occurs in equilibrium because traders with a faster contact rate
expect to have more future trading opportunities and so place less weight on their current
flow payoff. Intermediation thus moves misaligned asset holdings towards traders with higher
contact rates, which improves future trading opportunities. Thus the equilibrium displays
a core-periphery structure where the identity of the market participants at the core—fast
traders—remains stable over time.1
    The full model recognizes that traders’ contact rates are endogenous. We consider an
initial, irreversible investment in this meeting technology. For example, traders may invest
    1
    Recent empirical work documents that bilateral asset markets frequently exhibit a core-periphery network
structure where few central institutions account for most of the turnover while the majority of market
participants remains at the fringe. For the federal funds market, see Bech and Atalay (2010), Allen and
Saunders (1986), and Afonso, Kovner and Schoar (2013). For evidence on international interbank lending, see
Boss, Elsinger, Summer and Thurner (2004), Chang, Lima, Guerra and Tabak (2008), Craig and Von Peter
(2014), and in ’t Veld and van Lelyveld (2014). For credit default swaps Peltonen, Scheicher and Vuillemey
(2014) and Siriwardane (2015), for the corporate bond market Di Maggio, Kermani and Song (2015), for the
municipal bond market Li and Schürhoff (2014), and for asset-backed securities Hollifield, Neklyudov and
Spatt (2014).


                                                     1
in having faster communication technologies, better visibility through location choices or
advertisement, or relationships with more counterparties. While we assume throughout that
traders are ex ante identical, we recognize that they may choose different contact rates, as
in a mixed strategy equilibrium. A higher contact rate gives more trading opportunities but
we assume it also incurs a higher sunk cost.
    We prove that if the cost is a differentiable function of the contact rate, then any equi-
librium allocation must have a continuous distribution of contact rates. The force pushing
towards heterogeneity is the gains from intermediation. If everyone else chooses the same
contact rate, a trader who chooses a slightly faster contact rate acts as an intermediary for
everyone else, repeatedly buying and selling irrespective of her intrinsic valuation; while a
trader who chooses a slightly slower contact rate never trades once her asset position is alig-
ned with her preferences. The marginal returns to additional meetings thus jump discretely
at any mass point, inconsistent with equilibrium under a differentiable cost function. In
addition, we show that if the cost function is weakly convex, the equilibrium rate of misalig-
nment is strictly increasing in the contact rate. That is, a higher contact rate comes with an
inferior asset position (relative to fundamentals) and derives its benefits from trading profits.
In turn, traders on the fringe of the trading network have well-aligned asset positions but
pay for the intermediation services provided by the core through bid-ask spreads.
    We then turn to the natural assumption that the cost is proportional to the contact rate.
We prove that the equilibrium distribution of contact rates has a positive lower bound and
is unbounded above, with many traders choosing a high contact rate: First, the right tail of
the contact rate distribution is Pareto with tail parameter 2, so the variance in contact rates
is infinite. To the best of our knowledge, we are the first to show that a power law is an
equilibrium outcome when homogeneous individuals choose their search technology under
linear cost. This result carries over to the distribution of trading frequencies and connects
our theory tightly with empirical evidence on frictional asset markets.2 Second, we show that
a zero measure of traders chooses an infinite contact rate, giving them continuous contact
with the market. These “middlemen” account for a positive fraction of all meetings, earning
zero profits in each meeting but making it up on volume. We stress that ex ante there
is no difference between middlemen (the core of the network) and the periphery; however,
they choose to make different investments and so ultimately play a very different role in the
   2
    There is ample empirical evidence on concentration of trade among very few financial institutions. The
largest sixteen derivatives dealers intermediate more than 80 percent of the global total notional amount of
outstanding derivatives (Mengle, 2010; Heller and Vause, 2012). Bech and Atalay (2010) document that the
distribution of trading frequencies in the federal funds markets is well-approximated by a power law, while
Peltonen, Scheicher and Vuillemey (2014) find that the degree distribution of the aggregate credit default
swap network can be scale-free. For additional financial market variables that are—at least in the tail—well
approximated by power laws, see Gabaix, Gopikrishnan, Plerou and Stanley (2006).


                                                     2
market.
    We then demonstrate that these forces remain important even in an environment where
the cost per contact goes to zero, so search frictions vanish. In this frictionless limit, 27
percent of contacts are with middlemen. Moreover, middlemen account for 41 percent of
trading volume and intermediation chains are long: whenever a trader experiences a prefe-
rence shock, it gives rise to a sequence of trades that end only when two middlemen swap
the asset. As a consequence, trading volume far exceeds the minimal amount of reallocation
needed to offset preference shocks.
    We complement these findings with some numerical results. First, we show that both
the distribution of contact rates as well the distribution of trading frequencies are globally
well-approximated by a Pareto distribution with tail parameter 2. Second, we develop a
numerical proof that the equilibrium exists and is unique.
    We then consider optimal trading patterns and investments. We prove that the equili-
brium trading pattern—passing misalignment to traders with higher contact rates—is opti-
mal. We also show that all the qualitative features of the equilibrium allocation carry over
to the optimum: If costs are a differentiable function of the contact rate, there is optimally
no mass points in the distribution of contact rates. If the cost function is weakly convex, fas-
ter traders optimally have asset positions that are increasingly detached from their intrinsic
preferences. If costs are proportional to contact rates, the optimal contact rate distribution
has a Pareto tail with parameter 2 and a zero measure of middlemen account for a positive
fraction of all meetings. As costs converge to zero, middlemen optimally account for 37
percent of the meetings and 45 percent of trading volume, so trading volume still far exceeds
the minimal amount of reallocation needed to offset preference shocks.
    The equilibrium is inefficient due to search externalities. Pigouvian taxes highlight the
inefficiencies: traders only capture half the surplus in each meeting, leading to underinvest-
ment in contacts; but they do not internalize a business stealing effect, which induces them
to overinvest in contacts. We numerically contrast the equilibrium with the optimum and
find systematic overinvestment: The equilibrium has too few slow types and too much inter-
mediation The Pigouvian transfer offsets this by altering equilibrium prices in favor of the
buyers of intermediation services, namely slower traders.
    Finally, we emphasize the connection between intermediation and dispersion in contact
rates. We consider an economy in which traders with the same desired asset holdings never
meet, which eliminates the possibility of intermediation in our model economy. Under these
conditions, we show that if the cost is a weakly convex function of the contact rate, all
traders choose the same contact rate, both in equilibrium and optimally. Thus dispersion in
contact rates and intermediation are intimately connected: if there is dispersion in contact


                                               3
rates, faster traders act as intermediaries; and if intermediation is permitted, contact rates
are naturally disperse.

Related Work This paper is closely related to a growing body of work on trade and
intermediation in markets with search frictions. Rubinstein and Wolinsky (1987) were the
first to model middlemen in a frictional goods market. We share with them the notion
that intermediaries have access to a superior search technology.3 In two important papers
Duffie, Gârleanu and Pedersen (2005, 2007) study an over-the-counter asset market where
time-varying taste leads to trade. This is also the fundamental force giving rise to gains
from trade in our setup. Much of the more recent theoretical work extends their basic
framework to accommodate newly available empirical evidence on trade and intermediation
in over-the-counter markets.
    The decentralized interdealer market in Neklyudov (2014) features dealers with hetero-
geneous contact rates. The same dimension of heterogeneity is present in Üslü (2016) who
also allows for heterogeneity in pricing and inventory holdings.4 As in our framework, fast
dealers in these setups are more willing to take on misaligned asset positions, thus endo-
genously emerging as intermediaries. The marketplace features intermediation chains and
a core-periphery trading network with fast traders at the core. We add to this literature
by first showing that heterogeneity in meeting technologies arises naturally to leverage the
gains from intermediation even with ex-ante homogeneous agents, and second by showing
how the endogenous choice of contact rates disciplines key features of the contact rate dis-
tribution. Additionally, our normative analysis shows that both technological heterogeneity
and intermediation by those with a high contact rate are socially desirable.
    Hugonnier, Lester and Weill (2016) model a market with a continuum of flow valuations
which gives rise to intermediation chains; market participants with extreme flow value con-
stitute the periphery and those with moderate flow value constitute the core. Afonso and
Lagos (2015) similarly has endogenous intermediation because banks with heterogeneous as-
set positions buy and sell depending on their counterparties’ reserve holdings. In contrast to
these setups, ours offers a theory where the identity of the individuals at the center of the
intermediation chain remains stable over time, a key empirical feature of many decentralized
asset markets (see, for instance, Bech and Atalay (2010) for the federal funds market.)
    The identity of the institutions at the core is also stable in Chang and Zhang (2016),
where agents differ in terms of the volatility of their taste for an asset and those with less
   3
     Nosal, Wong and Wright (2016) extend Rubinstein and Wolinsky (1987) to allow for heterogeneous
bargaining power and storage cost but assume homogeneous contact rates.
   4
     A related literature studies the positive and normative consequences of high-speed trading in centralized
financial markets; see, for instance, Pagnotta and Philippon (2015).


                                                      4
volatile valuation act as intermediaries. The same is true in our framework but heterogeneity
in the volatility of an agent’s taste arises endogenously since a higher contact rate buffers
the impact of the flow value on the net valuation of asset ownership.
    Farboodi, Jarosch and Menzio (2016) model an environment where some have superior
bargaining power and emerge as middlemen due to dynamic rent extraction motives which
are, at best, neutral for welfare. In contrast, intermediation in our setup improves upon the
allocation since misaligned asset positions are traded toward those who are more efficient at
offsetting them. They also study an initial investment stage that determines the distribution
of bargaining power in the population, but restrict the distribution to two points. We allow
for a continuous distribution of contact rates and prove that this is consistent with both
equilibrium and optimum.
    Furthermore, some of the theoretical work on intermediation in over-the-counter markets
features exogenously given middlemen who facilitate trade and have access to a frictionless
interdealer market (Duffie, Gârleanu and Pedersen, 2005; Weill, 2008; Lagos and Rocheteau,
2009). We show that such middlemen who are in continuous contact with the market are a
natural equilibrium outcome when homogeneous agents invest into a search technology.
    Other recent work studies the structure of financial markets using explicit network forma-
tion models, which also generate core-periphery network structures (Farboodi, 2015; Wang,
2017) or star networks (Babus and Hu, 2015). In this class of models, agents (traders, banks)
form explicit links, over which trade can be executed, at either an explicit cost—the cost
of maintaining a relationship as in Babus and Hu (2015) and Wang (2017)—or an implicit
cost—the counterparty risk in Farboodi (2015). The cost of acquiring a contact rate in our
random search setup is closely related to the price of links in this network formation literature
following Jackson (2010). In this body of work, multiplicity arises frequently whereas our
equilibrium is unique, at least in the case of a linear cost function. In addition, the network
models tend to generate a somewhat extreme core-periphery structure, where traders take
on one of two roles, the core or the periphery; and traders in the periphery only trade with
those in the core. Our model predicts a continuous distribution of trading frequencies and
predicts that trades occur both within the periphery and within the core, as well as between
core and periphery.
    In summary, while the theoretical literature on frictional asset markets has offered a
variety of economic mechanisms that give rise to empirically observed intermediation chains
and core-periphery trading structures,our analysis offers novel insights along four distinct
dimensions: (i) time-invariant heterogeneity arises endogenously to leverage the gains from
trade; (ii) middlemen with continuous market contact arise endogenously; (iii) the tail of the
endogenous distribution of contact and trading rates is Pareto and our theory hence connects


                                               5
with the empirical regularities in a very tight way; (iv) our normative analysis shows that
both intermediation and heterogeneity in the search technology are closely interrelated and
socially desirable.
    Finally, the finding that both the equilibrium and optimal allocations have a Pareto
tail relates the paper to a large literature in economics that explores theoretical mecha-
nisms which give rise to endogenous power law distributions (Gabaix, 1999; Eeckhout, 2004;
Geerolf, 2016). Many other economically important regularities, such as the distributi-
ons of city and firm size and the distributions of income and wealth, are empirically well-
approximated by power laws. To the best of our knowledge, the mechanism giving rise to
the Pareto tail in our environment is novel and unrelated to the ones that are established in
the literature (see Gabaix, 2009, 2016, for an overview).

Outline The rest of the paper is organized as follows: Section 2 lays out the model. Section
3 defines and characterizes the equilibrium. Section 4 discusses the socially optimal allocation
and how it can be decentralized. Section 5 considers an economy where intermediation is
prohibited. Section 6 concludes.


2     Model
We study a marketplace where time is continuous and extends forever. A unit measure of
traders have preferences defined over their holdings of an indivisible asset and their consump-
tion or production of an outside good. Traders have rate of time preference r. The supply of
the asset is fixed at 21 and individual traders’ holdings are restricted to be m ∈ {0, 1}, so at
any point in time half the traders hold the asset and half do not. Traders have time-varying
taste i ∈ {h, l} for the asset and receive flow utility δi,m when they are in state (i, m). We
assume that ∆ ≡ 21 δh,1 +δl,0 −δh,0 −δl,1 ) > 0, which implies that traders in the high state are
the natural asset owners. Preferences over net consumption of the outside good are linear,
so that good effectively serves as transferable utility when trading the asset.
    Traders’ taste switches between l and h independently at an identical rate γ > 0. This
implies that at any point in time in a stationary distribution, half the traders are in state h
and half are in state l. Thus, in a frictionless environment, the supply of assets is exactly
enough to satiate the traders in state h. Search frictions prevent this from happening.
Instead a typical trader meets another one according to a Poisson process with arrival rate
λ ≥ 0. Trade may occur only at those moments. We assume that traders irrevocably commit
to a time-invariant contact rate λ ∈ [0, ∞] at time 0. A high contact rate is costly: a trader
who chooses a contact rate λ pays a cost c(λ) > 0 per meeting.


                                               6
    We allow for the possibility that different traders choose different contact rates. Let
G(λ) denote the cumulative distribution function of contact rates in the population and let
Λ denote the average contact rate. Importantly, we allow for the presence of a zero measure
of traders who are middlemen, choosing λ = ∞. Middlemen are in continuous contact with
the market and may account for a positive fraction of all meetings. That is, we require that
     R∞
Λ ≥ 0 λdG(λ) and allow the inequality to be strict, in which case there are middlemen.
    Search is random, so whom the trader meets is independent of her current taste and asset
holding, but is proportional to the other trader’s contact rate. More precisely, conditional
on meeting a counterparty, the counterparty’s contact rate falls into some interval [λ1 , λ2 ]
                  Rλ
with probability λ12 Λλ dG(λ). In addition, the probability of meeting a middleman is 1 −
R∞ λ
 0 Λ
      dG(λ). For any function f : [0, ∞] → R, it will be convenient to define the expected
value of f in a meeting:
                                  ∞                         Z ∞ 0
                                      λ0
                              Z                                        
                      0                      0     0           λ      0
                E(f (λ )) ≡              f (λ )dG(λ ) + 1 −       dG(λ ) f (∞)
                              0       Λ                      0 Λ

This explicitly accounts for the possibility both of meeting a regular trader and of meeting
a middleman. When Λ = 0, so (almost) everyone chooses a zero contact rate, we assume
that a trader who chooses a positive contact rate is equally likely to meet any of the other
traders and let E(f (λ0 )) = f (0), the average value of f in the population.
    When two traders meet, their asset holdings, preferences, and contact rates are observed
by each. If only one trader holds the asset, as will be the case in half of all meetings, the
traders may swap the asset for the outside good. Whether trade occurs and what the terms
of trade are is determined according to the (symmetric) Nash bargaining solution.


3    Equilibrium
Our analysis of equilibrium is broken into nine subsections. We start by characterizing the
value functions and flow of workers between different states. We then turn our focus to a
symmetric equilibria, where a trader’s behavior only depends on her contact rate and whether
her asset holdings are well-aligned with her preferences. We next explain how we make the
distribution of contact rates endogenous and define an equilibrium. The remainder of the
section develops seven propositions which characterize the equilibrium. Proposition 1 focuses
on which trades occur given a contact rate distribution, while Propositions 2–7 characterize
the contact rate distribution under different restrictions on the cost function c. The last
section characterizes the equilibrium numerically when the cost function is linear.



                                                  7
3.1        Value Functions and Flows
                                                                                0 0    0
In equilibrium, we need to find two objects.5 First, let 1λλ,i,m        ,i ,m
                                                                              denote the probability that
a trader with contact rate λ ∈ [0, ∞] in preference state i ∈ {h, l} with asset holdings
m ∈ {0, 1} trades when she contacts a trader with contact rate λ0 ∈ [0, ∞] in preference
                                                                                0 ,i0 ,m0
state i0 ∈ {l, h} with asset holdings m0 ∈ {0, 1}. Second, let pλλ,i,m                    denote the transfer
of the outside good from {λ, i, m} to {λ0 , i0 , m0 } when such a trade takes place. Feasibility
                λ0 ,i0 ,m0                    λ0 ,i0 ,m0
requires that 1λ,i,m       = 1λ,i,m                      λ,i,m
                              λ0 ,i0 ,m0 and pλ,i,m + pλ0 ,i0 ,m0 ≥ 0, where the latter condition ensures
that there are no outside resources available to the trading pair. The trading probability
and price are determined by Nash bargaining.
    Let vλ,i,m denote the present value of the profits of a trader {λ, i, m}. This is defined
recursively by

                                      
  rvλ,i,m = δi,m + γ vλ,∼i,m − vλ,i,m
                      X X                0 0 0                                    0 ,i0 ,m0 
                                                                                               
                  +λ                 E 1λλ,i,m
                                           ,i ,m
                                                 µλ0 ,i0 ,m0 vλ,i,m0 − vλ,i,m − pλλ,i,m          − λc(λ). (1)
                                i0 ∈{h,l} m0 ∈{0,1}


The left hand side of equation (1) is the flow value of the trader. This comes from four
sources, listed sequentially on the right hand side. First, she receives a flow payoff δi,m
that depends on her preferences and asset holdings. Second, her preferences shift from i
to ∼ i at rate γ, in which case the trader has a capital gain vλ,∼i,m − vλ,i,m . Third, she
meets another trader at rate λ, in which case they may swap asset holdings in return for
a payment. Here µλ0 ,i0 ,m0 denotes the endogenous fraction of traders with contact rate λ0
who are in preference state i0 and have asset holding m0 . If the two agree to trade, with
               0 ,i0 ,m0
probability 1λλ,i,m      , the trader has a capital gain from swapping assets and transferring the
                                       0 ,i0 ,m0
outside good, vλ,i,m0 − vλ,i,m − pλλ,i,m         . Finally, the trader pays a cost c(λ) in each meeting.
   The fraction of type λ traders in different states, µλ,i,m , also depends on the trading
probabilities through balanced inflows and outflows:
                                                         
                                                     
                             λ0 ,i0 ,1−m
               X
  γ + λ                  E 1λ,i,m       µλ0 ,i0 ,1−m  µλ,i,m
              i0 ∈{h,l}
                                                                         X            0 0                
                                                      = γµλ,∼i,m + λ                E 1λλ,i,1−m
                                                                                          ,i ,m
                                                                                                µλ0 ,i0 ,m µλ,i,1−m . (2)
                                                                       i0 ,∈{h,l}


A trader exits the state {λ, i, m} either when she has a preference shock, at rate γ, or when
she meets and succeeds in trading with another trader with the opposite asset holding. A
   5
       We focus throughout on steady states.


                                                              8
trader enters this state when she is in the opposite preference state and has a preference
shock or she is in the opposite asset holding state and trades.
      Nash bargaining imposes that trade occurs whenever it makes both parties better off, and
that that trading prices equate the gains from trade without throwing away any resources.
                                           λ0 ,i0 ,m0                                                 λ0 ,i0 ,m0
That is, if there are prices pλ,i,m                   + pλ,i,m
                                                         λ0 ,i0 ,m0 = 0 such that vλ,i,m0 − vλ,i,m ≥ pλ,i,m        and
                               λ,i,m                                                                      λ0 ,i0 ,m0
vλ0 ,i0 ,m − vλ0 ,i0 ,m0 ≥ pλ0 ,i0 ,m0 , trade occurs at a prices such that vλ,i,m0 − vλ,i,m − pλ,i,m =
vλ0 ,i0 ,m − vλ0 ,i0 ,m0 − pλ,i,m
                            λ0 ,i0 ,m0 . Otherwise there is no trade. It follows immediately that

                                            
                            0 0    0
                                            1
                          λ ,i ,m
                         1λ,i,m   =              if vλ,i,m0 + vλ0 ,i0 ,m ≷ vλ,i,m + vλ0 ,i0 ,m0 ;                 (3)
                                            0

and that the trading prices satisfy

                                  0 0
                              λ ,i ,m   0    1
                             pλ,i,m   =        (vλ,i,m0 + vλ0 ,i0 ,m0 − vλ,i,m − vλ0 ,i0 ,m )
                                             2

Of course, if m = m0 , there is no possibility for gains from trade. In the remainder of our
analysis, we ignore such meetings.


3.2      Symmetry
We call traders’ asset holding positions misaligned both when they hold the asset and are
in preference state l and when they do not hold the asset and are in preference state h. We
call traders’ asset holding positions well-aligned both when they hold the asset and are in
preference state h and when they do not hold the asset and are in preference state l. We
focus on allocations in which the two misaligned states and the two well-aligned states are
                                                                     0 ,i0 ,m0      0 ,∼i0 ,1−m0
treated symmetrically. That is, we look only at equilibria where 1λλ,i,m       = 1λλ,∼i,1−m      .6 That
such trading patterns may be consistent with equilibrium is a consequence of our symmetric
market structure, where half the traders are in each preference state and half of the traders
hold the asset.
    In a symmetric equilibrium, equation (2) implies µλ,i,m = µλ,∼i,1−m for all {λ, i, m}. That
is, the fraction of traders with contact rate λ in the high state, i = h, who hold the asset,
m = 1, is equal to the fraction of traders with the same contact rate who are in the low
state, i = l, and do not hold the asset m = 0. That is, the fraction of type-λ traders in either
well-aligned state are symmetric. The remaining traders are misaligned, and again there are
   To be specific, this implies the following requirement: If a type λ trader sells the asset to a type λ0 trader
   6

when both are in state h then it must be that they trade in the opposite direction when both are in state l.




                                                             9
equal shares of the two misaligned states for each λ.7
   It is mathematically convenient to refer to traders only by their alignment status, where
                                                                        0 0
a = 0 indicates misaligned and a = 1 indicates well-aligned. Let 1λλ,a,a indicate the trading
probability between traders (λ, a) and (λ0 , a0 ) conditional on them having the opposite asset
holdings. Let mλ ≡ µλ,l,1 + µλ,h,0 denote the fraction of traders with contact rate λ who are
misaligned. Equation (2) reduces to
                                      
          λ  λ0 ,0      λ0 ,1
       γ + E 1λ,0 mλ0 + 1λ,0 (1 − mλ0 ) mλ
          2
                                                                     
                                           λ  λ0 ,0    λ0 ,1
                                    = γ + E 1λ,1 mλ0 + 1λ,1 (1 − mλ0 ) (1 − mλ ). (4)
                                           2

The left hand side is the outflow rate from the misaligned states. This occurs either following
a preference shock or a meeting with a trader who has the opposite asset holdings where
trade occurs. The right hand side is the inflow rate, again following the same events.
     Let the average value of a misaligned and well-aligned trader be denoted by vλ,0 ≡
1
  (v
2 λ,l,1
        + vλ,h,0 ) and vλ,1 ≡ 12 (vλ,l,0 + vλ,h,1 ), respectively. Also define sλ ≡ vλ,1 − vλ,0 , the
surplus from being well-aligned rather than misaligned. Knowing the surplus function is
sufficient to tell whether trade occurs. To see this, note that the net value of alignment
when in state h, vλ,h,1 − vλ,h,0 equals the net value of alignment when in state l, vλ,l,0 − vλ,l,1
up to a constant common to all types λ. It then follows from condition (3) that the surplus
function sλ governs the patterns of trade since we have that

                               vλ,h,1 − vλ,h,0 + vλ0 ,l,0 − vλ0 ,l,1 = sλ + sλ0
                                vλ,l,1 − vλ,l,0 + vλ0 ,l,0 − vλ0 ,l,1 = −sλ + sλ0
                              vλ,h,1 − vλ,h,0 + vλ0 ,h,0 − vλ0 ,h,1 = sλ − sλ0
                               vλ,l,1 − vλ,l,0 + vλ0 ,h,0 − vλ0 ,h,1 = −sλ − sλ0 .

Taking advantage of symmetry in the misalignment rates and the Nash bargaining solution,
equation (1) reduces to

                              λ
            rvλ,0 = δ0 + γsλ + E (sλ + sλ0 )+ mλ0 + (sλ − sλ0 )+ (1 − mλ0 ) − λc(λ)
                                                                           
                                                                                                            (5)
                              4
                              λ
        and rvλ,1 = δ1 − γsλ + E (−sλ + sλ0 )+ mλ0 + (−sλ − sλ0 )+ (1 − mλ0 ) − λc(λ),
                                                                              
                                                                                                            (6)
                              4
   7
    We assume that if a positive measure of traders choose to live in autarky, λ = 0, half of them are initially
endowed with the asset and half are not. Thus they do not affect the share of traders with λ > 0 who hold
the asset.



                                                      10
where δ0 ≡ 21 (δl,1 + δh,0 ) and δ1 ≡ 21 (δl,0 + δh,1 ) = ∆ + δ0 . Again, both equations reflect the
sum of four terms. The first is the average flow payoff of a misaligned or well-aligned trader.
The second is the gain or loss from a preference shock that switches the alignment status.
The third is the gain from meetings, reflecting that only half of all meetings are with traders
who hold the opposite asset; and in these events each trader walks away with half of the
joint surplus, if there is any. The +-superscript is shorthand notation for the max{·, 0} and
reflects that meetings result in trade if and only if doing so is bilaterally efficient. The final
term is the search cost.
    Finally, we can simplify equation (4) using the Nash bargaining solution as well, since
trades occur if and only if doing so is bilaterally efficient:
                                                  
         λ                                       
      γ + E Isλ +sλ0 >0 mλ0 + Isλ >sλ0 (1 − mλ0 ) mλ
         2
                                                                               
                                            λ                                  
                                  = γ + E Isλ <sλ0 mλ0 + Isλ +sλ0 <0 (1 − mλ0 ) (1 − mλ ). (7)
                                            2

Here the indicator function I is equal to 1 if the inequality in the subscript holds and is zero
otherwise.


3.3      Endogenizing the Distribution of Contact Rates
At an initial date 0, all traders choose their contact rate λ in order to maximize their value.
If traders are impatient, that means that their choice will depend on their alignment status
at date 0. This would make it necessary to solve for transitional dynamics from this initial
condition. We circumvent this issue by focusing on the no-discounting limit of this economy,
r → 0. The surplus sλ = vλ,1 − vλ,0 is finite in this limit, while the present value of the
gain from switching alignment status, r(vλ,1 − vλ,0 ) converges to zero. It follows that the
trader’s initial asset holdings does not affect their incentive to invest and we may ignore the
transitional dynamics.
    The focus on the no-discounting limit reflects our expectation that the short-run desire to
trade is not an important determinant of the irreversible investment in meeting technologies.
We think of the preference shifts as occurring at a much higher frequency than discounting,
while trading opportunities may occur at a higher frequency still. This implies that the
importance of holding the asset at the correct time, ∆, is likely to be a much more important
determinant of this investment.




                                                11
3.4    Definition of Equilibrium
We define a steady state equilibrium in the limiting economy with r → 0. The definition
relies only on objects that are well-behaved in this limit.

Definition 1 A steady state equilibrium is a distribution of contact rates G(λ), an average
contact rate Λ, an allocation of misalignment mλ , and undiscounted surplus function sλ ,
satisfying the following conditions:

  1. Balanced inflows and outflows into misalignment as given by equation (7);

  2. Consistency of sλ with the value functions (5) and (6),

                 λ 
       ∆ = 2γsλ + E (sλ + sλ0 )+ − (sλ0 − sλ )+ mλ0
                                               
                 4                                                             
                                                     +              +
                                                                      
                                        + (sλ − sλ0 ) − (−sλ − sλ0 ) (1 − mλ0 ) ; (8)


  3. Optimality of the ex-ante investment decision:

      (a) dG(λ) > 0 only if it maximizes

                          λ           +               +         
                δ1 − γsλ + E − sλ + sλ0 mλ0 + − sλ − sλ0 (1 − mλ0 ) − λc(λ);
                          4
                                                    R∞
      (b) Middlemen make finite profits: Λ ≥        0
                                                         λdG(λ) and
                        1                                                        
                             E (−sλ + sλ0 )+ mλ0 + (−sλ − sλ0 )+ (1 − mλ0 ) − c(λ) ≤ 0,
                                                                           
                  lim
                  λ→∞    4

          with complementary slackness.

We have already explained the first two conditions. Condition 3(a) ensures that if tra-
ders choose a contact rate λ, it maximizes their average payoff limr→0 rvλ,1 = limr→0 rvλ,0 .
Condition 3(b) ensures that if there are middlemen, they earn zero profits in each meet-
ing. Middlemen earn profit by taking half the surplus from meetings where they change the
alignment status of their trading partners. If middlemen earned more profit in an average
meeting than the cost of a meeting, being a middleman would be arbitrarily profitable, in-
consistent with equilibrium. If they earned less, there would be no middlemen, which implies
     R∞
Λ = 0 λ0 dG(λ0 ).




                                               12
3.5    Equilibrium Trading Patterns
We now begin our characterization of the equilibrium, starting with trading patterns given
any distribution G(λ).
Proposition 1 In equilibrium, when two traders with opposite asset positions meet they
  1. always trade the asset if both are misaligned;

  2. never trade the asset if both are well-aligned;

  3. trade the asset if one is misaligned and the other is well-aligned and the well-aligned
     trader has the higher contact rate.

The Appendix contains proofs of all our propositions. The proof shows that the surplus
function sλ is non-negative and decreasing. The result then follows immediately.
    The first two parts of the proposition reflect fundamentals. Trade between two misaligned
traders turns both into well-aligned traders, thus creating gains in a direct, static fashion.
Trade between two well-aligned traders turns both misaligned and never happens for the same
static reason. The third part of the proposition reflects option value considerations and is
the key feature of the endogenous trading pattern which arises in this environment, namely
intermediation. It states that a faster trader buys the asset from a slower trader if both are
in preference state l; and she sells the asset to the slower trader if both are in preference state
h. These trades do not immediately increase the number of well-aligned traders, but they
move misalignment towards traders who expect more future trading opportunities. These
trades occur in equilibrium because traders with low contact rates are able to compensate
traders with high contact rates for taking the misaligned positions.
    The possibility of intermediation implies that a trader’s buying and selling decisions
become increasingly detached from her idiosyncratic preferences as her contact rate increases.
In other words, a high contact rate moderates the impact of the idiosyncratic taste component
on a trader’s valuation of the asset. It follows that those who become intermediaries, in
the center of the valuation chain, are traders with frequent meetings. Figure 1 shows the
intermediation chain which follows from Proposition 1. Slow traders are at the periphery
of the trading chain, not trading once their asset position is aligned with their preferences.
In turn, the fast traders constitute the endogenous core of the trading network, buying
and selling largely irrespective of their preference state. In doing so, they take on misaligned
asset positions from types with lower contact rates and are compensated through the bid-ask
spread. This also implies that faster traders not only meet other traders more frequently but
also trade more frequently conditional on a meeting because they take on the misalignment
from traders with lower search efficiency.

                                                13
                                                                                        direction of trade
       (λ1 , l)   (λ2 , l)   (.., l)    (λN , l) (λN , h)     (.., h)   (λ2 , h) (λ1 , h)

Figure 1: Direction of trade across traders with contact rate λ ∈ {λ1 , .., λN } with λ1 < λ2 <
.. < λN and current taste i ∈ {l, h}.

3.6        Distribution of Contact and Misalignment Rates
We next show that a non-degenerate distribution G(λ), that is the coexistence of traders with
different λ, arises in equilibrium even when market participants are ex-ante homogeneous.
To do so, we first solve explicitly for the surplus function, taking advantage of the trading
patterns determined in Proposition 1. We prove in the Appendix that the surplus function
satisfies
                                        ∆         R∞       0
                                                              
                                  sλ =       1 − e− λ φλ0 dλ .                            (9)
                                        2γ
where
                                                     8γ
                                       φλ ≡                                                             (10)
                                           λ 8γ + λ(H(λ) + 2L(λ))

and H(λ) ≡ E(Iλ0 >λ ) denotes the fraction of meetings with a trader who has a higher contact
rate and L(λ) ≡ E(Iλ0 <λ mλ0 ) denotes the fraction of meetings with a misaligned trader who
has a lower contact rate. In addition, part 3(a) of the definition of equilibrium implies that
G(λ) is increasing at λ only if λ maximizes

                                          λ                   
                                δ1 − γsλ + E Iλ0 <λ sλ0 − sλ mλ0 − λc(λ).                                 (11)
                                          4

We use this to prove the following result:

Proposition 2 Assume c(λ) is continuously differentiable. Then the equilibrium distribu-
tion of search efficiency G(λ) has no mass points, except possibly at λ = 0.

This proposition implies that although all traders are ex-ante identical, there is no symmetric
equilibrium in which all traders choose identical actions. Even stronger, almost all traders
choose different types.8 The proof shows that gross flow profits have a convex kink at any
mass point. Given a differentiable cost function we hence conclude that mass points are
inconsistent with optimality of the ex-ante investment decision.
   8
    The one caveat is that a positive fraction of traders may choose to live in autarky, setting λ = 0. If this
is optimal, all traders must get the same payoff, and so the value of participating in this market must be
zero. This is the case when the cost function c is too high.


                                                       14
    To develop an understanding for the result consider an environment where everyone has
contact rate λ̄. This turns out to create a convex kink in the value function at λ̄. To
understand why, consider the marginal impact of an increase in the contact rate for a trader
with a contact rate λ̄. This allows the trader to act as an intermediary for all the other
traders. Although the gains from intermediation are small, on the order of the difference
between the contact rates, the opportunities to intermediate are frequent, whenever she
meets a misaligned trader with the opposite asset holdings. Thus a higher contact rate
creates a first order gain. Conversely, consider the marginal impact of a decrease in the
contact rate for a trader with contact rate λ̄. This allows all other traders to intermediate
for her, dramatically reducing her misalignment probability. Of course, this doesn’t come
for free; she pays for these trades using the outside good. Nevertheless, the benefits from
the trades are again linear in the difference in contact rates. Thus a lower contact rate also
creates a first order gain. This creates a convex kink in the value function at the mass point
λ̄. This logic carries over to any mass point.9
    A different way to see this is in terms of the number of trades. Setting the same contact
rate as everyone else, trades only occur with both traders are misaligned and holding the
opposite asset position. Choosing a slightly different contact rate allows for gains from a
host of other trades, where one party is misaligned and the other well-aligned. In other
words, the nature and frequency of trades depends starkly on the contact rate compared
with other market participants. One gets intermediated by faster traders and intermediates
slower traders. As soon as a positive measure of traders has the same contact rate, this
discretely changes the marginal returns to λ and is hence inconsistent with equilibrium
under a differentiable cost function.
    The absence of a pure strategy equilibrium is a common feature of search models (Butters,
1977; Burdett and Judd, 1983; Burdett and Mortensen, 1998; Duffie, Dworczak and Zhu,
2016). These papers have in common that if all firms charge the same price (or offer the
same wage), firms that offering a slightly lower price (higher wage) earn discontinuously
higher profits. Our results concern a different object, the contact rate, and we find that the
profit function is continuous but not differentiable. We therefore believe that our finding is
distinct from those in the existing literature.
    Whenever the contact rate distribution has no mass points, we can use the equilibrium
trading pattern to simplify the inflow-outflow equality (7):

                        γ + 12 λ(H(λ) + L(λ)) mλ = γ + 12 λL(λ) (1 − mλ ).
                                                              
                                                                                                          (12)
   9
     Section 5 studies an environment where the only admissible trades are between asset holders in state l and
non-holders in state h. We show that the equilibrium distribution of contact rates then collapses to a single
mass point. It follows that heterogeneity fundamentally arises to leverage the gains from intermediation.


                                                      15
Misaligned traders become well-aligned when they experience a preference shock (rate γ),
meet a faster trader with the opposite asset position (rate 12 λH(λ)), or meet a slower misa-
ligned trader with the opposite asset position (rate 21 λL(λ)). Well-aligned traders become
misaligned following the first or third events.
    Proposition 2 shows that there is dispersion in equilibrium contact rates under a relatively
weak condition. This naturally leads us to ask how much dispersion. If the cost function is
weakly convex, we find that dispersion is not too extreme, in the sense that the support of
the contact rate distribution is convex:

Proposition 3 Assume λc(λ) is weakly convex. Then the equilibrium distribution of search
                                                                           R∞
efficiency G(λ) has a convex support. Moreover, if there are middlemen (Λ > 0 λdG(λ)),
the support of G(λ) is unbounded above.

The proof shows that if there is a “hole” in the support of G(λ), traders’ value function
must be strictly concave on the hole. This is inconsistent with both extreme points of the
hole maximizing the traders’ value. The open tail in the presence of middlemen reflects the
same argument. If there were an upper bound in the support of G, any individual above the
bound would conduct the same types of trades as those at the upper bound. This would
just linearly scale her revenues from trade with a misalignment rate identical to those at the
upper bound. If, given the weakly convex cost function, no individual finds it optimal to do
so, then it cannot be optimal to acquire an infinite contact rate either.
    Proposition 3 rules out the possibility that most traders choose a low contact rate, while
a few traders choose a very high contact rate acting as intermediaries. This would be the case
in a star network. This is a consequence of the complementarity in the matching technology.
If a trader chooses a very low contact rate, she only meets intermediaries infrequently, and
so cannot take advantage of their intermediation services.
    We next turn to the connection between contact rates and misalignment rates. A higher
contact rate has two opposing effects on an individual’s misalignment rate. First, an indivi-
dual is more frequently able to offset a misaligned position. However, a trader with a higher
contact rate also intermediates more frequently, taking on misalignment from slower traders.
Proposition 4 states that the latter force dominates everywhere on the support of G(λ) if
the cost function is weakly convex:

Proposition 4 Assume λc(λ) is weakly convex and continuously differentiable. Then the
equilibrium misalignment rate mλ is strictly increasing on the support of G(λ).

We stress that Proposition 4 imposes that G(λ) is the equilibrium contact rate distribution.



                                              16
The result is not true for an arbitrary distribution of contact rates.10 A faster contact rate
deteriorates a trader’s allocation, because she is more likely to serve as an intermediary. The
reason some traders invest in a faster contact rate then must come from trading profits, the
returns to frequently buying and selling the asset with a favorable bid-ask spread.
   A corollary of Proposition 4 considers an extension to our model where traders differ ex
ante in how much they care about having a well-aligned asset position, ∆. Proposition 4
suggests that faster traders at the core of the network will naturally be those with smaller
∆, while slower traders at the periphery will be those with larger ∆. This is the opposite of
what one would expect to see without intermediation.
   Finally, we point to a related observation: The proof of Proposition 6 below shows that
the trading probability conditional on a meeting is strictly increasing in λ. This is likewise
a consequence of the fact that faster traders trade with slower traders whenever the slower
trader is misaligned. When the slowest trader in the economy is well aligned, she never
trades, but the fastest trader trades regardless of her alignment status.


3.7     Linear Cost Function: Analytical Results
In this section, we restrict the cost function to be linear, so the cost per meeting is constant,
c(λ) = c. We start by showing how to express the equilibrium conditions in a pair of
equations. Let λ denote the lowest contact rate in the support of G. Then following the
arguments in the proof of Proposition 4, we can reduce the model to a pair of first order
ordinary differential equations in H and L:

                        4γ(2H(λ) + λH 0 (λ)) = λ2 H(λ)L0 (λ) − L(λ)H 0 (λ) ,
                                                                          
                                                                                                          (13a)
                        4γ + λ(H(λ) + 2L(λ)) L0 (λ) = −(2γ + λL(λ))H 0 (λ),
                                              
                                                                                                          (13b)

with H(λ) = 1 and L(λ) = 0. The first equation represents the optimality condition that
all traders earn the same profit in equilibrium, derived in the appendix (equation 32 with
c(λ) = c), while the second represents the steady state misalignment rate condition (equa-
tion 12). In this section, we manipulate these equations to partially characterize the equili-
brium analytically. Our main result is the following:
Proposition 5 Assume c(λ) = c. If c < ∆/16γ, the equilibrium distribution of contact rates
G(λ) has a strictly positive lower bound λ, has a Pareto tail with tail parameter 2, and has a
  10
    To see this, consider a distribution with a “hole” in the support. m(λ) would be strictly decreasing over
such an interval with a zero measure of traders for two reasons. First, the types of trades an individual
would engage in would be identical anywhere on the interval. Second, all individuals, except possibly the
fastest, trade more frequently into alignment then out of it, that is m(λ) < 21 . It follows that just scaling up
the contact rate without altering the types of trade reduces the misalignment rate.


                                                       17
zero measure of middlemen who are in continuous contact with the market, accounting for a
                                           R∞
strictly positive fraction of meetings, Λ > 0 λdG(λ). If c ≥ ∆/16γ, Λ = 0 in equilibrium.

If meetings are too costly the market place collapses into autarky. In turn, if there is trade
then the equilibrium G(λ) has rich features which we describe in turn.
    The strictly positive lower bound λ reflects that the value of a trader smoothly converges
towards its autarky level as λ → 0. If the cost are strictly below the minimum level which
leads to autarky traders, fare strictly better than under autarky, which allows us to rule out
contact rates close to zero.
    To develop an understanding for the Pareto tail, note that we have already established
that the distribution has no mass points and an open right tail in the presence of middlemen.
It thus follows that gross flow values (ignoring the linear cost cλ) must be linear above the
lowest contact rate λ. A Pareto distribution with tail parameter 2 implies that increasing
a trader’s contact rate leaves the frequency at which she meets a faster trading partner
unchanged. That is, the reduction in the fraction of individuals who are faster is exactly
offset by the increase in the contact rate. Furthermore, the relative contact rate conditional
on meeting a faster individual is also independent of λ. On the other hand, increasing λ
linearly scales the frequency at which she meets a slower trader; while the partner’s expected
contact rate converges to a constant, namely just the average contact rate among the finitely
fast traders (once λ is in the tail). Finally, increasing λ linearly increases meetings with a
middleman. Thus, the Pareto tail parameter 2 guarantees that as λ increases in the tail, it
linearly increases the rate of contacting slower traders and middlemen while leaving trading
opportunities with faster traders unchanged; jointly, these features deliver linear gross flow
values in the tail. The endogenous Pareto tail seems unrelated to well-known mechanisms
that give rise to Pareto distributions in various contexts (Gabaix, 2016).
    To understand the emergence of middlemen, we first note that an individual trader’s
value can be decomposed into pure trading profits and the returns from having a well-
aligned asset position. Furthermore, as λ becomes increasingly large, the types of trades
a trader conducts become increasingly independent of λ, since in most trades she acts as
an intermediary. This first implies that the misalignment rate converges to a constant, and
second that the total trading profits are linear in λ. It follows that, for fast traders with
different contact rates to be equally well off, the net trading profits have to converge to zero
as λ grows large. From this observation it also follows that whenever traders in equilibrium
are better off than under autarky it has to be that the misalignment rate of fast types falls
strictly below its autarky value of 12 . This is what middlemen guarantee since they allow
even very fast types to offload misaligned asset positions.In summary, an open right tail
requires net trading profits to converge to zero; middlemen then allow fast intermediaries to

                                              18
offload misalignment, restoring the incentives for intermediation.
    A large body of empirical work documents that the degree distribution of various financial
markets is often well described by a power law (see footnote 2). However, what is mapped
out empirically is the distribution of trading rates, the product of the contact rate λ and
the probability of trading in a meeting, pλ . The next proposition then connects the results
describing the distribution of contact rates to the distribution of trading rates, allowing us
to directly relate to the empirical literature.

Proposition 6 Assume c(λ) = c < ∆/16γ. The equilibrium distribution of trading rates
inherits the tail properties of the contact rate distribution, i.e. it has a Pareto tail with tail
parameter 2 and a zero measure of middlemen account for a strictly positive fraction of
trades.

Intuitively, the trading rate inherits the Pareto tail of the contact rate distribution, since
the trading probability conditional on a meeting converges to a positive constant in the tail.
This also ensures that middlemen account for a positive fraction of trades.
    Thus, with linear cost, our setup gives rise to a distribution of trading rates that looks like
its empirical counterpart. We highlight that the empirical literature frequently finds power
law coefficients close to 2. For instance, Gabaix, Gopikrishnan, Plerou and Stanley (2006)
report a tail parameter of 2.5 for the distribution of trading volume in the stock market.
While the exact Pareto result holds only in the tail, our numerical results in Section 3.9 show
that the entire distribution closely resembles a Pareto with tail parameter 2.


3.8    Linear Cost Function: Frictionless Limit
For many real world markets, frictions are small and so a natural question is whether inter-
mediation retains its prominent role in the frictionless limit and whether we obtain additional
insights from studying frictions in markets where frictions are small. This section therefore
focuses on the model with a linear cost when the cost of a meeting is negligible, c → 0. In
this limit, the lower bound on contact rates converges to infinity, λ → ∞, so in some sense
everyone can trade instantaneously. Still, this hides important heterogeneity in contact rates
in the limiting economy. To emphasize this point, in an economy with 0 < c < ∆/16γ and
hence λ < ∞, we define a trader’s relative contact rate as ρ ≡ λ/λ and call a trader “finite”
whenever ρ < ∞ and a middleman if ρ = ∞. We find that the distribution of ρ and the
fraction of meetings that are with middlemen have well-behaved limits as c → 0 and hence
λ → ∞. This limit then also allows us to obtain a sharp characterization of volume, the rate




                                                19
at which assets are traded:11

Proposition 7 Assume c(λ) = c. In the limit of equilibrium allocations as c → 0, a strictly
positive fraction of meetings are with middlemen and a strictly positive fraction are with
finite traders. Volume lies between 2γ and 2.5γ and can be decomposed as follows: finite
traders’ purchases from middlemen account for a volume of 21 γ; middlemens’ purchases from
middlemen account for a volume of 21 γ; middlemens’ purchases from finite traders account
for a volume of 12 γ; and finite traders’ purchases from finite traders account for the remaining
volume, which lies between 21 γ and γ.

The proof of Proposition 7 provides exact expressions for the fraction of meetings with midd-
lemen (approximately 26.9 percent), volume (approximately 2.46γ, of which 40.7 percent is
accounted for by middlemens’ purchases), and the ratio between the average contact rate Λ
and the lower bound on contact rates λ (both of which converge to infinity in the limit). It
also provides an implicit equation for the distribution of the relative contact rate ρ.
    We contrast Proposition 7 with a naı̈ve view of a market without frictions: all traders can
trade instantaneously upon receiving a preference shock and only trade with other traders
who receive the opposite preference shock at the same instant. That means that volume
equals the share of traders in the low preference state times the rate at which they are hit by
preference shocks, 21 γ. Note that this view leaves no role for intermediation or middlemen. In
contrast, we obtain more than four times as much trading volume. Furthermore, the propo-
sition highlights that a meaningful role for heterogeneity in contact rates and intermediation
by both finite traders and middlemen pertains to the limiting economy.
    To understand this result note that we are looking at a frictionless limit where almost
no one is misaligned. Whenever a trader (who is almost surely a finite trader) suffers a
preference shock, she is very likely to be well-aligned and very unlikely to contact another
misaligned trader, i.e. limλ→∞ L(λ) → 0. Instead, the market passes the asset towards faster
traders whenever possible. Since the faster trader is still very unlikely to be misaligned,
this trade does not reduce misalignment, but simply moves it towards the core traders. This
piece of the process stops once the misalignment is passed to a middleman. What the volume
decomposition shows is that, in the frictionless limit, the reallocation of the asset in response
to taste shocks runs through an intermediation chain that always involves middlemen. Every
time there is a preference shock, there is a trade between a middleman and a finite trader.
Half these trades are asset purchases and half are asset sales.
    When middlemen take on the asset from a finite trader they, too, move into misalign-
ment. Afterwards, they quickly trade away from misalignment, but only by meeting another
  11
   We make the natural assumption that two middlemen trade if and only if both are misaligned and have
opposite asset holdings.


                                                 20
middleman. As a consequence trade from middlemen to middlemen accounts for a volume of
1
2
  γ. The reason is that, when c is small, the misalignment rate of finite traders is proportio-
nal to the square of the misalignment rate of middlemen. Thus, as misalignment converges
to zero, traders are far more likely to contact misaligned middlemen than misaligned finite
traders. Taken together, whenever a trader experiences a taste shock the market rapidly re-
allocates her asset position to a misaligned finite type with opposite preferences. But instead
of doing so directly, the position gets traded through an intermediation chain. This chain
runs through faster finite types towards middlemen who then first reallocate the position
internally before passing it back to misaligned finite types with opposite preferences.


3.9       Linear Cost Function: Numerical Results
This section focuses on numerical results when the cost function is linear, c(λ) = c for all
λ. Throughout we normalize γ = 1. We first offer a numerical result that strongly suggest
existence and uniqueness of the equilibrium allocation. The sole parameter governing the
equilibrium allocation is the cost of contacts relative to the gains from alignment, c/∆. For
a given value of λ > 0, we solve equation (13) to find the functions H(λ) and L(λ), which
completely characterize the equilibrium. We then back out the implied ratio c/∆ from the
requirement that any value of λ in the support of the distribution G, and in particular
λ, is a profit maximizing choice. Inverting this gives us the set of equilibrium allocations
corresponding to each value of c/∆.
    For c/∆ ≥ 1/16, Proposition 5 proves that autarky is the unique equilibrium. Other-
wise, the red line in the top panel in Figure 2 suggests that each value of c/∆ ∈ (0, 1/16)
corresponds to a unique value of λ.12 When costs are close to 1/16, the lower bound is
very small and it grows without bound as costs converge to 0. Since the rest of the equili-
brium allocation is determined from λ using equation (13), this implies that each value of
c/∆ ∈ (0, 1/16) corresponds to a unique equilibrium allocation. If this mapping is indeed
one-to-one, this would prove existence and uniqueness of equilibrium. An analytical proof
of this claim eludes us.
    The middle panel in the figure plots the average contact rate Λ relative to the lower bound
λ as a function of the relative cost c/∆.13 The third panel in Figure 2 plots the fraction
                                             R∞
of meetings that are with middlemen, 1 − 0 λdG(λ)/Λ. This too is strictly decreasing in
the cost, converging to 0 when relative costs converge to 1/16 and approximately 0.27 when
costs converge to zero. Finally, the fourth panel in Figure 2 plots volume per unit of time.
This rises from 0 when relative costs converge to 1/16, exceeds 21 (the frictionless benchmark)
 12
      The blue lines in Figures 2 and 3 refer to the optimal allocation, which we define and analyze in Section 4.
 13
      Exact expressions for all limiting expressions in this paragraph are given in the proof of Proposition 7.


                                                        21
                                                  Lower Bound λ
                                         equilibrium
                                   3
                                 10
                                              optimum
                                 101


                     λ
                                10−1

                                10−3

                                             Average Contact Rate Λ/λ
                                   3

                                           optimum
                                 2.5
                     Λ/λ




                                            equilibrium
                                   2


                                 1.5
                                         Share of Contacts with Middlemeng
                                 0.4
                     λdG(λ)/Λ




                                           optimum
                                 0.3
                                            equilibrium
                                 0.2
                    R∞
                          0




                                 0.1
                     1−




                                   0
                                                      Volume
                                                  equilibrium
                                   2       optimum
                    volume




                                   1


                                  0
                                  10−7     10−6   10−5 10−4 10−3      10−2
                                                  relative cost c/∆

Figure 2: Features of the equilibrium and optimal contact rate distribution given relative
costs c/∆. We normalize γ = 1.


                                                       22
when c/∆ < 0.02, and converges to 2.46 in the limit as costs converge to zero.
    Figure 3 hones in on the equilibrium allocation for a particular value of the relative cost
c/∆. The top panel plots the distribution of contact rates. The survivor function 1 − G(λ)
is nearly linear in log-log space and has slope −2. That is, it is close to an exact Pareto
distribution with tail parameter 2, although we can prove that it is not an exact Pareto
distribution. In line with proposition 6, the middle panel shows that the same holds for
the equilibrium distribution of trading rates, the subject of much attention in the empirical
literature as discussed above. That is, the figure suggests that the entire distribution of
trading rates is well-approximated by a power law. Moreover, most traders have a trading
rate that exceeds γ, which means that intermediation is important for understanding the vast
majority of trades in this marketplace. Finally, the bottom panel shows the gradual increase
in the misalignment rate experienced by traders with higher contact rates, a corollary of
Proposition 4.


4      Optimal Allocation
This section examines which trading patterns and contact rate distributions maximizes
average utility. We imagine a hypothetical social planner who can instruct traders both
on their choice of λ at the initial date and on whether to trade in each future meeting,
but who cannot directly alleviate the search frictions in the economy. Since all traders are
identical at time 0, the solution to the social planner’s problem gives us the Pareto optimal
allocation.


4.1     Planner Problem
We work directly with the undiscounted problem where the planner wishes to maximize
steady state average utility.14 We also impose that the planner must use a symmetric trading
pattern, as in the equilibrium. Thus we simply need to keep track of the number of misaligned
traders at each contact rate λ.
    The planner’s objective is to maximize
                                        Z    ∞
                               δ0 + ∆            (1 − mλ )dG(λ) − ΛE(c(λ))                            (14)
                                         0


Each misaligned trader gets a flow payoff of δ0 , while each well-aligned trader gets a flow
payoff of δ1 = ∆ + δ0 , expressed in the first two terms. In addition, the planner must pay the
  14
    It is also possible to write down the discounted planner’s problem, take the limit as the discount rate
converges to zero, and focus on steady states. The results are the same.


                                                       23
                                                              Contact Rate Distribution
                                              100




                survivor function 1 − G(λ)
                                             10−1
                                                                                      eq
                                             10−2                                      uil
                                                                                          ibr
                                                                                op            ium
                                                                                  tim
                                             10−3                                    um
                                             10−4

                                             10−5 1
                                                10                    102            103                    104
                                                                        contact rate λ

                                                              Trading Rate Distribution
                                              100
                survivor function 1 − G(λ)




                                             10−1
                                                                                 eq
                                             10−2                                  ui
                                                                                     lib
                                                                           op        riu
                                               −3
                                                                               tim       m
                                             10                                   um

                                             10−4

                                             10−5
                                                        100              101           102                  103
                                                                       trading rate λpλ

                                                                      Misalignment Rate
                                              0.2
                                                                                              equilibrium
                    misalignment rate mλ




                                             0.15                     m
                                                                  imu
                                                              opt
                                              0.1

                                             0.05

                                                  0 1
                                                  10                  102            103                    104
                                                                        contact rate λ

Figure 3: Equilibrium and optimal contact rate distribution, trading rate distribution, and
misalignment rates, c/∆ = 0.001 and γ = 1.


                                                                          24
search costs, equal to the product of the average search intensity Λ and the cost per meeting
in the average meeting.
    The planner has two instruments. The first is that she chooses the set of admissible
trades. When a trader with contact rate λ and alignment status a ∈ {0, 1} meets a trader
with contact rate λ0 and alignment status a0 ∈ {0, 1} and the opposite asset position, they
                           0 0
trade with probability 1λλ,a,a = 1λ,a
                                  λ0 ,a0 . This implies that the steady state misalignment rate
satisfies
                                  
      λ  λ0 ,0      λ0 ,1
   γ + E 1λ,0 mλ0 + 1λ,0 (1 − mλ0 ) mλ
      2
                                                                
                                      λ  λ0 ,0    λ0 ,1
                               = γ + E 1λ,1 mλ0 + 1λ,1 (1 − mλ0 ) (1 − mλ ). (15)
                                      2

Second, the planner chooses the distribution of contact rates G(λ) and the average contact
                                          R∞
rate Λ. We allow the planner to set Λ > 0 λ0 dG(λ0 ), i.e. to use middlemen.
   The optimal allocation is a contact rate distribution G(λ) and Λ and trade indicator
             0 0
functions 1λλ,a,a ∈ [0, 1] that maximize (14) subject to (15). Our main result is that the
equilibrium and optimum allocations are qualitatively the same:

Proposition 8 Propositions 1–7 hold with the word “equilibrium” replaced by “optimum.”

The proof proceeds by solving the planner’s constrained optimization problem. The first
order conditions yield an expression for the social net value of asset ownership, Sλ , which
is the Lagrange multiplier on the misalignment constraint (15). We then show that the
planner requires trade whenever the joint social surplus of the transaction is positive. The
social surplus function Sλ is closely related to the private surplus sλ , and in particular is
decreasing and nonnegative:

                                        ∆       R∞       0
                                                            
                                 Sλ =      1 − e− λ Φλ0 dλ ,                              (16)
                                        2γ

where
                                            4γ
                              Φλ ≡                     .                                (17)
                                  λ 4γ + λ(H(λ) + 2L(λ))

This is scarcely changed from equations (9) and (10) in the decentralized equilibrium. Mo-
reover, the planner sets dG(λ) > 0 only if λ maximizes

                                                 γ ∞
                                                 Z                       
               λ                                                      0
        − γSλ + E Iλ0 <λ Sλ0 − Sλ mλ0 − λ c(λ) +     Sλ0 (1 − 2mλ0 )dG(λ )                (18)
               2                                 Λ 0



                                              25
               R∞
and sets Λ ≥   0
                    λdG(λ) and
                     1                            γZ ∞
               lim      E ((Sλ0 − Sλ )mλ0 ) − c(λ) ≤     Sλ0 (1 − 2mλ0 )dG(λ0 ),         (19)
               λ→∞    2                              Λ 0

with complementary slackness. This is analogous to part 3 of the definition of equilibrium.
   When the cost of contacts is constant, c(λ) = c, the appendix also characterizes the plan-
ner’s problem as the first order differential equation in H and L, analogous to equation (13a)
governing equilibrium:

                     2γ (2H(λ) + λH 0 (λ)) = λ2 (H(λ)L0 (λ) − L(λ)H 0 (λ)) .             (20)

Equation (13b) is unchanged. We use this pair of equations for the planner’s analog of
Propositions 5, 6, and 7.
    The proposition first implies that the equilibrium trading pattern is optimal. The in-
tuition for the result is straightforward. The planner’s objective function boils down to
minimizing the average rate of misalignment. The planner therefore demands trade if it
reduces static misalignment and rejects it if it raises static misalignment. In the case where
only one trader is misaligned, the planner moves the misalignment towards the trader with
more future trading opportunities. That is, the planner uses faster traders as intermediaries.
This does not affect the current misalignment rate, but improves future trading possibilities.
It follows that, given a non-degenerate distribution of contact rates G(λ), the intermediated
trading pattern governing equilibrium is optimal. This implies that the allocation would be
strictly inferior if traders could only engage in fundamental trades.
    The atomless feature of the optimal distribution allows the planner to leverage the gains
from meetings through intermediation. That is, any meeting between two individuals with
identical contact rates λ is gainful solely in the double-coincidence case. In contrast, when
two individuals with different contact rates meet each other, the meeting is socially gainful
not only in the double-coincidence case but also when misalignment can be traded towards
the faster individual. An atomless distribution maximizes the fraction of meetings in which
there are gains from trade.
    Furthermore, the proposition implies that the optimal distribution has a Pareto tail and
features middlemen, a zero measure of individuals with infinite contact rate. The Pareto tail
with parameter 2 arises from exactly the same logic discussed above for the equilibrium case.
Given the linear cost function it equates the marginal social returns to meetings created by
different types λ. The planner introduces middlemen for reasons that likewise mimic the
equilibrium case. A trader’s social value consists of the direct flow valuation she derives


                                               26
from her asset holdings and from the impact she has on the overall allocation net of the
cost of meetings. The latter component again becomes linearly scalable as λ becomes very
high; when a fast trader becomes even faster, she conducts the same types of trade, just
more frequently. It thus follows that the net social value that arises from trade by fast types
needs converges to zero when fast types coexist, as is the case with the Pareto tail. But in
the absence of middlemen fast traders have a misalignment rate converging to the autarky
level of 21 , implying that those traders have zero social value in excess of autarky. Clearly,
this cannot be part of the optimal solution where the marginal social returns to meetings
are equated across traders as long as the optimal solution dominates autarky—which is the
case whenever c < ∆/16γ.
    In the frictionless limit, as the constant meeting cost c approaches zero, the optimal al-
location shares the same qualitative features as equilibrium. However, the exact magnitudes
are different. In the optimal allocation, the fraction of meetings that go to middlemen is
e−1 , more than in equilibrium. Volume is (e − 12 )γ ≈ 2.22γ, which is smaller than the equili-
brium trading rate. As in equilibrium, middlemen buy from middlemen at rate 12 γ and from
finite traders at rate 12 γ while finite traders buy from middlemen at rate 21 γ. That is, just
like in equilibrium, the reallocation of the asset following a taste shock happens through an
intermediation chain which always involves two middlemen. The only difference from the
equilibrium allocation is that the optimal volume of purchases by one finite trader of the
asset held by another is slightly lower, namely (e − 2)γ.
    We can also characterize the limiting behavior of the entire optimal search intensity
distribution in closed form. Let Ψ denote the distribution of ρ ≡ λ/λ, so Ψ(ρ) = G(ρλ) for all
                                                                                            −1
ρ ≥ 1. When costs converge zero, λ grows without bound but Ψ(ρ) converges to (1−ρ−1 )eρ .
Compared to the equilibrium meeting distribution provided in the appendix, one can see
that the equilibrium distribution is more concentrated than the optimal solution. These
discrepancies between the optimal and the equilibrium allocation in the frictionless limit are
consistent with the more general discussion of inefficiency offered in the next subsection.


4.2    Pigouvian Taxes
Although the qualitative features of the equilibrium and optimal allocations are identical,
the equilibrium distribution is still inefficient. There are two sources of inefficiency. The
first comes from bargaining. In the decentralized equilibrium, each trader keeps only half of
the surplus from every meeting, while the social planner recognizes the value of the entire
surplus. This force induces traders to underinvest in meetings in equilibrium. Formally, this
is readily observable by contrasting equations (11) and (18): The planner puts twice the


                                              27
weight on the option value of trade compared to the individual trader.
    The second source of inefficiency is a business stealing effect. When one trader invests
more in meetings, she diverts meetings towards herself. That is, investing more in meetings
does not affect the contact rate of the other market participants, but it changes the distri-
bution of whom they meet. The failure to internalize this effect causes traders to overinvest
in meetings in equilibrium. This business stealing effect is represented by the last (negative)
term in (18). Notice that no corresponding term exists in the equilibrium counterpart (11).
    We can directly correct for each of these externalities. First, assume that whenever two
traders meet, an outside agent doubles the surplus from the meeting. Second, assume that
whenever a trader meets anyone, the outside agent charges her a tax which is independent
                            R∞
of her contact rate, τ̄ ≡ Λγ 0 Sλ0 (1 − 2mλ0 )dG(λ0 ). Then the equilibrium Bellman equations
for misaligned and well-aligned traders become

                         λ
       rvλ,0 = δ0 + γsλ + E (sλ + sλ0 )+ mλ0 + (sλ − sλ0 )+ (1 − mλ0 ) − λ(c(λ) + τ̄ )
                                                                      
                         2
                         λ
   and rvλ,1 = δ1 − γsλ + E (−sλ + sλ0 )+ mλ0 + (−sλ − sλ0 )+ (1 − mλ0 ) − λ(c(λ) + τ̄ ).
                                                                         
                         2

Taking the difference between these equations, we confirm that this reduces to equation (53),
and hence the equilibrium and optimal surplus functions are equal, sλ = Sλ . Moreover, the
equilibrium choice of λ, which must maximize the right hand side of the Bellman equation
for the well-aligned trader, coincides with the optimal choice from conditions (18) and (19).
It follows that the optimal allocation is an equilibrium with these Pigouvian taxes.
    In the case of a constant cost per meeting, the tax and subsidy scheme that decentralizes
these forces nets out to zero (in expectation) for all traders λ. That is, traders receive a
subsidy when they are misaligned and pay a tax when they are well-aligned, but the weighted
average of these transfers is zero:

Proposition 9 When c(λ) = c, the tax and subsidy system that decentralizes the optimal
allocation is such that τ̄ = c and the expected per worker subsidy in each meeting also equals
c for all types λ.

To understand this finding, first note that the social value of an average meeting equals in
an optimal allocation is the cost of the meeting, 2c for all traders λ. The subsidy we propose
doubles the joint surplus in each meeting, hence adds on average an additional 2c. Since
those are split symmetrically, the average expected subsidy per worker and meeting is c.
To understand the tax, it is easiest to think about the business stealing externality in the
following way: When increasing her contact rate, a trader effectively prevents others from
meeting each other. In particular, for each two additional meetings a trader “acquires,”

                                              28
she replaces one average meetings between two other traders. Under the optimal allocation,
that average meeting has value 2c. Thus, the tax τ̄ that internalizes the business stealing
externality equals c.
    It may seem paradoxical that a tax and subsidy system which does not transfer resources
across risk-neutral traders could affect the equilibrium allocation. The reason it has a real
effect is that the taxes and transfers alter payoffs conditional on alignment status, hence
the threat points in bargaining and the equilibrium price of assets. This in turn affects
investment decisions. To see this, we consider an equivalent representation of the tax and
subsidy scheme, which transfers are independent of who a trader contacts. Under this
scheme, misaligned trader pays a per-meeting tax
                   Z   ∞
               γ                                   1
                           Sλ0 (1 − 2mλ0 )dG(λ0 ) − E (Sλ + Sλ0 )mλ0 + Iλ0 >λ (Sλ − Sλ0 )(1 − mλ0 ) ,
                                                                                                   
      τλ,0   =
               Λ   0                               4

while a well aligned trader pays a tax
                                    Z   ∞
                                γ                                   1
                                            Sλ0 (1 − 2mλ0 )dG(λ0 ) − E Iλ0 <λ (Sλ0 − Sλ )mλ0 .
                                                                                            
                       τλ,1   =
                                Λ   0                               4

It is immediate that τλ,1 > τλ,0 for all λ and proposition 9 implies they average out to zero.
This means that the taxes affect the threat points in an intermediated trade. Intermediaries
take on misaligned asset positions from slower types. The taxes on the slower trader reduce
her gains from trade, which in turn reduces the profitability of intermediation under Nash
bargaining. Thus, while the direct payments net out to zero, their indirect effect on asset
prices offset the inefficiencies that lead to overinvestment in the equilibrium without taxes.


4.3      Equilibrium and Optimum: Numerical Illustration
This section numerically contrasts the equilibrium with its optimal counterpart along several
dimensions. First, the blue lines in Figure 2 summarize the optimal allocation with γ norma-
lized to 1. For any cost function, the top panel shows that the lower bound on the optimal
contact rate distribution is lower than under the equilibrium contact rate distribution.15 The
bottom panel shows that volume is also inefficiently high in equilibrium. We view this as
numerical proof that the equilibrium displays systematic overinvestment.
    To develop an intuition for this finding, we note that the business stealing externality
is identical for all types λ. In turn, the positive externality that arises from bargaining is
larger for those traders with higher average surplus meetings which are those with lower λ.
  15
     Furthermore, there appears to be a one-to-one mapping between contact rates c/∆ < 1/16 and lower
bounds λ. Just as in equilibrium, this suggests that the optimal allocation exists and is unique.


                                                            29
As a consequence, there are too few slow types and too many fast types and the undistorted
equilibrium displays excessive trading volume.
    On the other hand, given the lower bound on the contact rate, the rest of the distribution
is more compressed in equilibrium than the optimum. The second panel in Figure 2 shows
that the optimal average contact rate relative to the lower bound is higher than the equili-
brium counterparts. Likewise, the third panel shows that the optimal share of middlemen is
higher than the equilibrium share.
    The blue lines in Figure 3 illustrate more details of the optimal allocation when c/∆ =
0.001. The top panel shows that the optimal distribution of contact rates is “close” to a
Pareto with tail parameter 2, similar to the equilibrium, although we can again prove it is not
an exact Pareto. The middle panel shows that this carries over to the distribution of trading
rates, implying that the empirically documented scale-free nature of many financial networks
is also a feature of a market that optimally leverages the gains from intermediation when
the cost per meeting is constant. Once again most traders have an optimal trading rate that
exceeds γ, the natural benchmark for an economy without intermediation. Intermediation
is key to understanding the amount of trades in the optimal allocation.
    Finally, the blue line in the bottom panel in Figure 3 plots the misalignment rate against
λ in both equilibrium and the optimal allocation. As expected from Propositions 4 and 8,
traders with a higher contact rate have a higher misalignment rate in both equilibrium and
optimum. The equilibrium distribution of contact rates first order stochastically dominates
the optimal one; as a consequence, all traders with finite λ are more likely to meet with a
faster individual when comparing equilibrium with the optimal case. The reason the misalig-
nment rate crosses is that the planner allocates a larger fraction of meetings to middlemen;
see the bottom panel of Figure 2. This disproportionately benefits fast traders since they
can offload misalignment.


5    Constrained Economy: The Role of Intermediation
To understand the role of intermediation and its connection with heterogeneity, consider an
economy in which intermediation is not allowed. To be concrete, suppose meetings between
two traders with the same preference state simply do not occur. It follows that whenever
a misaligned trader meets a well-aligned trader, they have opposite preference states and
hence the same asset holdings, and so there is no scope for trade. We show in this section
that without intermediation, the equilibrium and optimal distribution of contact rates are
degenerate as long as the cost function λc(λ) is weakly convex.



                                              30
Constrained Equilibrium We start by defining an equilibrium without intermediation
analogously to the definition of equilibrium with intermediation.

Definition 2 A steady state equilibrium is a distribution of contact rates G(λ), an average
contact rate Λ, an allocation of misalignment mλ , and undiscounted surplus function sλ ,
satisfying the following conditions:

  1. Balanced inflows and outflows into misalignment as given by
                                                                   
                 λ                         λ                        
              γ + E Isλ +sλ0 >0 mλ0 mλ = γ + E Isλ +sλ0 <0 (1 − mλ0 ) (1 − mλ ).         (21)
                 2                          2

  2. Consistency of sλ with the value functions (5) and (6) adjusted for the no-intermediation
     case,
                                 λ                                            
                  ∆ = 2γsλ + E (sλ + sλ0 )+ mλ0 − (−sλ − sλ0 )+ (1 − mλ0 )               (22)
                                 4
  3. Optimality of the ex-ante investment decision:

      (a) dG(λ) > 0 only if it maximizes

                                     λ           +         
                           δ1 − γsλ + E − sλ − sλ0 (1 − mλ0 ) − λc(λ)
                                     4
                                                    R∞
      (b) Middlemen make finite profits: Λ ≥        0
                                                         λdG(λ) and
                                  1                                    
                                       E (−sλ − sλ0 )+ (1 − mλ0 ) − c(λ) ≤ 0,
                                                                 
                            lim
                            λ→∞    4

           with complementary slackness.

   Note that there are two relevant types of meetings in this constrained economy, those
between two misaligned traders with the opposite asset holdings, and those between two
well-aligned traders with the opposite asset holdings. We can extend our earlier results to
prove that the first type of meeting results in trade while the second does not. That is, in
equilibrium, two well-aligned agents never find it optimal to jointly trade into misalignment.

Constrained Planner’s Problem We turn next to the planner’s problem. The planner
again chooses the distribution of contact rates along with the admissible set of trades; as in
equilibrium the planner is subject to the constraint that intermediation is not allowed.
    The objective of the planner is unchanged, given by equation (14). Since we are inte-
rested in the case where intermediation is not allowed the planner is subject to an adjusted
constraint on the evolution of the misalignment rate,

                                               31
                                                      
                 λ  λ0 ,0              λ  λ0 ,1
              γ + E 1λ,0 mλ0    mλ = γ + E 1λ,1 (1 − mλ0 ) (1 − mλ ).                       (23)
                 2                      2
    The following proposition then summarizes our key findings for the environment where
solely fundamental trades between traders with different preferences are allowed.

Proposition 10 Consider an economy with no intermediation and a weakly convex cost
λc(λ). In equilibrium all traders choose a common value λ = Λ. The same holds in the solu-
tion to the planner’s problem. With a continuously differentiable cost function and interior
solution, the equilibrium contact rate is inefficiently high.

    The second part of the proposition highlights that the overinvestment result we nume-
rically document for the unconstrained case holds in the constrained case. Individuals do
not internalize that investing in additional meetings lowers misalignment in the marketplace
thereby reducing the marginal value of meetings acquired by others. This force leads to
overinvestment in the aggregate.
    More importantly, the first part of the proposition highlights that the heterogeneity that
arises in the full economy is an immediate, and socially desirable, consequence of intermedi-
ation. When individuals are restricted to trades driven by static fundamentals, there is no
gains from heterogeneity in the contact rate.
    This mass point result reflects that, without intermediation, there is effectively decreasing
returns to contacts at the individual level. The misalignment rate is strictly decreasing in
meetings; as an individual becomes increasingly well-aligned fewer meetings lead to gainful
trading opportunities. As a consequence, an unequal distribution of meetings comes with
first-order losses and the optimal distribution is degenerate. The same is true in equilibrium;
with a weakly convex cost function but decreasing returns on the individual level the only
distribution where ex-ante homogeneous traders have identical value is a degenerate one.
    In summary, intermediation and heterogeneity are closely interconnected in a market
with search frictions. Without heterogeneity there is no intermediation, and without inter-
mediation there is no heterogeneity. Heterogeneity is useful because in meetings where both
sides have identical preferences misalignment can be traded towards the faster trader using
intermediation to facilitate the transmission of the asset to those with a desire for it.


6     Conclusions
We study a model of over-the-counter trading in which ex-ante identical traders invest in a
meeting technology and participate in bilateral trade. We show that when traders have he-
terogeneous search efficiencies, fast traders intermediate for slow traders: they trade against

                                               32
their desired position and take on misalignment from slower traders. Moreover, we cha-
racterize how, starting with ex ante homogeneous traders, the distribution of contact rates
is determined endogenously in equilibrium, and how it compares with the corresponding
socially optimal distribution. We argue that an economy with homogeneous contact rates
is neither an equilibrium nor socially desirable when the cost of meetings is differentiable.
Under a linear cost function the endogenous and optimal distribution of trading rates is
governed by a power law, an empirical hallmark of various financial markets. Moreover,
middlemen with an infinite contact rate account for a positive fraction of meetings. We
also characterize the transfer scheme which decentralizes the optimal allocation, offsetting
the forces that lead to overinvestment in the undistorted equilibrium. Finally, we argue
that when intermediation is prohibited, dispersion in contact rates disappears both in equi-
librium and in the optimal allocation, which illustrates the interplay between heterogeneity
and intermediation in a frictional marketplace.
    We have kept our model as simple as possible in order to show how intermediation and
middlemen naturally arise in over-the-counter markets. It would be natural to extend our
model to a more complex environment, for example one in which the two misaligned states
are not symmetric, or one in which the binary restriction on asset holdings is relaxed. We
believe that the basic forces we highlight in this paper will be robust to such extensions.
Likewise, we believe that the random matching model with endogenous contact rates may
be useful for understanding other issues in financial markets, such as the percolation of
information (Duffie and Manso, 2007). We hypothesize that middlemen may serve a useful
role in this process as well.




                                             33
References
Afonso, Gara and Ricardo Lagos, “Trade Dynamics in the Market for Federal Funds,”
 Econometrica, 2015, 83 (1), 263–313.

  , Anna Kovner, and Antoinette Schoar, “Trading Partners in the Interbank Lending
  Market,” 2013.

Allen, Linda and Anthony Saunders, “The Large-Small Bank Dichotomy in the Federal
 Funds Market,” Journal of Banking & Finance, 1986, 10 (2), 219–230.

Babus, Ana and Tai-Wei Hu, “Endogenous Intermediation in Over-the-Counter Mar-
 kets,” 2015.

Bech, Morten L. and Enghin Atalay, “The Topology of the Federal Funds Market,”
 Physica A: Statistical Mechanics and its Applications, 2010, 389 (22), 5223–5246.

Boss, Michael, Helmut Elsinger, Martin Summer, and Stefan Thurner, “Network
 Topology of the Interbank Market,” Quantitative Finance, 2004, 4 (6), 677–684.

Burdett, Kenneth and Dale T Mortensen, “Wage Differentials, Employer Size, and
 Unemployment,” International Economic Review, 1998, pp. 257–273.

   and Kenneth L Judd, “Equilibrium Price Dispersion,” Econometrica, 1983, 51 (4),
  955–969.

Butters, Gerard R, “Equilibrium Distributions of Sales and Advertising Prices,” The
 Review of Economic Studies, 1977, 44 (3), 465–491.

Chang, Briana and Shengxing Zhang, “Endogenous Market Making and Network For-
 mation,” 2016.

Chang, Eui Jung, Eduardo José Araujo Lima, Solange M Guerra, and Benja-
 min M Tabak, “Measures of Interbank Market Structure: An Application to Brazil,”
 Brazilian Review of Econometrics, 2008, 28 (2), 163–190.

Craig, Ben and Goetz Von Peter, “Interbank Tiering and Money Center Banks,” Journal
 of Financial Intermediation, 2014, 23 (3), 322–347.

Duffie, Darrell and Gustavo Manso, “Information Percolation in Large Markets,” Ame-
 rican Economic Review, 2007, 97 (2), 203–209.



                                        34
  , Nicolae Gârleanu, and Lasse Heje Pedersen, “Over-the-Counter Markets,” Eco-
  nometrica, 2005, 73 (6), 1815–1847.

  ,   , and , “Valuation in Over-the-Counter Markets,” Review of Financial Studies,
  2007, 20 (6), 1865–1900.

  , Piotr Dworczak, and Haoxiang Zhu, “Benchmarks in Search Markets,” 2016.

Eeckhout, Jan, “Gibrat’s Law for (all) Cities,” American Economic Review, 2004,
 pp. 1429–1451.

Farboodi, Maryam, “Intermediation and Voluntary Exposure to Counterparty Risk,”
  2015.

  , Gregor Jarosch, and Guido Menzio, “Tough Middlemen - A Theory of Intermedia-
  tion as Pure Rent Extraction,” 2016.

Gabaix, Xavier, “Zipf’s Law for Cities: An Explanation,” Quarterly Journal of Economics,
 1999, pp. 739–767.

  , “Power laws in economics and finance,” Annu. Rev. Econ., 2009, 1 (1), 255–294.

  , “Power Laws in Economics: An Introduction,” The Journal of Economic Perspectives,
  2016, 30 (1), 185–205.

  , Parameswaran Gopikrishnan, Vasiliki Plerou, and H Eugene Stanley, “Institu-
  tional investors and stock market volatility,” The Quarterly Journal of Economics, 2006,
  121 (2), 461–504.

Geerolf, Francois, “A Theory of Pareto Distributions,” 2016.

Heller, Daniel and Nicholas Vause, “Collateral Requirements for Mandatory Central
 Clearing of Over-the-Counter Derivatives,” 2012.

Hollifield, Burton, Artem Neklyudov, and Chester S Spatt, “Bid-Ask Spreads,
 Trading Networks and the Pricing of Securitizations: 144a vs. Registered Securitizations,”
 2014.

Hugonnier, Julien, Benjamin Lester, and Pierre-Olivier Weill, “Heterogeneity in
 Decentralized Asset Markets,” 2016.

in ’t Veld, Daan and Iman van Lelyveld, “Finding the Core: Network structure in
  interbank markets,” Journal of Banking & Finance, 2014, 49, 27–40.

                                            35
Jackson, Matthew O., Social and Economic Networks, Princeton University Press, 2010.

Lagos, Ricardo and Guillaume Rocheteau, “Liquidity in Asset Markets with Search
  Frictions,” Econometrica, 2009, 77, 403–426.

Li, Dan and Norman Schürhoff, “Dealer Networks,” 2014.

Maggio, Marco Di, Amir Kermani, and Zhaogang Song, “The Value of Trading
 Relationships in Turbulent Times,” 2015.

Mengle, David, “Concentration of OTC Derivatives among Major Dealers,” ISDA Research
 Notes, 2010, 4.

Neklyudov, Artem V, “Bid-Ask Spreads and the Over-the-Counter Interdealer Markets:
 Core and Peripheral Dealers,” 2014.

Nosal, Ed, Yuet-Yee Wong, and Randall Wright, “Who Wants to be a Middleman?,”
 2016.

Pagnotta, Emiliano and Thomas Philippon, “Competing on Speed,” 2015.

Peltonen, Tuomas A, Martin Scheicher, and Guillaume Vuillemey, “The Network
 Structure of the CDS Market and its Determinants,” Journal of Financial Stability, 2014,
 13, 118–133.

Rubinstein, Ariel and Asher Wolinsky, “Middlemen,” The Quarterly Journal of Eco-
 nomics, 1987, pp. 581–594.

Siriwardane, Emil N, “Concentrated Capital Losses and the Pricing of Corporate Credit
  Risk,” 2015.

Üslü, Semih, “Pricing and Liquidity in Decentralized Asset Markets,” 2016.

Wang, Chaojun, “Core-Periphery Trading Networks,” 2017.

Weill, Pierre-Olivier, “Liquidity Premia in Dynamic Bargaining Markets,” Journal of
 Economic Theory, 2008, 140 (1), 66–96.




                                           36
A      Appendix
Proof of Proposition 1. We show that sλ is non-negative and strictly decreasing for all
λ > 0. The proposition immediately follows.
     If sλ < 0, (−sλ +sλ0 )+ ≥ (sλ +sλ0 )+ and (−sλ −sλ0 )+ ≥ (sλ −sλ0 )+ for all λ0 . Equation (8)
then implies sλ ≥ 2/γ, a contradiction. This proves s is non-negative. Likewise, equation (7)
implies m is non-negative. It follows immediately that for all λ and λ0 , Isλ +sλ0 >0 mλ0 ≥
Isλ <sλ0 mλ0 and Isλ >sλ0 (1 − mλ0 ) ≥ Isλ +sλ0 <0 (1 − mλ0 ). Equation (7) then implies mλ ≤ 1/2
for all λ.
     Next, use s nonnegative to rewrite equation (8) as

                    λ
                              (−sλ + sλ0 )+ − (sλ + sλ0 ) mλ0 − (sλ − sλ0 )+ (1 − mλ0 ) .
                                                                                      
          2γsλ = ∆ + E
                    4

Use (−sλ + sλ0 )+ = sλ0 − min{sλ , sλ0 } and (sλ − sλ0 )+ = sλ ) − min{sλ , sλ0 } to rewrite this as

                  λ                                                                 
        2γsλ = ∆ + E        − min{sλ , sλ0 } − sλ mλ0 − sλ − min{sλ , sλ0 } (1 − mλ0 ) .
                  4

Grouping terms, this gives
                                                                   
                                 4∆ + λE min{sλ , sλ0 }(1 − 2mλ0 )
                            sλ =                                     .                         (24)
                                            8γ + λ

View this as a mapping s = T (s). We claim that for any cumulative distribution function
G and misalignment function m with range [0, 1/2], T is a contraction, mapping continuous
functions on [0, ∆/2γ] into the same set of functions. Continuity is immediate. Similarly, if
s is nonnegative, T (s) is nonnegative. If s ≤ ∆/2γ,
                                                                       
                                           8γ + λE(1 − 2mλ0 )        ∆
                            T (s)λ ≤                                          .
                                                 8γ + λ              2γ

Since the misalignment rate is nonnegative, the result follows.
   Finally, we prove T is a contraction. If |s1λ − s2λ | ≤ ε for all λ,
                                                           
                                             λεE(1 − 2m λ0)
                    |T (s1 )λ − T (s2 )λ | ≤                 ≤ εE(1 − 2mλ0 ).
                                                 8γ + λ

Note that the second inequality uses the fact that the fraction is increasing in λ and hence
evaluates it at the limit as λ converges to infinity. Since E(1 − 2mλ0 ) < 1, this proves that
                                                     R∞ 0
T is a contraction in the sup-norm, with modulus 0 λΛ (1 − 2mλ0 )dGλ0 .
   Next we prove that the mapping T takes nonincreasing functions s and maps them into

                                                  37
                                                                             
decreasing functions. Take λ1 < λ2 and let E(λ) ≡ E min{sλ , sλ0 }(1 − 2mλ0 ) . Note that m
nonnegative and sλ ≤ ∆/2γ implies E(λ) ≤ ∆/2γ as well. Similarly, s nonincreasing implies
E is nonincreasing as well. Then

                                            4∆ + λ1 E(λ1 ) 4∆ + λ2 E(λ2 )
                   T (s)(λ1 ) − T (s)(λ2 ) =               −
                                               8γ + λ1          8γ + λ2
                                            4∆ + λ1 E(λ1 ) 4∆ + λ2 E(λ1 )
                                          ≥                −
                                               8γ + λ1          8γ + λ2
                                                                    
                                            4(λ2 − λ1 ) ∆ − 2γE(λ1 )
                                          =                           > 0,
                                               (8γ + λ1 )(8γ + λ2 )

The first equality is the definition of T . The first inequality uses E(λ2 ) ≤ E(λ1 ). The second
equality groups the two fractions over a common denominator. And the second equality uses
E(λ) < ∆/2γ. This proves the result. It follows that the equilibrium surplus function is
decreasing.


Deriving Equation (9). Since the surplus function is nonnegative and nonincreasing, we
can rewrite equation (8) as
                                                                               
                λ                                                  
      ∆ = 2γsλ + E    sλ + sλ0 − Iλ0 <λ sλ0 − sλ mλ0 + Iλ0 >λ sλ − sλ0 (1 − mλ0 )
                4

Regroup terms:
                                                                     
                  4∆ = 8γ + 2λEmλ0 sλ + λE Iλ0 ≥λ sλ − sλ0 (1 − 2mλ0 )                      (25)

Differentiate with respect to λ:

    0 = 8γ + λE(Iλ0 >λ + 2λE(Iλ0 <λ mλ0 ) s0λ + 2Emλ0 sλ + E Iλ0 >λ sλ − sλ0 (1 − 2mλ0 )
                                                                                      


Replace the last two terms using equation (25) and simplify using the definitions of H and
L to get                                                          
                     0           8γsλ − 4∆                      ∆
                    sλ =                         = φλ sλ −         ,
                         λ 8γ + λ(H(λ) + 2L(λ))                 2γ

where φλ is defined in equation (10). The general solution to this differential equation is

                                               ∆      Rλ       0
                                      sλ =        − ke λ φλ0 dλ
                                               2γ



                                                   38
for fixed λ and some constant of integration k. Use the fact that limλ→∞ sλ = 0 to pin down
the constant of integration, yielding equation (9).

Proof of Proposition 2. We proceed by contradiction. Assume G(λ) has a mass point
at some λ̄ > 0. From equation (10), we have that φλ jumps up at λ̄ since 2mλ < 1 for all λ.
Differentiating equation (9), we have that

                                             ∆       R∞       0
                                   s0λ = −      φλ e− λ φλ0 dλ ,
                                             2γ

and so this jumps down at λ̄. It follows that sλ has a concave kink at λ̄.
   Now consider part 3(a) of the definition of equilibrium. Using the monotonicity and
nonnegativity of sλ , the choice of λ must maximize

                                   λ                    
                         δ1 − γsλ + E Iλ0 <λ sλ0 − sλ mλ0 − λc(λ)
                                   4

The first derivative with respect to λ is
                              
                λ                    1
           − γ + E(Iλ0 <λ mλ0 ) s0λ + E Iλ0 <λ sλ0 − sλ mλ0 − c(λ) − λc0 (λ).
                                                          
                4                    4

Note that s0λ jumps down at λ̄ and the other expressions are continuous in λ. Therefore the
slope of the objective function jumps up at λ̄. That is, λ̄ represents a local minimum in
traders’ objective function, contradicting the assumption that G(λ) has a mass point at λ̄.


Proof of Proposition 3. To find a contradiction, we suppose that there is a hole in
the distribution of contact rates. That is, there are contact rates λ < λ̄ < ∞ such that
dG(λ) = 0 for all λ ∈ (λ, λ̄). Moreover, for this to be a hole in the distribution, we require
that E(Iλ0 ≤λ ) > 0 and E(Iλ0 ≥λ̄ ) > 0, so individuals choose contact rates on either side of
the hole. Finally, without loss of generality, we choose the thresholds λ and λ̄ such that
some individuals choose the extreme values of this set in equilibrium. Using part 3(a) of the
definition of equilibrium, this implies λ and λ̄ each maximize

                                   λ
                        vλ ≡ −γsλ + E(Iλ0 <λ (sλ0 − sλ )mλ0 ) − λc(λ).
                                   4

Note that vλ is continuous in λ, even if there are mass points in the contact rate distribution.
We prove that vλ is strictly concave for λ ∈ (λ, λ̄), which contradicts the requirement that
λ and λ̄ both maximize v.


                                                39
   To prove concavity of v, first rewrite v in this interval, using the fact that no one has a
contact rate in the interval (λ, λ̄):
                                         
                           λ                   λ
                 vλ ≡ − γ + E(Iλ0 ≤λ mλ0 ) sλ + E(Iλ0 ≤λ sλ0 mλ0 ) − λc(λ).
                           4                   4

The second term is linear in λ and the third is weakly concave, so the result follows if the
first term is strictly concave, i.e. if γ + λ4 E(Iλ0 ≤λ mλ0 ) sλ is strictly convex. To establish
                                                             

this, we solve equation (9) for sλ :
                                                                    
                        ∆   λ   8γ + λ̄ H(λ̄) + 2L(λ)      R ∞       0
                   sλ =    1−                           e− λ̄ φλ0 dλ  .
                        2γ   λ̄ 8γ + λ H(λ̄) + 2L(λ)
                                                       


The result immediately follows from twice differentiating with respect to λ.
   Finally, by setting λ̄ = ∞ and using part 3(b) of the definition of equilibrium, a similar
                           R∞
argument proves that Λ = 0 λdG(λ) whenever the support of G(λ) is bounded above which
implies the second part of the proposition.

Proof of Proposition 4. Use equation (12) to get

                                             2γ + λL(λ)
                                 mλ =                       .                               (26)
                                        4γ + 2λL(λ) + λH(λ)

We are trying to prove that

                           −λ(2γ + λL(λ)H 0 (λ) + H(λ)(λ2 L0 (λ) − 2γ)
                   m0λ =                                  2           ≥0                   (27)
                                    4γ + 2λL(λ) + λH(λ)

on the support of G.
    To prove this, we exploit restrictions on H 0 (λ) and L0 (λ) implied by equilibrium. The
first restriction simply recognizes from the definitions of H and L that mλ = −L0 (λ)/H 0 (λ)
and so equation (26) implies

                     4γ + 2λL(λ) + λH(λ) L0 (λ) = − 2γ + λL(λ) H 0 (λ).
                                                             
                                                                                            (28)

The second equation uses our equilibrium conditions. By Proposition 3, we know that the
support of G is convex. For any value of λ in the support, part 3(a) of the definition of




                                               40
equilibrium states that the profit must be the same, some v̄:

                                            λ                    
                             v̄ = δ1 − γsλ + E Iλ0 <λ sλ0 − sλ mλ0 − λc(λ),                   (29)
                                            4

where we simplify the expression slightly using the results from Proposition 1. This implies
the first order condition
                            
                        λ            1
            0 = − γ + L(λ) s0λ + E Iλ0 <λ (sλ0 − sλ )m0λ − c(λ) − λc0 (λ)
                                                             
                                                                                       (30)
                        4            4
                            
                        λ            v̄ − δ1 + γsλ
              = − γ + L(λ) s0λ +                    − λc0 (λ)
                        4                   λ
                                 R∞                              R∞       0
                                          0
                ∆ (4γ + λL(λ)) e− λ φλ0 dλ    v̄ − δ1 + ∆2 1 − e− λ φλ0 dλ
              =                         +                                  − λc0 (λ)
                λ 8γ + λ(H(λ) + 2L(λ))                       λ
                                        R∞     0         δ1 +δ0
                  −(δ1 − δ0 )H(λ)e− λ φλ0 dλ  v̄ −          2
                                                                   − λ2 c0 (λ)
                 =                        +
                  2 8γ + λ(H(λ) + 2L(λ))                          λ


where the second line simplifies the using first equation (29), the third line replaces sλ and
its derivative using equation (9) and replaces φλ using equation (10), and the fourth line
groups terms and recognizes that ∆ = δ1 − δ0 . Rewrite this as
                                        R∞     0
                              λH(λ)e− λ φλ0 dλ     2λ2 c0 (λ)   2v̄ − δ1 − δ0
                                                 +            =                               (31)
                            8γ + λ(H(λ) + 2L(λ))    δ1 − δ0         δ1 − δ0

for all λ in the support of G(λ). Differentiating this expression and replacing φλ gives us a
second equation relating H 0 (λ) and L0 (λ):
       R∞
            φλ0 dλ0
 2e−                  λ(4γ + λL(λ))H 0 (λ) + H(λ)(8γ − λ2 L0 (λ))
                                                                 
       λ                                                            2λ
                                               2                  + (2c0 (λ) + λc00 (λ)) = 0. (32)
                          8γ + λ(H(λ) + 2L(λ))                      ∆

Solve equations (28) and (32) for H 0 (λ) and L0 (λ) and substitute into equation (27). The
resulting expression is cumbersome, but it is easy to verify that it is strictly positive if
2c0 (λ) + λc00 (λ) ≥ 0, i.e. if λc(λ) is weakly convex.

Proof of Proposition 5. We start by proving that there is an equilibrium with Λ = 0
if and only if c ≥ ∆/16γ. To do this, we suppose that such an equilibrium exists. Equa-
tion (7) implies m0 = 1/2. Since the surplus function is nonnegative and nonincreasing




                                                    41
(Proposition 1), equation (8) implies that for all λ > 0,

                                                  4∆
                                         sλ =          ,
                                                8γ + λ

with s0 = ∆/2γ. Then part 3 of the definition of equilibrium implies that there is an
equilibrium with λ = 0 if and only if 0 maximizes

                                         λ
                                   −γsλ + (s0 − sλ ) − λc.
                                         8

Substituting for sλ , this reduces to the necessary and sufficient condition

                                               ∆(λ − 8γ)
                                 0 ∈ arg max             − λc.
                                                 16γ

The objective function is linear in λ, maximized at 0 if and only if c ≥ ∆/16γ, completing
this step of the proof.
    We next suppose that c ≥ ∆/16γ and prove that there is no equilibrium with Λ > 0. To
find a contradiction, suppose that such an equilibrium exists and let λ̄ > 0, possibly infinite,
denote the fastest contact rate in the population. As in the first step of the proof, part 3
of the definition of equilibrium implies that λ̄ must deliver at least as high profits as setting
λ = 0:
                                   λ̄                
                            −γsλ̄ + E sλ0 − sλ̄ mλ0 − λ̄c ≥ −γs0
                                   4
Now use the fact that s is nonincreasing and that mλ0 ≤ 1/2. This implies

                               1                                 
                                 (s0 − sλ̄ ) ≥ E     sλ0 − sλ̄ mλ0 .
                               2

Thus a necessary condition to have an equilibrium with Λ > 0 is

                                   8γ + λ̄
                                           (s0 − sλ̄ ) − λ̄c ≥ 0
                                      8

Equations (9) and (10) imply
                                                  2∆
                                     sλ̄ =                  ,
                                             4γ + λ̄E(mλ0 )
while s0 = ∆/2γ. Therefore the necessary condition to have an equilibrium with Λ > 0
reduces
                            (8γ + λ̄)λ̄∆E(mλ0 )
                                               − λ̄c ≥ 0
                            16γ 4γ + λ̄E(mλ0 )
Using the fact that E(mλ0 ) ∈ (0, 1/2), the left hand side is a strictly convex function of λ̄.

                                                42
Moreover, evaluate the first derivative of the left hand side in the limit as λ̄ converges to
infinity. It is negative if and only c ≥ ∆/16γ. Since the left hand side is nonincreasing for
large λ̄ and globally convex, it is strictly decreasing for all λ̄. Finally, since the left hand side
is 0 at λ̄ = 0, it is strictly negative at all positive values of λ̄, a contradiction. This proves
that if c ≥ ∆/16γ, there is a unique equilibrium and it has Λ = 0.
    The remainder of the proof focuses on the case where c < ∆/16γ. We have already
proved that there is no equilibrium with Λ = 0 and now characterize an equilibrium with
Λ > 0. For all λ in the support of G, equation (31) with c(λ) = c reduces to
                                          R∞      0
                               λH(λ)e− λ φλ0 dλ     2v̄ − δ1 − δ0
                                                  =               .                             (33)
                             8γ + λ(H(λ) + 2L(λ))       δ1 − δ0

If 0 is in the support of G, this implies v̄ = δ1 +δ2
                                                      0
                                                        , the value of autarky. That is, the right
hand side of this equation is 0. The left hand side is then also equal to 0 at all λ in the
support of G. This is a contradiction for all strictly positive λ that are smaller than the
highest value in the population, a contradiction. This proves that 0 is not in the support of
G, but instead the lower bound of the support of G is λ > 0.
    Replicating the proof of Proposition 3, we can show that the value function vλ is strictly
concave at all λ < λ. Since it must also be weakly higher at λ than at any lower value of λ,
this implies it is strictly increasing on this interval. It follows that v̄ > v0 = δ1 +δ
                                                                                      2
                                                                                         0
                                                                                           .
    Turn now to the upper bound λ̄ and, to find a contradiction, suppose λ̄ < ∞. That is,
H(λ̄) = 0. Then for all λ ≥ λ̄, equation (10) implies

                                               4γ
                                      φλ ≡            .
                                          λ 4γ + λL(λ̄)

Then equation (9) implies
                                            2∆
                                 sλ =                     ∀λ ≥ λ̄.                              (34)
                                        4γ + λL(λ̄)
Since no one chooses these high values of λ, part 3(a) of the definition implies that for all
λ > λ̄, the profits must be lower than choosing λ̄:

                  λ                                 λ̄                         
            −γsλ + E       sλ0 − sλ mλ0 − λc ≤ −γsλ̄ + E             sλ0 − sλ̄ mλ0 − λ̄c.
                  4                                   4

Rearranging terms, replacing sλ using the previous expression, and using λ > λ̄, this reduces
to
                                      1
                                        E(sλ0 mλ0 ) ≤ c.                                 (35)
                                      4


                                                 43
Now compare the value of choosing λ̄ to the value of autarky, λ = 0. Using v̄ > v0 , we have

                                  λ̄                       
                           −γsλ̄ + E           sλ0 − sλ̄ mλ0 − λ̄c > −γs0 .
                                  4

Use equation (8) to eliminate s0 and equation (34) to eliminate sλ̄ :
                                                                 
                                             1
                                    λ̄         E(sλ0 mλ0 ) − c        > 0.
                                             4

This contradicts inequality (35), establishing the contradiction.
   We next prove that middlemen account for a positive fraction of meetings in equilibrium.
Our starting point is equation (33). Take the limit as λ converges to ∞, noting that that
  R∞       0
e− λ φλ0 dλ → 1 and 8γ/λ → 0. The equation reduces to

                                                   2v̄ − δ1 − δ0
                              lim H(λ) =                          lim L(λ),                        (36)
                              λ→∞                      δ1 − v̄   λ→∞


where limλ→∞ H(λ) is the fraction of meetings with middlemen and limλ→∞ L(λ) is the
fraction of misaligned traders. Since we have already proved that v̄ > δ1 +δ 2
                                                                               0
                                                                                 and there are
misaligned traders in equilibrium, the result follows immediately.
    To prove the Pareto tail, differentiate equation (33) with respect to λ and evaluate at
λ → ∞ to get
                                             24(2v̄ − δ1 − δ0 )γΛ
                    lim λ3 dG(λ) =                                         .
                   λ→∞              ∆ − (2v̄ − δ1 − δ0 )(1 − 2 limλ→∞ mλ )
Using the steady state expressions, we find that
                                              R∞
                                              λ0
                                              Λ0
                                                  mλ0 dG(λ0 )                            δ1 − v̄
                  lim mλ =         R ∞ λ0
                                               0 ) + 2 ∞ λ0 m 0 dG(λ0 )
                                                       R                             =             (37)
                  λ→∞         1−    0 Λ
                                          dG(λ           0 Λ  λ                          δ1 − δ0

where the second equation simplifies the first using equation (36). Substituting this into the
tail parameter expression, we get

                                                                 24γΛ
                              lim λ3 dG(λ) =               δ1 −δ0          1 −δ0
                                                                                 .                 (38)
                              λ→∞
                                                        2v̄−δ1 −δ0
                                                                  − 2v̄−δ
                                                                       δ1 −δ0


Note that this is positive since traders’ value is less than the first best, v̄ < δ1 . This implies
that in the right tail, the G distribution is well-approximated by the Pareto distribution

                                                             12γΛ
                              G(λ) = 1 −              δ1 −δ0    2v̄−δ1 −δ0
                                                                           λ−2 .                   (39)
                                                   2v̄−δ1 −δ0
                                                              − δ1 −δ0



                                                        44
This completes the proof.

Proof of Proposition 6. Consider a λ-agent. When misaligned, which happens a fraction
mλ of the time, she trades with any faster trader with opposite asset holding, as well as slower
misaligned traders with opposite asset holding. So her trading probability conditional on a
meeting is 12 (H(λ) + L(λ)). When she is well aligned, a fraction (1 − mλ ) of the time, then
she takes on misalignment from slower traders with opposite asset holding, so she trades
with probability 12 L(λ). Combining this, the probability that a type λ trader actually trades
in a meeting is
                                        1
                                  pλ = (mλ H(λ) + L(λ)).
                                        2
Replace mλ = −L (λ)/H (λ) and eliminate L0 (λ) and H 0 (λ) using equation (13):
                    0     0



                                γ(H(λ) + 2L(λ)) + λL(λ)(H(λ) + L(λ)
                         pλ =                                       .
                                        4γ + λ(H(λ) + 2L(λ)

We are interested in the tail behavior of the trading rate λpλ .
    First observe that λpλ is increasing. To show this, differentiate wtih respect to λ and
replace L0 (λ) and H 0 (λ) using equation (13). The result follows algebraically.
    Now let F denote the cumulative distribution of trading rates. Since λpλ is increasing,
F (λpλ ) = G(λ) for all λ. Differentiating this gives

                                                     dG(λ)
                                      dF (λpλ ) =             .
                                                    λp0λ + pλ

Equation (39) shows us the behavior of dG(λ) in the tail, a Pareto. To see the behavior
of the denominator, again differentiate λpλ with respect to λ and replace L0 (λ) and H 0 (λ)
using equation (13). This time take the limit as λ converges to infinity:
                                                                                   2
                    3                    3                  limλ→∞ L(λ)(v̄ − δ0 )
               (λpλ ) lim dF (λpλ ) = λ lim dG(λ)                                        .
                        λ→∞                  λ→∞                  δ1 − δ0

Since λ3 limλ→∞ dG(λ) > 0 by equation (38), this is positive and hence the tail of F is Pareto
with tail parameter 2.

Proof of Proposition 7. For a fixed value of c ∈ (0, 16∆/γ), equilibrium is characterized
by a lower bound λ and the differential equations (13) as well as the requirement that
equilibrium costs are in fact c. We get this last condition by evaluating equation (30) at




                                                   45
λ = λ and evaluating s0λ using equations (9) and (10):
                                         R                          
                                            ∞           8γ
                          c       4γ exp − λ     λ(8γ+λH(λ)+2λL(λ))
                                                                    dλ
                            =                                            .               (40)
                          ∆                    λ(8γ + λ)

We are interested in evaluating these equations when c → 0, but there are two difficulties
with that limit. First, we prove below that λ → ∞, which makes the limiting system of
equations problematic. Second, we find that L(λ) → 0 in the same limit. We propose
a change in variables to deal with both of these issues. Let ρ ≡ λ/λ denote a worker’s
contact rate relative to the lower bound. Let h(ρ) ≡ H(λ) and `(ρ) ≡ L(λ)λ/γ. Rewrite
equations (13) and (40) in terms of ` and h:

                 4(2h(ρ) + ρh0 (ρ)) = ρ h(ρ)`0 (ρ) − `(ρ)h0 (ρ) − h(ρ)`(ρ),
                                                               

                4γ + λρh(ρ) + 2γ`(ρ) (ρ`0 (ρ) − `(ρ)) = −λρ2 (2 + `(ρ))h0 (ρ),
                                     
                                      R                         
                                           ∞         8γ
                         c    4γ exp − 1 ρ(8γ+ρλh(ρ)+2γ`(ρ)) dρ
                           =                                       .
                        ∆                  λ(8γ + λ)

The first two equations, together with the terminal condition h(1) = 1 and `(1) = 0, deter-
mine h and ` for any λ. If λ < ∞, they imply that the right hand side of the third equation is
positive and hence this is inconsistent with the third equation. On the other hand, we prove
below that the first two equations are well-behaved (and indeed solve them) when λ = ∞.
In this limit, the third equation holds when c = 0. Therefore this must describe the limiting
equilibrium with c = 0.
    We now turn to the characterization of these equations when λ → ∞. Solve the first two
equations for h0 and `0 in this limit:

                                8 + 7`(ρ) + `(ρ)2     h0 (ρ)       −4
                     `0 (ρ) =                     and        =             ,             (41)
                                   ρ(3 + `(ρ))        h(ρ)     ρ(3 + `(ρ))

with terminal conditions are `(1) = 0 and h(1) = 1. An equilibrium allocation in the limiting
economy is characterized by the solution to these to ordinary differential equations.
    The differential equation for ` is autonomous and so we start with that one. To solve it,
define the inverse functions f (`(ρ)) = ρ and rewrite the differential equation as

                                        f 0 (`)     (3 + `)
                                                =
                                        f (`)     8 + 7` + `2




                                                 46
with terminal condition f (0) = 1. The solution is

                                                        √     ! √1
                                               16 + (7 − 17)` 2 17
                           q
                    f (`) = 1 + 78 ` + 18 `2            √          = ρ.                   (42)
                                               16 + (7 + 17)`

This is a continuous, increasing mapping from positive reals to positive reals. That implies
that the mapping is invertible, i.e. for any `(ρ) ≥ 0, there is a unique value of ρ ≥ 1 that is
consistent with the equation of interest. This implies `(ρ) is a well-behaved function.
   Next turn to the equation for h(ρ). To solve it, define η(`) ≡ h(f (`)). Using the same
inverse function and its derivative, the solution is
                                         Z `
                                                  4f 0 (x)
                                                                  
                             η(`) = exp −                     dx
                                             0 f (x)(3 + x)
                                         Z `                       
                                                     4            0
                                  = exp −              0    02
                                                               d`
                                             0 8 + 7` + `
                                               √         !4/√17
                                      16 + (7 − 17)`
                                  =            √                 ,                        (43)
                                      16 + (7 + 17)`

where the second equation replaces f using equation (42) and the third calculates the integral.
Now since `(ρ) increases without bound when ρ is large, we get
                                                               √
                                                    √ !4/          17
                                                 7 − 17
                      lim h(ρ) = lim η(`) =         √                   = 0.269.
                     ρ→∞          `→∞            7 + 17

This is the probability of contacting a middleman in the zero cost limit, the first result in
the Proposition.
   We turn next to volume, which we measure as the rate that a trader buys the asset (and
hence also the rate that a trader sells the asset). In an economy with finite λ, we write this
as               Z ∞
                      λ                             ΛH(∞)L(∞) ΛH(∞)2 m2∞
            V≡          (L(λ) + H(λ)mλ )dG(λ) +                  +               ,        (44)
                  λ   4                                   4               4
where L(∞) ≡ limλ→∞ L(λ), H(∞) ≡ limλ→∞ H(λ), and m∞ is the misalignment rate of
middlemen. The integrand in the first term is the rate that a finite trader with contact rate
λ purchases the asset. This happens when the trader does not hold the asset (probability
1
2
  ) and meets someone (at rate λ), and either (i) the other trader is slower, hold the asset,
but doesn’t want it (probability 12 L(λ)) or (ii) the other trader is faster (probability H(λ)
and the type-λ trader wants the asset (probability m∞ ). Integrating this over the contact
rate distribution gives the rate that finite traders buy the asset. The second term is the

                                               47
rate that middlemen buy the asset from finite traders. Middlemen make contacts at rate
ΛH(∞). With probability 12 L(∞), the contact is with a finite trader who wants to sell the
asst, and then with probability 12 the middleman is able to buy it. The final term is the
rate that middlemen buy the asset from other middlemen. Again, middlemen make contacts
at rate ΛH(∞), with probability 12 m∞ , the middleman wants to buy the asset, and with
probability 12 H(∞)m∞ , she meets another middleman who wants to sell the asset. Summing
these terms gives us trading volume.
    We cannot directly evaluate this expression in the limiting economy because L, H, and
                                           ˆ ≡ L(ρλ)λ, and let Ψ(ρ) ≡ G(ρλ) denote the
G are all poorly behaved. Instead, define `(ρ)
cumulative distribution of relative contact rates. Noting that mλ = −L0 (λ)/H 0 (λ), we can
rewrite volume as

           γ
               Z     ∞   
                                 ρ`0 (ρ) − `(ρ)
                                                                   ˆ
                                                               Λh(∞)`(∞)   Λh(∞)2 m2∞
        V=                `(ρ) −                h(ρ)   dΨ(ρ) +           +            ,        (45)
           4     1                    ρh0 (ρ)                     4λ           4

where the terms have the exact same interpretation as equation (44). We compute the value
of each term in turn.
    Start with the integral. To measure this, we first need to characterize the contact rate
distribution G in the limiting economy. And as a preliminary step towards that goal, we find
the mean contact rate relative to the lower bound Λ/λ. For any finite λ, H 0 (λ) = −λdG(λ)/Λ
and also H 0 (λ) = h0 (ρ)/λ. Combining these gives

                                             λ           h0 (ρ)
                                               dΨ(ρ) = −        dρ,                            (46)
                                             Λ              ρ
        R∞
Since   1
             dΨ(ρ) = 1, we can integrate both sides of this to get

                                                                           √ ! √7
                   Λ          1             1         1                 7 + 17 2 17
                     = − R ∞ h0 (ρ) = − R ∞ η0 (`) = √                     √        ≈ 2.23,    (47)
                   λ               dρ             d`   2                7 − 17
                          1    ρ         0 f (`)


where again the second equation is a transformation of variables and the third calculates the
integral using the functional forms for f and η in equations (42) and (43).
    Turn next to the probability distribution over `, a monotonic transformation of the
probability distribution over ρ. Its density Γ0 (`) satisfies

                                                            Λh0 (f (`))f 0 (`)    Λη 0 (`)
                           Γ0 (`) = Ψ0 (f (`))f 0 (`) = −                      =−          ,
                                                                 λf (`)           λf (`)

where the first equation is the definition of Γ, the second uses equation (46), and the third


                                                        48
uses the definition of η. Again using the functional forms for f and η in equations (42)
and (43), we can integrate this to get

                                                                  √ ! √7
                                           `              2` + 7 + 17 2 17
                               Γ(`) = √                           √        .              (48)
                                       8 + 7` + `2        2` + 7 − 17

The fraction of traders with a contact rate less than ρ is then Γ(`(ρ)).
   We return now to the first term in the trading rate (45), the rate that a finite trader
buys the asset from either another finite trader or a middleman:
           ∞                                                Z ∞
                          ρ`0 (ρ) − `(ρ)
       Z                                                           
   γ                                                  1
                   `(ρ) −                h(ρ) dΨ(ρ) =    1+     `dΓ(`) γ
   4   1                       ρh0 (ρ)                2      1
                                                               √ ! 2√717
                                                                           
                                                        √   7 + 17
                                                    = 2       √         − 3 γ ≈ 1.46γ   (49)
                                                            7 − 17

The first equation simplifies the expressions with the differential equations (41) and changes
variables to write everything in terms of `. The second equation solves the integral using
the known functional form for Γ in equation (48).
   Next turn tot the rate that middlemen buy from finite traders. This uses the steady state
misalignment rate equation (13b), rewritten in terms of h and `:  ˆ

                                           ˆ      `ˆ (ρ) = −λ(2γ + ρ`(ρ))h
                                                                    ˆ
                                                 0                      0
                           4γ + ρ λh(ρ) + 2`(ρ)                             (ρ),

                  ˆ = 0. Take the limit as λ → ∞ and solve the differential equation to
with h(1) = 1 and `(1)
get
                             ˆ
                       Λh(ρ)`(ρ)     −γΛ ρ h0 (ρ0 ) 0
                                          Z
                                                        γ
                                  =             0
                                                   dρ → ,                          (50)
                           4λ         2λ 1     ρ        2
where the limiting result follows immediately from equation (47). This proves, middlemen
buy from finite traders at rate 12 γ.
   The same argument implies middlemen sell to finite traders at rate 21 γ and an immediate
corollary is that finite traders buy from middlemen at the same rate 12 γ. Subtracting this
from equation (49), we get that finite traders buy from finite traders at rate

                                           √ ! 2√717
                                                       
                                 √      7 + 17        7
                                 2        √         −  γ ≈ 0.96γ,
                                        7 − 17        2


indeed a number between 12 γ and γ.


                                                     49
    The last step of the proof is finding the rate that middlemen trade with other middlemen.
To find this, we need to compute the misalignment rate of middlemen. We start in the case
where λ is finite. Middlemen meet other traders at an infinite rate, and so the key is to
compute the fraction of those meetings that switch their alignment status in either direction.
First, if they are misaligned, they trade in meetings where the other trader is a misaligned,
finite speed trader (probability L(∞)) or in meetings where the other trader is a misaligned
middleman (probability H(∞)m∞ ). If they are well-aligned, they trade only in meetings
where the other trader is a misaligned, finite speed trader. Thus m∞ solves

                               (L(∞) + H(∞)m∞ ) m∞ = L(∞)(1 − m∞ ).

Middlemen’s own preference shocks do not appear in this expression because middlemen have
infinitely more trading opportunities than preference shocks. Again rewrite this in terms of
h and ˆl to get                            !
                          ˆ
                          `(∞)                       ˆ
                                                     `(∞)
                               + h(∞)m∞ m∞ =              (1 − m∞ ).
                            λ                          λ

Multiplying both sides of the equation by Λh(∞)/4, the previous equation implies

                                ˆ
                           Λh(∞)`(∞)   Λh(∞)2 m2∞        ˆ
                                                    Λh(∞)`(∞)
                                     −            =           m∞ .
                              4λ           4           2λ
                                                                                     ˆ
Now in the limit as λ converges to infinity, equation (50) showed that Λh(ρ)
                                                                           2λ
                                                                             `(ρ)
                                                                                  → γ, while
m∞ → 0. Thus the right hand side converges to 0 and so must the left hand side. Since
            ˆ                              2 2
again Λh(∞)
         4λ
           `(∞)
                → 21 γ, this implies Λh(∞)4 m∞ has the same limit. Thus middlemen buy from
middlemen at rate 12 γ. This completes the proof.

Proof of Proposition 8. We start by solving the problem of maximizing (14) subject
to the constraint (15) for all λ. We do this by writing the Lagrangian, placing a multiplier
                                                                     R∞
Sλ dG(λ) on constraint (15), a multiplier θ0 on the constraint that 0 dG(λ) = 1, and a
multiplier θ1 on the constraint that E(1) = 1. The Lagrangian is
         Z    ∞                                     Z        ∞        
  L=∆             (1 − mλ )dG(λ) − ΛE(c(λ)) + θ0 1 −              dG(λ) + θ1 (1 − E(1))
          0                                               0
                           Z   ∞                                         
                                             λ  λ0 ,0      λ0 ,1
                       +           Sλ   γ + E 1λ,0 mλ0 + 1λ,0 (1 − mλ0 )     mλ
                           0                 2
                                                                                  !
                                           λ  λ0 ,0      0
                                                                         
                                    − γ + E 1λ,1 mλ0 + 1λλ,1,1 (1 − mλ0 ) (1 − mλ ) dG(λ). (51)
                                           2


                                                   50
Take the first order condition with respect to mλ . Suppressing the multiplicative constant
dG(λ), this is

            λ  λ0 ,0                0
  ∆ = 2γSλ + E 1λ,0 (Sλ + Sλ0 ) + 1λλ,1,0 (Sλ − Sλ0 ) mλ0
                                                       
            2                                                                                 
                                            λ0 ,1                  0
                                                  (Sλ − Sλ0 ) + 1λλ,1,1 (Sλ + Sλ0 ) (1 − mλ0 ) (52)
                                                                                   
                                    + 1λ,0

                                                                            0   0
Next take the first order conditions for the indicator functions 1λλ,a,a . In doing this, we
                                               0 0
implicitly use the unstated constraints 0 ≤ 1λλ,a,a = 1λ,a
                                                       λ0 ,a0 ≤ 1. We get

                                                                            
                                     0
                                            1                       0
                                                                             1
                 Sλ + Sλ0 ≷ 0 ⇒ 1λλ,0,0 =        ,    Sλ ≷ Sλ0 ⇒ 1λλ,0,1   =        ,
                                            0                               0
                                                                            
                                     0
                                            1                       0
                                                                             1
                 Sλ + Sλ0 ≶ 0 ⇒ 1λλ,1,1   =      ,    Sλ0 ≷ Sλ ⇒ 1λλ,1,0   =        .
                                            0                               0

Using this, rewrite the first order condition (52) as

            λ 
  ∆ = 2γSλ + E (Sλ + Sλ0 )+ − (Sλ0 − Sλ )+ mλ0
                                          
            2                                                                   
                                       + (Sλ − Sλ0 )+ − (−Sλ − Sλ0 )+ (1 − mλ0 ) (53)
                                                                     


This is identical to equation (8) for the surplus in the decentralized economy, except that
the terms multiplying λ are twice as large for the planner. The proof of Proposition 1
implies the surplus function is uniquely defined by this equation and moreover is decreasing
and nonnegative. Optimal trading patterns (the planner’s version of Proposition 1) follow
immediately.
   Next, using monotonicity of S, rewrite equation (53) as
                                                                              
               4γ + λE 1 − Iλ0 ≤λ (1 − 2mλ0 ) Sλ = 2∆ + λE Iλ0 >λ Sλ0 (1 − 2mλ0 )             (54)

Differentiate with respect to λ to get
                                
             4γ + λ(H(λ) + 2L(λ)) Sλ0 + (H(λ) + 2L(λ))Sλ = E Iλ0 >λ Sλ0 (1 − 2mλ0 )
                                                                                   
                                                                                              (55)




                                                 51
Replace the right hand side using equation (54) and simplify to get
                                                                               
                                       4γSλ − 2∆                           ∆
                      Sλ0   =                      = Φλ             Sλ −          ,
                             λ 4γ + λ(H(λ) + 2L(λ))                        2γ


where Φλ is given in equation (17). The general solution to this differential equation is

                                              ∆      Rλ       0
                                       Sλ =      − Ke λ Φλ0 dλ
                                              2γ

for fixed λ and some constant of integration K. Use the fact that limλ→∞ Sλ = 0 to pin
down the constant of integration, equation (16).
    Now return to the Lagrangian (51). The first order condition with respect to dG(λ)
implies dG(λ) > 0 only if λ maximizes

                                 λ
 ∆(1 − mλ ) − λc(λ) − θ0 − θ1
                                Λ
 λ  λ0 ,0               0                           0                          0
                                                                                                            
+ E 1λ,0 mλ0 Sλ0 mλ + 1λλ,1,0 mλ0 Sλ0 (1 − mλ ) − 1λλ,0,1 Sλ0 (1 − mλ0 )mλ − 1λλ,1,1 Sλ0 (1 − mλ0 )(1 − mλ ) .
 2

Using the optimal trading patterns, this reduces to

                                   λ
  ∆(1 − mλ ) − λc(λ) − θ0 − θ1
                                   Λ
                λ                 λ                              λ
               + mλ E (mλ0 Sλ0 ) + (1 − mλ )E (Iλ0 <λ mλ0 Sλ0 ) − mλ E (Iλ0 >λ Sλ0 (1 − mλ0 )) .
                2                 2                              2

Multiply equation (54) by 12 mλ and add to the previous expression. dG(λ) > 0 only if λ
maximizes
                                                         
        λ                         λ                                             λ
  ∆ + E (Iλ0 <λ mλ0 Sλ0 ) − 2γ + E 1 − Iλ0 <λ (1 − 2mλ0 ) Sλ mλ − λc(λ) − θ0 − θ1 .
        2                         2                                              Λ

Using equation (15) under the optimal trading pattern and dropping irrelevant constants,
this simplifies to
                                                                           
                                   λ                                     λ
     dG(λ) > 0 ⇒ λ ∈ arg max −γSλ + E Iλ0 <λ mλ0 (Sλ0 − Sλ ) − λc(λ) − θ1                          (56)
                                   2                                      Λ

   Next, consider the first order condition with respect to Λ, which appears implicitly inside




                                                   52
each of the expectations operators. Using the efficient trading patterns, this gives
                                                                                             !
          Z    ∞                                                                
                             λ                                    λ
   θ1 =            Sλ          E (mλ0 + Iλ0 >λ (1 − mλ0 )) mλ −     E (Iλ0 <λ mλ0 ) (1 − mλ ) dG(λ)
           0                 2                                    2
              Z    ∞
      =γ               Sλ (1 − 2mλ )dG(λ)                                                         (57)
               0


where the second line again uses equation (15) under the efficient trading pattern. Substitute
this into equation (56) to get that dG(λ) > 0 only if λ maximizes the expression in (18).
    Finally, consider the behavior of (18) for large λ. If the inequality (19) is violated, the
planner would set λ unboundedly large for everyone. This incurs infinite costs and so cannot
be optimal. If the inequality (19) is slack, large values of λ would be inconsistent with
                                   R∞
condition (18), which implies Λ = 0 λdG(λ). To have middlemen, the inequality (19) must
be binding.
    Once we have established the close link between the mathematical structures of the
equilibrium and optimal allocations and surplus functions, it is straightforward to replicate
the proofs of Propositions 2–6. Here we present one key piece of the result, the analog
to equation (13a), which is critical for characterizing the optimal allocation when the cost
function is linear.
    For any value of λ in the support of G, equation (56) states that the planner marginal
values must be the same, some V̄ :

                                        λ                                    λ
                             V̄ = −γSλ + E Iλ0 <λ mλ0 (Sλ0 − Sλ ) − λc(λ) − θ1 ,                  (58)
                                        2                                     Λ

where we simplify the expression slightly using the results from the planner’s analog of to
Proposition 1. This implies the first order condition
                           
                       λ                1                                            θ1
              0 = − γ + L(λ) Sλ0 +        E Iλ0 <λ (Sλ0 − Sλ )m0λ − c(λ) − λc0 (λ) −
                                                                 
                                                                                                  (59)
                       2                2                                            Λ
                           
                       λ                V̄ + γSλ
                = − γ + L(λ) Sλ0 +                 − λc0 (λ)
                       2                     λ
                                    R∞                           R∞     0
                                             0
                   ∆ (2γ + λL(λ)) e− λ Φλ0 dλ    V̄ + ∆2 1 − e− λ Φλ0 dλ
                  =                        +                             − λc0 (λ)
                   λ 4γ + λ(H(λ) + 2L(λ))                     λ
                                          R∞      0        δ1 −δ0
                   −(δ1 − δ0 )H(λ)e− λ Φλ0 dλ  V̄ +           2
                                                                 − λ2 c0 (λ)
                  =                        +
                   2 4γ + λ(H(λ) + 2L(λ))                       λ


where the second line simplifies the first using equation (58), the third line replaces Sλ and


                                                      53
its derivative using equation (16) and replaces Φλ using equation (17), and the fourth line
groups terms and recognizes that ∆ = δ1 − δ0 . Rewrite this as
                                                  R∞     0
                                   λH(λ)e− λ Φλ0 dλ     2λ2 c0 (λ)   2V̄ + δ1 − δ0
                                                      +            =                                   (60)
                                 4γ + λ(H(λ) + 2L(λ))    δ1 − δ0        δ1 − δ0

for all λ in the support of G(λ). Differentiating this expression and replacing Φλ gives us an
second equation relating H 0 (λ) and L0 (λ):
       R∞
            Φλ0 dλ0
 2e−                    λ(2γ + λL(λ))H 0 (λ) + H(λ)(4γ − λ2 L0 (λ))
                                                                   
       λ                                                              2λ
                                                 2                  + (2c0 (λ) + λc00 (λ)) = 0. (61)
                           4γ + λ(H(λ) + 2L(λ))                       ∆

For the case of linear cost, this reduces to equation (20).
   Next, we consider the limit of the optimal allocation as c → 0, i.e. the planner’s analog to
Proposition 7. We start with some preliminaries. First, with a linear cost function, c(λ) = c,
the Lagrangian (51) can be simplified as
            Z     ∞                               Z               ∞           
  L=∆                 (1 − mλ )dG(λ) − cΛ + θ0 1 −                     dG(λ)
              0                                                0
                                  Z    ∞                                            
                                                     λ  λ0 ,0        λ0 ,1
                             +             Sλ     γ + E 1λ,0 mλ0 + 1λ,0 (1 − mλ0 )        mλ
                                   0                 2
                                                                                                 !
                                                       λ      0            0
                                                                                         
                                                 − γ + E 1λλ,1,0 mλ0 + 1λλ,1,1 (1 − mλ0 ) (1 − mλ ) dG(λ).
                                                       2

The first order condition with respect to Λ implies
                                                                                                 !
             Z      ∞                                                               
     1                           λ                                    λ
  c=                    Sλ         E (mλ0 + Iλ0 >λ (1 − mλ0 )) mλ −     E (Iλ0 <λ mλ0 ) (1 − mλ ) dG(λ)
     Λ          0                2                                    2
             Z      ∞
      γ
    =                   Sλ (1 − 2mλ )dG(λ),                                                            (62)
      Λ         0


where the second line uses equation (15) under the efficient trading pattern. Comparing this
with equation (57), we get
                                          θ1 = Λc                                      (63)

Second, evaluate equation (59) at λ = λ, eliminate Sλ0 using equations (16) and (17), and θ1
using equation (63). This gives
                                                       R                          
                                                          ∞          4γ
                                           c     γ exp − λ    λ(4γ+λH(λ)+2λL(λ))
                                                                                 dλ
                                             =                                         .               (64)
                                           ∆                 λ(4γ + λ)

                                                              54
The functions H and L satisfy the differential equations (13b) and (20) with boundary
conditions H(λ) = 1 and L(λ) = 0.
    As in equilibrium, we can prove that the optimal allocation must have λ → ∞ as c → 0.
To handle this, we do the same transformation of variables as in equilibrium, letting h(ρ) ≡
H(λ) and `(ρ) ≡ L(λ)λ/γ where ρ ≡ λ/λ. Rewrite equations (13b), (20) and (64) in terms
of ` and h:

                4γ + λρh(ρ) + 2γ`(ρ) (ρ`0 (ρ) − `(ρ)) = −λρ2 (2 + `(ρ))h0 (ρ),
                                     

                 2(2h(ρ) + ρh0 (ρ)) = ρ h(ρ)`0 (ρ) − `(ρ)h0 (ρ) − h(ρ)`(ρ),
                                                               
                                      R                         
                                          ∞          4γ
                         c     γ exp  −  1 ρ(4γ+ρλh(ρ)+2γ`(ρ))
                                                               dρ
                            =                                      .
                         ∆                 λ(4γ + λ)

with h(1) = 1 and `(1) = 0. Next, solve for `0 (ρ) and h0 (ρ) in the limit with λ → ∞:

                                    2 + `(ρ)                −2h(ρ)
                         `0 (ρ) =            and h0 (ρ) =             .
                                       ρ                  ρ(2 + `(ρ))

These differential equations can easily be solved in closed form:

                                                                    −1 −1
                             `(ρ) = 2(ρ − 1) and h(ρ) = eρ                  .            (65)

Using this, we can calculate the fraction of middlemen as

                                     lim h(ρ) = e−1 ≈ 0.368.
                                    ρ→∞


This is the optimal allocation analog of one of the key results in Proposition 7.
   Next, let Ψ(ρ) ≡ G(ρλ) denote the cumulative distribution of relative contact rates.
                         R∞
Using equation (46) and 1 dΨ(ρ) = 1, this implies

                                                ∞
                                                    h0 (ρ)
                                           Z
                                    λ
                                      =−                   dρ = e−1 ,
                                    Λ       1          ρ

so Λ/λ = e ≈ 2.72 in the economy without search frictions. Then substitute this back into
equation (46) gives
                                       −1                    −1
                        Ψ0 (ρ) = ρ−3 eρ ⇒ Ψ(ρ) = (1 − ρ−1 )eρ ,                      (66)

where the result follows by integrating the density function. This is an explicit solution for
the distribution of relative contact rates in the limiting economy.
   Finally, we turn to volume. We start with the rate that finite traders buy, the first term


                                                    55
in equation (45). We use the transformation in terms of h, `, and Ψ to get
        ∞
                       ρ`0 (ρ) − `(ρ)              γ ∞
    Z                                             Z
γ                                                                    −1
                `(ρ) −        0
                                      h(ρ) dΨ(ρ) =     (2ρ − 1)ρ−3 eρ dρ = (e − 3/2)γ ≈ 1.22γ.
4   1                       ρh (ρ)                 2 1

This compares to equation (49) in equilibrium. Finally, the buying rate of middlemen is
unchanged. This proves that finite traders buy from finite traders at rate (e − 2)γ ≈ 0.72γ ∈
( 21 γ, γ), they buy from middlemen at rate 12 γ, and middlemen buy from finite traders at rate
1
2
   γ, and sell to middlemen at rate 12 γ.

Proof of Proposition 9. First, the definition of τ̄ and equation (57) implies τ̄ = θ1 /Λ.
Then equation (63) implies τ̄ = c.
    We next show that the expected subsidy likewise equals c. Denote the expected subsidy
for an agent with contact rate λ by τ + (λ). This is given by
                          
            +   1                                                                             
        τ (λ) =               (1 − mλ ) E Iλ0 <λ (Sλ0 − Sλ ) mλ0 + mλ E Iλ0 <λ (Sλ0 + Sλ ) mλ0
                4
                                                                                                    
                                                                                                  
                              + mλ E Iλ0 >λ (Sλ − Sλ0 ) (1 − mλ0 ) + mλ E Iλ0 >λ (Sλ + Sλ0 ) mλ0        .

Rearrange the second line to get
                              
                 +  1                                                                             
            τ (λ) =               (1 − mλ ) E Iλ0 <λ (Sλ0 − Sλ ) mλ0 + mλ E Iλ0 <λ (Sλ0 − Sλ ) mλ0
                    4
                                                                                              
                                                                                            
                                  + 2mλ Sλ L(λ) + mλ Sλ H(λ) − mλ E Iλ0 >λ Sλ0 (1 − 2mλ0 ) .


Differentiating the expression in (56) with respect to λ, we get that
                                                                       
                                                             θ1    λ
                          E (Iλ0 <λ (Sλ0 − Sλ ) mλ0 ) = 2 c + + γ + L(λ) Sλ0
                                                             Λ     2

It follows that
                                        
                             1         θ1
                      +
                     τ (λ) = 2 c +          + (2γ + λL(λ)) Sλ0 + mλ Sλ (2L(λ) + H(λ))
                             4         Λ
                                                                                   
                                                             0
                             − mλ 4γ + λ(H(λ) + 2L(λ)) Sλ − mλ Sλ (H(λ) + 2L(λ))
                                      
                             1      θ1      1 0                                   
                           =     c+      + Sλ (1 − 2mλ ) (2γ + λL(λ)) − λmλ H(λ)
                             2      Λ       4
                                      
                             1      θ1
                           =     c+      =c
                             2      Λ


                                                          56
where the first equality uses the expression for E (Iλ0 <λ (Sλ0 − Sλ ) mλ0 ) and equation (55),
the second regroups terms, and the third uses the inflow-outflow equation (12). The final
equality follows from equating equations (57) and (62). This proves the result.

Proof of Proposition 10.         We begin with equilibrium. Condition 3b in definition 2
immediately implies that there are no middlemen whenever their per-meeting cost is strictly
positive. Solve equation (22) to get

                                         4∆ − λE s0λ m0λ
                                                         
                                    sλ =                   ,                               (67)
                                          8γ + λE(m0λ )

a decreasing and convex function. Condition 3a then implies that if λc(λ) is weakly concave,
all traders choose the same value of λ = Λ. That is, E s0λ m0λ = sΛ mΛ and E(m0λ ) = mΛ .
                                                               

    To find the equilibrium contact rate, we solve explicitly for sλ . First, simplify (67) when
λ = Λ:
                                                2∆
                                      sΛ =             .
                                            4γ + ΛmΛ
Then rewrite the expression for a general value of λ:
                                                          
                                    ∆ 16γ + 4ΛmΛ − 2λmΛ
                               sλ =                         .                              (68)
                                    (4γ + ΛmΛ )(8γ + λmΛ )

Finally, using condition 3a, it follows that if λc(λ) is weakly convex, the equilibrium choice
of Λ solves
                                    4γ∆mΛ
                                                    = c(Λ) + Λc0 (Λ).                     (69)
                          (4γ + ΛmΛ )(8γ + ΛmΛ )
   We next turn to the planner’s problem. As in equilibrium, it is straightforward to show
that only meetings between two misaligned traders result in trade. Replicating the proof of
Proposition 8, we get that the optimal surplus function satisfies
                                                                   
                          λ                       2∆ − λE Sλ0 mλ0
                ∆ = 2γSλ + E (Sλ + Sλ0 )mλ0 ⇒ Sλ =                   ,
                          2                         4γ + λE(mλ0 )

decreasing and convex. We also obtain that the planner has dG(λ) > 0 only if λ maximizes

                                      γ ∞
                                      Z                       
                                                             0
                      −γSλ − λ c(λ) +     Sλ0 (1 − 2mλ0 )dG(λ ) ,
                                      Λ 0

analogous to condition (18). Convexity of S implies that if the cost function is convex, the
planner places all weight on a single value of λ:



                                              57
   Replicating the arguments for the equilibrium, we then use this to prove that
                                                         
                                     ∆ 4γ + 2ΛmΛ − λmΛ
                                Sλ =                        .                              (70)
                                     (4γ + λmΛ )(2γ + ΛmΛ )

It follows that the optimal choice of Λ satisfies the first order condition

                                 γ∆mΛ
                                                 = c(Λ) + Λc0 (Λ),                         (71)
                          (2γ + ΛmΛ )(4γ + ΛmΛ )

where we simplify the expression slightly using the steady state relationship (23).
   To prove that the equilibrium contact rate is inefficiently high, use the steady state
misalignment rate to eliminate Λ from the left hand side of equations (69) and (71). This
gives, respectively,

                                    ∆m3Λ
                                             = c(Λ) + Λc0 (Λ)
                                 γ(1 + 2mΛ )
                                    ∆m3Λ
                                             = c(Λ) + Λc0 (Λ)
                                 4γ(1 − mΛ )

For any Λ > 0, 0 ≤ mΛ < 1/2 and therefore 1+2mΛ < 4(1−mλ ) It follows that the left hand
side of equation (69) is always bigger than the left hand side of equation (71) at a fixed value
of Λ > 0. Since both left hand sides are increasing in mΛ , it follows that the equilibrium
misalignment rate must be weakly lower than the optimum, strictly so if the equilibrium rate
is less than 1/2 and the cost function is continuously differentiable. Again using the steady
state misalignment equation, the same condition ensures that the equilibrium contact rate
weakly exceeds the optimum whenever the rate is positive.




                                              58
