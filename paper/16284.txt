                                 NBER WORKING PAPER SERIES




      A GRAPH THEORETIC APPROACH TO MARKETS FOR INDIVISIBLE GOODS

                                             Andrew Caplin
                                             John V. Leahy

                                         Working Paper 16284
                                 http://www.nber.org/papers/w16284


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                      August 2010




We thank Mamoru Kaneko, John Leahy Sr., Jeffrey Mensch, Victor Norman, Ennio Stacchetti, and
Ivan Werning for helpful comments. Leahy thanks the NSF for financial support. The views expressed
herein are those of the authors and do not necessarily reflect the views of the National Bureau of Economic
Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2010 by Andrew Caplin and John V. Leahy. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
A Graph Theoretic Approach to Markets for Indivisible Goods
Andrew Caplin and John V. Leahy
NBER Working Paper No. 16284
August 2010
JEL No. C63,D40,E1,R31

                                            ABSTRACT

Many important markets, such as the housing market, involve goods that are both indivisible and of
budgetary significance. We introduce new graph theoretic techniques ideally suited to analyzing such
markets. In this paper and its companion (Caplin and Leahy [2010]), we use these techniques to fully
characterize the comparative static properties of these markets and to identify algorithms for computing
equilibria.


Andrew Caplin
Department of Economics
New York University
19 W. 4th Street, 6th Floor
New York, NY 10012
and NBER
andrew.caplin@nyu.edu

John V. Leahy
Department of Economics
New York University
19 W. 4th Street, 6th Floor
New York, NY 10012
and NBER
john.leahy@nyu.edu
 A Graph Theoretic Approach to Markets for Indivisible
                       Goods
                                Andrew Caplin and John Leahy
                              New York University and N.B.E.R.

                                              August 2010


                                                 Abstract
          Many important markets, such as the housing market, involve goods that are both
      indivisible and of budgetary signi…cance. We introduce new graph theoretic techniques
      ideally suited to analyzing such markets. In this paper and its companion (Caplin and Leahy
      [2010]), we use these techniques to fully characterize the comparative static properties of
      these markets and to identify algorithms for computing equilibria.


1. Introduction

While many important goods are indivisible, technical barriers continue to limit our understand-
ing of markets for trading these goods. The best-studied cases are so-called allocation markets,
in which each agent can consume at most one unit of one of the available indivisible goods. Shap-
ley and Shubik (1972) provided a complete characterization of equilibria in such markets when
utility is transferable. Yet understanding of the corresponding markets with non-transferable
utility (NTU), a necessary feature when the goods in question are of budgetary signi…cance, has
advanced more slowly. Kaneko (1982) was …rst to establish conditions for existence of equilib-
ria, while Demange and Gale (1985) showed under much the same conditions that the set of
equilibrium prices is a lattice with maximal and minimal elements.1
     We thank Mamoru Kaneko, John Leahy Sr., Je¤rey Mensch, Victor Norman, Ennio Stacchetti, and Ivan
Werning for helpful comments. Leahy thanks the NSF for …nancial support.
   1
     They also established that the minimum price equilibrium cannot be manipulated by buyers, as well as some
basic comparative static properties of the minimum price equilibrium (e.g. minimum equilibrium prices rise
when more buyers are introduced).
    The main barrier holding back understanding of markets for indivisible goods is technical.
As Scarf [1994] has stressed, indivisibilities render the calculus of limited value in characterizing
allocation markets. The reason that the transferable utility case is susceptible to analysis is
precisely because it is equivalent to a problem without indivisibilities. It is tractable only
because the tools of linear programming can be employed in modeling how the allocation switches
with model parameters (Koopmans and Beckmann [1957]). The NTU case forces one to face
many of the same complexities that render integer programming so notoriously complex. There
may, for example, be “butter‡y e¤ects,” in which the smallest of parameter changes causes a
global reallocation of goods. Against this technical backdrop, the limits to our understanding
of markets in which signi…cant goods are indivisible is readily understood.
    In this paper and its companion (Caplin and Leahy [2010]) we introduce new mathematical
structures for analyzing equilibria in NTU allocation markets. Our “GA-structures” combine
an allocation of goods with a graph theoretic structure that represents indi¤erence relations. In
addition to having rich mathematical properties, GA-structures connect with a long-standing
economic tradition, in particular the “rent gradient”models of Ricardo (Ricardo (1817), Alonso
(1964), and Roback (1982), Kaneko, Ito, and Osawa [2006]). We show these GA-structures to
have …ve properties that make them ideally suited to analyzing equilibria in NTU allocation
markets.

  1. We establish equivalence between minimum price equilibria and a class of optimization
     problems on GA-structures. Experience with the fundamental theorem of welfare eco-
     nomics shows how useful such a link between equilibrium theory and optimization theory
     can be. Optimization problems are simpler and better understood. They also do not
     require one to explicitly consider demand, supply, or the balance between them.

  2. We use the link between optimization theory and equilibrium theory to invoke the standard
     theorem of the maximum, and thereby to fully characterize local comparative statics. We
     provide a chain rule for such local comparative statics. This chain rule establishes that
     small discrete shocks have local e¤ects in the model. In contrast, with divisible goods,
     in…nitesimal shocks have global e¤ects: even the smallest change to the supply or demand
     for one good tends to a¤ect the price of every other good in the economy.

  3. We show that GA-structures can be used to identify the entire set of competitive equilibria,
     not only the minimum price equilibrium.

  4. We use GA-structures to study how goods are reallocated as model parameters change.

                                                 2
      In a generic case, we show that there are …ve and only …ve distinct forms of change in the
      equilibrium allocation in response to local parameter changes.

   5. We show that GA-structures can be used algorithmically to identify minimum price equi-
      libria.2

   Properties 1-3 above are established in this paper, the last two in the companion paper.
While we limit our attention in both papers to allocation markets, the GA-structures and
associated techniques that we introduce may be relevant in other settings. We are currently
working on reallocation markets and on general equilibrium market dynamics using many of
the same mathematical tools. There may also be applications to auction markets, to matching
markets, and to models of network formation.
   The remainder of the paper is structured as follows. Section 2 discusses some related lit-
erature. Section 3 presents the basic model. Section 4 presents an example that illustrates
the main objects of our analysis. Section 5 introduces GA-structures. Section 6 characterizes
the minimum equilibrium price as the solution to an optimization problem on these structures.
Section 7 characterizes the minimum price equilibrium allocation in a similar manner. Section
8 uses these characterizations to study the local dependence of minimum price equilibria on
the economic environment. Section 9 de…nes a dual to the allocation problem, and uses it to
characterize the complete set of equilibria. Section 10 concludes.


2. Related Literature

The standard approaches to indivisibilities either assume linear utility or make assumptions that
smooth away the discreteness.
   An example of the …rst approach is the model of Shapley and Shubik (1972). They showed
that with linear utility the competitive equilibrium allocation in a market for heterogeneous,
indivisible goods is equivalent to the problem of a social planner allocating goods so as to maxi-
mize the sum of utilities. This social planner’s problem takes the form of the linear programming
problem studied by Koopmans and Beckmann (1957).
   The assumption of linear utility and the resulting absence of wealth e¤ects may not be
appropriate in many applications, especially if the good in question is an expensive one such as
  2
   The transferable utility case is well covered in this regard: the Hungarian algorithm of Kuhn [1955] and
Munkres [1957] can be used to compute the equilibrium allocation, while the ascending auction mechanism of
Demange, Gale and Sotomayor (1986) solves for the minimum price equilibrium in a discretized version of the
model.


                                                    3
a house. In the linear case, the social planner allocates goods based on some …xed notion of how
much each agent desires each good. If a poor agent values a sea-view more than a rich agent,
the planner will allocate a mansion by the sea to the poor agent. We do not, however, see many
poor agents living in sea-side mansions. What is missing is the e¤ect of diminishing marginal
utility of wealth that leads the rich to be willing to pay more than the poor for the nicest homes.
To include these e¤ects it is necessary to consider utility functions that are non-linear in wealth.
    An example of smoothing is Rosen’s (1974) hedonic pricing model. It also prices hetero-
geneous goods given heterogeneous buyers and sellers. While goods themselves are indivisible,
Rosen makes the assumption that there is a continuous density over characteristic bundles and
that within this space one can adjust each characteristic while …xing the others. This assumption
smoothes the type space allowing the use of the tools of calculus. In many applications, how-
ever, the type space may not be dense enough to allow such adjustments. In housing markets,
for example, location is one of the most important characteristics. It is not generally possible
to adjust location while keeping all other characteristics …xed, nor is it generally possible to
alter characteristics of homes while maintaining a …xed location without incurring substantial
costs. There is ample evidence in the urban economics literature that hedonic prices vary with
location.3
    There are some theoretical results in the case with indivisibilities and wealth e¤ects. Kaneko
(1982) established conditions for the existence of an equilibrium.4 Demange and Gale (1985)
showed that the set of equilibrium prices is a lattice with maximal and minimal elements. They
also established that the minimum price equilibrium cannot be manipulated by buyers, as well
as some basic comparative static properties of the minimum price equilibrium. We extend on
these results by illustrating the structure of minimum equilibrium prices.
    Allocation problems arise naturally in a number of areas in economics. In the housing lit-
erature, the minimum equilibrium price vector is similar to the rent gradient found in Ricardo
(1817), Alonso (1964), and Roback (1982). Models in this tradition tend to limit the hetero-
geneity in buyers or houses in order to keep the model tractable. At the same time, however,
this simplicity allows them to go further than we will in modelling the supply side of the market.
    In the auction and mechanism design literature, our equilibrium is similar to a second price
auction or a Vickrey-Groves-Clark mechanism. These models almost always assume transferable
utility. One exception is the paper by Demange and Gale (1985) cited above.
  3
   See, for example, Meese and Wallace (1994).
  4
   Quinzii (1984), Gale (1984), and Kaneko and Yamamoto (1986) also provide existence proofs. Crawford and
Knoer (1981) sketch a proof of existence for a version of their model with non-transferable utility.



                                                    4
3. The Model

We work with a variant of the model in Demange and Gale (1985). Demange and Gale simplify
the exposition and the analysis of allocation markets by removing all reference to budget con-
straints. This removes the need to discuss what transactions are feasible for each agent at each
set of prices and ensures that the choice correspondences are continuous.5
    There is a set of buyers xa 2 X, 1 a m, and a set of indivisible goods yi 2 Y , 1 i n.
The goods are initially held by the sellers. Buyers may purchase the indivisible goods from
sellers by making a transfer in terms of a homogeneous, perfectly divisible, numeraire good,
which may be thought of as money. Sellers choose only whether or not to sell. They do not
purchase the indivisible goods from other sellers. We assume that n m so that it is possible
to match each buyer with a good.6
    We assume that buyers can derive utility from at most one element of Y . The payo¤ for
buyer xa depends on the good that buyer purchases and the size of the transfer that the buyer
makes to the seller. This payo¤ is summarized by the utility function Ua : Y Rn ! R, where
Ua (yi ; pi ) is the utility to xa from the purchase of yi at the price pi .
    Let p 2 Rn denote the vector of goods prices. Each seller wishes to obtain the highest
possible price above a reservation level. Let r 2 Rn denote the vector of seller reservation prices.
The supply side is trivial: each seller prefers to hold on to their good for any pi < ri and to sell
for any pi > ri . The seller is indi¤erent when ri = pi .7 Choosing r 0 will ensure that all prices
are positive if so desired.
    Given any price vector p 2 Rn , the demand correspondence Da (p) speci…es members of Y
that maximize utility the utility of xa :

                        Da (p) = fyi 2 Y j Ua (yi ; pi )       Ua (yk ; pk ) for all yk 2 Y g :

       An allocation is a one-to-one mapping           : X ! Y from buyers to goods. It simpli…es later
   5
      With budget constraints, consumers’choice correspondences may not be continuous, and therefore the de-
mand correspondence may fail to be upper-hemicontinuous. Assumptions (such as the Inada conditions) may to
be made to ensure that the constraints are not binding in equilibrium, but these do not add insight.
    6
      This is without loss of generality. The possibility that a buyer may choose not to make a purchase can be
captured by associating a subset of goods with exit.
    7
      Since we will be interested in minimum price competitive equilibria, the exact form of a seller’s utility does
not matter so long as it is increasing in the transfer and there is a point ri at which seller i is indi¤erent between
selling and holding.




                                                           5
notation to let    a   denote the good assigned to buyer xa by the allocation ,

                                                  a          (xa ):

The set of all allocations is M . It will sometimes prove useful to have available the inverse
mapping : Y ! X [ ? such that ( (yi )) = yi when (yi ) 6= ?.
    A competitive equilibrium is a price vector and an allocation such that all buyers choose
optimally and all goods with prices above their reservation level are allocated. Given p 2 Rn ,
let U (p) fyi 2 Y jpi > ri g denote the set of goods with prices strictly above seller reservation
levels.

De…nition A competitive equilibrium is a pair (p ;                    ) with p 2 Rn and   2 M such that:

        1.   a   2 Da (p ) for all xa 2 X.
        2. pi      ri for all yi 2 Y .
        3. If yi 2 U (p ), then there exists xa 2 X such that                a   = yi .

    The …rst condition is buyer optimality: the allocation must maximize the utility of each
buyer. The second condition is seller optimality: no seller will part with a good for less than
the reservation price. The third states that all goods with prices above reservation must be
allocated. This ensures that supply is equal to demand.
    We are interested in , the set of equilibrium prices, and, should they exist, the minimum
and maximum equilibrium prices, respectively p2 and p 2 :
                                               ¯
                             = fp 2 Rn j9 2 M s.t. (p; ) an equilibriumg;
                          p 2         is such that p 2         =) pi       pi all i;
                          ¯
                          p 2         is such that p 2         =) pi       pi all i;

   We make assumptions on preferences that guarantee that utility is well behaved and an
equilibrium exists.

Assumption A For each buyer xa 2 X and good yi 2 Y ,

        1. Ua (yi ; pi ) is continuously di¤erentiable in pi and strictly decreasing in pi .
        2. limpi !1 Ua (yi ; pi ) =      1 and limpi !   1 Ua (yi ; pi )   = 1.


                                                         6
    The …rst assumption is a regularity assumption that will allow us to use the implicit function
theorem. Strict monotonicity simpli…es the later analysis but is a stronger condition than needed
for existence. The second assumption in combination with the …rst ensures that given any buyer,
any two goods, and a price for one of the goods, there is a unique price for the second that makes
the buyer indi¤erent between the two goods. Demange and Gale (1985) prove that under these
conditions the set of equilibrium prices is a lattice and that there exists a minimum equilibrium
price.8


4. A Motivating Example

A simple example will introduce some of the main objects of our analysis and some of the logic
behind our characterization of minimum price equilibria.
     Consider a market composed of two goods y1 and y2 and two buyers xa and xb . Suppose that
the preferences of xa are described by the utility functions Ua (y1 ; p1 ) = 2 p1 and Ua (y2 ; p2 ) =
1 p2 . These have the property that when the prices of the two goods are equal xa prefers good
y1 . Similarly, suppose that the preferences of xb are Ub (y1 ; p1 ) = 1 p1 and Ub (y2 ; p2 ) = 3 p2
so that when the prices are equal xb prefers good y2 . Finally, suppose that sellers’reservation
prices are r1 = r2 = 0.
     The minimum price competitive equilibrium in this example is trivial: the price of each good
is set equal to its reservation value and buyers purchase the goods they prefer.
     We now discuss how to use “chains of indi¤erence”to characterize the minimum price com-
petitive equilibrium in this example. The idea behind a chain of indi¤erence is that in any
minimum price competitive equilibrium, any set of goods whose prices are strictly above reser-
vation must contain a good that is demanded by some buyer allocated to a good outside of the
set.9 Otherwise, we could reduce the prices of all the goods in this set and obtain a competitive
equilibrium with lower prices. An implication is that each good is connected by indi¤erence to
a good whose price is the reservation price. Any good that is priced above its reservation value
must be demanded by a buyer allocated to another good. If we knew which buyers were indi¤er-
ent to which goods in equilibrium, we could build up the equilibrium price vector, starting with
the goods priced at their reservation values and using the appropriate “chains of indi¤erence”
to price all other goods. The complication is knowing which buyers to assign to which goods
and which goods should be connected through indi¤erence.
  8
     Demange and Gale assume that buyers may exit the market and therefore have a maximum willingness to
pay. This ensure that has a maximal element as well.
   9
     This is Lemma 4 in Demange and Gale (1985).


                                                   7
    In the current example, there are two possible allocations: buyer xa is matched either to y1
or y2 and buyer xb is matched with the other good. Denote these allocations by 1 and 2 where
  1             1             2             2
  a = y1 and b = y2 , and a = y2 and b = y1 . There are three potential chains of indi¤erence,
if we characterize chains by the goods that are to be connected through indi¤erence. The …rst
sets the price of y1 to its reservation value r1 and allows the price of y2 to be set so that the
buyer allocated to y1 is indi¤erent between the two goods. The second reverses these roles: y2
is set at its reservation value r2 and the price of y1 is set so that the buyer allocated to y2 is
indi¤erent between the two goods. The third possibility is that the prices of both goods are set
at their reservation values.
    An allocation and a chain together determine a price vector. For example, allocation 1 and
chain 1 specify that y1 is priced at reservation and the indi¤erence of buyer xa should be used to
price y2 . The price of y1 is therefore set to r1 = 0, and the price of y2 is -1 since xa is indi¤erent
between the two goods when the price vector is (0; 1). Table 1 reports the price vector that
results from each chain and each allocation.


                                             TABLE 1

                       AllocationnChain        1          2       3      max sum
                           1
                                            (0,-1) (-2,0) (0,0)           (0,0)
                           2
                                             (0,2)       (1,0)   (0,0)    (1,2)
                       p                                                  (0,0)


    Our main result is that the minimum equilibrium price vector can be found by …rst maxi-
mizing the sum of prices across all potential chains for a given allocation, and then minimizing
this across all potential allocations. In the current example, …xing the allocation and choosing
the price vector that maximizes the sum of prices leads to the price vector in the last column.
Minimizing this result with respect to the allocation leads to the price vector in last row. This
price vector is the minimum equilibrium price vector.
    Intuitively, two forces are at work. First, minimum equilibrium prices are determined by
the willingness to pay of the next most interested buyer. Picking the wrong chain results in
using the willingness to pay of a less interested buyer. This tends to lower the resulting price
vector. This is why we take the maximum across chains. Second, allocating a consumer to the
wrong good increases that consumer’s willingness to pay for other goods. This tends to raise
the resulting price vector. This is why we minimize across allocations.

                                                     8
   The next two sections formalize these arguments. In the next section, we associate chains of
indi¤erence with a particular set of directed graphs on Y . We then show how to combine these
graphs with allocations to generate prices such as those that appear in the cells of Table 1. The
min-max theorem is presented in the succeeding section.


5. GA-Structures

What characterizes the construction of prices from a chain of indi¤erence is that each good is
either priced at reservation or it is connected by some unique path to a good that is itself priced
at reservation. In graph theory, the property of there being a unique path from any vertex to
the member of a set of source points is characteristic of a forest of rooted trees.10 The graphs
that we are interested in are all forests of directed, rooted trees in which all edges point away
from the root.

De…nition The class F comprises all directed graphs F = (Y; R; E) with vertex set Y , root set
    R Y , and edge set E that have the following properties:

        1. F is a forest of trees.
        2. E is a set of ordered pairs of vertices where for e 2 E, e = (y1 ; y2 ) is directed from
           y1 to y2 .
        3. Each component (maximal connected subset) of F contains a unique element of R,
           and each edge in E is directed away from the corresponding element of R.

    Figure 1 illustrates a directed, rooted tree. The vertices are shown as circles, except for the
root vertex which is shown as a square. Each vertex corresponds to an indivisible good yi . The
edges are shown as arrows connecting one vertex to another. The edges are all directed away
from the root node, y1 . The absence of cycles characterizes the graph as a tree. A forest is a
collection of such graphs.
    [Figure 1]
    We will write E(F ) and R(F ) when it is necessary to indicate to which graph the edge set
and the root set belong. Let e = (yi ; yk ) 2 E denote the edge directed from good yi to good
yk . We say that yi is the tail of e, and yk is the head of e. We also say that yi is the direct
predecessor of yk and yk is the direct successor of yi . A standard and valuable observation is that
  10
    A tree is a graph with no cycles. A forest is a graph whose components are trees. A rooted tree is a tree
with one vertex denoted as the root.

                                                     9
for each non-root good yi 2 Y nR, there exists a unique root good yr 2 R and a corresponding
unique directed path f(yr ; y1 ); (y1 ; y2 ); : : : (yi 1 ; yi )g E connecting the root set to yi . We say
that yk 6= yi is a predecessor of yi if yk lies on this path between yr and yi . If yk is a predecessor
of yi , we say that yi is a successor of yk .
    We now show how to use a graph F 2 F and an allocation to create a price vector. To do
this, we limit attention to cases in which if (yi ; yk ) 2 E, then allocates a buyer to yi , the tail
of the edge (yi ; yk ).

De…nition A graph-allocation structure (GA-structure) comprises a graph F = (Y; R; E) 2 F
    and an allocation 2 M such that, if (yi ; yk ) 2 E, then there exists xa 2 X such that
     a = yi .


    We let G M F denote the class of all such GA-structures.
    We construct a mapping from GA-structures to prices, q : G ! Rn . The price mapping is
derived by induction on the set of goods that we have priced. The idea is to …rst set the root
goods at their reservation prices, and then to use the allocation and the graph F to construct
chains of indi¤erence. We price each non-root good using the indi¤erence of the buyer allocated
to its direct predecessor.11 We let qi ( ; F ) denote the ith element of the vector q( ; F ).

Construction of q( ; F ) We construct q( ; F ) 2 Rn iteratively:

         1. De…ne A0        R(F ) and set qi ( ; F ) = ri for all yi 2 A0 .
         2. Given s     0 and qi ( ; F ) for all yi 2 As                Y , let S comprise the set of direct
            successors of As ,

                                  S = fyk 2 Y nAs j9yi 2 As with (yi ; yk ) 2 E(F )g:

             For each yk 2 S, consider its direct predecessor yi 2 As with (yi ; yk ) 2 E(F ). Consider
             xa such that a = yi . Then qk ( ; F ) is de…ned implicitly by the indi¤erence condition:

                                           Ua (yi ; qi ( ; F )) = Ua (yk ; qk ( ; F )).                      (5.1)

         3. Set As+1 = As [ S. If As+1 = Y , stop. Otherwise repeat the induction step.
  11
     This is similar to the rent gradient in Ricardo (1871) or the di¤erential rent vector of Kaneko, Ito and Osawa
(2006). Kaneko, Ito and Osawa make assumptions that guarantee that F has only one component that is not
null, and that goods in this component have at most one direct successor. See also Miyake (2003) for a similar
construction.

                                                        10
    It is easy to see that this construction is well de…ned with Assumption A. Since every good
is connected to the root set S will be non-empty so long as As 6= Y . Since ( ; F ) 2 G, there
always exists xa 2 X with a = yi in step 2. It then follows from Assumption A that there exists
a unique qk ( ; F ) 2 R that satis…es (5.1). Finally, given the …nite number of goods, this process
will end after a …nite number of steps with As = Y . Since F is a forest, there is a unique path
to any good from the root set, so each element of S in step 2 has a unique direct predecessor.
It follows that this construction de…nes a unique price vector q( ; F ) 2 Rn .


6. The Min-Max Theorem

We are now in a position to present our main characterization theorem which relates GA-
structures to minimum price competitive equilibria. The proofs of all of the Theorems and
Lemmas are contained in the Appendices.

Theorem 1: q( ; F ) is a minimum equilibrium price if and only if:
                               X                                    X
                                         qi ( ; F ) = min max                 qi ( ; F )      (6.1)
                                                        2M F 2F
                             i2f1:::ng                            i2f1:::ng


     where F = fF 2 F j( ; F ) 2 Gg.

    We establish this result through a series of lemmas. To prove that the minimum equilibrium
price vector solves (6.1), we …rst show that for any minimum price competitive equilibrium
( ; p ) there exists a GA-structure ( ; F ) 2 G with q( ; F ) = p . Next we show that
altering the graph only lowers the implied price, qi ( ; F )     qi ( ; F ) for all ( ; F ) 2 G. If
this were not the case, ( ; p ) could not be a competitive equilibrium, since there would be
some buyer willing to bid more than p for a good that they are not allocated under . Finally,
we show that if is not associated with a competitive equilibrium then there exists some F
such that qi ( ; F )   qi ( ; F ). Again the intuition is that allocating a buyer a good that is
not in their demand set increases their willingness to pay for other goods. The converse follows
from the fact that we know from Demange and Gale (1985) that there exists a unique minimum
equilibrium price. It is shown that this implies that any solution to (6.1) is a competitive
equilibrium. Along the way, we prove an alternate version of Theorem 1.

Corollary 1 q( ; F ) is a minimum equilibrium price if and only if:

                                     qi ( ; F ) = min Qi ( ) for all i                        (6.2)
                                                     2M


                                                   11
     where Qi ( ) = maxF 2F qi ( ; F ).

    The di¤erence between the two formulations is that in Theorem 1 we choose an allocation
to minimize the sum of the components of q( ; F ), whereas in Corollary 1 we minimize each
component individually. Corollary 1 also allows for the maximization over graphs to take place
component by component. The advantage of Theorem 1 is its simplicity. The advantage of
Corollary 1 is that it shows that the equilibrium allocation not only minimizes the sum of prices
but each price individually. This will prove useful when discussing comparative statics below.
    Most GA-structures generate prices and allocations that are inconsistent with optimization
by buyers or sellers. Some generate prices that lie below sellers’ reservation prices; others
allocate goods to buyers who would prefer to purchase other goods. Buyer and seller optimality
are enforced through the maximization and minimization. On the sellers’side, maximizing over
F guarantees that all prices are above sellers’reservation, since we can always choose F such
that a given good is part of the root set. Minimizing over guarantees that all goods in U (p) are
potentially allocated. For example, suppose that for a given allocation maximizing over F leads
to a situation in which an unallocated good is priced above reservation. This can only happen
if that good is in the demand set of a buyer allocated to another good. Often reallocating that
buyer to the unallocated good solves the problem. Note that this also tends to reduce the price
vector by removing the indi¤erence that was driving up the price of the unallocated good in the
…rst place. On the buyers’side, given the equilibrium allocation, maximizing over F guarantees
that no buyer prefers any good to the good that they are allocated. Minimizing over avoids
raising prices through misallocations. Of course, the above intuitive arguments are incomplete,
and the proof itself is as a result somewhat intricate.
    Many comparative static results from the literature follow from Theorem 1. Demange and
Gale (1985) show that minimal equilibrium prices are weakly increasing in seller reservation,
that increasing the number of sellers does not raise prices, and that increasing the number buyers
does not lower prices. In our framework, an increase in reservation prices can only raise q( ; F );
an increase in the number of sellers is equivalent to an expansion in the set of potential matches;
and reducing the number of buyers is equivalent to a restriction on the set of graphs, namely
the restriction that one buyer be allocated to a null tree.


7. Competitive Equilibrium Allocations

Theorem 1 concerns the price vector. Allocations are more complicated. The arguments used
to prove Theorem 1 establish that if  is a minimum price competitive equilibrium allocation

                                                12
then there is exists a GA-structure involving      which solves (6.1). The converse, however, is
not true. There exist GA-structures that solve (6.1) that do not involve competitive equilibrium
allocations.
    The following example illustrates such a situation. The example involves a good that is
unallocated and priced above reservation. Normally such a GA-structure would not solve the
min-max problem. Reallocating the buyer assigned to the unallocated good’s direct predecessor
to the unallocated good would lower prices, since the unallocated good would lose the indi¤erence
supporting its high price. In the example, however, there are multiple buyers interested in the
unallocated good. When one buyer is reallocated, the others’indi¤erence continues to support
the good’s high price.

 Example: There are three goods and two buyers. The minimum equilibrium price has goods
        y1 and y2 priced at reservation and good y3 is priced above reservations. At these
        prices xa is indi¤erent between y1 and y3 and xb is indi¤erent between y2 and y3 .
        There are two competitive equilibrium allocations: either xa is allocated to y1 and
        xb is allocated to y3 or xa is allocated to y3 and xb is allocated to y2 . The key point
        is that in any competitive equilibrium y3 must be allocated since it is priced above
        reservation. It is not necessary, however, that y3 be allocated for a GA-structure to
        price it. The GA-structure with xa allocated to y1 and xb allocated to y2 , together
        with a graph that includes the edge (y1 ; y3 ) generates the minimum equilibrium price
        vector and hence solves (6.1). This GA-structure is illustrated in Figure 2. If xb were
        not indi¤erent to y3 , then reallocating xa to y3 would lower prices.

    [Figure 2]
    The property of competitive equilibrium that fails in the example is that the allocation is
not onto the set U (p). It turns out that if an allocation solves the min-max problem and is onto
U (p), then the allocation is a competitive allocation.

Theorem 2: If (p ;     ) is a minimum price competitive equilibrium then,

                                            2 arg min H( );                                 (7.1)
                              P
     where H( ) = maxF 2F       i2f1:::ng qi ( ; F ). Moreover, if 2 arg min H( ) and for all is
     onto U (p ) = fyi 2 Y jpi > ri g, then (p ; ) is a minimum price competitive equilibrium.

    The theorem follows from the observation that given any , if there exists a buyer xa who
strictly prefers some good yi to a at the minimum equilibrium price vector p , then there exists

                                               13
a graph F such that pi qi ( ; F ) with strict inequality for yi . Hence any allocation that solves
the min-max problem satis…es buyer optimality. If it is also onto U (p ) then it satis…es the other
conditions for a competitive equilibrium as well.
    Although the min-max problem does not pin down the equilibrium allocation, it is easy
to construct an equilibrium allocation given any solution to the min-max problem. Since the
solution to the min-max problem gives the equilibrium price vector, the values of all goods are
known. The problem becomes one of …nding for …xed payo¤s an allocation that both maximizes
buyers’utility and is onto the set U (p ). To construct such an allocation, one begins with any
allocation that solves the min-max problem. One then identi…es an unallocated good whose
price is above reservation. Since the allocation solves the min-max problem, there exists a chain
of indi¤erence extending from the unallocated good to the root set. Next, shift each buyer
allocated to a good in that chain to its immediate successor in the chain. This operation leads
to another allocation that solves the min-max problem and reduces the set of unallocated goods
by one. Caplin and Leahy (2010) discuss such reallocations in greater detail.


8. Local Comparative Statics

In this section we consider a collection of models indexed by the parameter 2 , where
is an open set in RT for some constant T . Depending on the application, may parametrize
a shift in the reservation prices of sellers, r( ), and/or it may re‡ect a some aspect of buyers’
utility, Ua (yi ; pi ; ). Hence given any GA-structure ( ; F ), the price vector will be q( ; F ; ).
Let : ! G denote the mapping from parameters to the set of GA-structures that generate
minimum price competitive equilibrium:

                   ( ) = f( ; F )j 2 arg min H( ) and F 2 arg max q( ; F ; )g
                                                                 F 2F


and let p: ! Rn denote the minimum equilibrium price vector given .
        ¯
    If we assume that q( ; F ; ) is continuous in for all ( ; F ) 2 G, it follows directly from the
Theorem of the Maximum applied to (6.2) that ( ) is upper-hemicontinuous and the minimum
price competitive equilibrium price vector is continuous.

Theorem 3 If q( ; F ; ) is continuous in for all ( ; F ) 2 G, then all of the components of
    p( ) are continuous and ( ) is non-empty, compact-valued, and upper-hemicontinuous
    ¯
    at 2 .



                                                14
    The picture that emerges is one of a …nite collection of surfaces q( ; F ; ) in Rn , one surface
for each ( ; F ). Given , the minimum competitive equilibrium price vector is associated with
one of these surfaces. As we alter , we move along one surface until it intersects with another and
the min-max problem may tell us to switch and follow the other surface. The characterization
of these switches is the subject of Caplin and Leahy (2010). The point that we want to make
here is that so long as these intersections are not too frequent, local comparative statics will
almost everywhere involve a …xed GA-structure.
    A natural smoothness assumption that leads to sparse switches is to assume that the q( ; F ; )
are analytic functions of .12 This assumption would be satis…ed in almost any practical appli-
cation of the model, as it only requires that the utility functions be analytic functions of p and
  and that the reservation prices be analytic functions of .13

Assumption B q( ; F ; ) is an analytic function of                for all ( ; F ) 2 G

    If the q( ; F ; ) are analytic, then Lojasiewicz’s Structure Theorem for Real Varieties (Krantz
and Parks [2002], p. 168) implies that the set of switch points is at most dimension T 1. It
follows that at almost every point in the parameter space 0 there will be a neighborhood N ( 0 )
such that ( ; F ) 2 ( 0 ) implies ( ; F ) 2 ( ) for 2 N ( 0 ).14
    We use this insight to discuss the local e¤ects of various parameter changes. First, suppose
that there is an increase in the reservation price of a good y0 . In this case         r0 . Suppose
that ( ; F ) 2 ( 0 ). It is immediate from the construction of q( ; F ) that for almost all , a
change in r0 impacts q( ; F ) only if y0 is part of the root set, and even then the e¤ect is limited
to the component of F containing y0 . If y0 is not an element of the root set then r0 is almost
surely inframarginal in the sense that it is strictly below the minimum equilibrium price. If y0
is part of the root set, then the e¤ects on the successors of y0 work through the graph F . An
increase in r0 has a direct e¤ect on the price of y0 which then a¤ects the willingness of the buyer
allocated to y0 to pay for other goods. This alters the price of the direct successors of y0 , and by
induction their successors. Prices of goods in other components are not a¤ected by the change
in r0 since they are not connected in any way to y0 .
    Proposition 1 summarizes the e¤ect of a change in the reservation price of y0 .
  12
     A function f (x) is analytic at a point x0 if its Taylor series expansion converges on a neighborhood of x0 .
  13
     See Frantz and Parks [2002].
  14
     It is possible that multiple allocations support the competitive equilibrium for 2 N ( 0 ). In this case the
equilibrium prices will be unique but the equilibrium allocation will be indeterminate. Caplin and Leahy (2010)
discuss conditions under which ( 0 ) is generically unique.




                                                       15
Proposition 1 Suppose   r0 for some y0 2 Y . Suppose further that ( ; F ) solves (6:1) at
      2 and that Assumption B holds. For almost all 2 the following are true:

  1. If y0 62 R(F ), then dpk =d = 0 for all yk 2 Y .
                           ¯
  2. If yk is not a successor of y0 , then dpk =d = 0 for all yk 2 Y .
                                            ¯
  3. If yk is a successor of y0 and f(y0 ; y1 ); (y1 ; y2 ); : : : (yn ; yk )g E(F ), then

                                          dpk  dp dp                  dp
                                           ¯ = ¯k ¯k           1
                                                                   ::: ¯ 1                           (8.1)
                                          d   dpk 1 dpk        2
                                                                      dp0
                                               ¯     ¯                 ¯
     where                                                         ,
                                  dpi   dU     i 1
                                                  (yi 1 ; pi 1 )       dU   i 1
                                                                               (yi ; pi )
                                    ¯ =
                                 dpi 1            dpi 1                      dpi
                                  ¯                ¯                          ¯
    Equation (8.1) is a type of “chain rule” for local comparative statics in allocation markets.
This chain rule works along the chain of indi¤erence connecting pk to the root set. The movement
                                                                 ¯
in each price in the chain a¤ects the price of its direct successor.
    A shock to the utility of a buyer is slightly more complicated. There is no equivalent to the
buyer being inframarginal, since we are assuming all buyers are allocated. The e¤ect of a shock
to the utility of buyer x0 is limited to the prices of all goods that are successors of 0 . Note
that the price of 0 does not change since x0 ’s utility is used to price the direct successors of 0
given the price of 0 .

Proposition 2 Suppose shifts the utility of buyer x0 who is assigned to y by . Suppose
    further that ( ; F ) solves (6:1) at 2 and that Assumption B holds. For almost all
      2 the following are true:

  1. If yk is not a successor of y, then dpk =d = 0.
                                           ¯
  2. If yk is a successor of y0 and f(y0 ; y1 ); (y1 ; y2 ); : : : (yn ; yi )g E(F ) is a path in F from y0
     to yk then
                                       dpk         dp dp                  dp
                                        ¯ = ¯ k ¯ k 1 ::: ¯ 1
                                       d         dpk 1 dpk 2              d
                                                   ¯       ¯
     where                                                         ,
                                dpi     dU i 1 (yi 1 ; pi 1 )           dU i 1 (yi ; pi )
                                 ¯ =
                              dpi 1              dpi 1                        dpi
                               ¯                  ¯                            ¯

                                                     16
       and
                              dp1       dU0 (y0 ; p0 )    dU0 (y1 ; p1 )
                                                                  dU0 (y1 ; p1 )
                               ¯ =
                              d             d                 d       dp1
                                                                       ¯
    The picture that emerges from these two propositions contrasts with the case of divisible
goods. With divisible goods every good is connected to every other good through indi¤erence.
Even the smallest change to the supply or demand for one good tends to a¤ect the price of
every other good in the economy. With indivisibility, small changes in the supply or demand
for a good, only a¤ect the prices of that good and its successors. With indivisible goods small
discrete shocks have local e¤ects, whereas with divisible goods, in…nitesimal shocks have global
e¤ects.15
    Global comparative statics with indivisible goods are more complicated. Larger shocks induce
changes in the equilibrium GA-structures. Caplin and Leahy (2010) show how to build up the
e¤ects of large shocks from the e¤ects of small shocks. They show that transitions among GA-
structures are orderly. Along the generic path in parameter space only certain q( ; F ; ) surfaces
intersect. Therefore only certain changes in the graph and allocation ever need to be considered.


9. The Dual Problem and the Equilibrium Set

9.1. Exit and the Primal Problem

In order to simplify the analysis, we have assumed to this point that all buyers make a purchase
from Y . In many applications buyers may have outside options. Moreover to model the dual
problem, we will need a notion of maximal willingness to pay.16
    We introduce exit by expanding the choice sets of buyers and sellers. Let ya denote the
outside option of buyer xa . We assume that buyer xa chooses from the set Y [ ya . No other
buyer demands ya . Let a denote the value of the outside option to buyer xa . We normalize the
reservation prices of ya to zero. Let Y = Y [ fya gm
                                                   a=1 .
    Similarly let xi denote the outside option of seller yi and X = X [ fxi gni=1 . This preserves
the one-to-one nature of the allocation. With these amendments there are m + n buyers and
sellers. We normalize the utility of the phantom buyers to zero. Demange and Gale prove that
  15
     We thank Victor Norman for this observation.
  16
     We introduce exit without introducing budget constraints. Budget constraints introduce discontinuities in
utility at the point resources are exhausted. Minimum price competitive equilibria may not exist. To eliminate
these problems it is often assumed that agent exit before resources are exhausted. See Kaneko (1982). This
assumption would be justi…ed by any model in which the Inada conditions held.




                                                         17
there exists a minimum price competitive equilibrium in this model, which we now refer to as
the “primal model.”
    The only impact that introducing exit has is to restrict the set of admissible GA-structures.
The set of admissible allocations is reduced in two ways. An allocation must not assign a buyer
to another buyer’s outside option, nor can an allocation assign one sellers outside option to
another seller. The set of admissible graphs is also reduced. The outside options of buyers
must be root goods, since no other buyer can demand them. Appropriately amended versions
of Theorem 1, Corollary 1 and Theorem 2 follow immediately.

9.2. The Dual

In the dual one switches the positions of buyers and sellers and reinterprets equilibrium as taking
place in the space of buyer utilities rather than in the space of seller prices. In the dual buyers’
utility plays the role that prices play in the primal. The utility of buyers’outside options plays
the role of seller’s reservation prices. Let 2 Rm+n    +     denote buyer utility. Let R
                                                                                       a denote the
utility xa receives from exit. Sellers can only make a sale to xa if they o¤er utility greater than
 R
 a.
     Sellers choose buyers to maximize the price that they receive. The payo¤ of seller yi ,
pi (xa ; a ), depends on the buyer that they sell to xa and a , the utility received by xa . In
the case of a null buyer
                                            pi (xi ; 0) ri .

In the case of a non-null buyer, pi (xa ; a ) is de…ned as the price that would have to charged for
good yi to provide buyer xa with utility a ,

                                      Ua [yi ; pi (xa ;   a )]   =   a:


                R
Given a         a , this solution exists and is unique due to strict monotonicity and continuity
of the utility function. The supply correspondence Si ( ) includes those buyers who generate
maximum values for this “indirect pro…t function”pi (xa ; a ).
    An allocation of goods is a one-to-one mapping : Y ! X such that such that each good is
assigned a feasible buyer,
                                          i = (yi ) 2 X [ xi .

                                                                                      1
  is the inverse of de…ned on the extended set of goods and buyers. We let M              denote the
set of such allocations.


                                                    18
De…nition 9.1. A competitive equilibrium in the dual model is a pair (^ ; ^ ) such that:

     1. ^ i 2 Si (^ ) for all yi 2 Y .

     2.     a    ^R
                  a


     3. If ^ a > ^ R
                   a , then there exists yi 2 Y such that ^ i = xa .


9.3. Maximum Price Equilibria

We construct maximum price competitive equilibrium using the dual of the GA-structure. This
is an allocation 2 M 1 and a graph T 2 T on the set of buyers X. The graphs T are of the
form (X; R; E) and satisfy all of the conditions of the class F with the additional restriction
that all of the null buyers satisfy xi 2 R. The allocations allocate sellers to buyers, respecting
the restriction that no seller can be allocated to the outside option of another seller. As in
the case of minimal price competitive equilibria we need to limit attention to cases in which if
(xa ; xb ) 2 E, then allocates a seller to xa . We denote the class of admissible ( ; T ) pairs H,
and the class of admissible graphs given an allocation , T ( ).
    We construct vectors of buyer utilities from ( ; T ) 2 H in the same way that we constructed
prices from ( ; F ). We set the utilities of all buyers xa 2 R equal to their reservation value R
                                                                                                a.
We then proceed by induction using the indi¤erence of sellers to assign utilities to the direct
successors of buyers whose utility we already know. If (xa ; xb ) 2 E and i = xa , then

                                          pi (xa ;   a)   = pi (xb ;   b)


gives b as a function of a .
    The maximal price competitive equilibrium is characterized by maximizing the sum of buyer
utility over admissible graphs T and then minimizing over allocations .

                                                                X
                                                                m
                                             min 1 max                 a
                                             2M      T 2T ( )
                                                                a=1


We can back out the equilibrium price of any good yi from any solution to this maximization
problem. Let xa = i , then pi solves,

                                              Ua (yi ; pi ) =     a:


If    i   = xi , then pi = ri .

                                                          19
9.4. The Equilibrium Set

Having solved the original model to identify the minimum equilibrium price, and the dual to
identify the maximum equilibrium price, one can characterize the set of competitive equilibria.
Every competitive equilibrium is associated with a set of reservation prices that lie between the
identi…ed minimum and maximum equilibrium prices. The formal statement is in Theorem 4.

Theorem 4 A price vector p is a competitive equilibrium price vector if and only if it is the
    minimum price competitive equilibrium price vector for a model with reservation prices
    r^ 2 [p; p].
         ¯

10. Concluding Remarks

In this paper and it companion, we present a new mathematical apparatus for understanding
allocation markets with NTU. We are currently extending the work to a dynamic context and
solving for the reallocation of objects over time. Buyers may become sellers or agents may act
simultaneously as buyers and sellers.
    The housing market is particularly promising in terms of applications. With regard to theory,
many questions concerning housing markets require the introduction of trading frictions. In
housing markets only a small fraction of homes are traded in any given period of time. What
do minimum price equilibria look like in this case? What in‡uence do non-traded homes have
on current transactions? With regard to empirical implementation, to what extent do prices
re‡ect local income and to what extent local amenities? How do shocks to one location such as
the location of a factory or school propagate through space and time? To what extent does the
revealed pattern of movements over the housing life cycle connect housing prices and housing
returns in geographically disconnected areas? Other applications, e.g. in auction markets, are
also of interest.


11. References

References

 [1] Alonso, William (1964), Location and Land Use, Cambridge: Harvard University Press.

 [2] Caplin, Andrew, and John Leahy (2010), “Comparative Statics in Markets for Indivisible
     Goods,”NYU working paper.

                                               20
 [3] Crawford, Vincent, and Elsie Knoer (1981), “Job Matching with Heterogeneous Firms and
     Workers,”Econometrica 49, 437-50.

 [4] Demange, Gabrielle, and David Gale (1985), “The Strategy Structure of Two-Sided Match-
     ing Markets,”Econometrica 53, 873-888.

 [5] Demange, Gabrielle, and David Gale, and Marilda Sotomayor (1986), “Multi-Item Auc-
     tions,”The Journal of Political Economy 94, 863-873.

 [6] Gale, David, (1984), “Equilibrium in a Discrete Economy with Money.”International Jour-
     nal of Game Theory 13, 61–64.

 [7] Kaneko, Mamoru, (1982), “The Central Assignment Game and the Assignment Markets,
     Journal of Mathematical Economics 10, 205–232.

 [8] Kaneko, Mamoru, Tamon Ito, and Yu-ichi Osawa (2006), “Duality in Comparative Statics
     in Rental housing markets with Indivisibilities,”Journal of Urban Economics 59, 142-170.

 [9] Kaneko, Mamoru, and Yoshitsugu Yamamoto (1986), “The Existence and Computation of
     Competitive Equilibria in Markets with an Indivisible Commodity”, Journal of Economic
     Theory 38, 118-136

[10] Koopmans, Tjalling and Martin Beckmann (1957), “Assignment Problems and the Location
     of Economic Activities”, Econometrica 25, 53-76.

[11] Krantz, Steven, and Harold Parks (2002), “A Primer of Real Analytic Functions,”Boston:
     Birhauser.

[12] Kuhn, Harold (1955), “The Hungarian Method for the Assignment Problem,” Naval Re-
     search Logistics Quarterly 2, 83-97.

[13] Meese, Richard, and Nancy Wallace (1994), “Testing the Present Value Relation for Housing
     Prices: Should I Leave my House in San Francisco,”Journal of Urban Economics, Volume
     35, 245-266.

[14] Miyake, Mitsunobu (1994), “Comparative Statics of Assignment Markets with General
     Utilities,”Journal of Mathematical Economics 23, 519-531.

[15] Miyake, Mitsunobu (2003), “Precise Computation of a Competitive Equilibrium of the
     Discrete Land Market Model,”Regional Science and Urban Economics 33, 721-743.

                                             21
[16] Munkres, James (1957), “Algorithms for the Assignment and Transportation Problems,”
     Journal of the Society of Industrial and Applied Mathematics 5, 32-38.

[17] Ricardo, David, (1817), Principles of Political Economy and Taxation, London, John Mur-
     ray.

[18] Roback, Jennifer (1982), “Wages, Rents, and the Quality of Life,” Journal of Political
     Economy 90, 1257-1278.

[19] Rosen, Sherwin (1974), “Hedonic Prices and Implicit Markets: Product Di¤erentiation in
     Pure Competition,”Journal of Political Economy 92, 34-55.

[20] Scarf, Herbert E. (1994), “The Allocation of Resources in the Presence of Indivisibilitie,”
     Journal of Economic Perspectives, Vol. 8, 111-128.

[21] Shapley, Lloyd, and Martin Shubik (1972), “The Assignment Game I: The Core.”Interna-
     tional Journal of Game Thoery 1, 111-130.

[22] Quinzii, Martine, (1984), “Core and Competitive Equilibria with Indivisibilities,”Interna-
     tional Journal of Game Theory 13, 41–60.




                                              22
12. Appendix

The following lemmas are used in the proof of Theorem 1.

Lemma 1: Given a minimum price competitive equilibrium ( ; p ), there exists F 2 F such
   that ( ; F ) 2 G and p = q( ; F ).

   Proof: Consider a minimum price competitive equilibrium ( ; p ). We construct F 2 F
such that ( ; F ) 2 G and p = q( ; F ).
   The …rst stage in the construction of graph F on Y is to identify the root set as all goods
that are at reservation prices,
                                   R = fyk 2 Y jpk = rk g :

    The graph is completed by induction. Let A1 = R and let F1 denote the null graph on the
vertex set A1 . At stage s > 1 of the construction, suppose we have identi…ed As          Y and a
graph Fs = (As ; R ; Es ) on the vertex set As such that Fs is a forest of rooted trees with root
set R and all of the edges in Es are directed away from the roots. By construction, R           As
and Y nAs U (p ). Lemma 4 in Demange and Gale (1985) states that there exists xa 2 X such
that a 2 As and Da (p ) \ Y nAs 6= ?. Choose yi 2 Da (p ) \ Y nA. Let As+1 = As [ fyi g,
Es+1 = Es [ ( a ; yi ), and Fs+1 = (As+1 ; R ; Es+1 ). By construction, Fs+1 is a forest of rooted
trees with root set R and all edges directed away from the roots. Given that there are a …nite
number of elements in Y nR , this construction converges in a …nite number of steps to a graph
F = (Y; R ; E ).
    To see that ( ; F ) 2 G, note that the construction implies that (yi ; yk ) 2 E only if there
exists xa 2 X such that a = yi . To see that q( ; F ) = p , note …rst that, by construction,
all goods in R are at reservation prices. Furthermore note that for any edge (yi ; yk ) 2 E , the
buyer xa 2 X with a = yi is indi¤erent between yi and yk at p . In light of Assumption A,
the fact that all implied indi¤erences hold at p is su¢ cient to complete the demonstration that
q( ; F ) = p .


Lemma 2: For any minimum price competitive equilibrium ( ; p ),

                                          pi = max qi ( ; F )
                                               F 2F



   Proof: The proof is by contradiction. Lemma 1 states that if ( ; p ) is a minimum price
competitive equilibrium then there exists ( ; F ) 2 G such that q( ; F ) = p . Suppose that

                                               23
q( ; F ) = p , and consider any F 6= F such that q1 ( ; F ) > p1 for some good y1 2 Y . p1 > p1
implies y1 62 R(F ). Let yr 2 R(F ) denote the root good in the component of F containing y1 .
yr is a predecessor of y1 in F . Since yr 2 R(F ), qr ( ; F ) = rr qr ( ; F ).
     Consider the path fyr ; : : : y1 g in F . Let y2 denote the …rst predecessor of y1 along this
path such that q2 ( ; F ) p2 . As qr ( ; F ) qr ( ; F ) and q1 ( ; F ) > q1 ( ; F ), y2 is well
de…ned. Let y3 denote the direct successor of y2 along this path. Consider x2 such that 2 = y2 .
(y2 ; y3 ) 2 F , implies that U (y2 ; q2 ( ; F )) = U (y3 ; q3 ( ; F )). Since x2 is indi¤erent between
y2 and y3 at q( ; F ), the fact that q2 ( ; F )        p2 and q3 ( ; F ) > p3 implies that x2 strictly
prefers y3 to y2 at the price vector p . But ( ; p ) is a minimum price competitive equilibrium.
This contradiction establishes the lemma.


Lemma 3: Given a minimum price competitive equilibrium ( ; p ) and any allocation , then
   there exists F 2 F such that ( ; F ) 2 G and pi qi ( ; F ) for all i. If there exists a buyer
   xa who strictly prefers some good yi to a at p , then the inequality is strict for good yi .

     Proof: Let ( ; p ) be a minimum price competitive equilibrium and any allocation. We
show how to construct an F such that q( ; F ) p . The lemma follows immediately.
     By Lemma 1, there exists, F such that q( ; F ) = p . Note that we may pick F such that
R(F ) contains all yi such that pi = ri by simply removing all of the edges (yk ; yi ) such that
pi = ri . Given this choice of F , all goods that are not root goods must be allocated by ,
that is for all yi 62 R(F ) there exists xb such that b = yi . Otherwise ( ; p ) would not be a
competitive equilibrium.
     To construct F , we …rst construct the directed graph K as follows.
     (1) For each edge (yi ; yk ) 2 E(F ) …nd xb 2 X such that b = yi . Then, if b 6= yk , include
( b ; yk ) in E(K). Intuitively, every good is being priced by the same person in K as in F .
     (2) If c 6= c , include ( c ; c ) in E(K).
     K may not be a tree. It is possible that the second step creates a vertix with a indegree of
two. To construct F we will make a selection from K.
     We construct F by induction. Let R(F ) = R(F ). Delete all edges (yi ; yk ) 2 K in which
yk 2 R(F ). Note also that qi ( ; F ) = ri = pi for all yi 2 R(F ).
     Now suppose that pi         q( ; F ) all yi 2 As Y . Since pj > rj for all yj 2 Y nR(F ), there
exists xd and y1 such that d 2 As , ( d ; y1 ) 2 E(F ), and y1 2 Y nAs . We consider two cases.
First, if d 2 As , then ( d ; y1 ) 2 K by rule (1) above, and we add ( d ; y1 ) to F . The second
case is d 2 Y nAs . Now for each yk 2 Y nAs , there exists xb such that b = yk . Hence if


                                                  24
 d 62 Y nAs and d 2 Y nAs , there exists xe such that e 2 Y nAs , but e 62 Y nAs . By rule (2),
( e ; e ) 2 E(K) and we add it to E(F ).
    Let (yj ; yk ) denote the edge that we have added to F at this stage and suppose that a = yj .
qk is determined by
                                        Ua (yk ; qk ) = Ua (yj ; qj ).

But yj 2 As implies qj     pj
                                           Ua (yj ; qj )        Ua (yj ; pj )

and the de…nition of competitive equilibrium implies

                                          Ua (yj ; pj )     Ua (     a; p   a
                                                                                )                 (12.1)

Finally by construction
                                          Ua ( j ; p a ) = Ua (yk ; pk )

Note the last step is redundant in the case of rule (2) as a = yk . It follows from the monotonicity
of Ua that qk pk . This completes the induction step.
     If is not a competitive equilibrium allocation then some buyer strictly prefers            to .
(12.1) becomes a strict inequality and qk       pk for all yk with strict inequality for at least one
yk . It follows that in this case
                                X                                       X
                                        qi ( ; F ) > min max                        qi ( ; F ).
                                                      2M F 2F
                            i2f1:::ng                                 i2f1:::ng


This completes the proof of the lemma.

    Proof of Theorem 1: We …rst show that the minimum competitive equilibrium price is a
solution to (6.1).
    Suppose that ( ; p ) is a minimum price competitive equilibrium and that q(^ ; F^ ) = p . By
Lemma 1, there exists F such that

                                         q( ; F ) = p = q(^ ; F^ ).

Lemma 2 implies
                                         qi ( ; F ) = max qi ( ; F )
                                                           F 2F




                                                           25
It follows immediately that
                                        X                            X
                                                  qi ( ; F ) =                 max qi ( ; F )
                                                                               F 2F
                                      i2f1:::ng                    i2f1:::ng


Lemma 3 implies
                                         X                                     X
                                                   qi ( ; F )      max                qi ( ; F )
                                                                   F 2F
                                       i2f1:::ng                          i2f1:::ng

It follows that
                       X                            X                                       X
                                 qi (^ ; F^ ) =               qi ( ; F ) = min max                    qi ( ; F ).
                                                                                2M F 2F
                     i2f1:::ng                    i2f1:::ng                               i2f1:::ng


    To establish the converse, we need only show that the solution to (6.1) is unique, for then the
preceding arguments establish equivalence. Suppose that there is a solution (^ ; F^ ) to min-max
that is not a competitive equilibrium. This could happen in one of three ways: either some price
is below reservation; some good whose price is above reservation is unallocated; or some buyer
is allocated to a good that is not in his or her demand correspondence. We discuss each case in
turn.
                                                                                     P
    In the …rst case it is clear that (^ ; F^ ) does not solve maxF 2F                  i2f1:::ng qi ( ; F ). We can
raise the price of any good to its reservation value by adding it to the root set.
    Second, suppose that there exists y1 such that q1 (^ ; F^ ) > r1 and there exists no xa 2 X such
that ^ a = y1 . Since q1 (^ ; F^ ) > r1 , y1 has a direct predecessor in F^ , call it y2 , and there exists
xb such that ^ b = y2 and xa is indi¤erent between y1 and y2 .
    Consider 0 such that 0a = a for all xa 6= xb , 0b = y1 , and y2 is unallocated.
    Suppose that there exists yi and F 0 such that qi ( 0 ; F 0 ) > qi (^ ; F^ ). Let yr denote the root
good associated with the component of F 0 containing yi . Consider the path fyr ; : : : yi g in F 0 .
Note that qr ( 0 ; F 0 ) = rr qr (^ ; F^ ). Let y3 denote the good closest to yr on this path such that
q3 ( 0 ; F 0 ) > q3 (^ ; F^ ) and let y40 denote the immediate predecessor of y3 in F 0 and y^4 the immediate
predecessor in F^ . Let ^ and 0 denote the inverses of ^ and 0 . If ^ (y40 ) = 0 (y40 ), then y40 6= y^4 ,
otherwise the edge (y40 ; y3 ) is in E(F^ ) and q4 ( 0 ; F 0 )        q4 (^ ; F^ ) implies q3 ( 0 ; F 0 )    q3 (^ ; F^ ).
But in this case if y40 6= y^4 we can replace the edge (^    y4 ; y3 ) 2 E(F^ ) with the edge (y40 ; y3 ) thereby
raising the price of y3 and its successors in F^ without reducing the price of any other good.
                                                 P                                  P
This contradicts the assumption that i2f1:::ng qi (^ ; F^ ) = maxF 2F                 i2f1:::ng qi ( ; F ). It follows
             0       0 0
that ^ (y4 ) 6= (y4 ). This implies that y4 = y1 since this is the only good that is allocated to
a di¤erent buyer under 0 . In this case we can replace (^             y4 ; y3 ) 2 E(F^ ) with the edge (y2 ; y3 ).

                                                                  26
Since there q1 ( 0 ; F 0 ) q1 (^ ; F^ ) and xa is indi¤erent between y1 and y2 at q1 (^ ; F^ ), this change
raises the price of y3 and its successors without altering any other price. This again leads to a
contradiction. As all cases are exhausted, it follows that qi ( 0 ; F 0 ) qi (^ ; F^ ).
    Since ^ minimizes the sum of prices it follows that qi ( 0 ; F 0 ) = qi (^ ; F^ ). Since q1 ( 0 ; F 0 ) > r1 ,
y1 has a direct predecessor in F 0 , call it y5 , and there exists xb such that ^ b = y5 and xb is
indi¤erent between y5 and y2 . Note that y5 6= y2 as y2 is unallocated, and xb 6= xa since xa
is allocated to y1 . We may therefore take F 0 to be equal to F except that the edge (y2 ; y1 ) is
replaced with the edge (y5 ; y1 ). The new graph has one less that is unallocated and has price
above reservation. Repeating the above arguments until this number is zero establishes the
lemma.
    The third case is covered by Lemma 4, which states any allocation that does not satisfy
buyer optimality leads to a strictly larger value for H( ).
    It follows that any solution to the min-max problem is a competitive equilibrium.

    Proof of Corrollary 1: Lemmas 1 through 3 establish that the minimum equilibrium price
satis…es (6.2). There can be no other solution to (6.2).
    Proof of Theorem 2: The …rst statement follows directly from the arguments used to
establish Theorem 1. If q( ; F ) solves (6.1), then q( ; F ) is a competitive equilibrium price
vector. Hence q( ; F ) r. By assumption if qi ( ; F ) > ri , there exists xa such that a = yi .
Finally, it follows from Lemma 3, that if there exists a buyer xa and a good yi such that xa prefers
yi to a at q( ; F ), then q( ; F ) does not solve (6.1). This establishes the second statement.

   Proof of Theorem 3: Consider 0 2 . Assumption A guarantees the existence of a
minimum price competitive equilibrium. Lemma 1 guarantees that there exists a GA-structure
that supports a competitive equlibrium. Hence ( 0 ) is non-empty.
   G is a discrete set. Hence ( 0 ) is compact.
   The upper-hemicontinuity of ( ) and the continuity of p( ) follow from applying the the-
                                                            ¯
orem of the maximum …rst to
                                  Hi ( ; ) = max qi ( ; F; )
                                                      F 2F

and then to
                                     p ( ) = min Hi ( ; )
                                     ¯i       2M

for each yi . Note the q( ; F; ) are continuous in by assumption, and the F are trivially
continuous correspondences in , implying that the H( ; ) are continuous in . Again M is
trivially continuous in .

                                                       27
     Proof of Theorem 4: (only if) Given a competitive equilibrium price vector p, we know
that p 2 [p; p]. If we take r^ = p, then p is a minimal price competitive equilibrium price vector.
           ¯
     (if) Let (^ ; p^) denote a minimal price competitive equilibrium for a model with reservation
prices r^ 2 [p; p], and let ( ; p) denote a maximal price competitive equilibrium for the original
              ¯
model. We show that there exists ( 0 ; p^) that is a equilibrium for the original model.
     First note that ( ; p) is a competitive equilibrium for the model with reservation price vector
r^, since raising the vector of reservation prices from r to a point in (r; p] only weakens the second
condition in the de…nition of a competitive equilibrium. It follows that p^ p, since p^ is the
minimal equilibrium price vector based on reservation utilities r^.
     Let Y A = fyi 2 Y j^   pi = pi g denote the set of goods for which p^ and p agree and Y B =
fyi 2 Y jpi > p^i g denote the set on which they disagree (note either set may be empty). De…ne
X B = fxa 2 Xj a 2 Y B g. Let 0 be de…ned as follows
                                                (
                                        0           ^ a if xa 2 X B
                                        a   =
                                                      a  otherwise

We …rst show that 0 is an allocation and is onto H(^         p). Since pi > ri for all yi 2 Y B , it
follows that all yi 2 Y B are allocated at p and that jX B j = jY B j. Since p^i < pi if and only if
yi 2 Y B , it follows that Da (^
                               p) Y B for all xa 2 jX B j. Since (^ ; p^) is a competitive equilibrium,
^ : X B ! Y B is a bijection. Since xa 2    = X B =) a 2   = Y B , we know that : XnX B ! Y A .
Since is an allocation it is 1-1 on this domain and only assigns null goods appropriately,
ensuring that 0 itself one-to-one and is an allocation. Moreover, since is onto H(^         p)nY B , 0 is
onto H(^ p):
    It remains to show ( 0 ; p^) satis…es buyer optimality. Since (^ ; p^) is a competitive equilibrium,
this is clear for xa 2 X B . Suppose that there exists xa 2 XnX B such that 0a 62 Da (^        p). Now
since ( ; p) is a competitive equilibrium, 0a = a 2 Da (p). Since p = p^ on Y A , it follows that
Da (^p) 2 Y B . The fact that ^ maps X B onto Y B implies that ^ maps XnX B into Y A . This
contradiction completes the proof.




                                                      28
                                                  y5
                               y4

            y1
                                                  y6

                       y2

                                    y3
Figure 1: A directed rooted tree with edges directed away from the root
good (y1)
                          y3




       (y1,xa)                          (y2,xb)

Figure 2: An example of a GA structure that generates the
competitive equilibrium price but involves a non-equilibrium
allocation. The solid arrow represents the graph F. The dashed arrow
represents the indifference of xb.
