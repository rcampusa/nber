                                 NBER WORKING PAPER SERIES




             AN INSTITUTIONAL THEORY OF MOMENTUM AND REVERSAL

                                           Dimitri Vayanos
                                            Paul Woolley

                                         Working Paper 14523
                                 http://www.nber.org/papers/w14523


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    December 2008




We thank Nick Barberis, Jonathan Berk, Bruno Biais, Pierre Collin-Dusfresne, Peter DeMarzo, Xavier
Gabaix, John Geanakoplos, Jennifer Huang, Ravi Jagannathan, Peter Kondor, Arvind Krishnamurthy,
Toby Moskowitz, Anna Pavlova, Lasse Pedersen, Christopher Polk, Matthew Pritzker Jeremy Stein,
Luigi Zingales, seminar participants at Chicago, Columbia, Lausanne, Leicester, LSE, Munich, Northwestern,
NYU, Oslo, Oxford, Stanford, Sydney, Toulouse, Zurich, and participants at the American Economic
Association 2010, American Finance Association 2010, CREST-HEC 2010, CRETE 2009, Gerzensee
2008 and NBER Asset Pricing 2009 conferences for helpful comments. Financial support from the
Paul Woolley Centre at the LSE is gratefully acknowledged. The views expressed herein are those
of the author(s) and do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2008 by Dimitri Vayanos and Paul Woolley. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
An Institutional Theory of Momentum and Reversal
Dimitri Vayanos and Paul Woolley
NBER Working Paper No. 14523
December 2008, Revised August 2010
JEL No. D5,D8,G1

                                               ABSTRACT

We propose a rational theory of momentum and reversal based on delegated portfolio management.
An investor can hold assets through an index or an active fund. Investing in the active fund involves
a time-varying cost, interpreted as managerial perk or ability. The investor responds to an increase
in the cost by flowing out of the active and into the index fund. While prices of assets held by the active
fund drop in anticipation of these outflows, the drop is expected to continue, leading to momentum.
Because outflows push prices below fundamental values, expected returns eventually rise, leading
to reversal. Besides momentum and reversal, fund flows generate comovement, lead-lag effects and
amplification, with all effects being larger for assets with high idiosyncratic risk. The active-fund manager’s
concern with commercial risk makes prices more volatile.


Dimitri Vayanos
Department of Finance, A350
London School of Economics
Houghton Street
London WC2A 2AE
UNITED KINGDOM
and CEPR
and also NBER
d.vayanos@lse.ac.uk

Paul Woolley
Financial Markets Group
London School of Economics
London WC2A 2AE
UNITED KINGDOM
p.k.woolley@lse.ac.uk
1     Introduction

Two of the most prominent financial-market anomalies are momentum and reversal. Momentum
is the tendency of assets with good (bad) recent performance to continue overperforming (under-
performing) in the near future. Reversal concerns predictability based on a longer performance
history: assets that performed well (poorly) over a long period tend to subsequently underperform
(overperform). Closely related to reversal is the value effect, whereby the ratio of an asset’s price
relative to book value is negatively related to subsequent performance. Momentum and reversal
have been documented extensively and for a wide variety of assets.1

    Momentum and reversal are viewed as anomalies because they are hard to explain within
the standard asset-pricing paradigm with rational agents and frictionless markets. The prevalent
explanations of these phenomena are behavioral, and assume that agents react incorrectly to in-
formation signals.2 In this paper we show that momentum and reversal can arise in markets with
rational agents. We depart from the standard paradigm by assuming that investors delegate the
management of their portfolios to financial institutions, such as mutual funds and hedge funds.

    Our explanation emphasizes the role of fund flows, and is loosely as follows. Suppose that a
negative shock hits the fundamental value of some assets. Investment funds holding these assets
realize low returns, triggering outflows by investors who update negatively about the ability of the
managers running these funds. As a consequence of the outflows, funds sell assets they own, and
this depresses further the prices of the assets hit by the original shock. If, in addition, outflows
are gradual because of institutional constraints (e.g., lock-up periods, institutional decision lags),
the selling pressure causes prices to decrease gradually, leading to momentum. At the same time,
because outflows push prices below fundamental values, expected returns eventually rise, leading
to reversal.

    In addition to deriving momentum and reversal with rational agents, we contribute to the liter-
ature by building an equilibrium model with delegated portfolio management that is parsimonious
and can speak to a broad range of phenomena. Delegation, to institutions such as mutual funds
    1
      Jegadeesh and Titman (1993) document momentum for individual US stocks, predicting returns over horizons
of 3-12 months by returns over the past 3-12 months. DeBondt and Thaler (1985) document reversal, predicting
returns over horizons of up to 5 years by returns over the past 3-5 years. Fama and French (1992) document the value
effect. This evidence has been extended to stocks in other countries (Fama and French 1998, Rouwenhorst 1998),
industry-level portfolios (Grinblatt and Moskowitz 1999), country indices (Asness, Liew, and Stevens 1997, Bhojraj
and Swaminathan 2006), bonds (Asness, Moskowitz and Pedersen 2008), currencies (Bhojraj and Swaminathan 2006)
and commodities (Gorton, Hayashi and Rouwenhorst 2008). Asness, Moskowitz and Pedersen (2008) extend and unify
much of this evidence and contain additional references.
    2
      See, for example, Barberis, Shleifer and Vishny (1998), Daniel, Hirshleifer and Subrahmanyam (1998), Hong and
Stein (1999), and Barberis and Shleifer (2003).


                                                         1
and hedge funds, is important in many markets. And while investors let fund managers invest on
their behalf, they move across funds, generating flows that are large and linked to the funds’ past
performance.3 Yet, incorporating delegation and fund flows into asset-pricing models is a daunting
task: it entails modeling multiple assets and funds, portfolio choice by fund managers (over assets)
and investors (over funds), and a motive for investors to be moving across funds, all in a dynamic
equilibrium setting. Our model includes these elements, while allowing for a tractable analysis of
fund flows and their price effects. The latter include not only momentum and reversal, but also
comovement, lead-lag effects, amplification, and the effects of managers’ concern with commercial
risk.

     Section 2 presents the model. We consider an infinite-horizon continuous-time economy with
multiple risky assets, to which we refer as stocks, and one riskless asset. A competitive investor
can invest in stocks through an index fund that holds the market portfolio, and through an active
fund run by a competitive manager. The active fund can add value over the index fund because
exogenous buy-and-hold investors hold stocks in different proportions than in the market portfolio:
the active fund overweighs “large residual supply” stocks, which are in low demand by buy-and-
hold investors and thus underpriced, and underweighs “small residual supply” stocks, which are in
high demand and overpriced.4 Flows between funds occur because the investor receives the return
of the active fund net of an exogenous time-varying cost, which can be interpreted as a managerial
perk or a reduced form for managerial ability. The manager determines the active fund’s portfolio,
and can invest his personal wealth in stocks through that fund. Both investor and manager are
infinitely lived and maximize expected utility of intertemporal consumption.

     Section 3 solves the model in the benchmark case of symmetric information, where the investor
observes the manager’s cost. When the cost increases, the investor flows out of the active and
into to the index fund. This amounts to a net sale of stocks in large residual supply, which the
active fund overweighs, and net purchase of stocks in small residual supply, which the active fund
underweighs. The manager takes the other side of this transaction by raising his stake in the
fund.5 Because the manager is risk-averse, stocks in large residual supply become cheaper and offer
   3
     According to the New York Stock Exchange Factbook, the fraction of stocks held directly by individuals in 2002
was less than 40%. The importance of fund flows and the link to past performance have been documented extensively.
See, for example, Chevalier and Ellison (1997) and Sirri and Tufano (1998) for mutual funds, and Fund, Hsieh, Naik
and Ramadorai (2008) and Ding, Getmansky, Liang and Wermers (2009) for hedge funds.
   4
     The assumption of buy-and-hold investors ensures that the “true” market portfolio, which characterizes equilib-
rium asset returns, differs from the market index tracked by the index fund. Such a difference would arise even in
the absence of buy-and-hold investors, provided that the market index is misconstructed, i.e., does not consist of one
share of each stock. For example, the index might not be including some stocks, which are instead accessible to the
active fund.
   5
     The manager performs two roles in our model: select the active portfolio and take the other side of the investor’s
transactions. Separating the two roles would complicate the model without changing the main mechanisms. See
Section 2 for further discussion.


                                                          2
higher expected return, while the opposite is true for stocks in small residual supply. Thus, the
investor’s flows generate return reversal, i.e., price changes forecast opposite changes in expected
returns. Moreover, since flows impact stocks in large and stocks in small residual supply in opposite
directions, they increase comovement within each group, while reducing comovement across groups.

    The return reversal derived in Section 3 arises at any horizon. To generate momentum in the
short run and reversal in the long run, we introduce the additional assumption that fund flows
exhibit inertia. Section 4 models inertia through an exogenous convex cost that the investor incurs
when changing her holdings of the active fund. In the presence of this adjustment cost, an increase
in the manager’s cost triggers gradual outflows from the active fund. Since these outflows are
anticipated and amount to net sales of stocks in large residual supply, they cause the prices of
these stocks to drop immediately. Yet, the drop is expected to continue, leading to momentum.
This result is puzzling: why is the manager willing to hold—and even overweigh—stocks that are
expected to underperform in the short run? The intuition is that these stocks offer the manager
an attractive return over a long horizon because the anticipation of future outflows renders them
underpriced. The manager could earn an even more attractive return, on average, by not holding
the stocks until after the outflows occur. This, however, exposes him to the risk that the outflows
might not occur, in which case the stocks would cease to be underpriced.6 Thus, the short-run price
drop is possible only because of the high long-run expected return; and more generally, momentum
is possible only because of the subsequent reversal.

    In addition to momentum, reversal and comovement, Sections 3 and 4 derive results on lead-lag
effects, idiosyncratic risk and commercial risk. Because changes in the manager’s cost impact the
prices and subsequent expected returns of all stocks, past returns of one stock forecast subsequent
returns of other stocks. For example, in Section 4, a price drop of a stock in high residual supply
forecasts that other stocks in high residual supply will drop in the short run but have a high return
in the long run. Momentum, reversal, comovement and lead-lag effects are larger for stocks with
high idiosyncratic risk because these stocks are more sensitive to flows between the active and the
index fund. Finally, when the manager receives a larger perk and is hence more concerned about
commercial risk (i.e., future outflows), returns become more volatile.

    Section 5 extends the analysis to the case of asymmetric information, where the investor does
not observe the manager’s cost and must infer it from fund performance. Asymmetric information
   6
     The following three-period example illustrates the point. A stock is expected to pay off at 100 in Period 2. The
stock price is 92 in Period 0, and 80 or 100 in Period 1 with equal probabilities. Buying the stock in Period 0 earns
the manager a two-period expected capital gain of 8. Buying in Period 1 earns an expected capital gain of 20 if the
price is 80 and 0 if the price is 100. A risk-averse manager might prefer earning 8 rather than 20 or 0 with equal
probabilities, even though the expected capital gain between Periods 0 and 1 is negative.



                                                         3
generates a causal link from performance to flows: if, for example, the active fund underperforms
relative to the index fund, the investor infers that the cost has increased and flows out of the
active and into the index fund. Causality from performance to flows implies that the latter can be
triggered by shocks to stocks’ cashflows—in contrast to the case of symmetric information, where
flows are driven only by changes in the cost.

       The fund flows triggered by cashflow shocks amplify the effect of these shocks on stock returns,
and generate momentum and reversal.7 Under asymmetric information, momentum and reversal
arise conditional not only on past returns, as under symmetric information, but also on past cashflow
shocks. Moreover, asymmetric information generates new channels of comovement and lead-lag
effects, as well as new effects of idiosyncratic and commercial risk. For example, a new channel
of comovement is that a cashflow shock to one stock induces fund flows which affect the prices
of other stocks. And a new effect of idiosyncratic risk is that cashflow shocks to stocks with
high idiosyncratic risk generate a higher discrepancy between the active and the index return, and
hence larger fund flows. Despite these new effects, the analysis of asymmetric information remains
tractable and has many formal similarities to that of symmetric information. For example, the
fund-flow-driven component of the covariance matrix of returns under asymmetric information is
equal to its symmetric-information counterpart times a multiplicative scalar—which is larger than
one because of the amplification effect of fund flows.

       Momentum and reversal have mainly been derived in behavioral models.8 In Barberis, Shleifer
and Vishny (1998), momentum arises because investors view random-walk earnings as mean-
reverting and under-react to news. In Hong and Stein (1999), prices under-react to news because
information diffuses slowly across investors and those last to receive it do not infer it from prices.
In Daniel, Hirshleifer and Subrahmanyam (1998), overconfident investors over-react to news be-
cause they underestimate the noise in their signals. Over-reaction builds up over time, leading to
momentum, because the self-attribution bias makes investors gradually more overconfident.

       Barberis and Shleifer (2003) is the behavioral model closest to our work. They assume that
stocks belong in styles and are traded between switchers, who over-extrapolate performance trends,
and fundamental investors. Following a stock’s bad performance, switchers become pessimistic
   7
     The mechanism for amplification is outlined in the third paragraph of the Introduction. The explanation in that
paragraph assumes asymmetric information, while the mechanism for momentum and reversal is broader and present
even under symmetric information (Section 4).
   8
     Rational models of momentum include Berk, Green and Naik (1999), Johnson (2002) and Shin (2006), in which
good news about a firm increase uncertainty and so raise the expected return required by investors. Albuquerque and
Miao (2010) derive both momentum and reversal in a model where some investors receive a signal about dividends
that is positively correlated with the return on a private investment technology. When the signal is high, the price goes
up, but so does the investment in the technology. Since investors bear more risk overall, expected return increases.



                                                           4
about the future performance of the corresponding style, and switch to other styles. Because the
extrapolation rule involves lags, switching is gradual and leads to momentum. Momentum requires
additionally that fundamental investors are myopic and do not anticipate the switchers’ flows.

    The equilibrium implications of delegated portfolio management are the subject of a growing
literature. In Shleifer and Vishny (1997), fund flows are an exogenous function of the funds’ past
performance, and amplify the effects of cashflow shocks. Amplification effects can also arise when
the equity stake of fund managers must exceed a lower bound because of optimal contracting under
moral hazard (He and Krishnamurthy 2009,2010), or when managers care about their reputation
(Guerreri and Kondor 2010).9 In Dasgupta, Prat and Verardo (2010), reputation concerns cause
managers to herd, and this generates momentum and reversal under the additional assumption
that the market makers trading with the managers are either monopolistic or myopic. In Basak
and Pavlova (2010), flows by investors benchmarked against an index cause stocks in the index to
comove.10 Besides deriving momentum and reversal with competitive and rational agents, we con-
tribute to that literature methodologically by bringing the analysis of delegation within a tractable
normal-linear framework that can address a broad range of phenomena.

    Finally, our emphasis on fund flows as generators of comovement and momentum is consistent
with recent empirical findings. Coval and Stafford (2007) find that mutual funds experiencing
large outflows engage in distressed selling of their stock portfolios. Anton and Polk (2010) and
Greenwood and Thesmar (2010) find that comovement between stocks is larger when these are
held by many mutual funds in common, controlling for style characteristics. Lou (2010) predicts
flows into mutual funds by the funds’ past performance, and imputes flows into individual stocks
according to stocks’ weight in funds’ portfolios. He finds that flows into stocks can explain up to
50% of stock-level momentum, especially for large stocks and in recent data where mutual funds
are more prevalent.
   9
     Amplification effects can also arise when agents face margin constraints or have wealth-dependent risk aversion.
See the survey by Gromb and Vayanos (2010).
  10
     Other models exploring equilibrium implications of delegated portfolio management include Brennan (1993),
Vayanos (2004), Dasgupta and Prat (2008), Petajisto (2009), Cuoco and Kaniel (2010), Kaniel and Kondor (2010)
and Malliaris and Yan (2010). See also Berk and Green (2004), in which fund flows are driven by fund performance
because investors learn about managers’ ability, and feed back into performance because of exogenous decreasing
returns to managing a large fund.




                                                         5
2    Model

Time t is continuous and goes from zero to infinity. There are N risky assets and a riskless asset.
We refer to the risky assets as stocks, but they could also be interpreted as industry-level portfolios,
asset classes, etc. The riskless asset has an exogenous, continuously compounded return r. The
stocks pay dividends over time, and their prices are determined endogenously in equilibrium. We
denote by Dnt the cumulative dividend per share of stock n = 1, .., N , and by Snt the stock’s
price. We specify the stochastic process for dividends later in this section. By possibly redefining
dividends, we normalize the supply of each stock to one share.

    A competitive investor can invest in the riskless asset and in the stocks. The investor can
access the stocks only through two investment funds. The first fund is passively managed and
tracks mechanically the market index, i.e., holds stocks according to their supplies. Since all stocks
are in supply of one share, the index fund holds an equal number of shares of each stock. The
second fund is actively managed and selects an optimal portfolio in a way specified later in this
section. We assume two investment funds, rather than only one, so that we can examine flows
between funds. The assumption that one of the funds is indexed avoids the difficulty of having to
solve for that fund’s optimal portfolio.

    Flows between the two funds can occur only if the funds hold different portfolios. To generate
different portfolios, we assume that part of each stock’s supply is held by an exogenous set of agents
who do not trade. These agents could be the firm’s managers or founding families, or unmodeled
investors. We refer to them as buy-and-hold investors, and denote by 1− θn the number of shares of
stock n that they hold. The residual supply of stock n, left over from buy-and-hold investors, is θn
shares. This is absorbed by the index fund, which holds an equal number of shares of each stock,
and the active fund. If, therefore, residual supply differs across stocks, the active fund holds a
different portfolio than the index fund in equilibrium: it overweighs stocks in large residual supply
(high θn ) and underweighs stocks in small residual supply (low θn ). Moreover, the active portfolio
dominates the index portfolio. Indeed, since prices adjust in equilibrium so that the active fund is
induced to accommodate discrepancies in stocks’ residual supplies, stocks in large residual supply
(which are overweighed by the active fund) are cheap, while stocks in small residual supply (which
are underweighed) are expensive.

    The investor determines how to allocate her wealth between the riskless asset, the index fund,
and the active fund. She maximizes expected utility of intertemporal consumption. Utility is




                                                   6
exponential, i.e.,
           Z       ∞
      −E               exp(−αct − βt)dt,                                                                       (2.1)
               0


where α is the coefficient of absolute risk aversion, ct is consumption, and β is the discount rate.
The investor’s control variables are consumption ct and the number of shares xt and yt of the index
and active fund, respectively.

    The active fund is run by a competitive manager, who can also invest his personal wealth in
the fund. The manager determines the active portfolio and the allocation of his wealth between the
riskless asset and the fund. He maximizes expected utility of intertemporal consumption. Utility
is exponential, i.e.,
           Z       ∞
      −E               exp(−ᾱc̄t − β̄t)dt,                                                                    (2.2)
               0


where ᾱ is the coefficient of absolute risk aversion, c̄t is consumption, and β̄ is the discount rate.
The manager’s control variables are consumption c̄t , the number of shares ȳt of the active fund, and
the active portfolio zt ≡ (z1t , .., zN t ), where znt denotes the number of shares of stock n included
in one share of the active fund.

    Under the assumptions introduced so far, and in the absence of other frictions, the equilibrium
takes a simple form. As we show in Section 3, the investor holds stocks only through the active
fund since its portfolio dominates the index portfolio. As a consequence, the active fund holds
the entire residual supply of each stock, its portfolio is constant over time, and there are no flows
between the two funds.

    To generate fund flows, we introduce an additional element into our model. We assume that
the investor’s return from the active fund is equal to the gross return, made of the dividends and
capital gains of the stocks held by the fund, net of a time-varying cost. We interpret this cost as a
managerial perk, and discuss additional interpretations later in this section.11 Empirical evidence
on the existence of a time-varying cost impacting the returns to fund investors is provided in a
number of papers.12 For simplicity, we assume that the index fund entails no cost, so its gross and
net returns coincide.
  11
     An example of a managerial perk is late trading, whereby managers use their privileged access to the fund to
buy or sell fund shares at stale prices. Late trading was common in many funds and led to the 2003 mutual-fund
scandal. A related example is soft-dollar commissions, whereby funds inflate their brokerage commissions to pay for
services that mainly benefit managers, e.g., promote the fund to new investors, or facilitate managers’ late trading.
  12
     Empirical papers measure the cost by the return gap, defined as the difference between a mutual fund’s return
over a given quarter and the return of a hypothetical portfolio invested in the stocks that the fund holds at the
beginning of the quarter. Kacperczyk, Sialm and Zhang (2008) show that the return gap varies significantly across


                                                         7
     We model the cost as a flow (i.e., the cost between t and t + dt is of order dt), and assume that
the flow cost is proportional to the number of shares yt that the investor holds in the active fund.
We denote the coefficient of proportionality by Ct and assume that it follows the process

      dCt = κ(C̄ − Ct )dt + sdBtC ,                                                                              (2.3)

where κ is a mean-reversion parameter, C̄ is a long-run mean, s is a positive scalar, and BtC is a
Brownian motion. The mean-reversion of Ct is not essential for momentum and reversal, which
occur even when κ = 0.

     We allow the manager to derive a benefit from the investor’s participation in the active fund.
This benefit can be interpreted as a managerial perk or a fee. We model the benefit in the same
way as the cost, i.e., a flow which is proportional to the number of shares yt that the investor holds
in the active fund. If the cost is a perk that the manager can extract efficiently, then the coefficient
of proportionality for the benefit is Ct . We allow more generally the coefficient of proportionality
to be λCt + B, where λ and B are scalars. The parameter λ can be interpreted as the efficiency of
perk extraction, while the parameter B can derive from a constant fee.13

     Varying the parameters λ and B generates a rich specification of the manager’s objective.
When λ = B = 0, the manager cares about fund performance only through his personal investment
in the fund, and his objective is similar to the fund investor’s. When instead λ and B are positive,
the manager is also concerned with commercial risk, i.e., the risk that the investor might reduce her
participation in the fund. The parameters λ and B are not essential for momentum and reversal,
which occur even when λ = B = 0. As we show in later sections, λ affects the size of momentum
relative to reversal, while B affects only the average mispricing.

     The cost and benefit are assumed proportional to yt for analytical convenience. At the same
time, these variables are sensitive to how shares of the active fund are defined (e.g., they change
with a stock split). We define one share of the fund by the requirement that its market value equals
the equilibrium market value of the entire fund. Under this definition, the number of fund shares
funds and over time, and is persistent with a half-life of about three years. The high persistence indicates that the
return gap is linked to underlying fund characteristics—and there is indeed a correlation with fund-specific measures
of agency costs and trading costs. Because of its significant cross-sectional variation and persistence, the return gap
a good forecaster of future returns: funds whose return gap is in the top decile outperform the market by an average
1.2% over the next year, while funds in the bottom decile underperform by 2.2%. Earlier studies that use the return
gap and link it to fund characteristics include Grinblatt and Titman (1989) and Wermers (2000).
   13
      If, for example, the cost Ct yt is the sum of a fee F yt and a perk (Ct − F )yt , and the manager can extract a
fraction λ of the perk, then the benefit is
      [F + λ(Ct − F )] yt = [λCt + (1 − λ)F ] yt ,
which has the assumed form with B = (1 − λ)F .


                                                          8
held by the investor and the manager in equilibrium sum to one, i.e.,

      yt + ȳt = 1.                                                                                 (2.4)

We define one share of the index fund to consist of one share of each stock, and refer to the
corresponding vector 1 ≡ (1, .., 1) as the market portfolio. We refer to the vector θ ≡ (θ1 , .., θN ) of
the stocks’ residual supplies as the residual-supply portfolio. We define the constant

      ∆ ≡ θΣθ ′ 1Σ1′ − (1Σθ ′ )2 ,

which is positive and becomes zero when the vectors 1 and θ are collinear.

    The manager observes all the variables in the model. The investor observes the returns and
share prices of the index and active funds, but not the same variables for the individual stocks.
We study both the case of symmetric information, where the investor observes the cost Ct , and
that of asymmetric information, where Ct is observable only by the manager. In the asymmetric-
information case, the investor seeks to infer Ct from the returns and share prices of the index and
active funds. The symmetric-information case is simpler analytically and delivers most of our main
results, including momentum and reversal. The asymmetric-information case is more realistic and
delivers some additional results.

    We denote the vector of stocks’ cumulative dividends by Dt ≡ (D1t , .., DN t )′ and the vector of
stock prices by St ≡ (S1t , .., SN t )′ , where v ′ denotes the transpose of the vector v. We assume that
Dt follows the process

      dDt = Ft dt + σdBtD ,                                                                         (2.5)

where Ft ≡ (F1t , .., FN t )′ is a time-varying drift equal to the instantaneous expected dividend, σ is a
constant matrix of diffusion coefficients, and BtD is a d-dimensional Brownian motion independent
of BtC . The expected dividend Ft is observable only by the manager. Time-variation in Ft is not
essential in the symmetric-information case, where momentum and reversal occur even when Ft
is a constant parameter known to the investor. Time-variation in Ft becomes essential for the
analysis of asymmetric information: with a constant Ft , the investor would infer Ct perfectly from
the share price of the active fund, and information would be symmetric. We model time-variation
in Ft through the process

      dFt = κ(F̄ − Ft )dt + φσdBtF                                                                  (2.6)



                                                    9
where the mean-reversion parameter κ is the same as for Ct for simplicity, F̄ is a long-run mean, φ
is a positive scalar, and BtF is a d-dimensional Brownian motion independent of BtC and BtD . The
diffusion matrices for Dt and Ft are proportional for simplicity.

     We finally comment on the assumption that the manager can invest his personal wealth in
the active fund. This assumption generates a simple objective that the manager maximizes when
choosing the fund’s portfolio.14 It also ensures that the manager acts as trading counterparty to
the investor: when Ct increases and the investor reduces her holdings of the active fund, effectively
selling the stocks held by the fund, the manager takes the other side by raising his stake in the
fund. Under the alternative assumption that the manager must invest his personal wealth in the
riskless asset, we would need to introduce additional “smart-money” investors who could access
stocks directly and act as counterparty to the fund investor. This would complicate the model
without changing the basic mechanisms.

     Note that in a model with smart-money investors, additional interpretations of the cost are
possible. Two interpretations not emphasized so far are an operational cost (e.g., trading cost)
and a reduced form for low managerial stock-picking ability. These additional interpretations are
not consistent with the assumption that the manager can invest his personal wealth in the active
fund. Indeed, the cost would then impact not only the investor’s holdings in the fund yt , as we
are assuming, but also the manager’s holdings ȳt . The additional interpretations, however, are
consistent with a model with smart-money investors: since these investors do not invest in the
active fund, their investments are not affected by the cost.



3     Symmetric Information

This section solves the model presented in the previous section in the case of symmetric information,
where the cost Ct is observable by both the investor and the manager. We look for an equilibrium
in which stock prices take the form

             F̄   Ft − F̄
      St =      +         − (a0 + a1 Ct ),                                                                      (3.1)
             r     r+κ
  14
     Restricting the manager not to invest his personal wealth in the index fund is also in the spirit of generating a
simple objective. Indeed, in the absence of this restriction, the active portfolio would be indeterminate: the manager
could mix a given active portfolio with the index, and make that the new active portfolio, while achieving the same
personal portfolio through an offsetting short position in the index. Note that restricting the manager not to invest
in the index only weakly constrains his personal portfolio since he can always modify the portfolio of the active fund
and his stake in that fund.




                                                         10
where (a0 , a1 ) are constant vectors. The first two terms are the present value of expected dividends,
discounted at the riskless rate r, and the last term is a risk premium linear in Ct . As we show later
in this section, the risk premium moves in response to fund flows. The investor’s holdings of the
active fund in our conjectured equilibrium are

      y t = b0 − b1 C t ,                                                                         (3.2)

where (b0 , b1 ) are constants. We expect b1 to be positive, i.e., the investor reduces her holdings of
the fund when Ct is high. We refer to an equilibrium satisfying (3.1) and (3.2) as linear.



3.1   Manager’s Optimization

The manager chooses the active fund’s portfolio zt , the number ȳt of fund shares that he owns, and
consumption c̄t . The manager’s budget constraint is

      dWt = rWt dt + ȳt zt (dDt + dSt − rSt dt) + (λCt + B)yt dt − c̄t dt.                       (3.3)

The first term is the return from the riskless asset, the second term is the return from the active
fund in excess of the riskless asset, the third term is the manager’s benefit from the investor’s
participation in the fund, and the fourth term is consumption. To compute the return from the
active fund, we note that since one share of the fund corresponds to zt shares of the stocks,
the manager’s effective stock holdings are ȳt zt shares. These holdings are multiplied by the vector
dRt ≡ dDt +dSt −rStdt of the stocks’ excess returns per share (referred to as returns, for simplicity).
Using (2.3), (2.5), (2.6) and (3.1), we can write the vector of returns as

                                                               φdBtF
                                                                      
                                                      dBtD                 − sa1 dBtC .
                                          
      dRt = ra0 + (r + κ)a1 Ct − κa1 C̄ dt + σ               +                                    (3.4)
                                                               r+κ

Returns depend only on the cost Ct , and not on the expected dividend Ft . The covariance matrix
of returns is

      Covt (dRt , dRt′ ) = f Σ + s2 a1 a′1 dt,
                                          
                                                                                                  (3.5)

where f ≡ 1 + φ2 /(r + κ)2 and Σ ≡ σσ ′ . The matrix f Σ represents the covariance driven purely
by dividend (i.e., cashflow) news, and we refer to it as fundamental covariance. The matrix s2 a1 a′1
represents the additional covariance introduced by fund flows, and we refer to it as non-fundamental
covariance.


                                                   11
    The manager’s optimization problem is to choose controls (c̄t , ȳt , zt ) to maximize the expected
utility (2.2) subject to the budget constraint (3.3) and the investor’s holding policy (3.2). The
active fund’s portfolio zt satisfies, in addition, the normalization

      zt St = (θ − xt 1)St .                                                                             (3.6)

This is because one share of the active fund is defined so that its market value equals the equilibrium
market value of the entire fund. Moreover, the latter is (θ −xt 1)St because in equilibrium the active
fund holds the residual-supply portfolio θ minus the investor’s holdings xt 1 of the index fund. We
conjecture that the manager’s value function is
                                                            
                                                     1      2
      V̄ (Wt , Ct ) ≡ − exp − r ᾱWt + q̄0 + q̄1 Ct + q̄11 Ct    ,                                       (3.7)
                                                     2

where (q̄0 , q̄1 , q̄11 ) are constants. The Bellman equation is

                                       
       max − exp(−ᾱc̄t ) + D V̄ − β̄ V̄ = 0,                                                            (3.8)
      c̄t ,ȳt ,zt


where D V̄ is the drift of the process V̄ under the controls (c̄t , ȳt , zt ). Proposition 3.1 shows that
the value function (3.7) satisfies the Bellman equation if (q̄0 , q̄1 , q̄11 ) satisfy a system of three scalar
equations.


Proposition 3.1 The value function (3.7) satisfies the Bellman equation (3.8) if (q̄0 , q̄1 , q̄11 ) satisfy
a system of three scalar equations.


    In the proof of Proposition 3.1 we show that the optimization over (c̄t , ȳt , zt ) can be reduced
to optimization over the manager’s consumption c̄t and effective stock holdings ẑt ≡ ȳt zt . Given
ẑt , the decomposition between ȳt and zt is determined by the normalization (3.6). The first-order
condition with respect to ẑt is

      Et (dRt ) = r ᾱCovt (dRt , ẑt dRt ) + (q̄1 + q̄11 Ct )Covt (dRt , dCt ).                         (3.9)

Eq. (3.9) links expected stock returns to the risk faced by the manager. The expected return that
the manager requires from a stock depends on the stock’s covariance with the manager’s portfolio
ẑt (first term in the right-hand side), and on the covariance with changes to the cost Ct (second
term). The latter effect reflects a hedging demand by the manager. We derive the implications of
(3.9) for the cross section of expected returns later in this section.

                                                         12
3.2    Investor’s Optimization

The investor chooses a number of shares xt in the index fund and yt in the active fund, and
consumption ct . The investor’s budget constraint is

      dWt = rWt dt + xt 1dRt + yt (zt dRt − Ct dt) − ct dt.                                                (3.10)

The first three terms are the returns from the riskless asset, the index fund, and the active fund
(net of the cost Ct ), and the fourth term is consumption. The investor’s optimization problem is to
choose controls (ct , xt , yt ) to maximize the expected utility (2.1) subject to the budget constraint
(3.10). The investor takes the active fund’s portfolio zt as given and equal to its equilibrium value
θ − xt 1. We conjecture that the investor’s value function is
                                                          
                                                    1     2
      V (Wt , Ct ) ≡ − exp − rαWt + q0 + q1 Ct + q11 Ct        ,                                           (3.11)
                                                    2

where (q0 , q1 , q11 ) are constants. The Bellman equation is

       max [− exp(−αct ) + DV − βV ] = 0,                                                                  (3.12)
      ct ,xt ,yt


where DV is the drift of the process V under the controls (ct , xt , yt ). Proposition 3.2 shows that the
value function (3.11) satisfies the Bellman equation (3.12) if (q0 , q1 , q11 ) satisfy a system of three
scalar equations. The proposition shows additionally that the optimal control yt is linear in Ct , as
conjectured in (3.2).


Proposition 3.2 The value function (3.11) satisfies the Bellman equation (3.12) if (q0 , q1 , q11 )
satisfy a system of three scalar equations. The optimal control yt is linear in Ct .


    In the proof of Proposition 3.2, we show that the first-order conditions with respect to xt and
yt are
      Et (1dRt ) = rαCovt [1dRt , (xt 1 + yt zt )dRt ] + (q1 + q11 Ct )Covt (1dRt , dCt ),                 (3.13)

      Et (zt dRt ) − Ct dt = rαCovt [zt dRt , (xt 1 + yt zt )dRt ] + (q1 + q11 Ct )Covt (zt dRt , dCt ),   (3.14)

respectively. Eqs. (3.13) and (3.14) are analogous to the manager’s first-order condition (3.9) in that
they equate expected returns to risk. The difference with (3.9) is that the investor is constrained to
two portfolios rather than N individual stocks. Eq. (3.9) is a vector equation with N components,
while (3.13) and (3.14) are scalar equations derived by pre-multiplying expected returns with the
vectors 1 and zt of index- and active-fund weights. Note that the investor’s expected return from
the active fund in (3.14) is net of the cost Ct .

                                                        13
3.3      Equilibrium

In equilibrium, the active fund’s portfolio zt is equal to θ − xt 1, and the shares held by the manager
and the investor sum to one. Combining these equations with the first-order conditions (3.9),
(3.13) and (3.14), and the value-function equations (Propositions 3.1 and 3.2), yields a system
of equations characterizing a linear equilibrium. Proposition 3.3 shows that a linear equilibrium
exists, and determines a sufficient condition for uniqueness.


Proposition 3.3 There exists a linear equilibrium. The constant b1 is positive and the vector a1
is given by

        a1 = γ1 Σp′f ,                                                                                         (3.15)

where γ1 is a positive constant and

                   1Σθ ′
        pf ≡ θ −         1                                                                                     (3.16)
                   1Σ1′

is the “flow portfolio.” There exists a unique linear equilibrium if λ < λ̄ for a constant λ̄ > 0.15


       Proposition 3.3 can be specialized to the benchmark case of costless delegation, where the
investor’s cost Ct of investing in the active fund is constant and equal to zero. This case can be
derived by setting Ct , as well as its long-run mean C̄ and diffusion coefficient s, to zero.


Corollary 3.1 (Costless Delegation) When Ct = C̄ = s = 0, the investor holds yt = ᾱ/(α + ᾱ)
shares of the active fund and xt = 0 shares of the index fund. Stocks’ expected returns are given by
the one-factor model

                      rαᾱf             rαᾱ
        Et (dRt ) =          Σθ ′ dt =        Covt (dRt , θdRt ),                                              (3.17)
                      α + ᾱ           α + ᾱ

with the factor being the residual-supply portfolio θ.


       The investor holds only the active fund because it offers a superior portfolio than the index fund
at no cost. The relative shares of the investor and the manager in the active fund are determined
  15
    We conjecture that uniqueness holds even if λ ≥ λ̄. Moreover, most of the properties that we derive hold in any
linear equilibrium: this applies, for example, to (3.15) and γ1 > 0, as we show in the proof of Proposition 3.3, and to
Corollaries 3.2-3.6.


                                                          14
by their risk-aversion coefficients, according to optimal risk-sharing. Stocks’ expected returns are
determined by the covariance with the residual-supply portfolio. The intuition for the latter result
is that since the index fund receives zero investment, the residual-supply portfolio coincides with the
active portfolio zt , which is also the portfolio held by the manager. Since the manager determines
the cross section of expected returns through the first-order condition (3.9), and there is no hedging
demand because Ct is constant, the residual-supply portfolio is the only pricing factor. Note that
when Ct = C̄ = s = 0, expected returns are constant over time. Thus, return predictability can
arise only because of time-variation in Ct . We next allow Ct to vary over time, and determine the
effects on fund flows, prices and expected returns.


Corollary 3.2 (Fund Flows) The change in the investor’s effective stock holdings, caused by a
change in Ct , is proportional to the flow portfolio pf :

       ∂(xt 1 + yt zt )
                        = −b1 pf .                                                                           (3.18)
            ∂Ct


    Following an increase in the cost Ct of investing in the active fund, the investor flows out
of that fund and into the index fund. The net change in the investor’s effective stock holdings
is proportional to the flow portfolio pf , defined in (3.16). This portfolio consists of the residual-
supply portfolio θ, plus a position in the market portfolio 1 that renders the covariance with the
market equal to zero.16 The intuition why the flow portfolio characterizes fund flows is as follows.
Following an increase in Ct , the investor reduces her investment in the active fund, thus selling
a slice of the residual-supply portfolio. She also increases her investment in the index fund, thus
buying a slice of the market portfolio. Because investing in the index fund is costless, the investor
maintains a constant overall exposure to the market. Therefore, the net change in her portfolio is
uncorrelated with the market, which means that she is selling a slice of the flow portfolio.

    In selling a slice of the flow portfolio, the investor is effectively selling some stocks and buying
others. The stocks being sold are in large residual supply and correspond to long positions in the
flow portfolio, while the stocks being bought are in small residual supply and correspond to short
positions. Thus, when the investor flows out of the active fund and into the index fund, she sells
stocks that the active fund overweighs relative to the index fund, and buys stocks that the active
fund underweighs.

  16
     The zero covariance between the market and the flow portfolio follows from the more general result of Corollary
3.3: premultiply the last equality in (3.19) by 1 and note that 1ǫt = 0.


                                                        15
Corollary 3.3 (Prices) The change in stock prices, caused by a change in Ct , is proportional to
stocks’ covariance with the flow portfolio pf :

      ∂St                   γ1                                   γ1
          = −γ1 Σp′f = −      2 2   Cov(dR t , p f dR t ) = −     s2 γ12 ∆
                                                                           Covt (dǫt , pf dǫt ),   (3.19)
      ∂Ct                    s γ1 ∆
                         f + 1Σ1  ′                           f + 1Σ1    ′



where dǫt ≡ (dǫ1t , .., dǫN t )′ denotes the residual from a regression of stock returns dRt on the market
return 1dRt .


    An increase in Ct lowers the prices of stocks that covary positively with the flow portfolio and
raises the prices of stocks covarying negatively. This price impact arises because of two distinct
mechanisms: an intuitive mechanism involving fund flows, and a more subtle mechanism involving
the manager’s hedging demand that we discuss at the end of this section. The fund-flows mechanism
is as follows. When Ct increases, the investor sells a slice of the flow portfolio, which is acquired by
the manager. As a result, the manager requires higher expected returns from stocks that covary
positively with the flow portfolio, and the price of these stocks decreases. Conversely, the expected
returns of stocks that covary negatively with the flow portfolio decrease, and their price increases.

    A stock’s covariance with the flow portfolio can be characterized in terms of idiosyncratic risk.
The last equality in Corollary 3.3 implies that the covariance is positive if the stock’s idiosyncratic
movement dǫnt (i.e., the part of its return that is orthogonal to the index) covaries positively with
the idiosyncratic movement of the flow portfolio. This is likely to occur when the stock is in large
residual supply, because it then corresponds to a long position in the flow portfolio. Thus, stocks in
large residual supply, which the active fund overweighs, are likely to drop when the investor flows
out of the active fund and into the index fund. Conversely, stocks in small residual supply, which
the active fund underweighs, are likely to rise.

    While residual supply influences the sign of a stock’s covariance with the flow portfolio, idiosyn-
cratic risk influences the magnitude: stocks with high idiosyncratic risk have higher covariance with
the flow portfolio in absolute value, and are therefore more affected by changes in Ct . The intuition
can be seen from the extreme case of a stock with no idiosyncratic risk. Since changes in Ct do
not change the investor’s overall exposure to the market, they also do not change her willingness
to carry market risk. Therefore, they do not affect the price of the market portfolio, or of a stock
carrying only market risk.

    Since changes in Ct , and the fund flows they trigger, affect prices, they contribute to comove-
ment between stocks. Recall from (3.5) that the covariance matrix of stock returns is the sum of a

                                                      16
fundamental covariance, driven purely by cashflows, and a non-fundamental covariance, introduced
by fund flows. Using Proposition 3.3, we can compute the non-fundamental covariance.


Corollary 3.4 (Comovement) The covariance matrix of stock returns is

      Covt (dRt , dRt′ ) = f Σ + s2 γ12 Σp′f pf Σ dt.
                                                 
                                                                                               (3.20)

The non-fundamental covariance is positive for stock pairs whose covariance with the flow portfolio
has the same sign, and is negative otherwise.


    The non-fundamental covariance between a pair of stocks is proportional to the product of
the covariances between each stock in the pair and the flow portfolio. It is thus large in absolute
value when the stocks have high idiosyncratic risk, because they are more affected by changes in
Ct . Moreover, it can be positive or negative: positive for stock pairs whose covariance with the
flow portfolio has the same sign, and negative otherwise. Intuitively, two stocks move in the same
direction in response to fund flows if they are both overweighed or both underweighed by the active
fund, but move in opposite directions if one is overweighed and the other underweighed.

    The effect of Ct on expected returns goes in the opposite direction than the effect on prices.
We next determine more generally the cross section of expected returns.


Corollary 3.5 (Expected Returns) Stocks’ expected returns are given by the two-factor model

                     rαᾱ 1Σθ ′
      Et (dRt ) =               Covt (dRt , 1dRt ) + Λt Covt (dRt , pf dRt ),                  (3.21)
                    α + ᾱ 1Σ1′

with the factors being the market and the flow portfolio. The factor risk premium Λt associated to
the flow portfolio is

                                              s2 (αq̄1 + ᾱq1 )
                                                               
            rαᾱ     γ1
      Λt =       +                (r + κ)Ct −                     .                            (3.22)
           α + ᾱ f + s2 γ12 ∆′                    α + ᾱ
                      1Σ1


    The presence of the flow portfolio as a priced factor can be viewed as a mispricing relative to a
CAPM in which the only factor is the market portfolio. The factor risk premium Λt associated to
the flow portfolio measures the severity of the mispricing. Note that the mispricing exists even when
delegation is costless (and it is because of this mispricing that the active fund is attractive to the
investor). Indeed, Corollary 3.1 shows that with costless delegation, expected returns are described

                                                        17
by a one-factor model, with the factor being the residual-supply portfolio rather than the market.
This one-factor model is also implied from Corollary 3.5. Indeed, setting Ct = C̄ = s = 0 in (3.22),
we find that the risk premia associated to the two factors are constant over time, and therefore
the two factors can be reduced to one. Moreover, the factor risk premium Λt , which measures the
mispricing, is positive. When Ct varies over time, so does Λt , and the two factors cannot be reduced
to one. An increase in Ct raises Λt and renders the mispricing more severe: stocks overweighed
by the active fund become more underpriced and their expected returns increase, while stocks
underweighed by the active fund become more overpriced and their expected returns decrease.
Note that changes in Ct are the only driver of time-variation in expected returns.

    The time-variation in expected returns gives rise to predictability. We examine predictability
based on past returns. As in the rest of our analysis, we evaluate returns over an infinitesimal
time period; returns thus concern a single point in time. We compute the covariance between
the vector of returns at time t and the same vector at time t′ > t. Corollary 3.6 shows that this
autocovariance matrix is equal to the non-fundamental (contemporaneous) covariance matrix times
a negative scalar.


Corollary 3.6 (Return Predictability) The covariance between stock returns at time t and
those at time t′ > t is

                                                 ′
      Covt (dRt , dRt′ ′ ) = −s2 (r + κ)γ12 e−κ(t −t) Σp′f pf Σ(dt)2 .                          (3.23)

A stock’s return predicts negatively the stock’s subsequent return (return reversal). It predicts
negatively the subsequent return of another stock when the covariance between each stock in the pair
and the flow portfolio has the same sign (negative lead-lag effect), and positively otherwise (positive
lead-lag effect).


    Since the diagonal elements of the autocovariance matrix are negative, stocks exhibit negative
autocovariance, i.e., return reversal. This is because expected returns vary over time only in
response to changes in Ct , and these changes move prices in the opposite direction. Thus, a lower-
than-expected price predicts a higher-than-expected subsequent return, and vice-versa.

    The non-diagonal elements of the autocovariance matrix characterize lead-lag effects, i.e.,
whether the past return of one stock predicts the future return of another. Lead-lag effects are
negative for stock pairs whose covariance with the flow portfolio has the same sign, and are positive
otherwise. For example, when the sign is the same, changes in Ct move the prices of both stocks in

                                                        18
the same direction and their expected returns in the opposite direction. Therefore, a lower-than-
expected price of one stock predicts a higher-than-expected subsequent return of the other, and
vice-versa.

       We next examine how prices and expected returns depend on the manager’s concern with
commercial risk, i.e., the risk that the investor might reduce her participation in the fund. Recall
that the manager derives the benefit (λCt + B)yt from the investor’s participation, where yt is the
number of shares owned by the investor, λ is the efficiency of perk extraction, and B is a fee.


Corollary 3.7 (Commercial Risk) An increase in λ raises γ1 , and thus increases the non-
fundamental volatility of stock returns and the extent of return reversal. An increase in B has
no effect on γ1 , but raises Λt , and thus increases the average mispricing.


       Since B raises Λt , it exacerbates the mispricing that the active fund seeks to exploit: stocks
that the active fund overweighs become more underpriced, while stocks that it underweighs become
more overpriced. Thus, a manager concerned with losing his fee is less willing to trade against
mispricings. A common intuition for this result is that the manager fears that mispricings might
worsen, in which case the fund will perform poorly and outflows will occur.17 In the symmetric-
information case, where the investor observes Ct , the causality is not from performance to flows, as
the previous intuition requires, but from flows to performance: an increase in Ct triggers outflows
from the active fund, and the negative price pressure these exert on the stocks that the fund
overweighs impairs fund performance. The intuition for the effect of B is different as well: a
manager concerned with losing his fee seeks to hedge against increases in Ct since these trigger
outflows. Hedging requires the manager to hold stocks that perform well when Ct increases. These
are the stocks that the active fund underweighs, and the manager’s hedging demand renders these
stocks more overpriced.

       The parameter B has an effect only on the average mispricing, but not on how the mispricing
varies with Ct . By contrast, λ renders the mispricing more sensitive to Ct , i.e., raises γ1 . Indeed,
λ > 0 implies that when Ct increases, the manager can extract a larger perk from each share
of the fund held by the investor, and is therefore more willing to hedge against future changes
in Ct . Thus, an increase in Ct not only generates outflows, but also makes the manager more
  17
    This is, for example, the mechanism in Shleifer and Vishny (1997), who assume that fund flows are an exogenous
function of fund performance. Causality from performance to flows is endogenous in our model, and arises in the
asymmetric-information case, where the investor does not observe Ct and seeks to infer it from fund performance. In
the asymmetric-information case, B raises Λt because of a mechanism similar to that in Shleifer and Vishny.




                                                        19
concerned with future outflows.18 As a consequence, the manager’s hedging demand increases, and
this adds to the mispricing caused by current outflows. Note that since λ raises γ1 , it also increases
non-fundamental volatility and comovement (Corollary 3.4), as well as return reversal (Corollary
3.6). Thus, the manager’s demand to hedge against outflows can have the perverse effect to render
returns more volatile.



4     Gradual Adjustment

Section 3 shows that returns exhibit reversal at any horizon. To generate short-run momentum
and long-run reversal, we need the additional assumption that fund flows exhibit inertia, i.e., the
investor can adjust her fund holdings to new information only gradually. Gradual adjustment can
result from contractual restrictions or institutional decision lags.19 We model these frictions as a
flow cost ψ(dyt /dt)2 /2 that the investor must incur when changing the number yt of active-fund
shares that she owns. The advantage of the quadratic cost over other formulations (such as an
upper bound on |dyt /dt|) is that it preserves the linearity of the model.

     We maintain the assumption that information about Ct is symmetric, and look for an equilib-
rium in which stock prices take the form

             F̄   Ft − F̄
      St =      +         − (a0 + a1 Ct + a2 yt ),                                                              (4.1)
             r     r+κ

where (a0 , a1 , a2 ) are constant vectors. The number yt of active-fund shares that the investor owns
becomes a state variable and affects prices since it cannot be set instantaneously to its optimal
level. The investor’s speed of adjustment vt ≡ dyt /dt in our conjectured equilibrium is

      vt = b0 − b1 Ct − b2 yt ,                                                                                 (4.2)

where (b0 , b1 , b2 ) are constants. We expect (b1 , b2 ) to be positive, i.e., the investor reduces her
investment in the active fund faster when Ct or yt are large. We refer to an equilibrium satisfying
(4.1) and (4.2) as linear.
  18
     The same effect would arise under the non-perk interpretations of the cost, discussed at the end of Section 2, if
the manager’s benefit is assumed concave in the number of shares yt owned by the investor.
  19
     An example of contractual restrictions is lock-up periods, often imposed by hedge funds, which require investors
not to withdraw capital for a pre-specified time period. Institutional decision lags can arise for investors such as
pension funds, foundations or endowments, where decisions are made by boards of trustees that meet infrequently.
The inertia in capital flows and its relevance for asset prices are emphasized in Duffie’s (2010) presidential address
to the American Finance Association.




                                                         20
4.1     Optimization


The manager chooses controls (c̄t , ȳt , zt ) to maximize the expected utility (2.2) subject to the budget
constraint (3.3), the normalization (3.6), and the investor’s holding policy (4.2). Since stock prices
depend on (Ct , yt ), the same is true for the manager’s value function. We conjecture that the value
function is
                                                                        
                                                                1 ′
       V̄ (Wt , X̄t ) ≡ − exp − r ᾱWt + q̄0 + (q̄1 , q̄2 )X̄t + X̄t Q̄X̄t ,                               (4.3)
                                                                2

where X̄t ≡ (Ct , yt )′ , (q̄0 , q̄1 , q̄2 ) are constants, and Q̄ is a constant symmetric 2 × 2 matrix.


Proposition 4.1 The value function (4.3) satisfies the Bellman equation (3.8) if (q̄0 , q̄1 , q̄2 , Q̄)
satisfy a system of six scalar equations.


      The investor chooses controls (ct , xt , vt ) to maximize the expected utility (2.1) subject to the
budget constraint

                                                     1
       dWt = rWt dt + xt 1dRt + yt (zt dRt − Ct dt) − ψvt2 dt − ct dt                                      (4.4)
                                                     2

and the manager’s portfolio policy zt = θ − xt 1. We study this optimization problem in two steps.
In a first step, we optimize over (ct , xt ), assuming that vt is given by (4.2). We solve this problem
using dynamic programming, and conjecture the value function
                                                             
                                                        1 ′
       V (Wt , Xt ) ≡ − exp − rαWt + q0 + (q1 , q2 )Xt + Xt QXt ,                                          (4.5)
                                                        2

where Xt ≡ (Ct , yt )′ , (q0 , q1 , q2 ) are constants, and Q is a constant symmetric 2 × 2 matrix. The
Bellman equation is

       max [− exp(−αct ) + DV − βV ] = 0,                                                                  (4.6)
       ct ,xt


where DV is the drift of the process V under the controls (ct , xt ). In a second step, we derive
conditions under which the control vt given by (4.2) is optimal.


Proposition 4.2 The value function (4.5) satisfies the Bellman equation (4.6) if (q0 , q1 , q2 , Q)
satisfy a system of six scalar equations. The control vt given by (4.2) is optimal if (b0 , b1 , b2 ) satisfy
a system of three scalar equations.

                                                      21
4.2       Equilibrium

The system of equations characterizing a linear equilibrium is higher-dimensional than under in-
stantaneous adjustment, and so more complicated. Proposition 4.3 shows that a unique linear
equilibrium exists when the diffusion coefficient s of Ct is small. This is done by computing explic-
itly the linear equilibrium for s = 0 and applying the implicit function theorem. Our numerical
solutions for general values of s seem to generate a unique linear equilibrium. Moreover, the prop-
erties that we derive for small s in the rest of this section seem to hold for general values of s.20


Proposition 4.3 For small s, there exists a unique linear equilibrium. The constants (b1 , b2 ) are
positive, and the vectors (a1 , a2 ) are given by

         ai = γi Σp′f ,                                                                                             (4.7)

where γ1 is a positive and γ2 a negative constant. Eq. (4.7) holds in any linear equilibrium for
general values of s.


       Since γ1 > 0, an increase in Ct lowers the prices of stocks that covary positively with the
flow portfolio and raises the prices of stocks covarying negatively. This effect is the same as
under instantaneous adjustment (Corollary 3.3) but the mechanism is slightly different. Under
instantaneous adjustment, an increase in Ct triggers an immediate outflow from the active fund
by the investor. In flowing out of the fund, the investor sells the stocks that the fund overweighs,
and the prices of these stocks drop so that the manager is induced to buy them. Under gradual
adjustment, the outflow is expected to occur in the future, and so are the sales of the stocks that
the fund overweighs. The prices of these stocks drop immediately in anticipation of the future sales.

       We next examine how Ct impacts stocks’ expected returns. As in the case of instantaneous
adjustment, expected returns are given by a two-factor model, with the factors being the market
and the flow portfolio. The key difference with instantaneous adjustment lies in the properties of
the factor risk premium associated with the flow portfolio.


Corollary 4.1 (Expected Returns) Stocks’ expected returns are given by the two-factor model
(3.21), with the factors being the market and the flow portfolio. The factor risk premium Λt
  20
       This applies to b1 > 0, b2 > 0, γ1 > 0, γ2 < 0, and to Corollaries 4.1 and 4.2 (with a different threshold λR ).




                                                             22
associated to the flow portfolio is

                         1
                                    γ1R Ct + γ2R yt − γ1 s2 q̄1 ,
                                                               
      Λt = r ᾱ +        s2 γ12 ∆
                                                                                                   (4.8)
                    f+
                         1Σ1′

where (γ1R , γ2R ) are constants. For small s, the constant γ1R is negative if

                                                   ᾱ
      λ < λR ≡                                             q                    ,                (4.9)
                                    ψ1Σ1′                           4(α+ᾱ)f ∆
                    2(α + ᾱ) +      2f ∆       r + (r + 2κ) 1 +      rψ1Σ1′



and is positive otherwise, and the constant γ2R is negative.


    When γ1R < 0, the effect of Ct on expected returns goes in the same direction as the effect on
prices. For example, an increase in Ct not only lowers the prices of stocks that covary positively
with the flow portfolio, but also lowers their subsequent expected returns. This seems paradoxical:
given that Ct does not affect cash flows, shouldn’t the drop in price be accompanied by an increase
in expected return? The explanation is that while expected return decreases in the short run, it
increases in the long run, in response to the gradual outflows triggered by the increase in Ct .

    Figure 1 illustrates the dynamic behavior of fund flows and expected returns following a shock
to Ct at time t. We assume that the shock is positive, and trace its effects for t′ > t. We set
the realized values of all shocks occurring subsequent to time t to zero: given the linearity of our
model, this amounts to taking expectations over the future shocks. To better illustrate the main
effects, we assume no mean-reversion in Ct , i.e., κ = 0. Thus, the shock to Ct generates an equal
increase in Ct′ for all t′ > t. We assume parameter values for which the constant γ1R of Corollary
4.1 is negative. The constant γ2R is also negative for these parameter values, a result which our
numerical solutions suggest is general.

    The solid line in Figure 1 plots the investor’s holdings of the active fund, yt′ . Holdings decrease
to a lower constant level, and the decrease happens gradually because of the adjustment cost.
The dashed line in Figure 1 plots the instantaneous expected return E(dRt′ )/dt of a stock that
covaries positively with the flow portfolio. Immediately following the increase in Ct , expected
return decreases because γ1R < 0. Over time, however, as outflows occur, expected return increases.
This is because the manager must be induced to absorb the outflows and buy the stock—an effect
which can also be seen from Corollary 4.1 by noting that yt′ decreases over time and γ2R < 0. The
increase in expected return eventually overtakes the initial decrease, and the overall effect becomes

                                                            23
                          0



                                                                      y
                                                                      E(dR)/dt




                           0            1             2           3              4
                                                t,−t (years)

           Figure 1: Effect of a positive shock to Ct on the investor’s holdings of the active
           fund yt′ (solid line) and on the instantaneous expected return E(dRt′ )/dt of a stock
           that covaries positively with the flow portfolio (dashed line) for t′ > t. Time is
           measured in years. The figure is drawn for (r, κ, ᾱ/α, ψ/α, φ2 , ∆/(1Σ1′ ), s2 , λ) =
           (0.04, 0, 4, 4, 0.1, 0.1, 1, 0). The equations describing the dynamics of yt′ and
           E(dRt′ )/dt are derived in the proof of Corollary 4.2.



an increase. It is the long-run increase in expected return that causes the initial price drop at time
t.

     While Figure 1 reconciles the initial price drop with the behavior of expected return, it does
not explain why expected return decreases in the short run. The latter effect is, in fact, puzzling:
why is the manager willing to hold at time t—and even overweigh—a stock that is expected to
underperform in the short run? The intuition is that the manager prefers to guarantee a “bird
in the hand.” Indeed, the anticipation of future outflows causes the stock to become underpriced
at time t and offer an attractive return over a long horizon. The manager could earn an even
more attractive return, on average, by buying the stock after the outflows occur. This, however,
exposes him to the risk that the outflows might not occur, in which case the stock would cease to
be underpriced. Thus, the manager might prefer to guarantee an attractive long-horizon return
(bird in the hand), and pass up on the opportunity to exploit an uncertain short-run price drop.
Note that in seeking to guarantee the long-horizon return, the manager is, in effect, causing the
short-run drop. Indeed, the manager’s buying pressure prevents the price at time t from dropping
to a level that fully reflects the future outflows, i.e., from which a short-run drop is not expected.




                                                    24
    The bird-in-the-hand effect can be seen formally in the manager’s first-order condition (3.9),
which in the case of gradual adjustment becomes

      Et (dRt ) = r ᾱCovt (dRt , ẑt dRt ) + (q̄1 + q̄11 Ct + q̄12 yt )Covt (dRt , dCt ).                   (4.10)

Following an increase in Ct , the expected return of a stock that covaries positively with the flow
portfolio decreases, lowering the left-hand side of (4.10). Therefore, the manager remains willing to
hold the stock only if its risk, described by the right-hand side of (4.10), also decreases. The decrease
in risk is not caused by a lower covariance between the stock and the manager’s portfolio ẑt (first
term in the right-hand side). Indeed, since outflows are gradual, ẑt remains constant immediately
following the increase in Ct . The decrease in risk is instead driven by the manager’s hedging demand
(second term in the right-hand side), which means that a stock covarying positively with the flow
portfolio becomes a better hedge for the manager when Ct increases. The intuition is that when
Ct increases, mispricing becomes severe, and the manager has attractive investment opportunities.
Hedging against a reduction in these opportunities requires holding stocks that perform well when
Ct decreases, and these are the stocks covarying positively with the flow portfolio. Holding such
stocks guarantees the manager an attractive long-horizon return—the bird-in-the-hand effect.

    The manager’s hedging demand is influenced not only by the bird-in-the-hand effect, but also
by the concern with commercial risk (Corollary 3.7). The two effects work in opposite directions
when λ > 0. Indeed, a stock covarying positively with the flow portfolio is a bad hedge for the
manager because it performs poorly when Ct increases, which is also when outflows occur. Moreover,
λ > 0 implies that the hedge tends to worsen when Ct increases because the manager becomes
more concerned with future outflows. When λ is small, the bird-in-the-hand effect dominates the
commercial-risk effect in influencing how the manager’s hedging demand depends on Ct . Thus,
when λ is small, changes in Ct impact prices and short-run expected returns in the same direction
(γ1R < 0), as Corollary 4.1 confirms in the case of small s.21

    The time-variation in expected returns implied by Corollary 4.1 gives rise to predictability.
As in the case of instantaneous adjustment, the autocovariance matrix of returns is equal to the
non-fundamental covariance matrix times a scalar. But while the scalar is negative for all lags
under instantaneous adjustment, it can be positive for short lags under gradual adjustment.


Corollary 4.2 (Return Predictability) The covariance between stock returns at time t and
   21
      Note that in a model with smart-money investors, sketched at the end of Section 2, λ would naturally be small:
since these investors invest their own wealth, their hedging demand would be influenced only by the bird-in-the-hand
effect.


                                                          25
those at time t′ > t is
                            h        ′                ′
                                                          i
      Covt (dRt , dRt′ ′ ) = χ1 e−κ(t −t) + χ2 e−b2 (t −t) Σp′f pf Σ(dt)2 ,                                   (4.11)


where (χ1 , χ2 ) are constants. For small s, the term in the square bracket of (4.11) is positive if
t′ − t < û and negative if t′ − t > û, for a threshold û which is positive if λ < λR and zero if
λ > λR . A stock’s return predicts positively the stock’s subsequent return for t′ − t < û (short-run
momentum) and negatively for t′ − t > û (long-run reversal). It predicts in the same manner the
subsequent return of another stock when the covariance between each stock in the pair and the flow
portfolio has the same sign, and in the opposite manner otherwise.


     When λ is small, stocks exhibit positive autocovariance for short lags and negative for long
lags, i.e., short-run momentum and long-run reversal. This is because expected returns vary over
time only in response to changes in Ct and the changes in yt that these trigger. Moreover, changes
in Ct move prices and short-run expected returns in the same direction, but long-run expected
returns in the opposite direction. When instead λ is large, autocovariance is negative for all lags
because changes in Ct move even short-run expected returns in the opposite direction to prices.22
Lead-lag effects have the same sign as autocovariance for stock pairs whose covariance with the
flow portfolio has the same sign. This is because changes in Ct influence both stocks in the same
manner.



5     Asymmetric Information

This section treats the case of asymmetric information, where the investor does not observe the
cost Ct and seeks to infer it from the returns and share prices of the index and active funds. Asym-
metric information involves the additional complexity of having to solve for the investor’s dynamic
inference problem. Yet, this complexity does not come at the expense of tractability: the equilib-
rium has a similar formal structure and many properties in common with symmetric information.
For example, the autocovariance and non-fundamental covariance matrices are identical to their
symmetric-information counterparts up to multiplicative scalars.

     We maintain the adjustment cost assumed in Section 4, and look for an equilibrium with the
following characteristics. The investor’s conditional distribution of Ct is normal with mean Ĉt . The
  22
     The result that stocks exhibit short-run momentum and long-run reversal when λ is small, but reversal for all
lags when λ is large is consistent with the implication of Corollary 3.7 that an increase in λ increases the extent of
reversal.


                                                         26
variance of the conditional distribution is, in general, a deterministic function of time, but we focus
on a steady state where it is constant.23 Stock prices take the form

                F̄   Ft − F̄
         St =      +         − (a0 + a1 Ĉt + a2 Ct + a3 yt ),                                         (5.1)
                r     r+κ

where (a0 , a1 , a2 , a3 ) are constant vectors. The conditional mean Ĉt becomes a state variable and
affects prices because it determines the investor’s target holdings of the active fund. The true
value Ct , which is observed by the manager, also affects prices because it forecasts the investor’s
target holdings in the future. We conjecture that the effects of (Ĉt , Ct , yt ) on prices depend on the
covariance with the flow portfolio, as is the case for (Ct , yt ) under symmetric information. That is,
there exist constants (γ1 , γ2 , γ3 ) such that for i = 1, 2, 3,

         ai = γi Σp′f .                                                                                (5.2)

The investor’s speed of adjustment vt ≡ dyt /dt in our conjectured equilibrium is

         vt = b0 − b1 Ĉt − b2 yt ,                                                                    (5.3)

where (b0 , b1 , b2 ) are constants. Eq. (5.3) is identical to its symmetric-information counterpart
(4.2), except that Ct is replaced by its mean Ĉt . We refer to an equilibrium satisfying (5.1)-(5.3)
as linear.


5.1       Investor’s Inference

The investor seeks to infer the cost Ct from fund returns and share prices. The share prices of
the index and active fund are zt St and 1St , respectively, and are informative about Ct because Ct
affects the vector of stock prices St . Prices do not reveal Ct perfectly, however, because they also
depend on the time-varying expected dividend Ft that the investor does not observe.

       In addition to prices, the investor observes the net-of-cost return of the active fund, zt dRt −Ct dt,
and the return of the index fund, 1dRt . Because the investor observes prices, she also observes
capital gains, and therefore can deduce net dividends (i.e., dividends minus Ct ). Net dividends are
the incremental information that returns provide to the investor.

       In equilibrium, the active fund’s portfolio zt is equal to θ − xt 1. Since the investor knows xt ,
observing the price and net dividends of the index and active funds is informationally equivalent
  23
       The steady state is reached in the limit when time t becomes large.


                                                           27
to observing the price and net dividends of the index fund and of a hypothetical fund holding
the residual-supply portfolio θ. Therefore, we can take the investor’s information to be the net
dividends of the residual-supply portfolio θdDt − Ct dt, the dividends of the index fund 1dDt , the
price of the residual-supply portfolio θSt , and the price of the index fund 1St .24 We solve the
investor’s inference problem using recursive (Kalman) filtering.


Proposition 5.1 The mean Ĉt of the investor’s conditional distribution of Ct evolves according to
the process
                                 n                                     o
        dĈt =κ(C̄ − Ĉt )dt − β1 pf [dDt − Et (dDt )] − (Ct − Ĉt )dt
                             h                                                     i
                      − β2 pf dSt + a1 dĈt + a3 dyt − Et (dSt + a1 dĈt + a3 dyt ) ,                          (5.4)


where
                           γ2 ∆ 1Σ1′
                               
        β1 ≡ T 1 − (r + k)           ,                                                                         (5.5)
                           1Σ1′   ∆

                           s2 γ2
        β2 ≡                      s2 γ22 ∆
                                             ,                                                                 (5.6)
                       φ2
                     (r+κ)2
                              +    1Σ1′


and T denotes the distribution’s steady-state variance. The variance T is the unique positive solution
of the quadratic equation

                                             2                        s 2 φ2
                                                  1Σ1′
                
            2                   γ2 ∆                                  (r+κ)2
        T           1 − (r + κ)                        + 2κT −                           = 0.                  (5.7)
                                1Σ1′               ∆               φ2
                                                                         + 1Σ1
                                                                              s2 γ22 ∆
                                                                                     ′
                                                                 (r+κ)2




    The term in β1 in (5.4) represents the investor’s learning from net dividends. Recalling the
definition (3.16) of the flow portfolio, we can write this term as

                                               1Σθ ′
                                                                       
        −β1 θdDt − Ct dt − Et (θdDt − Ct dt) −       [1dDt − Et (1dDt )]  .                                    (5.8)
                                               1Σ1′

The investor lowers her estimate of the cost Ct if the net dividends of the residual-supply portfolio
θdDt − Ct dt are above expectations. Of course, net dividends can be high not only because Ct is
  24
     We are assuming that the investor’s information is the same in and out of equilibrium, i.e., the manager cannot
manipulate the investor’s beliefs by deviating from his equilibrium strategy and choosing a portfolio zt 6= θ − xt 1.
This is consistent with the assumption of a competitive manager. Indeed, one interpretation of this assumption is
that there exists a continuum of managers, each with the same Ct . A deviation by one manager would then not affect
the investors’ beliefs about Ct because these would depend on averages across managers.


                                                                      28
low, but also because gross dividends are high. The investor adjusts for this by comparing with the
dividends 1Dt of the index fund. The adjustment is made by computing the regression residual of
θdDt − Ct dt on 1Dt , which is the term in curly brackets in (5.8).

      The term in β2 in (5.4) represents the investor’s learning from prices. The investor lowers her
estimate of Ct if the price of the residual-supply portfolio is above expectations. Indeed, the price
can be high because the manager knows privately that Ct is low, and anticipates that the investor
will increase her participation in the fund, causing the price to rise, as she learns about Ct . As with
dividends, the investor needs to account for the fact that the price of the residual-supply portfolio
can be high not only because Ct is low, but also because the manager expects future dividends to
be high (Ft small). She adjusts for this by comparing with the price of the index fund. Note that
if the expected dividend Ft is constant (φ = 0), learning from prices is perfect: (5.7) implies that
the conditional variance T is zero.

      Because the investor compares the performance of the residual-supply portfolio, and hence of
the active fund, to that of the index fund, she is effectively using the index as a benchmark. Note
that benchmarking is not part of an explicit contract tying the manager’s compensation to the
index. Compensation is tied to the index only implicitly: if the active fund outperforms the index,
the investor infers that Ct is low and increases her participation in the fund.



5.2     Optimization


The manager chooses controls (c̄t , ȳt , zt ) to maximize the expected utility (2.2) subject to the budget
constraint (3.3), the normalization (3.6), and the investor’s holding policy (5.3). Since stock prices
depend on (Ĉt , Ct , yt ), the same is true for the manager’s value function. We conjecture that the
value function is
                                                                               
                                                                      1
       V̄ (Wt , X̄t ) ≡ − exp − r ᾱWt + q̄0 + (q̄1 , q̄2 , q̄3 )X̄t + X̄t′ Q̄X̄t ,                           (5.9)
                                                                      2

where X̄t ≡ (Ĉt , Ct , yt )′ , (q̄0 , q̄1 , q̄2 , q̄3 ) are constants, and Q̄ is a constant symmetric 3 × 3 matrix.


Proposition 5.2 The value function (5.9) satisfies the Bellman equation (3.8) if (q̄0 , q̄1 , q̄2 , q̄3 , Q̄)
satisfy a system of ten scalar equations.




                                                        29
       The investor chooses controls (ct , xt , vt ) to maximize the expected utility (2.1) subject to the
budget constraint (4.4) and the manager’s portfolio policy zt = θ −xt 1. As in the case of symmetric
information, we study this optimization problem in two steps: first optimize over (ct , xt ), assuming
that vt is given by (5.3), and then derive conditions under which (5.3) is optimal. We solve the first
problem using dynamic programming, and conjecture the value function (4.5), where Xt ≡ (Ĉt , yt )′ ,
(q0 , q1 , q2 ) are constants, and Q is a constant symmetric 2 × 2 matrix.


Proposition 5.3 The value function (4.5) satisfies the Bellman equation (4.6) if (q0 , q1 , q2 , Q)
satisfy a system of six scalar equations. The control vt given by (5.3) is optimal if (b0 , b1 , b2 ) satisfy
a system of three scalar equations.



5.3       Equilibrium

Proposition 5.4 shows that a unique linear equilibrium exists when the diffusion coefficient s of Ct is
small. Our numerical solutions for general values of s seem to generate a unique linear equilibrium,
with properties similar to those derived in the rest of this section for small s.25


Proposition 5.4 For small s, there exists a unique linear equilibrium. The constants (b1 , b2 , γ1 )
are positive, and the constant γ3 is negative. The constant γ2 is positive if λ ≥ 0.


       When information is asymmetric, cashflow news affect the investor’s estimate of the cost Ct ,
and so trigger fund flows. These flows, in turn, impact stock returns. We refer to the effect that
cashflow news have on returns through fund flows as an indirect effect, to distinguish from the direct
effect computed by holding flows constant. To illustrate the two effects, consider the dividend shock
dDt at time t. The shock’s direct effect is to add dDt to returns dRt = dDt + dSt − rSt dt. The
shock’s indirect effect is to trigger fund flows which impact returns dRt through the price change
dSt . Eqs. (5.1), (5.2) and (5.4) imply that the indirect effect is β1 γ1 Σp′f pf dDt .

       The indirect effect amplifies the direct effect. Suppose, for example, that a stock experiences
a negative cashflow shock. If the stock is in large residual supply, and so overweighed by the
active fund, then the shock lowers the return of the active fund more than of the index fund. As
a consequence, the investor infers that Ct has increased, and flows out of the active and into the
index fund. Since the active fund overweighs the stock, the investor’s flows cause the stock to be
  25
       This applies to b1 > 0, b2 > 0, γ1 > 0, γ2 > 0, γ3 < 0, and to Corollaries 5.1, 5.2 and 5.3.


                                                             30
sold and push its price down. Conversely, if the stock is in small residual supply, then the investor
infers that Ct has decreased, and flows out of the index and into the active fund. Since the active
fund underweighs the stock, the investor’s flows cause again the stock to be sold and push its price
down. Thus, in both cases, fund flows amplify the direct effect that the cashflow shock has on
returns.

    Amplification is related to comovement. Recall that under symmetric information fund flows
generate comovement between a pair of stocks because they affect the expected return of each
stock in the pair. This channel of comovement, to which we refer as ER/ER (where ER stands for
expected return) is also present under asymmetric information. Asymmetric information introduces
an additional channel involving fund flows, to which we refer as CF/ER (where CF stands for
cashflow). This is that cashflow news of one stock in a pair trigger fund flows which affect the
expected return of the other stock. The CF/ER channel is the one related to amplification.

    While the ER/ER and CF/ER channels are conceptually distinct, their effects are formally
similar: the covariance matrix generated by CF/ER is equal to that generated by ER/ER times a
positive scalar (Corollary 5.1). Thus, if ER/ER generates a positive covariance between a pair of
stocks, so does CF/ER, and if the former covariance is large, so is the latter. Consider, for example,
two stocks that are in large residual supply. Since outflows from the active fund (triggered by, e.g.,
a cashflow shock to a third stock) push down the prices of both stocks, ER/ER generates a positive
covariance. Moreover, since a negative cashflow shock to one stock triggers outflows from the active
fund and this pushes down the price of the other stock, CF/ER also generates a positive covariance.
The former covariance is large if the two stocks have high idiosyncratic risk since this makes them
more sensitive to fund flows. But high idiosyncratic risk also renders the latter covariance large:
cashflow shocks to stocks having low correlation with the index generate a large discrepancy between
the active and the index return, hence triggering large fund flows.

    Corollary 5.1 computes the covariance matrix of stock returns. The fundamental covariance
is identical to that under symmetric information, while the non-fundamental covariance is propor-
tional. The intuition for proportionality is that the covariance matrices generated by ER/ER and
CF/ER are proportional, the non-fundamental covariance under symmetric information is gener-
ated by ER/ER, and that under asymmetric information is generated by ER/ER and CF/ER.
Corollary 5.1 shows, in addition, that for small s the non-fundamental covariance matrix is larger
under asymmetric information, i.e., the proportionality coefficient with the symmetric-information
matrix is larger than one. This result, which our numerical solutions suggest is general, implies



                                                 31
that the non-fundamental volatility of each stock is larger under asymmetric information, and so is
the absolute value of the non-fundamental covariance between any pair of stocks. Intuitively, these
quantities are larger under asymmetric information because the amplification channel CF/ER is
present only in that case.


Corollary 5.1 (Comovement and Amplification) The covariance matrix of stock returns is

      Covt (dRt , dRt′ ) = f Σ + kΣp′f pf Σ dt,
                                           
                                                                                                       (5.10)

where k is a positive constant. The fundamental covariance is identical to that under symmetric
information, while the non-fundamental covariance is proportional. Moreover, for small s, the
proportionality coefficient is larger than one.


    The cross section of expected returns is explained by the same two factors as under symmetric
information.


Corollary 5.2 (Expected Returns) Stocks’ expected returns are given by the two-factor model
(3.21), with the factors being the market and the flow portfolio. The factor risk premium Λt
associated to the flow portfolio is

                         1                                                 
      Λt = r ᾱ +         k∆
                                 γ1R Ĉt + γ2R Ct + γ3R yt − k1 q̄1 − k2 q̄2 ,                         (5.11)
                    f+
                         1Σ1′

where (γ1R , γ2R , γ3R , k1 , k2 ) are constants. For small s, the constants (γ1R , γ3R ) are negative and the
constant γ2R has the same sign as λ.


    Using Corollary 5.2, we can examine how expected returns respond to shocks. Consider a
cashflow shock, which we assume is negative and hits a stock in large residual supply. The shock
raises Ĉt , the investor’s estimate of Ct . The increase in Ĉt lowers the prices of stocks covarying
positively with the flow portfolio (including the stock hit by the cashflow shock) since γ1 > 0, and
lowers the subsequent expected returns of these stocks since γ1R < 0. The simultaneous decrease
in prices and expected returns is consistent because expected returns increase in the long run.
Expected returns decrease in the short run because of the bird-in-the-hand effect.

    The time-variation in expected returns following cashflow shocks can be characterized in terms
of the covariance between cashflow shocks and subsequent returns. Corollary 5.3 computes the

                                                         32
covariance between the vectors (dDt , dFt ) of cashflow shocks at time t and the vector of returns at
time t′ > t. Both covariance matrices are equal to the non-fundamental covariance matrix times a
scalar which is positive for short lags and negative for long lags. Thus, cashflow shocks generate
short-run momentum and long-run reversal in returns, consistent with the discussion in the previous
paragraph. Note that predictability based on cashflows arises only under asymmetric information
because only then cashflow shocks trigger fund flows.


Corollary 5.3 (Return Predictability Based on Cashflows) The covariance between cash-
flow shocks (dDt , dFt ) at time t and returns at time t′ > t is given by

                                 β1 (r + κ)Covt (dFt , dRt′ ′ ) h D −(κ+ρ)(t′ −t)     D −b2 (t′ −t)
                                                                                                    i
        Covt (dDt , dRt′ ′ ) =                                 = χ 1 e            + χ 2 e             Σp′f pf Σ(dt)2 ,
                                           β2 φ2
                                                                                                               (5.12)

where (χD    D
        1 , χ2 ) are constants. For small s, the term in the square bracket of (4.11) is positive if

t′ − t < ûD and negative if t′ − t > ûD , for a threshold ûD > 0. A stock’s cashflow shocks predict
positively the stock’s subsequent return for t′ − t < ûD (short-run momentum) and negatively for
t′ − t > ûD (long-run reversal). They predict in the same manner the subsequent return of another
stock when the covariance between each stock in the pair and the flow portfolio has the same sign,
and in the opposite manner otherwise.


       We finally examine predictability based on past returns rather than cashflows. This predictabil-
ity is driven both by cashflow shocks and by shocks to Ct . Predictability based on past returns has
the same form as under symmetric information (Corollary 4.2), except that short-run momentum
arises even for large λ.26


Corollary 5.4 (Return Predictability) The covariance between stock returns at time t and
those at time t′ > t is
                              h            ′              ′                ′
                                                                               i
        Covt (dRt , dRt′ ′ ) = χ1 e−(κ+ρ)(t −t) + χ2 e−κ(t −t) + χ3 e−b2 (t −t) Σp′f pf Σ(dt)2 ,               (5.13)
  26
     The latter result relies on the assumption that s is small. Recall that when information is symmetric, short-
run momentum does not arise for large λ because of commercial risk. Indeed, an increase in Ct lowers the prices
of stocks covarying positively with the flow portfolio because of the anticipation of future outflows from the active
fund. Moreover, the subsequent expected returns of these shocks increase, even in the short run, because the manager
becomes more concerned with commercial risk (and this effect dominates the bird-in-the-hand effect for large λ). Both
effects are also present when information is asymmetric. Under asymmetric information, however, predictability is
driven not only by shocks to Ct but also by cashflow shocks. Moreover, the latter have a dominating effect when
shocks to Ct have small variance (small s). Indeed, for small s, shocks to Ct are not only small but also trigger a
small price reaction holding size constant. This is because the price reaction is driven by the anticipation of future
flows as the investor learns about Ct , and learning is limited for small s.


                                                            33
where (χ1 , χ2 , χ3 , ρ) are constants. For λ ≥ 0 and small s, the term in the square bracket of (5.13)
is positive if t′ − t < û and negative if t′ − t > û, for a threshold û > 0. Given û, predictability is
as in Corollary 4.2.



6    Conclusion

This paper proposes a rational theory of momentum and reversal based on delegated portfolio
management. Momentum arises because prices do not fully adjust to reflect future fund flows, and
reversal arises because these flows push prices away from fundamental values. Besides momentum
and reversal, fund flows generate comovement, lead-lag effects and amplification, with all effects
being larger for assets with high idiosyncratic risk. Moreover, managers’ concern with commercial
risk makes prices more volatile. Our model provides a parsimonious and tractable framework to
study the price effects of fund flows.

    In focusing on flows between investment funds as a driver of momentum, we do not intend to
suggest that they are the only driver. Indeed, momentum could be also generated by gradual and
anticipated changes in leverage or irrational sentiment. At the same time, flows between investment
funds seem to be a relevant driver of momentum as recent empirical findings indicate, and can be
modeled in a manner that might be more tractable than alternatives. Moreover, the basic intuitions
identified in this paper, e.g., momentum is driven by the bird-in-the-hand effect and is possible only
because of the subsequent reversal, seem general and could carry over to other settings.

    Our emphasis in this paper is to develop a framework that allows for a general analysis of
the price effects of fund flows. An important next step, left for future work, is to examine more
systematically the empirical implications of our analysis, both to confront existing empirical facts
and to suggest new tests. For example, is momentum larger for individual assets or asset classes?
Are momentum winners correlated and is there a momentum factor? If so, how do momentum and
value factors correlate?




                                                    34
                                                        Appendix


A       Symmetric Information

Proof of Proposition 3.1: Eqs. (2.3), (3.2), (3.3) and (3.4) imply that

                                                                               φdBtF
                                                                                    
                         1
d r ᾱWt + q̄0 + q̄1 Ct + q̄11 Ct2                                    dBtD                 −s r ᾱẑt a1 − f¯1 (Ct ) dBtC , (A.1)
                                                                                                                   
                                               = Ḡdt+r ᾱẑt σ              +
                         2                                                     r+κ

where
                                                  
      Ḡ ≡r ᾱ rWt + ẑt ra0 + (r + κ)a1 Ct − κa1 C̄ + (λCt + B)(b0 − b1 Ct ) − c̄t

                                    1
            + f¯1 (Ct )κ(C̄ − Ct ) + s2 q̄11 ,
                                    2

      f¯1 (Ct ) ≡ q̄1 + q̄11 Ct .

Eqs. (3.7) and (A.1) imply that

                                                                          
                            1      2         ′  1 2            ¯
                                                                        2
      D V̄ = −V̄        Ḡ − (r ᾱ) f ẑt Σẑt − s r ᾱẑt a1 − f1 (Ct )     .                                            (A.2)
                            2                   2

Substituting (A.2) into (3.8), we can write the first-order conditions with respect to c̄t and ẑt as

      ᾱ exp(−ᾱc̄t ) + r ᾱV̄ = 0,                                                                                       (A.3)

      h̄(Ct ) = r ᾱ(f Σ + s2 a1 a′1 )ẑt′ ,                                                                              (A.4)

respectively, where

      h̄(Ct ) ≡ ra0 + (r + κ)a1 Ct − κa1 C̄ + s2 a1 f¯1 (Ct ).                                                            (A.5)

Eq. (A.4) is equivalent to (3.9) because of (2.3), (3.4) and (3.5). Using (A.2) and (A.3), we can
simplify (3.8) to

          1                                                              1
      Ḡ − (r ᾱ)2 ẑt (f Σ + s2 a1 a′1 )ẑt′ + r ᾱs2 ẑt a1 f¯1 (Ct ) − s2 f¯1 (Ct )2 + β̄ − r = 0.                     (A.6)
          2                                                              2

Eqs. (3.7) and (A.3) imply that

                                                     
                  1                  1      2
      c̄t = rWt +      q̄0 + q̄1 Ct + q̄11 Ct − log(r) .                                                                  (A.7)
                  ᾱ                 2

                                                                  35
Substituting (A.7) into (A.6) the terms in Wt cancel, and we are left with
                                                                                                
                                                                                      1      2
     r ᾱẑt ra0 + (r + κ)a1 Ct − κa1 C̄ + r ᾱ(λCt + B)(b0 − b1 Ct ) − r q̄0 + q̄1 Ct + q̄11 Ct
                                                                                        2
                                1
        + f¯1 (Ct )κ(C̄ − Ct ) + s2 q̄11 + β̄ − r + r log(r)
                                2
         1                                                              1
        − (r ᾱ)2 ẑt (f Σ + s2 a1 a′1 )ẑt′ + r ᾱs2 ẑt a1 f¯1 (Ct ) − s2 f¯1 (Ct )2 = 0.                 (A.8)
         2                                                              2

The terms in (A.8) that involve ẑt can be written as
                                          1
      r ᾱẑt ra0 + (r + κ)a1 Ct − κa1 C̄ − (r ᾱ)2 ẑt (f Σ + s2 a1 a′1 )ẑt′ + r ᾱs2 ẑt a1 f¯1 (Ct )
             
                                           2
                           1
        = r ᾱẑt h̄(Ct ) − (r ᾱ)2 ẑt (f Σ + s2 a1 a′1 )ẑt′
                           2
         1
        = r ᾱẑt h̄(Ct )
         2
         1
        = h̄(Ct )′ (f Σ + s2 a1 a′1 )−1 h̄(Ct ),                                                            (A.9)
         2

where the first step follows from (A.5) and the last two from (A.4). Substituting (A.9) into (A.8),
we find
                                                                                                  
        1        ′        2    ′ −1                                                       1      2
          h̄(Ct ) (f Σ + s a1 a1 ) h̄(Ct ) + r ᾱ(λCt + B)(b0 − b1 Ct ) − r q̄0 + q̄1 Ct + q̄11 Ct
        2                                                                                 2
                                1 
        + f¯1 (Ct )κ(C̄ − Ct ) + s2 q̄11 − f¯1 (Ct )2 + β̄ − r + r log(r) = 0.
                                                     
                                                                                                           (A.10)
                                2

Eq. (A.10) is quadratic in Ct . Identifying terms in Ct2 , Ct , and constants, yields three scalar
equations in (q̄0 , q̄1 , q̄11 ). We defer the derivation of these equations until the proof of Proposition
3.3 (see (A.40) and (A.41)).

Proof of Proposition 3.2: Eqs. (2.3), (3.4) and (3.10) imply that

                                                                    φdBtF
                                                                       
                          1     2                                 D
    d rαWt + q0 + q1 Ct + q11 Ct =Gdt + rα(xt 1 + yt zt )σ dBt +
                          2                                         r+κ

                                                       − s [rα(xt 1 + yt zt )a1 − f1 (Ct )] dBtC ,         (A.11)

where

                                                                                            1
  G ≡ rα rWt + (xt 1 + yt zt ) ra0 + (r + κ)a1 Ct − κa1 C̄ − yt Ct − ct +f1 (Ct )κ(C̄ −Ct )+ s2 q11 ,
                                                        
                                                                                            2

                                                                 36
      f1 (Ct ) ≡ q1 + q11 Ct .

Eqs. (3.11) and (A.11) imply that
                                                                                                   
                      1    2                                 ′ 1 2                                2
  DV = −V          G − (rα) f (xt 1 + yt zt )Σ(xt 1 + yt zt ) − s [rα(xt 1 + yt zt )a1 − f1 (Ct )] . (A.12)
                      2                                        2

Substituting (A.12) into (3.12), we can write the first-order conditions with respect to ct , xt and yt
as
      α exp(−αct ) + rαV = 0,                                                                              (A.13)

      1h(Ct ) = rα1(f Σ + s2 a1 a′1 )(xt 1 + yt zt )′ ,                                                    (A.14)

      zt h(Ct ) − Ct = rαzt (f Σ + s2 a1 a′1 )(xt 1 + yt zt )′ ,                                           (A.15)

respectively, where

      h(Ct ) ≡ ra0 + (r + κ)a1 Ct − κa1 C̄ + s2 a1 f1 (Ct ).                                               (A.16)

Eqs. (A.14) and (A.15) are equivalent to (3.13) and (3.14) because of (2.3), (3.4) and (3.5). Solving
for ct , and proceeding as in the proof of Proposition 3.1, we can simplify (3.12) to
                                                                                       
                                                                              1     2
        rα(xt 1 + yt zt ) ra0 + (r + κ)a1 Ct − κa1 C̄ − rαyt Ct − r q0 + q1 Ct + q11 Ct
                                                                                2
                             1
      + f1 (Ct )κ(C̄ − Ct ) + s2 q11 + β − r + r log(r)
                             2
       1                                                                                           1
      − (rα)2 (xt 1 + yt zt )(f Σ + s2 a1 a′1 )(xt 1 + yt zt )′ + rαs2 (xt 1 + yt zt )a1 f1 (Ct ) − s2 f1 (Ct )2 = 0.
       2                                                                                           2
                                                                                                            (A.17)

Eq. (A.17) is the counterpart of (A.8) for the investor. The terms in (A.17) that involve (xt , yt )
can be written as
                                                  
      rα(xt 1 + yt zt ) ra0 + (r + κ)a1 Ct − κa1 C̄ − rαyt Ct

       1
      − (rα)2 (xt 1 + yt zt )(f Σ + s2 a1 a′1 )(xt 1 + yt zt )′ + rαs2 (xt 1 + yt zt )a1 f1 (Ct )
       2
                                           1
      = rα(xt 1 + yt zt )h(Ct ) − rαyt Ct − (rα)2 (xt 1 + yt zt )(f Σ + s2 a1 a′1 )(xt 1 + yt zt )′
                                           2
       1                         1
      = rα(xt 1 + yt zt )h(Ct ) − rαyt Ct ,                                                                (A.18)
       2                         2

where the first step follows from (A.16) and the second from

      (xt 1 + yt zt )h(Ct ) − yt Ct = rα(xt 1 + yt zt )(f Σ + s2 a1 a′1 )(xt 1 + yt zt )′ ,                (A.19)

                                                          37
which in turn follows by multiplying (A.14) by xt , (A.15) by yt , and adding up. To eliminate xt
and yt in (A.18), we use (A.14) and (A.15). Noting that in equilibrium zt = θ − xt 1, we can write
(A.14) as

     1h(Ct ) = rα1(f Σ + s2 a1 a′1 ) [xt (1 − yt )1 + yt θ]′ .                                          (A.20)

Multiplying (A.14) by xt and adding to (A.15), we similarly find

     θh(Ct ) − Ct = rαθ(f Σ + s2 a1 a′1 ) [xt (1 − yt )1 + yt θ]′ .                                     (A.21)

Eqs. (A.20) and (A.21) form a linear system in xt (1 − yt ) and yt . Solving the system, we find
                         1 
     xt (1 − yt ) =          1h(Ct )θ(f Σ + s2 a1 a′1 )θ ′ − [θh(Ct ) − Ct ] 1(f Σ + s2 a1 a′1 )θ ′ ,   (A.22)
                        rαD
                         1 
                 yt =        [θh(Ct ) − Ct ] 1(f Σ + s2 a1 a′1 )1′ − 1h(Ct )1(f Σ + s2 a1 a′1 )θ ′ ,    (A.23)
                        rαD

where

                                                                              2
     D ≡ θ(f Σ + s2 a1 a′1 )θ ′ 1(f Σ + s2 a1 a′1 )1′ − 1(f Σ + s2 a1 a′1 )θ ′ .
                                                       


Eq. (A.23) implies that the optimal control yt is linear in Ct . Using (A.22) and (A.23), we can
write (A.18) as
        1                          1
          rα(xt 1 + yt zt )h(Ct ) − rαyt Ct
        2                          2
           1                                    1
        = rα [xt 1 + yt (θ − xt 1)] h(Ct ) − rαyt Ct
           2                                    2
            1 n
        =      [1h(Ct )]2 θ(f Σ + s2 a1 a′1 )θ ′ − 2 [θh(Ct ) − Ct ] 1h(Ct )1(f Σ + s2 a1 a′1 )θ ′
           2D
                                                o
        + [θh(Ct ) − Ct ]2 1(f Σ + s2 a1 a′1 )1′ .                                                      (A.24)


Substituting (A.24) into (A.17), we find
         1 n
             [1h(Ct )]2 θ(f Σ + s2 a1 a′1 )θ ′ − 2 [θh(Ct ) − Ct ] 1h(Ct )1(f Σ + s2 a1 a′1 )θ ′
        2D
                                                                               
                         2          2       ′   ′
                                                  o                    1      2
        + [θh(Ct ) − Ct ] 1(f Σ + s a1 a1 )1 − r q0 + q1 Ct + q11 Ct
                                                                       2
                               1 
        + f1 (Ct )κ(C̄ − Ct ) + s2 q11 − f1 (Ct )2 + β − r + r log(r) = 0.
                                                  
                                                                                                        (A.25)
                               2


                                                          38
Eq. (A.25) is quadratic in Ct . Identifying terms in Ct2 , Ct , and constants, yields three scalar
equations in (q0 , q1 , q11 ). We defer the derivation of these equations until the proof of Proposition
3.3 (see (A.44) and (A.45)).

Proof of Proposition 3.3: We first impose market clearing and derive the constants (a0 , a1 , b0 , b1 )
as functions of (q̄1 , q̄11 , q1 , q11 ). For these derivations, as well as for later proofs, we use the following
properties of the flow portfolio:
      1Σp′f = 0,

                             ∆
      θΣp′f = pf Σp′f =          .
                            1Σ1′

Setting zt = θ − xt 1 and ȳt = 1 − yt , we can write (A.4) as

      h̄(Ct ) = r ᾱ(f Σ + s2 a1 a′1 )(1 − yt )(θ − xt 1)′ .                                              (A.26)

Premultiplying (A.26) by 1, dividing by r ᾱ, and adding to (A.20) divided by rα, we find
                      
        h(Ct ) h̄(Ct )
      1       +          = 1(f Σ + s2 a1 a′1 )θ ′ .                                                       (A.27)
         rα      r ᾱ

Eq. (A.27) is linear in Ct . Identifying terms in Ct , we find

          r + κ + s2 q11 r + κ + s2 q̄11
                                            
                        +                        1a1 = 0 ⇒ 1a1 = 0.                                       (A.28)
               rα             r ᾱ

Identifying constant terms, and using (A.28), we find

               αᾱf
      1a0 =           1Σθ ′ .                                                                             (A.29)
               α + ᾱ

Substituting (A.28) and (A.29) into (A.20), we find

                                                                ᾱ
      rαᾱf                                                    α+ᾱ − yt 1Σθ ′
             1Σθ ′ = rαf 1Σ [xt (1 − yt )1 + yt θ]′ ⇒ xt =                     .                          (A.30)
      α + ᾱ                                                     1 − yt 1Σ1′


    Substituting (A.30) into (A.26), we find
                                                                    ′
                                          α 1Σθ ′
                                      
                           2     ′
     h̄(Ct ) = r ᾱ(f Σ + s a1 a1 )                 1 + (1 − yt )pf
                                        α + ᾱ 1Σ1′
                                                                            ′
                                          α 1Σθ ′
                                      
             = r ᾱ(f Σ + s2 a1 a′1 )               1 + (1 − b 0 +  b 1 t f ,
                                                                       C )p                               (A.31)
                                        α + ᾱ 1Σ1′


                                                          39
where the second step follows from (3.2). Eq. (A.31) is linear in Ct . Identifying terms in Ct , we
find

        (r + κ + s2 q̄11 )a1 = r ᾱb1 f Σp′f + s2 a′1 p′f a1 .
                                                            
                                                                                                                   (A.32)

Therefore, a1 is collinear to the vector Σp′f , as in (3.15). Substituting (3.15) into (A.32), we find

                                               s2 γ12 ∆
                                                         
                    2
        (r + κ + s q̄11 )γ1 = r ᾱb1        f+                .                                                    (A.33)
                                                1Σ1′

Identifying constant terms in (A.31), and using (3.15), we find

             αᾱf 1Σθ ′ ′       γ1 (κC̄ − s2 q̄1 )                   s2 γ12 ∆
                                                                            
        a0 =             Σ1 +                      + ᾱ(1 − b0 ) f +             Σp′f .                            (A.34)
             α + ᾱ 1Σ1′                r                             1Σ1′


       Using (3.2) and (A.30), we can write (A.21) as
                                                                             ′
                                               ᾱ 1Σθ ′
                                           
                                   2     ′
        θh(Ct ) − Ct = rαθ(f Σ + s a1 a1 )               1 + (b0 − b1 Ct )pf
                                             α + ᾱ 1Σ1′

                        rαᾱf (1Σθ ′ )2                        s2 γ12 ∆
                                                                       
                                                                           ∆
                     =                  + rα(b0 − b1 Ct ) f +                   ,                                  (A.35)
                       α + ᾱ 1Σ1′                              1Σ1′ 1Σ1′

where the second step follows from (3.15). Eq. (A.35) is linear in Ct . Identifying terms in Ct , and
using (3.15), we find

                                                    s2 γ12 ∆
                                                            
                            γ1 ∆                               ∆
        (r + κ + s2 q11 )        − 1 = −rαb 1   f +              .                                                 (A.36)
                            1Σ1′                     1Σ1′ 1Σ1′

Identifying constant terms, and using (3.15) and (A.34), we find

                 ᾱ       s2 γ1 (q1 − q̄1 )
        b0 =         +                        .                                                                   (A.37)
               α + ᾱ r(α + ᾱ) f + s2 γ12 ∆′
                                
                                        1Σ1

Substituting b0 from (A.37) into (A.34), we find

                                                                                     s2 γ12 ∆
                                                                                              
               αᾱf     1Σθ ′      γ1 κC̄          s2 γ1 (αq̄1
                                                            + ᾱq1 )     αᾱ f +      1Σ1′
        a0 =               Σ1′ +         −                          +                            Σp′f .          (A.38)
               α + ᾱ 1Σ1′           r                 r(α + ᾱ)                α + ᾱ



       The system of equations characterizing equilibrium is as follows. The endogenous variables are
(a0 , a1 , b0 , b1 , γ1 , q̄0 , q̄1 , q̄11 , q0 , q1 , q11 ). The equations linking them are (3.15), (A.33), (A.36), (A.37),

                                                                  40
(A.38), the three equations derived from (A.10) by identifying terms in Ct2 , Ct , and constants, and
the three equations derived from (A.25) through the same procedure. To simplify the system,
we note that the variables (q̄0 , q0 ) enter only in the equations derived from (A.10) and (A.25) by
identifying constants. Therefore they can be determined separately, and we need to consider only
the equations derived from (A.10) and (A.25) by identifying linear and quadratic terms. We next
simplify these equations, using implications of market clearing.

    Using (A.31), we find
      1
        h̄(Ct )′ (f Σ + s2 a1 a′1 )−1 h̄(Ct )
      2
          r 2 α2 ᾱ2 f (1Σθ ′ )2 1 2 2                             s2 γ12 ∆
                                                                           
                                                           2                  ∆
      =                         +   r ᾱ (1 − b 0 + b  C
                                                      1 t )    f +
           2(α + ᾱ)2 1Σ1′        2                                 1Σ1′ 1Σ1′
                                                                                  2
        r 2 α2 ᾱ2 f (1Σθ ′ )2 1 2 2  α           s2 γ1 (q̄1 − q1 )                       s2 γ12 ∆
                                                                                                   
                                                                                                       ∆
      =                      ′ + r ᾱ         +                          + b1 C t     f+        ′        ,
                      2                                            2γ2∆
                                                                                                      1Σ1′
                                                         
         2(α + ᾱ) 1Σ1          2       α + ᾱ r(α + ᾱ) f + 1 ′ s                          1Σ1
                                                                 1Σ1
                                                                                                      (A.39)

where the second step follows from (A.37). Substituting (A.39) into (A.10), and identifying terms
in Ct2 and Ct , we find

                                                s2 γ12 ∆
                                                          
                                                                ∆
      (r + 2κ)q̄11 +    s2 q̄11
                             2
                               −    r 2 ᾱ2 b21
                                            f+         ′             + r ᾱλb1 = 0,                             (A.40)
                                                 1Σ1           1Σ1′
                                                      s2 γ12 ∆
                                                                                    
                                          rαᾱ f + 1Σ1       ′         2
                                                                    ᾱs γ1 (q̄1 − q1 )  ∆
      (r + κ)q̄1 + s2 q̄1 q̄11 − r ᾱb1                         +                            − κC̄ q̄11 + r ᾱ(Bb1 − λb0 ) = 0,
                                               α + ᾱ                    α + ᾱ          1Σ1′
                                                                                                             (A.41)

respectively. Using (3.15) and (A.30), we can write (A.20) as

                   rαᾱf
      1h(Ct ) =           1Σθ ′ .                                                                            (A.42)
                   α + ᾱ

Eq. (3.15) implies that the denominator D in (A.25) is

                 s2 γ12 ∆
                         
      D = f∆ f +            .                                                                                (A.43)
                  1Σ1′

Using (3.15), (A.35), (A.37), (A.42) and (A.43), we find that the equations derived from (A.25) by



                                                         41
identifying terms in Ct2 and Ct are
                                           s2 γ12 ∆
                                                     
                      2 2      2 2 2                       ∆
      (r + 2κ)q11 + s q11 − r α b1 f +            ′             = 0,                                 (A.44)
                                            1Σ1           1Σ1′
                                                 s2 γ12 ∆
                                                                             
                                     rαᾱ f + 1Σ1              αs 2 γ (q − q̄ )
                                                                             1  ∆
                                                        ′
                                                                     1 1
      (r + κ)q1 + s2 q1 q11 + rαb1                         +                          − κC̄q11 = 0, (A.45)
                                          α + ᾱ                     α + ᾱ       1Σ1′

respectively.

     Solving for equilibrium amounts to solving the system of (3.15), (A.33), (A.36), (A.37), (A.38),
(A.40), (A.41), (A.44) and (A.45) in the unknowns (a0 , a1 , b0 , b1 , γ1 , q̄1 , q̄11 , q1 , q11 ). This reduces
to solving the system of (A.33), (A.36), (A.40) and (A.44) in the unknowns (b1 , γ1 , q̄11 , q11 ): given
(b1 , γ1 , q̄11 , q11 ), a1 can be determined from (3.15), (q̄1 , q1 ) from the linear system of (A.41) and
(A.45), and (a0 , b0 ) from (A.38) and (A.37). Replacing the unknown b1 by
                     r
                              s2 γ12 ∆
      b̂1 ≡ r ᾱb1       f+            ,
                               1Σ1′

we can write the system of (A.33), (A.36), (A.40) and (A.44) as
                              r
                2                   s2 γ12 ∆
     (r + κ + s q̄11 )γ1 = b̂1 f +               ,                                                             (A.46)
                                      1Σ1′
                                 q
                                        s2 γ12 ∆
               2
     r + κ + s q11 γ1 ∆       b̂1 f + 1Σ1      ′    ∆      1
                         ′ +                          ′ =    ,                                                 (A.47)
           rα       1Σ1            r ᾱ            1Σ1    rα

                                       b̂21 ∆      λb̂1
      (r + 2κ)q̄11 + s2 q̄11
                          2
                             −                +q               = 0,                                            (A.48)
                                       1Σ1′           s2 γ12 ∆
                                                 f + 1Σ1′

                                        α2 b̂21 ∆
      (r + 2κ)q11 + s2 q11
                        2
                           −                      = 0.                                                         (A.49)
                                       ᾱ2 1Σ1′

To show that the system of (A.46)-(A.49) has a solution, we reduce it to a single equation in b̂1 .
Eq. (A.49) is quadratic in q11 and has a unique positive solution q11 (b̂1 ), which is increasing in
b̂1 ∈ (0, ∞), and is equal to zero for b̂1 = 0 and to ∞ for b̂1 = ∞.27 Substituting q11 (b̂1 ) into
(A.47), we find
                                                 q
                                                            s2 γ12 ∆
       r+κ+     s2 q   11 (b̂1 )   γ1 ∆    b̂1       f+      1Σ1′       ∆      1
                                       ′ +                                ′ =    .                             (A.50)
           rα                      1Σ1               r ᾱ              1Σ1    rα
  27
     The positive solution of (A.49) is the relevant one. Indeed, under the negative solution, the investor’s certainty
equivalent would converge to −∞ when |Ct | goes to ∞. The investor can, however, achieve a certainty equivalent
converging to ∞ by holding a large short position in the active fund when Ct goes to ∞, or a large long position
when Ct goes to −∞.


                                                                        42
                                                                              √
The left-hand side of (A.50) is increasing in γ1 ∈ (0, ∞), and is equal to b̂1 f ∆/(r ᾱ1Σ1′ ) for
γ1 = 0 and to ∞ for γ1 = ∞. Therefore, (A.50) has a unique positive solution γ1 (b̂1 ) if b̂1 ∈ (0, b̂∗1 ),
                       √
where b̂∗1 ≡ ᾱ1Σ1′ /(α f ∆), and no solution if b̂1 ∈ (b̂∗1 , ∞). The solution is decreasing in b̂1 since

the left-hand side of (A.50) is increasing in b̂1 , and is equal to 1Σ1′ /[(r + κ)∆] for b̂1 = 0 and to
zero for b̂1 = b̂∗1 . Substituting γ1 (b̂1 ), and q̄11 from (A.46), into (A.48), we find

                              q
                                   1 1s2 γ 2 (b̂ )∆
         (r + κ)κ r b̂1 f + 1Σ1       ′                      b̂21 f                   λb̂1
       −      2
                 −                                    +                  +q                             = 0.                           (A.51)
            s           γ1 (b̂1 )s 2                      γ12 (b̂1 )s2                 s2 γ12 (b̂1 )∆
                                                                               f+         1Σ1′


Eq. (A.51) is the single equation in b̂1 to which the system of (A.46)-(A.49) reduces. Since the
left-hand side of (A.51) is equal to −(r + κ)κ/s2 for b̂1 = 0 and to ∞ for b̂1 = b̂∗1 , (A.51) has a

solution b̂1 ∈ (0, b̂∗1 ). Therefore, a linear equilibrium exists. The equilibrium is unique if the solution

b̂1 of (A.51) is unique, which is the case if the derivative of the left-hand side with respect to b̂1
and evaluated at the solution is positive. The derivative is
              q                                                           
                        s2 γ12 (b̂1 )∆
      1  r b̂1 f + 1Σ1            ′        2b̂21 f        λb̂1
          −                            +              +q                   
     b̂1         γ1 (b̂1 )s2             γ12 (b̂1 )s2    f+
                                                            s2 γ12 (b̂1 )∆
                                                                              1Σ1′
                               q                                                                                                      
                                        s2 γ12 (b̂1 )∆                  2 2
                                                                       s γ1 (b̂1 )∆                                    2 2
                                                                                                                      s γ1 (b̂1 )∆
         dγ1 (b̂1 ) 1      r b̂ f + 1Σ1′
                           1                                     r b̂1 1Σ1     ′                  2b̂21 f        λb̂1 1Σ1      ′      
       +                                               −              q                       −               −                      3 .
                                                                                                                                       
           db̂1 γ1 (b̂1 )       γ1 (b̂1 )s2                                     s    2
                                                                                   2 γ (b̂ )∆
                                                                                                γ 2 (b̂  )s 2         2 2
                                                                                                                                   
                                                         γ1 (b̂1 )s2 f + 1Σ1          1   1      1 1                  s γ1 (b̂1 )∆   2
                                                                                           ′                     f + 1Σ1       ′

                                                                                                                                       (A.52)


If b̂1 solves (A.51), we can write (A.52) as
            "                       #
         1 (r + κ)κ        b̂21 f
                      + 2
        b̂1     s2      γ1 (b̂1 )s2
                                                                                                                                          
                                                                   s2 γ12 (b̂1 )∆
           dγ1 (b̂1 )     1        (r + κ)κ                  r b̂1 1Σ1       ′                     b̂21 f           λb̂1 f             
       +                          −         −                                                −               +                        .
                                                                                                                                        
                                       s2                                                                                              3
                                                                  q
             db̂1       γ1 (b̂1 )             γ1 (b̂1 )s2            f+
                                                                             s2 γ12 (b̂1 )∆       γ12 (b̂1 )s2      s2 γ12 (b̂1 )∆    2
                                                                                1Σ1′                            f+      1Σ1′
                                                                                                                                       (A.53)

The term inside the first squared bracket is positive. The term inside the second squared bracket is
negative for λ = 0 and by continuity for λ < λ̄ for a λ̄ > 0. Since γ1 (b̂1 ) is decreasing in b̂1 , (A.53)
is positive for λ < λ̄.

                                                                      43
Proof of Corollary 3.1: Eq. yt = ᾱ(α + ᾱ) follows from (3.2) and (A.37). Eq. xt = 0 follows
from (A.30) and yt = ᾱ(α + ᾱ). The first equality in (3.17) follows from (3.4) and (A.38), and the
second equality follows from (3.5).

Proof of Corollary 3.2: The investor’s effective stock holdings are
       xt 1 + yt zt = x1 1 + yt (θ − xt 1)

                                  ᾱ 1Σθ ′
                   = y t pf +               ,                                                     (A.54)
                                α + ᾱ 1Σ1′

where the second step follows from (A.30). Eq. (3.18) follows from (3.2) and (A.54).

Proof of Corollary 3.3: The first equality in (3.19) follows from (3.1) and (3.15). The second
equality follows from (3.5) and (3.15). To derive the third equality, we note from (3.5) and (3.15)
that

       Covt (1dRt , pf dRt ) = 0.

Therefore, if β denotes the regression coefficient of dRt on 1dRt , then
       Covt (dRt , pf dRt ) = Covt (dRt − β1dRt , pf dRt )

                           = Covt (dǫt , pf dRt )

                           = Covt [dǫt , pf (dRt − β1dRt )]

                           = Covt (dǫt , pf dǫt ) ,

where the second and fourth steps follow from the definition of dǫt , and the third step follows
because dǫt is independent of 1dRt .

Proof of Corollary 3.4: The corollary follows by substituting (3.15) into (3.5).

Proof of Corollary 3.5: Stocks’ expected returns are
                                          
    Et (dRt ) = ra0 + (r + κ)a1 Ct − κa1 C̄ dt

                                                                                       s2 γ12 ∆
                                                                                                  
                   rαᾱf 1Σθ ′                        2                    rαᾱ  f +
                                      (r + κ)γ1 Ct − s γ1 (αq̄1 + ᾱq1 ) +             1Σ1   ′        
                                  ′                                                               Σp′f dt
                =               Σ1  +
                   α + ᾱ 1Σ1′                             α + ᾱ                α + ᾱ               

                   rαᾱ 1Σθ ′
                                                                       
                                      2    ′   ′             2    ′   ′
                =             (f Σ + s a1 a1 )1 + Λt (f Σ + s a1 a1 )pf dt,                       (A.55)
                  α + ᾱ 1Σ1′

where the first step follows from (3.4), the second from (3.15) and (A.38), and the third from (3.15)
and (3.22). Eq. (A.55) is equivalent to (3.21) because of (3.5).

                                                      44
Proof of Corollary 3.6: The autocovariance matrix is
      Covt (dRt , dRt′ ′ )
              (                                                                                                          ′ )
                           φdBtF                                                           φdBtF′
                                                                                                     
       = Covt     σ dBtD +                       − sa1 dBtC , (r + κ)a1 Ct′ dt + σ dBtD′ +                  − sa1 dBtC′
                           r+κ                                                             r+κ

                           φdBtF
                                                              
                    D                         C          ′
       = Covt σ dBt +                − sa1 dBt , (r + κ)a1 Ct dt
                                                             ′
                           r+κ

       = Covt −sa1 dBtC , (r + κ)a′1 Ct′ dt
                                           


       = −s(r + κ)γ12 Covt dBtC , Ct′ Σpf p′f Σdt,
                                     
                                                                                                                    (A.56)

where the first step follows by using (3.4) and omitting quantities known at time t, the second step
follows because the increments (dBtD′ , dBtF′ , dBtC′ ) are independent of information up to time t′ , the
third step follows because BtC is independent of (BtD , BtF ), and the fourth step follows from (3.15).
Eq. (2.3) implies that

                                h                     i               Z     t′
               −κ(t′ −t)                −κ(t′ −t)                                     ′
      C =et′               Ct + 1 − e                     C̄ + s                 e−κ(t −u) dBuC .                   (A.57)
                                                                        t


Substituting (A.57) into (A.56), and noting that the only non-zero covariance is between dBtC and
dBtC , we find (3.23).

Proof of Corollary 3.7: The left-hand side of (A.48) is increasing in λ. Since, in addition, the
derivative (A.53) is positive, the solution b̂1 of (A.48) is decreasing in λ. Since γ1 (b̂1 ) is decreasing
in b̂1 , it is increasing in λ.

    Since B does not enter into the system of (A.46)-(A.49), it does not affect (b1 , γ1 , q̄11 , q11 ).
Therefore, its effect on Λt is only through (q̄1 , q1 ). Differentiating (A.41) and (A.45) with respect
to B, we find
                                                                             
                                                          ∂ q̄1       ∂q1
                           ∂ q̄1            ᾱs2 γ1       ∂B      −   ∂B           ∆
      (r + κ + s2 q̄11 )         − r ᾱb1                                              + r ᾱb1 = 0,                (A.58)
                           ∂B                     α + ᾱ                          1Σ1′
                                                                             
                           ∂q1              αs2 γ1 ∂q
                                                    ∂B −
                                                      1               ∂ q̄1
                                                                      ∂B           ∆
      (r + κ + s2 q11 )        + rαb1                                                  = 0.                         (A.59)
                           ∂B                         α + ᾱ                      1Σ1′

The system of (A.58) and (A.59) is linear in (∂ q̄1 /∂B, ∂q1 /∂B). Its solution satisfies

          ∂ q̄1      ∂q1   Y
      α         + ᾱ     =− ,                                                                                       (A.60)
          ∂B         ∂B    Z

                                                                            45
where
                                 rαs2 b1 γ1 ∆
                                             
     Y ≡ rαᾱb1 r + κ + s2 q11 +                ,
                                   1Σ1′

                                            rα2 s2 b1 γ1 ∆(r + κ + s2 q̄11 ) r ᾱ2 s2 b1 γ1 ∆(r + κ + s2 q11 )
      Z ≡ (r + κ + s2 q̄11 )(r + κ + s2 q11 ) +                              −
                                                    (α + ᾱ)1Σ1′                        (α + ᾱ)1Σ1′
                                                                              2 2
                                                                                   
                          2
                                                         r 2 α2 ᾱs2 b2 f + s γ1 ∆
                   f    αs γ1 ∆                                        1      1Σ1 ′
        = r ᾱb1     +               (r + κ + s2 q11 ) +                              ,
                   γ1 (α + ᾱ)1Σ1′                                (α + ᾱ)1Σ1′

and where the second equation for Z follows from (A.33). Since (b1 , γ1 , q11 ) are positive, so are
(Y, Z). Therefore, αq̄1 + ᾱq1 is decreasing in B, and (3.22) implies that Λt is increasing in B.



B     Gradual Adjustment

Proof of Proposition 4.1: Eqs. (2.3), (2.5), (2.6), (4.1) and (4.2) imply that the vector of returns
is

                                                                                   φdBtF
                                                                                          
                        aR          aR                                    dBtD                 − sa1 dBtC ,
                                                           
     dRt = ra0 +         1 Ct   +    2 yt   − κa1 C̄ − b0 a2 dt + σ              +                            (B.1)
                                                                                   r+κ

where
     aR
      1 ≡ (r + κ)a1 + b1 a2 ,

     aR
      2 ≡ (r + b2 )a2 .


Eqs. (2.3), (3.3), (4.2), (4.3) and (B.1) imply the following counterpart of (A.2):

                                                                          
                           1      2         ′  1 2            ¯
                                                                        2
     D V̄ = −V̄        Ḡ − (r ᾱ) f ẑt Σẑt − s r ᾱẑt a1 − f1 (X̄t )     ,                                (B.2)
                           2                   2

where
     Ḡ ≡r ᾱ rWt + ẑt ra0 + aR       R
                                                                               
                               1 Ct + a2 yt − κa1 C̄ − b0 a2 + (λCt + B)yt − c̄t

                                                   1
           + f¯1 (X̄t )κ(C̄ − Ct ) + f¯2 (X̄t )vt + s2 q̄11 ,
                                                   2

     f¯1 (X̄t ) ≡ q̄1 + q̄11 Ct + q̄12 yt ,

     f¯2 (X̄t ) ≡ q̄2 + q̄12 Ct + q̄22 yt ,


                                                            46
and q̄ij denotes the (i, j)’th element of Q̄. Substituting (B.2) into (3.8), we can write the first-order
conditions with respect to c̄t and ẑt as (A.3) and

      h̄(X̄t ) = r ᾱ(f Σ + s2 a1 a′1 )ẑt′ ,                                                                        (B.3)

respectively, where

      h̄(X̄t ) ≡ ra0 + aR       R                        2   ¯
                        1 Ct + a2 yt − κa1 C̄ − b0 a2 + s a1 f (X̄t ).                                               (B.4)

Proceeding as in the proof of Proposition 3.1, we find the following counterpart of (A.10):
                                                                                                 
     1         ′        2    ′ −1                                                      1 ′
       h̄(X̄t ) (f Σ + s a1 a1 ) h̄(X̄t ) + r ᾱ(λCt + B)yt − r q̄0 + (q̄1 , q̄2 )X̄t + X̄t Q̄X̄t
     2                                                                                 2
                                                1 
        + f¯1 (X̄t )κ(C̄ − Ct ) + f¯2 (X̄t )vt + s2 q̄11 − f¯1 (X̄t )2 + β̄ − r + r log(r) = 0.
                                                                      
                                                                                                                     (B.5)
                                                2

Eq. (B.5) is quadratic in X̄t . Identifying quadratic, linear and constant terms yields six scalar
equations in (q̄0 , q̄1 , q̄2 , Q̄). We defer the derivation of these equations until the proof of Proposition
4.3 (see (B.38)-(B.40)).

Proof of Proposition 4.2: Suppose that the investor optimizes over (ct , xt ) but follows the control
vt given by (4.2). Eqs. (2.3), (4.2), (4.4), (4.5) and (B.1) imply the following counterpart of (A.12):

                                                                                                       
                        1                                          1
   DV = −V           G − (rα)2 f (xt 1 + yt zt )Σ(xt 1 + yt zt )′ − s2 [rα(xt 1 + yt zt )a1 − f1 (Xt )]2 , (B.6)
                        2                                          2

where
                                                                                                                
                                                                                                    1
                                                aR          aR                             − yt Ct − ψvt2 − ct
                                                                                       
      G ≡rα rWt + (xt 1 + yt zt ) ra0 +          1 Ct   +    2 yt   − κa1 C̄ − b0 a2
                                                                                                    2
                                                1
            + f1 (Xt )κ(C̄ − Ct ) + f2 (Xt )vt + s2 q11 ,
                                                2

      f1 (Xt ) ≡ q1 + q11 Ct + q12 yt ,

      f2 (Xt ) ≡ q2 + q12 Ct + q22 yt ,

and qij denotes the (i, j)’th element of Q. Substituting (B.6) into (4.6), we can write the first-order
conditions with respect to ct and xt as (A.13) and

      1h(Xt ) = rα1(f Σ + s2 a1 a′1 )(xt 1 + yt zt )′ ,                                                              (B.7)

                                                            47
respectively, where

                                                       2
      h(Xt ) ≡ ra0 + aR       R
                      1 Ct + a2 yt − κa1 C̄ − b0 a2 + s a1 f1 (Xt ).                                        (B.8)

The counterpart of (A.17) is
                                                                        1    2
      rα(xt 1 + yt zt ) ra0 + aR       R
                                                            
                               1 Ct + a2 yt − κa1 C̄ − b0 a2 − rαyt Ct − rαψvt
                                                                        2
                                       
                               1 ′                                         1
      − r q0 + (q1 , q2 )Xt + Xt QXt + f1 (Xt )κ(C̄ − Ct ) + f2 (Xt )vt + s2 q11 + β − r + r log(r)
                               2                                           2
       1                                                                                           1
      − (rα)2 (xt 1 + yt zt )(f Σ + s2 a1 a′1 )(xt 1 + yt zt )′ + rαs2 (xt 1 + yt zt )a1 f1 (Xt ) − s2 f1 (Xt )2 = 0.
       2                                                                                           2
                                                                                                             (B.9)

The terms in (B.9) that involve xt 1 + yt zt can be written as

     rα(xt 1 + yt zt ) ra0 + aR       R
                                                            
                              1 Ct + a2 yt − κa1 C̄ − b0 a2

       1
      − (rα)2 (xt 1 + yt zt )(f Σ + s2 a1 a′1 )(xt 1 + yt zt )′ + rαs2 (xt 1 + yt zt )a1 f1 (Xt )
       2
                                 1
      = rα(xt 1 + yt zt )h(Xt ) − (rα)2 (xt 1 + yt zt )(f Σ + s2 a1 a′1 )(xt 1 + yt zt )′
                                 2
                        1
      = rαyt θh(Xt ) − (rα)2 yt2 θ(f Σ + s2 a1 a′1 )θ ′
                        2
                                                                             ′
                                  1               2     ′                   ′
      + rαxt (1 − yt ) 1h(Xt ) − rα1(f Σ + s a1 a1 ) [xt (1 − yt )1 + 2yt θ] ,                             (B.10)
                                  2

where the first step follows from (B.8) and the second from the equilibrium condition zt = θ − xt 1.
Using zt = θ − xt 1, we can write (B.7) as

        1h(Xt ) = rα1(f Σ + s2 a1 a′1 ) [xt (1 − yt )1 + yt θ]′                                            (B.11)

                        1h(Xt ) − rαyt 1(f Σ + s2 a1 a′1 )θ ′
      ⇒xt (1 − yt ) =                                         .                                            (B.12)
                             rα1(f Σ + s2 a1 a′1 )1′

Eqs. (B.11) and (B.12) imply that
                                                                           ′
                              1           2    ′                          ′
      rαxt (1 − yt ) 1h(Xt ) − rα1(f Σ + s a1 a1 ) [xt (1 − yt )1 + 2yt θ]
                              2
        1
      = [rαxt (1 − yt )]2 1(f Σ + s2 a1 a′1 )1′
        2
                                                2
        1 1h(Xt ) − rαyt 1(f Σ + s2 a1 a′1 )θ ′
          
      =                                            .                                                       (B.13)
        2         1(f Σ + s2 a1 a′1 )1′


                                                        48
Substituting (B.10) and (B.13) into (B.9), we find
                                                                                          2
                                                  1 1h(Xt ) − rαyt 1(f Σ + s2 a1 a′1 )θ ′
                                                    
                     1      2 2       2                                                                 1
                                           ′   ′
      rαyt θh(Xt ) − (rα) yt θ(f Σ + s a1 a1 )θ +                      2   ′    ′            − rαyt Ct − rαψvt2
                     2                            2          1(f Σ + s a1 a1 )1                         2
                                    
                               1                                          1 
      − r q0 + (q1 , q2 )Xt + Xt′ QXt + f1 (Xt )κ(C̄ − Ct ) + f2 (Xt )vt + s2 q11 − f1 (Xt )2
                                                                                                 
                               2                                          2

       + β − r + r log(r) = 0.                                                                                 (B.14)

Since vt in (4.2) is linear in Xt , (B.14) is quadratic in Xt . Identifying quadratic, linear and constant
terms yields six scalar equations in (q0 , q1 , q2 , Q). We defer the derivation of these equations until
the proof of Proposition 4.3 (see (B.42)-(B.44)).

     We next study optimization over vt , and derive a first-order condition under which the control
(4.2) is optimal. We use a perturbation argument, which consists in assuming that the investor fol-
lows the control (4.2) except for an infinitesimal deviation over an infinitesimal internal.28 Suppose
that the investor adds ωdǫ to the control (4.2) over the interval [t, t + dǫ] and subtracts ωdǫ over the
interval [t + dt − dǫ, t + dt], where the infinitesimal dǫ > 0 is o(dt). The increase in adjustment cost
over the first interval is ψvt ω(dǫ)2 and over the second interval is −ψvt+dt ω(dǫ)2 . These changes
reduce the investor’s wealth at time t + dt by

      ψvt ω(dǫ)2 (1 + rdt) − ψvt+dt ω(dǫ)2

       = ψω(dǫ)2 (rvt dt − dvt )

       = ψω(dǫ)2 (rvt dt + b1 dCt + b2 dyt )

       = ψω(dǫ)2 (r + b2 )vt dt + b1 κ(C̄ − Ct )dt + sdBtC ,
                                                        
                                                                                                               (B.15)

where the second step follows from (4.2) and the third from (2.3). The change in the investor’s
wealth between t and t + dt is derived from (4.4) and (B.1), by subtracting (B.15) and replacing yt
by yt + ω(dǫ)2 :

      dWt =Gω dt − ψω(dǫ)2 b1 κ(C̄ − Ct )dt + sdBtC
                                                   


                                                              φdBtF
                                                                             
                                        2                 D                   C
                                          
               + xt 1 + yt + ω(dǫ)              zt    σ dBt +         − sa1 dBt ,                              (B.16)
                                                              r+κ
  28
     The perturbation argument is simpler than the dynamic programming approach, which assumes that the investor
can follow any control vt over the entire history. Indeed, under the dynamic programming approach, the state variable
yt which describes the investor’s holdings in the active fund must be replaced by two state variables: the holdings
out of equilibrium, and the holdings in equilibrium. This is because the latter affect the equilibrium price, which the
investor takes as given.



                                                            49
where
     Gω ≡rWt + xt 1 + yt + ω(dǫ)2 zt              ra0 + aR       R                                 2
                                                                                                
                                                         1 Ct + a2 yt − κa1 C̄ − b0 a2 − yt + ω(dǫ) Ct

                  ψvt2
              −        − ct − ψω(dǫ)2 (r + b2 )vt .
                   2

The investor’s position in the active fund at t + dt is the same under the deviation as under no
deviation. Therefore, the investor’s expected utility at t + dt is given by the value function (4.5)
with the wealth Wt+dt determined by (B.16). The drift DV corresponding to the change in the
value function between t and t + dt is given by the following counterpart of (B.6):
                 
                       1                                                            ′
      DV = − V G − (rα)2 f xt 1 + yt + ω(dǫ)2 zt Σ xt 1 + yt + ω(dǫ)2 zt
                                                                         
                       2
                                                               
              1 2                      2
                                                           2
             − s rα xt 1 + yt + ω(dǫ) zt a1 − f1ω (Xt )          ,                                        (B.17)
              2

where

                                                   1
     G ≡ rαGω + f1ω (Xt )κ(C̄ − Ct ) + f2 (Xt )vt + s2 q11 ,
                                                   2

     f1ω (Xt ) ≡ f1 (Xt ) − rαψω(dǫ)2 b1 .

The drift is maximum for ω = 0, and this yields the first-order condition

     zt h(Xt ) − rαψb1 s2 (xt 1 + yt zt )a1 − Ct = rαzt (f Σ + s2 a1 a′1 )(xt 1 + yt zt )′ + ψhψ (Xt ),   (B.18)

where

     hψ (Xt ) ≡ (r + b2 )vt + b1 κ(C̄ − Ct ) − b1 s2 f1 (Xt ).

Using (B.7) and the equilibrium condition zt = θ − xt 1, we can write (B.18) as


   θh(Xt ) − rαψb1 s2 [xt (1 − yt )1 + yt θ] a1 − Ct = rαθ(f Σ + s2 a1 a′1 ) [xt (1 − yt )1 + yt θ]′ + ψhψ (Xt ).

                                                                                                          (B.19)

Using (B.12), we can write (B.19) as

                                          1h(Xt ) − rαyt 1(f Σ + s2 a1 a′1 )θ ′
     θ h(Xt ) − rαψb1 s2 yt a1 − rαψb1 s2
                             
                                                                                1a1 − Ct
                                               rα1(f Σ + s2 a1 a′1 )1′
                                                                               ′
                                       1h(Xt ) − rαyt 1(f Σ + s2 a1 a′1 )θ ′
                               
        = rαθ(f Σ + s2 a1 a′1 ) yt θ +                                       1    + ψhψ (Xt ).            (B.20)
                                            rα1(f Σ + s2 a1 a′1 )1′


                                                       50
Eq. (B.20) is linear in Xt . Identifying linear and constant terms, yields three scalar equations
in (b0 , b1 , b2 ). We defer the derivation of these equations until the proof of Proposition 4.3 (see
(B.29)-(B.35)).

Proof of Proposition 4.3: We first impose market clearing and follow similar steps as in the proof
of Proposition 3.3 to derive the constants (a0 , a1 , a2 , b0 , b1 , b2 ) as functions of (q̄1 , q̄2 , Q̄, q1 , q2 , Q).
Setting zt = θ − xt 1 and ȳt = 1 − yt , we can write (B.3) as

      h̄(X̄t ) = r ᾱ(f Σ + s2 a1 a′1 )(1 − yt )(θ − xt 1)′ .                                                   (B.21)

Premultiplying (B.21) by 1, dividing by r ᾱ, and adding to (B.11) divided by rα, we find

                       
        h(Xt ) h̄(X̄t )
      1       +           = 1(f Σ + s2 a1 a′1 )θ ′ .                                                            (B.22)
         rα      r ᾱ

Eq. (B.22) is linear in (Ct , yt ). Identifying terms in Ct and yt , we find

        r + κ + s2 q11 r + κ + s2 q̄11
                                           
                                                     b1 (α + ᾱ)
                       +                      1a1 +              1a2 = 0,                                       (B.23)
              rα                  r ᾱ                   rαᾱ
       2
        s q12 s2 q̄12
                       
                                   (r + b2 )(α + ᾱ)
              +          1a1 +                       1a2 = 0,                                                   (B.24)
         rα       r ᾱ                   rαᾱ

respectively. Eqs. (B.23) and (B.24) imply

      1a1 = 1a2 = 0.                                                                                            (B.25)

Identifying constant terms in (B.22), and using (B.25), we find (A.29). Substituting (A.29) and
(B.25) into (B.11), we find (A.30).

     Substituting (A.30) into (B.21), we find

                                                                                 ′
                                                     α 1Σθ ′
                                               
                                2
      h̄(X̄t ) = r ᾱ(f Σ + s       a1 a′1 )                   1 + (1 − yt )pf        .                         (B.26)
                                                   α + ᾱ 1Σ1′

Eq. (A.31) is linear in X̄t . Identifying terms in Ct and yt , we find

      (r + κ + s2 q̄11 )a1 + b1 a2 = 0,                                                                         (B.27)

      s2 q̄12 a1 + (r + b2 )a2 = −r ᾱ f Σp′f + s2 a′1 p′f a1 ,
                                                             
                                                                                                                (B.28)




                                                                   51
respectively. Therefore, (a1 , a2 ) are collinear to the vector Σp′f , as in (4.7). Substituting (4.7) into
(B.27) and (B.28), we find

       (r + κ + s2 q̄11 )γ1 + b1 γ2 = 0,                                                                               (B.29)

                                           s2 γ12 ∆
                                                          
        2
       s q̄12 γ1 + (r + b2 )γ2 = −r ᾱ f +                     ,                                                       (B.30)
                                            1Σ1′

respectively. Identifying constant terms in (B.26), and using (4.7), we find

            αᾱf 1Σθ ′ ′       γ1 (κC̄ − s2 q̄1 ) + b0 γ2          s2 γ12 ∆
                                                                          
       a0 =             Σ1 +                              + ᾱ f +             Σp′f .                                  (B.31)
            α + ᾱ 1Σ1′                   r                         1Σ1′


     Using (A.30), we can write (B.19) as

                              ᾱ 1Σθ ′
                                                
      θh(Xt ) − rαψb1 s2                1 + y t f a1 − Ct
                                               p
                           α + ᾱ 1Σ1′
                                                    ′
                                 ᾱ 1Σθ ′
                             
                    2    ′
       = rαθ(f Σ + s a1 a1 )               1 + yt pf + ψhψ (Xt )
                               α + ᾱ 1Σ1′

                                               rαᾱf (1Σθ ′ )2          s2 γ12 ∆
                                                                                
                                ∆ 2                                                 ∆
        ⇒ θh(Xt ) − rαψb1 s γ1    ′ y t − Ct =              ′  + rα f +        ′        yt + ψhψ (Xt ),
                               1Σ1             α + ᾱ 1Σ1                1Σ1       1Σ1′
                                                                                               (B.32)

where the second step follows from (4.7). Eq. (B.32) is linear in (Ct , yt ). Identifying terms in Ct
and yt , and using (4.2) and (4.7), we find
                                   ∆
           (r + κ + s2 q11 )γ1 + b1 γ2     − 1 = −ψb1 (r + κ + b2 + s2 q11 ),
       
                                                                                                    (B.33)
                                    1Σ1′
                                                            s2 γ12 ∆
                                                                    
                                      2
                                           ∆                           ∆
                                                                              − ψ (r + b2 )b2 + b1 s2 q12 ,
                                                                                                       
         (r + b2 )γ2 + (q12 − rαψb1 )s γ1       ′ = rα f +         ′        ′
                                            1Σ1              1Σ1       1Σ1
                                                                                                    (B.34)

respectively. Identifying constant terms, and using (4.2), (4.7) and (B.31), we find

                                       s2 γ12 ∆
                                                
            2                                           ∆
                                                            = ψ (r + b2 )b0 + b1 (κC̄ − s2 q1 ) .
                                                                                              
           s γ1 (q1 − q̄1 ) + r ᾱ f +                                                                                 (B.35)
                                        1Σ1′           1Σ1′




     The system of equations characterizing equilibrium is as follows. The endogenous variables
are (a0 , a1 , a2 , b0 , b1 , b2 , γ1 , γ2 , q̄1 , q̄2 , Q̄, q1 , q2 , Q). (As in Proposition 3.3, we can drop (q̄0 , q0 ).) The
equations linking them are (4.7), (B.29)-(B.31), (B.33)-(B.35), the five equations derived from (B.5)

                                                               52
by identifying linear and quadratic terms, and the five equations derived from (B.14) through the
same procedure. We next simplify the latter two sets of equations, using implications of market
clearing.

       Using (B.26), we find

                                                   r 2 α2 ᾱ2 f (1Σθ ′ )2 1 2 2                     s2 γ12 ∆
                                                                                                            
       1                                                                                                       ∆
         h̄(X̄t )′ (f Σ + s2 a1 a′1 )−1 h̄(X̄t ) =                       +   r ᾱ (1 − y t )2
                                                                                                f +              . (B.36)
       2                                            2(α + ᾱ)2 1Σ1′        2                         1Σ1′ 1Σ1′

We next substitute (B.36) into (B.5), and identify terms. Identifying terms in Ct2 , Ct yt and yt2 , we
find

         1 ′
           X̄t Q̄R̄2 Q̄ + Q̄R̄1 + R̄′1 Q̄ − R̄0 X̄t = 0,
                                               
                                                                                                                       (B.37)
         2

where

                     s2 0
                                
         R̄2 ≡                       ,
                     0 0

                     r
                                               
                     2   +κ              0
         R̄1 ≡                   r                  ,
                         b1      2       + b2
                                                                     !
                         0        r ᾱλ
         R̄0 ≡              2  2      s2 γ12 ∆
                                               
                                                 ∆                        .
                     r ᾱλ r ᾱ f + 1Σ1′ 1Σ1       ′



Eq. (B.37) must hold for all X̄t . Since the square matrix in (B.37) is symmetric, it must equal zero,
and this yields the algebraic Riccati equation

         Q̄R̄2 Q̄ + Q̄R̄1 + R̄′1 Q̄ − R̄0 = 0.                                                                         (B.38)

We next identify terms in Ct and yt , which yield

         (r + κ + s2 q̄11 )q̄1 + b1 q̄2 − κC̄ q̄11 − b0 q̄12 = 0,                                                      (B.39)

                                                               s2 γ12 ∆
                                                                         
                             2                  2 2                            ∆
         (r + b2 )q̄2 + s q̄1 q̄12 + r ᾱ                   f+                     − r ᾱB − κC̄ q̄12 − b0 q̄22 = 0,   (B.40)
                                                                1Σ1′          1Σ1′

respectively. Using (3.15) and (A.30), we can write (B.11) as

                         rαᾱf
         1h(Xt ) =              1Σθ ′ .                                                                                (B.41)
                         α + ᾱ


                                                                              53
Using (4.2), (4.7), (B.32) and (B.41), we find that the equation derived from (B.14) by identifying
terms in Ct2 , Ct yt and yt2 is

       QR2 Q + QR1 + R′1 Q − R0 = 0,                                                                                      (B.42)

where

                   s2 0
                          
       R2 ≡                    ,
                   0 0

                   r
                       + κ rαψb1 s2
                                        
       R1 ≡        2                         ,
                            r
                       b1   2 + b2


                       −rαψb21
                                                                                                                               !
                                                                          −rαψb1 (r + κ + 2b2 )
 R0 ≡                                   
                                                         s2 γ12 ∆
                                                                    
                                                                         ∆                          ∆                              ,
            −rαψb1 (r + κ + 2b2 ) r 2 α2 f +              1Σ1′          1Σ1′   + 2r 2 α2 ψb1 s2 γ1 1Σ1 ′ − rαψb2 (2r + 3b2 )



and the equations derived by identifying terms in Ct and yt are

       (r + κ + s2 q11 )q1 + b1 q2 − rαψb0 b1 − κC̄q11 − b0 q12 = 0,                                                      (B.43)

       (r + b2 )q2 + s2 (q12 + rαψb1 )q1 − rαψ (r + 2b2 )b0 + b1 κC̄ − κC̄q12 − b0 q22 = 0,
                                                                    
                                                                                                                          (B.44)

respectively.

     Solving for equilibrium amounts to solving the system of (4.7), (B.29)-(B.31), (B.33)-(B.35),
(B.38)-(B.40) and (B.42)-(B.44) in the unknowns (a0 , a1 , a2 , b0 , b1 , b2 , γ1 , γ2 , q̄1 , q̄2 , Q̄, q1 , q2 , Q). This
reduces to solving the system of (B.29), (B.30), (B.33), (B.34), (B.38) and (B.42) in the unknowns
(b1 , b2 , γ1 , γ2 , Q̄, Q): given (b1 , b2 , γ1 , γ2 , Q̄, Q), (a1 , a2 ) can be determined from (4.7), (b0 , q̄1 , q̄2 , q1 , q2 )
from the linear system of (B.35), (B.39), (B.40), (B.43) and (B.44), and a0 from (B.31). We replace
the system of (B.29), (B.30), (B.33), (B.34), (B.38) and (B.42) by the equivalent system of (B.29),
(B.30), (B.38), (B.42),

                                                                         ∆
       ψb1 (r + κ + b2 + s2 q11 ) = 1 + s2 γ1 (q̄11 − q11 )                  ,                                            (B.45)
                                                                        1Σ1′
                                                                      s2 γ12 ∆
                                                                              
                                                ∆                                ∆                        ∆
       ψ (r + b2 )b2 + b1 s2 q12 − rαψb1 s2 γ1                                     + s2 γ1 (q̄12 − q12 )
                               
                                                    = r(α + ᾱ)   f +                                         .
                                               1Σ1′                    1Σ1′ 1Σ1′                         1Σ1′
                                                                                                  (B.46)




                                                                54
     For s = 0, (B.29), (B.30), (B.38), (B.42), (B.45) and (B.46) become

       (r + κ)γ1 + b1 γ2 = 0,                                                                                    (B.47)

       (r + b2 )γ2 = −r ᾱf,                                                                                     (B.48)
                        ′
       Q̄R̄01 + R̄01 Q̄ − R̄00 = 0,                                                                              (B.49)
                        ′
       QR01 + R01 Q − R00 = 0,                                                                                   (B.50)

       ψb1 (r + κ + b2 ) = 1,                                                                                    (B.51)

                                              ∆
       ψ(r + b2 )b2 = r(α + ᾱ)f                  ,                                                              (B.52)
                                             1Σ1′

respectively, where

                                r
                                                     
                                    +κ       0
       R̄01   =   R01   ≡       2
                                         r                ,
                                    b1   2   + b2

                                             
                        0       r ᾱλ
       R̄00   ≡                       ∆           ,
                      r ᾱλ r ᾱ2 f 1Σ1
                             2
                                        ′



                           −rαψb21
                                                                                  
                                                  −rαψb1 (r + κ + 2b2 )
       R00    ≡                                       ∆                                .
                      −rαψb1 (r + κ + 2b2 ) r 2 α2 f 1Σ1′ − rαψb2 (2r + 3b2 )



Eq. (B.52) is quadratic and has a unique positive solution b2 .29 Given b2 , b1 is determined uniquely
from (B.51), γ2 from (B.48), γ1 from (B.47), Q̄ from (B.49) (which is linear in Q̄), and Q from
(B.50) (which is linear in Q). We denote this solution by (b01 , b02 , γ10 , γ20 , Q̄0 , Q0 ).

     To show that the system of (B.29), (B.30), (B.38), (B.42), (B.45) and (B.46) has a solution for
small s, we apply the implicit function theorem. We move all terms in each equation to the left-
hand side, and stack all left-hand sides into a vector F, in the order (B.46), (B.45), (B.30), (B.29),
(B.38), (B.42). Treated as a function of (b1 , b2 , γ1 , γ2 , Q̄, Q, s), F is continuously differentiable
around the point A ≡ (b01 , b02 , γ10 , γ20 , Q̄0 , Q0 , 0) and is equal to zero at A. To show that the Jacobian
matrix of F with respect to (b1 , b2 , γ1 , γ2 , Q̄, Q) has non-zero determinant at A, we note that F has
a triangular structure for s = 0: F1 depends only on b2 , F2 only on (b1 , b2 ), F3 only on (b2 , γ2 ),
F4 only on (b1 , γ1 , γ2 ), F5 only on (b1 , b2 , Q̄), and F6 only on (b1 , b2 , Q). Therefore, the Jacobian
matrix of F has non-zero determinant at A if the derivatives of F1 with respect to b2 , F2 with
  29
     The positive solution is the relevant one. Indeed, since the negative solution satisfies r + 2b2 < 0, (B.49) implies
that q̄22 < 0. Therefore, the manager’s certainty equivalent would converge to −∞ at the rate yt2 when |yt | goes to
∞ and Ct is held constant. The manager can, however, achieve higher certainty equivalent by not investing in the
active fund.


                                                              55
respect to b1 , F3 with respect to γ2 , and F4 with respect to γ1 are non-zero, and the Jacobian
matrices of F5 with respect to Q̄ and F6 with respect to Q have non-zero determinants. These
results follow from (B.47)-(B.52) and the positivity of (b01 , b02 ). Therefore, the implicit function
theorem applies, and the system of (B.29), (B.30), (B.38), (B.42), (B.45) and (B.46) has a solution
for small s. This solution is unique in a neighborhood of (b01 , b02 , γ10 , γ20 , Q̄0 , Q0 ), which corresponds
to the unique equilibrium for s = 0. Since b01 > 0, b02 > 0, γ10 > 0, γ20 < 0, continuity implies that
b1 > 0, b2 > 0, γ1 > 0, γ2 < 0 for small s.

Proof of Corollary 4.1: Stocks’ expected returns are

    Et (dRt ) = ra0 + aR       R
                                                    
                       1 Ct + a2 yt − κa1 C̄ − b0 a2 dt

                    rαᾱf 1Σθ ′ ′                                  s2 γ12 ∆
                                                                                         
                                          R        R                                 2      ′
                =                Σ1 + γ1 Ct + γ2 yt + r ᾱ f +                 − γ1 s q̄1 Σpf dt
                    α + ᾱ 1Σ1′                                     1Σ1′

                     rαᾱ 1Σθ ′
                                                                          
                                        2    ′   ′             2    ′    ′
                =               (f Σ + s a1 a1 )1 + Λt (f Σ + s a1 a1 )pf dt,                           (B.53)
                    α + ᾱ 1Σ1′

where

      γ1R ≡ (r + κ)γ1 + b1 γ2 ,

      γ2R ≡ (r + b2 )γ2 .

The first step in (B.53) follows from (B.1), the second from (4.7) and (B.31), and the third from
(4.7) and (4.8). Eq. (B.53) is equivalent to (3.21) because of (3.5).

    Eq. (B.29) implies that γ1R has the opposite sign of γ1 q̄11 . For small s, γ1 > 0 and q̄11 has the
                         0 for s = 0. Eq. (B.49) implies that
same sign as its value q̄11

        0       2b01 q̄12
                       0
      q̄11 =−
                r + 2κ
                     2b01
                                     r ᾱλ − b01 q̄22
                                                   0
                                                      
          =−                    0                       ,
             (r + 2κ)(r + κ + b2 )

                    2r ᾱb01                  r ᾱb01 f ∆
                                                              
          =−                          λ−                         ,
             (r + 2κ)(r + κ + b02 )        (r + 2b02 )1Σ1′

                    2r ᾱb01
                                                                         
                                                          r ᾱf ∆
          =−                          λ−                                    ,                           (B.54)
             (r + 2κ)(r + κ + b02 )        ψ(r + κ + b02 )(r + 2b02 )1Σ1′




                                                      56
where the last step follows from (B.51). Using (B.52), we find
                                               ∆
     ψ(r + κ + b02 )(r + 2b02 ) = 2r(α + ᾱ)f      + ψ (r + 2κ)b02 + r(r + κ)
                                                                            
                                              1Σ1′

                                                         "             s                 #
                                               ∆     ψr                     4(α + ᾱ)f ∆
                                = 2r(α + ᾱ)f      +       r + (r + 2κ) 1 +                .    (B.55)
                                              1Σ1′    2                        rψ1Σ1′

                                    0 is positive if (4.9) holds, and is negative otherwise. Therefore,
Eqs. (B.54) and (B.55) imply that q̄11
for small s, γ1R is negative if (4.9) holds, and is positive otherwise. Moreover, γ2R < 0 since b2 > 0
and γ2 < 0.

Proof of Corollary 4.2: Using (B.1) and proceeding as in the derivation of (A.56), we find
                               h                           ′ i
    Covt (dRt , dRt′ ′ ) = Covt −sa1 dBtC , aR        R
                                             1 Ct′ + a2 yt′ dt


                         = −sγ1 Covt dBtC , γ1R Ct′ + γ2R yt′ Σp′f pf Σdt,
                                                             
                                                                                                (B.56)

where the last step follows from (4.7). Using the dynamics (2.3) and (4.2), we can express (Ct′ , yt′ )
as a function of their time t values and the Brownian shocks dBuC for u ∈ [t, t′ ]. The covariance
(B.56) depends only on how the Brownian shock dBtC impacts (Ct′ , yt′ ). (See the proof of Corollary
3.6.) To compute this impact, we solve the “impulse-response” dynamics

     dCt = −κCt dt,

      dyt = −(b1 Ct + b2 yt )dt,

with the initial conditions
     Ct = sdBtC ,

      yt = 0.

The solution to these dynamics is
                 ′
     Ct′ = e−κ(t −t) sdBtC ,                                                                    (B.57)
               h       ′           ′
                                        i
             b1 e−κ(t −t) − e−b2 (t −t)
     yt′ = −                              sdBtC ,                                               (B.58)
                         b2 − κ

and the implied dynamics of expected return are
                                         h     ′             ′
                                                                  i
      E(dRt′ )           ′
                                        b1 e−κ(t −t) − e−b2 (t −t) 
               = γ1R e−κ(t −t) − γ2R                                   sΣp′f dBtC .             (B.59)
        dt                                         b2 − κ         


                                                      57
Eqs. (B.58) and (B.59) are used to plot the solid and dashed lines, respectively, in Figure 1.
Substituting (B.57) and (B.58) into (B.56), we find (4.11) with

                  b1 γ2R
                                                        
            2               R      2             b1 γ2
     χ1 ≡ s γ1           − γ1 = s (r + κ)γ1            − γ1 ,                                    (B.60)
                 b2 − κ                         b2 − κ

               s2 b1 γ1 γ2R    s2 (r + b2 )b1 γ1 γ2
      χ2 ≡ −                =−                      .                                            (B.61)
                b2 − κ               b2 − κ

The function χ(u) ≡ χ1 e−κu + χ2 e−b2 u can change sign only once, is equal to −s2 γ1 γ1R when u = 0,
and has the sign of χ1 if b2 > κ and of χ2 if b2 < κ when u goes to ∞. For small s, γ1R is negative if
(4.9) holds, and is positive otherwise. The opposite is true for χ(0) since γ1 > 0. Since, in addition,
b1 > 0, b2 > 0 and γ2 < 0, (B.60) and (B.61) imply that χ1 < 0 if b2 > κ and χ2 < 0 if b2 < κ.
Therefore, there exists a threshold û ≥ 0, which is positive if (4.9) holds and is zero otherwise, such
that χ(u) > 0 for 0 < u < û and χ(u) < 0 for u > û.



C     Asymmetric Information

Proof of Proposition 5.1: We use Theorem 10.3 of Liptser and Shiryaev (LS 2000). The investor
learns about Ct , which follows the process (2.3). She observes the following information:


    • The net dividends of the residual-supply portfolio θDt −Ct dt. This corresponds to the process
                  Rt
      ξ1t ≡ θDt − 0 Cs ds.

    • The dividends of the index fund 1dDt . This corresponds to the process ξ2t ≡ 1Dt .

    • The price of the residual-supply portfolio θSt . Given the conjecture (5.1) for stock prices,
      this is equivalent to observing the process ξ3t ≡ θ(St + a1 Ĉt + a3 yt ).

    • The price of the index portfolio 1St . This is equivalent to observing the process ξ4t ≡
      1(St + a1 Ĉt + a3 yt ).




                                                        58
    The dynamics of ξ1t are
      dξ1t = θ(Ft dt + σdBtD ) − Ct dt
                                                                  
                            κθ F̄
             = (r + κ)θa0 −       + (r + κ)ξ3t + (r + κ)θa2 Ct − Ct dt + θσdBtD
                             r
                                                                  
                            κθ F̄                      (r + κ)γ2 ∆
             = (r + κ)θa0 −       + (r + κ)ξ3t − 1 −                 Ct dt + θσdBtD ,               (C.1)
                             r                            1Σ1′

where the first step follows from (2.5), the second from (5.1), and the third from (5.2). Likewise,
the dynamics of ξ2t are
                                            
                            κ1F̄
      dξ2t   = (r + κ)1a0 −      + (r + κ)ξ4t dt + 1σdBtD .                                         (C.2)
                             r

The dynamics of ξ3t are
                                                
                   F̄    Ft − F̄
     dξ3t = d θ        +          − (a0 + a2 Ct )
                    r     r+κ

               κ(F̄ − Ft )dt + φσdBtF
                                                                        
                                                                     C
                                                                      
          =θ                             − a2 κ(C̄ − Ct )dt + sdBt
                         r+κ

                                                    φθσdBtF
                                         
                    F̄
          =κ θ         − a0 − a2 C̄ − ξ3t dt +               − sθa2 dBtC
                    r                                 r+κ

                                                     φθσdBtF    sγ2 ∆dBtC
                                            
               θ F̄           γ2 ∆C̄
          =κ         − θa0 −         −  ξ 3t   dt +          −             ,                        (C.3)
                r             1Σ1′                    r+κ         1Σ1′

where the first step follows from (5.1), the second from (2.6) and (2.3), and the fourth from (5.2).
Likewise, the dynamics of ξ4t are

                                            φ1σdBtF
                                     
                       1F̄
      dξ4t = κ             − 1a0 − ξ4t dt +         .                                               (C.4)
                        r                    r+κ


    The dynamics (2.3) and (C.1)-(C.4) map into the dynamics (10.62) and (10.63) of LS by setting
                                                 D 
                                                 Bt
                                       ′
θt ≡ Ct , ξt ≡ (ξ1t , ξ2t , ξ3t , ξ4t ) , W1t ≡       , W2t ≡ BtC , a0 (t) ≡ κC̄, a1 (t) ≡ −κ, a2 (t) ≡ 0,
                                                 BtF
b1 (t) ≡ 0, b2 (t) ≡ s, γt ≡ R,

                                          κθ F̄
                                                   
                          (r + κ)θa0 −      r
                                          κ1F̄
                         (r + κ)1a0 −
                                                   
                                           r      
      A0 (t) ≡ 
                κ        θ F̄           γ2 ∆C̄     ,
                           r − θa0 −           ′
                                         1Σ1
                                                    
                                                  
                           κ 1rF̄ − 1a0

                                                         59
                               (r+κ)γ2 ∆      
                       1−         1Σ1′
                                  0           
      A1 (t) ≡ −                              ,
                                  0           
                                   0
                                   
                 0        0 r+κ   0
                0        0  0  r+κ 
      A2 (t) ≡ 
                0
                                    ,
                          0 −κ    0 
                 0        0  0   −κ

                 θσ            0
                                      
                1σ            0       
      B1 (t) ≡ 
                0             φθσ     ,
                                       
                               r+κ
                               φ1σ
                  0            r+κ

                                  
                           0
                          0       
      B2 (t) ≡ − 
                      sγ2 ∆
                                   .
                                   
                       1Σ1′
                           0

The quantities (b ◦ b)(t), (b ◦ B)(t), and (B ◦ B)(t), defined in LS (10.80) are

      (b ◦ b)(t) = s2 ,

                                                        
      (b ◦ B)(t) = −                       s2 γ2 ∆           ,
                               0 0          1Σ1′     0

                     θΣθ ′ 1Σθ ′                                 0             0
                                                                                      
                    1Σθ ′ 1Σ1′                                  0             0       
      (B ◦ B)(t) =  0                               φ2 θΣθ ′   s2 γ22 ∆2   φ2 1Σθ ′   .
                                                                                      
                           0                        (r+κ)2 + (1Σ1′ )2      (r+κ)2     
                                                           φ2 1Σθ ′         φ2 1Σ1′
                      0     0                              (r+κ)2           (r+κ)2


Theorem 10.3 of LS (first subequation of (10.81)) implies that
                                                                                               
                                                            κθ F̄                    (r + κ)γ2 ∆
     dĈt =κ(C̄ − Ĉt )dt − β1 dξ1t − (r + κ)θa0 −                + (r + κ)ξ3t − 1 −              Ĉt dt
                                                             r                          1Σ1′

              1Σθ ′
                                                                    
                                                κ1F̄
           −          dξ 2t −   (r  +  κ)1a0 −         + (r +  κ)ξ 4t dt
              1Σ1′                                r
                                                           
                                θ F̄           γ2 ∆C̄
           − β2 dξ3t − κ             − θa0 −           − ξ3t dt
                                 r             1Σ1′

              1Σθ ′
                                                     
                                   1F̄
           −          dξ 4t − κ         − 1a 0 −  ξ 4t dt    .                                      (C.5)
              1Σ1′                   r



                                                                     60
Eq. (5.4) follows from (C.5) by noting that the term in dt after each dξit , i = 1, 2, 3, 4, is Et (dξit ).
In subsequent proofs we use a different form of (5.4), where we replace each dξit , i = 1, 2, 3, 4, by
its value in (C.1)-(C.4):


                                                                                             φpf σdBtF   sγ2 ∆dBtC
                                                                                                                
                                                (r + κ)γ2 ∆
dĈt = κ(C̄−Ĉt )dt−β1          pf σdBtD   − 1−                     (Ct − Ĉt )dt −β2                  −                 .
                                                   1Σ1′                                        r+κ         1Σ1′

                                                                                                                (C.6)

Eq. (5.7) follows from Theorem 10.3 of LS (second subequation of (10.81)).

Proof of Proposition 5.2: Eqs. (2.3), (2.5), (2.6), (5.1)-(5.3) and (C.6) imply that the vector of
returns is
           n     h                                                 i    o
      dRt = ra0 + γ1R Ĉt + γ2R Ct + γ3R yt − κ(γ1 + γ2 )C̄ − b0 γ3 Σp′f dt + σ + β1 γ1 Σp′f pf σ dBtD
                                                                                                 

                                                                 
                    φ                                     β2 γ1 ∆
                       σ + β2 γ1 Σp′f pf σ dBtF − sγ2 1 +           Σp′f dBtC ,
                                          
               +                                                                                                (C.7)
                   r+κ                                     1Σ1′

where

      γ1R ≡ (r + κ + ρ)γ1 + b1 γ3 ,

      γ2R ≡ (r + κ)γ2 − ργ1 ,

      γ3R ≡ (r + b2 )γ3 ,

and
                                     
                      (r + κ)γ2 ∆
      ρ ≡ β1       1−                      .                                                                    (C.8)
                         1Σ1′

Eqs. (2.3), (3.3), (5.3), (C.6) and (C.7) imply that
                                                        
                                              1 ′
      d r ᾱWt + q̄0 + (q̄1 , q̄2 , q̄3 )X̄t + X̄t Q̄X̄t
                                              2

       = Ḡdt + r ᾱẑt σ + β1 γ1 Σp′f pf σ − β1 f¯1 (X̄t )pf σ dBtD
                                                             

            φ 
                  r ᾱẑt σ + β2 γ1 Σp′f pf σ − β2 f¯1 (X̄t )pf σ dBtF
                                                                 
        +
          r+κ
                                                β2 γ2 ∆f¯1 (X̄t )
                                                                           
                           β2 γ1 ∆                                  ¯
        − s r ᾱγ2 1 +               ẑt Σp ′
                                            f −                   − f 2 (X̄t )  dBtC ,                          (C.9)
                            1Σ1′                     1Σ1′



                                                           61
where
                       n     h                                                 i    o                    
      Ḡ ≡r ᾱ rWt + ẑt ra0 + γ1R Ĉt + γ2R Ct + γ3R yt − κ(γ1 + γ2 )C̄ − b0 γ3 Σp′f + (λCt + B)yt − c̄t
                        h                           i
            + f¯1 (X̄t ) κ(C̄ − Ĉt ) + ρ(Ct − Ĉt ) + f¯2 (X̄t )κ(C̄ − Ct ) + f¯3 (X̄t )vt

                     φ2 β22   s2 β22 γ22 ∆ ∆q̄11 s2 β2 γ2 ∆q̄12 1 2
                                         
              1 2
            +    β +        +                    +             + s q̄22 ,
              2 1 (r + κ)2      1Σ1′        1Σ1′     1Σ1′       2

      f¯1 (X̄t ) ≡ q̄1 + q̄11 Ĉt + q̄12 Ct + q̄13 yt ,

      f¯2 (X̄t ) ≡ q̄2 + q̄12 Ĉt + q̄22 Ct + q̄23 yt ,

      f¯3 (X̄t ) ≡ q̄3 + q̄13 Ĉt + q̄23 Ct + q̄33 yt .

Eqs. (5.9) and (C.9) imply that
                 
                       1
      D V̄ = − V̄ Ḡ − (r ᾱ)2 f ẑt Σẑt′
                       2

                                                                                      β1 ∆f¯1 (X̄t )
                                                                                                  
                1                                            β1 γ1 ∆
              − β1 r ᾱγ1 ẑt Σp′f − f¯1 (X̄t ) r ᾱ 2 +                        ′
                                               
                                                                         ẑt Σp f −
                2                                              1Σ1′                        1Σ1′

                1 φ2 β2                                                                     β2 ∆f¯1 (X̄t )
                                                                                                         
                                          ′    ¯
                                                                     β2 γ1 ∆            ′
              −              r ᾱγ1 ẑt Σpf − f1 (X̄t ) r ᾱ 2 +                  ẑt Σpf −
                2 (r + κ)2                                             1Σ1′                      1Σ1′
                                                                                        2 )
                                                          β2 γ2 ∆f¯1 (X̄t )
                                          
                1 2                β2 γ1 ∆          ′                           ¯
              − s r ᾱγ2 1 +                  ẑt Σpf −                      − f2 (X̄t )      .                 (C.10)
                2                    1Σ1′                      1Σ1′

Substituting (C.10) into (3.8), we can write the first-order conditions with respect to c̄t and ẑt as
(A.3) and

      h̄(X̄t ) = r ᾱ(f Σ + kΣp′f pf Σ)ẑt′ ,                                                                   (C.11)

respectively, where
                      h                                                                                 i
      h̄(X̄t ) ≡ ra0 + γ1R Ĉt + γ2R Ct + γ3R yt − κ(γ1 + γ2 )C̄ − b0 γ3 + k1 f¯1 (X̄t ) + k2 f¯2 (X̄t ) Σp′f ,
                                                                                                                (C.12)

                                        φ2 β2 γ1                                 β2 γ1 ∆ 2
                                                                                    
                         β1 γ1 ∆                       β2 γ1 ∆       2 2
           k ≡ β1 γ1 2 +            +              2 +           + s  γ 2    1 +            ,                   (C.13)
                           1Σ1′        (r + κ)2          1Σ1′                     1Σ1′

                                       φ2 β2                     s2 β2 γ22 ∆
                                                                                       
                       β1 γ1 ∆                       β2 γ1 ∆                        β2 γ1 ∆
          k1 ≡ β1 1 +            +               1+            +                1+            ,                 (C.14)
                        1Σ1′         (r + κ)2         1Σ1′         1Σ1′              1Σ1′
                                
                         β2 γ1 ∆
          k2 ≡ s2 γ2 1 +           .                                                                            (C.15)
                          1Σ1′


                                                           62
Proceeding as in the proof of Proposition 3.1, we find the following counterpart of (A.10):
                                                                                                        
     1         ′           ′       −1                                                         1 ′
       h̄(X̄t ) (f Σ + kΣpf pf Σ) h̄(X̄t ) + r ᾱ(λCt + B)yt − r q̄0 + (q̄1 , q̄2 , q̄3 )X̄t + X̄t Q̄X̄t
     2                                                                                        2
                  h                           i
      + f¯1 (X̄t ) κ(C̄ − Ĉt ) + ρ(Ct − Ĉt ) + f¯2 (X̄t )κ(C̄ − Ct ) + f¯3 (X̄t )vt

                      φ2 β22   s2 β22 γ22 ∆ ∆q̄11 s2 β2 γ2 ∆q̄12 1 2
                                          
           1 2
       +       β1 +          +                    +             + s q̄22 + β̄ − r + r log(r)
           2        (r + κ)2     1Σ1′        1Σ1′     1Σ1′       2
                              ¯                                           2
                      φ2 β22  ∆f1 (X̄t )2 1 2 β2 γ2 ∆f¯1 (X̄t )
                                              
           1 2                                                    ¯2 (X̄t ) = 0.
       −       β1 +                      −   s                  + f                                          (C.16)
           2        (r + κ)2   1Σ1′        2       1Σ1′

Eq. (C.16) is quadratic in X̄t . Identifying quadratic, linear and constant terms yields ten scalar
equations in (q̄0 , q̄1 , q̄2 , q̄3 , Q̄). We defer the derivation of these equations until the proof of Propo-
sition 5.4 (see (C.40)-(C.43)).

Proof of Proposition 5.3: Dynamics under the investor’s filtration can be deduced from those
under the manager’s by replacing Ct by the investor’s expectation Ĉt . Eq. (C.6) implies that the
dynamics of Ĉt are

                                                             φpf σdBtF   sγ2 ∆dBtC
                                                                                    
      dĈt = κ(C̄ − Ĉt )dt − β1 pf σdB̂tD − β2                        −                 ,                   (C.17)
                                                               r+κ         1Σ1′

where B̂tD is a Brownian motion under the investor’s filtration. Eq. (C.7) implies that the net-of-cost
return of the active fund is

                         n     h                                                i    o
      zt dRt − Ct dt = zt ra0 + (g1R + g2R )Ĉt + g3R yt − κ(γ1 + γ2 )C̄ − b0 γ3 Σp′f dt − Ĉt dt
                                                                                              
                                                    φ                                  β2 γ1 ∆
                 β1 γ1 Σp′f pf σ       dB̂tD +zt                   ′        F
                                                                                                 zt Σp′f dBtC ,
                                                                        
      +zt σ +                                          σ + β2 γ1 Σpf pf σ dBt −sγ2 1 +
                                                   r+κ                                  1Σ1′
                                                                                                          (C.18)

and the return of the index fund is

              n     h                                                i    o
      1dRt = 1 ra0 + (g1R + g2R )Ĉt + g3R yt − κ(γ1 + γ2 )C̄ − b0 γ3 Σp′f dt
                                                                                             
                                                   φ                                  β2 γ1 ∆
                 β1 γ1 Σp′f pf σ       dB̂tD +1                   ′        F
                                                                                                1Σp′f dBtC .
                                                                       
      +1 σ +                                          σ + β2 γ1 Σpf pf σ dBt −sγ2 1 +
                                                  r+κ                                  1Σ1′
                                                                                                       (C.19)



                                                               63
     Suppose that the investor optimizes over (ct , xt ) but follows the control vt given by (5.3). Eqs.
(4.4), (5.3), (C.17), (C.18) and (C.19) imply that
                                             
                                    1 ′
       d rαWt + q0 + (q1 , q2 )Xt + Xt QXt
                                    2

        = Gdt + rα(xt 1 + yt zt ) σ + β1 γ1 Σp′f pf σ − β1 f1 (Xt )pf σ dB̂tD
                                                                     

            φ 
                  rα(xt 1 + yt zt ) σ + β2 γ1 Σp′f pf σ − β2 f1 (Xt )pf σ dBtF
                                                                         
        +
          r+κ
                                                                      
                         β2 γ1 ∆                         β2 γ2 ∆f1 (Xt )
        − s r ᾱγ2 1 +                               ′
                                    (xt 1 + yt zt )Σpf −                   dBtC ,                              (C.20)
                          1Σ1′                                1Σ1′

where
                                n     h                                                i    o
      G ≡rα rWt + (xt 1 + yt zt ) ra0 + (g1R + g2R )Ĉt + g3R yt − κ(γ1 + γ2 )C̄ − b0 γ3 Σp′f − yt Ĉt

               ψvt2                                                   φ2 β22   s2 β22 γ22 ∆ ∆q11
                                                                                         
                                                               1 2
             −      − ct + f1 (Xt )κ(C̄ − Ĉt ) + f2 (Xt )vt +    β +        +                    ,
                2                                              2 1 (r + κ)2      1Σ1′        1Σ1′

      f1 (Xt ) ≡ q1 + q11 Ĉt + q12 yt ,

      f2 (Xt ) ≡ q2 + q12 Ĉt + q22 yt .

Eqs. (4.5) and (C.20) imply that
                 
                        1
      DV = − V G − (rα)2 f (xt 1 + yt zt )Σ(xt 1 + yt zt )′
                        2
                                                                                                                     
               1                        ′
                                                                     β1 γ1 ∆                         ′    β1 ∆f1 (Xt )
             − β1 rαγ1 (xt 1 + yt zt )Σpf − f1 (Xt ) rα 2 +                       (xt 1 + yt zt )Σpf −
               2                                                       1Σ1′                                     1Σ1′

               1 φ2 β2 
                                                                                                                             
                                                 ′
                                                                              β2 γ1 ∆                        ′    β2 ∆f1 (Xt )
             −             rαγ (x
                              1 t  1 + y   z
                                         t t )Σp f − f 1 (X t )   rα    2 +                (x t 1 + y   z
                                                                                                      t t )Σp f  −
               2 (r + κ)2                                                       1Σ1′                                  1Σ1′
                                                                                  2 )
               1 2             β2 γ1 ∆                            β2 γ2 ∆f  1 (X t )
             − s rαγ2 1 +                (xt 1 + yt zt )Σp′f −                            .                      (C.21)
               2                1Σ1′                                   1Σ1′

Substituting (C.21) into (4.6), we can write the first-order conditions with respect to ct and xt as
(A.13) and

      1h(Xt ) = rα1(f Σ + kΣp′f pf Σ)(xt 1 + yt zt )′ ,                                                        (C.22)

respectively, where
                    h                                                              i
      h(Xt ) ≡ ra0 + (g1R + g2R )Ĉt + g3R yt − κ(γ1 + γ2 )C̄ − b0 γ3 + k1 f1 (Xt ) Σp′f .                     (C.23)

                                                          64
Proceeding as in the proof of Proposition 4.2, we find the following counterpart of (B.14):

                     1      2 2                          [1h(Xt ) − rαf yt1Σθ ′ ]2             1
                                             ′
      rαyt θh(Xt ) − (rα) yt θ(f Σ + kΣpf pf Σ)θ +  ′
                                                                                   − rαyt Ĉt − rαψvt2
                     2                                            2f 1Σ1′                      2
                                          
                               1 ′
      − r q0 + (q1 , q2 )Xt + Xt QXt + f1 (Xt )κ(C̄ − Ĉt ) + f2 (Xt )vt
                               2

                    φ2 β22     s2 β22 γ22 ∆ ∆[q11 − f1 (Xt )2 ]
                                          
        1 2
      +      β +            +                                   + β − r + r log(r) = 0.           (C.24)
        2 1 (r + κ)2             1Σ1′             1Σ1′

Since vt in (4.2) is linear in Xt , (C.24) is quadratic in Xt . Identifying quadratic, linear and constant
terms yields six scalar equations in (q0 , q1 , q2 , Q). We defer the derivation of these equations until
the proof of Proposition 5.4 (see (C.44)-(C.46)).

    We next study optimization over vt , using the same perturbation argument as in the proof of
Proposition 4.2. The counterparts of (B.19) and (B.20) are

     θ h(Xt ) − rαψb1 k1 yt Σp′f − Ĉt = rαθ(f Σ + kΣp′f pf Σ) [xt (1 − yt )1 + yt θ]′ + ψhψ (Xt ),
                               

                                                                                                              (C.25)

                                                                                       1h(Xt ) − rαyt f 1Σθ ′ ′
                                                                                                             
                   rαψb1 k1 yt Σp′f                           kΣp′f pf Σ)
                                     
      θ h(Xt ) −                          − Ĉt = rαθ(f Σ +                     yt θ +                       1 + ψhψ (Xt ),
                                                                                            rαf 1Σ1′
                                                                                                                (C.26)

respectively, where

                                                                 φ2 β22   s2 β22 γ22 ∆ ∆f1 (Xt )
                                                                                     
      hψ (Xt ) ≡ (r + b2 )vt + b1 κ(C̄ − Ĉt ) − b1 β12 +               +                        .
                                                               (r + κ)2     1Σ1′        1Σ1′

Eq. (C.26) is linear in Xt . Identifying linear and constant terms, yields three scalar equations
in (b0 , b1 , b2 ). We defer the derivation of these equations until the proof of Proposition 5.4 (see
(C.36)-(C.38)).

Proof of Proposition 5.4: We first impose market clearing and derive the constants (a0 , b0 , b1 , b2 , γ1 , γ2 , γ3 )
as functions of (q̄1 , q̄2 , q̄3 , Q̄, q1 , q2 , Q). Setting zt = θ − xt 1 and ȳt = 1 − yt , we can write (C.11)
and (C.22) as

        h̄(X̄t ) = r ᾱ(f Σ + kΣp′f pf Σ)(1 − yt )(θ − xt 1)′ ,                                               (C.27)

      1h(Xt ) = rα1(f Σ + kΣp′f pf Σ) [xt (1 − yt )1 + yt θ]′ ,                                               (C.28)




                                                         65
respectively. Premultiplying (C.27) by 1, dividing by r ᾱ, and adding to (C.28) divided by rα, we
find
                         
          h(Xt ) h̄(X̄t )
        1       +           = 1(f Σ + kΣp′f pf Σ)θ ′ .                                                (C.29)
           rα      r ᾱ

Eq. (C.29) is linear in (Ĉt , Ct , yt ). The terms in Ĉt , Ct and yt are zero because 1Σp′f = 0. Identifying
constant terms, we find (A.29). Substituting (A.29) into (C.28), we find (A.30).

       Substituting (A.30) into (C.27), we find

                                                                                ′
                                                    α 1Σθ ′
                                              
        h̄(X̄t ) = r ᾱ(f Σ +   kΣp′f pf Σ)                   1 + (1 − yt )pf        .                (C.30)
                                                  α + ᾱ 1Σ1′

Eq. (C.30) is linear in X̄t . Identifying terms in Ĉt , Ct and yt , we find

        (r + κ + ρ)γ1 + b1 γ3 + k1 q̄11 + k2 q̄12 = 0,                                                (C.31)

        (r + κ)γ2 − ργ1 + k1 q̄12 + k2 q̄22 = 0,                                                      (C.32)
                                                        
                                                     k∆
        (r + b2 )γ3 + k1 q̄13 + k2 q̄23 = −r ᾱ f +        ,                                          (C.33)
                                                    1Σ1′

respectively. Identifying constant terms, we find

             αᾱf 1Σθ ′ ′
                                                                                    
                                κ(γ1 + γ2 )C̄ + b0 γ3 − k1 q̄1 − k2 q̄2           k∆
        a0 =             Σ1 +                                           + ᾱ f +         Σp′f .       (C.34)
             α + ᾱ 1Σ1′                         r                               1Σ1′


       Using (A.30), we can write (C.26) as
                                                                                       ′
                                                                    ᾱ 1Σθ ′
                                                                            
                            ∆
        θh(Xt ) − rαψb1 k1      yt − Ĉt = rαθ(f Σ + kΣp′f pf Σ)              1 + yt pf + ψhψ (Xt )
                           1Σ1′                                   α + ᾱ 1Σ1′

                                              rαᾱf (1Σθ ′ )2
                                                                               
                               ∆                                          k∆      ∆
         ⇒ θh(Xt ) − rαψb1 k1    ′ yt − Ĉt =              ′  + rα f +                 yt + ψhψ (Xt ).
                              1Σ1             α + ᾱ 1Σ1                 1Σ1 1Σ1′
                                                                              ′

                                                                                                 (C.35)




                                                               66
Eq. (C.35) is linear in (Ĉt , yt ). Identifying terms in Ĉt and yt , and using (5.3), we find
                                                               ∆
        [(r + κ)(γ1 + γ2 ) + b1 γ3 + k1 q11 ]                      −1
                                                              1Σ1′
                                                      φ2 β22   s2 β22 γ22 ∆ ∆q11
                                                                               
        = −ψb1 r + κ + b2 + β12 +                            +                      ,                                  (C.36)
                                                    (r + κ)2     1Σ1′        1Σ1′

                                ∆
        [(r + b2 )γ3 + (q12 − rαψb1 )k1 ]
                               1Σ1′
                                                       φ2 β22   s2 β22 γ22 ∆ ∆q12
                                                                              
                  k∆   ∆                         2
        = rα f +           − ψ (r + b2 )b2 + b1 β1 +          +                      ,                                 (C.37)
                 1Σ1′ 1Σ1′                           (r + κ)2     1Σ1′        1Σ1′

respectively. Identifying constant terms, and using (5.3) and (C.34), we find
                                               
                                            k∆         ∆
        k1 (q1 − q̄1 ) − k2 q̄2 + r ᾱ f +     ′
                                           1Σ1       1Σ1′

                                                   φ2 β22   s2 β22 γ22 ∆ ∆q1
                                                                            
      = ψ (r + b2 )b0 + b1 κC̄ − b1 β12 +                 +                      .                                     (C.38)
                                                 (r + κ)2     1Σ1′        1Σ1′


     The system of equations characterizing equilibrium is as follows. The endogenous variables
are (a0 , b0 , b1 , b2 , γ1 , γ2 , γ3 , β1 , β2 , T, q̄1 , q̄2 , q̄3 , Q̄, q1 , q2 , Q). (As in Propositions 3.3 and 4.3, we can
drop (q̄0 , q0 ).) The equations linking them are (5.5)-(5.7), (C.31)-(C.34), (C.36)-(C.38), the nine
equations derived from (C.16) by identifying linear and quadratic terms, and the five equations
derived from (C.24) by identifying linear and quadratic terms. We next simplify the latter two sets
of equations, using implications of market clearing.

     Using (C.30), we find

                                           r 2 α2 ᾱ2 f (1Σθ ′ )2 1 2 2
                                                                                         
   1         ′             ′   −1                                                2     k∆   ∆
     h̄(X̄t ) (f Σ + kΣpf pf Σ) h̄(X̄t ) =                       + r ᾱ (1 − yt ) f +           . (C.39)
   2                                        2(α + ᾱ)2 1Σ1′       2                   1Σ1′ 1Σ1′

We next substitute (C.39) into (C.16), and identify terms. Quadratic terms yield the algebraic
Riccati equation

       Q̄R̄2 Q̄ + Q̄R̄1 + R̄′1 Q̄ − R̄0 = 0,                                                                           (C.40)

where

                              φ2 β22       s2 β22 γ22 ∆
                h                                        i
                                                                     s2 β2 γ2 ∆
                                                                                      
                                                               ∆
                     β12 +   (r+κ)2
                                       + 1Σ1        ′         1Σ1′     1Σ1′       0
       R̄2 ≡                       s2 β2 γ2 ∆
                                                                                  0 ,
                                                                                   
                                      1Σ1′                               s2
                                        0                                0        0

                                                                        67
                  r
                                                               
                  2    +κ+ρ               −ρ               0
                                        r
      R̄1 ≡            0               2 +κ               0    ,
                                                       r
                        b1                 0           2   + b2
                                        
              0   0            0
      R̄0 ≡  0   0          r ᾱλ      .
                       2  2      k∆  ∆
              0 r ᾱλ r ᾱ f + 1Σ1′ 1Σ1′

Terms in Ĉt , Ct and yt yield

                                                          φ2 β22
                                                                                                                    
                                                                   ∆q̄1 q̄11    2 β2 γ2 ∆q̄1          β2 γ2 ∆q̄11
        (r + κ + ρ) q̄1 + b1 q̄3 +              β12   +                      +s              + q̄2                + q̄12
                                                        (r + κ)2 1Σ1′               1Σ1′                1Σ1′

        − κC̄(q̄11 + q̄12 ) − b0 q̄13 = 0,                                                                                        (C.41)

                                               φ2 β22
                                                                                                         
                                                        ∆q̄1 q̄12    2 β2 γ2 ∆q̄1          β2 γ2 ∆q̄12
      (r + κ)q̄2 − ρq̄1 +            β12   +                      +s              + q̄2                + q̄22
                                             (r + κ)2 1Σ1′               1Σ1′                1Σ1′

        − κC̄(q̄12 + q̄22 ) − b0 q̄23 = 0,                                                                                        (C.42)

                           φ2 β22
                                                                                          
                                    ∆q̄1 q̄13     2 β2 γ2 ∆q̄1             β2 γ2 ∆q̄13
      (r + b2 )q̄3 + β12 +                    + s               +  q̄ 2                + q̄ 23
                         (r + κ)2 1Σ1′                1Σ1′                   1Σ1′
                        
           2 2      k∆       ∆
        + r ᾱ f +                − r ᾱB − κC̄(q̄13 + q̄23 ) − b0 q̄33 = 0,                                                      (C.43)
                   1Σ1 1Σ1′
                       ′



respectively. Using (A.30), we can write (C.28) as (B.41). Using (5.3), (B.41) and (C.35), we find
that the equation derived from (C.24) by identifying quadratic terms is

      QR2 Q + QR1 + R′1 Q − R0 = 0,                                                                                               (C.44)

where

                               φ2 β22          s2 β22 γ22 ∆
                  h                                           i               !
                                                                   ∆
                      β12 +   (r+κ)2       +     1Σ1′             1Σ1′    0
      R2 ≡                                                                        ,
                                           0                              0

                                                            φ2 β22     s2 β22 γ22 ∆
                               h                                                      i          !
                  r                                                                        ∆
                  2   + κ rαψb1 β12 +                      (r+κ)   2 +   1Σ1′             1Σ1′
      R1 ≡                                                                                           ,
                                                             r
                      b1                                     2 + b2


                      −rαψb21
                                                                                                                                       
                                                                                            −rαψb1 (r + κ + 2b2 )
     R0 ≡                                                                                  ∆                  ∆                             ,
                 −rαψb1 (r + κ + 2b2 ) r 2 α2 f +                              k∆                  2 2
                                                                                      
                                                                              1Σ1′        1Σ1′ + 2r α ψb1 k1 1Σ1′ − rαψb2 (2r + 3b2 )




                                                                               68
and the equations derived by identifying terms Ĉt and yt are

                                φ2 β22    s2 β22 γ22 ∆ ∆q1 q11
                                                     
                          2
     (r + κ)q1 + b1 q2 + β1 +          +                       − κC̄q11 − b0 q12 − rαψb0 b2 = 0,
                              (r + κ)2      1Σ1′        1Σ1′
                                                                                               (C.45)

                              φ2 β22    s2 β22 γ22 ∆ ∆(q12 + rαψb1 )q1
                                                   
        (r + b2 )q2 +   +    β12      +                                − κC̄q12 − b0 q22
                            (r + κ)2      1Σ1′             1Σ1′
                                    
         − rαψ b0 (r + 2b2 ) + b1 κC̄ = 0,                                                                                        (C.46)

respectively.

     Solving for equilibrium amounts to solving the system of (5.5)-(5.7), (C.31)-(C.34), (C.36)-
(C.38), (C.40)-(C.43), (C.44)-(C.46) in the unknowns (a0 , b0 , b1 , b2 , γ1 , γ2 , γ3 , β1 , β2 , T, q̄1 , q̄2 , q̄3 , Q̄, q1 , q2 , Q).
This reduces to solving the system of (5.5)-(5.7), (C.31)-(C.33), (C.36), (C.37), (C.40), (C.44) in the
unknowns (b1 , b2 , γ1 , γ2 , γ3 , β1 , β2 , T, Q̄, Q): given (b1 , b2 , γ1 , γ2 , γ3 , β1 , β2 , T, Q̄, Q), (b0 , q̄1 , q̄2 , q̄3 , q1 , q2 )
can be determined from the linear system of (C.38), (C.41)-(C.43), (C.45), (C.46), and a0 from
(C.34). We replace the system of (5.5)-(5.7), (C.31)-(C.33), (C.36), (C.37), (C.40), (C.44) by the
equivalent system of (5.5)-(5.7), (C.31)-(C.33), (C.40), (C.44),

                                  φ2 β22   s2 β22 γ22 ∆ ∆q11
                                                           
                           2
     ψb1 r + κ + b2 + β1 +               +
                                (r + κ)2     1Σ1′        1Σ1′
                                                             ∆
         = 1 + [k1 (q̄11 + q̄12 ) + k2 (q̄12 + q̄22 ) − k1 q11 ],                                                                 (C.47)
                                                           1Σ1′
                                    φ2 β22     s2 β22 γ22 ∆ ∆q12
                                                                 
                            2                                                     ∆
        ψ (r + b2 )b2 + b1 β1 +              +          ′         ′   − rαψb1 k1
                                  (r + κ)  2       1Σ1        1Σ1                1Σ1′
                               
                           k∆       ∆                                      ∆
        = r(α + ᾱ) f +       ′         ′ + (k1 q̄13 + k2 q̄23 − k1 q12 )      .                                                  (C.48)
                          1Σ1 1Σ1                                         1Σ1′

For s = 0, the unique non-negative solution of (5.7) is T = 0. Eqs. (5.5), (5.6), (C.8) and (C.13)-
(C.15) imply that β1 = β2 = ρ = k = k1 = k2 = 0. Eqs. (C.31)-(C.33), (C.40), (C.44), (C.47) and
(C.48) become

        (r + κ)γ1 + b1 γ3 = 0,                                                                                                    (C.49)

        (r + κ)γ2 = 0,                                                                                                            (C.50)

        (r + b2 )γ3 = −r ᾱf,                                                                                                     (C.51)




                                                                    69
(B.49), (B.50), (B.51) and (B.52), respectively, where

                      r
                                                     
                      2   +κ          0          0
        R̄01 ≡           0      r
                                 2    +κ         0    ,
                                             r
                          b1          0      2   + b2

                                   
                0   0         0
        R̄0 ≡  0   0       r ᾱλ   ,
                         2  2     ∆
                0 r ᾱλ r ᾱ f 1Σ1′

and (R01 , R00 ) are as under symmetric information (Proposition 4.3). Given the unique positive
solution b2 of (B.52), (b1 , γ3 , γ1 , Q̄, Q) are determined uniquely from (B.51), (C.51), (C.49), (B.49)
and (B.50), respectively, and (C.50) implies that γ2 = 0. We denote the solution for s = 0 by
(b01 , b02 , γ10 , γ20 , γ30 , β10 , β20 , T 0 , Q̄0 , Q0 ). The variables (b01 , b02 , γ10 , γ30 , Q0 ) coincide with (b01 , b02 , γ10 , γ20 , Q0 )
under symmetric information. Proceeding as in the proof of Proposition 4.3, we can apply the im-
plicit function theorem and show that the system of (5.5)-(5.7), (C.31)-(C.33), (C.40), (C.44),
(C.47), (C.48) has a solution for small s. Moreover, this solution is unique in a neighborhood of
(b01 , b02 , γ10 , γ20 , γ30 , β10 , β20 , T 0 , Q̄0 , Q0 ), which corresponds to the unique equilibrium for s = 0. Since
b01 > 0, b02 > 0, γ10 > 0, γ30 < 0, continuity implies that b1 > 0, b2 > 0, γ1 > 0, γ3 < 0 for small
s. Since γ20 = 0, continuity does not establish the sign of γ2 for small s, so we need to study the
asymptotic behavior of the solution. Eqs. (5.7), (5.5) and (5.6) imply that

                s2
        T =        + o(s2 ),                                                                                                             (C.52)
                2κ
                1∆1′ 2
        β1 =        s + o(s2 ) ≡ β̂10 s2 + o(s2 ),                                                                                       (C.53)
                2κ∆
        β2 = o(s2 ),                                                                                                                     (C.54)

                             o(s2 )
respectively, where           s2
                                      converges to zero when s goes to zero. Eqs. (C.8) and (C.13)-(C.15) imply
that

        ρ = β̂10 s2 + o(s2 ),                                                                                                            (C.55)

        k = 2β̂10 γ10 s2 + o(s2 ),                                                                                                       (C.56)

        k1 = β̂10 s2 + o(s2 ),                                                                                                           (C.57)

        k2 = o(s2 ),                                                                                                                     (C.58)




                                                                        70
respectively, and (C.40) implies that

                                2r 2 ᾱ2 (b01 )2 f ∆                        r ᾱb0 λ                       r 2 ᾱ2 b0 f ∆
                                                                                                                           
                         (r+2κ)(r+κ+b02 )(r+2b02 )1Σ1′
                                                                  − (r+2κ)(r+κ+b
                                                                            1
                                                                                0)               − (r+κ+b0 )(r+2b
                                                                                                              1
                                                                                                                 0 )1Σ1′
                                                                                       2                    2         2    
                                        r ᾱb01 λ
     Q̄0 =                  − (r+2κ)(r+κ+b                                   0                               r ᾱλ
                                                                                                                            .         (C.59)
                                                                                                                           
                                                     0)                                                    r+κ+b02
                                                     2
                                    r 2 ᾱ2 b01 f ∆
                                                                                                                           
                                                                           r ᾱλ                           r 2 ᾱ2 f ∆
                           − (r+κ+b0 )(r+2b0 )1Σ1′                       r+κ+b02                         (r+2b02 )1Σ1′
                                       2           2



Eqs. (C.32), (C.55), (C.57), (C.58) and (C.59) imply that

                                            r ᾱb01 λ
                                                           
     γ2 =         β̂10       γ10   +                          s2 + o(s2 ).
                                     (r + 2κ)(r + κ + b02 )

Therefore, γ2 > 0 if λ ≥ 0.

Proof of Corollary 5.1: Eq. (C.7) implies that the covariance matrix of stock returns is
                                                                 ′
    Covt (dRt , dRt′ ) = σ + β1 γ1 Σp′f pf σ σ + β1 γ1 Σp′f pf σ
                                            


                                                φ2                 ′
                                                                                         ′
                                                                                                  ′
                                         +            σ + β2 γ1 Σp f p f σ   σ + β2 γ1 Σp f p f σ
                                             (r + κ)2
                                                                      2
                                                             β2 γ1 ∆
                                         +   s2 γ22       1+                Σp′f pf Σ,
                                                              1Σ1′

which is equal to (5.10) because of (C.13). Eqs. (3.20) (which is also valid under gradual adjust-
ment) and (5.10) imply that the proportionality coefficient between the non-fundamental covariance
matrices under asymmetric and symmetric information is larger than one if k > s2 γ1sym
                                                                                  2    , where
γ1sym denotes the value of γ1 under symmetric information. Rearranging (C.13), we find

                                           φ2      s2 γ22 ∆                                               φ2 β22   s2 β22 γ22 ∆ γ12 ∆
                                                                                                                          
     k = 2 β1 + β2                               +                     γ1 +    s2 γ22   +       β12   +          +                    . (C.60)
                                        (r + κ)2    1Σ1′                                                (r + κ)2     1Σ1′        1Σ1′

Rearranging (5.6), we find

                    φ2      s2 γ22 ∆
                                    
     β2                   +            = s2 γ2 ,                                                                                       (C.61)
                 (r + κ)2    1Σ1′

and rearranging (5.7), we find
                                             2                     s4 γ22 ∆
                                                  1Σ1′
             
         2                   γ2 ∆                                    1Σ1′
     T           1 − (r + k)                           +                               = s2 − 2κT
                             1Σ1′                  ∆            φ 2
                                                                       + 1Σ1
                                                                            s2 γ22 ∆
                                                                                   ′
                                                              (r+κ)2

                                φ2 β22   s2 β22 γ22 ∆
                                                     
                                                         ∆
      ⇒ β12 +                          +                     = s2 − 2κT,                                                               (C.62)
                              (r + κ)2     1Σ1′         1Σ1′


                                                                              71
where the second step follows from (5.5) and (5.6). Substituting (C.61) and (C.62) into (C.60), we
find
        k = 2β1 γ1 + s2 (γ1 + γ2 )2 − 2κT γ12

                                     1Σ1′
                                                          
             2           2
          = s (γ1 + γ2 ) + 2T γ1          − κγ1 − (r + κ)γ2 ,                                      (C.63)
                                      ∆

where the second step follows from (5.5).

       Eqs. (C.52), (C.63) and γ20 = 0 imply that for small s,

                              s2 γ10       1Σ1′
                                                        
              2
        k=s       (γ10 )2   +                   − κγ10       + o(s2 ).                             (C.64)
                                κ           ∆

The variables (b01 , b02 ) are identical under symmetric and asymmetric information. Moreover, (B.47),
(B.48), (C.49) and (C.51) imply that the same is true for γ10 . Therefore, k > s2 γ1sym
                                                                                   2    for small s if

        1Σ1′
             − κγ10 > 0
         ∆
           1Σ1′        κr ᾱf b01
         ⇔      −                    >0
            ∆      (r + κ)(r + b02 )

           1Σ1′                   κᾱb02
                                                   
         ⇔        1−                                  > 0,                                         (C.65)
            ∆         (r + κ)(α + ᾱ)(r + κ + b02 )

where the second step follows from (C.49) and (C.51), and the third from (B.51) and (B.52). Since
b02 > 0, (C.65) holds.

Proof of Corollary 5.2: Stocks’ expected returns are
               n     h                                                 i    o
    Et (dRt ) = ra0 + γ1R Ĉt + γ2R Ct + γ3R yt − κ(γ1 + γ2 )C̄ − b0 γ3 Σp′f dt

                         rαᾱf 1Σθ ′ ′
                                                                                                     
                                              R       R     R                k∆                         ′
                     =               Σ1 + γ1 Ĉt + γ2 Ct + γ3 yt + r ᾱ f +        − k1 q̄1 − k2 q̄2 Σpf dt
                         α + ᾱ 1Σ1′                                        1Σ1′

                          rαᾱ 1Σθ ′
                                                                                
                                                ′
                                                      ′                 ′
                                                                              ′
                     =                f Σ + kΣpf pf Σ 1 + Λt f Σ + kΣpf pf Σ pf dt,                  (C.66)
                         α + ᾱ 1Σ1′

where the first step follows from (C.7), the second from (C.34), and the third from (5.11). Eq.
(C.66) is equivalent to (3.21) because of (5.10).

       Eqs. (C.31) and (C.32) imply that γ1R and γ2R have the opposite sign of k1 q̄11 + k2 q̄12 and
k1 q̄12 + k2 q̄22 , respectively. Eqs. (C.57) and (C.58) imply that for small s, the latter variables have

                                                                     72
                   0 and q̄ 0 , respectively. Since b0 > 0 and b0 > 0, (C.59) implies that q̄ 0 > 0
the same sign as q̄11      12                        1          2                            11
      0 has the same sign as −λ. Therefore, for small s, γ R < 0 and γ R has the same sign as λ.
and q̄12                                                  1           2

Moreover, γ3R < 0 since b2 > 0 and γ3 < 0.

Proof of Corollary 5.3: Using (C.7) and proceeding as in the derivation of (A.56), we find
                                                                   
    Covt (dDt , dRt′ ′ ) = σCovt dBtD , γ1R Ĉt′ + γ2R Ct′ + γ3R yt′ pf Σdt,             (C.67)
                                                                      
      Covt (dFt , dRt′ ′ ) = φσCovt dBtF , γ1R Ĉt′ + γ2R Ct′ + γ3R yt′ pf Σdt.                   (C.68)


The covariances (C.67) and (C.68) depend only on how the Brownian shocks dBtD and dBtF , re-
spectively, impact (Ĉt′ , Ct′ , yt′ ). To compute the impact of these shocks, as well as of dBtC for the
next corollary, we solve the impulse-response dynamics

      dCt = −κCt dt,
            h                    i
      dĈt = −κĈt + ρ(Ct − Ĉt ) dt,
                              
      dyt = − b1 Ĉt + b2 yt dt,


with the initial conditions

      Ct = sdBtC ,

                                        φpf σdBtF   sγ2 ∆dBtC
                                                               
      Ĉt =   −β1 pf σdBtD   − β2                 −                 ,
                                          r+κ         1Σ1′

      yt = 0.

The solution to these dynamics is (B.57),

                                                            φβ2 pf σdBtF
                                                                                          
             −κ(t′ −t)    C    −(κ+ρ)(t′ −t)            D                      β2 γ2 ∆     C
     Ĉt′ = e          sdBt − e                β1 pf σdBt +              +s 1−           dBt
                                                               r+κ              1Σ1′
                                                                                              (C.69)

                  b1 h −κ(t′ −t)          ′
                                              i
      yt′ = −          e         − e−b2 (t −t) sdBtC
                b2 − κ
                                                     i              φβ2 pf σdBtF
                                                                                                    
               b1     h
                         −(κ+ρ)(t′ −t)   −b2 (t′ −t)             D                      β2 γ2 ∆     C
         +              e              −e               β1 pf σdBt +              +s 1−           dBt .
           b2 − κ − ρ                                                   r+κ              1Σ1′
                                                                                               (C.70)




                                                       73
Substituting (B.57), (C.69) and (C.70) into (C.67) and (C.68), and using the mutual independence
of (dBtD , dBtF , dBtC ), we find (5.12) with

                      b1 γ3R
                                                                      
                                                             b1 γ3
      χD
       1   ≡ β 1                − γ1
                                    R
                                        = (r + κ + ρ)β1              − γ1 ,                           (C.71)
                   b2 − κ − ρ                             b2 − κ − ρ

                  b1 β1 γ3R    (r + b2 )b1 β1 γ3
      χD
       2 ≡−                 =−                   .                                                    (C.72)
                b2 − κ − ρ       b2 − κ − ρ

The function χD (u) ≡ χD
                       1 e
                          −(κ+ρ)u + χD e−b2 u can change sign only once, is equal to −β γ R when
                                     2                                                 1 1

u = 0, and has the sign of χ1 if b2 > κ + ρ and of χ2 if b2 < κ + ρ when u goes to ∞. For small s,
χ(0) > 0 since γ1R < 0. Since, in addition, b1 > 0, b2 > 0, γ1 > 0, γ3 < 0 and ρ > 0, (C.71) and
(C.72) imply that χ1 < 0 if b2 > κ + ρ and χ2 < 0 if b2 < κ + ρ. Therefore, there exists a threshold
ûD > 0 such that χ(u) > 0 for 0 < u < ûD and χ(u) < 0 for u > ûD .

Proof of Corollary 5.4: Using (C.7) and proceeding as in the derivation of (A.56), we find
                                                                                      
    Covt (dRt , dRt′ ′ ) = σ + β1 γ1 Σp′f pf σ Covt dBtD , γ1R Ĉt′ + γ2R Ct′ + γ3R yt′ pf Σdt
                                              


                                φ                                                                
                                    σ + β2 γ1 Σp′f pf σ Covt dBtF , γ1R Ĉt′ + γ2R Ct′ + γ3R yt′ pf Σdt
                                                        
                            +
                              r+κ
                                             
                                      β2 γ1 ∆           
                                                             C     R          R         R
                                                                                              
                                                                                                ′
                            − sγ2 1 +           Cov   t   dB t , γ   Ĉ
                                                                   1 t  ′ + γ2 tC ′ + γ3 t Σpf pf Σdt.
                                                                                          y ′
                                       1Σ1′
                                                                                                       (C.73)

Substituting (B.57), (C.69) and (C.70) into (C.73), and using (5.6) and the mutual independence
of (dBtD , dBtF , dBtC ), we find (5.13) with
                                 
              D          β1 γ1 ∆
      χ1 ≡ χ1 1 +                   ,                                                                 (C.74)
                          1Σ1′

                      b1 γ3R
                                                        
              2                    R     R         β2 γ1 ∆
      χ2 ≡ s γ2               − γ1 − γ2       1+
                     b2 − κ                         1Σ1′
                                                               
              2                 b1 γ3                     β2 γ1 ∆
          = s (r + κ)γ2                − γ1 − γ2     1+              ,                                (C.75)
                              b2 − κ                       1Σ1′

                                                         s2 γ2
                                                                            
                   R         β1            β1 γ1 ∆                      β2 γ1 ∆
      χ3 ≡ −b1 γ3                       1+           +            1+
                       b2 − κ − ρ           1Σ1′        b2 − κ           1Σ1′

                                                                  s2 γ2
                                                                                    
                                      β1           β1 γ1 ∆                      β2 γ1 ∆
          = −(r + b2 )b1 γ3                   1+              +            1+              .          (C.76)
                                 b2 − κ − ρ         1Σ1′         b2 − κ          1Σ1′



                                                        74
The function χ(u) ≡ χ1 e−(κ+ρ)u + χ2 e−κu + χ3 e−b2 u has the same sign as χ̂(u) ≡ χ1 e−ρu + χ2 +
χ3 e−(b2 −κ)u . The latter function is equal to

                                                                                  
                       β1 γ1 ∆            2                                β2 γ1 ∆
      −β1 γ1R       1+               −s       γ2 (γ1R   +   γ2R )       1+
                        1Σ1′                                                1Σ1′

when u = 0, and has the sign of χ2 if b2 > κ and ρ > 0 and of χ3 if b2 < κ and ρ > 0 when u goes
to ∞. Moreover, its derivative χ̂′ (u) = −χ1 ρe−ρu − χ3 (b2 − κ)e−(b2 −κ)u is equal to

                                                                                                                        
                                                                       β1 γ1 ∆            2                      β2 γ1 ∆
      −χ1 ρ − χ3 (b2 − κ) =          β1 (ργ1R    +   b1 γ3R )       1+               +s       b1 γ2 γ3R       1+               (C.77)
                                                                        1Σ1′                                      1Σ1′

when u = 0. For small s, χ(0) > 0 since γ1R < 0 and s2 γ2 /β1 = o(1). Since, in addition, b1 > 0,
b2 > 0, γ1 > 0, γ2 > 0, γ3 < 0, γ3R < 0 and ρ > 0, (C.75) and (C.76) imply that χ2 < 0 if b2 > κ
and χ3 < 0 if b2 < κ, and (C.77) implies that χ̂′ (0) < 0. Since χ̂′ (u) can change sign only once,
it is either negative or negative and then positive. Therefore, χ̂(u) is positive and then negative.
The same is true for χ(u), which means that there exists a threshold û > 0 such that χ(u) > 0 for
0 < u < û and χ(u) < 0 for u > û.




                                                                         75
                                         References

Asness, C., J. Liew and R. Stevens, 1997, “Parallels Between the Cross-Sectional Predictabil-
     ity of Stock and Country Returns,” Journal of Portfolio Management, 23, 79-87.

Asness C., T. Moskowitz and L. Pedersen, 2008, “Value and Momentum Everywhere,” work-
     ing paper, New York University.

Albuquerque R. and J. Miao, 2010, “Advance Information and Asset Prices,” working paper,
     Boston University.

Anton, M. and C. Polk, 2010, “Connected Stocks,” working paper, London School of Eco-
     nomics.

Barberis, N. and A. Shleifer, 2003, “Style Investing,” Journal of Financial Economics, 68,
     161-199.

Barberis, N., A. Shleifer and R. Vishny, 1998, “A Model of Investor Sentiment,” Journal of
     Financial Economics, 49, 307-343.

Basak, S. and A. Pavlova, 2010, “Asset Prices and Institutional Investors,” working paper,
     London Business School.

Berk, J. and R. Green, 2004, “Mutual Fund Flows and Performance in Rational Markets,”
     Journal of Political Economy, 112, 1269-1295.

Berk, J., R. Green and V. Naik, 1999, “Optimal Investment, Growth Options, and Security
     Returns,” Journal of Finance, 54, 1553-1607.

Bhojraj, S. and B. Swaminathan, 2006, “Macromomentum: Returns Predictability in Inter-
     national Equity Indices,” Journal of Business, 79, 429-451.

Brennan, M., 1993, “Agency and Asset Pricing,” working paper, University of California at Los
     Angeles.

Chevalier, J. and G. Ellison, 1997, “Risk Taking by Mutual Funds as a Response to Incen-
     tives,” Journal of Political Economy, 105, 1167-1200.

Cuoco, D. and R. Kaniel, 2010, “Equilibrium Prices in the Presence of Delegated Portfolio
     Management,” Journal of Financial Economics, forthcoming.

Coval, J. and E. Stafford, 2007, “Asset Fire Sales (and Purchases) in Equity Markets,” Journal
     of Financial Economics, 86, 479-512.

                                               76
Daniel, K., D. Hirshleifer and A. Subrahmanyam, 1998, “A Theory of Overconfidence, Self-
     Attribution, and Security Market Under and Over-Reactions,” Journal of Finance, 53, 1839-
     1885.

Dasgupta, A. and A. Prat, 2008, “Information Aggregation in Financial Markets with Career
     Concerns,” Journal of Economic Theory, 143, 83-113.

Dasgupta, A., A. Prat and M. Verardo, 2010, “The Price Impact of Institutional Herding,”
     Review of Financial Studies, forthcoming.

DeBondt, W. and R. Thaler, 1985, “Does the Stock Market Overreact?,” Journal of Finance,
     40, 793-805.

Ding, B., M. Getmansky, B. Liang and R. Wermers, 2009, “Share Restrictions and Investor
     Flows in the Hedge Fund Industry,” working paper, University of Massachusetts at Amherst.

Duffie, D., 2010, “Presidential Address: Asset Price Dynamics with Slow-Moving Capital,” Jour-
     nal of Finance, 65, 1237-1267.

Fama, E. and K. French, 1992, “The Cross-Section of Expected Stock Returns,” Journal of
     Finance, 47, 427-465.

Fama, E. and K. French, 1998, “Value versus Growth: The International Evidence,” Journal
     of Finance, 53, 1975-1999.

Fung, W., D. Hsieh, N. Naik and T. Ramadorai, 2008, “Hedge Funds: Performance, Risk,
     and Capital Formation,” Journal of Finance, 58, 1777-1803.

Gorton, G., F. Hayashi and G. Rouwenhorst, 2007, “The Fundamentals of Commodity Fu-
     tures Returns,” working paper, Yale University.

Greenwood, R. and D. Thesmar, 2010, “Stock Price Fragility,” working paper, Harvard Uni-
     versity.

Grinblatt, M. and T. Moskowitz, 1999, “Do Industries Explain Momentum?,” Journal of Fi-
     nance, 54, 1249-1290.

Gromb, D. and D. Vayanos, 2010, “Limits of Arbitrage,” Annual Review of Financial Eco-
     nomics, forthcoming.

Guerreri, V. and P. Kondor, 2010, “Fund Managers, Career Concerns and Asset Price Volatil-
     ity,” working paper, University of Chicago.

                                                 77
He, Z. and A. Krishnamurthy, 2009, “A Model of Capital and Crises,” working paper, Uni-
     versity of Chicago.

He, Z. and A. Krishnamurthy, 2010, “Intermediary Asset Pricing,” working paper, University
     of Chicago.

Hong, H. and J. Stein, 1999, “A Unified Theory of Underreaction, Momentum Trading, and
     Overreaction in Asset Markets,” Journal of Finance, 54, 2143-2184.

Jegadeesh, N. and S. Titman, 1993, “Returns to Buying Winners and Selling Losers: Impli-
     cations for Stock Market Efficiency,” Journal of Finance, 48, 65-91.

Johnson, T., 2002, “Rational Momentum Effects,” Journal of Finance, 57, 585-608.

Liptser, R. and A. Shiryaev, Statistics of Random Processes, Volume I: General Theory, Sec-
     ond Edition. New York: Springer-Verlag, 2000.

Lou, D., 2010, “A Flow-Based Explanation for Return Predictability,” working paper, London
     School of Economics.

Malliaris, S. and H. Yan, 2010, “Reputation Concerns and Slow-Moving Capital,” working pa-
     per, Yale University.

Petajisto, A., 2009, “Why Do Demand Curves for Stocks Slope Down?,” Journal of Financial
     and Quantitative Analysis, 44, 1013-1044.

Rouwenhorst, G., 1998, “International Momentum Strategies,” Journal of Finance, 53, 267-284.

Shin, H., 2006, “Disclosure Risk and Price Drift,” Journal of Accounting Research, 44, 351-379.

Shleifer, A. and R. Vishny, 1997, “The Limits of Arbitrage,” Journal of Finance, 52, 35-55.

Sirri, E. and P. Tufano, 1998, “Costly Search and Mutual Fund Flows,” Journal of Finance,
     53, 1655-1694.

Vayanos, D., 2004, “Flight to Quality, Flight to Liquidity, and the Pricing of Risk,” working
     paper, London School of Economics.




                                                 78
