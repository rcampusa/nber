                                 NBER WORKING PAPER SERIES




              TRADE AND THE TOPOGRAPHY OF THE SPATIAL ECONOMY

                                              Treb Allen
                                            Costas Arkolakis

                                         Working Paper 19181
                                 http://www.nber.org/papers/w19181


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                       June 2013




We thank George Alessandria, Dave Donaldson, Gilles Duranton, Pablo Fajgelbaum, Gene Grossman,
Gordon Hanson, Johannes Horner, Sam Kortum, Kiminori Matsuyama, Stephen Redding, Esteban
Rossi- Hansberg, Antonios Stampoulis, and Jonathan Vogel for their helpful suggestions and comments.
Li Xiangliang provided excellent research assistance. All errors are our own. The views expressed
herein are those of the authors and do not necessarily reflect the views of the National Bureau of Economic
Research.

At least one co-author has disclosed a financial relationship of potential relevance for this research.
Further information is available online at http://www.nber.org/papers/w19181.ack

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2013 by Treb Allen and Costas Arkolakis. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
Trade and the Topography of the Spatial Economy
Treb Allen and Costas Arkolakis
NBER Working Paper No. 19181
June 2013
JEL No. F10,O18,R12,R13

                                            ABSTRACT

We develop a versatile general equilibrium framework to determine the spatial distribution of economic
activity on any surface with (nearly) any geography. Combining the gravity structure of trade with
labor mobility, we provide conditions for the existence, uniqueness, and stability of a spatial economic
equilibrium and derive a simple set of differential equations which govern the relationship between
economic activity and the geography of the surface. We then use the framework to estimate the topography
of trade costs, productivities, amenities and the strength of spillovers in the United States. We find
that geographic location accounts for 24% of the observed spatial distribution of income. Finally, we
calculate that the construction of the interstate highway system increased welfare by 3.47%, roughly
twice its cost.


Treb Allen
Department of Economics
Northwestern University
2001 Sheridan Road
Evanston, IL 60208-2600
treb.allen@northwestern.edu

Costas Arkolakis
Department of Economics
Yale University, 28 Hillhouse Avenue
P.O. Box 208268
New Haven, CT 06520-8268
and NBER
costas.arkolakis@yale.edu
               The Topography of the Spatial Economy                                    1


1       Introduction
There exists an enormous disparity in economic activity across space. For example, in the
year 2000, the population density in McLeod County, MN was 26 persons/km2 and the
payroll per capita was $13,543, while in Mercer County, NJ the population density was 369
persons/km2 and the payroll per capita was $20,795 (MPC, 2011). Many explanations for
this disparity focus on the characteristics of a location that affect either the productivity or
the amenity value of living there (e.g. climate, natural resources, institutions, etc).1 These
explanations ignore the role of geographical location: if the local characteristics of McLeod
County were identical to those of Mercer County, such explanations would imply that the
two locations should have the same economic activity. In contrast, the theoretical literature
in spatial economics developed over the past few decades emphasizes that, because trade
over space is costly, geographical location plays an important role by affecting how remote a
location is from economic activity elsewhere.
    How much of the observed spatial disparity in economic activity is due to geographic
location? Unfortunately, the simplicity of the spatial structure postulated in theoretical
spatial economic models has restricted their direct applicability to a narrow set of stylized
examples. In this paper, we resolve this tension between theory and data by developing a
new framework that allows us to determine the equilibrium spatial distribution of economic
activity on any surface with (nearly) any geography. Using this framework, we perform
quantitative empirical analysis using the observed distribution of economic activity and the
observed geography of the United States. We estimate that a substantial fraction – 24
percent – of the spatial variation in incomes across the United States can be explained by
geographic location alone.
    The first part of the paper presents our theoretical framework, which relies on distinct
(but mutually compatible) economic and geographic components. The economic component
combines the gravity structure of international trade with labor mobility to determine the
equilibrium distribution of economic activity on a space with any continuous topography of
exogenous productivity and amenity differences and any continuous bilateral iceberg trade
costs. To incorporate the possibility of productivity or congestion externalities, we allow for
the total productivity and amenity in a location to endogenously depend on its population
(“spillovers”). Given this setup, we characterize conditions for the existence, uniqueness, and
    1
    The literature examining the factors contributing to the productivity of a location is immense, see e.g.
Sachs (2001), Acemoglu, Johnson, and Robinson (2002).
             The Topography of the Spatial Economy                           2


stability of a spatial economic equilibrium. We also provide a simple iterative technique for
calculating the equilibrium.
    The geographic component provides a micro-foundation for bilateral trade costs. We
suppose that there exists a topography of instantaneous trade costs over a surface. The
bilateral trade costs are then equal to the accumulation of these instantaneous trade costs
over the least cost route. We use methods from differential geometry to characterize the
bilateral trade costs between any two points in space, thereby providing a unique mapping
between the topography of instantaneous trade costs and the resulting bilateral trade costs.
    By combining the economic and geographic components, we derive a set of differential
equations that succinctly relate the endogenous economic outcomes to the underlying geog-
raphy of the surface and highlight the role that spillovers play in determining the equilibrium
spatial distribution of economic activity. We provide several stylized examples of the mech-
anisms of the model, and derive a closed-form solution to the equilibrium distribution of
population across a homogeneous finite line in the absence of spillovers.
    The second part of the paper uses the theoretical framework to analyze the real world
distribution of economic activity throughout the continental United States. We estimate
the underlying geography, bilateral trade costs, productivities and amenities, of the United
States. For the bilateral trade costs, we assume that the instantaneous trade costs are a func-
tion of the observable geographical features (e.g. rivers, ocean, mountains, etc.) and then
estimate the relative cost of traveling over each type of land using observed bilateral state
to state trade shares. The procedure is greatly facilitated by the “fast marching method”
algorithm borrowed from computational physics, which allows us to efficiently compute the
lowest trade cost from all locations to all other locations. Given the trade costs, we then
identify the unique topography of productivities and amenities that exactly match the ob-
served spatial distribution of wages and population given the structure of the model. In the
final estimation step, we determine the strength of spillovers using the correlation between
the change in the calibrated productivities and amenities and the observed change in the
population distribution before and after the construction of the Interstate Highway System
(IHS).
    We perform two exercises using the estimated geography of the United States. First, we
decompose the observed spatial distribution of economic activity into its underlying sources:
differences in underlying productivity, amenities, and geographic location. We find that 24
percent of the spatial variation in income across the United States in the year 2000 can
be explained by geographic location alone. Second, we examine the effect of the Interstate
               The Topography of the Spatial Economy                                     3


Highway System. We estimate that the Interstate Highway System increased welfare by
3.47% – roughly twice its cost – and show that the model does a good job predicting the
observed redistribution of labor and income across space.
    In addition to allowing for a nearly arbitrary geography, our framework departs from
the standard model of economic geography based on Krugman (1991), and extensively ana-
lyzed by Fujita, Krugman, and Venables (1999), in three ways. First, we dispense with the
assumption of a homogeneous freely traded good, thereby allowing nominal wages to vary
across space. Second, we depart from the tradition of a monopolistic competition structure,
instead using a perfect competition Armington setup with differentiated varieties as in An-
derson (1979) and Anderson and Van Wincoop (2003). Third, rather than taking a stand
on the source of production externalities or congestion externalities, we incorporate such
spillovers by simply assuming that productivity and amenities may depend in part on the lo-
cal population.2 While ad-hoc, this assumption allows us to directly assess how the strength
of spillovers affect the spatial distribution of economic activity. Despite these departures
from the standard spatial framework, we show that for particular strengths of spillovers, our
model becomes isomorphic to a free entry monopolistic competition setup similar to the one
considered by Krugman (1980) and Krugman (1991), and the fixed amenity framework of
Helpman (1998) and Redding and Sturm (2008).
    Like Fujita, Krugman, and Venables (1999), this paper provides a theoretical treatment
of the factors determining the spatial distribution of economic activity.3 In this manner, our
work is also related to Matsuyama (1999), who characterizes specialization into industries
and economic activity and how this is affected by the geographical location of countries
under a variety of different scenarios.4 However, the primary goal of the paper is to provide
an empirically-implementable framework to study of the role of economic geography (in the
spirit suggested by Duranton (2008)). While there has been much empirical work examining
the implication of space for the allocation of agents (Davis and Weinstein 2002, 2008) and
wages (Hanson 2005; Breinlich 2006; Head and Mayer 2006; Amiti and Cameron 2007), there
   2
     Unlike Rossi-Hansberg (2005), we restrict such spillovers to be local. For the examination of micro-
foundations of spillovers, see for example Lucas and Rossi-Hansberg (2003), Duranton and Puga (2004), and
Rossi-Hansberg and Wright (2007)
   3
     Fabinger (2012) also derives equations governing the relationship between equilibrium economic outcomes
and the geography of a space, although his work is concerned with the strength of income spillovers in a
world arranged along a circle or a sphere.
   4
     Our model can be easily extended to allow for labor mobility within but not between countries. In
this case, we can derive equilibrium expressions for the relationship between internal trade frictions and the
welfare gains from international trade. In this sense, our work is also related to the work of Cosar and
Fajgelbaum (2012), Ramondo, Rodrı́guez-Clare, and Saborio-Rodriguez (2012) and Redding (2012).
             The Topography of the Spatial Economy                            4


has been little empirical application of the extensive body of theoretical research on economic
geography (with the notable exceptions of Redding and Sturm (2008) and Ahlfeldt, Redding,
Sturm, and Wolf (2012)).
    Finally, our empirical work is related to the recent literature estimating the impact of the
transportation network on economic output. Donaldson (2012) and Cervantes (2012) con-
sider the impact of railroads in India and the US, respectively, when labor is immobile, while
Donaldson and Hornbeck (2012) consider the impact of the railroad network in the US when
labor is mobile. While such transportation networks can be incorporated in our framework,
we can also incorporate trade costs that do not have obvious network representations, for
example geographical features like mountains and oceans.
    The remainder of the paper is organized as follows. The next section presents the the-
oretical framework and the third section presents the empirical analysis. The last section
concludes.


2       Theoretical framework
This section describes our theoretical framework. It comprises four subsections. We first
present the economic component of the framework, where we describe the equilibrium dis-
tribution of economic activity in a space with arbitrary trade costs. Second, we present
the geographic component of the framework, where we define and characterize geographic
trade costs that arise from moving goods across a surface. Next, we combine the economic
and geographic components to generate a set of differential equations governing the equilib-
rium distribution of economic activity on a surface with geographic trade costs. Finally, we
provide several simple examples of the model highlighting the mechanisms at play.


2.1     Economic component
In this subsection, we present the economic component of our framework and characterize
the existence, uniqueness, and stability of a spatial equilibrium.

2.1.1    Setup

The world is a continuum of locations i ∈ S, where S is a compact subset of RN . Each
location i ∈ S produces a unique differentiated variety of a good. Trade is costly: trade
costs are of the iceberg form and are described by the function T : S × S → [1, ∞), where
               The Topography of the Spatial Economy                                    5


T (i, j) is the quantity of a good needed to be shipped from location i in order for a unit of
a good to arrive in location j.
    The world is inhabited by a measure L̄ of workers who are freely mobile across locations
and derive utility from the consumption of differentiated varieties and the local amenity.
In particular, we assume workers have identical Constant Elasticity of Substitution (CES)
preferences over the continuum of differentiated varieties, so that the total welfare in location
i ∈ S, W (i), can be written as:
                                          ˆ                             σ
                                                                       σ−1
                                                           σ−1
                                W (i) =            q (s)    σ    ds           u (i) ,
                                             s∈S


where q (i) is the quantity consumed of the variety produced in location i, σ ∈ (1, ∞) is the
elasticity of substitution between goods ω, and u (i) is the local amenity.5 We denote by
P (i) the consumer price index in location i.
    Labor is the only factor of production. Each worker provides a unit of labor inelastically
in the location where she lives, for which she is compensated with a wage. A worker in
location i produces A (i) units of a good, where A (i) is the local productivity. Production is
assumed to be perfectly competitive. We define the functions L : S → R+ and w : S → R++
to be the density of workers and their wage, respectively.
    In order to allow for the possibility of productivity spillovers or congestion externalities,
both productivity and amenities may depend on the density of workers. In particular, we
assume that productivity in location i can be written as:

                                          A (i) = Ā (i) L (i)α ,                                     (1)

where Ā (i) is the (exogenous) component of productivity inherent to location i and α de-
termines the extent of the productivity spillover. Similarly, we assume that the amenity in
location i can be written as:
                                    u (i) = ū (i) L (i)β ,                             (2)

where ū (i) is the (exogenous) utility derived from living in location i inherent to the loca-
tion and β determines the extent of the congestion externality. In Appendix A.2, we show
how particular productivity and amenity spillovers make our framework isomorphic to other
                                                   1
spatial economic models. In particular, if α = σ−1   , our model is isomorphic to a monopo-
   5
    While the model attains a non-trivial solution even for σ ∈ (0, 1) we focus on this parameter space to
obtain equilibria where more productive locations attract more workers.
              The Topography of the Spatial Economy                                           6


listically competitive framework with free entry, where the number of goods produced in a
                                                               1
location is proportional to its population. Similarly, if α = σ−1 and β = − 1−γ
                                                                             γ
                                                                                , our model is
isomorphic to the Helpman (1998)-Redding (2012) framework with 1 − γ being the budget
share spent on the immobile factor.
     We define the geography of S to be the set of functions Ā, ū, and T , where Ā and ū
comprise the local characteristics and T comprises the geographic location. S is said to have
a regular geography if Ā, ū, and T are continuous and bounded above and below by strictly
positive numbers. We define the distribution of economic activity to be the set of functions
w and L.

2.1.2   Gravity

We first determine bilateral trade flows as a function of the geography of the surface, the
wages, and the labor supply. The function X : S × S → R+ describes equilibrium value of
trade flows, i.e. X (i, j) expresses the value of bilateral trade flows from location i to location
j. Using the CES assumption, and the fact that with perfect competition the final price of
the good produced in location i and sold in location j is equal to the marginal production and
                 w(i)
shipping cost, A(i)   T (i, j), the value of location j’s imports from location i can be expressed
as:                                                       1−σ
                                            T (i, j) w (i)
                               X (i, j) =                       w (j) L (j) ,                   (3)
                                             A (i) P (j)
where                                            ˆ
                                   1−σ
                           P (j)             =       T (s, j)1−σ A (s)σ−1 w (s)1−σ ds             (4)
                                                 S

is the CES price index. Define λ (i, j) ≡ ´ X(i,j)    as the relative market share of location i
                                           S X(s,j)ds
in location j. Combining equations (3) and (4) yields for all i ∈ S:
                                                          ˆ
                         σ−1           1−σ
                 A (i)         w (i)         = λ (i, i)       T (s, i)1−σ A (s)σ−1 w (s)1−σ ds,   (5)
                                                          S


where λ (i, i) is the ratio of local goods consumed in location i to the average amount of
goods consumed in location i from any location (so that higher values of λ (i, i) indicate that
a location is less open to trade).

2.1.3   Equilibrium

Trade is said to be balanced if for all i ∈ S:
                The Topography of the Spatial Economy                                                          7


                                                                ˆ
                                               w (i) L (i) =          X (i, s) ds.                                             (6)
                                                                  S

When trade is balanced, the welfare of living in a location is:
                                   ´                                                  σ1
               w (i)                   T (i, s)1−σ P (s)σ−1 w (s) L (s) ds                           σ−1                γ1
       W (i) =       u (i) =         S
                                                                                            Ā (i)    σ    ū (i) L (i)− σ ,   (7)
               P (i)                                 P (i)

where γ1 ≡ 1 − (σ − 1) α − βσ. The parameter γ1 is the partial elasticity of the welfare in
a location with respect to the population in that location. Welfare is said to be equalized if
for all i ∈ S there exists a W > 0 such that W (i) ≤ W , with the equality strict if L (i) > 0.
That is, welfare is equalized if the welfare of living in every inhabited location is the same
and the welfare of living in every uninhabited location is no greater than the welfare of the
inhabited locations.
    Given a regular geography with parameters σ, α, and β, we define a spatial equilibrium
as a distribution of economic activity such that (i) trade is balanced; (ii) welfare is equalized;
and (iii) the aggregate labor market clears:
                                                       ˆ
                                                            L (s) ds = L̄.                                                     (8)
                                                        S

In what follows, we pay particular attention to two types of spatial equilibria. A spatial
equilibrium is said to be regular if w and L are continuous and every location is inhabited,
i.e. for all i ∈ S, L (i) > 0. A spatial equilibrium is said to be point-wise locally stable if
dW (i)
 dL(i)
       < 0 for all i ∈ S. Intuitively, a point-wise locally stable equilibrium is one where no
small number of workers can increase their welfare by moving to another location.6
    We now discuss sufficient conditions for the existence and uniqueness of the spatial equi-
libria. Using equations (3), (4), and (5) to substitute out for trade flows, X (i, s), and the
price index, P (j), we can write the balanced trade condition (6) for all i ∈ S as:
                                                   ˆ
                       1−σ                 σ
               A (i)         L (i) w (i)       =        T (i, s)1−σ λ (s, s) A (s)1−σ L (s) w (s)σ ds.                         (9)
                                                    S


Combining equation (4) and (5) with utility equalization implies for all i ∈ S and s ∈ S such
   6
     This concept of stability is an adaptation of the one first introduced by Krugman (1991) to a continuum
of locations. Note that with a continuum of locations, changing the population in a single location does not
affect the price index in that location.
                    The Topography of the Spatial Economy                                              8


that L (i) > 0 and L (s) > 0:

                         λ (i, i) A (i)1−σ u (i)1−σ = λ (s, s) A (s)1−σ u (s)1−σ = W 1−σ                             (10)

Substituting equations (1), (2), and (10) into the balanced trade equation (9) yields for all
i ∈ S such that L (i) > 0:
                                                ˆ
              1−α(σ−1)          σ
      L (i)              w (i) = W        1−σ
                                                        T (i, s)1−σ Ā (i)σ−1 ū (s) σ−1 L (s)1+β(σ−1) w (s)σ ds,    (11)
                                                    S


Similarly, substituting equations (1), (2), and (4) into utility equalization yields for all i ∈ S
such that L (i) > 0:
                                                ˆ
              1−σ           β(1−σ)
      w (i)         L (i)            =W   1−σ
                                                        T (s, i)1−σ Ā (s) σ−1 ū (i) σ−1 w (s)1−σ L (s)α(σ−1) ds.   (12)
                                                S


These two sets of equations constitutes a system that can be used to solve for w (i) and L (i).
   When there are no productivity or amenity spillovers (i.e. α = β = 0 so that A (i) = Ā (i)
and u (i) = ū (i)), equations (11) and (12) are eigenfunctions for L (i) w (i)σ and w (i)1−σ ,
respectively. As a result, we have the following theorem:

Theorem 1 Consider a regular geography with exogenous productivity and amenities. Then:
  i) there exists a unique spatial equilibrium and this equilibrium is regular; and
  ii) this equilibrium can be computed as the uniform limit of a simple iterative procedure.

Proof. See Appendix A.1.1.
   Consider now the case with productivity or amenity spillovers, and suppose bilateral
trade costs are symmetric (i.e. T (i, s) = T (s, i) for all i, s ∈ S). Then substituting (10) into
equations (11) and (12) yields a relationship between L (i) and w (i) that is consistent with
both these equilibrium equations:
                                                                                         1
                                 L (i) = φĀ (i)σ−1 w (i)1−2σ ū (i)1−σ
                                                                                   1−(σ−1)(α−β)
                                                                                                   ,                 (13)

where φ is a scalar. If equation (13) holds, then any functions w (i) and L (i) satisfying
equation (11) will also satisfy (12) (and vice versa).7
  7
    We prove in the subsequent theorem that for any regular equilibrium, equation (13) is the unique
relationship between L (i) and w (i) such that equations (11) and (12) hold.
                     The Topography of the Spatial Economy                                                    9


      Combining equations (13) and (12) yields (after some algebra):
                                                                     ˆ                                                         γγ2
        σ̃γ1              (1−σ̃)(σ−1)            σ̃(σ−1)
L (i)          = ū (i)                 Ā (i)             W   1−σ
                                                                          T (s, i)1−σ Ā (s)(1−σ̃)(σ−1) ū (s)σ̃(σ−1) L (s)σ̃γ1 1 ds,
                                                                      S
                                                                                                                             (14)
                                                                     σ−1
where γ2 ≡ 1 + ασ + (σ − 1) β and σ̃ ≡                               2σ−1
                                                                          .
    Equation (14) is a non-linear integral equation known as a homogeneous Hammerstein
equation of the second kind (see, e.g. p.807 of Polyanin and Manzhirov, 2008). If equation
(14) has a solution for L (i) and W 1−σ then equilibrium wages can be determined from
equation (13) using the aggregate labor clearing condition to determine the scalar φ. The
next theorem discusses the conditions for existence and uniqueness of spatial equilibria for
γ1 6= 0.

Theorem 2 Consider a regular geography with endogenous productivity and amenity func-
tions specified in equations (1) and (2), respectively, and assume that iceberg trade costs are
symmetric and parameters are such that γ1 6= 0. Then:
    i) there exists a regular spatial equilibrium;
    ii) if γ1 > 0, all equilibria are regular;
    iii) if γγ21 ∈ [−1, 1], the spatial equilibrium is unique; and if γγ12 ∈ (−1, 1], it can be computed
as the uniform limit of a simple iterative procedure.

Proof. See Appendix A.1.2.
    Note that γγ21 ∈ [−1, 1] implies γ1 > 0, so part (iii) is a special case of part (ii).8 It is
straightforward to show that if γ1 = 0 there is (generically) no regular spatial equilibrium
satisfying equations (13) and (14). Finally, the following proposition characterizes when a
spatial equilibria is point-wise locally stable.

Proposition 1 Consider a regular geography with endogenous productivity and amenity
functions specified in equations (1) and (2), respectively, and assume that iceberg trade costs
are symmetric and parameters are such that γ1 6= 0. Then if γ1 < 0, no regular equilibria is
point-wise locally stable, and if γ1 > 0, all equilibria are point-wise locally stable.

Proof. See Appendix A.1.3.
   Figure 1 depicts the ranges of α and β and the different cases of equilibrium existence and
stability with σ = 4. The graph is divided in four regions with conditions on α and β that
  8
   Theorem 1 and Theorem 2(iii) generalize for the case of discrete number of locations, as shown in
Appendix A.1.
                  The Topography of the Spatial Economy                                       10


guarantee uniqueness and stability. Focusing on the range where α ∈ [0, 1] and β ∈ [−1, 0],
we see that γγ21 ∈ [−1, 1] if and only if α + β ≤ 0, so there is a unique stable equilibrium
regardless of the economic geography as long as dispersion forces are at least as strong as
agglomeration forces. When α + β > 0 but is small, there exists an equilibrium that it
is stable (since γ1 > 0) but it need not be unique (since γ2 /γ1 > 1). We provide specific
examples of the possible multiple equilibria below. However if α + β increases enough so that
γ1 ≤ 0, the agglomeration forces are sufficiently strong to induce complete concentration in
a single location, i.e. a black-hole. While regular equilibria exist (if γ1 < 0), they are not
point-wise locally stable.


2.2        Geographic component
In this subsection, we present the geographic component of our spatial framework. The
geographic component provides a micro-foundation for the bilateral trade cost function by
assuming that bilateral trade costs are the total trade costs incurred traveling from an origin
to a destination along the least cost route.
    Suppose that the world is a continuum of locations i ∈ S, where S is a manifold. In what
follows, we focus on the cases where S is a finite line, a finite circle, and a finite plane.9
    Let τ : S → R+ be a continuous function where τ (i) gives the instantaneous (iceberg)
trade cost incurred by crossing point i ∈ S. Let t (i, j) be the solution to the following least
cost path minimization problem:
                                                         ˆ   1
                                                                             dγ (t)
                                   t (i, j) = min                τ (γ (t))          dt,                           (15)
                                              γ∈Γ(i,j)   0                    dt

where γ : [0, 1] → S is a path and Γ (i, j) ≡ {γ ∈ C 1 |γ (0) = i, γ (1) = j} is the set of all
possible continuous and once-differentiable paths that lead from location i to location j. The
notation k·k stands for the Euclidean norm. If the bilateral trade cost function T is such
that for all i, j ∈ S, T (i, j) = et(i,j) , we say that the bilateral trade costs are geographic.10
Note that when bilateral trade costs are geographic, there exists a unique mapping from the
(n-dimensional) instantaneous trade cost function τ to the (n2 -dimensional) bilateral trade
costs T .
   Equation (15) is a well studied problem that arises in a number of fields, including
  9
       In fact, practically
                   ´b
                             all the theoretical results that follow, apply to any finite-dimensional manifold.
  10                  f (x)dx
                                 Qb                        Qb
       Note that e a          = a (1 + f (x) dx), where a denotes a type II product integral.
              The Topography of the Spatial Economy                           11


fluid mechanics, image processing, and even the study of the formulation of snowflakes. Its
solution is characterized by the following Eikonal (or Hamilton-Jacobi in the viscosity sense)
partial differential equation (see Mantegazza and Mennucci (2003)). For any origin i ∈ S
and destination j ∈ S:
                                      ||∇t (i, j) || = τ (j) ,                            (16)

where the gradient is taken with respect to the destination j.
    For our purposes, it suffices to focus on the set of iso-cost contours, i.e. the set of curves
defined by the set of destinations {j|t (i, j) = C} for all C. Equation (16) implies that as
C increases, the iso-cost contour expands outward at a rate inversely proportional to the
instantaneous trade cost in a direction that is orthogonal to the contour curve. Hence, the
evolution of the contour of the (log) bilateral trade costs is equivalent to the propagation of
a wave front outward from the origin along the surface at a speed inversely proportional to
the instantaneous trade cost. As a result, beginning with an arbitrarily small C around any
initial point i ∈ S, one can trace the expansion of the contours to determine t (i, j) for all
j ∈ S. Figure 2 illustrates the propagation process.
    Two properties of geographic trade costs deserve special mention. First, because traveling
over a particular point i ∈ S incurs the same cost regardless of the direction of travel,
geographic trade costs are symmetric, i.e. for all i, j ∈ S, T (i, j) = T (j, i) . Second, because
the topography of the surface is smooth, nearby locations will face similar trade costs to all
other destinations. Formally, for all s, i, j ∈ S, we have lims→i T (s, j) = T (i, j). While we
believe these are attractive properties for trade costs arising from transportation costs, they
abstract from alternative sources of trade costs, e.g. origin-specific tariffs or information
frictions (see e.g. Allen (2012)).


2.3    Combining the economic and geographic components
In this subsection, we combine the economic and geographic components by considering a
surface S with a regular geography and geographic trade costs. We show that there exists a
simple set of differential equations relating the equilibrium spatial distribution of economic
activity on S to the geography of S.
    Combining utility equalization (i.e. w (i) = W P (i) /u (i)) with equation (13), taking the
gradient with respect to i, and substituting in the Eikonal equation (16) yields the following
relationships between the topography of the labor supply and wages and the underlying
geography of productivity, amenities, and trade costs:
                  The Topography of the Spatial Economy                                         12




                  γ1 ∇ ln L (i) = (σ − 1) ∇ ln Ā (i) + σ∇ ln ū (i) − (2σ − 1) κ (i) τ (i) ,          (17)
                  γ1 ∇ ln w (i) = − β (σ − 1) ∇ ln Ā (i) − (1 − α (σ − 1)) ∇ ln ū (i)                (18)
                                       + (1 − (σ − 1) (α − β)) κ (i) τ (i) ,
                     ´
                         ∇t(s,i)T (s,i)1−σ A(s)σ−1 w(s)1−σ ds
where κ (i) ≡ ´ S||∇t(s,i)||T (s,i)1−σ A(s)σ−1 w(s)1−σ ds . While succinct, equations (17) and (18) capture
                 S
a number of important characteristics of the equilibrium distribution of economic activity.
In what follows, we focus on the case γ1 > 0 so that all spatial equilibria are regular and
locally point-wise stable. First, all else equal, the equilibrium labor supply will increase as
the underlying productivity and amenity of a location increase. In contrast, the equilibrium
wages will decrease as the underlying productivity increases and may increase or decrease as
the amenity of a location increases, depending on the sign of 1 − α (σ − 1).
    Second, all else equal, an increase in the remoteness of a location will cause the equilibrium
labor supply to fall. To see this, note that ∇t (s, i) captures how a move from i changes the
distance from s and T (s, i)1−σ A (s)σ−1 w (s)1−σ is proportional to the relative importance
of goods from s in i’s consumption bundle. As a result, κ (i) captures how changes in the
geographic location affect the average distance from i to all its trading partners, weighted
by the importance of each trading partner.11 In other words, κ (i) captures the gradient of
the “remoteness” of a location. If moving in a particular geographic location increases the
remoteness, all else equal, the equilibrium labor supply will decrease in that direction, as
the price of the consumption bundle increases due to the rising trade costs. In contrast,
the effect of the remoteness of a location on the equilibrium wages depends on the sign of
1 − (σ − 1) (α − β).
    Third, the instantaneous trade cost bounds how much the equilibrium labor supply and
wages can change over space. In particular, note that from the triangle inequality, the length
of κ (i) is no greater than one:
                                         ´
                                               ||∇t (s, i) T (s, i)1−σ A (s)σ−1 w (s)1−σ ||ds
                    0 ≤ ||κ (i) || ≤ ´     S
                                                                                                = 1,
                                           S
                                             ||∇t (s, i) ||T (s, i)1−σ A (s)σ−1 w (s)1−σ ds

so that:

               0 ≤ || (σ − 1) ∇ ln Ā (i) + σ∇ ln ū (i) − γ1 × ∇ ln L (i) || ≤ (2σ − 1) τ (i)
  11
       Indeed, it is straightforward to show that κ (i) τ (i) = ∇ ln P (i).
                  The Topography of the Spatial Economy                                                13


and

0 ≤ ||γ1 ×∇ ln w (i)+β (σ − 1) ∇ ln Ā (i)+(α (1 − σ) + 1) ∇ ln ū (i) || ≤ |1−(σ − 1) (α − β) |τ (i) .

Intuitively, the gradient of the log of the price index is bounded by the instantaneous trade
costs, as at worst (best), moving in a particular direction moves you away from (toward) all
other locations, increasing (reducing) all bilateral trade costs by τ (i).
    Fourth, the productivity and amenity spillovers (i.e. α and β) only affect the topography
of the labor supply directly by changing its overall elasticity to geographical factors.12 To see
this, note that α and β only enter the constant γ1 in equation (17), which simply governs the
overall responsiveness of ∇ ln L (i) to ∇ ln Ā (i), ∇ ln ū (i), and κ (i) τ (i). Thus, increasing
the productivity spillovers (i.e. increasing α) increases the elasticity of the labor supply to
changes in geographical factors, while increasing the congestion externalities (i.e. decreasing
β) decreases the elasticity of the labor supply to changes in geographical factors.


2.4        Examples: the line and the circle
To obtain an insight into the forces shaping the spatial equilibrium, we present two simple
one-dimensional examples of surfaces: the line and the circle. These two cases help us to
illustrate the different types of equilibria that may arise and discuss their stability properties.
     The line
     Let S be the [−π, π] interval and the instantaneous trade costs be constant, i.e. τ (i) = τ
for all i ∈ S. In this case, T (i, s) = eτ |i−s| . Suppose that α = β = 0 and Ā (i) = ū (i) = 1,
i.e. there are no spillovers and all locations have homogeneous productivities and amenities.
Then the differential equation (17) becomes:

                                            ∂ ln L (i)
                                                       = − (2σ − 1) τ κ (i) ,                                      (19)
                                                ∂i
                    ´i                                       ´
                     −π   e(1−σ)τ |i−s| A(s)σ−1 w(s)1−σ ds− iπ e(1−σ)τ |i−s| A(s)σ−1 w(s)1−σ ds
where κ (i) =                            ´π
                                              (1−σ)τ |i−s| A(s)σ−1 w(s)1−σ ds                   .   Because κ (−π) = −1
                                          −π e

  12
       There is also an indirect effect of α and β on L (i) through κ (i).
               The Topography of the Spatial Economy                                  14


and κ (π) = 1, the following boundary conditions follow immediately from equation (19):

                                      ∂ ln L (−π)
                                                   = (2σ − 1) τ
                                           ∂i
                                        ∂ ln L (π)
                                                   = − (2σ − 1) τ.
                                            ∂i

Furthermore, by imposing symmetry, equation (19) implies that the ∂ ln∂iL(i) is positive for
i < 0 and negative for i > 0, i.e. the equilibrium distribution is a concentration in the center
of the line, with the degree of concentration increasing in both the trade cost τ and the
elasticity of substitution σ.
    It turns out that there exists a closed form solution to equation (19). To see this, we
differentiate equation (14) twice to show that the equilibrium satisfies the following second
order differential equation:
                                         ∂2
                                         ∂i2
                                             L (i)σ̃
                                                     = k1 ,                                 (20)
                                          L (i)σ̃
where k1 ≡ (1 − σ)2 τ 2 + 2 (1 − σ) τ W 1−σ . Given the boundary conditions above, the equi-
librium distribution of labor is characterized by the cosine function (see example 8.8.16 in
Polyanin and Manzhirov (2008)):
                                                      p  σ̃1
                                       L (i) = k2 cos i k1 ,

where k2 can be determined using the aggregate labor clearing condition.13
    Figure 3 depicts the equilibrium labor allocation in this simple case for different values
of the instantaneous trade cost. As the instantaneous trade cost increases, the population
concentrates in the middle of the interval where the locations are less economically remote.
The lower the trade costs, the less concentrated the population; in the extreme where τ = 0,
labor is equally allocated across space. With symmetric productivities and amenities, wages
are lower in the middle of the line to compensate for the lower price index.
    Exogenous differences in productivities, amenities and spillovers also play a key role in
determining the equilibrium allocation of labor and wages. We use numerical methods to
  13
    In this simplest form the differential equation resulting from our system is the one also describing a
system of free harmonic oscillations, which, when displaced from its equilibrium position experiences a
restoring force proportional to the displacement. Mechanical examples include the pendulum, springs, and
acoustical systems. More general formulations of the exogenous productivity or amenity functions result
to more general specifications of the second order differential equation illustrated above (see Polyanin and
Zaitsev (2002) section 8.1 for a number of tractable examples).
               The Topography of the Spatial Economy                                   15


compute these more general cases. Assume, for example, that there are no spillovers, but
Ā (i) = eAi . Then the differential equation (17) becomes:

                                   ∂ ln L (i)
                                              = Ai − (2σ − 1) τ κ (i) ,
                                       ∂i

so that the equilibrium distribution of population is shifted rightward when A > 0. Figure
4 depicts this reallocation of labor toward locations with higher productivities.
    A different result is obtained if we increase the parameter α that regulates productivity
externalities, but leave productivities homogeneous. As mentioned in the previous subsec-
tion, as long as γ1 > 0, this change increases the elasticity of the labor supply to changes in
the geography, which increases the concentration of population in the already highly pop-
ulated locations. Figure 5 depicts the population for higher values of α, and the resulting
increase in the concentration. Notice that further increases in α, to the point that γ1 < 0,
results in a completely different regular spatial equilibrium where most of the population is
concentrated at the two edges of the line. This equilibrium, however, is not locally point-wise
stable, as a small number of workers could move from the edges to the center and become
better off.
    The circle
    The example of the circle illustrates the possibility of multiplicity of spatial equilibria.
All the results that we have in this case are numerical. Figure 6 shows the cases α + β = 0
(left panel) and α + β > 0 (right panel). When α + β = 0. there is a unique equilibrium with
symmetric population across all locations. This remains an equilibrium when α + β > 0, but
there are also (a continuum of) additional equilibria, where any location on the circle could
be the one where economic activity is more concentrated. Thus, γ1 = 1, which corresponds
to α + β = 0, is a bifurcation point that moves us from a parameter space with a unique
spatial equilibrium to one with a continuum of equilibria.14


3      The topography of the real world spatial economy
In this section, we use the model developed in Section 2 to analyze the actual topography of
economic activity in the continental United States. The section is composed of three parts.
In the first part, we estimate the underlying geography of the United States. In the second
  14
    If we further increase α + β to the point that the sign of γ1 turns negative we can only find numerically
one regular spatial equilibrium, which is again the symmetric one. This equilibrium is not point-wise locally
stable, as increasing the population of any point in the circle increases the welfare workers living there.
               The Topography of the Spatial Economy                                 16


part, we determine the fraction of the observed spatial variation in income due to geographic
location. In the third part, we examine the welfare impact and the resulting redistribution of
economic activity arising from the construction of the Interstate Highway System. In what
follows, we assume the elasticity of substitution σ = 9, which, consistent with Eaton and
Kortum (2002), yields a trade elasticity of eight.


3.1     Determining the real world geography
The goal of this subsection is to recover the underlying geography of the continental United
States, namely the bilateral trade cost function T and the topography of exogenous pro-
ductivities Ā and amenities ū. To do so, we proceed in three steps. In the first step,
we estimate trade costs using observable geographical features in order to best match the
observed bilateral trade shares between states. In the second step, we find the unique com-
posite productivities A and amenities u that generate the observed distribution of wages
and population given the trade costs. Finally, we estimate the strength of spillovers α and β
using changes in the composite productivities and amenities over time and use these spillover
estimates to back out the underlying exogenous productivities Ā and amenities ū.

3.1.1    Estimating trade costs

We first estimate the bilateral trade cost function T . To do so, we assume that T is a
composite function of geographic trade costs Tg and non-geographic trade costs Tng : T =
Tg + Tng . Let Gg : S → Rd be an observable vector of d geographical characteristics (e.g.
elevation, whether i is on land or water, etc.). Similarly, let Gng : S × S → Rc be an
observable vector of c bilateral non-geographic characteristics (e.g. if i and s are in the
same political area).15 We assume that both the instantaneous trade costs underlying the
geographic trade costs and the non-geographic trade costs can be written as a linear function
of observable geographic characteristics:

                                            τ (i) = βg0 Gg (i)
                                                    0
                                             Tng = βng Gng .
  15
    Technically, both Xg and Xng are required to be continuous functions on their respective domains for
the theoretical results to hold. Discontinuous observables such as political boundaries can be included by
assuming borders take up space, thereby “smoothing” the discontinuity. This does not affect the empirical
analysis, as the space S is ultimately discretized for computational purposes.
               The Topography of the Spatial Economy                                      17


The goal of the following procedure is to estimate βg and βng . To do so, we choose the βg
and βng to most closely match the state to state bilateral trade flows predicted by the model
to the trade flows observed in the 2007 Commodity Flow Survey (CFS) using a nonlinear
least squares approach. In the CFS, we observe a measure of the total value of bilateral
trade flows from state o to state d, X̃od .16 We assume that this data is measured with error
so that the true value of bilateral trade flows Xod can be written as:

                                                  Xod = X̃od εod ,                                       (21)

where εod is i.i.d. with E [ln εod ] = 0.
    The major difficulty of the estimation procedure is that the CFS reports state to state
bilateral trade flows while our model predicts bilateral trade flows between any two locations
on a surface. Formally, let Si be the set of all locations in geographic area i (e.g. state i).
Bilateral trade flows from state o to state d are hence:
                                          ˆ  ˆ
                                  Xod =            X (i, j) didj.
                                                  i∈So   j∈Sd


The usual estimation method would involve guessing βg and βng , calculating X (i, j) for all
locations in the world, aggregating to construct state to state trade flows Xod and iterating to
find the βg and βng that minimize the distance between the Xod and the trade flows observed
in the data. Unfortunately, such a procedure is too computationally intensive to be feasible.
Instead, we use the following procedure based on Anderson and Van Wincoop (2003).
    It can be shown from the gravity structure of the model (equation 3) and balanced trade
(equation 6) that as long as trade costs are symmetric, trade flows from any i ∈ S to any
j ∈ S can be written as follows:

                                             T (i, j)1−σ      w (j) L (j) w (i) L (i)
                             X (i, j) =        1−σ        1−σ                         ,
                                          P (j)     P (i)              yW
                ´
where y W ≡         S
                        w (s) L (s) ds is the aggregate world income. If the price index is roughly
  16
     We use the value of all commodity flows between states to construct trade shares. One potential concern
with this measure is that it includes shipments of intermediate goods as well as final goods. While the public
CFS data only differentiates commodities at an aggregate level, we have constructed alternative measures
of trade shares only using values of commodities that are likely to be final goods (e.g. “cereal grains”). The
correlation of the trade shares calculated using all commodities and the trade shares calculated using only
this subset of commodities is 0.98 (0.89 in logs), suggesting that the presence of intermediate goods is not
substantially affecting the results.
               The Topography of the Spatial Economy                                  18


the same for all locations within a state, i.e. P (s) ≈ Pi for all s ∈ Si , then the normalized
bilateral trade share can be written as:
                                            ´      ´                  2
               Xod Xdo                     i∈So j∈Sd
                                                       K   (i, j) didj
                         ≈ ´    ´                    ´       ´                       ,            (22)
               Xoo Xdd                 K (i, j) didj                  K (i, j) (j) didj
                             i∈So j∈So                    i∈Sd j∈Sd

where K (i, j) ≡ T (i, j)1−σ w (i) L (i) w (j) L (j). Notice that this expression says that the
normalized state-level bilateral trade flows is approximately a weighted average of the nor-
malized location-level bilateral trade flows, where the weights are determined by the product
of the origin and destination location incomes. Because location incomes are observed in the
data, calculating the (approximate) model predicted X       od Xdo
                                                          Xoo Xdd
                                                                   only requires the calculation of
the bilateral trade cost function T (i, j) rather than solving the entire model equilibrium.17
     The remainder of the estimation procedure is as follows. We first guess the value of βg and
βng . Given βg , we use the instantaneous trade costs τ (i) = βg0 Gg (i) to calculate the implied
geographic component of the bilateral trade cost function T̃g (βg ) : S ×S → R++ . We employ
the Fast Marching Method (FMM) algorithm, which calculates the bilateral trade cost by
propagating the cost contour outwards from a particular origin using equation (16). FMM
has proven enormously successful in quickly calculating accurate and precise approximations
of bilateral cost functions on arbitrary manifolds (see Sethian (1996); Kimmel, Kiryati, and
Bruckstein (1996); Kimmel and Sethian (1998)).18 We implement FMM routines in Matlab
developed by Peyre (2009) and Kroon (2009) to calculate the bilateral trade cost function
T̃g (βg ) for all i, j ∈ Sg and j pixels.19 The computation is quick: for a 100 × 100 pixel surface
(which requires determining the distance between 100 million bilateral pairs), T̃g (βg ) can be
calculated in approximately one minute on a standard personal computer. Total bilateral
                                                            Xod Xdo
  17
     In practice, the correlation between the approximate X  oo Xdd
                                                                    and the actual X od Xdo
                                                                                   Xoo Xdd predicted by the
model is greater than 0.99, suggesting that the assumption of an approximately equal price index within
state is not substantially affecting the results.
  18
     Other trade papers (e.g. Donaldson (2012)) have calculated the distance function by approximating the
distance with a discrete graph and using Dijkstra’s algorithm. The Dijkstra algorithm, however, is inappro-
priate for approximating distances along a continuous surface as its estimated distances will not converge
to the true distance as the graph approximation of the surface becomes more refined (see Mitchell (1988)).
Fortunately, the FMM provides consistent estimates of the true distance using discrete approximations of
the space while retaining the same operational complexity of Dijkstra’s algorithm (see Mémoli and Sapiro
(2001)). Indeed, the FMM algorithm is equivalent to an extension of the Dijkstra algorithm where the
distance is an appropriately weighted average of several paths traveling through nodes in a gridded network
(see Tsitsiklis (1995)).
  19
     The routine developed by Kroon (2009) is based on the work of Hassouna and Farag (2007) and has
been shown to be more accurate; however, it is not implementable on non-planar surfaces.
              The Topography of the Spatial Economy                                   19


                                                                                    0
trade costs implied by βg and βng are then simply T̃ (βg , βng ) = T̃g (βg ) + βng    Gng .
    Given the bilateral trade costs T̃ (βg , βng ), we then calculate the implied trade shares using
equation (22). Let fod (β) denote the predicted log normalized trade share given parameter
β ≡ [βg , βng ]. Let β 0 be the true value so that the predicted
                                                                      trade shares given β 0 is equal
                                                      Xod Xdo
to the actual trade shares, i.e. fod (β 0 ) = ln X      oo Xdd
                                                                . Note from equation (21) that the
expected log difference between the normalized trade share predicted by the model given β 0
and the normalized trade share observed in the CFS is zero:
                        "                           !#                   
                               0
                                        X̃   X̃
                                            od do                  εoo εdd
                     E fod β − ln                       = E ln                = 0,
                                         X̃oo X̃dd                 εod εdo

which suggests the following non-linear least squares estimator:

                                      N   N
                                                                            !!2
                                   1 XX                         X̃od X̃do
                      β̂ = arg min 2         f (β) − ln                           .              (23)
                                β N                             X̃oo X̃dd
                                     o=1 d=1


To construct Gg , we assign each location to one of six mutually exclusive and exhaustive
types: ocean, interstate highway, river (or lake), old highways (constructed by 1931), moun-
tain (measured as elevation greater than 2000 meters), and other land, where the order
indicates the precedent of each type (e.g. a location with both a river and an interstate
highway is classified as an interstate highway). As a result, βg indicates the instantaneous
trade cost of traveling over each type of location. We assume Gng is simply an indicator
equal to one if the origin location and destination location are in different states, so that βng
indicates the ad valorem cost of trading across states.
    Table 1 presents the resulting estimates from equation 23. The estimates yield a reason-
able ranking of the relative costs of traveling over different types of locations: traveling via
interstate highways is least costly, followed by oceans and other land, while traveling over
mountains are most costly. The magnitude of the estimates suggest that trade costs are
substantial: the ad valorem equivalent trade cost of shipping a good from one coast to the
other ranges from 70% (if traveling only via interstate highways) to 320% (if traveling only
via mountains). The non-geographic trade costs appear substantial as well; we estimate that
there is a 48% ad valorem equivalent trade cost of trading with locations outside one’s own
state. Overall, the average ad valorem equivalent trade cost between any two locations is
74.3%, which is roughly in line with the estimates of Anderson and Van Wincoop (2004).
    Figure 7 shows how well the model is able to match the normalized bilateral trade shares
               The Topography of the Spatial Economy                                    20


observed in the CFS. Overall, there is a high (0.61) correlation between the predicted and
observed normalized bilateral trade shares. The model, however, is not able to fully capture
the observed variance in the trade shares, as it tends to under-predict trade flows between
states with the greatest amount of trade.

3.1.2    Identifying productivities and amenities

Suppose we observe trade costs and the equilibrium distribution of economic activity. Can
we identify the underlying topography of productivities and amenities? Note that combining
equation (4) with utility equalization implies:
                                            ˆ
                           1−σ
                   u (i)         =W   1−σ
                                                T (s, i)1−σ w (i)σ−1 w (s)1−σ A (s)σ−1 ds.             (24)
                                            S


In addition, equation (13) can be rearranged as follows:

                                                   1
                                  A (s)σ−1 =         L (s) w (s)2σ−1 u (s)σ−1 .                        (25)
                                                   φ

The following theorem guarantees that for any observed distribution of economic activity,
there exists a unique topography of productivities and amenities that generate that equilib-
rium.

Theorem 3 For any continuous functions w and L and continuous symmetric function T ,
all bounded above and below by strictly positive numbers, there exists unique (to-scale) positive
and continuous functions A and u such that w and L comprise the regular spatial equilibrium
for the geography defined by T , Ā = AL−α and ū = uL−β .

Proof. See Appendix A.1.4.
    In practice, amenities u (i) can be determined (up to scale) by iterating equation (24)
from an initial guess of the amenities, using equation (25) to substitute for A (s)σ−1 . Figure
8 depicts the observed spatial distribution of people (top panel) and wages (bottom) panel
in the United States in the year 2000, which is available at the county level from MPC
(2011).20 Figure 9 depicts the unique spatial distribution of productivities A (i) (top panel)
and u (i) (bottom panel) that are consistent with the observed distribution of people and
  20
    Population density L (i) is measured as the average number of people per square kilometer in the county.
Wages w (i) are measured as the total payroll per capita in each county and are trimmed at the 1%/99%
level. Both wages and population density are normalized to have a mean of one.
               The Topography of the Spatial Economy                                  21


income along with the trade costs estimated in the previous section. Conditional on the price
index, locations with observed higher wages are estimated to have lower composite amenities
(from utility equalization), whereas conditional on the price index and wages, locations with
greater populations are estimated to have higher composite productivities (from balanced
trade). As a result, cities like New York, Chicago, and Los Angeles are estimated to have
higher composite productivities and lower composite amenities than nearby areas which are
less densely populated and have lower wages.
    It should be noted that Theorem 3 implies that only the composite productivity A (i)
and amenity u (i) can be identified from the observed topography of wages and population.
If the parameters α and β governing the strength of spillovers are also known, then the
underlying topography of S (i.e. the functions Ā and ū) can be determined simply using
equations (1) and (2) (since labor is observed). However, α and β cannot be identified
from the observed distribution of wages and population: for any α and β, unique functions
Ā and ū can be chosen to generate the composite productivities necessary to generate the
observed equilibrium distribution of economic activity.21 The next subsection discusses how
the strength of spillovers can be identified using time series variation resulting from a change
in trade costs.

3.1.3    Estimating the strength of spillovers

Consider a surface S with functions Ā and ū governing the topography of exogenous pro-
ductivity and amenities. Suppose that the equilibrium distribution of economic activity
was observed under two alternative trade cost regimes T0 and T1 , i.e. the set of functions
{w0 , L0 , T0 } and {w1 , L1 , T1 } are observed. From Theorem 3, there exists unique functions
A0 and u0 corresponding to {w0 , L0 , T0 } and unique functions A1 and u1 corresponding to
{w1 , L1 , T1 }. As long as the exogenous productivities Ā and amenities ū remain unchanged,
it is possible to identify the strength of spillovers since α = ln Â
                                                                ln L̂
                                                                               ln û
                                                                      and β = ln  L̂
                                                                                     from equations
                                                                                 A1
(1) and (2), where the hat denotes the ratio between regimes, i.e. Â ≡ A0 . Intuitively, a
change in the trade costs will result to a reallocation of economic activity across S. Because
the composite amenities and productivities can be identified in the cross section and the
exogenous functions Ā and ū remain unaffected by the trade costs, any observed change in
A and u must have arisen from changes due to spillovers.
     To illustrate the process, we consider a change in trade costs arising from the construction
  21
    Ellison and Glaeser (1997) make a similar point about the inability to disentangle the natural advantage
of a location from spillovers using cross-sectional data alone.
                  The Topography of the Spatial Economy                                  22


of the U.S. interstate highway system (IHS). Construction of the IHS began in 1956 and was
proclaimed complete in 1992. It now includes approximately 76,000km of roads. In Section
3.1.1, we estimated the effect of both the IHS and the old highway system on instantaneous
trade costs. To determine the instantaneous trade costs prior to the construction of the IHS,
we remove the interstate highway system from the topography of instantaneous trade costs,
reassigning locations with interstate highways to the appropriate alternative category (using
the ordering from above).
    Figure 10 compares the topography of instantaneous trade costs prior to the construc-
tion of the IHS (top panel) to the instantaneous trade costs after the construction of the IHS
(middle panel) using the coefficients estimated in Section 3.1.1; the decline in the instanta-
neous trade costs (bottom panel) depicts the complete IHS network. We then calculate the
bilateral trade cost functions T0 and T1 given the topography of instantaneous trade costs
before and after the construction of the IHS, respectively, using the FMM method described
in Section (3.1.1). As an example, Figure 11 shows the bilateral trade cost from New York
City to all other locations in the United States prior to the construction of the IHS (top
panel), after the construction of the IHS (middle panel), and the resulting change in bilat-
eral trade costs (bottom panel). The construction of the IHS differentially reduced the trade
costs to destinations far away, as the least cost route to these destinations is along greater
stretches of interstate highways.
    To determine the equilibrium distribution of economic activity prior to the construction
of the IHS, we use the 1930 county level U.S. census data available from MPC (2011). The
population density L0 is measured as the county-level average population density and the
wage w0 is measured as the total value of output (agriculture plus manufacturing) per capita
in the county.22 Figure 12 presents the relative population density (top panel) and wages
(bottom panel) across the United States in the years 1930. Figure 13 shows the change in
the topography of population densities (top panel) and wages (bottom panel) between 1930
and 2000.
    Given T0 and T1 and the observed spatial distribution of economic activity {w0 , L0 } and
{w1 , L1 }, we follow the procedure presented in Section 3.1.2 to identify the unique topography
of composite productivities and amenities {A0 , u0 } and {A1 , u1 } that is consistent with the
observed distribution of economic activity and trade costs. Let εA (i) ≡ Ā   1 (i)
                                                                            Ā0 (i)
                                                                                    and εu (i) ≡ ūū01 (i)
                                                                                                        (i)

denote the change in the exogenous productivities and amenities, respectively. Then taking
  22
       The different measure of wages is necessary because payroll data was not collected in 1930.
                The Topography of the Spatial Economy                                      23


logs of equations (1) and (2) yields:
                                                        
                                 A1 (i)             L1 (i)
                            ln             = α ln            + CA + ln εA (i)                               (26)
                                 A0 (i)             L0 (i)
                                                        
                                  u1 (i)            L1 (i)
                             ln            = β ln            + CU + ln εu (i) ,                             (27)
                                  u0 (i)            L0 (i)

where CA and CU capture changes in the normalization (since composite amenities and
productivities are only identified up to scale).23 If εA (i) and εu (i) are uncorrelated with the
log change in population density, unbiased estimates of the parameters α and β governing
the strength of spillovers can be estimated from equations (26) and (27) using ordinary
least squares (OLS). However, because εA (i) and εu (i) reflect changes in the exogenous
productivities and amenities and the labor supply is determined in part by productivities
and amenities (see equation 13), the model suggests that the OLS estimates of α and β will
be biased.
    To overcome this problem, we estimate equations (26) and (27) using an instrumental
variable (IV) procedure. We use as our instrument ln P̂ (i), which we define as the (log)
difference between the price index in location i in the year 1930 and what the price index
in the year 1930 would have been if the IHS had already existed, holding fixed the observed
wages and calibrated composite amenities, i.e.:
                                         ´
                                   1       T (s, i)1−σ A0 (s)σ−1 w0 (s)1−σ ds
                                          S 0
                      ln P̂ (i) ≡     ln ´                                    .
                                  1−σ      T (s, i)1−σ A0 (s)σ−1 w0 (s)1−σ ds
                                          S 1


This instrument captures the increase in market access due to the decline in bilateral trade
costs resulting from the construction of the IHS, i.e. it is a location-specific measure of the
impact of the IHS. By holding the wages and calibrated composite amenities fixed, variation
in ln P̂ (i) arises only from the effect of the IHS on the average trade cost location i incurs with
its trading partners, where the average is weighted by the importance of the trading partner
in the consumption bundle of consumers in location i. Instrumental variables estimation
will yield unbiased estimates of α and β as long as ln P̂ (i) is uncorrelated with exogenous
  23
      Because the equilibrium distribution of economic activity across space is only affected by rela-
tive
´      differences
               ´ in exogenous productivities and amenities, without loss of generality we can normalize
  S
    Ā (s) ds=  S
                  ū (s) ds = 1. However, without knowledge of α and β, this normalization does     ´     not help
determine
´             the scale   of the composite  productivities  and  amenities. We  therefore normalize   S
                                                                                                        A (s) ds =
 S
    u (s) ds  = 1 and   include  a constant to control for the change in scale.
               The Topography of the Spatial Economy                                     24


changes in amenities and productivities conditional on the change in the population.24 This
seems a reasonable assumption, as the IHS was designed to connect major cities, connect to
international road networks, and for national defense purposes, so its effect on the average
bilateral trade costs of a location is unlikely to be systematically correlated to the changes
in fundamentals of that location (see e.g. Michaels (2008)). Figure 14 presents a map of
the impact of the IHS on the price index; while overall market access in the western United
States increased the most from the construction of the IHS (as the pre-existing road density
was lowest there), there exists substantial variation both within and across states.
    The results of the estimation of equations (26) and (27) are presented in Table 2. The first
two columns present the OLS results; the productivity spillover α is estimated to be 0.459,
and the amenity spillover β is estimated to be −0.339. The third and fourth columns present
the IV results. These estimates are substantially greater in magnitude; the productivity
spillover α is estimated to be 1.545, and the amenity spillover is estimated to be −1.640. Part
of the reason for the substantial difference between the OLS and IV results may be because
the IV regression assumes that the first-stage relationship between ln P̂ (i) and ln L̂ (i) is the
same for the entire United States. In the fifth and sixth columns, we allow the first-stage
relationship to vary across states.25 In this case, the productivity spillover α is estimated
to be 0.350, and the amenity spillover is estimated to be −0.336. Because of the additional
flexibility in the first stage relationship, these are our preferred estimates in what follows.
All estimates are precisely estimated and strongly statistically significant.
    How do these estimates compare to results elsewhere? Rosenthal and Strange (2004)
review the literature and find that doubling the size of city increases productivity by roughly
3 to 8 percent; our preferred IV estimate suggests a higher figure of 35 percent. However,
our measure of productivity captures both the measure of variates produced in a location
and the productivity per worker of each variety (see Appendix A.2). In particular, in a
                                                                                1
monopolistic competition setup with free entry with a fixed cost of labor, σ−1     of the α will
be due to productivity gains resulting from the increased number of varieties in markets with
larger population. Thus, given the assumed elasticity of substitution of nine, our estimate
of α implies that the elasticity of productivity per worker to the population density is 22.5
percent. If amenity spillovers are interpreted as the share of income spent on non-tradable
  24
      This instrumental variable strategy is similar in spirit to Ahlfeldt, Redding, Sturm, and Wolf (2012),
whose identification strategy relies on the assumption that the distance to the Berlin wall was uncorrelated
with changes in exogenous residential and production fundamentals.
   25
      Because this requires estimating an intercept and slope coefficient for each state in the first stage, we
follow Stock and Yogo (2002) and use a Limited Information Maximum Likelihood (LIML) estimator.
                  The Topography of the Spatial Economy                                   25


                                                                             β
goods (see Appendix A.2), the IV estimates of β̂ imply that 25% (− 1−β         ) of income is spent
on non-tradables. In comparison, the 2011 Consumer Expenditure Survey finds the average
household spent 33.8% of their income on housing (BLS, 2011).
    Given estimates α̂ and β̂ from columns five and six of Table 2, we estimate the geography
of exogenous productivities and amenities from the observed distribution of population and
the calculated composite productivities and amenities using equations (1) and (2), i.e. Ā (i) =
A (i) L (i)−α̂ and ū (i) = u (i) L (i)−β̂ . Figures 15 and 16 present the topography of exogenous
productivities (top panel) Ā and exogenous amenities (bottom panel) ū for the years 1930
and 2000, respectively. In 1930, the exogenous productivity was high in the northeast, great
plains, and west coast, while it was lower in the southwest; amenities were low in the west and
high in the south and the Appalachia. In 2000, both exogenous productivity was highest in
the Rocky Mountain states and lowest in the south; exogenous amenities were highest along
the coasts and in the south and lowest in the Rocky Mountains.


3.2        Importance of geographic location
Given the estimated geography of the United States, we can determine the fraction of the
observed variation in incomes Y (i) ≡ w (i) L (i) that is due to the geographic location of
i ∈ S. To do so, note that combining equation (13) with utility equalization along with some
algebra yields the following expression:

                            ln Y (i) = C + δ1 ln Ā (i) + δ2 ln ū (i) + δ3 ln P (i) ,                 (28)

where C is a scalar, and the coefficients are known functions of σ, α, and β.26 Equation (28)
provides a log linear relationship between the observed income in location i, the exogenous
productivities and amenities, and the price index. Note that the price index is a sufficient
statistic for the effect of geographic location on income, as it is the only term that includes
the bilateral trade costs. To determine the relative contribution of the effect of local charac-
teristics (i.e. Ā (i) and ū (i)) and geographic location (i.e. P (i)) to the spatial dispersion of
income, we apply a Shapley decomposition (see Shorrocks (2013)) to equation (28).
    There are two caveats that should be mentioned with this approach. First, the relative
contribution of the two terms will depend in part on the chosen parameters α and β governing
productivity and amenity spillovers, respectively. For robustness, we implement the Shapley
decomposition for a wide range of parameters other than our estimated values. Second, if
  26
       Equation (28) can also be arrived at by integrating the differential equations (17) and (18).
               The Topography of the Spatial Economy                                  26


the trade cost function τ (i) is mis-specified, the model may fail to capture the observed
differences in income without relying on exogenous variation in productivity and amenities
even if no such exogenous variation is necessary. In such an event, the estimated contribution
of the price index would be biased downwards. As a result, the contribution of the price
index should be considered a lower bound for the importance of the geography of trade costs
in explaining the differences in income across space.
    Figures 17 and 18 report the fraction of the spatial variation in income that can be at-
tributed to geographic location for the years 1930 and 2000, respectively, for all constellations
of α ∈ [0, 1] and β ∈ [−1, 0]. The star indicates the location of the preferred IV estimates
of α̂ and β̂. At these estimates, 43.2% of the observed spatial variation in income is due
to geographic location in the year 1930, and 24.0% of the observed spatial variation in in-
come is due to geographic location in the year 2000. These results remain mostly unchanged
for different strengths of spillovers, with the exception of spillover combinations near the
black-hole threshold γ1 = 0. Hence, the results suggest that a substantial fraction of the spa-
tial variation in incomes across the United States can be explained by geographic location,
although the importance of geographic location has declined over the past seventy years.


3.3     Welfare effects of the Interstate Highway System
In this section, we examine the welfare implications of the interstate highway system. This
has the additional benefit of providing a check of the validity of the model, as we can compare
the predicted and observed redistribution of economic activity across space. In what follows,
we set parameters α = 0.35 and β = −0.35. These values (which are well within the
confidence intervals of the 2SLS estimates) ensure a unique spatial equilibrium, thereby
avoiding problems of performing counterfactuals in the presence of multiple equilibria.27
     It is first helpful to use the model to characterize the total change in welfare between the
years 1930 and 2000. To do so, we calculate the welfare (up to scale) for each year using
the observed wages, composite amenities, and use equation (4) to impute the price index
given the estimated bilateral trade costs and composite productivities. Given the strength
of spillovers, we can then determine the scale of the welfare for each year by imposing that
´                  ´
  S
    Ā (s) ds  =     S
                       ū (s) ds = 1 in both years. We find that welfare was 65.7% greater in
  27
    If we use the 2SLS estimates α = 0.350 and β = −0.336, we find the algorithm which guarantees uniform
convergence for α + β ≤ 0 converges to an alternative equilibrium even for initial guesses of the population
density near the observed distribution in 1930. It is interesting to note that this alternative equilibrium
is characterized by a substantial increase in the population in the western United States (especially in
California) and is associated with 17% higher welfare than the observed spatial equilibrium.
             The Topography of the Spatial Economy                         27


2000 than in 1930. Because the exogenous amenities and productivities are normalized to
have a unit mean in both years, this welfare increase is due only to changes in the spatial
distribution of Ā and ū (and the resulting reallocation of the population) and the reduction
in trade costs associated with the construction of the interstate highway system.
    How much of this welfare gain can be attributed to the construction of the interstate
highway system? To answer this question, we hold the topography of productivities Ā and
amenities ū fixed at the 1930 levels and recalculate the equilibrium spatial distribution of
economic activity given the estimated bilateral trade costs after the construction of the IHS
using equations (13) and (14). The model estimates that the construction of the IHS lead
to a 3.47% increase in welfare, indicating that the majority of the welfare gain over the
past seventy years is due to changes in the spatial distribution of exogenous amenities and
productivities.
    Given the estimate of the welfare gains from the IHS, a simple back-of-the-envelope cal-
culation suggests that the benefits of the IHS substantially outweigh its costs. Duranton and
Turner (2011) estimate that the annual total cost (interest payments on the initial construc-
tion plus maintenance costs) of each kilometer of interstate is between $1.3 million and $3.25
million (in 2007 dollars), depending on the population density. Given the approximately
76,000km of interstate highways, their estimates suggest a total annual cost of the IHS is
between $100 and $250 billion. The U.S. GDP in 2007 was $14.25 trillion; since preferences
are assumed to be homothetic, if the IHS increased (static) welfare by 3.47%, its value is
$494.5 billion in 2007 dollars, suggesting a return on investment of at least 100%.
    While the construction of the IHS cannot explain a majority of the change in welfare, its
effect on the spatial distribution of economic activity accords well with the observed change
in the spatial distribution of people and income. Figures 19 and 20 compare the observed
change in the population and wages, respectively, between 1930 and 2000 (top panel) to the
change arising from the construction of the IHS predicted by the model (bottom panel),
where changes are measured in log differences. The model correctly predicts the increase
in population density and income in the Southwest and Florida; overall, the correlation
between the predicted and observed changes is 0.194 and 0.182 for population and wage
changes, respectively. The model, however, substantially under-predicts the magnitude of
the redistribution of population and wages. This reinforces the finding that the construction
of the IHS contributed only a small portion to the changing topography of economic activity
over the past seventy years.
             The Topography of the Spatial Economy                        28


4    Conclusion
We view this paper as taking a number of necessary steps toward the rigorous quantification
of spatial theory. First, we develop a unified general equilibrium approach combining labor
mobility, gravity, and productivity and amenity spillovers. Second, we provide a micro-
foundation of trade costs as the accumulation of instantaneous trade costs over the least
cost route on a surface. Combining the two allows us to determine the equilibrium spatial
distribution of economic activity on any surface with (nearly) any geography. As a result,
the framework can be applied directly to the analysis of detailed real world data on spatial
economic activity.
    This framework could be extended to address a number of other questions, including: How
would liberalizing a border redistribute the economic activity within each country? What will
be the effect of the opening of the Northwest Passage on the global income distribution? How
would removing restrictions on cross-country migration affect the equilibrium distribution of
economic activity?
            The Topography of the Spatial Economy                       29


References
Acemoglu, D., S. Johnson, and J. Robinson (2002): “Reversal of fortune: Geography
 and institutions in the making of the modern world income distribution,” The Quarterly
 Journal of Economics, 117(4), 1231–1294.

Ahlfeldt, G. M., S. J. Redding, D. M. Sturm, and N. Wolf (2012): “The Economics
 of Density: Evidence from the Berlin Wall,” CEPR Working paper, 1154.

Allen, T. (2012): “Information Frictions in Trade,” mimeo, Yale University.

Amiti, M., and L. Cameron (2007): “Economic Geography and Wages,” Review of Eco-
 nomics and Statistics, 89(1), 1231–1294.

Anderson, J. E. (1979): “A Theoretical Foundation for the Gravity Equation,” American
 Economic Review, 69(1), 106–116.

Anderson, J. E., and E. Van Wincoop (2003): “Gravity with Gravitas: A Solution to
 the Border Puzzle,” American Economic Review, 93(1), 170–192.

         (2004): “Trade Costs,” Journal of Economic Literature, 42(3), 691–751.

Arkolakis, C., A. Costinot, and A. Rodrı́guez-Clare (2012): “New Trade Models,
 Same Old Gains?,” American Economic Review, 102(1), 94–130.

Arkolakis, C., S. Demidova, P. J. Klenow, and A. Rodrı́guez-Clare (2008):
 “Endogenous Variety and the Gains from Trade,” American Economic Review, Papers and
 Proceedings, 98(4), 444–450.

Armington, P. S. (1969): “A Theory of Demand for Products Distinguished by Place of
 Production,” International Monetary Fund Staff Papers, 16, 159–178.

Birkhoff, G. (1957): “Extensions of Jentzsch’s theorem,” Transactions of the American
  Mathematical Society, 85(1), 219–227.

BLS (2011): “2011 Consumer Expenditure Survey,” http://www.bls.gov/cex/csxann11.pdf.

Breinlich, H. (2006): “The Spatial Economic Structure in the European Union: What
 Role for Economic Geography?,” Journal of Economic Geography, 12(6), 593–617.
            The Topography of the Spatial Economy                       30


Cervantes, F. P. (2012): “Railroads and Economic Growth: A Trade Policy Approach,”
 mimeo.

Chaney, T. (2008): “Distorted Gravity: The Intensive and Extensive Margins of Interna-
 tional Trade,” American Economic Review, 98(4), 1707–1721.

Cosar, K. A., and P. Fajgelbaum (2012): “Internal Geography, International Trade,
 and Regional Outcomes,” mimeo.

Davis, D., and D. Weinstein (2002): “Bones, Bombs, and Break Points: The Geography
 of Economic Activity,” American Economic Review, 92(5), 1269–1289.

         (2008): “A Search for Multiple Equilibria in Urban Industrial Structure,” Journal
  of Regional Science, 48(1), 29–65.

Donaldson, D. (2012): “Railroads of the Raj: Estimating the Economic Impact of Trans-
 portation Infrastructure,” Manuscript, MIT.

Donaldson, D., and R. Hornbeck (2012): “Railroads and American Economic Growth:
 New Data and Theory,” Discussion paper.

Duranton, G. (2008): “Spatial Economics,” in The New Palgrave Dictionary of Economics,
 ed. by S. N. Durlauf, and L. Blume, vol. 2nd Edition. Palgrave Macmillan.

Duranton, G., and D. Puga (2004): “Microfoundations of urban agglomeration
 economies,” in Handbook of Regional and Urban Economics, ed. by J. V. Henderson, and
 J. Thisse, vol. 4. North-Hol.

Duranton, G., and M. Turner (2011): “Urban growth and transportation,” Working
 Paper.

Eaton, J., and S. Kortum (2002): “Technology, Geography and Trade,” Econometrica,
 70(5), 1741–1779.

Ellison, G., and E. Glaeser (1997): “Geographic Concentration in U.S. Manufacturing
 Industries: A Dartboard Approach,” Journal of Political Economy, 105(5), 889–927.

Fabinger, M. (2012): “Trade and Interdependence in a Spatially Complex World,” mimeo,
  Penn State.
            The Topography of the Spatial Economy                      31


Fujimoto, T., and U. Krause (1985): “Strong ergodicity for strictly increasing nonlinear
 operators,” Linear Algebra and its Applications, 71, 101–112.

Fujita, M., P. Krugman, and A. J. Venables (1999): The Spatial Economy: Cities,
 Regions, and International Trade. MIT Press, Boston, Massachussetts.

Hanson, G. H. (2005): “Market Potential, Increasing Returns, and Geographic Concentra-
 tion,” Journal of International Economics, 67(1), 1–24.

Hassouna, M., and A. Farag (2007): “Multistencils Fast Marching Methods: A Highly
 Accurate Solution to the Eikonal Equation on Cartesian Domains,” Pattern Analysis and
 Machine Intelligence, IEEE Transactions on, 29(9), 1563–1574.

Head, K., and T. Mayer (2006): “Regional Wage and Employment Responses to Market
 Potential in the EU,” Regional Science and Urban Economics, 36(5), 573–595.

Helpman, E. (1998): “The Size of Regions,” Topics in Public Economics. Theoretical and
 Applied Analysis, pp. 33–54.

Karlin, S., and L. Nirenberg (1967): “On a theorem of P. Nowosad,” Journal of Math-
 ematical Analysis and Applications, 17(1), 61–67.

Kimmel, R., N. Kiryati, and A. Bruckstein (1996): “Sub-pixel distance maps and
 weighted distance transforms,” Journal of Mathematical Imaging and Vision, 6(2), 223–
 233.

Kimmel, R., and J. Sethian (1998): “Computing Geodesic Paths on Manifolds,” Proceed-
 ings of the National Academy of Sciences, 95(15), 8431–8435.

Krasnosel’Skii, M., and L. Boron (1964): Positive Solutions of Operator Equations. P.
 Noordhoff Groningen.

Kroon, D. (2009): “Accurate Fast Marching Toolbox,” Matlab Toolbox available at
 http://www.mathworks.com/matlabcentral/fileexchange/24531.

Krugman, P. (1980): “Scale Economies, Product Differentiation, and the Pattern of Trade,”
 American Economic Review, 70(5), 950–959.

        (1991): “Increasing Returns and Economic Geography,” The Journal of Political
  Economy, 99(3), 483–499.
            The Topography of the Spatial Economy                     32


Lucas, R. E., and E. Rossi-Hansberg (2003): “On the Internal Structure of Cities,”
 Econometrica, 70(4), 1445–1476.

Mantegazza, C., and A. Mennucci (2003): “Hamilton-Jacobi Equations and Distance
 Functions on Riemannian Manifolds,” Applied Mathematics and Optimization, 47(1), 1–26.

Matsuyama, K. (1999): “Geography of the World Economy,” CMS-EMS Discussion Paper
 1239, Presented as the Fukuzawa Lecture, Far Eastern Econometric Society Meeting at
 Singapore.

Melitz, M. J. (2003): “The Impact of Trade on Intra-Industry Reallocations and Aggregate
 Industry Productivity,” Econometrica, 71(6), 1695–1725.

Mémoli, F., and G. Sapiro (2001): “Fast Computation of Weighted Distance Functions
 and Geodesics on Implicit Hyper-surfaces,” Journal of Computational Physics, 173(2),
 730–764.

Michaels, G. (2008): “The effect of trade on the demand for skill: evidence from the
 Interstate Highway System,” The Review of Economics and Statistics, 90(4), 683–701.

Mitchell, J. (1988): “An Algorithmic Approach to Some Problems in Terrain Navigation,”
 Artificial Intelligence, 37(1), 171–201.

MPC (2011): “National Historical Information System: Version 2.0,” Minnesota Population
 Center, http://www.nhgis.org.

Nowosad, P. (1966): “On the integral equation kf equals l/f arising in a problem in com-
 munication,” Journal of Mathematical Analysis and Applications, 14, 484–492.

Peyre, G. (2009):     “Fast Marching Toolbox,” Matlab            Toolbox   available   at
 http://www.mathworks.com/matlabcentral/fileexchange/6110.

Polyanin, A., and A. Manzhirov (2008): Handbook of Integral Equations. Chapman &
 Hall/CRC.

Polyanin, A., and V. Zaitsev (2002): Handbook of exact solutions for ordinary differen-
 tial equations. Chapman & Hall/CRC.
            The Topography of the Spatial Economy                      33


Ramondo, N., A. Rodrı́guez-Clare, and M. Saborio-Rodriguez (2012): “Scale Ef-
 fects and Productivity Across Countries: Does Country Size Matter?,” mimeo, University
 of California, Berkeley.

Redding, S., and D. Sturm (2008): “The Costs of Remoteness: Evidence from German
 Division and Reunification,” American Economic Review, 98(5), 1766–1797.

Redding, S. J. (2012): “Goods Trade, Factor Mobility and Welfare,” mimeo.

Rosenthal, S. S., and W. C. Strange (2004): “Evidence on the nature and sources of
 agglomeration economies,” Handbook of regional and urban economics, 4, 2119–2171.

Rossi-Hansberg, E. (2005): “A Spatial Theory of Trade,” American Economic Review,
 95(5), 1464–1491.

Rossi-Hansberg, E., and M. L. J. Wright (2007): “Establishment Size Dynamics in
 the Aggregate Economy,” American Economic Review, 97(5), 1639–1666.

Sachs, J. (2001): “Tropical underdevelopment,” Discussion paper, National Bureau of Eco-
  nomic Research.

Sethian, J. (1996): “A Fast Marching Level Set Method for Monotonically Advancing
  Fronts,” Proceedings of the National Academy of Sciences, 93(4), 1591–1595.

Shorrocks, A. (2013): “Decomposition procedures for distributional analysis: a unified
  framework based on the Shapley value,” Journal of Economic Inequality, 11(1), 99–126.

Stock, J. H., and M. Yogo (2002): “Testing for weak instruments in linear IV regression,”
  .

Tsitsiklis, J. (1995): “Efficient Algorithms for Globally Optimal (seerajectories,” Auto-
 matic Control, IEEE Transactions on, 40(9), 1528–1538.

Zabreyko, P., A. Koshelev, M. Krasnosel’skii, S. Mikhlin, L. Rakovshchik, and
  V. Stetsenko (1975): Integral Equations: A Reference Text. Noordhoff International
  Publishing Leyden.
             The Topography of the Spatial Economy                          34


Tables and figures

                        Table 1: Estimated instantaneous trade costs
                                                           Implied trade
                              Estimate Standard error cost for a coast-to-coast trip
       Ocean                  1.03       0.162             180.8%
       River                  1.40       0.086             306.9%
       Interstate highways 0.53          0.010             70.1%
       Old highways           1.17       0.043             221.4%
       Mountains              1.44       0.785             320.2%
       Other land             1.03       0.028             179.8%
       Different state        0.48       0.005
Notes: This table reports the estimated instantaneous trade cost of traveling over six types
of locations as well as the estimated ad valorem cost of trading with other states. The
distance from coast to coast is normalized to one, so that ex − 1 is the total ad valorem trade
cost of traveling from coast to coast across locations with instantaneous trade costs x. The
estimation was done using a nonlinear least squares procedure to most closely match the
normalized state to state bilateral trade flows observed in the 2007 Commodity Flow Survey.
The elasticity of substitution (σ) is assumed to have a value of nine. The resolution of the
United States is 61 × 97 pixels.
                              Table 2: Estimating the strength of spillovers
                              (1)         (2)          (3)        (4)           (5)             (6)
Dependent variable:           ln Â(i)    ln Û (i)    ln Â(i)   ln Û (i)     ln Â(i)        ln Û (i)
Change in relative            0.459***    -0.339***    1.545***   -1.640***     0.350***        -0.336***
population density (ln L̂(i)) (0.008)     (0.008)      (0.085)    (0.093)       (0.019)         (0.019)
Constant                      0.237***    0.180***     0.495***   -0.129***     0.211***        0.181***
                              (0.008)     (0.007)      (0.025)    (0.028)       (0.010)         (0.009)
Identified parameter          α           β            α          β             α               β
Estimator                     OLS         OLS          2SLS       2SLS          LIML            LIML
Instrument                                                                      State-specific State-specific
                                                        ln P̂ (i)   ln P̂ (i)   ln P̂ (i)       ln P̂ (i)
First-stage F-stat                                      291.646 291.646         223.278         223.278
Observations                    13345      13345        13345       13345       13345           13345
       Notes: This figure shows the estimated strength of spillovers using the correlation between
       changes in the composite amenities and productivities and the change in the relative popu-
       lation density resulting from the construction of the U.S. Interstate Highway System. Each
       observation is a location in the United States; the resolution of the United States is 121×193.
       The instrument is the log difference between the price index in 1930 and what the price index
       would have been in 1930 if the Interstate Highway System had been in existence. Robust
       standard errors are reported in parentheses. Stars indicate statistical significance: * p<.10
       ** p<.05 *** p<.01.
                                                                                                                The Topography of the Spatial Economy
                                                                                                                      35
             The Topography of the Spatial Economy                        36


             Figure 1: Equilibria with endogenous amenities and productivity




Notes: This figure shows the regions of values for the productivity externality α and the
amenity externality β for which there exists an equilibrium, for which there exists a point-
wise locally stable equilibrium, and whether that equilibrium is unique. The elasticity of
substitutions σ is chosen to equal 4.
             The Topography of the Spatial Economy                         37


                      Figure 2: Propagation of geographic trade costs




Notes: This figure shows how the geographic trade costs evolve across a surface. Given a
contour of points on a surface such that the geographic trade cost to location i is equal to a
constant C (the solid line), for an arbitrarily small ε > 0, we can construct the contour line
for bilateral trade costs C + ε (the dashed line) by propagating the initial contour outwards
at a rate inversely proportional to the instantaneous trade cost.
             The Topography of the Spatial Economy                           38


                     Figure 3: Economic activity on a line: Trade costs




Notes: This figure shows how the equilibrium distribution of population along a line is
affected by changes in the trade cost. When trade is costless, the population is equal along the
entire line. As trade becomes more costly, the population becomes increasingly concentrated
in the center of the line where the consumption bundle is cheapest.
             The Topography of the Spatial Economy                        39


        Figure 4: Economic activity on a line: Exogenous productivity differences




Notes: This figure depicts how the equilibrium distribution of population along a line is
affected by exogenous differences in productivity across space. With homogeneous produc-
tivities, and positive trade costs, the population is concentrated at the center of the line.
When productivity is higher toward the right, the population concentrates in regions to the
right of the center of the line.
             The Topography of the Spatial Economy                           40


               Figure 5: Economic activity on a line: Productivity spillovers




Notes: This figure shows how the equilibrium distribution of population along a line is
affected by varying degrees of productivity spillovers. As the productivity spillovers increase,
the population becomes increasingly concentrated in the center of the line. A non-degenerate
equilibrium can be maintained as long as γ1 = 1 − α (σ − 1) − σβ > 0.
             The Topography of the Spatial Economy                        41


                Figure 6: Economic activity on a circle: Multiple equilibria




Notes: This figure provides an example of multiple equilibria when the surface is a one
dimensional circle. The left panel shows the unique homogeneous distribution of population
along the circle when α + β = 0. When α + β > 0 (here α = 0.01 and β = 0), uniqueness is
no longer guaranteed. In the case of the circle, there are uncountably many equilibria, each
of which has an increased concentration of population around a different point of the circle.
The right panel depicts two such equilibria.
             The Topography of the Spatial Economy                        42


  Figure 7: Estimating trade costs: Predicted versus observed state-to-state trade shares




Notes: This figure shows how well the model captures the variation in state-to-state normal-
ized trade shares observed in the 2007 Commodity Flow Survey given the estimated trade
costs. The green line is the 45 degree line.
            The Topography of the Spatial Economy                       43


              Figure 8: United States wages and population density in 2000




Notes: This figure shows the distribution of wages (measured as total payroll per capita)
and population density within the United States in the year 2000. The data are reported at
the county level and are normalized to have a unit mean. (Source: MPC (2011)).
            The Topography of the Spatial Economy                      44


    Figure 9: United States: Composite productivities and amenities in the year 2000




Notes: This figure shows the unique topography of log composite productivity (top panel)
and log composite amenities (bottom panel) consistent with the observed topography of
wages, population, and estimated bilateral trade costs in the year 2000.
             The Topography of the Spatial Economy                        45


                   Figure 10: United States: Instantaneous trade costs




Notes: This figure shows the estimated topography of instantaneous trade costs for the
United States. The top panel depicts the trade costs in 1930 (prior to the construction
of the interstate highways), the middle panel depicts the trade costs in 2000 (after the
construction of interstate highways) and the lower panel depicts the difference between the
two. The values of the instantaneous trade costs reported are the log bilateral trade cost
of traveling the width of the figure (e.g. an instantaneous trade cost of 4 indicates the ad
valorem tax equivalent trade cost of the width of the figure is e4 − 1).
             The Topography of the Spatial Economy                         46


                   Figure 11: United States: Trade costs from New York




Notes: This figure depicts the bilateral trade costs along the optimal routes from New York,
NY. The top panel reports the log bilateral trade costs in 1930 (prior to the construction of
the interstate highway system), the middle panel reports the log bilateral trade costs in 2000
(after the construction of the interstate highway system), and the bottom panel reports the
difference between the two.
            The Topography of the Spatial Economy                       47


             Figure 12: United States wages and population density in 1930




Notes: This figure shows the distribution of wages (measured as manufacturing and agricul-
ture output per capita) and population density within the United States in the year 1930.
The data are reported at the county level and are normalized to have a unit mean. (Source:
MPC (2011)).
            The Topography of the Spatial Economy                       48


              Figure 13: United States: Change in the population and wages




Notes: This figure shows the change in the relative wages and population density between
1930 and 2000. Wages and population density are normalized to have a unit mean in each
year and the change is measured as the log difference in the normalized values between the
two years. (Source: MPC (2011)).
             The Topography of the Spatial Economy                            49


        Figure 14: United States: Effect of the highway system on the price index




Notes: This figure shows the log difference in the calibrated price index in 1930 and the
counterfactual price index in 1930 holding fixed the calibrated amenities and observed wages
but changing the bilateral trade costs to allow for travel over interstate highways. As a result,
the figure shows the relative impact of the interstate highway system on different locations,
where a higher value (indicating a greater potential fall in the price index) indicates a greater
impact.
             The Topography of the Spatial Economy                        50


 Figure 15: United States: Topography of exogenous productivities and amenities in 1930




Notes: This figure topography of (log) exogenous productivities and amenities in the U.S. in
the year 1930 using the estimated α and β parameters governing the strength of productivity
and amenity spillovers. Both amenities and productivities are normalized to have a mean of
one.
             The Topography of the Spatial Economy                        51


 Figure 16: United States: Topography of exogenous productivities and amenities in 2000




Notes: This figure topography of (log) exogenous productivities and amenities in the U.S. in
the year 2000 using the estimated α and β parameters governing the strength of productivity
and amenity spillovers. Both amenities and productivities are normalized to have a mean of
one.
             The Topography of the Spatial Economy                        52


Figure 17: United States: Fraction of spatial inequality of income due to geographic location
in 1930




Notes: This figure shows the fraction of the observed variation in income across space in the
U.S. in the year 1930 that is due to geographic location. The decomposition is calculated
for all constellations of productivity spillover strength α ∈ [0, 1] and β ∈ [−1, 0] (except
for those sufficiently near the “black-hole” condition; see Figure 1). The star indicates the
estimated spillover strength using the construction of the interstate highway system.
             The Topography of the Spatial Economy                        53


Figure 18: United States: Fraction of spatial inequality of income due to geographic location
in 2000




Notes: This figure shows the fraction of the observed variation in income across space in the
U.S. in the year 2000 that is due to geographic location. The decomposition is calculated
for all constellations of productivity spillover strength α ∈ [0, 1] and β ∈ [−1, 0] (except
for those sufficiently near the “black-hole” condition; see Figure 1). The star indicates the
estimated spillover strength using the construction of the interstate highway system.
             The Topography of the Spatial Economy                        54


   Figure 19: United States: Predicted versus actual effect of IHS on population density




Notes: The top panel of this figure shows the observed change in the relative population
(measured in log differences) between the years 1930 and 2000. The bottom panel of the
figure shows the predicted change in the population (measured in log differences) as a result
of the construction of the Interstate Highway System.
             The Topography of the Spatial Economy                          55


         Figure 20: United States: Predicted versus actual effect of IHS on wages




Notes: The top panel of this figure shows the observed change in the relative wages (measured
in log differences) between the years 1930 and 2000. The bottom panel of the figure shows
the predicted change in the wages (measured in log differences) as a result of the construction
of the Interstate Highway System.
             The Topography of the Spatial Economy                          56


A       Appendix
This Appendix is composed of two subsections. In the first, we prove Theorems 1 and 2 and
Proposition 1 regarding the existence, uniqueness, and point-wise local stability of a spatial
equilibrium, as well as Theorem 3, regarding the identification of exogenous productivities
and amenities. In the second, we discuss the isomorphisms existing between our framework
and other spatial economic models.


A.1     Proofs of Theorems
In this section, we prove the theorems in the main text. The proofs rely heavily on results
from the study of integral equations, for which Zabreyko, Koshelev, Krasnosel’skii, Mikhlin,
Rakovshchik, and Stetsenko (1975) and Polyanin and Manzhirov (2008) are handy references.
The proofs of the theorems apply to compact intervals S ⊂ RN but for convenience we provide
references with results for connected and compact subsets of RN .

A.1.1    Proof of Theorem 1

Note that when α = β = 0, equation (11) can be written as:
                                             ˆ
                                 g (i) = λ       K (s, i) g (s) ds,                       (29)
                                             S


where g (i) ≡ L (i) w (i)σ in unknown, K (s, i) ≡ T (i, s)1−σ A (i)σ−1 u (s)σ−1 is known, and
λ ≡ W 1−σ is unknown. We can also re-write equation (12) in an identical form:
                                             ˆ
                                 f (i) = λ       K (i, s) f (s) ds,                       (30)
                                             S


where f (i) ≡ w (i)1−σ is unknown, K (i, s) ≡ T (s, i)1−σ u (i)σ−1 A (s)σ−1 is the transpose of
K (s, i) , and λ ≡ W 1−σ is unknown.
    Part (i) As mentioned in the text, equations (29) and (30) are eigenfunctions. Further-
more, because in both cases all components of the Kernel are continuous and bounded above
and below by a positive number, each kernel K (s, i) is also continuous and bounded above
and below by a positive number. As a result, by a generalization of Jentzsch’s theorem
(see e.g. Theorem 3 of Birkhoff (1957) where S is a Banach lattice or p.648 of Polyanin
                The Topography of the Spatial Economy                                     57


and Manzhirov (2008) where S is a connected interval of R.28 ), there exists a unique (to-
scale) strictly positive function g (i) and constant λ1 that solves equation (29) and a unique
(to-scale) strictly positive function f (i) and constant λ2 that solves equation (30).
    It remains to show that λ1 = λ2 . From one of the Fredholm Theorems (see Theorem
1.3 on p. 31 of Zabreyko, Koshelev, Krasnosel’skii, Mikhlin, Rakovshchik, and Stetsenko
(1975)29 ), because the kernel of equation (30) is the transpose of the kernel equation (29),
λ1 is a characteristic value of equation (30) and λ2 is a characteristic value of equation (29).
In addition, notice that the constants λ1 and λ2 correspond to the smallest characteristic
values of equations (29) and (30), respectively.30 Suppose that λ1 > λ2 , we will arrive at a
contradiction. In that case equation (30) has a characteristic value smaller than λ2 , which is
a contradiction of Jentzsch’s theorem. Similarly, we get a contradiction if we assume λ2 > λ1 .
Therefore, λ1 = λ2 , so that there exists unique (to-scale), strictly positive functions g (i) and
f (i) that solve equations (29) and (30). Because g (i) ≡ L (i) w (i)σ and f (i) ≡ w (i)1−σ ,
wages and the labor supply can be determined (up to scale) immediately from g (i) and f (i).
    To prove that the equilibrium is regular we need to argue that L (i) , w (i) are strictly
positive and continuous functions for all i. The proof that all regions are populated, and thus
L (i) , w (i) > 0, is given in the proof of Theorem 2 for any γ1 > 0 . The proof of continuity
is given in Part (ii) below.
    Part (ii) The solution of the wages and the labor, up to scale, is the uniform limit of
the successive approximation
                                                        ´
                                                           K (i, s) fn (s) ds
                                           fn+1 (i) = ´ ´S                      ,                          (31)
                                                       S S
                                                           K (i, s) fn (s) dsdi

as shown by Birkhoff (1957), starting from an arbitrary guess of the function f0 (i). In
practice, we find that the convergence of equation (31) is rapid for both f (i) and g (i).
                                                                                              1
Solving for equilibrium wages and the labor supply is then straightforward, as w (i) = g (i) 1−σ
                                 σ
                       f (i)g(i) σ−1
and L (i) = L̄ ´                 σ        . Note that once convergence occurs, the normalization identifies
                   S   f (s)g(s) σ−1 ds

  28
       Note that the compactness of S and the continuity of K (s, i) are sufficient but not necessary conditions
to apply Theorem 3 of Birkhoff (1957). Related to that, the boundeness of K (s, i) above and below by a
positive number is a stronger requirement than the linear transformation of K (s, i) is uniformly bounded.
   29
       Note that because λ1 is real, the complex conjugate of λ1 , λ̄1 , is equal to λ1 (and likewise for λ2 and
λ̄2 ).
   30
       See, for example, Krasnosel’Skii and Boron (1964) p.232. This statement derives from the results of
Theorems 2.11 and 2.13, p.78 and 81, with the required conditions on the kernel stated in Theorem 2.10,
page 76. The conditions require that the kernel is bounded above and below by a positive number, which
we have already assumed (see Theorem 2.2).
             The Topography of the Spatial Economy                                  58

                         ´              σ
W 1−σ , i.e. W 1−σ = L̄/ S f (s) g (s) σ−1 ds.
    Notice that if we start with a continuous guess f0 (i) the operator (31) is continuous and
thus {fn (i)}n∈N is a sequence of continuous functions. By the uniform convergence theorem
and the uniform limit result above the limit of this sequence is also continuous and thus
f (i) is also continuous. Since we proved that the equilibrium solutions are positive and
continuous, we proved that the equilibrium is regular, completing the proof of the theorem.
    Discrete number of locations Theorem 1 extends in straightforward manner to the
case of a discrete number of locations. The analogous result to Jentzsch’s theorem for matri-
ces – related to the case of a discrete number of locations – is the celebrated Perron-Frobenius
theorem (in fact, Jentzsch’s theorem is a generalization of Perron-Frobenius theorem, which
regards matrices and eigenvectors, for continuous kernels and eigenfunctions). The analo-
gous result to the Fredholm theorem is coming from the fact that for a square matrix its
eigenvalue is the same as the eigenvalue of its transpose. The matrix operator in this case
is ergodic in the sense that an iterative approach as the one in (31) converges to the true
solution. The algorithm in this case is the same as for the case of continuous variables.

A.1.2    Proof of Theorem 2

We first show that if there exists a regular spatial equilibrium, then equation (13) is the
unique relationship between w (i) and L (i) that satisfies equations (11) and (12). Suppose
there exists a regular spatial equilibrium, i.e. there exists continuous functions w (i) and
L (i) bounded above and below by positive numbers that satisfy equations (11) and (12).
Define the function φ : S → R+ as follows:

                                             L (i)1−α(σ−1) w (i)σ Ā (i)1−σ
                                   φ (i) ≡                                    .
                                             w (i)1−σ ū (i)1−σ L (i)β(1−σ)

Note that φ (i) is positive, continuous, and bounded above and below by strictly positive
numbers. Suppose too that T (i, s) = T (s, i). Then from equations (11) and (12) we have:
                          ´
                                  T (i, s)1−σ ū (s)σ−1 L (s)1+β(σ−1) w (s)σ ds
                 φ (i) = ´    S
                                                                                   ⇐⇒
                                  T (s, i)1−σ Ā (s) σ−1 w (s)1−σ L (s)α(σ−1) ds
                           ´
                           S
                                   F (s, i)φ (s)β ds
                 φ (i) = ´     S
                                                       ,                                   (32)
                           S
                             F (s, i)φ (s)β−1 ds
              The Topography of the Spatial Economy                                        59


where F (s, i) ≡ T (i, s)1−σ ū (s)(1−β)(σ−1) Ā (s)β(σ−1) L (s)1+β(σ−1)+β((α−β)(σ−1)−1) w (s)σ+β(1−2σ)
and we use the assumed symmetry of trade costs, i.e. T (i, s) = T (s, i). Note that F (s, i)
is positive, continuous, and bounded above and below by strictly positive numbers. We can
then write (32) as

                                       φ (i)β                        φ (i)β−1
                              ´                           =´                           .              (33)
                               S
                                 F (s, i)φ (s)β ds             S
                                                                 F (s, i)φ (s)β−1 ds

                      φ(i)β
Define γ (i) ≡   ´            β   .   Note that because φ (i) is positive, continuous, and bounded
                 S F (s,i)φ(s) ds

above and below by strictly positive numbers, so too is γ (i). Define functions g1 (i) ≡ φ (i)β
and g2 (i) ≡ φ (i)β−1 . Then we can rewrite equation (33) as the following set of equations:
                                                  ˆ
                                       g1 (i) =        λ(i)F (s, i)g1 (s)ds                           (34)
                                                  ˆS
                                       g2 (i) =        λ(i)F (s, i)g2 (s)ds                           (35)
                                                   S


Because λ (i) F (s, i) is positive, continuous, and bounded above and below by strictly posi-
tive numbers, the generalized Jentzsch theorem implies that there exists a unique (to-scale)
strictly positive function that satisfies both equations (34) and (35), i.e. g1 (i) = Cg2 (i),
where C is a constant. As a result, φ (i)β = Cφ (i)β−1 , or equivalently, φ (i) = C. Substitut-
ing in the definition of φ (i) into φ (i) = C immediately yields equation (13). Hence equation
(13) is the unique relationship between w (i) and L (i) that satisfies equations (11) and (12)
for a regular spatial equilibrium.
    Since equation (13) holds for any regular equilibrium, it is sufficient to consider it along
with equation (14) to determine existence and uniqueness of a regular equilibrium rather
than equations (11) and (12) directly. Note that we can rewrite equation (14) as a nonlinear
integral equation                           ˆ                           γ2
                                       f (i) = λ          K (s, i) f (s) γ1 ds,                       (36)
                                                      S

where f (i) ≡ L (i)γ1 , λ = W 1−σ , and

           K (s, i) ≡ ū (i)(1−eσ)(σ−1) Ā (i)σe(σ−1) T (s, i)1−σ Ā (s)(1−eσ)(σ−1) ū (s)σe(σ−1) .

In fact, instead of characterizing (36) it suffices to find the solution for the combined variable
                The Topography of the Spatial Economy                                          60

                     1
                 γ
                 2
fe(i) = f (i) λ γ1 −1 . To see this, notice that
                                                ˆ           h     i γγ2
                                   fe(i) =                    ˜
                                                    K (s, i) f (s) 1 ds ⇐⇒                                   (37)
                                                S
                                          1         ˆ                         1
                                                                                    γγ2
                                        γ2                                   γ2        1
                                        γ1 −1                                   −1
                              f (i) λ           =           K (s, i) f (s) λ γ1          ds,
                                                    S


which is equivalent to (36). In our case f (i) ≡ L (i)γ1 and the labor market clearing con-
straint implies
                                                                    ˆ
                                                              1
                                                    −γ
                                          L̄ = λ            2 −γ1       fe(s)1/γ1 ds,                        (38)
                                                                    S


and thus, for each solution for fe(s), a unique solution for λ.31 Therefore, finding a solution
for fe(i) gives us the solution for f (i) and the eigenvalue of the system λ, which in our case is
inversely related to welfare. Given the above preliminaries we proceed to prove the different
parts of Theorem 2.
    Part (i) We first prove existence of a regular spatial equilibrium. To do so we can
directly use Theorem 2 of Karlin and Nirenberg (1967) to establish existence for Equation
(36). Their Theorem 2 shows the existence of a continuous solution f (i) for a Hammerstein
equation of the second kind
                                                    ˆ
                                    f (i) = λ               K (s, i) φ (s, f (s)) ds,
                                                        S


where φ is a continuous function and where the bounds of integration are given by the min
and the max of K (s, i) /F (K (., i)) with F (K (., i)) an arbitrary linear functional such that
F (f ) = 1 and F (K (·, s)) > 0 for all s ∈ S. Furthermore, the solution f (i) is bounded
below by a ≡ mini,s∈S F K(i,s)
                         (K(·,s))
                                   > 0 and bounded above by b ≡ maxi,s∈S F K(i,s)
                                                                             (K(·,s))
                                                                                      > 0. For our
                                γ2                ´         1
purposes, φ (s, f (s)) = f (s) γ1 and F (f ) ≡ L̄1 S f (s) γ1 ds. Note both that F (f ) = 1 from
                                              ´          1
labor market clearing and F (K (·, s)) = L̄1 K (i, s) γ1 ds > 0 for all s ∈ S since K (s, i) is
bounded above and below by a positive number, so the theory applies. Note too that for
Karlin and Nirenberg (1967) S = [0, 1]. However, as they point out, and as is easily verified
  31
    Using the latest formulation it is easy to show that increasing L̄ does not affect the distribution of labor
across locations. In particular, an increase in L̄ does not affect fe(i) , given equation (37), and thus translates
only to a change in overall welfare, λ = W 1−σ , but not to a change in the distribution of labor across
locations.
               The Topography of the Spatial Economy                                             61


from the steps of the proof of their Theorem 2, their result applies for any domain in RN
and, thus, for a compact interval, which completes the proof of existence.32
    Part (ii) To prove that for γ1 > 0 all equilibria are regular notice that we need to prove
that all locations are inhabited in equilibrium and that the equilibrium wages and labor
functions are continuous. For the first part notice that if γ1 > 0 expression (7) guarantees
that every location is populated: the utility of moving to an uninhabited location is infinite.
To show that every equilibrium is continuous, we need to prove that for any  > 0 there exists
a δ > 0 such that ks1 − s2 k < δ implies that that f˜ (s1 ) − f˜ (s2 ) < , i.e. f˜ is continuous,
and thus f is continuous. Assume that we have an equilibrium with every location population
and a resulting eigenvalue λ, we will establish continuity. Note first that K (s, i) is assumed
to be continuous and S is compact, so that by the Heine-Cantor theorem, K (s, i) is uniformly
continuous on S. Then for any  > 0 there exists a δ > 0 so that ks1 − s2 k < δ implies
|K (s, s1 ) − K (s, s2 )| <  with s1 , s2 ∈ S. Suppose ks1 − s2 k < δ. Then we have:
                                                ˆ                                           γ
                                                                                          2
                      f˜ (s1 ) − f˜ (s2 ) =             (K (s, s1 ) − K (s, s2 )) f˜ (s) γ1 ds
                                               ˆ    S
                                                                                        γ 2
                                           ≤            |K (s, s1 ) − K (s, s2 )| f˜ (s) γ1 ds
                                                    ˆ
                                                    S
                                                                  γ
                                                         2
                                           ≤    f˜ (s) γ1 ds
                                              Sˆ             γ2
                                                            1
                                           ≤        ˜
                                                    f (s) ds
                                                           γ1
                                                                  |S|1−γ2
                                                         S
                                                             γ2
                                           ≤ L̄ λ γ2 −γ1 |S|1−γ2
                                                    γ2



where the second to last line used Holder’s inequality, the last line used equation (38), and
       ´
|S| ≡ S ds. Hence for any  > 0, we can choose a δ > 0 such that ks1 − s2 k < δ implies that
|K (s, s1 ) − K (s, s2 )| <   γ2
                                
                                       and thus f˜ (s1 ) − f˜ (s2 ) < , establishing continuity.
                            L̄γ2 λ γ2 −γ1 |S|1−γ2
    Part (iii) We now prove uniqueness of a regular equilibrium when | γγ21 | ≤ 1.
    We already discussed the case γ2 = γ1 (which would occur if α + β = 0).
    Next suppose instead that | γγ12 | < 1. In this case, we can apply Theorem 2.19 from
Zabreyko, Koshelev, Krasnosel’skii, Mikhlin, Rakovshchik, and Stetsenko (1975) (p.401),
which states that if i) K (i, s) is positive and continuous and ii) fe(s) is strictly positive and
it is non-decreasing and fe(s) /sc is non-increasing for c ∈ (0, 1) or it is non-increasing and
  32
    The proof involves constructing a compact operator that maps the convex set of all continuous functions
f (s) into itself and consequently applying Schauder’s fixed point theorem. These steps do not depend on
the domain of the integration.
              The Topography of the Spatial Economy                                62


fe(s) sc is increasing for c ∈ (0, 1) then there there exists a unique positive solution to equation
(37). Furthermore, that solution is the uniform limit of the successive approximations:
                                               ˆ                   γ 2
                                 fen+1 (i) =       K (s, i) fen (s) γ1 ds.                        (39)
                                               S


for any arbitrary non-zero, non-negative fe0 (i) .33 Notice that i) is satisfied given the restric-
                             γ2
tions on K (i, s) and fe(s) γ1 satisfies ii) and in particular with γγ12 ∈ [0, 1), the first condition
or with γγ21 ∈ (−1, 0) the second condition. Thus, there exists a unique positive function fe(i)
that solves (37) and uniqueness is proved when | γγ21 | < 1
    Finally, assume that γγ12 = −1. For this case Remark 1 of Karlin and Nirenberg (1967)
implies that as long as K (s, i) continuous, non-negative and K (i, i) > 0, there exists a
unique continuous and positive function f (i) that satisfies (36) for γγ21 = −1, in the case of
S = [0, 1]. Their argument for uniqueness trivially extends to any compact subset of S of
RN .
    Discrete number of locations The uniqueness proof for Theorem 2 also applies to
the case of a discrete number of locations for γ2 /γ1 ∈ (0, 1]. Fujimoto and Krause (1985)
show that any operator T that is strictly increasing and satisfies T (λx) = f (λ) T (x) with
f : R+ → R+ such that f (λ) /λ is non-increasing and f (0) = 0, has a unique positive solution
                                                                             X                   γ2
and is strongly ergodic. Our operator in the discrete case is T (f ) =            K (s, i) f (s) γ1 and
                                                                               s
γ2 /γ1 ∈ (0, 1] all these restrictions on the operator are satisfied, proving the result.

A.1.3    Proof of Proposition 1

Consider a regular equilibrium satisfying equations (13) and (14). Taking the derivative of
welfare in location i with respect to the population in location i from equation (7) yields:
                       ´                             σ1                             
                                  1−σ
          dW (i)   γ1     T (i, s)    w (s) L (s) ds            σ−1             γ1
                 =−  S                                   Ā (i) σ ū (i) L (i)− σ −1  ,
          dL (i)   σ                P (i)

  33
     Notice that there is a typo in the statement of the second condition of Theorem 2.19 in Zabreyko,
Koshelev, Krasnosel’skii, Mikhlin, Rakovshchik, and Stetsenko (1975). A statement of the Theorem for a
connected compact interval in R is given by Polyanin and Manzhirov (2008) p. 831.
             The Topography of the Spatial Economy                                                   63

                                                                                 ´                             1
                                                                             (       S   T (i,s)1−σ w(s)L(s)ds) σ
since changes in the population in location i do not affect                                       P (i)
                                                                                                                    because
location i has zero measure. As a result:
                                            
                                     dW (i)
                              sign             = −sign (γ1 ) .
                                      dL (i)

From the definition of point-wise local stability, it immediately follows that if γ1 < 0, the
equilibrium is point-wise locally stable and if γ1 > 0 the equilibrium is point-wise locally
stable, thereby proving the Proposition.

A.1.4    Proof of Theorem 3

Substituting equation (25) into equation (24) yields:
                                       ˆ
                       1−σ     W 1−σ
               u (i)         =             T (s, i)1−σ w (i)σ−1 w (s)σ L (s) u (s)σ−1 ds.                              (40)
                                φ      S

                                                                       W 1−σ
Define the functions f (i) ≡ u (i)1−σ and K (s, i) ≡                     φ
                                                                             T   (s, i)1−σ w (i)σ−1 w (s)σ L (s).
Then equation (40) can be rewritten as:
                                                 ˆ
                                                                   1
                                       f (i) =        K (s, i)         ds.                                             (41)
                                                  S              f (s)

Equation (41) arises in models of signal theory and was first studied by Nowosad (1966) in
the case that K (s, i) is symmetric and S = [0, 1]. Since this equation is essentially the same
as equation (37) when γ2 /γ1 = −1 the argument for uniqueness in Theorem 2 directly applies
here. In particular, note that because w, L, and T are continuous and bounded above and
                                            1−σ
below by strictly positive numbers and W φ is strictly positive, the kernel K is continuous
and K (i, i) > 0 for all i ∈ S. As a result, we can apply Theorem 2 and Remark 1 of Karlin
and Nirenberg (1967) to equation (41), which imply that there exists a unique continuous
positive function u (i) satisfying equation (40) for any connected compact subspace of RN .
The continuous and positive function A can then be determined using equation (41). Note
that A and u are only identified up to scale, as the constants φ and W offset any changes in
the normalizations of A and u, respectively.
             The Topography of the Spatial Economy                         64


A.2     Isomorphism of the perfect competition and the monopolistic
        competition environments
We study two separate types of isomorphisms of our elementary gravity model with labor
mobility to richer gravity trade models. First, we show that our main setup can be shown
to be isomorphic to the class of gravity trade models considered by Arkolakis, Costinot, and
Rodrı́guez-Clare (2012) if an equilibrium with labor mobility is considered in that setup.
Second, we show that our setup is isomorphic to a new economic geography model as in
Krugman (1991), but when an inelastic supply of housing (amenity) is introduced, as in
Helpman (1998). Finally, we show an isomorphism to a gravity model where workers have
idiosyncratic utility shocks for each location. In all these exercises we consider a surface S
with a continuum of locations.
    Gravity models Arkolakis, Costinot, and Rodrı́guez-Clare (2012) consider gravity trade
models with exogenous entry and free entry. Models with exogenous entry include Eaton and
Kortum (2002), Chaney (2008)-Melitz (2003), and of course, the Armington (1969) setup.
The gravity trade relationships and the labor market clearing conditions of these models are
very similar. As long as the models are set to have the same bilateral trade costs, popula-
tion, and also the elasticity of trade is set to the same value, their technology parameters
can be adjusted so that they are formally isomorphic. This elasticity of trade parameter is
the Frechet curvature parameter in Eaton and Kortum (2002), the Pareto curvature param-
eter in Chaney (2008)-Melitz (2003), and the CES demand elasticity in Armington (1969).
Given this formal isomorphism, introducing labor mobility simply extends the isomorphism
to a labor mobility equilibrium, as we have introduced in the main text with exogenous
productivities and amenities.
    The isomorphism carries on in the case of models with free entry, but allowances have to
be made in order for a non-degenerate equilibrium to emerge. Models of free entry analyzed
by Arkolakis, Costinot, and Rodrı́guez-Clare (2012) include Krugman (1980), and the Melitz
(2003) model with Pareto distributed productivities considered by Arkolakis, Demidova,
Klenow, and Rodrı́guez-Clare (2008). The assumption of free entry implies that firms need
to hire f e units of local labor to produce a unique differentiated variety in a location, and
in the resulting equilibrium the number of entrants is proportional to population, Ni ∝ Li .
When labor is allowed to move, it is straightforward to show that our setup with production
externalities and α = 1/ (σ − 1) is isomorphic to the free entry models discussed above.
Unfortunately, α = 1/ (σ − 1) and β = 0 =⇒ γ1 = 0, and the only equilibrium is a “black-
             The Topography of the Spatial Economy                                        65


hole” equilibrium where all production concentrates in one location. For a non-degenerate
equilibrium to arise, the production externality needs to be less strong, which corresponds to
allowing a negative production externality in the Arkolakis, Costinot, and Rodrı́guez-Clare
(2012) setup with free entry, and respectively setting α < 1/ (σ − 1) in our model.
    Gravity models with two sectors A formal isomorphism can be derived with the
Helpman (1998)-Redding (2012) setup. That setup assumes that workers spend a constant
share γ of their income on differentiated goods and a share 1 − γ to local non-tradable goods
(often referred to as “housing”). A preference structure that gives rise to this is a monotonic
transformation of a Cobb-Douglas aggregator with a coefficient one on the differentiated
goods and (1 − γ) /γ on housing. The differentiated sector is as in Krugman (1980) and
Krugman (1991) while earnings from land are equally divided by workers residing in that
location. In equilibrium with labor mobility, a constant share of income is earned from wages
and rents. To formally map this model to our setup we need to set α = 1/ (σ − 1) and also
β = − (1 − γ) /γ. For the equilibrium to be unique we require that

                                                    1 + (γ − 1) (σ)
                             α + β ≥ 0 ⇐⇒                           ≥0
                                                       γ (σ − 1)

This condition is discussed as a sufficient condition for the existence mobility equilibrium in
an N -location world, in Redding (2012). In fact, Theorem 2 implies that this condition is
sufficient for a unique labor mobility equilibrium in our setup, while the sufficient conditions
for existence are weaker. It is easy to check the rest of the parts of the isomorphism, i.e.
that the gravity relationship of trade is exactly the same and the trade balance condition
is the same. Notice that similar isomorphisms can be derived if other free entry setups are
considered instead of the Krugman (1980) one.
    Worker Heterogeneity We now build a formal isomorphism to a model where workers
have idiosyncratic utility shocks in each location. Notice that this isomorphism holds for any
finite number of locations. Suppose that a worker ω receives welfare U (i, ω) from living in
location i ∈ S, where:
                                     ˆ                           σ
                                                                σ−1
                                                    σ−1
                        U (i, ω) =          q (s)    σ    ds           u (i) υ (i, ω) ,
                                      s∈S


and υ (i, ω) is distributed i.i.d. Frechet across people and locations with shape parameter
                            −θ
θ, i.e. P r [υ ≤ u] = e−u . If workers choose to live in the location with their highest
idiosyncratic utility, then for any two locations i, s ∈ S, the ratio of the population densities
              The Topography of the Spatial Economy                                   66


can be written as a function of the non-idiosyncratic welfare:
                                       θ
                          w(i)
             L (i)        P (i)
                                u (i)           w (i)              1   w (s)              1
                   =                   θ ⇐⇒         u (i) L (i)− θ =       u (s) L (s)− θ .
             L (s)    w(s)                      P (i)                  P (s)
                        P (s)
                                u (s)

Since u (i) = ū (i) L (i)β , the above condition is isomorphic to the utility equalization condi-
tion presented in the main text with the alternative β̃ = β − 1θ . Hence, adding heterogeneous
worker preferences simply creates an additional dispersion force.
