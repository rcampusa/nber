                                 NBER WORKING PAPER SERIES




      NONPARAMETRIC IDENTIFICATION AND ESTIMATION OF NONADDITIVE
                           HEDONIC MODELS

                                          James J. Heckman
                                           Rosa L. Matzkin
                                            Lars Nesheim

                                         Working Paper 15226
                                 http://www.nber.org/papers/w15226


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     August 2009




This research was supported by NSF grants SES-0241858 and BCS-0433990. Lars Nesheim also thanks
the Leverhulme Trust and the UK Economic and Social Research Council (ESRC grant RES-589-28-0001)
for support through its funding of the Centre for Microdata Methods and Practice(http://www.cemmap.ac.uk).
Rosa L. Matzkin research has been supported also by NSF grant SES-0551272. We thank the participants
of seminars at Northwestern University, Universidad de San Andres, Princeton University, Harvard/MIT,
UCLA/USC, University of California at Berkeley, University of Minnesota, the Bureau of Labor Statistics,
University of Chicago, Universidad Di Tella, the 2002 Workshop on Characteristics Models: Theory
and Applications (University of Copenhagen), the 2002 Workshop on Mathematical Economics (IMPA),
and the 2004 Banff International Research Station (BIRS) workshop on "Mathematical Structures
in Economic Theory and Econometrics" for their useful comments. We thank Myrna Wooders and
Daniel McFadden for many stimulating conversations, and Donald J. Brown for specific comments.
The views expressed herein are those of the author(s) and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2009 by James J. Heckman, Rosa L. Matzkin, and Lars Nesheim. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
Nonparametric Identification and Estimation of Nonadditive Hedonic Models
James J. Heckman, Rosa L. Matzkin, and Lars Nesheim
NBER Working Paper No. 15226
August 2009
JEL No. C14,D41,D58

                                             ABSTRACT

This paper studies the identification and estimation of preferences and technologies in equilibrium
hedonic models. In it, we identify nonparametric structural relationships with nonadditive heterogeneity.
We determine what features of hedonic models can be identified from equilibrium observations in
a single market under weak assumptions about the available information. We then consider use of
additional information about structural functions and heterogeneity distributions. Separability conditions
facilitate identification of consumer marginal utility and firm marginal product functions. We also
consider how identification is facilitated using multimarket data.


James J. Heckman                                    Lars Nesheim
Department of Economics                             Department of Economics
The University of Chicago                           University College London
1126 E. 59th Street                                 Gower Street
Chicago, IL 60637                                   London WC1E 6BT
and NBER                                            United Kingdom
jjh@uchicago.edu                                    l.nesheim@ucl.ac.uk

Rosa L. Matzkin
Department of Economics
University of California, Los Angeles
8283 Bunche Hall
Mail Stop 147703
Los Angeles CA 90095
matzkin@econ.ucla.edu
1       Introduction
How much are consumers willing to pay for increased product quality? What wage premium
do workers require to compensate them for an increase in on-the-job fatality risk? How
much are homeowners willing to pay to avoid moving one mile further from work? What
will be the e¤ect of new clean air legislation on real estate prices? Hedonic models provide
information that helps to narrow the range of possible answers to these questions. In an
hedonic market, the price function for a good or service decomposed into its attributes
measures the equilibrium relationship between attributes of the good and the price at which
buyers and sellers are willing to trade. It is the price that equates supply and demand in
the space of hedonic attributes. It provides an exact measure of the marginal willingness to
pay and willingness to accept for equilibrium transactions in a market. However, in general,
the equilibrium price function does not identify the willingness to pay for counterfactual
transactions that might occur in markets characterized by di¤erent endowments, technology
and preferences. Due to unobserved heterogeneity, there is a selection problem.1 To take a
labor market example, workers who choose to work in jobs with a low fatality risk are likely
to have low unobserved tolerance for risk. As a result, the compensation they require to
accept more risk is likely to be higher than the equilibrium wage premium for risky jobs.
To identify willingness to pay and willingness to accept for counterfactual transactions, one
needs to identify the structural parameters of buyers and sellers.
    Knowledge of the hedonic price function alone is not enough to analyze general equi-
librium e¤ects of policy changes in hedonic markets. When supply or demand conditions
change, buyers and sellers will in general alter how they sort in hedonic markets. Hence,
to analyze general equilibrium changes in hedonic markets, it is necessary to identify the
structural parameters.2
    Observed and unobserved heterogeneity play key roles in hedonic equilibrium sorting
models. In particular their distributions and the underlying utility and production functions
of the agents shape equilibrium sorting outcomes and shape how a hedonic economy will
react to changes in the economic environment. Previous studies of hedonic markets have an-
alyzed either parametric or restrictive nonparametric utility and production functions, where
the unobserved heterogeneity is speci…ed as a term added to marginal utility or marginal
product functions.3 Ekeland, Heckman and Nesheim (2004) analyze nonparametric hedonic
    1
      See, e.g., Rosen (1974).
    2
      See, e.g., Hurwicz (1962) or, for a more modern statement, Heckman and Vytlacil (2007).
    3
      For analysis of identi…cation of parametric hedonic models, see Brown and Rosen (1982), Brown (1983),


                                                     1
models with additive marginal utility and additive marginal product functions. They show
that hedonic models with additivity restrictions are nonparametrically identi…ed with single
market data and present two methods for recovering the structural functions in such models.
    The additivity assumptions used to establish identi…cation in Ekeland, Heckman, and
Nesheim (2004) are strong. No heterogeneity in the curvature of production and preference
functions is allowed. In addition, these restrictions are over-identifying.
    In contrast, this paper establishes nonparametric identi…cation of structural functions and
distributions in general hedonic models without imposing additivity. We allow the curvature
of the marginal utility for the product attribute, as well as the distribution of the marginal
utilities, to vary in general ways across agents with di¤erent observed characteristics. We
allow an analogous property to hold for nonadditive unobserved heterogeneity in marginal
product functions on the supply side of the market.
    We …rst analyze what can be identi…ed in an unrestricted model …t using data from
a single market that satis…es standard economic regularity conditions and additional mild
statistical regularity conditions. We then restrict the functional structure of the marginal
utilities and marginal product functions, obtaining nonparametric generalizations of random
coe¢ cient and household scale models. We show that in these cases, the marginal utility and
marginal product functions, as well as the distribution of the unobserved characteristics of the
agents, are identi…ed. Our proofs of identi…cation are constructive and suggest nonparametric
estimation strategies whose properties we examine in a web appendix.4
    We go on to show that models that cannot be identi…ed in a single cross section are
identi…ed using data from multiple markets. This follows from the economics of the hedonic
model. In general, variation in the distributions of observed variables across markets induces
cross-market variation in price functions. This part of our analysis formalizes and extends
discussions in Rosen (1974), Brown and Rosen (1982), Epple (1987) and Kahn and Lang
(1988).
    To focus on the key identi…cation problems that arise in a setup where marginal utilities
are nonadditive in unobserved heterogeneity, we concentrate on an hedonic model with a
single product characteristic. Our main results can be extended to hedonic models with
multiple characteristics captured by an index structure, as in Epple and Sieg (1999) and
Sieg, Smith, Banzhaf, and Walsh (2004). Our methodology extends the two stage method of
Rosen (1974) to a nonparametric setting. The …rst stage estimates the hedonic function and
Epple (1987), Bajari and Benkard (2005), or Berry and Pakes (2007).
  4
    See Web Appendices D and F at http://jenni.uchicago.edu/nonpara_hedonic



                                               2
its derivatives. Using the estimated price function together with the …rst order conditions of
the agents identi…es production and utility functions.
    This paper proceeds in the following way. Section 2 describes the hedonic model for a
product with a single attribute. Section 3 studies the identi…cation of nonadditive marginal
utility and nonadditive marginal product functions. Section 4 analyzes identi…cation in
multiple markets. Analog estimators are discussed in Section 5. Their properties are derived
in the web appendix (see http://jenni.uchicago.edu/nonpara_hedonic) for this paper.
The web appendix also presents a limited Monte Carlo analysis. Section 6 summarizes and
discusses possible extensions.


2       The Competitive Hedonic Equilibrium Model
The model analyzed in this paper applies to a spot market in which products are di¤eren-
tiated by their attributes, prices are set competitively and participating buyers and sellers
each trade a single type of product chosen from a set of feasible products. Our analysis of
demand in this section, and in Section 3, applies equally to hedonic demand estimation prob-
lems in imperfectly competitive markets where consumers are fully informed price takers.
The multi-market analysis in Section 4 can readily be adapted to study demand in imper-
fectly competitive markets as long as there is su¢ cient cross-market variation in market
structure to induce price variation. We focus on competitive markets for ease of exposition.
    To …x ideas, we consider a labor market setting in which jobs are characterized by their
attributes. Workers (sellers) match to single employee …rms (buyers) and supply job services
indexed by a scalar z where z 2 Z:  e 5 We assume that Ze      R is compact. The space Ze is
the space of technologically feasible job attributes. The variable z denotes a job attribute
assumed to be a disamenity for the workers and an input for the …rms. For example, z could
measure the probability of injury on the job as in Kniesner and Leeth (1995) or Leeth and
Ruser (2003), so Ze = [0; 1] : Let P (z) be a twice continuously di¤erentiable price function
de…ned on Z.e The value of P (z) is the wage paid at a job characterized by attribute z:
    Each worker has quasilinear utility function P (z) U (z; x; ") where x is a vector of
    5
    If jobs are characterized by a vector of attributes a 2 Ae Rn ; we assume that preferences and costs
depend on a only through the scalar index z = g (a). We discuss identi…cation of a single index model in
Section 3. Alternatively, if utility is quasilinear and both utility and production functions are additively
separable functions of z and other attributes, the price function will be as well and the market for z can be
analysed independently of the other attributes.




                                                     3
observed characteristics of dimension nx and " is a scalar unobserved heterogeneity term.6
Observe that U ( ) is a disutility. " is statistically independent of x: In the risk of injury
example, " is interpreted as the component of unobserved preference for risk that is inde-
pendent of observables such as age, education, gender, race, etc. Note that since " is allowed
to enter marginal utility Uz in a nonadditive way, the independence assumption is much
weaker than it would be if " entered additively. In particular, the nonadditive speci…cation
is consistent with a model where Uz is a function of an unobserved = m(x; "), whose dis-
tribution depends on the vector of observed characteristics, x, of the agent. The population
of workers is described by the pair of density functions fx and f" , which are assumed to be
strictly positive on the compact sets Xe    Rnx and E   e R, respectively. Each worker may
choose not to trade, in which case they obtain reservation utility V0 .
    Each …rm has a production function (z; y; ) where y is a vector of observed charac-
teristics of the …rm of dimension ny and is a scalar unobserved heterogeneity term. We
assume that is statistically independent of y, and that (y; ) is independent of (x; "). The
population of …rms is described by the pair of density functions fy and f that are strictly
positive on the compact sets Ye     Rny and H  e     R, respectively. If a …rm opts out of the
market, it earns reservation pro…ts 0 .
    Both U and are assumed to be twice continuously di¤erentiable with respect to all
arguments.7 Additionally, we assume that, given the equilibrium price function, each worker
and …rm that participates has a unique interior optimum. A su¢ cient condition for this
to hold is a Spence-Mirrlees type single-crossing condition, requiring that Uzz        zz > 0;

Uz" < 0, and z >, for all (x; "; y; ), be satis…ed.8 For simplicity, we assume that these
conditions are satis…ed.
    Each worker chooses z 2 Z; e a job type or a location in the space of job attributes, to
maximize
                                     P (z) U (z; x; ") :

From uniqueness of the optimum, it follows from Gale and Nikaido (1965) that there exists
   6
     When utility is not quasilinear, we can identify the ratio of the marginal utility of z to the marginal
utility of income (See Web Appendix B.).
   7
     The equilibrium analysis can be extended to cases in which z is a vector, the arguments of the functions
are discrete, the measures on characteristics are not absolutely continuous with respect to Lebesgue, or the
functions are not di¤erentiable. See Ekeland (2005) or Chiappori, McCann, and Nesheim (2008) for details.
   8
     See Chiappori, McCann, and Nesheim (2008) for details.




                                                     4
a supply function z = s(x; ") such that

                                 Pz (s(x; "))     Uz (s(x; "); x; ") = 0:              (2.1)

By the Implicit Function Theorem,

                             @s(x; ")           Uz" (s(x; "); x; ")
                                      =                                                (2.2)
                               @"       Pzz (s(x; ")) Uzz (s(x; "); x; ")

so that @s(x;")
          @"
                > 0 since Uz" < 0 and the denominator is negative from the assumption of an
interior optimum. Our assumptions imply that s(x; ") is strictly monotonic in " and that its
inverse with respect to " exists. We denote the inverse supply function by " = se (z; x).
    A parallel analysis can be performed for the demand side of the market. Each …rm
chooses z 2 Ze to maximize the pro…t function

                                              (z; y; )       P (z):

      The resulting demand function z = d(y; ) satis…es

                                   z (d(y;   ); y; )       Pz (d(y; )) = 0;

and
                             @d(y; )            z (d(y; ); y; )
                                     =
                               @       Pzz (d(y; ))    zz (d(y; ); y; )

so that @d(y;
          @
              )
                > 0 since z > 0 and the denominator is positive. We denote the inverse
demand function = de(z; y) :
    The inverse supply and demand functions characterize equilibrium.9 Let
                           n                                                      o
                       Zs = z 2 Ze z = s (x; ") for some (x; ") 2 X
                                                                  e           e
                                                                              E

be the range of the mapping s (x; ") : Using a standard change of variables formula, the
density of supply implied by the inverse supply function is
                                  Z
                                                               @e
                                                                s (z; x)
                                        f" (e
                                            s (z; x)) fx (x)             dx            (2.3)
                                    e
                                    X                             @z
  9
      See Ekeland, Heckman, and Nesheim (2004).




                                                       5
for z 2 Zs : For z 2 Ze n Zs ; the density of supply is zero.
    Analogously, let
                         n                                                      o
                     Zd = z 2 Ze z = d (y; ) for some (y; ) 2 Ye            e
                                                                            H

be the range of the mapping d (y; ) : The density of the demanded z is
                                 Z
                                                            @ de(z; y)
                                        f   de(z; y) fy (y)            dy                      (2.4)
                                   Ye                           @z

for z 2 Zd : For z 2 Ze n Zd ; the density of demand is zero. Both inverse supply and inverse
demand depend on P (z) although the dependence is implicit.
    Among the set of smooth price functions that yield unique interior optima, an equilibrium
price function must satisfy the condition that the density of supply equals the density of
demand for all values of z 2 Z. e Making explicit the dependence of the supply and demand
densities on P , this condition requires that Zs = Zd and that
 Z                                                       Z
                                @e
                                 s (z; x; P (z))                                @ de(z; y; P (z))
    f" (e
        s (z; x; P (z))) fx (x)                  dx =    de(z; y; P (z)) fy (y)
                                                             f                                    dy
  e
  X                                   @z           Ye                                  @z
                                                                                                (2.5)
for all z 2 Zs \ Zd , where P (z) is the price function. The equilibrium price function solves
this equation.


2.1    Properties of Equilibrium
Ekeland (2005) and Chiappori, McCann, and Nesheim (2008) show that an equilibrium exists
in the hedonic model under very general conditions which include those given in the previous
section. They also show that the single-crossing property presented in the previous section
is su¢ cient for equilibrium to be unique and pure in the sense that each worker matches
to a single …rm and each pair chooses a single job type z: This implies, in particular, that
counterfactual policy analysis using this model provides unambiguous answers.
    A key implication of the model is that cross-market variation in the price function is
determined by cross-market variation in the functions (fx ; f" ) and (fy ; f ). To see this more




                                                     6
                          @e
                           s(z;x)           e
                                          @ d(z;y)
clearly, substitute for     @z
                                    and      @z
                                                       and rewrite (2:5) as
                                              R                               R
                                                  Ye
                                                       f fy      zz
                                                                 z
                                                                         dy       e
                                                                                  X
                                                                                      f" fx UUzz
                                                                                              z"
                                                                                                 dx
                               Pzz (z) =                R f      fy           R     f" fx
                                                                                                      (2.6)
                                                        Ye       z
                                                                         dy       e Uz" dx
                                                                                  X


where the arguments of the functions are suppressed. This second order di¤erential equation
depends on the objects (U; ), (fx ; f" ) and (fy ; f ) : If the parameters (U; ) and (f" ; f ) are
…xed while (fx ; fy ) vary across markets, the equilibrium price will vary across markets. We
exploit the variation induced by these changes in Section 4 to show identi…cation of the
structural parameters using multimarket data.
    Finally, our assumptions imply that the joint distribution of observables (z; x; y) implied
by the model will be continuous. Since the distributions of (x; ") and (y; ) are continuous,
the joint distribution of (z; x; y) will be continuous if almost all agents do not bunch at a
                 e Given a point zb 2 Z;
single point in Z.                       e it is possible that a positive measure of agents will
bunch at zb ; only if the set

                          B = f(x; ") ; (y; ) j              z   (zb ; y; ) = Uz (zb ; x; ")g :

has positive measure. When (x; ") and (y; ) are continuously distributed, this set cannot
have positive measure if z > 0 and Uz" < 0. Our assumed single-crossing condition
rules out bunching and implies that (z; x; y) are continuously distributed on their respective
domains.10


3      Identi…cation in a Single Market
This section discusses identi…cation of supply function s (x; ") ; the marginal utility function
Uz (z; x; ") and the distribution of " in a single market. We do not discuss the demand side
of the market because the analysis for that case is analytically similar. Our analysis assumes
that the equilibrium price function P (z) and the distribution of (z; x) are known where
z denotes the observed hedonic location choice of an individual and x denotes the vector
of observed worker characteristics. Estimation of P (z) does not a¤ect the identi…cation
analysis. In Section 5, we discuss how it impacts the estimation analysis. (See Web Appendix
  10
    Examples with bunching can be generated either by allowing for mass points in the distributions or
worker or …rm types or by relaxing the single-crossing condition. Further analysis of bunching is available
in Web Appendix C.


                                                                     7
A.)
   We conduct the analysis for the case where z 2 R. The analysis applies equally to the
case where z = g (a) 2 R and a 2 Rn subject to a normalization on g: For example, if
z=      a and 1 = 1, then the vector of parameters for can be estimated from the price
function since the equilibrium price has the form p = P ( a). Under these conditions
dP
daj
dP     =   j:   Once   has been identi…ed, the analysis in this paper can be applied to z =    a:11
da1
    In nonadditive hedonic models, supply function s (x; ") is a nonseparable function of a
vector of observables x and a scalar unobservable ". While we assume that " is independent
of x, nonetheless, the nonadditive structure allows for arbitrary interactions between x and
" in producing outcomes. Furthermore, the theoretical structure of Section 2 implies that s
is a strictly increasing function of ". The function s (x; ") can then be identi…ed using results
from Matzkin (1999) and Matzkin (2003), where it is shown that, using the independence
between " and x; and the strict monotonicity of s in "; one has that for all values x of X
and all values "0 of ";

                              F" ("0 ) = Pr ("     "0 )
                                      = Pr ("      "0 jx)
                                      = Pr (s (X; ")        s (x; "0 ) jX = x)
                                      = FZjX=x (s (x; "0 )) :

The conditional distribution function, FZjX=x ; of Z given X = x; is strictly increasing when
the density of " is everywhere positive. In this case,

                                                     1
                                     s (x; "0 ) = FZjX=x (F" ("0 )) :

Note that s (x; ") is a reduced form. It depends on the structural utility function and on the
equilibrium price P (z). Nevertheless, it can be used to predict partial equilibrium impacts
of changes in x or " on equilibrium outcomes. Moreover, identi…cation of s (x; ") is a …rst
step required for identi…cation of Uz .
    Identi…cation of s (x; ") requires either a normalization of the function (e.g., …xing its
values at a particular value of X) or of the distribution of the unobserved " (e.g., assuming
that the distribution F" ("0 ) is known). If, for example, we normalize s so that at a value x
  11
    Epple and Sieg (1999) and Sieg, Smith, Banzhaf, and Walsh (2004) assume this index structure in
their analysis of parametric hedonic models.


                                                    8
of X; and all "0 ;
                                           s (x; "0 ) = "0

then one gets from the above equations that for all "0

                                   F" ("0 ) = FZjX=x (s (x; "0 ))

and for all x
                                                1
                                s (x; "0 ) = FZjX=x FZjX=x ("0 ) :

See Matzkin (1999) or Matzkin (2003) for details.
   Certain features of the function s, such as @s (x; "0 ) =@x; the partial derivative of s with
respect to x, or z1 z0 = s (x1 ; ") s (x0 ; ") ; the change in z due to a change in x from x0
to x1 ; leaving the value of " …xed, are invariant to the choice of a normalization. These can
be expressed as
                        @s (x; "0 )     @FZjX=x (z) 1 @FZjX=x (z)
                                    =
                           @x                @z                 @x
where z = s (x; "0 ) and as

                                     s (x1 ; ")   s (x0 ; ")
                                      1
                                 = FZjX=x1
                                           FZjX=x0 (z0 )            z0 :

See Matzkin (2007) for details. We next consider assumptions under which Uz is identi…ed.
We start with a nonidenti…cation result that motivates our identi…cation analysis.


3.1     A Nonidenti…cation Result
Given s (x; ") and P (z), we seek to identify the marginal utility function Uz : In equilibrium,
this function satis…es the …rst order condition

                                Uz (s(x; "); x; ") = Pz (s(x; ")) :                         (3.1)

Note that the marginal utility function is identi…ed for those values of (z; x; ") that lie on
the surface f(z; x; ") : z = s (x; ")g : On this surface, the value of the marginal utility Uz is
known, since it must equal the value of the marginal price function.
   However, it is clear from this expression that without further restrictions, it is not possible


                                                  9
to identify the function Uz for all values of (z; x; ") using data from a single market. For any
arbitrary values of x and "; the value s (x; ") ; the …rst argument of the function, is uniquely
determined. Thus, even if we could observe "; we could not independently vary (z; x; ") and
trace out the function on its nx + 2 dimensional domain.12
    We o¤er three responses to this fundamental nonidenti…cation problem: 1) Focus atten-
tion on features of Uz that are identi…ed; 2) Impose functional restrictions on Uz that enable
analysts to overcome the exact functional dependence between z; x; and " that is implied
by economic theory; or 3) Obtain data from equilibria in di¤erent markets and make use of
independent variation in hedonic equilibrium prices across markets. We pursue the …rst two
approaches in the remainder of this section and develop the third approach in Section 4.


3.2     What is Identi…ed without Further Structure
Even though Uz is not identi…ed using data from a single market, some features of the
function Uz can be identi…ed. A revealed preference argument shows that the hedonic price
function provides a bound on Uz . If a worker (x0 ; "0 ) chooses z0 and not z1 where z0 > z1 ,
then it must be the case that

                           P (z0 )       P (z1 )     U (z0 ; x0 ; "0 ) U (z1 ; x0 ; "0 )
                                                     Zz0
                                                   =     Uz (s; x0 ; "0 ) ds
                                                       z1


Di¤erences in hedonic prices for z0 and z1 in general overestimate the change in welfare
between z1 and z0 .13
    Other features of Uz are point identi…ed. For example, if x contains two variables, x1
and x2 , the ratio of the partial derivatives of Uz with respect to x1 and x2 is identi…ed. To
see this, note that one can totally di¤erentiate equation (3:1) with respect to x1 and x2 to
obtain

                               @s(x1 ; x2 ; ")                                                @s(x1 ; x2 ; ")
        Uzz (z; x1 ; x2 ; ")                   + Uzx1 (z; x1 ; x2 ; ") = Pzz (s(x1 ; x2 ; "))
                                   @x1                                                            @x1
  12
     This is the nonparametric generalization of the nonidenti…cation result reported in Brown and Rosen
(1982).
  13
     See Scotchmer (1985), Kanemoto (1988), and Gri¢ th and Nesheim (2008).




                                                            10
and

                             @s(x1 ; x2 ; ")                                                @s(x1 ; x2 ; ")
      Uzz (z; x1 ; x2 ; ")                   + Uzx2 (z; x1 ; x2 ; ") = Pzz (s(x1 ; x2 ; "))                 :
                                 @x2                                                            @x2

Hence, from the assumed properties of U , and the additional assumption that Uzz                                Pzz is
non-zero,
                                               @s(x1 ;x2 ;")
                       Uzx1 (z; x1 ; x2 ; ")
                                             = @s(x@x  1
                                                    1 ;x2 ;")
                                                              js(x1 ;x2 ;")=z :                                 (3.2)
                       Uzx2 (z; x1 ; x2 ; ")
                                                              @x2

Since s (x; ") is identi…ed, the ratios of partial derivatives in (3:2) are identi…ed without any
further restrictions. The ratio on the left side of (3:2) measures the e¤ect on Uz of changing
x1 relative to changing x2 : Since Uz is the marginal willingness to accept (WTA) for the
worker who chooses z; this ratio measures the relative impact on WTA of x1 and x2 : For
example, when z is injury risk and x1 and x2 are education and experience respectively, the
ratio measures the relative impacts on WTA of education and experience. This identi…cation
result requires no further restrictions on the set of admissible Uz functions other than what
has been assured thus far. It does not require any normalization of the s function.
    Alternatively, if x is scalar and one assumes that the distribution of " is known, the same
arguments can be used to show that the ratio of partial derivatives

                                                           @s(x;")
                                         Uzx (z; x; ")       @x
                                                       =   @s(x;")
                                                                     js(x;")=z                                  (3.3)
                                         Uz" (z; x; ")
                                                             @"


is identi…ed without any further restrictions on Uz . In this case, (3:3) can be used to evaluate
the relative impacts on Uz of observable x and unobservable " for di¤erent values of x and
at di¤erent quantiles of the distribution of ": In the job injury example, this ratio could be
used to study the impact of education on WTA for injury risk at di¤erent quantiles of the
distribution.


3.3    Identi…cation Assuming Further Information about the Struc-
       ture of Preferences and Technology
A second way to deal with the fundamental nonidenti…cation problem is to assume additional
restrictions on the set of admissible Uz functions. For example, Ekeland, Heckman, and
Nesheim (2004) overcome the nonidenti…cation problem by imposing an additive structure



                                                         11
on Uz . In their leading example, they assume that

                              Uz (z; x; ") = u0 (z)                u1 (x)     ":

This assumption implies that heterogeneity shifts the marginal utility of z but has no e¤ect
on higher order derivatives. All workers have the same curvature in the utility function.
   Under this restriction (and similar restrictions discussed in Ekeland, Heckman, and
Nesheim (2004)), equation (3:1) reduces to

                          u0 (s (x; "))        u1 (x)       " = Pz (s (x; ")) :

The additive restriction reduces the dimension of the identi…cation problem by one. Ekeland,
Heckman, and Nesheim (2004) show that this implies that u0 , u1 and the distribution of "
are identi…ed up to scale and location parameters.
    However, the additive structure may be too strong for certain economic environments.
From an economic perspective it minimizes the role of heterogeneity in hedonic models.
Moreover, it imposes testable restrictions on observable data. Under the additive model
restriction, the ratios in (3:2) reduce to

                            @u1                    @s(x1 ;x2 ;")
                            @x1
                                  (x1 ; x2 )          @x1
                            @u1
                                               =   @s(x1 ;x2 ;")
                                                                   js(x1 ;x2 ;")=z :
                            @x2
                                  (x1 ; x2 )          @x2


The rate of trade-o¤ between x1 and x2 must be the same for all quantiles of the z distrib-
ution. This is a testable restriction. In the case of scalar x; we have

                                                    @s(x;")
                                   @u1 (x)            @x
                                           =        @s(x;")
                                                              js(x;")=z :
                                     @x
                                                      @"


The impact of x on z must be the same for all ":
    The additive model structure is over-identifying. It is desirable to investigate weaker
conditions for identi…cation that are just identifying. Proceeding along these lines, we de-
velop three theorems. Each introduces a di¤erent assumption on marginal utility, but all
have the e¤ect of reducing the number of arguments of Uz by at least one to overcome the
nonidenti…cation result of Section 3.1. We emphasize that all are weaker than assumptions
imposed in parametric hedonic models or in Ekeland, Heckman, and Nesheim (2004). All
impose some separability structure on the utility or production functions and some sort of


                                                     12
scale normalization. The types of restrictions required are similar in spirit to either those
required to identify household equivalence scales in classical demand theory or to restrictions
used in random coe¢ cients models. See Lewbel (1989) or Lewbel (1997) for related results
on identi…cation of household equivalence scales and a survey of that literature.

3.3.1    Observable Scales

For our …rst theorem, we assume that Uz is a weakly separable function of the pair (z; x), i.e.,
for some functions m : R2 ! R; and q : R2 ! R; Uz (z; x; ") = m (q(z; x); ") : Moreover,
we assume that the function, q; which aggregates the e¤ect of z and x on Uz is known. In
the job risk example, q (z; x) can be interpreted as the observable scale or quality of the
job-worker match while " is unobserved heterogeneity in marginal utility. Note that when
q(z; x) = z=x; our speci…cation is consistent with Barten’s (1964) scale model for utility.
Since m is nonadditive in "; a normalization on either m or the distribution of " is also
needed. In the next theorem, we assume that the distribution of " is speci…ed a priori.14

Theorem 3.1 Suppose that for some unknown di¤erentiable function m : R2 ! R; which is
strictly decreasing in its second argument, and some known di¤erentiable function q : R2 !
R; the marginal utility function can be written

                                      Uz (z ; x ; ") = m (q(z; x); ") :                                 (3.4)

Further, assume that F" is known and let (q l ("); q u (")) denote the support of q(s(x; "); x) for
any " 2 E: e Then, for all " and all x such that q(s(x; "); x) 2 (q l ("); q u (")); Uz (z; x; ") is
identi…ed:

Proof. See Appendix A.
    The intuition for this result is that for a given value of ", identi…cation of s (x; ") allows
one to …nd all pairs of (z; x) that are consistent with that value of ". The separability
restriction on Uz allows one to select from among these pairs the one that produces a given
value of q (z; x). Combining these two results allows one to identify Uz at any arbitrary
point.
    Theorem 3.1 uses a separability restriction and a normalization of the distribution of ".
An alternative approach is to invoke separability, but to normalize the function Uz ; instead
  14
    For example, since " is not observed, a natural choice is to specify that " is uniformly distributed. Thus
" can be interpreted as the quantile in the unobserved heterogeneity distribution.


                                                     13
of the distribution of "; by assuming that its value is known at a point. Along these lines,
we obtain the following theorem.

Theorem 3.2 Let x 2 R: Suppose that for some unknown, di¤erentiable function m : R2 !
R; which is strictly decreasing in its last argument, and some known, di¤erentiable, function
q : R2 ! R,
                                  Uz (z ; x ; ") = m (q(z; x); ") :

Use the function Pz to …x the value of the unknown function Uz at one value x of x; and on
the 45 degree line on the (z; ") space, by requiring that for all t;

                                         Uz (t; x; t) = Pz (t):                                   (3.5)

Let " be given. Let q 2 (q l ("); q u (")); the support of q(s(x; "); x): Then, for x such that
q(s(x; "); x) 2 (q l ("); q u (")), Uz (z ;x;") is identi…ed:

Proof. See Appendix A.

3.3.2    Random Coe¢ cients

Results analogous to Theorems 3.1 and 3.2 can be obtained if, instead of requiring that Uz
be separable in (z; x), one assumes that Uz is separable in (z; "): In other words, one can
assume that for some unknown function m : R2 ! R; which is strictly increasing in its …rst
argument, and some known function q : R2 ! R; which is strictly decreasing in its second
argument
                                Uz (z; x; ") = m (q(z; "); x) :                        (3.6)

This speci…cation is a generalization of a linear random coe¢ cients model. When q(z; ") =
" z; this speci…cation is consistent with a linear random coe¢ cients model for the marginal
utility.15
    A result analogous to that of Theorem 3.1 can be obtained when F" is known. For any
x; let (ql (x); qu (x)) denote the support of q(s(x; "); "). Following an argument similar to
that used in the proof of Theorem 3.1, it is easy to show that for all x and all " such that
q(s(x; "); ") 2 (q l (x); q u (x)); Uz (z; x; ") is identi…ed. The result that corresponds to Theorem
  15
    The scalar version of the parametric demand model analyzed in Bajari and Benkard (2005) is a special
case of this model. They assume that m is parametric.




                                                  14
3.2 is obtained by …xing the values of m when x = x; a speci…ed value of x; as

                                          m (q (t; t) ; x) = Pz (t):

3.3.3    Multiple Observed Scales

When x is a vector, alternative restrictions can be used to achieve identi…cation. As an
example, when x is a two-dimensional vector (x1 ; x2 ) ; we can impose the restriction that
Uz is weakly separable into two known functions, q1 (z; x1 ) and q2 (x2 ; ") : The next theorem
establishes that this restriction, along with a normalization on Uz ; which is weaker than what
is required in the case where x is a scalar, allows one to identify Uz :

Theorem 3.3 Let x = (x1 ; x2 ) 2 R2 : Suppose that for some unknown di¤erentiable func-
tion m : R2 ! R; which is strictly increasing in its second argument, and some known
di¤erentiable functions q1 : R2 ! R and q2 : R2 ! R

                               Uz (z; x1 ; x2 ; ") = m (q1 (z; x1 ); q2 (x2 ; "))                       (3.7)

where q2 is strictly decreasing in its second argument. Let q2l ; q2u denote the support of
q2 (x2 ; "): Assume that the function m is known at one point (z; x1 ; ) where 2 q2l ; q2u ; so
that
                                    m (q1 (z; x1 ); ) = P z (z) :                         (3.8)

For any t2 2 q2l ; q2u ; let [q1l (t2 ); q1u (t2 )] denote the support of q1 (s(x1 ; x2 ; "); x1 ) conditional
on q2 (x2 ; ") = t2 : Then, for any (z; x1 ; x2 ; ") such that q2 (x2 ; ") 2 q2l ; q2u and q1 (z; x1 ) 2
[q1l (t2 ); q1u (t2 )], Uz (z; x1 ; x2 ; ") is identi…ed.

Proof. See Appendix A.
    Identi…cation of Uz is obtained from a sequence of arguments. First, equation (3.7)
implies that the supply function s(x1 ; x2 ; ") is a weakly separable function of x1 and q2 (x2 ; "):
Equation (3.8) implies that the supply function is known at one point. Further, the strict
monotonicity of m and q2 in their second arguments implies that the supply function is
strictly increasing in ": These implications guarantee that the supply function s and the
distribution of " are identi…ed. Next, to identify the value of m(t1 ; t2 ) at an arbitrary
point (t1 ; t2 ) on the relevant domain, we …rst …nd values x1 ; x2 ; and " such that when
z = s(x1 ; x2 ; " ); q1 (z; x1 ) = t1 and q2 (x2 ; " ) = t2 : Finally, since such a z satis…es the FOC,
it follows that m(t1 ; t2 ) = Pz (z) = Pz (s(x1 ; x2 ; " )) : Thus, independent variation in x1 and

                                                      15
x2 ; the assumed dependence of Uz on only two arguments, and knowledge of the functions
q1 and q2 ; allow one to trace out Uz as a function of its two arguments.
     The statement and proof of Theorem 3.3 can easily be modi…ed to show that the function
Uz is also identi…ed when it can be expressed as a function m(t1 ; x1 ); where t1 = q1 (z; t2 ) and
t2 = q2 (x2 ; "): To see this, suppose that for some unknown function m : R2 ! R and some
known functions q1 : R2 ! R and q2 : R2 ! R; such that m is strictly increasing in its …rst
argument, q1 is strictly increasing in its second argument, and q2 is strictly decreasing in its
second argument
                              Uz (z; x1 ; x2 ; ") = m (q1 (z; q2 (x2 ; ")); x1 ) :             (3.9)

Assume that the function m is known at one point (z; x1 ; ) so that

                                    m (q1 (z; ); x1 ) = Pz (z) :                              (3.10)

Then, as in the proof of Theorem 3.3, it can be shown by using (3.9) that the supply function,
s(x1 ; x2 ; ") is weakly separable in q2 (x2 ; "). By (3.10), the value of s is …xed at one point.
By the monotonicity of m and q1 ; s is strictly increasing in q2 : These properties guarantee
identi…cation of s and of the distribution of " using the analysis of Matzkin (1999) and
Matzkin (2003): To identify the value of m(t1 ; t2 ) at an arbitrary vector (t1 ; t2 ); let x1 = t2 ;
and …nd x2 ; and " such that when z = s(x1 ; x2 ; " ); q1 (z; q2 (x2 ; " )) = t1 : Then, as in the
previous argument, m(t1 ; t2 ) = Pz (z) = Pz (s(x1 ; x2 ; " )) :

3.3.4   Economic Implications of the Restrictions

Consider the economic implications of some of the restrictions that we have invoked. We
focus on the restrictions used in Theorems 3.1 and 3.2. Consider the alternative speci…cations

                                     Uz (z; x; ") = m1 (zx; ")                                (3.11)

and
                                     Uz (z; x; ") = m2 (z"; x) :                              (3.12)

These models make di¤erent assumptions about how heterogeneity impacts marginal util-
ity. Model (3.11) imposes the requirement that UUzxzz
                                                      = xz while model (3.12) imposes the
requirement that UUzz
                   z"
                      = z" : The former condition might be appropriate when the researcher
has prior information about the marginal rate of substitution between z and observable x


                                                 16
and but has no information about how unobserved heterogeneity a¤ects marginal utility.
The latter might be appropriate if the researcher is willing to impose a random coe¢ cients
structure but has no prior information about the e¤ects of observables.


4    Identi…cation in Multiple Markets
The possibilities for identi…cation of Uz (z; x; ") in a single market are limited because all
workers face the same price schedule. Across multiple markets, the marginal price function
Pz (z) will typically vary depending on underlying market conditions. For example, assuming
that the marginal utility function, Uz (z; x; "), does not vary across markets, the marginal
price function (and the supply function s (x; ")) will, in general, vary across markets when the
distributions of worker or …rm attributes vary across markets. When data are available from
multiple markets and cross-market variation in the distributions of observables causes cross-
market variation in Pz (z) and s (x; "), such variation can be used to identify the function
Uz (z; x; ") without invoking the conditions of Section 3.
    Our analysis provides a general approach to identi…cation of Uz under weaker conditions
than are required when using data from a single cross-section. Use of multimarket data to
identify hedonic models is proposed in Brown and Rosen (1982), Brown (1983) and Epple
(1987). Our analysis is more general than theirs because we consider the nonseparable case
whereas their analyses assume linearity of supply and price equations. Also, our approach
makes explicit that the equilibrium price and the supply function depend on the distributions
of observable characteristics of …rms and workers.
    Suppose that the distributions of " and are the same in all markets. Further assume
that the distributions of x and y with densities denoted by (fx ; fy ) 2 F X     e     F Ye
L2 X;  e x          L2 Ye ; y vary across markets. Here, x and y are Lebesgue measure on
Xe and Ye respectively and L2 represents the space of square integrable functions. Suppose
that a multimarket sample exists from M markets with Nm observations on (z; y; x) from
each market m: The marginal price and supply functions in each market will depend on
 fxm ; fym ; the densities of observed x and y in each market. Dropping superscripts, write
these functions as Pz (z; fx ; fy ) and s (x; "; fx ; fy ).
    The functions (fx ; fy ) and the functional Pz (z; fx ; fy ) are identi…ed in a multimarket
sample satisfying these conditions. Using results in Matzkin (1999, 2003), the functional
s (x; "; fx ; fy ) is nonparametrically identi…ed. Hence, multimarket data allow one to identify


                                              17
the distributions of the observables and the dependence of the marginal price and the supply
function on these distributions. We use this information to identify the marginal utility
function Uz (z; x; ") in the following way.
   From the workers’…rst order condition:

                      Uz (s(x; "; fx ; fy ); x; ") = Pz (s(x; "; fx ; fy ); fx ; fy ) :

We have made explicit the dependence of Pz and s on fx and fy : In a single cross section,
the price function and the supply function are …xed and we cannot independently vary the
three arguments of Uz : With multimarket data, both Pz and s vary for each (x; ") provided
that fx , fy , or both, vary across markets.
    Before stating and proving Theorem 4.1, we need to introduce some new notation. Given
 fxm ; fym     F X e     F Ye , let sm (x; ") and P m (z) be, respectively, the supply function
and price function implied by equilibrium condition (2:5). Further, let
             n                                                                                   o
          S = (z; x; ") : z = sm (x; ") for some fxm ; fym                  e
                                                                          F X             F Ye       :     (4.1)

Similarly, let dm (y; ) be the equilibrium demand function and
             n                                                                                   o
          D = (z; y; ) : z = dm (y; ) for some fxm ; fym                    e
                                                                          F X             F Ye       :     (4.2)

The sets S and D are the sets of matches that could occur in a feasible equilibria.

Theorem 4.1 Let S and D be de…ned as in (4:1) and (4:2) : Assume that (f" ; f ) are known
and are the same across markets, then Uz (z; x; ") is identi…ed for all (z; x; ") 2 S and
 z (z; y; ) is identi…ed for all (z; y; ) 2 D:


Proof. Let (z; x; ") 2 S: Then z = sm (x; ") for some market m with fxm ; fym                              e
                                                                                                         F X
F Ye and Uz (z; x; ") = Pzm (sm (x; ")) where Pzm (z) is the marginal price in market m.
Thus, Uz is identi…ed at all points (z; x; ") such that z is an equilibrium choice for (x; ") in
some feasible equilibrium. By an identical argument, z (z; y; ) is identi…ed for all (z; y; ) 2
D:
    Theorem 4.1 exploits the variation in price and supply functions induced by cross-market
variation in the distributions of observables. Given a …xed pair fx0 ; fy0 ; under the conditions
stated in section 2, equation (2:5) will have a unique solution P 0 (z). This solution will imply
a pair of supply and demand functions s0 (x; ") and d0 (y; ). Perturbing the underlying

                                                    18
distributions to fx1 ; fy1 will result in a new equilibrium price function P 1 (z) and new
supply and demand functions s1 (x; ") and d1 (y; ) : In general, if the dependence of utility
and production functions on y and x is not degenerate, it will be true that P 1 (z) 6= P 0 (z),
s1 (x; ") 6= s0 (x; ") and d1 (y; ) 6= d0 (y; ).


5     Estimation
Since our identi…cation results are constructive, they suggest estimators for the marginal
utility (resp. production) functions and their distributions, based on estimators for the
derivative of the price function and the supply (resp. demand) function. The derivative of
the price function can be estimated as the derivative of the kernel regression of price on z:
The demand and supply functions, and the distributions of the unobservable variables, can
be estimated also using kernel methods, as described in Matzkin (2003).
    The innovation in this paper over previous research is the estimation of the marginal
utility and marginal product functions. Following our proofs of identi…cation, we can con-
struct estimators for either the supply or demand side. Consider, for example, a variant of
the speci…cation of the marginal utility in Theorem 3.3. Suppose that for some unknown
function m and known functions q1 and q2 ;

                        Uz (z; x1 ; x2 ; x3 ; ") = m (q1 (z; x1 ); q2 (x2 ; "); x3 ) :

The vector, x3 ; of additional observable individual characteristics, is included here to allow
for the possibility that the dimension of x is larger than 2. Note, however, that x3 is
not needed for our main identi…cation results. The supply function resulting from this
speci…cation is separable in q2 (x2 ; ") : An estimator for such supply function, denoted by
sb (x1 ; q2 (x2 ; ") ; x3 ) ; can be derived following Matzkin (2003). Let Pbz (z) denote the kernel
estimator for the derivative of the price function, and let t1 ; t2 be arbitrary values. It follows
from the proof of Theorem 3.3 that

                                 b (t1 ; t2 ; x3 ) = Pbz (b
                                 m                        s (b
                                                             x1 ; t2 ; x3 )) ;                (5.1)

      b1 is the value of x1 that solves the equation
where x

                                      q1 (b
                                          s (x1 ; t2 ; x3 ) ; x1 ) = t1 :                     (5.2)



                                                     19
Equation (5:1) with the estimated Pbz and sb plugged in is our estimator of the marginal utility
function in this model.
   Let x1 denote the value of x1 that satis…es

                                           q1 (s (x1 ; t2 ; x3 ) ; x1 ) = t1 :

We demonstrate in Web Appendix D that, under standard conditions, the rate of convergence
   b1 to x1 is the same as that of sb to s: We develop the results using the Implicit Function
of x
Theorem in Banach spaces of Hildebrandt and Graves (1927), to derive a …rst order Taylor
type approximation for the functional that maps the estimated distribution of the observable
variables into the value of x           b1 . Note that because q1 is known and (t1 ; t2 ) is given, equation
(5.2) implies that sb (b                                                    b1 : Hence, the asymptotic be-
                              x1 ; t2 ; x3 ) is a deterministic function of x
havior of sb (b x1 ; t2 ; x3 ) can be derived from that of x    b1 using well known techniques. Also note
that, when the dimension of the vector (x1 ; x2 ; x3 ) is larger than the dimension of z plus
2; we may assume for the purpose of analyzing the asymptotic behavior of Pbz (b                        x1 ; t2 ; x3 ))
                                                                                                    s (b
that Pz is known. Hence, under standard regularity conditions, m                  b (t1 ; t2 ; x3 ) will converge
to m (t1 ; t2 ; x3 ) at the same rate that sb converges to s; with an asymptotic variance that
can be calculated by that of x            b1 using the standard Delta method. See Web Appendix D for
additional detail and Web Appendix E for some simulations that suggest that the method
is practical and works well in practice.


6      Conclusions
This paper develops methods for identifying the deep structural parameters of hedonic equi-
librium models where both the marginal utility of workers and the marginal product of …rms
are nonadditive functions of attributes and a random vector of individual characteristics,
which are di¤erent for the workers and …rms. We develop su¢ cient conditions to identify
the marginal utility and marginal product functions using both single market and multimar-
ket data. In the single market case, we develop nonparametric estimators for these functions
and show in Web Appendix D that they are consistent and asymptotically normal. Limited
Monte Carlo evidence presented in Web Appendix E suggests that the methods work well
in practice.
    Our analysis is for a hedonic model with a single attribute. However, as discussed in
Sections 2 and 3, these results apply equally to a model in which the hedonic attribute is a


                                                          20
single index with some known structure in terms of a vector of characteristics. We also note
that our methods allow one to deal with unobserved product attributes, as long as these
can be identi…ed from the price function, as in Bajari and Benkard (2005), since in such a
case one can treat them as observed. In contrast to their analysis, our analysis allows for
a nonparametric utility function. More generally, the …rst order conditions in unrestricted
multiple attribute hedonic models are systems of simultaneous equations. General conditions
for nonparametric identi…cation of systems of equations are given in Matzkin (2008). Further
work is required to investigate which types of restrictions developed in Matzkin (2008) are
most appropriate for hedonic applications.


A       Proofs
Proof of Theorem 3.1. Since model (3:4) satis…es the conditions in section 2; s(x; ")
satis…es (2:1) and (2:2) : Thus, s is a nonadditive function in " which is strictly increasing in
": Since " is independent of X; it follows by Matzkin (1999) and Matzkin (2003) that

                                                    1
                                      s (x; ") = FZjX (F" (")) :

Since F" is given, s is identi…ed. Let (t1 ; t2 ) be such that t1 2 (q l (t2 ); q u (t2 )). Find x such
that
                                     q (s(x ; t2 ); x ) = t1 :

Then,
                                     m(t1 ; t2 ) = Pz (s(x ; t2 )) :


Proof of Theorem 3.2. As in Theorem 3.1, s is a nonadditive function in " which is
strictly increasing in ": Further, it follows from equation (3:5) that the supply function,
s(x; "); satis…es
                                          s(x; ") = ":

Then, by Matzkin (1999)
                                         F" (") = FZjX=x (")

and
                                                1
                                   s(x; ") = FZjX=x (FZjX=x (")):


                                                   21
To establish that the function m is identi…ed, let x denote the solution to

                                          q (s(x ; t2 ); x ) = t1 :

Hence,

                                m(t1 ; t2 ) = m (q (s(x ; t2 ); x ) ; t2 )
                                             = Pz (s(x ; t2 )) :



Proof of Theorem 3.3.              Since Uz is weakly separable in q2 (x2 ; "); the function z =
s(x1 ; x2 ; ") is also weakly separable in q2 (x2 ; "): Hence, for some unknown function v

                                     s(x1 ; x2 ; ") = v(x1 ; q2 (x2 ; ")):

Further, since all of the conditions in section 2 are satis…ed and since q2 is strictly increasing
in both x2 and "; v is strictly increasing in its second argument.
    Let x2 and " be such that q2 (x2 ; ") = : Then, by separability and condition (3.8) in the
statement of the theorem
                                  Uz (z; x1 ; q2 (x2 ; ")) = Pz (z)

where z satis…es the FOC (2:1) when x1 = x1 and q2 (x2 ; ") = : It follows that

                                  s (x1 ; x2 ; ") = v(x1 ; q2 (x2 ; ")) = z:

It then follows from the analysis of Matzkin (2003) that the function v and the distribution
of " are identi…ed from the conditional distribution of Z given X = (X1 ; X2 ).
    To show that the function m is identi…ed, let (t1 ; t2 ) be any vector such that t2 2 q2l ; q2u
and t1 2 [q1l (t2 ); q1u (t2 )]: Let x1 denote a solution to

                                          q1 (v(x1 ; t2 ); x1 ) = t1 :

Since q1 is a known function and v can be recovered from the conditional cdf of z given
(x1 ; x2 ); the only unknown in the expression is x1 : Since t2 2 q2l ; q2u and t1 2 [q1l (t2 ); q1u (t2 )];




                                                      22
x1 exists. Since v(x1 ; t2 ) satis…es the FOC (2:1),

                               m(t1 ; t2 ) = m (q1 (v(x1 ; t2 ); x1 ) ; t2 )              (A.1)
                                          = Pz (v(x1 ; t2 ))
                                          = Pz (s(x1 ; x2 ; " ))

for any x2 and " such that q2 (x2 ; " ) = t2 : In (A.1), the …rst equality follows because
q(v(x1 ; t2 ); x1 ) = t1 : The second equality follows because the value of the marginal utility
function m equals the value of the marginal price function at the particular value of z
that satis…es the …rst order conditions. The third equality follows by the restriction on the
function s: Since the function Pz is known and the function s can be recovered without
knowledge of m; (A:1) implies that m is identi…ed.




                                                   23
References
Bajari, P. and C. Benkard (2005). Demand Estimation with Heterogeneous Consumers and
  Unobserved Product Characteristics: A Hedonic Approach. Journal of Political Econ-
  omy 113 (6), 1239–1276.

Barten, A. (1964). Family Composition, Prices and Expenditure Patterns. Econometric
  Analysis for National Economic Planning, 277–292.

Berry, S. and A. Pakes (2007). The pure characteristics demand model . International
  Economic Review 48 (4), 1193–1225.

Brown, J. N. (1983). Structural estimation in implicit markets. In J. E. Triplett (Ed.), The
  Measurement of Labor Cost. Chicago: University of Chicago Press for NBER.

Brown, J. N. and H. S. Rosen (1982, May). On the estimation of structural hedonic price
  models. Econometrica 50 (3), 765–768.

Chiappori, P.-A., R. McCann, and L. Nesheim (2008). Hedonic price equilibria, stable
  matching, and optimal transport: Equivalence, topology, and uniqueness. Forthcoming,
  Economic Theory.

Ekeland, I. (2005, April). Existence, uniqueness and e¢ ciency of equilibrium in hedonic
  markets with multidimensional types. University of British Columbia.

Ekeland, I., J. J. Heckman, and L. Nesheim (2004, February). Identi…cation and estimation
  of hedonic models. Journal of Political Economy 112 (S1), S60–S109. Paper in Honor of
  Sherwin Rosen: A Supplement to Volume 112.

Epple, D. (1987, February). Hedonic prices and implicit markets: Estimating demand and
  supply functions for di¤erentiated products. Journal of Political Economy 95 (1), 59–80.

Epple, D. and H. Sieg (1999). Estimating Equilibrium Models of Local Jurisdictions. Journal
  of Political Economy 107 (4), 645–681.

Gale, D. and H. Nikaido (1965). The Jacobian matrix and global univalence of mappings.
 Mathematische Annalen 159 (2), 81–93.

Gri¢ th, R. and L. Nesheim (2008). Household willingness to pay for organic products.
  CEMMAP Working Paper CWP18/08.

                                            24
Heckman, J. J. and E. J. Vytlacil (2007). Econometric evaluation of social programs, part I:
  Causal models, structural models and econometric policy evaluation. In J. Heckman and
  E. Leamer (Eds.), Handbook of Econometrics, Volume 6B, pp. 4779–4874. Amsterdam:
  Elsevier.

Hildebrandt, T. and L. Graves (1927). Implicit functions and their di¤erentials in general
  analysis. Transactions of the American Mathematical Society 29 (1), 127–153.

Hurwicz, L. (1962). On the structural form of interdependent systems. In E. Nagel, P. Suppes,
 and A. Tarski (Eds.), Logic, Methodology and Philosophy of Science, pp. 232–239. Stanford
 University Press.

Kahn, S. and K. Lang (1988, February). E¢ cient estimation of structural hedonic systems.
 International Economic Review 29 (1), 157–166.

Kanemoto, Y. (1988, July). Hedonic prices and the bene…ts of public projects. Economet-
 rica 56 (4), 981–989.

Kniesner, T. J. and J. D. Leeth (1995). Simulating Workplace Safety Policy. Boston, MA:
 Kluwer Academic Publishers.

Leeth, J. D. and J. Ruser (2003). Compensating wage di¤erentials for fatal and nonfatal risk
  by gender and race. Journal of Risk and Uncertainty 27 (3), 257–277.

Lewbel, A. (1989). Identi…cation and Estimation of Equivalence Scales under Weak Separa-
  bility. Review of Economic Studies 56 (2), 311–16.

Lewbel, A. (1997). Consumer Demand Systems and Household Equivalence Scales. Handbook
  of Applied Econometrics 2, 167–201.

Matzkin, R. L. (1999). Nonparametric estimation of nonadditive random functions. First
 edition. Unpublished manuscript, Northwestern University, Department of Economics.

Matzkin, R. L. (2003, September). Nonparametric estimation of nonadditive random func-
 tions. Econometrica 71 (5), 1339–1375.

Matzkin, R. L. (2007). Nonparametric identi…cation. In J. Heckman and E. Leamer (Eds.),
 Handbook of Econometrics, Volume 6B. Amsterdam: Elsevier.



                                             25
Matzkin, R. L. (2008). Identi…cation in nonparametric simultaneous equations models.
 Econometrica 76 (5), 945–978.

Rosen, S. (1974, January-February). Hedonic prices and implicit markets: Product di¤eren-
  tiation in pure competition. Journal of Political Economy 82 (1), 34–55.

Scotchmer, S. (1985, October). Hedonic prices and cost-bene…t analysis. Journal of Economic
  Theory 37 (1), 55–75.

Sieg, H., V. K. Smith, H. S. Banzhaf, and R. Walsh (2004, November). Estimating the general
  equilibrium bene…ts of large changes in spatially delineated public goods. International
  Economic Review 45 (4), 1047–1077.




                                            26
