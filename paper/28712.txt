                              NBER WORKING PAPER SERIES




                        POLICY WITH STOCHASTIC HYSTERESIS

                                        Georgii Riabov
                                        Aleh Tsyvinski

                                      Working Paper 28712
                              http://www.nber.org/papers/w28712


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                    April 2021




We thank Fernando Alvarez, Lint Barrage, Job Boerma, Jaroslav Borovicka, Eduardo Faingold,
Felix Kubler, Francesco Lippi, Ernest Liu, Erzo Luttmer, Giuseppe Moscarini, Alessandro Pavan,
Florian Scheuer, Simon Scheidegger, Michael Sockin, Stefanie Stantcheva, Kjetil Storesletten,
Philip Strack, Ted Temzelides, Pierre Yared, and Nicolas Werquin. The views expressed herein
are those of the authors and do not necessarily reflect the views of the National Bureau of
Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2021 by Georgii Riabov and Aleh Tsyvinski. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Policy with Stochastic Hysteresis
Georgii Riabov and Aleh Tsyvinski
NBER Working Paper No. 28712
April 2021
JEL No. E0,H23,Q4,Q5,Q54

                                          ABSTRACT

The paper develops a general methodology for analyzing policies with path-dependency
(hysteresis) in stochastic models with forward looking optimizing agents. Our main application is
a macro-climate model with a path-dependent climate externality. We derive in closed form the
dynamics of the optimal Pigouvian tax, that is, its drift and diffusion coefficients. The dynamics
of the present marginal damages is given by the recently developed functional Itô formula. The
dynamics of the conditional expectation process of the future marginal damages is given by a new
total derivative formula that we prove. The total derivative formula represents the evolution of the
conditional expectation process as a sum of the expected dynamics of hysteresis with respect to
time, a form of a time derivative, and the expected dynamics of hysteresis with the shocks to the
trajectory of the stochastic process, a form of a stochastic derivative. We then generalize the
results. First, we propose a general class of hysteresis functionals that permits significant
tractability. Second, we characterize in closed form the dynamics of the stochastic hysteresis
elasticity that represents the change in the whole optimal policy process with an introduction of
small hysteresis effects. Third, we determine the optimal policy process.


Georgii Riabov
Institute of Mathematics, NAS of Ukraine
Vulytsya Tereshchenkivska, 3,
Kiev
Ukraine
ryabov.george@gmail.com

Aleh Tsyvinski
Department of Economics
Yale University
Box 208268
New Haven, CT 06520-8268
and NBER
a.tsyvinski@yale.edu
1    Introduction

Modern macroeconomics is stochastic and is built on recursive methods. The actions in these models
are history dependent but the past is represented by a small number of finite-dimensional state
variables. For example, Ljungqvist and Sargent (2018) write that "finding a recursive way to handle
history dependence is a major achievement of the past 35 years and an important methodological
theme". They call these developments an "imperialistic response of dynamic programming" to
Prescott's (1977) critique of the impossibility of using dynamic programming in government policy
design. In this paper, we aim to study environments in which it may in general be difficult or
impossible to write a recursive representation. We use the term hysteresis to describe settings in
which the trajectory of policies or actions may generally affect the structure of the environment.
That is, the effects of policies are path-dependent.
    Our main economic application is  generalization of the macroeconomy-climate model of
Golosov, Hassler, Krusell, and Tsyvinski (2014) to the path-dependent climate externalities. There
are two main reasons to consider hysteresis in such models. First, there is important recent evi-
dence from climate sciences that a number of climate variables show significant hysteresis behavior.
Intergovernmental Panel on Climate Change (IPCC) lists, for example, hysteresis that is present
in (1) vegetation change; (2) changes in the ice sheets; (3) ocean acidification, deep ocean warming
and associated sea level rise; (4) models of the feedback between the ocean and the ice sheets; and
(5) models of the Atlantic meridional overturning circulation (Collins, et al. 2013 in IPCC Fifth
Assessment Report ­ AR5). While cumulative carbon emission is an important benchmark used in
macro-climate models, recent research in climate sciences (further discussed in Section 3.2) points to
importance of hysteresis in a number of climate variables that constitute a natural science founda-
tion of these models. Moreover, the path-dependency in these models is often rather sophisticated
as the exact sequence of the events may matter. The IPCC Special Report further concludes that
path dependence of carbon budgets "remains an important knowledge gap" (Rogelj et al. 2018).
Second, one of the central themes in the recent developments in the economics literature on climate
change is incorporating path-dependency. A recent survey by Aghion, et al. (2019) summarizes
these developments and argues that path-dependency in which both history and expectations mat-
ter is one of the core insights in this literature (see, for example, Acemoglu, Aghion, Bursztyn,
and Hemous (2012), Acemoglu, Akcigit, Hanley, and Kerr (2016), Acemoglu, Aghion, Barrage and
Hemous (2019), and Aghion, Dechezlepretre, Hemous, Martin, and Van Reenen (2016)). Finally,



                                                  2
careful consideration of uncertainty has been another important theme of recent research on eco-
nomics of climate change. Our application thus puts at the forefront the analysis of an economy
where  forward looking social planner makes emission decisions under uncertainty and faces a
path-dependent emissions externality. In contrast to the literature and, specifically to Golosov,
Hassler, Krusell, and Tsyvinski (2014), we significantly relax the assumption of how the previous
emission choices enter the climate damages. In our setting, the whole path of the emission (hystere-
sis) matters as opposed to a depreciated stock of the previous emissions. Specifically, we analyze
a particular climate hysteresis functional that captures the most important elements of the setting
with general hysteresis.
   Our main result in this macro-climate application is a closed form characterization of the dy-
namics of the marginal externality damage which is also the Pigouvian tax that implements the
optimal allocation. We start by deriving the first-order conditions for the optimum and showing
that the marginal externality damage from emissions is comprised of the marginal contempora-
neous damages and the conditional expectation of the cumulative future damages. Both of these
terms are path-dependent and their dynamics cannot be derived using the usual It^
                                                                                o formula which
applies only to functions of the current state and not the functionals of the trajectories. We use two
different sets of tools to provide the dynamics of the present and the expected cumulative damages.
   The present marginal damages are already represented as an explicit path-dependent functional
and we use recently developed functional It^
                                           o calculus for the non-anticipative functionals (Dupire
2009, 2019, Cont and Fournie 2013) to represent this term. The functional It^
                                                                            o formula uses two new
concepts of derivatives introduced by Dupire (2009, 2019). The vertical derivative is an analogue
of the space derivative and the horizontal derivative is an analogue of the time derivative for the
functionals. These derivatives evaluate, respectively, the effects of a discontinuous bump in the
underlying trajectory and the effects of a time extension of the trajectory while fixing the terminal
position. The Dupire's functional It^
                                    o formula then gives the dynamics of the present damages
with the drift determined by the horizontal and the second vertical derivative, and the diffusion
coefficient given by the vertical derivative of the marginal present damages. Using the notion of
the horizontal and vertical derivatives the functional It^
                                                         o formula allows us to convey the similar
intuition as in the case of no hysteresis for which the usual It^
                                                                o formula is applicable. However,
in contrast with the case of no hysteresis path-dependency may lead to significant effects on the
dynamics even in the case of absent contemporaneous damages.
   The most challenging part of the paper is to characterize the dynamics of the expected future


                                                  3
marginal damages represented by the conditional expectation process. The difficulty comes from
the fact that with passage of time both the damages themselves and the information set (filtration)
are changing. The main new theoretical tool that we develop ­ the total derivative formula for
conditional expectation processes ­ allows us to characterize the dynamics of such processes. More-
over, this formula is broadly applicable to a variety of macroeconomic settings where the conditional
expectations processes are central. There are two terms in the semimartingale decomposition of
the conditional expectations process that the total derivative formula delivers. The first term can
be intuitively thought of as  time derivative and represents how the conditional expectation of the
future marginal damages evolves with respect to time. The second term, given as a conditional
expectation of the Malliavin derivative of the cumulative future marginal damages, can be thought
of as a stochastic derivative with respect to the underlying process and represents how the condi-
tional expectation changes with the changes in the stochastic process. It is useful to compare the
results to the case with no hysteresis. The main difference is that in the case of no hysteresis, the
policy does not have future effects. With hysteresis, the contemporaneous effects of the policy may
be very small but the expected future effects of the policy may be very large ­ small actions today
my have significant future consequences. Moreover, these effects change with both time and the
stochastic shocks.
   Combining the dynamics of the present and the conditional expectation of the future marginal
damages, we obtain in closed form the drift and diffusion of the optimal Pigouvian tax correcting
the path-dependent externality. The dynamics are given by the semimartingale decomposition of
the marginal externality damages which can be though of in terms of the planner changing the
tax with the passage of time and with the realization of uncertainty. Alternatively, this can be
thought of as determination of what features of the model matter to the first order for the drift
and diffusion of the optimal tax. Specifically, those are given by the functional It^
                                                                                    o formula and
by our total derivative formula for the conditional expectation processes. Even if there are no
direct contemporaneous effects, the dynamics of the optimal policy may be significantly impacted
by either the past choices or by the future effects. In other words, both the past and the future
non-trivially matter.
   We then show that one can significantly generalize the application of the climate hysteresis.
First, we propose a very general class of hysteresis functionals that allow significant tractability
of the analysis of optimal policies. The Fr´
                                           echet derivatives of these functionals have two sources
of variation: an instantaneous influence in the given (current) period and an integral influence of


                                                 4
perturbations in previous periods. The assumption is mild and only requires that the derivative of
a functional at a given time is absolutely continuous up to that period and may have an atom at
the present time. We show that every Fr´
                                       echet differentiable functional is a pointwise limit of func-
tionals from this class. Importantly, these functionals have an attractive property of conveniently
separating the effects of the past and the present. As we are considering a very general environment
with path-dependence, it may be difficult or impossible to use dynamic programming to write a
recursive representation of the problem. Instead, we directly find the first order conditions for the
optimal problem by considering all local variations of the policies. The assumption on the deriva-
tive of the hysteresis functional allows us to conveniently separate the first order condition in two
parts: the marginal effects of the policy on current period and the conditional expectation of the
cumulative future marginal effects of policy paths in the future periods.
   Our next goal is to explicitly find the evolution equation for the stochastic hysteresis elasticity.
This concept of stochastic hysteresis elasticity is similar to the usual concept of elasticity as it
captures the change in the variables following a small change in policy. The difference is that the
stochastic elasticity is the change in the whole optimal process. Alternatively, one can think of the
stochastic elasticity as the asymptotics of the optimal policy when there is an infinitesimal additional
hysteresis. Specifically, we show that the stochastic elasticity is an It^
                                                                         o process and write its explicit
semimartingale decomposition. A fundamental property of the solution is that both of the terms ­
the present and the expected future marginal effects of policy paths ­ in the first order condition
for optimality and in the formula for the stochastic elasticity are path-dependent. Similarly to our
climate hysteresis application we use the functional It^
                                                       o formula and the total derivative formula
to represent the dynamics of the stochastic elasticity. The semimartingale decomposition of the
present and the cumulative marginal effects of policies show that the stochastic elasticity, that is,
the change in the optimal policy process following introduction of hysteresis, is an It^
                                                                                       o process. The
difference with the no-hysteresis case is that now the drift and diffusion coefficients are themselves
functionals of the trajectory of the policy. That is, hysteresis leads to the path-dependent stochastic
process of the elasticity for which we calculate the drift and diffusion coefficients in the explicit form.
Finally, we return to the analysis of the optimal policies with general hysteresis. The evolution of
the optimal policy can be analyzed using exactly the same tools as the stochastic elasticity. The
explicit form we obtained for the stochastic elasticity thus can be thought of as a characterization
of the optimal policy process for small hysteresis, or small hysteresis asymptotics. We use the
functional It^
             o formula to represent the current marginal effects and the total derivative formula to


                                                    5
represent the conditional expectation process of the future marginal effects of policies. The drift
and diffusion coefficients of the optimal policy are then determined implicitly by the equations
having a similar form as the explicit solution for the stochastic elasticity but also depending on the
process of the optimal policy itself.
   We finally provide several examples of how to calculate the stochastic hysteresis elasticity. All of
these examples are straightforward applications of the main semimartingale decomposition formula
that we developed.


Literature

The closest to our work is a sequence of papers by Borovicka, Hansen, and Scheinkman (2014),
Borovicka, Hansen, Hendricks, and Scheinkman (2011), and Borovicka and Hansen (2016). They
define the concept of the shock elasticity, relate it to impulse responses familiar to macroeconomists,
and, importantly, formalize it using Malliavin derivatives. The shock elasticity is an impulse re-
sponse of the pricing kernel to the marginal perturbation of the underlying stochastic cash flow
process. Our work goes beyond their results and delivers the explicit semimartingale decomposi-
tion of the evolution of the stochastic elasticity for the path-dependent functionals. In Section 7.3
we also provide a connection to the Clark-Ocone formula that features prominently in Borovicka,
Hansen, and Scheinkman (2014).
   The only paper that we are aware of that uses functional It^
                                                              o formula in economic settings is
an insightful work of Cvitani´
                             c, Possama¨
                                       i, and Touzi (2017). In the dynamic moral hazard setting
where the agent controls the volatility of the process, they show how that without loss of generality
the set of admissible contracts can be represented as the path-dependent processes arising from the
functional It^
             o formula. In our environment, both the functional It^
                                                                  o formula and the total derivative
formula are applied. We discuss this in more details in Section 7.1.
   The concept of stochastic elasticity is similar to the analysis of the models of investment under
uncertainty for the case of small sunk costs or for models with small menu costs. In those models,
there is a form of hysteresis where due to the region of inaction, a temporary change may have a
permanent effect. The analysis of such models have important implications for the large amounts
of inertia that arise in the models of small menu costs such as in Akerlof and Yellen (1985) and
Mankiw (1985). Dixit (1991) develops a method of analytical approximation for such hysteresis
models. Reis (2006) and Alvarez, Lippi, and Paciello (2011, 2016) derive a similar analytical
characterization in the models with inattentive producers. These are essentially the same as our


                                                  6
calculation of stochastic elasticity for the environments that can be characterized by It^
                                                                                         o formula.
A series of papers by Alvarez and Lippi (2019), Alvarez, Le Bihan, and Lippi (2016) and Alvarez,
Lippi, and Oskolkov (2020) focus on the cumulative output effects of shock in environments with
the menu and adjustment costs frictions. These cumulative output effects are the output impulse
response functions1 that are similar to the future expected marginal effects of policy in our paper.
Our analysis can be thought of as generalizing the results to the environments in which there is
path-dependence.
    An important early paper by Detemple and Zapatero (1991) studies an asset pricing model
with habit formation using Malliavin calculus.2 Huang and Sockin (2018) study optimal dynamic
taxation in continuous time and calculate impulse response to misreporting using Malliavin deriva-
tives. As Sannikov (2014) for the model of moral hazard they connect their analysis to the finance
literature on the sensitivity of the "Greeks" of the options (see, e.g., Fourni´
                                                                               e, Lasry, Lebuchoux,
Lions, and Touzi 1999). Their analysis relates to our calculation of Malliavin derivatives of the
policy process in the last part of Section 6.4.
    Hysteresis or path-dependence is important in a variety of macroeconomic and other settings.
The natural rate of unemployment may directly depend on the previous path of unemployment and,
hence, on the path of monetary policy (Blanchard and Summers 1986). Examples of recent explicit
focus on path dependency and monetary policy is Berger, Milbradt, Tourre, and Vavra (2018), Gali
(2020), and Jorda, Singh, and Taylor (2020). Hysteresis is also central in the models of secular
stagnation as in Summers (2014) and Eggertsson, Mehrotra, and Robbins (2019). Adjustment costs
in investment generate hysteresis (for example, see a survey in Dixit 1992). Acemoglu, Egorov, and
Sonin (2020) exposit a wide variety of political economy models with path-dependence of policies or
institutions. Egorov and Sonin (2020) additionally discuss models in which there is non-Markovian
dependence on the sequence of policy events. Page (2006) classifies types of history dependence and
distinguishes between the path-dependent policies (where the exact sequence of events matters) and
the "phat" dependent strategies (where the events but not their sequence matters). The models of
increasing returns such as Arthur (1989) and David (1985), and a review in Arrow (2000) feature
potentially very complicated dependence on the paths.

   1
      Similarly, the impulse responses play an important role in Pavan, Segal, and Toikka (2014), Garrett and Pavan
(2012), and Bergemann and Strack (2015) in dynamic mechanism design, Makris and Pavan (2017) in the dynamic
taxation, and Makris and Pavan (2018) who connect these two literatures. See also a review in Pavan (2017). In
general, the recursive formulation of a number of these problems may be challenging and the tools we develop may
prove to be useful in those contexts.
    2
      See also Serrat (2001), Bhamra and Uppal (2009) and Cvitanic and Malamud (2009).


                                                        7
    We now briefly discuss the relationship of the economic environment we consider with mathe-
matical literature. The analysis of deterministic dynamic systems with hysteresis is well established
(e.g., Krasnosel'skii and Pokrovskii 2013). In our model, path dependency arises from the opti-
mization of the forward looking agents under uncertainty rather than being directly posed as a
property of a dynamic system. The problem that we study also does not fit easily into the standard
framework of the infinite-dimensional stochastic optimal control such as Fabbri, Gozzi, and Swiech
(2017), see discussion in Section 7.4. The reason is that the hysteresis functional depends on the
whole path of the policy. If we treat the policy as a control process we are obliged to take the space
of paths (of variable length) as a control space which leads to the analysis of path-dependent HJB
equations the understanding of which is in its nascency.


2        Environment

We describe an environment of a stochastic problem with forward looking agents and path-dependency.


2.1       Baseline setting

Let w = (wt )0tT be a Brownian motion.3 Let the objective of the planner be described by the
quadratic loss function:
                                                                 T
                                                                      1
                                             max E                   - (ct - wt )2 dt.              (1)
                                               c             0        2

Here maximization is taken over all (progressively measurable) policy processes c : [0, T ]×C ([0, T ]) 
R. That is, policy ct depends on information about w up to moment t.
    The basic problem is easily solved by interchanging integral and expectation and yields the
optimal process ct :

                                                                 ct = wt .                          (2)

The optimal policy simply tracks the Brownian motion wt .


2.2       General environment

Consider a problem where there is an additional path-dependent effect of policy ht :

                                                       T
                                                             1
                                       max E               (- (ct - wt )2 - ht (c))dt,              (3)
                                         c         0         2

    3
        All of the results can be straightforwardly extended to more general diffusion processes.


                                                                       8
where h : [0, T ] × C [0, T ]  R is an adapted functional on the space of trajectories (i.e. ht (c) is
defined only by the restriction of c on [0, t] ), and        is a parameter. One can think of the functional
h as an additional effect (a cost or a benefit) that depends on the history of policy up to time t.
The solution of this problem is denoted c . We define hysteresis as dependence of the effects of
policy ht (c) on the path of the previous policies c[0,t] = ct .


3     Climate externality

This section generalizes the macro-climate model of Golosov, et al. (2014) to the case where
climate externality is path-dependent. Section 3.1 shows how to map some of the key features
of that paper to the framework described in the previous section. Section 3.2 discusses evidence
on hysteresis in the climate externality. Section 3.3 proposes a specific path-dependent climate
hysteresis functional that captures most of the insights of the general framework that we develop
later in Section 4. Sections 3.4-3.7 solve in closed form the dynamics of the marginal climate
externality or the Pigouvian tax implementing the optimum, that is, determine its drift and diffusion
coefficients.


3.1    Planner's problem with a climate externality

We first note that the structure of the problem (3) captures some of the main features of the
macroeconomic model with a climate externality of Golosov, et al. (2014). In its essence, a macro-
climate model consists of two primary blocks. The first is the specification of the economy which
is a standard dynamic stochastic general equilibrium model. The planner maximizes the expected
utility of consumption (we assume no discounting)

                                                   T
                                           E           U (ccons
                                                           t    ) dt,
                                               0


subject to the standard feasibility constraint with capital accumulation, where ccons
                                                                                 t    is a consump-
tion good. The production function is given by


                                          Yt = F (Kt , Et , St ) ,


where Kt is capital, Et is energy consumption (measured in carbon emission units), and St is a
                                                                                 ~t E t of the
climate variable at time t. The climate variable is in general a functional St = S


                                                         9
path of emissions E t = E[0,t] (equation (4) in Golosov, et al. (2014) is, in fact, exactly this general
formulation). The climate variable St affects the economy via a damage function Dt (St ) so that the
                                                    ~ (Kt , Et ) . Moreover, the damages are assumed
output is reduced multiplicatively (1 - Dt (St )) × F
to be exponential 1 - Dt (St ) = exp (-t St ) for some parameter t and the utility U (x) = log (x).
The essence of the model is how the path of emissions E t translates to damages to the economy.
Let us now reduce the model further to focus on this key dimension. Assume that production does
not require capital and the feasibility constraint for the economy is then static:


                                      ccons
                                       t    = Yt = e-t St F (Et ) .


The planner then maximizes
                                                T
                                    max E           ~ (Et ) - t St dt,
                                                    U
                                     Et     0

                                                                                   ~ (Et ) =
which is essentially equivalent to the general problem (3). We further assume that U
 1
-2 (Et - wt )2 but this is again done purely for leanness of the model and can be immediately
extended.
   The key simplification, however, that the literature makes is in simple dependence of the climate
variable St on the path of the emissions. For example, Golosov, et al. (2014)) assume that

                                                         t
                                            St =             ds Es ds,
                                                     0


where ds  [0, 1] is a carbon depreciation rate and then also further structure is placed on ds . In
other words, the climate variable is equal to the stock of the depreciated emissions.
   The climate-economy model in its essence reduces to how the previous energy consumption
choices and the associated carbon emissions impact today's and future economy. In contrast to
the literature, we significantly relax the assumption of how the previous emission choices enter the
damages. In our setting, the whole path of the emissions (hysteresis) matters through the functional
ht ct as opposed to a depreciated stock of the previous emissions. We, on purpose, stripped down
the climate model to focus only on the general path-dependent effects of the emissions and their
interaction with the uncertainty.




                                                     10
3.2   Evidence on climate hysteresis

There are two primary sets of evidence which imply that hysteresis is important in the economic
models of climate change.
   The first is a large set of recent evidence on importance of hysteresis in climate sciences. The
most comprehensive and authoritative source for such research is the Intergovernmental Panel
on Climate Change (IPCC). The working group for the physical science basis of the long-term
climate change in the Fifth Assessment Report ­ AR5 (Collins, et al. 2013), while arguing for
the attractiveness of the use of the cumulative carbon emission, notes that a number of climate
variables and models show significant hysteresis behavior. These are the models of (1) vegetation
change; (2) changes in the ice sheets; (3) ocean acidification, deep ocean warming and associated
sea level rise; (4) models of the feedback between the ocean and the ice sheets; and (5) models of the
Atlantic meridional overturning circulation. The report also argues that "the concepts of climate
stabilization and targets is that stabilization of global temperature does not imply stabilization for
all aspects of the climate system. For example, some models show significant hysteresis behaviour
in the global water cycle, because global precipitation depends on both atmospheric CO2 and
temperature". This is also consistent with the study of Zickfield et al. (2012) who argue that,
while total cumulative emissions may be an important approximation for many models, there are
a number of exceptions where path-dependency is important: among the variables with timescales
of several centuries, such as deep ocean temperature and sea level rise, and for the peak responses
of atmospheric CO2 or for the surface ocean acidity. We now briefly discuss some other recent
evidence of the hysteresis behavior in individual components of the climate system. Eliseev et
al. (2014) is a comprehensive study of the permafrost behavior that finds significant evidence of
hysteresis especially for the higher concentration of greenhouse gases in the atmosphere. Another
important aspect of ice thawing is the release of permafrost carbon which is found to be both very
significant and highly path-dependent (Gasser et al. 2018). Garbe, et al. (2020) analysis "reveals
a strong, multi-step hysteresis behaviour of the Antarctic Ice Sheet" which is potentially reinforced
by a number of additional feedback mechanisms. Nordhaus (2019) augments the DICE model with
the effects of Greenland ice sheet disintegration and finds that the baseline or the no-policy effects
are significantly different when even a simple formulation of the hysteresis is incorporated while
the optimal policy results are similar. Boucher et al. (2012) analyzes the response of a number of
models to a significant increase in the CO2 concentration and finds that hysteresis is particularly



                                                 11
pronounced for the terrestrial (such as long lived soil carbon sinks and vegetation) and marine
variables (such as the sea-level rise) as well as in global mean precipitation. Nohara et al. (2013)
finds that the hysteresis effects are important for the regional climate change which is notable given,
for example, the recent focus on the significant differences in optimal climate policy at the regional
level by Hassler, et al. (2020). Wu et al. (2012) describe significant hysteresis in the hydrological
cycle that leads to one of the most direct impacts of global warming affecting droughts, floods
and water supplies. This is important for the recent economic literature that studies the impact
of the floods and the sea level (for example, Bakkensen and Barrage 2017, Barrage and Furst
2019; Hong, Wang, and Young, 2020 where hysteresis may be also compounded with the path-
dependency in beliefs). Summarizing, while the cumulative emission and its variants are certainly
a central benchmark for the development of the climate-economy models, recent research in climate
sciences points to importance of hysteresis with sophisticated trajectory dependence in a number
of important climate variables.
   The second reason for why hysteresis is important lies in the economics part of the climate-
economy models. One of the central themes in the recent advances in this literature has been
incorporating path-dependency. A recent survey by Aghion, et al. (2019) summarize these devel-
opments: "The core insight is that technological innovation is a path-dependent process in which
history and expectations matter greatly in determining eventual outcome" leading to "important
implications for climate policy design" and "research and knowledge production are path-dependent,
deployment of innovations is path-dependent and the incentives for technology adoption create path
dependence". Several papers in the literature develop various parts of these insights. In Acemoglu,
Aghion, Bursztyn, and Hemous (2012), dirty technologies have an advantage in the market size and
in the initial productivity and, hence, there is path-dependency in the direction of innovation and
production. One of the most important findings of Acemoglu, Akcigit, Hanley, and Kerr (2016)
is that the nature of innovations in clean or dirty technologies is path dependent. Similarly, there
is path-dependence in innovation in the model of the consequences of the shale gas revolution by
Acemoglu, Aghion, Barrage and Hemous (2019). Grubb, et al. (2020) and Baldwin, Cai, and Ku-
ralbayeva (2020) develop models of path-dependency due to the costs of switching from the dirty
technologies. Aghion, Dechezlepr^
                                etre, Hemous, Martin, and Van Reenen (2016) provide extensive
empirical evidence of path dependence in innovation in auto industry from aggregate spillovers and
from the firm's own innovation history. Meng (2016) finds significant evidence for strong path de-
pendence in energy transition for the U.S. electricity sector over the 20th century, focusing on coal.


                                                  12
Fouquet (2016) is a summary of evidence that energy systems are subject to strong and long-lived
path dependence due to technological, infrastructural, institutional and behavioral lock-ins. A re-
cent strand of the climate economics literature (Lemoine and Traeger 2014; Lontzek, Cai, Judd,
and Lenton 2015; van der Ploeg and de Zeeuw 2018, and Cai and Lontzek 2019) has attempted
to incorporate hysteretic effects through the tipping point modeling. Dietz, Rising, Stoerk, and
Wagner (2020) synthesize a number of different approaches in this literature into a meta-model and
argue for the need to develop sophisticated models of hysteretic behavior.4
    Finally, careful consideration of uncertainty such as in Temzelides (2016), Li, Narajabad, and
Temzelides (2016), Traeger (2017), Cai and Lontzek (2019), Brock and Hansen (2018), Van den
Bremer and van der Ploeg (2018), Barnett, Brock, and Hansen (2020), Giglio, Kelly, and Stroebel
(2020), Kotlikoff, Kubler, Polbin, and Scheidegger (2020) and Lemoine (2021) has been another
important theme of recent research on economics of climate change.


3.3    Climate hysteresis functional

In this section, we analyze a particular hysteresis functional that captures the most important
elements of the abstract setting that we develop in Section 4 and allows to transparently show how
the solution in the general environment works.
    Specifically, let
                                                                    t
                                    ht ct = gt wt ct +                  ks,t wt cs ds,                              (4)
                                                                0

where ct denotes the amount of emissions at time t.5 Here, there are two sources of the effects
of emissions. The first source is contemporaneous. The amount of emission ct yields climate
externality equal to gt wt , where gt is a functional of the path of uncertainty wt . The second
source is the effect of the past emissions cs . Each of the emissions in the previous period cs
contributes ks,t wt to the climate externality ht at time t, where ks,t is a functional of the path
of uncertainty wt . It is important to note that both of these terms are path-dependent.6
    We observe that with the functional (4) the optimization problem (3) becomes intractable for
the stochastic control approach. Indeed, two possibilities for such approach would be either to
introduce a control ct or to introduce an additional control xt = ht (ct ). Both approaches lead to
   4
      Section 6.6 further elaborates on an example of the use of our methodology with tipping points.
   5
      Strictly speaking, the functional in this section depends on both the path ct and wt while we consider in Section
4 the functional ht ct . The extension to allow for the dependence on the path wt is immediate. Further, for the
analysis of the stochastic elasticity in Section 5.1, the underlying optimal process ct = wt and, hence, this is without
loss of generality.
    6
      Remark 2 in Section 4.1 further discusses motivation for this example as a representation of stochastic integrals.


                                                          13
complicated infinite-dimensional HJB equations. The first is due to the complicated structure of
the control space. The second is due to the path dependent first order condition for the process x.7


3.4    First-order conditions

We derive the first order conditions of the problem (3) with the climate hysteresis functional (4)
by perturbing the process c by a an adapted process z and computing the derivative in  at  = 0 :

               T                                                                                      t
                      1
     E               - (ct + zt - wt )2 -             gt wt (ct + zt ) +                                  ks,t wt (cs + zs ) ds   dt         =
           0          2                                                                           0                                     =0
                T                                                   t
      =E                 zt wt - ct zt -    gt wt zt +                  ks,t wt zs ds                      dt =
            0                                                   0
                T                                          T
      =E            zt wt - ct -           gt w t +            kt,s (ws ) ds                    dt = 0,
            0                                          t


where the last line is obtained by changing the order of integration. Since z is an arbitrary adapted
process we get the first order conditions

                                                                                          T
                                     ct = wt -        gt w t + E                              kt,s (ws )ds Ft       .                            (5)
                                                                                      t


The term
                                                                                  T
                                             t = gt w t + E                           kt,s (ws )ds Ft                                            (6)
                                                                              t

plays the central role in Golosov, et al. (2014) and is the marginal externality damage from
emissions, it also is equal to the optimal Pigouvian tax that corrects this externality. Specifically,
in our setting there are two effects of the marginal change in the emission ct . First, there is the
immediate damage gt wt . Second, there are marginal damages in each future period s, given by
kt,s (ws ) . These damages are then integrated and evaluated as the expectation conditional on the
information up to time t.
    It is important to note the difference with the case with no hysteresis, where the externality is
a function gt (wt ) and not a functional of the trajectory wt . First, the future expected marginal
                     T
damage E            t    kt,s (ws )ds Ft is absent in that case as the change in emissions today does not have
effects on the future. Second, the contemporaneous effects gt wt also may be significantly different
    7
      Of course, for some special cases there is no need to use the theory we develop. In Section 6 we show, whenever
possible, how to derive the results using known tools. One interesting class of examples can be solved by extracting
a martingale and then using the Clark-Ocone formula. In Section 6.3 and Remark 3 we show how to do this for the
                                             t
case of cumulative hysteresis ht (ct ) = ct 0 cs ds; in Section 6.4 and Remark 4 we show how to do this for when the
kernel ks,t is mutliplicative. We further expand on this class of examples in Boulatov, Riabov, and Tsyvinski (2020).


                                                                         14
from gt (wt ) as it depends now on the path wt . Even if emissions have no immediate effects, the
past effects and the expected cumulative effects may be very significant. In other words, both the
past and the future non-trivially matter.
   Our primary interest is in providing the evolution of the marginal externality damage, that is,
in the semimartingale decomposition dt = t wt dt + t wt dwt . This decomposition can be
thought of as the evolution of the marginal externality damage (or the optimal Pigouvian tax) with
respect to time dt, the drift, and with respect to the realizations of uncertainty dwt , the diffusion
                                                          T
coefficient. Since both the terms gt wt and E            t    kt,s (ws )ds Ft are path-dependent, we cannot
use the standard It^
                   o formula as it applies only to the functions and not to the functionals of the
path. We proceed by analyzing the present and the future effects separately as the analysis requires
the use of different methods.


3.5    Present effects of the emissions path

The present damage gt wt of the current emissions is already a well-defined functional of the path
wt . We use a recently developed Dupire's functional It^
                                                       o formula for the non-anticipative functional
(Dupire 2009, 2019; Cont and Fournie 2013) to represent this term.
   We first introduce two derivatives due to Dupire (2009, 2019): the vertical and the horizontal
derivative. These are, respectively, the functional analogues of the space and of the time derivatives.

Definition 1. (Vertical Derivative) Let D[0, t] be the space of c`
                                                                 adl`
                                                                    ag paths. The vertical
derivative of a functional h : D[0, t]  R is the limit

                                                       h(c + et ) - h(c)
                                    ct h(c) = lim                            ,
                                               0


where et (s) = 1s=t .

   Intuitively, this derivative measures an influence on the functional of a (discontinuous) bump
to the path at time t (Figure 1). If the functional is just the function of current realization of the
path, this yields the usual derivative h (ct ) .

Definition 2. (Horizontal derivative) Let z : [0, T ] × D[0, T ]  R be an adapted functional on
the space of trajectories. The horizontal derivative t is defined as a limit

                                                       zt+ (c·, ) - zt (c)
                                    t zt (c) = lim                           ,
                                                   0



                                                       15
                       Figure 1: Dupire's vertical derivative: path perturbation


where c·, is an extension of the path c from [0, t] to [0, t + ] by cs, = ct for t  s  t + .

    Intuitively, this derivative freezes the path of the underlying process at time t, extends it for a
small time      and evaluates the functional zt+ on this extended path (Figure 2). If the functional
zt is just the function of the value of the path at time t, this yields the usual time derivative of
(t zt )(ct ).




                      Figure 2: Dupire's horizontal derivative: path perturbation

    If the functional gt wt does not depend on the path of policies and is a function f (wt , t) of
only the current realization of uncertainty and of time, we can use the usual It^
                                                                                o formula. For its
application, we need to ensure that the first and the second order space derivative f1 (wt , t), f1 (wt , t)
and the time derivative f2 (wt , t) exist. When, as is the case in this section, there is hysteresis to
                       o formula we need to make a similar assumption on the functional gt wt
apply the functional It^
as in the case of it being a function but with different notions of derivatives.



                                                    16
Lemma 1. (Functional It^
                       o Formula: Dupire, 2009, 2019; Cont and Fournie, 2013) Let
xt be an It^
           o process, dxt = bt dt + t dwt , where the drift coefficient bt and the diffusion coefficient t
are adapted functionals of w. Let gt be horizontally differentiable and twice vertically differentiable
functional on the space of c´  ag paths. Then the process gt (xt ) is an It^
                            adl´                                           o process with the stochastic
differential
                                                              1 2
                      dgt xt = t gt (xt )dt + ct gt (xt )dxt + c  gt (xt )(t )2 dt.                   (7)
                                                              2 t

   The lemma gives a semimartingale decomposition of the functional gt xt . It is similar in form
to the usual It^
               o formula that applies to the functions of the state. However, the time derivative of
a function is replaced by the horizontal derivative of the functional t ; the first and second space
                                                                                             2 . Of
derivatives of the function are replaced by the first and second vertical derivatives ct and ct

course, if there is no path-dependency and gt is a function rather than a functional, one recovers
the usual It^
            o formula.
                         o formula to gt wt we obtain
   Applying functional It^

                                                 1 2
                       dgt wt =      t gt (wt ) + c  gt (wt ) dt + ct gt (wt )dwt .
                                                 2 t



   Summarizing the results in this section: the drift of the dynamics of the present effects of
the emissions is determined by the horizontal and the second vertical derivative and the diffusion
coefficient is given by the vertical derivative of the present marginal effects of the policy functional.
This result both parallels and differs from the case of no hysteresis where, similarly, the first and
second order derivatives matter for the dynamics. However, the notion of the derivative is very
different as the horizontal and the vertical derivatives measure how hysteresis functionals change
with the whole past trajectory. Even if there are no direct contemporaneous effects of the policy,
its dependence on the past may lead to significant effects on the dynamics of optimal policy. At
the same time, using these different notions of the derivatives the functional It^
                                                                                 o formula allows us
to convey the similar intuition as in the case of no hysteresis. In particular, uncertainty represents
itself in the second vertical derivative of the functional gt wt by affecting the drift and in the first
vertical derivative of the functional affecting the diffusion coefficient.




                                                   17
3.6     Expected future effects of the emissions paths

The most challenging part of the paper is to characterize the dynamics of the expected future
                                                                                                       T
marginal effects of current emission represented by the conditional expectation process E             t    kt,s (ws )ds Ft .
           T
Let t =   t    kt,s (ws )ds. Note that the conditional expectation process E t |Ft is in general not a

martingale. For example, if ks,t = 1, then t = T - t and we have E t |Ft = T - t. Also note that
t is not adapted in general. The difficulty more broadly comes from the fact that in the conditional
expectation both the process t and the filtration Ft are changing with time.


3.6.1    Total derivative formula for conditional expectations

In this section, we derive a new total derivative formula for conditional expectation processes ­ this
is the main new theoretical tool that we develop in this paper. A more general statement of the
result and a complete proof is given in the Appendix. Here, we state a simpler version of the result
and an outline of a heuristic proof.

Definition 3. The Malliavin derivative of the cylindrical functional f (w) = g (wt1 , . . . , wtk ), where
                                                                         k
t1 < . . . < tk and g is a smooth function, is defined by Dt f (w) =     i=1 i g (wt1 , . . . , wtk )1tti .   This
defines a closable linear operator D : L2 ()  L2 ( × [0, T ]). Its closure is also denoted by D and
is called the Malliavin derivative operator.

   Intuitively, a Malliavin derivative is a change in a functional due to a perturbation of the whole
path of the process (Figure 3).




                           Figure 3: Malliavin derivative: path perturbation



                                                   18
   The next proposition states the total derivative formula, the main technical tool that we develop
in this paper.

Proposition 1. (Total derivative formula) Let an adapted square integrable process (Xt )0tT
be represented as
                                                Xt = E[t |Ft ].

Let (t )0tT be a Malliavin differentiable square integrable absolutely continuous process, that is,
                                     t
a process of the form t = 0 +       0 s ds,   where  and  may be anticipative. Then,


                                  dXt = E[t t |Ft ]dt + E[Dt t |Ft ]dwt ,                                         (8)


where D is a Malliavin derivative.

Proof. The Clark-Ocone formula gives

                                                         T
                                     t = E [t ] +             E[Dr t |Fr ]dwr .
                                                     0


Taking the conditional expectation leads to

                                                          t
                                    Xt = E [t ] +             E[Dr t |Fr ]dwr .
                                                      0


The total derivative is then

                                                                                     t
                    dXt = E [t t ] dt + E[Dt t |Ft ]dwt +                                E[Dr t t |Fr ]dwr dt =
                                                                                 0
                                                                             t
                        = E[Dt t |Ft ]dwt + E [t t ] +                           E[Dr t t |Fr ]dwr dt.
                                                                         0


Note now that by the Clark-Ocone formula applied to the derivative t t :

                                                             T
                                 t t = E [t t ] +                E[Dr t t |Fr ]dwr ,
                                                         0


and taking the conditional expectations:

                                                                     t
                               E[t t |Ft ] = E [t t ] +                  E[Dr t t |Fr ]dwr .
                                                                 0


The total derivative is then given by (8).

                                                      19
    The lemma provides a time-dependent extension of the Clark-Ocone formula for processes that
can be represented as a conditional expectation of an absolutely continuous process.8 The first
term, E[t t |Ft ], can be thought of as a time derivative of this variable and represents how the
conditional expectation evolves with respect to time. The second term, E[Dt t |Ft ], can be thought
of as a stochastic derivative with respect to the underlying process wt and represents how the
conditional expectation changes with the changes in wt .9


3.6.2    Semimartingale decomposition of the expected future effects of policy paths

We now make mild assumptions on the kernel kt,s ­ absolute continuity of the kernel in variable t
and Malliavin differentiability as a functional from ws ­ and apply the total derivative formula to
                                                             T
the expected future marginal damages, E                     t    kt,s (ws )ds Ft :


              T                                  T                                       T
  dE              kt,s (ws )ds Ft = E t              kt,s (ws )ds Ft dt + E Dt               kt,s (ws )ds Ft dwt =
          t                                  t                                       t
                                            time derivative                     stochastic derivative
                                            T                                                    T
                                =E            t kt,s (ws )ds       Ft -   kt,t wt dt + E           Dt kt,s (ws )ds        Ft dwt .
                                        t                                                      t
                                                       time derivative                            stochastic derivative


                                                                                                                T
The meaning of this equation is straightforward. The conditional expectation dE                                t    kt,s (ws )ds Ft
measures the effects of the change in the emissions in period t on the expected future marginal
externality kt,s (ws ) in all periods s (s  [t, T ]). The time evolution of the conditional expectation is
given by the analogue of the time derivative. The stochastic evolution of the conditional expecta-
tion is given by a stochastic derivative of the cumulative change in all marginal effects of emission
in time t on all future periods s with respect to variation in the underlying process w.




   8
      See Section 7.3 for the more detailed discussion of the relationship of our total derivative formula to the Clark-
Ocone formula.
    9
      The process (t ) in Proposition 1 need not be adapted, and we can understand the process Xt = E[t |Ft ] as
the adapted projection of the process  . In Proposition 1 we thus prove that an adapted projection of an absolutely
continuous process is necessarily an It^o process. In the Appendix 9.6 we show the converse to this clam ­ any It^     o
process can be represented as such projection.


                                                                  20
3.7   Dynamics of the marginal externality damage

We can now collect the results of the previous two sections. We obtain the dynamics of the marginal
externality damage

                                                                      T
                                    1 2
           dt = -       t gt (wt ) + c  gt (wt ) + E                      t kt,s (ws )ds Ft - kt,t wt   dt+
                                    2 t                           t
                                         T
                 + ct gt (wt ) + E           Dt kt,s (ws )ds Ft             dwt .
                                     t


This, we believe, is an important result as it solves in the closed form the dynamics of the evolution
of the marginal externality damage or the optimal Pigouvian tax. This formula shows how the
policymaker should change the tax with the passage of time and with the realizations of uncertainty
­ that is, we determined the drift and the diffusion coefficients of the process of the optimal
Pigouvian tax.
   A related way to think about this result is that it determines what features of the model matter
up to the first order. For the time updating, the functional It^
                                                               o formula shows that the horizontal
and the second order vertical derivative are important and the total derivative formula shows that
the "time derivative" of the expected cumulative damages are important. For the updating with
the movement of uncertainty, the functional It^
                                              o formula shows that the vertical derivative and the
total derivative formula shows that the "stochastic derivative" of the expected cumulative marginal
damages are important.
   We also immediately obtain the dynamics of the optimal emission policies from equation (5) in
closed form:

                                                                      T
                                   1 2
           dct = -     t gt (wt ) + c  gt (wt ) + E                       t kt,s (ws )ds Ft - kt,t wt   dt+
                                   2 t                            t
                                                    T
                 + 1 - ct gt (wt ) - E                  Dt kt,s (ws )ds Ft          dwt .
                                                t


   We thus extended the result of the macro-climate model of Golosov, et al. (2014) to the case
with the path-dependent hysteresis given by (4). Note that all of the results here are given in
closed form. The next sections show that the main insights derived with this specifications apply
to general hysteresis functionals.




                                                             21
4     General hysteresis functionals

We now return to the analysis of the problem (3) for a general hysteresis functional.


4.1    The class At of path-dependent functionals

In this section we describe a class of path-dependent functionals At which, in a sense, is parallel
to continuously differentiable functions of a real-valued argument. It will turn out that this class,
while very general, allows significant tractability in the analysis of path-dependent problems. The
introduction of this class of functionals is one contribution of our paper.

Remark 1. Adding a path-dependent functional ht can considerably change the structure of the
optimal policy. For example, consider the functional ht (c) = c t that describes the effects of the
                                                                               2

policies at the middle of the time period [0, t]. We show in the appendix that the optimal policy is
                                                  T
no longer continuous and has a jump at t =        2.

                           echet derivative of a functional ht : C [0, t]  R at a point c  C [0, t] is a
    Let us recall that a Fr´
signed measure µ on [0, t] such that

                                                     t
                        ht (c + z ) = ht (c) +           zs dµ (t, s) + o ( z ) , z  0.
                                                 0


The primary difficulty with this formulation is that it features a very general dependence of the
measure µ on time t. The next assumption structures this dependence.

Assumption 1. (Class At ) Suppose the (Fr´
                                         echet) derivative of the functional ht has an absolutely
continuous part and an atom at point t:

                                                               t
                 ht (c + z ) = ht (c) + ct ht (c)zt +              s ht (c)zs ds + o ( z ) , z  0.
                                                           0


The family of such functionals is denoted by At .

    This assumption on the derivative of functionals means that there are two sources of variation
for ht : an instantaneous influence of a perturbation at the moment t given by an atom and an
integral influence of perturbations at previous moments s  t which is an absolutely continuous
process. Assumption 1 is mild ­ it only requires that the derivative of a functional (which is a
measure) is absolutely continuous and has an atom at the present time.



                                                          22
       The class At contains a variety of functionals:


                                                 ht (c) = f (ct ),


which is state-dependent but not path-dependent;

                                                                            t
                                         ht (c) = ft (ct ,                      gt (cs )ds),
                                                                        0

                                                                                                t
which jointly depends on state ct and the integral influence of the path                       0 gt (cs )ds   and, moreover,
both the joint dependence ft and the effects of the past policies gt depend on time t;

                                                        t       t
                                    ht (c) = ft (                   gt (cs , cr )dsdr, ...)
                                                    0       0


where now there is a joint dependence on the past values cs and cr via a repeated integral.
       The proposition that follows shows that this assumption covers a very general class of function-
als.

                       echet differentiable functional g : C [0, T ]  R is a pointwise limit of
Proposition 2. Every Fr´
functionals from the class AT .

Proof. In the appendix.

       We next explore the nature of the present marginal influence of policy ct ht which is itself a path-
dependent functional. The lemma that follows (proven for a more general case in the appendix)
connects Dupire's vertical derivative to the derivatives of the functionals in the class At .

Lemma 2. Let the functional ht be in the class At , then ct ht (c) is the vertical derivative in the
Dupire sense.

Remark 2. We now discuss some additional motivation behind Assumption 1. Consider, for exam-
ple, hysteresis given by an It^
                              o process:

                                                                        t
                                              ht (c) =                      bs dcs ,                                     (9)
                                                                    0


where b is an absolutely continuous function. The functional ht (c) in equation (9) is well-defined
if and only if the process (cs )0st is of bounded variation. This is not true for an arbitrary
progressively measurable process (cs )0st , and we cannot expect that the optimal policy process

                                                            23
will be of bounded variation. For example, in our baseline case of Section 2.1 ct = wt and then

almost all realizations of c are of unbounded variation. However, if the coefficient b is absolutely
continuous, then we can integrate (9) by parts and rewrite ht (c) in the form:

                                                              t
                                           ht (c) = -             bs cs ds + bt ct .
                                                          0


Further, ht is just a linear functional from c :

                                                                                       t
                                      ht (c + z ) - ht (c) = bt zt -                       bs zs ds.
                                                                                   0


So, ht  At with ct h(c) = bt , s ht (c) = -bs .


4.2   Optimal policy: the first order conditions

In this section, we derive the first order conditions for the optimal process c . While in some
circumstances one can write a recursive formulation even for a path-dependent problem and then
find a Hamilton-Jacobi-Bellman equation, in general it is difficult or impossible to do it. Here, we
instead find the first order conditions for optimal policy using a variational method.

Proposition 3. (The first order conditions for the optimum) Let the optimal policy process
c solve (3), then
                                                                           T
                         ct = wt -         ct ht ((c )t ) + E                  t hs ((c )s )ds Ft                .          (10)
                                                                       t

Proof. Perturb the process c by z, where z is an adapted process, and compute the derivative in
 at  = 0 :

                             T
                                   1
                     E            - (ct + zt - wt )2 - ht (ct + z t ) dt                                    =
                         0         2                                                                   =0
                              T                                                            t
                    =E             zt wt - ct zt -     ct ht (ct )zt +                         s ht (ct )zs ds       dt =
                          0                                                        0
                              T                                                T
                    =E            zt wt - ct -        ct ht (ct ) +                t hs (cs )ds              dt = 0.
                          0                                                t


Since z is an arbitrary adapted process, we get the first order conditions (10). The importance
of Assumption 1 is evident in particular in the third line of the proof. If we did not impose this
                                                  T
assumption, then instead of the integral         t    t hs (cs )ds we would have a general measure µt (cs , [t, T ])
which can even be discontinuous in t. Assumption 1 imposes a smooth structure for this measure


                                                           24
by requiring that the measure has an absolutely continuous part.

     This equation (10) has a natural economic meaning. When hysteresis ht is present, the solution
to the optimal problem (ct = wt ) is modified by the two terms. The first term,



                                                  It = ct ht (c ),


is the instantaneous marginal effect of the change in the policy ct on functional ht . The second
term gives the future marginal effects of policy ct

                                                         T
                                        Ft = E               t hs ((c )s )ds Ft .
                                                     t


on the values of all future hysteresis functionals hs ((c )s ). For each time s (where t  s  T ),
the marginal effect of changing policy in period t is represented by the derivative t hs ((c )s ) of the
functional hs with respect to change in policy at time t. These marginal effects are evaluated as
a conditional expectation at time t and hence represent the expected future marginal effects. It is
useful to think about the term Ft as the cumulative impulse response of the change of the policy
today on all future hysteresis functionals. This is similar to Alvarez and Lippi (2019), Alvarez, Le
Bihan, and Lippi (2016), Alvarez, Lippi, and Oskolkov (2020) and Borovicka, Hansen, Scheinkman
(2014), Borovicka, Hansen, Hendricks, and Scheinkman (2011), and Borovicka and Hansen (2016).
Note that Ft is a conditional expectation process that may non-trivially change with time as both
the marginal effects t hs and the filtration Ft changes.
     Both terms depend on the path of policy c[0,s] = (c )s . As seen here, the assumption that the
functional ht is in the class At allows us to conveniently separate the first order condition in two
parts: the marginal effects of the policy on current period It and the conditional expectation of the
cumulative future marginal effects of policy paths in the future, Ft .


5        Characterizing the general problem

This section is divided into two main parts. Section 5.1 derives a closed-form characterization of
the change in the optimal policy when hysteresis is small. Section 5.2 provides a characterization
of the optimal policy.10

    10
     It may be useful for a reader to also consider an example in the appendix that provides a parallel characterization
for the case with no path-dependency.


                                                              25
5.1     Stochastic hysteresis elasticity and its dynamics

In this section we derive a closed-form characterization of the change in the optimal policy when
hysteresis is small. We call this first order process a stochastic hysteresis elasticity. We char-
acterize the dynamics of the stochastic elasticity in closed form by providing its semimartingale
decomposition which is the main contribution of this section.


5.1.1    Stochastic hysteresis elasticity

We first formally define the stochastic hysteresis elasticity. This is the first order process that
represents the change in optimal policy process c in response to introduction of an infinitesimal
path-dependent hysteresis functional ht .

Definition 4. (Stochastic hysteresis elasticity) Let ct be a solution to the baseline problem

(1) and ct be a solution to the problem (3), where hysteresis is given by the functional ht ,        0.
                                                                 h is such that
The first-order process or the stochastic hysteresis elasticity Ct


                                         ct = c     h
                                               t + Ct + o( ).


                              h is the change to the first order in the optimal policy process in
   The stochastic elasticity Ct
response to a small change in the hysteresis h. In this sense, it is similar to the usual concept of
elasticity but now determines how the whole process ct changes.             From now on, to ease notation
                           h on h and denote it simply by C .
we drop the dependence of Ct                               t

   Differentiating (10) with respect to     at   = 0, and recalling that c0    
                                                                          t = ct = wt we find the

process Ct explicitly
                                                           T
                              Ct = -ct ht (wt ) - E            t hs (ws )ds Ft .                     (11)
                                                       t

This equation is already interesting by itself as it presents the change in the optimal policy plan
due to the introduction of the path-dependent effect. Moreover, it is given in closed form.
   We now turn to presenting the main result of this section ­ showing that Ct is an It^
                                                                                       o pro-
cess and, most importantly, writing its explicit semimartingale decomposition. We are seeking a
representation
                                    dCt =  wt dt +  wt dwt ,

where  and  are potentially path-dependent. In other words, we want to determine the dynamics
of the stochastic elasticity Ct .

                                                  26
5.1.2      Present effect of the policy path

This section provides a semimartingale decomposition of the term ct ht (c ) ­ the present effect of
the path of policies (c )t = wt . The principal tool that we use is Dupire's functional It^
                                                                                          o formula in
Lemma 1 that applies to the non-anticipative functionals of the path. We now make an assumption
that allows the use of this formula.

Assumption 2. There exists a non-anticipative functional q : [0, T ] × D[0, T ]  R which is
horizontally differentiable, twice vertically differentiable and is such that qt (c) = ct ht (c). In other
                                                      1,2
words, the derivative ct ht (c) can be extended to a Cb   -functional on the space of c´
                                                                                       adl´
                                                                                          ag paths. We
denote this extension also by ct ht (c).

                             o formula, and noting that c
   Applying the functional It^                           t = wt we obtain a semimartingale

decomposition of the functional ct ht (c ) that depends on the whole history of policy (c )t = wt :

                                                                       1
                d(ct ht (c )) = t ct ht (wt ) dt + ct ct ht (wt ) dwt + ct c
                                                                           2
                                                                              h (wt ) dt,
                                                                             t t
                                                                       2

and gathering the terms we obtain the following lemma.

Lemma 3. (Dynamics of the present effect, It ) The semimartingale decomposition of the
present marginal effects, It , of the policy path is given by

                                                           1 3
                      d(ct ht (c )) =     t (ct ht (wt )) + c  ht (wt ) dt + c
                                                                             2
                                                                               h (wt )dwt .
                                                                              t t
                                                                                                     (12)
                                                           2 t

   This part of the derivation is already interesting as a stand-alone result. The reason why one can
apply the Dupire and Cont-Fournie analysis is that ct ht (c ) is already represented as a functional
of the path. The decomposition (12) then has the same intuitive meaning as the standard It^
                                                                                          o's
formula but now applies to the functional of the past, not the function of the present realization.
Note that we are already applying the functional It^
                                                   o's formula to the marginal effects, that is, to
the vertical derivative of the functional ct ht (wt ). Hence, there are the second, c
                                                                                    2 , and the third,
                                                                                     t

3 , vertical derivatives as well as the mixed derivative   .
ct                                                       t ct



5.1.3      Expected future effects of policy paths

We now make an assumption on the derivative of the functional, t hs (c ), that is needed to apply
the total derivative formula of Proposition 1.11
  11
       In Section 7.2, we further discuss the smoothness assumptions for the functionals ht .


                                                           27
Assumption 3. The derivative t hs (c ) is an absolutely continuous in t and is a Malliavin differ-
entiable functional of the path ws .

   It follows that the future marginal effect of a given policy path is given by

                                         T                                            T
                                d                                                         
                                             t hs (c )ds = -t ht (c ) +                     (t hs )(c )ds.
                                dt   t                                            t       t

and its conditional expectation is given by the total derivative formula (8):

                   T                                       T                                                 T
        dE             t hs (c )ds Ft = E t                    t hs (c )ds Ft dt + E Dt                          t hs (c )ds Ft dwt .
               t                                       t                                                 t
                                                      time derivative                           stochastic derivative


The meaning of this equation is straightforward. The conditional expectation

                                                                     T
                                                  Ft = E                 t hs (c )ds Ft
                                                                 t


describes how a change in policy in period t determines the expected future marginal effects of that
policy t hs (c ) in all periods s (s  [t, T ]). The time evolution of the conditional expectation is given
by the analogue of the time derivative. The stochastic evolution of the conditional expectation is
given by a stochastic derivative of the cumulative change in all marginal effects of policy t on all
future periods s with respect to variation in the underlying process w. Collecting the terms gives
us the dynamics of the future effects of policy and shows that it is an It^
                                                                          o process.

Lemma 4. (Dynamics of the future effects, Ft ) The semimartingale representation of the
future marginal effects, Ft , of policy paths is given by:

                       T
          dE               t hs (c )ds Ft =
                   t
                                         T                                                           T
                                                 
          = -t ht (wt ) +                    E     (t hs )(ws ) Ft ds dt + E Dt                          t hs (ws )ds Ft dwt .          (13)
                                     t           t                                               t




                                                                         28
5.1.4     Dynamics of the stochastic elasticity

We now combine the results of the decompositions of the present effects (12) and the future effects
(13) of policy and recalling that ct = wt :


                               1 3
      dCt = - t ct ht (wt )dt + c  ht (wt )dt + c
                                                2
                                                  h (wt )dwt -
                                                 t t
                               2 t
                            Present effects: functional It^
                                                          o
                                         T                                                    T
                                            
            -   -t ht (wt )dt + E              (t hs )(ws )ds     Ft dt + E                       Dt (t hs (ws )) ds Ft dwt ,
                                       t    t                                             t
                                                    Future effects: total derivative


where in the last term we interchanged the Malliavin derivative and the integral.
   Collecting the terms gives the semimartingale decomposition of the first order process Ct in
closed form.

Theorem 1. (Dynamics of stochastic elasticity) The semimartingale decomposition of the
stochastic elasticity Ct is given by

                                                                                      T
                                 1 3                                                      
          dCt = - t ct ht (wt ) + c  ht (wt ) - t ht (wt ) + E                              (t hs )(ws )ds Ft       dt-
                                 2 t                                              t       t
                                             T
                   2
                 - c  h (wt ) + E
                     t t
                                                 Dt (t hs (ws )) ds Ft         dwt .                                        (14)
                                         t


   This theorem shows that the optimal process ct changes with the introduction of hysteresis,

that is, the additional infinitesimal path-dependent effect of policies. The equation (14) gives the
first order process in closed form as

                                         h
                                       dCt = t wt dt + t wt dwt ,


where  and  are path-dependent coefficients.


5.2     Dynamics of optimal policy

We now characterize the dynamics of the optimal policy.
   In this section, we assume that = 1, without loss of generality. The first order conditions (10)
become
                                                                       T
                               wt = ct + ct ht (ct ) + E                   t hs (cs )ds Ft .
                                                                   t




                                                            29
Let us take the differential of this equation assuming that c is an It^
                                                                      o process, i.e.


                                                          dct = t dt + t dwt .


The present marginal effects of the policy are differentiated using the functional It^
                                                                                     o formula (7):

                                                                          1 3
                         d ct ht (ct ) = t ct ht (ct )dt + c
                                                           2
                                                              h (ct )dct + c
                                                             t t
                                                                              ht (ct )t
                                                                                      2
                                                                                        dt.
                                                                          2 t

The future expected marginal effects of the policy are differentiated using the total derivative
formula (8):

               T                                              T                                             T
  d E              t hs (cs )ds Ft         = E t                  t hs (cs )ds Ft dt + E                        Dt (t hs (cs )) ds Ft dwt =
           t                                              t                                             t
               T                                                                  T
   =E              t (t hs (cs )) ds Ft dt - t ht (ct )dt + E                         Dt (t hs (cs )) ds Ft dwt .
           t                                                                  t


The differential of the first order conditions is then given by

                                                            1 3
               dwt = dct + t ct ht (ct )dt + c
                                             2
                                                h (ct )dct + c
                                               t t
                                                                ht (ct )t
                                                                        2
                                                                          dt+
                                                            2 t
                             T                                                               T
               +E                t t hs (cs )ds Ft dt - t ht (ct )dt + E                         Dt (t hs (cs )) ds Ft dwt .
                         t                                                               t


Collecting the terms near dt and dwt we derive dynamics of the optimal policy:
    
             2 h (ct )) + 1  3 h (ct ) 2 +   h (ct ) + E                                          T
    0 = (1 + c                                                                                        t t hs (cs )ds Ft - t ht (ct ),
    
               t t     t  2 ct t           t ct t
                                      t                                                          t

             2 h (ct )) + E                    T
                                                   Dt (t hs (cs )) ds Ft ,
    
    1 = (1 + c
    
               t t     t                      t


and the next theorem characterizes the drift and diffusion coefficients of the optimal policy.

Theorem 2. (Optimal policy) The dynamics of optimal policy is given by:

                                                                                                 T
                        1              1 3
     t = -                               ht (ct )t
                                                 2
                                                   + t ct ht (ct ) + E                               t t hs (cs )ds Ft - t ht (ct ) ,
                    2 h (ct )
                1 + ct t
                                       2 ct                                                  t
                          T
           1-E           t       Dt t hs (cs )ds Ft
     t =                    2 h (ct ))
                                                      .
                       (1 + ct t



   We can compare this theorem to the results without hysteresis, where there are only contempo-



                                                                       30
raneous effects of the policy f (ct ), the details of which are in the appendix. The diffusion coefficient
t is determined by two terms. The first term, in the denominator, contains the vertical deriva-
tive of the present marginal effects of the policy ct ct ht (ct ) and measures the change in the
present marginal costs due to a "bump" in the trajectory of the costs. This is an analogue of the
term f (ct ) for the case without hysteresis. The second term, in the numerator, is the stochastic
                 T
derivative E    t    Dt t hs (cs )ds Ft which measures impact of the change in the trajectory of the
stochastic process on the expected future marginal effects in all periods. This term is not present
in the case without hysteresis.
   The drift coefficient t is determined by three terms. The first term, in the denominator, is the
same relative scaling as in the case of t . The second set of terms is the time evolution of the present,
                                     T
t ct ht (ct ), and future, E t      t    t hs (cs )ds Ft , marginal costs. The analogue of the horizontal
derivative t ct ht (ct ) for the case without hysteresis would be the time derivative t f (ct , t). The
time evolution of the future marginal costs are is in the case without hysteresis. The third term is
the quadratic variance of the present marginal costs, 1 3       t 2
                                                      2 ct ht (c )t . It is a path-dependent analogue
   1
of 2 f (ct ) (t )2 in the case without hysteresis.
   The equations Theorem 2 characterize the drift and diffusion coefficients implicitly in contrast
to the explicit form we obtained in Theorem 1. The explicit form we obtained for the stochastic
elasticity thus can be thought of as a characterization of the optimal process for small hysteresis,
or small hysteresis asymptotics.

Remark. We now show that assuming that the marginal effect of policy t hs are in the class As ,
we can compute Malliavin derivatives Dt t hs (cs )ds in Theorem 2 in a more detailed way.

Corollary. Let t hs be in the class As , then

                                                                     s
                          Dt t gs (cs ) = ct t hs (cs )Dt cs +           r t hs (cs )Dt cr dr,
                                                                 t


where the tangent process Dt cr is given by
                              
                              d(Dt cs ) = (Dt s )ds + (Dt s )dws , s > t
                              
                                                                                                                     (15)
                              D c =  .
                               t t  t


                                                                                                  t
Proof. Let us perturb the underlying Brownian motion: S (w, z )t = wt +                          0 zr dr,   0  t  T. Then




                                                       31
by the definition of the Malliavin derivative

                                                                          t
                                    ct (S (w, z )) = ct (w) +                 Dr ct (w)zr dr + o( ),
                                                                      0


where Dr ct is a tangent process. Hence,

                                                                                    s
       t hs (cs (S (w, z ))) = t hs (cs (w)) + cs t hs (cs )                            Dr cs (w)zr dr+
                                                                                0
                 s                      r
        +            r t hs (cs )           Du cr (w)zu dudr + o( ) =
             0                      0
                                         s                                              s
        = t hs (cs (w)) +                    zr cs t hs (cs )Dr cs (w) +                    u t hs (cs )Dr cu (w)du dr + o( ).
                                     0                                              r


The result follows.

    This characterization is useful as it uses the tangent process which has a particularly simple
form. When c is an It^
                     o process, its tangent process is also an It^
                                                                 o process with the drift and diffusion
coefficients being the Malliavin derivatives of the drift and diffusion coefficients of the process c.


6    Examples

In this section, we present a number of examples of the hysteresis functionals ht to illustrate how
to use our theoretical results. We also provide, whenever possible, an alternative derivation using
other tools. Section 6.1 is the user's guide that describes the steps needed to apply the theory we
developed. The first example, Section 6.2, revisits the case of no hysteresis. In this case, only the
present effects of the policy are present and the functional It^
                                                               o formula reduces to the usual It^
                                                                                                o
formula. There is no need to use the total derivative formula. The second example, Section 6.3,
considers cumulative hysteresis. The effects of the polices are a function of the current policy and
the integral of the past policies. For the case of the multiplicative dependence of the effects of the
current policies and the cumulative hysteresis, the stochastic elasticity takes a very simple form.
The present marginal effects of the policy path only have the horizontal derivative which measures
how the cumulant of the past policies changes with time and all of the vertical derivatives are equal
to zero. The total derivative formula for the conditional expectation of the future marginal effects
only has the stochastic derivative component which itself has a very simple form that measures how
lengthy the effects of the stochastic shock are. We expand on this class of examples in Boulatov,
Riabov, and Tsyvinski (2020) where we analyze such cases extracting a martingale and not using

                                                                 32
the main tools of this paper ­ the functional It^
                                                o formula and the total derivative formula. Our
third example, Section 6.4, studies hysteresis that depends both on time and the past policies. This
example captures three important parts of path-dependent policies. First, there is an effect of the
present policy. Second, there is an effect of the hysteresis. The hysteresis is represented by an
integral with a kernel that has joint dependence on current time and past policies. That is, path
dependency sophisticatedly changes with both the time and evolution of the past polices. Third,
there is a joint dependence between the present and the past. For this example, we need to utilize
all of the tools developed in the paper. The functional It^
                                                          o formula gives the evolution of the present
marginal effects of the policies in terms of horizontal and vertical derivatives. The total derivative
formula straightforwardly gives the evolution of the conditional expectation process in terms of the
time and stochastic derivative. We also consider a deterministic setting with hysteresis in Section
6.5. As there is no stochasticity, there is only evolution with respect to time or, rather, the history
of policies. We decompose its effects into the effects of the present and the past history. The present
marginal effect of policy then evolves as the first-order horizontal and the vertical derivatives. The
future marginal effects of policies evolve as their time derivative. In Section 6.6 we consider an
example with a tipping point in which the time when the stochastic process reaches the maximum
becomes a reference point.


6.1    The user's guide

In order to apply results from the previous section one needs to calculate a number of derivatives of
the functional (ht )0tT . In calculation of the first order conditions (10), we need to find a Fr´
                                                                                                 echet
derivative of ht :
                                                                 t
                      ht (c + z ) - ht (c) = ct ht (c)zt +           s ht (c)zs ds + o(||z ||).
                                                             0

For the application of Dupire's functional It^
                                             o's formula and finding the SDE for the present effects of
the path in Section 5.1.2 and equation (12) we need to calculate the horizontal derivative t ct ht (c)
                             2 h (c),  3 h (c). For the application of the total derivative formula
and two vertical derivatives c t t    ct t

(13) and finding the evolution equation for the future effects of the path we need to calculate
                                                                 
two types of derivatives of t hs (c): (a) time derivative        t t hs (c),    and (b) the Malliavin derivatives
Dt t hs (c),
    In other words, we first break the first order condition for the effects of policies of the present
and the effects of the past. The dependence of variables in the past implies that any change in a



                                                     33
variable affects all the future states. We then use the functional It^
                                                                     o formula to derive the evolution
equation for the effect on the present and the total derivative formula for the effects on the future.
The total derivative formula also requires calculations of the Malliavin derivatives.


6.2       No hysteresis: state-dependent perturbations

We start with the simplest case ­ the state-dependent perturbation where h is a function of the
current state rather than a functional. Consider the perturbation ht (c) = f (ct ), where f : R  R
is a smooth function. The list of derivatives becomes the following.
   The Fr´
         echet derivative of the functional is just the derivative of f :


                            ht (c + z ) - ht (c) = f (ct + zt ) - f (ct ) = f (ct )zt + o(||z ||).


Correspondingly, the present marginal effects of policy are given by the regular derivative


                                                       ct ht (c) = f (ct ),


and the effects of the past are
                                                      s ht = 0 for s < t.

In particular, we see that ht  At and s ht  At .
   We now turn to the analysis of the present effect of the policy path. The horizontal derivative
t (ct ht (c)) is equal to zero. Indeed, it is defined as a limit

                                                             ct+ ht+ (c·, ) - ct ht (c)
                                      t ct ht (c) = lim                                     ,
                                                        0


where c·, is an extension of the path c from [0, t] to [0, t + ] by cs, = ct for t  s  t + . It follows
that12
                                                 f (ct+ , ) - f (ct )            f (ct ) - f (ct )
                          t ct ht (c) = lim                             = lim                        = 0.
                                            0                               0

Vertical differentiation of the present marginal effect of policy is the regular differentiation of f :

                                          2                  3
                                          c h (c) = f (ct ), c
                                           t t
                                                                h (c) = f (ct ).
                                                               t t




  12                                                                                 2
       If we had ht (c) = f (ct , t) the only difference would be that t ct ht (c) = c t ,t
                                                                                            f (ct , t)


                                                                34
   We now turn to the analysis of the expected future marginal effects. The derivative in t of the
                                                                    
future marginal effects in period s : t hs (c), i.e.                t t hs (c)        is equal to zero, since t hs (c) = 0 :

                                                             
                                                               t hs (c) = 0.
                                                             t

The Malliavin derivative of t hs (c) is also zero, since t hs (c) = 0 :


                                                             Dt t hs (c) = 0.


   The formula for the dynamics of the stochastic elasticity (14) becomes:

                                  1 3
        dCt = - t ct ht (wt ) dt + c  ht (wt )dt + c
                                                   2
                                                      h (wt )dwt -
                                                     t t
                                  2 t
                           =0                     =f (wt )            =f (wt )
                                                      T                                                  T
                - -t ht (wt )dt + E                       t t hs (ws )ds Ft dt + E                           Dt t hs (ws )ds Ft dwt ,
                                                  t                                                  t
                                                                           =0


and
                                                 1
                                          dCt = - f (wt )dt - f (wt )dwt .
                                                 2

   We summarize the result. First, the present effect of the path from the Section 5.1.2 are given
by the standard space derivatives. The functional It^
                                                    o formula reduces to the usual It^
                                                                                     o's formula.
Second, all of the future effects of the path from are zero, hence, the conditional expectation is
zero.
   One can, of course, immediately get the result of this section by applying the It^
                                                                                    o formula to
f (ct ), see the Appendix.



6.3     Cumulative hysteresis
                                                                 t
Consider the hysteresis functional ht (c) = ct                  0 cs ds.   Here, the path-dependence enters cumulatively
as the integral of the past realization. The cumulative hysteresis is then multiplicative with the
current policy ct .
   We start with the Fr´
                       echet derivative of ht that appears in the first order conditions of the
problem (10). It is given by varying the whole path c[0,t] by a variation z[0,t] :

                                              t                                t                 t                        t
      ht (c + z ) - ht (c) = (ct + zt )           (cs + zs ) ds - ct               cs ds =           ct zs ds + zt            cs ds + o(||z ||).
                                          0                                0                 0                        0


                                                                    35
Correspondingly, the present marginal effects of policy are given by the integral of the path of
previous policies
                                                                          t
                                                    ct ht (c) =               cs ds.
                                                                      0

As all previous cs enter identically in the integral, the effects of the past marginally contributes ct :


                                                    s ht = ct for s < t.


In particular, we see that ht  At and s ht  At .
   The first order process is given by (11), recalling that ct = wt :

                                              T                                                   t                    T
            Ct = -ct ht (c[0,t] ) - E             t hs (c[0,s] )ds Ft = -                             ws ds - E            ws ds Ft .
                                          t                                                   0                    t
                                                                                         Present effect           Future effect


Note that in the future effects it is t hs (ct ) = cs = ws that enters as it shows how policy in period

t (t  s  T ) affects future period s.
   We now turn to calculation of the derivatives needed for the application of the Dupire's func-
tional It^
         o formula (12). Recall that the horizontal and two vertical derivatives are needed. The
horizontal derivative of the present effects of the path ct ht (c) is simply the time derivative of the
integral:
                                                                      t
                                  t (ct ht (c)) = t                       cs ds          = ct = wt .
                                                                  0

The vertical differentiation of the present effects of the path ct ht (c) is given by bumping the path
and is equal to zero:

                                                                                  t
                                        ct (ct ht (c)) = ct                           cs ds       = 0,
                                                                              0
                                        3
                                        c  h (c) = 0.
                                          t t




   We now turn to characterizing the expected future effects of policy using the total derivative
formula (8). Since the marginal effect of the policy at time t on time s, t hs (ws ) = ws , does not
depend on time, we get
                                                     t (t hs (ws )) = 0.




                                                             36
The Malliavin derivative is also simple as it measures the sensitivity of ws to the shock wt :


                                         Dt (t hs (ws )) = Dt ws = 1,


and the the stochastic derivative term of the future marginal costs becomes

                                                     T
                                       E Dt              t hs (ws )ds Ft = T - t.
                                                 t


This has a natural interpretation. The stochastic derivative measures the impact of the stochastic
                                                                                                                     T
shock dwt on the future marginal effects of policies. Those are represented by the integrals                        t    ws ds.
A shock at time t affects the future marginal effect of policy in each period sas Dt ws = 1. Since
there are (T - t) future periods, the shock dwt has the effect (T - t). In other words, the stochastic
shocks for early periods t have longer lasting impact than for the later periods.
   We then gather the present and the future terms to determine the dynamics of the first order
process in (14):

                                  1 3
        dCt = - t ct ht (wt ) dt + c  ht (wt )dt + c
                                                   2
                                                      h (wt )dwt -
                                                     t t
                                  2 t
                       =wt                       =0                      =0
                                             T                                            T
              - -t ht (wt ) dt+ E                t t hs (ws )ds Ft dt+ E                      Dt t hs (ws )ds Ft dwt ,
                                         t                                            t
                       =wt
                                                           =0                                      =T -t


   or
                                                 dCt = - (T - t) dwt .

Remark 3. There are two alternative ways, without using our methodology, to derive the result.
                               T
The first is to note that E   t    ws ds Ft = (T - t) wt and then


                        dCt = -wt dt - ((T - t) dwt - wt dt) = - (T - t) dwt .


The second approach that works in a variety of other circumstances is in extracting a martingale
and using the Clark-Ocone formula to provide its explicit characterization in terms of Malliavin
derivatives. We can rewrite

                                   T                                 T                    t
                          E            ws ds Ft = E                      ws ds Ft -           ws ds,
                               t                                 0                    0




                                                                37
and
                                t                         T                                    t                               T
               Ct = -               ws ds + E                 ws ds Ft -                           ws ds        = -E               ws ds Ft .
                            0                         0                                    0                               0

                                                                                                                                                 T
The Clark-Ocone formula gives the representations of the martingale where Mt = E                                                                0    ws ds Ft
as                                                                                                                
                                          T                                            T
               dMt = E Dt                     ws ds Ft dwt = E                             Dt ws ds Ft  dwt = (T - t) dwt .
                                      0                                            t
                                                                                                   =1

We expand on this class of examples in Boulatov, Riabov, and Tsyvinski (2020) where we analyze
a more general class of environments which can be solved by extracting a martingale and not using
the main tools of this paper ­ the functional It^
                                                o formula and the total derivative formula.


6.4       Hysteresis with time and past dependency
                                                           t
Consider the functional ht (ct ) = h(ct ,                 0 at,s cs ds),           it describes the interaction of the policy at the
present moment of time, and average of past values. The averaging is defined by the smooth kernel
                                                                                                                                         1
at,s which measures how policy in period s affects period t. For example, at,s =                                                         t   corresponds to
the usual averaging. Importantly, the kernel depends on current time t.
      This example captures three important parts of history-dependent policies. First, there is an
effect of the present which is represented by the first argument, ct . Second, there is an effect of
                                                                                                         t
the past which is represented by the second argument,                                                   0 at,s cs ds.   Here, the past enters as the
integral of the path of the previous consumptions where the path enters through the kernel at,s
that depends both on the current policy t and the path of previous policies.13 Third, there is a
joint dependence h (., .) between the present and the past.
      The Fr´
            echet derivative of ht that appears in the first order conditions (10) is given by changing
the whole path ct by a variation z t :

                                                                            t
                 ht (c + z ) - ht (c) = h ct + zt ,                             at,s (cs + zs ) ds - ht (c) =
                                                                        0
                                          t                         t                                   t
                  = zt h1 ct ,                at,s cs ds +              at,s h2 ct ,                        at,r cr dr zs ds + o(||z ||).
                                      0                         0                                   0


Correspondingly, the present marginal effects of policy are given by the integral of the path of


     13                                                                                                                                         t
    One can easily modify this part to be some more complicated path-dependent object ­ for example, 0  c[0,s] ds,
where  is a functional of the path or to have arbitrary interaction of the past effects; or allow for ht (c) =
 t t
     g (c , c )dsdr), ... where now there is a joint dependence on the past values cs and cr via a repeated integral.
 0 0 t s r



                                                                            38
previous policies
                                                                                       t
                                                 ct ht (c) = h1 ct ,                       at,s cs ds .
                                                                                   0

The marginal effect of policy in time t n the past period s (s  t  T ) is given by:

                                                                                               t
                                             s ht (ct ) = at,s h2 ct ,                             at,r cr dr .
                                                                                       0


In particular, we see that ht  At and s ht  At .
   The first order condition (10) is

                                                 t                                     T                                    s
                    ( )
             wt = ct + h1 ct ,                       at,s cs ds + E                        as,t h2 cs ,                         as,r cr dr ds Ft ;
                                             0                                     t                                    0


and the stochastic elasticity (11) is given by, recalling that ct = wt :

                                         t                                     T                                    s
               Ct = -h1 wt ,                 at,s ws ds - E                        as,t h2 ws ,                         as,r wr dr ds Ft .
                                  0                                        t                                    0
                             Present effect                                                           Future effect

                                                                                                     s
Note that in the future effects it is t hs (ct ) = as,t h2 ws ,                                     0 as,r wr dr                that enters as the kernel as,t
measures how policy in period t (t  s  T ) affects future period s.
                                                        T                       s
   The conditional expectation E                       t    as,t h2 ws ,       0 as,r wr dr               ds Ft is intractable for direct com-
putations, as it requires infinite-dimensional integration over the distribution of the process (w(r) -
w(t))trs . However, the semimartingale decomposition is obtained immediately after an applica-
tion of the total derivative formula (8).
   We now turn to calculation of the derivatives needed for the application of the Dupire's func-
tional It^
         o formula (12). These derivatives are used in determining the decomposition of the present
effects of the path ct ht (c) in the first order conditions of the perturbed problem (10). Recall that
the horizontal and two vertical derivatives are needed.
   The horizontal derivative of the present effects of the path ct ht (c) is given by freezing the path
at time t and extending it with time:

                                     t                                                         t                                            t
    t ct ht (c) = t h1 wt ,              at,s ws ds            = h12 wt ,                          at,s ws ds               at,t wt +           (t at,s )ws ds .
                                 0                                                         0                                            0


Vertical differentiation of the present effects of the path ct ht (c) is given by bumping the path. It




                                                                      39
reduces to the differentiation in the first argument:

                                                                         t                                                                    t
                    2
                    c h (c) = ct h1 wt ,
                     t t
                                                                             at,s ws ds                       = h11 wt ,                          at,s ws ds ,
                                                                     0                                                                    0
                                                                         t                                                                        t
                    3         2
                    c h (c) = c
                     t t        t
                                  h1 wt ,                                    at,s ws ds                       = h111 wt ,                             at,s ws ds .
                                                                     0                                                                        0


Note that since we are already finding the derivatives of the marginal effect ct ht (c), the mixed
time-derivative and the second and third order space derivatives appear (rather than just the time
and first and second order derivatives).
   We next calculate the derivatives needed for the application of the total derivative formula (13)
to characterize the conditional expectation of the marginal effects of policy. The time derivative is
given by

                                                                             s                                                                                       s
           t (t hs (ws )) = t as,t h2 ws ,                                       as,r wr dr                    = (t as,t )h2 ws ,                                        as,r wr dr .
                                                                         0                                                                                       0


The Malliavin derivative is given by

                                                                     s
      Dt (t hs (ws )) = Dt as,t h2 ws ,                                  as,r wr dr                       =
                                                                 0
                                  s                                                                                s                                                         s
       = as,t h12 ws ,                as,r wr dr Dt ws + as,t h22 ws ,                                                 as,r wr dr                     Dt                         as,r wr dr           .
                              0                                                                                0                                                         0
                                                            =1
                                                                                                                                                        s                               s
                                                                                                                                                  =    t    as,r Dt wr dr=             t    as,r dr


Gathering the terms we find the differential of the first order process:

                                 t                                                     t
    dCt = -h12 wt ,                  at,s ws ds            at,t wt +                       (t at,s )ws ds dt-
                             0                                                     0
                              t                                                                           t
                                                     1
        - h11 wt ,                   at,s ws ds dwt + h111 wt ,                                               at,s ws ds dt -
                             0                       2                                                0
                                          t                                                    T                                          s
        - - at,t h2 wt ,                      at,r wr dr dt + E                                    (t as,t )h2 ws ,                           as,r wr dr ds Ft dt+
                                      0                                                    t                                          0
                            t ht (wt )
                                                                                                                                                        
                                                                                                                  T
                                                                                                          E      t     t t hs (ws )ds Ft 

                    T                                s                                                                        s                                  s
        +E              (as,t h12 ws ,                   as,r wr dr + as,t h22 ws ,                                               as,r wr dr                         as,r dr)ds Ft dwt .
                t                                0                                                                        0                                  t
                                                                                                                       

                                                                 E Dt tT                   t hs     (ws )ds      Ft 




                                                                                           40
Remark 4. The presented calculation can be done without the use of the total derivative formula
when the occurrence of t under the integral in the conditional expectation can be removed, e.g. when
as,t = g
       ~(t)g (s), and a martingale can be extracted. Indeed, then future effects can be represented
as

               T                      s                                                  t                      s
 g
 ~(t)E             g (s)h2 ws ,           as,r wr dr ds Ft = -g
                                                              ~(t)                           g (s)h2 ws ,           as,r wr dr ds + g
                                                                                                                                    ~(t)Mt ,
           t                      0                                                  0                      0


where
                                                     T                       s
                                  Mt = E                 g (s)h2 ws ,            as,r wr dr ds Ft .
                                                 0                       0

Now the semimartingale decomposition immediately follows from the It^
                                                                    o formula. This type of
examples (with exponential functions g, g
                                        ~) where studied by Detemple and Zapatero (1991) in the
context of asset prices under habit formation.


6.5     Deterministic hysteresis

In this section, we consider a deterministic case. Assume that the underlying process shock  is
deterministic: dt = b(t )dt. Then optimal policies c and c are deterministic as well:


                                                               ct = t .



Our assumption of ht belonging to the class At allows us to neatly decompose its effects into those
of the effects of the present and the past history

                                                                                     1
                                          ct = t -        ct ht (c ) +                   t hs (c )ds .
                                                                                 t


Differentiating the latter relation in               at     = 0 we get

                                                                             1
                                           Ct = - ct ht (c ) +                   t hs (c )ds .
                                                                         t


                            o formula (7) to ct ht (c ) and note that there are no second order
Now, apply the functional It^
vertical derivatives of ct ht (c ) due to the absence of stochasticity:


                                  d (ct ht (c )) = t ct ht (c ) + c
                                                                  2
                                                                     h (c )b(c
                                                                    t t       t ) dt.




                                                                  41
                                                                                                                   1       
The future marginal effects of policy are also deterministic and we can simply differentiate                      t t hs (c )ds

in time.

                                                                                         1
                                                                                             
           dCt = - t ct ht (c ) + c
                                  2
                                     h (c )b(c
                                    t t
                                                               
                                              t ) dt - -t ht (c ) +                            t hs (c )ds) dt.
                                                                                     t       t
                              d(ct ht (c ))                                       1
                                                                            d(            
                                                                                 t t hs (c )ds)   )

   The present effects of the policy ct ht (c ) change with time as the horizontal derivative t and
with the movement in the path of the policy as the vertical derivative ct . The cumulative future
                                  1       
marginal effects of the policy   t t hs (c )ds   change as the relative difference between the time change
in the cumulant of the future marginal effects                 
                                                      t t hs (c )ds       relative to today's marginal effect of
the policy t ht (c ). This case is interesting as a stand alone result that allows to focus on history
dependence without stochasticity.


6.6   A "tipping point"

The main premise of the literature on tipping points discussed in 3.2 is that there is some level of
emissions the crossing of which leads to a different behavior of the climate system. For example,
upon reaching the threshold the damages become larger or become irreversible. We now show an
example where instead of considering a threshold we focus on the time when the climate variable
achieves its maximum upto any given period of time.
   Let t be the time when the Brownian motion w achieves its maximum over [0, t] :


                                               t = arg max ws
                                                        s[0,t]


and it is known that t is a.s. unique. Let f (x) be an absolutely continuous function such that
f (x) = 0 for x  0. Consider the objective function

                                     T                         t
                                          1
                          E              - (ct - wt )2 -           f (s - t )cs ds dt .
                                 0        2                0


One can think of this setting as follow. In each period t, we consider the time t when the maximal
level of w has been achieved ­ say, the time of the temperature record. The damages then are
counted as the weighted by f (s - t ) emissions from the time of the record. When the new record
is achieved, the weighting restarts. This example can be significantly expanded by having the
weighting functions change with time or the weighting functions that weigh both the time prior


                                                      42
to t and the time after t (a form of highlighting the "salience" of the record time) but we chose
to present the simple form here. That is, there is a salient "tipping" or reference point following
which the damages change their behavior.
   The first-order conditions give us the optimal policy in a closed form is given by

                                                                     T
                                        ct = wt - E                      f (t - s )ds Ft .
                                                                 t

                         T
The process t =         t    f (t - s )ds is absolutely continuous and square integrable. Indeed,

                                                         T       t
                                           t =                       f (x - s )dxds.
                                                     t       0


Let us represent t using the Clark-Ocone formula

                                                                             T
                                                  t = Et +                       gt,s dws .
                                                                         0


By the total derivative formula of Proposition 1, we immediately find that c is an It^
                                                                                     o process and


                                        dct =      1 - gt,t dwt - E[t t |Ft ]dt.                                             (16)


Remark 5. Let us try to get this result using standard methods. We compute the process ct
explicitly as a functional of the Wiener process w. At first we find the conditional expectation

                                               
            E [f (t - s )|Ft ] = E                f (x)1x<t-s dx Ft =
                                           0
                    t                                                t
            =           f (x)P (s < t - x|Ft )dx =                       f (x)P         max w > max w Ft dx =
                0                                                0                     [0,t-x]        [t-x,s]
                    t
            =           f (x)1max[0,t-x] w>max[t-x,t] w P                max w < z                                    dx =
                0                                                        [0,t-s]                 z =max[0,t-x] w-wt
                    t                                                            max[0,t-x] w - wt
            =           f (x)1max[0,t-x] w>max[t-x,t] w 2                                                  - 1 dx.
                0                                                                       t-s




                                                                     43
Hence,

                         t                                                 T           max[0,t-x] w - wt
         ct = wt -           f (x)1max[0,t-x] w>max[t-x,t] w                   2                           - 1 dsdx =
                     0                                                 t                      t-s
                         t-t                    T         max[0,t] w - wt
            = wt -              f (x)                 2                    - 1 dsdx =
                     0                      t                     t-s
                                        T               max[0,t] w - wt
            = wt - f (t - t )                   2                        - 1 ds.
                                    t                         t-s

We get the representation of the form


                                                    ct = wt - f (t - t )g (max w - wt ).
                                                                               [0,t]


Now one can try two standard approaches to get the semimartingale decompostion. The first is to
apply the It^
            o formula. In order to do this, we see that


                                                           ct = F (t, wt , t , Mt ),


where Mt = max[0,t] w, and F (t, x, y, z ) = x - f (t - y )g (z - x). Hence the It^
                                                                                  o formula will lead
to a semimartingale decomposition that contains terms dt , dMt , and the sum over jumps of the
process t . It is not obvious that the process ct is an It^
                                                          o process.

    The second approach is to apply the functional It^
                                                     o formula. In order to do this the functional
                          1,2
ct must be extended to a Cb   -functional (in the sense of Cont and Fournie) on the space of cadlag
paths. However, if such extension is possible, vertical derivatives of ct must be equal to zero and
the functional It^
                 o formula would lead to semimartingale decomposition dct = t dt, which is not
the case.
    Instead, the application of our methodology give a straightforward and compact answer of the
equation (16).


7    Discussion

In this section, we discuss some of the more technical issues behind the results.




                                                                      44
7.1      Why do we need both the functional It^
                                              o formula and the total derivative
         formula?
                           h is described in (11) via two terms: a vertical derivative  h (c) of the
The stochastic elasticity Ct                                                           ct t
                                                                                         1       
perturbation functional ht and the conditional expectation E[                           t t hs (c )ds|Ft ].   Both are functionals
of the path (cs )0st but we need to use different methods to study them.
   We assume that the functional ct ht (c) satisfies conditions from Dupire (2019). This is a natural
assumption, since ct ht (c) is a well-defined time-dependent functional of the path (cs )0st .
                                                                 1       
   However, in the case of the functional E[                    t t hs (c )ds|Ft ]      the same assumption is not generally
suitable. The application of the Dupire's functional It^
                                                       o formula requires that

                                                        1
                                           E                t hs (c )ds|Ft = qt (m),
                                                    t


where m is a certain semimartingale and (qt )t[0,T ] is smooth in the sense of Dupire (2019) and
Cont and Fournie (2013) family of path-dependent functionals. It may be a difficult stand-alone
problem even to verify that such representation holds. Consider, for example, the case when

                                                1                               t
                                       E            t hs (c )ds|Ft =                ft (c     
                                                                                         s )dcs ,
                                            t                               0


and ft is smooth in t. The stochastic integral is defined for almost all realizations of c only and it
is unclear how we can extend it smoothly to all continuous paths.14
   Instead we assume that the expression under the conditional expectation is smooth in t and
then apply the total derivative formula in Proposition 1 to prove directly that C h is an It^
                                                                                            o process
and to find its semimartingale decomposition as well.
   In other words, the functional It^
                                    o formula is useful when the functional of the path is already
well-defined. When faced with a conditional expectation process such as the one we considered
here or that frequently occurs in a variety of other economic problems, the total derivative formula
allows to straightforwardly calculate its semimartingale decomposition.


7.2      Assumptions on smoothness of the functionals

Our results are valid for path-dependent functionals h = (ht )0tT such that: (1) ht  At ; (2)
t  ct ht is horizontally and twice vertically differentiable; (3) t  t hs (cs ) is absolutely continuous;

  14
       Recall that the functional It"
                                    o formula is applicable to functionals defined on a larger space of c´
                                                                                                         adl´
                                                                                                            ag paths.


                                                                   45
(4) w  t hs (cs (w)) is Malliavin differentiable.
   The first restriction that ht belongs to the class At allows to calculate the first order conditions
in a tractable form. The second restriction is a typical condition needed for the functional It^
                                                                                               o
formula to be valid. Last two conditions are imposed for the ease of presentation and also they are
satisfied in all our examples. They are needed for the total derivative formula to be applicable for
the process
                                                          T
                                         t  E[                t hs (cs )ds|Ft ].
                                                      t

However, these conditions can be considerably relaxed. It is enough to find an absolutely continuous
square integrable process t , such that

                                             T
                                    E[           t hs (cs )ds|Ft ] = E [t |Ft ].
                                         t


As a simple example consider the process


                                                    t gs (cs ) = wt .


This process is not absolutely continuous, however, E [wt |Ft ] = E [wT |Ft ] and one can take t =
(T - t)wT .


7.3    Relationship to the Clark-Ocone formula

It is instructive to compare Proposition 1 to the well-known Clark-Ocone formula. Recall that
F = (Ft )t[0,T ] is a filtration generated by Wiener process (wt )t[0,T ] . Every F -martingale (Mt )t[0,T ]
can be represented as a conditional expectation process. Indeed, from the definition of a martingale
we get Mt = E[MT |Ft ]. Conversely, every process of the form


                                                    Zt = E[ |Ft ],


where  is an integrable random variable, is a martingale. This follows from the basic properties
of conditional expectations:


                            E [Zt+h |Ft ] = E [E [ |Ft+h ] |Ft ] = E [ |Ft ] = Zt .




                                                              46
Moreover, every F -martingale Zt = E[ |Ft ] is an It^
                                                    o process and if  is Malliavin differentiable, the
Clark-Ocone formula gives
                                                          t
                                    Zt = Z0 +                 E[Ds  |Fs ]dws ,
                                                      0

and the differential of Z :


                                          dZt = E[Dt  |Ft ]dwt .

   The processes that we consider in the Proposition 1 are of the different type - they are of the
form
                                                  Xt = E[t |Ft ]

with  = (t )t[0,T ] being an absolutely continuous process. Such process are not martingales in
general. The simplest example is provided with deterministic non-constant process  , e.g. if we
take t = t, then Xt = t and this is obviously not a martingale.
   The Clark-Ocone formula is then a partial case of Proposition 1 corresponding to constant in t
process (t )t[0,T ] . For the proof and general versions of Proposition 1 we refer to the Appendix.


7.4    Discussion of the optimal control approach

A natural question is whether we can use optimal control and dynamic programming to simplify
the analysis.
   One of the standard approaches for solving optimization problems is the dynamic programming
principle. It can be used for maximization of functionals of the type (see see Fabbri, Gozzi, and
Swiech 2017 for the exposition of infinitely dimensional problems):

                                                          T
                                    V (a) = E                 l(t, xt , a(t))dt,
                                                      0


where a is the control process, the process x satisfies certain SDE whose coefficients depend on the
control a as well. This framework is not well suited for our problem, as in our case the dependence
of the expression under the integral is a path-dependent functional of the policy c:

                                              T
                                                    1
                              V (c) = E            - (ct - wt )2 - ht (ct ) dt.
                                          0         2

Hence, to fit the framework of the optimal control we must consider the whole path ct as the value


                                                          47
of the control a(t). That is, the control space becomes the set of paths t[0,T ] C [0, t]. This leads to
the consideration of the cost functional

                                               T
                                                    1
               V (t, x, ct ) = max Et,x            - (as - ws-t - x)2 - hs (ct  as ) ds.
                             aC [t,T ]     t        2

The HJB equation then becomes a path-dependent PDE that contains infinite-dimensional opti-
mization over trajectories of the control. Thus the analysis may be as complicated as our original
problem. For example, Cosso et. al (2018) use functional It^
                                                           o calculus to write the path-dependent
HJB equation, prove that the value function is a viscosity solution and prove a partial comparison
principle.


8    Conclusion

Path-dependent policies are a feature of a number of economic models. Doing a lot of sports only
when young leads to a very different health outcome than exercising lightly throughout life, even
though the cumulative lifetime exercise may be the same. Moreover, the importance of the previous
pattern of exercise may change with time. For example, intensively training several times a week
is best when young while a steady pattern of light exercise during a week may be preferable when
older. Missing a credit card payment twice in a row in a ten year period leads to a very different
credit history than missing a payment once every five years. The consequence of the same sequence
of non-payments for the credit history may be quite different in a recession versus a boom. These
policies are not just a function of the current state or time but depend on the whole trajectory of
the past actions. Moreover, the dependency itself is changing with time.
    We developed a methodology for analysis of general class of policy with path-dependent effects
in an uncertain environment with forward looking agents. The primary difficulty that arises in
such models is that the optimizing agents foresee such path dependency and the actions they take
incorporate the expectation of the future effects. We show that three ingredients are needed for the
analysis of such problems. First, we introduced a general class of path-dependent functionals that
allows to tractably write the first order conditions for the problem. Second, the recently developed
functional It^
             o calculus allows to describe the dynamics of the present effect of the past choices.
Third, the total derivative formula that we develop in this paper allows to derive the dynamics
of the conditional expectation processes of the future effects of today's choices. Our analysis
shows that even when policy has very small contemporaneous effects, it may have large effects

                                                     48
due to either interaction with the past choices or due to the expected future effects. The effects
of the past are represented by the magnitude of horizontal derivatives and higher order vertical
derivative. The future expected effects are determined by the magnitude of the time derivative and
by the stochastic derivatives. We believe that the methodology we develop in, on purpose, a stark
underlying environment will facilitate analysis of a wide class of other economic problems.




                                                49
9     Appendix

9.1    Remark 1 in Section 4.1

The objective function (3) can be written as follows:

                        T                                                 T                                  T
                              1                                                 1
               E            (- (ct - t )2 - c t )dt = E                       (- (ct - t )2 )dt - E              c t dt =
                    0         2               2
                                                                      0         2                        0        2
                                                                      T
                                T
                                      1                               2
                =E                  (- (ct - t )2 )dt - 2E                 cs ds =
                            0         2                           0
                                T
                                                                                T
                                2     1                                               1
                =E                  (- (ct - t )2 - 2 ct )dt + E                    (- (ct - t )2 )dt.
                            0         2                                        T      2
                                                                               2



The first-order conditions become
                                                    
                                                    ct = t - 2 , t <
                                                                                      T
                                                                                      2
                                                    c =  , t >                T
                                                     t  t                     2,


                                                                                      T
which implies that the optimal policy has a jump at t =                               2.



9.2    An example with contemporaneous policies

In this section, we develop a simple example of introducing additional effects of policies that can
be easily handled by the usual It^
                                 o formula. That is, there is no hysteresis and policy only has
contemporaneous effects.
    Consider an additional effect of policies given by f (ct ), where f : R  R is a smooth function:

                                                         T
                                                               1
                                            max E            (- (ct - wt )2 - f (ct ))dt,
                                             c       0         2

and   is a parameter. The first order conditions are given by


                                                         ct = wt - f (ct ) ,                                                (17)


and equate the marginal benefit of the policy tracking the process wt with the additional marginal
effects f (ct ) .




                                                                      50
9.2.1   Stochastic elasticity and its dynamics

We are particularly interested in the case of  0. One can think about this as a small parameter
                                  f
asymptotics for the problem. Let Ct be a first variation process:

                                                  f
                                       ct = ct + Ct + o( ).


             f
The process Ct represents how optimal policy process changes locally in response to the intro-
                                                         f
duction of a small effect of policyf . One can think of Ct as a notion of stochastic elasticity that
represents the change in the whole process when policy has additional effects f .
   Differentiating the first order condition (17) with respect to   and evaluating at   = 0, we get

                                            f
                                           Ct = f (ct ).


                                             f
Without any restrictions on f , the process Ct may be quite arbitrary, for example, discontinu-
                                                                                       f
ous. However, since we assumed smoothness of f , It^
                                                   o's lemma implies that the process Ct is a
semimartingale. Moreover, its decomposition is given as (using also that ct = wt ) in closed form:


                                      f
                                    dCt = (wt )dt +  (wt )dwt ,


where

                                               1
                                        (wt ) = f (wt ),
                                               2
                                         (wt ) = f (wt ).                                       (18)


9.2.2   Dynamics of optimal policy

We now turn to characterizing the optimal policy ct rather than the first variation process. Let the
process ct have the form
                                   dct =  (ct ) dt +  (ct ) dwt .




                                                51
Applying It^
           o formula to (17), we can find the dynamics of the process ct :

                                        1
             dct = dwt -   f (ct ) dct + f (ct ) (t )2 dt ,
                                        2
                                                  1
             t dt + t dwt = dwt -     f (ct ) t + f (ct ) (t )2 dt - f (ct ) t dwt .
                                                  2

The drift and diffusion coefficients are then given by collecting terms at dt and dwt :

                                                    1
                                                    2f(ct ) (t )2
                                      t (ct ) = -                 ,
                                                   1 + f (ct )
                                                    1
                                      t (ct ) =             .                                       (19)
                                                1 + f (ct )

The coefficients in (19) are given as a system of coupled equations and themselves depend on the
process ct . This is in contrast to the coefficients of the stochastic elasticity given in (18) which are
given in closed form as they are evaluated at the process ct = ct
                                                                  =0 = w .
                                                                        t

   The key to tractability in the simple setting of this section is It^
                                                                      o lemma. However, It^
                                                                                          o lemma
only applies to functions and not the functionals. That is, it does not apply to the path-dependent
effects of policies studying which is the main goal of the rest of this paper.
   It is useful to summarize these results in terms of how the magnitude of the additional effects
influences policy. This parallels the discussion of Dixit (1991), Reis (2006) and Alvarez, Lippi, and
Paciello (2011, 2016) who show that in the environments with uncertainty and adjustment frictions
the costs up to the fourth order may have first order effects on the dynamics of optimal policies.
In our setting, since the additional effects f are smooth, we show that the effects up to the third
order, that is the second and the third derivative of f will have the first-order effects. The first
and second derivative of the marginal effects (that is, the second and third derivative of f ) matter
for the drift of the optimal policy ­ this is the evolution of optimal policy with respect to time.
The first derivative of the marginal effects matters for the diffusion coefficients ­ this is response of
optimal policy to stochastic shocks. Importantly, the dynamics of the optimal policy is not directly
influenced by either the past or the future evolution of the policies.


9.3   Vertical derivatives and the class At of functionals

The functional h : C [0, t]  R is said to be in the class At if for each path c  C [0, t] there exists a
number ct h(c) and an integrable function (s h(c))s[0,t] , such that the following asymptotic relation



                                                    52
holds for any c  C [0, t] :

                                                            t
                  h(c + z ) = h(c) + ct h(c) · zt +             s h(c) · zs ds + o(||z ||), z  0.
                                                        0


The number ct h(c) is the derivative of h along the value of the path (cs )s[0,t] at time t (i.e. the
derivative along the present value). The function (s h(c))s[0,t] , represents the integrated influence
of the past on the variation of the functional.

Lemma 5. Assume that the functional h  At admits a continuous extension to the space D[0, t] of
cadlag paths (equipped with the Skorokhod topology). Then the functional h is vertically differentiable
at every c  C [0, t], and the vertical derivative coincides with ct h(c).

Proof. Fix  > 0. There exists  > 0 such that for any z  C [0, t] with ||z ||  ,

                                                                        t
                        h(c + z ) - h(c) - ct h(c) · zt -                   s h(c) · zs ds  ||z ||.
                                                                    0


The function et  D[0, t] can be approximated in the Skorokhod topology by continuous functions
                                 (n)                  1          (n)
z (n) , such that 0  z (n)  1, zs      = 0 for s  t - n , zt                = 1. We have for all      

                                                            t
              h(c + z (n) ) - h(c) - ct h(c) · -                              (n)
                                                                    s h(c) · zs   ds   ||z (n) || =  .
                                                           1
                                                        t- n


Dividing by    we get

                                                                                   t
                          h(c + z (n) ) - h(c)
                                                 - ct h(c)   +                           |s h(c)|ds
                                                                                     1
                                                                                  t- n


Taking n  ,
                                       h(c + et ) - h(c)
                                                            - ct h(c)  .

Since  > 0 is arbitrary, this proves that the vertical derivative of h exists and is equal to ct h(c).


9.4   Proof of Claim 2

We recall that the class AT consists of functionals g : C [0, T ]  R such that for all c, z  C [0, T ]

                                                                    T
                    g (c + z ) = g (c) + ct g (c)zt +                   s g (c)zs ds + o( ),       0.
                                                                0




                                                      53
For any function c  C [0, T ] introduce the transformation

                                                                                   T
                                (R(n) c)t = e-n(T -t) cT + n                           e-n(s-t) cs ds.
                                                                               t


The function R(n) c solves the problem
                                            
                                             dR(n) c = -n(ct - (R(n) c)t )
                                            
                                               dt

                                            (R(n) c) = c
                                            
                                                    T   T



Hence, R(n) c  c uniformly on [0, T ]. Given any Frechet differentiable functional g : C [0, T ]  R,
consider
                                                    g (n) (c) = g (R(n) c).

Fix c  C [0, T ] and let the measure µ be the Frechet derivative of g at R(n) c.

                                                                                   T
      g (n) (c + z ) = g (R(n) c + R(n) z ) = g (R(n) )(c) +                           (R(n) z )s µ(ds) + o( ) =
                                                                               0
                                        T                                  T
                   = g (n) (c) +                e-n(T -s) zT + n               e-n(r-s) zr dr µ(ds) + o( ) =
                                    0                                  s
                                            T                                                T       r
                   = g (n) (c) +                e-n(T -s) µ(ds) zT +                                     e-n(r-s) µ(ds) zr dr + o( )
                                        0                                                0       0


So, g (n)  AT . Every differentiable functional is a pointwise limit of functionals from the class AT .


9.5     Total derivative formula: a general version of Proposition 1
                                                                                                                            T   2 ds < .
Let  = (t )t[0,T ] be a measurable process. We will say that  is square integrable, if E                                   0    s
   We say that a measurable stochastic process  = (t )t[0,T ] is absolutely continuous, if 0 is
square integrable and there exists a square integrable process (t )t[0,T ] , such that

                                                              t
                                            t = 0 +               s ds, 0  t  T.                                                       (20)
                                                          0

                                                                 2 <  and is a.s. continuous.
Observe that an absolutely continuous process  satisfies sup0tT Et
It is important that an absolutely continuous process need not be adapted. Since the processes
under consideration are square integrable and measurable with respect to a Wiener process w, their




                                                                  54
values can be represented as stochastic integrals. Namely,

                                                         T                                                          T
                               t = Et +                      gt,s dws , t = Et +                                        ht,s dws , 0  t  T,                               (21)
                                                     0                                                          0


where gt = (gt,s )s[0,T ] and ht = (ht,s )s[0,T ] are progressively measurable (in s) square integrable
processes. We need one technical result on the regularity of the process gt .

Lemma. For each t  [0, T ] and almost all s  [0, T ]

                                                                                                   t
                                                             gt,s = g0,s +                             hr,s dr a.s.
                                                                                               0


In particular, for almost all s  [0, T ] the process t  gt,s has a continuous modification.

Proof. Let u = (us )s[0,T ] be an arbitrary progressively measurable square integrable process. Using
It^
  o's isometry we compute

                T                        T                       T                                         T
     E              gt,s us ds = E           gt,s dws                us dws = Et                               us dws =
            0                        0                       0                                         0
                                              T                          t                 T
                             = E0                 us dws +                    Er               us dws dr =
                                          0                          0                 0
                                         T                               t            T                                             T                t
                             =E              g0,s us ds +                     E        hr,s us ds dr = E                                g0,s +           hr,s dr us ds.
                                     0                               0            0                                             0                0

                                                                                                                                     t
Since the latter holds for arbitrary u we deduce that gt = g0 +                                                                     0 hr dr   as elements of L2 ( ×
[0, T ]).

    Further we will always deal with a continuous in t modifications of processes t  gt,s .

Proposition. Let  = (t )t[0,T ] be a square integrable progressively measurable process. Then  is
     o process if and only if it can be represented in the form t = E[t |Ft ] for some square integrable
an It^
absolutely continuous process  = (t )t[0,T ] . In this case the semimartingale representation of  is
given by
                                                                 dt = E[t |Ft ]dt + gt,t dwt ,

where processes  and gt are determined from (20), (21).

Proof. Assume that  is an It^
                            o process. Then it can be written in the form

                                                                         t                         t
                                                  t = 0 +                    s ds +                    s dws , 0  t  T.
                                                                     0                         0


                                                                                       55
Introduce the process
                                                                          T                                  t
                                           t =  0 +                               s dws +                        s ds.
                                                                      0                                  0

Observe that the process  is an absolutely continuous process. Since stochastic integrals are
martingales, we deduce that

                                 t                             T                                                        t                       t
          E [t |Ft ] = 0 +           s ds + E                         s dws |Ft = 0 +                                       s ds +                  s dws = t .
                             0                             0                                                        0                       0


Conversely, assume that t = E[t |Ft ] with some absolutely continuous process . Related processes
, gt are defined in (20), (21). Consider the process

                                                                              t
                                 Mt =  t -  0 -                                   E[r |Fr ]dr, 0  t  T.
                                                                          0


We verify that the process M is a martingale. Indeed, for s < t we compute

                                                     t
           E[Mt |Fs ] = E t - 0 -                        E[r |Fr ]dr|Fs =
                                                 0
                                                                      t
                     = E E[t |Ft ] - 0 -                                  E[r |Fr ]dr|Fs =
                                                                  0
                                                    t                                               s
                     E[t |Fs ] - 0 -                     E[r |Fs ]dr -                                  E[r |Fr ]dr =
                                                s                                               0
                                           t                                                    t                                    s
                     = E s +                   r dr|Fs - 0 -                                        E[r |Fs ]dr -                        E[r |Fr ]dr =
                                       s                                                    s                                    0
                                                              s                                                                  s
                     = E [s |Fs ] - 0 -                           E[r |Fr ]dr = s - 0 -                                              E[r |Fr ]dr = Ms .
                                                          0                                                                  0


As a Wiener martingale, the process M has a representation as a stochastic integral. Since M0 = 0
the representation is of the form:
                                                                                       t
                                                           Mt =                            vs dws
                                                                                   0

for some progressively measurable square integrable process v = (vs )s[0,T ] . To find this process we
use It^
      o's isometry. For arbitrary progressively measurable square integrable process u = (us )s[0,T ] ,




                                                                                  56
we have

          T                          T                           T                                T
  E           vs us ds = E               vs dws                      us dws = EMT                     us dws =
      0                          0                           0                                0
                                 T                                         T                                    T                            T                  r
   = E T -  0 -                          E[r |Fr ]dr                           us dws = E T                         us dws           -           E r                us dws dr =
                                0                                      0                                 0                               0                  0
                  T                          T               r                                T                              T
   =E                 gT,s us ds -               E               hr,s us dsdr = E                     gT,s -                     hr,s dr us ds.
              0                          0               0                                0                              s


From the previous Lemma we deduce

                                                                               T                                    s
                                             vs = gT,s -                           hr,s dr = g0,s +                     hr,s dr = gs,s .
                                                                           s                                    0


Finally, equality

                                                         t                                                  t                                    t
                            t = 0 +                          E[s |Fs ]ds + Mt = 0 +                             E[s |Fs ]ds +                        gs.s dws
                                                     0                                                  0                                    0


implies the needed semimartingale representation of .

Remark. For almost all t  [0, T ] the process t is the time-derivative of the process t . If we assume
that t is Malliavin differentiable, then the Clark-Ocone formula implies


                                                                               gt,t = E [Dt t |Ft ] .


In these terms the result of the theorem can be written as


                                                 dE [t |Ft ] = E [t t |Ft ] dt + E [Dt t |Ft ] dwt ,


which is the motivation behind the term "total derivative formula".


9.6       Characterization of It^
                                o processes: converse of Proposition 1

The total derivative formula states that for any square integrable absolutely continuous process
(t )t[0,T ] , the process t = E [t |Ft ] is an It^
                                                 o process. In this section we give the converse statement.

Claim. For any square integrable It^
                                   o process (t )t[0,T ] there exists an absolutely continuous process
(t )t[0,T ] such that
                                                                                    t = E [t |Ft ].


                                                                                          57
Proof. By the definition of the It^
                                  o process, there exist adapted square integrable processes (t )t[0,T ]
and (t )t[0,T ] such that
                                                               t                      t
                                    t = 0 +                        s ds +                 s dws .
                                                           0                      0

We simply define
                                                               t                      T
                                     t = 0 +                       s ds +                 s dws .
                                                           0                      0

The process  is absolutely continuous, and

                                                       t                                  T
                            E [t |Ft ] = 0 +               s ds + E                           s dws Ft =
                                                   0                                  0

                                                   t                         t
                                   = 0 +               s ds +                    s dws = t .
                                               0                         0




                                                                    58
References



   Acemoglu, Daron, Philippe Aghion, Leonardo Bursztyn, and David Hemous. "The environment
and directed technical change." American economic review 102, no. 1 (2012): 131-66.
   Acemoglu, Daron, Philippe Aghion, Lint Barrage and David Hemous "Climate change, directed
innovation, and energy transition: The long-run consequences of the shale gas revolution." In 2019
Meeting Papers, no. 1302. Society for Economic Dynamics, 2019.
   Acemoglu, Daron, Ufuk Akcigit, Douglas Hanley, and William Kerr. "Transition to clean
technology." Journal of Political Economy 124, no. 1 (2016): 52-104.
   Acemoglu, Daron, Georgy Egorov, and Konstantin Sonin. Institutional Change and Institu-
tional Persistence. No. w27852. National Bureau of Economic Research, 2020.
   Aghion, Philippe, Antoine Dechezlepr^
                                       etre, David Hemous, Ralf Martin, and John Van Reenen.
"Carbon taxes, path dependency, and directed technical change: Evidence from the auto industry."
Journal of Political Economy 124, no. 1 (2016): 1-51.
   Aghion, Philippe, Cameron Hepburn, Alexander Teytelboym, and Dimitri Zenghelis. "Path
dependence, innovation and the economics of climate change." In Handbook on Green Growth.
Edward Elgar Publishing, 2019.
   Akerlof, George A., and Janet L. Yellen. "A near-rational model of the business cycle, with
wage and price inertia." The Quarterly Journal of Economics 100, no. Supplement (1985): 823-838.
   Alvarez, Fernando, and Francesco Lippi. "The Analytic Theory of a Monetary Shock." Einaudi
Institute for Economics and Finance Mimeo, in preparation (2019).
   Alvarez, Fernando E., Francesco Lippi, and Luigi Paciello. "Optimal price setting with obser-
vation and menu costs." The Quarterly journal of economics 126, no. 4 (2011): 1909-1960.
   Alvarez, Fernando E., Francesco Lippi, and Luigi Paciello. "Monetary shocks in models with
inattentive producers." The Review of economic studies 83, no. 2 (2016): 421-459.
   Alvarez, Fernando, Herve Le Bihan, and Francesco Lippi. "The real effects of monetary shocks
in sticky price models: a sufficient statistic approach." American Economic Review 106, no. 10
(2016): 2817-51.
   Alvarez, Fernando E., Francesco Lippi, and Aleksei Oskolkov. The Macroeconomics of Sticky
Prices with Generalized Hazard Functions. No. w27434. National Bureau of Economic Research,
2020.


                                               59
   Arrow, Kenneth J. "Increasing returns: historiographic issues and path dependence." The Eu-
ropean Journal of the History of Economic Thought 7, no. 2 (2000): 171-180.
   Bakkensen, Laura A., and Lint Barrage. Flood risk belief heterogeneity and coastal home price
dynamics: Going under water?. No. w23854. National Bureau of Economic Research, 2017.
   Baldwin, Elizabeth, Yongyang Cai, and Karlygash Kuralbayeva. "To build or not to build?
Capital stocks and climate policy." Journal of Environmental Economics and Management 100
(2020): 102235.
   Barnett, Michael, William Brock, and Lars Peter Hansen. "Pricing uncertainty induced by
climate change." The Review of Financial Studies 33, no. 3 (2020): 1024-1066.
   Barrage, Lint, and Jacob Furst. "Housing investment, sea level rise, and climate change beliefs."
Economics letters 177 (2019): 105-108.
   Bergemann, Dirk, and Philipp Strack. "Dynamic revenue maximization: A continuous time
approach." Journal of Economic Theory 159 (2015): 819-853.
   Berger, David W., Konstantin Milbradt, Fabrice Tourre, and Joseph Vavra. Mortgage prepay-
ment and path-dependent effects of monetary policy. No. w25157. National Bureau of Economic
Research, 2018.
   Blanchard, Olivier J., and Lawrence H. Summers. "Hysteresis and the European unemployment
problem." NBER macroeconomics annual 1 (1986): 15-78.Bhamra, Harjoat S., and Raman Uppal.
"The effect of introducing a non-redundant derivative on the volatility of stock-market returns
when agents differ in risk aversion." The Review of Financial Studies 22, no. 6 (2009): 2303-2330.
   Borovicka, J. and Hansen, L.P., 2016. Term structure of uncertainty in the macroeconomy. In
Handbook of Macroeconomics (Vol. 2, pp. 1641-1696). Elsevier.
   Borovi                                         e A. Scheinkman. "Shock elasticities and
         cka, Jaroslav, Lars Peter Hansen, and Jos´
impulse responses." Mathematics and Financial Economics 8, no. 4 (2014): 333-354.
   Borovi                                                         e A. Scheinkman. "Risk-price
         cka, Jaroslav, Lars Peter Hansen, Mark Hendricks, and Jos´
dynamics." Journal of Financial Econometrics 9, no. 1 (2011): 3-65.
   Boucher, O., P. R. Halloran, E. J. Burke, M. Doutriaux-Boucher, C. D. Jones, J. Lowe, M. A.
Ringer, E. Robertson, and P. Wu. "Reversibility in an Earth System model in response to CO2
concentration changes." Environmental Research Letters 7, no. 2 (2012): 024013.
   Boulatov, Alexei, Georgii Riabov, and Aleh Tsyvinski. "Optimal trading with dynamic stochas-
tic price impact", Working paper (2020).
   Brian, Arthur, W. "Competing technologies, increasing returns, and lock-in by historical events."


                                                60
The economic journal 99, no. 394 (1989): 116-131.
   Brock, William A., and Lars Peter Hansen. "Wrestling with uncertainty in climate economic
models." University of Chicago, Becker Friedman Institute for Economics Working Paper 2019-71
(2018).
   Cai, Yongyang, and Thomas S. Lontzek. "The social cost of carbon with economic and climate
risks." Journal of Political Economy 127, no. 6 (2019): 2684-2734.
   Collins, Matthew, Reto Knutti, Julie Arblaster, Jean-Louis Dufresne, Thierry Fichefet, Pierre
Friedlingstein, Xuejie Gao et al. "Long-term climate change: projections, commitments and irre-
versibility." In Climate Change 2013-The Physical Science Basis: Contribution of Working Group I
to the Fifth Assessment Report of the Intergovernmental Panel on Climate Change, pp. 1029-1136.
Cambridge University Press, 2013.
   Cont, Rama, and David-Antoine Fournie. "Functional It^
                                                        o calculus and stochastic integral
representation of martingales." The Annals of Probability 41, no. 1 (2013): 109-133.
   Cosso, Andrea, Salvatore Federico, Fausto Gozzi, Mauro Rosestolato, and Nizar Touzi. "Path-
dependent equations and viscosity solutions in infinite dimension." The Annals of Probability 46,
no. 1 (2018): 126-174.
          c, Jaksa, and Semyon Malamud. "Equilibrium driven by discounted dividend volatility."
   Cvitani´
Swiss Finance Institute Research Paper 09-34 (2009)
   Cvitani´
          c, Jak                 i, and Nizar Touzi. "Moral hazard in dynamic risk manage-
                sa, Dylan Possama¨
ment." Management Science 63, no. 10 (2017): 3328-3346.
   David, Paul A. "Clio and the Economics of QWERTY." The American Economic Review 75,
no. 2 (1985): 332-337.
   Detemple, Jerome B., and Fernando Zapatero. "Asset prices in an exchange economy with
habit formation." Econometrica: Journal of the Econometric Society (1991): 1633-1657.
   Dietz, Simon, James Rising, Thomas Stoerk, and Gernot Wagner. "Tipping Points in the
Climate System and the Economics of Climate Change." In EGU General Assembly Conference
Abstracts, p. 2959. 2020.
   Dixit, Avinash. "Analytical approximations in models of hysteresis." The Review of Economic
Studies 58, no. 1 (1991): 141-151.
   Dixit, Avinash. "Investment and hysteresis." Journal of economic perspectives 6, no. 1 (1992):
107-132.
   Dupire, Bruno. "Functional It^
                                o calculus." 2009. Bloomberg Working Paper.


                                               61
   Dupire, Bruno. "Functional It^
                                o calculus." Quantitative Finance 19, no. 5 (2019): 721-729.
   Eggertsson, Gauti B., Neil R. Mehrotra, and Jacob A. Robbins. "A model of secular stagnation:
Theory and quantitative evaluation." American Economic Journal: Macroeconomics 11, no. 1
(2019): 1-48.
   Egorov, Georgy, and Konstantin Sonin. The Political Economics of Non-democracy. No.
w27949. National Bureau of Economic Research, 2020.
   Eliseev, Alexey V., Pavel F. Demchenko, Maxim M. Arzhanov, and Igor I. Mokhov. "Transient
hysteresis of near-surface permafrost response to external forcing." Climate dynamics 42, no. 5-6
(2014): 1203-1215.
   Fabbri, Giorgio, Fausto Gozzi, and Andrzej Swiech. "Stochastic optimal control in infinite
dimension." Probability and Stochastic Modelling. Springer (2017).
   Fouquet, Roger. "Path dependence in energy systems and economic development." Nature
Energy 1, no. 8 (2016): 1-5.
   Fourni´
         e, Eric, Jean-Michel Lasry, J´
                                      er^
                                        ome Lebuchoux, Pierre-Louis Lions, and Nizar Touzi.
"Applications of Malliavin calculus to Monte Carlo methods in finance." Finance and Stochastics
3, no. 4 (1999): 391-412.
   Gal´
      i, Jordi. Insider-outsider labor markets, hysteresis and monetary policy. No. w27385.
National Bureau of Economic Research, 2020.
   Garbe, Julius, Torsten Albrecht, Anders Levermann, Jonathan F. Donges, and Ricarda Winkel-
mann. "The hysteresis of the Antarctic ice sheet." Nature 585, no. 7826 (2020): 538-544.
   Gasser, Thomas, Mehdi Kechiar, Phillippe Ciais, E. J. Burke, Thomas Kleinen, Dan Zhu,
Yuanyuan Huang, Altug Ekici, and M. Obersteiner. "Path-dependent reductions in CO 2 emission
budgets caused by permafrost carbon release." Nature Geoscience 11, no. 11 (2018): 830-835.
   Giglio, Stefano, Bryan T. Kelly, and Johannes Stroebel. Climate Finance. No. w28226. Na-
tional Bureau of Economic Research, 2020.
   Golosov, Mikhail, John Hassler, Per Krusell, and Aleh Tsyvinski. "Optimal taxes on fossil fuel
in general equilibrium." Econometrica 82, no. 1 (2014): 41-88.
   Grubb, Michael, Rutger-Jan Lange, Nicolas Cerkez, Pablo Salas, Jean-Francois Mercure, and
Ida Sognnaes. "Taking Time Seriously: Implications for Optimal Climate Policy." (2020).
   Hassler, John, Per Krusell, Conny Olovsson, and Michael Reiter. "On the effectiveness of
climate policies." IIES WP (2020).
   Huang, Zangbo and Michael Sockin "Dynamic Taxation with Endogenous Skill Premia", 2018.


                                               62
   Hong, Harrison, Neng Wang, and Jinqiang Yang. Mitigating Disaster Risks in the Age of
Climate Change. National Bureau of Economic Research, 2020.
   Jord`  `
       a, Oscar, Sanjay R. Singh, and Alan M. Taylor. The long-run effects of monetary policy.
No. w26666. National Bureau of Economic Research, 2020.
   Kotlikoff, L.J., Kubler, F., Polbin, A. and Scheidegger, S., 2020. Pareto-Improving Carbon-Risk
Taxation (No. w26919). National Bureau of Economic Research.
   Krasnosel'skii, Mark A., and Aleksei V. Pokrovskii. Systems with hysteresis. Springer Science
& Business Media, 2012.
   Lemoine, Derek. "The climate risk premium: how uncertainty affects the social cost of carbon."
Journal of the Association of Environmental and Resource Economists 8, no. 1 (2021): 27-57.
   Lemoine, Derek, and Christian Traeger. "Watch your step: optimal policy in a tipping climate."
American Economic Journal: Economic Policy 6, no. 1 (2014): 137-66.
   Li, Xin, Borghan Narajabad, and Ted Temzelides. "Robust dynamic energy use and climate
change." Quantitative Economics 7, no. 3 (2016): 821-857.
   Ljungqvist, Lars, and Thomas J. Sargent. Recursive macroeconomic theory. MIT press, 2018.
   Lontzek, Thomas S., Yongyang Cai, Kenneth L. Judd, and Timothy M. Lenton. "Stochastic
integrated assessment of climate tipping points indicates the need for strict climate policy." Nature
Climate Change 5, no. 5 (2015): 441-444.
   Mankiw, N. Gregory. "Small menu costs and large business cycles: A macroeconomic model of
monopoly." The Quarterly Journal of Economics 100, no. 2 (1985): 529-537.
   Makris, Miltiadis, and Alessandro Pavan. Taxation under learning-by-doing. Working Paper,
2017.
   Makris, Miltiadis, and Alessandro Pavan. Wedge Dynamics with Endogenous Private Informa-
tion: A General Recursive Characterization. mimeo, Northwestern University, 2018.
   Meng, Kyle C. Estimating path dependence in energy transitions. No. w22536. National
Bureau of Economic Research, 2016.
   Nohara, Daisuke, Yoshikatsu Yoshida, Kazuhiro Misumi, and Masamichi Ohba. "Dependency
of climate change and carbon cycle on CO2 emission pathways." Environmental Research Letters
8, no. 1 (2013): 014047.
   Nordhaus, W.D., 1994. Managing the global commons: the economics of climate change (Vol.
31). Cambridge, MA: MIT press.
   Page, Scott E. "Path dependence." Quarterly Journal of Political Science 1, no. 1 (2006):


                                                 63
87-115.
   Pavan, Alessandro. "Dynamic mechanism design: Robustness and endogenous types." In Ad-
vances in Economics and Econometrics: Eleventh World Congress, pp. 1-62. 2017.
   Pavan, Alessandro, Ilya Segal, and Juuso Toikka. "Dynamic mechanism design: A myersonian
approach." Econometrica 82, no. 2 (2014): 601-653.
   Reis, Ricardo. "Inattentive producers." The Review of Economic Studies 73, no. 3 (2006):
793-821.
   Prescott, Edward C. "Should control theory be used for economic stabilization?." In Carnegie-
Rochester Conference Series on Public Policy, vol. 7, pp. 13-38. North-Holland, 1977.
   Rogelj, J., D. Shindell, K. Jiang, S. Fifita, P. Forster, V. Ginzburg, C. Handa, H. Kheshgi, S.
Kobayashi, E. Kriegler, L. Mundaca, R. S´
                                        ef´
                                          erian, and M.V.Vilari~
                                                               no, 2018: Mitigation Pathways
Compatible with 1.5°C in the Context of Sustainable Development. In: Global Warming of 1.5°C.
An IPCC Special Report on the impacts of global warming of 1.5°C above pre-industrial levels
and related global greenhouse gas emission pathways, in the context of strengthening the global
response to the threat of climate change, sustainable development, and efforts to eradicate poverty
[Masson-Delmotte, V., P. Zhai, H.-O. P¨
                                      ortner, D. Roberts, J. Skea, P.R. Shukla, A. Pirani, W.
Moufouma-Okia, C. P´
                   ean, R. Pidcock, S. Connors, J.B.R. Matthews, Y. Chen, X. Zhou, M.I.
Gomis, E. Lonnoy, T. Maycock, M. Tignor, and T. Waterfield (eds.)]. In Press.
   Sannikov, Yuliy. "Moral hazard and long-run incentives." Unpublished working paper, Prince-
ton University (2014).
   Serrat, Angel. "A dynamic equilibrium model of international portfolio holdings." Econometrica
69, no. 6 (2001): 1467-1489.
   Summers, Lawrence H. "US economic prospects: Secular stagnation, hysteresis, and the zero
lower bound." Business economics 49, no. 2 (2014): 65-73.
   Temzelides, Ted. "Needed: Robustness in Climate Economics." Coping with the climate crisis
(2016): 104.
   Traeger, Christian P. "Ace­analytic climate economy (with temperature and uncertainty)."
(2018).
   Van Den Bremer, Ton, and Rick van der Ploeg. "Pricing Carbon Under Economic and Climactic
Risks: Leading-Order Results from Asymptotic Analysis." (2018).
   van der Ploeg, Frederick, and Aart de Zeeuw. "Climate tipping and economic growth: precau-
tionary capital and the price of carbon." Journal of the European Economic Association 16, no. 5


                                                64
(2018): 1577-1617.
   Walsh, Conor. "Hysteresis Implies Scale Effects." (2020): Working paper.
   Zickfeld, K., Arora, V.K. and Gillett, N.P., 2012. Is the climate response to CO2 emissions
path-dependent?. Geophysical Research Letters, 39(5).




                                              65
