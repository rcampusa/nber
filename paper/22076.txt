                              NBER WORKING PAPER SERIES




                         MIRRLEES MEETS DIAMOND-MIRRLEES

                                        Florian Scheuer
                                         Iván Werning

                                      Working Paper 22076
                              http://www.nber.org/papers/w22076


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     March 2016




For helpful comments and discussions we thank Jim Poterba, Casey Rothschild and Emmanuel
Saez. The views expressed herein are those of the authors and do not necessarily reflect the views
of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2016 by Florian Scheuer and Iván Werning. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Mirrlees meets Diamond-Mirrlees
Florian Scheuer and Iván Werning
NBER Working Paper No. 22076
March 2016
JEL No. D6,D8,E6,H2,J2

                                          ABSTRACT

We show that the Diamond and Mirrlees (1971) linear tax model contains the Mirrlees (1971)
nonlinear tax model as a special case. In this sense, the Mirrlees model is an application of
Diamond-Mirrlees. We also derive the optimal tax formula in Mirrlees from the Diamond-
Mirrlees formula. In the Mirrlees model, the relevant compensated cross-price elasticities are
zero, providing a situation where an inverse elasticity rule holds. We provide four extensions that
illustrate the power and ease of our approach, based on Diamond-Mirrlees, to study nonlinear
taxation. First, we consider annual taxation in a lifecycle context. Second, we include human
capital investments. Third, we incorporate more general forms of heterogeneity into the basic
Mirrlees model. Fourth, we consider an extensive margin labor force participation decision,
alongside the intensive margin choice. In all these cases, the relevant optimality condition is
easily obtained as an application of the general Diamond-Mirrlees tax formula.


Florian Scheuer
Department of Economics
Stanford University
579 Serra Mall
Stanford, CA 94305
and NBER
scheuer@stanford.edu

Iván Werning
Department of Economics, E52-536
MIT
77 Massachusetts Avenue
Cambridge, MA 02139
and NBER
iwerning@mit.edu
                     Mirrlees meets Diamond-Mirrlees∗
                              Florian Scheuer                  Iván Werning
                            Stanford University                       MIT

                                               March 2016



                                                   Abstract

        We show that the Diamond and Mirrlees (1971) linear tax model contains the Mirrlees
        (1971) nonlinear tax model as a special case. In this sense, the Mirrlees model is an ap-
        plication of Diamond-Mirrlees. We also derive the optimal tax formula in Mirrlees from
        the Diamond-Mirrlees formula. In the Mirrlees model, the relevant compensated cross-
        price elasticities are zero, providing a situation where an inverse elasticity rule holds.
        We provide four extensions that illustrate the power and ease of our approach, based
        on Diamond-Mirrlees, to study nonlinear taxation. First, we consider annual taxation
        in a lifecycle context. Second, we include human capital investments. Third, we incor-
        porate more general forms of heterogeneity into the basic Mirrlees model. Fourth, we
        consider an extensive margin labor force participation decision, alongside the intensive
        margin choice. In all these cases, the relevant optimality condition is easily obtained as
        an application of the general Diamond-Mirrlees tax formula.



1      Introduction
The Mirrlees (1971) model is a milestone in the study of optimal nonlinear taxation of labor
earnings. The Diamond and Mirrlees (1971) model is a milestone in the study of optimal lin-
ear commodity taxation. Here we show that the Diamond-Mirrlees model, suitably adapted
to allow for a continuum of goods, is strictly more general than the Mirrlees model. In this
sense, the Mirrlees model is an application of the Diamond-Mirrlees model.
    This connection is obtained by reinterpreting and expanding the commodity space in the
Diamond-Mirrlees model. Although only linear taxation of each good is allowed, nonlinear
taxation can be mimicked by treating each consumption level as a different sub-good. The
    ∗ For   helpful comments and discussions we thank Jim Poterba, Casey Rothschild and Emmanuel Saez.


                                                      1
tax rate within each sub-good then determines the tax for each consumption level, which
is equivalent to a nonlinear tax. The only slight complication with this approach is that it
requires working with a continuum of goods and a continuum of agents. In particular, in
the Mirrlees model, there is a nonlinear tax on the efficiency units y of labor supplied, which
equals pre-tax earnings. Instead of treating y as the quantity for a single good, we model y
as indexing the characteristic of a separate sub-good. Since any positive supply y is allowed,
the set of sub-goods allowed is the positive real line.1
    Both Mirrlees (1971) and Diamond and Mirrlees (1971) provided optimal tax formulas
that have been amply studied, interpreted and employed. They provide intuition into the
optimum and suggest the relevant empirical counterparts, or sufficient statistics, to the the-
ory. In the case of Mirrlees (1971), the tax formula was employed and reinterpreted by
Diamond (1998) and Saez (2001). In the case of Diamond and Mirrlees (1971), one can point
to Mirrlees (1975) and especially Diamond (1975), who provided a many-person Ramsey tax
formula.
    We provide a connection by showing that the formula in Mirrlees can be derived from
the formula in Diamond-Mirrlees in a straightforward manner. In particular, we start with
a version of the general Diamond-Mirrlees formula, as provided by Diamond (1975), and
show that it specializes to the Mirrlees tax formula in its integral form, as provided by Di-
amond (1998), Saez (2001) and others. A connection between the two formulas is natural
given that we have shown that Diamond-Mirrlees’ framework nests Mirrlees’. However,
moving from the Diamond-Mirrlees formula to the Mirrlees formula is not entirely imme-
diate because the optimality conditions in Mirrlees were developed for a continuous model
and are therefore of a somewhat different nature. Fortunately, after a convenient change in
variables, the connection between the two formulas is greatly simplified.2
    One major benefit of demonstrating the connection between the two formulas is to offer
a common economic interpretation. The Diamond-Mirrlees formula (as seen through the
lens of the interpretation offered by Diamond, 1975) equates two sides, each with a simple
economic interpretation. One side of the equation involves compensated cross-price elas-
ticities, used to compute the change in compensated demand for a particular commodity
when all taxes are increased proportionally across the board by an infinitesimal amount. The
other side involves the demands for this particular commodity for all agents weighted by
   1 Piketty (1997) and Saez (2002b) consider a discrete “job” model with a finite number of jobs and associ-
ated earnings levels, deriving discrete optimal tax formulas, but they do not provide a connection with the
Diamond-Mirrlees linear tax framework.
   2 Diamond and Mirrlees (1971) also briefly extend their analysis to consider parametric nonlinear tax sys-

tems and derive an optimality condition. However, due to its abstract nature, they do not develop it in detail,
and this parametric approach has not been followed up by the literature. This is not our starting point, nor our
ending point. We work with the Diamond-Mirrlees linear tax formula, which has been developed and applied
in detail, and use it to derive the Mirrlees non-parametric optimal tax formula.


                                                       2
their respective social marginal utilities of income—which in turn combine welfare weights,
marginal utilities of consumption, and income effects to account for fiscal externalities from
income transfers.
    The Mirrlees model, on the other hand, has at center stage two elements: the local com-
pensated elasticity of labor and the local shape of the skill distribution or earnings distribu-
tion. It also involves social marginal utilities and income effects.
    We show that the Diamond-Mirrlees formula reduces to the Mirrlees formula for two rea-
sons. First, the cross-price derivatives for compensated demands in the Diamond-Mirrlees
formula turn out to be zero, drastically simplifying one side of the equation. Thus, the Mir-
rlees model and its formula, when seen through the lens of Diamond-Mirrlees, constitutes
the rare “diagonal” case where an exact “inverse elasticity rule” applies. Second, in our for-
mulation, the commodity space is already specified as a choice over cumulative distribution
functions for labor supply. As a result, the Diamond-Mirrlees formula directly involves the
distribution of labor. In the basic Mirrlees model, this translates directly to the distribution
of earnings.
    Our results highlight a deep connection between two canonical models in public finance
and provide an alternative interpretation of the Mirrlees formula in terms of the Diamond-
Mirrlees formula. Another benefit of attacking the nonlinear tax problem this way is that the
Mirrlees formula is shown to hold under weaker conditions than commonly imposed. For
example, a general, possibly nonlinear, production function is a key feature of the Diamond-
Mirrlees model, whereas the baseline Mirrlees setup involves a simple linear technology.
Finally, our approach provides a powerful and simple tool to explore extensions of the stan-
dard Mirrlees model. We consider four such extensions.
    The original Mirrlees model is cast in a one-shot static setting, with a single consumption
and labor supply decision. Thus, the model abstracts from dynamic considerations as well
as uncertainty. Our first extension shows how to incorporate lifecycle features. In particular,
each individual faces a time-varying productivity profile, but pays taxes based on current
income. This is in line with present practice, where taxes are assessed annually, despite
individuals’ earnings varying significantly over their lifecycle.
    Due to the lack of age and history dependence in taxation, the optimal annual income
tax schedule solves a severely constrained—and hence complex—planning problem under
the standard mechanism design approach. The connection to the Diamond-Mirrlees model,
however, allows us to derive a formula for the optimal annual tax that is similar to the
standard static one with two differences: it features a local Frisch elasticity of labor supply,
which plays a similar role as the compensated elasticity in the static Mirrlees model, and a
new additional term that captures lifetime effects. In the simple case with quasilinear pref-
erences, the latter effect vanishes and the tax formula coincides in format with that of the

                                               3
static model. However, even in this special case, our analysis highlights that the application
of this formula requires taking into account that welfare weights are a function of lifetime
differences in earnings, rather than current annual differences in earnings. Since inequality
in lifetime earnings is smaller than inequality in annual earnings, the benefits for redistribu-
tion are smaller, for a given welfare function.
    Second, we incorporate human capital investment into the lifecycle framework. Notably,
individuals can choose an education level that will affect their lifetime productivity profile,
and individuals may differ in both their costs of this investment and its effect on produc-
tivities. We show that the formula for the optimal annual tax from the lifecycle model with
exogenous productivity profiles extends to this case, with the only difference that the novel
effect now also captures the effect of taxes on human capital. More generally, the novel effect
can be interpreted as a ”catch all” for any additional margins that affect individuals’ lifetime
productivity profiles and budget constraints.
    Third, the Diamond-Mirrlees model allows for general differences across agents. In con-
trast, the benchmark Mirrlees model adopts a single dimension of heterogeneity satisfying
a single-crossing assumption. Using our approach, we show how one can easily extend
the Mirrlees analysis to allow for rich multi-dimensional forms of heterogeneity. Our re-
sults show that the standard formula holds using simple averages of the usual sufficient
statistics, elasticities and marginal social utilities. This generalizes Saez (2001), who allowed
for heterogeneity in his perturbation analysis of the asymptotic top marginal tax rate, and
Jacquet and Lehmann (2015), who obtain a result under additively separable preferences
based on an extended mechanism design approach that incorporates the constraint that a
single income tax schedule cannot fully separate agents when there are multiple dimensions
of heterogeneity. The Diamond-Mirrlees approach provides a very straightforward way of
dealing with rich forms of heterogeneity.
    Fourth, the Mirrlees model only considers an intensive margin of choice for labor sup-
ply. Other analyses have incorporated an extensive participation margin, following the
seminal contribution by Diamond (1980). We show that the Diamond-Mirrlees model also
nests these models, including the pure extensive-margin model in Diamond (1980) and the
hybrid intensive-extensive models considered in Saez (2002b) and Jacquet, Lehmann and
Van der Linden (2013). Indeed, we consider a slightly more general specification and use
the Diamond-Mirrlees approach to obtain the relevant tax formula. As in the lifecycle ex-
tensions, the demand system with both an intensive and extensive margin is no longer di-
agonal with zero cross-elasticities, and optimal tax formulas are no longer an application of
the “inverse elasticity rule.” Despite this fact, the demand system still retains an elementary
structure and, thus, delivers relatively simple and easily interpretable tax formulas.
    Of the four extensions we offer, we believe the first two to be the most significant, in the

                                               4
sense that, to the best of our knowledge, they have no precedent in the literature. Moreover,
a mechanism design approach, while probably feasible, would be relatively contrived in
these contexts. Our other two extensions, adding heterogeneity and the extensive margin,
have clear precedents in the literature, as already mentioned. Although our assumptions
and results differ in details, we believe the main benefit of covering these two extensions
is to illustrate the benefits of revisiting them with a Diamond-Mirrlees perspective. Indeed,
our method is able to handle these extensions with ease while highlighting the economics
of each extension, summarized by the impact different assumptions have on the resulting
demand system.
    This paper is organized as follows. Section 2 introduces both the Diamond and Mirrlees
(1971) and the Mirrlees (1971) model, and Section 3 shows how the Mirrlees model can
be understood as a special case of Diamond-Mirrlees. Section 4 presents the optimal tax
formulas from both models and Section 5 shows how to obtain the Mirrlees formula directly
from the one in Diamond-Mirrlees. All the extensions are collected in Section 6 and Section
7 concludes. Most formal derivations are relegated to the appendix.


2     Diamond-Mirrlees and Mirrlees Models
We begin by briefly describing both frameworks, starting with the Diamond and Mirrlees
(1971) linear tax model and then turning to the nonlinear tax model in Mirrlees (1971). To
make the two models comparable, we extend Diamond-Mirrlees to a case with a continuum
of goods and agents.


2.1   Diamond-Mirrlees
A set of agents is indexed by h ∈ H. Agent h has utility

                                            uh ( x h )

over net demands x ∈ X. Technology is represented by

                                          G ( x̄ ) ≤ 0,                                   (1)

where x̄ is the aggregate of x h over H. Agents face a linear budget constraint

                                         B( x h , q) = I




                                                5
with consumer prices q. Diamond-Mirrlees consider both the case where one allows a
nonzero lump-sum tax or transfer, I 6= 0, as well as the case where it is ruled out, by im-
posing I = 0. We shall be more interested in the natural case where the lump-sum tax is
permitted.
   The objective of the planner is to maximize a social welfare function

                                                     W ({uh }),

where {uh } collects the utilities obtained by each agent h ∈ H.
    Under the simplest interpretation in Diamond-Mirrlees, all production is controlled by
the planner. The planner sets prices q and possibly the transfer I (if I is not required to
be zero) and agents select their net demands x h to maximize utility subject to their budget
constraint. The planner is constrained by the fact that these demands must be consistent
with the technological constraint (1).
    As is well understood, whenever technology is convex and has constant returns to scale,
this planning problem can be reinterpreted as allowing private production by firms to maxi-
mize profits at some producer prices p 6= q. In other words, one can implement the previous
planning problem by allowing decentralized private production. Taxes are then equal to the
difference between consumer and producer prices, t = q − p.


Finite agents and goods.         In Diamond and Mirrlees (1971), there is a finite population
H = {1, 2, . . . , M}, so we can write
                                                          M
                                                 x̄ =    ∑ xh .
                                                         h =1

There is a finite set of goods indexed by i ∈ {1, 2, . . . , N }, so that x h = ( x1h , x2h , . . . , x hN ). The
budget constraints are then
                                                         N
                                            q·x =h
                                                        ∑ qi xih = I,
                                                        i =1

where q = (q1 , q2 , . . . , q N ). Note that some elements of the vector x may be positive while
others negative, with the interpretation that negative entries represent a surplus or supply
(i.e. selling in the market), while positive entries represent deficits or demand (i.e. buying
in the market).


Continuum of agents and goods. A simple extension to allow for a continuum of agents
and commodities is as follows. Let there be a measure of agents µh over a set H. The set
of goods is allowed to be infinite. Each agent h consumes a signed measure x h ∈ X over
these goods and is subject to a linear budget constraint B( x, q) = I as before, where q are

                                                         6
consumer prices. This is a natural generalization. With a finite set of goods, choosing a
measure is equivalent to selecting the quantity of each good.


2.2   Mirrlees
Agents are indexed by their productivity θ with c.d.f. F (θ ) on support Θ. They have utility
function
                                        U (c, y; θ ),

over consumption c and effective labor effort y with the single-crossing condition that the
marginal rate of substitution function

                                                                  Uy (c, y; θ )
                                    MRS(c, y; θ ) = −
                                                                  Uc (c, y; θ )

is strictly decreasing in θ (so higher θ types find it less costly to provide y). The canonical
specification in Mirrlees (1971) is U (c, y; θ ) = u(c, y/θ ) for some utility function over c and
actual effort y/θ. Agents are subject to the budget constraint

                               c(θ ) ≤ y(θ ) − T (y(θ )) ≡ R(y(θ )).

where T is a nonlinear income tax schedule and R is the associated retention function. The
tax on consumption is normalized to zero without loss of generality.
    Technology is defined by the resource constraint
                                ˆ                             ˆ
                                        c(θ ) dF (θ ) ≤               y(θ ) dF (θ ).
                                    Θ                             Θ

Thus, the different efficiency units of labor are perfect substitutes.
   We will consider a generalization of technology to allow for imperfect substitution. Any
choice over y(θ ) induces a distribution over y which we denote by its associated cumulative
distribution function (c.d.f.) H (y). We consider the resource constraint to be
                                         ˆ
                                                 c(θ ) dF (θ ) ≤ G ( H ),                      (2)
                                             Θ

for some production function G. The special case mentioned earlier is when
                                        ˆ    ∞                    ˆ       ∞
                          G( H ) =               y dH (y) =                   (1 − H (y)) dy
                                         0                            0

where the second expression follows by integration by parts.


                                                          7
    The goal is to maximize a social welfare function W ({U (c(θ ), y(θ ); θ )}). The planner sets
a tax function T or, equivalently, a retention function R, and agents then select c(θ ), y(θ ) to
maximize utility subject to their budget constraint. The planner is constrained by the fact
that these demands must be consistent with the technological constraint (2). Once again, un-
der the simplest interpretation, all production is controlled by the planner. But the optimum
can be decentralized with private production by firms under the usual conditions.


3      Mirrlees as a Special Case of Diamond-Mirrlees
The main difference between the Diamond-Mirrlees model and the Mirrlees model is that
taxation is linear in the former, while it is allowed to be nonlinear in the latter. We will argue
that this difference is only apparent: The Diamond-Mirrlees framework can accommodate
nonlinear taxation and nest the Mirrlees model.
   We present two ways of mapping one model into the other. The first is more straight-
forward and works directly with prices and taxes in levels. The second entails a change of
variables to rewrite things in terms of marginal prices and taxes. This reformulation is more
convenient to work with and is instrumental in relating the optimal tax formulas for both
models in Section 5.


3.1     Levels Formulation
We now describe an economy in Diamond-Mirrlees that captures the Mirrlees problem.
Agents are indexed by their skill type, so that h = θ and µh is defined by the c.d.f. over
skills F. The commodity space is comprised of a single consumption and a continuum of
labor varieties indexed by y ≥ 0.3 Agent θ chooses a level for consumption c ≥ 0 as well as
a measure over labor varieties which can be summarized by a c.d.f. Hθ (y).
    Technology is given by         ˆ
                                                  c(θ )dF (θ ) ≤ G ( H )
                                              Θ
             ´
where H (y) = Hθ (y)dF (θ ) is the aggregate c.d.f. over y.
  Each agent faces a budget constraint
                                                  ˆ    ∞
                                           c≤              q(y)dHθ (y) + I,                    (3)
                                                   0

where we have normalized the price of the consumption good c to unity. In the Diamond-
Mirrlees notation and nomenclature, the tax on consumption has been normalized to zero,
    3 See   Section 5.4 for how this can be generalized to multiple consumption goods.


                                                              8
while the tax on variety y is given by q(y) − p(y) for some { p(y)} representing the deriva-
tives of the production function G; in the standard Mirrlees model with linear technology
p(y) = y.
    Finally, we assume that agents must put full mass of unity on a particular value for y.
This is a restriction on preferences, that is, on the space over which the utility function is
defined. Specifically, we assume agents attain utility U (c, y; θ ) when they consume c and
put full mass on y; they would obtain −∞ if they attempted to distribute mass over various
points or put less than measure one. Thus, the measure is a c.d.f. Hθ (y) that is increasing
and a step function, jumping from 0 to 1 at the chosen y(θ ). This implies that the budget
constraint specializes to
                                         c ≤ q(y) + I,

so that the q(y)-schedule is effectively the retention function in the Mirrlees model.
     This completes the description of a particular Diamond-Mirrlees economy that nests the
Mirrlees model. Under this formulation, the agents choose a measure Hθ (y) over y and
a consumption level, subject to a budget constraint that is linear in these objects. Thus,
standard consumer demand theory applies, with the price of good y as q(y).
     The only complication is that the natural quantities in this formulation are densities. In
                                                                                 ´∞
particular, if Hθ admits a density hθ then the budget constraint becomes c ≤ 0 q(y)hθ (y)dy +
I. However, in our Mirrlees formulation, we are actually ensuring that Hθ has no density
representation.
     A related point is that a small change in the price schedule can have discontinuous effects
on demand. For example, suppose the production function is linear—so that p(y) = y—and
start with no taxation—so that q(y) = p(y) = y. If the skill distribution is continuous, the
economy produces a density over y in aggregate. However, if one reduces q(y0 ) at a point
y0 , by any positive amount, then a mass of agents shift towards y0 (from the neighborhood
around y0 ). Conversely, if we raise q(y0 ) at y0 , then the density of agents at this point drops
discontinuously to zero. Thus, aggregate demand behaves discontinuously with respect to
these forms of price changes. To overcome both problems, we next reformulate the model
using a change of variables.


3.2   A Reformulation
We have cast the Mirrlees model into the Diamond-Mirrlees framework. In this formulation,
consumers face prices q(y) and the planner can be seen as controlling taxes t(y) = q(y) −
p(y). We now discuss a simple reformulation in terms of the marginal price q0 (y) and marginal
taxes t0 (y) = q0 (y) − p0 (y).



                                               9
    Integrating the budget constraint (3) by parts gives
                                     ˆ    ∞
                                c≤            q0 (y)(1 − Hθ (y))dy + Ĩ                         (4)
                                      0

where Ĩ = q(0)(1 − Hθ (0)) + I.
    Under this formulation, we can interpret q0 (y) and 1 − Hθ (y) as the price and quantity,
respectively, for good y. Agent θ chooses the quantity of each of these goods to maximize
utility, taking into account any restriction dictated by preferences (his consumption feasibil-
ity set). Because the budget constraint is linear, standard consumer theory applies.
    This overcomes the two problems discussed above. First, quantities are now always
well-defined, even when the c.d.f. Hθ (y) admits no density representation. In particular, the
demand by household θ for good y is

                                   1 − Hθ (y) = I(y ≤ y(θ )),

where y(θ ) is θ’s preferred level of y. For later use, we will also denote by 1 − Hθc (y) the com-
pensated demand, i.e. holding utility unchanged for agent θ. Second, aggregate demand for
good y                                        ˆ       ∞
                               1 − H (y) =                (1 − Hθ (y))dF (θ )
                                                  0

is no longer discontinuous with respect to focalized changes in the price schedule q0 (y). In
addition to overcoming these two problems, this formulation in terms of marginal prices is
more natural to link to the Mirrlees formula, which is expressed in terms of marginal tax
rates.


4     Tax Formulas: Diamond-Mirrlees and Mirrlees
Here we briefly review the optimal tax formulas offered by both models. These formulas
crystalize the main results from these theories, offer intuition and provide the starting points
for empirical applications. Readers familiar with these formulas can skip this section.


4.1   Diamond-Mirrlees
The first-order optimality conditions for the Diamond-Mirrlees model can be expressed in
various useful and insightful ways. There are several different expressions, depending on
whether or not one expands the effects of tax changes on tax revenues, whether one uses the
compensated or uncompensated demands, and how one groups the different terms. The one


                                                      10
we find most useful is due to Diamond (1975) (and the related analysis in Mirrlees, 1976).
   In the case of finite goods and agents, the formula for good i is
                                                                !
                                         M                                      M
                                  ∂
                                 ∂τ     ∑      xic,h (q + τt)              =   ∑ β̂h xih .                     (5)
                                        h =1                        τ =0       h =1


The left-hand side is the change in the demand for good i due to a compensated change in
prices in the form of a proportional increase in all taxes.4 This left-hand side (or the same
expression divided by aggregate demand for the good) is often interpreted as an index of
“discouragement,” which measures by how much the tax system lowers the demand for the
good, captured by substitution effects of compensated demands.
   The right-hand side is the demand weighted by “social marginal utilities from income,”
defined as                                                          !
                                                 N
                                            ∂
                                            ∂I j∑
                               h    h                      h
                             β̂ = β − 1 +            t j x j (q, I ) ,                     (6)
                                                 =1

Here, βh is the marginal social benefit of increasing consumption for agent h. The next term,
−1, captures the resource cost of providing the extra income to increase consumption in the
absence of taxes. The final term corrects the latter for fiscal externalities due to the presence
of taxes: when transferring income to agent h, this agent will spend the income on goods
that are taxed, and income may flow back to the government. Thus, when the last term is
positive, the social cost is less than 1. Overall, the social marginal utility of income may be
positive or negative. Indeed, when the poll tax I is available, then the optimality condition
for I implies that the average of the social marginal utilities of income across agents must be
zero: ∑hM=1 β̂h = 0.
    Thus, this version of the Diamond-Mirrlees optimal linear tax formula states that the dis-
couragement (or encouragement) of a good through the tax system should be in proportion
to the welfare-weighted level of that good. Goods that are consumed more by those with
high β̂h should be encouraged and vice versa. In the context of labor supply (a negative
entry in the x-vector), if agents who work and earn more have lower β̂h then labor should
be discouraged.
   4 The left-hand side is often written more explicitly as ∑h ∑ j t j ∂q∂ xic,h . However, this format is one step
                                                                          j
removed from its economic interpretation, i.e. the aggregate change in good i when all taxes rise proportionally
and agents are compensated. In addition, this explicit format is specific to the finite good case, since the
derivatives ∂q∂ xic,h are not immediately well-defined with a continuum of goods, or requires reinterpretation. In
               j
                                                  
                                        c,h
contrast, the expression ∂τ  ∂
                                 ∑hM=1 xi (q + τt)    is closer to the interpretation and carries over immediately
                                                    τ =0
to the continuum case.




                                                           11
4.2    Mirrlees
Just as in the case of Diamond-Mirrlees, the Mirrlees optimality conditions can be expressed
in a number of equivalent forms. There are two main choices. First, the conditions can
be expressed in differential or in integral form. Second, they can be expressed using the
primitive skill distribution or using the implied distribution of earnings. Finally, one can
derive the optimality conditions by various methods: applying the Principle of Optimality
by setting up a Hamiltonian, setting up a Lagrangian and taking first-order conditions, or
using local perturbation arguments. For concreteness, we shall focus on the version of the
optimality condition that is expressed in integral form and using the earnings distribution,
rather than the skill distribution, as in Saez (2001). However, we show in Appendix A how
to connect to other versions.
    We first introduce the relevant elasticities that play a role in the formula. Consider the
agent problem
                            y(ξ, I ) ∈ arg max U (q(y) − ξy + I, y; θ ),
                                                       y

which allows us to measure the behavioral effect of a small increase in the marginal tax rate
(captured by ξ) and income effects (in response to I) starting from a given schedule q(y).
Then we define the uncompensated tax elasticity and the income effect by

                              ∂y              q0 (y)                                        ∂y
                 εu (y) = −                                and          η (y) = −                           q 0 ( y ),   (7)
                              ∂ξ   ξ = I =0      y                                          ∂I   ξ = I =0

with the compensated elasticity obeying the Slutsky relation

                                              ε c ( y ) = ε u ( y ) + η ( y ).

Note that εc ≥ 0; moreover, η ≥ 0 if “leisure” −y is a normal good. We will assume that the
initial schedule q is such that the optimum is continuous in τ and I. This is equivalent to
assuming that the agent’s optimum is unique.
    The optimality condition in the Mirrlees model can then be expressed as
                                          ˆ       ∞                          ˆ       ∞
              T 0 (y) c                                                                   T 0 (ỹ)
                        ε (y)yh(y) =                  1 − β ỹ dH (ỹ) +                              η (ỹ)dH (ỹ),     (8)
            1 − T 0 (y)                       y                                  y       1 − T 0 (ỹ)

at all points where no bunching takes place.5 Here, H denotes the c.d.f. for labor supply y,
h is its associated density, and β y is the social marginal utility from consumption. Equation
(8) must be supplemented with a boundary condition, stating that the right-hand side of (8)
   5 However,  somewhat informally, one can still interpret this equation as holding since dividing by h(y) and
noting that εc = 0 and h(y) = ∞ when there is bunching, the equation holds for any T 0 (y).


                                                            12
is equal zero at the lower bound of the support for H (y).
    A version of equation (8) was derived in Saez (2001, equation (19), p. 218) employing
a perturbation argument where, starting from the optimal tax schedule, marginal tax rates
are increased by a small amount dτ in the small interval [y, y + dy]. Then the left-hand side
of condition (8) corresponds to the substitution effect of those individuals in [y, y + dy] due
to the increase in the marginal tax rate in this interval. The first term on the right-hand
side captures the mechanical effect net of welfare loss from the reform, because increasing
the marginal tax rate in [y, y + dy] implies that everyone above y pays dτdy in additional
taxes, each unit of which is valued by the government 1 − β y . Finally, the second term on
the right-hand side captures the income effect of this additional tax payment for everyone
above y. Setting the sum of the substitution, mechanical and income effects equal to zero at
the optimum yields equation (8).
    One minor difference is that our definitions for the elasticities capture changes starting
from a baseline where the agent faces a nonlinear price schedule q; the nonlinearity could
be due to a nonlinear tax, t(y), or a nonlinear producer price, p(y), or both. In particular,
the compensated elasticity is affected by the local curvature of q. These definitions seem
natural in a nonlinear taxation context and help streamline optimal tax formulas. Indeed,
our formula (8) involves the actual distribution of earnings, while the one in Saez (2001)
uses instead a modified “virtual density,” which is affected by the local curvature in the tax
schedule.
    Equation (8) can be interpreted as a first-order differential equation that implicitly char-
acterizes the optimal tax schedule. Solving it yields the well-known ABC-formula

                                        T 0 (y)
                                                  = A(y) B(y)C (y)                                                       (9)
                                      1 − T 0 (y)
                                                          ˆ       ∞                  ˆ       ỹ
                                                                                                             !
         1            1 − H (y)                                                                  η (z) dz         dH (ỹ)
A(y) = c     , B(y) =           , and C (y) =                         1 − β ỹ exp                                         .
       ε (y)            yh(y)                                 y                          y        εc (z) z       1 − H (y)

Both formulas, (8) and (9), are identical when there are no income effects, η = 0, as in the
related formulas derived by Diamond (1998).6


5     Tax Formulas: From Diamond-Mirrlees to Mirrlees
We now show how to reach the Mirrlees formulas (8)–(9) starting from the Diamond-Mirrlees
formulas (5)–(6). We do so by first translating the left-hand side of (5) into the Mirrleesian
    6 Diamond (1998) expressed the formula as a function and the primitive skill distribution, rather than the
implied earnings distribution.


                                                     13
reinterpretation laid out in Section 3.2, followed by the right-hand side.


5.1   Left-Hand Side in Diamond-Mirrlees
The proportional change in all taxes underlying the left-hand side of equation (5) corre-
sponds to changing the marginal consumer price schedule such that

                                    q0 (y; τ ) = q0 (y) + τt0 (y)                             (10)

for all y, where t0 (y) = q0 (y) − p0 (y). Then the left-hand side of equation (5) is simply equal
to
                                         ∂
                                           (1 − H c (y; τ ))      ,                            (11)
                                        ∂τ                   τ =0

where H c (y; τ ) is the aggregate distribution of y under price schedule q0 (y; τ ), and the su-
perscript c indicates that the compensated responses are required when we vary τ.
    When τ is increased infinitesimally from zero, the compensated response for each agent
is, by (10) and the definition of the compensated elasticity, a decrease in y equal to

                                        ∂yc (θ; τ )                     εc (y)y
                              −t0 (y)                        = t0 (y)           .
                                           ∂τ         τ =0               q0 (y)

Since each agent lowers y, this produces a shift in the distribution H to the left. At a particu-
                                                               t0 (y)
lar point (y, H (y)), the horizontal shift equals precisely q0 (y) εc (y)y. Equation (11), however,
demands the implied vertical shift. To translate the horizontal shift into the vertical shift
requires multiplying by the slope of H, that is, the density h. We conclude that the left-hand
side of (5) equals
                             ∂                          t0 (y)
                               (1 − H c (y; τ ))      = 0 εc (y)yh(y).                         (12)
                            ∂τ                   τ =0  q (y)
The formal derivation is contained in Appendix A.
   Equation (12) reveals that the left-hand side of the Diamond-Mirrlees formula simplifies
drastically when applied to the Mirrlees setting: the relevant response for y only depends
on the variation in the marginal tax rate t0 (y) at y, and not on the variation in the entire
schedule in (10). In other words, the Mirrlees model constitutes the rare diagonal case where
compensated cross-price elasticities of demand are zero and only the own-price elasticity
matters. This coveted case is often highlighted in the commodity tax literature for it implies
an “inverse elasticity rule.”




                                                      14
5.2           Right-Hand Side in Diamond-Mirrlees
The analog, with a continuum of goods, of the right-hand side of equation (6) in conjunction
with (5) is
  ˆ       ∞                                       ˆ   ∞                                          
                                     ∂                      0
              (1 − Hθ (y)) β θ − 1 −                     t (z) (1 − Hθ (z; I )) dz dF (θ )
      0                              ∂I            0
                                   ˆ ∞                              ˆ y(θ;I )         !
                                                                  ∂
                                =                      βθ − 1 −               t0 (z)dz dF (θ )
                                           θ (y)                 ∂I 0
                                                                    ˆ ∞                                    
                                                                                         0        ∂y(θ; I )
                                                                  =           β θ − 1 − t (y(θ ))             dF (θ ), (13)
                                                                     θ (y)                          ∂I

where θ (y) denotes the inverse of y(θ ).7 Substituting ∂y(θ; I )/∂I = −η (y)/q0 (y) into (13)
and changing variables from θ to y = y(θ ) yields
                                   ˆ       ∞                                   ˆ       ∞
                                                                                           t0 (ỹ)
                               −               (1 − β ỹ )dH (ỹ) +                                η (ỹ)dH (ỹ),                     (14)
                                       y                                           y       q0 (ỹ)

with a slight abuse of notation to write β y for β θ (y) .


5.3           Putting it Together
Equating (12) and (14) yields
                                                        ˆ       ∞                                ˆ       ∞
                       t0 (y)                                                                                t0 (ỹ)
                      − 0 εc (y)yh(y) =                             (1 − β ỹ )dH (ỹ) −                             η (ỹ)dH (ỹ).   (15)
                       q (y)                                y                                        y       q0 (ỹ)

To translate this into the Mirrlees model with a nonlinear tax over pre-tax earnings p(y), we
set q(y) = p(y) − T ( p(y)) and recall that t(y) = q(y) − p(y), so that t(y) = − T ( p(y)) and

                                                       t0 (y)       T 0 ( p(y))
                                                              = −                 ,                                                   (16)
                                                       q0 (y)     1 − T 0 ( p(y))

which upon substitution gives precisely the Mirrlees formula (8). Thus, applying the Diamond-
Mirrlees formula (5) to the Mirrlees model immediately delivers the condition which Saez
(2001) obtained from his perturbation argument, equating, at the optimum, the substitution
effect on the left-hand side with the sum of the mechanical effects net of welfare loss and the
income effects on the right-hand side.
    7 Recall that y ( θ ) is monotone increasing by the single-crossing assumption. Moreover, note that the effect

of I on 1 − Hθ has the opposite sign in (4) compared to (6), which is why the income effects enter with a minus
sign in (13).



                                                                          15
    In Appendix A, we show how to solve (15) to obtain the ABC-formula
                                             ˆ       ∞                  ˆ                       !
               t0 (y)     1 1 − H (y)                                          ỹ
                                                                                     η (z) dz         dH (ỹ)
              − 0     = c                                1 − β ỹ exp                                         ,   (17)
               q (y)    ε (y) yh(y)              y                          y        εc (z) z       1 − H (y)

which upon the same substitution of the relationship (16) delivers (9). This concludes the
derivation of the Mirrlees formulas (8)–(9) from the Diamond-Mirrlees formulas (5)–(6).


5.4       Discussion
Tax formula in terms of skills. Mirrlees (1971) expresses the optimal tax formula in terms
of the primitive skill distribution instead of the implied distribution of labor supply. In
Appendix A, we show that there is a direct link between the two, and we demonstrate how
to rewrite formulas (8) and (9) as a function of F (θ ) rather than H (y). The rewritten formulas
characterize the marginal tax rate τ (θ ) = t0 (y(θ )) faced by type θ. We emphasize though
that this is one step removed from the formulas that naturally result from an application of
the Diamond-Mirrlees framework, which are in terms of y. In particular, when expressing
them in terms of elasticities, the formulas in terms of θ require the use of different elasticity
concepts in general.8


Technology and tax instruments. An advantage of deriving the Mirrlees optimal tax for-
mula from the Diamond-Mirrlees formula is that it allows for a general structure of the
production side of the economy. A general, possibly nonlinear, production function is a key
feature of the Diamond-Mirrlees model. In contrast, the baseline Mirrlees setup involves a
simple linear technology. As our derivation makes clear, the Mirrlees optimal tax formula
holds for any production function G ( H ). In other words, the result of Diamond and Mirrlees
(1971) that their tax formula is independent of whether technology is linear or not extends
to the Mirrlees formula.
    We note, however, that this result relies on the availability of sufficiently rich tax instru-
ments. Consider, for instance, a two-sector economy with technology G ( H1 , H2 ), so a given
level of labor supply y can have different effects depending on whether it enters in sector 1 or
2. Then the Diamond-Mirrlees framework, and hence our analysis, requires sector-specific
tax instruments t1 (y) and t2 (y). In the absence of this, with only a single tax schedule t(y),
the Mirrlees formula generally gets modified to reflect general equilibrium effects on redis-
tribution (Stiglitz, 1982, and Rothschild and Scheuer, 2013). Moreover, production efficiency
   8 It
      is also possible to rewrite the optimal tax formulas as a function of the implied distribution of earnings
p(y), again requiring different elasticity concepts in general when p(y) 6= y (see for example Scheuer and
Werning (2015) for the required elasticity adjustments in the context of superstar effects).


                                                          16
is not necessarily optimal with restricted tax instruments (Guesnerie, 1998, and Naito, 1999).
In our framework with sufficiently targeted instruments, however, these considerations play
no role.9


Multiple consumption goods. In line with the original Mirrlees model, we have consid-
ered a single consumption good. Since the Diamond-Mirrlees model naturally allows for
any finite number N of commodities, it is straightforward, however, to extend our analysis
to multiple consumption goods. With linear taxes on each of the consumption goods (nor-
malizing one of them to zero), an application of conditions (5) and (6) would immediately
deliver formulas for (i) the optimal linear commodity tax rates in the presence of the opti-
mal nonlinear labor income tax schedule and (ii) marginal tax rates of the optimal nonlinear
income tax schedule in the presence of the optimal commodity taxes.
    Such formulas have been derived in the literature using standard mechanism design (see
for example Mirrlees, 1976, and Jacobs and Boadway, 2014) or variational approaches (e.g.
Christiansen, 1984, and Saez, 2002a). A crucial feature of these formulas are conditional labor
elasticities of the commodity demands, which measure how the demand for a consumption
good ci changes when labor y changes but after-tax income q(y) is held fixed. When these
cross-elasticities are zero, which holds under the weakly separable preference specification
U (u(c1 , ..., c N ), y; θ ) considered by Atkinson and Stiglitz (1976), it then immediately follows
that (i) all commodity taxes are zero at the optimum, and (ii) the formula for the optimal
marginal income tax rates is the same as derived here except for additional income effects
on commodity demands on the right-hand side of (15).


6      Four Extensions of the Mirrlees Model
In this section, we briefly consider four extensions that illustrate the power and ease of our
approach. First, we extend the Mirrlees model to a lifecycle framework where workers pay
an annual income tax, but productivity varies from year to year. Second, we incorporate hu-
man capital investments into this lifecycle framework, endogenizing individuals’ lifetime
productivity profiles. Third, we enrich the static Mirrlees model to allow for additional
arbitrary dimensions of heterogeneity, without single-crossing assumptions. Fourth, we in-
corporate an extensive margin, alongside the intensive margin, for labor supply. The first
two of these extensions are novel, and would be rather cumbersome to tackle with the usual
mechanism design approach. The third and fourth extensions of the Mirrlees models have
    9 Saez
         (2004) links a discrete jobs model to the Diamond-Mirrlees model and discusses the implications of
nonlinear production functions, also contrasting the results with Stiglitz (1982) and Naito (1999). However,
Saez (2004) does not attempt to derive the Mirrlees optimal tax formula.


                                                    17
precedents in the existing literature.10 While our assumptions and results are slightly differ-
ent, the main benefit of our treatment of these extensions is to illustrate the power and ease
of our approach based on the Diamond-Mirrlees formula.


6.1     Annual Taxation of Earnings in a Lifecycle Context
The original Mirrlees model is a one-shot static model: there is a single consumption good
and a single labor supply choice. We now consider a simple dynamic extension, to incorpo-
rate a lifecycle choice for labor supply.
    Suppose ex ante heterogeneity is indexed by θ ∼ F (θ ) as before. Each individual faces
varying productivities δ over her lifetime with conditional distribution P(δ|θ ). Individuals
choose how much labor to supply for each δ, resulting in a schedule y(δ; θ ). The government
sets a nonlinear income tax schedule, resulting in the retention function q(y) for the income
earned at any point in time (i.e. an “annual” tax without age or history dependence, as is
the case in practice). Moreover, markets are complete, so individuals smooth consumption
over their lifecycle respecting their budget constraint
                                               ˆ       ∞
                                       c=                  q(y(δ; θ ))dP(δ|θ ).
                                                   0

Preferences are
                                                           U (c, Y; θ )

with                                           ˆ   ∞
                                     Y=                    v(y(δ; θ ), δ)dP(δ|θ ).
                                               0

We can interpret v(y, δ) as a measure of the instantaneous disutility from supplying effective
labor y at a moment when productivity is δ, and as usual we assume v is such that we have
single-crossing in δ. Then Y captures the total disutility from labor over the individual’s
lifetime. We do not require assumptions about the nature of ex ante heterogeneity in θ.
    As before, we can think of each individual as choosing a distribution Hθ (y) over y. The
only difference to before is that this distribution is no longer degenerate (i.e., no longer a step
function). Using this insight, we show in Appendix B that our analysis carries over easily
and leads to the following formula for the optimal annual tax t(y):
                                                       ˆ       ∞                         ˆ       ∞
                           t0 (y)                                                                              t0 (ỹ)
                                          
            F
                                  + Λ(y)
                                                                          
        − yε (y)h(y)                           =                   1 − β̄ ỹ dH (ỹ) −               η̄ (ỹ)           dH (ỹ).   (18)
                           q0 (y)                          y                                 y                 q0 (ỹ)
  10 See,among others, Saez (2001), Hendren (2014) and Jacquet and Lehmann (2015) for the third and Dia-
mond (1980), Saez (2002b), Choné and Laroque (2011), Jacquet et al. (2013), Zoutman et al. (2013) and Hendren
(2014) for the fourth extension.


                                                                   18
This is very similar to the static formula (15) except for the following differences.
   First, ε F (y) is a Frisch elasticity of labor supply that holds fixed λ ≡ −Uc /UY , i.e. the
marginal rate of substitution between lifetime consumption and lifetime labor supply. This
elasticity is purely local in the sense that it depends only on the local shape of the flow
disutility function v and on the local shape of the annual tax schedule at y.
   Second, there is a novel term on the left-hand side
                                    ˆ
                                                1      ∂λc (τ, θ )
                          Λ(y) =                                            dF (θ |y),
                                        Θ   λc (τ, θ )    ∂τ         τ =0

which captures precisely the lifetime effects on the compensated labor supply. In particular
(and as explained in more detail in Appendix B), λc (τ, θ, Ū ) is defined such that

                                y F (τ, λc (τ, θ, Ū )) = yc (τ, θ, Ū ),

where y F is the Frisch labor supply, holding λ fixed, and yc is the compensated labor supply,
holding lifetime utility Ū fixed (and we dropped the argument Ū in λc ). This captures global
effects on labor supply and the interactions of labor supply across different “ages,” i.e. across
different values of δ. The effect Λ(y) will generally depend on the entire tax schedule.
    Third, on the right-hand side, η̄ (y) is the average income effect and β̄ y the average social
welfare weight at y (across θ).
    We emphasize the following implications of the lifecycle framework for the shape of the
annual income tax schedule. First, the fundamental welfare weights β θ only vary with ex
ante (i.e., lifetime) heterogeneity θ. Since there can be substantially less lifetime inequality
than cross-sectional inequality at any given point in time (which is driven by δ in addition
to θ), the average welfare weights at a given income β y naturally vary less than in the static
framework. An extreme case occurs when there is no ex ante heterogeneity, so all income
inequality is driven by the shocks δ. Hence, when viewed over their entire lifetimes, all in-
dividuals face the same distribution of these shocks, but the resulting cross-sectional income
inequality at any point in time can be arbitrarily large. Then β y is independent of y and
optimal annual taxes are zero.
    Second, in the special case of quasilinear lifetime preferences
                                       ˆ       ∞                              
                             U c−                   v(y(δ; θ ), δ)dP(δ|θ ); θ ,
                                            0

the additional term on the left-hand side vanishes: Λ(y) = 0. Hence, in this case, the stan-
dard formula from the static setting fully extends to the annual tax in this much richer life-
cycle framework.


                                                         19
6.2     Human Capital
It is easy to incorporate human capital investment in this lifecycle framework. In particular,
suppose individuals choose an education level e before entering the labor market, which
affects their productivity distribution P(δ|θ, e). Their lifetime utility is U (c, Y; θ, e), which
can capture costs of the education investment e in a general form (and note that these costs
can differ across θ-types). Otherwise, the framework is identical to the one in the preceding
subsection. As before, the government looks for the optimal annual nonlinear income tax
schedule, or equivalently q(y).11
     As we show in Appendix B, all the results from the basic lifecycle framework go through.
In particular, the optimal tax formula (18) still applies. The effect Λ(y) takes the same form
as before, but now also captures the effect of taxes on individuals’ human capital choices.12
In this sense, Λ(y) can be interpreted as a ”catch all” for any additional margins that affect
individuals’ lifetime productivity profiles and budget constraints.


6.3     More General Forms of Heterogeneity
An important advantage of approaching the Mirrlees model from the perspective of the
Diamond-Mirrlees framework is that we can easily accommodate relatively general forms of
heterogeneity, as we now show. General forms of heterogeneity are inherent to the structure
in Diamond-Mirrlees. In contrast, the baseline Mirrlees setup allows for only one dimension
of heterogeneity satisfying a single-crossing condition.
    Returning to the static framework, suppose there are groups, indexed by φ and dis-
tributed according to c.d.f. P(φ) (and support Φ) in the population, with preferences

                                                      U (c, y; θ, φ).

We only require that the single-crossing property in terms of θ is satisfied among individuals
with the same φ, i.e. MRS(c, y; θ, φ) is strictly decreasing in θ for each φ. Apart from that,
we can allow for arbitrary preference heterogeneity captured by φ. For example, φ could
be from a finite set or a continuum, and it could be single- or multidimensional. This is
in line with the Diamond-Mirrlees model, where h can index arbitrary differences across
households.
    In Appendix B, we show how to generalize the analysis from Section 5 to such a frame-
work. The Mirrlees optimal tax formulas (8) and (9) go through when replacing the elas-
  11 This assumes that the human capital investment e is not taxed or subsidized directly. In other words, we
abstract from exploring its optimal tax treatment (see e.g. Bovenberg and Jacobs, 2005, and Stantcheva, 2016,
for recent work on this issue).
  12 In particular, Λ again vanishes if lifetime preferences take the quasilinear form U ( c, Y; θ, e ) = Ũ ( c − Y; θ, e ).



                                                            20
ticities εc (y) and η (y) as well as the marginal social welfare weights β y by their averages
conditional on y. For example, εc (y) is simply replaced by
                                                                     ˆ
                              c                       c
                             ε̄ (y) = E[ε (y, φ)|y] =                        εc (y, φ)dP(φ|y),
                                                                         Φ

where P(φ|y) is the distribution of φ conditional on y (and analogously for η̄ (y) and β̄ y ).13


6.4     Extensive-Margin Choices
Finally, we demonstrate how the Diamond-Mirrlees setting can easily incorporate extensive
margin labor choices, generalizing the environments considered by Diamond (1980), Saez
(2002b), Choné and Laroque (2011), and Jacquet et al. (2013) among others. We shall derive
the resulting tax formula starting from the Diamond-Mirrlees formulas (5)–(6).
    For simplicity, suppose individuals are characterized by two-dimensional heterogeneity
(θ, ϕ) with preferences
                                                            (
                                                                U (c, y; θ ) if y > 0
                                  V (c, y; θ, ϕ) =
                                                                u(c; θ, ϕ) if y = 0.

Hence, heterogeneity in the ϕ-dimension only drives participation decisions but not inten-
sive margin decisions conditional on θ.14 In other words, preferences are the same as in
Section 5 for strictly positive y but can exhibit a discontinuity at y = 0 that can be different
across individuals with the same θ. Assuming that u is increasing in ϕ, this will lead indi-
viduals with high values of ϕ, for any given θ, to stay out of the labor market and choose
y = 0, consuming the demogrand q(0).
   We show in Appendix B that an application of the Diamond-Mirrlees formulas in this
case leads to the following simple modification of formula (8):

                                  ˆ       ∞
        T 0 (y) c                                               T 0 (ỹ)            T (ỹ) − T (0)
                                                                                                       
                  ε (y)yh(y) =                    1 − β̄ ỹ +              η (ỹ) −                ρ(ỹ) dH (ỹ),   (19)
      1 − T 0 (y)                     y                       1 − T 0 (ỹ)               q(ỹ)
  13 Using a perturbation approach, Saez (2001) derives this result for the asymptotic top marginal tax rate.
Hendren (2014) provides a formula for the fiscal externality from changes to the nonlinear income tax schedule
that depends on average elasticities at each income level, also based on a perturbation approach. Jacquet and
Lehmann (2015) consider the same structure of heterogeneity as here and obtain this result for the optimal tax
formula for the special case of additively separable preferences based on a mechanism design approach with
pooling.
  14 Such further heterogeneity could be easily incorporated as shown in the previous subsection. We focus on

the extensive margin here.




                                                                21
where ρ(y) is the participation elasticity at y, defined by

                                                   ∂h(y) q(y)
                                         ρ(y) =                            ,
                                                   ∂q(y) h(y)    {y(θ )}

which is the percentage change in the density at y when q(y) is increased by one percent,
holding fixed the intensive margin choices of all individuals with y > 0 (i.e. holding fixed
the y(θ )-schedule). Moreover, β̄ y is the average social welfare weight on individuals who
choose y.
    As in the lifecycle extensions, the (compensated) demand system is no longer diagonal
with an active extensive margin: The proportional change in all marginal tax rates underly-
ing the left-hand side of (5) affects 1 − H (y) not just through the (compensated) intensive-
margin response at y, but also through the (compensated) extensive-margin responses of all
individuals with labor supply above y. Combining this with the pure income effect on the
extensive margin from (6) leads to the additional term on the right-hand side of the optimal
tax formula.15
    A special case arises when only the extensive margin is active (see e.g. Diamond, 1980,
and Choné and Laroque, 2011), in which case (19) reduces to

                                           T ( y ) − T (0)   1 − β̄ y
                                                           =          ,
                                                 q(y)         ρ(y)

i.e., an inverse elasticity rule similar to the pure intensive margin model considered so far,
but in terms of the average tax rate and the participation elasticity.


7      Conclusion
This paper uncovered a deep connection between two canonical models in public finance
and their optimal tax formulas. We find this connection is insightful and, thus, worthwhile
in its own right. In addition, this line of attack on the nonlinear tax problem can easily allow
for weaker conditions and extensions. We have provided four such extensions to illustrate
the appeal of the Diamond-Mirrlees approach. We conjecture that this approach could be
usefully applied in other settings as well.
    15 Saez
         (2002b) derives the equivalent of this formula for a discrete type setting and for the special case with-
out income effects using a perturbation approach (the working paper version in Saez (2000) also provides a
continuous types analogue). Jacquet et al. (2013) consider preferences with an additively separable partici-
pation cost (so V (c, y; θ, ϕ) = U (c, y; θ ) − I(y > 0) ϕ). For this special case of our environment, they derive
the same formula as ours using perturbation and mechanism design approaches. Zoutman et al. (2013) and
Hendren (2014) provide related formulas for the fiscal externality in the inverse optimum problem with both
intensive and extensive margins.


                                                       22
References
Atkinson, A. and J. Stiglitz, “The Design of Tax Structure: Direct Versus Indirect Taxation,”
  Journal of Public Economics, 1976, 6, 55–75. 5.4

Bovenberg, L. and B. Jacobs, “Redistribution and Education Subsidies are Siamese Twins,”
  Journal of Public Economics, 2005, 89, 2005–2035. 11

Choné, P. and G. Laroque, “Optimal Taxation in the Extensive Model,” Journal of Economic
 Theory, 2011, 146, 425–453. 10, 6.4, 6.4

Christiansen, V., “Which Commodity Taxes Should Supplement the Income Tax,” Journal of
 Public Economics, 1984, 24, 195–220. 5.4

Diamond, P., “A Many-Person Ramsey Tax Rule,” Journal of Public Economics, 1975, 4, 335–
 342. 1, 4.1

  , “Income Taxation With Fixed Hours of Work,” Journal of Public Economics, 1980, 13, 101–
  110. 1, 10, 6.4, 6.4

  , “Optimal Income Taxation: An Example with a U-Shaped Pattern of Optimal Marginal
  Tax Rates,” American Economic Review, 1998, 88 (1), 83–95. 1, 4.2, 6

   and J. Mirrlees, “Optimal Taxation and Public Production II: Tax Rules,” American Eco-
  nomic Review, June 1971, 61 (3), 261–78. 1, 2, 2, 2.1, 5.4

Guesnerie, R., “Peut-on Toujours Redistribuer les Gains a la Spécialization et a l’Echange?
 Un Retour Pointille sur Ricardo et Heckscher-Ohlin,” Revue Economique, 1998, 49, 555–579.
 5.4

Hendren, N., “The Inequality Deflator: Interpersonal Comparisons Without a Social Welfare
 Function,” NBER Working Paper 20351, 2014. 10, 13, 15

Jacobs, B. and R. Boadway, “Optimal Linear Commodity Taxation Under Optimal Non-
  linear Income Taxation,” Journal of Public Economics, 2014, 117, 201–210. 5.4

Jacquet, L. and E. Lehmann, “Optimal Income Taxation when Skills and Behavioral Elastic-
  ities are Heterogeneous,” CESifo Working Paper 5265, 2015. 1, 10, 13

  , , and B. Van der Linden, “The Optimal Marginal Tax Rates with both Extensive and
  Intensive Responses,” Journal of Economic Theory, 2013, 148, 1770–1805. 1, 10, 6.4, 15

Mirrlees, J., “An Exploration in the Theory of Optimum Income Taxation,” Review of Eco-
 nomic Studies, 1971, 38, 175–208. 1, 2, 2.2, 5.4

                                             23
  , “Optimal Commodity Taxation in a Two-Class Economy,” Journal of Public Economics,
  1975, 4, 27–33. 1

  , “Optimal Tax Theory: A Synthesis,” Journal of Public Economics, 1976, 6, 327–358. 4.1, 5.4

Naito, H., “Re-Examination of Uniform Commodity Taxes Under a Non-linear Income Tax
 and its Implication for Production Efficiency,” Journal of Public Economics, 1999, 71 (165-
 188). 5.4, 9

Piketty, T., “La Redistribution Fiscale Face au Chômage,” Revue française d’économie, 1997,
  12, 157–201. 1

Rothschild, C. and F. Scheuer, “Redistributive Taxation in the Roy Model,” Quarterly Journal
 of Economics, 2013, 128, 623–668. 5.4

Saez, E., “Optimal Income Transfer Programs: Intensive versus Extensive Labor Supply
  Responses,” NBER Working Paper 7708, 2000. 15

  , “Using Elasticities to Derive Optimal Income Tax Rates,” Review of Economic Studies, 2001,
  68 (1), 205–29. 1, 4.2, 4.2, 5.3, 10, 13

  , “The Desirability of Commodity Taxation under Non-linear Income Taxation and Het-
  erogeneous Tastes,” Journal of Public Economics, 2002, 83, 217–230. 5.4

  , “Optimal Income Transfer Programs: Intensive versus Extensive Labor Supply Re-
  sponses,” The Quarterly Journal of Economics, 2002, 117 (3), 1039–1073. 1, 1, 10, 6.4, 15

  , “Direct Or Indirect Tax Instruments For Redistribution: Short-Run Versus Long-Run,”
  Journal of Public Economics, 2004, 88, 503–518. 9

Scheuer, F. and I. Werning, “The Taxation of Superstars,” NBER Working Paper 21323, 2015.
  8

Stantcheva, S., “Optimal Taxation and Human Capital Policies over the Life Cycle,” Mimeo,
  Harvard University, 2016. 11

Stiglitz, J., “Self-Selection and Pareto Efficient Taxation,” Journal of Public Economics, 1982,
  17, 213–240. 5.4, 9

Zoutman, F., B. Jacobs, and E. Jongen, “Revealed Social Preferences of Dutch Political Par-
  ties,” Working Paper, 2013. 10, 15




                                              24
A      Derivations

A.1        Derivation of Equation (12)
The the left-hand side of (5) with a continuum of goods equals
           ˆ    ∞                                                ˆ    ∞
       ∂                                                   ∂                                               ∂θ c (y; τ )
                    (1 −   Hθc (y; τ ))dF (θ )          =                         dF (θ )             =−                         f (θ (y))   (20)
      ∂τ    0                                    τ =0     ∂τ         θ c (y;τ )                                ∂τ         τ =0
                                                                                            τ =0

where the superscript c indicates compensated choices, θ (y; τ ) is the inverse of y(θ; τ ) with
respect to its first argument, and θ (y) stands short for θ (y; 0). We are using the fact that
y(θ; τ ) is increasing in θ for any τ by the single-crossing condition.
   The optimum for agent θ must satisfy the tangency condition

                                        MRS(c, y; θ ) = q0 (y; τ ) = q0 (y) + τt0 (y).                                                       (21)

To compute the compensated demand, we use this equation with c = e(v, y; θ ) where e is the
inverse of U with respect to its first argument. To compute the uncompensated demand, we
use the budget constraint c = q(y) + I. Differentiating (21) yields

                                    ∂θ c (y; τ )               q0 (y) − p0 (y)   t0 (y)/q0 (y)
                                                           =                   =               .                                             (22)
                                        ∂τ          τ =0            MRSθ         MRSθ /MRS

Moreover, observe that the density of y is given by h(y) = f (θ (y))θ 0 (y). Again differentiat-
ing (21) for τ = 0 yields
                                                  MRS     q00
                                          MRSc + MRSy − q0
                              θ 0 (y) = −                     .                            (23)
                                             MRSθ /MRS
Finally, the elasticities defined in (7) can be obtained by differentiating

                                          MRS(q(y) − ξy + I, y; θ ) = q0 (y) − ξ.

Hence,
                                                                  − MRSc + 1/y
                                                   εu (y) =                        MRSy         q00
                                                                                                      ,                                      (24)
                                                                MRSc +             MRS      −   q0

                                                                            MRSc
                                                   η (y) =                        MRSy          q00
                                                                                                      ,                                      (25)
                                                               MRSc +             MRS       −   q0

and
                                                                                            1/y
                                     εc (y) = εu (y) + η (y) =                                  MRSy          q00
                                                                                                                    .                        (26)
                                                                                  MRSc +        MRS       −   q0


                                                                        25
Using (26) in (23) yields

                                                                   1            1
                                     θ 0 (y) = −                                      .                                              (27)
                                                               yεc (y)      MRSθ /MRS
Substituting all this in (20), we obtain (12).


A.2      Derivation of Equation (17)
Define
                                                                  t0 (y) c
                                             µ(y) ≡ −                    ε (y)yh(y)
                                                                  q0 (y)
and write equation (15) as
                                     ˆ       ∞                                 ˆ       ∞
                                                                                           η (ỹ) µ(ỹ)
                         µ(y) =                  (1 − β ỹ )dH (ỹ) +                                   dỹ.
                                         y                                         y       εc (ỹ) ỹ

Differentiating this yields

                                                                                      η (y) µ(y)
                                µ 0 ( y ) + (1 − β y ) h ( y ) = −                               .
                                                                                      εc (y) y

Integrating this ordinary first-order differential equation forward to solve for µ and using
its definition yields (17).


A.3      Formulas in Terms of the Skill Distribution
Combine (20) and (22) and change variables from θ to y(θ ) to write the left-hand side of (5)
as
                       t0 (y(θ ))/q0 (y(θ ))            τ (θ )
                                             f (θ ) =            θ f ( θ ) χ ( θ ),
                           MRSθ /MRS                  1 − τ (θ )

where we defined τ (θ ) = T 0 ( p(y(θ ))) and χ(θ ) = − ( MRSθ θ/MRS)−1 . Using this together
with (14) yields
                                                 ˆ       ∞                                ˆ       ∞
                τ (θ )                                                                                  τ (θ̃ )
                         θ f (θ )χ(θ ) =                     (1 − β θ̃ )dF (θ̃ ) +                                η (θ̃ )dF (θ̃ ),   (28)
              1 − τ (θ )                             θ                                        θ       1 − τ (θ̃ )

where we slightly abused notation to write η (θ ) = η (y(θ )). This is the equivalent of (8)
written in terms of θ. Defining the left-hand side of equation (28) as µ̂(θ ), we can write it as
                                     ˆ       ∞                                ˆ       ∞
                                                                                            η (θ̃ )
                          µ̂(θ ) =               (1 − β θ̃ )dF (θ̃ ) +                              µ̂(θ̃ )dθ̃.
                                         θ                                        θ        θ̃χ(θ̃ )


                                                                       26
Observe that
                                               η (θ )   η (θ ) y0 (θ )
                                                      = c              ,
                                              θχ(θ )    ε (θ ) y(θ )
where we used (25), (26) and (27) (and, again slightly abusing notation, wrote εc (θ ) =
εc (y(θ ))). Using this and differentiating yields

                                                                         η (θ ) y0 (θ )
                             µ̂0 (θ ) + (1 − β θ ) f (θ ) = −                           µ̂(θ ).
                                                                         εc (θ ) y(θ )

Solving this forward yields
                                              ˆ       ∞                       ˆ                          !
             τ (θ )      1 1 − F (θ )                                                 θ̃
                                                                                           η (s) dy(s)         dF (θ̃ )
                      =                                   (1 − β θ̃ ) exp                                               ,   (29)
           1 − τ (θ )   χ(θ ) θ f (θ )            θ                               θ        εc (s) y(s)       1 − F (θ )

which is the equivalent of (9) written in terms of θ.


B     Extensions

B.1     Lifecycle Framework
Due to single-crossing in δ, y(δ; θ ) is increasing in δ, so
                                                          ˆ   ∞
                               1 − Hθ (y) =                       (1 − Hδ,θ (y))dP(δ|θ )
                                                          0

where
                                      1 − Hδ,θ (y) = I(y ≤ y(δ; θ )).

Hence, the left-hand side of (5) simply becomes
                                                    ˆ
             ∂                                   ∂
               (1 − H c (y; τ ))          =             (1 − Hθc (y; τ ))dF (θ )
            ∂τ                     τ =0         ∂τ Θ                              τ =0
                                                    ˆ ˆ ∞
                                                 ∂                    c
                                          =                 (1 − Hδ,θ   (y; τ ))dP(δ|θ )dF (θ )
                                                ∂τ Θ 0                                                             τ =0
                                                    ˆ ˆ ∞
                                                 ∂
                                          =                       dP(δ|θ )dF (θ )
                                                ∂τ Θ δc (y;θ,τ )
                                                                                     τ =0
                                                   ˆ
                                                                      ∂δc (y; θ, τ )
                                          =     −      p(δ(y; θ )|θ )                     dF (θ )                           (30)
                                                     Θ                     ∂τ        τ =0

where δ(y; θ ) is the inverse of y(δ; θ ) with respect to its first argument and p(δ|θ ) is the
density corresponding to P(δ|theta).


                                                                  27
   Individuals solve
                                                      ˆ   ∞                               
                           max U c(θ ),                        v(y(δ; θ ), δ)dP(δ|θ ); θ
                         c(θ ),y(δ;θ )                 0

subject to                                         ˆ   ∞
                                         c(θ ) =           q(y(δ; θ ))dP(δ|θ )
                                                   0
with first-order conditions

                                                       Uc = λ̃
                                UY vy (y(δ; θ ), δ) = −λ̃q0 (y(δ; θ )).

The Frisch labor supply as defined in the main text is thus y F (δ; λ, τ ) such that

                                            vy (y F , δ) = λq0 (y F ; τ )

where λ ≡ −λ̃/UY . Note that λ will in general depend on θ.
  We can write the compensated labor supply as yc (δ; θ, Ū, τ ) such that

                                    vy (yc , δ) = λc (θ, Ū, τ )q0 (yc ; τ ).

Dropping the argument Ū, this equivalently determines δc (y; θ, τ ) such that

                                         vy (y, δc ) = λc (θ, τ )q0 (y; τ ).

We are now able to compute

                                                       ∂λc 0                1 ∂λc
                        ∂δc (y; θ, τ )                 ∂τ q     + λc t0     λc ∂τ + t0 /q0
                                                   =                    =                  .
                             ∂τ            τ =0                vyδ             vyδ /vy

At τ = 0, we can also compute (for the change of variables from δ to y)

                    ∂δ(y; θ )    0            vyy − λc q00    vyy /vy − q00 /q0
                              ≡ δ (y; θ ) = −              =−                   .
                      ∂y                          vyδ              vyδ /vy

Finally, note that the Frisch elasticity is based on
                                                                      
                                         vy (y F , δ) = λ q0 (y F ) − ξ ,




                                                               28
so
                                        ∂y F          q0       λ      q0         1/y
                      ε F (y) = −                        =         00
                                                                         =                   .
                                        ∂ξ     ξ =0   y    vyy − λq y      vyy /vy − q00 /q0
(Observe that this does not depend on θ.) Using all this, we can write (30) as
                               ˆ                                1 ∂λc
                                                       0     + t0 /q0
                                                                λc ∂τ
                                     p(δ(y; θ )|θ )δ (y; θ )            dF (θ )
                           Θ                          vyy /vy − q00 /q0
                         ˆ
                                                         1 ∂λc
                                                                         
                                             0                      0   0
                       =      p(δ(y; θ )|θ )δ (y; θ )     c ∂τ
                                                                + t /q yε F (y)dF (θ )
                           Θ                            λ
                                        0          ˆ
                                                          1 ∂λc
                                                                          
                            F             t (y)
                       = yε (y)h(y) 0           +          c
                                                                dF (θ |y) .
                                          q (y)       Θ λ ∂τ

For the last step, we noted that λc (θ, τ ) depends on θ and we used the fact that

                                         p(δ(y; θ )|θ )δ0 (y; θ ) f (θ )
                                                                         = f ( θ | y ).                 (31)
                                                    h(y)

To see this, note that, given θ, by monotonicity of δ in y, we have H (y|θ ) = P(δ(y; θ )|θ ). Dif-
ferentiating this, we obtain the density of y conditional on θ: h(y|θ ) = p(δ(y; θ )|θ )δ0 (y; θ ).
Multiplying this by the marginal density f (θ ) for θ, we obtain the joint density h(y, θ ) =
p(δ(y; θ )|θ )δ0 (y; θ ) f (θ ). By Bayes’ Rule, this implies the conditional density f (θ |y) of θ con-
ditional on y given by (31).
    As for the right-hand side, we have
            ˆ ˆ   ∞                            ˆ ∞                            
                                            ∂        0
               (1 − Hδ,θ (y)) β θ − 1 −             t (z) (1 − Hδ,θ (z; I )) dz dP(δ|θ )dF (θ )
          Θ 0                               ∂I 0
         ˆ ˆ ∞                  ˆ y(δ;θ,I )         !
                              ∂
       =            βθ − 1 −                t0 (z)dz dP(δ|θ )dF (θ )
          Θ δ(y;θ )          ∂I  0
         ˆ ˆ ∞                                       
                             ∂y(δ; θ, I ) 0
       =            βθ − 1 −             t (y(δ; θ )) dP(δ|θ )dF (θ ).
          Θ δ(y;θ )              ∂I

Using ∂y(δ(y; θ ); θ, I )/∂I = −η (y, θ )/q0 (y), this becomes after changing variables in the
inner integral
                  ˆ ˆ      ∞
                                                      t0 (z)
                                                              
                                   β θ − 1 + η (z, θ ) 0            p(δ(z; θ )|θ )δ0 (z; θ )dzdF (θ )
                  Θ     y                             q (z)
                   ˆ    ∞ˆ                                             ˆ   ∞ˆ
                                                                                         t0 (z)
            = −                  (1 − β θ ) dF (θ |z)dH (z) +          η (z, θ )dF (θ |z) 0 dH (z)
                       y       Θ                                  y  Θ                   q (z)
                   ˆ       ∞                        ˆ ∞
                                                             t0 (z)
            = −                1 − β̄ z dH (z) +        η̄ (z) 0 dH (z),                                (32)
                       y                             y        q (z)


                                                               29
where η̄ (y) is the average income effect and β̄ y the average social welfare weight at y.


B.2     Human Capital
Individuals now solve
                                                         ˆ      ∞                                                
                           max              U c ( θ ),               v(y(δ; θ ), δ)dP(δ|θ, e(θ )); θ, e(θ )
                      c(θ ),y(δ;θ ),e(θ )                    0

subject to                                            ˆ      ∞
                                            c(θ ) =              q(y(δ; θ ))dP(δ|θ, e(θ ))
                                                         0
with first-order conditions

                                                                       Uc = λ̃
                                       UY vy (y(δ; θ ), δ) = −λ̃q0 (y(δ; θ ))
               ˆ    ∞                                           ˆ ∞
          UY          v(y(δ; θ ), δ)dPe (δ|θ, e(θ )) + Ue = −λ̃       q(y(δ; θ ))dPe (δ|θ, e(θ )).
                0                                                                      0

Defining the Frisch labor supply as above, holding fixed λ = −λ̃/UY = −Uc /UY , all the
analysis in Appendix B.1 goes through.


B.3     General Heterogeneity
As for the left-hand side of the Diamond-Mirrlees formula (5), consider the same variation
of the price schedule q0 (y) as in (10) and let Hθ,φ (y; τ ) = I(y ≥ y(θ; φ, τ )), where y(θ; φ, τ ) is
the income chosen by θ, φ when faced with q0 (y; τ ), given by the first-order condition

                                                  MRS(c, y; θ, φ) = q0 (y; τ )                                                      (33)

Then we can write the left-hand side of (5) as
            ˆ ˆ ∞                                                                          ˆ ˆ    ∞
         ∂                    c                                                        ∂
                      (1 − Hθ,φ  (y; τ ))dF (θ |φ)dP(φ)                             =                           dF (θ |φ)dP(φ)
        ∂τ Φ 0                                                               τ =0     ∂τ   Φ     θ c (y;φ,τ )
                                                                                                                                 τ =0
           ˆ
                                ∂θ c (y; φ, τ )
      = −      f (θ (y; φ)|φ)                        dP(φ)                                                                          (34)
             Φ                        ∂τ        τ =0




                                                                        30
where F (θ |φ) is the c.d.f. of θ conditional on φ and f (θ |φ) is the corresponding conditional
density. Differentiating (33) yields

                                ∂θ c (y; φ, τ )              t0 (y)   t0 (y)/q0 (y)
                                                         =          =               .
                                      ∂τ          τ =0       MRSθ     MRSθ /MRS
                                                                       ´
Observe that the income distribution is H (y) =                             Φ   F (θ (y; φ)|φ)dP(φ) and hence h(y) =
´                        0
  Φ f ( θ ( y; φ )| φ ) θ ( y; φ ) dP ( φ ). We compute

                                                    MRSy          q00 (y)
                                          MRSc +     MRS      −   q0 (y)               1        MRS
                         θ 0 (y; φ) = −                                     =−                       ,
                                                    MRSθ                           yεc (y, φ)   MRSθ
                                                    MRS

where we used the expression, analogous to (26), for the compensated elasticity

                                                                   1/y
                         εc (y, φ) =                                                                       .
                                                                        MRSy (y,θ (y;φ),φ)       q00 (y)
                                       MRSc (y, θ (y; φ), φ) +             MRS(y)
                                                                                             −   q0 (y)


Using this, (34) becomes
   ˆ                                                    ˆ
                         t0 (y) MRS              t0 (y)   f (θ (y; φ)|φ)θ 0 (y; φ) c
           f (θ (y; φ)|φ) 0         dP(φ) = yh(y) 0                               ε (y, φ)dP(φ)
       Φ                 q (y) MRSθ              q (y) Φ            h(y)
                                                 t0 (y)
                                          = yh(y) 0 ε̄c (y),                                  (35)
                                                 q (y)

where ε̄c (y) = E[εc (y, φ)|y] denotes the average compensated elasticity at y (and we again
used the fact that, by the same argument as in Appendix B.1, the weights on the right-hand
side of the first equation in (35) equal the density p(φ|y) of φ conditional on y ).
   As for the right-hand side of (5), we have
               ˆ ˆ   ∞                                ˆ ∞                          
                                                   ∂        0
                                                                                 
                    (1 − Hθ,φ (y)) β θ,φ − 1 −             t (z) 1 − Hθ,φ (z; I ) dz dF (θ |φ)dP(φ)
              Φ 0                                  ∂I 0
             ˆ ˆ ∞                     ˆ y(θ;φ,I )         !
                                     ∂
           =            β θ,φ − 1 −                t0 (z)dz dF (θ |φ)dP(φ)
              Φ θ (y;φ)             ∂I 0
             ˆ ˆ ∞                                           
                                    ∂y(θ; φ, I ) 0
           =            β θ,φ − 1 −             t (y(θ; φ)) dF (θ |φ)dP(φ).
              Φ θ (y;φ)                 ∂I

Again using ∂y(θ (y; φ); φ, I )/∂I = −η (y, φ)/q0 (y), this becomes after changing variables in




                                                             31
the inner integral
             ˆ ˆ   ∞
                                               t0 (z)
                                                       
                  β θ (z;φ),φ − 1 + η (z, φ) 0            f (θ (z; φ)|φ)θ 0 (z; φ)dzdP(φ)
           Φ y                                q   ( z )
            ˆ ∞ˆ                                              ˆ ∞ˆ
                                                                                       t0 (z)
        = −          1 − β θ (z;φ),φ dP(φ|z)dH (z) +                    η (z, φ)dP(φ|z) 0 dH (z)
             y  Φ                                                y    Φ                 q (z)
            ˆ ∞                       ˆ ∞             0
                                                   t (z)
        = −     1 − β̄ z dH (z) +          η̄ (z) 0 dH (z)                                       (36)
             y                         y            q (z)

where η̄ (y) is the average income effect and β̄ y the average social welfare weight at y. Equat-
ing (35) and (36) and following the same steps as in Appendix A delivers the results.


B.4    Extensive-Margin Choices
Denoting by y(θ ) the preferred labor supply of an individual of type θ among all y > 0, this
individual will choose y(θ ) instead of y = 0 if and only if

                                                       ϕ ≤ ϕθ (q)

where ϕθ (q) is such that

                              U (q(y(θ )), y(θ ); θ ) = u(q(0); θ, ϕθ (q)).

Let the distribution of ϕ conditional on θ be given by Γ( ϕ|θ ) and denote the corresponding
conditional density by γ( ϕ|θ ). Then a share Γ( ϕθ (q)|θ ) of all θ-types will supply y(θ ) and
the rest y = 0. Hence, we can write the left-hand side of (5) as
                                                ˆ    ∞
            ∂                               ∂
              (1 − H c (y; τ ))          =                       Γ( ϕcθ (q; τ )|θ )dF (θ )
           ∂τ                     τ =0     ∂τ       θ c (y;τ )
                                                                                                  τ =0
                                                                             ˆ    ∞
                                             ∂θ c (y; τ )                                                ∂ϕcθ (q; τ )
      = −Γ( ϕθ (y) (q)|θ (y)) f (θ (y))                                  +               γ( ϕθ (q)|θ )                         dF (θ ) (37)
                                                    ∂τ            τ =0           θ (y)                       ∂τ         τ =0

Note that the density of y is now h(y) = Γ( ϕθ (y) (q)|θ (y)) f (θ (y))θ 0 (y), so the first term is the
standard one derived in Appendix A. Integrating the variation defined in (10), we have

                                     q(y; τ ) = q(y) + τ (t(y) − t(0)),

so we can write
                              ∂ϕcθ (q; τ )                                                 ∂ϕcθ (q)
                                                      = (t(y(θ )) − t(0))                           .
                                  ∂τ         τ =0                                          ∂q(y)


                                                                 32
Using this, the second term in (37) becomes
               ˆ      ∞                                                                                       ˆ        ∞
                                                       ∂ϕc (q)                                                             t ( z ) − t (0) c
                         (t(y(θ )) − t(0))γ( ϕθ (q)|θ ) θ dF (θ ) =                                                                       ρ (z)dH (z)             (38)
                   θ (y)                               ∂q(y)                                                       y             q(z)

where ρc (y) is the compensated participation elasticity at y.
  The right-hand side of (5) becomes
      ˆ    ∞      ˆ   ϕθ (q)                                                             ˆ    ∞      ˆ   y(θ;I )
                                                              ∂
                               ( β θ,ϕ − 1)dΓ( ϕ|θ )dF (θ ) −                                                      t0 (z)dzΓ( ϕθ (q; I )|θ )dF (θ ).              (39)
          θ (y)       −∞                                      ∂I                             θ (y)   0

                                                           ´∞
The first term can be rewritten as                         θ (y) ( β̄ θ         − 1)Γ( ϕθ (q)|θ )dF (θ ) with

                                        ˆ   ϕθ (q)
                                                                            dΓ( ϕ|θ )
                                                                                         = E β θ,ϕ |θ, ϕ ≤ ϕθ (q)
                                                                                                                 
                               β̄ θ =                ( β θ,ϕ − 1)
                                            −∞                             Γ( ϕθ (q)|θ )

and hence, after changing variables, as
                                                                   ˆ       ∞
                                                                               ( β̄ z − 1)dH (z)
                                                                       y


(where we slightly abused notation to write β̄ y = β̄ θ (y) ).
   The second term in (39) equals
      ˆ   ∞                                                                          ˆ   ∞
               ∂y(θ; I ) 0                                                 ∂ϕθ (q; I )
  −                     t (y(θ ))Γ( ϕθ (q)|θ )dF (θ ) −                                dF (θ ).(t(y(θ )) − t(0))γ( ϕθ (q)|θ )
      θ (y)      ∂I                          θ (y)                            ∂I
                                                                                           (40)
The first term here is again standard and the same as in Section 5. The second term in (40)
can be combined with (38) to deliver the uncompensated extensive-margin response, i.e.
                                                           ˆ       ∞
                                                                       t ( z ) − t (0)
                                                       −                               ρ(z)dH (z).
                                                               y             q(z)

   Collecting all these results and equating the left- and right-hand side yields
                                    ˆ       ∞                                    ˆ       ∞                                      ˆ       ∞
      t0 (y)                                                                                 t0 (z)                                         t ( z ) − t (0)
−yh(y) 0 εc (y) =                               (1 − β̄ z )dH (z) −                                 η (z)dH (z) +                                           ρ(z)dH (z)
      q (y)                             y                                            y       q0 (z)                                 y             q(z)

and hence the condition in the main text.




                                                                                     33
