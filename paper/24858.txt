                             NBER WORKING PAPER SERIES




 FACTORS THAT FIT THE TIME SERIES AND CROSS-SECTION OF STOCK RETURNS

                                       Martin Lettau
                                       Markus Pelger

                                     Working Paper 24858
                             http://www.nber.org/papers/w24858


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                    July 2018




We thank Svetlana Bryzgalova, John Cochrane, Jianqing Fan, Kay Giesecke, Bob Hodrick, Per
Mykland, Serena Ng, Viktor Todorov, Dacheng Xiu and seminar participants at Columbia,
Chicago, Stanford, UC Berkeley, Zürich, Toronto, Boston University, Humboldt University,
Frankfurt, Ulm, Bonn and the conference participants at the NBER-NSF Time-Series Conference,
SoFiE, Western Mathematical Finance Conference and INFORMS. The views expressed herein
are those of the authors and do not necessarily reflect the views of the National Bureau of
Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2018 by Martin Lettau and Markus Pelger. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Factors that Fit the Time Series and Cross-Section of Stock Returns
Martin Lettau and Markus Pelger
NBER Working Paper No. 24858
July 2018
JEL No. C14,C38,C52,C58,G0,G12

                                         ABSTRACT

We propose a new method for estimating latent asset pricing factors that fit the time-series and
cross-section of expected returns. Our estimator generalizes Principal Component Analysis
(PCA) by including a penalty on the pricing error in expected returns. We show that our estimator
strongly dominates PCA and finds weak factors with high Sharpe-ratios that PCA cannot detect.
Studying a large number of characteristic sorted portfolios we find that five latent factors with
economic meaning explain well the cross-section and time-series of returns. We show that out-of-
sample the maximum Sharpe-ratio of our five factors is more than twice as large as with PCA
with significantly smaller pricing errors. Our factors are based on only a subset of the stock
characteristics implying that a significant amount of characteristic information is redundant.


Martin Lettau
Haas School of Business
University of California, Berkeley
545 Student Services Bldg. #1900
Berkeley, CA 94720-1900
and NBER
lettau@haas.berkeley.edu

Markus Pelger
312 Huang Engineering Center
Department of Management Science & Engineering
Stanford University
Stanford, CA 94305
mpelger@stanford.edu
1. Introduction

      The fundamental insight of asset pricing theory is that the cross-section of expected re-
turns should be explained by exposure to systematic risk factors. Finding the “right” factors
has become the central question of asset pricing. Harvey et al. (2016) document that more
than 300 published candidate factors have predictive power for the cross-section of expected
returns. As argued by Cochrane (2011), this “factor zoo” leads to the questions of which risk
factors are really important and which factors are subsumed by others.
      This paper develops a new statistical method to ﬁnd the most important factors for ex-
plaining asset returns and to bring order into the chaos of factors. Our methodology uses
large ﬁnancial data sets to identify factors that simultaneously explain the time series and
cross-section of stock returns. The estimation approach is a generalization of the widely uti-
lized Principal Component Analysis (PCA), e.g. in Connor and Korajczyk (1986, 1988). Sta-
tistical factor analysis based on PCA has problems identifying factors with a small variance
that are important for capturing the cross-section of returns. Our estimator, Risk-Premium
PCA (RP-PCA), can be interpreted as generalized PCA with a penalty term to account for
cross-sectional pricing errors, thus combining PCA factor analysis with the Arbitrage Pricing
Theory (APT) of Ross (1976).
      The RP-PCA method considers three key elements concurrently: First, we ﬁnd statistical
factors instead of selecting from a set of pre-speciﬁed and potentially miss-speciﬁed fac-
tors. Second, we use information from large panel data sets; i.e. a large number of time
observations for many ﬁnancial assets. Using the information provided by a large number
of anomaly-sorted portfolios allows identiﬁcation of all relevant factors, but the “curse of
dimensionality” also makes the statistical estimation signiﬁcantly more challenging. Third,
RP-PCA identiﬁes factors with high Sharpe-ratios that ﬁt the cross-section of expected re-
turns and not only co-movement in the time series dimension: This is important as low
Sharpe-ratio factors that can only explain time-series comovements, for example industry
factors, do not seem to be important for the cross-section of expected returns and hence do
not capture the risk-return trade-oﬀ.1
      This paper focuses on the empirical estimation using RP-PCA while the econometric
asymptotic theory for the estimator is developed in Lettau and Pelger (2018a). That pa-
per shows that RP-PCA dominates conventional estimation based on PCA along a number
of dimensions, especially when factors are “weak”. We deﬁne “weak” factors as factors that
aﬀect only a subset of the underlying assets. Weak factors are harder to detect than “strong”
factors that aﬀect all assets (such as the “market” factor). Many anomaly-based factors are

  1
   Bryzgalova (2016) shows that time- and cross-sectional information need to be considered together to avoid
spurious factors.


                                                     1
more likely to be “weak” factors and RP-PCA can ﬁnd weak factors with high Sharpe-ratios,
which cannot be detected with PCA, even if an inﬁnite amount of data is available.
   Our estimator is grounded in economic theory. The objective of ﬁnding factors that can
explain co-movement and the cross-section of expected returns simultaneously is based on
the fundamental insight of of Ross’ APT. This contrasts our estimator with other regularized
estimation approaches that use ad-hoc penalty functions unrelated to the economic problem.
We show theoretically and empirically that including the additional information of arbitrage
pricing theory in the estimation of factors leads to factors that have better out-of-sample
pricing performance.
   Our empirical analysis is based on three data sets. First, we analyze factors from monthly
returns of double-sorted portfolios for a sample of monthly returns from July 1963 to Decem-
ber 2017. Second, we study the monthly returns of 370 decile portfolios based on single-sorts
on 37 characteristics. Lastly, we study the factor structure in individual stock returns. Our
empirical ﬁndings are sixfold. First, PCA is not a reliable method to estimate latent asset pric-
ing factors and is strongly dominated by RP-PCA. We show that even for the double-sorted
portfolios that follow a clear factor structure, PCA can fail to detect the underlying factor
structure, while RP-PCA reliably ﬁnds all asset-pricing factors. Second, we show that a small
number of ﬁve latent factors can explain the covariance and expected return structure of the
370 anomaly portfolios. In contrast a large number of ad-hoc long-short factors is needed
to achieve similar pricing properties. Third, we demonstrate that using the information in
the mean of the data in the estimation is essential for discovering factors that can explain
the risk-premium of assets. The maximum Sharpe-ratio of ﬁve RP-PCA factors is more than
twice as large as the Sharpe-ratio of ﬁve PCA factors; a result that holds in- and out-of-sample.
The cross-sectional pricing errors out-of-sample are sizable smaller for RP-PCA than for PCA
factors. We conclude that the RP-PCA methodology captures the pricing information better
while explaining the same amount of variation and co-movement in the data compared with
standard PCA. Fourth, we demonstrate that the better pricing performance results are due
to the detection of weak factors with high Sharpe-ratios that are not found by PCA. Fifth,
RP-PCA factors are based on only a subset of the stock characteristics implying that a signif-
icant amount of characteristic information is redundant. The RP-PCA pricing factors can be
interpreted as a market factor, value/value-interaction, momentum/momentum-interaction,
proﬁtability and a “high SR” factor that loads heavily on reversal. We also show that most of
the pricing information is contained in the extreme deciles. Sixth, we verify that linear factor
models estimated on portfolio data are stable over time, while this is not the case for esti-
mations using individual stock return data. This suggests that factor models with constant
factor weights are inappropriate for estimating factor models for individual stocks.
   Our paper contributes to an emerging literature that uses new econometric techniques in


                                               2
asset pricing for high-dimensional data, including machine learning methods. Kozak et al.
(2017) also exploit economic restrictions relating expected returns to the covariance to ex-
tract the factors spanning the stochastic discount factor. Their estimator is based on an
elastic net that shrinks the contributions of low-variance principal components of candidate
factors. This is in contrast to the RP-PCA estimator that also penalizes large pricing errors
but can actually strengthen low-variance principal components. It is important to under-
stand that in our main study our estimator is applied to a large number of sorted portfolios
and not individual stocks. A collection of portfolio sorts is in general not representing the
covariance structure of the individual stocks. Hence, a factor that has a high Sharpe-ratio
and is necessary to span the stochastic discount factor might only explain a small amount
of the variation in a particular choice of sorted portfolios and hence leads to a low-variance
principal component. Our approach is able to ﬁnd this factor and hence is in this sense ro-
bust to the choice of basis assets. Kelly et al. (2017) introduce Instrumented-PCA to perform
dimensionality reduction of the characteristic space. Their work is closely related to the
Projected-PCA of Fan et al. (2016) that allows for time-varying factor loadings. Both methods
ﬁrst project the individual stock returns into managed portfolios based on observed char-
acteristics and then apply PCA to the projected data. These approaches could be combined
with our methodology by applying RP-PCA in the second step to identify the factors that can
best “price” the managed portfolios. Kelly et al. (2017) and Kozak et al. (2017) argue that the
SDF based on the dominant principal components can explain the cross-section of expected
returns well. DeMiguel et al. (2017), Freyberger et al. (2017) and Feng et al. (2017) employ
factor selection with Lasso-style 𝐿1 -norm penalties. These papers have in common that they
assume that the stochastic discount factor has a sparse exposure to the characteristics. In
contrast, we only assume a low-dimensional factor structure without imposing any sparsity
constraints on how the characteristics can aﬀect the factors and hence the stochastic dis-
count factor. RP-PCA estimation can also be combined with other PCA-based methods, e.g.
the 3-pass model in Giglio and Xiu (2017).
   The rest of the paper is organized as follows. In Section 2 we introduce the model and
provide an intuition for our estimators. The simulations in Section 3 verify the theoretical
results. The empirical results are collected in Section 4. Section 5 concludes. The appendix
contains all the tables and ﬁgures.


2. Methodology

2.1. A Factor Model
   We assume that excess returns follow a standard approximate factor model and the as-
sumptions of the arbitrage pricing theory are satisﬁed. This means that returns of an asset


                                              3
𝑛, 𝑋𝑛𝑡 , have a systematic component captured by 𝐾 factors and a nonsystematic, idiosyn-
cratic component capturing asset-speciﬁc risk. The approximate factor structure allows the
non-systematic risk to be weakly dependent. We observe the excess return of 𝑁 assets over
𝑇 time periods:

                          𝑋𝑛𝑡 = F𝑡 Λ ⊤
                                     𝑛 + 𝑒𝑛𝑡       𝑛 = 1, ..., 𝑁 𝑡 = 1, ..., 𝑇              (1)

                     ⟺ ⏟
                       X = ⏟ Λ⊤ + ⏟
                           F ⏟    e                                                         (2)
                          𝑇×𝑁     𝑇×𝐾 𝐾×𝑁   𝑇×𝑁


   Our goal is to estimate the unknown latent factors F and loadings Λ . We will work in a
large dimensional panel, i.e. the number of cross-sectional observations 𝑁 and the number
of time-series observations 𝑇 are both large and we study the asymptotics as they jointly go
to inﬁnity.
   Under the assumption that the factors and residuals are uncorrelated, the covariance
matrix of the returns consists of a systematic and idiosyncratic part:

                                Var(X) = Λ Var(F) Λ ⊤ + Var(e).

Since the largest eigenvalues of Var(X) are driven by the factors, Principal Component Anal-
ysis (PCA) can be used to estimate the loadings and factors. PCA estimators of latent factors
only utilize the information contained in the second moment but ignore information that is
contained in the ﬁrst moment.
   Factor models, e.g. Connor and Korajczyk (1988, 1993), Bai (2003), Bai and Ng (2002) and
Stock and Watson (2002), typically assume that the mean of the data matrix X is equal to zero.
As we will see below, this assumption is restrictive if the means contain information about
the factor structure, as is the case in applications of ﬁnancial data. The RP-PCA estimator
exploits this information, so it is crucial to allow the means to be unrestricted.
   In the case of asset return data, the role of means is explicitly given by Ross’ Arbitrage-
Pricing Theory (APT), which implies that expected excess returns are explained by the ex-
posure to the risk factors multiplied by the risk-premium of the factors. If the factors are
excess returns, the APT implies

                                       E[X𝑛 ] = Λ 𝑛 E[F].

We assume a strong form of APT, where residual risk has a risk-premium of zero. In its more
general form APT requires only the risk-premium of the idiosyncratic part of well-diversiﬁed
portfolios to go to zero. As most of our analysis will be based on portfolios, there is no loss
of generality by assuming the strong form.
   Factors identiﬁed by standard PCA explain as much time-variation as possible. Conven-


                                               4
                                                                               1
tional statistical factor analysis applies PCA to the sample covariance matrix 𝑇 X⊤ X − X̄ X̄ ⊤
where X̄ denotes the sample mean of excess returns. The eigenvectors of the largest eigen-
values are proportional to the loadings Λ̂ PCA and factors are obtained from a regression on
the estimated loadings. It can be shown that conventional PCA factor estimates are based
                                                                            2
on the objective function (Stock and Watson (2002)):

                                                            𝑁    𝑇
                                                   1                       ⊤ 2
                                      min                  ∑ ∑ (𝑋𝑛𝑡 − F𝑡 Λ 𝑛 ) .                               (3)
                                       Λ ,F    𝑁𝑇          𝑛=1 𝑡=1


      Our Risk-Premium-PCA (RP-PCA) estimator modiﬁes the objective function so that cross-
sectional pricing errors are taken into account. The RP-PCA objective function minimizes
jointly the unexplained variation and cross-sectional pricing errors:

                                     𝑁    𝑇                                     𝑁
                                1                                ⊤    1                        ⊤ 2
                      min            ∑ ∑ (𝑋𝑛𝑡 − F𝑡 Λ 𝑛 )2 + 𝛾             ∑ (X̄ 𝑛 − F̄ Λ 𝑛 ) ,                 (4)
                       Λ ,F   𝑁𝑇 𝑛=1 𝑡=1
                              ⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟ 𝑁 𝑛=1
                                                                      ⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
                                    unexplained TS variation                    XS pricing error


where 𝛾 is the weight of the average cross-sectional pricing error relative to the times-series
error in standard PCA. It is straightforward to show that minimizing (4) is equivalent to
applying PCA to the matrix

                                                       1
                                                           X⊤ X + 𝛾 X̄ X̄ ⊤ .                                  (5)
                                                       𝑇
Note that (5) is equal to the variance-covariance matrix of X if 𝛾 = −1. Thus RP-PCA with
𝛾 > −1 can be understood as PCA applied to a matrix that “over-weights” the means. As
in standard PCA, the eigenvectors of the largest eigenvalues of (5) are proportional to the
loadings Λ̂ RP . RP-PCA factors are estimated by a regression of the returns on the estimated
                                ⊤             −1
loadings, i.e. F̂ = X Λ̂ RP (Λ̂ RP Λ̂ RP )         .
      There are four diﬀerent interpretations of RP-PCA:

  (a) Variation and pricing objective functions: As outlined above the RP-PCA estimator com-
        bines the time-series variation and cross-sectional pricing error criteria function. As
        such it only selects factors that are priced and hence have small cross-sectional alpha’s.
        But at the same time it protects against spurious factors that have vanishing loadings
        as it requires the factors to explain a large amount of the variation in the data as well.3

  2
     Stock and Watson (2002) assume that the data matrix X has a mean of zero. In this case PCA on the
covariance matrix of X is equivalent to minimizing (3). In our model, we do not restrict the mean of X and the
equations below reﬂect this more general case.
   3
     A natural question to ask is why do we not just use the cross-sectional objective function for estimating
latent factors, if we are mainly interested in pricing? First, the cross-sectional pricing objective function alone
does not identify a set of factors. For example it is a rank 1 matrix and it would not make sense to apply PCA to

                                                                 5
  (b) Penalized PCA: RP-PCA is a generalization of PCA regularized by a pricing error penalty
      term. Factors that minimize the variation criterion need to explain a large part of
      the variance in the data. Factors that minimize the cross-sectional pricing criterion
      need to have a non-vanishing risk-premia. Our joint criteria is essentially looking for
      the factors that explain the time-series but penalizes factors with a low Sharpe-ratio.
      Hence the resulting factors usually have much higher Sharpe-ratios than those based
      on conventional factor analysis.

  (c) Information interpretation: Conventional PCA of a covariance matrix only uses informa-
      tion contained in the second moment but ignores all information in the ﬁrst moment.
      As using all available information in general leads to more eﬃcient estimates, there is
      an argument for including the ﬁrst moment in the objective function. Our estimator
      can be seen as combining two moment conditions eﬃciently.
                                               1 ⊤
  (d) Signal-strengthening: The matrix         𝑇
                                                 X X   + 𝛾X̄ X̄ ⊤ should converge to4

                                        Σ𝐹 + (1 + 𝛾) 𝜇 𝐹𝜇 ⊤
                                     Λ (Σ                      ⊤
                                                          𝐹 ) Λ + Var(e),


      where Σ 𝐹 = Var(F) denotes the covariance matrix of F and 𝜇 𝐹 = E[F] the mean of the
      factors. After normalizing the loadings, the strengths of the factors in the standard
      PCA of a covariance matrix are equal to their variances. Larger factor variances will
      result in larger systematic eigenvalues and a more precise estimation of the factors. In
      our RP-PCA the signal of weak factors with a small variance can be “pushed up” by their
      mean if 𝛾 is chosen accordingly. In this sense our estimator strengthens the signal of
      the systematic part.

    Lettau and Pelger (2018a) develop a formal statistical theory that provides guidance on
the optimal choice of the key parameter 𝛾. The intuition is as follows. There are essentially
two diﬀerent factor model interpretations: a strong factor model and a weak factor model.
In a strong factor model the factors provide a strong signal and lead to exploding eigenvalues
in the covariance matrix. This is either because the strong factors aﬀect a large number of
assets and/or because they have large variances themselves. In a weak factor model the
factors’ signal is weak and the resulting eigenvalues are large compared to the idiosyncratic
spectrum, but they do not explode. Weak factors only aﬀect a small subset of assets or aﬀect
                                                                       5
all assets only weakly. This intuition is formalized below.


it. Second, there is the problem of spurious factor detection (see e.g. Bryzgalova (2016)). Factors can perform
well in a cross-sectional regression because their loadings are close to zero. Thus “good” asset pricing factors
need to have small cross-sectional pricing errors and explain the variation in the data.
    4
      In this large-dimensional context the limit is more complicated and studied in Lettau and Pelger (2018a).
    5
      The Arbitrage-Pricing Theory developed by Chamberlain and Rothschild (1983) assumes that only strong


                                                       6
    In a strong factor model, PCA and RP-PCA yield consistent estimates of factors and load-
ings but RP-PCA estimates are more eﬃcient. In a weak factor model RP-PCA strengthens the
signal of the weak factors, which could otherwise not be detected and usually dominates PCA
estimates. Depending on which framework is appropriate, the optimal choice of 𝛾 varies. A
weak factor model usually suggests much larger choices for the optimal 𝛾 than a strong fac-
tor model. However, in strong factor models our estimator is consistent for any choice of
𝛾 and choosing a 𝛾 that is “too large” results in only minor eﬃciency losses. On the other
hand, a 𝛾 tat is “too small” can prevent weak factors from being detected at all. Thus in our
empirical analysis we opt for the choice of larger 𝛾’s.
    The empirical spectrum of eigenvalues in equity data suggests a combination of strong
and weak factors. In all equity data sets that we have considered, the ﬁrst eigenvalue of the
sample covariance matrix was large, typically around ten times the size of the rest of the
spectrum. The second and third eigenvalues usually stand out, but have only magnitudes
around twice or three times of the average of the residual spectrum, which would be more
in line with a weak factor interpretation. The ﬁrst statistical factor in our data sets is always
very strongly correlated with an equally-weighted market factor. Hence, if we are interested
in learning more about factors besides the market, the weak factor model is likely to be
appropriate.
    In this paper we consider a simpliﬁed factor model with the purpose to make the weak
and strong factor models comparable. The assumptions of the strong factor models can be
relaxed considerably without aﬀecting the results, as shown in Lettau and Pelger (2018a).

Assumption 1: Factor Model

  The factor model (2) holds with the following assumptions:

    (a) Convergence rates: 𝑇, 𝑁 ⟶ ∞, 𝑁/𝑇 ⟶ 𝑐 with 0 < 𝑐 < ∞.

    (b) Factors: The factors F are uncorrelated, are independent of e and Λ and have bounded
         ﬁrst two moments:

                                    𝑇                                      𝜎12 ⋯ 0
                                1                           1             ⎛          ⎞
                                                     Σ̂ 𝐹 = F𝑡 F𝑡⊤ ⟶ Σ𝐹 = ⎜          ⎟
                                         𝑝                         𝑝
                       𝜇̂ 𝐹 =       ∑ F𝑡 ⟶ 𝜇 𝐹                            ⎜
                                                                          ⎜ ⋮  ⋱ ⋮   ⎟
                                                                                     ⎟
                                𝑇 𝑡=1                      𝑇                       2
                                                                          ⎝ 0  ⋯ 𝜎𝐾⎠


     (c) Loadings: The loadings Λ are independent of the factors and residuals.


factors are non-diversiﬁable and explain the cross-section of expected returns. As pointed out by Onatski
(2012) a weak factors can be regarded as a ﬁnite sample approximation for strong factors, i.e. the eigenvalues
of factors that are theoretically strong grow so slowly with the sample size that the weak factor model provides
a more appropriate description of the data.


                                                       7
    (d) Residuals: The matrix of residuals can be represented as e = 𝜖 Σ 𝑒 with 𝜖𝑡,𝑖 ∼𝑖.𝑖.𝑑. 𝑁(0, 1).


   Assumption 1 (a) imposes that time and cross-sectional dimensions grow at the same
proportional rate 𝑐. Assumption 1 (b) is relatively weak and the main constraint is the inde-
pendence of the factors of the loadings and residuals. The assumption that the factors are
uncorrelated is a normalization and without loss of generality. Assumptions (c) and (d) will
be further speciﬁed for the strong and weak factor models. Both models require a form of
weak dependence of the residuals but diﬀer in the strength of the loadings.
                                             Λ⊤ is identiﬁed. For any full rank 𝐾 × 𝐾 matrix
   In latent factor models only the product FΛ
H the factors FH−1 and loadings Λ H⊤ yield the same factor model. We use the standard
convention to normalize the loadings Λ ⊤Λ /𝑁 = I𝐾 and assume that the factors are uncorre-
lated. That means that a factor with a variance of 𝜎𝐹2 = 0.5 could be interpreted as aﬀecting
only half of the assets with an average loadings of 1. Alternatively, we could normalize the
covariance matrix of the factors to an identity matrix, so that the norm of the loading vectors
measure the strength of the factors.

2.2. Strong Factor Model
   Traditional factor models as in Connor and Korajczyk (1988, 1993), Bai (2003), Bai and Ng
(2002) and Stock and Watson (2002) are based on the assumption that factors are “strong” in
the following sense. The “strengths” of systematic factors are given by their corresponding
eigenvalues of the matrix Λ ⊤Λ . The eigenvalues of strong factors diverge to inﬁnity (while in
the weak factor models considered below the eigenvalues are bounded). This is captured by
                      1 ⊤
the assumption that   𝑁
                        Λ Λ   → ΣΛ where ΣΛ is a full-rank matrix. Without loss of generality
                                                                                     1 ⊤
we will use the normalization ΣΛ = I𝐾 . The interpretation of the assumption         𝑁
                                                                                       Λ Λ   → I𝐾
is that strong factors aﬀect an inﬁnite number of assets with non-vanishing loadings. One
example of this factor structure is Λ𝑛𝑘 = 𝑁(1, 1/√𝑁) ∀𝑛, 𝑘, i.e. the loading of each asset
on each factor converge to 1 as 𝑁 grows. The results below show that in a strong factor
model RP-PCA and PCA provide consistent estimators for the loadings and factors but the
RP-PCA estimator of the loadings is more eﬃcient than the PCA estimator. Furthermore,
the assumptions required for the strong factor model are weaker than those imposed in the
weak factor model below.

Assumption 2: Simpliﬁed Strong Factor Model

  Assume Assumption 1 holds and in addition:
                              𝑝
    (a) Loadings: Λ ⊤Λ /𝑁 ⟶ I𝐾 and all loadings are bounded.

    (b) Residuals: All elements and all row sums of Σ 𝑒 are bounded.


                                                8
   The following result is proven in Lettau and Pelger (2018a):

Proposition 1: Simpliﬁed Strong Factor Model

  Suppose that Assumption 2 holds. The RP-PCA estimator that minimizes the objective func-
  tion (4) has the following properties:

    (a) The factors and loadings estimators are consistent.

    (b) The asymptotic distribution of the factor estimates is independent of 𝛾.

    (c) The asymptotic distribution of the estimates of the loadings of factor 𝑘 is given by

                                     √𝑇 (H⊤Λ̂ 𝑘 − Λ 𝑘 ) ⟶ 𝑁(0, Ω 𝑘 ).

          Closed-form expressions of Ω 𝑘 and the rotation matrix H are given in Lettau and Pelger
          (2018a).

    (d) The optimal 𝛾 that minimizes the asymptotic variance is 𝛾 = 0. Choosing 𝛾 = −1, i.e.
          PCA with covariance matrix for factor estimation, is not eﬃcient.

Simulations results in section 3 and Lettau and Pelger (2018a) show that eﬃciency gains of
choosing 𝛾 = 0 are relatively minor. We conclude that strong factors are relatively easy to
estimate by PCA-based methods. We now turn to the more interesting case when factors
“weak”.

2.3. Weak Factor Model
   In contrast to strong factors, weak factors aﬀect only a smaller fraction of the assets (or
have a small variance). Formally, in a weak factor model, the matrix Λ ⊤Λ is bounded and
                                                                        1 ⊤
converges to a ﬁxed limit, in contrast to a strong factor model where   𝑁
                                                                          Λ Λ   converges. With-
                                                           𝑝
out loss of generality, we use the normalization Λ ⊤Λ ⟶ I𝐾 . Lettau and Pelger (2018a) give
a general characterization of weak factors. In this paper, we focus on an easily interpretable
class of weak factors of the form Λ𝑛𝑘 = 𝑁(0, 1/√𝑚) with probability 𝑚/𝑁, Λ𝑛𝑘 = 0 with
probability 1 − 𝑚/𝑁. For 𝑚 = 𝑁, the factor 𝑘 aﬀect all assets but the loadings converge to
zero. If 𝑚 is small, fewer assets are aﬀected by the factors (in expectation) but with larger
weights. A weak factor can thus either be interpreted as a factor with only a weak eﬀect on
many assets or a factor with strong eﬀects on a few assets. Moreover for 𝑚 > 1, factors of
this form have the interpretation of long-short portfolios since the mean of all Λ𝑛𝑘 is zero,
so that in expectation half the loadings are positive and half are negative.
   The statistical model for analyzing weak factor models is considerably more complicated
than that of the strong factor model and is based on spiked covariance models from random


                                                9
                                                                    6
matrix theory (see Lettau and Pelger (2018a) for details).              The distinction of strong and weak
factors matters in practice since the estimation of weak factors is more diﬃcult than the
estimation of strong factors. Recall that strong factors and their loadings can be estimated
consistently. In contrast, PCA-based estimators of weak factors are generally biased, even in
the limit as 𝑇 and 𝑁 grow. For example, the correlation of an estimated weak factor with the
“true” weak factor typically converges to a number less than one (see Proposition 2 below).
Lettau and Pelger (2018a) derive a set of results that show that RP-PCA dominates standard
PCA in a number of dimension. The optimal choice of 𝛾 is generally larger than −1 and in
most cases larger than 0. We present some simulation evidence in section 3 and refer to
Lettau and Pelger (2018a) for more results. The bias reduction of choosing 𝛾 > −1 is often
substantial.
      Moreover, in the weak factor model RP-PCA can detect factors which are missed by con-
ventional PCA. If a weak factor aﬀects “too few” assets, if the loadings are “too small” or if
the variance of the factor is “too low”, it cannot be detected by PCA. However, the signal of
RP-PCA depends on the mean and the variance of the factors. Thus, RP-PCA can detect weak
factors with a high Sharpe-ratio even if the factor is below the critical detection value for
PCA. The results in Lettau and Pelger (2018a) are summarized in the following proposition.

Assumption 3: Weak Factor Model

  Assume Assumption 1 holds and in addition:
                               𝑝
      (a) Loadings: Λ ⊤Λ ⟶ I𝐾 and the column vectors of the loadings Λ are orthogonally
          invariant, e.g. Λ1𝑘 = 𝑁(0, 1/√𝑚) with prob. 𝑚/𝑁, Λ𝑛𝑘 = 0 with prob. 1 − 𝑚/𝑁.7

      (b) Residuals: The empirical eigenvalue distribution function of Σ 𝑒 converges almost
          surely weakly to a non-random spectral distribution function with compact support.
          The supremum of the support is 𝑏 and the largest eigenvalues of Σ 𝑒 converge to 𝑏.

  6
     The intuition is as follows. Under the assumptions of random matrix theory the eigenvalues of a sample
covariance matrix separate into two areas: (1) the bulk spectrum with the majority of the eigenvalues that are
clustered together and (2) some spiked large eigenvalues separated from the bulk. Under appropriate assump-
tions the bulk spectrum converges to the generalized Marchenko-Pastur distribution. The largest eigenvalues
are estimated with a bias which is characterized by the Stieltjes transform of the generalized Marchenko-Pastur
distribution. If the largest population eigenvalues are below some critical threshold, a phase transition phe-
nomena occurs. The estimated eigenvalues will vanish in the bulk spectrum and the corresponding estimated
eigenvectors will be orthogonal to the population eigenvectors. Onatski (2012) studies weak factor models and
shows the phase transition phenomena for weak factors estimated with PCA. Our paper provides a solution
to this factor detection problem. It is important to notice that essentially all models in random matrix theory
work with processes with mean zero. However, this assumption is not appropriate for factor models of asset
returns. Lettau and Pelger (2018a) develop new methods when this assumption is relaxed.
   7
     The normality assumption is not essential and can be relaxed to allow for wider class of distributions (e.g.
all spherical distributions).




                                                      10
As mentioned above, factors of the form considered in Assumption 3 (a) have the interpre-
tation of long-short portfolios that either aﬀect many assets weakly, or few assets more
strongly. Assumption 3 (b) is a standard assumption in random matrix theory. The assump-
tion allows for non-trivial weak cross-sectional correlation in the residuals, but excludes
serial-correlation.
   The following proposition conveys the intuition of the results that are formally stated
and proven in Lettau and Pelger (2018a).

Proposition 2: Risk-Premium PCA under weak factor model

     Suppose that Assumption 3 holds.
     Let 𝜃1 , … , 𝜃𝐾 be the ﬁrst 𝐾 largest eigenvalues of an appropriately deﬁned “signal ma-
  trix” given in Lettau and Pelger (2018a). The eigenvalues 𝜃𝑘 = 𝜃𝑘 (𝛾) are strictly increasing
  functions of 𝛾 and have the interpretation of “signal strengths” of individual factors 𝑘.
     Let 𝐹𝑘̂ denote the RP-PCA estimator of factor 𝐹𝑘 . Then the correlation of 𝐹𝑘̂ with the true
  factor 𝐹𝑘 converges to

                                             ⎧
                                             ⎪𝜏𝑘 (𝛾) > 0   if 𝜃𝑘 (𝛾) > 𝜃crit
                                           𝑝
                                  ̂
                           Corr (𝐹𝑘 , 𝐹𝑘 ) ⟶ ⎨
                                             ⎪0            otherwise.
                                             ⎩

  𝜃crit is a threshold that does not depend on 𝛾 or the factors but only on the noise distribution.

     𝜏𝑘 (𝛾) has the following properties:

    (a) For generic cases 𝜏𝑘 (𝛾) < 1.

    (b) Typically, 𝜏𝑘 (𝛾) has a unique ﬁnite maximum 𝛾∗ = argmax 𝜏𝑘 (𝛾) that yields the
        highest correlation of the estimated factor with the true factor.

    (c) If 𝜇 𝐹 ≠ 0, then 𝛾∗ > −1 and RP-PCA yields factor estimates that are more highly
        correlated with the true factors than PCA with 𝛾 = −1. If 𝜇 𝐹 = 0 then 𝛾∗ = −1.

   Proposition 2 states that weak factors can only be estimated with a bias even as 𝑁 and 𝐾
grow. If a factor is too weak, i.e. its signal strength 𝜃𝑘 (𝛾) is below the threshold 𝜃crit , then
it cannot be detected at all. Since 𝜃𝑘 (𝛾) is increasing in 𝛾, RP-PCA is more likely to detect
factors with lower signal strength than PCA with 𝛾 = −1.
   𝛾 also aﬀects the correlations of estimated factors with true factors. Typically, there is a
ﬁnite 𝛾 that maximizes the correlation of detected factors with true factors. In particular, RP-
PCA with 𝛾 > −1 yields estimated factors that are more highly correlated with true factors




                                                11
than PCA with 𝛾 = −1.8 The factor means 𝜇 𝐹 play a crucial role for this result. If the factors
have means of zero, PCA with 𝛾 = −1 is optimal. If 𝜇 𝐹 ≠ 0, then RP-PCA with 𝛾 > −1 is
optimal. If 𝜇 𝐹 = 0, as in traditional factor models, then PCA with 𝛾 = −1 is optimal.This
distinction is important since asset pricing factors have non-zero means.
      Figure 1 plots the function 𝜏𝑘 (𝛾) for parameters used in the simulation exercise described
below.9 The variance of the factor in the top panel is set to 0.05 and to 0.1 in the bottom
panel. Ceteris paribus, a higher factor variance increases the signal strength of the factor.
We also consider three positive values for the Sharpe-ratio (or, equivalently, the mean) of the
factor, as well as a case with mean-0 factor. The vertical lines indicate the 𝛾 that maximizes
𝜏𝑘 (𝛾)10 . In all cases with positive Sharpe-ratios, 𝜏𝑘 (𝛾) increases sharply with 𝛾 for small 𝛾
and then ﬂattens out as 𝛾 increases. For ﬁxed factor variance, the gains in the correlation
of the estimated and true factors increase with the Sharpe-ratio (and mean) of the factor.
Comparing the two panel shows that the optimal 𝛾 is higher if the signal strength of the
factor is lower (i.e. the factor variance decreases) and if the Sharpe-ratio increases. If the
Sharpe-ratio (or the mean) of a factor is zero, then 𝜏𝑘 (𝛾) is decreasing in 𝛾 and the optimal
weight 𝛾 = −1, as stated in Proposition 2. Note that in this case 𝜏𝑘 (𝛾) = 0 if 𝛾 is large
enough. The reason is that the factor mean does not contain any useful information but
more and more weight is put on the uninformative cross-sectional errors. Hence, in this case
RP-PCA performs strictly worse than PCA.
      How should the optimal 𝛾 be chosen? Based on our asymptotic theory, there are two
possible criteria. First, a very large 𝛾 maximizes the probably of detecting a weak factor but
lowers the correlation with the true factor. Alternatively, a moderately high 𝛾 maximizes this
correlation. Another aspect of choosing 𝛾 is the out-of-sample performance of the RP-PCA
estimator. As we will show in the next section, RP-PCA estimation deteriorates out-of-sample
if 𝛾 is chosen too high.

2.4. Number of Factors
      We use diﬀerent diagnostic criteria to determine the number of factors. The basic idea
for estimating the number of factors is that the systematic eigenvalues of the covariance
matrix are “large” while the idiosyncratic eigenvalues are “small”. Traditional methods de-
signed for strong factor models, such as the information criterion in Bai and Ng (2002) and
the eigenvalue ratio estimator of Ahn and Horenstein (2010), are exploit the fact that strong

  8
     Intuitively, the phase transition phenomena that hides weak factors can be avoided by putting some weight
on the information captured by the risk-premium.
   9
     We have estimated the sparse residual correlation matrix with a thresholding approach based on 𝑁 = 370
deciles sorted portfolios as described in the empirical Section 4. The other parameters are the same as in the
simulation section.
  10
     We calculate the smallest value of 𝛾 such that 𝜏𝑘 (𝛾) is less than 0.5% from its maximum value as 𝜏𝑘 (𝛾) can
be essentially ﬂat for large values of 𝛾 and there is practically no gain in increasing 𝛾.

                                                      12
factors lead to exploding eigenvalues while the idiosyncratic eigenvalues are bounded. Esti-
mating the number of factor in weak factor models is more complicated since eigenvalues of
weak factors are bounded just as the idiosyncratic eigenvalues. Onatski (2010) shows that
the pattern of successive eigenvalues can be used to determine the number of systematic
factors and proposes an eigenvalue diﬀerence estimator. He argues that idiosyncratic eigen-
values cluster around a single point, i.e. successive eigenvalues are similar in magnitudes. In
contrast, successive systematic eigenvalues are diﬀerent in magnitude. Hence, the number
of weak factors can be estimated by determining when, starting from the smallest eigenval-
ues, the clustering in the residual eigenvalues stops. However, only weak factors that are
detectable, i.e. whose eigenvalues separate from the idiosyncratic spectrum, can be identi-
ﬁed. When the signal strength of weak factors is too low, i.e. below the detection threshold
in Proposition 2, their eigenvalues can not be separated form the eigenvalues of idiosyncratic
factors. However, if we apply the Onatski (2010) argument to the eigenvalues of the RP-PCA
covariance matrix with overweighted mean, we can detect these weak factors.11


3. Simulation

      In this section we use a Monte Carlo simulation to study the behavior of the RP-PCA
estimator in samples of the size typically encountered in practice. We focus on the eﬀects
of 𝛾, the signal strength and excess returns of factors (Lettau and Pelger (2018a) conduct a
more comprehensive simulation study).
      We consider a two factor model, where the ﬁrst factor mimics a strong “market” factor
that aﬀects all assets with an average loading of one. The second factor is a weak long-short
factor with an average loading of zero: Λ𝑛,1 = 1, Λ𝑛,2 ∼ 𝑁(0, 1). The mean and standard
deviation of the market factor are 𝜇1 = 0.5%, 𝜎1 = 4.5% and the Sharpe ratio is 0.11. The
signal strength of the weak second factors depends on its variance 𝜎22 and Sharpe ratio. We
consider a variety of diﬀerent values for 𝜎𝐹2 and SR𝐹 to assess the RP-PCA estimation of weak
factors.
   The performance of RP-PCA is evaluated by the following criteria: (i) the correlation
between the estimated and “true” factors, 𝜌(𝐹̂𝑘 , 𝐹𝑘 ), (ii) the Sharpe-ratios of the estimated
         ̂ 𝑘 , and (iii) the root-mean-squared pricing errors of time series regressions of re-
factors, SR
                                                 2
turns on estimated factors, RMSE = √1/𝑁 ∑𝑛 𝛼𝑛      . We normalize the RMSE of the model
with estimated factors by the RMSE for the true factors. To conserve space we only report
out-of-sample results where we ﬁrst estimate the loading vector in-sample and then obtain

 11
    The mean operator with the weight 𝛾 can lead to an additional “spurious” spike in the eigenvalues of
1 ⊤
𝑇
  𝑋 𝑋  + 𝛾𝑋̄𝑋̄⊤ . Hence, if we observe that the ﬁrst 𝑞 eigenvalues do not cluster, we must have at least 𝑞 − 1
strong or weak factors, but it is theoretically possible that the 𝑞th spike is spurious. For realistic values in our
simulations this spurious phenomena did not occur.


                                                        13
the out-of-sample factor estimates by projecting the out-of-sample returns on the estimated
loadings. The sample size of 𝑁 = 74 and 𝑇 = 650 observations is based on our empirical
study below. Finally, the correlation matrix of our simulated residuals is set to the empirical
                                                 12
correlation that we observe in the data.
      We ﬁrst consider estimation of the strong ﬁrst factor. Figure 2 shows the evaluation
criteria as function of 𝛾. Panel A shows that the correlation of the estimated factor and the
true factor 𝜌(𝐹̂1 , 𝐹1 ) is close to one indicating that unobservable strong factor is estimated
                                                                                       ̂ 1 is
with high precision for all values of 𝛾. Panel B shows that the estimated Sharpe ratio SR
close to the true SR of the strong factor (0.11) for all values of 𝛾. This conﬁrms the theoretical
results in Proposition 1 that stated that strong factors can be estimated consistently and that
𝛾 only aﬀects the eﬃciency of the estimator. We conclude that strong factors are relatively
easy to estimate by PCA-based methods. We next consider the more interesting case of weak
factors.
      Figure 3 has the same layout as Figure 2 but considers a range of values for the variance
and Sharpe ratio of the weak factor: 𝜎22 = 0.05, 0.1, 0.5 and SR2 = 0.1, 0.3, 0.5, 0.6. The
panel columns have diﬀerent values of 𝜎22 and each panel has four lines corresponding to
four diﬀerent values of SR2 . Recall that the signal strength of a factor increases in 𝜎22 and
SR2 , so a factor with a small variance but a high Sharpe ratio is detectable by RP-PCA as long
as 𝛾 is suﬃciently high. Consider a factor with a low variance 𝜎22 = 0.05 (left column in
Figure 3). The top panel shows that the correlation 𝜌(𝐹2 , 𝐹̂2 ) is essentially zero if the Sharpe
ratio is also low (SR2 = 0.1). This is an example of an undetectable factor that is below
the signal threshold in Proposition 2. As the Sharpe ratio of the weak factor increases, the
factor becomes detectable as long as 𝛾 is set suﬃciently high. The intuition is that a non-
zero Sharpe ratio contains information that can be exploiting by putting more weight on the
mean, i.e. increasing 𝛾. Hence a factor that is missed by standard PCA with 𝛾 = −1 can be
detected by RP-PCA. However, 𝜌(𝐹2 , 𝐹̂2 ) is below one in all cases showing that in contrast to
strong factors, weak factors are not fully identiﬁable as shown theoretically in Proposition
2.
                                                            ̂ 2 of the second factor increases
      The panel below shows that the estimated Sharpe ratio SR
with 𝛾. This is intuitive since a higher 𝛾 allows for a better identiﬁcation of the weak factor.

 12
    In more detail, we have estimated the residual correlation matrix based on 𝑁 = 74 extreme deciles sorted
portfolios as described in the empirical Section 4. In each case we have ﬁrst regressed out the systematic factors
and then estimated the residual covariance matrix with a hard thresholding approach setting small values to
zero, see Bickel and Levina (2008) and Fan, Liao and Mincheva (2013). This provides a consistent estimator of
the residual population covariance matrix. We have regressed out the ﬁrst 6 PCA factors. Our results remain
unchanged when we calculate residuals based on more PCA factors or using RP-PCA factors. The additional
results are available upon request. The remaining correlation structure in the residuals is sparse. In particular
the estimated eigenvalues of the simulated residuals coincide with the empirical estimates of the eigenvalues.
The average idiosyncratic noise level is estimated from the data and set to 𝜎𝑒2 = 4.


                                                       14
Finally, the bottom panel shows that the RMSE time-series error decreases slightly with 𝛾
if SR = 0.6. If the Sharpe ratio is lower, coupled with a low variance of the second factor
relative to the variance of the ﬁrst factor (0.05 vs. 0.21), the true model is dominated by the
market factor and identifying the second factor decreases the RMSE only marginally.
      The middle column of Figure 3 considers a larger 𝜎22 of 0.1. The patterns are similar as
for 𝜎22 = 0.05 but the eﬀect of a higher 𝛾 is more pronounced. The eﬀect of a higher 𝛾
is especially pronounced if the Sharpe ratio of the weak factor is high. For SR2 = 0.6, the
improvements along all three evaluation criteria are substantial.
                                                                                 ̂ 1 are larger than
      Since the signal strength of the second factor is higher, 𝜌(𝐹2 , 𝐹̂2 ) and SR
in the left column as long as 𝛾 is suﬃciently high. The eﬀect of a higher 𝛾 on the normalized
RMSE is larger than in the left panel with smaller factor variance. Note that standard PCA
misses to detect this factor completely and thus RP-PCA strictly dominates PCA for 𝛾 ≳ 5.
      In the right columns 𝜎22 is increased further to 0.5. Now, the signal strength is suﬃciently
high that the second factor is better characterized as strong rather than weak and thus can
be estimated regardless of 𝛾. This example shows that RP-PCA is particularly powerful for
factors in the intermediate range between very weak factors that are undetectable and factors
that are strong enough to be detectable by standard PCA. We will argue in the empirical
section below that in the data the market index is a strong factor while any additional factors
are better characterized as weak, so that they might missed by standard PCA but not too
weak, so that they can be estimated by RP-PCA.
      In Figure 4, we plot sample paths of one representative simulation run. Each panel shows
the true factor as well as the estimated RP-PCA factors for a range of 𝛾’s. The estimated
sample paths of the strong factor in the ﬁrst panel are close to the sample path of the true
factor, which is not surprising since the correlations of the estimated factors with the true
factor is essentially equal to one, as discussed above. The pattern is diﬀerent for the second
(weak) factor in the second panel since the sample paths of the factor estimates diverge from
the path of the true factor. As predicted by Proposition 2, the paths are closer to the path
of the true factor for higher 𝛾. In particular, the estimated PCA factor with 𝛾 = −1 has no
resemblance to the path of the true factor and thus the weak factor is unidentiﬁed by PCA.


4. Empirical Results

      We proceed with the empirical application in two steps. First, we consider two cases with
25 double-sorted portfolios. The RP-PCA is designed to handle much larger cross-sections
but the cases with smaller 𝑁 are helpful in demonstrating the methodology. Next, we con-
sider the larger cross-section of anomaly portfolios used in Kozak et al. (2017) that is based
                                                      13
on single-sorts of 37 diﬀerent characteristics.            The sample span is July 1963 to December
 13
      We thank the authors for sharing their data.

                                                     15
2017 in all cases.
                                                                            Λ⊤ , is identiﬁed.
      As mentioned in section 2, only the product of factors and loadings, FΛ
For the theoretical derivations in section 2, it was convenient to normalize the loadings in
terms of Λ ⊤Λ . When presenting empirical results, it turns out to be more useful to normalize
the variance-covariance matrix of the factors instead, hence we set Σ 𝐹 = I𝐾 , unless otherwise
noted. The reason is that we want to compare diﬀerent factor model and their composition
in terms of the original portfolios. To do so, the “units” of estimated loadings must be
comparable across models. Normalizing Σ 𝐹 = I𝐾 achieves this objective. For some results,
normalizing the loadings, i.e. Λ ⊤Λ = I𝑘 , is more informative. Of course, the overall model is
not aﬀected by any normalization.

4.1. Double-Sorted Portfolio, 𝑁 = 25
      We start with two well-studied data sets of 25 double-sorted portfolio: Size/accruals and
size/short-term reversal. We compare RP-PCA and PCA with three factors (𝐾 = 3). We also
consider a three-factor model with ad hoc long-short portfolios where the factors are long
in the equally weighted top quintiles and short in the bottom quintiles. We evaluate models
by the same criteria as in section 3: The Sharpe ratio, cross-sectional pricing errors and
unexplained time-series variation.14
      Figure 5 plots the Sharpe ratio in the top panel, the RMS time series pricing errors 𝛼𝑛 ,
and the unexplained time series variation (as a fraction of total variation) as a function of the
RP-PCA weight 𝛾 for the size/accruals portfolios. The left panels are in-sample and the right
panels are out-of-sample statistics. To illustrate the eﬀect of each factor, we consider models
with one, two and three factors. The ﬁgure shows that 𝛾 has little eﬀect on the Sharpe ratios,
𝛼’s and unexplained variances in models with one and two factors. Hence RP-PCA and PCA
are essentially equivalent, which suggests that the ﬁrst two factors are “strong”. This is not
the case when a third factor is added (solid green lines). As long as 𝛾 is less than 5, adding
a third factor does not change the in-sample SR and 𝛼 materially. For 𝛾 larger than 5, the
SR increases and the RMS 𝛼 decreases. For 𝛾 > 15, the in-sample SR is about twice as high

 14
   We calculate the maximum Sharpe ratio that can be obtained by a linear combination of the factors, i.e. it
combines the factors with the weights Σ−1
                                       𝐹 𝜇𝐹 . This is the Sharpe ratio of the stochastic discount factor implied
                                                                           1   𝑁
by the factors. The root-mean-squared pricing error (𝑅𝑀𝑆𝛼) equals √ 𝑁 ∑𝑖=1 𝛼𝑖2 , where the pricing error 𝛼𝑖 is
the intercept of a time-series regression of the excess return of asset 𝑖 on the factors. The idiosyncratic variation
is the average variance of the residuals after regressing out the factors. The in-sample analysis is based on the
whole time horizon of 𝑇 = 650 months. The out-of-sample analysis estimates the loadings with a rolling
window of 20 years (𝑇 = 240). With these estimated loadings including information up to time 𝑡 we predict
the systematic return and obtain a pricing error out-of-sample at 𝑡 + 1. This corresponds to a cross-sectional
pricing regression with out-of-sample loadings. The mean and variance of the out-of-sample errors are used
to calculate the average pricing error and the idiosyncratic variation. We use the optimal portfolio weights for
the maximum Sharpe-ratio portfolio estimated in the rolling window period to create an out-of-sample optimal
return giving us the maximum Sharpe-ratio portfolio out-of-sample.


                                                        16
as for 𝛾 = −1 and the RMS 𝛼 is cut in half. Note that the increase in residual variance rises
only very little compared relative to the PCA case with 𝛾 = −1. The out-of-sample statistics
are similar but the eﬀect of higher 𝛾 starts at smaller values.
   What is the cause for the diﬀerence between PCA and RP-PCA when a third factor is
added? Figure 6 shows a heat map of the loadings of the three factors for PCA with 𝛾 = −1
and RP-PCA with 𝛾 = 10. Positive loadings are in green and negative loadings in red. The
ﬁgure shows that the loading of the ﬁrst two factors are similar for PCA and RP-PCA. The ﬁrst
factor is a “long” factor with positive weights on all portfolios with a tilt towards small-stock
portfolios. The second factor is a long-short factor with positive weights on small-stock
portfolios and short in large-stock portfolios. These factors are similar to the market and
SMB factors in Fama-French models. The composition of the third factor is diﬀerent for PCA
and RP-PCA. The PCA factor has no clear pattern and adds very little information, as shown in
Figure 5. In contrast, the third RP-PCA factor has positive loadings on low-accrual stocks and
negative loadings on high-accrual stocks, similar to a Fama-French-type factor. This pattern
explains the higher Sharpe ratio and lower 𝛼’s in the three factor RP-PCA model shown in
Figure 5.
   The top panel of Table 1 reports in-sample and out-of-sample Sharpe ratios, RMS 𝛼’s and
unexplained variance of three factor PCA, RP-PCA with 𝛾 = 10 and the long/short Fama-
French-style model with ad-hoc weights. In-sample, the ad hoc long/short model performs
almost as well as the RP-PCA model but the OOS SR of the RP-PCA is almost twice as high
as the OOS SR of the ad hoc model. The SR of the PCA model is lower and its RMS 𝛼 is
higher than RP-PCA both in-sample and out-of-sample. Note that the unexplained variation
of RP-PCA is only slightly higher than that of PCA.
   The evidence suggests that the underlying factor model for 25 size/accruals portfolio
consists of two “strong” factors that are easily identiﬁable and one “weak” factor that is
missed by PCA but can be identiﬁed by RP-PCA.
   Consider next the results for the 25 size/short-term reversal portfolios shown in Figure
7. The SR and RMS 𝛼 for models with one factors are almost unaﬀected by 𝛾 and change only
moderately for the the three factor model. In contrast, the statistics of two-factor models
change substantially for diﬀerent 𝛾. The IS-SR rises and IS-RMSE 𝛼 decreases once 𝛾 exceeds
18 and settle down at 𝛾 ≈ 20. Figure 8 compares the loadings for the three factors for PCA
and RP-PCA with 𝛾 = 20. As in the case of the size/accruals portfolios, the loadings of the
ﬁrst factor is very similar for both models. The second PCA factor has positive loadings
of small-stock portfolios and negative ones of large-stock portfolios, it is hence a “small-
minus-big” portfolios. The third PCA factor is long in low-reversal portfolios and short in
high-reversal stocks and is therefore a “long-minus-short” reversal factor. These two factors
are reversed in RP-PCA. The second RP-PCA factor is a “long-minus-short” reversal factor


                                               17
while the third factor is “small-minus-big” factor. The reason for this switch is that the return
spread is much larger along the reversal dimension than along the size dimension since RP-
PCA gives high Sharpe-ratio factors additional weight. A “small-minus-big” factor contributes
more towards the common time-series variation and is this favored by PCA, whereas the
“long-minus-short” reversal factor contributes more to the cross-sectional dimension and is
thus favored by RP-PCA.

4.2. Large Cross-section of Single-Sorted Portfolio
   Next, we apply the RP-PCA estimator to a larger cross-section of portfolios. We select 37
characteristics from the data set used in Kozak et al. (2017) that are available as of July 1963.
Table 3 shows the mean return, the standard deviation, the SR of the long-short portfolios
as well as the mean return of the extreme portfolios. We consider two cases: (i) The two
extreme 1 and 10 portfolios of each characteristic sort, so that 𝑁 = 74, (ii) all deciles with
𝑁 = 370.
   It will be useful to group related anomalies into categories deﬁned as follows:

    value: value, valuem, divp, ep, cfp, sp

    value interactions: valmom, valmomprof, valprof

    momentum: mom, mom12, indmom

    reversal: lrrev, strev, momrev

    industry reversal: indmomrev, indrrev, indrrevlv;

    growth: inv, invcap, igrowth, growth, sgrowth

    proﬁtability: prof, roaa, roea, noa, gmargins, aturnover

    other: All other portfolios are in categories of their own

Number of factors
   We start the factor analysis by investigating how many factors are “systematic” and how
many are “idiosyncratic”. We use two approaches to determine the number of factors: First,
we apply a diagnostic criterion to the eigenvalues as described in section 2.4. Second, we
study the out-of-sample performance based on the number of factors.
                                                                    1 ⊤
   Figure 9 plots the diﬀerences of consecutive eigenvalues of      𝑇
                                                                      X X   + 𝛾X̄ X̄ ⊤ for diﬀerent
values of 𝛾 for the sample with only deciles 1 and 10 in Panel A and sample with all deciles
in Panel B. The red line indicates the critical values of the Onatski-criterion. For 𝛾 < 10, the
ﬁfth eigenvalue diﬀerence is below the critical value in both samples indicating that the ﬁrst
four factors are systematic. However, for 𝛾 ≥ 10, the ﬁfth eigenvalue diﬀerence is above the
critical value indicating that there are ﬁve systematic factors. This suggests that the ﬁfth


                                               18
factor is weak and below the detection threshold for PCA and RP-PCA with 𝛾 < 10. Once 𝛾
is chosen high enough, RP-PCA is able to detect this factor.
   Our second diagnostic criterion concerns the out-of-sample performance of the estimator.
If a spurious factor overﬁts the noise in the data, we expect it to have a poor out-of-sample
performance. As we will see below, when adding incrementally factors and determining the
maximum Sharpe-ratio, pricing errors and amount of unexplained variation, we observe a
signiﬁcant change when including ﬁve factors in the RP-PCA estimation in-sample as well as
out-of-sample. A ﬁfth factor does add much to the explanatory power of the RP-PCA model
conﬁrming the evidence based on the Onatski criterion.

Estimation Results: RP-PCA vs. PCA
   Figure 10 compares the SR, RMS 𝛼 and unexplained variance in-sample and out-of sample
for both samples (𝑁 = 74 in the left column and 𝑁 = 370 in the right). For each model we
start with one factor and successively add factors (up to a total of six factors). The RP-PCA
weight 𝛾 is set to 10. The top two panels show the Sharpe-ratios of the stochastic discount
factors that are implied by the estimated factors. Note that the SRs for the case with only
the extreme deciles (𝑁 = 74) are very similar to those of the case with all deciles (𝑁 = 370)
suggesting that estimated factors for the full model are mostly comprised of the extreme
1 and 10 decile portfolios. We will study the portfolio weights of the estimated factors in
more detail below. As expected, adding factors increases the in-sample Sharpe ratios of the
SDFs for all models but the magnitudes of the incremental results diﬀer. First, the overall
SRs are signiﬁcantly higher for RP-PCA than those for PCA. The IS-SR for models with ﬁve
factors for RP-PCA is 0.57, about twice as high as the IS-SR for PCA. The OOS-SRs exhibit a
similar pattern but are somewhat lower than the IS-SRs. Second, higher order factors add
substantially to the SRs, especially for RP-PCA. Consider the case with 𝑁 = 74. The SR of the
1-factor RP-PCA model is 0.12; adding factors two and three raises the SR to about 0.4. The
fourth factor has little eﬀect on the SR but the ﬁfth factor raises the SR by 0.2 to around 0.6.
Adding a sixth factor has a minimal eﬀect. In contrast, the incremental eﬀects of additional
factors is much smaller in the PCA model. Note that the OOS-SRs in the right panel are
only slightly lower than the IS-SRs suggesting that the RP-PCA model does not suﬀer from
excessive overﬁtting.
   The middle row shows the root-mean-squared cross-sectional pricing errors. First, note
that adding incremental factors in all models reduces pricing errors not only in-sample but
also out-of-sample, again conﬁrming that the factor structure is stable and the models are
not overﬁtting. Second, RP-PCA pricing errors are smaller than those for PCA in all cases
but the incremental eﬀects of the factors are diﬀerent. In the sample with only the one and
ten deciles, the second and ﬁfth RP-PCA factors have a particularly large incremental eﬀect
on the pricing errors. These are the same factors that also have a large incremental eﬀect

                                              19
on the Sharpe-ratios shown in the top panel suggesting that these are important for pricing
cross-sectional returns. Since the corresponding PCA factors have much smaller eﬀects on
the Sharpe-ratio, they also do not improve the cross-sectional ﬁt of the PCA model by much.
Finally, the RMS pricing errors are smaller for the large sample with all portfolios than for
the sample with only the 1-10 deciles. This is because the extreme 1 and 10 portfolios are
the most mispriced while the pricing errors of the middle portfolios are smaller resulting in
a smaller average error. If we plotted only the pricing errors of 1 and 10 portfolios in the
large sample, the patterns would look as in the case with 𝑁 = 74.
   The plots for the unexplained idiosyncratic variations in the bottom row are almost iden-
tical for comparable RP-PCA and PCA models. Since PCA factors minimize unexplained vari-
ation, RP-PCA sacriﬁces some power along this dimension but the plots show that the eﬀect
is minute.
   Panel A of Table 4 compares the Sharpe-ratios, pricing errors and idiosyncratic variance
for RP-PCA and PCA models with three and ﬁve factors. The in- and out-of-sample RP-PCA
Sharpe ratios are up to twice as high than those for PCA in three and ﬁve factor models and
for both samples. RP-PCA also implies smaller pricing errors in all cases while idiosyncratic
variances for RP-PC is only slightly larger than those for PCA. Properties for individual factors
are shown in Table 5. To make factors comparable, we normalize all factor loadings to a
norm of one. Not surprisingly, the variance of the ﬁrst factor is a magnitude larger than the
variances of the other factors but for RP-PCA its Sharpe-ratio is smaller than for factors with
smaller variances. Moreover, the Sharpe-ratios of RP-PCA factors are signiﬁcantly larger than
the corresponding PCA factors (with the exception of the fourth factor for 𝑁 = 74). Note
the Sharpe-ratio of the ﬁfth RP-PCA factor is almost twice as large as the Sharpe-ratios of
the ﬁrst four RP-PCA factors. Recall that the ﬁfth factor is signiﬁcant for RP-PCA but not for
PCA.
   In summary, RP-PCA outperforms PCA in terms of pricing errors and extracting factors
with higher Sharpe ration and sacriﬁces little in terms of time series variation. Next, we
analyze these results in more detail.
   Figure 11 shows the mean-squared cross-sectional pricing errors (𝛼’s) for each anomaly
based on models with six factors. We include a ﬁfth factor for PCA to enable a comparison
with 5-factor RP-PCA model. The anomalies are ranked by the Sharpe-ratio of the decile-
10 return minus the return of decile-1 (’10-1’). The dark blue bars are RP-PCA 𝛼’s and the
light blue bars are those for PCA. In almost all cases the RP-PCA pricing errors are smaller
than those of PCA. Only the momentum (mom) portfolios 𝛼’s are consistently larger for RP-
PCA than for PCA. RP-PCA markedly outperforms PCA for a number of portfolios, including
ivol, valuem, mom12, and indrrev. The ﬁgure also shows that the anomalies with the highest
Sharpe-ratio are the ones with the largest pricing errors. RP-PCA reduces these pricing errors


                                               20
relative to PCA, especially in the small sample with 74 portfolios.
   Next, we study the composition of the estimated SDF and individual factors. Each model
implies an SDF that is a linear combination of the portfolios in the sample. Figure 12 shows
the compositions of the RP-PCA and PCA SDF loadings for the case with the ﬁrst and 10th
deciles (𝑁 = 74). The anomalies are ranked by Sharpe-ratio. The dark bars represent the
portfolio weights of the decile-10 portfolios and the light bars show the the decile-1 weights.
First, note that the high-returns decile-10 weights are mostly of the opposite sign of the
weights of the low-return decile-1 portfolios for RP-PCA as well as PCA. Hence, the SDF is
composed of long-short anomaly portfolios but the weights do not necessarily sum to zero,
as is the case for Fama-French style factors. Next, note that the largest loadings (in absolute
value) of the RP-PCA SDF are related to anomalies with the highest Sharpe-ratio (e.g. indrrev
and indmomrev) while the magnitudes of the PCA weight are not linked to Sharpe-ratios.
This is due to the fact that RP-PCA puts more weight on the cross-sectional pricing errors
than PCA and conﬁrms the validity of the simulations results when RP-PCA is applied to
actual data.

Factor composition
   The SDF of each model is linear combination of the ﬁve individual factors; we study
composition of individual factors next. Figure 13a shows heatmaps of the RP-PCA and PCA
portfolio weights in each factors for the sample with only the 1 and 10 deciles. The color
range is dark blue (largest) to dark brown (most negative) while white corresponds to a load-
ing of zero. Each panel shows the RP-PCA and PCA decile-10 weights for a given factor in
the top two rows and their decile-1 loadings in rows three and four. The factors are nor-
malized to have a variance of one in order to make the loadings comparable across diﬀerent
factors. The portfolios on the 𝑥-axis in the ﬁrst four factors are sorted by categories while
the heatmap for the ﬁfth factor is sorted by SR.
   Typically, the ﬁrst factor in factor models of asset returns is a “level” factor that is “long”
in all portfolios. The top panel of Figure 13a shows that this is the case here as well. The
loadings range from 2.9 to 7.6 with an average of 4.99 for RP-PCA and 4.97 for PCA. More-
over, the weights of ﬁrst RP-PCA and PCA factors are almost identical and the factors have
a correlation of 0.999 suggesting that the ﬁrst factor is “strong” and relatively easy to iden-
tify by PCA-based methods. The correlations of the ﬁrst RP-PCA and PCA factor with the
CRSP-VW index return is 0.99 conﬁrming the interpretation of “level” factors and essentially
proxies for the market return.
   The second panel of Figure 13a shows the composition of the second factor. In contrast
to the long-only structure of the ﬁrst factor, the second factor is composed of long and short
positions of individual portfolios. Moreover, the decile-10 and decile-1 loadings are (mostly)


                                               21
of diﬀerent signs, hence this factor is akin to long-short factors in which the high-return fac-
tors are of opposite signs of the low-return factors. For most portfolios the high-return decile
10 has a positive weight while the weight of the low-return decile is negative but there are sev-
eral exceptions. The average RP-PCA portfolio weight is -0.41, much smaller than the mean
loading of 4.99 of the ﬁrst factor, and hence represents an almost zero-investment strategy
similar to the Fama-French factor portfolios. The heatmap also shows that the second factor
has large (in absolute value) loadings of value/growth related portfolios. The second PCA
factor loads strongly on traditional multiples (book/market, dividend/price, earnings/price,
cash-ﬂow/price and sales/price) and suggests an interpretation of a “value” factor. The sec-
ond RP-PCA factor also loads positively on these multiple portfolios, but in contrast to the
PCA factor, the loadings of value-related multi-dimensional anomalies are also large (Value-
Momentum, Value-Momentum-Proﬁtability, Value-Proﬁtability). Hence this factor can be in-
terpreted as a “value/value-interaction” factor.
   The interpretation of the third factor is less clear. It has a similar long-short structure
as the second factor with a mean holding of close to zero. The RP-PCA factor loads most on
momentum and proﬁtability-related portfolios but the PCA factor is not linked to particular
categories. In contrast, the heatmaps in the top panel of Figure 13b show that the fourth RP-
PCA and PCA factors load most heavily on momentum and momentum-interaction portfolios.
The loadings of other portfolios are signiﬁcantly smaller (with some exceptions). For both es-
timation methods, the fourth factor represents a “momentum/momentum-interaction” fac-
tor.
   The portfolios on the 𝑥-axis of the heatmaps for the ﬁfth factor in the bottom panel of
Figure 13b are sorted by the SR of the 10-1 returns instead of categories. Recall that the
ﬁfth RP-PCA factor has a SR of 0.45 while the SR of the ﬁfth PCA factor is only 0.18 (see
Table 5). The heatmap shows the reason why this is the case. The loadings of the ﬁfth RP-
PCA factor are linked to the SR of portfolios while this is not the case for the ﬁfth PCA factor.
The RP-PCA weights of the ﬁve anomaly portfolios with the highest SR (indrrev, indmomrev,
indrrev, seasonand valprof ) are all positive while theses PCA weights are close to zero. Thus,
the ﬁfth RP-PCA factor is a “high SR” factor while the ﬁfth PCA factor does not have a clear
interpretation, which is not surprising since it is insigniﬁcant (see Figure 9).
   While the estimation is agnostic about the types and “names” of portfolios, it is notewor-
thy that most of the identiﬁed factors have clear economic interpretations. The ﬁrst RP-PCA
and PCA factor is a market proxy, the second factor is a “value/value-interaction” factor
(RP-PCA) or a pure “value” factor (PCA) and the third factor is a “momentum/momentum-
interaction” factor. The fourth RP-PCA factor is linked to momentum and proﬁtability while
the ﬁfth RP-PCA factor is a “high SR” factor.




                                                22
Proxy factors
      In order to interpret latent factor models Pelger and Xiong (2018) propose the use of
proxy factors. The proxy factors use only the largest portfolio weights of the latent factors
and set the smaller portfolio weights to zero. Pelger and Xiong (2018) show that the largest
factor portfolio weights already contain most of the information signal even if the true factor
itself is not sparse. We approximate the ﬁrst latent factor by an equally weighted portfolio
of all assets and use the 8 largest portfolio weights for 𝑁 = 74 respectively the 10% largest
portfolio weights for 𝑁 = 370 to approximate the latent second to ﬁfth RP-PCA and PCA
factors.
      Based on the portfolio weights of the proxy factors in Table 6 we conﬁrm our previous
interpretation about which characteristics describe the latent factors. The ﬁrst RP-PCA proxy
is a market factor. The second to fourth RP-PCA proxy factors load heavily on value, momen-
tum, value- and momentum-interaction. The ﬁfth RP-PCA proxy factor can be interpreted as
a LS-factor based on reversal-interaction, which are high SR anomalies. The second to fourth
PCA proxy factors are based on value, momentum and momentum-interaction. Interest-
ingly, the ﬁfth PCA proxy factor has a clear interpretation as an asset turnover/proﬁtability
LS-factor, which has a relatively low SR.
      One of the major problems when comparing two diﬀerent sets of factors is that a factor
model is only identiﬁed up to invertible linear transformations. Two sets of factors represent
the same factor model if the factors span the same vector space. When trying to interpret
estimated factors by comparing them with economic factors, we need a measure to describe
how close two vector spaces are to each other. As proposed by Bai and Ng (2006) the gen-
eralized correlation is a natural candidate measure. Intuitively, we calculate the correlation
between the latent and candidate factors after rotating them appropriately. Generalized cor-
relations close to 1 measure of how many factors two sets have in common.15
      Table 7 shows the generalized correlations of the original factors with the proxy factors,
i.e. the correlations after rotating the latent factors. The generalized correlation of the ﬁrst
four proxy factors with the estimated RP-PCA and PCA factors is 0.94 and higher conﬁrming
that the proxy factors provide a good approximation to the latent factors. The ﬁfth GC is
somewhat lower; 0.71 for RP-PCA and 0.86 for PCA. The next question is how well the proxy

 15
    Let 𝐹 be the 𝐾 latent factors and 𝐺 are 𝐾𝐺 candidate factors. We want to test if a linear combination of the
candidate factors 𝐺 can replicate some or all of the factors 𝐹. The ﬁrst generalized correlation is the highest
correlation that can be achieved through a linear combination of the factors 𝐹 and the candidate factors 𝐺. For
the second generalized correlation we ﬁrst project out the subspace that spans the linear combination for the
ﬁrst generalized correlation and then determine the highest possible correlation that can be achieved through
linear combinations of the remaining 𝐾−1 respectively 𝐾𝐺 −1 dimensional subspaces. This procedure continues
until we have calculated the min(𝐾, 𝐾𝐺 ) generalized correlation. Mathematically the generalized correlations
are the square root of the min(𝐾, 𝐾𝐺 ) largest eigenvalues of the matrix Cov(𝐹, 𝐺)Var(𝐹)−1 Cov(𝐹, 𝐺)Var(𝐺)−1 .
If 𝐾 = 𝐾𝐺 = 1 it is simply the correlation.


                                                      23
factors price the portfolios. Panel B of Table 4 shows the pricing statistics for models with
proxy factors in comparison with the statistics of the original factors in Panel A. Overall, the
results are very similar conﬁrming that the proxy factors retain most of the pricing informa-
tion of the the original factors. Note that the proxy models tend to outperform the models
with original factors out-of-sample. This is due to the more parsimonious representation
with fewer portfolios that have non-zero weights that comprise the proxy factors.

The full sample, 𝑁 = 370
   Next, we study the loadings for the full sample with all ten deciles of each anomaly (𝑁 =
370). Instead of plotting individual factor loadings we focus on the composition of the SDF
of the estimated RP-PCA and PCA models. Figure 14 shows the heatmap of all 370 individual
weights in the SDFs of RP-PCA (Panel A) and PCA (Panel B). All loadings are multiplied by 10
for ease of display. The anomalies on the 𝑥-axis are sorted by the anomaly Sharpe ratios.
Several patterns emerge from the SDF loadings. First, the RP-PCA SDF weights are related to
the Sharpe ratios of anomalies. The largest loadings are the high-return decile 10 portfolios
of the anomalies with the highest Sharpe-ratios in the top left corner of the heatmap. The
most negative loadings are the low-return decile 1 portfolios of these anomalies in the bottom
left. Aside from the high SR anomalies, some proﬁtability portfolio loadings are also large.
Second, the SDF is mostly comprised of the 1 and 10 deciles as the weights of the middle
portfolios tend to be small.
   The heatmap of the PCA SDF in Panel B shows a diﬀerent pattern. First, there is no link
between loadings and Sharpe ratios. This is consistent with the ﬁndings for the smaller
sample with only the 1 and 10 deciles discussed above. For example, the largest PCA loading
is lev portfolio 10 with 0.19, while its RP-PCA loading is only 0.02 (recall that the loading in
the heatmap are multiplied by 10). The weights of the high SR anomaly portfolios on the left
are (mostly) small and hence do not enter in the PCA in any signiﬁcant way. Hence it is not
surprising that the SR of the RP-PCA model is about twice as high as that of the PCA SDF (cf.
Table 4).
   Figure 17 shows the cumulative weights by decile portfolios. For example, the “Decile 1”
bars show the sum of the 37 decile-1 RP-PCA and PCA SDF weights. The pattern is similar for
RP-PCA and PCA estimations: The SDF is mostly comprised of the extreme 1 and 10 deciles
while the middle decile loadings are smaller. In other words, most of the pricing information
is contained in the extreme deciles.
   How do the statistical RP-PCA and PCA factors relate to simple long-short factors (i.e.
with weights of 1 for decile 10, -1 of decile 1 and 0 otherwise)? To answer this question, we
compute generalized correlations of statistical factors with long-short portfolios. The ﬁrst
LS-factor is the market factor and LS-factors are added incrementally based on the largest


                                              24
accumulative absolute loading of the anomaly in the portfolio weights of the statistical fac-
tors. The results are shown in Figure 16. Each panel shows ﬁve lines for the ﬁve statistical
factors in each model/sample. The number of incremental factors is on the 𝑥-axis and the
generalized correlation is on the 𝑦-axis. Consider ﬁrst the RP-PCA model using the small
sample with only the deciles 1 and 10 in the top left panel. The purple line corresponding to
the ﬁrst RP-PCA factor shows a generalized correlation of close to one with the ﬁrst LS-factor
(the market return) conﬁrming the results described above that the ﬁrst RP-PCA factor is es-
sentially a market proxy. This is true for the ﬁrst factors in all cases displayed in Figure 15.
The generalized correlation of the second to ﬁfth statistical factors with LS-portfolios is gen-
erally signiﬁcantly lower than one. For example, ﬁve LS-portfolios are required to generate
a generalized correlation with the second RP-PCA factor of 0.8 while about 10 LS-portfolios
are required for factors three and four. The ﬁfth factor is the most diﬃcult to proxy for
with LS portfolios; a combination of 18 LS-portfolios yields a generalized correlation of 0.8.
These patterns are broadly similar for PCA factors and the complete panel of 370 portfolios.
Statistical factors clearly yield more parsimonious representations of pricing factors than
simple LS-factors.

Stability over time
   Next, we investigate whether the RP-PCA and PCA factor estimations are stable over time
and whether the assumption of constant loadings is justiﬁed. Using a rolling window with
240 months we estimate the loadings for RP-PCA and PCA locally for each month and com-
pare them with the loadings estimated on the whole sample of 𝑇 = 650. We are interested
if the space spanned by factors estimated over diﬀerent time horizons is stable. If we have
the same set of latent factors but their order changes over time, it still describes the same
factor model. Figure 18 plots the generalized correlations of the ﬁve RP-PCA and PCA fac-
tor loadings estimated using rolling windows with those estimated on the whole sample.
Generalized correlations close to one indicate that the loading and hence also factor space
stays stable. We observe that RP-PCA is more stable over time than PCA and its smallest
generalized correlations is on average larger than 80%. In Figure 19 we plot the loadings for
each portfolio (on the 𝑥-axis) and each rolling sample. The loadings are rotated to match
the loadings of the whole time horizon. If the loadings were constant over time, the plot
would show a single line with the constant loading for each portfolios. If loadings were to
vary substantially, the plots would show many diﬀerent lines and look more “fuzzy”. All ﬁve
RP-PCA factor loadings appear to be quite stable with little variation over time. This is true
also for the ﬁrst four PCA factors but the loadings of ﬁfth PCA factor are signiﬁcantly less
stable over time indicating that PCA is unable to detect this factor.




                                              25
Individual stocks
   Next, we brieﬂy explore the ability of RP-PCA and PCA to capture returns of individual
stocks rather than returns of portfolios. Recall that both methods assume that factor load-
ings are constant over time and we showed that this assumptions is satisﬁed in the case of
portfolio returns. Intuitively, the assumption of constant loadings appears problematic in
the case of individual stocks. For example, the turnover in sorts of some anomaly character-
istics is very high. For example, a given stock might be in the highest momentum portfolio
at some period but in a lower momentum portfolio in another period. If momentum is a
priced factor, then the momentum loading of stocks is likely to change over time. To explore
whether this is indeed the case, we estimate RP-PCA and PCA on a panel of large stocks.
   Our sample consists of monthly excess returns of a balanced panel of stock returns from
1/1972 to 12/2014, which results in 𝑁 = 270 stocks with 𝑇 = 500 monthly returns. The
data is obtained from CRSP. We include only stocks that have been constituents of the S&P
500 index at some point during the sample span and have no missing values during the
time period that we consider. Extending to a longer time period would drastically reduce the
number of stocks in our panel. By construction the stocks in our sample are mainly large
cap stocks and the results are not driven by small stocks.
   Figures 20 to 22 show the generalized correlations and loadings for the RP-PCA and PCA
estimations using rolling windows, and in-sample and out-of-sample pricing statistics. The
plots show that, in contrast to the estimation for portfolios, the estimation for individual
stocks is much less robust and exhibits instability in loadings and pricing performance.
Generalized correlations of loadings of subsamples with loadings for the entire sample are
signiﬁcantly lower than in the case of portfolios (cf. Figures 20 and 18), especially at the
start of the sample. Moreover, loadings for rolling windows vary more for stocks than for
portfolios (cf. Figures 19 and 21).
   We study the maximum SR, pricing error and amount of unexplained variation in Fig-
ure 22. While adding factors increasing SRs and lowers pricing error in-sample for RP-PCA
and PCA, the performance completely deteriorates out-of-sample. This is an indication for
the time-variation in the factor structure for individual stocks. We conclude that a factor
model with constant loadings is not appropriate for modeling data of individual stock re-
turns. Hence the development of methods that allow for time-varying loadings is essential
for estimating factor models on ﬁrm-level data, see e.g. Kelly et al. (2017), Fan et al. (2016),
and Lettau and Pelger (2018b).


5. Conclusion

   We propose a new estimator for latent asset pricing factors to bring order into the “factor
zoo” and ﬁnd the asset pricing factors that provide independent information for expected

                                              26
returns. Our estimator is PCA generalized with a penalty term on the pricing error and
as easy to use as conventional PCA. We show that our estimator RP-PCA strongly dominates
conventional PCA. We can detect weak factors with high Sharpe-ratios which are undetectable
with PCA. Strong factors are estimated more eﬃciently with RP-PCA compared to PCA.
   We have four main conclusions. First, by estimating latent factors instead of using a pre-
speciﬁed (and potentially misspeciﬁed) set of observable factors, we ﬁnd a small number of
factors that can explain the covariance and expected return structure in the data. Second, we
demonstrate that using the information in the mean of the data in the estimation is essential
for discovering factors that can explain the risk-premium of assets. Our model outperforms
the conventional PCA approach. Our factors achieve a higher out-of-sample mean-variance
eﬃciency and smaller pricing errors than alternative models in- and out-of-sample. Third,
our factors are based on only a subset of the stock characteristics implying that a signif-
icant amount of characteristic information is redundant. Our asset pricing factors can be
interpreted as a market factor, value/value-interaction, momentum/momentum-interaction,
proﬁtability and a “high SR” factor that loads heavily on reversal. Fourth, most of the pricing
information is contained in the extreme deciles.
   The key idea for successfully extracting asset pricing factors is to use the insight of arbi-
trage pricing theory in the estimation. Factors that ﬁt the time-series have to simultaneously
ﬁt the cross-section of expected returns. RP-PCA achieves this goal by incorporating this
insight in the estimation, while neither observable nor PCA based factors reach this goal.
A distinguishing advantage of our estimator is that it ﬁnds high Sharpe-ratio factors that
are weak and only aﬀect a subset of the assets. These factors are crucial for spanning the
stochastic discount factor, but hard or impossible to detect when using PCA. Essentially all
latent factor estimators work on projected data which can be interpreted as managed port-
folios of stocks based on observable ﬁrm characteristics. This projection is necessary to
control for the time-variation in the loadings of individual stocks. However, factors that
are strong on the original stocks can become weak when considering the sorted portfolios
and hence cannot be detected by PCA. RP-PCA however is robust to the choice of managed
portfolios and will detect all asset pricing factors.
   Last but not least, our model has a direct practical beneﬁt for optimal portfolio choice.
As our asset pricing factors provide a better span of the stochastic discount factor compared
to PCA or observable factor models, their linear combinations obtains a higher Sharpe-ratio
out-of-sample. This suggests that an optimal investment portfolio should only be composed
of our RP-PCA factors.




                                               27
References

Bai, J., 2003. Inferential theory for factor models of large dimensions. Econometrica 71, 135–171.
Bai, J., Ng, S., 2002. Determining the number of factors in approximate factor models. Econometrica 70, 191–
  221.
Bryzgalova, S., 2016. Spurious factors in linear asset pricing models. Technical report, Stanford University .
Chamberlain, G., Rothschild, M., 1983. Arbitrage, factor structure, and mean-variance analysis on large asset
  markets. Econometrica 51, 1281–1304.
Cochrane, J.H., 2011. Presidential address: Discount rates. Journal of Finance 66, 1047–1108.
Connor, G., Korajczyk, R., 1988. Risk and return in an equilibrium apt: Application to a new test methodology.
  Journal of Financial Economics 21, 255–289.
Connor, G., Korajczyk, R., 1993. A test for the number of factors in an approximate factor model. Journal of
  Finance 58, 1263–1291.
Connor, G., Korajczyk, R.A., 1986. Performance measurement with the arbitrage pricing theory: A new frame-
  work for analysis. Journal of Financial Economics 15, 373–394. URL: https://www.sciencedirect.com/science/
  article/pii/0304405X86900279, doi:10.1016/0304-405X(86)90027-9.
DeMiguel, V., Garlappi, L., Nogales, F., Uppal, R., 2017. A portfolio perspective on the multitude of ﬁrm charac-
  teristics. Working paper .
Fan, J., Liao, Y., Wang, W., 2016. Projected principal component analysis in factor models. The Annals of
  Statistics 44, 219–254.
Feng, G., Giglio, S., Xiu, D., 2017. Taming the factor zoo. Technical Report, Chicago Booth .
Freyberger, J., Neuhierl, A., Weber, M., 2017. Dissecting characteristics nonparametrically. Technical Report,
  Chicago Booth .
Giglio, S., Xiu, D., 2017. Asset pricing with omitted factors. Working paper .
Harvey, C.R., Liu, Y., Zhu, H., 2016. ... and the cross-section of expected returns. Review of Financial Studies
  29, 5–68.
Kelly, B., Pruitt, S., Su, Y., 2017. Instrumented principal component analysis. Working Paper .
Kozak, S., Nagel, S., Santosh, S., 2017. Shrinking the cross section. Working Paper, Chicago Booth .
Lettau, M., Pelger, M., 2018a. Estimating latent asset pricing factors. Working paper .
Lettau, M., Pelger, M., 2018b. Factor models with time-varying loadings. Working paper .
Onatski, A., 2012. Asymptotics of the principal components estimator of large factor models with weakly
  inﬂuential factors. Journal of Econometrics , 244–258.
Pelger, M., Xiong, R., 2018. Interpretable proximate factors for large dimensions. Working paper .
Ross, S.A., 1976. The arbitrage theory of capital asset pricing. Journal of Economic Theory 13, 341–360.
Stock, J.H., Watson, M.W., 2002. Forecasting Using Principal Components from a Large Number of Predictors.
  URL: https://www.jstor.org/stable/3085839, doi:10.2307/3085839.
                     Table 1: RP-PCA vs. PCA for 25 Double-sorted Portfolios


                                         In-sample                     Out-of-sample
                             SR      RMS 𝛼      Idio. Var.        SR    RMS 𝛼       Idio. Var.

                                      Size and accrual (𝛾 = 10)
              RP-PCA        0.24      0.12         6.11         0.21      0.11        6.75
                  PCA       0.13      0.14         5.92         0.11      0.14        6.72
         FF-long/sort       0.21      0.12         7.90         0.11      0.12        7.11

                               Size and short-term reversal (𝛾 = 20)
              RP-PCA        0.22      0.15         6.48         0.15      0.19        8.40
                  PCA       0.19      0.16         6.38         0.10      0.19        8.41
         FF-long/sort       0.18      0.17         8.47         0.08      0.20        8.42

Note: Maximal Sharpe-ratios, root-mean-squared pricing errors and unexplained idiosyncratic variation.
𝐾 = 3 statistical factors.
                                    Table 2: Largest Eigenvalues


                             Size and accrual           Size and short-term reversal
                         PCA      RP-PCA (𝛾 = 10)        PCA        RP-PCA (𝛾 = 20)

                 𝜎12    19.01           19.01           21.19             21.19
                 𝜎22     1.03            1.03            1.07              1.07
                 𝜎32     0.24            0.24            0.98              0.98
                 𝜎42     0.15            0.15            0.35              0.34
                 𝜎52     0.12            0.12            0.24              0.23


Note: Variance signal for diﬀerent factors: Largest eigenvalues of ΛΣ 𝐹Λ ⊤ normalized by the average id-
                           1   𝑁
iosyncratic variance 𝜎𝑒2 = 𝑁 ∑𝑖=1 𝜎𝑒,𝑖
                                    2
                                       .
                                    Table 3: Single-sorted Portfolios

 Portfolio                   Abbreviation   Mean   SD     SR       Mean           RP-PCA           PCA
                                                                 low high       low   high      low   high

 Ind. Rel. Rev. (L.V.)       indrrevlv      1.28   3.05   0.42    0.00   1.28   -0.29    0.20    0.07    0.09
 Industry Mom. Rev.          indmomrev      1.17   3.44   0.34    0.07   1.24   -0.18    0.12    0.07    0.06
 Industry Rel. Reversals     indrrev        1.01   4.12   0.24    0.08   1.09   -0.29    0.22   -0.07   -0.05
 Seasonality                 season         0.79   3.94   0.20   0.22    1.01   -0.19   0.15    0.04    -0.01
 Value-Proﬁtability          valprof        0.75   3.81   0.20    0.26   1.01   -0.17    0.15   -0.17    0.28
 Momentum (12m)              mom12          1.25   6.88   0.18   -0.16   1.08   -0.17   0.10    -0.14   0.07
 Value-Mom-Prof.             valmomprof     0.83   4.83   0.17    0.35   1.18   -0.07    0.15   -0.19    0.20
 Investment/Assets           inv            0.47   3.06   0.15   0.40    0.86   -0.06   0.04    0.02    0.06
 Composite Issuance          ciss           0.48   3.30   0.14   0.30    0.78   -0.12   0.00    0.02    0.07
 Investment Growth           igrowth        0.38   2.71   0.14    0.33   0.71   -0.05    0.02   -0.08    0.00
 Sales/Price                 sp             0.52   4.28   0.12   0.41    0.93   0.04    0.06    -0.03   0.24
 Earnings/Price              ep             0.57   4.69   0.12   0.33    0.90   -0.07   -0.03   -0.10   0.18
 Net Operating Assets        noa            0.38   3.28   0.12   0.26    0.64   -0.12   0.10    -0.11   0.00
 Accrual                     Accrual        0.35   3.14   0.11   0.31    0.66   -0.02   0.05    0.06    -0.08
 Value (A)                   value          0.48   4.56   0.11   0.45    0.93   0.09    -0.01   0.04    0.10
 Gross Proﬁtability          prof           0.36   3.38   0.11   0.38    0.75   -0.17   0.19    -0.23   0.19
 Asset Turnover              Aturnover      0.41   3.83   0.11    0.30   0.71   -0.20    0.12   -0.32    0.24
 Value-Momentum              valmom         0.51   5.05   0.10   0.40    0.91   0.07    -0.06   -0.04   0.12
 Cash Flows/Price            cfp            0.43   4.37   0.10   0.42    0.85   0.06    -0.05   0.04    0.12
 Momentum-Reversals          momrev         0.46   4.84   0.10    0.42   0.88   -0.06    0.09   -0.06    0.08
 Asset Growth                growth         0.29   3.46   0.08   0.41    0.70   -0.02   -0.03   -0.04   0.02
 Long Run Reversals          lrrev          0.41   5.07   0.08   0.47    0.89   0.00    0.11    0.00    0.18
 Industry Momentum           indmom         0.47   6.21   0.08    0.34   0.81    0.03   -0.06   -0.06    0.10
 Idiosyncratic Volatility    ivol           0.54   7.16   0.08   -0.01   0.53   -0.18   -0.04   -0.19   0.07
 Value (M)                   valuem         0.40   5.86   0.07   0.52    0.92   0.08    0.14    0.06    -0.05
 Short-Term Reversals        strev          0.36   5.27   0.07   0.26    0.62   -0.26   0.12    -0.06   -0.02
 Size                        size           0.29   4.80   0.06   0.46    0.75   -0.03   0.09    0.00    0.16
 Momentum (6m)               mom            0.35   6.25   0.06   0.58    0.93   0.07    0.00    -0.12   0.07
 Leverage                    lev            0.26   4.63   0.06   0.48    0.73   0.10    -0.09   0.04    0.22
 Return on Assets (A)        roaa           0.21   4.08   0.05   0.37    0.58   -0.08   0.12    -0.16   0.09
 Dividend/Price              divp           0.18   5.08   0.04   0.49    0.67   0.02    -0.11   0.08    0.13
 Investment/Capital          invcap         0.12   5.01   0.02   0.57    0.68   0.15    -0.09   -0.06   -0.01
 Return on Book Equity (A)   roea           0.08   4.39   0.02   0.51    0.59   -0.07   0.08    -0.12   0.13
 Sales Growth                sgrowth        0.05   3.64   0.01   0.58    0.53   0.03    -0.08   -0.07   -0.06
 Gross Margins               gmargins       0.01   3.37   0.00   0.55    0.56   -0.10   0.10    -0.01   -0.01
 Share Volume                shvol          0.02   5.96   0.00   0.49    0.47   -0.03   -0.05   -0.08   0.06
 Price                       price          0.01   6.80   0.00   0.50    0.49   0.07    -0.03   -0.05   0.01


Note: Long-short portfolios of extreme deciles of 37 single-sorted portfolios from 07/1963 to 12/2016:
Mean, standard deviation and Sharpe-ratio, mean of low and high portfolios and contribution to the SDF
based on RP-PCA and PCA with 6 factors applied to the extreme decile portfolios (𝑁 = 74).
                                    Table 4: Fit of RP-PCA vs. PCA


                                                    In-sample                     Out-of-sample
                                         SR    RMS 𝛼 Idio. Var.             SR    RMS 𝛼 Idio. Var.

                                       Panel A: Estimated Factors

                                                  𝑁 = 74

     RP-PCA 3 factors                   0.37    0.24      13.94%           0.30     0.22     15.32%
     PCA 3 factors                      0.22    0.27      14.00%           0.14     0.25     16.00%

     RP-PCA 5 factors                   0.57    0.17      10.40%           0.50     0.15     12.06%
     PCA 5 factors                      0.30    0.22      10.30%           0.24     0.20     11.98%

                                                 𝑁 = 370

     RP-PCA 3 factors                   0.23    0.17      12.75%           0.18     0.15     14.57%
     PCA 3 factors                      0.17    0.17      12.68%           0.14     0.15     14.66%

     RP-PCA 5 factors                   0.53    0.14      10.76%           0.45     0.12     12.70%
     PCA 5 factors                      0.24    0.14      10.66%           0.17     0.14     12.56%

                                         Panel B: Proxy Factors

                                                  𝑁 = 74

     Proxy RP-PCA 3 factors             0.31    0.25      14.52%           0.26     0.22     16.01%
     Proxy PCA 3 factors                0.24    0.28      14.46%           0.22     0.24     15.72%

     Proxy RP-PCA 5 factors             0.58    0.17      10.40%           0.50     0.15     11.97%
     Proxy PCA 5 factors                0.33    0.22      11.09%           0.27     0.18     12.10%

                                                 𝑁 = 370

     Proxy RP-PCA 3 factors             0.26    0.18      13.07%           0.22     0.15     14.77%
     Proxy PCA 3 factors                0.19    0.17      12.97%           0.15     0.15     14.86%

     Proxy RP-PCA 5 factors             0.56    0.12      11.29%           0.47     0.12     13.06%
     Proxy PCA 5 factors                0.29    0.14      11.12%           0.22     0.13     13.23%

Note: Maximal Sharpe-ratios, root-mean-squared pricing errors and unexplained idiosyncratic variation
for panels of single-sorted portfolios: 74 decile 1 and decile 10 portfolios and all 370 deciles portfolios
of 37 anomalies.
                             Table 5: Individual RP-PCA and PCA Factors


                                            RP-PCA                              PCA

                             Mean       Variance       SR          Mean      Variance       SR

                                                  𝑁 = 74

           1. Factor          5.35      1892.53       0.12         5.22       1940.31      0.12
           2. Factor          2.46       67.51        0.30         0.68        98.30       0.07
           3. Factor          1.80       96.56        0.18         1.40        73.67       0.16
           4. Factor          0.28       66.73        0.03         1.13        70.96       0.13
           5. Factor          2.09       21.72        0.45         0.81        19.85       0.18

                                                  𝑁 = 370

           1. Factor         11.67      7295.35       0.14         11.56      7387.22      0.13
           2. Factor          2.65       222.62       0.18         1.66       241.03       0.11
           3. Factor          0.46       213.34       0.03         0.23       207.49       0.02
           4. Factor          2.40       125.92       0.21         1.52       132.57       0.13
           5. Factor          2.76       39.10        0.44         0.78        49.30       0.11

Note: Properties of individual factors in estimation of panels of single-sorted portfolios: 74 decile 1 and
decile 10 portfolios and all 370 deciles portfolios of 37 anomalies.
                        Table 6: Portfolio Weights of Proxy Factors 2 to 5


                                                RP-PCA

divp 10      1.53       mom12 10         2.04       size 10           2.14       valuem1 0       1.93
growth 1    -1.46       mom 10           1.99       ivol 1            2.13       indrrev 10      1.39
igrowth 1 -1.51         indmomrev 10 1.90           valmomprof 10 1.89           price 1         1.31
ep 1        -1.53       mom 1           -2.29       mom12 10          1.84       indrrevlv 10    1.26
invcap 1    -1.69       valuem 10       -2.32       mom 10            1.82       lrrev 10        1.25
shvol 1     -1.72       ivol 1          -2.93       price 1           1.69       strev 1        -1.22
mom12 1 -2.32           price 1         -3.51       shvol 1           1.65       indrrevlv 1    -1.34
ivol 1      -2.48       mom12 1         -4.00       indmomrev 1      -1.57       indrrev 1      -1.37

                                                 PCA

valuem 10 2.91          divp 10          1.74       indmom 10         2.42       valprof 10      1.25
price 1      2.52       ivol 10          1.69       mom 10            2.39       Aturnover 10 1.15
divp 10      2.26       roea 1          -1.64       valmom 10         2.18       prof 10         0.95
value 10     2.24       mom12 1         -1.65       mom12 10          2.12       sp 10           0.95
lrrev 10     2.06       size 10         -1.82       valmomprof 10 2.12           lrrev 10        0.86
sp 10        1.98       shvol 1         -1.90       indmom 1         -2.38       valprof 1      -0.98
cfp 10       1.92       ivol 1          -3.16       mom12 1          -2.70       prof 1         -1.51
mom12 1      1.88       price 1         -3.21       mom 1            -2.71       Aturnover 1    -1.89

Note: Portfolio composition of second to ﬁfth proxy factors based on 𝑁 = 74 extreme deciles. The port-
folio weights of the proxy factors are the 8 largest loadings of the latent factors. RP-weight 𝛾 = 10
                                                 Table 7


                                  Proxy factors              37 Long-short factors
                               RP-PCA           PCA          RP-PCA            PCA

                                                 𝑁 = 74

                 1.GC            1.00           1.00          1.00             1.00
                 2.GC            0.99           0.99          1.00             1.00
                 3.GC            0.95           0.97          1.00             1.00
                 4.GC            0.95           0.94          0.99             0.99
                 5.GC            0.71           0.86          0.65             0.65

                                                𝑁 = 370

                 1.GC            1.00           1.00          0.99             0.99
                 2.GC            0.99           0.99          0.99             0.99
                 3.GC            0.98           0.99          0.98             0.98
                 4.GC            0.94           0.94          0.93             0.91
                 5.GC            0.77           0.89          0.64             0.64

Note: Top: First and last decile of 37 single-sorted portfolios (𝑁 = 74): Bottom: Deciles of 37 single-
sorted portfolios (𝑁 = 370): Generalized correlations of statistical factors with proxy factor (portfolios
of 8 assets for 𝑁 = 74 and portfolios of 10% of assets for 𝑁 = 370) and 37 long-short anomaly factors.
𝐾 = 5 statistical factors and RP-weight 𝛾 = 10
          Figure 1: Weak Factors – Correlation of estimated Factor with the true Factor

                                         Panel A: Low Factor Variance

                                                                      2
                                                 Statistical Model    F
                                                                        =0.05
                            1



                           0.8



                           0.6
                   Corr




                           0.4


                                                                                     SR=0.6
                           0.2                                                       SR=0.3
                                                                                     SR=0.1
                                                                                     SR=0
                            0
                                 0   5      10       15      20         25      30   35       40




                                         Panel B: High Factor Variance

                                                                      2
                                                  Statistical Model   F
                                                                        =0.1
                             1



                           0.8



                           0.6
                    Corr




                           0.4


                                                                                     SR=0.6
                           0.2                                                       SR=0.3
                                                                                     SR=0.1
                                                                                     SR=0
                             0
                                 0   5      10       15      20         25      30   35       40



Note: This plot shows 𝜏𝑘 (𝛾) as a function of 𝛾 for diﬀerent parameter settings (𝑁 = 370 and 𝑇 = 650).
                                      Figure 2: Simulation - First Factor

                                     Panel A: Correlation with True Factor

                                              Correlation 1. Factor
                               1

                              0.8

                              0.6
                       Corr




                              0.4
                                                                       SR=0.6
                              0.2                                      SR=0.3
                                                                       SR=0.1
                               0
                                     0          5           10       15         20



                                                    Panel B: SR

                                                     SR 1. Factor
                              0.15



                               0.1
                       SR




                              0.05                                    SR=0.6
                                                                      SR=0.3
                                                                      SR=0.1
                                0
                                      0          5          10       15         20


Note: Correlations and Sharpe-ratios as a function of 𝛾 for diﬀerent variances and Sharpe ratios for the
ﬁrst (strong) factor.
                                                        Figure 3: Simulation - Second Factor

                     Correlation 2F =0.05                                   Correlation 2F =0.1                                 Correlation 2F =0.5
        1                                                        1                                                   1
Corr




                                                         Corr




                                                                                                             Corr
       0.5                                                      0.5                                                 0.5
                                                                                                                                                   SR=0.6
                                                                                                                                                   SR=0.3
                                                                                                                                                   SR=0.1
        0                                                        0                                                   0
              0        5        10       15        20                 0       5       10       15       20                0       5       10       15       20


                           SR 2F =0.05                                            SR 2F =0.1                                          SR 2F =0.5
       0.6                                                      0.6                                                 0.6


       0.4                                                      0.4                                                 0.4
SR




                                                         SR




                                                                                                             SR
       0.2                                                      0.2                                                 0.2


        0                                                        0                                                   0
              0        5        10       15        20                 0       5       10       15       20                0       5       10       15       20

                                         2                                                     2                                                   2
                  Normalized RMSE        F
                                           =0.05                          Normalized RMSE      F
                                                                                                 =0.1                         Normalized RMSE      F
                                                                                                                                                     =0.5


        2                                                        2                                                   2
RMSE




                                                         RMSE




                                                                                                             RMSE




       1.5                                                      1.5                                                 1.5



        1                                                        1                                                   1
              0        5        10       15        20                 0       5       10       15       20                0       5       10       15       20



             Note: Out-of-sample correlations, Sharpe-ratios and normalized RMSE for the second (weak) factor as a
             function of 𝛾 for diﬀerent variances and Sharpe ratios.
                                               Figure 4: Simulation - Factor realizations

                                   1. Factor                                                   2. Factor
400                                                                      150
                     True factor
300                  RP-PCA =0
                     RP-PCA =10                                          100
                     RP-PCA =20
200                  PCA
                                                                          50
100

                                                                           0
  0


-100                                                                     -50
       0       100       200       300   400    500   600    700               0   100   200   300   400   500   600   700
                                     Time                                                        Time

           Note: Sample path of one representative simulation for the true factor as well as estimated factors for
           diﬀerent values of 𝛾.
                     Figure 5: RP-PCA vs. PCA Fit for Size/Accrual Portfolios




Note: Size and Accrual: Maximal Sharpe-ratios, root-mean-squared pricing errors and unexplained id-
iosyncratic variation for diﬀerent values of 𝛾.
                Figure 6: Heatmap of Factor Loadings for Size/Accrual Portfolios




Note: Size and Accrual: Heatmap of loadings. 𝐾 = 3 statistical factors and RP- weight 𝛾 = 10.
                   Figure 7: RP-PCA vs. PCA Fit for Size/ST Reversal Portfolios




Note: Size and short-term reversal: Maximal Sharpe-ratios, root-mean-squared pricing errors and unex-
plained idiosyncratic variation for diﬀerent values of 𝛾.
              Figure 8: Heatmap of Factor Loadings for Size/ST Reversal Portfolios




Note: Size and short-term reversal: Heatmap of loadings. 𝐾 = 3 statistical factors and RP- weight 𝛾 =
20.
                                           Figure 9: Eigenvalue Diﬀerences for Single-sorted Portfolios


                                                                   Panel A: 𝑁 = 74

                                                              Eigenvalue Differences
                                           1.2
                                                                                              =-1
                                            1                                                 =0
                Eigenvalue Difference

                                                                                              =5
                                                                                              =10
                                           0.8
                                                                                              =20
                                                                                             Critical value
                                           0.6

                                           0.4

                                           0.2

                                            0
                                                 2      4      6         8       10     12        14          16
                                                                       Number

                                                                Panel B: 𝑁 = 370

                                                               Eigenvalue Differences
                                             3
                                                                                              =-1
                                           2.5                                                =0
                   Eigenvalue Difference




                                                                                              =5
                                                                                              =10
                                             2
                                                                                              =20
                                                                                             Critical value
                                           1.5

                                             1

                                           0.5

                                             0
                                                 2      4       6        8       10     12        14          16
                                                                        Number

                                                                1
Note: Diﬀerences of consecutive eigenvalues of the matrix ( 𝑇 X⊤ X + 𝛾X̄ X̄ ⊤ ) for diﬀerent RP-weights 𝛾.
The red line indicates the critical value of the Onatski-test. Top panel: First and last decile of 37 single-
sorted portfolios (𝑁 = 74). Bottom panel: Deciles of 37 single-sorted portfolios (𝑁 = 370).
                                    Figure 10: RP-PCA vs. PCA Fit for Single-sorted Portfolios

                             SR (In-sample)                                                        SR (Out-of-sample)
 0.7                                                         1 factor
                                                                          0.7
                                                             2 factors
 0.6                                                         3 factors    0.6
                                                             4 factors
 0.5                                                         5 factors    0.5
                                                             6 factors
 0.4                                                                      0.4

 0.3                                                                      0.3

 0.2                                                                      0.2

 0.1                                                                      0.1

  0                                                                        0
       RP-PCA (N=74)   PCA (N=74)     RP-PCA (N=370)     PCA (N=370)            RP-PCA (N=74)   PCA (N=74)    RP-PCA (N=370)    PCA (N=370)




                          RMS       (In-sample)                                                  RMS     (Out-of-sample)

0.35                                                                     0.35

 0.3                                                                      0.3

0.25                                                                     0.25

 0.2                                                                      0.2

0.15                                                                     0.15

 0.1                                                                      0.1

0.05                                                                     0.05

  0                                                                        0
       RP-PCA (N=74)   PCA (N=74)     RP-PCA (N=370)     PCA (N=370)            RP-PCA (N=74)   PCA (N=74)    RP-PCA (N=370)    PCA (N=370)




                   Idiosyncratic Variation (In-sample)                                    Idiosyncratic Variation (Out-of-sample)

 30                                                                       30

 25                                                                       25

 20                                                                       20

 15                                                                       15

 10                                                                       10

  5                                                                        5

  0                                                                        0
       RP-PCA (N=74)   PCA (N=74)     RP-PCA (N=370)     PCA (N=370)            RP-PCA (N=74)   PCA (N=74)    RP-PCA (N=370)    PCA (N=370)



       Note: Maximal Sharpe-ratios, root-mean-squared pricing errors and unexplained idiosyncratic variation
       for diﬀerent number of factors. RP-weight 𝛾 = 10, extreme deciles (𝑁 = 74) or all deciles (𝑁 = 370).
                                                                                                               in                                                             in                                                                            in                                                                              in




                                                                                                                                 0
                                                                                                                                                                                                0
                                                                                                                                                                                                                                                                                    0
                                                                                                                                                                                                                                                                                                                                                                 0




                                                                                                                                     0.1
                                                                                                                                           0.2
                                                                                                                                                     0.3
                                                                                                                                                                                                    0.1
                                                                                                                                                                                                          0.2
                                                                                                                                                                                                                0.3
                                                                                                                                                                                                                          0.4
                                                                                                                                                                                                                                                                                        0.1
                                                                                                                                                                                                                                                                                              0.2
                                                                                                                                                                                                                                                                                                    0.3
                                                                                                                                                                                                                                                                                                          0.4
                                                                                                                                                                                                                                                                                                                   0.5
                                                                                                                                                                                                                                                                                                                                                                     0.2
                                                                                                                                                                                                                                                                                                                                                                           0.4
                                                                                                                                                                                                                                                                                                                                                                                    0.6
                                                                                                                  d                                                              dr                                                                            dr                                                                              dr
                                                                                                            in rre                                                         in       r                                                                    in       r                                                                      in       r
                                                                                                              dm vl                                                          dm evl                                                                        dm evl                                                                          dm evl
                                                                                                                  om v                                                           om v                                                                          om v                                                                            om v
                                                                                                                       re                                                              re                                                                            re                                                                              re
                                                                                                                 in v                                                           in v                                                                          in v                                                                            in v
                                                                                                                    dr                                                             dr                                                                            dr                                                                              dr
                                                                                                                       re                                                              re                                                                            re                                                                              re
                                                                                                                 se v                                                           se v                                                                          se v                                                                            se v
                                                                                                                    as                                                             as                                                                            as                                                                              as
                                                                                                                        o                                                                o                                                                             o                                                                               o
                                                                                                                 va n                                                           va n                                                                          va n                                                                            va n
                                                                                                                     lp                                                             lp                                                                            lp                                                                              lp
                                                                                                                        ro                                                              ro                                                                            ro                                                                              ro
                                                                                                                m          f                                                   m           f                                                                 m           f                                                                   m           f
                                                                                                           va om                                                           va om                                                                         va om                                                                           va om
                                                                                                              lm 1                                                           lm 1                                                                          lm 1                                                                            lm 1
                                                                                                                 om 2                                                           om 2                                                                          om 2                                                                            om 2
                                                                                                                      pr                                                             pr                                                                            pr                                                                              pr
                                                                                                                         of                                                              of                                                                            of                                                                              of
                                                                                                                       in                                                               in                                                                            in                                                                              in
                                                                                                                          v                                                                v                                                                             v                                                                               v
                                                                                                                     ci                                                               ci                                                                            ci                                                                              ci
                                                                                                                 ig s   s                                                      ig s      s                                                                   ig s      s                                                                     ig s      s
                                                                                                                   ro                                                             ro                                                                            ro                                                                              ro
                                                                                                                      w                                                               w                                                                             w                                                                               w
                                                                                                                        th                                                               th                                                                            th                                                                              th

                                                                                                                            sp                                                             sp                                                                              sp                                                                              sp

                                                                                                                        ep                                                                e                                                                                ep                                                                         e
                                                                                                                 ac                                                                ac p                                                                          Ac                                                                           Ac p
                                                                                                                    cr                                                                cr                                                                            cr                                                                            cr
                                                                                                                       ua                                                                ua                                                                                ua                                                                        ua




sample for 6 RP-PCA and PCA factors.
                                                                                                                          l                                                                 l                                                                                   l                                                                        l
                                                                                                                    va                                                                va                                                                            va                                                                            va
                                                                                                                       lu                                                                lu                                                                                lu                                                                        lu
                                                                                                                          e                                                                 e                                                                          e                                                                                e
                                                                                                              at pro                                                            at pro                                                                      At     pr                                                                       At pro
                                                                                                                ur        f                                                       ur        f                                                                  ur     of                                                                      ur        f
                                                                                                                   no                                                               no                                                                           no                                                                              no
                                                                                                                      ve                                                                ve                                                                          v                                                                               ve
                                                                                                                va        r                                                       va        r                                                                  va er                                                                         va         r
                                                                                                                   lm                                                                lm                                                                          lm                                                                              lm
                                                                                                                      om                                                                om                                                                          om                                                                              om




                                                                                                                                                           RMS
                                                                                                                                                                                                                                                                                                                         RMS




                                                                                                                       c                                                                c                                                                                                                                                             c




                                                                                                                                                                                                                                RMS
                                                                                                                                                                                                                                                                                                                                                                                          RMS




                                                                                                                                                                                                                                                                      cf
                                                                                                                m fp                                                             m fp                                                                          m         p                                                                     m fp
                                                                                                                   om                                                               om                                                                            om                                                                              om
                                                                                                                       re                                                               re                                                                            re                                                                              re
                                                                                                                  gr v                                                             gr v                                                                          gr v                                                                            gr v
                                                                                                                    ow                                                               ow                                                                            ow                                                                              ow
                                                                                                                                                                                                                                                                                                                                                                                                      A: 𝑁 = 74




                                                                                                                                                                                                                                            B: 𝑁 = 370
                                                                                                                         th                                                               th                                                                            th                                                                              th
                                                                                                                     lrr                                                              lrr                                                                           lrr                                                                             lrr
                                                                                                                         e                                                               e                                                                              e                                                                               e




                                                                                                                                                                                                                                In-Sample
                                                                                                                                                                                                                                                                                                                                                                                          In-Sample




                                                                                                                in                                                               in                                                                            in                                                                              in
                                                                                                                   dm v                                                             dm v                                                                          dm v                                                                            dm v




                                                                                                                                                           Out-Of-Sample
                                                                                                                                                                                                                                                                                                                         Out-Of-Sample




                                                                                                                       om                                                               om                                                                            om                                                                              om

                                                                                                                     iv                                                                iv                                                                            iv                                                                             iv
                                                                                                                 va ol                                                             va ol                                                                         va ol                                                                          va ol
                                                                                                                   lu                                                                lu                                                                            lu                                                                             lu
                                                                                                                      em                                                                em                                                                            em                                                                             em
                                                                                                                       st                                                            st                                                                               st                                                                              st
                                                                                                                         re                                                             re                                                                              re                                                                              re
                                                                                                                             v                                                             v                                                                                    v                                                                           v
                                                                                                                     si                                                               si                                                                               si                                                                              si
                                                                                                                       ze                                                                ze                                                                                 ze                                                                             ze
                                                                                                                    m                                                                m                                                                              m                                                                              m
                                                                                                                      om                                                                om                                                                             om                                                                              om
                                                                                                                                                                                                                                                                                                                                                                                                                  Figure 11: RMS of Time-series 𝛼’s by Characteristic




                                                                                                                    ro                                                                ro                                                                              ro                                                                              ro
                                                                                                                       aa                                                                  aa                                                                            a      a                                                                          aa
                                                                                                                         le                                                              le                                                                                le                                                                              le
                                                                                                                            v                                                               v                                                                                   v                                                                            v
                                                                                                                       di                                                             di                                                                              di                                                                              di
                                                                                                                         vp                                                             vp                                                                                 vp                                                                              vp
                                                                                                                       no                                                             no                                                                               no                                                                              no
                                                                                                                  in      a                                                       in a                                                                           in         a                                                                    in         a
                                                                                                                      vc                                                            vc                                                                                vc                                                                           vc
                                                                                                                        ap                                                              ap                                                                                 ap                                                                              ap
                                                                                                                   r                                                                 ro                                                                            r                                                                               r
                                                                                                              gm oea                                                            gm ea                                                                         gm oea                                                                          gm oea
                                                                                                                 ar                                                                ar                                                                            ar                                                                              ar
                                                                                                                    gi                                                                gi                                                                           gi                                                                               gi
                                                                                                                      ns                                                                ns                                                                            ns                                                                               ns
                                                                                                                  sh                                                                sh                                                                            sh                                                                              sh




37 single-sorted portfolios (𝑁 = 370 and 𝑇 = 638). Root-mean-squared pricing errors in- and out-of-
                                                                                                                     vo                                                                vo                                                                            vo                                                                              vo
                                                                                                                         l                                                                 l                                                                            l                                                                                l




Note: Top: First and last decile of 37 single-sorted portfolios (𝑁 = 74 and 𝑇 = 638). Bottom: Deciles of
                                                                                                                  pr                                                                pr                                                                            pr                                                                              pr

                                                                                                                                                 PCA
                                                                                                                                                                                                                      PCA
                                                                                                                                                                                                                                                                                                          PCA
                                                                                                                                                                                                                                                                                                                                                                                 PCA




                                                                                                               sg ice                                                            sg ice                                                                        sg ice                                                                          sg ice
                                                                                                                 ro                              RP-PCA                            ro                                                                            ro                                                                              ro
                                                                                                                                                                                                                      RP-PCA
                                                                                                                                                                                                                                                                                                          RP-PCA
                                                                                                                                                                                                                                                                                                                                                                                 RP-PCA




                                                                                                                    w                                                                 w                                                                             w                                                                               w
                                                                                                                       th                                                                th                                                                           th                                                                               th
                                                                                                                                    0.3
                                                                                                                                              0.2
                                                                                                                                                    0.1
                                                                                                                                                          0.0
                                                                                                                                                                0.1
                                                                                                                                                                      0.2
                                                                                                                                                                            0.3
                                                                                                                                                                                                                        0.3
                                                                                                                                                                                                                                    0.2
                                                                                                                                                                                                                                          0.1
                                                                                                                                                                                                                                                0.0
                                                                                                                                                                                                                                                      0.1
                                                                                                                                                                                                                                                            0.2
                                                                                                               ind                                                                                   ind
                                                                                                                    r                                                                                     r
                                                                                                            ind revlv                                                                             ind revlv
                                                                                                                mom                                                                                   mom
                                                                                                                  ind rev                                                                               ind rev
                                                                                                                       rr                                                                                    rr
                                                                                                                  sea ev                                                                                sea ev
                                                                                                                        s                                                                                     s
                                                                                                                  valp on                                                                               valp on
                                                                                                                          r                                                                                     r
                                                                                                                  mom of                                                                                mom of
                                                                                                           valm 12                                                                               valm 12
                                                                                                                  omp                                                                                   omp
                                                                                                                         irnovf                                                                                irnovf
                                                                                                                        cis                                                                                   cis
                                                                                                                 igro s                                                                                igro s
                                                                                                                        wth                                                                                   wth
                                                                                                                           sp                                                                                    sp
                                                                                                                           ep                                                                                    ep
                                                                                                                acc                                                                                   acc
                                                                                                                      rua                                                                                   rua
                                                                                                                     valuls                                                                                valuls
                                                                                                                             e                                                                                     e
                                                                                                                       pro                                                                                   pro
                                                                                                              atu             f                                                                     atu             f
                                                                                                                   rno                                                                                   rno
                                                                                                                valm er  v                                                                            valm er  v
                                                                                                                         om                                                                                    om
                                                                                                                         cfp                                                                                   cfp
                                                                                                                mom                                                                                   mom
                                                                                                                         r                                                                                     r
                                                                                                                  gro ev                                                                                gro ev
                                                                                                                        wth                                                                                   wth




                                                                                                                                                                                  Panel B: PCA
                                                                                                                      lrre                                                                                  lrre
                                                                                                                                                                                                                                                                  Panel A: RP-PCA




                                                                                                                ind v                                                                                 ind v




portfolios. The anomalies on the 𝑥-axis are sorted by their SR.
                                                                                                                      mom                                                                                   mom
                                                                                                                        ivo                                                                                   ivo
                                                                                                                  valu l                                                                                valu l
                                                                                                                         em                                                                                    em
                                                                                                                     stre                                                                                  stre
                                                                                                                             v                                                                                     v
                                                                                                                        size                                                                                  size
                                                                                                                      mom                                                                                   mom
                                                                                                                       roa                                                                                   roa
                                                                                                                             a                                                                                     a
                                                                                                                                                                                                                                                                                    Figure 12: Portfolio Weights in RP-PCA and PCA SDFs




                                                                                                                         lev                                                                                   lev
                                                                                                                       divp                                                                                  divp
                                                                                                                        noa                                                                                   noa
                                                                                                                   invc                                                                                  invc
                                                                                                                           ap                                                                                    ap
                                                                                                                       roe                                                                                   roe
                                                                                                                sgr a                                                                                 sgr a
                                                                                                                      o                                                                                     o
                                                                                                              gm wth                                                                                gm wth
                                                                                                                   arg                                                                                   arg
                                                                                                                          i                                                                                     i
                                                                                                                     princ s                                                                               princ s
                                                                                                                             e                                                                                     e
                                                                                                                     shv                                                                                   shv




Note: Portfolio loadings of SDF estimated by RP-PCA and PCA for ﬁrst and last decile of 37 single-sorted
                                                                                                                            ol                                                                                    ol
                                                                                                                                  Decile 1
                                                                                                                                                                                                                        Decile 1




                                                                                                                                  Decile 10
                                                                                                                                                                                                                        Decile 10
                                                                   Figure 13a: Heatmap of Factor Loadings

                                                                                 Factor 1 (sorted by Category)
RP-PCA10 5.0 5.7 3.5 4.9 5.0 5.6 4.8 5.4 5.3 5.4 5.8 4.7 5.8 6.3 6.0 5.0 7.1 5.6 5.2 4.1 5.5 5.0 4.7 4.4 4.3 4.4 5.1 4.2 4.7 5.4 3.1 5.4 4.0 5.1 3.9 5.9 3.1
   PCA10 4.6 5.5 3.1 4.5 4.7 5.2 4.4 4.7 4.8 5.1 5.3 4.4 5.6 6.5 5.8 4.1 6.8 4.8 4.9 3.9 5.5 4.9 4.8 4.1 4.2 4.3 5.1 4.2 4.5 5.3 2.9 5.4 3.6 5.0 3.9 5.5 2.9

 RP-PCA1 4.5 4.6 5.0 5.6 4.8 4.4 4.9 5.0 4.6 6.0 5.5 5.1 5.2 4.4 5.2 3.5 4.6 3.4 5.1 5.7 5.4 5.4 5.5 3.7 5.6 6.0 4.7 4.9 3.6 3.9 6.5 5.3 5.0 4.5 6.6 4.6 6.5
    PCA1 4.6 4.6 5.2 6.1 5.0 4.6 5.2 5.4 5.0 6.2 6.6 5.4 5.4 4.8 5.5 4.0 5.2 4.0 5.4 6.0 5.8 5.7 5.7 3.8 6.1 6.4 5.1 5.0 3.8 3.9 7.6 5.7 5.4 4.6 7.0 5.0 7.0
               valu e
                      em
                    divp
                       ep
                      cfp
                       sp
        valm om




              igro p




           atu gins
               valprof
                  momf

             ind 12
                  mom
                         v




             acc l
                    cisss


                         e
             mom v
         ind rev
               ind rev
            ind ev
                        lv
                      inv


               gro th
             sgr th
                         h
                          f
                         a
                         a
                    noa


                    sizer




                      lev

                     son
                        ol
                     ivo
                      ro




                    pro




                      ve



                        l
                   lrre
                  stre




                   roa
                   roe
                  valu




                  pric
                  owt
                       a




                  rua
                 rrev




                  shv
                    w
                    w
                    rr


                invc
               mom
               omp
             valm




             mom




                rno




               sea
                ar
           gm
                                                                                 Factor 2 (sorted by Category)
RP-PCA10 1.3 0.5 1.5 1.2 1.1 1.0 1.2 1.0 1.0 0.3 0.3 0.6 0.6 -0.8 0.2 1.3 -0.3 1.1 0.4 0.7 -0.3 0.2 -0.1 -0.2 -0.7 -0.5 -0.8 -0.8 0.0 0.1 0.4 -0.7 0.9 0.8 -0.4 -0.1 0.4
   PCA10 2.2 2.9 2.3 1.5 1.9 2.0 0.8 0.1 1.4 -1.0 -1.1 -0.5 2.1 0.7 1.3 -0.1 0.6 0.5 0.6 1.0 0.3 0.9 0.9 -1.2 -1.3 -1.0 -1.1 -1.4 -0.2 1.5 -0.1 -0.6 0.7 1.7 -1.1 -0.5 0.4

 RP-PCA1 -1.2 -1.0 -1.0 -1.5 -1.3 -1.2 -1.4 -1.3 -1.1 -1.2 -2.3 -1.2 -1.2 -0.9 -1.2 -0.8 -1.4 -0.8 -1.1 -1.7 -1.5 -1.5 -1.2 -0.1 -1.2 -0.9 -1.2 -0.2 -0.5 -0.3 -2.5 -1.4 -0.9 -1.2 -1.1 -0.8 -1.7
    PCA1 -1.7 -1.8 -1.0 -0.4 -1.6 -1.5 -0.3 0.2 -0.5 1.2 1.9 0.9 -1.4 -0.3 -1.1 0.5 -0.2 -0.3 -0.6 -1.6 -0.7 -1.0 -1.1 0.4 0.3 0.7 -0.1 0.5 0.1 -0.6 0.8 -0.5 0.1 -1.7 2.5 0.5 -0.7
               valu e
                      em
                    divp
                       ep
                      cfp
                       sp
        valm om




              igro p
               valprof
                  momf

             ind 12
                  mom
                         v




               gro th
             sgr th




                    cisss
             mom v
         ind rev
               ind rev
            ind ev
                        lv
                      inv




                         h
                          f
                         a
                         a
                    noa

           atu gins



             acc l
                    sizer




                      lev
                         e
                     son
                        ol
                     ivo
                      ro




                    pro




                      ve



                        l
                   lrre
                  stre




                   roa
                   roe
                  valu




                  pric
                  owt
                       a




                  rua
                 rrev




                  shv
                    w
                    w
                    rr


                invc
               mom
               omp
             valm




             mom




                rno




               sea
                ar
           gm
                                                                                 Factor 3 (sorted by Category)
RP-PCA10 -0.5 -2.3 -0.3 0.2 -0.4 -0.6 1.0 1.5 -0.0 2.0 2.0 1.8 -1.2 -1.2 -0.8 1.9 -0.6 1.0 0.3 0.2 -0.2 -0.2 -0.6 1.5 1.1 1.1 0.8 1.1 0.7 -1.1 1.0 0.3 0.6 -0.4 1.2 0.8 0.4
   PCA10 0.4 -0.8 1.7 1.1 0.8 0.1 0.5 -0.2 -0.1 0.1 -0.2 0.5 -1.1 -0.9 -0.9 1.3 -1.3 0.8 0.1 1.0 -0.8 0.0 -0.0 0.6 0.4 0.7 -0.3 0.2 0.5 -1.8 1.7 -0.6 1.2 1.4 0.8 -0.2 1.3

 RP-PCA1 1.0 1.4 0.6 -0.7 0.7 0.8 -0.8 -1.2 -0.1 -2.3 -4.0 -1.9 0.7 -0.1 0.4 -0.8 -0.6 0.1 0.1 0.3 -0.4 0.1 0.4 -0.1 -1.1 -1.2 -0.5 -0.2 -0.2 0.7 -2.9 -0.5 -0.4 1.0 -3.5 -0.8 -0.5
    PCA1 0.2 0.2 0.3 -1.3 0.0 0.1 -0.3 -0.2 0.3 -1.1 -1.7 -0.5 0.0 -0.3 -0.4 0.9 -0.7 1.1 -0.1 -1.5 -1.0 -0.6 -0.8 0.7 -1.5 -1.6 -0.2 -0.3 0.5 1.0 -3.2 -0.8 0.1 0.0 -3.2 -0.3 -1.9
               valu e
                      em
                    divp
                       ep
                      cfp
                       sp
        valm om




              igro p
               valprof
                  momf

             ind 12
                  mom
                         v




            ind ev
             mom v
         ind rev
               ind rev

                        lv
                      inv


               gro th
             sgr th
                         h
                          f
                         a
                         a
                    noa

           atu gins



             acc l
                    cisss
                    sizer




                      lev
                         e
                     son
                        ol
                     ivo
                      ro




                    pro




                      ve



                        l
                   lrre
                  stre




                   roa
                   roe
                  valu




                  pric
                  owt
                       a




                  rua
                 rrev




                  shv
                    w
                    w
                    rr


                invc
               mom
               omp
             valm




             mom




                rno




               sea
                ar
           gm
                                                           Figure 13b: Heatmap of Factor Loadings, contd.

                                                                              Factor 4 (sorted by Category)
RP-PCA10 0.2 -0.7 -1.1 -0.3 -0.1 0.3 1.4 1.9 0.6 1.8 1.8 1.6 1.2 -0.2 0.8 -0.2 0.6 -0.6 0.4 -0.5 0.9 0.4 0.1 -0.5 -0.5 -0.7 0.2 -0.5 -0.4 2.1 -1.2 0.5 -0.7 -1.2 -0.4 0.3 -1.1
   PCA10 0.5 -1.7 -0.0 0.4 0.4 0.3 2.2 2.1 0.5 2.4 2.1 2.4 0.5 -1.1 0.2 0.7 -0.5 -0.3 0.5 0.2 0.6 0.4 0.1 -0.2 -0.4 -0.4 -0.0 -0.4 -0.2 1.2 -0.3 0.1 -0.0 -0.5 0.2 0.1 -0.4

 RP-PCA1 -0.6 -0.1 -0.5 1.0 -0.4 -0.5 -1.4 -1.4 -0.6 -1.4 -1.2 -1.5 -0.2 0.8 0.5 -1.6 1.0 -0.6 -0.1 0.8 0.6 0.2 0.6 -0.6 1.1 1.5 -0.2 0.8 -0.6 -1.0 2.1 0.4 -0.4 -0.4 1.7 0.4 1.7
    PCA1 -0.6 -0.0 -0.5 0.3 -0.5 -0.5 -2.1 -1.9 -0.4 -2.7 -2.7 -2.4 -0.2 0.9 0.4 -1.2 0.9 0.3 -0.1 -0.2 0.1 -0.2 0.1 -0.1 0.3 0.7 -0.4 0.8 -0.4 -0.5 0.3 -0.1 -0.3 -0.5 -0.5 0.4 0.7
               valu e
                      em
                    divp
                       ep
                      cfp
                       sp
        valm om




              igro p
               valprof
                  momf

             ind 12
                  mom
                         v




               gro th
             sgr th
             mom v
         ind rev
               ind rev
            ind ev
                        lv
                      inv




                         h
                          f
                         a
                         a
                    noa

           atu gins



             acc l
                    cisss
                    sizer




                      lev
                         e
                     son
                        ol
                     ivo
                      ro




                    pro




                      ve



                        l
                   lrre
                  stre




                   roa
                   roe
                  valu




                  pric
                  owt
                       a




                  rua
                 rrev




                  shv
                    w
                    w
                    rr


                invc
               mom
               omp
             valm




             mom




                rno




               sea
                ar
           gm
                                                                                  Factor 5 (sorted by SR)
RP-PCA10 1.3 0.6 1.4 0.7 1.2 -0.0 0.6 0.4 0.4 0.3 1.0 0.5 0.2 0.8 0.6 0.6 -0.1 0.5 1.0 0.2 1.3 -0.6 -0.1 1.9 1.0 0.9 -0.5 0.3 0.4 0.3 0.2 0.0 0.2 0.1 0.1 -0.4 0.0
   PCA10 0.2 -0.2 -0.0 -0.1 1.2 -0.0 0.6 0.0 -0.1 -0.1 0.9 0.4 -0.4 0.0 1.0 1.1 -0.1 0.1 0.4 -0.1 0.9 -0.1 -0.1 -0.1 0.2 0.9 -0.1 0.5 0.7 0.0 0.1 -0.5 0.6 -0.5 0.0 -0.2 -0.0

 RP-PCA1 -1.3 -0.4 -1.4 -0.6 -0.8 0.3 0.1 -0.3 -0.4 -0.3 -0.1 -0.4 -0.1 -0.0 -0.5 -0.7 0.5 -0.1 -0.6 -0.3 -0.3 0.8 -0.5 -0.1 -1.2 -0.2 1.2 -0.2 0.1 -0.1 -0.4 0.3 -0.0 -0.1 -0.2 1.3 -0.3
    PCA1 -0.0 0.3 -0.5 0.1 -1.0 -0.1 -0.7 0.1 0.0 -0.3 -0.0 -0.3 0.5 0.4 -1.5 -1.9 0.2 0.3 -0.3 -0.0 0.1 0.1 -0.5 0.3 -0.5 -0.2 -0.0 -0.7 0.4 0.5 -0.5 0.1 -0.6 -0.2 -0.3 0.3 -0.1
        ind revlv




                 valuls
              ind rev
              sea v




                     cfp
              valp n
              mom of
       valm 12

                     inovf
                    ciss
                    wth
                       sp
                      ep


                        e
                         f

                     om
            valmver


              gro ev
                    wth
            ind v
                  mom
                    ivol
                     em


                  mom
                        a
                     lev
                   divp
                    noa
                      ap
                        v
                    size




            sgr a
          gm wth
                 pric s
                        e
                       ol
                   pro




                     in
                   rre




                  lrre




                 stre


                   roa




                   roe
                    so




                  rua




                 shv
                     r

                     r




                     r




               invc
              omp




               arg
              valu
            mom




               rno


            mom
             igro




                  o
                r




            acc
           ind




          atu



    Note: Heatmaps of portfolio weights in six factors for ﬁrst and last decile of 37 single-sorted portfolios (𝑁 = 74).
                                                                Figure 14: Heatmap of Factor Loadings, 𝑁 = 370

                                                                                           Panel A: RP-PCA
                 1.7 1.2 1.3 1.0 1.5 0.9 1.4 0.3 0.3 0.1 0.8 0.3 0.1 0.4 1.6 1.1 -0.0 0.0 0.8 -0.0 1.1 -0.0 0.1 0.9 0.5 0.7 0.3 0.9 0.2 -0.0 0.7 -0.4 0.7 0.6 -0.0 -0.1 -0.6
            10
                 1.5 0.7 1.4 0.4 1.1 0.0 0.9 0.3 0.2 0.2 0.5 0.2 0.6 -0.1 1.1 1.0 -0.5 0.2 0.3 0.2 0.4 0.2 0.1 0.7 1.0 0.5 -0.2 0.2 -0.0 -0.2 0.3 -0.3 0.5 -0.1 0.1 -0.1 -0.1
            9

                 1.0 0.4 0.9 0.1 1.0 0.1 0.4 0.2 -0.0 0.1 0.5 0.2 -0.1 -0.3 0.7 0.1 -0.5 -0.2 0.4 -0.1 0.4 -0.2 0.1 -0.2 0.8 0.5 -0.4 0.0 -0.2 -0.3 0.3 -0.1 0.2 0.1 0.0 -0.1 -0.1
            8



                 0.5 0.2 0.5 0.1 0.7 -0.2 0.2 0.2 -0.0 0.3 -0.0 0.0 -0.0 -0.3 0.0 0.2 -0.3 -0.6 0.1 -0.1 0.1 0.0 -0.0 -0.2 0.4 0.4 -0.2 -0.5 -0.3 0.0 0.1 -0.3 -0.3 -0.1 0.1 -0.2 -0.3
            7




                 0.1 0.2 0.2 -0.1 0.7 -0.2 -0.3 -0.0 0.2 0.0 -0.1 -0.2 -0.1 -0.6 -0.2 0.3 0.0 -0.3 0.4 -0.1 0.1 0.6 0.1 -0.7 0.2 0.3 0.0 -0.5 -0.6 0.1 0.0 -0.1 -0.5 -0.5 -0.2 0.2 0.3
            6




                 -0.1 0.1 -0.1 0.0 0.7 -0.1 0.0 0.2 0.3 -0.0 -0.1 -0.3 0.1 -0.6 -0.5 0.3 0.2 -0.2 -0.0 -0.1 -0.0 0.2 0.2 -0.5 0.0 0.2 0.1 -0.5 -0.7 -0.2 0.1 0.0 -0.6 -0.3 0.1 0.2 0.5
            5




                 -0.2 -0.3 -0.4 -0.4 -0.0 -0.0 -0.0 -0.1 -0.0 -0.2 -0.1 -0.1 0.1 -0.8 -1.0 0.2 0.3 -0.1 -0.2 0.1 -0.0 -0.1 -0.1 -0.7 -0.3 0.1 0.3 -0.5 -0.2 -0.2 -0.7 0.3 -0.5 -0.4 -0.2 0.5 0.1
            4




                 -0.6 -0.1 -0.8 -0.3 -0.7 0.0 -0.0 0.2 -0.1 0.1 -0.4 0.0 0.1 0.0 -1.2 -0.2 0.3 -0.2 -0.0 0.3 -0.1 0.2 0.2 -0.4 -0.3 -0.0 0.4 -0.5 -0.5 0.1 -0.0 -0.0 -0.6 -0.2 -0.3 0.3 0.3
            3




                 -0.8 -0.3 -1.1 -0.6 -0.8 -0.4 0.1 -0.2 -0.3 0.3 -0.2 -0.3 0.0 0.3 -1.2 -0.8 0.5 0.5 -0.2 0.4 -0.5 0.1 -0.3 0.0 -1.0 -0.2 0.5 -0.4 0.1 -0.1 -0.4 0.2 -0.6 -0.5 -0.1 0.3 0.0
            2




                 -1.7 -1.1 -1.9 -1.1 -1.4 -1.7 -0.7 -0.7 -0.8 -0.6 0.2 -0.7 -0.3 0.5 -0.9 -1.2 0.2 0.3 -0.7 -0.4 -0.2 -0.1 -1.7 0.5 -1.5 -0.2 0.2 -0.6 0.6 0.0 -1.1 0.7 -0.6 -0.6 -0.4 -0.1 -0.0
            1
              ind evlv
                    ind rev
                    sea v




                               e
                    valp n
                    mom f
             valm 12

                           inovf
                         ciss
                         wth
                             sp
                            ep

                       valu s

                                f
                  valmver
                           om
                           cfp

                    gro ev
                         wth
                               v
                       mom
                          ivol
                           em


                       mom
                               a
                               v
                         size



                           lev
                         divp
                         noa
                            ap
                               a
                gm h
                       pric s
                               e
                             ol
                           ro




                         pro
                              l




                           in
                         rre




                        lrre




                       stre



                        roa




                        roe
                          so




                       owt
                       rua




                       shv
                           r




                           r




                     invc
                    omp




                     arg
                    valu
                  mom




                     rno


                  mom
                   igro
                      rr




                  ind




                  sgr
                  acc
                 ind




                atu
                                                                                              Panel B: PCA
                 0.5 0.5 -0.5 -0.2 1.4 0.9 1.4 0.3 0.2 -0.1 1.2 1.3 -0.7 0.7 0.8 0.9 1.2 0.7 0.4 0.3 1.0 1.1 0.4 -1.0 -0.3 1.1 1.0 -0.0 1.9 1.1 -0.3 0.1 0.3 -0.5 0.4 -0.1 -0.3
            10




                 0.5 0.8 -0.0 -0.0 0.9 0.8 1.0 0.4 0.1 -0.2 1.3 0.9 -0.8 0.4 0.4 1.0 0.7 0.4 0.4 0.1 0.6 1.0 0.2 -0.6 -0.0 1.0 0.6 -0.2 0.9 0.5 -0.7 0.1 0.1 -0.6 0.3 -0.0 0.0
            9




                 0.2 0.7 -0.1 -0.1 0.8 0.7 0.9 0.2 0.5 0.1 1.1 0.7 -0.7 0.3 -0.2 0.0 0.4 0.4 0.4 0.1 0.7 1.0 0.4 -0.3 0.2 0.9 0.7 -0.1 0.5 0.3 0.1 -0.0 0.3 -0.6 0.1 0.1 0.1
            8




                 0.5 0.4 0.1 0.3 0.7 0.4 0.5 -0.4 0.2 -0.3 0.8 0.4 -0.2 0.1 -0.6 0.2 0.1 0.2 0.3 -0.3 0.6 0.7 0.4 -0.5 0.2 0.9 0.6 -0.1 0.2 0.1 -0.1 0.1 0.2 -0.1 0.4 -0.0 0.0
            7




                 0.2 0.5 0.1 0.2 0.4 0.3 0.3 -0.1 0.0 -0.4 0.8 0.4 -0.4 -0.2 -0.4 -0.1 -0.0 0.4 0.2 -0.1 0.5 0.6 0.5 -0.5 0.2 0.7 0.2 -0.3 0.2 0.3 -0.4 -0.1 -0.1 -0.4 0.4 0.1 -0.0
            6




                 0.5 0.4 -0.0 0.2 0.2 0.2 -0.0 -0.4 -0.1 -0.2 0.5 -0.0 0.0 -0.4 -0.5 0.3 0.1 0.2 0.4 0.1 0.3 0.4 0.1 -0.6 0.2 0.5 -0.1 -0.2 -0.1 0.6 0.1 0.3 0.1 -0.2 0.4 0.0 -0.0
            5




                 0.4 0.2 0.1 0.3 0.0 -0.2 -0.4 -0.4 -0.0 0.0 0.3 0.1 0.4 -0.2 -0.8 -0.3 0.1 0.4 0.2 0.0 0.2 -0.0 -0.2 -0.4 0.1 0.4 -0.2 0.0 -0.2 0.4 -0.4 0.2 -0.4 0.1 0.3 -0.3 -0.1
            4




                 0.4 0.1 -0.0 0.4 -0.9 -0.3 -0.6 -0.6 -0.1 -0.2 0.1 0.0 0.1 0.0 -0.9 -0.8 0.0 0.1 0.2 -0.2 0.2 0.0 -0.2 -0.3 -0.0 0.1 -0.3 0.7 -0.2 0.3 -0.3 -0.3 -0.4 0.0 0.2 -0.1 0.0
            3




                 0.1 -0.1 -0.1 0.2 -1.2 -1.0 -0.9 -0.6 0.0 -0.2 -0.2 -1.0 0.1 -0.1 -0.5 -1.2 -0.3 0.3 -0.1 -0.4 -0.0 -0.5 -0.4 -0.1 -0.1 0.1 -0.9 0.8 -0.0 0.1 -0.4 -0.4 -0.3 0.5 0.2 -0.2 -0.7
            2




                 0.5 -0.1 -0.1 0.2 -1.0 -1.7 -1.7 -0.3 0.2 -0.7 -0.6 -0.5 -0.2 -0.3 -0.7 -1.4 -1.2 -0.2 -0.5 -0.6 -0.5 -1.3 -0.8 0.0 -0.0 -0.3 -1.6 -0.5 -0.3 0.0 -0.8 -0.9 -0.4 0.2 -0.3 -0.8 -0.7
            1
              ind evlv
                    ind rev
                    sea v
                    valp n
                    mom f
             valm 12

                           inovf
                         ciss
                         wth
                             sp
                            ep

                       valu s
                               e
                                f




                               a
                  valmver
                           om
                           cfp

                    gro ev
                         wth
                               v
                       mom
                          ivol
                           em
                               v
                         size
                       mom

                           lev
                         divp
                         noa
                            ap
                               a
                gm h
                       pric s
                               e
                             ol
                           ro




                         pro
                              l




                           in
                         rre




                        lrre




                       stre



                        roa




                        roe
                          so




                       owt
                       rua




                       shv
                           r




                           r




                     invc
                    omp




                     arg
                    valu
                  mom




                     rno


                  mom
                   igro
                      rr




                  ind




                  sgr
                  acc
                 ind




                atu




Note: Heatmaps of portfolio weights RP-PCA and PCA SDFs for all decile portfolios (𝑁 = 370). The loadings are multiplied by 10.
                                     Figure 15: Loadings by Deciles


                Model
         2.0        RP-PCA
                    PCA
         1.5

         1.0

         0.5
Weight




         0.0

         0.5

         1.0

         1.5

         2.0
                1            2   3        4       5            6   7       8       9       10
                                                      Decile

          Note: The ﬁgure shows combined loadings by deciles for RP-PCA and PCA for 𝑁 = 370.
Figure 16: Generalized Correlations or RP-PCA and PCA Factors with Long-short
                                  Portfolios

                                       RP-PCA LS-Factors Correlations                                                        PCA LS-Factors Correlations
                              1                                                                                     1


                             0.8                                                                                   0.8
  Generalized Correlations




                                                                                        Generalized Correlations
                             0.6                                                                                   0.6


                             0.4                                                                                   0.4
                                                                           1. GC                                                                                  1. GC
                                                                           2. GC                                                                                  2. GC
                             0.2                                           3. GC                                   0.2                                            3. GC
                                                                           4. GC                                                                                  4. GC
                                                                           5. GC                                                                                  5. GC
                              0                                                                                     0
                                   0       5            10            15           20                                    0       5            10            15            20
                                               Number of LS-factors                                                                  Number of LS-factors


                                       RP-PCA LS-Factors Correlations                                                        PCA LS-Factors Correlations
                              1                                                                                     1


                             0.8                                                                                   0.8
  Generalized Correlations




                                                                                        Generalized Correlations



                             0.6                                                                                   0.6


                             0.4                                                                                   0.4
                                                                           1. GC                                                                                  1. GC
                                                                           2. GC                                                                                  2. GC
                             0.2                                           3. GC                                   0.2                                            3. GC
                                                                           4. GC                                                                                  4. GC
                                                                           5. GC                                                                                  5. GC
                              0                                                                                     0
                                   0      10            20            30           40                                    0   5        10      15     20          25       30
                                               Number of LS-factors                                                                  Number of LS-factors


Note: Top: First and last decile of 37 single-sorted portfolios (𝑁 = 74 and 𝑇 = 638).
Bottom: Deciles of 37 single-sorted portfolios (𝑁 = 370 and 𝑇 = 638). Generalized
correlation of 𝐾 = 5 statistical factors (𝛾 = 10) and an increasing number of long-
short anomaly factors. The ﬁrst LS-factor is the market factor and LS-factors are added
incrementally based on the largest accumulative absolute loading of the anomaly in the
portfolio weights of the statistical factors.
      Figure 17: Portfolio Weights in RP-PCA and PCA SDFs: Categories with Single
                                        Portfolios


0.2


0.1


0.0


0.1


0.2

                                                                                                               Decile 10
0.3                                                                                                            Decile 1
          lv

                  rev




                                                       ep

                                                               ls
                        son

                              rof

                                     12
                                          inv

                                                ciss




                                                                         v
                                                                             ivol

                                                                                    size

                                                                                           lev

                                                                                                 noa

                                                                                                        e

                                                                                                               ol
                                                                     lrre




                                                                                                       pric
                                                             rua
        rrev




                                                                                                              shv
                                    mom
                             valp
                 mom
                       sea




                                                            acc
       ind
             ind




0.3


0.2


0.1


0.0


0.1

                                                                                                               Decile 10
                                                                                                               Decile 1
0.2
          lv

                      rev




                      inv
                      son

                       rof

                       12


                                                ciss

                                                       ep

                                                               ls
                                                                      v
                                                                             ivol

                                                                                    size

                                                                                           lev

                                                                                                 noa

                                                                                                        e

                                                                                                                l o
                                                                     lrre




                                                                                                       pric
                                                               rua
          rrev




                                                                                                              shv
                 mom
                  valp
                 mom
                  sea




                                                            acc
       ind
             ind




 Note: The ﬁgure shows RP-PCA and PCA SDF weights for a sample with one portfolio
 per category. For each category we pick the the anomaly with the highest SR: value: ep,
 value interactions: valprof, momentum: mom12, reversal: lrrev, momentum/reversal:
 indmomrev, relative industry reversal: indrrevlv, growth: inv, proﬁtability: noa. The
 sample also includes the eight anomalies that form their own categories: size, ivol, ac-
 cruals, ciss, lev, price, season and shvol.
                                                Figure 18: Generalized Correlations of Local Loading Estimates

                                                 RP-PCA (total vs. time-varying)                                                                    RP-PCA (total vs. time-varying)
                           1                                                                                                     1




                                                                                                      Generalized Correlation
Generalized Correlation




                          0.8                                                                                                   0.8


                          0.6                                                                                                   0.6


                          0.4               1st GC
                                                                                                                                0.4            1st GC
                                            2nd GC                                                                                             2nd GC
                                            3rd GC                                                                                             3rd GC
                          0.2                                                                                                   0.2
                                            4th GC                                                                                             4th GC
                                            5th GC                                                                                             5th GC
                           0                                                                                                     0
                                0      50     100      150   200    250    300      350   400   450                                   0   50     100      150   200    250    300      350   400   450
                                                                Time                                                                                               Time

                                                     PCA (total vs. time-varying)                                                                       PCA (total vs. time-varying)
                           1                                                                                                     1
Generalized Correlation




                          0.8                                                                         Generalized Correlation   0.8


                          0.6                                                                                                   0.6


                          0.4               1st GC                                                                              0.4            1st GC
                                            2nd GC                                                                                             2nd GC
                                            3rd GC                                                                                             3rd GC
                          0.2                                                                                                   0.2
                                            4th GC                                                                                             4th GC
                                            5th GC                                                                                             5th GC
                           0                                                                                                     0
                                0      50     100      150   200    250    300      350   400   450                                   0   50     100      150   200    250    300      350   400   450
                                                                Time                                                                                               Time




                                    Note: Generalized correlations between loadings estimated on the whole time horizon
                                    𝑇 = 650 and a rolling window with 240 months for 𝐾 = 5 factors. Left panel: First
                                    and last decile of 37 single-sorted portfolios (𝑁 = 74). Right panel: Deciles of 37 single-
                                    sorted portfolios (𝑁 = 370).
                       Figure 19: Rolling Loadings Estimates

                                      A: 𝑁 = 74




                                     B: 𝑁 = 370




Note: Time-varying rotated loadings for the ﬁrst ﬁve factors. Loadings are estimated on
a rolling window with 240 months. Diﬀerent lines corresponds to the loading estimated
for diﬀerent time windows. The rotation is calculated at each point in time to minimize
the distance between time-varying loadings and those calculated over the whole sample.
Top panel: Extreme deciles (𝑁 = 74). Bottom panel: All deciles (𝑁 = 370).
                                                                                              Generalized
                                                                                                                        0.4                                             1st GC
                                                                                                                                                                        2nd GC
                                                                                                                                                                        3rd GC
                                                                                                                        0.2
                                                                                                                                                                        4th GC
                                                                                                                                                                        5th GC
                                                                                                                         0
                                                                                                                              0   50     100       150       200      250        300
                                    Figure 20: Generalized Correlations of Local Loading Estimates
                                                                                              Time for Stocks


                                           RP-PCA (total vs. time-varying)                                                             PCA (total vs. time-varying)
                           1                                                                                             1




                                                                                              Generalized Correlation
Generalized Correlation




                          0.8                                                                                           0.8


                          0.6                                                                                           0.6


                          0.4                                                                                           0.4
                                                                               1st GC
                                                                               2nd GC
                                                                               3rd GC
                          0.2                                                                                           0.2
                                                                               4th GC
                                                                               5th GC
                           0                                                                                             0
                                0     50       100      150       200        250        300                                   0   50     100       150       200      250        300
                                                        Time                                                                                      Time


                                       PCA (total vs. time-varying)
                           1 Note: Generalized    correlations between loadings estimated on the whole time horizon
                             𝑇 = 500 and a rolling window with 240 months for stock price data (𝑁 = 270 and
Generalized Correlation




                          0.8
                             𝑇 = 500)
                          0.6


                          0.4


                          0.2


                           0
                                0     50       100      150       200        250        300
                                                        Time
                 Figure 21: Rolling Loadings Estimates for Stocks




Note: Time-varying rotated loadings for the ﬁrst ﬁve factors. Loadings are estimated on
a rolling window with 240 months. Diﬀerent lines corresponds to the loading estimated
for diﬀerent time windows. The rotation is calculated at each point in time to minimize
the distance between time-varying loadings and those calculated over the whole sample.
Stock price data (𝑁 = 270 and 𝑇 = 500)
                         Figure 22: RP-PCA vs. PCA Fit for Stocks

                    SR (In-sample)                                SR (Out-of-sample)

                                       1 factor
    0.6                                2 factors   0.6
                                       3 factors
                                       4 factors
    0.4                                5 factors   0.4
                                       6 factors

    0.2                                            0.2


     0                                              0
              RP-PCA                 PCA                       RP-PCA               PCA


                 RMS     (In-sample)                            RMS     (Out-of-sample)
    0.4                                            0.4

    0.3                                            0.3

    0.2                                            0.2

    0.1                                            0.1

     0                                              0
              RP-PCA                 PCA                       RP-PCA               PCA


          Idiosyncratic Variation (In-sample)            Idiosyncratic Variation (Out-of-sample)
    80                                             80


    60                                             60


    40                                             40


    20                                             20


     0                                              0
              RP-PCA                 PCA                       RP-PCA               PCA


Note: Maximal Sharpe-ratios, root-mean-squared pricing errors and unexplained idiosyn-
cratic variation for diﬀerent number of factors. RP-weight 𝛾 = 10, Stock price data
(𝑁 = 270 and 𝑇 = 500)
