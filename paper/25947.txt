                              NBER WORKING PAPER SERIES




     DEMAND AND WELFARE ANALYSIS IN DISCRETE CHOICE MODELS WITH
                       SOCIAL INTERACTIONS

                                    Debopam Bhattacharya
                                      Pascaline Dupas
                                        Shin Kanaya

                                      Working Paper 25947
                              http://www.nber.org/papers/w25947


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                    June 2019




We are grateful to Steven Durlauf, James Heckman, Xenia Matschke, Gautam Tripathi, and
seminar participants at the University of Chicago and the University of Luxembourg for helpful
feedback. Bhattacharya acknowledges financial support from the ERC consolidator grant
EDWEL; the first outline of this project appeared as part b.3 of that research proposal of March
2015. Part of this research was conducted while Kanaya was visiting the Institute of Economic
Research, Kyoto University (under the Joint Research Program of the KIER), the support and
hospitality of which are gratefully acknowledged. The views expressed herein are those of the
authors and do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2019 by Debopam Bhattacharya, Pascaline Dupas, and Shin Kanaya. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.
Demand and Welfare Analysis in Discrete Choice Models with Social Interactions
Debopam Bhattacharya, Pascaline Dupas, and Shin Kanaya
NBER Working Paper No. 25947
June 2019
JEL No. C31,C35,C57,H23,I38

                                         ABSTRACT

Many real-life settings of consumer-choice involve social interactions, causing targeted policies
to have spillover-effects. This paper develops novel empirical tools for analyzing demand and
welfare-effects of policy-interventions in binary choice settings with social interactions.
Examples include subsidies for health-product adoption and vouchers for attending a high-
achieving school. We establish the connection between econometrics of large games and Brock-
Durlauf-type interaction models, under both I.I.D. and spatially correlated unobservables. We
develop new convergence results for associated beliefs and estimates of preference-parameters
under increasing-domain spatial asymptotics. Next, we show that even with fully parametric
specifications and unique equilibrium, choice data, that are sufficient for counterfactual demand-
prediction under interactions, are insufficient for welfare-calculations. This is because distinct
underlying mechanisms producing the same interaction coefficient can imply different welfare-
effects and deadweight-loss from a policy-intervention. Standard index-restrictions imply
distribution-free bounds on welfare. We illustrate our results using experimental data on
mosquito-net adoption in rural Kenya.

Debopam Bhattacharya                            Shin Kanaya
Department of Economics                         Aarhus University
University of Cambridge                         Department of Economics and Business
Austin Robinson Building                        Fuglesangs Allé 4
Sidgwick Avenue                                 building 2628, room 310
Cambridge CB3 9DD                               8210 Aarhus V
United Kingdom                                  Denmark
debobhatta@gmail.com                            skanaya@creates.au.dk

Pascaline Dupas
Department of Economics
Stanford University
579 Serra Mall Stanford,
CA 94305-6072 and
CEPR
and also NBER
pdupas@stanford.edu
1    Introduction
Social interaction models ­ where an individual'
                                               s payo¤ from an action depends on the perceived
fraction of her peers choosing the same action ­ feature prominently in economic and sociological
research. In this paper, we address a substantively important issue that has received limited
attention within these literatures, viz. how to conduct economic policy evaluation in such settings.
In particular, we focus on welfare analysis of policy interventions in binary choice scenarios with
social interactions. Examples include subsidies for adopting a health-product and merit-based
vouchers for attending a high-achieving school, where the welfare gain of bene...ciaries may be
accompanied by spillover-led welfare e¤ects on those unable to adopt or move, respectively. Ex-ante
welfare analysis of policies is ubiquitous in economic applications, and informs the practical decision
of whether to implement the policy in question. Furthermore, common public interventions such as
taxes and subsidies are often motivated by e¢ ciency losses resulting from externalities. Therefore,
it is important to develop empirical methods for welfare analysis in presence of such externalities,
which cannot be done using available tools in the literature. Developing such methods and making
them practically relevant also requires one to clarify and extend some aspects of existing empirical
models of social interaction.
    Literature Review and Contributions: Seminal contributions to the econometrics of social
interactions include Manski (1993) for continuous outcomes, and Brock and Durlauf (2001a) for
binary outcomes. More recently, there has been a surge of research on the related theme of network
models, c.f. de Paula (2016). On the other hand, the econometric analysis of welfare in standard
discrete choice settings, i.e. with heterogeneous consumers but without social spillover, started with
Domencich and McFadden (1977), with later contributions by Daly and Zachary (1978), Small and
Rosen (1981), and Bhattacharya (2018). The present paper builds on these two separate literatures
to examine how social interactions inuence welfare e¤ects of policy-interventions and the identi...-
ability of such welfare e¤ects from standard choice data. In the context of binary choice with social
interactions, Brock and Durlauf (2001a, Sec 3.3) discussed how to rank di¤erent possible equilibria
resulting from policy interventions in terms of social utility ­as opposed to individual welfare. They
used log-sum type formulae, as in Small and Rosen (1981), to calculate the average indirect utility
for speci...c realized values of covariates and average peer choice. Such calculations are not directly
useful for our purpose. This is because the aggregate income transfer that restores average social
utility to its pre-intervention level does not equal the average of individual compensating variations
that restore individual utilities to their pre-intervention level. The latter is related to the concept
of average deadweight loss, i.e. the e¢ ciency cost of interventions, and consequently has received
the most attention in the recent literature on empirical welfare analysis, c.f. Hausman and Newey
(2016), Bhattacharya (2015), McFadden and Train (2019), and it is this notion of individual welfare
that we are interested in. However, in settings involving spillover, we cannot use the methods of



                                                  2
the above papers, as they do not allow for individual utilities to be a¤ected by aggregate choices
­ a feature that has fundamental implications for welfare analysis. Therefore, new methods are
required for welfare calculations under spillover, which we develop in the present paper.
       In order to develop these methods, one must ...rst have a theoretically coherent utility-based
framework where many individuals interact with each other, i.e. provide a micro-foundation for
Brock-Durlauf type models in terms of an empirical game with many players. This is necessary
because welfare e¤ects are de...ned with respect to utilities, and therefore, one has to specify the
structure of individual preferences and beliefs including unobserved heterogeneity, and how they in-
teract to produce the aggregate choice in equilibrium before and after the policy intervention. This
requires clarifying the information structure and nature of the corresponding Bayes-Nash equilibria.
A pertinent issue here is modelling the dependence structure of utility-relevant variables unobserv-
able to the analyst but observable to the individual players. In particular, spatial correlation in
unobservables ­ natural in the commonly analyzed setting where peer-groups are physical neigh-
borhoods ­ makes individual beliefs conditional on one'
                                                      s own privately observed variables which
contain information about neighborhood ones. This complicates identi...cation and inference. The
...rst main contribution of the present paper is to establish conditions under which this feature of
beliefs can be ignored `in the limit'
                                    , and one can proceed as if one is in an I.I.D. setting. This
derivation is much more involved than the well-known result that in linear regression models, the
OLS is consistent under correlated unobservables. In particular, our result involves showing that
the ...xed points of certain functional maps converge, under increasing domain and weak dependence
asymptotics for spatial data, to ...xed points of a limiting map, implying convergence of conditional
beliefs to unconditional ones. This, in turn, is shown to imply convergence of complicated esti-
mators of preference parameters under conditional beliefs to computationally simple ones in the
limit. These estimators then yield consistent, counterfactual demand-prediction corresponding to
a policy-intervention.
       The standard setting in the game estimation literature is one where many independent markets
are observed, each with a small number of players. Here, we consider estimation of preference
parameters from data on a few markets with many players in each, using asymptotic approximations
where the number of players tends to in...nity but number of markets remains ...xed. In this setting,
if the forms of equilibrium beliefs is symmetric among players,1 the probabilistic laws that they
follow have a certain homogeneity across players. Due to this homogeneity, asymptotics on the
number of players provides the `repeated observations'required to identify the players'preference
parameters. Menzel (2016) had also analyzed identi...cation and estimation in games with many
players. Below, we provide more discussion on the relation and di¤erences between our analysis
   1
       Symmetry means that (1) if the beliefs are unconditional expectations ­ as is the case with I.I.D. unobervables
­ they are identical across players, (2) if they are conditional expectations ­ as is the case for spatially correlated
unobservables ­ their functional forms are identical.




                                                           3
and Menzel's.
   Welfare Analysis: The second part of our paper concerns welfare-analysis of policy-interventions,
e.g. a price-subsidy, in a setting with social interactions. Here we show that unlike counterfactual
demand estimation, welfare e¤ects are generically not identi...ed from choice data under interactions,
even when utilities and the distribution of unobserved heterogeneity are parametrically speci...ed,
equilibrium is unique, and there are no endogeneity concerns. To understand the heuristics behind
under-identi...cation, consider the empirical example of evaluating the welfare e¤ect of subsidizing
an anti-malarial mosquito net. Suppose, under suitable restrictions, we can model choice behav-
ior in this setting via a Brock-Durlauf type social interaction model, and the data can identify
the coe¢ cient on the social interaction term. However, this coe¢ cient may reect an aggregate
e¤ect of (at least) two distinct mechanisms, viz. (a) a social preference for conforming, and (b) a
health-concern led desire to protect oneself from mosquitoes deected from neighbors who adopt
a bednet. These two distinct mechanisms, with di¤erent magnitudes in general, would both make
the social interaction coe¢ cient positive, and are not separately identi...able from choice data (only
their sum is). But they have di¤erent implications for welfare if, say, a subsidy is introduced. At
one extreme, if all spillover is due to preference for social conforming, then as more neighbours buy,
a household that buys would experience an additional rise in utility (over and above the gain due
to price reduction), but a non-buyer loses no utility via the health channel. At the other extreme,
if spillover is solely due to perceived negative health externality of buyers on non-buyers, then
increased purchase by neighbours would lower the utility of a household upon not buying via the
health-route, but not a¤ect it upon buying since the household is then protected anyway. These
di¤erent aggregate welfare e¤ects are both consistent with the same positive aggregate social inter-
action coe¢ cient. This conclusion continues to hold even if eligibility for the subsidy is universal,
there are no income e¤ects or endogeneity concerns, and whether or not unobservables in individual
preferences are I.I.D. or spatially correlated.
   Indeed, this feature is present in many other choice situations that economists routinely study.
For example, consider school-choice in a neighborhood with a free, resource-poor local school and a
selective, fee-paying resource-rich school. In this setting, a merit-based voucher scheme for attending
the high-achieving school can potentially have a range of possible welfare e¤ects. Aggregate welfare
change could be negative if, for example, with high-ability children moving with the voucher the
academic quality declines in the resource-poor school more than the improvement in the selective
school via peer-e¤ects. In the absence of such negative externalities, aggregate welfare could be
positive due to the subsidy-led price decline for voucher users and any positive conforming e¤ects
that raise the utility of attending the rich school when more children also do so. These contradictory
welfare implications is compatible with the same positive coe¢ cient on the social interaction term
in an individual school-choice model.
   For standard discrete choice without spillover, Bhattacharya (2015) showed that the choice



                                                  4
probability function itself contains all the information required for exact welfare analysis. In
particular, for the special case of quasi-linear random utility models with extreme value additive
errors, the popular `
                    logsum' formula of Small and Rosen (1981) yields average welfare of policy
interventions. These results fail to hold in a setting with spillovers because here one cannot set
the utility from the outside option to zero ­ an innocuous normalization in standard discrete
choice models ­ since this utility changes as the equilibrium choice-rate changes with the policy-
intervention. This is in contrast to binary choice without spillover, where utility from the outside
option, i.e. non-purchase, does not change due to a price change of the inside good.
   Nonetheless, under a standard, linear-index speci...cation of demand, one can calculate distribution-
free bounds on average welfare, based solely on choice probability functions. The width of the
bounds increases with (i) the extent of net social spillover, i.e. how much the (belief about) average
neighborhood choice a¤ects individual choice probabilities, and (ii) the di¤erence in average peer-
choice corresponding to realized equilibria before and after the price-change. The index structure,
which has been universally used in the empirical literature on social interactions (c.f. Brock and
Durlauf, 2001a, 2007), leads to dimension reduction that plays an important role in identifying
spillover e¤ects. We therefore continue to use the index structure as it simpli...es our expressions,
and comes "for free", because social spillovers cannot in general be identi...ed without such struc-
ture anyway. Under stronger and untestable restrictions on the nature of spillover, our bounds can
shrink to a singleton, implying point-identi...cation of welfare. Two such restrictions are (a) the
e¤ects of an increase in average peer-choice on individual utilities from buying and not buying are
exactly equal in magnitude and opposite in sign, or (b) the e¤ect of aggregate choice on either the
purchase utility or the non-purchase utility is zero.
   Empirical Illustration: We illustrate our theoretical results with an empirical example of a
hypothetical, targeted public subsidy scheme for anti-malarial bednets. In particular, we use micro-
data from a pricing experiment in rural Kenya (Dupas, 2014) to estimate an econometric model
of demand for bednets, where spillover can arise via di¤erent channels, including a preference
for conformity and perceived negative externality arising from neighbors' use of a bednet. In
this setting, we calculate predicted e¤ects of hypothetical income-contingent subsidies on bednet
demand and welfare. We perform these calculations by ...rst accounting for social interactions, and
then compare these results with what would be obtained if one had ignored these interactions.
We ...nd that allowing for (positive) interaction leads to a prediction of lower demand when means-
tested eligibility is restricted to fewer households and higher demand when the eligibility criterion is
more lenient, relative to ignoring interactions. The intuitive explanation is that ignoring a covariate
with positive impact on the outcome would lead to under-prediction if the prediction point for the
ignored covariate is higher than its mean value. As for welfare, allowing for social interactions may
lead to a welfare loss for ineligible households, in turn implying higher deadweight loss from the
subsidy scheme, relative to estimates obtained ignoring social spillover where welfare e¤ects for



                                                   5
ineligibles are zero by de...nition. The resulting net welfare e¤ect, aggregated over both eligibles
and ineligibles, admits a large range of possible values including both positive and negative ones,
with associated large variation in the implied deadweight loss estimates, all of which are consistent
with the same coe¢ cient on the social interaction term in the choice probability function.
    An implication of these results for applied work is that welfare analysis under spillover ef-
fects requires knowledge of the di¤erent channels of spillover separately, possibly via conducting a
`
belief-elicitation' survey; knowledge of only the choice probability functions, inclusive of a social
interaction term, is insu¢ cient.
    Plan of the Paper: The rest of the paper is organized as follows. Section 2 describes the
set-up, and establishes the formal connection between econometric analysis of large games and
Brock-Durlauf type social interaction models for discrete choice, ...rst under I.I.D. and then under
spatially correlated unobservables. This section contains the key results on convergence of con-
ditional (on unobservables) beliefs in the spatial case to non-stochastic ones under an increasing
domain asymptotics. Section 3 shows consistency of our preferred, computationally simple estima-
tor even under spatial dependence, Section 4 develops the tools for empirical welfare analysis of a
price intervention ­ such as a means-tested subsidy ­ in such models, and associated deadweight
loss calculations. In Section 5, we lay out the context of our empirical application, and in Section
6 we describe the empirical results obtained by applying the theory to the data. Finally, Section
7 summarizes and concludes the paper. Technical derivations, formal proofs and additional results
are collected in an Appendix.


2     Set-up and Assumptions
Consider a population of villages indexed by v 2 f1; : : : ; v g and resident households in village v
indexed by (v; h), with h 2 f1; : : : ; Nv g. For the purpose of inference discussed later, we will think
of these households as a random sample drawn from an in...nite superpopulation. The total number
                                 P
of households we observe is N = v  v =1 Nv . Each household faces a binary choice between buying
one unit of an indivisible good (alternative 1) or not buying it (alternative 0). Its utilities from
the two choices are given by U1 (Yvh         Pvh ;    vh ;   vh )   and U0 (Yvh ;    vh ;   vh )   where the variables
Yvh , Pvh , and   vh   denote respectively the income, price, and heterogeneity of household (v; h),
and   vh   is household (v; h)'
                              s subjective belief of what fraction of households in her village would
choose alternative 1. The variable     vh   is privately observed by household (v; h) but is unobserved
by the econometrician and other households. The dependence of utilities on                          vh   captures social
interactions. Below, we will specify how       vh    is formed. Household (v; h)'
                                                                                s choice is described by

                        Avh = 1 fU1 (Yvh     Pvh ;    vh ;   vh )     U0 (Yvh ;   vh ;   vh )g ;                     (1)




                                                        6
where 1 f g denotes the indicator function. In the mosquito-net example of our application, one
can interpret U1 and U0 as expected utilities resulting from di¤erential probabilities of contracting
malaria from using and not using the net, respectively.
   The utilities, U1 and U0 , may also depend on other covariates of (v; h). For notational simplicity,
we let Wvh = (Yvh ; Pvh )0 , and suppress other covariates for now; covariates are considered in our
empirical implementation in Section 6.
   For later use, we also introduce a set of location variables fLvh g: where Lvh 2 R2 denotes
(v; h)'
      s (GPS) location.
   Incomplete-Information Setting: In each village v , each of the Nv households is provided
the opportunity to buy the product at a researcher-speci...ed price Pvh randomly varied across
households. These households will be termed as players from now on. Players have incomplete
information in that each player (v; h) knows her own variables (Avh ; Wvh ; Lvh ;                              vh ).   We assume,
in line with our application context, that a player does not know the identities of all the players
who have been selected in the experiment and thus their variables (Wv
                                                                    ~k ; Lv
                                                                          ~k ;                               ~k )
                                                                                                             v       and choice Av
                                                                                                                                 ~k
(for any v
         ~ 2 f1; : : : ; v g and k 6= h). Accordingly, we model interactions of households as an
incomplete-information Bayesian game, whose probabilistic structure is as follows.
   We consider two sources of randomness: one stemming from random drawing of households
from a superpopulation, and the other associated with the realization of players'unobserved het-
erogeneity f   vh g.   This will be further elaborated below.
   We assume players have `
                          rational expectations' in accordance with the standard Bayes-Nash
setting, i.e., each (v; h)'
                          s belief is formed as
                                           1 X
                                  vh =                                       E [Avk jIvh ];                                     (2)
                                         Nv 1   1           k Nv ; k6=h

where E [ jIvh ] is the conditional expectation computed through the probability law that governs
all the relevant variables given (v; h)'
                                       s information set Ivh that includes (Wvh ;                            vh ).   Here, `
                                                                                                                           rational
expectation'simply means that subjective and physical laws of all relevant variables coincide. The
explicit form of (2) in equilibrium is investigated in the next subsection after we have speci...ed the
probabilistic structure for all the variables.
   Each player (v; h) is solely concerned with behavior of other players in the same village. In this
sense, the econometrician observes v games (v is eleven in our empirical study), each with `
                                                                                           many'
players. To formalize our model as a Bayesian game in each village, given the form of (2), U1 and
U0 would be interpreted as expected utilities. This is possible when the underlying vNM utility
indices u1 and u0 satisfy
                                                                         1       X
         U1 (Yvh       Pvh ;   vh ;   vh )   = E [u1 (Yvh   Pvh ;                                    Avk ;     vh )jIvh ],
                                                                    Nv       1       1 k Nv ; k6=h

i.e., u1 is linear in the second argument; U0 and u0 satisfy an analogous relationship. This will
hold in particular when utilities have a linear index structure, as in Manski (1993) and Brock and



                                                            7
Durlauf (2001a, 2007).
       Dependence Structure of Unobserved Heterogeneity: We assume that unobserved het-
                       Nv
erogeneity f       vh gv =1   (v = 1; : : : v ) takes the following form:

                                                          vh   =    v   + uvh ,                                                   (3)

where       v   stands for a village-speci...c factor that is common to all members in the v th village and
uvh represents an individual speci...c variable. Below we will consider two di¤erent speci...cations
for the sequence fuvh gN v
                       h=1 : for each v , given                    v,   viz., (1) uvh are conditionally independent and
identically distributed, and (2) uvh is spatially dependent.2 We assume that the value of                                     v    is
commonly known to all members in village v but uvh is a purely private variable known only to
individual (v; h). Neither f v g nor fuvh g is observable to the econometrician. We also assume that
this information structure as well as the probabilistic structure of variables imposed below (c.f.
conditions C1, C2, and C3 with I.I.D. or SD below) is known to all the players in the game.
Given our settings so far, we can specify the form of player (v; h)'
                                                                   s information set as

                                                 Ivh = (Wvh ; Lvh ; uvh ;         v ).                                            (4)

In our empirical set-up, the group level unobservables f v g will be identi...ed using the fact that
there are many households per village.

       Having described the set-up through equations: (1), (2), (3), and (4), we now close our model
by providing the following conditions on the probabilistic law for the key variables:

                                 Nv
C1 f(Wvh ; Lvh ;       v ; uvh )gh=1 ,   v = 1; : : : ; v , are independent across v .

       Assumption C1 says that variables in village v are independent of those in village v
                                                                                          ~(6= v ).

C2 For each v 2 f1; : : : ; v g, given            v,   f(Wvh ; Lvh )gN v
                                                                     h=1 is I.I.D. with (Wvh ; Lvh )
                                                                                                                    v (w; lj ),
                                                                                                                   FW L      v
         the conditional CDF for village v .

       This conditional I.I.D.-ness of C2 for observables represents randomness associated with sam-
pling of households in our ...eld experiment. Additionally, the household (v; h) is assumed to know
                  v (w; lj ).
the distribution FW L      v

       For the distribution of unobservable heterogeneity, we consider two alternative scenarios:

C3-IID (i) For each v , given               v,   the sequence fuvh gNv
                                                                    h=1 is conditionally I.I.D., with uvh j                   v
          v ( j ); (ii) fu gNv is independent of fW ; L gNv conditionally on
         Fu     v         vh h=1                   vh  vh h=1                                               v.
   2
       The "...xed-e¤ect" type speci...cation (3) is similar to Brock and Durlauf (2007). However, the additive separable
structure of (3) is assumed here for expositional simplicity; we can allow for            vh   =   (   v ;uvh )   for some possibly
nonlinear function      ( ; ), and this general form does not change anything substantive in what follows.




                                                                    8
C3-SD For each v , the sequence fuvh g de...ned as

                                                       uvh = uv (Lvh );                                            (5)

        for a stochastic process fuv (l)gl2Lv , indexed by location l 2 Rv @ R2 , where fuv (l)gl2Rv
        are independent of fuv0 (l)gl2R         for v 6= v 0 , and satisfy the following properties: (i) for each
                                          v0

        v , fuv (l)gl2Rv is an alpha-mixing stochastic process conditionally on            v,   where the de...nition
        of an alpha-mixing process is provided in Appendix A.2; (ii) fuv (l)gl2Rv is independent of
        f(Wvh ; Lvh )gNv
                      h=1 conditionally on       v.


     The conditional I.I.D.-ness imposed in C3-IID (i) leads to equi-dependence within each village,
i.e., Cov [  ;    ] = Cov      ~;
                                                               ~ ~
                                   ~ (6= 0) for any h 6= k and h 6= k . In contrast, C3-SD (i) allows
             vh   vk           vh   vk
for non-uniform dependence that may vary depending on the relative locations of the two players,
i.e., if two households (v; h) and (v; k ) selected in the experiment with locations Lvh and Lvk ,
respectively, live close to each other (i.e., jjLvh            Lvk jj is small), uvh and uvk (and thus       vh   and
 vk )   are more correlated. For example, in our application on mosquito-net adoption, this can
correspond to positive spatial correlation in density of mosquitoes, unobserved by the researcher.
Assumption C3-SD is consistent with the "increasing domain" type asymptotic framework used
for spatial data, formally set out in Appendix A.2 of this paper (briey, the area of Rv = RN
                                                                                           v tends
to 1 as N ! 1; c.f. Lahiri, 2003, Lahiri and Zhu, 2006).
   For the purpose of inference, C3-SD may be seen as a generalization of C3-IID, but in our
Bayes-Nash framework with many players, they will, in general, imply substantively di¤ erent forms
for beliefs and equilibria. In particular, under C3-IID, each player (v; h)'
                                                                           s unobservables uvh is not
useful for predicting another player (v; k )'
                                            s variables and behavior, and therefore her belief                    vh   ­
de...ned in (2) as the average of the conditional expectations about all the others' Avk ­is reduced
to the average of the unconditional expectations (as formally shown in Proposition 1) below. On
the other hand, under the spatial dependence scheme C3-SD, since uvh and uvk are correlated,
knowing one'
           s own realized value of uvh can help predict others' uvk ; in other words, (v; h)'
                                                                                            s own
information Ivh = (Wvh ; Lvh ; uvh ;     v)    is useful for forming beliefs about others.
   Condition (ii) in C3 (with I.I.D. or SD) is the exogeneity condition. Since fuv (l)g is inde-
pendent of (Wvh ; Lvh ) conditionally on          v,   we have Wvh ? uv (Lvh )jLvh ;      v.   This allows for iden-
ti...cation and consistent estimation of model parameters. In the context of the ...eld experiment
in our empirical exercise, this exogeneity condition can be interpreted as saying that realization of
unobserved heterogeneity is independent of how researchers have selected the sample. Note that
the exogeneity condition is conditional on Lvh (and              v ),   and it does not exclude correlation of uvh
and Wvh       (Pvh ; Yvh ) in the unconditional sense. Say, if Yvh is well predicted by location Lvh (say,
there are high-income districts and low-income ones, and no restriction is imposed on the joint
distribution of (Wvh ; Lvh )), we can still capture situations where uvh tends to be higher for (v; h)'
                                                                                                      s



                                                           9
income Yvh since uvh = uv (Lvh ).3
       Two Sources of Randomness: The above probabilistic framework with two sources of ran-
domness has parallels in Andrews (2005, Section 7) and Lahiri and Zhu (2006). It is also related to
Menzel'
      s (2016) framework with exchangeable variables (below we provide further comparison of
our framework with Menzel's). As stated, C2 represents randomness induced by the researchers'
experimental process. In contrast, the speci...cation in C3 represents randomness of unobserved
heterogeneity conditionally on fLvh gN v
                                     h=1 , the (locations of) households selected in the experiment.
       Conditions C2 and C3-IID imply that f(Wvh ; Lvh ; uvh )gNv
                                                               h=1 are I.I.D. conditionally on             v,   and
thus our framework can be interpreted as the standard one with a single source of randomness.
For the spatial case C3-SD, the beliefs depend on Ivh , and in particular, on the unobservable
(to the econometrician) uvh , which complicates identi...cation and inference. We get around this
complication by showing that under an "increasing domain" type of asymptotics for spatial data,
reasonable in our application, the model and estimates of its parameters under C3-SD converge
essentially to the simpler model C3-IID, and this justi...es the use of Brock-Durlauf type analysis
even under spatial dependence.


2.1       Equilibrium Beliefs

In this subsection, we investigate the forms of players'beliefs de...ned in (2) ...rst in the I.I.D. and
then in the spatially dependent case. We ...rst consider the case of C3-IID. This case corresponds
to Brock and Durlauf'
                    s (2001a) binary choice model with social interactions where, additionally,
unobserved heterogeneity was modelled through the logistic distribution. BD01 made an intuitive,
but somewhat ad hoc, assumption that beliefs, corresponding to our                  vh ,   are constant and sym-
metric across all players in the same village. We ...rst show that under C3-IID, this assumption can
be justi...ed in our incomplete-information game setting via the speci...cation of a Bayes-Nash equi-
librium. We next consider the spatially dependent case with C3-SD. As briey discussed above,
beliefs under the spatial dependence have to be computed through conditional expectations. How-
ever, under an "increasing domain"asymptotic framework for spatial data, conditional-expectation
based beliefs converge to the beliefs in the I.I.D. case. The mathematical derivation of this result is
somewhat involved; so in the main text we outline the key points, and provide the formal derivation
in the Appendix.


2.1.1       Constant and Symmetric Beliefs under the (Conditional) I.I.D. Setting

We investigate the forms of beliefs under C3-IID through the two following propositions:

   3
       In our application, prices Pvh are randomly assigned to individuals by researchers and thus Pvh and uvh are
independent both unconditionally and conditionally on Lvh .




                                                         10
Proposition 1 Suppose that Conditions C1, C2, and C3-IID are common knowledge in the
Bayesian game described in the previous section. Then, for any k 6= h in village v with                                                    v,


                                                         E [Avk jIvh ] = E [Avk j v ];

where Ivh = (Wvh ; Lvh ; uvh ;              v)   de...ned in (4).

       The proof of Proposition 1 is provided in Appendix A.1. Note that this proposition does not
utilize any equilibrium condition. It simply con...rms, formally, the intuitive statement that (v; h)'
                                                                                                     s
own variables are not useful to predict other (v; k )'
                                                     s behavior Avk . Given this result, we can write
the belief         vh   (de...ned in (2)) as
                                                                      vh   =     vh ,                                                           (6)

where
                                                                            X
                                                                       1
                                     vh     =        vh ( v )   :=   Nv 1                            E [Avk j v ];
                                                                                 1 k Nv ; k6=h

and       vh   is a function of         v   and independent of (v; h)-speci...c variables, (Wvh ; Lvh ; uvh ), while
the functional form of             vh   may depend on the index (v; h) in a deterministic way; for notational
simplicity, we suppress the dependence of                            vh   on     v   below.
       Beliefs in equilibrium solve the system of Nv equations:
                                              " (                         )#
                          X                       U1 (Yvk Pvk ; vk ; vk )
                      1
              vh = Nv 1                    E v 1                             ; h = 1; : : : ; Nv ;                                              (7)
                             1 k Nv ; k6=h              U0 (y; vk ; vk )

where E        v
                   [ ] denotes the conditional expectation operator given                                   v   (i.e., E [ j v ]). Brock and
Durlauf (2001a) focus on equilibria with constant and symmetric                                       beliefs.4   Using our notation above,
we say that (constant) beliefs are symmetric when                                    vh   =    vk    for any h; k 2 f1; : : : ; Nv g (for each
v ). When Brock and Durlauf'
                           s framework is interpreted as a Bayesian game, one can formally
justify their focus on constant and symmetric beliefs under conditions laid out in Proposition 2
below.
       To establish this proposition, de...ne for each v , given                              v,   a function mv : [0; 1] ! [0; 1] as

               mv (r) = mv v (r) := E            v
                                                     [1 fU1 (Yvh          Pvh ; r;    v   + uvh )       U0 (Yvh ; r;     v   + uvh )g] ;        (8)

for notational economy, we will often suppress the dependence of mv (r) on                                           v   ; but note that mv (r)
is independent of individual index h under the conditional I.I.D. assumption given                                                v.   Now we are
ready to provide the following characterization of beliefs:

   4
       The constancy of beliefs means that each player's belief is independent of any realization of her own, player-speci...c
variables as in (65).




                                                                            11
Proposition 2 Suppose that the same conditions hold as in Proposition 1 and the function mv v ( )
de...ned in (8) is a contraction, i.e., for some                  2 (0; 1),

                              jmv (r)       mv (~
                                                r) j          jr        r
                                                                        ~j for any r; r
                                                                                      ~ 2 [0; 1] :                             (9)

Then, a solution (   v1 ; : : : ;   vNv )   of the system of Nv equations in (7) uniquely exists and is given
by symmetric beliefs, i.e.,

                                       vh   =    vk       for any h; k 2 f1; : : : ; Nv g:

   The proof is given in the Appendix. Propositions 1-2 show that, given the (conditional) I.I.D.
and contraction conditions, the equilibrium is characterized through

                                            vh   =    v    for any h = 1; : : : ; Nv ;

for some constant    v   :=    v( v)   2 [0; 1] within each village (given                     v ).   This implies that the beliefs
can be consistently estimated by the sample average of Avk over village v , which is exploited in our
empirical study.
   The contraction condition (9) can be veri...ed on a case by case basis. In particular, for the
linear index model used below, the condition is

                                                      j j sup f" (e) < 1;
                                                            e2R

where    denotes the coe¢ cient on beliefs, i.e. the social interaction term, and f" ( ) denotes the
density of ", the unobservable determinant of choosing option 1 (de...ned below through vk or uvh ).
                                                                                  p
In a probit speci...cation in which " is the standard normal, supe2R f" (e) = 1= 2 and thus we
               p
require j j < 2 (' 2:506) and for the logit speci...cation, supe2R f" (e) = 1=4, and thus j j < 4.
We verify that these conditions are satis...ed in our application.
   Note, however, from the proof of Proposition 2, that the contraction condition (9) is not nec-
essarily required for uniqueness. That is, if a solution (                      v1 ; : : : ;   vNv )   to the system of equations
(7) is unique and mv ( ) de...ned in (8) has a unique ...xed point (i.e., a solution to r = mv (r) is
unique), then the same conclusion still holds. We have imposed (9) since it is a convenient su¢ -
cient condition that guarantees uniqueness both in (7) and r = mv (r); it also appears to be a mild
condition, and easy to verify in applications.


2.1.2   Convergence of Beliefs under Spatial Dependence

In this subsection, we provide a formal characterization of beliefs in equilibrium under the spatial
case C3-SD. When the unobserved heterogeneity fuvh g are dependent, beliefs in equilibrium may
not reduce to a constant within each village, unlike in Proposition 1. With correlated uvk and
uvh , the conditional expectation E [Avk jIvh ] is in general a function of the privately observed uvh ,



                                                                   12
because knowing uvh is useful for predicting uvk and thus Avk (the latter is a function of uvk ).
While (v; h)'
            s beliefs are given by a constant under C3-IID, they will in general be a function
of (v; h)'
         s variables unobserved by the researcher, when spatial dependence is allowed, thereby
complicating the analysis. In this subsection, we investigate formal conditions under which this
feature of beliefs disappears "in the limit".5
       Asymptotic Framework for Spatial Data: Under spatial dependence, the ...rst key condi-
tion enabling consistent estimation of our model parameters is the spatial analog of weak depen-
dence. This amounts to specifying that uvk and uvh are less dependent when the distance between
(v; k ) and (v; h), jjLvk            Lvh jj1 , is large. The notion of asymptotics we use is the so-called "increas-
ing domain" type (c.f. Lahiri, 1996), where the area from which fLvk gNv
                                                                      k=1 is sampled expands to
in...nity as Nv ! 1. In particular, for each player h, the number of other players who are almost
uncorrelated with h expands to 1, and the ratio of such players (relative to all Nv players) tends
to 1. Given this, and assuming that any bounded region in the support of Lvk does not contain too
many observations (even when Nv tends to 1), we can (i) ignore the e¤ect of spatial dependence
on equilibrium beliefs "in the limit", and (ii) derive limit results for spatial data (e.g., the laws of
large numbers and central limit theorems as in Lahiri, 1996, 2003), and use these to develop an
asymptotic inference procedure.
       In our empirical set-up, the average distance between households within every village is more
than 1 kilometer, and is close to 2 kilometers in most villages. This corresponds well with the
increasing domain framework above.
       Convergence of Equilibrium Belief : We now characterize the game's equilibrium under
the asymptotic scheme outlined above. The formal details of the analysis are laid out in Appendix
A.2; here we outline the main substantive features and their implications for the belief structure.
       To characterize beliefs in equilibrium, write

                                                 vh   =    vh (Wvh ; Lvh ; uvh ; v );                                      (10)

given each       v.       vh (   ) may depend on index (v; h) in a deterministic way. Note that this expression
(10) follows from the speci...cation of               vh   in (2), de...ned as the average of the conditional expecta-
tions. Then, in the equilibrium, for each village v , beliefs are given by the set of functions,                          vh (   ),
h = 1; : : : Nv , that solves the following system of Nv equations:

              vh (Wvh ; Lvh ; uvh ; v )
                                               " (                                                            )     #
                      1             X                 U1 (Yvk     Pvk ;   vk (Wvk ; Lvk ; uvk ; v );   vk )
             =                             E 1                                                                    Ivh ;    (11)
                 Nv        1                                U0 (Yvk ;   vk (Wvk ; Lvk ; uvk ; v );   vk )
                               1 k Nv ; k6=h

   5
       Yang and Lee, 2017 discuss estimation of a social interaction model with heterogeneous beliefs, but the hetero-
geneity is solely a function of observed player-speci...c variables (c.f. Eqn 2.1 in Yang and Lee, 2017), while unobserved
private variables are IID, and not spatially correlated as in our case.




                                                                  13
for h = 1; : : : ; Nv (almost surely).
      Note that the solution f                    vh (   )g to (11) depends on Nv , the number of households. We now
discuss the limit of the solutions when Nv ! 1. To this end, for expositional ease, consider a
symmetric equilibrium such that                              vh (    )=       v(      ) for any h = 1; : : : ; Nv ; symmetry is imposed here
solely for easy exposition, and a formal proof without symmetry is provided in Appendix A.2. Under
symmetry, the functional equation in (11) is reduced to

                                                                          v   =       v;Nv      v   ;                                                   (12)

where      v;Nv   is a functional operator (mapping) from a [0; 1]-valued function g (of random variables,
Ivk = (Wvk ; Lvk ; uvk ;             v ))      to another [0; 1]-valued function                        v;Nv   [g ] (evaluated at Ivh ):

          v;Nv   [g ] =     v;Nv  [g ] (Ivh )
                                            " (                                                           )    #
                  1             X               U1 (Yvk Pvk ; g (Wvk ; Lvk ; uv (Lvk ); v ); vk )
         =                                E 1                                                               Ivh ;                                       (13)
             Nv       1                              U0 ( Yvk ; g ( W vk ; Lvk ; u v ( Lvk ) ; v ) ; vk )
                          1 k   Nv ; k6=h

where uvh = uv (Lvk ) as formulated in C3-SD. Under C3-IID in (7), we have considered the system
of equations that can be eventually de...ned through the unconditional expectations E                                                        v
                                                                                                                                                 [ ]. In con-
trast, here we have to consider conditional expectations of the form E [ j Ivh ] = E [ j Wvh ; Lvh ; uvh ;                                                     v ],
as in (11) and (13). Given the correlation in fuvh g, they do not reduce to the unconditional ones
since uvh is useful for predicting others' uvk . However, under the increasing domain asymptotics
and a weak dependence condition (i.e., uv (Lvk ) and uv (Lvh ) are less correlated when jjLvk                                                         Lvh jj1
is large), both of which are standard asymptotic assumptions for inference with spatial data, the
number of players in the game whose unobservables are almost uncorrelated with any given player
(v; h) becomes large as Nv ! 1, and further the ratio of such players (among all Nv players) tends
to 1. As a result, the operator                         v;Nv     [g ] converges to the average of the unconditional expectations:

             v;Nv     [g ] !       v;1 [g ]
                                                             " (                                                                             )#
                       1               X                              U1 (Yvk               Pvk ; g (Wvk ; Lvk ; uv (Lvk );    v );   vk )
             :=                                    E     v
                                                                 1                                                                                ;     (14)
                  Nv        1                                                  U0 (Yvk ; g (Wvk ; Lvk ; uv (Lvk );          v );   vk )
                                1 k Nv ; k6=h

for any g , where we call each summand E v [ ] an `
                                                  unconditional'expectation in that it is independent
of (Wvh ; Lvh ; uvh ), and we also suppress the dependence of                                             v;1   on    v   for notational simplicity.6
The precise meaning of this convergence, together with required conditions, is formally stated in
the Appendix (see (81) in the proof of Theorem 5, for the general case without symmetry).
      The convergence of the operator                                v;Nv     to       v;1     caries over to that of a ...xed point of                 v;Nv
(i.e. the solution of              v       =     v;Nv        v   ) when the limit operator                      v;1   is a contraction. The above
discussion can be summarized as:
  6
      We write E [B j      v]   =E     v
                                           [B ] and E [B jC;         v]   =E      v
                                                                                      [B jC ] for any random objects B and C .




                                                                                       14
Theorem 1 Suppose that C2 and C3-SD hold with Assumption 4 (introduced in Appendix A.2),
and the functional map                v;1 [g ]    de...ned in (14) is a contraction with respect to the metric induced
by the norm jjg jjL1 := E [jg (Wvh ; Lvh ; uv (Lvh ))j] (g is a [0; 1]-valued function on the support of
(Wvh ; Lvh ; uv (Lvh ))),7 i.e.,

                                 j   v;1 [g ]       v;1 [~
                                                         g ]j    jjg     g
                                                                         ~jjL1 for some        2 (0; 1) .

Let        v   2 [0; 1] be a solution to the functional equation g =                      v;1 [g ]   (which is unique under the
contraction property). Then, for each v , it holds that for any solution                               v   to g =   v;Nv   [g ], which
may not be unique,

                                sup E j           v (Wvh ; Lvh ; uv (Lvh ))        vj   ! 0 as Nv ! 1.                           (15)
                              1 h Nv


         Note that the limit of          v,     a ...xed point of      v;1 ,   corresponds to the equilibrium (constant and
symmetric) beliefs for the C3-IID case (a ...xed point of mv ( ) in (8); recall that                                  vh    =    v   by
Propositions 1 - 2).
         This theorem is restated as Theorem 5 in Appendix A.2, where its proof is also provided.
Theorem 5 derives the convergence of the equilibrium beliefs (without the symmetry assumption
    vh (   ) =    v   ( )), viz. that the limit of the solution to (11) is given precisely by the solution of
(7). The theorem also derives the rate of the convergence in 15: The rate is faster if (1) the
area of each village expands quicker as Nv ! 1 under the increasing-domain assumption; and if
(2) the degree of spatial dependence of fuvh g is weaker. Note that the contraction condition of
the limit (unconditional) operator implies existence and uniqueness of the solution, but we do not
need to impose it on the operator de...ned via the conditional operator; multiplicity of solutions
(    v   =     v;Nv     v   ) is allowed for, and any of the solutions would then converge to                        v,    where the
existence of a solution can be relatively easily checked using other, less restrictive ...xed point
theorem.

         In sum, this convergence result justi...es the use of Brock and Durlauf (2001a) type speci...cation
of constant and symmetric beliefs, even when unobserved heterogeneity exhibits spatial dependence.
This enables us to overcome complications in identi...cation and inference posed by the dependence of
beliefs on unobservables. In the next section, we present two estimators ­one based on the Brock
and Durlauf type speci...cation and another that takes into account the conditional expectation
feature of the beliefs as in (10). Then, we (a) show that the di¤erence between the two estimators
is asymptotically negligible, and (b) justify using observable group average outcome as a regressor in
an econometric speci...cation of individual level binary choice as in Brock and Durlauf'
                                                                                       s estimation
procedure.
     7
         Note that E [jg (Wvh ; Lvh ; uv (Lvh ))j] is independent of h, given C2 and C3-SD; and it can be used as a norm.




                                                                       15
   Further Discussions and Comparison with Menzel (2016): In our discussion of the
spatial case, the sequence fuvh g = fuv (Lvh )g, de...ned through two independent components, is
called subordinated to the stochastic process fuv (l)g via the index variables fLvh g. Subordination
has been used previously in econometrics and statistics for modelling spatially dependent processes,
c.f. Andrews (2005, Section 7) and Lahiri and Zhu (2006). One implication of subordination is the
so-called exchangeability property (see, e.g., Andrews, 2005), and if a sequence of random variables
is exchangeable, it can be I.I.D. conditionally on some sigma algebra (often denoted by F1 , the
tail sigma algebra), which is known as de Finetti'
                                                 s theorem (see, e.g., Ch. 7 of Hall and Heyde,
1980). In our setting, this corresponds to the conditional I.I.D.-ness of f(Wvh ; Lvh ; uv (Lvh ))g, given
a realization of the stochastic process uv ( ) (as well as that of      v ),   where F1 is set as the sigma
algebra generated by the random function uv ( ).
   Menzel (2016) has proposed a conditional inference method for games with many players un-
der the exchangeability assumption. Indeed, Menzel (2016) and the present paper are similar in
that both consider estimation of a game with the I.I.D. condition relaxed and under many-player
asymptotics. However, there are some substantive di¤erences between Menzel's (2016) framework
and ours. Firstly, in his conditional inference scheme, the probability law recognized by players in a
game is di¤erent from that used by researchers for inference purposes (i.e., the former is the uncon-
ditional law and the latter is the conditional law given F1 ), but they are identical in our setting.
This feature of non-identical laws causes di¢ culty in constructing a valid, interpretable moment
restriction that guarantees consistent estimation. In the context of estimating structural economic
models (including game theoretic models), such a restriction is usually presented as some exogene-
ity or exclusion condition that is derived by taking into account players' optimization behavior,
i.e., the restriction is constructed based on the players' perspective. This sort of construction may
not give a valid moment restriction under the conditional inference scheme where validity has to
be judged from the researcher '
                              s perspective with the conditional law. To see this point, consider a
simple binary choice example: Yi = 1 fXi0 + "i          0g, where "i jXi       N (0; 1) and Xi is a covariate.
In the standard case, the parameter        can be estimated through E [w (Xi ) fYi              (Xi0 )g] = 0,
where w ( ) is a weighting function, and        is the distribution function of N (0; 1). In contrast,
under an inference scheme that exploits exchangeability or conditional I.I.D.-ness of f(Yi ; Xi )g1
                                                                                                  i=1 ,
consistent estimation would require E [w (Xi ) fYi         (Xi0 )gjF1 ] = 0, where F1 is the tail sigma
algebra of f(Yi ; Xi )g1
                       i=1 . The F1 -conditional moment is in general hard to interpret, is not implied
by the unconditional one, and it is not always be obvious whether it holds. Indeed, Andrews (2005)
discuses failure of consistency in a simple least square regression case when the conditional law is
used.
   Another feature of Menzel (2016) that is distinct from ours is his focus on aggregate games.
In his setting, players' utilities depend on the `aggregate state', that is computed through the
conditional expectation of others' actions (Gmn (s;        m)   de...ned in Eq. (2.1) on p. 311, Menzel,



                                                   16
2016). This object is the counterpart of          vh    in our setting in that players'interactions take place
only through the aggregate state      m      (   vh   in our notation). Our           vh   for the spatially dependent
case is de...ned in (10) and (11) through conditional expectations (E [Avk jIvh ]) given all information
Ivh available to player (v; h), i.e., both the individual variables (Wvh ; Lvh ; uv (Lvh )) and common
variable   v.   On the other hand, a counterpart of Menzel's aggregate state in our context is
                                         1       X
                                                                      E [Avk j v ];                                 (16)
                                    Nv       1        1 k Nv ; k6=h

where the conditional expectation is computed given only the common                           v   (called a public signal
on p. 310 in Menzel, 2016, denoted by wm ). The formulation (16) means that each player does
not utilize all the available information for predicting others'behavior even when uvh is useful for
(v; h) to predict uvk (and thus Avk ) due to correlation between uvk and uvh . This contradicts
the intuitively natural structure of belief formation in Bayesian games via rational expectations
in our setting. Note, however, that Menzel (2016, Section 3) also discusses convergence of ...nite-
players games and the associated equilibria. His convergence result is based on the assumption that
players'predictions about other players is based on E [ j v ] both in ...nite games and its limit, while
our result establishes convergence of the belief process, where E [ jIvh ] is used in a ...nite-player game
but reduces to E [ j v ] in the limit. In this sense, our belief convergence result may be interpreted
as providing an asymptotic justi...cation of Menzel'
                                                   s (2016) `
                                                            aggregate game'framework.


3    Econometric Speci...cation and Estimators
In this section, we lay out the econometric speci...cation of our model, and describe estimation of
preference parameters (denoted by     1 ),   assuming that the observed sample is generated via the game
introduced in the previous section and satisfying assumptions C1, C2, and C3-SD (the C3-IID
case is simpler, and is nested within the C3-SD case; see more on this below). In particular, we
de...ne the true parameter via a conditional moment restriction that is derived from speci...cation of
utility functions and the structure of the game in each of v villages. As discussed above, the beliefs
in the ...nite-player game possess a conditional expectation feature, so the conditional expectation
used to de...ne 1 has a complicated form, and consequently the estimator based on it, denoted by
^SD below, is di¢ cult to implement.
 1
   Therefore, we construct another, computationally simpler estimator ^1 based on a conditional
expectation restriction derived from the limit model with the limit belief v (derived in Theorem
1), and use it in our empirical application. We call ^1 Brock-Durlauf type as it resembles the
estimator used in Brock and Durlauf (2001a, 2007). Since the limit model is not the actual data
generating process (DGP), our preferred estimator ^1 is based on a mis-speci...ed conditional moment
restriction. However, we show that the estimator for the ...nite-player game with spatial dependence,
^SD , which takes into account the conditional-expectation feature of the beliefs (as in (10)) shares
 1




                                                           17
the same limit as ^1 that is based on the limit model, as N ! 1, under the asymptotic scheme
for spatial data as introduced in the previous section and in Appendix A.2.1. In this sense, the
two estimators, ^1SD and ^ , are asymptotically equivalent, and this result justi...es the use of the
                           1

simpler, Brock-Durlauf type estimation procedure. This result is formally proved in Theorem 2
below. The key challenge in this proof is showing uniform convergence of the ...xed point solutions
(beliefs) over the parameter space.
         Forms of Beliefs under Spatial Dependence: To develop our estimators, we assume that
the players'beliefs in (10) are symmetric:                          vh   =   v (Wvh ; Lvh ; uvh ; v ), i.e., the functional form of

 v   ( ) is common for all the players in the same                       village v .8 We note that given the (conditional) in-
dependence assumptions in C2 and C3-SD, the forms of the beliefs can be slightly simpli...ed. That
is, the beliefs are a ...xed point of the conditional expectation operator (13) with (Wvh ; Lvh ; uvh ;                                               v)
being conditioning variables; however, we can show that (v; h)'
                                                              s variable Wvh is irrelevant in pre-
dicting other (v; k )'
                     s variables in that

                                     (Wvk ; Lvk ; uv (Lvk )) ? Wvh j (Lvh ; uv (Lvh ) ;                            v) ,                           (18)

and accordingly, the ...xed point solution is a function of (Lvh ; uvh ;                                          v)   without Wvh .9 Thus, with
     8
         This can be justi...ed under C1, C2, and C3-SD when the mapping from a [0; 1]-valued function g ( ) to another
[0; 1]-valued function:            " (                                                                            )          #
                                          U1 (Yvk      Pvk ; g (Wvk ; Lvk ; uv (Lvk );         v );     vk )
                                E 1                                                                                    Ivh                        (17)
                                                 U0 (Yvk ; g (Wvk ; Lvk ; uv (Lvk );        v );   vk )

is a contraction, where Ivh = (Wvh ; Lvh ; uvh ;        v ).   This contraction condition for the functional mapping is analogous
to that for the function mv (r) (de...ned in (8)) in Proposition 2. The proof of symmetric equilibrium beliefs                                    v   ()
is similarly analogous to the proof of Proposition 2, and is omitted for brevity. We provide and discuss a su¢ cient
condition for (17) to be a contraction in Appendix A.3.
   9
     We can prove (18) as follows: The sequence f(Wvh ; Lvh )gNv
                                                              h=1 is conditionally I.I.D. given                                        v   (by C2) and
thus it is also conditionally independent of the stochastic process fuv (l)g given                                     v   (by C3-SD (ii)). Therefore,
f(Wvh ; Lvh )gN v
              h=1     is conditionally i.i.d. given (fuv (l)g ;          v ),   implying that

                                               (Wvh ; Lvh ) ? (Wvk ; Lvk ) j(fuv (l)g ;               v ).


Since it also holds that (Wvh ; Lvh ) ? fuv (l)g j             v,   we apply the conditional independence relation (63) with Q =
(Wvh ; Lvh ), R = (Wvk ; Lvk ), and S = fuv (l)g, to obtain

                                       (Wvk ; Lvk ; fuv (l)g) ? (Wvh ; Lvh ) j          v

                                 )     (Wvk ; Lvk ; fuv (l)g) ? Wvh j (Lvh ;           v)

                                 )     (Wvk ; Lvk ; uv (Lvk ) ; uv (Lvh )) ? Wvh j (Lvh ;                    v)

                                 )     (Wvk ; Lvk ; uv (Lvk )) ? Wvh j (Lvh ; uv (Lvh ) ;                    v)

where the derivations of the second and fourth lines have used the following conditional independence relation: for ran-
dom objects T , U , V , and C , if T ? (U; V ) jC , then T ? U j (V; C ); for the second line, we set T = (Wvk ; Lvk ; fuv (l)g),
U = Wvh , and V = Lvh , with C =          v;   and for the fourth line, T = Wvh , U = (Wvk ; Lvk ; uv (Lvk )), and V = uv (Lvh )
with C = (Lvh ;      v ).




                                                                          18
slight abuse of notation, we write

                                                                vh   =       v (Lvh ; uvh ; v ).                                                                   (19)

       Linear Index Structure: We now specify the forms of the utility functions. With few large
peer-groups (e.g. there are eleven large villages in our application dataset), one cannot consistently
estimate the impact of the belief                      vh   on the choice probability function nonparametrically holding
other regressors          constant.10         Accordingly, following Manski (1993), and Brock and Durlauf (2001a,
2007), we assume a linear index structure with                                        = ( 0;         1 )0   viz. that utilities are given by

                                          U1 (y        p; ; ) =                  +                                           1,
                                                                             1         1 (y         p) +             1   +
                                                                                                                                                                   (20)
                                          U0 (y; ; ) =                   +                               0,
                                                                     0           0y   +        0    +

where corresponding to Assumptions 1 - 2, we assume that                                                         0   > 0,     1   > 0, i.e., non-satiation in
numeraire,        1   need not equal              0,   i.e. income e¤ects can be present, and that                                              1         0   0,   i.e.,
compliance yields higher utility. These utilities can be viewed as expected utilities corresponding to
Bayes-Nash equilibrium play in a game of incomplete information with many players, as outlined in
Section 2 above. Below in Section 4, we will provide more details on interpretation of the individual
coe¢ cients in (20) when discussing welfare calculations. These details do not play any role in the
rest of this section.
       Using (20) and the structure of                                =           + uvh (see (3)) with                                     0;
                                                                                                                                      := ( v        1 0
                                                             vh              v                                                    v                 v)    and uvh :=
(u0     1 0
  vh ; uvh ) , it follows that


              U1 (Yvh        Pvh ;       vh ;   vh )    U0 (Yvh ;            vh ;      vh )
                                                                                                                         1        0
               =(     1      0)   +(     1       0 ) Yvh             1 Pvh   +(        1            0)      vh   +       v        v   + u1
                                                                                                                                         vh          u0
                                                                                                                                                      vh

                  c1 Pvh + c2 Yvh +               vh   +    v   + "vh ,                                                                                            (21)

where we have de...ned                   := c0 +        1        0       .
                                     v                  v        v
       Recall that the probabilistic conditions in C2 and C3-SD are stated conditional on the (realized
values of) village-...xed unobserved heterogeneity                                         v,      as in the econometric literature on ...xed-
e¤ects panel data models. In this sense, we can treat                                               v    as non-stochastic. Indeed, given many
observations per villages, the (realized) values of                                        v       can be estimated and are included in a set
of parameters to be estimated. We discuss this point further in Section 4.4 below.
       Econometric Speci...cations: We now present the alternative estimators. To do this, we need
some more notation. Let                   1   = (c0 ; )0 denotes a (preference) parameter vector, where c = (c1 ; c2 )0
is the coe¢ cient vector corresponding to Wvh = (Pvh ; Yvh )0 . In the rest of this Section 3, we
  10
       This is because     vh   is constant within a village in the (conditionally) I.I.D. case, and this constancy also holds for
the limit model in the spatial case. In particular, the ...xed point constraint does not help because of dimensionality
                                                   R
problems. Indeed, the ...xed point condition: = q1 (p; y; ) dFP;Y (p; y ), where FP;Y (p; y ), the joint CDF of (P; Y )
is identi...ed, the unknown function q1 (p; y; ) has higher dimension than the observable FP;Y (p; y ).




                                                                                  19
assume that the village-...xed parameters                 1; : : : ; v       are known, which is for notational simplicity;
this assumption does not change any substantive arguments on the convergence of the estimators.
We discuss identi...cation/estimation schemes of these parameters below and provide a complete
proof for the case when           1; : : : ; v   are estimated using one of the identi...cation schemes (e.g. the
homogeneity assumption) in Appendix A.4. Given (19) and (21), we can write

                                         0
                                Avh = 1 Wvh c+             v   +        v (Lvh ; uvh )   + "vh         0 :                                (22)

In order to incorporate the ...xed-point feature of                      v   in estimation, where we write                     v (Lvh ; uvh )   =
 v (Lvh ; uvh ; v )    for notational simplicity, we can assume a parametric model of spatial dependence
for the stochastic process f"vh g, which is required to compute the functional equations de...ning v .
Corresponding to the de...nition of uvh = uv (Lvh ) with uv (l) = (u0 (~
                                                                       l); u1 (~
                                                                               l)), we let "vh = "v (Lvh ),
                                                                                             v      v
where f"v (l)g is a stochastic process de...ned as "v (l) =                       u1 ej e; jj~
                                                                                   v (l)
                                                                              let H (~        0
                                                                                            uv (l). We
                                                                                             l ljj; 2 )
                                       ~      1 ~      0  ~
be the conditional distribution of "v (l) = uv (l) uv (l) given "v (l) = e, parametrized by a ...nite
dimensional parameter 2 2 2 , and the (pseudo) true value is denoted by 2 . We also write the
marginal CDF of "v (~    l) by H (e) and its probability density h (e). In the sequel, we also write the
marginal CDF of "v (~      l) as F" (e), and thus H (e) = 1 F" ( e). The joint distribution function
                      R
of ("v (~                     ej s; j~
        l); "v (l)) is s e H (~      l lj1 ; 2 )h (s) ds, given the location indices ~
                                                                                     l and l.11
       To develop estimators that incorporate the ...xed point restriction, de...ne the following functional
operator based on H :

                ?
               Fv;Nv
                     [g ] (l; e; 1 ; 2 )
                  Z Z
               :=         1fw ~ 0 c + v + g (~  ~;
                                             l; e        1; 2)     +e
                                                                    ~               eje; j~
                                                                              0gdH (~     l          lj1 ;        v
                                                                                                                       ~ ~
                                                                                                             2 )dFW L (w; l);             (23)

                              ?
for v = 1; : : : ; v , where Fv;N  is a functional operator from a [0; 1]-valued function g = g (l; e;
                                 v                                                                                                       1; 2)

to another                ?
              function Fv;N              v (w; l)
                              [g ], and FW                     is the joint CDF of (Wvh ; Lvh ). We provide su¢ cient
                            v              L
conditions              ?
              for this Fv;Nv to be a contraction               in Appendix A.3.
       Given the above set-up, de...ne the model to be estimated as:

                               0                         ?
                      Avh = 1 Wvh c+             v   +   v (Lvh ; "vh ; 1 ; 2 )     + "vh        0       1= 1 ;    2= 2
                                                                                                                          ;               (24)

where      1 (=   (c 0 ;   )0 ) and   2   denote the true parameters and                    ?
                                                                                            v (Lvh ; "vh ; 1 ; 2 )            is a solution to
the functional equation de...ned through the operator (23) (for each ( 1 ;                                   2)   given):

                                                               ?
                                                            = Fv;Nv
                                                                    [ ];                                                                  (25)
  11
    This speci...cation implies pairwise stationarity of f"v (l)g, i.e. the joint distribution of "v (~
                                                                                                      l) and "v (l) depends
only on the distance j~l lj1 . Stationarity is not strictly necessary for our purpose but is maintained for simplicity.
We could also specify the full joint distribution of the whole "v (l) (for any l 2 Lv , or for any l1 ; l2 ; : : : ; lq 2 Lv with
q being any ...nite integer; say, a Gaussian process), which would not a¤ect our estimation method.




                                                                   20
and C1, C2, C3-SD, and some regularity conditions (provided below) are satis...ed. Henceforth,
the model (24) will be assumed to be the DGP of observable variables f(Avh ; Wvh ; Lvh )gNv
                                                                                         h=1 (v =
1; : : : ; v ).


3.1        Econometric Estimators

De...nition of the Estimand: Suppose for now that the true parameter                                  2   for the spatial depen-
dence is given. Then, based on (22), we de...ne the true preference parameter                             1   (i.e., our estimand)
as the solution to the conditional moment restriction:

                          E [fAvh     Cv (Wvh ; Lvh ;   1 ; 2 )g jWvh ; Lvh ]    = 0 (v = 1; : : : ; v ),                         (26)

where Cv is the conditional choice probability function12 :
                                   Z
                                         0              ?
         Cv (Wvh ; Lvh ; 1 ; 2 ) := 1 Wvh  c+ v +      v (Lvh ; e;                       1; 2)   +e       0 dH (e) :              (27)

        Practical Estimator Based on the Limit Model: Given our parametric set-up, we can in
principle compute an empirical analogue of (27) by solving an empirical version of the ...xed point
equation (25). This estimator, denoted below by ^SD , is di¢ cult to compute in practice. Therefore,
                                                                  1
we consider an alternative estimator based on the simpler conditional moment condition:

                                            0
                           E [ Avh      F" Wvh c+       v   +     v    jWvh ] = 0 (v = 1; : : : ; v ).                            (28)

This is derived from the limit model with the limit beliefs                v,   which do not depend on the unobserved
heterogeneity and other (v; h) speci...c variables. Indeed, the limit model is not the true DGP, and
thus this (28) is mis-speci...ed under C3-SD (it is correctly speci...ed under C3-IID). Nonetheless,
we show that the estimator based on (28), which we eventually use in our empirical application,
can be justi...ed in an asymptotic sense. This simpler estimator is given by:

                                                ^BR = argmax L
                                                             ^ BR ( 1 ) ;
                                                 1
                                                            12    1


where
                                                Nv
                                              v X
                                              X
                              ^ BR ( 1 ) := 1
                              L                                0
                                                   Avh log F" Wvh c+                      v   + ^v
                                            N
                                                 v =1 h=1
                                                                          0
                                         +(1     Avh ) log 1          F" Wvh c+      v   + ^v         ;                           (29)

where     = (c0 ; )0 , 1 is the parameter space that is compact in Rd1 with d1 1 being the dimension
            1
              P
of Wvh , N = v   v =1 Nv , and the constant beliefs, v , (that appear in the limit model) are estimated
          1 PNv
by ^v = Nv h=1 Avh . We use the label `      BR'for this estimator, as it is based on the Brock and
   12
        Note that all the (conditional) expectations, E [ ] and E [ j ] in this Section 3 are taken with respect to the law
of Avh , Wvh , Lvh , and "vh (= "v (Lvh ), or uvh = uv (Lvh ) conditional on the unobserved heterogeneities             v   (or   v ).




                                                                 21
Durlauf (2001a) type formulation. This estimator ^1 is easy to compute as its objective function
^ BR ( ) requires neither solving ...xed point problems nor any numerical integration, in which the
L
belief formulation is based on the limit model with constant beliefs v . Below, we show that the
complicated estimator ^SD (based on (24)) and the simpler one ^1 have the same limit.
                               1

   Potential Estimator for the Finite-Player Game: We now formally introduce the com-
putationally di¢ cult potential estimator ^1
                                           SD based on (26). It is de...ned through the following

objective function:

         ^ SD ( 1 ;
         L            2)
              v Nv n                                                                    h                                  io
            1 XX            ^ (Wvh ; Lvh ;                                                     ^ (Wvh ; Lvh ;
         :=         Avh log C                            1; 2)     + (1        Avh ) log 1     C                   1; 2)
            N
                 v =1 h=1

      ^ is an estimate of the conditional choice probability that explicitly incorporate conditional-
where C
belief and ...xed-point features:
                                             Z    n                                                        o
             ^ (Wvh ; Lvh ;
             C                  1; 2)   :=          0
                                                 1 Wvh c+      v   +      ^? (Lvh ; e;    1; 2)   +e      0 dH (e) ;            (30)
                                                                           v


and ^v
     ? (L ; e;
         vh           1; 2)   is an estimator of the belief and is de...ned as a solution to the following
functional equation for each ( 1 ;           2 ):

                                                  ^v;N
                                                 =F ?
                                                        [ ] for v = 1; : : : ; v:                                               (31)
                                                      v


^?
F                                  ?                                          v                  ^v
  v;Nv is an empirical version of Fv;Nv (de...ned in (23)) in which the true FW;L is replaced by FW;L :

              ^ ? [g ] (l; e; 1 ; 2 )
              F v;Nv
                  Z Z
              :=       1fw ~ 0 c + v + g (~  ~;
                                          l; e         1; 2)   +e
                                                                ~               eje; j~
                                                                          0gdH (~     l      l j1 ;       ^v    ~ ~
                                                                                                      2 )dFW;L (w; l):          (32)

This ^v
      ? is an empirical version of a solution to (23). A notable feature of this is that it is a function

of the unobserved heterogeneity (represented by the variable e). Due to this dependence on e,
computation of C ^ in (30) and F^?
                                 v;Nv in (32) is di¢ cult, and requires numerical integration of the
indicator functions; furthermore, ...nding the ...xed point ^? in the functional equation (31) will also
                                                                               v
require some numerical procedure.
      Here, we do not pursue how to identify and estimate the parameter for the spatial dependence
                                                             ^ SD ( 1 ; 2 )), but suppose the availability
     (since our empirical application is not anyway based on L
 2
                                                    p
of some reasonable preliminary estimator ^2 with ^2 !                          2,   and de...ne our estimator as

                                                              ^ SD ( 1 ; ^2 ):
                                                 ^SD = argmax L
                                                  1
                                                          12   1


Note that given this form of ^1
                              SD , we can again interpret this estimator as a moment estimator that

solves
                                        Nv
                                      v X
                                      X                            n                                         o
                 ^ SD ( 1 ; ^2 ) := 1
                 M                         ! (Wvh ;            1 )  Avh             ^ Wvh ; Lvh ;
                                                                                    C                   ^
                                                                                                      1; 2       = 0;
                                    N
                                         v =1 h=1




                                                               22
with some appropriate choice of the weight ! Wvh ;                            ^ . This may be viewed as a sample
                                                                            1; 2

moment condition based on the population one in (26). The corresponding estimation procedure
would be similar to the nested ...xed-point algorithm, as in Rust (1987).


3.2         Convergence of the Estimators
                                   p
We now show that jj ^1 SD    ^1 jj ! 0, i.e., ^1
                                               SD based on the correct condition moment restriction

(26) and ^1 based on the mis-speci...ed one (28) are asymptotically equivalent. That is, if ^1 is
consistent, so is ^SD and vice versa; in the proof, we show that both the estimators are consistent
                       1
for     1   that satis...es (93). This is formally stated in the following theorem:

Theorem 2 Suppose that C1, C2, C3-SD, Assumptions 4, 5, 6, 7, and 8 hold. Then

                                                     jj ^1
                                                         SD     ^1 jj = op (1) :

       The formal proof is provided in Appendix A.4; the outline is as follows. We start by introducing
another, intermediate estimator that is based on constant beliefs but solves the Fixed Point problem
of the Limit model, ^FPL = argmax L
                            1
                                    ^ FPL ( 1 ), where
                                      12   1


                                            v Nv
                           ^ FPL          1 XX               0                                   ?
                           L     ( 1 ) :=        Avh log F" Wvh c+                        v   + ^v ( 1)
                                          N
                                               v =1 h=1
                                                                         0                   ?
                                     + (1       Avh ) log 1          F" Wvh c+        v   + ^v ( 1)            ;

where            ? ( ) 2 [0; 1] is a solution to the ...xed point equation for each
              = ^v                                                                                            (...xed):
                     1                                                                                   1
                                            Z
                                          = F" (w0 c + v + )dF      ^ v (w);                                                  (33)
                                                                     W

           ? ( ) 2 [0; 1] is a sample version of ? ( ) that solves
Note that ^v   1                                 v   1
                                      Z
                                   = F" (w0 c + v + )dFW     v
                                                               (w);                                                           (34)

                                             ^ v replaced by the true CDF F v of Wvh . This ^FPL is
which is the population version of (33) with FW                            W                 1
constructed based on the limit model (with constant beliefs), but it explicitly solves the ...xed point
restriction (33) (unlike ^1 derived from the Brock-Durlauf type moment restriction (28)). ^FPL may                        1
be interpreted as a moment estimator that is derived from the conditional moment restriction13 :

                                          0                      ?
                           E Avh     F" (Wvh c+         v   +    v ( 1 ))jWvh      = 0 (v = 1; : : : ; v ).
  13
       Note that ^1
                  FPL                                 ^ FPL ( 1 ) = 0, where, given an appropriate choice of the weight
                      can also be de...ned as solving M
! (Wvh ;     1 ),
                                         Xv XNv
                        ^ FPL ( 1 ) := 1
                        M                       ! (Wvh ;        1)    Avh       0
                                                                            F" Wvh c+         v
                                                                                                     ?
                                                                                                  + ^v ( 1)        :
                                       N v=1
                                               h=1




                                                                 23
Note that this restriction is also a mis-speci...ed one.
   We show the convergence of jj ^1 SD   ^1 jj in two steps. In the ...rst step, we show that ^FPL and ^1
                                                                                               1
have the same limit, which is the solution to a di¤erent conditional moment restriction (See (93) in
Appendix A.4). In the second step, we show that L   ^ SD ( 1 ; ^2 ) is asymptotically well approximated
   ^ FPL ( 1 ) uniformly over
by L                              1   2   1   for any sequence of ^2 (as N ! 1).


4    Welfare Analysis
We now move on to the second part of the paper, which concerns welfare analysis of policy inter-
ventions under spillovers. Since we assume spillovers are restricted to the village where households
reside, any welfare e¤ect of a policy intervention can be analyzed village by village. So for economy
of notation, we drop the (v; h) subscripts except when we account explicitly for village-...xed e¤ects
during estimation. Also, we use the same notation                to denote both individual beliefs entering
individual utilities, and the unique, equilibrium belief about village take-up rate entering the av-
erage demand function. The assumption of a constant (within village)                is justi...ed via the results
Proposition 10, Proposition 11 and Theorem 1.
    In the welfare results derived below, all probabilities and expectations ­e.g. mean welfare loss
­in Sections 4.1-4.3 are calculated with respect to the marginal distribution of aggregate unobserv-
ables, denoted by    =    vh   above and below. In this sense, they are analogous to `
                                                                                     average structural
functions'(ASF), introduced by Blundell and Powell (2004). Later, when discussing estimation of
the ASF, together with the implied pre- and post-intervention aggregate choice probabilities and
average welfare in Section 4.4, we will allude to village-...xed e¤ects explicitly, and show how they
are estimated and incorporated in demand and welfare predictions.

    In order to conduct welfare analysis, we impose two restrictions on the utilities.

Assumption 1 U1 ( ; ; ) and U0 ( ; ; ) (introduced in (1) in Section 2) are continuous and
strictly increasing for each ...xed value of        and    , i.e., all else equal, utilities are non-satiated in
the numeraire.

Assumption 2 For each y and , U1 (y; ; ) is continuous and strictly increasing, and U0 (y; ; )
is continuous and weakly decreasing, i.e. conforming yields higher utility than not conforming for
each individual.

    De...ne q1 (p; y; ) to be the structural probability (i.e. Average Structural Function or ASF) of
a household choosing 1 when it faces a price of p, and has income y and belief :
                                 Z
                    q1 (p; y; ) = 1 fU1 (y p; ; s) > U0 (y; ; s)g dF (s) ,                                  (35)

and let q0 (p; y; ) = 1   q1 (p; y; ), where F is the CDF of            vh




                                                          24
     Policy Intervention: Start with a situation where the price of alternative 1 is p0 and the value
of    is   0.   Then suppose a price subsidy is introduced such that that individuals with income less
than an income threshold               become eligible to buy the product at price p1 < p0 . This policy will
alter the equilibrium adoption rate; suppose the new equilibrium adoption rate changes to                                       1.   How
the counterfactual       1   and   0    are calculated will be described below. For given values of                         0   and    1,

we now derive expressions for welfare resulting from the intervention. By "welfare" we mean the
compensating variation (CV), viz. what hypothetical income compensation would restore the post-
change indirect utility for an individual to its pre-change level. For a subsidy-eligible individual,
for any potential value of          1   corresponding to the new equilibrium, the individual compensating
variation is the solution S to the equation

                                   max fU1 (y + S         p1 ;        1;     ) ; U0 (y + S;        1;   )g
                                   = max fU1 (y         p0 ;     0;        ) ; U0 (y;    0;   )g ,                                   (36)

whereas for a subsidy-ineligible individual, it is the solution S to

                                   max fU1 (y + S         p0 ;        1;     ) ; U0 (y + S;        1;   )g
                                   = max fU1 (y         p0 ;     0;        ) ; U0 (y;    0;   )g .                                   (37)

Note that we do not take into account peer-e¤ects again in de...ning the CV because the income
compensation underlying the de...nition of CV is hypothetical. So the impact of actual income
compensation on neighboring households is irrelevant. Since the CV depends on the unobservable
 , the same price change will produce a distribution of welfare e¤ects across individuals; we are
interested in calculating that distribution and its functionals such as mean welfare.

     Existence of S : Under the following condition, there exists an S that solves (36) and (37):

Condition For any ...xed           and (p0 ; p1 ; y ), it holds that (i) limS &                   1 U1 (y    +S   p1 ; 1; ) < U1 (y         p0 ; 0; ),
       and (ii) limS %1 U0 (y + S; 1; ) > U0 (y; 0; ).

     Intuitively, this condition strengthens Assumption 1 by requiring that utilities can be increased
and decreased su¢ ciently by varying the quantity of numeraire. Existence follows via the inter-
mediate value theorem. Under an index structure, existence is explicitly shown below. Finally,
uniqueness of the solution to (36) and (37) follows by strict monotonicity in numeraire. Since the
maximum of two strictly increasing functions is strictly increasing, the LHS of (36) and (37) are
strictly increasing in S , implying a unique solution.

     Welfare with Index Structure: In accordance with the literature on social interactions (see
Section 3 above), from now on we maintain the single-index structure introduced in (20):

                                   U1 (y     p; ; ) =           +                                       1.
                                                            1              1 (y   p) +        1   +
                                   U0 (y; ; ) =         +                               0,
                                                    0           0y    +      0    +



                                                                 25
with          > 0,       > 0, and                   0             14
          0          1                     1                    0.      In our empirical setting of anti-malarial bednet adoption,
there are multiple potential sources of interactions (i.e.                                                          1;          0   6= 0). The ...rst is a pure preference
for conforming; the second is increased awareness of the bene...ts of a bednet when more villagers
use it; the third is a perceived negative health externality. The medical literature suggests that the
technological health externality is positive, i.e. as more people are protected, the lower is the malaria
burden, but the perceived health externality is likely to be negative if households correctly believe
that other households' bednet use deects mosquitoes to unprotected households, but ignore the
fact that those deected mosquitoes are less likely to carry the parasite. Indeed, the implications
for adoption are di¤erent: under the positive health externality, one would expect free-riding, hence
a negative e¤ect of others' adoption on own adoption; under the negative health externality, the
correlation would be positive.
       In particular, let         p   > 0 denote the conforming plus learning e¤ect, and                                                                                     H    denote the health
externality. Then it is reasonable to assume that                                                     1             p               0 and                       0   =    H          p    0. In other
words, the compliance motive and learning e¤ect together are equal in magnitude but opposite
in sign between buying and not buying. Further, if a household uses an ITN, then there is no
health externality from the neighborhood adoption rate (since the household is protected anyway),
but if it does not adopt, then there is a net health externality e¤ect                                                                                              H   from neighborhood use,
which makes the overall e¤ect                           0   =       H        p       and              1   6=            0    in         general.15                      In the context of ITNs,
the technological e¤ects are unlikely to be large enough and/or the villagers are unlikely to be
sophisticated enough to understand the potential deterrent e¤ects of ITNs. Therefore, we assume
from now on that the perceived health externality is non-positive, and thus                                                                                                1       0      0.

       Given the linear index speci...cation, the structural choice probability for alternative 1 at (p; y; )
is given by                                                         0                                                                                               1

                                      q1 (p; y; )               F @ c0 + c1 p + c2 y + |{z} A ,                                                                                                    (38)
                                                                   |{z} |{z}   |{z}
                                                                        1        0                1             1           0                   1           0


where F ( ) denotes the marginal distribution function of                                                                (      1               0 ).        It is known from Brock and
Durlauf (2007) that the structural choice probabilities F (c0 + c1 p + c2 y +                                                                                                    ) identify c0 ; c1 ; c2
and       , i.e. (   1     0 ),       0,       1   and (        1           0)   = 2          p                H,    up to scale even without knowledge of
  14
       We can also allow for concave income e¤ects by specifying, say,
                                                                                                                                    0
                                                        U0 (y; ; ) =                 0   +    0   ln y +        0        +              ,
                                                                                                                                                    1
                                                   U1 (y    p; ; ) =                 1   +    1   ln (y         p) +            1           +           ,

but we wish to keep the utility formulation as simple as possible to highlight the complications in welfare calculations
even in the simplest linear utility speci...cation.
  15
     An analogous asymmetry is also likely in the school voucher example mentioned in the introduction if the
voucher-led `brain-drain'leads to utility gains and losses of di¤erent amounts, e.g. if better teaching resources in the
high-achieving school substitute for ­or complement ­peer-e¤ects in a way that is not possible in the resource-poor
local school.




                                                                                             26
the probability distribution of " =                                   (   1        0 ).     In the application, we will consider various ways
to estimate the structural choice probabilities, including standard Logit and Klein and Spady'
                                                                                             s
distribution-free MLE. One can also use other semiparametric methods, e.g. Bhattacharya (2008)
or Han (1987) that require neither speci...cation of error distributions nor subjective bandwidth
choice.
     The condition       1        0               0   makes the model di¤erent from standard demand models for binary.
In the standard case, for the so-called "outside option", i.e. not buying, the utility is normalized
to zero. In a social spillover setting, this cannot be done because that utility depends on the
aggregate purchase rate                   . As we will see below, in welfare evaluations of a subsidy,                                                                         1   and     0

appear separately in the expressions for welfare-distributions, but cannot be separately identi...ed
from demand data, which can only identify                                                     1                   0.      As a result, point-identi...cation of welfare
will in general not be possible. Below, we will consider three untestable special cases, under which
one obtain point-identi...cation, viz. (i)                                    1   = =2 =                               0   (i.e.       H    = 0: no health externality and
symmetric spillover), (ii)                1   = ;                0   = 0 (i.e.          H     =           p:          technological health externality dominates
deection channel and net health externality exactly o¤sets conforming e¤ect) and (iii)                                                                                             1    = 0,
 0   =      (   p   = 0 and       H       =             : no conforming e¤ect and deection channel dominates). Cases
(ii) and (iii) will yield respectively the upper and lower bounds on welfare gain in the general case.
     Toward obtaining the welfare results, consider a hypothetical price intervention moving from a
situation where everyone faces a price of p0 to one where people with income less than an eligibility-
threshold       are given the option to buy at the subsidized price p1 < p0 . This policy will alter the
equilibrium take-up rate. Assume that the equilibrium take up rate changes from                                                                                           0   to   1.    We
will describe calculation of                  0       and        1    later. For given values of                                       0   and       1,      the welfare e¤ect of the
policy change can be calculated as described below. We ...rst lay out the results in detail for the
case where      1   >   0,   which corresponds to our application. In the appendix we present results for
a hypothetical case where                     1   <          0   (which may happen if there are multiple equilibria before and
after the intervention). For the rest of this section, we assume that                                                                            1   >       0.


4.1      Welfare for Eligibles

The compensating variation for a subsidy-eligible household is given by the solution S to

                                                                                                          1                                                           0
                     max      1   +       1 (y         +S             p1 ) +       1 1      +                 ;       0   +    0 (y    + S) +            0 1      +
                                                                                                  1                                                      0
                     = max            1   +       1 (y               p0 ) +       1 0     +           ;       0       +       0y   +   0 0       +                                      (39)

Since LHS is strictly increasing in S , the condition S                                                                a is equivalent to

                                                                                                          1                                                           0
                     max      1   +        1 (y        +a             p1 ) +       1 1      +                 ;       0   +    0 (y    + a) +            0 1      +
                                                                                                  1                                                      0
                        max           1   +           1 (y           p0 ) +       1 0     +           ;           0   +       0y   +       0 0   +            .                         (40)



                                                                                          27
     If a < p1     p0            1
                                 1
                                     (    1          0)    < 0, then each term on the LHS of (40) is smaller than the
corresponding term on the RHS. If a                                  0
                                                                     0
                                                                         (       0           1)   > 0, then each term on the LHS is larger than
the corresponding term on the RHS. This gives us the support of S :
                                   (
                                     0, if a < p1 p0       1
                                                              ( 1                                                                                  0) ,
                      Pr (S a) =                           1

                                     1, if a      0
                                                  0
                                                    ( 0   1) .


Remark 1 Note that the above reasoning also helps establish existence of a solution to (39). We
know from above that for S < p1                            p0            1
                                                                         1
                                                                             (       1           0 ),      the LHS of (39) is strictly smaller than the
RHS, and for S           0
                         0
                             (   0            1 ),   the LHS of (39) is strictly larger than the RHS. By continuity, and
the intermediate value theorem, it follows that there must be at least one S where (39) holds with
equality.

     Back to calculating the CDF, now consider the intermediate case where

                                                                             1                                    0
                                          a 2 [p1           p0                   (       1            0 );            (       0           1 )):
                                                                          1
                                               |                         {z                             } |0              {z                  }
                                                                         <0                                               >0

In this case, the ...rst term on LHS of (40) is larger than ...rst term on RHS for all                                                                                          1,   and the
second term on LHS of (40) is smaller than the second term on the RHS for all                                                                                         0,   and thus (57)
is equivalent to

                        +                                                            1                                                             0
                   1         1 (y    +a              p1 ) +      1 1         +                    0   +       0y      +           0 0     +
                                                                                                                                                                                        (41)
              ,         +                                                                                                 1                                                0.
                   1         1 (y    +a              p1 ) +      1 0         +       1( 1                    0)   +                       0   +        0y   +   0 0   +

For any given      1,   we have that the probability of (41) reduces to

                                         F (c0 +           1( 1              0)      + c1 (p1                 a) + c2 y +                          0)
                                                                                         1
                                         = q1 (p1           a; y;        0   +               (    1           0 )).                                                                     (42)

The intercept c0 , the slopes c1 ; c2 and                            are all identi...ed from conditional choice probabilities; but
 1   is not identi...ed, and therefore (42) is not point-identi...ed from the structural choice probabilities.
However, since      1   2 [0; ], for each feasible value of                                            1   2 [0; ], we can compute a feasible value of
(42), giving us bounds on the welfare distribution.
     Note also that the thresholds of a at which the CDF expression changes are also not point-
identi...ed for the same reason. However, since                                          1            0    > 0 and                    0   > 0,          1   > 0, the interval

                                                                 1                                                    0
                                              p1      p0             (       1           0)           a<                  (       0           1)
                                                                 1                                                    0

will translate to the left as                 1    varies from 0 to .
     Putting all of this together, we get the following result:



                                                                                         28
Theorem 3 If Assumptions 1, 2, and the linear index structure hold and                                                                                         1    >      0,   then given
 1   2 [0; ], the distribution of the compensating variation for eligibles is given by

     Pr S Elig     a
       8
       >
       < 0,                                                             if a < p1                  p0                   (                    0) ,
                                                                                                                    1
       >                                                                                                            1
                                                                                                                                1
     =     q1 p1       a; y;    0   +   1
                                            (    1           0)      , if p1          p0               1
                                                                                                            (    1                  0)           a<            1
                                                                                                                                                                   (   1        0) ,       (43)
         >
         >                                                                                             1                                                   0
         : 1,                                                           if a                       (                    0) .
                                                                                               1
                                                                                           0
                                                                                                        1




Remark 2 Note that the above theorem continues to hold even if the subsidy is universal; we have
not used the means-tested nature of the subsidy to derive the result.

     Mean welfare: From (43), mean welfare loss is given by
                               Z    0
                                                                                                                1
                                                                     q1 p 1      a; y;         0    +               (       1               0)    da
                                   p 1 p0        1(
                                                    1        0)
                                                 1
                           |                                                    {z                                                                    }
                                             Welfare gain (smallest when                       1 =0,            0=          )
                                Z           1(
                                                 1      0)   h                                                                                        i
                                        0                                                                               1
                            +                                    1     q1 p 1         a; y;            0   +                (       1            0)       da                               (44)
                                |0                                                   {z                                                                    }
                                                         Welfare loss (=0 when                      0 =0,           1=          )

     Discussion: The width of the bounds on (43) and (44), obtained by varying                                                                                             1    over [0; ],
depends on the extent to which q1 ( ; ; ) is a¤ected by , i.e. the extent of social spillover, and
also the di¤erence in the realized values                               1   and           0.       For our single-index model, the ...xed point
restrictions imply that these counterfactual                                1   and       0    depend on                            1   and       0   only via             =     1     0   (c.f.
(56) and (57) below) which is point-identi...ed, so every potential value of counterfactual demand is
point-identi...ed. But given any feasible value of                                    1   and              0,   the welfare (44) is not point-identi...ed
in general since       1   is unknown.
     Given , the welfare gain in expression (44) is increasing in                                                           1;          i.e., the welfare gain is largest in
absolute value when            1    =       and      0       = 0, and the smallest when                                                 1   = 0 and            0   =       . Conversely
for welfare loss. Intuitively, if there is no negative externality from increased                                                                                  on non-purchasers,
then they do not su¤er any welfare loss, but purchasers have a welfare gain from both lower price
and higher . Conversely, if all the spillover is negative, then purchasers still get a welfare gain via
price reduction, but non-purchasers su¤er welfare loss due to increased . Also, note that under
quasilinear utilities, where income e¤ects are absent, the y drops out of the above expressions,
but the same identi...cation problem remains, since                                                1    does not disappear. Changing variables




                                                                                 29
p = p1    a, one may rewrite (44) as
                         Z p0 + 1 ( 1                             0)
                                                     1                                                        1
                                                                       q1 p; y;           0   +                   (   1                   0)      dp
                                        p1
                                    |                                        {z                                                                    }
                                                                           Welfare gain
                                    Z    p1                           h                                                                                    i
                                                                                                                          1
                               +                                       1        q1 p; y;                  0+                  (       1           0)           dp.                         (45)
                                        p1 +      0(
                                                     1           0)
                                                  0
                                    |                                                     {z                                                                       }
                                                                                 Welfare Loss

Note that if     1   = 0, then the ...rst term is the usual consumer surplus capturing the e¤ect of price
reduction on consumer welfare; for a positive                                        1,   the term                            1
                                                                                                                              1
                                                                                                                                  (       1           0)   yields the additional e¤ect
arising via the conforming channel. Also, if                                         1    = 0, then the second term, i.e. the welfare loss
from not buying, is the largest (given ): this corresponds to the case where all of                                                                                                is due to the
negative externality.
   The second term in (45), which represents welfare change caused solely via spillover and no
price change, is still expressed as an integral with respect to price. This is a consequence of the
index structure which enables us to express this welfare loss in terms of foregone utility from an
equivalent price change. To see this, recall eq. (39)
                                                                                                      1                                                                        0
                     max       1   +     1 (y     +S              p1 ) +         1 1      +               ;   0   +           0 (y        + S) +               0 1         +
                                                                                              1                                                                0
                     = max         1    +        1 (y        p0 ) +            1 0   +            ;       0   +           0y      +           0 0     +                ;

which is equivalent to
           8           0                                                                                                                                                       1     9
           >
           >                                                                                                                                                                         >
                                                                                                                                                                                     >
           >
           >           B                                                                                                                                                        C    >
                                                                                                                                                                                     >
           >
           >           B                                                                                                                                                        C    >
                                                                                                                                                                                C+ ; >
                               0 0            0                                                                                                   1                    0           1
           >
           >    1 + 1B y+             +S+       ( 1  0)                                                                       p1                       1   +               1         >
                                                                                                                                                                                     >
           >
           >           @        0            0                                                                                                    1                    0        A    >
                                                                                                                                                                                     >
           >
           >            |   {z      }  |        {z    }                                                                   |                           {z                       }     >
                                                                                                                                                                                     >
           <                                                                                                                                                                         =
                            y0                  S0                                                                                                    p0
       max                         0                                                                                                                  11
           >
           >                                                                                                                                                                           >
                                                                                                                                                                                       >
           >
           >                       B                                                                                                                 C                                 >
                                                                                                                                                                                       >
           >
           >                       B                                                                                                                 C                                 >
                                                                                                                                                                                       >
           >
           >                +      B y+
                                            0 0
                                                   +S+
                                                                                                                      0
                                                                                                                          ( 1                     0 )C +
                                                                                                                                                                   0                   >
                                                                                                                                                                                       >
           >
           >              0      0
                                   @                                                                                                                 A                                 >
                                                                                                                                                                                       >
           >
           >                         |   {z
                                             0
                                                 } |
                                                                                                                      0
                                                                                                                          {z                       }                                   >
                                                                                                                                                                                       >
           :                                                                                                                                                                           ;
                                                                           y0                                             S0
                 8                 0                                                                                                      1 9
                 >
                 >                                                                                                                          >
                                                                                                                                            >
                 >
                 >                 B                                                                                                   C    >
                                                                                                                                            >
                 >
                 >                 B         0 0                                              1 0                     0 0              C    >
                                                                                                                                            >
                 >
                 >         +       1B  y+                                       p0                            +                        C+ ; >
                                                                                                                                          1
                                                                                                                                            >
                 >
                 >
                       1
                                   @                                                                                                   A    >
                                                                                                                                            >
                 <                   |    {z
                                              0
                                                 }                         |
                                                                                               1
                                                                                                  {z
                                                                                                                          0
                                                                                                                                      }     =
         = max                                        y0                                          p0                                          ,
                 >
                 >                                                                                 0                                        >
                                                                                                                                            >
                 >
                 >                                                                   0 0                                                    >
                                                                                                                                            >
                 >
                 >                                       0   +    0       y+                      +           0                             >
                                                                                                                                            >
                 >
                 >                                                                                                                          >
                                                                                                                                            >
                 >
                 >                                                    |         {z
                                                                                      0
                                                                                              }                                             >
                                                                                                                                            >
                 :                                                                                                                          ;
                                                                                y0

which is of the form

                           max               1   +       1   y0 + S 0            p0
                                                                                  1 +                 1; 0        +           0       y0 + S 0 +                   0

                               = max              1   +      1    y0        p0
                                                                             0 +           1; 0               +       0y
                                                                                                                              0
                                                                                                                                  +           0   ,



                                                                                      30
i.e.
                  max U1 y 0 + S 0           p0
                                              1;      ; U0 y 0 + S 0 ;                     = max U1 y 0                         p0
                                                                                                                                 0;       ; U0 y 0 ;            .

From Bhattacharya, 2015, this is exactly the form for the compensating variation S 0 in a binary
choice model without spillover when income is y 0 and price changes from p0     0 16
                                                                          0 to p1 .


Corollary 1 In the special case of symmetric interactions, i.e. where                                                                 1   =          0   in (20) (e.g. if
 H        = 0, i.e. there is no health externality in the health-good example), we get that                                                               1
                                                                                                                                                               =     2
                                                                                                                                                                         0
                                                                                                                                                                          0
                                                                                                                                                                              =1
                                                                                                                                                                               2,
and from (45) mean welfare equals:
    Z p0 + ( 1 0 )                                                Z p1
          2 1              1                                                                                                              1
                   q1 p; y; ( 1 +                        0 ) dp +                                                  1     q1 p; y;           (   1   +     0)        dp. (46)
     p                     2                                       p                           (         0)
                                                                                                                                          2
  | 1                {z                                       } | 1                     2 0        1
                                                                                                                               {z                                        }
                           welfare gain                                                                                 welfare loss

If        0   = 0, and    =    1,   i.e. all spillover is via conforming, average welfare is given by
                                                  Z p0 + ( 1 0 )
                                                          1
                                                                  q1 (p; y; 1 ) dp;                                                                                           (47)
                                                    p1
                                                |              {z                }
                                                                     welfare gain

if on the other hand, all spillover is due to perceived health risk, i.e.                                                             =         0    and       1    = 0, then
average welfare is given by
                        Z p0                                         Z    p1
                                          q1 (p; y;     0 ) dp   +                                      [1         q1 (p; y;        0 )] dp.                                  (48)
                                    p1                                   p1            (   1       0)
                               |             {z             }        |             0
                                                                                                         {z                                }
                                         welfare gain                                              welfare loss

          Equations (47) and (48) correspond to the upper and lower bounds, respectively, of the overall
welfare gain for eligibles.17


4.2           Welfare for Ineligibles

Welfare for ineligibles is de...ned as the solution S to the equation

                                         max fU1 (y + S              p0 ;          1;      ) ; U0 (y + S;                 1;    )g
                                         = max fU1 (y             p0 ;        0;        ) ; U0 (y;            0;       )g .
     16
          Analogously, the choice probabilities have the form

                   q1 (p; y; ) = F (c0 + c1 p + c2 y +           )=F          c0 + c 1 p +                             + c2 y         q1 p +             ;y ,
                                                                                                         c1                                         c1
i.e. the choice probabilities under spillover at price p; income y and aggregate use                                                      can be expressed as choice-
probabilities in a binary choice model with no spillover at an adjusted price and the same income.
  17
     In independent work, Gautam (2018) obtained apparently point-identi...ed estimates of welfare in parametric
discrete choice models with social interactions, using Dagsvik and Karlstrom (2005)'s expressions for the setting
without spillover. Even with strong restrictions, under which welfare is point-identi...ed, our welfare expressions (c.f.
eqn (46), (47), (48)) are di¤erent from Gautam's.




                                                                               31
Using the index-structure, S                                          a is therefore equivalent to

                                                                                                                1                                                                           0
                            max               1   +            1 (y     +a          p0 ) +       1 1   +            ;       0   +       0 (y        + a) +          0 1         +
                                                                                                            1                                                       0
                                     max              1    +        1 (y        p0 ) +        1 0      +        ;       0   +       0y      +        0 0   +                .                                          (49)

        If a <     1
                   1
                       (    0            1)   < 0, then each term on the LHS is smaller than the corresponding term on
the RHS for each realization of the s. So the probability is 0. Similarly, for a                                                                                                                0
                                                                                                                                                                                                0
                                                                                                                                                                                                     (   0        1)   > 0,
each term on the LHS is larger, and thus the probability is 1. In the intermediate range, a 2
[   1
    1
        (   0     1) ;
                            0
                            0
                                 (   0            1 )),        we have that the ...rst term on the LHS exceeds the ...rst term on the
RHS for each                1,   and the second term on the LHS is smaller than the second term on the RHS for
each        0.   Therefore, (49) is equivalent to

                                                                                                            1                                                               0
                                          1       +        1 (y     +a              p0 ) +       1 1   +                        0   +       0y      +    0 0    +               .

The probability of this event is not point-identi...ed if the values of                                                                                    1,       0   are not known. But for
each choice of               1   2 [0; ], we can compute the probability of this event as

                                                                                                                                                                                1
                F (c0 +          1( 1                     0)   + c1 (p0              a) + c2 y +                0)      = q1 p 0                     a; y;      0   +                   (   1            0)   .

        Putting all of this together, we have the following result:

Theorem 4 If Assumptions 1, 2, and the linear index structure hold and                                                                                                          1   >           0,   then for each
    1   2 [0; ],

                   Pr S Inelig                        a
                     8
                     >
                     < 0,                                                                                   if a <                      (                1) ,
                                                                                                                                    1
                     >                                                                                                              1
                                                                                                                                                0
                   =         q1 p 0                   a; y;           0   +     1
                                                                                    (   1        0)    , if             1
                                                                                                                            (       0           1)       a<             0
                                                                                                                                                                            (       0           1) ,                   (50)
                           >
                           >                                                                                            1                                               0
                           : 1,                                                                             if a                        (                1) .
                                                                                                                                    0
                                                                                                                                    0
                                                                                                                                                0

        For ineligibles, all of the welfare e¤ects come from spillovers, since they experience no price
change. In particular, for ineligibles who buy, there is a welfare gain from positive spillover due
to a higher            . For ineligibles who do not buy, there is, however, a potential welfare loss due to
increased . This is why the CV distribution has a support that includes both positive and negative
values. From (50), mean compensating variation is given by
                     Z 0
                                                   1
                             q1 p0 a; y; 0 +         ( 1   0 ) da
                                                  1(
                                                     0              1)
                                                  1
                                     |                                                      {z                                                       }
                                                                                     Welfare gain
                                              Z                1(
                                                                    1      0)   n                                                                                   o
                                                           0                                                                                1
                                      +                                          1          q1 p 0       a; y;              0+                  (   1        0)             da.                                        (51)
                                                  0
                                              |                                                         {z                                                                   }
                                                                                                 Welfare loss




                                                                                                       32
Using the change of variables, p = p0                                                        a, the above expression becomes
                                                             Z   p0 +    1(
                                                                            1       0)
                                                                         1                                           1
                                                                                         q1 p; y;         0   +           (   1            0)      dp
                                                              p0
                                                    |                                         {z                                                    }
                                                                                             Welfare gain
                                                             Z    p0                     n                                                               o
                                                                                                                                  1
                                                     +                                    1          q1 p; y;       0+                (    1        0)       dp.                                  (52)
                                                                 p0 +    0(
                                                                            1       0)
                                                                         0
                                                             |                                               {z                                               }
                                                                                                       Welfare loss

The ...rst term in (52) captures the welfare gain resulting from a positive                                                                                         1       and higher           ; this
term would be zero if                                    1   = 0. The second term in (52) captures the welfare loss also resulting from
higher           ; this loss would be zero if there are no negative impacts, i.e.                                                                             0    = 0. Of course, both
would be zero if                           =0=                   1   =    0,    reecting the fact that welfare e¤ect on ineligibles would be zero
if there is no spillover.

Corollary 2 In the three special cases where we have point-identi...cation, viz. (i)                                                                                            1   =        0   =   2;
(ii)     =        1,           0   = 0; and (iii)                         =             0,       1   = 0, mean CV (52) reduces respectively to:
                  Z    p0 + 2              (         0)
                                                                                                          Z    p0
                                       1
                                               1
                                                                                0   +        1                                                                          0   +   1
       (i)                                                   q1 p; y;                                dp +                                      1    q1 p; y;                            dp;       (53)
                      p0                                                            2                     p               (           0)
                                                                                                                                                                            2
             |                                                {z                                      } | 0         2 0       1
                                                                                                                                                    {z                                   }
                                                    Welfare gain                                                                                Welfare loss
                  Z    p0 +            (       1    0)
                                   1
   (ii)                                                  q1 (p; y;         1 ) dp;                                                                                                                (54)
                      p0
             |                                      {z                              }
                                       Welfare gain
             Z    p0
  (iii)                                             f1           q1 (p; y;      0 )g dp.                                                                                                          (55)
                 p0            (   1           0)
                           0
             |                                       {z                                      }
                                               Welfare loss

       Equations (54) and (55) correspond to the upper and lower bounds, respectively, of the overall
welfare gain for ineligibles, and therefore, the overall bounds generically contain both positive and
negative values, since                                       6= 0.


4.3      Deadweight Loss

The average deadweight loss (DWL) can be calculated as the expected subsidy spending less the
net welfare gain. In particular, if                                             0   = 0 and              =     1,   i.e. there are no negative spillover, then from




                                                                                                          33
(45) and (51), the DWL equals

               DW L(y )
                                                                                               Z   p0 +       (   1   0)
                                                                                                          1
               = 1 fy         g    (p0        p )        q1 (p1 ; y;      1)    1 fy      g                                q1 (p; y;       1 ) dp
                 |                           {z 1                         }                      p1
                                  Subsidy spending                              |                         {z                                   }
                                                                                              Welfare gain of eligibles
                                  Z   p0 +       (   1   0)
                                             1
                   1 fy > g                                   q1 (p; y;   1 ) dp.
                                   p0
               |                             {z                                }
                              Welfare gain of ineligibles

So if      1
               (   1    0)   is large enough, then it is possible for the deadweight loss to be negative, i.e.
for the subsidy to increase economic e¢ ciency under positive spillover, as in the standard textbook
case. This can happen because there is no subsidy expenditure on ineligibles, and yet those that
buy enjoy a subsidy-induced welfare gain due to positive spillover. Similarly, eligibles also receive an
additional welfare gain via positive spillover, over and above the welfare-gain due to reduced price,
and it is only the latter that is ...nanced by the subsidy expenditure. In general, the deadweight
loss will be lower (more negative) when (i) the positive spillover (                                      1)      is larger, (ii) the change in
equilibrium adoption (                1       0)     due to the subsidy is greater, and (iii) the price elasticity of demand
(     1)   is lower ­ the last e¤ect lowers deadweight loss simply by reducing the substitution e¤ect,
even in absence of spillover.


4.4        Calculation of Predicted Demand and Welfare

In order to calculate our welfare-related quantities, we need to estimate the structural choice prob-
abilities q1 (p; y; ) and the equilibrium values of the aggregate choice probabilities,                                                0   and      1   in the
pre and post intervention situations. To do this we will consider two alternative scenarios. The ...rst
is where we assume that the unobservables                                 =     vh   are independent of realized values of price and
income (conditional on other covariates) in the available, experimental data. The second is where
we assume that exogeneity holds, conditional on unobserved village-...xed e¤ects. Note that price
in our data are randomly assigned, so the endogeneity concern is solely regarding income. Under
income endogeneity, Bhattacharya (2018) had discussed interpretation of welfare distributions as
conditional on income. See Appendix A.6 of the present paper for a review of that discussion.
Regardless, calculation of the equilibrium s requires us to either assume exogeneity of observables
or to estimate village-...xed e¤ects, conditional on which exogeneity holds, as in our assumptions
above.
    No Village-Fixed E¤ects: Under the index-restriction (20) and no village-...xed e¤ects, esti-
mation of q1 (p; y; ) can be done via standard binary regression, using the variation in price and
income across and within villages and of observed                                       across villages to estimate the coe¢ cients
constituting the linear index. This implicitly assumes, as is standard in the literature, that even if



                                                                               34
the game can potentially have multiple equilibrium '
                                                   s, only a single equilibrium is played in each
village, and thus one can use the observed                       from each village as a regressor to infer the preference
parameters. Note that given the index structure, we do not need to impose a speci...c distribution
for the s to calculate the index coe¢ cients. Any existing semiparametric estimation method for
index models can be used for calculations, e.g. Klein and Spady (1993), which requires bandwidth
choice and Bhattacharya (2008), which does not.
   Finally, the equilibrium values of                   0   and        1   can be calculated in each village by solving the
...xed point problems
                     Z
                 0 =   q1 (p0 ; y; 0 ) dFY (y ) ,                                                                                     (56)
                     Z
                 1 =   [1 fy      g q1 (p1 ; y;                   1)   + 1 fy > g                q1 (p0 ; y;      1 )] dFY   (y ) ,   (57)

where FY ( ) denotes the distribution of income in the village. For ...xed p0 ; p1 , the RHS of the
above equations, viewed as functions of                      0    and         1   respectively, are each a map from [0; 1] to
[0; 1]. If q1 (p1 ; ; y ) and q1 (p0 ; ; y ) are continuous, then by Bruower'
                                                                            s ...xed point theorem, there
is at least one solution in          0   and      1,   respectively, implying "coherence". However, there may be
multiple solutions, and then our welfare expressions would have to be applied separately for each
feasible pair of values (       0;   1 ).   Note that even if the solutions to (56) and (57) are unique, our
expressions in theorems 3 and 4 above imply that welfare distributions are still not point-identi...ed.
   Once we obtain the predicted values of                    0    and       1,    we can calculate (43) and (50) directly, using
previously obtained estimates of the index coe¢ cients.
   With Village-Fixed E¤ects: Our data for the application come from eleven di¤erent villages
with approximately 180 households per village. It is plausible that utilities from using and from
not using a bednet are a¤ected by village-speci...c unobservable characteristics, such as the chance
of contracting malaria when not using a bednet. Such e¤ects were termed "contextual"by Manski
(1993). Brock and Durlauf (2007) discussed some di¢ culties with estimating social spillover e¤ects
in presence of group-speci...c unobservables. To capture this situation explicitly, recall the linear
utility structure from Section 2, given by
                                                                                             0
                                     U0 (y; ; ) =            0   +     0y   +      0   +       + u0 ,
                                                                                            | {z }
                                                                                                  0

                                                                                                           1
                                U1 (y       p; ; ) =         1   +     1 (y       p) +       1     +         + u1 ,
                                                                                                          | {z }
                                                                                                              1


where   0   and   1   denote unobservable village speci...c characteristics. Therefore,

                  U1 (y        p; ; )           U0 (y; ; )
                                                                                                      1       0
                      =(   1    0)   +(     1      0) y          1p    +(     1        0)    +                    + u1       u0
                       c0 + c1 p + c2 y +              + + ".



                                                                       35
Since       is village speci...c and we have many observations per village, we can use a dummy                                             v   for
each village, and estimate the regression of take-up on price, income and other characteristics that
vary across households h within village v , together with village dummies, i.e.

                              Pr (Avh = 1jPvh ; Yvh ) = F" (           v   + c1 Pvh + c2 Yvh ) ,

where F" ( ) refers to the distribution of " = "vh (which may potentially depend on the realized
value   v   for village v ). The consistency of these estimates results from exogeneity conditional on
village-...xed e¤ects (See assumptions C3-IID (ii) and C3-SD (ii) above).The identi...ed coe¢ cients
 v   of the village dummies therefore satisfy        v   =         v   + c0 +      v.   We will need to identify the sum
 v     c0 +   v.   However, in the equations     v   =     v   +       v   there are as many             v   as there are             v,   so we
have v equations in v + 1 unknowns ( v s and ). In our empirical application, we address this issue
in two separate ways. The ...rst is a homogeneity assumption for observationally similar villages,
and the second is Chamberlain's correlated random e¤ects approach.
     Homogeneity Assumption: If two villages are very similar in terms of observables, then it
is reasonable to assume that they have similar values of                     v,   which leads to a dimension reduction,
and enables point-identi...cation simply by solving the linear system                        v   =           v   +       v   as there are as
many     vs   as the number of    v   less 1 (for ). Indeed, in our application, there are two villages out
of eleven in our dataset that are very similar in terms of observables, and hence are amenable to
this approach.
     Correlated Random E¤ects Assumption: A di¤erent way to address the unobserved group-
e¤ect issue is to use Chamberlain'
                                 s correlated random e¤ects approach (c.f. Section 15.8.2 of
Wooldridge, 2010). In this approach, one models the unobserved                                  0 + e where Z denotes
                                                                                             = Zv
                                                                                         v           v       v

the village-averages of observables, and the error term ev is assumed to satisfy ev ? "vh j(Wvh ; Zv )
("vh = u1
        vh         u0
                    vh ). The coe¢ cients    are estimated in an initial probit regression of purchase on
individual and village characteristics
     In the absence of the above assumptions,            can be point-identi...ed using an instrumental variable
                                                            regression'
type strategy if there are many villages, e.g. estimate the `                                    v   =           v   +       v   using, say the
aggregate fraction of individuals with subsidies or the average value of subsidy as the IV for                                                  v.

But since we have only eleven villages in our data, we do not consider this avenue.
     Welfare Calculation with Village-Fixed E¤ects: Once we have a plausible way to estimate
the structural choice probabilities, we can proceed with welfare calculation in presence of social
spillover and unobserved group-e¤ects, as follows. Consider an initial situation where everyone
faces the unsubsidized price p0 , so that the predicted take-up rate 0 =                             0v      in village v solves
                                   Z
                                                                    v
                            0v =      F" c1 p0 + c2 y + 0v + v dFY    (y ) ,                                                                (58)

       v (y ) is the distribution of income Y
where FY                                     vh in village v , and c1 , c2 ,                         , and           v   are estimated as
above. Now consider a policy induced price regime p0 for ineligibles (wealth larger than a) and p1



                                                           36
for eligibles (wealth less than a). Then the resulting usage                      1   =       1v   in village v is obtained via
solving the ...xed point      1vin the equation
                              Z "                                                              #
                                    1 fy   g F" c1 p1 + c2 y +              1v    +   v              v
                     1v   =                                                                        dFY (y ) .             (59)
                                       +1 fy > g F" c1 p0 + c2 y +           1v   +       v

Finally, average welfare e¤ect of this policy change in village v can be calculated using
                       Z h                                                    i
                                          Elig                     Inelig        v
                Wv =       1 fy    g Wv        (y ) + 1 fy > g Wv         (y ) dFY (y ) ,                                 (60)

       Elig           Inelig
where Wv    (y ) and Wv      (y ) are average welfare at income y in village v , calculated from (43) for
eligibles and (50) for ineligibles, respectively, using          0v   and    1v   as the predicted take-up probability
in village v (analogous to         0   and   1   in (43) and (50)),    1   2 [0; ] as above.


5    Empirical Context and Data
Our empirical application concerns the provision of anti-malarial bednets. Malaria is a life-threatening
parasitic disease transmitted from human to human through mosquitoes. In 2016, an estimated 216
million cases of malaria occurred worldwide, with 90% of the cases in sub-Saharan Africa (WHO,
2017). The main tool for malaria control in sub-Sahran Africa is the use of insecticide treated
bednets. Regular use of a bednet reduces overall child mortality by around 18 percent and reduces
morbidity for the entire population (Lengeler, 2004). However, at $6 or more a piece, bednets
are una¤ordable for many households, and to palliate the very low coverage levels observed in the
mid-2000s, public subsidy schemes were introduced in numerous countries in the last 10 years. Our
empirical exercise is designed to evaluate such subsidy schemes not just in respect of their e¤ec-
tiveness in promoting bednet adoption, but also their impact on individual welfare and deadweight
loss, in line with classic economic theory of public ...nance and taxation. Based on our discussion in
Section 4, we focus on two main sources of spillover, viz. (a) a preference for conformity, and (b) a
concern that mosquitoes will be deected to oneself when neighbors protect themselves. Both will
generate a positive e¤ect of the aggregate adoption rate on one's own adoption decision, but they
have di¤erent implications for the welfare impact of a price subsidy policy.
    Experimental Design: We exploit data from a 2007 randomized bednet subsidy experiment
conducted in eleven villages of Western Kenya, where malaria is transmitted year-round. In each
village, a list of 150 to 200 households was compiled from school registers, and households on the
list were randomly assigned to a subsidy level. After the random assignment had been performed
in o¢ ce, trained enumerators visited each sampled household to administer a baseline survey. At
the end of the interview, the household was given a voucher for an bednet at the randomly assigned
subsidy level. The subsidy level varied from 40% to 100% in two villages, and from 40% to 90%
in the remaining 9 villages; there were 22 corresponding ...nal prices faced by households, ranging



                                                            37
from 0 to 300 Ksh (US $5:50). Vouchers could be redeemed within three months at participating
local retailers.
         Data: We use data on bednet adoption as observed from coupon redemption and veri...ed
obtained through a follow-up survey. We also use data on baseline household characteristics mea-
sured during the baseline survey. The three main baseline characteristics we consider are wealth
(the combined value of all durable and animal assets owned by the household); the number of
children under 10 years old; and the education level of the female head of household.18


6         Empirical Speci...cation and Results
We work with the linear index structure (20), where y = Yvh is taken to be the household wealth,
p = Pvh is the experimentally set price faced by the household,                  =   vh   is the average adoption in
the village. The health externality from bednet use is implicitly accounted for via the dependence
of utilities from adoption and non-adoption on the average adoption rate                     (c.f. eq. (20)).19
         For the empirical analysis, we also use additional controls, denoted by Zvh below, that can
potentially a¤ect preferences (U1 ( ) and U0 ( )) and therefore the take-up of bednet, i.e. q1 ( ). In
particular, we include presence of children under the age of ten and years of education of the oldest
female member of the household. A village-speci...c variable that could a¤ect adoption is the extent
of malaria exposure risk in the village. We measure this in our data from the response to the
question: "Did anyone in your household have malaria in the past month?". Summary statistics
for all relevant variables are reported in Table 1, and their village averages are shown in table 2,
for each of the eleven villages in the data.
         Our ...rst of results correspond to taking F ( ) to be the standard logit CDF of                   1     0
                                                                                                    vh = ( vh     vh )
                                                                                                     1  PNv
(as in (38), i.e. with no ...xed e¤ects), and including average take-up                   = ^v (=   Nvh  h=1 Avh ) in
village as a     regressor.20   As shown in Theorem 2 above, even if unobservables are spatially correlated,
our increasing domain asymptotic approximation will lead to consistent estimates of preference
parameters. This approximation is reasonable in our empirical setting where the average distance
between households within a village typically exceeds 1.5 Kilometers. The marginal e¤ects at mean
are presented in Table 3. It is evident that demand is highly price elastic, and that average bednet
adoption in the village has a signi...cant positive association with private adoption, conditional on
    18
         Not all households in a village participated in the game. However, at the time of the experiment, non-selected
households did not have the opportunity to buy an ITN, and the outcome variables for such households are always
zero. So even if we allow for interactions among all households (including non-selected ones), it is easy to make the
necessary adjustments in the empirics. See Appendix A.7 for more on this.
  19
     There are some households who live in the village but were not part of the formal experiment. Since the ITN was
not available from any source other than via the experiment, this only impacts the game via the computed fraction
 vh .     We clarify this point in Appendix A.7.
 20
         While estimating the logit parameters we do not impose the ...xed point constraint. While this would have
improved e¢ ciency, the additional computational burden would be quite onerous.




                                                            38
price and other household characteristics, i.e.             > 0 in our notation above. The social interaction
coe¢ cient       is 2:4 which is less than 4, as required for the ...xed point map to be a contraction
(see discussion following Proposition 2) in the logit case. The e¤ect of children is negative, likely
reecting that households with children had already invested in other anti-malarial steps, e.g. had
bought a less e¤ective traditional bednet prior to the experiment. We also computed analogous
estimates where we ignore the spillover, i.e., we drop average take-up in village from the list of
regressors. The corresponding marginal e¤ects for the retained regressors are not very di¤erent
in magnitude from those obtained when including the average village take-up, and so we do not
report those here. Instead, we use the two sets of coe¢ cients to calculate and contrast the predicted
bednet adoption rate corresponding to di¤erent eligibility thresholds. These predicted e¤ects are
quite di¤erent depending on whether or not we allow for spillover, and so we investigated these
further, as follows.
     In particular, we consider a hypothetical subsidy rule, where those with wealth less than                    are
eligible to get the bednet for 50 KSh (90% subsidy), whereas those with wealth larger than                        get
it for the price of 250 KSh (50% subsidy). Based on our logit coe¢ cients, we plot the predicted
aggregate take-up of bednets corresponding to di¤erent income thresholds . In Figure 1, for each
threshold       , we plot the fraction of households eligible for subsidy on the horizontal axis, and
the predicted fraction choosing the bednet on the vertical axis, based on coe¢ cients obtained by
including (solid) and excluding (small dash) the spillover e¤ect. The 45 degree line (large dash)
showing the fraction eligible for the subsidy is also plotted in the same ...gure for comparison.
     It is evident from Figure 1 that ignoring spillovers leads to over-estimation of adoption at lower
thresholds and underestimation at higher thresholds of eligibility. To get some intuition behind this
...nding, consider a much simpler set-up where an outcome Y is related to a scalar covariate X via the
classical linear regression model Y =        0 + 1X +
                                                 where is zero-mean, independent of X and 1 >
0. OLS estimation of this model yields estimators ^1 , ^0 with probability limits (and also expected
values)    1   = Cov [X; Y ] =Var [X ] and   0   = E [Y ]      1E   [X ], respectively. Corresponding to a value
x of X , the predicted outcome has a probability limit of y :=               0   +   1x   = E [Y ] +   1 fx   E [X ]g.
Now consider what happens if one ignores the covariate X . Then the prediction is simply the
sample mean of Y which has the probability limit of y miss := E [Y ]. Therefore, y < y miss if
x < E [X ]. Thus, although the ignored covariate X has a positive e¤ect on the outcome (since
 1   > 0), ignoring it in prediction leads to an overestimation of the outcome if the point x where the
prediction is made is smaller than the population average of the ignored covariate. On the other
hand, if x > E [X ], then there will be under-estimation.
     Having obtained these (uncompensated) e¤ects, we now turn to calculating the average demand
and the mean compensating variation for a hypothetical subsidy scheme. We consider an initial
situation where everyone faces a price of 250 KSh for the bednet, and a ...nal situation where an
bednet is o¤ered for 50 KSh to households with wealth less than                      = 8000 KSh (about the 27th



                                                        39
percentile of the wealth distribution), and for the price of 250 KSh to those with wealth above that.
The demand results are reported in Table 4, and the welfare results in Table 5. We perform these
calculations village-by-village, and then aggregate across villages. To calculate these numbers, we
...rst predict the bednet adoption when everyone is facing a price of 250 KSh, and then when eligibles
face a price of 50 KSh and the rest stay at 250 KSh, giving us the equilibrium values of                             0   and   1,

respectively, in our notation above. In all such calculations with our data, we always detected a
single solution to the ...xed point           (i.e. a unique equilibrium) as can be seen from Figure 2, where
we plot the squared di¤erence between the RHS and the LHS of eqn. (57), i.e.
                    Z                                                                                            2
                1       [1 fy        g   q
                                         ^1 (p1 ; y; z;   1 ) + 1 fy > g   q
                                                                           ^1 (p0 ; y; z;         ^
                                                                                            1 )] dFY;Z (y; z )


on the vertical axis, and        1   on the horizontal axis, separately for each of the eleven villages, where
q
^1 (p; y; z; ) is the predicted demand (choice probability) function at (p; y; z; ). The globally
convex nature of each objective function is evident from Figure 1. The minima are relatively close
to each other around 0:15, except village 7 and 10, where it is larger. A similar set of globally convex
                                              h     R                                 i2
graphs is obtained for 0 , which minimizes 0          q                   ^Y;Z (y; z ) . These predicted
                                                      ^1 (p1 ; y; z; 0 ) dF
values of   0   and     1   are used as inputs into the prediction of demand as per eqn. (35) and welfare
as per Theorems 3 and 4.
   The ...rst row of Table 4 shows the pre-subsidy predicted demand (using a logit CDF F ) by
subsidy-eligibility. In the second row, we calculate the predicted e¤ect of the subsidy on demand,
and break that up by the own price e¤ect (Row 2) and the spillover e¤ect (row 3). The own e¤ect
is obtained by changing the price in accordance with the subsidy but keeping the average village
demand equal to the pre-subsidy value; the spillover e¤ect is the di¤erence between the overall
e¤ect and the own e¤ect. It is clear that spillover e¤ects on both eligibles and ineligibles are large
in magnitude. In particular, the spillover e¤ect raises demand for ineligibles by nearly 33% of its
pre-subsidy level.
   In Table 5, we report welfare calculations. First, in the row titled "Logit", we report the average
CV of the subsidy rule for eligibles, corresponding to assuming no spillover. In this case, we simply
use the results of Bhattacharya (2015) to calculate the (point-identi...ed) average CV for eligibles
as the price changes from 250 KSh to 50 KSh. This yields the value of welfare gain to be 51:9 KSh.
As there is no spillover, the welfare change of ineligibles is zero by de...nition, and therefore the
net welfare gain, denoted by net CV is simply the fraction eligible (0:27) times the average CV for
eligibles. This is reported in the second column of Table 5.
   We next turn to the case with spillover. Using the predicted adoption rates                             0     and      1,   we
compute the lower and upper bounds of the overall average CV using (45), (47) and (48) for
eligibles, and using (52), (54) and (55) for ineligibles. These are reported in Columns 3-6 of Table
5. The most conspicuous ...nding from these numbers is that ineligibles can su¤er a large welfare loss



                                                              40
on average due to the subsidy. This is because the subsidy facilitates usage for solely the eligibles,
raising the equilibrium usage              in the village, but the ineligibles keep facing the high price, and
thus a lower utility from not buying because                        is now higher (in the index speci...cation,                       0        0).
However, the few ineligibles who buy, despite the high price, get some welfare increase from a rise in
the average adoption rate, that explains the small upper bound corresponding to the case                                                  0   = 0.
As for eligibles, the lower and upper bounds on average welfare gain do not contain the estimate
that ignores spillovers, suggesting over-estimation of welfare gains in the latter case. This is also
consistent with Figure 1, where we see that at 27% eligibility and lower, demand is overestimated
when spillovers are ignored. The overall welfare gain across eligibles and ineligibles, reported in the
column with heading "net CV", includes the negative welfare e¤ects on ineligibles, thereby lowering
the average e¤ect relative to ignoring spillovers and incorrectly concluding no welfare change for
ineligibles.

    Deadweight Loss: To compute the average deadweight loss, we subtract the net welfare from
the predicted subsidy expenditure. The latter equals the amount of subsidy (200 KSh) times the
average demand at the subsidized price 50 KSh of the eligibles. Thus the expression for DWL is
given by
                Z "                                                                                                #
                                          200         1 fy      g     q1 (50; y; z;      1)
           D=                                                                                                          dF (y; z ) ,
                             1 fy    g    Elig   (y; z;                                Inelig
                                                          1;   0)    1 fy > g                   (y; z;   1;   0)

where y denotes wealth, z denotes other covariates, q1 (50; y; z;                               1)   denotes predicted demand at
price 50 KSh including the e¤ect of spillover, and                       Elig   and    Inelig    refer to average welfare gain for
eligibles and ineligibles, respectively. Ignoring spillovers leads to the point-identi...ed deadweight
loss
               Z h                                                                                                    i
                                             No-spillover                                       No-spillover
       D=            200     1 fy     g     q1            (50; y; z )           1 fy      g                    (y; z ) dF (y; z ) .



    Group-E¤ects: It is evident from table 2 that villages 1 and 11 are highly similar in terms of
the average values of key regressors, except that the (randomly assigned) average price in village
1 is much higher than in village 11, which explains the much lower average adoption in village 11.
Given this, we assume that villages 1 and 11 are likely to be similar in terms of their unobservables,
and as such, we estimate a single                v   for them. Speci...cally, we ...rst estimate

                           Pr (Avh = 1jPvh ; Yvh ; Zvh ) = F             v   + c1 Pvh + c2 Yvh + c0
                                                                                                  3 Zvh ,


where Zvh is a vector containing presence of children and female education, the                                             vs   are village-
speci...c intercepts (estimated using dummies for the villages), and Pvh and Yvh are price faced by
the household in the experiment and its wealth, respectively. In the second step, we solve the linear



                                                                    41
system          v   =    v   + c0 +       v   =       v   +    v,    for     and      v,   for v = 1; :::; 11, where   v   is obtained in the
previous step, and the                v   s are the average adoption rates in individual villages in the experiment.
In solving this system, we set                    1   =       11 ,   which incorporates the homogeneity assumption discussed
above. We can do all of this in one step by adding nine dummies for villages 2-10 and one for
villages 1 and 11, and then running a regression of individual use on the regressors p; y and x,
the average use in each village, as well as the village dummies. In the second row in Table 5, we
report the average welfare e¤ects of the same hypothetical policy change as described above, using
expression (60).
       Next, we use the correlated random e¤ect approach described above, where village averages of
observable regressors (price, wealth, female education, number of children) are added as additional
controls in a probit (instead of logit) regression. The corresponding welfare results are reported in
the third row of table 5.
       Semiparametric Estimates: Finally, in the fourth row of Table 5, we report welfare results
from a semiparametric index estimation of the conditional choice-probabilities, i.e. retaining the
index structure but dropping the logit assumption. This is achieved by using the "sml" routine
(de Luca, 2008) in Stata which implements Klein and Spady's (1993) estimator for single index
models, using (i) a default bandwidth of hn = n                                    1=6:5    to estimate the index, and then (ii) a local
cubic polynomial for regressing the binary outcome on the estimated index to produce the predicted
probabilities, using a bandwidth of hn = cn                                1=5   where c is chosen via leave-one-out cross-validation.
       The welfare numbers do vary a bit across speci...cations. But all of these results support the
overall conclusion that accounting for spillovers can lead to much lower estimates of net welfare
gain from the subsidy program and higher deadweight loss. Some of this di¤erence arises from
potential welfare loss su¤ered by ineligibles that is missed upon assuming no spillover, and some
from the impact of including spillover terms on the prediction of counterfactual purchase-rates (c.f.
Fig 1).
       In Table 6, we report standard errors for the simple logit case. In principle, one can also
derive formulae for standard errors adjusted for spatial correlation, but given that the paper is
already quite long, and such standard errors contribute nothing substantive, we do not attempt
that here. Table 6 also reports the welfare calculations corresponding to the special case where
  1    =        0   = =2. This would be reasonable when there is no negative externality due to deection,
i.e.       H   = 0 above, whence average welfare becomes point-identi...ed. Note that this case is di¤erent
from the results obtained assuming no spillover whatsoever, i.e. the ...rst row third column of table
5. We still obtain a negative average e¤ect of the subsidy due to the larger aggregate welfare loss
of ineligibles compared with the gains of eligibles.
       Comparative Statics: In Table 7, we show how the welfare e¤ects change as we vary the
generosity of the subsidy scheme; the wealth threshold for quali...cation is varied so that either




                                                                                 42
20%, 40% or 60% of the population is eligible. It is apparent from Table 7 that the upper bound
on welfare loss for ineligibles increases as more people become eligible (since equilibrium take up
is higher), and the deadweight loss larger still due to both a larger extent of subsidy induced
distortion, as well as the higher welfare loss of ineligibles. The lower bound on the welfare gain for
eligibles decreases as the share eligible increases, in fact it becomes negative when 40% are eligible.
This is because those among the eligible who are too poor to buy the bednet even at the 50Ksh
price are now experiencing a welfare loss since equilibrium take-up is higher. The overall e¤ect is
an unambiguous increase in the deadweight loss.

    Endogeneity: Price variation is exogenous in our application, since price was varied randomly
by the experimenter. Indeed, it is still possible that wealth Y is correlated with , the unobserved
determinants of bednet purchase. However, experimental variation in price P implies also that P is
independent of , given Y . Consequently, one can invoke the argument presented in Bhattacharya
(2018, Sec. 3.1; reproduced in the Appendix A.6 below for ease of reference), and interpret the
estimated choice-probabilities and the corresponding welfare numbers as conditional on y , and then
integrating with respect to the marginal distribution of y . This overcomes the problem posed by
potentially endogenous income.


7    Summary and Conclusion
In this paper, we develop tools for economic demand and welfare analysis in binary choice models
with social interactions. To do this, we ...rst show the connection between Brock-Durlauf type social
interaction models and empirical games of incomplete information with many players. We analyze
these models under both I.I.D. and spatially correlated unobservables. The latter makes individual
beliefs conditional on privately observed variables, complicating identi...cation and inference. We
show when and how these complications can be overcome via the use of a limit model to which the
...nite game model converges under increasing domain spatial asymptotics, in turn yielding compu-
tationally simple estimators of preference parameters. These lead to consistent point-estimates of
potential values of counterfactual demand resulting from a policy-intervention, which are unique
under unique equilibria.
    However, with interactions, welfare distributions resulting from policy changes such as a price
subsidy are generically not point-identi...ed for given values of counterfactual aggregate demand,
unlike the case without spillovers. This is true even for fully parametric speci...cations, and when
equilibria are unique. Non-identi...cation results from the inability of standard choice data to distin-
guish between di¤ erent underlying latent mechanisms, e.g. conforming motives, consumer learning,
negative externalities etc., which produce the same aggregate social interaction coe¢ cient, but have
di¤erent welfare implications depending on which mechanism dominates. This feature is endemic
to many practical settings that economists study, including the health-product adoption case ex-



                                                  43
amined here. Another prominent example is school-choice, where merit-based vouchers to attend
a fee-paying selective school can create negative externalities by lowering the academic quality
of the free local school via increased departure of high-achieving students. The resulting welfare
implications cannot be calculated based solely on a Brock-Durlauf style empirical model of indi-
vidual school-choice inclusive of a social interaction term. This is in contrast to models without
social interaction, where choice probability functions have been shown to contain all the informa-
tion required for welfare-analysis. Nonetheless, we show that under standard semiparametric linear
index restrictions, welfare distributions can be bounded. Under some special and untestable cases
e.g. exactly symmetric spillover e¤ects or absence of negative externalities, these bounds shrink to
point-identi...ed values.
   We apply our methods to an empirical setting of adoption of anti-malarial bednets, using data
from an experiment by Dupas (2014) in rural Kenya. We ...nd that accounting for spillovers provides
di¤erent predictions for demand and welfare resulting from hypothetical, means-tested subsidy
rules. In particular, with positive interaction e¤ects, predicted demand when including spillover
is lower for less generous eligibility criteria, compared to demand predicted by ignoring spillovers.
At more generous eligibility thresholds, the conclusion reverses. As for welfare, if negative health
externalities are present, then subsidy-ineligibles can su¤er welfare loss due to increased use by
subsidized buyers in the neighborhood; if solely conforming e¤ects are present and there is no
health-related externality, then welfare can improve. Speci...cally, our welfare bounds applied to the
bednet data show that a 200 KSh subsidy with eligibility threshold equal to the 75th percentile of
wealth has an average (across eligibles and ineligibles combined) cash equivalent of between        14
to +10 KSh when including spillovers; equals       1:48 KSh under symmetric spillover, and about
13 KSh when all spillovers are ignored. The potential welfare loss of ineligibles and non-buyers
translates into larger estimates of potential deadweight loss from price intervention. We perform
robustness checks allowing for village-level unobservables and a semiparametric speci...cation.
   The implication of these results for applied work is that under social interactions, welfare analy-
sis of potential interventions requires more information regarding individual channels of spillover
than knowledge of solely the choice probability functions (inclusive of a social interaction term).
Belief-eliciting surveys provide a potential solution.
   We conclude by noting that we have used the basic and most popular speci...cation of interac-
tions, viz. that physical neighbors constitute an individual'
                                                            s peer group. This also seems reasonable
in the context of our application, which concerns adoption of a health product in physically sepa-
rated Kenyan villages. It would be interesting to extend our analysis to other network structures,
e.g. those based on ethnicity, caste, socioeconomics distance, etc. We leave that to future work.




                                                  44
 Figure 1. Predicted equilibrium adoption of ITN under changing eligibility rule
                   for subsidy, plotted against fraction eligible
                     1         .8
        Predicted Adoption Rate
       .2      .4    0.6




                                    0   .2           .4               .6              .8      1
                                                      Fraction Eligible

                                             No externality                With externality
                                             45 degree line




Notes: We consider a hypothetical subsidy in which eligible gets a price of 50Ksh for an ITN
while the rest face a price of 250Ksh. We plot the predicted aggregate take-up of ITNs
corresponding to different eligibility shares, based on coefficients obtained by including (solid)
and excluding (small dash) the spillover effect. The 45 degree line (large dash) is shown for
comparison.




                                                              45
                              Figure 2. Objective function for each of the 11 villages

                              Village 1                                                Village 2                                                 Village 3                                                 Village 4
.02 .04 .06 .08 .1




                                                         .02 .04 .06 .08 .1




                                                                                                                   .02 .04 .06 .08 .1




                                                                                                                                                                             .02 .04 .06 .08 .1
    objective




                                                             objective




                                                                                                                       objective




                                                                                                                                                                                 objective
         0




                                                                  0




                                                                                                                            0




                                                                                                                                                                                      0
                     0   .1    .2         .3   .4   .5                        0   .1     .2         .3   .4   .5                        0   .1     .2         .3   .4   .5                        0   .1    .2         .3   .4   .5
                                    Pi1                                                       Pi1                                                       Pi1                                                      Pi1


                              Village 5                                                Village 6                                                 Village 7                                                 Village 8
.02 .04 .06 .08 .1




                                                         .02 .04 .06 .08 .1




                                                                                                                   .02 .04 .06 .08 .1




                                                                                                                                                                             .02 .04 .06 .08 .1
    objective




                                                             objective




                                                                                                                       objective




                                                                                                                                                                                 objective
         0




                                                                  0




                                                                                                                            0




                                                                                                                                                                                      0
                     0   .1    .2         .3   .4   .5                        0   .1     .2         .3   .4   .5                        0   .1     .2         .3   .4   .5                        0   .1    .2         .3   .4   .5
                                    Pi1                                                       Pi1                                                       Pi1                                                      Pi1


                              Village 9                                                Village 10                                                Village 11
.02 .04 .06 .08 .1




                                                         .02 .04 .06 .08 .1




                                                                                                                   .02 .04 .06 .08 .1
    objective




                                                             objective




                                                                                                                       objective
         0




                                                                  0




                                                                                                                            0




                     0   .1    .2         .3   .4   .5                        0   .1     .2         .3   .4   .5                        0   .1     .2         .3   .4   .5
                                    Pi1                                                       Pi1                                                       Pi1




                                                                                                                      46
                        Table 1: Summary Statistics (N=2197)

Variable                    Definition                         Mean       Min        Max

Adoption                    Bought ITN                          0.35      0.00       1.00
Price (Kenyan Shillings)    Randomly assigned price of ITN
                                                              129.15      0.00      300.00

Wealth (Kenyan Shillings)   Household wealth                   21143      0.00      99003
Avg use                     Average ITN use in village          0.28      0.10       0.59
Avg malaria                 Incidence of malaria in village     0.66      0.33       0.79
Educ-female (yrs)           Yrs of school for female adults     5.87      0.00      15.00
Child                       Whether hhd has child under 10      0.74      0.00       1.00

Notes: Households surveyed come from 11 different villages. At the time of the study the
exchange rate was apprximately 65 Kenyan Shillings to 1 USD.




                                              47
                        Table 2: Village Averages

                                                              Years of    HH
                                                              Educatio    has
Village Number of Purchased ITN Price Wealth Malaria
                                                                 n of    Child
  ID     households     ITN       (KSh)       (KSh) Incidence
                                                               female    under
                                                                head      10
   1        183        0.269       142.5      22,885  0.644      5.45    0.857
   2        254        0.452       108.3       23,741 0.606      5.30    0.748
   3        224        0.455       120.8      20,677  0.627      4.50    0.721
   4        224        0.344       130.0       23,124 0.710      7.35    0.722
   5        301        0.338       117.9       23,455 0.793      6.39    0.742
   6        184        0.269       140.1      16,151  0.633      4.48    0.753
   7        145        0.162       179.1      11,724  0.678      6.11    0.690
   8        254        0.220       180.3      24,261  0.663      8.13    0.763
   9        221        0.117       156.8      22,265  0.592      5.78    0.738
  10        167        0.677        62.0      17,425  0.664      4.53    0.653
  11        108        0.733        49.5       20,235 0.582      5.43    0.752
Notes: In Table 5 row 2, we group villages 1 and 11.




                                     48
Table 3: Marginal Effects in Logit of Buying ITN


                     Marginal      Std.
Variable                                      P-value
                      Effect       Error
Price (KSh)           -0.0033      0.0002     <0.001
Wealth ('000 KSh)      0.0009      0.0006      0.142
Avg Use                0.6302      0.0925     <0.001
Avg Malaria           -0.0454      0.1759      0.796
Educ-female (yrs)      0.0037      0.0029     0.201
Child under 10        -0.0705      0.0252     0.005

Notes: 2,197 observations from 11 villages.




                             49
               Table 4: Impact of Subsidy on Demand by Eligibility

                                                    Eligible                 Non-eligible
Pre-Subsidy                                          0.027                     0.030

Post-Subsidy         Overall                         0.502                      0.044
                     Own Effect                      0.397                      0.030
                     Spillover Effect                0.105                      0.014
Notes: The table shows estimated demand. See text   section 5 for details.




                                         50
                              Table 5: Mean Welfare and Deadweight Loss in Kenyan Shillings


                               W/O Externality                                         With Externality
                              Predicted                                                   Predicted
                               subsidy        Deadweight                                   Subsidy                       Deadweight
                    Eligibles spending Net CV    Loss           Eligibles   Non-eligibles Spending      Net CV              Loss
                                                               LB     UB     LB     UB                   LB       UB     LB      UB
Logit                   51.87     25.76     13.32      12.44      12.02 39.40 -23.43 -0.35     21.29    -14.32    9.86   11.43   35.61
Logit w Group
                        52.87     25.76     13.58      12.18      22.09 42.65 -18.03 -0.21     28.83     -7.73   10.80   18.03   36.55
Effect
Probit w Correlated
                        54.72     25.76     14.05      11.70       4.89 36.23 -26.97 -0.73     15.72    -18.79    8.76   6.97    34.51
Random Effects
Semiparametric          54.06     25.76     13.88      11.87      31.51 47.81 -13.04 1.11      37.26     -1.60    13.10 24.16    38.86
Notes: The table shows estimated welfare effects. "LB" stands for lower bound, and "UB" for upper bound. CV =    compensating
variation. In the "group effect" estimation, we group villages 1 and 11.




                                                                 51
                Table 6: Welfare: Bootstrapped Std-Errors and Special Case

                        CV w/o spillover
                                                                  CV with Spillover
                              Net     Deadweight                                        Deadweight
                  Eligibles                         Eligibles   Ineligibles   Net CV
                              CV         Loss                                              Loss
                                                   LB     UB    LB     UB     LB   UB    LB    UB

1. Estimate        51.87      13.32     12.44      12.02 39.40 -23.43 -0.35 -14.32 9.86 11.43 35.61
   Std Error        2.16       0.67     1.90        4.46 3.19 1.77 0.08 2.31 0.93 4.12 2.93

2. Point identified                                26.87           -11.27      -1.48       24.28
Notes: Row 1: Logit estimate with boostrapped standard errors (68 replications).
Row 2: we set alfa1=-alfa0=alfa/2 and welfare is point identified.




                                                   52
            Table 7: Welfare and Deadweight Loss by Eligibility



                     Eligibles      Non-eligibles        Net CV        Deadweight Loss

                    LB      UB      LB         UB      LB      UB        LB       UB
 Percent Eligible
       20%         17.33 38.07 -17.30 -0.24           -10.38 7.41         9.67    27.45
       40%         -4.60 42.56 -41.67 -0.16           -26.86 16.91       13.23   57.00
       60%        -36.09 46.16 -74.63 1.09            -51.51 28.13        8.66    88.30
       80%        -66.54 53.82 -112.68 5.87           -75.74 44.26        4.57   124.56
Notes: Table shows estimated welfare for different   eligibility coverage.




                                          53
References
 [1] Andrews, D.W. (2005) Cross-section regression with common shocks. Econometrica 73, 1551-
    1585.

 [2] Bhattacharya, D. (2008) A Permutation-based estimator for monotone index models. Econo-
    metric Theory 24, 795-807.

 [3] Bhattacharya, D. (2015) Nonparametric welfare analysis for discrete choice. Econometrica 83,
    617-649.

 [4] Bhattacharya, D. (2018) Empirical welfare analysis for discrete choice: Some general results.
    Quantitative Economics 9, 571-615.

 [5] Blundell, R. and J. Powell (2004). Endogeneity in nonparametric and semiparametric regression
    Models, in Advances in Economics and Econometrics, Cambridge University Press, Cambridge,
    U.K.

 [6] Brock, W.A. & Durlauf, S.N. (2001a). Discrete choice with social spillover. Review of Economic
    Studies 68, 235-60.

 [7] Brock, W.A. & Durlauf, S.N. (2001b) Interactions-based models. Handbook of econometrics
    (Vol. 5, pp. 3297-3380). Elsevier.

 [8] Brock, W.A. & Durlauf, S.N. (2007) Identi...cation of binary choice models with social inter-
    actions. Journal of Econometrics 140, 52-75.

 [9] Daly, A. & Zachary, S. (1978) Improved multiple choice models. Determinants of travel choice,
    335, p.357.

[10] Dupas, P. (2014) Short-run subsidies and long-run adoption of new health products: Evidence
    from a ...eld experiment. Econometrica 82, 197-228.

[11] De Luca, G. (2008) SNP and SML estimation of univariate and bivariate binary-choice models.
    The Stata Journal 8, 190-220.

[12] Gautam, S. (2018) Quantifying welfare e¤ects in the presence of externalities: An ex-ante
    evaluation of a sanitation intervention, Mimeo.

[13] Hall, P. & Heyde, C.C. (1980) Martingale Limit Theory and Its Application, Academic Press.

[14] Hausman, J.A, & Newey W. (2016) Individual heterogeneity and average welfare. Econometrica
    84, 1225-48.




                                                54
[15] Han, A. K. (1987) Non-parametric analysis of a generalized regression model: the maximum
    rank correlation estimator. Journal of Econometrics 35, 303-16.

[16] Lahiri, S.N. (1996) On Inconsistency of estimators based on spatial data under in...ll asymp-
    totics. Sankhya Series A 58, 403-417.

[17] Lahiri, S.N. (2003) Central limit theorems for weighted sums of a spatial process under a class
    of stochastic and ...xed designs. Sankhya Series A 65 356-388.

[18] Lahiri, S.N. & Zhu, J. (2006) Resampling methods for spatial regression models under a class
    of stochastic designs. The Annals of Statistics 34, 1774-1813.

[19] Lengeler, C. (2004) Insecticide-treated bed nets and curtains for preventing malaria. The
    Cochrane Library.

[20] Manski, C.F. (1993) Identi...cation of endogenous social e¤ects: The reection problem. The
    Review of Economic Studies 60, 531-542.

[21] McFadden, D. & Train, K., (2019) Welfare economics in product markets. Working paper,
    University of California, Berkeley.

[22] Menzel, K. (2016) Inference for games with many players. The Review of Economic Studies
    83, 306-337.

[23] Rust, J. (1987) Optimal replacement of GMC bus engines: An Empirical model of Harold
    Zurcher. Econometrica 55, 999-1033.

[24] De Paula, A. (2016) Econometrics of network models (No. CWP06/16). cemmap working
    paper, Centre for Microdata Methods and Practice.

[25] Small, K. & Rosen, H. (1981). Applied welfare economics with discrete choice models. Econo-
    metrica 49, 105-130.

[26] WHO, 2017. World malaria report (2017) Geneva: World Health Organization. Licence:
    CCBY-NC-SA 3.0 IGO.

[27] Wooldridge, J.M. (2010) Econometric analysis of cross section and panel data. MIT press.

[28] Yang, C. and Lee, L.F., 2017. Social interactions under incomplete information with heteroge-
    neous expectations. Journal of Econometrics, 198(1), pp.65-83.




                                                55
A      Appendix
This Appendix has seven sections labelled A.1 - A.7. They deal respectively with the proof of
constancy and symmetry of the beliefs with I.I.D. unobservables, belief convergence with spatially
correlated unobservables, su¢ cient conditions for contraction, convergence of the estimators (the
proof of Theorem 2), welfare analysis under             1   <        0,   income endogeneity, and nonparticipating
households.


A.1     Proofs for the (Conditionally) I.I.D. Case
                                                                                                                1 P
Proof of Proposition 1. By the de...nition in (2) (with h replaced by k ),                         vk     =   Nv 1 1 j Nv ; j 6=k E [Avj jIvk ].
Since this is the average of the conditional expectations given Ivk = (Wvk ; Lvk ; uvk ;                                  v ),   we can
write (v; k )'
             s belief as
                                          vk   = gvk (Wvk ; Lvk ; uvk ;       v );

using some function gvk ( ) which may depend on each index (v; k ) but is deterministic (non-random).
Thus, plugging this expression of         vk   into Avk = 1fU1 (Yvk             Pvk ;   vk ;       vk )       U0 (Yvk ;     vk ;   vk )g,
we can also write
                                        Avk = fvk (Wvk ; Lvk ; uvk ;          v );                                                 (61)

for some deterministic function fvk ( ), where Wvk = (Yvk ; Pvk ).
     By C3-IID, we have the two of the conditional independence restrictions: (uvh ; uvk ) ? (Wvh ; Lvh )j                                  v
and uvh ? uvk j v . These imply that

                                uvk ? (Wvh ; Lvh )juvh ;         v    and uvk ? uvh j          v
                                                                                                                                   (62)
                           ,    uvk ? (Wvh ; Lvh ; uvh )j v ,

where we have used the following conditional independence relation: for random objects Q, R, and
S,
                  "Q ? Rj (S;     v)   and Q ? S j v " is equivalent to "Q ? (R; S )j v ",                                         (63)

which is applied with Q = uvk , R = (Wvh ; Lvh ), and S = uvh . By the same token, C3-IID implies
that

                (Wvk ; Lvk ; Wvh ; Lvh ) ? (uvk ; uvh )j    v    and (Wvk ; Lvk ) ? (Wvh ; Lvh )j                  v
           )    (Wvk ; Lvk ) ? (uvk ; uvh )j(Wvh ; Lvh ;        v)    and (Wvk ; Lvk ) ? (Wvh ; Lvh )j v ;

which is equivalent to
                                   (Wvk ; Lvk ) ? (Wvh ; Lvh ; uvk ; uvh )j v :                                                    (64)




                                                         A1
We below denote by E        v
                                [ ] the conditional expectation operator given                        v   (i.e., E [ j v ]; we also write
E v [ jB ] = E [ j v ; B ] for any random variable). Given the above, we have

               E [Avk jIvh ] = E v [fvk (Wvk ; Lvk ; uvk ; v )jWvh ; Lvh ; uvh ]
                               Z
                                                                                          v
                             = E v [fvk (Wvk ; Lvk ; u ~; v )jWvh ; Lvh ; uvh ; uvk = u
                                                                                      ~]dFu (~
                                                                                             uj v )
                               Z
                                                                 v
                             = E v [fvk (Wvk ; Lvk ; u ~; v )]dFu  (~uj v )

                             = E v [fvk (Wvk ; Lvk ; uvk ;           v )]   = E [Avk j v ];

where the ...rst equality uses (61), the second and third equalities follow from (62) and (64), respec-
tively, the fourth equality holds since (Wvk ; Lvk ) ? uvk j v , completing the proof.
Proof of Proposition 2. Let

                                  vk   =    vk ( v )   := E [Avk j v ] for h = 1; : : : ; Nv ;                                      (65)

where henceforth we suppress the dependence of                      vk   on    v   for notational simplicity. By Proposition
1 and (6), we have
                                                                    X
                                                               1
                                           vh   =   vh   =   Nv 1                             vk .                                  (66)
                                                                         1 k Nv ; k6=h

Given these, we can write
                   " (                       P                                                       )#
                         U1 (Yvh Pvh ; Nv1 1 1                      k Nv ; k6=h vk ;          vh )
          vh = E v 1                       P                                                              ; h = 1; : : : ; Nv .     (67)
                               U0 (y; Nv1 1 1 k                     Nv ; k6=h vk ;    vh )

We can easily see that if a symmetric solution to the system of Nv equations in (67) exists uniquely,
                                                                                           PNv
then that of (7) (in terms of f vh gNv
                                    h=1 ) also exists uniquely (vice versa; note that vh =  k=1 vk
(Nv    1)     vh   by (66)). Therefore, we investigate (67).
   Corresponding to (67), de...ne an Nv -dimensional vector-valued function of r = (r1 ; r2 ; : : : ; rNv ) 2
[0; 1]Nv as
                                       P                             P
                  Mv (r ) := mv ( Nv1 1 k6=1 rk ); : : : ; mv ( Nv1 1 k6=Nv rk ) ;
              P               P
where we write 1 k Nv ; k6=h = k6=h for notational simplicity, and the metric in the domain and
range spaces of Mv is de...ned as

                                            jjs     ~jj1 := max jsh
                                                    s                                s
                                                                                     ~h j ;
                                                               1 h Nv


for any s = (s1 ; : : : ; sNv ), s
                                 ~ = (~            ~Nv ) 2 [0; 1]Nv (note that both the spaces are taken to be
                                      s1 ; : : : ; s
[0; 1]Nv ). Given these de...nitions of Mv (r ) and the metric, we can easily show that the contraction
property of mv ( ) carries over to Mv ( ), i.e.,

                                       kMv (r )          M v (r
                                                              ~)k1             kr      ~k1 ;
                                                                                       r



                                                                A2
which implies that there exists a unique solution r to the (Nv -dimensional) vector-valued equation:

                                                 r = Mv (r ):                                               (68)

    Now, consider the following scalar-valued equation r = mv (r). By the contraction property (9),
it has a unique solution. Denote this solution by r 2 [0; 1]. By the de...nition of Mv ( ), the vector
r = (r ; : : : ; r ) 2 [0; 1]Nv must be a solution to (68). Then, by the uniqueness of the solution to
(68), this r must be a unique solution, which is a set of symmetric beliefs. The proof is completed.




A.2       The Spatially Dependent Case

In this section, we present formal speci...cations for the spatially dependent process fuvh g and derive
the belief convergence result. We prove Theorem 5 below, which is a ...ner, more general version of
Theorem 1 in Section 2 in that it also derives the rate of convergence without the assumption of
symmetric beliefs.
    Note that given C1 (independence over villages), each village may be analyzed separately.
So for notational simplicity, we drop the village index v , i.e. write f(Wh ; Lh ; uh )gN
                                                                                        h=1 instead of
f(Wvh ; Lvh ; uvh )gNv
                    h=1 . All of the conditions and statements here should be interpreted as conditional
ones given   v   for each village v , where we note that C2 and C3-SD are stated conditionally on             v.
    To avoid any notational confusion, we re-write C2 and C3-SD in the following simpli...ed forms
(without the village speci...c e¤ects   v   and village index v ):

C2' f(Wh ; Lh )gN
                h=1 is I.I.D. with (Wh ; Lh )       FW L (w; l).

C3-SD' fuh gN
            h=1 is de...ned through uh = u(Lh ), where fu (l)gl2R2 is a stochastic process on R
                                                                                                2

      with the following properties: i) fu (l)g is alpha-mixing satisfying Assumption 3 (provided
      below); ii) fu (l)gl2R2 is independent of f(Wh ; Lh )gN
                                                            h=1 .


A.2.1      Spatially Mixing Structure

Now, we provide additional speci...cations of fuh g modelled as a spatially dependent process. To
this end, we introduce some more notation. For a set L                    R2 , let      [L] be the sigma algebra
generated by fu(l) : l 2 Lg and de...ne

                             ~ (L1 ; L2 ) := sup jPr[B \ C ]       Pr[B ] \ Pr[C ]j ;                       (69)

where the supremum is taken over any events B 2                [L1 ] and C 2         [L2 ]. This ~ measures the
degree of dependence between two algebras; it is zero if any B and C are independent. We also
de...ne
                                                   Pk
                             R(b) := f[k
                                       j =1 Dj :      j =1 jDj j    b, k is ...niteg;



                                                      A3
the collection of all ...nite disjoint unions of squares, Dj , in R2 with its total volume not exceeding b,
where jDj j stands for the volume of each square Dj . Given these, we de...ne alpha- (strong) mixing
coe¢ cients of the stochastic process fu (l)g by

                                      (a; b) := supf ~ (L1 ; L2 ) : d(L1 ; L2 )     a; L1 ; L2 2 R(b)g;                           (70)

where d(L1 ; L2 ) is the distance between two sets: d(L1 ; L2 ) := inf fjjl ~  ljj1 : l 2 L1 ; ~l 2 L2 g, jjl ~  ljj1
stands for the l1 -distance between two points in R2 : jl1 ~l1 j + jl2 ~
                                                                       l2 j for l = (l1 ; l2 ) and ~l = (~
                                                                                                         l1 ; ~
                                                                                                              l2 ).21
We suppose     (a; b) is decreasing in a (and increasing in b). In particular, the decreasingness of
in a implies that u(l) and u(~ l) are less correlated when jjl ~ljj1 is large, i.e. the process is weakly
dependent when the mixing coe¢ cients                        (a; b) decay to zero as a tends to in...nity.

          For location variables fLh g, we consider the following increasing-domain asymptotic scheme,
which roughly follows Lahiri (1996). We regard R0 as a `prototype' of a sampling region (i.e.,
village), which is de...ned as a bounded and connected subset of R2 , and for each N , we denote by
RN a sampling region of the village that is obtained by inating the set R0 by a scaling factor
 N        ! 1 maintaining the same shape, such that

                                                       2
                                                  N=   N   ! c for some c 2 (0; 1):                                               (71)

In particular, if R0 contains the origin 0 2 R2 , we can write RN =                                NR
                                                                                                        0,   which may be assumed
WLOG. It is also assumed that R0 is contained in a square whose sides have length 1, WLOG.
Thus, the area of RN is equal to or less than                       2 .
                                                                    N      We let f0 ( ) be the probability density on R0 ,
and then for sh                f0 ( ),
                                                              Lh =        N sh ;                                                  (72)

where the dependence of Lh on N is suppressed for notational simplicity.22 Given these, we have
Lh          (1=   2 )f (   =                                                                                           RN (       R2 )
                  N 0          N ),   and the expected number of households residing in a region A
is                                                                                      Z
                                                                            1
                                  N Pr (Lh 2 A) = N Pr sh 2                N A     =N             f0 (u) du:
                                                                                             1
                                                                                            N A

We can also compute the expected distance of two individuals with Lk and Lh :
                                  Z    Z
               E [jjLk Lh jj1 ] =           jj~
                                              l ljj1 (1= 4      ~                ~
                                                         N )f0 (l= N )f0 (l= N )dldl
                                   R N    N
                                        R Z
                                        Z
                                = N             jjs
                                                  ~ sjj1 f0 (~
                                                             s)f0 (s) ds
                                                                       ~ds;                                                       (73)
                                                             R0   R0
     21
          For the veri...cation of Theorem 5 below, this de...nition of the mixing coe¢ cients using R(b) is slightly more
complicated than necessary. We maintain this de...nition, however. It is the same as the one used in Lahiri and Zhu
(2006), and they howed validity of a spatial bootstrap under this de...nition and some mild regularity conditions.
  22
     Note that when R0 does not contain the origin, we need to consider some location shift: Lh = N (sh s )
instead of (72), where s is some point in R0 such that the region `R0                   s '(shifted by s ) contains the origin.




                                                                    A4
                              ~=~
using changing variables with s l=              N       and s = l=     N.      Since the second term on the last line is
a ...nite integral (independent of N ), which exists under sups2R0 f0 ( ) < 1, the average distance
between any k and h grows at the rate of                     N.   This sort of growing-average-distance feature is
key to establishing limit theory for spatially dependent data under the weakly dependent (mixing)
condition above. We discuss this point and its implications below after introducing Assumption 3.

      Now, we state the following additional conditions on the data generating mechanism:

Assumption 3 (i) The stochastic process fu (l)gl2RN is alpha-mixing with its mixing coe¢ cients
satisfying
                                                        (a; b)    Ca     1
                                                                             b 2,

for some constants, C;           1   2 (0; 1) and   2       0, where         (a; b) is de...ned in (70). (ii) Let fLh gN
                                                                                                                       h=1
be an I.I.D. sequence introduced in C2'. Each Lh de...ned through (72) is continuously distributed
with its support RN (de...ned through RN =                          0
                                                                  NR )       and probability density function, fL ( ) =
(1=    2 )f (   =
       N 0          N ),   satisfying sups2R0 f0 (s) < 1.

      Condition (i) controls the degree of spatial dependence of fu (l)g, which is a key for establishing
limit (LLN/CLT) results. The same condition is used in Lahiri and Zhu (2006), and some analogous
conditions are also imposed in other papers such as Jenish and Prucha (2012). (ii) is the increasing-
domain condition, and is important for establishing consistency of estimators (Lahiri, 1996). The
uniform boundedness of the density is imposed for simplifying proofs, but can be relaxed at the
cost of a more involved proof.
      Conditions (i) and (ii) have an important implication for identi...cation and estimation of our
model: Given the increasing-domain condition (ii), the distance between two of individuals, k and
h, on average, increases with the rate              N   ! 1 as N ! 1, as in (73). This implies that, given the
weak dependence condition (i), the correlation between two variables,                         k   and   h,   for any k and h,
becomes weaker as N tends to 1. In other words, for each h, the number of other individuals who
are almost uncorrelated with h tends to 1 and, furthermore, the ratio of such individuals (among
all N players) tends to 1. That is, the conditional law of u(Lk ) and that of Ak are less a¤ected by
u(Lh ) for larger N , and thus E [Ak jWh ; Lh ; u(Lh )] converges to E [Ak ]. We formally verify this
convergence result in Theorem 5.
      Note that such convergence is not speci...c to our speci...cation of the data-generating mechanism,
but it occurs generically in settings with spatial data. For example, Jenish and Prucha (2012) derive
various limit results for spatial data (or random ...elds) under the increasing-domain assumption
and the so-called minimum distance condition , where the latter means that the distance between
any two individuals is larger than some ...xed constant d > 0 (independent of N ).23 These two
assumptions imply that the number of individuals who are `far away' from each h tends to 1.
 23
      Note that our increading-domain assumption (together with the speci...cation of the density of Lh ) implies that




                                                                 A5
This, together with the mixing condition as in (i) of Assumption 3, drives the convergence of
conditional expectations.

     Before concluding this subsection, we present the following Assumption 4 under which Theorem
1 in Section 2 is veri...ed. This is a multi-village version of Assumption 3 in which we allow for
v > 1 and       v   6= 0 (and thus     vh   =   v   + uvh ):

Assumption 4 (i) For each v 2 f1; : : : ; v g, given                  v,   the stochastic process fuv (l)gl2RN
                                                                                                             v
                                                                                                               is alpha-
mixing with its mixing coe¢ cients satisfying                  v (a; b)      Ca     1   b   2   for some constants C 2 (0; 1),
     > 0, and             0, where the de...nition of           (a; b) =         v (a; b)       follows (70).     (ii) For each v ,
 1                   2

given    v,   let   fLvh gNv
                          h=1   be the conditionally I.I.D. sequence introduced in C2. Each Lvh is con-
tinuously distributed with its support RN
                                        v =
                                                                  0
                                                               N Rv
                                                                               v ( ) = (1=
                                                                      and PDF fL                         2 )f v
                                                                                                         N 0      (=   N)   satisfying
sups2R0 fv
      v 0
               (s) < 1, where      R0
                                    v   is a `prototype'sampling region for each village v and                         N   is a scaling
constant with N=         2   ! c for some c 2 (0; 1).
                         N


A.2.2     Convergence of Equilibrium Beliefs

To formally state our belief convergence result, we introduce the following functional operator T 1
that maps a [0; 1]-valued function g to some constant in [0; 1]:
                                " (                                              )#
                      1               U1 (Yk Pk ; g (Wk ; Lk ; u(Lk )); u(Lk ))
                    T [g ] := E 1                                                   ;                                             (74)
                                          U0 (Yk ; g (Wk ; Lk ; u(Lk )); u(Lk ))

where T 1 [g ] is independent of k by the (conditional) I.I.D.-ness of fWk ; Lk g (Wk = (Yk ; Pk )0 ) and
                                                                       . If f(Wk ; Lk ; u(Lk ))gN
the independence between fWk ; Lk g and fu(l)g, imposed in C2'and C3-SD'                        k=1
were I.I.D., the equilibrium beliefs would be characterized as a ...xed point of this T 1 (as clari-
...ed through Propositions 1 and 2). While beliefs are given as conditional expectations under the
spatial dependence of unobserved heterogeneity as modelled in C3-SD'they are still characterized
through T 1 in an asymptotic sense stated below.
     To show this, we introduce the following mapping to characterize the beliefs under C3-SD'for
each N . Let g N = (g1 ; : : : ; gN ) be an N -dimensional vector valued function, each element of which
is a [0; 1]-valued function gh on the support of (Wh ; Lh ; u(Lh )). Then, de...ne TN as a functional
mapping from g N to an N -dimensional random vector:

                                      TN g N := (TN;1 g N ; : : : ; TN;N g N );
for any d > 0, k 6= h,
                                                                                 1
                                      Pr (jjLk Lh jj1 d) = Pr jjsk sh jj1      N d
                                       Z Z
                                                           1
                                     =       1 jju rjj1  N d f0 (u) f0 (r ) dudr ! 0;

                                                                            1
where the convergence holds as the area of (u; r) jju          rjj1        N d   shrinks to zero and f0 ( ) is uniformly bounded;
thus for any d > 0, we have the minimum distance condition with probability approaching 1.




                                                                A6
where each TN;h g N is a mapping from g N to a [0; 1]-valued random variable de...ned as

         TN;h g N
                              N
                                               " (                                                                            )                  #
                  1           X                            U1 (Yk        Pk ; gk (Wk ; Lk ; u(Lk )); u(Lk ))
         :=                                 E 1                                                                                   Wh ; Lh ; u(Lh ) :
              N        1                                        U0 (Yk ; gk (Wk ; Lk ; u(Lk )); u(Lk ))
                           k=1; k6=h


Note that TN;h g N corresponds to individual h'
                                              s belief                                                  h       (this is written as       vh   in Section 2
where multiple villages are considered), when h predicts other k '
                                                                 s behavior using gk (Wk ; Lk ; u(Lk )).
Therefore, in the equilibrium, the system of beliefs,

                             (     1; : : :         N)   =(    1 (W1 ; L1 ; u(L1 )); : : : ;            N (WN ; LN ; u(LN ));


is given as that satis...es the ...xed point restriction:

                                   (     1 (W1 ; L1 ; u(L1 )); : : : ;             N (WN ; LN ; u(LN ))                = TN       N
                                                                                                                                                       (75)

                                                          N
almost surely, where we write                                 =(      1; : : : ;    N ),   a vector of function; note that each element of
the solution,         1; : : : ;       N,   depends on N but we suppress this for notational simplicity.
      Note that (75) may be equivalently written in the following coordinate-wise form:

                                                                                                N
                                                h (Wh ; Lh ; u(Lh ))          = TN;h                    h = 1; : : : ; N:

      The next theorem states the convergence of each                                           h (Wh ; Lh ; u(Lh ))          to a unique ...xed point of
T1 , which is a constant                      = E [Ak ]:

Theorem 5 (Convergence of beliefs under spatial correlation) Suppose that C2'and C3-
SD' hold with Assumption 3, and the functional map T 1 de...ned in (74) is a contraction with
respect to the metric induced by the norm jjg jjL1 := E [jg (Wh ; Lh ; u(Lh ))j] < 1 (g is a [0; 1]-valued
function on the support of (Wh ; Lh ; u(Lh ))), i.e.,

                                         jT 1 [g ]        T 1 [~
                                                               g ]j          jjg      g
                                                                                      ~jjL1 for some                   2 (0; 1) .

Let     2 [0; 1] be a (unique) solution to the functional equation g = T 1 [g ]. Then, it holds that for
                      N
any solution               =(          1; : : : ;   N)     to the functional equation (75), which may not be unique,

                                                                                                                1 =2
                                   sup E [j              h (Wh ; Lh ; u(Lh ))              j]       C       N          for each N ,                    (76)
                              1 h N

                                                                                                        N
where C 2 (0; 1) is some constant (independent of N ,                                                       , and ), whose explicit expression is
provided in the proof, and thus

                                           sup E [j           h (Wh ; Lh ; u(Lh ))               j] ! 0 as N ! 1.
                                         1 h N




                                                                                    A7
    An important pre-requisite of Theorem 5 is that the mapping T 1 is a contraction. This
condition is easy to verify, e.g., see Section A.3 for a su¢ cient condition for the contraction property
under a linear-index restriction on the utilities. Roughly speaking, we can show that T 1 is a
contraction if the extent of social interactions is not `
                                                        too large'.
    The contraction property of the unconditional expectation operator T 1 implies uniqueness of
its ...xed-point, the conditional expectation operators TN g N = (TN;1 g N ; : : : ; TN;N g N ) need
not be a contraction and may admit multiple ...xed points (i.e., multiplicity of equilibria). The
theorem states each of the non-unique equilibrium beliefs in each N -player game converges to the
unique ...xed point of T 1 . In examples, existence of a ...xed-point solution of TN is relatively easy to
check, but its uniqueness or contraction property may not be; indeed, veri...cation of the latter may
require an appropriate speci...cation of joint distributional properties of fuh gN              N
                                                                                 h=1 = fu (Lh )gh=1 as
the operator TN is based on conditional expectations.
    Theorem 5 provides the rate of convergence of equilibrium beliefs in (76). Using this result, if
the degree of spatial dependence is not too strong with                            1   > 4, then, we can strengthen the belief
convergence result to the uniform one:

                        E [ sup j       h (Wh ; Lh ; u(Lh ))          j]
                          1 h N
                                                                                                             1 =2
                             N sup E [j         h (Wh ; Lh ; u(Lh ))              j] = N           C    N           ! 0;
                               1 h N
                p
since   N   = O( N ) as speci...ed in (71).

                                                  1 from an N -dimensional vector valued
Proof of Theorem 5. De...ne a functional mapping TN;h
function g N = (g1 ; : : : ; gN ) to r 2 [0; 1]:
                                                                           N
                                                                           X
                                             1                   1
                                            TN;h g N :=                                T 1 [gk ] ;                          (77)
                                                             N       1
                                                                         k=1; k6=h

                                                                                   N is a [0; 1]-valued
where T 1 is de...ned in (74) (as a mapping on scalar valued functions), and each gh
                                                              1 , we also de...ne an N -dimensional
function on the support of (Wh ; Lh ; u(Lh )). Based on this TN;h
vector mapping:
                                        T1 [g N ] := (TN;
                                                       1
                                                          1 g
                                                              N            1
                                                                ; : : : ; TN;N g N ):

We also write       N   = ( ; : : : ; ), the N -dimensional vector each element of which is . Then, since
  is a ...xed point of T 1 (i.e.,           = T 1 [ ]), it obviously holds that

                                       N
                                            = T1 [   N         1
                                                         ] = (TN; 1[
                                                                           N               1
                                                                               ]; : : : ; TN;N [   N
                                                                                                       ]):                  (78)

                N
Now, since          =(    1; : : : ;   N)   solves the functional equation:

                         (   1 (W1 ; L1 ; u(L1 )); : : : ;   N (WN ; LN ; u(LN )))                 = TN             N
                                                                                                                        :   (79)



                                                                 A8
where TN maps an N -dimensional vector valued function to an N -dimensional random vector.
   Given (78) and (79), we can see that

                                                                               N            1
                                 h (Wh ; Lh ; u(Lh ))          = TN;h                      TN;h [ ] for each h:

Thus, by the triangle inequality and the contraction property of T1 , we have

                 jj    h (Wh ; Lh ; u(Lh ))             jjL1
                                         N      1        N             1           N          1        N
                        jjTN;h                 TN;h [        ]jjL1 + jTN;h [           ]     TN;h [        ]j for any h.                              (80)

                       1 in (77) as well as that of
By the de...nition of TN;h                                               N    = ( ; : : : ; ), the second term on the majorant
side is bounded by
                                                                               N
                                                                               X
                         1           N        1                     1
                        TN;h [           ]   TN;h [ N]   =                                 T1[    k]       T1[ ]
                                                                N        1
                                                                             k=1; k6=h

                                                                max jT 1 [          h]        T 1 [ ]j
                                                               1 h N

                                                                  max jj         h (Wh ; Lh ; u(Lh ))                  jjL1 ;
                                                                 1 h N

where the last inequality follows from the contraction condition on T 1 . Thus, this bound and (80)
lead to
                                                                         1                                 N           1        N
            max jj       h (Wh ; Lh ; u(Lh ))            jjL1                    max jjTN;h                           TN;h [        ]jjL1 :
           1 h N                                                    1          1 h N

Therefore, if it holds that

                                                                                                           1 =2
                                      max sup jjTN;h [g N ]              1
                                                                        TN;h [g N ]jjL1          C     N          ;                                   (81)
                                     1 h N

for some constant C 2 (0; 1) independent of N , where the supremum is taken over any (Borel
measurable) functions, g N : [0; 1]N ! [0; 1]N , then the desired result (76) holds with C =                                                  1
                                                                                                                                                  1
                                                                                                                                                      C.
Proof of (81). For notational simplicity, we write
                                        (                                            )
                                          U1 (Yk Pk ; g (Wk ; Lk ; u(Lk )); u(Lk ))
             mg (Wk ; Lk ; u(Lk )) := 1                                                ;
                                              U0 (Yk ; g (Wk ; Lk ; u(Lk )); u(Lk ))

for an arbitrary function, g : [0; 1] ! [0; 1]. Then, the inequality (81) follows if

            max sup kE [ mg (Wk ; Lk ; u(Lk ))j Wh ; Lh ; u(Lh )]                                E [mg (Wk ; Lk ; u(Lk ))]kL1
          1 h;k N
                      1 =2
             C   N           ;                                                                                                                        (82)

where the supremum is taken over any (Borel measurable) functions, g : [0; 1] ! [0; 1].
   To show this inequality, observe that by (ii) of C3-SD'
                                                         ,

                        fu (l)g ? (Wh ; Lh ; Wk ; Lk ) ) fu (l)g ? (Wk ; Lk )j Wh ; Lh :                                                              (83)



                                                                    A9
Here, we recall the following result on independence: for random objects Q, R, and S ,

                                Q ? R jS and R ? S ) (Q; S ) ? R:

Applying this with Q = fu (l)g, R = (Wk ; Lk ), and S = (Wh ; Lh ), since C2'implies that (Wh ; Lh ) ?
(Wk ; Lk ), we can obtain
                                      (fu (l)g ; Wh ; Lh ) ? (Wk ; Lk );                             (84)

which in turn implies that
                                      (uv (Lh ); Wh ; Lh ) ? (Wk ; Lk ):                             (85)

The relation (84) also leads to

              (u(~
                 l); u(Lh ); Wh ; Lh ) ? (Wk ; Lk ) ) u(~
                                                        l) ? (Wk ; Lk )j u(Lh ); Wh ; Lh :           (86)

for any ~
        l. Then, we can compute the conditional expectation in (82) as

                   E [ mg (Wk ; Lk ; u(Lk ))j Wh ; Lh ; u(Lh )]
                       Z   "                                                     #
                                                          Wh ; Lh ; u(Lh );
                   = E mg (Wk ; Lk ; u(Lk ))                                              ~ ~
                                                                                   dFW L (w; l)
                                                         (Wk ; Lk ) = (w; ~ ~l)
                       Z   "                                              #
                                                  W  h ; Lh ; u ( Lh ) ;
                   = E mg (w;     ~ ~ l; u(~
                                           l))                              dFW L (w;~ ~
                                                                                       l)
                                                 (Wk ; Lk ) = (w;  ~ ~ l)
                       Z   h                                        i
                   = E mg (w;     ~ ~l; u(~l)) j Wh ; Lh ; u(Lh ) dFW L (w;     ~ ~
                                                                                  l)                 (87)

where the ...rst and third equalities have used (85) and (86), respectively.
   Now, we look at the maximand on the LHS of (82):
     h                                                                              i
    E jE [ mg (Wk ; Lk ; u(Lk ))j Wh ; Lh ; u(Lh )] E [mg (Wk ; Lk ; u(Lk ))]j
           hZ Z      h                                                i
    =E   u
                 E mg (w;  ~ ~
                             l; u(~ l)) j (Wh ; Lh ) = (w; l); u(l) dFW L (w;  ~ ~
                                                                                 l)
                                                   i
        E [mg (Wk ; Lk ; u(Lk ))] dFW L (w; l)
            Z Z      h                          i
    =E   u
                  E mg (w; ~ ~l; u(~ l)) j u(l) dFW L (w; ~ ~
                                                            l) E [mg (Wk ; Lk ; u(Lk ))] dFW L (w; l)
            Z Z n h                               i     h                   io
    = Eu            E mg (w; ~ ~ l; u(~l)) j u(l)     E mg (w; ~ ~ l; u(~l)) dFW L (w;~ ~l) dFL (l)
       Z Z      h h                             i     h                   ii
             E u E mg (w;  ~ ~l; u(~ l)) j u(l)      E mg (w;~ ~l; u(~ l)) dFW L (w;~ ~l)dFL (l) ;    (88)

where E u [ ] is the expectation that only concerns fu(l)gl2R2 ; the ...rst equality uses (87) and the
independence of fu(l)gl2R2 and (Wh ; Lh ); the second equality again uses the same independence
condition (i.e., (u(~
                    l); u(l)) ? (Wh ; Lh ) and thus u(~
                                                      l) ? (Wh ; Lh )j u(l)); the third equality holds
since                                               Z     h             i
                     E [mg (Wk ; Lk ; u(Lk ))] =        E mg (w; ~   ~          ~ ~
                                                              ~ l; u(l)) dFW L (w; l);



                                                        A10
by the independence of fu(l)g and (Wk ; Lk ), and the last inequality uses the Fubini theorem.
   To bound the RHS of (88), note that for jj~                                                    ~
                                             l ljj1 > 0, we can always construct two sets on R2 , L
and L satisfying 1) the former contains ~ l and the latter contains l, 2) the distance between the two
sets is larger than jj~
                      l ljj1 =2, 3) Each of L~ and L is a square in RN with its area less than 1. u(~l)
and u(l) are measurable with respect to                         ~] and
                                                               [L                 [L], respectively. Then, noting the de...nition of
mixing coe¢ cients of fu (l)g in (69) and (70), these 1) - 3) allow us to apply McLeish'
                                                                                       s mixingale
inequality (p. 834 of McLeish, 1975; or Theorem 14.2 of Davidson, 1994) and derive its bound in
terms of (jj~l ljj1 =2; 1). That is, since jmg j is uniformly bounded ( 1), we obtain
                   h    h                       i                    h               ii
              Eu             ~ ~
                       E mg (w; l; u(~
                                     l)) j u(l)                           ~ ~
                                                                    E mg (w; l; u(~
                                                                                  l))                                   6 (jj~
                                                                                                                             l    ljj1 =2; 1);               (89)

                   ~, ~
uniformly over any w  l, and l.
   To ...nd an upper bound of the majorant side of (88), recall that the (marginal) distribution
function FL (whose support is given by RN ) has the density fL (l) = (1=                                                         2 )f (l=
                                                                                                                                 N 0      N)     for each N ,
and also that by the de...nition of the mixing coe¢ cients in (69) and (70),                                                        (a; b)       2 uniformly
over any a, b. Then, plugging (89), we have
                            Z Z
          the RHS of (88)           (jj~
                                       l ljj1 =2; 1)dFL (~
                                                         l)dFL (l)
                              Z    Z
                          =6              (jj~
                                             l ljj1 =2; 1)dFL (~l)dFL (l)
                               R N  R  N
                              Z Z
                          =6             ( N jjs
                                               ~ sjj1 =2; 1)fs (s)fs (~s)dsds
                                                                            ~
                               R 0 R0
                              Z Z
                            6                  =2
                                                         2fs (s)fs (~
                                                                    s)dsds~
                                               jjs
                                                 ~ sjj1            1     ~;s2R0
                                                                        ;s
                                         Z Z                   N

                                                                                                             1
                                   +6                                                   C2      1
                                                                                                         N          ~
                                                                                                                  jjs    sjj1 1 fs (s)fs (~    ~
                                                                                                                                          s)dsds
                                               jjs
                                                 ~ sjj1 >          1 =2 ;   ~;s2R0
                                                                            s
                                                               N
                                                  1 =2                        1 =2     2
                                        6[2   N          + C2      1
                                                                        N            ]f0 ;                                                                   (90)

where f0 := sups2R0 f0 ( ), the last inequality holds since
   Z Z                                                   Z Z
                                                                                                                                   2             1 =2    2
                  =2
                             2 fs ( s ) f s  s
                                            (~ ) dsd ~
                                                     s 2                                                                    ~
                                                                                                                         dsdv     f0     2   N          f0
        jjs
          ~ sjj1       1   ;   ~;s2R0
                               s                                                     jjv
                                                                                       ~jj1              1 =2 ;   s2R0
                   N                                                                             N


                                                                       1 =2
by changing variables, and for jjs
                                 ~                sjj1 >           N          ,

                                                                            1                 1 =2
                                                         jjs
                                                           ~       sjj1                N             :

Thus, we can see that this upper bound of (88) is independent of h, k , and g , and thus the inequality
                                     2 , completing the proof.
(82) holds with C := 6 [2 + C 2 1 ] f0




                                                                          A11
A.3      Su¢ cient Conditions for Contraction
                                                  ?
Here, we investigate the contraction property of Fv;N  (de...ned in (23)) as well as its limit operator:
                                                     v


                     ?
                    Fv; 1 [g ] (l; e; 1 ; 2 )
                        Z Z
                    :=          1fw ~ 0 c + v + g (~
                                                   l; e
                                                      ~;            1; 2)     ~
                                                                             +e        0gdH (~   v
                                                                                             e)dFW;L  ~ ~
                                                                                                     (w; l):                         (91)

 ?
Fv;                                                                                                                            ?
    1 is a functional operator from a [0; 1]-valued function g = g (l; e;                             1; 2)     to a constant Fv; 1 [g ] 2
[0; 1]. This limit operator is used investigate convergence properties of the estimators. We impose
the following conditions:

Assumption 5 (i) For any             2 [lv ; uv ],         0 and the density h of the conditional CDF H (~
                                                                                                         ejea ; d;                           2)

satis...es
                                             sup                      eje; jj~
                                                                    h(~      l        ljj1 ;   2)   2 [0; 1),                        (92)
                                 ~;e2R; jj~
                                 e        l ljj1 0;      22     2


where ~                                               ~ and e, respectively, jj~
      l and l denote location indices associated with e                        l                                      ljj1 stands for the
distance, and the interval [lv ; uv ] is the set of possible values of                           (introduced in Assumption 7).
(ii) The conditional CDF H ( je; d;          2)    satis...es

                                          H (~
                                             ejea ; d;        2)        H (~
                                                                           ejeb ; d;      2 ),


for any e
        ~ 2 R and any d;        2,   if ea       eb .

    These conditions are used to verify the so-called Blackwell su¢ cient conditions (c.f. Theorem
3.3 of Stokey and Lucas, 1989: I). The non-negativity of                                  is used for the monotonicity. While
(92) is a condition for the conditional density, it also implies the same condition for the marginal
density:
                                                         sup h(~
                                                               e) 2 [0; 1);
                                                         e
                                                         ~2R
               R
since h(~
        e) =         eje; jj~
                   h(~      l   ljj1 ;   2 )h(e)de      (recalling that H (e) is de...ned as the CDF of "vh and
F" ( e) is that of      "vh , it holds that h(e) = f" ( e)). Condition (ii) means that H ( jea ; d;                                    2)

...rst-order stochastically dominates H ( jeb ; d;              2 ),    implying that any two of (spatially dependent)
variables, "vk and "vh , are (weakly) positively correlated, which is also conveniently used to show
                     ?
the monotonicity of Fv;N   .
                         v
                                                                         ?
    Given these preparations, we can show the contraction properties of Fv;        ?
                                                                            1 and Fv;Nv :

                                                             ?
Proposition 3 Suppose that (i) of Assumption 5 holds. Then, Fv; 1 is a contraction in the space
of [0; 1]-valued functions on Rv
                               Nv            R       1             2,   g (l; e;   1 ; 2 ),    each of which are nondecreasing in
e, equipped with the sup metric, where             Rv
                                                    Nv    denotes the support of the random variable Lvh .
                                          ?
b) Suppose that Assumption 5 hold. Then, Fv;N  is a contraction in the same space.
                                             v




                                                                A12
     The restriction for g being nondecreasing-ness is innocuous when considering ...xed points of
 ?
Fv;        ?
    1 and Fv;Nv . This is because, given the non-negativity of                                           and the stochastic-dominance of
H , the ...xed points are also nondecreasing in e (since
      ?
     Fv;             ?
         1 [g ] and Fv;Nv [g ] are also nondecreasing in e for such a nondecreasing).
                                                               ?
     In this proposition, we have de...ned the limit operator Fv; 1 on the set of general functions,
g (l; e;   1 ; 2 ),   which may depend on (l; e). This general domain space is required to consider the
                             ?
convergence of the operator Fv;N                                                                   ?
                                  and its ...xed point. However, if we de...ne the limit operator Fv;
                                v                                                                     1
only on the restricted space of functions, g ( 1 ;                         2 ),   each of which is independent of (l; e), we can
write                                                       Z
                                ?
                               Fv; 1 [g ] ( 1 ; 2 )   =              ~0c +
                                                                 F" (w            v   + g( 1;                v
                                                                                                                  ~ ~
                                                                                                       2 ))dFW;L (w; l);

since H (e) = 1                F" ( e). In this case, by the Lipschitz continuity of F" , we can check the
                         ?
contraction property of Fv; 1 on the restricted space under


                                                j j sup h (e) = j j sup f" (e) < 1:
                                                      e2R                       e2R

Note that in the probit speci...cation in which "vh is supposed to follow the standard normal,
                  p
supe2R f" (e) = 1= 2 ; and the logit speci...cation, supe2R f" (e) = 1=4.

                                               ?
Proof of Proposition 3. First, we investigate Fv; 1 by using the Blackwell su¢ cient conditions.
Since                      ?
               0, we have Fv;                   ?
                              1 [f ]           Fv; 1 [g ] for any two functions f; g with f (l; e;                       1; 2)   g (l; e;   1 ; 2 ),

implying the monotonicity condition. II) For a constant a                                         0,

                        ?
                       Fv; 1 [g + a] ( 1 ; 2 )
                          Z Z
                       =        1fw~ 0 c + v + g (~
                                                  l; e
                                                     ~;               1; 2)   + a+e
                                                                                  ~                0gh(~
                                                                                                       e)de  v
                                                                                                          ~dFW;L  ~ ~
                                                                                                                 (w; l):

Since g (~
         l; e
            ~;        1; 2)                       ~ and
                              is nondecreasing in e                             0,     g (~
                                                                                          l; e
                                                                                             ~;    1; 2)    +e
                                                                                                             ~ is strictly increasing in e
                                                                                                                                         ~.
Thus, we can ...nd a unique e0 satisfying

                                              ~0c +
                                              w             v    + g (~
                                                                      l; e0 ;     1; 2)   + e0 = 0;

          ~ ~
for each (w; l;        1 ; 2 ).   For each a       0, let e be a unique number satisfying

                                             ~0c +
                                             w          v   + g (~
                                                                 l; e;      1; 2)      + a + e = 0:

Since a          0 and the slope of the function g (~
                                                    l; e
                                                       ~;                         1; 2) + e
                                                                                          ~
                                                                          is greater than or equal to 1, we must
have e0 > e and (e0                e)    1      a. This upper bound of (e0 e) holds for any (w;~ ~
                                                                                                 l; 1 ; 2 ). Thus,

                                   ?                                 ?
                                  Fv; 1 [g + a] ( 1 ;       2)      Fv; 1 [g ] ( 1 ;    2)   + (e0         e) sup h(~
                                                                                                                    e)
                                                                                                             e
                                                                                                             ~2R
                                                                     ?
                                                                    Fv; 1 [g ] ( 1 ;    2)   +a           sup h(~
                                                                                                                e):
                                                                                                          e
                                                                                                          ~2R




                                                                         A13
Therefore, if (92) holds, the so-called discounting condition is satis...ed. Therefore, given I) and II),
                   ?
we have veri...ed Fv; 1 is a contraction.
                            ?
    Next, we investigate Fv;N                                                                      ~0c + v +
                                 . Note that since g (l; e; 1 ; 2 ) is nondecreasing in e, so is 1fw
                               v

 g (~
    l; e            ~ 0g, and given (ii) of Assumption 5, the mapped function F ? [g ] (l; e; 1 ; 2 ) is
       ~; 1 ; 2 ) + e                                                                                                     v;Nv
also nondecreasing. Therefore, the domain and range spaces of                                          ?
                                                                                                      Fv;N        can be taken to be identical.
                                                                                                          v

We can also check the Blackwell su¢ cient conditions for                             ?
                                                                                    Fv;N                                      ? ,
                                                                                              exactly in the same way as for Fv;
                                                                                        v                                        1
implying the desired contraction property.


A.4        Proof of Theorem 2 (the Estimators'Convergence)

Here, we prove Theorem 2 through several lemmas. In Section 3, for ease of exposition, we assumed
that the village-...xed e¤ects            1; : : : ; v   are known to the econometrician. Here, we explicitly include
them in the parameter              1   to be estimated. Note also that identi...cation of preference parameters in
presence of       0s   requires identi...cation of the           0s   themselves; hence we need to use one of the methods
for doing so, as described in Section 4.4. Here we use the homogeneity assumption                                                   1   =   v;   an
alternative proof can be given for the correlated random e¤ects case. To sum up, for this section,
we re-de...ne the eventual parameter as                     1   = (c0 ;     1; : : : ; v 1;       ) (see e.g. Assumption 7), with all
other related quantities interpreted analogously. Consistency of the estimators for the case with
 1; : : : ; v   known is a simpler corollary of Theorem 2.
       To analyze ^FPL and ^BR , we de...ne the following conditional moment restriction:

                             E A1
                                vh
                                               0
                                          F" (Wvh c+        v   +         ?
                                                                          v ( 1 ))jWvh    = 0 (v = 1; : : : ; v ),                              (93)

where A1                                                             24
       vh is a hypothetical outcome variable based on the limit model :

                                       A1        0
                                        vh := 1 Wvh c +               v   +       ?
                                                                                  v( 1)   + "vh           0 :                                   (94)

For each v , let rv = lim N
                          N , where this limit ratio value is supposed to be in (0; 1) (note that
                            v

     Pv                                               ^ FPL ( 1 ) and L
                                                                      ^ BR ( 1 ),
N = v=1 Nv ). We also consider the limit versions of L
                                               v
                                               X
                              LFPL ( 1 ) :=           rv E A1          0
                                                            vh log F" Wvh c +                     v   +       ?
                                                                                                              v ( 1)
                                               v =1

                                           +(1        A1
                                                       vh ) log 1
                                                                               0
                                                                           F" Wvh c+              v   +       ?
                                                                                                              v ( 1)      ;
                                               v
                                               X
                               LBR ( 1 ) :=           rv E A1          0
                                                            vh log F" Wvh c +                     v   +       v
                                               v =1

                                           +(1        A1
                                                       vh ) log 1
                                                                               0
                                                                           F" Wvh c+          v   +       v        ;
  24
       Recall that     1   has been de...ned through the conditional moment restriction (26) for the observed variables
(Avh ; Wvh ; Lvh ) generated from the ...nite-player game (Avh is generated from (22) or equivalently (24)).                                1   may
also be de...ned as the one satisfying restriction(93), which is correctly speci...ed for the variables (hypothetically)
generated from the limit model, (A1
                                  vh ; Wvh ).




                                                                      A14
respectively, where    ?       in LFPL ( 1 ) is de...ned as a solution to (34) for each 1 , and v in
                       v ( 1)
                                                           1 PNv
LBR ( 1 ) is de...ned as the (probability) limit of ^v = N  v  h=1 Avh (note that the limits of ^v and
 1 PNv      1
Nv   h=1 Avh coincide, which follows from arguments analogous to those in the proof of Lemma 3).
The ...rst order condition of LFPL ( 1 ) may be seen as an unconditional moment restriction based
on the conditional one (93).
   Note that given the continuity of F" ( ), LFPL ( 1 ) and LBR ( 1 ) are continuous in 1 . Lemma 3
shows the uniform convergence of L   ^ FPL ( 1 ) to LFPL ( 1 ) in probability over 1 ; we can also show
        ^ BR ( 1 ) to LBR ( 1 ) in probability over 1 (the proof this result is analogous to that of
that of L
Lemma 3, and is omitted).
   Given the limit objective function, we let

                                                1   = argmax LFPL ( 1 );                                             (95)
                                                        12   1

                                               #
                                               1    = argmax LBR ( 1 ):                                              (96)
                                                        12   1


Lemma 2 shows identi...cation of          1   (i.e., it is a unique maximizer of LFPL ( 1 ) over             1)   and the
                      #
same result as for    1 .   As a result, by Theorem 2.1 of Newey and McFadden (1994), given the
compactness of the parameter space             1,   we obtain
                                                   p
                                              ^FPL !                p          #
                                               1        1    and ^1 !          1 :

                                            #
Since Lemma 2 also shows that         1 = 1    under the correct speci...cation, we have jj ^1
                                                                                             FPL   ^1 jj.
   By Lemma 4, we have sup               ^ SD ( 1 ; ^2 ) L
                                         L               ^ FPL ( 1 ) = op (1), which, together with Lemma
                                 12   1

3, implies that
                                     ^ SD ( 1 ; ^2 )
                                 sup L                        LFPL ( 1 ) = op (1) :
                                 12   1

                                 p
                             ^SD !
This in turn means that       1       1   (by using Newey and McFadden'
                                                                      s Theorem 2.1 again). These
lead to the conclusion of the theorem.



A.4.1    Identi...cation Results: Lemmas 1 - 2
                                                                           #
In this subsection, we investigate identi...cation of            1   and   1   (de...ned in (95) and (96), respectively).
To this end, we impose the following conditions:

Assumption 6 (i) Let uv (l) = (u0        1
                                v (l)); uv (l)) and


                                               "v (l) := u1
                                                          v (l)       u0
                                                                       v (l) ;


and the (marginal) CDF of       "v (l) is F" ( ) for each l 2 Lv , whose functional form is supposed to be
known, and F" ( ) is strictly increasing on R with its continuous PDF f" ( ) satisfying supz 2R f" (z ) <



                                                            A15
1.
                                                                            0 ; 1)0 is not
(ii) The random vector Wvh includes no constant component. The support of (Wvh
included in any proper linear subspace of RdW +1 , where dW is the dimension of Wvh .

     Assumption 6 is quite standard. The condition in (i) on the support of                                                       "v (l) may be relaxed,
allowing for some bounded support (instead of R), but it simpli...es our subsequent conditions and
proofs and thus is maintained.

                                                                                                                      1    PNv
Assumption 7 (i) Let                        v   (2 (0; 1)) be the probability limit of ^v =                          Nv       h=1 Avh .       It holds that

                                                                             1   6=      v:                                                                   (97)

(ii) Denote by              1     = (c0 ;   1; : : : ; v 1;    )0 a generic element in the parameter space                                         1.     1   is a
compact subset of                RdW +v     such that
                                                                                  Qv
                                                               1    =   c             v =1 [lv ; uv ];

                                                                                                      Qv
where         c   is a compact subset of RdW in which c lies and                                       v =1 [lv ; uv ]   is a closed rectangular region
of   Rv   (with some lv ; uv 2 R) in which ( 1 ; : : : ;                         v 1;        )0   lies.
(iii) For any             2 [lv ; uv ],
                                                                    j j sup f" (z ) < 1:                                                                      (98)
                                                                         z


                                                                                                                                              Qv
(iv) Let c} be an element of                        c.   Given this c} (...xed), for any ( 1 ; : : : ;                       v 1;      )0 2     v =1 [lv ; uv ],   it
holds that
     Z                                                                           Z
        F" (w0 c +                1   +     ?
                                            1 ( 1 )jc=c
                                                              1
                                                           )dFW (w)         <          F" (w0 c +           1   +        ?
                                                                                                                         v ( 1 )jc=c
                                                                                                                                          v
                                                                                                                                       )dFW (w);              (99)

where v? ( )j               ?     0                    0
           1 c=c stands for v ((c ; 1 ; : : : ; v 1 ; ) ), a unique solution to the ...xed point equation,
     R
 v =   F" (w0 c + v + v )dFWv (w ) (v = 1; : : : ; v; with
                                                             1 = v ).


     Assumption 7 (i) leads to di¤erent `
                                        constant'terms for v = 1; v under the homogeneity assump-
tion (    1   =    v ),   i.e.,
                                                                1   +        1   6=      v   +        v:

                                                           #           #             #            #
This is required for identi...cation of                    1 ; : : : ; v 1;              in       1   through the Brock-Durlauf type objective
function      LBR (       1 ).

     Conditions (ii) - (iv) are used for identi...cation of                                       1   via LFPL ( 1 ). The rectangularity of the
parameter space for ( 1 ; : : : ;                  v 1;    )0 imposed in (ii) is a technical requirement when using Gale
and Nikaido's (1965) result for univalent functions (see their Theorem 4 and our proof of Lemma
1). The restriction on                          in (98) in (iii) guarantees the contraction property of the ...xed point




                                                                                 A16
problem (see discussions in Appendix A.3). As for (iv), since                                           ?                               ?         in LFPL ( 1 ) are
                                                                                                        1 ( 1)        and               v ( 1)
...xed points, we can equivalently re-write (99) as

                                                        ?                         ?
                                                        1 ( 1 )jc=c        <      v ( 1 )jc=c   .                                                                  (100)

This is an extension of (97) to the model-based probabilities for all ( 1 ; : : : ;                                              v 1;         )0 in the parameter
space, where we note that (99) implies (97) under (93) since                                    =        ?                                       ?
                                                                                            v            v ( 1 ).             Note that if       1 ( 1 )jc=c 6=
 ?                                                                                                                            ?                    ?
 v ( 1 )jc=c   , we may suppose (100) without loss of generality. That is, if                                                 1(        1 )jc=c > v ( 1 )jc=c ,

we may re-label the indices v = 1; v to secure "<".
      The inequality (99) does not impose any substantive restriction. For example, if                                                                             0 and
the   (marginal) distribution of W1  0 c is ...rst-order stochastically dominated by that of W 0 c , then
                                      h                                                        vh
the   ...xed point solutions satisfy 1 ? ( )j      <   ? ( )j     and  thus (99) for any   (since F" ( ) is
                                           1 c=c       v   1 c=c                         1

strictly increasing), where any restriction on                         1   (except for the maintained one:                                           0) is imposed.
                                                                                                                 #
      Now, we are ready to establish the identi...cation properties of                                           1   and            1:


Lemma 1 (Global identi...cation) Suppose that Assumption 6 holds.
                                                                                      #
(a) Further if (i) of Assumption 7 holds, then for any                                1 ; 1     2       1,

                                          0 #            #         #                    0
                                     F" (Wvh c +         v    +            v)   6= F" (Wvh c+           v   +             v );                                     (101)

                                                                                                    #                                     #          #
for some v 2 f1; : : : ; v g with positive probability, if and only if                              1   6=       1,       where           1   =      v   and   1   =   v.

(b) Denote by         1   = (c 0 ;   1 ; : : : ; v 1;       )0 any element in             1.    Further if (ii) - (iv) of Assumption 7
                                                                                     }
are satis...ed, in which (iv) is satis...ed with                  c}   of this       1,   then for               1   2         1,

                                  0                               ?                     0                                 ?
                              F" Wvh c +           v    +         v( 1)         6= F" (Wvh c+           v   +             v ( 1 ))                                 (102)

for some v 2 f1; : : : ; v g with positive probability, if and only if                              1       6=       1,   where           1   =      v   and   1   =   v.

                                                                                                                                                 #
      The result of this lemma allows us to establish (global) identi...cation of                                                   1   and      1   based on their
limit objective functions,            LFPL (     1)     and   LBR (        1 ).   Note that this result does not presuppose the
correct speci...cation of model-implied conditional choice probabilities as in (93). However, given
(93) with      1,   our identi...cation analysis based on the objective functions can be done analogous to
that for ML estimators in the standard I.I.D. case (as in Lemma 2.2 and Example 1.2 of Newey
and McFadden, 1994, pages 2124-2125), which is due to the form of our objective functions, while
they are not full ML functions. We summarize the objective-function-based identi...cation result as
follows:

Lemma 2 Suppose that                  1   satis...es the conditional expectation restriction (93), and Assumptions
4-7 hold, where (iv) of Assumption 7 holds with c in this                                      1.   Then,                 1    is a unique maximizer of
LFPL ( 1 ) in        1    and it is also a unique maximizer of LBR ( 1 ) in                                  1.




                                                                           A17
                         #
     While    1   and    1       (introduced in (95) and (96), respectively) may di¤er in general, this lemma
states that they are identical if we suppose the correct speci...cation, under which we will identify
them and always write               1   hereafter.



A.4.2     Uniform Convergence Results: Lemmas 3 - 4

In this subsection, we establish uniform convergence for the objective functions using the following
conditions:

Assumption 8 (i) For any v , the support of Wvh is included in SW , a bounded subset of RdW .
           eje; j~
(ii) Let h(~     l lj1 ; 2 ) be the conditional probability density of "vk given (v; k )'s location Lvk = ~
                                                                                                          l
and (v; h)'s variables (Lvh ; "vh ) = (l; e) (parametrized by                       2   2    2)    satisfying

                                          eje; j~
                                        h(~     l       l j1 ;   2)     h(~
                                                                          e)     M1 j~
                                                                                     l      lj1 1 h(~
                                                                                                    e),

where M1 ;    1    2 (0; 1) are constants (independent of e and                               2 );   1   > 4 is the same constant
introduced in Assumption 4 (the majorant side is de...ned as 0 if ~
                                                                  l = l).

     Assumption 8 (ii) can be derived from a spatial analogue of the so-called strong Doeblin condi-
tion used in Markov chain theory (see, e.g., Theorem 1 of Holden, 2000), which can be satis...ed by
various parametric models. It is a strengthening of the alpha-mixing condition in (i) of Assumption
4.

Lemma 3 Suppose that C1 - C2, C3-SD, (i) of Assumption 6, (ii) - (iii) of Assumption 7,
Assumption 4 - 8 hold. Then,

                                                 ^ FPL ( 1 )
                                             sup L                        LFPL ( 1 ) = op (1).
                                             12   1


Lemma 4 Suppose that C1 - C2, C3-SD, Assumption 5, (i) of Assumption 6, (ii) - (iii) of
Assumption 7, Assumptions 4 - 8 hold. Then, for each v ,

                   sup             sup      ^ (Wvh ; Lvh ;
                                            C                         1; 2)
                                                                                   0
                                                                               F" Wvh c+       v
                                                                                                      ?
                                                                                                   + ^v ( 1)    = op (1)            (103)
              12   1;   22       2 1 h Nv


and
                        ^ SD ( 1 ; ^2 )
                    sup L                             ^ FPL ( 1 ) = op (1) for any estimator ^2 of
                                                      L                                                             2.
                    12       1



A.4.3     Proofs of Lemmas 1 - 4

Proof of Lemma 1. The proof of the result (a) is standard and is omitted. Here, we focus on (b).
For ease of exposition, we let v = 11, as in our empirical application and set                                  1   =    11 .   The proof




                                                                         A18
for any other v can be done in exactly the same way. We let                                                                1   = (c0 ;    1 ; : : : ; 10 ;    )0 and de...ne       1
analogously. Since F" ( ) is strictly increasing, (102) is equivalent to
                         0                                      ?             0                              ?
                        Wvh c +               v   +             v( 1)     6= Wvh c+             v    +       v ( 1)   for some v 2 f1; : : : ; v g ;                            (104)

with positive probability. We can immediately see that this (104) implies that                                                                                1   6=       1.   Now,
supposing that                  1   6=       1,   we shall derive (104). To this end,,we consider the following ...ve cases: 1)
If c 6= c, (104) holds with positive probability by (i) of Assumption 4, regardless of the equality
for the other (constant) terms (i.e.,                                         +           ?                                         ?
                                                                          v               v( 1)      is equal to       v    +       v ( 1)    or not). 2) If c = c and
     =        = 0, we must have ( 1 ; : : : ;                          10 )       6= ( 1 ; : : : ;   10 ),   implying (104). 3) If c = c,                          = 0,         6= 0,
and ( 1 ; : : : ;                                                                                                ?
                         10 )   = ( 1; : : : ;          10 ),     we must at least have                          11 ( 1 )      > 0 by (99) of Assumption 7 and
thus          ?
              11 ( 1 )   6= 0, which implies (104).
4) For the case with c = c,                                           = 0,               6= 0, and ( 1 ; : : : ;            10 )   6= ( 1 ; : : : ;   10 ),   we suppose in
contradiction that                           =          +         ?                                                                          ?
                                         v          v             v ( 1)          for any v 2 f1; : : : ; v g. Then,                         1 ( 1)   =       1        1    =    and
 ?                                                                                               ?                ?
 11 ( 1 )     =     1           1    = , since              1   =     11 ,    and thus           1 ( 1)      =    11 ( 1 ).     However, this contradicts (99) of
Assumption 7.
5) Finally, we consider the case with c = c,                                                     6= 0, and            6= 0. In this case, by re-parametrizing
 v   =    v   +        v,   the ...xed point equations (with respect to v ),
                                      Z
                                v   =   F" (w0 c + v + v )dFW v
                                                                (w) (v = 1; : : : ; 11,                                                  1    =   11 ),                         (105)

can be equivalently re-written as equations with respect to v :
                              Z
                   v = v +
                                                 v
                                 F" (w0 c + v )dFW (w) (v = 1; : : : ; 11,                                                                1   =   11 ).                         (106)

That is, if             =       ?                                                                     ?                            ?
                   v            v ( 1)        is a solution to (105), then                            v   ( 1) =      v+           v ( 1)    is a solution to (106); and
if   ?   ( 1 ) solves to (106), then                            ?                    ?
     v                                                          v ( 1)    =(         v   ( 1)        v )=    solves (105). We can also check the solution
uniqueness of (105) is equivalent to that of (106). By this re-parametrization, given c} = c, (104)
is
                                                        ?                     ?
                                                        v( 1)        6=       v   ( 1 ) for some v 2 f1; : : : ; 11g ,                                                          (107)

which we shall show below. Now, to investigate (106), we de...ne the following vector-valued (11-
                                                                      Q
by-1) function of := ( 1 ; : : : ; 11 )0 and = ( 1 ; : : : ; 10 ; )0 2 11
                                                                        v =1 [lv ; uv ] as
                                                 0                  1
                                                      K1 ( ; )
                                                 B           .      C
                                      K ( ; ) := B
                                                 @
                                                             .
                                                             .      C;
                                                                    A
                                                     K11 ( ; )
where
                                                                                    Z
                            Kv ( ; ) =                      v    +    v   +              F" (w0 c +               v
                                                                                                             v )dFW (w )           for v = 1; : : : ; 10;
                                                                                     Z
                         K11 ( ; ) =                        11    +     1     +           F" (w0 c +                11
                                                                                                              11 )dFW (w ),




                                                                                                A19
and the dependence of K and Kv on c = c is suppressed for notational simplicity. Given (98) of
Assumption 7, using the contraction mapping theorem: for any                            = ( 1; : : : ;     10 ;   )0 , we can ...nd a
unique
                                      = ( ) such that K ( ; ) = 0.                                                            (108)

Given this function of     , we consider the set of its values:
                                       n                              Q11                   o
                                V :=       ( ) 2 R11              2       v =1 [lv ; uv ]       :

Next, we compute the Jacobian matrix        of K with respect to                   = ( 1; : : : ;   10 ;    )0 :
                               0                                      R                                        1
                                 1                            0           F" (w0 c +             1
                                                                                            1 )dFW (w )
                               B .          ..                .                     .    C
                               B .               .            .                     .    C
                               B .                            .                     .    C
                               B .                            .                     .    C
             (@=@ )K ( ; ) = B
                   0
                               B ..
                                                     ..
                                                          .   .
                                                              .                     .
                                                                                    .
                                                                                         C;
                                                                                         C
                               B                                R                        C
                               B 0                            1   F" (w c + 10 )dFW (w)0 C
                                                                       0          10
                               @                                                         A
                                                                R      0          11
                                 1           0                0   F" (w c + 11 )dFW (w)0

where the upper-left 10-by-10 submatrix is the identity matrix. This matrix (@=@ 0 )K ( ; ) has
dominant diagonals for any ( ; ) in the sense of Gale and Nikaido (1965, p. 84), that is, letting
    R                v (w ), whose dependence on c and
lv = F" (w0 c + v )dFW                                   v is suppressed for notational simplicity,
                                                                                                                                 11
(@=@ 0 )K ( ; ) is said to have dominant diagonals if we can ...nd strictly positive numbers dv                                  v =1
such that
                             dv > lv d11 for v = 1; : : : ; 10 and l11 d11 > d1 :                                             (109)

If we set dv = 1 for d = 2; : : : ; ; 11, then (109) is reduced to

                              1 > lv for v = 2; : : : ; 10 and l11 > d1 > l1 ;

and it is possible to ...nd some d1 2 (0; 1) since
                   Z                                Z
             l11 = F" (w c + 11 )dFW (w) = F" (w0 c + 1 + 11
                             0           11                           ?
                                                                        ( 1 ))dFW11
                                                                                    (w)
                   Z                                        Z
                 > F" (w0 c + 1 + 1       ?
                                            ( 1 ))dFW1
                                                       (w) = F" (w0 c + 1 )dFW 1
                                                                                 (w) = l1 ;

which is imposed in (99) of Assumption 7. Since (@=@ 0 )K ( ; ) has dominant diagonals for each
( ; ), it is a P -matrix for each ( ; ) in the sense of Gale and Nikaido (1965, p.84). Applying
Gale and Nikaido's Theorem 4, we can see that for each (...xed) 2 V , K ( ; ) is univalent as a
               Q11                                                       Q
function of 2 v=1 [lv ; uv ] , i.e., K ( ; ) = 0 holds only at a unique 2 11
                                                                           v =1 [lv ; uv ]. Therefore,
we can de...ne a function( ) on V , i.e., the inverse function of ( ) introduced in (108). That
is, we have shown that ( ) is one-to-one (injective; ( ) 6= ( ~ ) for =
                                                                      6 ~ ), implying the desired
result (107). We have now completed Case 5) and thus the whole proof.




                                                          A20
Proof of Lemma 2. Given the de...nition of A1
                                            vh in (94), observe that


               LFPL ( 1 )         LFPL ( 1 )
                   v
                                 "                                                                 (                                                    )
                   X                                                                                        0 c+
                                                                                                       F" Wvh                v+               ?
                                                                                                                                              v ( 1)
                                      0                                        ?
               =          rv E    F" Wvh c             +         v   +         v( 1)       log             0 c +                               ?
                   v =1
                                                                                                       F" Wvh                v +               v( 1)
                                                                                               (                                                          )#
                                                                                                          0 c+
                                                                                                   1 F" Wvh                       +            ?
                               0                                      ?                                                          v             v ( 1)
               + 1         F" Wvh c +              v    +             v( 1)         log                  0 c +                                  ?
                                                                                                   1 F" Wvh                      v +            v( 1)
                   v
                   X
                                       0                                           ?                             0                                     ?
                          rv log E F" Wvh c+                          v   +        v ( 1)          + 1       F" Wvh c +                   v   +        v( 1)
                   v =1
                   X v
               =          rv log E [1] = 0;                                                                                                                                 (110)
                   v =1

where the ...rst equality follows from the law of iterated expectations and the correct speci...cation
assumption and the inequality holds by Jensen's inequality. By the strict concavity of log, this
                                                  0 c +
inequality holds with equality if and only if F" Wvh                                                         +           ?                  0 c+                           ?
                                                                                                         v               v( 1)       = F" (Wvh                 v   +       v ( 1 )),
which is equivalent to                1   =   1   by (b) of Lemma 1. That is, we have shown that                                                          1    is the unique
maximizer of       LFPL (        1)   over        1.

      To establish the same result for LBR ( 1 ), note that                                                  ?
                                                                                                             v( 1)        is the ...xed point, and thus the
condition (93) (that determines                         1)   implies
                                                         Z
                             v   =E       [A1
                                            vh ]   =                 F" (w0 c +            v   +       ?         v
                                                                                                       v ( 1 ))dFW (w )          =        ?
                                                                                                                                          v ( 1 ):


Therefore,
                                     0                                                   0                                       ?
                                 F" Wvh c +                  v   +             v   = F" Wvh c +                  v   +           v( 1)         ;

meaning that the conditional choice probability model with                                                           (instead of               ?
                                                                                                                 v                             v ( 1 ))   is also correctly
speci...ed at      1   =    1.    By the same arguments as in (110), we can see that                                                               1   is also the unique
maximizer of LBR ( 1 ) over                   1.       The proof is completed.

Proof of Lemma 3. By boundedness of the support of Wvh and boundedness of the parameter
space              0 c+                       ?
          1,   F" Wvh                 v   +   v ( 1)             is bounded away from 0 and 1 uniformly over                                                  1,   v , and (any
realization of) Wvh , i.e., we can ...nd some (small) constant                                                   2 (0; 1=2) (independent of                            1   and v )
such that
                                                            0                                       ?
                                                        F" Wvh c+                      v   +        v ( 1)           1       :                                              (111)

      Thus, given the globally Lipschitz continuity of log ( ) on [ ; 1                                                                   ], and that of F" ( ) and
 ?
 v(   ) (see the global Lipschitz continuity result (120) in the proof of Lemma 5), as well as the
uniform boundedness of f" ( ), we can see that E A1          0
                                                  vh log F" Wvh c +                                                                   v   +        ?
                                                                                                                                                   v ( 1)          and E [(1
A1
 vh ) log   1          0 c
                   F" Wvh       + v+ v    ?( )
                                              1                           ] are also globally Lipshitz continuous in                                      1,   implying the
global Lipschitz          continuity of LFPL ( 1)                         in       2
                                                                               1           1.




                                                                                       A21
                            ^ FPL ( 1 ) by
                   ? ( ) in L
   Now, replacing ^v                                        ?
                       1                                    v ( 1 ),   we de...ne the following function:
                                     v Nv
                    ~ FPL          1 XX               0                                                   ?
                    L     ( 1 ) :=        Avh log F" Wvh c+                              v   +            v ( 1)
                                   N
                                             v =1 h=1
                                                                           0                         ?
                              + (1            Avh ) log 1              F" Wvh c+     v   +           v ( 1)           :

                                  ? ( ) to
Given the uniform convergence of ^v                             ?
                                      1                         v ( 1)   (Lemma 5), by arguments analogous to those
for the global Lipschitz continuity of         LFPL (        1 ),   we can easily see that

                                       ^ FPL ( 1 )
                                   sup L                            ~ FPL ( 1 ) = op (1) :
                                                                    L                                                             (112)
                                   12    1


Again, given the global Lipschitz continuity of relevant functions as discussed above, we can also
check the stochastic equicontinuity (SE) of L ~ FPL ( 1 ) (by using Corollary 2.2 of Newey, 1991) as
                                               h            i
well as the (global Lipschitz) continuity of E L ~ FPL ( 1 ) .

   Since    1 is assumed to be compact and we have veri...ed the (global Lipschitz) continuity of
                         ~ FPL ( 1 ), Theorem 2.1 of Newey (1991) implies the uniform convergence:
LFPL ( 1 ) and the SE of L
                                                  h            i
                             sup L   ~ FPL ( 1 ) E L~ FPL ( 1 ) = op (1) ;
                              12     1


if the pointwise convergence holds
                                          h            i
                       ~ FPL ( 1 )
                       L                 E L~ FPL ( 1 ) = op (1) for each                            1   2     1,                 (113)

which is to be shown below. And, analogously to the proof of Lemma 7 below, we can obtain

                                                             ?                        ?
                     max             sup                j    v (Lvh ; e; 1 ; 2 )      v ( 1 )j           = op (1) ;
                    1 h Nv e2R;    12    1;    22   2


as its simpler corollary. Then, using this result and arguments quite analogous to the proof of
Lemma 4 below, we also have
                                   h            i
                              sup E L~ FPL ( 1 )                       LFPL ( 1 ) = op (1) ;
                              12     1


implying that
                                       ~ FPL ( 1 )
                                   sup L                            LFPL ( 1 ) = op (1) :                                         (114)
                                   12    1

Then, by (112) and (114), we can obtain the desired conclusion of the lemma. It remains to show
the pointwise convergence (113), note that each summand of L  ~ FPL ( 1 ) is a function of 1 , Wvh ,
and uvh (since uvh = (u0           1        0                       1
                       v (Lvh )); uv (Lvh )) and "vh = "v (Lvh ) = uv (Lvh )                                   u0
                                                                                                                v (Lvh )). Thus, letting


                  G 1 (Wvh ; uvh ) = Gv1 (Wvh ; uvh )
                                                   0                                 ?
                                     = Avh log F" Wvh c+                     v   +   v ( 1)
                                                                              0                              ?
                                     + (1        Avh ) log 1              F" Wvh c+          v   +           v ( 1)       ;



                                                                 A22
which is uniformly bounded since (111) holds, we can apply Lemma 6 to obtain
                                                   v
                                                   X                            Nv
                                 ~ FPL ( 1 ) =                 Nv            1 X
                                 L                                                 Gv1 (Wvh ; uvh )
                                                               N             Nv
                                                   v =1                         h=1
                          v
                          X
                      p
                     !           rv E Gv1 (Wvh ; uvh ) = LFPL ( 1 ) for each                                 1   2       1,
                          v =1

where rv 2 (0; 1) is the limit of Nv =N . This completes the proof.

Proof of Lemma 4. Let

                     ^N := max
                     k                                sup                     ^? Lvh ; e
                                                                                       ~;       ^
                                                                                             1; 2
                                                                                                              ?
                                                                                                             ^v ( 1) ;
                       v                                                       v
                                 1 h Nv e
                                        ~2R;       12     1;       22    2


                                                                    ^ (Wvh ; Lvh ;
which is shown to be op (1) in Lemma 7. Then, by the de...nition of C                                                         1; 2)    in (30), we
have
                      Z     n                                                                    o
                              0
                           1 Wvh c+               +       ?                      ^N + e
                                              v           v ( 1)              j jk v            0 dH (e)

                           ^ (Wvh ; Lvh ; 1 ; 2 )
                           C
                           Z n                                                                       o
                              1 Wvh 0
                                      c+ v +                       ?               ^N + e
                                                                   v ( 1)     + j jk v              0 dH (e)

Recall also the de...nition of H (e) = 1                  F" ( e) (F" is the CDF of                              "), these lower and upper
bounds can be computed as

                                          0
                                      F" Wvh c+                    +         ?           ^N :
                                                               v             v ( 1)   j jk v


                                                                  0 c+
Since F" is Lipschitz continuous, both the bounds converge to F" Wvh                                                     +    ?
                                                                                                                     v        v ( 1)    in proba-
bility. Further, the absolute di¤erence of the lower and upper bounds is bounded by supz 2R f" (z )
2j jk ^N , implying the uniform convergence of C  ^ (Wvh ; Lvh ; 1 ; 2 ) as in (103).
        v




A.4.4       Auxiliary Lemmas and their Proofs

Lemma 5 Suppose that C2, (i) of Assumption 6, (ii) - (iii) of Assumption 7, and (i) of Assump-
tion 8 hold. Then,
                                                  ?                            ?
                                       sup sup j ^v ( 1)                       v ( 1 )j   = op (1) :                                         (115)
                                      1 v v   12      1


                                                                 ? ( ):
Proof of Lemma 5. We below show 1) the pointwise convergence of ^v   1

                                    ?             ?
                                 j ^v ( 1)        v ( 1 )j         = op (1) for each           1   2        1;                               (116)

and 2) the continuity of the limit function                ?(            and the stochastic equicontinuity of ^ ? ( 1 ). Then,
                                                                    1)

given the compactness of             (by (ii) of Assumption 7), we have sup                                         ?( )
                                                                                                                 j ^v           ?
                                 1                                                                     12    1         1        v ( 1 )j   = op (1)



                                                                        A23
(for each v ) by Theorem 2.1 of Newey (1991), which implies the desired result (115) since v is taken
over a ...nite set f1; : : : ; v g. We below show 1) and 2).
                                                      ?( )
1) To show the pointwise convergence, we compute E j ^v                                                  ?        2
                                                         1                                               v ( 1) j     . To this end, de...ne a
functional mapping g (2 (0; 1)) 7!                    TV(g ) (2 (0; 1)) for each (v; 1 ):
                                                         1
                                                          Z
                                              T v1 (g ) = F" (w0 c + v + g )dFW      v
                                                                                       (w);

Analogously, we de...ne the following mapping:
                                        Z
                               ^v (g ) = F" (w0 c +
                               T                                                   v
                                                                                             ^W
                                                                                       + g )dF v
                                                                                                 (w);
                                 1


                                                                ^ v . Since T v and T
                      v in T v is replaced by the empirical one F
where the (true) CDF FW                                                             ^v are
                              1                                  W
contraction (by (iii) of Assumption 7; see also discussions in Appendix A.3), we can ...nd v       ?( )
                                                                                                       1
      ?                                v      ^ , respectively, for each ( 1 ; v ). By the I.I.D.-ness of
and ^v ( 1 ), unique ...xed points of T 1 and T v
                                                 1

fWvh gNv
      h=1 in C2,

                ^v (g )
            E [jT             T v1 (g ) j2 ]
                  1


                   1 X
                      Nv   h                                                                                                  i   4
                                  0                                                      0                                2
             =      2
                         E   F" (Wvh c+                  v + g ( 1 ))             E F" (Wvh c+           v + g ( 1 ))                ;
                  Nv                                                                                                              Nv
                     h=1
                                                              0 c+ + g ( )) E F (W 0 c +
where the last inequality holds since F" is the CDF and jF" (Wvh                                                                             + g ( 1 )) j2
                                                                  v      1     "  vh                                                     v

  4. Therefore, we have shown that

                                             ^v (g )
                                     sup E [jT                         T v1 (g ) j2 ] = O (1=Nv ) = o (1) ;                              (117)
                                               1
                                      g

where the supremum is taken over any [0; 1]-valued function on                                          1.

   Noting that ^ ? ( 1 ) and              ?(
                                                    1)
                                              are ...xed points, by the triangle inequality, we have
                                              h                           i
   E [j ^ ? ( 1 )     ?
                          ( 1 ) j]    E jT^v (^ ? ( 1 )) T v (^ ? ( 1 )) j + E jT v (^ ? ( 1 )) T v ( ? ( 1 )) j
                                            1               1                      1               1
                                            h                    i
                                      sup E jT^v (g ) T v (g ) j + E [j ^ ? ( 1 )    ?
                                                                                       ( 1 ) j] ;
                                                1         1
                                          g

which, together with (117), implies that
                                                                        1        h                               i
                            ?
                      E [j ^v ( 1)                ?
                                                  v ( 1 ) j]   =                   ^v (g )
                                                                            sup E jT                  T v1 (g ) j = o (1) :
                                                                                     1
                                                                   1          g

This implies the desired pointwise convergence (116).

2) To verify the continuity of                    ?
                                                  v ( 1 ),     observe that for         1   6= ~1 ,
            ?          ?     ~1
            v ( 1)     v
             Z                                               Z
        =         F" (w0 c +      v +   ?
                                          ( 1 )) dFW
                                                    v
                                                      ( w )           ~ + ev + ~ ? ~1 )dFW
                                                               F" (w0 c                  v
                                                                                           (w)
                                  Z
            sup f" (z )             kwk dFW v
                                               (w) kc c     ~k + j v ev j +     ?
                                                                                v ( 1)
                                                                                         ? ~
                                                                                       ~ v   1                                    :      (118)
              z




                                                                            A24
Using the triangle inequality, we have the following upper bound of the last term in the curly braces:

                     ?                   ?       ~1               ?                 ?      ~1               ?    ~1                 ?   ~1
                     v ( 1)         ~    v                        v ( 1)            v                +      v               ~       v

                                                            j j     ?               ?      ~1
                                                                    v ( 1)          v                +j         ~j :                                 (119)

By combining (118) and (119), we obtain

         ?           ?    ~1
         v ( 1)      v
                                             Z
          sup f" (z )          kc       ~k              v
                                                  kwk dFW (w) + j                    e j+j j              ?             ?       ~1
                                        c                                       v     v                   v ( 1)        v               +j      ~j :
               z

Since we can ...nd some                  2 ( 1; 1) such that supz f" (z ) j j                                   for any             2 [lv ; uv ] (by (ii) of
Assumption 7), this inequality leads to
                                                                                         Z
         ?           ?    ~1                 1                                                        v                             e j+j
         v ( 1)      v                                sup f" (z )          kc       ~k
                                                                                    c           kwk dFW (w) + j             v        v          ~j
                                         1             z

                                         C?       1
                                                           ~1 ;                                                                                      (120)

where C ? 2 (0; 1) is some positive constant, whose existence follows from (i) of Assumption 8. That
is, we have shown that              ?(
                                          1)     is (globally Lipschitz) continuous in                            1.   We can also show that

                                                   ?               ? ~               ^?                  ~1 ;
                                                  ^v ( 1)         ^v  1              C           1                                                   (121)

where C^ ? is some Op (1) random variable independent of 1 ; ~1 ; note that (121) can be derived in
                            R                         R
the same way as (120) with kwk dFW  v (w ) replaced by kw k dF^ v (w)(= Op (1)). This (121) implies
                                                               W
the stochastic equicontinuity of ^ ? ( ) by Corollary 2.2 of Newey (1991). The proof of Lemma 5 is
completed.

Lemma 6 Suppose that C1, C2, C3-SD, and Assumption 4 hold. Then, let G be a function of
 1 (2   1 ),   Wvh , and uvh that is uniformly bounded (and measurable) with

                                                            jG 1 (Wvh ; uvh )j               G,

where G is some positive constant (independent of                                   1 ).   Then, for each v ,
                      Nv
                   1 X                                                                               p
                         fG 1 (Wvh ; uvh )                    E [G 1 (Wvh ; uvh )]g ! 0 for each                                1   2   1.
                   Nv
                         h=1



Proof of Lemma 6. Recall that uvh = uv (Lvh ). Since fuv ( )g is alpha-mixing, we apply
Billingsley'
           s inequality (Corollary 1.1 of Bosq, 1998) to

                         jCov [G 1 (Wvh ; uvh ); G 1 (Wvk ; uvk )j (Wvh ; Lvh ) ; (Wvk ; Lvk )]j
                               4G2               (kLvh       Lvk k1 =2; 1) :                                                                         (122)



                                                                           A25
By the so-called conditional-covariance decomposition formula, we have

  Cov [G 1 (Wvh ; uvh ); G 1 (Wvk ; uvk )]
   = E [Cov [G 1 (Wvh ; uvh ); G 1 (Wvk ; uvk )j (Wvh ; Lvh ) ; (Wvk ; Lvk )]]
   + Cov [E [G 1 (Wvh ; uvh )j (Wvh ; Lvh ) ; (Wvh ; Lvk )] ; E [G 1 (Wvk ; uvk )j (Wvh ; Lvh ) ; (Wvk ; Lvk )]] :
                                                                                                                                 (123)

The second term on the RHS of (123) is zero since (Wvh ; Lvh ) ? (Wvk ; Lvk ) and the conditional
expectations are reduced to

     E [G 1 (Wvh ; uv (Lvh ))j (Wvh ; Lvh ) ; (Wvk ; Lvk )] = E [G 1 (Wvh ; uv (Lvh ))j (Wvh ; Lvh )] and
     E [G 1 (Wvk ; uv (Lvk ))j (Wvh ; Lvh ) ; (Wvk ; Lvk )] = E [G 1 (Wvk ; uv (Lvk ))j (Wvk ; Lvk )] ;

which follow from the conditional independence relation as in (85) (in the proof of Theorem 5).
Thus, by the covariance bound given in (122), we have

           Cov G 1 (Wvh ; uvh ); Gv1 (Wvk ; uvk )                      4G2 E [ (kLvh             Lvk k1 =2; 1)]
                                                                            Z Z
                                                                     = 4G 2
                                                                                 (jjl            ~
                                                                                                 ljj1 =2; 1)dFL (l) dFL (~
                                                                                                                         l)
                                                                                1 =2
                                                                     = O(   N          );

uniformly over any (v; h) and (v; k ), where the last equality follows from the same arguments as
for (90) (in the proof of Theorem 5). Using these, we can compute
            "                                                      #
               1 XN v                          v
                                                                 2
          E                G 1 (Wvh ; uvh ) E G 1 (Wvh ; uvh )
              Nv     h=1

              1 XNv       h                                        i O (1) X X
                                                                                                                          1 =2
          = 2           E fG 1 (Wvh ; uvh ) E [G 1 (Wvh ; uvh )]g2 +    2                                             N
             Nv     h=1                                               Nv
                                                                                                          1 h6=k Nv
                                  1 =2
             4G=Nv + O(       N          ) = o (1) ;

which completes the proof of Lemma 6.


Lemma 7 Suppose that Assumptions 5 and 8 hold. Then, it holds that

                       max                 sup               ^? (Lvh ; e;       1; 2)
                                                                                             ?
                                                                                            ^v ( 1 ) = op (1) :
                                                                 v
                     1 h Nv e2R;          12   1;   22   2



Proof of Lemma 7. Recall that ^v                                             ^?
                               ? is a ...xed point of the functional mapping F
                                                                               v;Nv de...ned in
          ? is a ...xed point of
(32) and ^v
                                Z Z
          ^ ?
         Fv;1 [g ] ( 1 ; 2 ) :=       ~0c +
                                    1fw                      v   + g (~
                                                                      l; e
                                                                         ~;     1; 2)       +e
                                                                                             ~    0gh(~    ^W;L
                                                                                                         ~dF
                                                                                                      e)de   v
                                                                                                                 ~ ~
                                                                                                                (w; l):



                                                                     A26
Note that this F  ^ ? is a contraction (by Proposition 3) which does not depend on 2 (the dependence
                   v;1
   ^ ?
of Fv;1 [g ] ( 1 ; 2 ) on 2 is only through that of g ), and its ...xed point is also independent of 2 ;
                ? ( ) (instead of ^ ? ( ;
thus, we write ^v   1              v    1                    2 )).   By the triangle inequality,

                       ^? (Lvh ; e; 1 ; 2 ) ^ ? ( 1 )
                        v                      v
                                 h i                            h i
                          ^v;N
                          F ?      ^? (Lvh ; e; 1 ; 2 ) F ^ ?     ^? ( 1 ; 2 )
                              v     v                       v;1    v
                               h i
                      + F ^?      ^? (Lvh ; e; 1 ; 2 ) F ^ ? [^ ? ] ( 1 ; 2 )
                           v;1     v                      v;1 v
                                                   h i                             h i
                                sup         F^?       ^? (Lvh ; e; 1 ; 2 ) F  ^?    ^? ( 1 ;              2)
                                              v;Nv     v                       v;1   v
                            e2R;   12   1;   22    2


                      +       ^? (Lvh ; e;        1; 2)
                                                             ?
                                                            ^v ( 1) ;
                               v


where the last inequality holds with some                            2 (0; 1) (by Proposition 3) that is independent of
( 1;   2)   and any realization of random variables. Thus,
                 h                                  i
               E ^v  ?
                       (Lvh ; e; 1 ; 2 ) ^v ?
                                               ( 1)
                                 "                                                                                      #
                     1                                ^ ? [g ] (Lvh ; e;                       ^ ? [g ] ( 1 ;
                         sup E            sup         F v;Nv                           1; 2)   F v;1             2)         ;
                   1      g        e2R; 1 2 1 ; 2 2 2

where the (outer) supremum is taken over any [0; 1]-valued functions. We now show this majorant
side is op (1). To this end, observe that

            ^ ? [g ] (l; e; 1 ; 2 ) F
            F                        ^ ? [g ]
              v;Nv                    v;1
              Z Z
                    1fw~ 0 c + v + g (~   ~; 1 ; 2 ) + e
                                       l; e            ~ 0g h(~eje; j~
                                                                     l lj1 ; 2 ) h(~   ~dF
                                                                                   e) de ^ v (w; ~
                                                                                          W;L ~ l)
                   Z Z                                       Z
              M1        j~l lj1 1 h(~
                                    e)de~dF ^W;L
                                             v
                                                 (w;  l) = M1 j~
                                                    ~ ~         l lj1 1 dF  v ~
                                                                           ^L (l);

where the second inequality follows from Assumption 8, and this upper bound is independent of g ,
                     ^ v is the empirical distribution function of the I.I.D. variables fLvk gNv , we
e, 1 , and 2 . Since FL                                                                       k=1
have                      Z                                                 Z Z
                                                                     Nv 1
                       E [ j~
                            l                     ^L
                                        Lvh j1 1 dF v ~
                                                     (l)] =                       j~
                                                                                   l           v ~
                                                                                       lj1 1 dFL      v
                                                                                                 (l)dFL (l):
                                                                      Nv
By the same arguments as those for (90) (in the proof of Theorem 5), we have
                            Z Z
                                                               =2
                                  j~
                                   l lj1 1 dFLv ~
                                               (l)dFL (l) = N 1 :

Therefore,

                                                           ^? (Lvh ; e;            ?                            1 =2
                 E [ max                 sup                v             1; 2)   ^v ( 1 ) ] = O(Nv        N           );
                    1 h Nv e2R;         12   1;   22   2

                                                      p
which is o (1) for      1   > 4 since        N    = O( N ). This completes the proof of Lemma 7.




                                                                      A27
A.5     Welfare Analysis: The case of                                                       1   <         0

Eligibles: Recall eq. (40)
                                                                                                             1                                                                                  0
                  max            1   +     1 (y        +a           p1 ) +                 1 1      +            ;       0   +       0 (y         + a) +                   0 1          +
                                                                                                         1                                                                 0
                     max              1   +        1 (y        p0 ) +               1 0         +            ;       0   +       0y      +            0 0     +                     .

   Now, if
                                                                                       1                                                 0
                                 a < min p1                         p0                     (    1                0)      < 0;                 (       0               1)        ,
                                                                                       1                                                 0
then each term on the LHS is smaller than the corresponding term on the RHS. If, on the other
hand,
                                                               0                                                                     1
                                     a         max                  (       0              1 ) ; p1              p0                      (       1            0)           ,
                                                               0                                                                     1
then each term on the LHS is larger than the corresponding term on the RHS. This gives us
                        8                  n                                      o
                        < 0, if a < min p1 p0           1
                                                          (   1  0 ) ; 0
                                                                          (  0 1 )  ,
            Pr (S a) =                     n           1               0           o
                        : 1, if a max 0 ( 0            1 ) ; p1 p0      1
                                                                           ( 1  0) .
                                              0                         1

In the intermediate case,
                                               0                                                             1
                             min                   (   0            1 ) ; p1               p0                        (   1               0)
                                               0                                                             1
                                                                                           1                                                  0
                                     a < max p1                         p0                      (    1               0)      < 0;                    (    0                1)           ,
                                                                                           1                                                  0

we have that if p1           p0           1
                                          1
                                              (    1           0)   <           0
                                                                                0
                                                                                    (      0             1 ),     then
                                                                                                                                                                      !
                                                                             +                                                                                1
                                                                        1              1 (y         +a               p1 ) +              1 1         +
                         Pr (S            a) = Pr
                                                                                                +                                                 0
                                                                                           0             0y      +           0 0         +
                                                                                                                                                                                        !
                                                                                    +                                                                                  1
                                                                                1               1 (y     +a                  p1 ) +                  1 1      +
                                                   = Pr
                                                                                    +                                                                                           0
                                                                                0              0y   +            0 1         +       0( 0                     1)      +
                                                                                                                             1
                                                   = q1 p1                      a; y;           1   +                            (   0                1)          ,

and if p1    p0      1
                     1
                         (   1            0)
                                                       0
                                                       0
                                                           (   0                1 ),    then
                                                                                                                                                          !
                                                                            +                                                                    0
                                                                     0              0 (y        + a) +                       0 1     +
                   Pr (S                 a) = Pr
                                                                             +                                                                       1
                                                                         1              1 (y             p0 ) +                  1 0     +
                                                                                                                                                                                            !
                                                                                           +                                                                  0
                                                                                    0               0 (y         + a) +                  0 1         +
                                              = Pr
                                                                             +                                                                                                  1
                                                                         1              1 (y        +a               (p0 + a)) +                           1 0         +
                                                                                                                                                                                            !
                                                                     +                                                                                                                  0
                                                                0                0 (y       + a) +                   0 0         +        0( 1                        0)   +
                                              = Pr
                                                                                +                                                                                                   1
                                                                            1              1 (y     +a                   (p0 + a)) +                          1 0          +
                                                                                                                                 1
                                              = q0 p0 + a; y + a;                                   0    +                           (       1             0)          .

Putting all of this together, we have that



                                                                                                A28
Proposition 4 Suppose that Assumptions 1, 2 and the linear index structure hold and                                                                                                                                                     1         0.

Then, for each         1   2 [0; ], if p1                               p0                  1
                                                                                            1
                                                                                                (    1           0)    <               0
                                                                                                                                       0
                                                                                                                                               (       0                1 ),     then

  Pr S Elig a
    8
    >
    < 0,                                                                                  if a < p1 p0                                                              (                  0) ,
                                                                                                                                                                1
    >                                                                                            h                                                              1
                                                                                                                                                                            1

  =    q1 p1 a; y;                  1       +               1
                                                                (   0               1 ) , if a 2 p1  p0                                                             1
                                                                                                                                                                        (    1             0) ;
                                                                                                                                                                                                       0
                                                                                                                                                                                                           (    0          1)       ,        (124)
    >
    >
                                                                                                                                                                    1                                  0
    :
       1,                                                                                              if a                0
                                                                                                                           0
                                                                                                                               (           0                   1) ;

and if p1   p0             1
                           1
                               (    1               0)      >       0
                                                                    0
                                                                        (       0               1 ),     then

  Pr S Elig a
    8
    >
    < 0,                                                                                                         if a <                            (                        1) ,
                                                                                                                                               0
    >                                                                                                                                  h0                  0

  =    q0 p0 + a; y + a;                            0   +               1
                                                                            (       1               0)      , if a 2                           0
                                                                                                                                                       (       0             1 ) ; p1              p0              1
                                                                                                                                                                                                                       (   1            0)   ,
    >
    >
                                                                                                                                               0                                                                   1
    :
       1,                                                                                                        if a                  p1                  p0                1
                                                                                                                                                                             1
                                                                                                                                                                                 (     1           0) .

                                                                                                                                                                                                                                             (125)



   Ineligibles: Recall eq. (39)

                                                                                                                           1                                                                                    0
                   max                  1   +           1 (y    +a                  p0 ) +               1 1     +             ;       0   +               0 (y         + a) +                 0 1      +
                                                                                                                       1                                                                       0
                           max                  1   +       1 (y                p0 ) +              1 0      +             ;       0   +               0y      +            0 0      +             .
                   n                                                                           o
Now if a < min             1
                           1
                               (       0            1) ;
                                                                0
                                                                0
                                                                    (       0               1 )  =             0
                                                                                                               0
                                                                                                                   (       0                   1 ),        then each term on the LHS is smaller
than the corresponding term on the RHS for each realization of the s. So the probability is 0.
Similarly, for a               1
                               1
                                   (        0            1 ),   the probability is 1. Finally, for                                                                           0
                                                                                                                                                                             0
                                                                                                                                                                                 (     1           0)              a<          1
                                                                                                                                                                                                                               1
                                                                                                                                                                                                                                    (   0        1 ),

the above inequality is equivalent to

                       +                                                                    0                                                                                              1
                   0               0 (y         + a) +              0 1         +                        1   +     1 (y                    p0 ) +                       1 0      +
            ,          +                                                                                                               0                                                                                       1.
                   0               0 (y         + a) +              0 0         +           0( 1                 0)    +                                   1   +         1 (y              p0 ) +              1 0     +

Thus we have that:

Proposition 5 Suppose that Assumptions 1, 2 and the linear index structure hold and                                                                                                                                                     1         0.

Then, for each         1   2 [0; ],

    Pr S Inelig a
      8
      >
      < 0,                                                                                                         if a <                                       (                    0) ,
                                                                                                                                                           1
      >                                                                                                                                                0
                                                                                                                                                                        1
    =    q0 p0 + a; y + a;                              0   +               1
                                                                                (       1              0)    , if                          1
                                                                                                                                                   (       1             0)            a<           1
                                                                                                                                                                                                           (   0           1) ,              (126)
      >
      >                                                                                                                                0                                                            1
      : 1,                                                                                                         if a                                (                        1) .
                                                                                                                                                   1
                                                                                                                                                   1
                                                                                                                                                                0




                                                                                                             A29
A.6    Income Endogeneity

(Summarized from Bhattacharya, 2018, Sec 3.1): Observed income may be endogenous with
respect to individual choice, e.g. when omitted variables, such as unrecorded education level, can
both determine individual choice and be correlated with income. Under such endogeneity, the
observed choice probabilities would potentially di¤er from the structural choice probabilities, and
one can de...ne welfare distributions either unconditionally, or conditionally on income, analogous
to the average treatment e¤ect and the average e¤ect of treatment on the treated, respectively, in
the program evaluation literature. In this context, an important and useful insight, not previously
noted, is that for a price-rise, the distribution of the income-conditioned EV is not a¤ected by
income endogeneity; for a fall in price, the conclusion holds with CV instead of EV.
   To see why that is the case, recall the binary choice setting discussed above, and de...ne the
conditional-on-income structural choice probability at income y 0 as
                                  Z
                     c
                    q1 p; y ; y = 1 U1 y 0 p1 ;
                           0
                                                         U0 y 0 ;    dF ( jy ) ,

where F ( jy ) denotes the distribution of the unobserved heterogeneity                  for individuals whose
realized income is y , where y may or may not equal           y0.   Now, given a price rise from p0 to p1 , for
a real number a, satisfying 0         a < p1     p0 , the distribution of equivalent variation (analogous to
compensating variation for a fall in price as in a subsidy) at a, evaluated at income y , conditional
on realized income being y , is given by (see Bhattacharya, 2015)

                                                             c
                                    Pr (EV      ajY = y ) = q1 (p0 + a; y; y ) ,                         (127)

      c (p + a; y; y ), by de...nition, is the fraction of individuals currently at income Y = y who
Now, q1   0

would choose alternative 1 at price p0 + a, had their income been y . Now if prices are exogenous in
the sense that P ? jY , then the observable choice probability conditional on price p and income
y is given by
                               Z
                q1 (p; y ) =       1 fU1 (y    p; )    U0 (y; )g f ( jp; y ) d
                               Z
                         =         1 fU1 (y    p; )    U0 (y; )g f ( jy ) d        (by P ? jY )
                            c
                         = q1 (p; y; y ) .

Therefore, (127) equals q1 (p0 + a; y ), so no corrections are required owing to endogeneity. This
implies that if exogeneity of income is suspect and no obvious instrument or control function is
available, then a researcher can still perform meaningful welfare analysis based on the EV distri-
bution at realized income, provided price is exogenous conditional on income and other observed
covariates. For a fall in price, as induced by a subsidy, the same conclusion holds for the com-
pensating variation which we have calculated in our application. Furthermore, one can calculate



                                                       A30
                                                                c (p; y; y ) over the marginal distribu-
aggregate welfare in the population by integrating q1 (p;y ) = q1
tion of income.


A.7    Nonparticipating Households

We note that in our ...eld experiment conducted over eleven villages in West Kenya, a subset of
households in each village is participating in the game, and our sample does not cover all village
members. This might potentially cause a problem since selected households might interact with
non-selected ones but we do not have any data about the latter. However, at the time of the
experiment, non-selected households did not have any opportunity to buy an ITN and the outcome
variables A for such households are always zero, whose conditional expectations are zero as well.
Thus, in our speci...cation, even if we allow for interactions among all the village members (who are
selected or non-selected by us), it is easy to do the necessary adjustments in the empirics.
   To see this point, we interpret the index (v; k ) as representing any of selected and non-selected
households, i.e., k 2 f1; : : : ; Nv g where Nv is the number of all households in village v (thus,
Nv > Nv ), and de...ne Avk as a variable to denote the outcome of any village members, i.e., if (v; k )
is selected in the experiment, Avk = Avk and otherwise = 0. Corresponding to Avk , let                            vh   be
(v; h)'
      s belief de...ned as
                                                       X
                                                  1
                                       vh   =   Nv 1
                                                                           E [Avk jIvh ];
                                                           1 k Nv ; k6=h

which is the average of the conditional expectations over all the households in village v . By the
de...nition of Avk , we can easily see that
                                                 X
                                Nv    1
                       vh    = (N       ) 1
                                      1 Nv 1
                                                                       E [Avk jIvh ] = ( N
                                                                                         N
                                                                                          v     1
                                                                                                1
                                                                                                  )   vh ;        (128)
                                 v                     1 k Nv ; k6=h                        v


which is a scaled version of         vh .   Even if (v; h)'
                                                          s behavior is a¤ected by non-selected households,
i.e., it is determined by (1) but with            vh   being replaced by          vh ,   its di¤erence from the previous
case is only the scaling by     (Nv 1
                                 Nv 1
                                      ).        In our empirical setting, this ratio is 0:8, and we apply this
adjustment throughout the analysis.



References for the Appendix

 Gale, D. & Nikaido, H. (1965) The Jacobian matrix and global univalence of mappings, Mathe-
      matische Annalen 159, 81-93.

 Holden, L. (2000) Convergence of Markov chains in the relative supremum norm. Journal of
      Applied Probability 37, 1074-1083.

 Jenish, N. & Prucha, I.R. (2012) On spatial processes and asymptotic inference under near-epoch
      dependence. Journal of Econometrics 170, 178-190.



                                                             A31
Lee, L.-F. (2004) Asymptotic distributions of quasi-maximum likelihood estimators for spatial
    autoregressive models, Econometrica 72, 1899-1925.

Newey, W.K. (1991) Uniform convergence in probability and stochastic equicontinuity, Economet-
    rica 59, 1161-1167.

Newey, W.K. & McFadden, D. (1994) Large sample estimation and hypothesis testing, Handbook
    of Econometrics, Vol. IV (Ed. R.F. Engle and D.L. McFadden), Ch. 36, pages 2111-2245,
    Elsevier.

Stokey, N.L. & Lucas, Robert E. Jr. (1989) Recursive Methods in Economic Dynamics, Harvard
    University Press.

Varin, C., Reid, N., & Firth, D. (2011) An overview of composite likelihood methods, Statistica
    Sinica 21, 5-42.




                                             A32
