                   NEER WORKING PAPER SERIES




           ON A GENERAL COMPUTER AIJOR[THN FOR ThE
       ANALYSIS OF MODELS WITh EftflTED DEPDENT VAlUABLES

                       Forrest D. Nelson




                     Working Paper No. 68




COMPUTER RESEARCH CENTER FOR ECONOt'tLCS AND MANAGENENT SCIENCE
           National Bureau of Economic Research, Inc.
                     575 Techrio1o>i Square
                Cambridge, Massachusetts 02139



                         October l97




                 Preliminary: not for quotation

NBER working papers are distributed informally and in limited
numbers for corrments only. They should not be quoted without
written permission.
This   report has not undergone the review accorded official NBER
publications; in particular, it has not yet been submitted for
approval by the Board of Directors.
*NEER Computer Research Center. Research supported in part by
 National Science Foundation Grant GJ-115X3 to the National
Bureau of Economic Research, Inc.
                                    Abstract

Several   econometric models for the analysis of relationships with limited
dependent variables have been prosed including       the   probit, Tobit, two-
limit probit, ordered discrete, and friction models. Widespread application
of these methods has been hampered by the lack of suitable computer programs.
This paper provides a concise survey of the various models; suggests a
general   functional model under which they may be   formulated and   analyzed;
reviews  the analytic problems and the similarities and dissimilarities of
the models; and outlines the appropriate and necessary methods of analysis
including, but not limited to, estition. It is thus intended to serve as
a guide for users of the various models, for the preparation of suitable
computer programs, for the users of those programs; and, more specifically,
for the users of the program package utilizing the functional model as
implemented on the NBER TROLL system.




                                 AcJowledgnent

The author is indebted to Professor G.S. Maddala for his generous counsel
in the preparation of this paper.
                                Contents

Introduction                                                        •    1

I.    Review of Some Limited Lpendent Variable Models .
II.   A General Functional Model                                        13

III. Features of a Computational L\lgoritbm                             19

References                                                              28




                                 Tables

Table 1. Components of Likelihood Function and Corresponding
             First arid Second [rivatives of the Log LikelThood .   .   22
Introduction

     Economic   relationships involving limited dependent variables are
receiving widespread attention in the Econometrics literature. Much
of the discussion has focused on methodoloi with only scattered
application to real problems, the one exception being the qualitative
variable problem frequently treated with       and probit analysis.
                                           logit

Since potential applications for these rrodels abound, it is likely
that the shortage of corrputer programs and their limited dissemination
is partly responsible for the infrequent emperical studies using them.
In turn, useable computer routines may be scarce because the models
though similar in many respects are dissimilar enough so as to seem
to require a separate algoritim for each model.
     The purpose of this note is to suggest a general functional model
which is readily adaptable to computer coding and flexible enough to
                                                             1
fit a wide variety of limited dependent variable problems.       It should
be emphasized that the model presented here is functional as opposed
to theoretical. That is, it is not advocated as the structural model

1. Tom Johnson [1] presents a general discussion of many
    of the models but falls of short describing in detail a central
    model around which a computer algorithm can be constructed.
                                —2—

underlying   any limited dependent variable relationship. Rather we
suggest that many of the theoretical relationships may be reformulated
to fit this functional model so that a single computer program may be
used to analyze all of them.
       The terminolo, "limited dependent variable" is used here to
denote variables endogenous to sone underlying economic relationship
which are not continuously neasureable (or observable) over the entire
real line either directly or even after soire transformation such as
logaritbns. Thus it applies to discrete (ordinal) variables, qual-
itative (non-ordinal) variables and to variables subject to threshold
constraints such as non-negativity. Such discontinuities may result
from   theoretical considerations, from physical constraints on the

variable or simply from measurenent difficulties.

       The effect of the discontinuities on estimation is that when such

a dependent variable enters the usual sort of regression model the

properties of the implied   disturbance   term cannot satisfy the assumptions

needed   for least squares estimation. The atterriative estimation nethod
generally proposed is maximum likelihood. After a suitable choice for
the distribution of the disturbances is specified the distribution of
the limited dependent variable is derived and the likelihood function
is constructed. This typically involves both probabi ilty density and
distribution functions and yields non-linear normal equations so that
iterative maximization algorithris, generally Newton-Raphson, are
suggested for obtaining estimates. These procedures are of course
straight forward but they may becorre quite expensive and. time consuming
if computer programs to not exist for the particular model being examined.
                               —3—



     Section I of this paper presents a brief review of a nu]ther of
limited dependent variable models. Such a survey will serve to
motivate the types of models to be treated and highlight their sim-
ilarities and dissimilarities. In Section II the functional model is
introduced. It is of course possible to outline a completely general
model but the aim here is for a model which rry be easily impleinted
in a single computer algorithm. With this goal in mind reasonable
restrictions on the model ars imposed and nny of the details needed
for implenntation are discussed. A final section outlines features
which should be included in a general computer algorithm.
                                        —




     Review   of Some Limited Lpendent Variable Models
A.    Binomial choice models2
           In these models each measuring unit or individual is faced
      with the choice of one of two mutually exclusive alternatives and
      the choice made is thought to depend on some vector of exogenous
      variables. One way to formalize the choice mechanism is to view
      the decision maker as having associated with each alternative
      sorre preference function, say
           I li f.1(X.)
                     i+        v
                                  ii
           I 2i     f 2(X.)
                         1 +   v
                                  2m,

      and choosing that alternative which yields the higher preference.
      Assuming f(X1) jl,2, is of the fore f.(X1)                    alternative
      2 is chosen if
            I2i
             .>Ili a'X.—ct'X.
                     2i 11 + v2i.—vli.>O
                        —   ,xi+ui>o
      where FcL         i v2i.-v li..
              2 1-a and u.                  The   model can be rewritten in the
      alternative fonyi:
           Y.
            1
              z $T.
                  1
                    + u.1
           W.
              1
                  = 0   if Y.<0
                            1
                  =1 ifY.>0

      where Y.
            1 is sorre latent (i.e •,       unobserved)   variable and W.
                                                                       1
                                                                          is the
      observed     dependent variable which indicates the choice made. Maxi-

2. These models appear to have been first examined in the context of
     economics by Tobin [8] who outlined the method of estimation which
     he termed "probit regression analysis." Theil [7], among others,
     treated the same problem with "logit" analysis. The distinction
     between the two lies in the assumptions made regarding the distribution
     of the underlying disturbance.
                                      —5—



mum likelihood estimation requires sorre assumption about the
distribution of .              If that    distribution is nol, i.e., uIN(O,a2),

the likelihood function is given by


     L(,aW,X)              II P(<i n P(i
                         w.O\ a w1l a
where   P(x) represents the standard normal cumulative density
function,    P(x):             lexp(-u2/2)du.
                     -     )/TiT

founatly S'X1/ais observationafly equivalent to (k )/(ka)
where 1K is any      positive        constant so that a is not estimable and

  is estimable only up to a scale factor. Thus we estimate

         ,   say, which is equivalent to normalizing a at unity.
        An interesting related ndel is

        Y.
         1
              'X.1 +     u.1

        W.
         1
              1 if Y.1-
                      <         1
                                Z.

              0     if Y.1 >    Z.
                                 1
where    Z1 is sorre observed variable. A concrete example might be
the estimation of a wage expectation function for say new labor
force    entrants. Expectations (Y1) are               not observable but we might
argue that        when faced with a job offer (that is an offered wage

of Z1) the entrant will accept the job (W1l) only                  if that offer
meets or exceeds his            expectation. The appropriate likelihood
function,     under the assumption of normality, is given             by
                                           z.—'x.
                                            1
        L(,al W ,X ,Z )                                .111-P
                                              a   ')            (Z±_ X)

In this case a is estimable because observations on Z1 provide

information on the scale of Y..
                             1
                                     —6—



             In another variation on the same model Z1 is replaced by sorr
      constant threshold. If           includes an intercept term then a is
      again not   estimable since (c-0-6'X)/a is observationally equivalent

      to (c-c0--ct'X')/(ka) where a0k60+(l-k)c and ck .      If that con-
      stant is also unknown and to be estimated the identification

      problem is further compounded and estimation will require some

      normalization   on either      or the threshold paramster.


B.    Multinomial choice models3
             An obvious generalization of the binomial choice model is to
      allow for   more than two alternatives in   the set of possible choices.
      Such models fit a large and important set of problems encountered
      in economics and are mentioned here for that reason. Regretably
      the functional model to be presented here cannot be used to analyze
      these models. This is the one class of limited dependent variable
      models,   however, for which there seems to be wide dissemination

      of suitable corrputer programs. The approach used in these programs

      is logit analysis, a choice dictated in part by the fact that a

      specification of the underlying disturbance distributions such that

      the selection probabilities are of the logistic form leads to tract-

      able   likelihood functions,   while almost every other choice of

      distributions   leads to nearly insurmountable computational diff-
      iculties.


3. Refer to McFadden [31 for   a description of the most general
     muitinomial model, an extensive bibliography of practical
     applications and a discussion of the estimation problems.
                                         —7—

C.   Ordinaly discrete dependent variables
          Another extension of the binary choice model is to all for
     more than two alternatives but to require that those alternatives
     be ranked in sorre well defined order. Such models might arise
     when the nagnitude of the observed dependent variable reflects the
     magnitude but not the scale of sorre underlying but unobserved
     dependent variable. As an example years of schooling might be a
     proxy rreasure for accumulated human capital but it may not be
     reasonable to assurre that twice as much education implies twice
     as much capital. Alternatively the observed dependent variable
     may have the scale relevant to a particular relationship being
     examined but it may be rreasurable only in coarse discrete units.
          In the case with unkncwn scale the model appears as:
          Y.   'X.+
                 1
           1        1
          W.l
          1
                   if             11
                                  Y.<p

               2   if

               S—l if ps—2—              i   s—i

               S        if ps—i—<Y.i

     If the u. 's are independently and normally distributed with mean
     zero the likelihood function is
                                  (1_'Xj            (p2_Xf (1_'xA
           L(,pIX,W)fl            P\ a 111              I -p\   ,,/...
                              1                1

                                     (51-'
                                        a
                                           X (s-2a X\                   (5_1—' Xj
                        .11
                         W.=s—i
                               P\                  /_P\    )   •fl   l_P\ a J
                              1                                 1

L• See   NcKelvie t1     for      a detailed discussion of the models.
                                             —8—

     As   in the      binomial    choice model, a       is not identifiable and   the
     set of thresholds               and the intercept cannot all be estimated.
     After suitable          normalization, for example al and              we can

     estimate             up to a multiplicative scale factor and the difference
     between the thresholds up to the same scale. Estimates of the
     i.'s   would represent the            relative scale among   the values taken on
     by   the observed        dependent     variable.

            When the scale of the variable W is known the model is the
     same except          for replacing the uni<riown      i.'s with appropriate known
     constants and in this case a is estimable.
D.   Truncated dependent variables 5
             In many economic relationships the dependent variable is
     necessarily non negative. Thus we might write the                  model as

            W.
              1       'X.1 + u.       if PHS>O
                                1
                      0                otherwise

     Alternatively we might concieve of an unconstrained latent variable
     Y. and reformulate the model as
      1
            y.1   z   'X.1   + u.
                                1
            W.
              1
                  Y.1 if Y. 1—
                             >L.1
                  L.         if Y.<L.
                                 1  1

     where   the threshold of 0 has been replaced by a more general variable
     threshold and only X, W. and L are observed. For independent
     normal u1 ' s the likelihood function is given by

                                        (L._tX\                 (w_'x
             L(',aJW,X,L)            II p\'   a                     a



                                                                                         .
                                                    W.>L.
                                    W.L.
                                     11              1 1


5.   These models were investigated by Tobin 191 and                have   coma to be
     called "Tobitt' models.
                                  —9—



  where   Z (x) is the standard normal density function              exp (-x2/2).

       Exanples      of problems to which this   model might   be applied
  include consumer expenditure on some class of goods, which is
  constrained to be non negative, and interest rates paid by cornnercial
  banks on savings deposits, which are constrained by regulation Q
  not to exceed a certain rate fixed by the Federal Reserve. Note
  that for purposes of estimation alone the pardcular value assigned
   toW1 for limit observations is not used while the threshold value
   is. On the other hand for non limit observations the threshold
   value need not be known. Thus the model may under certain cir-
   curnstances be utilized to estimate seperately the two equations
   of the following disequilibrium market model:
          D=          +
                          u
          S=          +u

          Q    Min(S,D)

          u1 and U2 independent
   The observed variables are Q ,X1 and X2 and we assume that X1 and
   X2 are independent of U1 and u2. For estition of the demand
   equation D is the latent variable and S the threshold with the roles
   reversed    for estimation of the supply equation. We must, for the

   truncated    model to apply, know   which observations in a given sample

   correspond to demand (ie     excess supply) and   which correspond to
   supply. Furtherrrüre information on this sample separation must be
                 6
   eXOgenOUS.

          Suppose that in the sirrple truncated dependent variable model

6. See Maddala and Nelson [2] for a detailed discussion of disequilibrium
   market     model estimation under these and other assumptions.
                                              — 10       —




   the threshold is an unithown constant to be estimated with limit
   observations on W somehow distinguishable, though not equal to
   the threshold,. Then direct maximization of the likelihood function
   with respect to ,            a     and p   (the       threshold) would lead to an estimate
   for p   of       infinity. But this would be inconsistent with model                       which

   specifies that the constant threshold must necessarily                              be less than
   or equal to the minimum observed value of W.                             over the set of non-
   limit observations. Thus the maximum likelihood estimate of p
   would be this minimum value of W.
                                  1 and the other estimates would be
   obtained by maximizing the likelihood with respect to                               the other
   paraireters       holding p fixed.

E. Iub1y truncated dependent variables.
        Some dependent variables of interest may                            be   truncated both
                                       7
   at high and at low values. The model becomes

                            +

        W.
           1
                =   L
                     li
                        .    if Y.<L
                                 1 ii
                =Y.1         ifL.<Y.L.
                                li—i 2i
                =L.
                  2 ifL.<Y.
                        2 1
   and the likelihood function is given by

                                                                        1
           L(,aW,X,L)               II    P1         a
                                                               11       a Z
                                                                                   a
                                    W.=L
                                     1 11                           1   1


                                    W1=L        (L;t Xi)
   In some probleus the intermediate or non-limit observations may also


7. See Rosett and Nelson [6] for a detailed treatment of this class
   of models.
                                             — 11   —




   be   unobserved. Provided the sarrle may                   still   be separated into
   the three       subsets of observations and the thresholds are J<nown

   constants or       observable       variables, all parameters of          the irodel are


   replaced in this case by [P(
                                L .-'X.
                                         —P(
                                             L .-'X.
                                                         '
   still estimable. The middle term in the likelihood function is
                                                   1)], and the model

   is seen to be a specific case of the ordered discrete variable
   model with J<nown scale.
         An example of a problem to which this model has been applied
   is the demand for health insurance by people on madicare. A certain
   minimum coverage (the lower threshold) is provided to all participants.
   They may purchase supplemantal insurance only up to some maximum
   which falls short of full coverage.
F. Models of Friction
   Rosett [5] considered a model in which the dependent variable
   responds only to numarically large values of the exogenous variables.
   His model may be written as:

          Yi
               =
                   'Xi li
                        +


          W.
           1
               =Y.1 -       1
                                ifY.1 <a 1
                                if   a1 < Y.
                                           1
                                               <    a2


                    i2
                =y.—a           if a 2<Y.1
   Denote      the sample separation into                the three   subsets by three sets
   of integers l '2 and                  .    The    likelihood function is given by
                           - 12   —




      L(1,a2,,aIW ,X)     IIi Z\ a ) P a ) - P1-'x.1
                               (w1+a1'x 2 f2_TxA11




                          3           _______
The   model provides for a different intercept in the two sets of
continous observations. One might assume no difference in the
intercepts by setting 1Y1 in both extreme cases and deleting
   aid °2 from the corresponding teniis in the likelihood.
Going the other direction even the slope coefficients might be
permitted to change between the two sets by appropriate modification
of the model and the likelihood function.
       Exai1es of problems to which this model might apply are
changes in the holdings of some asset in response to changes in
its price or rate of return and changes in wage offers by a firm
in response to changes in market conditions.




                                                                       .
                                  — 13 —



II.   A General Functional Model
      Most of the limited dependent variable models may be specified,
      perhaps after reformulation, as
      (i)   a single regression equation relating a latent, i.e., not

            directly   observable, endogenous variable to a stochastic
            function of some vector of exogenous variables, say
                   f
            and
      (ii) a      discontinuous mapping from the latent variable Y to an
            observable dependent variable W, say
                  g (Y,Z.)
The role played by the vector of exogenous variables Z will
be discussed below. Observed variables include X.1']
                                                  Z. and W.
                                                          1
                                                            and para-
meters to be estimated include the vector and perhaps parameters of
the distribution of U1 and of the function g.
      The functional form of both g and f must be }<nown and constant
over all observations. If the rmdel is to conform to the various limited
dependent variable models and be operationally feasible we will require
certain restrictions on the form of these two functions. Consider
first the function f. Since the estimation method to be used is maximum
likelihood the distribution of the stochastic component must be specified.
We will assume that the disturbance term u appears, perhaps after a
suitable transformation, additively and follows an independent normal
distribution with zero mean and constant variance.8 Restrictions on

8. The choice of distributions may of course be changed but is an
    integral part of the analysis and thus must be held fixed for
    implementation of the model. Note that the normal distribution
    leads to probit analysis for the binomial choice model and is
    the distribution suggested most often for eKtensions of the limited
    dependent variable models. A choice of the logistic (sech2) dist-
      ribution would lead to logit analysis for the binomial choice model.
                                           -1-

the degree     of non-linearity of f        may also be desireable. The
iterative niaxinuization algorithims used for obtaining estimates
generally require at least first and perhaps second derivatives. Thus
if nonlinear specifications for f are to be alled implementation
will require a computer system with analytic differentiation capability,
nuirical derivatives or user supplied derivativatives. Restricting f
to be linear would avoid this problem but we will not impose that

constraint here. The regression equation to be used in the nodel is

thus of the form
                                                   2
       (1) Y f(X.,)         +   u    ,   uIN(O,a       ).


       In   the limited dependent variable models the mapping W1g(Y) is

necessarily discontinuous with the discontinuities appearing at well

defined points, to be called thresholds, in the range of Y.

that   there are S-l   threshold      points and partition the range of              into

the S disjoint intervals. Then g(Y1 ,Z             may be written as

       (2) g(Y,Z1) =                  if   tj1
                                                            <
                                                                tj   j=l,...

where t. .
        1J
             ,j1,... ,S-l are the threshold points and t. and t. are
                                                      10      iS
defined to be -      and +

jzl,... ,S must hold across
                             respectively.         The constraint -
                                    all observations i but the         threshold
                                                                                tj
                                                                                points

need not be constant across observations. Any conüination of the following

specifications for the t 's should be permissable:

       (i) known nureric constants

    (ii) observable variables (ie. one of the variables in the vector
             Z.)
              1
   (iii)     constant but unknown paramsters to be estimated.
                                            - 15   -

        The individual                     jl,... ,s are of two         basic   types, to be

called continuous and        mass point      as determined by the distribution of

the   random variable W.
                      1 within the relevant interval on Y.
                                                        1
                                                           .                      A   mass point
         specifies       that within the jth interval of the range of Y
                                                                                        WI
                                                                                             is

a constant function of Y(i . e.,            independent of thelevel             of Y1). 7pica1

specifications         for mass   point   g.'s are

        (i)                 t< (where tik is one of the threshold points of

                                               the type (i) or (ii) as given above)

       (ii) g (Y1)          Zik (where Zik is soma observable exogenous variable)

      (iii) (Y) c (soma known constant)
Continuous               's specify continuous and strictly increasing functions
               g (Y1)
of      within the corresponding interval on                     The most corrmon specifi-
cation will be
                   =

We will in     fact require that all continuous               g5   be   of this form, delaying
for the moment a discussion of the advantages and disadvantages of such
a restriction.
        Derivation of the likelihood function for the functional model is
straight forward. We need first to derive the distribution of W1. For
mass point intervals we have
        Pr(W.g.(Y.))
           1 : 1              Pr(t.. <Y.<t..)
                                  ij—l—i ij
               =(t..        -f(X.,)
                               1    <—u.1     < t.
                                                   1J
                                                       .-f(X.,))
                                                           1

which under the Normality assunption on u. becorrs
                                         1
                                   t.1J.-f(X.,)
                                           1
                              p(                              ( 1J 0
                                                        - p              1
        Pr(W.=g.(Y.))
            1] 1
 9.    The term mass point         and continuous will be loosely applied to the sub-
 functions g., to the corresponding interval on Y. and to the values taken
 on by W.. What is implied in all cases is that,'within some intervals of
 the rane of Y. ,W1 is defined by g. to be a constant so that its associated
 measure of proabi1ity is probabi1ty mass. In other intervals W1 is a
 continuous function of Y. within that interval so that the appropriate
 measure      of   probability i its probability density.
                                                  - 16       -
 where P() is the standard normal cumulative density function. A general
 derivation of the density function for over continuous intervals
 requires strong assunptions about the specification of continuous g (Y) 's.
 If these      functions are strictly increasing                       (decreasing) over   the relevant

  interval on        Y. then the inverse function
                      1

         Y.1        g (W.)
                        1
                     J

  exists and is differentiable so that the p. d. f. of continuous W, say
 h(W.), is given by

         h(w) J z (wi_fXi))
 where J is the Jacobian of the                   transformation, J.                  I,   and   Z is the
 standard normal density function. Construction of the likelihood requires
 knowledge of the sanple separation. That is for each observation on
 we must be, able to determine the interval in which the corresponding
 unobserved value for               lies.10 For notational convenience define the
 subsets            of integers 1,... ,n, where n is the sanle size, as
                     if t_1            <    t..      ,   i       1,... ,n , :F:l,... ,s
 The likelihood function is given by
  (3) L(eJW,X,Z) = ii           ii
                               A.      Ti       A.
                                                  i2 •. ..        ii       A.
                              1             2                          s
 where 0 is a vector of all paraireters to be estimated and the A. . 's are
                                                                                             1J
 defined as
                       t. .—f(X.1 ,)              i1
                                                t. .     —f(X.1 ,)
         A..    =    P(                —
          1]
 if j   corresponds       to a mass point interval on Y1 and

                          Z
                              ((Wi) - f(X6)
10. Determination of the sample separation is made by comparing, for each observa-
tion, W1 with each g. (Y.). For mass point g. 's a matching of Wj and g. (Y) for
some j determines that *he observation correponds to a value of Yj inthe th
interval. This leaves only the continuous observations to be classified but, as
will be pointed out later, so long as we restrict continuous gj 'S    be of the                  to
form gj (Y) Y1 the knowledge that an observation on Wj    is a continuous one is
all that is required; we need not know to which continuous interval it belongs.
                                        — 17    —




if j   corresponds    to a continuous interval on Y..
        It should nc be clear why the restrictive specification
g (Y) Y for continuous intervals was imposed. Such a restriction
makes it easy to distinguish mass point from continuous intervals
and permits all continuous observations be to be grouped into a single sub-
set, for purposes of estimation, since they all enter the likelihood in
exactly the sane form (Jl and g (W1) = W1 for every continuous
interval j.)       Thus   we can avoid a good deal of pethaps nessy corrputer
coding and additional user supplied infornition. Note too that this
restriction creates difficulty with only one of the limited dependent
variable models reviewed in section I, the friction model. But even this
problem is easily surmounted by judicious use of dunmy variables.
        The friction model, with intercepts which differ in the two
continuous intervals, is repeated here.
        Y.
         1=       'X.1 + U.1
        w.
         1
              =   Y.
                   1 -a1 ifY. 1<a1
              zQ ifa1<Y1<a2
                  Y.
                  1 —a
                     2
                       ifa 2<Y.1
Reformulate the regression equation as
        Y.
         1        a1D.ii+ a 2i2
                            D. + 'X.1    + U.
                                            1
where D. il       -l when Y.
                          1 lies in the lcwer continuous interval
                  0 otherwise
                  -l when Y lies in the upper continuous interval
                  0 otherwise.
                                          — 18 -



The   rest of the model is then written as
        W.
         1
              Y.
                   1
                        if     Y.1 <ct1

               0        if   c<Y.<c
                              1—i   2


             =Y.1       if    2i
                             cL<Y.



Note that the two continuous intervals on          are not properly defined
in this formulation but recall that for continuous intervals the
threshold points do not appear in the corresponding terms in the likeli-
hood function. Thus with regard to estimation the inconsistency is only
transparent. The inconsistency could in fact be removed by redefining
the two intervals as Y.<0
                       1 and 0<Y..
                               —1
                                   But this would make the model more
difficult to irxplemant since then, without specifically accounting for
the specification of f(X1,), the intervals on Y1 would appear to either
overlap or fail to exhaust the entire range of Y1. Several other points
are worth noting. In this model        should not include an intercept
term or indentification problems among o'l and 02 will arise. The
friction model is unique in that threshold parameters and parameters of
the function f overlap. Finally, similar use of dunj variables can
provide for slope coefficients which differ in the two continuous intervals
while if all intercept and slope coefficients are the same the restriction
on    the specification of the continuous g 's is satisfied    without a
reformulation          using duimj   variables.
                                               - 19 -


III.    Features of a Computational Algorithm

        In   this section we will discuss the specific details involved in

a   suitable conputer program for the              functional model. First           the
model is restated.
                  The functional model is defined as
         (1) Y.1        f(X.,)
                           1
                               +         u.1
         (2) Wi = g.(Y)                  if t1 <        Y1   <   t.., j1,... ,S
                                 2
                   1    IN(O,o       )




     is a latent variable and W, the vector X and perhaps some vector
Z.1 are the observed variables. Parameters to be estimated include
and    perhaps         and/or some of the t's. The threshold points t0 and
t1     are defined as -              and +     respectively      for all i=l,. .   . ,n where n

is the sanple size. The remaining threshold points t11,... ,t51 may

be   any   of    the following:

           (1)    known numeric constants
        (ii) observable exogenous variables (one of the Zts)
       (iii) constant but unknown parameters to be estimated

       g (Y1) 's define W1 to be either a mass point observation or a
The

continuous observation when the unobserved                         falls in the conesponding
 th interval. Continuous g (Y1) 's must be of the form

                  g(Y1)
while mass        point g(Y1)'s may be either
           (1)    known constants,i.e.,g.(Y.)            C
                                        Ji
or

           (ii)    observable exogenous variab1es,i.e.,g(Y)                    ZJ<
                                       - 20 -
Furthermorethe mass point g (Y) 's must be such that a comparison of
W for each observation with each mass point g will determine uniquely
a sample separation defined by the following subsets of the integers
1,...
         ic' 1ff W. g (Y.)              for mass point interval j
         ik 1'o    iff WI g (Y1)        for any mass point interval j.
Note    that 1'. will be empty for any continuous interval j.
         The   components of the likelihood function were presented in Section
II. Estimation involves maximization of the logarithm of the likelihood
function. The normal equations obtained by setting the derivatives of
log L with respect to each estimable paraiiter equal to zero will be non-
linear so that soma iterative maximization algorithm is required.
Experience has       shown   that the Newton-Raphson algorithm11 works quite
well on    these models with fairly rapid convergence when starting from

reasonable        initial estimates. This algorithm does require both first
and    second derivatives which, though messy, are fairly easy      to derive.
Table 1 presents the components of the likelihood function corresponding
to each type of interval on Y1 and the associated terms in the first and
second derivatives of the log likelihood function. Several points should
be noted. First the parameters to be estimated are denoted by the by
the vector e with elements 0. Secondly, the derivatives presented there
make the following use of the chain rule: The terms in the log likelihood
function     involve the functions P(A) and Z(B), where A and B are represent-

ative argunts, and have the following derivatives:

11. As was noted earlier the constraint t. .1<t.. must hold for jl,... ,s and
all i1,... ,n. If these thresholds includparaters to be estimated the
constant should be taken into account in the maximization algorithm. This
is awkward to do however, in the general model since not all problems will
require estimation of threshold parameters. There is no danger that straight
forward application of Newton's mathod will produce estimates which violate
the constraint since this would require taking logarithms of negative numbers.
We therefore suggest using Newton's method with the provision of allowing some
user control in the iterative process for handling those occasional problems
in which the constraint causes difficulty.
                                   — 21   —




         P(A)   - Z(A)      A and Z(B)           —Z(B)   B .
          o.1   — P(A)
                              1
                                        o.1
                                                                1

We   have carried the differention only this far, since the arguments A
and B involve the unspecified function f(X1 ), and assume that the
derivatives of these arguments can be readily obtained thru some corrination
of user supplied derivatives, restrictions on the functional form of f
and internal differentiation capability 12 Finally, note that lower and
upper mass point intervals have been distinguished in tht table from
interior mass point intervals since recognition of their sirrpler
structure generally will achive significant economies in computer time.
      As was suggested by the discussion in Section I, not all parameters
in the functional rrodel are necessarily estimable. In parLicular can
be estimated only if the observed variable W contains some information
regarding the scale of the latent variable          In general any one of
the following conditions on the model will be sufficient       to permit

estimation    of a.
        (i)   At least one continuous interval

       (ii)   At least one threshold is an observable, varying threshold
      (iii) At least two threshold points are known constants
If none of these conditions   are met   then estimation may proceed only after
normalization of a, e.g., ail. If the model includes both threshold parameters
to   be estimated and an intercept term in the regression equation there
will generally be an identification problem airng this set of parameters
12. The TROLL system on which the authors have implemented the functional
model does have the internal capability of obtaining analytic derivatives.
This feature is exLremely useful for such simple functions as the arguments
like A and B in that it renders unnecessary further restrictions of f or
alternatively, heavy user input. On the other hand it cannot be used to
avoid the progranirning of derivitive calculation to the level presented in
table I without resulting in prohibative computer time.
                                                                                             S
                                       TABLE   1.   COMPONTS OF LJKELDIOOD FUNCrION AND CORRESPONDING
                                                    FIRST AND SECOND DERIVATIVES OF THE LOG LIKELIHOOD
ipe of interval                    Corresponding
to which an                        component in
observation        belongs         likelihood                      First derivative (w.r.t.O.)                               Second derivative                               and
                                                                                                                                                                  (w.r.t.O         Ok)
Lier mass point                                                                      A
                                   P(A)                            Z(A)                                                      Z(A)              [1k          -   A.•A•A] -    P(A)    BP(A)
                                                                P(A.)
                                                                         I
                                                                                                                             P(A.)
                                                                                                                                   1
                                                                                                                                                                             .1          k
Interior mass        point         P(A.)—P(B.)                     Z(A.)A
                                                                    P(A.)
                                                                         i       1
                                                                                     —

                                                                                         -   Z(BJ•B
                                                                                          P(B.)
                                                                                                 ii        11                      1  1]]
                                                                                                                             Z(A.)•[A-A.AA1
                                                                                                                                               1]
                                                                                                                                                                     —
                                                                                                                                                                           I
                                                                                                                                                                P(A.)- P(B.)
                                                                                                                                                                                I    I]]
                                                                                                                                                                         Z(B.)•[B—B.•BB]
                                                                                                                                                    -                          B[P(A.)-P(B.)]
                                                                                                                                                        [P(A)-P(B)]
per     ss        point            l-P(B.)                         -Z(B.)
                                                                                      A                                      -Z(B.)
                                                                                                                                           .                 - B.BB] + l-P(B.)               l-P(B.)
                                                                   P(B.)
                                                                      I                                                       P(B.)                                            .i               k
Continuous                         1 Z(C   )                       <—1/a> —C•C
                                                                                             i
                                                                                                                             <<1/a >>
                                                                                                                                       2
                                                                                                                                                        -     jlc +
                                                                                                                                                            (C.C       1k
                                                                                                                                                                    C.C )
                                   a
P()
         -
         fX       Z(u)du,          Z()                  exp(—x2/2)
A.     t.-f(X,)       ,   B.   =
                                   t1_f(X)          ,   C =    W-f(X,)               ,   A                      ,   A   2A     ,   etc.
              a                      a
                                                                                                      Oi
      the term -1/a appears only         for 0             =   a
      the term 1/a2         only               for ik,               =       a
                            appears                            O
                                  - 23   -
- only the difference between each pair of parameters
in the set can be estimated. Again a normalization is required on
one parameter in this set.
     The iterative maximization algoritii will require starting values
for the parameters to be estimated. We have not been successful in
obtaining a straightforward routine for selecting good starting values
for all parameters in the functional model. Tobin [9], in the context
of the Tobit model, suggested approximating the non-linear terms in the
normal equations by some simple functions to allow analytic solution of
those equations but this approach becomes quite difficult to implement
in the more general functional model, especially if the regression
equation is itself non-linear. Similarly some expansion of the normal
equations   with a low order truncation is   also difficult to implement.
In   lieu of a general solution we offer the following suggestions for

implementation   on a case by case basis.
      (a) If the model includes continuous intervals, least squares
            regression of W1 on X1 over just the subset of continuous
            observations will often provide satisfactory, thoui biased,
            starting values for the regression coefficients and for a.
      (b) For threshold parameters choose starting values such that the
            spacing between adjacent threshold points is proportional to
            the percentage of observations falling in each interval.
      (c) In models with no continuous intervals and values for W1 which
            correspond ordinafly to Y try a straightforward least squares
            regression of W1 on X1 for starting values for the regression
            coefficients.
                                   — 2'- —



     Cd)    for many   data sets and if the iterative maximization
            algorithm is fairly stable, zero starting values for many of
            the paranEters will generally suffice.
    Generally paraneter estimation is only part of the analysis to
be performed on a given model. The remainder of this section discusses
vamious other analyses which may often be desired and which are reason-
ably easy to isplerrent in the functional model.
     It is often quite informative to examine simple descriptive statistics,
such as mean, variance and range, of various variables in the model both
over all observations and over the subsets of observations corresponding
to each interval on Y. Furthermore while such information may be of
use by itself it can as well serve to detect or explain failures in the
estimation process. To see this consider a simple binomial choice model
with a single regressor variable. The likelihood function is given by
     L(a,W,X)          II P(—a—X.)
                               1 .   11   [l—P(—a—X.)]
                                                  1
                       1             1

Suppose    that in a given set of data the observations are as pictured in
the figure to the right.                                 W
                                                             xx xx x
It is easy in this case to
                                                                       X
find values for a and
such that whenever W.O
                    1

(_a_X) is positive and when Wl (_a_X) is negative. All observations
can thus be perfectly classified on the basis of the sean value (ct+X)
for such a and . In fact the likelihood is maximized as a and tend
to negative and positive infinity respectively. This failure in the
estimation process could easily be predicted, in this simple model, by
                                       - 25   -

coirparing the    range of X within the two        sets   of observations. The
sane   problem   arises in this model   with      more than one exogenous variable
and   all the   other models as well, suggesting that as a prelude to
estimation one should always critically examine simple statistics,
expecially the range, of the exogenous variables within each subset
of observations. In addition, even if the individual exogenous
variables do overlap,     there may be    sorre combination which provides
perfect classification of the observations. Such a situation is often
difficult to detect until after the estimation process has failed.

Performing      the sane analysis on      =
                                              f(x,) where       is the vector of

regression coefficient estimates when the iterative maximization

procedure began to diverge may often reveal the source of the problem.

        Estimated classification probabilities(i .e . Pr(W. g.       (Y.1 ) IX.
                                                                              1,Z.)
                                                                                1
                                                               1-J
or   alternatively Pr(t.1< Y <         t..!X.,ZJ)      are often as important to

the analysis as estimates of the parameters themselves. The expressions

for obtaining them are given by the components of the likelihood function

for    mass point intervals and similar expressions for continuous intervals.
In addition to their independent use they serve an important role in
an examination      of the estimation results analogous to residual analysis

in least squares regression. They provide, for example, one rreasure of
classification error. Let j be the interval in which an observation
falls    and   j be the interval with largest associated classification
                                                                                      13
probability.       An obervation may be   viewed as being misclassified if j j.
13. Whether this is an appropriate measure of misclassification will depend
on the model being examined. For example it may be a useful measure for the
binomial choice model while in the ordinally discrete model, since the
frequency of misclassification under this measure is easily altered by
arbitrarily collapsing adjacent intervals, it may not be at all appropriate.
                                             - 26   -

      Avariety of maasures of "residuals" may be readily obtained. Using
estimated coefficients to conpute Y = f(X,6) we can obtain directly
 1 ii
u.
the
      W. -Y. for continuous observations. For mass

      estimated residual    may be "bracketed" by t. .-Y. and Y.-t..
                                                                        point observations

                                                   13 1       1 ij—1
Another   indicator of misclassification is given by a conparison of j

and j where    j   the   interval in which          Y falls and, as before, j* is the
observed   interval.

      An important part     of   the analysis for a given problem might be the

calculation   of mean values for the observed dependent variables. These
might be needed, for example, for prediction purposes or for the calculation
of elasticities. LLf The expected value of                     for given X (and Z) is
                                     y-f(X.,6)
                                          1
      E(W. IX. ,Z.) =1 — Z       (                      g(y) dy


                    = I
                       s    ij 1            y—f(X. ,6)                    s
                                                             g.(y) dy         A.
                    j=l t1
                                       Z(                )
                                                                         jl
For mass point intervals g (y) is a constant so that the coresonding
term in the expected value of is

      A. = g.(Y.) . [P(
       3     31
                           t.'.-f(X. 6)'      ) - p ( ijl
                                                         t.. -f(X.,6)
                                                                 1




l.observation
    If the prediction   or elasticity is for a single individual or.
              then the appropriate value for W to be used should by Wg(Y1).
On the other hand if we need the mean predicted value or aggregate
elasticity the appropriate value is E(WIX±ZI) as is given here.
                                       — 27      —




 For   continuous intea1s, iteation over the 1evant range yields15
            A f(X1,8) [p(t1-f(X1) ) - p (tij_l_f(xis)) ]
                    -a[Z(11
                            t. .—f(X.,)
                                   1
                                           )-Z('         t. . —f(X.,)
                                                                        )]




                     t.      1 y-f(X,)
 15. We have
                A    f     y a Z(            )
                                                 dy IL2[f(X,) ÷ ax] Z() dx
                     j—1                                   1
                             L                       L
                     f(X1) 2 Z()d + a
                           L1

where Lj1[t. 1—f(X,)]/a and L2[It.—f(X,)]/a.

Since Z() —dZ()/d, !XZ(X)d —                     Z()
and we obtain

           f(X,)•[P(L2) -              -                 - Z
                              P(L1)]       a[Z(L2)             (L1)]
                                   — 28   —




References


[1]    Johnson, Thomas. "Qualitative and Limited Dependent Variables in
       Economic Relationships, "Econömetri-ca, May, 1972.
[2]    Maddala, G.S. and F.D. Nelson. "Maximum Likelihood Mathods for
       Models of Markets in Disequilibrium," (forthcoming) Econoiietrica,
       November, l97.
[3]    McFadden, Daniel. "Conditional Logit Analysis of Qualitative choice
       Behavior," Frontiers in Econoutrics, P. Zareithka (Ed.), Academic
       Press, 1973.
[]     McKelvey,   Richard D. "A Statistical Model for the Analysis of
       Ordinal Level Dependent Variables ," discussion paper, Political
       Science Departnnt, University of Rochester, May, 1973.
[5]    Rosett, Richard N. "A statistical Model of Friction in Economics,"
       Econouetrica    1959.

[6]    Rosett, Richax N. and F.D. Nelson. "Estimation of the Two-Limit
       Probit Regression Model," (forthcoming) Econontrica.

[7]    Theil, Henri.    Principles of Econoiietrics, chapter 12; Wiley, 1971.

[8]    Tobin, J. "The Application of Multivariate Probit Analysis to
       Economic Survey Data," Cowles Foundation Discussion Paper no. 1,
       New Haven, Conn., 1955.

 [9]   Tobin, J. "Estimation of Relationships for Limited Dependent
       Variables," Econorretrica 1958.
