                               NBER WORKING PAPER SERIES




                 CLASS SIZE AND SORTING IN MARKET EQUILIBRIUM:
                              THEORY AND EVIDENCE

                                         Miguel Urquiola
                                         Eric Verhoogen

                                       Working Paper 13303
                               http://www.nber.org/papers/w13303


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                    August 2007




We thank Kensuke Teshima for excellent research assistance. For useful comments we thank (without
implicating) Josh Angrist, Jere Behrman, David Card, Ken Chay, Pierre-Andre Chiappori, Gregory
Elacqua, Helios Herrera, Kate Ho, Larry Katz, David Lee, Robert Moffitt, Richard Romano, Bernard
Salanie, and many seminar participants. We especially thank Patrick McEwan, who was involved
in the early stages of the project. The views expressed herein are those of the author(s) and do not
necessarily reflect the views of the National Bureau of Economic Research.

© 2007 by Miguel Urquiola and Eric Verhoogen. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
Class Size and Sorting in Market Equilibrium: Theory and Evidence
Miguel Urquiola and Eric Verhoogen
NBER Working Paper No. 13303
August 2007
JEL No. C2,I2,L1,O1

                                               ABSTRACT

This paper examines how schools choose class size and how households sort in response to those choices.
Focusing on the highly liberalized Chilean education market, we develop a model in which schools
are heterogeneous in an underlying productivity parameter, class size is a component of school quality,
households are heterogeneous in income and hence willingness to pay for school quality, and schools
are subject to a class-size cap. The model offers an explanation for two distinct empirical patterns
observed among private schools that accept government vouchers: (i) There is an inverted-U relationship
between class size and household income in equilibrium, which will tend to bias cross-sectional estimates
of the effect of class size on student performance. (ii) Some schools at the class size cap adjust prices
(or enrollments) to avoid adding another classroom, which produces stacking at enrollments that are
multiples of the class size cap. This generates discontinuities in the relationship between enrollment
and household characteristics at those points, violating the assumptions underlying regression-discontinuity
(RD) research designs. This result suggests that caution is warranted in applying the RD approach
in settings in which parents have substantial school choice and schools are free to set prices and influence
their enrollments.

Miguel Urquiola
Columbia University
SIPA and Economics Department
1022 IAB, MC 3308
420 West 118th Street
New York, NY 10027
and NBER
msu2101@columbia.edu

Eric Verhoogen
Columbia University
SIPA and Economics Department
1022 IAB, MC 3308
420 West 118th Street
New York NY 10027
eric.verhoogen@columbia.edu
1        Introduction

There has been a long and heated debate on whether class-size reductions improve educational
performance. Hanushek (1995, 2003) reviews an extensive literature and concludes that class
size has no systematic eﬀect on student achievement in either developed or developing countries.
Krueger (2003), Kremer (1995) and others have countered that this conclusion is based largely
on cross-sectional evidence and subject to multiple potential sources of bias, including the en-
dogenous sorting of students into classes of diﬀerent sizes, and have called for further analyses
using experimental and quasi-experimental designs. In the latter category, an inﬂuential approach
has been the regression-discontinuity (RD) design of Angrist and Lavy (1999), which exploits the
discontinuous relationship between enrollment and class size that results from class-size caps.1
        Despite a general awareness of the possible endogeneity of class size, relatively little attention
has been paid to how schools choose class size or to how households sort in response to those
choices. In this paper, we develop a model of class-size choices by heterogeneous schools and of
school choices by heterogeneous households, show that two central predictions are borne out in
data on Chilean schools, and argue that these ﬁndings have important implications for attempts
to estimate the eﬀect of class size on student outcomes. Chile’s educational market is well-suited
to such an investigation in part because private schools account for approximately half of the
market, and a majority of them are operated on a for-proﬁt basis. This makes it straightforward
to specify schools’ objective functions—an otherwise diﬃcult task in many public-sector contexts.
        In the model, schools are assumed to be monopolistically competitive, to be heterogeneous in
an underlying productivity parameter, and to oﬀer quality-diﬀerentiated “products,” where class
size is a component of school quality. Households are assumed to be heterogeneous in income
and hence in willingness to pay for quality. Schools face three constraints, corresponding to real
restrictions faced by private schools that accept vouchers in Chile: (1) a class size cap at 45
students; (2) an integer constraint on the number of classrooms; and (3) the restriction that
enrollment (a choice variable of schools) cannot exceed demand.
        The model delivers two main empirical predictions, both of which ﬁnd support in the data.
First, there is an inverted-U relationship between class size and household income in cross-section.
    1
    The RD approach has also been used to study the eﬀects of class size by Hoxby (2000) in the U.S., Dobbel-
steen, Levin, and Oosterbeek (2002) in Holland, Browning and Heinesen (2003) in Denmark, Asadullah (2005) in
Bangladesh, Jakubowski and Sakowski (2005) in Poland, Bressoux, Kramarz, and Prost (2005) and Piketty and
Valdenaire (2006) in France, Wössmann (2005) in ten European countries, and Urquiola (2006) in Bolivia.


                                                      1
The model predicts that higher-income households sort into higher-productivity, higher-quality
schools, as one might expect. The inverted U arises from the interaction of two eﬀects: higher
productivity enables schools to ﬁll up their existing classrooms, and it also leads them to add
classrooms and reduce class size to appeal to higher-income households. The former tends to
dominate at lower levels of productivity, and the latter at higher levels. The inverted-U relation
between class size and income will tend to confound attempts to estimate the eﬀect of class size
in cross-sectional regressions.
   Second, in the presence of the class-size cap and the integer constraint on the number of
classrooms, schools at the cap adjust price (or enrollment) to avoid having to add an addi-
tional classroom. This results in stacking at enrollment levels that are multiples of 45. Because
higher-income households sort into higher-productivity schools, the stacking implies discontinu-
ous changes in average family income and hence in other correlates of income, such as mothers’
schooling, at these multiples. The resulting discontinuities violate the assumptions underlying the
RD designs that have been used to estimate the eﬀect of class size. Our results thus provide a
concrete illustration of how endogenous sorting around discontinuities may invalidate RD designs
(Lee, forthcoming; McCrary, forthcoming). We view these results as a cautionary note regarding
the application of such designs in contexts where schools are able to set prices and inﬂuence their
enrollments, and parents have substantial school choice. As we discuss below, we have no reason
to believe that this conclusion generalizes to the public-school settings typically studied, in which
students are required to attend local schools and in which schools cannot control their enrollments
but rather react mechanically to them.
   In addition to the papers cited above, this paper is related to a growing body of theoretical
and empirical work on sorting in education markets, including Manski (1992), Epple and Romano
(1998), Clotfelter (1999), Epple, Figlio, and Romano (2002), Epple and Romano (2002), Nesheim
(2002), Caucutt (2002), Nechyba (2003), Bayer, McMillan, and Rueben (2004), Altonji, Huang,
and Taber (2005), Urquiola (2005), Epple, Romano, and Sieg (2006), Hsieh and Urquiola (2006),
Rothstein (2006), and Ferreyra (2007). Much of this work is focused on the impact of greater
school choice—either through greater school district availability or through vouchers—on sorting
outcomes. The distinctive aspect of this paper is our focus on the role of institutional constraints—
the class-size cap and the integer constraint—in a market that is already largely liberalized.
   One caveat is that this paper does not consider the role of peer eﬀects, which play a central role


                                                 2
in much of the previous theoretical work on sorting in educational markets (Epple and Romano,
1998, 2002; Epple, Figlio, and Romano, 2002). In many of these models, schools are essentially
passive “clubs” whose main attribute is the average ability and income of their students. In our
model, as in Epple, Romano, and Sieg (2006), schools actively choose the level of educational
quality to supply. It is diﬃcult to integrate both the peer-eﬀects and the quality-choice elements
in an analytically tractable model. Epple, Romano, and Sieg (2006) maintain both elements, but
must rely on numerical methods to compute equilibria. Our approach is to abstract from peer
eﬀects in order to arrive at analytical results. In the long run it would clearly be desirable to
develop an analytically tractable model that combines both elements.
        This paper is also related to work on quality choice by ﬁrms (Mussa and Rosen, 1978; Gab-
szewicz and Thisse, 1979; Shaked and Sutton, 1982; Anderson and de Palma, 2001). The structure
of the theoretical model has many elements in common with the framework of Verhoogen (2007),
which models quality choice by heterogeneous Mexican ﬁrms facing heterogeneous consumers in
the domestic and export markets.
        Finally, in seeking to understand the mechanisms behind the determination of class size, we
view our work as complementary to Lazear (2001), which focuses on how schools allocate students
with heterogeneous levels of self-discipline into classes of diﬀerent sizes. We abstract from sorting
within schools and instead focus on sorting between schools with diﬀerent average class sizes.
        The remainder of the paper is organized as follows. Section 2 provides institutional back-
ground, and section 3 sets out the model. Section 4 describes the data. Section 5 discusses
testable implications and presents the results. Section 6 concludes.


2        Chile’s School System

There are three main types of schools in Chile:

    1. Public or municipal schools are run by roughly 300 municipalities which receive a per-
          student “voucher” payment from the central government. These schools cannot turn away
          students unless oversubscribed, and are limited to a maximum class size of 45.2 In most
          municipalities, they are the suppliers of last resort.
    2
     In some instances schools are temporarily authorized to have classes of 46 or 47, but they receive no payments
for the students above 45.



                                                        3
   2. Private subsidized or voucher schools are independent, and since 1981 have received exactly
         the same per student subsidy as municipal schools.3 They are also constrained to a maximum
         class size of 45, but, unlike public schools, have wide latitude regarding student selection.

   3. Private unsubsidized schools are independent, do not accept vouchers and receive no other
         explicit subsidies, and are not bound by the class-size cap.

       Parents can use the per-student voucher in any public or private voucher school that is willing
to accept their children. In 2003, private schools (both voucher and unsubsidized) accounted for
about 45 percent of all schools, and voucher schools alone accounted for about 36 percent. In
urban areas, these shares were 62 and 48 percent, respectively. Private schools can be explicitly
for-proﬁt, and using their tax status to classify them, Elacqua (2005) calculates that about 70
percent of them are indeed operated as such. Further, even non-proﬁt schools can legally distribute
dividends to principals or board members. A handful of private schools are run by privately or
publicly held corporations that control chains of schools, but the modal one is owned and managed
by a single principal/entrepreneur.
       Public primary schools are not allowed to charge “add on” tuition supplemental to the voucher
subsidy.4 While initially voucher private schools were subject to the same constraint, this restric-
tion was eased beginning in 1994. At present, they can charge tuition as high as approximately
1.7 times the voucher payment. In practice, this constraint appears not to be important for most
voucher schools; in 2006, for instance, fewer than 4 percent of them had per-student revenues
within 25 percent of the tuition cap.5 The resources these institutions raise through tuition are
equal to about 20 percent of their state funding.
       Rather than attempt to analyze the entire Chilean educational sector, we narrow our focus in
four important ways. First, we restrict attention to primary (K-8) schools because class size, a
central variable in our analysis, is more clearly deﬁned at the primary than at the secondary level.
Second, we focus on private schools since, as mentioned above, we can plausibly assume that they
are proﬁt-maximizing. Third, we focus on urban areas because we want to consider settings where
enrollment and class size are determined by schools’ and households’ choices, and not constrained
   3
     The payment varies somewhat by location, but within an area voucher and municipal schools receive equal
payments. For further details on the creation of the voucher system, see Hsieh and Urquiola (2006).
   4
     Public secondary schools can charge add-ons, but in practice very few do.
   5
     The administrative data this ﬁgure is based on contain information on average revenue and not posted prices.
The former can be lower than posted tuition if some students receive discounts.


                                                       4
by the size of the market, as could happen in rural areas.6 Fourth, we focus on voucher schools,
the private schools subject to the class-size cap, and not on unsubsidized schools. We do so in
part because we are primarily interested in how the class-size cap aﬀects sorting outcomes, and in
part because the unsubsidized schools serve a very distinct, elite population,7 and are governed
by considerations that would be diﬃcult to incorporate tractably into our theoretical framework.8
        A ﬁnal relevant fact is that as elsewhere, primary schools in Chile are not large; 95 percent
of urban ones have fewer than 135 students in the 4th grade.9 As Figure 1 illustrates, they run
relatively few classes per grade. In 2002, for instance, 53 percent of urban private schools had
only one 4th grade class, while 86 and 95 percent had two or fewer or three or fewer, respectively.
Public schools run a slightly higher average number of classes, but 91 percent of them still operate
three or fewer 4th grades. While in theory schools could combine students from more than one
grade into a single classroom, in practice very few do, especially in the urban areas we focus on.
In 2002, for instance, 4.3 percent of urban voucher schools reported they combined more than one
grade into a class.10 These facts motivate the integer constraint in our model.


3        The Model

This section develops a model of quality diﬀerentiation and sorting in the Chilean school market.
We model parents’ demand for education in a standard discrete-choice framework with quality
diﬀerentiation (McFadden, 1974; Anderson, de Palma, and Thisse, 1992). We solve the optimiza-
tion problem of proﬁt-maximizing voucher schools under realistic constraints. To simplify the
model, we take the set of voucher schools as given and abstract from entry decisions. This is a
strong assumption, but our view is that including a detailed analysis of entry would add more
    6
      The qualitative conclusions of our empirical analyses turn out not to be much aﬀected by this restriction.
    7
      The summary statistics in Table 1, discussed in more detail below, indicate that the students attending private
unsubsidized schools are from markedly richer households than those in voucher or public schools; for instance, the
average household income at the 10th percentile of the income distribution in unsubsidized schools is greater than
the average household income at the 90th percentile of the income distribution in voucher schools.
    8
      Indeed, in the context of our model, it is a puzzle that many unsubsidized schools refuse to accept vouchers.
Essentially all these schools have class sizes below 45, and while we do not have reliable data on their tuition,
it appears that many of them also charge average fees well below the maximum allowed for voucher schools.
Anecdotally, it appears that an important reason for why these schools do not accept vouchers is that exclusivity is
part of their appeal. This appears to be related to peer eﬀects and considerations of social status that are diﬃcult
to model tractably.
    9
      As discussed below, we focus primarily on 4th grade observations because our testing data are at that grade
level. The results for other grades, however, are quite similar.
   10
      The administrative data do not allow us to discern how often this happened speciﬁcally at the 4th grade level,
the one we focus on below. They simply report that the school did this for some combination of grades.


                                                         5
tedious complication than real insight. Under the assumption that each school thinks of itself
as small relative to the market as a whole, the extent of entry would not aﬀect the optimizing
decisions of particular schools, and our two main implications would continue to hold. It is worth
emphasizing that our two main implications do not hold for all possible parameter values in our
model. Rather, we show that there exists a set of parameter values for which the implications do
hold and in Section 4 we examine whether there is empirical support for them.


3.1       Demand

There is a continuum of households of mass M , heterogeneous in income. Each is assumed to
have one child and to enroll the child in a school. The parameter λ, discussed in more detail
below, indexes schools. Let x(λ), n(λ) and p(λ) represent the enrollment, number of classrooms
and tuition of school λ. We assume that school quality is observed by households and depends
on enrollment, the number of classrooms, and λ in a manner to be made clear below. Households
are assumed to have the following indirect utility function:

                                                                
                       U p(λ), q x(λ), n(λ), λ ; θ = θq x(λ), n(λ), λ − p(λ) + ε                                                 (1)

                    
where q x(λ), n(λ), λ is school quality and ε is a random term capturing the utility of a particular
household-school match. This speciﬁcation follows from a direct utility function in which house-
holds have identical utility functions and diﬀer only in income.11 The parameter θ represents
households’ willingness to pay for quality, and is a monotonically increasing function of household
income. We assume that θ has a distribution g(θ) with positive support over (θ, θ) where θ, θ > 0;
this distribution reﬂects the underlying distribution of income among households. We assume
the random-utility term ε is i.i.d. across households with a double-exponential distribution with
                                 
c.d.f. F (ε) = exp − exp − µε + χ ,12 where µ is a positive constant that captures the degree of
  11
       Suppose:
                                                e (z, q) = u(z) + q + εe
                                                U
where z is a non-diﬀerentiated numeraire good, q is the quality of education, εe is a mean-zero random term, and
the sub-utility function u(·) has u (·) > 0 and u (·) < 0. If households are on their budget constraint, then indirect
utility is:
                                              e (p, q ; y) = u (y − p) + q + εe
                                              U
                                                                                          e          u(y)
Taking a ﬁrst-order approximation of u(·) around y, and setting θ ≡ 1/u (y) , U ≡       U
                                                                                        u (y)
                                                                                                 −   u (y)
                                                                                                            ,   and ε ≡     εe
                                                                                                                          u (y)
                                                                                                                                 ,   we
                         u(y)
have (1). Note that the    term is constant across schools and does not aﬀect the household’s choice probabilities.
                         u (y)
  12
     We assume χ = 0.5772 (Euler’s constant), ensuring that the expectation of ε is zero.



                                                           6
diﬀerentiation between schools.13
       A standard derivation yields the probability that a household chooses school λ, conditional
on having willingness to pay for quality θ and on the qualities and prices of all schools:14
                                                                                         
                                                 1                θq x(λ), n(λ), λ − p(λ)
                       s λ| θ, q(·), p(·) =            exp                                               (2)
                                                  Ω(θ)                         µ

where                                                                      
                                    λ             θq x(λ̃), n(λ̃), λ̃ − p(λ̃)
                          Ω(θ) ≡        exp                                     f (λ̃) dλ̃
                                   λ                          µ

We assume that schools cannot discriminate among households, and hence that price and quality
are equal for all households in a given school. As is common in monopolistic-competition models,
we will treat individual schools as small relative to the market as a whole, and assume that they
ignore their eﬀect on the aggregate Ω(θ).
       The expected market share of school λ, integrating over all households, is:

                                                      θ                             
                  s q x(λ), n(λ), λ , p(λ) =                  s λ|θ, q x(λ), n(λ), λ , p(λ) g(θ)dθ       (3)
                                                      θ


Expected demand for school λ is then:

                                                                      
                        d q x(λ), n(λ), λ , p(λ) = M s q x(λ), n(λ), λ , p(λ)                            (4)


The key implications of this demand speciﬁcation are that demand for school λ is declining in
price and increasing in quality, and that higher-θ households are more sensitive to quality for
a given price. Note that the speciﬁcation combines horizontal diﬀerentiation, in the sense that
if all schools’ tuitions are equal each will face positive demand with positive probability, with
vertical diﬀerentiation, in the sense that if tuitions are equal, higher-quality schools will face
higher demand. Throughout we will assume schools are risk-neutral, and ignore the fact that the
expression for d(·) represents an expectation.
       It will be convenient to deﬁne the expected willingness to pay of households that send their
  13
     As µ → 0, the distribution of household-school-speciﬁc utility terms collapses to a point, and the model
approaches perfect competition.
  14
     See for example Anderson, de Palma, and Thisse (1992, theorem 2.2, p. 39).




                                                               7
children to school λ:

                                                               
             Θ q x(λ), n(λ); λ , p(λ)  ≡ E θ q x(λ), n(λ); λ , p(λ)
                                                ⎡                                 ⎤
                                            θ     s λ| θ, q x(λ), n(λ), λ , p(λ) g(θ)
                                       =      θ ⎣                                 ⎦ dθ                     (5)
                                          θ           s q x(λ), n(λ), λ , p(λ)

where by Bayes’ rule the term in brackets represents the probability density of θ conditional on
households sending their children to school λ.


3.2      Production

We now think of λ as an exogenously ﬁxed productivity parameter in which schools are hetero-
geneous. It can be interpreted as the ability of the school principal/entrepreneur.15 We assume
that there is a continuum of schools with continuous density f (λ) over the interval [λ, λ). Each
school is uniquely identiﬁed by its value of λ, which justiﬁes our use of λ as an index above.
       Each school is constrained to oﬀer just one “product,” and is assumed to produce quality with
a technology:                                                           
                                                                    T
                                           q(x, n; λ) = λ ln                                                   (6)
                                                                   x/n

where x is enrollment, n is the number of classrooms, the denominator is class size, and T is a
constant that represents the technological maximum of class size. The term in parentheses is by
assumption always greater than or equal to one. This speciﬁcation captures the idea that the
larger is class size the less teacher attention is available for each individual student.16 Note that
a given reduction in class size raises quality more at higher-λ schools. This complementarity will
be crucial in what follows.
       In order to guarantee an interior solution for the school’s optimization problem we must impose
a lower bound on the degree of diﬀerentiation between schools. The condition:


                                                     µ > λθ                                                    (7)
  15
     In a more complex, dynamic model, one might think of λ as reputation. The important point is that it aﬀects
households’ perceptions of quality and is unaﬀected by schools’ decisions in the short run.
  16
     An interesting extension might be to include an endogenous term in the numerator representing teacher quality,
an additional choice variable for schools. We leave this task for future work, in part because we do not have data
on teacher salaries or other teacher characteristics.




                                                        8
will be suﬃcient. Intuitively, this limits the extent to which demand for a school increases with
a given class-size reduction.
   We suppose that there is a ﬁxed cost Fs of running a school, a ﬁxed cost Fc of operating a
classroom, and a constant variable cost c for each student. Recall that p is tuition, and let τ be
the per-student subsidy that schools receive from the government. Proﬁt is then:


                                π(p, n, x; λ) = (p + τ − c) x − nFc − Fs                       (8)


There is assumed to be no cost of diﬀerentiation; hence every school diﬀerentiates its “product”
and has a monopoly over the product it oﬀers.


3.3   Schools’ Optimization Problem

The problem facing schools is to maximize proﬁt over the choice of tuition, enrollment, and the
number of classrooms:
                                           max π(p, x, n; λ)                                   (9)
                                           p,x,n

This optimization is subject to three constraints:

  1. The number of classrooms must be a positive integer


                                                    n∈                                      (10)


      where    is the set of natural numbers {1, 2, 3, ...}.
  2. Class size cannot exceed the class-size cap:

                                                    x
                                                      ≤ 45                                   (11)
                                                    n


  3. Enrollment cannot exceed demand:


                                             x ≤ d(q(x, n; λ), p)                            (12)


      where q(·) is given by (6) and d(·) by (4).



                                                    9
Although the ﬁrst two constraints are designed to mimic the institutional environment in Chile,
they are likely to apply more generally. It is common in many countries for primary schools to
have a relatively small number of classrooms per grade and to be subject to class-size caps. The
third constraint clearly applies to all schools.17


3.4    Characterization of Equilibrium

The integer restriction complicates the solution of schools’ optimization problems, since we cannot
simply solve a set of ﬁrst-order conditions. A common approach to such problems is to ﬁrst relax
this constraint, then compare solutions with and without the relaxation. This is how we proceed
below. In the main text, we report key results; derivations of those results appear in Appendix
A, with section numbers corresponding to the cases.


Case 1: Divisible Classrooms

If the integer constraint (10) is relaxed, it turns out that in equilibrium there is a critical value of
the entrepreneurial-ability parameter, call it α, to the right of which the class-size cap does not
bind and to the left of which it does bind. Consider each of these sub-cases in turn.


Sub-Case 1.1: Class-Size Cap Non-Binding
If λ > α and the cap does not bind, then in equilibrium schools’ optimal choices are deﬁned
implicitly by the following:

                                                                           
                          p∗ (λ) = µ + c − τ + λΘ q x∗ (λ), n∗ (λ); λ , p∗ (λ)                                 (13a)
                                                              
                          x∗ (λ) = d q x∗ (λ), n∗ (λ); λ , p∗ (λ)                                              (13b)
                                    1                                   
                          n∗ (λ) =    λx∗ (λ)Θ q x∗ (λ), n∗ (λ); λ , p∗ (λ)                                    (13c)
                                   Fc

where Θ(·) is given by (5), d(·) is given by (4), and the asterisks indicate equilibrium values. In
order for the second-order conditions for a maximum to be satisﬁed, it must be the case that:

                                                               λσ 2
                                                                     θ|λ
                               Ψ ≡ Θ q x∗ (λ), n∗ (λ); λ , p∗ (λ) −      >0                                      (14)
                                                                    µ
  17
    The third constraint ends up binding in every case we present here, and we could treat it as an equality
constraint or substitute d(·) for x in (8) and (9). But there exist realistic cases in which it would not bind—i.e. if
there were a tuition constraint. For conceptual clarity, we leave the constraint as an inequality.


                                                         10
       2 is the variance of θ among households with children attending school λ in equilibrium.18
where σθ|λ
Assumption (7) guarantees that this condition holds. (See Appendix A.1.1.) Unfortunately,
there is no explicit analytical solution to (13a)-(13c). Nonetheless, using the implicit function
theorem, we can sign the relationship between the various endogenous variables and the underlying
productivity parameter, λ. In particular:

                                                                ∂p∗
                                                                    >0                                                  (16a)
                                                                ∂λ
                                                                ∂x∗
                                                                    >0                                                  (16b)
                                                                ∂λ
                                                                ∂n∗
                                                                    >0                                                  (16c)
                                                                ∂λ
                                                                ∂Θ∗
                                                                    >0                                                  (16d)
                                                                 ∂λ 
                                                                 ∂ x∗
                                                                       <0                                               (16e)
                                                                ∂λ n∗

where Θ∗ is shorthand for the equilibrium value of Θ(·) for a given λ. In equilibrium, higher-λ
schools charge higher tuition, have larger enrollments, operate more classrooms, have smaller class
sizes, and attract students whose families are on average wealthier and have higher willingness to
pay for quality. All of these relationships are monotonic in λ.
      In Figure 2, which plots class size vs. λ in the divisible-classrooms case, this sub-case corre-
sponds to the declining portion of the curve, to the right of the critical value α. Intuitively, the
fact that class size is declining in λ is a consequence of the fact that λ and class-size reductions
are complementary in the quality production function (6).


Sub-Case 1.2: Class-Size Cap Binding
If λ ≤ α and the class-size cap binds, then in equilibrium schools’ optimal choices are deﬁned
 18
      That is, deﬁne:
                                                                      2 “       `                 ´        ”     3
                      Z           „     “ `                        ”«2 s λ| θ, q x∗ (λ), n∗ (λ), λ , p∗ (λ) g(θ)
                              θ                           ´
              2
             σθ|λ ≡                         ∗      ∗          ∗
                                   θ − Θ q x (λ), n (λ); λ , p (λ)    4     “ `                   ´        ”     5 dθ    (15)
                          θ                                                s q x∗ (λ), n∗ (λ), λ , p∗ (λ)




                                                                    11
implicitly by:

                                                   Fc
                              p∗ (λ) = c − τ + µ +                                              (17a)
                                                 45              
                                                          
                              x (λ) = d q x (λ), n∗ (λ); λ , p∗ (λ)
                               ∗             ∗
                                                                                                (17b)
                                             x∗ (λ)
                              n∗ (λ) =                                                          (17c)
                                               45

The slopes with respect to λ in this sub-case are:

                                                ∂p∗
                                                    =0                                          (18a)
                                                ∂λ
                                                ∂x∗
                                                    >0                                          (18b)
                                                ∂λ
                                                ∂n∗
                                                    >0                                          (18c)
                                                ∂λ
                                                ∂Θ∗
                                                    >0                                          (18d)
                                                 ∂λ 
                                                 ∂ x∗
                                                       =0                                       (18e)
                                                ∂λ n∗

Although class size and price are constant, enrollment, the number of classrooms, and average
household income are increasing in the productivity parameter. Average household income is
increasing in λ because λ raises quality conditional on class size. It is notable that proﬁts are also
increasing in λ, even though price is constant, because enrollment is increasing in λ and schools
charge a mark-up over costs. In Figure 2, this sub-case corresponds to the portion of the curve
to the left of α where class size is ﬂat at 45.
   The critical value α is deﬁned implicitly by the equation

                                                               F
                                                                     c
                                  αΘ q x∗ (α), n∗ (α); α , p∗ (α) =                              (19)
                                                                    45

                                  x
This is the value of λ at which   n   = 45 in the ﬁrst sub-case above. Note that there is no guarantee
that α ∈ (λ, λ), i.e. that the class-size cap will be binding on any schools in the market. At the
critical value, the optimal choices p∗ , x∗ , and n∗ are equal in the two sub-cases (cap binding, cap
non binding). Hence over the entire range of λ we have that p∗ , x∗ , n∗ and Θ∗ are continuous; p∗
                                                                                                   x∗
is weakly monotonically increasing; x∗ , n∗ and Θ∗ are strictly monotonically increasing; and      n∗

is weakly monotonically decreasing.



                                                      12
Case 2: Indivisible Classrooms

Now add the restriction that the number of classrooms must be an integer (10). Our strategy
for dealing with the integer constraint is ﬁrst to characterize the optimal choices of schools for a
given number of classrooms, and then to characterize the sets of schools that choose each integer
number of classrooms.


Fixed Number of Classrooms

To begin, suppose that n is ﬁxed and think of it as a parameter. It will turn out that for a given
n there is a single critical value of λ, call it β(n), below which the class-size cap does not bind
and above which it binds. Again consider the two sub-cases in turn.


Sub-Case 2.1: Class-Size Cap Non-Binding
If λ ≤ β(n) and the class-size cap does not bind, then schools’ optimal choices are implicitly
deﬁned by:

                                                                          
                     p∗ (n, λ) = µ + c − τ + λΘ q x∗ (n, λ); n, λ , p∗ (n, λ)                 (20a)
                                                             
                     x∗ (n, λ) = d q x∗ (n, λ); n, λ , p∗ (n, λ)                              (20b)


Price and average willingness to pay (i.e. average household income) are unambiguously increasing
in λ:

                                           ∂p∗
                                               >0                                             (21a)
                                            ∂λ
                                           ∂Θ∗
                                               >0                                             (21b)
                                            ∂λ

   There is a subtlety in the relationship between enrollment and λ. On one hand, there is a
direct eﬀect of a higher λ on demand: for a given class size, households prefer higher-λ schools.
On the other hand, there is an indirect eﬀect: from (6), at higher values of λ a given increase
in enrollment has a larger negative eﬀect on quality and hence on demand. It is theoretically
possible in this case that the latter eﬀect dominates, making it optimal for higher-λ schools to
raise prices such that enrollment, conditional on a given number of classrooms, is decreasing in λ.
In that case, our testable implications (discussed in the introduction and in more detail below)


                                                13
do not hold. We focus instead on the case where enrollment is increasing in λ. A necessary and
suﬃcient condition for this, which we assume hereafter, is:19
                                                                                              
                                                                Θ q x∗ (n, λ); n, λ , p∗ (n, λ)
                                             nT
                                 ln                       >                                                              (22)
                                          x∗ (n, λ)                                       Ψ

where Ψ is deﬁned as in (14). Under this assumption, we have

                                                                    ∂x∗
                                                                        >0                                               (23)
                                                                    ∂λ

                                                 ∂
                                                       x∗ 
Since n is ﬁxed, (23) implies that               ∂λ       n        > 0; for a given number of classrooms, class size is
increasing in λ. That is, conditional on n, higher-λ schools are better able to ﬁll their classrooms.


Sub-Case 2.2: Class-Size Cap Binding
If λ > β(n) and the class-size cap binds, then we have two endogenous variables and two binding
constraints. The constraints pin down the values of p and x:


                                              p∗ (n, λ) = µ ln Σ − µ ln(45n)                                            (24a)

                                             x∗ (n, λ) = 45n                                                            (24b)


where                                                                              θλ
                                                              θ                      µ
                                                                   1          T
                                               Σ≡                                         g(θ)dθ                         (25)
                                                          θ       Ω(θ)        45

The slopes with respect to λ are:

                                                  ∂p∗
                                                                  > 0                                                   (26a)
                                                   ∂λ                                
                                                  ∂x∗                   ∂          x∗
                                                                  =                     =0                              (26b)
                                                   ∂λ                  ∂λ          n
                                                  ∂Θ∗
                                                                  > 0                                                   (26c)
                                                   ∂λ
  19
       If we replace the production function for quality (6) by a general function q(x, n; λ), then the condition is:
                                                            2
                                                                       !
                                                ∂2q        σθ|λ ∂q   1 ∂q
                                             −       <             +
                                               ∂x∂λ       µΘ∗ ∂x     x ∂λ

                                                                                                      ∂2q
which makes it clear that the indirect eﬀect of higher λ described above (represented by             ∂x∂λ
                                                                                                          )   must be small in
                                                       ∂q
magnitude relative to the direct eﬀect (represented by ∂λ ).



                                                                         14
    The critical value β(n) for a given n is deﬁned implicitly by the equation:

                                                   
               β(n) Θ q x∗ (β(n)); n, β(n) , p∗ (β(n)) = µ ln Σ − µ ln(45n) − c + τ − µ                 (27)


The critical value of λ is the point at which class size reaches 45 in sub-case 2.1. At this value,
the optimal choices p∗ and x∗ are the same in the two sub-cases. Hence for a given n, p∗ , x∗ , and
                                                                                                          x∗
Θ∗ are continuous at β(n), p∗ and Θ∗ are strictly monotonically increasing in λ, and x∗ and               n

are weakly monotonically increasing in λ.


Optimal Choice of Number of Classrooms

Now consider the issue of which integer number of classrooms schools choose. Let


                                      π̃(n, λ) ≡ π(p∗ (n, λ), x∗ (n, λ); n, λ)                          (28)


be school λ’s optimal proﬁt when the number of classrooms is ﬁxed at n, where p∗ (n, λ) and
x∗ (n, λ) are given by (20a)-(20b) for λ ≤ β(n) and (24a)-(24b) for λ > β(n). Deﬁne Λk to be the
set of all schools for which a given integer k is the optimal number of classrooms:


                                Λk = {λ : π̃(k, λ) ≥ π̃(j, λ) ∀ j = k, j ∈      }                     (29)


The following lemma characterizes the sets Λk :

Lemma 1. There exist unique positive integers k and k and a unique set of critical values
νk , νk+1 , ...νk−1 , νk such that:


                            Λk = {λ : νk−1 ≤ λ < νk } for k = k, k + 1, ..., k


where λ = νk−1 < νk < ... < νk−1 < νk = λ.

The proof is in Appendix A.2.3. The lemma indicates that the set of schools can be partitioned
into a set of intervals, [νk−1 , νk ), [νk , νk+1 ), [νk+1 , νk+2 ) etc., where the optimal integer number of
classrooms is k in the ﬁrst interval, k + 1 in the next, k + 2 in the next, and so on. Within each
of the subsets Λk the above results for ﬁxed n hold.



                                                        15
       Appendix A.2.4 shows that at the critical values νk , νk+1 , ..., νk−1 , enrollment is strictly in-
creasing, class size is weakly decreasing, and average willingness to pay is strictly increasing in
λ.20 The fact that average willingness to pay is strictly increasing at the critical values, and
that it is strictly increasing between the critical values (refer to (21b) and (26c)), means that in
equilibrium average willingness to pay Θ∗ is monotonically increasing in λ for all λ.
       Note that there is no guarantee that the value of λ at which the class-size cap starts to bind
for a given integer k, β(k), is to the left of the value of λ at which it becomes optimal to add an
additional classroom, νk . In the empirical part of the paper, we present evidence consistent with
the hypothesis that β(k) < νk for low values of k.
       Figure 3 plots class size against λ for the case where β(k) < νk for k = 1 and k = 2 but not
thereafter. The curve roughly resembles the curve for the divisible-classrooms case (Figure 2),
but with an overlaid saw-tooth pattern generated by the integer constraint. The ﬁgure exhibits
an approximately inverted-U relationship between class size and λ. It results from the interaction
of two eﬀects: (1) conditional on a value of n, class size is increasing in λ, since greater values of λ
make schools better able to ﬁll their classrooms; and (2) across values of n, class size is declining
in λ, since greater λ leads schools to increase the number of classrooms, reducing class size.
       The inverted-U relationship between class size and λ is not itself testable, because λ is un-
observed. But since Θ∗ is strictly increasing in λ for all λ, we would also expect an inverted-U
relationship in equilibrium between class size and Θ∗ . This gives us our ﬁrst testable implication:

Testable Implication 1 In equilibrium, there is an approximately inverted-U relationship be-
         tween class size and average household income.

       Figure 3 also illustrates that schools between β(1) and ν1 have enrollment 45 and schools
between β(2) and ν2 have enrollment 90. Intuitively, in these regions schools raise tuition rather
than incur the ﬁxed cost of starting a new classroom.21 Although we do not model the possibility
explicitly, one can easily imagine that in the presence of stochasticity in demand and menu costs of
changing tuition, schools might turn away potential students for the same reason.22 Since average
  20                                                                                                  ∂p
     The direction of the change in price at each critical value is ambiguous in this case. The slope ∂λ is greater when
the class-size cap binds than when it does not bind, since higher λ leads schools to raise prices to keep class-size
pegged at 45. Consequently, price may be greater to the left of νk than to the right.
  21
     Appendix A.2.2 shows that for a given number of classrooms, tuition (p) is more steeply sloped in λ in the
region where the class-size cap binds than in the region where the cap does not bind.
  22
     In Chile, private schools have wide latitude regarding student selection, and can turn away students for reasons
ranging from the desire to maintain a given class size, to the desire to maintain religious uniformity.


                                                          16
household income is monotonically increasing in λ, the stacking implies discontinuous changes in
average household income with respect to enrollment at enrollments of 45, 90, and so on.23 More
generally, we have our second testable implication:

Testable Implication 2 In equilibrium, schools may stack at enrollments that are multiples of
           45, implying discontinuous changes in average household income with respect to enrollment
           at those points.

         It is worth considering brieﬂy what our model predicts for private unsubsidized schools, the
elite private schools that do not accept vouchers and are not subject to the class-size cap. In the
context of the model, the results for unsubsidized schools would be similar to those for voucher
schools in the sub-cases where the class-size cap is not binding. That is, if we were to set the
value of the voucher to zero and suppose that β(k) > νk for all k, then the results in sub-cases
1.1 and 2.1 would carry over to unsubsidized schools. In this case, the ﬁgure analogous to Figure
3 would not have the ﬂat regions between β(1) and ν1 and between β(2) and ν2 .


4         Data

To examine our model’s implications, we draw on two sources of information. The ﬁrst is school-
level administrative information on grade-speciﬁc enrollments and the number of classrooms from
the Chilean Ministry of Education; we use these data to calculate average class sizes in each grade.
The second source of information is the SIMCE testing system,24 which tracks schools’ math and
language performance. SIMCE data are available at the school level since 1988. Since 1997, they
also exist at the individual level and include information on students’ household income, parental
schooling, and other characteristics from a parental questionnaire sent home with students.
         Depending on the year, the SIMCE tests 4th , 8th , or 10th graders. We focus on the 4th grade
because as indicated above, class size is best-deﬁned in early primary grades. We focus on the
2002 cross section because it is the most recent 4th grade testing round for which we have data.
    23
      Technically speaking, as long as the class-size cap is not binding to the right of the critical value, νk , the
model predicts a discontinuity in Θ∗ even in the absence of stacking. Average willingness to pay in equilibrium
is a smooth, monotonically increasing function of class size. (See the discussions leading up to (58c) and (63) in
Appendix A.2.4.) Class size jumps discontinuously at the critical values νk . Hence Θ∗ must also jump at νk . Our
view, however, is that the discontinuity due to stacking is the more empirically important one.
   24
      SIMCE, which stands for Sistema de Medición de la Calidad de la Educación (Educational Quality Measurement
System), is Chile’s standardized testing program.



                                                         17
We note, however, that the general conclusions we obtain emerge in other cross-sections we have
analyzed (for instance, the 1999 4th grade and the 2004 8th grade waves).
         Table 1 presents descriptive statistics for public schools, private voucher schools and public
unsubsidized schools. As noted in Section 2, the table indicates that private unsubsidized schools
serve a very diﬀerent demographic group than either the voucher or the public schools. Household
income and parents’ schooling are markedly higher in the unsubsidized schools. Students’ test
scores, unsurprisingly, are highly correlated with these measures of socioeconomic status.


5         Results

We now take our two testable implications to the data. We review each implication, discuss how
it relates to the existing literature, and present the empirical results.


5.1        Class Size and Income in Cross-Section: The Inverted U

The ﬁrst testable prediction is an inverted-U relationship between class size and average household
income. The upward-sloping portion reﬂects the fact that low-λ schools may have trouble ﬁlling
their existing classrooms to achieve the desired class size. The downward-sloping portion reﬂects
the fact that higher-λ schools ﬁnd it proﬁtable to restrict class size to appeal to richer households.
These mechanisms are consistent with anecdotal evidence from Chile, where there is a widespread
perception that many lower-quality voucher schools are small “mom and pop” operations that
struggle to ﬁll their classrooms. In contrast, voucher schools run by larger ﬁrms have suﬃcient
demand to operate multiple classrooms, and are generally perceived to be of higher quality.
         Panel A in Figure 4 plots class size against log average household income among urban voucher
schools. The central line plots ﬁtted values of a locally weighted regression of class size on
log income, and the outer lines plot point-wise conﬁdence intervals generated by a bootstrap
procedure.25 A clear inverted-U pattern is evident. Panel B produces a similar conclusion, using
mothers’ schooling rather than income on the x-axis. Average class size rises with mothers’
schooling up to about the point where the average mother is a high school graduate, and declines
thereafter.
    25
    Using a parametric regression with a ﬁfth-order polynomial produces very similar results, both for the condi-
tional mean and the conﬁdence intervals.




                                                       18
       A possible concern with these ﬁgures is that the inverted-U pattern may reﬂect the aggregation
of schools across regions, rather than cross-sectional patterns within markets. To examine this
possibility, Table 2 reports simple regressions of class size on polynomials in log income (Panel A)
and mother’s schooling (Panel B) among urban voucher schools. To facilitate interpretation, we
use second-order polynomials. Column 1 reports results without region dummies, and Columns 2
and 3 include dummies for 13 regions and 318 municipalities, respectively. The quadratic term is
uniformly negative and signiﬁcant, and not much aﬀected by the regional controls. That is, the
inverted-U pattern holds even within narrowly deﬁned urban markets.
       The inverted-U ﬁnding is relevant to the literature on the eﬀect of class size on student
achievement. In this literature, it is common to see cross-sectional estimates that are of the
“wrong” sign or essentially equal to zero. Since achievement tends to be strongly correlated with
household income and since income is often unobserved (or is observed with error), the inverted-
U pattern suggests that cross-sectional regressions are likely to understate the eﬀect of class size
reductions among lower-income voucher schools and to overstate it among higher-income ones.26
       Previous work has revealed positive correlations between class size and enrollment and between
enrollment and household socioeconomic status among public schools in Israel (Angrist and Lavy,
1999) and Bolivia (Urquiola, 2006),27 but to our knowledge our paper is the ﬁrst to provide either
a theoretical rationale or empirical evidence for a non-linear relationship between class size and
household income. We conjecture that the inverted-U pattern is likely to arise among private
primary schools in other countries.


5.2      Stacking at Multiples of Class-Size Cap

Our second testable implication is related to regression discontinuity (RD) designs that exploit the
discontinuous relationship between enrollment and class size induced by class-size caps.28 Figure
5 shows that the Chilean setting appears to be a promising one for an RD-based evaluation of
the eﬀect of class size. The solid line plots the relation between class size and enrollment that
  26
      Consistent with Figure 4, for instance, we ﬁnd that a cross-sectional bi-variate regression of test scores on class
size among all urban voucher schools results in an insigniﬁcant point estimate. If the sample is restricted to schools
with mean mothers’ schooling below 12 years of age, however, the coeﬃcient is positive and signiﬁcant. If it is
restricted to schools with a mean above 12, it is negative and signiﬁcant at the 10 percent level.
   27
      Mizala and Romaguera (2002) present evidence of a positive correlation between enrollment and household
socioeconomic status in Chile.
   28
      For overviews and history of the RD design, see Angrist and Krueger (1999), van der Klaauw (2002), and
Shadish, Cook, and Campbell (2002).



                                                           19
would be observed if schools mechanically expanded class size with enrollment until reaching the
class-size cap, i.e. if class size were determined by:

                                               x p                x
                                                       =          x−1                                           (30)
                                                n          int     45      +1

where the superscript p indicates this is the predicted level. This results in a “saw-tooth” pattern
in which class size increases one for one with enrollment until, at 46, a new class is added and
average class size falls to 23, with other discontinuities observed at 90, 135, etc. Using data for
urban voucher schools for 2002, the circles plot enrollment-cell means of class size. Aggregated to
the enrollment-cell level as in this ﬁgure, a regression of actual on predicted class size produces
an R2 greater than 0.9—a clear “ﬁrst stage”.29
       The idea behind RD designs, originally proposed by Thistlewaite and Campbell (1960), is that
discontinuities like those in Figure 5 can be used to identify the causal eﬀect of class size even if
enrollment is systematically related to factors that aﬀect students’ outcomes. Intuitively, if enroll-
ment is smoothly related to student characteristics and other factors that aﬀect achievement at
multiples of the class-size cap, then for example students in schools with enrollments of 45 provide
an adequate control group for those in schools with enrollments of 46. In such a case, diﬀerences
in students’ performance can be attributed to the very diﬀerent class sizes they experience.
       More formally, consider a standard RD model, assuming one class-size cut-oﬀ and a homoge-
neous eﬀect of class size on test scores (van der Klaauw, 2002):


                                          T Si = γ E(CSi |Xi ) + f (Xi ) + ui                                    (31a)
                                                        0 ) + k(Xi )
                                 E(CSi |Xi ) = η 1(Xi ≥ X                                                        (31b)


where i indexes schools, T Si is the average 4th -grade test score in school i, CSi is average 4th -
                                               0 is the value of the class-size cut-oﬀ (i.e. 45), f (·)
grade class size, Xi is 4th -grade enrollment, X
and k(·) are ﬂexible functions of enrollment, and E(εi |Xi ) = 0. In the present setting this model
corresponds to a “fuzzy” (as opposed to “sharp”) regression discontinuity design, since, as Figure
5 indicates, enrollment aﬀects but does not perfectly explain class size.
                                                                         0 and the mean of class size
       In the context of this model, if f (·) and k(·) are continuous at X
  29
    For visual clarity, Figure 5 excludes schools that declare 4th grade enrollments above 180 students (less than
two percent of all schools), thus focusing on only the ﬁrst three discontinuities in the enrollment/class size relation.



                                                            20
                                                           0 , then the class-size eﬀect, γ, is non-
conditional on enrollment, E(CSi |Xi ) is discontinuous at X
parametrically identiﬁed at the cut-oﬀ (Hahn, Todd, and van der Klaauw, 2001). Intuitively, in a
small enough neighborhood around the cut-oﬀ, f (·) and k(·) are constant and any discontinuity in
test scores can be attributed to the discontinuity in the conditional mean of class size. In practice,
one rarely has enough data in neighborhoods around the cut-oﬀ to estimate γ precisely. As Lee
and Card (forthcoming) point out, if Xi is discrete, as in our case, one cannot estimate the class-
size eﬀect non-parametrically even with an inﬁnite amount of data, and one must therefore choose
parametric speciﬁcations for f (·) and k(·). If these are speciﬁed correctly then they capture all
dependence of class size and test scores on enrollment away from the cut-oﬀ and the instrumental-
variable (IV) procedure corresponding to (31a)-(31b) will consistently estimate γ, eﬀectively using
only the discontinuity in E(CSi |Xi ). In our baseline speciﬁcations, we use four class-size cut-oﬀs,
rather than just one as in (31b), and piecewise linear splines (with “kinks” at the values of the
cut-oﬀs) for f (·) and k(·).30
    Table 3 reports the results of a standard RD analysis using school-level data from 2002.
Column (1) presents the ﬁrst-stage regression of class size on indicators for whether enrollment is
above the ﬁrst four cut-oﬀs, along with the piecewise linear spline for enrollment. The coeﬃcients
on the cut-oﬀ indicators are estimates of the average decline in class size at those breaks.31
Consistent with the visual evidence in Figure 5, the ﬁrst one suggests that class size drops by
about 17 students at the ﬁrst threshold. The declines at the ﬁrst three of the four cut-oﬀs are
statistically signiﬁcant, but become progressively smaller.32 In this speciﬁcation, all standard
errors are clustered by enrollment levels, as Lee and Card (forthcoming) suggest is appropriate
when the assignment variable (here enrollment) is discrete.
    There is prima-facie evidence that the standard RD strategy would generate signiﬁcant re-
sults. Figure 6 presents “raw” enrollment-cell means of math and language test scores, along with
the ﬁtted values of a locally weighted regression calculated within each enrollment segment. Par-
ticularly around the ﬁrst cut-oﬀ, which accounts for the greatest density of schools, the discrete
  30
     We return to the possibility of using higher order polynomials below. We note that the piecewise splines are
appropriate to the extent that equation (30) suggests that if the class size rule were strictly applied, the slope of
the relationship between class size and enrollment would be diﬀerent in each segment.
  31
     For the sake of space, Table 3 and all subsequent ones exclude the small number of schools that declare 4th
grade enrollments above 225 (less than one percent of all schools), thus focusing on only the ﬁrst four discontinuities
in the enrollment/class size relation.
  32
     Although we omit the results, adding controls for individuals’ characteristics has essentially no eﬀect on the
key coeﬃcients.



                                                          21
reduction in class size is accompanied by an increase in average test scores. This observation is
also borne out by the regression results. Columns 2-3 of Table 3 present reduced-form regressions
of average math and language scores, showing positive and signiﬁcant increases in scores at the
ﬁrst cut-oﬀ, and positive (although not signiﬁcant) increases at subsequent ones. Columns 4-5
report IV speciﬁcations, where dummy variables for the ﬁrst four cut-oﬀs are used as instruments
for class size. In both columns, class size appears to have a negative and signiﬁcant eﬀect on test
scores.
       Focusing more narrowly around the discontinuities as in van der Klaauw (2002), Columns 1-3
of Table 4 present IV results for bands of 5 students (panels A and C for math and language,
respectively) and 3 students (panels B and D) around the ﬁrst three breaks, omitting the piecewise
spline in enrollment.33 These are equivalent to simple Wald estimates of the eﬀect of class size
within the bands around each cut-oﬀ.34 Column 4 produces similar estimates pooling all three
local samples.35 In these pooled samples, the point estimates of the eﬀect of class size on test
scores are uniformly negative, although not statistically signiﬁcant.36
       One might be tempted to interpret Tables 3 and 4 as producing consistent estimates of the
causal eﬀect of class size on achievement. If the second testable implication of our model is correct,
however, then the smoothness conditions required for valid RD-based inference are likely to be
violated. Recall that the theoretical model predicts a non-negligible mass of schools stacking at
enrollments of 45; in Figure 3, for instance, all schools with productivity parameters between β(1)
and ν1 have enrollment 45, and all those between β(2) and ν2 have enrollment 90. Panel A of
Figure 7 presents a histogram of 4th grade enrollments among urban voucher schools, and the
evidence of such stacking is clear: more than 5 times as many schools report enrollments of 45 as
report enrollments of 46. The same happens at higher cut-oﬀs as well: more than 7 times as many
schools have 90 4th graders as have 91, for instance.37 Panel B shows that there is no evidence
of stacking among private unsubsidized schools, which are not subject to the class-size cap. It
appears that the stacking among voucher schools is not due to technological factors unrelated to
  33
     The somewhat erratic results in Column 2 are due to outliers close to the 90-student cut-oﬀ; when we replicate
the results using 1999 data, the point estimates and standard errors around the second cut-oﬀ are in line with those
around the other cut-oﬀs.
  34
     In other words, the point estimates could be replicated by dividing the diﬀerence in average test scores between
the schools above and below the cut-oﬀ within each band, by the diﬀerence in their respective average class sizes.
  35
     In this case dummies for whether enrollments are above the three cut-oﬀs, 1{x > 45}, 1{x > 90}, and 1{x >
135}, as well as three sample-speciﬁc intercepts serve as instruments; see van der Klaauw (2002).
  36
     Note that clustering by enrollment level, as suggested by Lee and Card (forthcoming), lowers signiﬁcance levels.
  37
     Similar stacking occurs if 1st or 8th grade data are used.


                                                         22
the cap. In short, Figure 7 provides a clear illustration of what McCrary (forthcoming) terms
manipulation of the running variable—enrollment in this case.
       Recall also that the model predicts that higher-income households on average sort into higher-λ
schools. If so, then the stacking will generate discontinuities in the relationship between enrollment
and student characteristics close to the cut-oﬀ points, violating the smoothness assumptions
underlying the RD approach. Again, Figure 3 illustrates the intuition: because of the stacking,
the average value of λ among schools at the cap is strictly less than the average value just above the
cap; since average household income is strictly monotonically increasing in λ (see the discussion
in Section 3.4 above), the stacking generates discontinuous changes in household income at the
class-size cut-oﬀs.   38


       Panel A of Figure 8 presents enrollment cell means of household income, along with the ﬁtted
values of a locally weighted regression calculated within each enrollment segment. There is visual
evidence that income changes discontinuously around the ﬁrst cut-oﬀ—schools just to the right
contain students who come from wealthier households. Panel B shows, not surprisingly, that they
also have students with higher average mothers’ schooling—as much as a full year. While jumps
at the subsequent cut-oﬀ points are less evident, the clear discontinuities at the ﬁrst one (which
provides the bulk of observations, as shown in Figure 7) are suﬃcient to cast doubt on the RD
approach in this context.
       Columns 1-3 of Table 5 present regressions of household characteristics on the piecewise linear
spline in enrollment and indicator variables for the class-size cut-oﬀs. The results are consistent
with the visual evidence from Figure 8. In particular, they conﬁrm that mothers’ schooling,
fathers’ schooling and income display substantial and statistically signiﬁcant jumps at the ﬁrst
enrollment cut-oﬀ; the coeﬃcients for subsequent cut-oﬀs are positive but not signiﬁcant. This is
further evidence that the continuity assumption on the function f (Xi ) in (31a)—which is presumed
to capture the eﬀect of all variables that vary with enrollment except class size—is violated.
       For another indication that something is amiss in the RD design, consider the sensitivity
of the estimates of the class-size eﬀect to the inclusion of socioeconomic controls. If the RD
approach were valid in this context, then including socioeconomic controls in (31a)-(31b) would
  38
    It is worth emphasizing that stacking alone may not violate the RD assumptions in our context. If student
performance depended only on class size and not directly on λ, and there were no sorting, then the students on one
side of the class-size cut-oﬀ would still serve as a valid control group for those on the other side. The violation of
the RD assumptions arises from the interaction of the stacking and the endogenous sorting of households.



                                                         23
have little eﬀect on the estimate of γ. If the conditional means of the controls with respect to
enrollment were continuous, then the component of each control that varied with enrollment would
be captured by k(Xi ) and f (Xi ), and the component that was orthogonal to enrollment would also
be orthogonal to the instrument. In fact, Columns 4-5 of Table 5 show that the IV estimates from
Columns 4-5 of Table 3 are sensitive to the inclusion of socioeconomic controls. The coeﬃcient
on class size for the math-score speciﬁcation drops in magnitude from -0.7 and signiﬁcant (Table
3, Column 4) to -0.1 and insigniﬁcant (Table 5, Column 4) with the inclusion of the controls.
For the language-score speciﬁcation, the drop is from -0.6 to -0.1. The coeﬃcients on mothers’
schooling and income are strongly signiﬁcant in the test-score regressions; fathers’ schooling is
signiﬁcant at the 10 percent level in the math-score speciﬁcation.39 This is clear evidence that
the exclusion restriction required for the IV estimates in Table 3 is invalid: the cut-oﬀ dummies
used as instruments are correlated with household characteristics that are omitted from the Table
3 speciﬁcation, and those characteristics are in turn correlated with the test-score outcomes.
    Finally, we explore to extent to which the observed discontinuities in the treatment and out-
come variables, and in other covariates, are robust to more ﬂexible speciﬁcations of k(Xi ) and
f (Xi ) in (31a)-(31b). While the literature has not produced a consensus on the correct speciﬁca-
tion of these functions,40 two practical guidelines for credible RD estimation seem uncontroversial.
First, there should not be evidence of discontinuities in relevant co-variates at the cut-oﬀs using
the same speciﬁcation of f (Xi ) used in the outcome equation (31a), as for instance we found in
Columns 1-3 of Table 5. Second, it is worrisome if the results, either for the estimates of γ or
for the absence of discontinuities in other co-variates, are not robust to the choice of functional
form. To investigate this, Table 6 presents reduced-form regressions analogous to those in columns
1-3 of Tables 3 and 5, using higher order speciﬁcations of the piecewise control function, as in
van der Klaauw (2002).41 Note that the ﬁrst stage (Panel A) is not robust to the addition of
more ﬂexible controls—the estimated declines in class size become small or even positive at some
cut-oﬀs. This is somewhat surprising given the apparent strength of the ﬁrst stage observed in
   39
      These results are qualitatively similar if we use the predicted class size in equation (30) as an instrument for
class size in place of the piecewise linear spline. Additionally, although we omit the exercise for the sake of space,
we note that the simple within-band IV results in Table 4 are similarly sensitive to the addition of controls for
socioeconomic status (results available from the authors).
   40
      In their very useful review of practical issues in implementing RD designs, for instance, Imbens and Lemieux
(forthcoming) do not make a speciﬁc recommendation.
   41
      For the sake of space we only report the coeﬃcients on the ﬁrst two cut-oﬀ indicators.




                                                         24
Figure 5.42 But more importantly for our story, note that the discontinuous jumps in test scores
and socioeconomic status (panels B-F) are robust and, if anything, grow stronger as one moves
to the right in the table. In short, Table 6 reaﬃrms that sorting across the cut-oﬀs appears too
strong to allow for reliable implementation of an RD approach.
       Lee and Card (forthcoming) propose an additional practical procedure to guide the choice of
polynomial for f (Xi ) in the outcome equation in a context such as ours in which the running
variable is discrete. The test is based on a goodness-of-ﬁt statistic for a “restricted” low-order
polynomial speciﬁcation relative to an “unrestricted” model with a dummy for each value of
the discrete running variable. This is not a deﬁnitive test—Lee and Card note that rejection of a
given polynomial does not necessarily imply that the corresponding estimate of γ is inconsistent—
but our conﬁdence in a chosen polynomial speciﬁcation increases if it cannot be rejected by this
Lee-Card test. For the outcome equation (31a) in our case, the test does not reject any of
the speciﬁcations in columns 1-4 of Table 6. This is consistent with the ﬁnding that adding
higher-order polynomial terms does not eliminate the discontinuities in the outcome variables
and co-variates in Panels B-F of Table 6.
       To summarize, our results provide a concrete illustration of Lee’s (forthcoming) observation
that “economic behavior can corrupt the RD design.” It is worth emphasizing that our results
apply to settings in which for-proﬁt schools can set prices and directly inﬂuence their enrollments,
and in which households enjoy substantial freedom to sort between schools; we have no reason to
believe that they extend to public-school contexts typically studied. For instance, Angrist and
Lavy (1999) point out that in the Israeli public school context they analyze, pupils are required
to attend their neighborhood schools, and schools in turn must accept applicants.43 Further,
migration and immigration may render it diﬃcult for schools to predict enrollments, and private
participation is limited to orthodox schools.44
  42
      We have veriﬁed that other years and grades of the administrative enrollment data produce similar results.
  43
      Similarly, in some exercises Urquiola (2006) considers Bolivian schools in rural towns in which school choice is
likely to be very limited.
   44
      The observation that Israeli institutions prevent strategic behavior of the kind we emphasize in this paper
is consistent with the ﬁnding of Angrist and Lavy (1999) that, controlling for secular enrollment eﬀects, adding
controls for the proportion of students with low socioeconomic backgrounds does not aﬀect their key estimates. For
an alternative approach to checking for discontinuities in co-variates at discontinuities, see McEwan and Shapiro
(forthcoming).




                                                         25
6         Conclusion

The model developed in this paper oﬀers an explanation for two distinct empirical patterns ob-
served in the Chilean data. First, there is an inverted-U cross-sectional relationship between class
size and household income, which is likely to bias non-experimental estimates of the eﬀect of
class size. Second, schools’ enrollments tend to stack at multiples of the class-size cap, which, in
conjunction with the sorting of households into schools of diﬀerent quality, generates discontinu-
ities in household characteristics at these points. These in turn violate the assumptions required
for regression-discontinuity analyses of class size. The fact that a single, relatively parsimonious
model can account for these two distinct phenomena suggests that it is a useful way to organize our
thinking about class size and sorting in liberalized education markets. Our ﬁndings recommend
caution in interpreting cross-sectional and RD estimates of the eﬀect of class size in such settings,
and underline the value of randomized experiments to estimate class-size eﬀects in contexts where
schools are free to set prices and/or turn away students, and households are free to sort between
schools.45
         Our results also recommend caution more broadly in the application and interpretation of RD
designs. It has become increasingly common to use discontinuities in the application of regulations
to estimate causal eﬀects of those regulations. But in contexts where economic agents interact
freely in markets, such discontinuities are likely to generate discontinuities along more than one
dimension, undermining the RD approach. This general observation has been made before, by
Lee (forthcoming) and others. This paper has sought to provide a concrete illustration of such
behavior, in a setting with heterogeneity and sorting on two sides of an important market.




References
Altonji, J. G., C. Huang, and C. R. Taber (2005): “Estimating the Cream Skimming Eﬀect of
  Private School Vouchers on Public School Students,” Unpub. paper, Northwestern University.
Anderson, S., and A. de Palma (2001): “Product Diversity in Asymmetric Oligopoly: Is the Quality
 of Consumer Goods Too Low?,” Journal of Industrial Economics, 49(2), 113–135.
Anderson, S., A. de Palma, and J.-F. Thisse (1992): Discrete-Choice Theory of Product Diﬀerenti-
 ation. MIT Press, Cambridge, MA.
    45
    Banerjee, Cole, Duﬂo, and Linden (forthcoming) present randomized evaluations of two programs to increase
teacher attention per student in India.




                                                     26
Angrist, J., and A. Krueger (1999): “Empirical Strategies in Labor Economics,” in Handbook of Labor
 Economics, ed. by O. Ashenfelter, and D. Card, vol. 3A. Elsevier Science.
Angrist, J. D., and V. Lavy (1999): “Using Maimonides’ Rule to Estimate the Eﬀect of Class Size on
 Scholastic Achievement,” Quarterly Journal of Economics, 114(2), 533–575.
Asadullah, M. N. (2005): “The Eﬀect of Class Size on Student Achievement:               Evidence from
  Bangladesh,” Applied Economics Letters, 12(4), 217 – 221.
Banerjee, A., S. Cole, E. Duflo, and L. Linden (forthcoming): “Remedying Education: Evidence
  from Two Randomized Experiments in India,” Forthcoming in Quarterly Journal of Economics.
Bartle, R. G. (1976): The Elements of Real Analysis. John Wiley & Sons, New York, 2nd edition edn.
Bayer, P., R. McMillan, and K. Rueben (2004): “An Equilibrium Model of Sorting in an Urban
  Housing Market,” NBER Working Paper # 10865.
Bressoux, P., F. Kramarz, and C. Prost (2005): “Teachers’ Training, Class Size and Students’
  Outcomes: Evidence from Third Grade Classes in France,” Unpub. paper, CREST.
Browning, M., and E. Heinesen (2003): “Class Size, Teacher Hours and Educational Attainment,”
  Centre for Applied Microeconometrics Working Paper 2003-15, Institute of Economics, University of
  Copenhagen.
Caucutt, E. M. (2002): “Educational Vouchers When There are Peer Group Eﬀects: Size Matters,”
  International Economic Review, 43(1), 195 – 222.
Clotfelter, C. T. (1999): “Public School Segregation in Metropolitan Areas,” Land Economics, 75(4),
  487–504.
Dixit, A. K. (1976): Optimization in Economic Theory. Oxford University Press, Oxford, UK.
Dobbelsteen, S., J. Levin, and H. Oosterbeek (2002): “The Causal Eﬀect of Class Size on Scholastic
 Achievement: Distinguishing the Pure Class Size Eﬀect from the Eﬀect of Changes in Class Composi-
 tion,” Oxford Bulletin of Economics and Statistics, 64(1), 17–38.
Elacqua, G. (2005): “How Do For-Proﬁt Schools Respond to Voucher Funding? Evidence from Chile,”
  Occasional Paper, National Center for Study of Privatization in Education, Teachers College, Columbia
  University.
Epple, D., D. Figlio, and R. Romano (2002): “Competition Between Private and Public Schools:
  Testing Stratiﬁcation and Pricing Predictions,” Unpub. paper, University of Florida.
Epple, D., and R. Romano (1998): “Competition Between Private and Public Schools, Vouchers, and
  Peer Group Eﬀects,” American Economic Review, 88(1), 33–62.
        (2002): “Education Vouchers and Cream Skimming,” NBER Working Paper #9354.
Epple, D., R. Romano, and H. Sieg (2006): “Admission, Tuition, and Financial Aid Policies in the
  Market for Higher Education,” Econometrica, 74(4), 885 – 928.
Ferreyra, M. M. (2007): “Estimating the Eﬀects of Private School Vouchers in Multi-District
  Economies,” American Economic Review, 97(3), 789–817.
Gabszewicz, J. J., and J.-F. Thisse (1979): “Price Competition, Quality, and Income Disparities,”
 Journal of Economic Theory, 20, 340–359.
Hahn, J., P. Todd, and W. van der Klaauw (2001): “Identiﬁcation and Estimation of Treatment
 Eﬀects with a Regression-Discontinuity Design,” Econometrica, 69(1), 201–209.
Hanushek, E. A. (1995): “Interpreting Recent Research on Schooling in Developing Countries,” World
 Bank Research Observer, 10, 227–246.
        (2003): “The Failure of Input-Based Schooling Policies,” Economic Journal, 113(485), F64–F98.



                                                  27
Hoxby, C. M. (2000): “The Eﬀects of Class Size on Student Achievement: New Evidence from Population
 Variation,” Quarterly Journal of Economics, 115(4), 1239–1285.
Hsieh, C.-T., and M. Urquiola (2006): “The Eﬀects of Generalized School Choice on Achievement
  and Stratiﬁcation: Evidence from Chile’s School Voucher Program,” Journal of Public Economics, 90,
  1477–1503.
Imbens, G., and T. Lemieux (forthcoming): “Regression Discontinuity Designs: A Guide to Practice,”
  Forthcoming in Journal of Econometrics.
Jakubowski, M., and P. Sakowski (2005): “Quasi-Experimental Estimates of Class Size Eﬀect in
  Primary Schools in Poland,” Unpub. paper, Warsaw University, Faculty of Economics.
Kremer, M. R. (1995): “Research on Schooling: What We Know and What We Don’t: A Comment,”
 World Bank Research Observer, 10(2), 247–254.
Krueger, A. B. (2003): “Economic Considerations and Class Size,” Economic Journal, 113(485), F34–63.
Lazear, E. P. (2001): “Educational Production,” Quarterly Journal of Economics, 116(3), 777–803.
Lee, D. S. (forthcoming): “Randomized Experiments from Non-Random Selection in U.S. House Elec-
  tions,” Forthcoming in Journal of Econometrics.
Lee, D. S., and D. Card (forthcoming): “Regression Discontinuity Inference with Speciﬁcation Error,”
  Forthcoming in Journal of Econometrics.
Manski, C. (1992): “Educational Choice (Vouchers) and Social Mobility,” Economics of Education Review,
 11(4), 351–369.
McCrary, J. (forthcoming): “Manipulation of the Running Variable in the Regression Discontinuity
 Design: A Density Test,” Forthcoming in Journal of Econometrics.
McEwan, P., and J. Shapiro (forthcoming): “The Beneﬁts of Delayed Primary School Enrollment:
 Discontinuity Estimates Using Exact Birth Dates,” Forthcoming in Journal of Human Resources.
McFadden, D. (1974): “Conditional Logit Analysis of Qualitative Choice Behavior,” in Frontiers in
 Econometrics, ed. by P. Zarembka, pp. 105–142. Academic Press, New York.
Mizala, A., and P. Romaguera (2002): “Equity and Educational Performance,” Economı́a, 2(2), 219–
 262.
Mussa, M., and S. Rosen (1978): “Monopoly and Product Quality,” Journal of Economic Theory, 18,
 301–317, a.
Nechyba, T. J. (2003): “Centralization, Fiscal Federalism, and Private School Attendance,” International
  Economic Review, 44(1), 179–204.
Nesheim, L. (2002): “Equilibrium Sorting of Heterogeneous Consumers Across Locations: Theory and
  Empirical Implications,” CEMMAP Working Paper CWP08/02, University College London.
Piketty, T., and M. Valdenaire (2006): “L’Impact de la Taille des Classes sur la Réussite Scolaire
  Dans les Écoles, Collèges et Lycées Fran cais [The Impact of Class Size on Student Success in French
  Primary and Secondary Schools],” Les Dossiers, Ministère de l’Éducation Nationale, no. 173.
Rothstein, J. (2006): “Good Principals or Good Peers? Parental Valuation of School Characteristics,
  Tiebout Equilibrium, and the Eﬀects of Inter-District Competition,” American Economic Review, 96(4),
  1333–1350.
Shadish, W. R., T. D. Cook, and D. T. Campbell (2002): Experimental and Quasi-Experimental
  Designs for Generalized Causal Inference. Boston.
Shaked, A., and J. Sutton (1982): “Relaxing Price Competition through Product Diﬀerentiation,”
  Review of Economic Studies, 49, 3–13.
Thistlewaite, D., and D. Campbell (1960): “Regression Discontinuity Analysis: An Alternative to


                                                   28
  the Ex-Post Facto Experiment,” Journal of Educational Psychology, 51, 309–317.
Urquiola, M. (2005): “Does School Choice Lead to Sorting? Evidence from Tiebout Variation,” Ameri-
 can Economic Review, 95(4), 1310–1326.
         (2006): “Identifying Class Size Eﬀects in Developing Countries: Evidence from Rural Schools in
  Bolivia,” Review of Economics and Statistics, 88(1).
van der Klaauw, W. (2002): “Estimating the Eﬀect of Financial Aid Oﬀers on College Enrollment: A
  Regression Discontinuity Approach,” International Economic Review, 43(4), 1249–1287.
Verhoogen, E. A. (2007): “Trade, Quality Upgrading and Wage Inequality in the Mexican Manufactur-
 ing Sector,” CEPR discussion paper no. 6385, July.
Wössmann, L. (2005): “Educational Production in Europe,” Economic Policy, (43), 445 – 493.




                                                  29
A     Theory Appendix
In this appendix, to avoid clutter, we do not write explicitly the dependence of x, n and p on λ,
of q(·) on x, n and λ, or of d(·) and Θ(·) on p and q, but this dependence should be understood.
As above, asterisks indicate equilibrium values.

A.1     Case 1: Divisible Classrooms
To solve the school’s optimization problem in this case, form the Lagrangian from (9), where the
constraints are (12) and (11):
                                                                           x     
               L(p, x, n; λ) = (p − c + τ ) x − nFc − Fs − φ1 (x − d) − φ2    − 45          (32)
                                                                            n
The ﬁrst-order conditions are:
                                          
                ∂L                     d
                      = x + φ1       −         =0                                                (33a)
                ∂p                     µ
                ∂L                         θ
                                        ∂s(λ|θ, q, p)                   x
                      = −Fc + φ1                      M g(θ) dθ + φ2
                ∂n                   θ      ∂n                           n2
                                                  x
                                      λΘd
                      =   −Fc + φ1           + φ2         =0                                     (33b)
                                       µn             n2
                                                                               
                                                   θ
                ∂L                                   ∂s(λ|θ, q, p)               1
                      =   p − c + τ − φ1 1 −                       g(θ) dθ − φ2
                ∂x                               θ       ∂x                      n
                                                             
                                               λΘd              1
                      =   p − c + τ − φ1 1 +            − φ2         =0                          (33c)
                                                µx              n
                ∂L                          ∂L
                      ≥   0, φ1 ≥ 0, and φ1       =0                                             (33d)
                ∂φ1                         ∂φ1
                ∂L                          ∂L
                      ≥   0, φ2 ≥ 0, and φ2       =0                                             (33e)
                ∂φ2                         ∂φ2

where s(λ|θ, q, p) is given by (2). The interchanging of the partial derivatives and the integrals is
justiﬁed by a standard property of integrals (see e.g. Bartle (1976, Theorem 31.7, p. 245)) and
the continuity of s(λ|θ, q, p) and its partial derivatives.
                           ∂L
    Suppose φ1 = 0 and ∂φ    1
                               > 0, i.e. the demand constraint is not binding. Then (33a) implies
x = 0, and (33b) in turn implies Fc = 0, which is false. Hence if there is a solution it must be
      ∂L
that ∂φ 1
          = 0 and the demand constraint is binding: x = d. It follows from (33a) that φ1 = µ.
We then have two sub-cases.

A.1.1    Sub-Case 1.1: Class-Size Cap Non-Binding
                                                                ∂L                      x       Fc
In this sub-case, the class size cap is non-binding: φ2 = 0 and ∂φ 2
                                                                     ≥ 0. By (33b),     n   =   λΘ   and
 ∂L                    Fc
∂φ2 ≥ 0 implies λΘ ≥ 45 . Simple algebra then yields (13a)-(13c).




                                                    30
   To check the second-order conditions, form the bordered Hessian:
                                   ⎛                         ⎞
                                            ∂h     ∂h    ∂h
                                       0
                                   ⎜ ∂h ∂∂p  2
                                                   ∂n
                                                  ∂2L
                                                         ∂x
                                                        ∂2L ⎟
                                   ⎜ ∂p ∂pL2 ∂n∂p            ⎟
                              H≡⎜  ⎜ ∂h ∂ 2 L     ∂2L
                                                        ∂x∂p ⎟
                                                        ∂2L ⎟
                                   ⎝ ∂n ∂p∂n ∂n2 ∂x∂n ⎠
                                                           ∂h           ∂2L          ∂2L           ∂2L
                                                           ∂x           ∂p∂x         ∂n∂x          ∂x2

where h(p, n, x; λ) ≡ x − d. It is then straightforward (if tedious) to show that the last two leading
principal minors alternate in sign with the last one negative (and hence that the Hessian of L is
negative deﬁnite on the constraint set) if and only if (14) holds. Rewriting (14),

               θ                                                      θ                                              
                           s(λ| θ, q ∗ , p∗ )g(θ)                               λθ               s(λ| θ, q ∗ , p∗ )g(θ)              λΘ∗2
                   θ                                    dθ >                             θ                                    dθ −
           θ                    s(q ∗ , p∗ )                        θ           µ                     s(q ∗ , p∗ )                    µ

Under assumption (7), λθ µ < 1 for all values of λ and θ. Hence the left-hand-side term is greater
than the ﬁrst term on the right-hand side. Since the second term on the right-hand side is negative,
it follows that the solution to the ﬁrst-order conditions given is a local constrained maximum.
Moreover, the negative-deﬁniteness of L on the constraint set holds for all p, n and all x > 0,
hence the local maximum is a unique global maximum of the constrained optimization problem.
   Rewrite (13a)-(13c), together with (5), noting that φ = µ and x = d:

                                     G1 = p∗ − (µ + c − τ + λΘ∗ ) = 0                                                                       (34a)
                                                               θ
                                     G2 = x∗ −                     s(λ|θ, q ∗ , p∗ )M g(θ) dθ = 0                                           (34b)
                                                           θ
                                                               θ                                        
                                                    ∗   s(λ|θ, q ∗ , p∗ )g(θ)
                                     G3    ≡ Θ −     θ                                                       dθ = 0                         (34c)
                                                   θ        s(q ∗ , p∗ )
                                                   λΘ∗ x∗
                                     G4    = −Fc +        =0                                                                                (34d)
                                                     n∗
                                              ∗
It is convenient to deﬁne z ∗ = nx∗ (class size) and analyze (34a)-(34d) as a set of four equations
with four endogenous variables, p∗ , x∗ , Θ, and z ∗ , and one exogenous variable, λ. Let J be the
Jacobian:                              ⎛ ∂G1 ∂G1 ∂G1 ∂G1 ⎞
                                                           ∂p∗              ∂x∗      ∂z ∗         ∂Θ∗
                                                 ⎜         ∂G2              ∂G2      ∂G2          ∂G2    ⎟
                                                 ⎜         ∂p∗              ∂x∗      ∂z ∗         ∂Θ∗    ⎟
                                              J ≡⎜         ∂G3              ∂G3      ∂G3          ∂G3    ⎟
                                                 ⎝         ∂p∗              ∂x∗      ∂z ∗         ∂Θ∗    ⎠
                                                           ∂G4              ∂G4      ∂G4          ∂G4
                                                           ∂p∗              ∂x∗      ∂z ∗         ∂Θ∗

   By the implicit function theorem:
                                                  ⎛     ∂p∗    ⎞                         ⎛       ∂G1   ⎞
                                                         ∂λ                                       ∂λ
                                                  ⎜     ∂x∗    ⎟         ⎜                       ∂G2   ⎟
                                                  ⎜      ∂λ    ⎟ = −J −1 ⎜                        ∂λ   ⎟                                     (35)
                                                  ⎝     ∂z ∗   ⎠         ⎝                       ∂G3   ⎠
                                                         ∂λ                                       ∂λ
                                                        ∂Θ∗                                      ∂G4
                                                         ∂λ                                       ∂λ




                                                                             31
   It is straightforward to show that:
                                                           Ψ
                                              det J = −       <0                                            (36)
                                                           Θ∗
since Ψ > 0 (refer to (14)). Simplifying (35), we have:
                                        ⎛                                    ⎞
                           ⎛ ∂p∗ ⎞          Θ∗     ∗ + λ ln T σ 2
                                                 Θ                ∗
                               ∂λ∗      ⎜ Ψ          ∗ Θ∗
                                                         µ
                                                              Tz  θ|λ          ⎟
                           ⎜ ∂x ⎟ ⎜     ⎜          x
                                                          ln                     ⎟
                           ⎜ ∂λ∗ ⎟ = ⎜           µ   z∗                      ⎟
                           ⎝ ∂z ⎠ ⎜ − z ∗ λ ln T∗ σ 2 + Θ∗                       ⎟                          (37)
                               ∂λ
                                                                                 ⎟
                              ∂Θ∗       ⎝ λΨ ∗ µ2         z      θ|λ             ⎠
                                               Θ σθ|λ   T          
                               ∂λ                       ln         + 1
                                                µΨ           z ∗


at the optimum.
                          2
    In the deﬁnition of σθ|λ in (15), the fact that the double-exponential distribution yields a
non-zero probability that any given household will choose any given school implies that the term
in brackets is non-zero for all θ. Hence as long as θ = Θ∗ for some θ, which follows from the
assumption that θ has positive support over (θ, θ), we have:
                                                   2
                                                  σθ|λ >0                                                   (38)

The results (16a), (16b), (16d) and (16e) follow from (14), (37) and (38). Finally, we have:
                                       
                            ∂n∗     ∂ x∗         1 ∂x∗    x∗ ∂z ∗
                                 =            =        −           >0
                             ∂λ    ∂λ z ∗       z ∗ ∂λ    z ∗ 2 ∂λ

where the inequality follows from (16b) and (16e). This gives (16c).

A.1.2    Sub-Case 1.2: Class-Size Cap Binding
                                                                   ∂L                    x
In this sub-case, the class-size cap is binding: φ2 ≥ 0 and        ∂φ2   = 0 (that is,   n   = 45). By (33b) and
                                                φ2    F                                     F
the facts that x = d and φ1 = µ, we have      = n  − λΘ. The fact that φ2 ≥ 0 implies λΘ ≤ 45
                                                      45                                      .
Algebra yields (17a)-(17c).
   To verify the second-order conditions, the bordered Hessian is:
                                 ⎛              ∂h1    ∂h1   ∂h1
                                                                   ⎞
                                     0     0    ∂p     ∂n     ∂x
                                 ⎜ 0            ∂h2    ∂h2   ∂h2 ⎟
                                 ⎜         0                  ∂x ⎟
                                 ⎜ ∂h1 ∂h2 ∂∂p   2L
                                                       ∂n
                                                        2      2L ⎟
                            H≡⎜  ⎜ ∂p      ∂p   ∂p2
                                                      ∂
                                                      ∂n∂p
                                                          L  ∂
                                                            ∂x∂p ⎟
                                                                   ⎟                      (39)
                                 ⎜ ∂h1 ∂h2 ∂ 2 L      ∂2L    ∂2L ⎟
                                 ⎝ ∂n ∂n ∂p∂n ∂n2 ∂x∂n ⎠
                                        ∂h1     ∂h2   ∂2L     ∂2L        ∂2L
                                        ∂x      ∂x    ∂p∂x    ∂n∂x       ∂x2

where L is given in (32), h1 (p, n, x, λ) ≡ x − d and h2 (p, n, x, λ) ≡ nx − 45. It is straightforward to
                       x3
verify that det H = − µn 4 < 0 at the optimum, and hence that the second-order conditions for a
maximum are satisﬁed.




                                                      32
   To analyze the slopes with respect to λ in this sub-case, rewrite (17a)-(17c) with (5) as:
                                                       
                                  ∗                  Fc
                        G1 = p − c − τ + µ +              =0                                 (40a)
                                                     45
                                                θ
                          G2 = x∗ −                 s(λ|θ, q ∗ , p∗ )M g(θ) dθ = 0             (40b)
                                            θ
                                                θ                             
                                      ∗               s(λ|θ, q ∗ , p∗ )g(θ)
                          G3 ≡ Θ −                  θ                              dθ = 0         (40c)
                                            θ             s(q ∗ , p∗ )
                                           x∗
                          G4 = n∗ −                 =0                                         (40d)
                                           45
   Applying the implicit function theorem (as in (35)) to (40a)-(40d), we have:
                                 ⎛   ∂p∗   ⎞                            ⎛        ⎞
                                                                             0
                                      ∂λ                           
                                 ⎜   ∂x∗   ⎟ 1                 T        ⎜ x∗ Θ∗ ⎟
                                 ⎜    ∂λ   ⎟ = ln                       ⎜ x ∗ Θ∗ ⎟                 (41)
                                 ⎝   ∂n∗   ⎠ µ                 45       ⎝        ⎠
                                      ∂λ                                    45
                                     ∂Θ∗                                     2
                                                                          σθ|λ
                                      ∂λ

which in turn implies (18a)-(18e).
                     ∗
    The fact that ∂Θ                                           ∗
                   ∂λ > 0 in both sub-cases implies that λΘ is monotonically increasing in λ and
guarantees that there is at most one critical value of λ, call it α, at which (19) holds. The results
for the ﬁrst sub-case apply for λ ≥ α and the results for the second sub-case apply for λ < α.

A.2    Case 2: Indivisible Classrooms
The Lagrangian in this case is the same as (32), but n is now interpreted as a parameter:
                                                                         x     
             L(p, x; n, λ) = (p − c + τ ) x − nFc − Fs − φ1 (x − d) − φ2    − 45                   (42)
                                                                          n
The ﬁrst-order conditions are:
                                        
                        ∂L               d
                              = x − φ1       =0                                                   (43a)
                        ∂p               µ
                                                               
                        ∂L                          λΘd          1
                              = p − c + τ − φ1 1 +         − φ2     =0                         (43b)
                        ∂x                            µx         n
                       ∂L                         ∂L
                              ≥ 0, φ1 ≥ 0, and φ1      =0                                         (43c)
                       ∂φ1                        ∂φ1
                       ∂L                         ∂L
                              ≥ 0, φ2 ≥ 0, and φ2      =0                                      (43d)
                       ∂φ2                        ∂φ2
   We can quickly rule out the possibility that the demand constraint is not binding:
                                                                                 ∂L
  1. If neither the demand constraint nor the class-size cap is binding (φ1 = 0, ∂φ 1
                                                                                      ≥ 0, φ2 = 0
           ∂L
     and ∂φ2 ≥ 0) then by (43a), x = 0 and by (43b), p = c − τ . It is straightforward to verify
     that the second-order conditions are not satisﬁed in this sub-case.
                                                                                            ∂L
  2. If the demand constraint is not binding but the class-size cap is binding (φ1 = 0,     ∂φ1   ≥ 0,


                                                          33
                   ∂L
     φ2 ≥ 0 and ∂φ   2
                       = 0) then by (43a), we have x = 0. This violates the class-size constraint
     ( nx = 45); hence there is no solution in this case.

   There are then two sub-cases to be considered.

A.2.1   Sub-Case 2.1: Class-Size Cap Non-Binding
In this sub-case, the demand constraint is binding and the class-size cap is non-binding: φ1 ≥ 0,
 ∂L                ∂L
∂φ1 = 0, φ2 = 0, ∂φ2 ≥ 0. Equations (20a)-(20b) follow immediately from (43a)-(43b).
    The second-order conditions can be veriﬁed by evaluating the determinant of the bordered
Hessian (3x3 in this case). The determinant is positive, and the second-order conditions are
satisﬁed, if condition (14) is satisﬁed. This condition is guaranteed by (7). We again have that
the Hessian of the proﬁt function is negative deﬁnite on the constraint set, and hence that the
solution given by (20a)-(20b) is a global maximum.
    Rewrite (20a)-(20b), together with (5):

                          G1 = p∗ − [µ + c − τ + λΘ∗ ] = 0                                         (44a)
                                                       θ
                          G2 ≡ x∗ −                         s(λ|θ, q ∗ , p∗ )M g(θ) dθ = 0         (44b)
                                                   θ
                                                        θ                            
                                             ∗                s(λ|θ, q ∗ , p∗ )g(θ)
                          G3 ≡ Θ −                          θ                             dθ = 0   (44c)
                                                    θ             s(q ∗ , p∗ )

Note that these are the same as (34a)-(34c). (The number of classrooms is now treated as a
parameter, and we no longer have (34d).) Inverting the Jacobian (3x3 in this case) and using the
implicit function theorem (as in (35)) applied to (44a)-(44c), we have:
                                             ⎛            ∗2            2 ⎞
                     ⎛ ∂p∗ ⎞                    Θ∗ + λΘµ + µλ ln nT     x∗ σθ|λ
                         ∂λ∗                 ⎜                              ⎟
                     ⎝ ∂x ⎠ =           1    ⎜     x ∗
                                                         Ψ ln   nT
                                                                      −  Θ ∗    ⎟
                                             ⎜      µ           x ∗             ⎟           (45)
                         ∂λ∗
                        ∂Θ           1 +  λΨ ⎝
                                           µ
                                                    2    
                                                   σθ|λ λΘ∗            nT    ⎠
                         ∂λ
                                                    µ       µ + ln x∗

The results (21a),(21b) and (23) follow from (14), (22), (38), and (45).
                   ∂L
   The condition ∂φ  2
                       ≥ 0 requires:

                              θ                   θλ                           
                                   1         T      µ             c − τ + µ + λΘ∗
                  45n ≤                                     exp −                   M g(θ) dθ
                          θ       Ω(θ)       45                          µ

Taking the exponential term out of the integral and solving for λΘ∗ , we have:

                                   λΘ∗ ≤ µ ln Σ − µ ln(45n) − c + τ − µ

where Σ is deﬁned as in (25). Setting this inequality to an equality yields (27), which implicitly
deﬁnes β(n), the value of λ at which the class-size cap begins to bind.




                                                                  34
A.2.2    Sub-Case 2.2: Class-Size Cap Binding
                                                                                     ∂L
In this sub-case, both the demand constraint and class-size cap are binding: φ1 ≥ 0, ∂φ 1
                                                                                           = 0,
             ∂L
φ2 ≥ 0 and ∂φ2 = 0. The two constraints, x = d and x = 45n, pin down the values of p and x,
and the results (24a)-(24b) follow
                                   immediately.
                  ∂x∗    ∂    x
    The fact that ∂λ = ∂λ n = 0 follows immediately. It is straightforward to show that
                                                    
                                    ∂p∗               T
                                        = Θ∗ ln            >0                             (46a)
                                     ∂λ               45
                                                        
                                    ∂Θ∗      1 2         T
                                        =      σθ|λ ln      >0                            (46b)
                                     ∂λ      µ           45

   It remains to establish the set of schools over which the condition φ2 ≥ 0 is satisﬁed. The ﬁrst
order conditions imply:

                           φ2 = n {µ ln Σ − µ ln(45n) − c + τ − µ − λΘ∗ }                         (47)

By the deﬁnition of β(n) above, if λ = β(n) then φ2 = 0. Partially diﬀerentiating (47):
                                                               
                             ∂φ2            µ ∂Σ     ∂Θ∗      ∗
                                     = n         −λ       −Θ
                              ∂λ            Σ ∂λ      ∂λ
                                                         
                                                  T       ∗
                                     = n Ψ ln         −Θ >0
                                                  45

by assumption (22). Thus φ2 ≥ 0 for λ ≥ β(n). The ﬁrst sub-case applies for λ ≤ β(n) and the
second applies for λ > β(n).
    Finally, it follows from (45), (46a), and (22) that:

                                               ∂p∗          ∂p∗
                                       lim         < lim
                                     λ→β(n)−   ∂λ   λ→β(n)+ ∂λ

That is, the slope of p∗ with respect to λ is steeper to the right of the critical value, in the region
where the class-size cap binds.

A.2.3    Proof of Lemma 1
Our strategy for proof is to begin with a preliminary partition of the set of schools and show
that within each subset there are two possible optimal integer choices, and that there is a critical
value below which the lower integer is optimal and above which the higher integer is optimal.
These new critical values become the basis for the new partition described in the statement of
the lemma.

  1. For a given integer k, let δk be the value of λ at which the optimal number of classrooms
     in Case 1, the divisible-classrooms case, is k. That is, δk ≡ n∗ −1 (k) where n∗ (λ) is deﬁned
     by (13c) for λ ≥ α and by (17c) for λ < α. As noted above, n∗ (λ) is continuous and
     monotonically increasing in λ. This implies that δk > δk if k > k for any positive integers
     k, k . The values δk thus form an ordered partition the set of schools.



                                                  35
2. We now show that within the interval λ ∈ [δk , δk+1 ), the optimal integer number of class-
   rooms is either k or k + 1.
   (a) Deﬁne functions for proﬁts under the counterfactual assumptions that the class-size
       cap never binds and that it always binds. That is, let:

                                  π ∗ (n, λ) = π(p∗ (n, λ), x∗ (n, λ), n, λ)

       where p∗ (n, λ) and x∗ (n, λ) are given by (20a) and (20a), the optimal choices when the
       class-size cap does not bind. Let:

                                  π ∗∗ (n, λ) = π(p∗ (n, λ), x∗ (n, λ), n, λ)

       where p∗ (n, λ) and x∗ (n, λ) are given by (24b) and (24a), the optimal choices when the
       class-size cap binds. The deﬁnition of π̃(·) in (28) can then be restated:
                                             ∗
                                               π (n, λ) if λ ≤ β(n)
                                 (n, λ) =
                                 π                                                         (48)
                                               π ∗∗ (n, λ) if λ > β(n)

   (b) We now show that π ∗ (n, λ), π ∗∗ (n, λ) and hence π
                                                          (n, λ) are concave in n for any given
       λ:
         i. By the envelope theorem, we have:
                                                         ∂π ∗   ∂L
                                                              =                            (49)
                                                         ∂n     ∂n
                                                    ∗
            where L is given by (32) and ∂π
                                          ∂n allows p and x to vary (holding λ constant) but
            ∂L
            ∂n holds p, x and λ constant. Then by (33b):
                                                                          
                         ∂ 2 π∗    ∂       ∂L              ∂          λΘ∗ x∗
                              2
                                =                       =      −Fc +
                         ∂n       ∂n       ∂n             ∂n            n
                                                              ∗
                                                            λΘ x∗    λΘ ∂x∗ λx∗ ∂Θ∗
                                                                        ∗
                                                        = −       +           +            (50)
                                                             n2       n ∂n      n ∂n
            Applying the implicit function theorem (as in (35)) to (44a)-(44c),
                                                                     ⎛           ⎞
                                       ⎛    ∂p∗     ⎞                       2
                                                                         λσθ|λ
                                             ∂n               λ   ⎜        n     ⎟
                                       ⎝    ∂x∗     ⎠=            ⎜       x∗ Ψ   ⎟         (51)
                                             ∂n
                                            ∂Θ∗            µ + λΨ ⎝        n
                                                                           2
                                                                                 ⎠
                                                                          σθ|λ
                                             ∂n
                                                                           n

            Plugging into (50),
                                           ∂ 2π∗      λxΨ
                                               2
                                                 =−          <0
                                           ∂n      n2 1 + λΨ         µ

             Hence π ∗ (n, λ) is globally concave in n for all λ.
         ii. Combining (8), (24a) and (24b), and diﬀerentiating twice with respect to n, we
                         2 ∗∗
             have that ∂∂nπ2 = − 45µ                  ∗∗
                                     n < 0. Hence π (n, λ) is globally concave in n for all λ as
             well.

                                                    36
        iii. Implicitly diﬀerentiating (27) with respect to n, we have:

                                       ∂β(n)         µ
                                             =     T      >0                                (52)
                                        ∂n    n Ψ ln 45 − Θ

            for all n, where the inequality follows from (22). Hence there is a one-to-one
            mapping between β(n) and n for a given λ. β −1 (λ) is then the value of n at
            which the class-size cap starts to bind for a given λ. Note that the cap binds for
            n < β −1 (λ) and does not bind for n ≥ β −1 (λ). The deﬁnition of π̃(·) in (48) can
            then be rewritten:
                                             ∗
                                               π (n, λ) if n ≥ β −1 (λ)
                                  (n, λ) =
                                  π                                                        (53)
                                               π ∗∗ (n, λ) if n < β −1 (λ)

            The function π ∗ (n, λ) gives the maximized proﬁt for a given n and λ under one
            equality constraint, namely x = d. The function π ∗∗ (n, λ) gives the maximized
            proﬁt for a given n and λ under two equality constraints, namely x = d and
            x
            n = 45. For a given λ, the two points coincide at the point where the optimal
            class size is 45 even in the absence of the cap—that is, where n = β −1 (λ)—and
            for all other n the function π ∗∗ (n, λ) lies under π ∗ (n, λ). A standard result in
            optimization theory is that (if both functions are continuously diﬀerentiable) the
            two curves are tangent at that point (see e.g. Dixit (1976, Ch. 3)).
            Now consider the curvature of the π   (n, λ) function. For n < β −1 (λ), ∂eπ
                                                                                       ∂n is decreas-
            ing in n by the concavity of π ∗∗ (n, λ). For n ≥ β −1 (λ), ∂e
                                                                         π
                                                                        ∂n is decreasing in∗ n by the
                                                                                                ∂π ∗∗
            concavity of π ∗ (n, λ). At n = β −1 (λ) the two curves are tangent and ∂π    ∂n = ∂n .
            It follows that ∂eπ
                             ∂n is decreasing in n for all n and all λ. Hence π   (n, λ) is globally
            concave in n for all λ.
    (c) Recall the deﬁnition of n∗ (λ), the optimal number of classrooms in the divisible-
        classroom case, from step 1 of this proof. Since n∗ (λ) is monotonically increasing
        in λ, λ ∈ [δk , δk+1 ) implies n∗ (λ) ∈ [k, k + 1). From the concavity of π
                                                                                  (n, λ) it follows
        that:

                                      π         (k , λ) ∀ k < k
                                      (k, λ) > π                                               (54)
                                                               
                                  π             (k , λ) ∀ k > k + 1
                                  (k + 1, λ) > π                                               (55)

        That is, within the interval λ ∈ [δk , δk+1 ) either k or k + 1 must be the optimal integer
        number of classrooms.

3. We now show that in the interval λ ∈ [δk , δk+1 ) there is a critical value of λ to the left of
   which k is the optimal number of classrooms and to the right of which k + 1 is the optimal
   number. For λ ∈ [δk , δk+1 ), deﬁne:
                                    
                                    Π(λ) ≡π
                                          (k + 1, λ) − π
                                                        (k, λ)

   Since k is the unique optimal choice of number of classrooms at δk in the divisible-classrooms
   case,
                                 k) = π
                                Π(δ      (k + 1, δk ) − π
                                                         (k, δk ) < 0


                                               37
Similarly, since k + 1 is the unique optimal number of classrooms at δk+1 in the divisible-
classrooms case,
                            k+1 ) = π
                          Π(δ        (k + 1, δk+1 ) − π
                                                       (k, δk+1 ) > 0
From (52), we know that β(k) < β(k + 1); the class-size cap starts to bind at a higher value
                                                                  
of λ for n = k + 1 than for n = k. Using (48), the deﬁnition of Π(λ)   can be restated:
                      ⎧ ∗
                      ⎨ π (k + 1, λ) − π ∗ (k, λ)      if λ ≤ β(k)
               
               Π(λ) =     π ∗ (k + 1, λ) − π ∗∗ (k, λ) if β(k) < λ ≤ β(k + 1)
                      ⎩ ∗∗
                          π (k + 1, λ) − π ∗∗ (k, λ) if β(k + 1) < λ

Note that π ∗ (k, β(k)) = π ∗∗ (k, β(k)) and π ∗ (k + 1, β(k + 1)) = π ∗∗ (k + 1, β(k + 1)). Hence

Π(λ) is continuous. Now consider the slope of Π(λ)       against λ in each interval:

 (a) λ ≤ β(k). The class-size cap binds neither for n = k nor for n = k + 1.
                                                                    
                ∂ 2 π∗     ∂ ∂π ∗        ∂ ∂L          ∂          λx∗ Θ∗
                       =              =             =      −Fc +           >0
                ∂n∂λ      ∂λ ∂n         ∂λ ∂n         ∂λ             n

     where the second equality follows from (49), the third equality follows from (33b), and
     the inequality follows from (21b) and (23). Hence:

                                 
                                dΠ   ∂π ∗ (k + 1, λ) ∂π ∗ (k, λ)
                                   =                −            >0
                                dλ         ∂λ            ∂λ


(b) β(k) < λ ≤ β(k + 1). The class-size cap binds for n = k but not for n = k + 1. Note
    that                                                 
                               ∂π ∗    ∂L      ∗ ∗     nT
                                    =      = x Θ ln                                (56)
                                ∂λ     ∂λ              x∗
     where L is given by (42), and the ﬁrst equality follows by the envelope theorem. Sim-
     ilarly,                                               
                                 ∂π ∗∗   ∂L                 T
                                       =     = 45nΘ∗ ln                               (57)
                                  ∂λ     ∂λ                45
     At n = k, the optimal enrollment if there were no class-size cap would be greater than
     or equal to 45n; otherwise the cap would not be binding. Hence, comparing (56) and
     (57),
                                     ∂π ∗ (k, λ)   ∂π ∗∗ (k, λ)
                                                 ≥
                                         ∂λ            ∂λ
     Using step 3a above,

                              ∂π ∗ (k + 1, λ)   ∂π ∗ (k, λ)   ∂π ∗∗ (k, λ)
                                              >             ≥
                                     ∂λ             ∂λ            ∂λ
     Hence:
                                
                               dΠ   ∂π ∗ (k + 1, λ) ∂π ∗∗ (k, λ)
                                  =                −             >0
                               dλ          ∂λ           ∂λ
 (c) β(k + 1) < λ. The class-size cap binds for both n = k and n = k + 1. Partially


                                            38
              diﬀerentiating (57) and using (51),
                                                               
                                    ∂ ∂π ∗∗              T       ∂Θ
                                                = 45 ln      Θ+n      >0
                                   ∂n    ∂λ              45      ∂n

              Hence
                                              
                                             dΠ   ∂π ∗∗ (k + 1, λ) ∂π ∗∗ (k, λ)
                                                =                 −             >0
                                             dλ          ∂λ            ∂λ
              
        Thus Π(λ)   is continuous and monotonically increasing in λ for all λ ∈ [δk , δk+1 ). Together
        with the fact that it is negative at δk and positive at δk+1 , this implies that there is exactly
                                                   k ) = 0. For λ ∈ [δk , νk ), k is the optimal integer
        one critical value, call it νk , at which Π(ν
        number of classrooms; for λ ∈ [νk , δk+1 ), k + 1 is optimal.

   4. It remains to consider the regions at the extremes of the support of λ. Without loss of
      generality, let j be the largest integer such that δj ≤ λ,46 and let j be the smallest integer
      such that λ ≤ δj . Within each interval, [δj , δj+1 ), [δj+1 , δj+2 ), ..., [δj−1 , δj ), the results from
      steps 1-3 above hold. Truncate the interval (δj , δj ) at λ below and λ above. If νj ≤ λ, then
      let k = j + 1; else if λ < νj then let k = j. If νj−1 < λ, then let k = j; else if λ ≤ νj−1 , then
      let k = j − 1. Let νk−1 = λ and νk = λ. Then

                                                   νk−1 < νk < ... < νk

        form a partition of the set of voucher schools, with the optimal integer number of classrooms
        equal to k, k + 1, ..., k between consecutive values, and the lemma is proved.

A.2.4       Discontinuities at Critical Values
Consider a given νk from Lemma 1, where k < k < k. The fact that β(k + 1) > β(k) (from (52))
implies that it will never be the case that the class-size cap is non-binding to the left of the critical
value but binding to the right of it. There are then three cases to consider:

   1. The class-size cap is binding neither to the left nor to the right of the critical value: νk ≤
      β(k) < β(k + 1). In this case, limλ→ν − p∗ , limλ→ν − x∗ and limλ→ν − Θ∗ (the limits as λ
                                                 k           k                  k
      approaches νk from the left) are given by (20a), (20b), and (5) with n = k. limλ→ν + p∗ ,
                                                                                                  k
      limλ→ν + x∗ and limλ→ν + Θ∗ are given by the same expressions with n = k+1. The diﬀerences
              k                k
      in the left and right limits then have the same signs as the partial derivatives of the variables
                                                                ∗
                                                                       ∂x∗            ∂Θ∗
      with respect to n. By (51), we have immediately that ∂p  ∂n > 0, ∂n > 0, and ∂n > 0. Hence:

                                                      lim p∗ < lim p∗                                    (58a)
                                                     λ→νk−      λ→νk+

                                                      lim x∗ < lim x∗                                    (58b)
                                                     λ→νk−      λ→νk+

                                                      lim Θ∗ < lim Θ∗                                     (58c)
                                                     λ→νk−      λ→νk+

 46
      If λ < δ1 then let j = 0 and δ0 = 0.




                                                         39
  Moreover,
                                          
                              ∂       x∗                  1 ∂x∗  x∗
                                                =               − 2
                             ∂n       n                   n ∂n   n
                                                           ∗
                                                                     
                                                          x     λΨ
                                                =                   −1 <0
                                                          n2 µ + λΨ

  and hence:
                                                      x∗        x∗
                                               lim       > lim                                   (59)
                                           λ→νk−      n   λ→νk+ n


2. The class-size cap is binding to the left of the critical value but not to the right: β(k) <
   νk < β(k + 1). It is immediate that,

                                                x∗             x∗
                                       lim         = 45 > lim                                    (60)
                                       λ→νk−    n        λ→νk+ n

  Consider x∗ and Θ∗ in turn:
                                                                                             ∗
   (a) If there were no class-size cap, then for λ ∈ (β(k), νk ), we would have ∂x
                                                                                ∂λ > 0. In the
                                                                   ∂x∗
       presence of the class-size cap, for λ ∈ (β(k), νk ) we have ∂λ = 0. Hence


                                           lim x∗               < lim x∗
                                        λ→νk−                         λ→νk−
                                                          cap                       no cap

        If there were no class-size cap, then by (58b) we would have:


                                               lim x∗                   < lim x∗
                                           λ→νk−                             λ→νk+
                                                            no cap

        Hence:
                                                lim x∗                < lim x∗
                                               λ→νk−                        λ→νk+
                                                                cap
                  ∗
   (b) Let z ∗ = xn . Recalling the assumption that schools cannot price discriminate, the price
       term can be brought outside the integral in (5) and Θ∗ can then be written:
                                                     !θ      1
                                                                       T  θλ
                                                                            µ
                                                     θ    θ Ω(θ)       z∗        g(θ)dθ
                                       Θ∗ = !                       T  θλ                      (61)
                                              θ          1                µ
                                                      θ Ω(θ)          z∗         g(θ)dθ

        Note that Θ∗ depends only on class size and λ, not on price, or enrollment or the
        number of classrooms separately. Diﬀerentiating,
                                                ∂Θ∗    λ 2
                                                    = − σθ|λ <0                                  (62)
                                                 ∂z    µz




                                                      40
            Hence (60) implies:
                                                  lim Θ∗ < lim Θ∗                                (63)
                                              λ→νk−              λ→νk+

  3. If the class-size cap is binding both to the left and to the right of the critical value: β(k) <
     β(k + 1) ≤ νk . It is immediate that:

                                          lim z ∗ = lim z ∗ = 45                                 (64)
                                          λ→νk−          λ→νk+

     and:
                                  lim x∗ = 45k < 45(k + 1) = lim x∗
                                  λ→νk−                                  λ→νk+

     As (61) indicates, Θ∗ depends only on class size and λ. Hence (64) implies:

                                             lim Θ∗ = lim Θ∗
                                            λ→νk−          λ→νk+

               ∗
     Since ∂Θ                                                                               ∗
             ∂λ > 0 both to the left and to the right of νk (refer to (26c)), we have that Θ is
     strictly increasing in λ at νk .
     In this case, p∗ is given by (24a) both to the left and to the right of the critical value. Hence
     the jump in number of classrooms from k to k + 1 implies:

                                             lim p∗ > lim p∗
                                            λ→νk−          λ→νk+


To summarize, at νk , class size is either decreasing or constant in λ, and enrollment and average
willingness to pay are always increasing in λ. We have no unambiguous result for how price
changes with λ at νk .




                                                    41
                             Figure 1: Histograms of the number of 4th grades in urban schools, 2002


                             Panel A: All schools                                                       Panel B: Public schools




                                                                               20 0 40 0 60 0 80 0
          500 1000 1500
       Nu mbe r of schools




                                                                              Number of sch ools
                                                                                         0
                0




                             1      2    3    4       5      6        7   8                              1     2    3   4      5     6        7   8
                                        Num ber of 4 th grad es                                                    Number of 4th grades


                             Panel C: Voucher private schools                                           Panel D: Unsubsidiz ed priv ate schools




                                                                               50 10 0 15 0 20 0 25 0
        200 400 600 800
       Nu mbe r of schools




                                                                              Number of sch ools
                                                                                         0
                0




                              1    2     3    4       5      6        7   8                              1     2    3   4      5     6        7   8
                                        Num ber of 4 th grad es                                                    Number of 4th grades



Note: Based on 2002 administrative data for urban schools with positive 4th grade enrollments. The figures cover
only schools Chile’s Ministry of Education classifies as urban. For voucher schools, panel C excludes about 0.2
percent of schools which report having more than eight 4th grade classes.



                                                    Figure 2: Case 1— Divisible classrooms
      x/n




               45




                                                                  α                                                                       λ
      Figure 3: Case 2 — Indivisible classrooms
x/n




 45




                                                            λ
       β(1)   ν1      β (2)   ν2       ν3         ν4   ν5
     Figure 4: Class size and income/mothers’ schooling among urban private voucher schools, 2002

                                         Panel A: Log income




                               37
                               35   33
                         Class size
                            31 29
                               27
                               25




                                         11          11.5           12            12.5   13     13.5
                                                                         Log income




                                         Panel B: Mothers' schooling
                               37
                               35   33
                         Class size
                            31 29
                               27
                               25




                                               8               10              12        14       16
                                                                    Mothers' schooling



Note: Income and mothers’ schooling come from 2002 individual-level SIMCE data aggregated to the school level. Class
size is based on 2002 administrative information. In each panel, the lines plot fitted values, along with point-wise confidence
intervals, of locally weighted regressions (using Stata’s lowess command and a bandwidth of 0.2) of class size on log income
(Panel A) and mothers’ schooling (Panel B). The figures omit observations below and above the 1st and 99th percentile of
income or mothers’ schooling. Standard errors are based on a bootstrap procedure with 1,000 replications. We note that the
results are very similar if derived using regressions of class size on a 5th-order polynomial of the independent variables.
                                  Figure 5: 4th grade enrollment and class size in urban private voucher schools, 2002




                                                             50            40
                                               4t h grade class size (x/n)
                                                      20     10
                                                             0  30




                                                                                0   45            90                                135
                                                                                         4th grade enrollment

  Note: Based on administrative data for 2002. The solid line describes the relationship between enrollment and class
  size that would exist if the class size rule (equation 30 in the text) were applied mechanically. The circles plot actual
  enrollment cell means of 4th grade class size. Only data for schools with 4th grade enrollments below 180 are
  plotted; this excludes less than two percent of all schools.



                                      Figure 6: Test scores and enrollment in urban private voucher schools, 2002


                                Pan el A: Ma th                                                                             Pan el B: La nguage
                                                                                                  200 220 240 260 280 300
20 0 22 0 24 0 26 0 28 0 30 0




                                                                                                        Language score
          Math score




                                          45             90          135                                                             45           90           135
                                                4th-grade enrollment                                                                      4th-grade enrollment

  Note: Test scores come from 2002 individual-level SIMCE information aggregated to the school level, and
  enrollment is drawn from administrative data for the same year. The figures plot “raw” enrollment-cell means of
  test scores, along with the fitted values of a locally weighted regression calculated within each enrollment segment.
                             Figure 7: Histograms of 4th grade enrollment in urban private schools, 2002

                         Panel A: Voucher private
           80       60
  Number of schools
        40 20
           0




                         0              45            90           135           180           225
                                                     4th grade enrollment


                         Panel B: Unsubsidized private
           20       15
  Number of schools
        10 5
           0




                         0              45            90           135           180           225
                                                     4th grade enrollment

Note: Enrollment is drawn from administrative data for 2002. For visual clarity, only schools with 4th grade
enrollments below 225 are displayed. This excludes less than one percent of all schools.
      Figure 8: Student characteristics and enrollment in urban private voucher schools, 2002
                                            Panel A: Log income




                              13  12.5
                    Household income
                     12       11.5




                                                           45                90             135
                                                                     4th-grade enrollment



                                            Panel B: Mothers' schooling
                              14       13
                    Mothers' schooling
                       11      12
                              10
                              9




                                                           45                90             135
                                                                     4th-grade enrollment




Note: Income and mothers’ schooling come from 2002 individual-level SIMCE data aggregated to the school level.
Enrollment is drawn from administrative data for the same year. The figure presents “raw” enrollment-cell means,
along with the fitted values of a locally weighted regression calculated within each enrollment segment. Only data
for schools with 4th grade enrollments below 180 are plotted; this excludes less than two percent of all schools.
                               Table 1: Descriptive statistics for urban schools, 2002

     Sample/variable                                                                   Quantile
                                     Mean         S.D.         10th        25th         50th          75th        90th
     Panel A: Full sample
     Income                             311.2       341.7       102.5        130            180        303.7       781.8
     Mothers’ schooling                  11.1         2.4         8.3         9.3          10.7         12.7        14.9
     Fathers’ schooling                  11.3         2.5         8.5         9.4          10.8         12.9        15.2
     Math score                         249.3          30       212.6       227.7         246.9        269.3       291.9
     Language score                     253.1        30.5       215.2       231.3         251.5        275.1         296
     4th grade class size                32.9            9.2          20          27         34         40.3        44.3
             th
     No. of 4 grade clases               1.88        1.09             1            1              2           2          3
      th
     4 grade enrollment                     65       45.1             21          33         56              86      122
     Panel B: Public schools
     Income                             152.8        69.1        94.4        113.6         138.6       172.1         217
     Mothers’ schooling                   9.6         1.3         8.1          8.6           9.4        10.4        11.3
     Fathers’ schooling                   9.7         1.4         8.1          8.8           9.6        10.6        11.5
     Math score                         235.1        21.4       208.7        220.6         233.8       248.8       262.2
     Language score                     237.9        21.6       211.2        223.9         237.5       251.8       265.8
     4th grade class size                34.7         7.2         25            30          35.5        40.3          44
     No. of 4th grade clases              2.1              1           1           1              2           3           3
      th
     4 grade enrollment             75.4                 42           29      41.5            70             98      130
     Panel C: Voucher private schools
     Income                        250.8            142.6       115.7        155.8         213.1       307.1       428.2
     Mothers’ schooling             11.5              1.8         8.9         10.2          11.6        12.8        13.8
     Fathers’ schooling             11.5              1.9           9         10.2          11.6        12.9        13.9
     Math score                    252.2             27.5       215.1        234.4         254.3       271.3       287.5
     Language score                256.9             28.4       218.4        239.1         259.7       277.4       290.7
      th
     4 grade class size             34.2              9.3         21            28           36          42          45
     No. of 4th grade clases              1.7        1.07              1           1              1           2           3
      th
     4 grade enrollment                  61.4        48.1             21          31          45         82.5        112
     Panel D: Unsubsidized private schools
     Income                       1050.2            419.3       506.3        770.9       1003.6         1350      1673.5
     Mothers’ schooling              15.1             1.2        13.8         14.7         15.4          15.9       16.3
     Fathers’ schooling              15.6             1.3          14           15         15.9          16.5       16.9
     Math score                     288.1            25.3       254.3          276        292.9        304.7       314.1
     Language score                 291.8            23.7       261.8         283         297.5          307       315.1
      th
     4 grade class size              22.4             8.6          10         16.8           23          28.5        34
     No. of 4th grade clases              1.7              1           1           1              1           2           3
      th
     4 grade enrollment                  41.7        33.2             10          17        31.5         57.5            85

Note: Data on monthly income, parental schooling, and test scores come from 2002 individual SIMCE information
aggregated to the school level. Income is in thousands of Chilean pesos (the average exchange rate for 2002 was about 700
pesos per U.S. dollar). Class size, the number of classes operated, and enrollment come from administrative data for the
same year. The table covers only urban schools. Panel A describes all 3,776 schools in the sample, panel B covers 1,652
public schools, panel C refers to 1,636 voucher private schools, and panel D refers to 488 private unsubsidized institutions.
   Table 2: Class size and income and mothers’ schooling among urban private voucher schools, 2002


                                                                     Dependent var.: 4th grade class size
                                                                       (1)           (2)          (3)
                   Panel A
                   Log income                                           120.3***      125.5***      135.3***
                                                                          (15.2)        (15.6)        (16.7)
                   Log income2                                            -4.9***       -5.1***       -5.5***
                                                                            (0.6)         (0.6)         (0.7)
                   13 region dummies                                          No           Yes            No
                   318 commune dummies                                        No            No           Yes
                   R2                                                     0.038          0.073         0.209
                   N                                                      1,636          1,636         1,636
                   Panel B
                   Mothers' schooling                                      8.5***        8.7***        9.8***
                                                                            (1.2)         (1.3)         (1.4)
                   Mothers' schooling2                                    -0.4***       -0.4***       -0.4***
                                                                            (0.1)         (0.1)         (0.1)
                   13 region dummies                                          No           Yes            No
                   318 commune dummies                                        No            No           Yes
                   R2                                                     0.029          0.061         0.200
                   N                                                      1,636          1,636         1,636


Note: Income and mothers’ schooling are drawn from 2002 individual-level SIMCE data aggregated to the school level.
Class size comes from administrative data for the same year. *** indicates statistical significance at the 1% level.
Table 3: 1st stage, reduced form, and base IV specifications; urban private voucher schools, 2002

                                        1st stage            Reduced form                         IV
                                         Class             Math      Language            Math          Language
                                           size            score       score             score           score
                                            (1)             (2)         (3)               (4)             (5)
          Class size                                                                    -0.7***          -0.6**
                                                                                         (0.3)           (0.3)
          1{x ≥46}                       -16.5***         11.8***       9.9***
                                           (2.7)           (3.2)        (3.3)
          1{x ≥91}                         -4.9**           0.0          1.6
                                           (2.3)           (4.0)        (4.0)
          1{x ≥136}                        -4.3**          11.5         10.9
                                           (2.0)          (13.6)       (12.9)
          1{x ≥181}                         -3.4           11.2         11.5
                                           (3.0)          (10.6)       (13.9)
          x                              0.95***           0.1           0.2*            0.8***         0.8***
                                          (0.01)           (0.1)        (0.1)            (0.2)          (0.3)
          (x -46)*1{x ≥46}                -0.6***           -0.1         -0.2            -0.6**         -0.6**
                                           (0.1)           (0.2)       (0.2)             (0.3)          (0.3)
          (x -91)*1{x ≥91}                 -0.3**           0.0         -0.1             -0.2*          -0.3**
                                           (0.1)           (0.1)       (0.1)             (0.1)          (0.1)
          (x -136)*1{x ≥136}                0.0             -0.6        -0.4              -0.2           -0.1
                                           (0.1)           (0.4)       (0.4)             (0.2)          (0.2)
          (x -181)*1{x ≥181}                -0.1            0.2         0.2                0.1           0.1
                                           (0.1)           (0.5)       (0.6)             (0.3)          (0.4)
          N                               1,623            1,623       1,623             1,623          1,623
          R2                              0.844            0.069       0.072


 Note: Test scores are based on 2002 SIMCE individual-level data, aggregated to the school level. Class size and
 enrollment come from administrative information for the same year. *** indicates statistical significance at the 1%
 level; ** at 5%, and * at 10%. All regressions are clustered by enrollment levels; see Lee and Card (forthcoming).
 The table focuses only on effects around the first four cut-offs, excluding the less than one percent of schools that
 report 4th grade enrollments in excess of 225 students.
         Table 4: Within-enrollment band IV regressions; urban private voucher schools, 2002

                                                                        Cutoff                     Pooled
                                                         1st
                                                                          2nd         rd
                                                                                      3            cutoffs
                                                          (45             (90         (135
                                                       students)       students)    students)
                                                           (1)             (2)          (3)          (4)
            Panel A: 5 student interval
            Dep. var.: Math score
            Class size                                          -3.3        -32.6           -4.4        -3.4
                                                               (2.5)      (185.3)          (7.3)       (2.4)
            N                                                   249          186              41        476
            Panel B: 3 student interval
            Dep. var.: Math score
            Class size                                         -6.9         -55.2      -13.9**             -7.4
                                                               (6.7)      (197.9)        (4.4)         (6.1)
            N                                                   185          145           33           363
            Panel C: 5 student interval
            Dep. var.: Language score
            Class size                                          -3.1        -38.1           -4.0        -3.2
                                                               (2.4)      (216.0)          (6.7)       (2.3)
            N                                                   249          186              41        476
            Panel D: 3 student interval
            Dep. var.: Language score
            Class size                                         -7.0          59.7      -13.0**             -7.3
                                                               (6.6)      (213.3)        (3.7)         (5.9)
            N                                                   185          145           33           363

Notes: Test scores are from 2002 SIMCE individual-level data, aggregated to the school level. Class size and
enrollment come from administrative information for the same year. Columns present regressions within 5 (panels A
and C) and 3 (panels B and D) student enrollment bands around the first three cut-offs. Separate results around the
fourth cut-off are omitted for the sake of space; they account for less than 1 percent of observations. Columns 1-3 are
IV specifications using an indicator for whether schools’ enrollment is above the respective cut-off as an instrument.
As van der Klaauw (2002) indicates, these are equivalent to simple Wald estimates of the effect of class size around
each discontinuity. Column 4 produces similar estimates pooling all three local samples and using the three cut-offs
(1{x>45}, 1{x>90}, and 1{x>135}) as instruments. All regressions are clustered around enrollment levels, see Lee
and Card (forthcoming).
      Table 5: Behavior of selected variables around enrollment cut-offs and IV specifications;
                                urban private voucher schools, 2002

                                           Mothers’       Fathers’     Household                   IV
                                           schooling     schooling      income              Math      Language
                                              (1)           (2)           (3)                (4)         (5)
               Class size                                                                        -0.1         0.1
                                                                                                (0.1)       (0.1)
               1{x ≥46}                        0.93***       0.94***       66.6***
                                                 (0.2)         (0.2)        (14.1)
               1{x ≥91}                          0.03          0.03           17.6
                                                 (0.2)         (0.2)        (17.3)
               1{x ≥136}                         0.66          0.86        143.7*
                                                 (0.7)        (0.8)         (79.4)
               1{x ≥181}                          0.66         0.71           53.1
                                                 (1.1)        (1.1)         (77.7)
               x                                -0.02*       -0.02*        -2.4***             0.4***       0.4***
                                                 (0.0)        (0.0)           (0.8)             (0.1)        (0.1)
               (x -46)*1{x ≥46}                  0.02*         0.01          2.3***           -0.4***      -0.4***
                                                 (0.0)        (0.0)           (0.8)             (0.1)        (0.1)
               (x -91)*1{x ≥91}                  -0.01         0.00            -0.7               0.1            0
                                                 (0.0)        (0.0)           (0.6)             (0.1)        (0.1)
               (x -136)*1{x ≥136}                -0.02        -0.03            -3.5            -0.2**         -0.1
                                                 (0.0)        (0.0)           (2.3)             (0.1)        (0.1)
               (x -181)*1{x ≥181}                 0.01         0.02               4               0.1          0.1
                                                 (0.0)         (0.0)         (3.4)             (0.1)         (0.2)
               Mothers’ schooling                                                             8.5***        9.5***
                                                                                               (0.9)         (1.0)
               Fathers’ schooling                                                               1.6*           1.1
                                                                                               (0.9)        (0.9)
               Household income                                                               13.4**      16.6***
                                                                                               (5.4)        (5.5)
               N                                1,623         1,623         1,623             1,623        1,623
               R2                               0.034         0.032         0.029

Notes: Test scores and socioeconomic status measures are from 2002 SIMCE individual-level data, aggregated to
the school level. Class size and enrollment come from administrative information for the same year. *** indicates
statistical significance at 1% level; ** at 5%, and * at 10%. All regressions are clustered by enrollment levels. The
table focuses only on effects around the first four cut-offs, excluding the less than one percent of schools that report
4th grade enrollments in excess of 225.
      Table 6: Reduced form regressions with piecewise control functions of higher order

                                                          Specification of the piecewise control function
                                                            1st          2nd          3rd          4th
                                                           order        order        order        order
                                                            (1)           (2)         (3)          (4)
           Panel A-Dep. var.: Class size
           1{x ≥46}                                       -16.5***     -10.0**        0.6          1.5
                                                           (2.7)        (4.1)        (3.2)        (3.1)
           1{x ≥91}                                        -4.9**        -2.4        4.9**         3.3
                                                           (2.3)        (1.6)        (2.2)        (2.1)
           Panel B-Dep. var.: Math score
           1{x ≥46}                                        11.8***     11.5***      24.7***      22.3***
                                                            (3.2)       (3.8)        (4.8)        (4.7)
           1{x ≥91}                                          -0.0       6.6**       15.5***      19.8***
                                                            (4.0)       (3.3)        (2.8)        (4.0)
           Panel C-Dep. var.: Language score
           1{x ≥46}                                        9.9***      10.9***      24.2***      24.2***
                                                           (3.3)        (3.9)        (3.9)        (4.0)
           1{x ≥91}                                         1.6         7.4**       19.6***      18.6***
                                                            (4.0)       (3.2)        (2.9)        (3.4)
           Panel D-Dep. var.: Mothers' schooling
           1{x ≥46}                                        0.93***     0.91***      1.21***      1.11***
                                                           (0.20)      (0.22)       (0.24)       (0.24)
           1{x ≥91}                                         0.03        0.29         0.55         0.40
                                                           (0.22)      (0.26)       (0.35)       (0.40)
           Panel E-Dep. var.: Fathers' schooling
           1{x ≥46}                                        0.94***     0.93***      1.14***      1.05***
                                                           (0.20)      (0.24)       (0.29)       (0.28)
           1{x ≥91}                                         0.03        0.25         0.61*        0.47
                                                           (0.22)       (0.26)      (0.36)       (0.41)
           Panel F-Dep. var.: Household income
           1{x ≥46}                                        66.6***     76.1***      69.5***      68.4***
                                                           (14.1)      (14.5)       (17.4)       (19.0)
           1{x ≥91}                                         17.6        29.6         40.5         22.3
                                                           (17.3)      (20.1)       (27.6)       (31.1)
           N                                               1,623       1,623        1,623        1,623
Note: Test scores and socioeconomic status measures are from 2002 SIMCE individual-level data, aggregated to the
school level. Class size and enrollment come from administrative information for the same year. *** indicates
statistical significance at 1% level; ** at 5%, and * at 10%. All regressions are clustered by enrollment levels. This
table analyzes the robustness of reduced form results to the inclusion of higher order piecewise control functions
(Van der Klaauw, 2002). The results in column 1 (panels A-C) replicate those in Table 3 above (columns 1-3).
The results in column 1 (panels D-F) replicate those in Table 5 above (columns 1-3). The remaining columns then
explore how these results change as higher order piecewise control functions are added. For the sake of space, these
panels report only the coefficients on the first two cut-offs, which correspond to the majority of observations.
