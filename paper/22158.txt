                              NBER WORKING PAPER SERIES




                      PAVING THE WAY TO DEVELOPMENT:
              COSTLY MIGRATION AND LABOR MARKET INTEGRATION

                                        Melanie Morten
                                       Jaqueline Oliveira

                                      Working Paper 22158
                              http://www.nber.org/papers/w22158


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     April 2016




We thank Treb Allen, Marcella Alsan, Ana Barufi, Gharad Bryan, Kate Casey, Arun
Chandrasekhar, Rafael Dix-Carneiro, Dave Donaldson, Taryn Dinkelman, Pascaline Dupas, Fred
Finan, Doireann Fitzgerald, Paul Gertler, Doug Gollin, Saum Jha, Brian Kovak, Kyle Mangum,
Mushfiq Mobarak, David McKenzie, Paula Pereda, Nancy Qian, Mark Rosenzweig and Sam
Schulhofer-Wohl for discussions; and seminar participants at the 36th Meeting of the Brazilian
Econometrics Society, Emory University, Harvard/MIT, 2014 NBER Summer Institute, 7th
Migration and Development Conference, University of Calgary, WUSTL, Clemson University,
Oxford University, University of Houston and UCL/LSE for helpful comments. Anita Bhide
provided excellent research assistance. Part of this work was completed while Morten was a
visiting scholar at the Federal Reserve Bank of Minneapolis and their hospitality is greatly
acknowledged. This paper previously circulated under the title “Migration, roads and labor
market integration: Evidence from a planned capital city”. Any errors are our own. The views
expressed herein are those of the authors and do not necessarily reflect the views of the National
Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2016 by Melanie Morten and Jaqueline Oliveira. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Paving the Way to Development: Costly Migration and Labor Market Integration
Melanie Morten and Jaqueline Oliveira
NBER Working Paper No. 22158
April 2016
JEL No. J61,O18,O54

                                          ABSTRACT

How integrated are labor markets within a country? Labor mobility is key to the integration of
local labor markets and therefore to understanding the efficacy of policies to reduce regional
inequality. We present a comprehensive framework for understanding migration decisions,
focusing on the costs of migrating. We construct and then estimate a spatial equilibrium model
where mobility is determined not only by idiosyncratic tastes, but also by moving costs that are
origin-destination dependent. We use rich data on the inter-municipality moves of 18 million
people together with exogenous variation in the road network caused by the construction of a
capital city to identify the bilateral costs of moving between two regions. The mean observed
migration cost is between 0.8-1.2 times the mean wage. 84% of the migration cost is a fixed cost,
3.5% depends on the distance between locations, and 9.6%is dependent on the travel time on the
road. This imperfect integration of labor markets has two key implications. First, costly migration
generates heterogeneity in regional responses to economic shocks. A region 10% more connected
will have a 5.6 percentage point higher population elasticity to wage shocks. Second, costly
migration changes the incidence of regional shocks. We estimate that 37%of the total incidence
of a shock falls on residents, compared to 1% in a model where migration is costless. Our results
have important implications for understanding the impact of economic development as well as the
impact of place-based development policies.


Melanie Morten
Department of Economics
Stanford University
579 Serra Mall
Stanford, CA 94305
and NBER
memorten@stanford.edu

Jaqueline Oliveira
Clemson University
201 Tiliwa Court, apt 220
Central SC, 29630
joliveirayale@gmail.com
1    Introduction
Regional inequality is both a concern to policy makers and a puzzle to academics. Many
governments implement place-based policies to improve lagging regions and reduce spa-
tial inequality. On the other hand, academics are puzzled by the persistence of large wage
gaps across space and ask why migration doesn’t arbitrage away these gaps. The level
of labor market integration is key to understanding both issues. While the response of
migration to returns has been well-studied, much of the traditional literature assumes,
primarily due to data constraints, that labor can either costlessly move between locations
or that labor is immobile across space. Using data on gross migration between municipal-
ities in Brazil we show that neither assumption fits the data. We therefore ask two related
questions. First, how large is the cost of migrating and what proportion of this cost is po-
tentially affected by policy? Second, how does imperfect labor market integration affect
the efficacy of government policy to address regional inequality?
    To answer these questions we provide a comprehensive framework to understand
the migration decisions households make, paying particular attention to understand-
ing the costs involved with migration. Our model extends the standard spatial equi-
librium model (Roback (1982)) and allows for mobility to be determined not only by
preference shocks for locations (as in Moretti (2011)), but also by moving costs that are
origin-destination dependent. In the model agents optimally choose their location each
period, paying a cost if they migrate. We estimate the model with rich data of 18 million
inter-municipality migration decisions in Brazil over the period 1980-2000. We param-
eterize migration costs by inter-regional travel time on the road, using the construction
of a planned capital city, Brasilia, to generate plausibly exogenous variation in the cost
of migrating (and in an extension, the cost of trading goods) through the location of the
national road network. We first document substantial costs of migration. The average
observed migration cost between two municipalities is equal to 0.8-1.2 times the annual
wage. Of these costs, 9.6% is due to the time to travel on a road between the regions.
Next, we quantify the policy implications of costly migration. We show: (i) the popu-
lation elasticity of migration to wage shocks depends on the the ease of accessing other
labor markets. As such, the average population elasticity hides substantial geographic
variation in the population elasticity of shocks, and (ii) costly migration leads to highly
concentrated distributional effects of regional shocks. We estimate that the incidence of
the same shock is more than 30 times larger for the local population in the estimates from
the model with costly migration than a benchmark model with costless migration. Both

                                             1
results have key implications for understanding the distributional impact of place-based
regional development policy.
   A key challenge to estimate the elasticity of migration costs as well as to understand
the responsiveness of labor to economic shocks has been the lack of data on gross migra-
tion flows between locations. Data constraints have precluded analysis of these costs in
prior literature, but doing so leads to systematic bias of key economic elasticities related
to the responsiveness of labor to changes in economic conditions. To see why net flows
do not fully yield information about migration elasticities, consider two locations, A and
B. 100 people start in each location. The following period there are 110 people in location
B and 90 people in location A. The observed net migration flow of 10 people could be con-
sistent with either large gross flows (50 people moving from A to B and 40 people moving
from B to A) or with small gross flows (15 people moving from A to B and 5 people mov-
ing from B to A). Data on gross and net migration rates therefore yield two separate sets
of information. First, how “easy” it is to migrate will roughly depend on the quantity of
total migration. Second, how “attractive” each region is (which affects estimates of how
responsive migration is to economic returns) will depend roughly on the relative flows
out of a region compared with the rate of non-migration in a region. With only data on net
flows it is not possible to separate out whether a location that had a high net inflow had
so because they had high returns (for example, a large wage shock) or because they had
a relatively small wage shock but had many people living in the vicinity who could more
easily migrate in than a more isolated region with the same wage shock. In our setting we
use census data on 18 million observations where we know both the origin municipality
and the destination municipality of all individuals. These rich migration flow data allow
us to separately identify the costs of migration from the returns of different locations.
   The key contribution of our paper is to identify and estimate the magnitude of migra-
tion costs and then show how costly migration changes fundamental conclusions about
the role of labor arbitrage across space. To separate the effects of migration costs from
other determinants of migration, such as income and amenities, we construct and esti-
mate a spatial equilibrium model. In the model, agents gain indirect utility from wages
and amenities, which vary by location. Migration is costly and costs depend on the origin
and destination. Agents choose the location which maximizes their utility, and will mi-
grate from the current location if the value of moving to another location and paying the
cost to do so is higher than the utility from remaining where they are. On the production
side, nominal wage differences reflect productivity differences. A productivity shock will


                                             2
increase the nominal wage. This increases the real wage of a location, attracting migrants.
Equilibrium is achieved through the adjustment of the housing market. A location that
receives a positive productivity shock will have higher nominal wages. These nominal
wages will attract migrants. An inflow of migrants will increase the rental rate of hous-
ing, reducing the real wage and consequently, the returns to migration. Migration costs
introduce a wedge between the utility of each location, and can generate differences in
real wages across space. In an extension, we allow for costly trade between two locations,
following Eaton and Kortum (2002). This generates one additional general equilibrium
effect: for a location that is not well connected to other markets a positive productivity
shock will decrease the local prices of goods; this effect is mitigated if a location is more
connected and can increase exports in response to a positive productivity shock.
   We think of migration costs broadly, including fiscal as well as psychic components
such as being away from friends and family (Sjaastad (1962)). In our model, migration
is efficient: individuals make rational decisions, internalizing the cost of migrating. The
policy-relevant question is therefore the level of migration costs, and if such costs can be
modified by policy. If people simply dislike migrating, then, it may be difficult to imple-
ment policies to facilitate labor mobility. However, if part of the cost of migration is due to
lack of access to infrastructure such as highways, then migration rates may be lower than
if infrastructure was improved. These marginal, policy-relevant, costs are central to our
analysis. Of course, it is reasonable to ask whether a one-time migration cost (which may
be small relative to the present value of a higher income stream) will have a substantial
effect on the decision to migrate. We argue that such costs can be significant. For example,
if migrants like to return home to visit friends and family once they have migrated, the
migration cost will include the flow costs of return visits (both a fiscal component and a
time component) as well as the utility cost of not seeing friends and family as often as if
they lived closer. It is also easy to see how such costs could depend on the ease of trav-
eling to a specific location. Whether migration costs exist and hence affect the decision
to migrate is the focus of the paper, and ultimately, is an empirical question which we
answer.
   The empirical results are as follows. The estimated migration costs are substantial,
equivalent to 0.8-1.2% of the mean wage. Travel time between locations, controlling for
the Euclidean distance, is 19% of the costs of all possible moves. For moves that actually
occur, the road cost is 9.6% of the observed cost; however it is important to account for
the unobserved preference shock (on average, the unobserved preference shock for those


                                              3
who choose to move is large enough to offset the observed cost). We find that migration
costs are relatively stable by subgroups based on age and educational characteristics.
   Next, we examine the policy implications of costly migration. We first show that mi-
gration costs induce substantial regional variation in the population elasticity to an own-
region wage shock. When a region is hit by a positive shock migrants from other loca-
tions choose to move to that region. However, if the region is far away and costly to get
to then that region will not attract as many migrants. The overall elasticity of population
in response to economic shocks will depend on how well integrated the region is. We
illustrate this channel in our model by simulating the migration response to wage shocks
in each region, and showing the resulting distribution of elasticities. We also document
that, as expected, the estimated elasticity correlates with the “migration market access” of
the region. To contrast our results to a traditional model without migration costs we un-
dertake the same exercise and show that in a model without migration costs population
elasticities to shocks are uniform across space.
   We then show that this regional heterogeneity leads to substantial distributional con-
sequences of shocks. Migration costs make it difficult for the labor force to adjust in
response to changes in economic conditions. When a region is hit by a wage shock (or a
development policy) people who live in poorly-connected areas bear more of the distri-
butional consequences of shocks than when the same size shock hits a region that is well
connected and labor can adjust. We simulate this channel in our model and show that
these distributional implications are substantial. In the estimates where we incorporate
the costs of moving, residents absorb 37% of the welfare effects. However, in a model
without moving costs then the distributional effects are spread between all members in
the population. As a result, the initially resident population accrue only 1% of the total
distributional effects.
   This has implications for understanding who will indirectly benefit from place-based
policies, such as investment in local economic areas. In a world where migration is cost-
less, we would expect a large migration shock and the benefits to be spread over more
people; in contrast where mobility is limited, spatial economic shocks will be more felt by
those who are initially in the location. We illustrate this last point by simulating the effect
of a housing subsidy, similar in flavor to the Brazilian government’s mortgage assistance
scheme for low income households to live in high-wage locations (called “Minha Casa,
Minha Vida”). In our simulations, the population response to the housing scheme is con-
centrated in areas neighboring the affected areas. In contrast, in a model where migration


                                              4
is costless, the population response is spread evenly throughout all the regions.
    Our paper contributes to several literatures.
    First, we identify and estimate bilateral costs of moving across space in a fully inte-
grated spatial equilibrium model using an exogenous source of variation in road con-
nectivity. Due to data constraints, most of the spatial, urban and trade literatures have
made the assumption that the bilateral component of migration costs is zero (Moretti,
2011; Diamond, 2016; Allen and Arkolakis, 2014; Redding, 2015)) or that labor is immo-
bile across space (Donaldson, 2016; Topalova, 2010). Some recent work relaxes these as-
sumptions. The three papers that are closest to our approach in this regard are Tombe
and Zhu (2015) who use individual data from Chinese censuses to estimate interregional
costs of migration, focusing on the costs associated with the hukou registration system,
Bryan and Morten (2015) who estimate interregional migration costs in Indonesia, and
Monte et al. (2015) who use commuting flow data in the US which provides gross flow
rates to estimate the costs of commuting across regions. Relative to these papers we have
exogenous variation in a key component of migration costs. This allows us to estimate
migration costs directly rather than non-parameterically identifying the costs from within
the model.1
    Second, we contribute to understanding the determinants of internal migration. A
large predominantly empirical literature has focused on the responsiveness of migration
to economic returns (Harris and Todaro, 1970; Pessino, 1991; Tunali, 2000). In line with
our results on the important of migration costs, experimental results find a large migra-
tion response when migration is directly subsidized (Bryan et al. (2014)). Kennan and
Walker (2011) find evidence of migration costs for US youth. Dix-Carneiro and Kovak
(2014) examine population responses in Brazil in response to regional trade liberaliza-
tion, where labor is again mobile across regions. We extend this literature by considering
the responsiveness of migration to both costs and returns and by considering the general
equilibrium effects of migration.2
    Third, our paper studies the incidence and heterogeneity of place-based policy. We
document that imperfect labor migration leads to substantial regional heterogeneity in
   1 Mangum     (2015) estimates a gravity model for the US using aggregated migration flows provided by
the IRS. Relative to this paper, we have data on individual level migration decisions as well as exogenous
variation in costs of migration. Caliendo et al. (2015) estimate inter-state migration costs for the US but do
not have data at a finer regional aggregation and also do not utilize exogenous variation in migration costs.
   2 Chein and Assuncao (2009) study the construction of a road in the North of Brazil as an instrument for

migration to study the effect of migration on wages, but do not estimate the effect of roads on migration
costs directly.



                                                      5
the responsiveness of population to economic shocks, consistent with the results found
in Monte et al. (2015) for labor markets and commuting costs in the US. Yagan (2016)
finds substantial regional variation and limited migration response in response to the
Great Recession, consistent with frictions in labor market integration in the US. Busso et
al. (2013); Kline and Moretti (2014) provides frameworks to study the incidence of place-
based policy in the US in the context where labor can costlessly relocate. We quantify
how the incidence of place-based policy will also depend on the degree of labor market
integration across space.
    Fourth, our paper adds another mechanism to understanding the effect of infrastruc-
ture on the functioning of markets. A large literature has examined the effect of roads on
trade in goods; we provide empirical evidence that migration is also affected directly by
the presence of roads. Our results use an instrumental variable strategy similar in flavor
to that employed by other studies examining the relationship of the transport network
and economic development (Michaels, 2008; Banerjee et al., 2009; Faber, 2014; Ghani et
al., 2014; Hornung, 2014). Relative to these papers we focus on the effect of roads on mi-
gration of people.3 A key contribution of our paper it to explicitly examine the role of
labor mobility and the interaction of the labor market as a result of the change in road
networks. This is important because any effects of trade on productivity need to also take
into account labor market reallocation.
    Fifth, costly migration contributes a new mechanism to explain underdevelopment in
many developing economies. If it is costly to move out of low income locations labor may
not be able to move to where it is most productive. Given low levels of infrastructure in
developing countries, it is plausible that migration costs are larger in magnitude in the
developing world than the developed world. For example, a worker may prefer to relo-
cate to an area with a higher real wage, but the cost of moving may be too high to make
this decision worthwhile. If labor is not allocated to the place where it is most produc-
tive then aggregate productivity may decrease, along similar lines to studies examining
the misallocation of capital (Hsieh and Klenow (2009)).              4   Our paper presents convincing
evidence that, while these migration costs are in large part attributed to tastes, they can
be considerably reduced by improving access to transportation infrastructure. We believe
this finding suggests there is margin for policy makers to ease labor frictions that prevent
   3 Bird and Straub (2015) also use the construction of Brasilia as an instrument to study the effect of road
construction on regional GDP. Their study focuses on the effect of roads on GDP and they do not examine
the effect of roads on migration.
   4 The implications for aggregate GDP when there is costly migration in the presence of migrant selection

are examined in Bryan and Morten (2015).


                                                      6
the efficient allocation of labor across space.
    The plan of the paper is as follows. We present the structural model in Section 2 and
our estimation strategy in Section 3. We then discuss some background information on
the construction of Brasilia and how we use this natural experiment to provide exogenous
variation in the road network in Section 4. Section 5 introduces the regional outcome and
road database we construct for Brazil and Sections 6 and 7 present our empirical results
and discuss the implications for regional heterogeneity, and we conclude by discussing
the main findings in Section 8.



2    Model
This section presents the spatial equilibrium model. The framework is based on Moretti
(2011). We augment the model by adding in pairwise location-specific migration costs.
    In the model, agents gain indirect utility from wages and amenities, which vary by
location. Migration is costly and depends on the origin and destination. Agents choose
the location which maximizes their utility, and will migrate from the current location if
the value of moving to another location and paying the cost to do so is higher than the
utility from remaining where they are. In our baseline model we assume that labor is
homogenous, factor markets are perfectly competitive and capital can move freely. As a
result, nominal wage differences across locations reflect productivity differences. How-
ever, the real wage agents receive depends on the cost of living. Each location has a rental
market, with a housing supply elasticity that determines the response of rental rates to
increased demand for housing. A location that receives a positive productivity shock will
have higher nominal wages. These nominal wages will attract migrants. An inflow of mi-
grants will increase the rental rate of housing, hence reducing the real wage and reducing
the returns to migration.
    Differences in real wages across space can arise from both migration costs as well
as differences in amenity values. In the original Roback model of spatial equilibrium
(Roback, 1982), all agents are indifferent across locations, and differences in real wages
are equal to the difference in amenity value of locations across space. With an idiosyn-
cratic taste component for location, such as in Moretti (2011), the marginal, rather than
the average, migrant is indifferent across location. Introducing migration costs into the
model generates a wedge in utility for the marginal migrant. This can lead to larger gaps
in real wages than if labor were perfectly mobile: without migration costs the agent may


                                                  7
migrate, driving up rental rates in the destination and reducing them in the origin, hence
reducing the real wage gap between origin and destination. With migration costs, the
agent no longer migrates and so the wage differential is larger. The magnitude of these
effects is the aim of our empirical estimation.
    We now set up the key ingredients of the model: equations specifying labor demand,
labor supply and housing supply, and show how these equations form the spatial equi-
librium system.


2.1    Labor demand
Assume that there is a national homogenous good produced in each location k at time
t. Production is determined by a constant returns to scale technology. Productivity is
location-specific, and denoted by Akt :

                                                            1−α
                                            Ykt = Akt Lαkt Kkt  .

    Firms have access to capital at price it . The market for capital and labor is competitive,
and factors are paid their marginal products.

                                                                     Kkt
                            log wkt = log Akt + log α + (1 − α ) log     ,                                 (1)
                                                                     Lkt
                                                                     K
                               log it = log Akt + log(1 − α ) − α log kt .                                 (2)
                                                                     Lkt

    Together, Equation 1 and Equation 2 form the labor demand curve for location k:

                                                             1
                                         log wkt = αt +        log Akt ,                                   (3)
                                                             α
                           (1−α )                   (1−α )
where αt = (log α +          α      log(1 − α ) −     α      log it ), and is common across all locations
at time t.
    Given the assumption about competitive markets and the free movement of capital,
labor demand is only a function of location-specific productivity. That is, any nominal
wage differences between two locations reflect productivity differences.5
   5 The implication that capital is perfectly mobile and therefore nominal wage differences purely reflect
productivity differences is a strong assumption. The other extreme assumption is that capital is fixed in
location, as in Ottaviano and Peri (2012). The assumption about capital mobility does not affect our first step
estimates. However, the assumption is important for the GE counterfactuals. We run the counterfactuals
under both assumptions (setting the labor share equal to 0.3) and find very little additional effect of having
fixed capital mobility compared to the baseline assumption of perfect mobility. Dix-Carneiro and Kovak


                                                       8
2.2      Housing supply
All housing is owned by absentee landlords. The elasticity of rental rates to labor is given
by:
                                      log rkt = ηt + ηr log Lkt ,                                   (4)

where ηr is the elasticity of house prices to population. If it is easy to expand the housing
supply (for example, there is a lot of available land), then ηr will be small. If it is not
easy to expand the housing supply (for example, very strict zoning regulations), then ηr
will be large: the price of housing will increase a lot when there is a larger workforce.
Each worker demands one unit of housing, so the equilibrium in the housing market will
equate housing supply with labor supply.


2.3      Labor supply
Consumers living in location k derive utility from goods consumption Ckt , which they
can buy at price pt , and housing Hkt , which they can rent at rkt . They also derive some
amenity value from living in location k, Xkt , and we represent the agents utility as follows:

                                             γ 1−γ
                                      Ukt = Ckt Hkt exp Xkt .                                       (5)

      These preferences, along with the budget set pt Ckt + rkt Hkt ≤ wkt , generate demand
functions for goods and housing units:

                                         pt Ckt = γwkt ,
                                        rkt Hkt = (1 − γ )wkt ,

where wkt are the wages in location k at time t.
      The (log) indirect utility function for living in location k at time t is:

                         log Ukt = β + βt + βw log wkt − log rkt + βχ Xkt ,                         (6)
                                 = β + βt + Vkt ,

where β = (γ log(γ ) + (1 − γ ) log(1 − γ ))/(1 − γ ), βt = − ptγ /(1 − γ ), βw = 1/(1 − γ ),
(2014) find very slow regional adjustment to trade shocks in Brazil, part of which could be explained by
slow capital adjustment rates.




                                                    9
βχ = 1/(1 − γ ) and:
                                       Vkt = βw log wkt − log rkt + βχ Xkt .                              (7)

    An agent begins the period living in location j. The utility from living in j at time
t depends on the indirect utility given by Equation 6, as well as an individual-specific
match value i jt :

                          Vi jt = β + βt + βw log w jt − log r jt + βχ X jt + i jt ,                     (8)
                                 = β + βt + V jt + i jt .

    An agent who starts the period in location j can choose to remain in j or relocate to
another location. In total, there are M possible locations, including their current location.
If they relocate from j to location k they must pay a migration cost of c jkt , where c jkt > 0
if j 6= k. Agents observe their match-specific shock for each of the M locations, including
where they currently reside, and then make a decision about where to migrate. The lo-
cation decision for agent i living in location j is therefore to choose the location with the
highest utility:
                                              max{Vkt + ikt − c jkt }.
                                                k

    Notice that, because the parameters β and βt are constant across the alternatives k,
their values do not affect the locational choice. Assume that the individual match specific
terms are distributed as random type 1 extreme value: ikt ∼ EV1. Then, the probability
that an agent chooses location k in time t, given that they start the period in location j, is
given by the conditional logit expression:

                                       exp(βw log wkt − log rkt + βχ Xkt − c jkt )
                       π jkt =    M
                                                                                              ,           (9)
                                             w                     χ
                                 ∑m =1 exp (β log wmt − log rmt + β Xmt − c jmt )


with ∑k π jkt = 1.6
    The supply of labor to region k is determined by the net in-migration into each region.
Because it is costly to move between locations, equilibrium labor supply will also depend
on the initial distribution of population. This is because the utility of living in region
k (conditional on the realization of the match value ) is not the same for all potential
   6 The    probability that the agent does not migrate is given by the probability they stay in their current
location:
                                              exp(βw log w jt − log r jt + βχ X jt )
                            π j jt =    M
                                                                                          .
                                                   w                     χ
                                       ∑m =1 exp (β log wmt − log rmt + β Xmt − c jmt )




                                                           10
migrants: if there are more people living close to region k and it is cheap to migrate to
k the in-migration response will be larger than if people are living further away from
region k and it is expensive to migrate there. In a world without bilateral migration costs,
labor supply does not depend on the distribution of population because the cost does not
differ based on current origin - people migrate to region k if it provides the highest level
of utility, independent of their current location.
   Given the initial distribution of the population, N j,t−1 , ∀ j = 1, 2, ..., M, the labor sup-
ply in locality k is the net inflow of labor into region k from every region (including those
who start in k and chose not to migrate out), given by:

                                                 M
                                         Lkt =   ∑ π jkt N j,t−1 .                               (10)
                                                 j=1


2.4    Spatial equilibrium
The spatial equilibrium is given by solving a system of simultaneous equations for gross
migration from j to k (π ∗jkt ), equilibrium labor (L∗kt ), wage (w∗kt ) and housing price (r∗kt ) for
each region k, such that:

   1. Labor demand is given by Equation 3:

                                                              1
                                         log w∗kt = αt +        log Akt
                                                              α

   2. Migration rates are given by Equation 9:

                                     exp(βw log w∗kt − log r∗kt + βχ Xkt − c jkt )
                      π ∗jkt =    M                ∗         ∗
                                             w                     χ
                                 ∑m =1 exp (β log wmt − log rmt + β Xmt − c jmt )


   3. Labor supply is given by Equation 10:

                                                       M
                                            L∗kt =     ∑ π ∗jkt N j,t−1
                                                       j=1


   4. Housing supply is given by Equation 4:

                                          log r∗kt = ηt + ηr log L∗kt



                                                     11
    The spatial equilibrium yields that the marginal migrant is indifferent between staying
in their current location and migrating. In a world where migration was costless, the
marginal migrant would receive the same utility at each location. In contrast, with costly
migration, the marginal migrant internalizes the cost of migrating and will only migrate if
the utility at the new destination is large enough to compensate for the cost of migrating.
Migration costs therefore introduce a wedge in utility across locations.



3    Estimation
This section describes the procedure to estimate the spatial equilibrium model. Consider
an initial spatial equilibrium where the number of people in region j at time t is given by
N jt . The economy experiences productivity shocks in period t + 1 which generate new
wage shocks for each location. The productivity shocks propagate through the economy.
Initially, the productivity shock in k increases nominal wages in region k. This will in-
crease the returns to migrating, and so people from every other region will migrate into
k. As labor migrates in, the demand for housing increases, pushing up the rental rate
for housing. The rate of increase of rental rates will depend on the elasticity of housing
to population. As the rental rate for housing increases, the real return to migration to
region k decreases. Agents will continue to migrate into k until the marginal migrant is
indifferent between staying in their initial region j and migrating to k. The new spatial
equilibrium is the allocation of individuals across space, N j,t+1 . The goal of the estimation
is to predict the new spatial allocation as closely as possible.
    To estimate the model we implement a two-step procedure, following Diamond (2016),
which is based on Berry et al. (1995). The first step of the estimation is to quantify the
mean utility for each region separately from the transportation cost. We then use the
change in the mean utility over time to identify the parameters determining the spatial
equilibrium process: the elasticity of utility to changes in wages relative to rents (βw ),
and elasticity of house prices to changes in population (ηr ). We use three sets of instru-
ments to identify the model. To identify the effect of roads on migration costs in the first
step estimation, we use the instrument generated by the construction of highways link-
ing the newly-build federal capital with state capitals. In Section 5, we provide the details
of how we create the instrument. To identify the spatial adjustment parameters in the
second step we use exogenous productivity shocks together with the interaction of the
exogenous productivity shock with a measure of market access (described later in this


                                              12
section).


3.1   First step: estimation of bilateral migration costs
The first step of the estimation process is to use the observed gross migration flows to
separately estimate the common utility (Vkt ) from the transport cost (c jkt ). A key part
of our analysis is to identify the bilateral migration costs of moving between j and k. In
order to estimate these costs, it is necessary to have data on gross migration flows, not just
the net population allocation. Our analysis is similar to the approach used for identifying
costs of switching industries in Artuç et al. (2010).
   To see why it is important to have data on the gross flows and not just net flows,
consider two locations. 100 people start in each location. The following period there are
110 people in location B and 90 people in location A. The observed net migration flow of
10 people could be consistent with either large gross flows (50 people moving from A to B
and 40 people moving from B to A) or with small gross flows (15 people moving from A to
B and 5 people moving from B to A). Data on gross and net migration rates therefore yield
two separate sets of information. First, how “easy” it is to migrate will roughly depend
on the quantity of total migration. Second, how “attractive” each region is (which affects
estimates of how responsive migration is to economic returns) will depend roughly on
the relative flows out of a region compared with the rate of non-migration in a region.
With only data on net flows it is not possible to separate out whether a location that had
a high net inflow had so because they had high returns (for example, a large wage shock)
or because they had a relatively small wage shock but had many people living in the
vicinity who could more easily migrate in that a more isolated region with the same wage
shock. In our setting we use census data on 18 million observations where we know
both the origin municipality and the destination municipality of all individuals. These
rich migration flow data allow us to separately identify the costs of migration from the
returns of different locations.
   Consider again the probability that an agent chooses to live in location k at time t,
given that they start the period in location j:

                                               exp(Vkt − c jkt )
                                  π jkt =    M
                                                                       .                  (11)
                                            ∑m =1 exp (Vmt − c jmt )

   Our analysis is concerned with identifying the role of transport costs on mobility. We



                                                   13
parameterize the bilateral cost, c jkt :

     c jkt = λ f I{ j 6= k} + λ d Bilateral distance jk + λ t Bilateral travel time jkt + ζ jkt ,   (12)

where I{ j 6= k} captures a fixed utility cost of moving, Bilateral distance jk is the eu-
clidean distance between j and k, Bilateral travel time jkt is the travel time between origin
j and destination k at time t, and ζ jkt is an unobservable component, which captures pair-
wise barriers to migration due to, for example, limited networking and information flows
about local labor market conditions, socio-cultural differences, among others.
   In an extension we also allow agents to derive direct utility, Vb , from living in their
state of birth. Indexing state of birth by s, the probability equation is given by

                                        exp(Vkt + I(k ∈ Sb )Vb − c jkt )
                         π jkst =    M
                                                                                .                   (13)
                                    ∑m =1 exp (Vmt + I(m ∈ Sb )Vb − c jmt )

   Inserting Equation 12 into Equation 13 and taking the natural logarithm of both sides
yields our estimating equation:

          log(π jkst ) = Vkt + Vb I{k ∈ Sb } + λ f I{ j 6= k} + λ d Bilateral distance jk +
                      + λ t Bilateral travel time jkt + Π jt + ζ jkt ,                              (14)

where I{k ∈ Sb } is an indicator for whether k belongs to the set of localities in the birth
                              M
                                                     
state Sb , and Π jt = − log ∑m  =1 exp (Vmt − c jmt ) . We expect Vb > 0, as individuals
might value being closer to relatives.
   The term Π jt is absorbed when we estimate Equation 14 including origin fixed effect.
The common utility components Vkt are estimated as destination fixed effects. In order
to consistently estimate the parameters from the cost function, the variable components
of the migration cost need to be uncorrelated with the unobservable cost component ζ jkt .
We expect that λ f < 0, λ d < 0, and λ t < 0.
   Road connectivity between bilateral pairs is likely correlated with ζ jkt . This is so if,
for example, highways are placed to integrate two localities with higher values of ζ jkt
and stimulate migration flows. In this case, OLS estimates will likely overstate λ t and
yield smaller negative impacts of travel time on migration costs. We circumvent this
problem by exploiting the relocation of Brazil’s capital city from the coast to the center of
the country as a natural experiment that spurred the construction of a highway network
to connect the new federal capital to the state capitals. This experiment allows us to


                                                   14
construct a least-costly road network of highways.7
    The first-stage equation for traveltime is:

      Bilateral traveltime jk = θkt + θb I{k ∈ Sb } + θ f I{ j 6= k} + θ d Bilateral distance jk +
                               + θ t Z jkt + θ jt + ϑ jkt ,                                            (15)

where Z jkt is the instrument for bilateral travel time.


3.2     Second step: estimation of elasticities
Once we have recovered the mean level of utility for each region Vkt , we then relate this
to observable changes in wages and rents that occurred over this period. We estimate two
structural parameters by GMM: the elasticity of utility to wages (relative to rents), βw , and
the elasticity of rental rates to population ηr . We construct exogenous productivity shocks
to use as instruments for productivity differences across space. In addition, we use our
first-step estimates of the cost parameters to create a measure of labor market integration
(explained below), which we interact with our measure of productivity shocks and use as
an additional instrument.
    The specific productivity shock we construct is a Bartik shock (Bartik (1991)).8 The
Bartik shock takes the national-level growth rate in employment for each industry, and
constructs a location specific shock based on a baseline industry specialization of each
location. Precisely, we compute the nation-wide increase in employment for each indus-
try between period t − 1 and period t and then assign a predicted employment shock to
location k, based on the baseline composition of industry in location k (empirically, we
define this as the composition of employment across industries in 1970). Let the Bartik
shock for location k be given by ∆Bkt = Bkt − Bk,t−1 :

                                                                   Lind,k,0
                                  ∆Bkt =    ∑ (∆ log Lind,−k,t )            ,
                                            ind
                                                                    Lk,0

where log Lind,−k,t is the average log employment in industry ind in year t, excluding
workers in location k, and Lind,k,0 / Lk,0 is the baseline industry composition in location k.
   7 We present the historical and institutional contexts that motivated the instrument in Section 4 and

present the details of how we generate the bilateral travel times and instrument in Section 5.
   8 Bartik shocks are extensively used in urban economics to generate spatial productivity differences. For

recent examples, see for example Diamond (2016), Notowidigdo (2013). They have been less extensively
used in developing countries, one exception is Theoharides (2016) who studies the effect of migrant demand
shocks in the Philippines.

                                                       15
The Bartik shocks utilize variation across space in the location of industry.
    In the presence of bilateral migration costs, the same productivity shock will have
different impacts on labor supply depending on the ease with each migrants can move
to where wages are higher. Therefore, the model suggests using the estimates of the
migration costs to construct a measure of labor market integration for location k, which
we call Mkt :

                        M
                Mkt =   ∑ −(λ̂ f + λ̂d Bilateral distance jk + λ̂t Z jk )−1 L j,t−1 .
                        j6=k


    Our second instrument is an interaction between the labor market integration measure
and the Bartik shocks, ∆Bkt Mkt .
    Taking the first difference of Equations 4 and 7 yield the following estimating equa-
tions:

                        ∆ log rkt = ∆η + η∆ log Lkt + ∆ξkt ,                            (16)
                               ∆Vkt = βw ∆ log wkt − ∆ log rkt + ∆νkt .                 (17)

    The error term ∆νkt captures shocks to the amenity value of location k at time t. The
identifying restrictions used in the GMM estimation of Equations 17 and 16 are:

                                          E(∆Bkt ∆ν jt ) = 0,
                                      E(∆Bkt Mkt ∆ν jt ) = 0,
                                          E(∆Bkt ∆ξ jt ) = 0,
                                      E(∆Bkt Mkt ∆ξ jt ) = 0.



4    Instrument for bilateral travel time: Brasilia
The focus of the paper is on quantifying the effect of migration costs on the decision
to migrate. To do so, we need to be able to cleanly identify the components of such a
migration cost. A key concern for our exercise is that migration costs are endogenous:
for example, migration costs are low between two cities because a road connects the two;
however the road was built precisely because there is high demand for migration. To get
around this issue we use plausibly exogenous variation in the location of highways in
Brazil generated by the construction of a planned capital city, Brasilia.

                                                16
4.1    Selection of the new capital city
Brasilia was constructed in 1960 as a response to a long-standing issue of where to have
the capital city.9 We argue that it is the timing, not the location, of Brasilia that was a
shock. After being dormant for 50 years, the renewed interest in Brasilia was motivated
by political reasons, and once started, the completion of the city was very fast.
    Brazil was declared a republic in 1889. The first Constitution in 1891 determined the
selection of the site for the eventual capital city. In 1922, the National Congress approved
the creation of the new capital within a site that was then called Quadrilatero Cruls, a
160 x 90 kilometer rectangle located in the Central Upland (Planalto Central) close to the
border of the state of Goiania with the state of Minas Gerais.10 This area would eventually
become Brasilia. The transfer of the national capital to the interior was delayed during
the Getulio Vargas’ administration (1930-1946), but it resumed in 1947, when Eurico Dutra
became president. At that moment, new debates over the site and construction of the new
capital arose. Finally in 1955, based on previous reports, the recently created Commission
for the New Federal Capital delineated the area in which Brasilia would be placed. The
president elected in 1956, Juscelino Kubitschek (1956-1961), carried out the construction
of Brasilia and created the Company for Urbanization of the New Capital (NOVACAP).
The work on the site began in that same year under the supervision of Israel Pinheiro.
After three years and ten months, Brasilia was officially inaugurated in April 21st, 1960.


4.2    The roads connecting the new capital to the rest of the country
The construction of Brasilia in the interior of Brazil lead to population and development
of the interior regions, known as the ”westward march” (marcha para o oeste). The devel-
opment of a new highway system connecting the new capital to the other parts of the
country was crucial in this process.
    Before 1951, the few existing roads already in place were limited the the coastal areas
of the Southeast and Northeast. As a result of transferring the capital to a previously
unexplored site, roads had to be built in order to transport workers and construction
materials. Between 1951 and 1957, the Brasilia-Belo Horizonte line was laid, connecting
   9 Brazilis not alone in solving the capital-city location problem by constructing an entirely new city.
Other countries that have employed this strategy include Australia (Canberra), Belize (Belmopan), Burma
(Naypyidaw), India (New Delhi), Kazakhstan (Astana), Nigeria (Abuja), Pakistan (Islamabad) and the
United States (Washington, D.C.).
  10 For comparison, this is a land area approximately equal to the size of the state of Connecticut, and ten

times the size of New York City.


                                                     17
the soon-to-be new capital to the capital of the state of Minas Gerais. In the same period,
parts of the Brasilia-Anapolis highway had been implanted, a road that would link the
new capital to the city of Sao Paulo. There were also plans to built the 2,276 kilometers-
long Belem-Brasilia, or Transbrasiliana, which for the first time would provide an overland
route from the underpopulated Northern states to the demographic and industrial centers
of the country located in the South.
   The directions for building the new roads were set by the many transportation projects
designed over the years, the so called Planos Nacionais de Viacao (PNVs). During the
Getulio Vargas’ government, the transportation projects started to contemplate the high-
way system (PNVs 1934 and 1944). But it was during Juscelino’s administration, which
introduced the automobile industry and transferred the national capital to the interior,
that the country experienced a boost in the development of highways (PNV 1956).
   In particular, these plans determined that the roads were to be built in order to con-
nect the new capital city to the capitals of the other Brazilian states and the North to the
South.11 This new highway network, known as radial highways, is illustrated in Figure
1. The roads run radially from Brasilia towards the country’s extremes in eight direc-
tions, North, Northeast, East, Southeast, South, Southwest, West, and Northwest. We
exploit the development of the radial highway network to generate exogenous variation
in access to road infrastructure. Municipalities in the path between Brasilia and the state
capitals were more likely to be served by roads after the transfer of the capital city.
   One concern with using the realized roads directly is that the cities connected to the ac-
tual radial network were chosen based on their economic attributes. Road placement may
have favored cities that showed more economic potential. Conversely, the government
may have decided to place the roads to connect remote areas to the already established
urban centers in order to fulfill its “westward march” goals. The direction of the bias is
not clear in the Brazilian context. To address this issue, we predict actual access to roads
by constructing the minimum spanning tree (MST) network that connects Brasilia to the
other 26 state capitals, following Faber (2014). We assume that the planners’ goal was to
have a highway network running in eight directions: North, Northeast, East, Southeast,
South, Southwest, West, and Northwest. The resulting network corresponds to the net-
work that planners would choose if their goal was to connect all the capitals through the
  11 The state capitals, excluding Brasilia, are: Aracaju, Belem, Belo Horizonte, Boa Vista, Cuiaba, Campo
Grande, Curitiba, Florianopolis, Fortaleza, Goiania, Joao Pessoa, Macapa, Maceio, Manaus, Natal, Palmas,
Porto Alegre, Porto Velho, Recife, Rio Branco, Rio de Janeiro, Salvador, Sao Luis, Sao Paulo, Teresina, e
Vitoria.



                                                   18
shortest distance path.
   We use ArcGIS to compute the MST network. First, we use the latitude-longitude
coordinates to create point features representing the location of Brasilia and the 26 state
capitals. Next, we divide the country into 8 exogenous slices, and consider the optimal
network connecting the cities within each slice. We do this to avoid exogenous choice
in which capital cities were connected to Brasilia. We proceed by creating an imaginary
pie sliced into eight parts and centered around Brasilia. We form eight 45 degree slices
starting from North and moving clockwise. Then, we classify the 26 state capitals into
eight groups, according to the location of their bearing with respect to Brasilia. We use
the Spanning Tree Tool, in Arcmap, to find the minimum spanning tree connecting the
states in each of the eight groups.12 Figure 1 shows the resulting predicted network.
Our exogenous measure of access to road network is the straight line distance from the
centroid of each county to the nearest road that is is part of the predicted MST network.13
   The distance to MST network is a strong predictor of actual access to road network, as
shown in Appendix Table 1. Access to road network is measured using the distance from
each municipality to the nearest paved road in place in the years 1960, 1970, 1980, 1990,
and 2000. Column (1) shows that the elasticity of distance to paved roads to distance to
MST network is 0.11 (and it is statistically significant at 1% significance level). Looking at
Column (2) we can see that the result is robust to adding controls to municipality area (in
square km), distance to nearest big city, and distance to Brasilia – elasticity is 0.148. Being
connected to the MST network is associated with a 11.1 percentage point increase in the
probability of being served by a road. After including controls, the coefficient is still large
and significant and indicates an increase of 16.3 percentage points in the probability of
having a road. Note that our instrument cannot predict changes over time in access to a
road. Therefore, we use the time-varying distance from a paved road as the dependent
variable and include year fixed effects to capture the overall level of road access in a given
year.
   One might be concerned that the transfer of the capital did not occur for random rea-
sons, since the government had the clear goal to populate the remote cities located in the
middle of the country. We argue that our variation in road access does not come from the
location of the new capital. Instead, it comes from the fact that, due to the radial highway
network, the cities that happened to be on the path between Brasilia and the other state
capitals were more likely to be connected to the network. Another concern could be with
  12 The  tool uses Prim’s algorithm to design the euclidean minimum spanning tree.
  13 We   use the Near tool, available in ArcGIS, to compute the near distances.

                                                    19
the endogeneity of the endpoints of the network, which consist of large cities. To check
this second concern we have rerun the analysis dropping all migration pairs that contain
a state capital; the results are robust (results available upon request).


5      Municipality Level Database
We construct a regional database of migration, wages and roads at the municipality level
between 1970-2010. Summary statistics for the regional database are presented in Table
1 (the summary statistics separated by year are in Appendix Table 2). The primary data-
source is the individual data files from the Brazilian Census, 1970-2010, collected by the
Brazilian Institute of Geography and Statistics (IBGE). Our sample of interest is males
aged 20-65 who report non-zero earnings in their main occupation. All nominal variables
are converted into constant 2010 prices; the exchange rate between the USD and Real is
approximately 1 USD = 2.3 BRL.14


5.1         Employment and wages
Wage data are sourced from the census. The census asks both the average earnings per
month in the main occupation,15 as well as the usual hours worked. We use earnings
from main occupation and the hours worked to construct an equivalent hourly wage
rate. This wage rate is 7.6 BRL on average. This average wage matches well to GDP
estimates. Assuming a standard 2000 hour work year, the annual wage of 7.3 BRL in 1970
and 9.0 BRL in 2010 would be equivalent to annual incomes of $3000 and $7800. The per
capita GDP figures for Brazil are $2400 in 1970 and $5600 in 2010 (World Development
Indicators).
     Nearly 65% of the population report being employees rather than self-employed. The
share working in agriculture is about 26%. The high proportion of self-employed people,
particularly in agriculture, may generate concerns that the wage we compute does not
accurately reflect actual income. To check for this issue, we use detailed municipality
level agriculture input and output data collected in agricultural censuses to show that
self-reported income in the population census is highly correlated at the municipality
level with agricultural profits (For details, see Appendix B.1).
    14 We
        constructed a modified consumer price index that accounts for changes in the Brazilian currency
that occurred within the period under analysis. All nominal variables were converted to 2010 BRL. See
http://www.ipeadata.gov.br/ for the factors of conversion for the Brazilian currency.
  15 The exception is 1970, where only total earnings, rather than earnings in the main occupation, is asked.



                                                     20
5.2    Migration
The current location of the individual is coded to the municipality level. From 1980 loca-
tion 5 years ago is also coded to the municipality level. We are able to match the previous
location at the municipality for 99.2% of the population (96% of people who report liv-
ing in a different municipality 5 years ago.)16 The inter-municipality migration rate is
12% in our sample. Of these moves, 60% (i.e. a migration rate of 7.2%) were between
meso-regions.
    A focus of our paper is to examine the spatial equilibrium of migration in a model with
many locations. This is important because internal migration is more complex than sim-
ply rural-urban migration: using these data, 16% of all migrants are rural-rural migrants
in 1980; 41% are urban-urban migrants; 35% are rural-urban and 6.8% are urban-rural
(numbers not reported in table but available upon request from authors). Our spatial
model will capture the heterogeneity in migrant destination by studying the locational
choice over N locations.
    Table 2 shows the migration flows by year. We compute both the gross migration
rate (migration in any direction), as well as the net migration rate. As in Artuç et al.
(2010), the ratio of net to gross population flows will turn out to be informative about the
idiosyncratic reasons to migrating (such as preference shocks), compared with common
reasons to migrate (such as a positive productivity shock in one location). If it is the case
that everyone agrees about where to migrate, then we should see that net migration is
equal to gross migration. On the other hand, if it is the case that people are migrating
entirely due to preference shocks, then we should see that net migration is zero and gross
migration is much larger than net migration. The net/gross ratio gives some information
about the direction of migration flows; this ratio is approximately 0.4 in Brazil.
    Figure 3 shows the migration inflow, the migration outflow, and the net migration flow
for Brazil’s aggregated regions. This figure highlights the extra information in the gross
migration data. All five regions have substantial amounts of in-migration and substantial
amounts of out-migration. The diagrams show an initial population movement away
from the South of Brazil into the Central-West between 1980-1990. By 2000 all five regions
have net migration rates that are close to zero but this hides substantial amounts of gross
migration (e.g. the Southeast) and lower levels of gross migration (e.g. the North).
    The relationship between bilateral (gross) migration and bilateral distance is shown in
  16 Forthe other 4%, the location is given at the state, not municipality, level. Fewer than 0.05% of the
population report living abroad 5 years previously, so we ignore international migration.



                                                   21
Figure 2. The first two graphs are plot of the (residual) migration flows against the travel
distance. Conditional on destination fixed effects, there is a clear negative relationship
between travel distance and migration. This relationship weakens when we condition on
the straight-line distance between origin-destination pairs, but it is still negative. Gross
migration flows are also inversely related to straight-line distance, with and without con-
ditioning on travel distance. Overall, the data show that places which are closer and/or
more connected through the road network experience larger inflows and outflows of peo-
ple.


5.3    Rents and Costs of living
To convert nominal wages into real wages, we need to construct measures of the cost of
living across space. Unfortunately, consumer price data is not collected at the munici-
pality level. We instead construct costs of living using the best data sources available: a
consumer price index collected at 10 cities in Brazil, and housing prices collected in the
population census.
   The national consumer price index is a data series collected by IBGE for 10 locations
across Brazil. For each AMC, we merge to the closest price collection point. In the analy-
sis, we will make an adjustment sourced from equations linking the ability of a region to
trade with other regions and source cheaper products to generate a measure of the change
in price indices. Second, we use rental rates from the population census. Approximately
17% of our sample report paying rent to live in their accommodation.
   For rental rates we use census data on the rents paid for housing. The mean rental rate
for one bedroom is 321 BRL a month, equivalent to 42 hours of work at the mean wage.
We show in Appendix B.2 that rental rates are positively correlated with the relative price
index. 17% of the population report paying rents for their housing. While this may seem
low, the equivalent number for US houses in 2005 is 24%. We run the estimation under
several different definitions of the rental variables, including hedonic pricing to impute
the cost of non-rented units, and find that the results are robust across definitions of the
housing cost variable.


5.4    Road data
Our geographic data come from two sources. We obtained vector-based maps from the
highway network for the period 1960 to 2000 from the Brazilian Ministry of Transporta-


                                            22
tion. These maps were constructed based on statistical yearbooks from the Ministry’s
Planning Agency, previously known as GEIPOT. We used the ArcGIS software to georef-
erence the maps to match real-world geographic data. The geographic coordinate system
applied to the maps is the SIRGAS 2000.
    The second source of data is the IBGE, which provides municipality boundaries maps
in digital format. We use the municipality boundaries from 2000 and apply the crosswalk
that maps the municipalities that existed in 2000 into AMCs. We then aggregate the AMCs
up to meso regions. Due to overlap with AMC boundaries, we need to combine two sets
of two meso regions, creating 135 adjusted meso regions. This will be our primary unit of
analysis for the spatial component.        17

    Similar to the road data, we applied the coordinate system SIRGAS 2000 to the AMC
and meso-region boundaries. Finally, in order to compute geographic distances in kilo-
meters, we projected the maps using the Brazil Mercator projection.
    In our migration cost function, we use two variables to measure the cost of moving
between two locations. The first variable is the Euclidean distance, which is computed
using the latitude and longitude coordinates of each origin-destination pair. The second
variable measures the distance between origin-destination pairs taking into account the
actual road coverage. To compute the latter, we use the fast marching algorithm, follow-
ing the approach used in Allen and Arkolakis (2014).18 First, we generate a picture of
the road network and the location of the 135 meso-regions. This picture is converted into
pixels and a travel speed is assigned to each pixel. Pixels corresponding to a paved road
are assigned a travel speed of 100, whereas pixels outside the road network are assigned
a travel speed of 0.00001. Essentially, this algorithm finds the shortest route, traveling on
roads, between two locations, with the minimum off-road traveled to connect a region
without a road to the road network. The outcome is a 135x135 matrix where each entry
corresponds to the fastest arrival time between a origin-destination pair. We undertake
the same exercise for our predicted highway system (the MST network) to find an instru-
  17 The crosswalk file can be obtained from http://www.ipeadata.gov.br/. For cases where is overlap
between the AMC and the meso region we assign the AMC to the meso region which has the largest number
of 2010 component municipalities. We then group together Madeira-Guapore and Leste Rondoniense (both
in Rondnia) and Sul de Roraima with Norte de Roraima (two meso regions in Roraima).
  18 The fast marching algorithm finds the solution to the Eikonal equation used to characterize the prop-

agation of wave fronts. The algorithm uses a search pattern for grid points in computing the arrival times
(distances) that is similar to the Dijkstra shortest path algorithm (Hassouna and Farag (2007)). However,
because the fast marching algorithm is applied to a continuous graph, it reduces the grid bias and generates
more accurate bilateral distances.




                                                    23
ment for the actual bilateral cost using the travel time on the exogenous road network.19
For each year, the bilateral distances were normalized using the travel distance between
the nothernmost and the southernmost meso-regions as a nummeraire. The value used
when estimating the model is the predicted values from a regression of the actual bilateral
distances on the MST bilateral distances, including year fixed effects.


5.5      Geographic Units
Municipality boundaries change over time. In order to analyze the same geographical
area, we use data aggregated to two geographical regions. The first are the minimum
comparable areas (areas minimas comparaveis) constructed by the Institute of Applied Eco-
nomic Research in Brazil. We refer to these units as AMCs, or municipalities for short
hand. There are 3659 AMCs in Brazil in the period 1970 to 2000. The second unit of anal-
ysis are meso-regions. Meso-regions are statistical regions constructed by the Brazilian
Institute of Geography and Statistics (IBGE). There 3659 were grouped into 137 meso-
regions; we merge two of these meso regions together because of overlapping munici-
pality boundaries. This leaves us with a final sample of 135 regions. We present statistics
where possible at the finer level of geography; however, it is not possible to estimate a dy-
namic choice model over 3659 dimensions, and so for the estimation of the spatial model
we instead use the coarser geography.



6       Estimation results
This section reports the estimates from the two-step estimation procedure. The first step
of the estimation procedure estimates the components of the migration cost function. The
second step estimates the migration elasticity to wages and the housing supply elasticity.


6.1      First step: components of the migration cost function
The first step results yield four key results:

     1. The observed component of migration costs are between 0.8 and 1.2 times the aver-
         age wage.
    19 See   Section 4 for details on the MST network.




                                                         24
   2. The observed migration cost overstates the incurred migration costs because people
         migrate shorter distances and also migrate when they receive large enough positive
         utility shocks. On average, incurred migration costs are negative (i.e. there is a gain
         to migrating) of between 0.3 and 0.6 times the average wage.

   3. The level of observed migration costs are very stable in levels across demographic
         groups. As a share of average wage, the observed costs are largest for low-skilled
         young people, and lowest for high skill old people. Once the unobserved costs are
         taken into account, low skilled young people receive the largest gain from migrat-
         ing.

   4. 16% of the observed cost for moves that occur are marginal costs rather than fixed
         costs. Of these marginal costs, the bilateral travel time distance is 61% of the marginal
         cost (9.6% of overall migration cost). This suggests a role for infrastructure policy to
         affect the migration choices and allocation of labor across space.

   We report the results from the first step linearization of the migration choice equation
(Equation 14) in Table 3.20 The unit of observation is a bilateral-region-year pair (the share
of population from origin j who moved to destination k in year t) or a bilateral-region-
birthstate-pair (the share of population from origin j and who were born in state s who
moved to destination k in year t). People who do not move are included in the regression
as the bilateral share from origin j to destination j. As per Equation 14, we add a full set
of origin by year (Π jt ) and destination by year fixed effects (Vkt ).
   Starting with Column (1), the components of the migration cost have the expected
sign. There is a fixed cost to migrate, reflecting any dislike of moving (coefficient of −7.2).
The bilateral distance is negative and significant showing that traveling a longer distance
is more costly (coefficient of −0.0011). In the OLS regression the bilateral travel time is
positive, suggesting that locations that places that take longer to travel between, control-
ling for the bilateral distance, have more migration flows between them (coefficient of
0.37).
   We are concerned about endogeneity of road placement. This endogeneity could go in
either direction. If it were the case that places that have unobserved demand for migra-
tion (e.g. two locations that are more culturally similar), then we would expect that roads
will be positively correlated with migration, leading to a negative bias on the travel time
coefficient. On the other hand, if roads are connecting places that are less likely to have
  20 Estimates   by each year are presented in Appendix Table 4.


                                                     25
unobserved demand for migration (such as government policy that connects lagging re-
gions to the road network) then we would expect to have the opposite bias. Column (2)
estimates the IV specification where we instrument the bilateral travel time between two
locations with the bilateral instrument. The F statistic for the instrument in the first stage
regression is between 28-39 depending on specification (the first stage is reported in Ap-
pendix Table 3.) The IV results switch the sign on the road coefficient. This is consistent
with the source of endogeneity in this context being the second type: locations that are
unobservably less appealing are more likely to be connected the road line, which is con-
sistent with government policy at the time to encourage the “westward march” towards
the center of Brazil. The bilateral travel time is now negative and significant (coefficient
of −32.1). The bilateral distance remains negative and significant but reduces in magni-
tude (coefficient of −0.00029). This makes sense: if the only reason why distance matters
is because of the time to travel, then all of the variation should be absorbed in the travel
time variable and distance should not independently affect migration. The small nega-
tive effect of distance is consistent with distance being correlated with other determinants
of migration, such as climatic or cultural similarity, that grow as distance increases. The
fixed cost of migrating reduces in magnitude but also remains negative and significant
(coefficient of −2.95).
   Our results show an important role for infrastructure that has not been well studied:
facilitating the movement of labor to where their returns are highest. The negative effect
of travel time on migration decisions has key implications for policy. Neither a dislike of
moving nor Euclidean distance are variables that are under the control of policy makers.
However, distance on a road is a policy-relevant variable. The results suggest that one
benefit of increased infrastructure is to facilitate the movement of people across space.
   Columns (3) and (4) reestimate the model allowing for individuals to gain utility from
living in their state of birth. While gross migration flow data are rarely available in popu-
lation censuses, often state of birth is recorded and is used as a proxy variable for migra-
tion costs (e.g. Diamond (2016)), so it is reassuring to see that the bilateral components
of migration cost are robust after controlling for birth origin. The bilateral distance is
negative and significant, and then bilateral travel time is negative and significant.
   One other important issue, common to many migration studies, is that the migration
matrices are sparse (many bilateral pairs do not have people moving between them). In
our setting, 43% of region-pair-year observations have zero flows. Excluding the pairs
with zero observed flows could introduce a sample selection bias. To investigate whether


                                             26
this extensive margin affects our estimates, we reestimate the model with the dependent
variable as log(π jkt + 0.001).21        22   The results are in Columns (5)-(8) of Table 3. The
migration cost estimates are robust across the specifications. The fixed cost remains neg-
ative and significant and the bilateral travel time remains negative and significant. Once
we control for state of birth and travel time the coefficient on bilateral distance is close to
zero (22e−5 ) and statistically insignificant, suggesting that all of the variation is accounted
for in the direct travel time cost and the preferences for living in a region in the state of
birth.
    To illustrate the magnitudes of the migration cost estimates we decompose the total
migration cost estimates into its components in Table 4. The table has two panels. The first
panel shows the cost decomposition over all possible moves. The second panel shows the
cost decomposition over moves which actually occur.
    Starting with the first panel, the average bilateral migration cost is 9.1 BRL. This is 1.2
times the average wage of 7.6 BRL. If we convert this cost into wage units using a marginal
utility of 5.6 then the cost is estimated to be 198 BRL.23 The fixed cost is the dominant
component representing 54% of the total cost. The contribution from the bilateral distance
is 6% of the cost and the travel time is 40%. The unobserved extreme value preference
shock has the same mean across all locations and so on average the contribution of the
unobserved component of the cost is zero.
    However, migration is more likely to occur between pairs that have lower migration
costs and between pairs in which the net unobserved shock an individual receives is large
and positive. The overall estimates therefore overstate the costs of moving. In the second
panel of Table 4 we present the decomposition of migration costs for moves that actually
occur in the data. Observed migration moves are shorter in distance than the average
move. This is seen by the level of the observed migration cost falling (5.04 compared to
9.1). Second, following Kennan (2006), the mean unobserved component of the cost for
  21 Results  are not sensitive to the choice of the small constant to add to the zero flows; results available
upon request.
   22 The trade literature has developed non-linear estimation methods for estimating models with zero

flows, such as the Poisson pseudo maximum likelihood estimator (Silva and Tenreyro, 2006; Tenreyro,
2009)). However, these models present substantial computational challenges to incorporate endogeneity
of the form we model. To run our specification in a non-linear model we would need to integrate over
the unobserved bilateral shocks (which have dimension 18,255 (1352 )) which would be extremely compu-
tationally intensive. The linear specification allows standard IV estimation to be used.
   23 This calculation finds x such that cost = α log ( x ).
                                                  w




                                                      27
people who choose to move from j to k is given by:24

                                                                                         ln π j j
      − E(ik |choose k) − E(i j |don’t choose j) =        Vk − V j − (c jk − c j j ) +          .
        |                  {z                    }          | {z }     | {z } 1 − π j j
                        unobserved cost                   average return   observed cost


    Using this formula, we can separate out the unobserved cost from the observed cost.
We do this in the second panel of Table 4. The first thing to note is that the unobserved
component on the migration cost is large: it is -1.5 times the total observed cost. As a
result, the net migration cost between two pairs is actually negative (-2.35 in our baseline
specification). We decompose the observed components of the cost in the same way as
earlier. Compared to the first panel, moves that occur are those that are closer, and so the
fixed cost is a larger component of the total cost (69% vs 54%). The component due to
distance is 3.5% and the component due to travel time on roads is 27.7%.
    Although the incurred migration cost is negative, this does not mean that migration
costs are not important. Rather, the larger the observed component of the migration cost,
the larger the unobserved shock will need to be in order to induce someone to move.
Pairs with lower bilateral costs of moving will have larger migration flows between them
because it is more likely that someone has a large enough preference shock to compensate
for the cost incurred, all else equal.
    The remainder of Table 4 carries out robustness exercises on the migration cost. We
first estimate the model separately for different demographic groups.25 Related literature,
mostly in the US, has found that older people and lower skilled people are less likely to
migrate (Notowidigdo, 2013; Schulhofer-Wohl and Kaplan, 2015). In Brazil, we find that
migration rates are higher for young people, but do not depend on their level of educa-
tion: the migration rate of younger people (defined as below median, approximately 35
years in the sample) is 9%, compared to the migration rate of older people of 5%. How-
ever, the migration rates of low skilled (defined as below-median level of education in
each census year) are comparable to the migration rate of high skilled people: young low
skilled people migrate at a rate of 9.4%, compared to the migration rate of 9.1% for young
  24 Details     on how to compute unobserved costs are in Appendix C. In our setting, the unobserved term
will contain both the i.i.d. error term as well as the bilateral-pair unobserved term from the first step
ξ jkt − ξ j jt .
   25 The spatial equilibrium model we propose assumes homogenous labor force and does not allow for

migration costs to be different across demographic groups. A full treatment of heterogeneity in migration
responses to changes in moving costs requires extending the spatial equilibrium model to accommodate
different types of labor in the local production function. Nonetheless, for estimating differences in the
magnitudes of these costs, we do not need to make assumptions about the production function.


                                                   28
high skilled migrants (old low skilled migrate at a rate of 5.1% compared to a rate of 5.4%
for old high skilled).
   Differential migration rates can either be explained by differential costs of moving or
differential returns to migrating. The estimated migration costs by demographic group
are remarkably stable: from the first panel, these range from 5.3 for young low-skilled
to 5.8 for young high-skilled (for the moves that actually occur, the range is -3.9 to -4.7).
However, these costs represent a very different proportion of the average wage. For ex-
ample, for low-skilled young people, the observed cost over all possible moves is 5.3 BRL,
2.4 times their average wage (converted into wage units this cost is 2.8, 80% of the mean
wage). The incurred cost for moves that occur is -4.7 (-2.4 in wage units, or 65% of their
wage.).
   Accounting for the utility people have when they live in their state of birth reduces
the migration cost: the average cost falls from 9.1 to 6.4, and the average incurred cost
falls from -2.4 to -4.4. On average, slightly more people move from a region that is in their
state of birth to a region that is out of their state of birth than the opposite direction, and
so the average incurred cost for the change in birth utility is positive (and many people
move from one region in their state of birth to another region also in their state of birth
so do not incur any change in their component of their utility, contributing zero for this
piece of the cost). Controlling for utility from living in the state of birth increases the
fixed component of the migration cost for moves that incur from 69% to 84%, reducing
the component due to travel time from 28% to 10%.


6.2     Second step: estimation of elasticities
The second step of the estimation procedure decomposes the common component of util-
ity found in the first step to identify the housing supply elasticity and the migration elas-
ticity to wages in Equations 17 and 16. We estimate these elasticities in a model allowing
for bilateral costs and compare the estimates in a model that is estimated without bilateral
costs. We then extend the model to allow for endogenous local prices and show that the
key elasticities remain stable.


6.2.1   Baseline estimates

First, we show reduced form estimation of the housing supply elasticity and the popula-
tion elasticity to wages in Table 5. We present results that take the long-run change in the


                                              29
population and housing supply over the period 1980-2010. On average, regions that had
an increase in wages had an increase in population (elasticity of 1.49), and regions that
had an increase in population had an increase in the rental price of housing (elasticity of
0.88). However, these reduced form elasticities do not take into account the heterogeneity
of migration responses depending on the market integration of the region and also do not
take into account the composition of migration flows due to individual preferences to live
in their state of birth. To separate out the population response due to returns (different
wages in regions) from the population response due to costs (the ease of accessing specific
regions, and the implied cost for people to move out of a region in the state of their birth)
it is necessary to separate our returns from costs. This separation of the determinants of
migration into costs and returns is exactly the exercise done in the first step.
    Taking the estimated level of indirect utility estimated in the first step, we then use the
Bartik instruments and Bartik instruments interacted with the labor market integration
measure to identify the elasticities. The results are in Table 6. Column (1) presents the
baseline results from our model which allows for bilateral costs of migration and prefer-
ences to live in the state of birth (as well as unobserved preference shocks for each region).
We estimate a housing supply elasticity of 0.88 and a migration elasticity to wages of 6.1.
The migration elasticity to rents has been normalized to -1.26


6.2.2     Comparisons to a model without migration costs

Due to data limitations, the majority of spatial equilibrium models are estimated using the
current allocation of people across space (potentially allowing for preferences of living in
the state of birth, which is data that is often contained in census datasets). We would like
to make comparisons between our model, which is estimated on gross migration flow
data, and an alternative model that uses only net migration flow data.
    We reestimate our model on the same data assuming that we only know the current
location of all individuals and not their previous location. This modifies equation 9. The
probability that an agent, born in state s, chooses to live in location k at time t is now
  26 To separately identify the elasticity of utility to housing prices it would be necessary to have a separate
instrument that moves housing prices independently of wages. The standard approach in the literature
is to use instruments that capture geographical constraints to city expansions, following Saiz (2010). We
have constructed these variables for Brazil but do not find that housing prices respond to geographical
constraints in any consistent way. One explanation could be that our unit of observation, the meso region,
contains both urban and rural components and the geographical variation is not binding over the whole
region. Results available on request from authors.




                                                      30
given by:
                                               exp(Vkt + I(k ∈ Sb )Vb )
                                 πskt =    M
                                          ∑m =1  exp(Vmt + I(m ∈ Sb )Vb )
    We then take the estimated level of indirect utility estimated assuming a “no-cost”
model and do the same decomposition, using the Bartik instruments and Bartik instru-
ments interacted with the labor market integration measure to identify the elasticities.
The baseline result is in Column (3). We find consistent elasticities: the housing elasticity
is slightly higher (0.93 compared with 0.88) and the migration elasticity is slightly lower
(4.94 compared with 6.1), but the elasticities are robust across specification.27


6.2.3   Extension allowing for tradeable goods

Another concern with the estimates in Columns (1) and (3) is that time-varying prices are
an omitted variable, and one that is correlated with the connectivity of the location. To
address these concerns we estimate an extension of the model which allows for trade in
goods. We add in costly trade to our model, following Eaton and Kortum (2002); Redding
(2015). The model is presented in Appendix D.
    The key adjustment required to our estimating equations is to construct a market-
access variable and use this variable to adjust wage shocks to capture the local “pass-
through” of productivity shocks into local prices. This requires estimating a model of the
cost of trading goods across space. We specify the trade cost function as:

    d jkt = β1 Euclidean distance jk + β2 traveltime on road jkt + β3 rail distance jkt , ∀ j 6= k

where d jkt ≥ 1 is the shipping costs, measured as the amount of the good that needs
to be shipped so that one unit of output from j arrives at k. The trade cost function is
identified from bilateral gross trade flows. We use interstate trade flows.28 We allow for
  27 The bartik shock instrumented with migration cost only makes sense within the model for the migration

cost estimates and not the model without migration costs. Results are robust for the elasticities if we use
only the Bartik shock instrument for the no cost model; results available upon request.
   28 We source internal trade data for Brazil from two sources. Internal trade data is only available at the

state level. For 1970, we source internal trade data for Brazil from the Anuario estatstico do Brasil (IBGE,
1972), which is based on data from the Comercio Interestadual por vias Internas. The survey provides infor-
mation on the quantity (in tons) and the commercial value of exports and imports by type of goods and
destination states. For the year 1999, we use data from de Vasconcelos and de Oliveira (2006), consisting
of interstate bilateral flow data are derived from information on state tax. The state tax is the Imposto sobre
Operacoes relativas a Circulacao de Mercadorias e Prestacao de Servicos de Transporte Interestadual e Intermunicipal
e de Comunicacao, or ICMS. This is a tax changed when there is movement of goods, transportation, and
communication services between states.



                                                        31
trade costs to depend on traveltime on roads and also on the railroad connection between
two states. The results are in Appendix Table 5. In all specifications, Euclidean distance is
negative and statistically significant. The then use the implied measure of d jkt to compute
a measure of market access at the meso region. For destination k, the elasticity of prices
in k to own productivity shocks in k are given by:

                                                 −1    1
                                   Pkt ,wkt =
                                                 θ ∑m∈ M d−θ
                                                          mkt

    This index gives the elasticity of the equilibrium price index in one location to changes
in the price of the good it produces. The distribution of this index is graphed in Appendix
Figure 1. The elasticity ranges from 0.32 to 0.5. Meso regions that are well connected have
a lower elasticity because they can trade easily with other locations, they export more of
the good they produce when they have a positive productivity shocks, and they import
more goods when their own goods are more expensive. Therefore, the pass through of
shocks into the CPI is smaller. However, meso regions who are not well connected, such
as in the North of the country with very little road access, or in the South of the country
where they are near the border with Uruguay and Paraguay, have much lower market
access, and hence, a higher elasticity of the consumer price index to own-productivity
shocks.
    We interact this measure of market access with the wage variable to capture the en-
dogenous response of local prices to local productivity shocks. We include our price
correction index in Columns (2) and (4) of the second step estimation in Table 6 to check
robustness to tis extension. Both elasticities are stable across specification: the migration
elasticity reduces slightly in the bilateral cost specification from 6.1 to 5.3 and from 4.9 to
4.3 in the no-cost specification, and the housing price elasticities are 0.88 and 0.92 in the
cost and no cost models respectively.



7     Implications for regional heterogeneity
We now turn to analyzing the implications of costly migration for understanding the
process of spatial adjustment in the economy. We quantify two major effects of costly
migration:

    1. Costly migration generates substantial regional heterogeneity in the population elas-
      ticity at the regional level. Regions that are well connected have a high population

                                                 32
      elasticity to wage shocks; regions that are poorly connected have a low population
      elasticity. This heterogeneity is missed in models that do not include bilateral costs
      of migration.

  2. The incidence of economic shocks will depend on whether or not migration is costly.
      Without costly migration, the incidence of shocks to wages, housing or amenities
      is equally distributed amongst the national population. With costly migration the
      incidence is borne by those who are either living in or close to the affected region.
      This has important implications for place-based development policy.


7.1   Costly migration induces regional heterogeneity
How do migration costs affect how the economy adjusts to economic shocks that occur
in different locations? In the model, the population in location k depends on the initial
allocation of labor across space and then the responsiveness of labor in each location to a
specific shock in another location:


                                  Lkt =   ∑ π jkt (w, r, x) N j,t−1
                                           j

   The elasticity of population in location k to an own-wage shock is given by

                                                   ∂π (w,r,x)
                                                    jk
                               ∂ log( Lkt )   ∑j     ∂wk      N j,t−1
                                            =
                                  ∂wkt           ∑ j π jk N j,t−1

                                                                        ∂π jk (w,r,x)       ∂πk (w,r,x)
   In the case where there are no bilateral costs of migration              ∂wk         =      ∂wk        ∀ j, and
the population elasticity simplifies to

                                   ∂ log( Lkt )
                                                = α (1 − πkt )
                                      ∂wkt
   With bilateral costs of migration there is no closed form for the elasticity, so we com-
pute this by simulation within the model: for each region we shock the wage rate by 10%
and then recompute the allocation of labor across space in response to this initial shock.
We show the results in Figure 4. When the model is estimated without bilateral migration
costs the elasticity is (almost) constant across space. The average partial equilibrium elas-
ticity is 5.2, with a standard deviation of 0.07. In contrast, when migration has bilateral
costs, there is a distribution of elasticities. The mean elasticity is 4.2, with a standard de-


                                                 33
viation of 1.5. This reflects the heterogeneity in labor market access: places that are well
connected to other locations experience larger inflows to a wage shock generating a large
elasticity. In contrast, places that are very isolated have very little population response to
shocks and so have a very small elasticity. We show indeed that the correlation between
the estimated elasticity and the labor market connectivity is positive in Figure 5: a 10%
increase in the market access of a region increases the population elasticity by 5.6 percent-
age points. These results are consistent with those in Monte et al. (2015) who document
substantial regional heterogeneity at the regional level for the US as a result of costs of
commuting between regions.
   One additional point to note is that the partial equilibrium elasticities are much larger
than the general equilibrium elasticities. As a place experiences a positive wage shock
there is in-migration. This increases the housing price, reducing the gains from migration
and reducing the inflow. Not accounting for the general equilibrium effects of migration
therefore grossly overstates the responsiveness of population responsiveness to economic
shocks. We show this on the same Figure 4. The average general equilibrium response in
the model without migration costs is close to 3.0 (with a standard deviation of 0.03), and
the average general equilibrium response in the model allowing for migration costs is 2.7
(with a standard deviation of 0.8). This highlights the benefit of having a fully specified
model that can account for the spillover affects of economic shocks rather than restricting
the analysis to partial equilibrium effects.


7.2   Costly migration generates heterogeneity in the incidence of eco-
      nomic shocks
We next consider the distributional effects of a wage shock. Migration costs mean that
location is “sticky”: people are more likely to stay where they are and absorb the shock
that to move out of (or into) the region in response to the shock. As a result the incidence
of the shock will be differentially felt by those who are living in the location and those
who are outside the location. To illustrate these effects we simulate the heterogenous
incidence of the wage shock based on the migration behavior of individuals. For region
i, we look at the initial allocation of labor in time t − 1. We define those who live in
region i at time t − 1 as “local” and those who live outside region i as “non-local”. We
then compute the baseline migration between period t and t − 1 without the shocks for
the given realization of wages in the data. We compare this allocation at time t to the
allocation where region i is shocked by an additional 10% wage shock between at the end

                                               34
of period t − 1. This generates groups based on their migration choices under the two
regimes: (1) people who were initially not in region i in period t − 1, and then do not
move to i in either the baseline run or wage shock run (the “Non-local, never in”), (2)
people who were not initially in region i in period t − 1 and who did not move to region i
in the baseline specification, but did move with the wage shock (“Non-local, switch in”),
(3) people who were not initially in region i in period t − 1 and who move to region i in
both the baseline and the wage shock specification (“non-local, always in”). We define
groups (4)-(6) for those who start in region i in period t − 1 analagously.
    Table 7 shows the mean utility gain for each group of people for the wage shock.
Studying the first panel, Columns (1) and (2) examine the average increase in utility for
agents in the model with bilateral costs. The utility gain is composed of the net effect of
the increase in wages (and the related adjustment in the housing market as in-migration
occurs for the general equilibrium results), and any observed and unobserved migration
costs for those who change their migration decision. Agents who choose to live in i under
both the baseline and the increased wage gain only the common utility gain (in the table:
a gain in 0.51 utility units for the “non-local, always in” and the “local, always in” groups)
because their unobserved shock is the shock for location i in both scenarios. Agents who
choose to switch-in to region i give up some of their higher unobserved utility draw for
their previous location in exchange for the utility draw for region i, so their utility gain
is lower than for the individuals who were always inside the region. The locals who
switch in no longer pay a migration cost, so their utility gain is slightly higher (0.25 utility
units) than the non-locals who switch in (0.23). Finally, for those who don’t change their
migration decisions to live in i have a very small utility gain due to the slight increase
in wages and slight decrease in the house price through the general equilibrium adjust-
ment.29 Columns (3) and (4) repeat the exercise for the model without migration costs. In
terms of relative gains, the pattern looks similar to the case of the model without bilateral
cost. Here, the driving force is the unobserved utility shocks and not any differential di-
rect cost of migrating. Agents who were living in a different location in the baseline must
have had a high unobserved utility gain of doing so, and they give up some of this gain
to move into i. As a result, the average gain for the “local, switch in” and the “non-local,
switch in” are essentially the same (while in the case with bilateral costs, the “local switch
in” don’t have to pay the observed component of migration cost, while “non-local switch
in” pay the difference in the incurred migration cost).
  29 The partial equilibrium effects, not reported, are larger than the general equilibrium effects because

they don’t account for the increase in house prices.


                                                    35
    The key difference, however, is in the weighted incidence of the shocks. In the model
without costly migration the probability of migrating to region i is independent of where
the individual starts and so location the previous period (whether local/non-local) is in-
dependent of the location this period. The share of “local, always in” is therefore just
the overall share of ‘i’ s population, which, given there are 135 regions, is approximately
1%. In contrast when migration is costly the migration choice depends on the previous
location. This means that “locals” make up a much larger share of the population: 30%
on average. Therefore, the incidence of the shock is felt very differently across the two
models. The second panel of Table 7 highlights this. In the model with migration costs,
37% of the incidence of the shock falls on people who were initially in the region that is
hit by the wage increase. In comparison only 1% of the incidence is felt by the people who
were initially in the region if migration is not costly.


7.2.1   Application to Brazil’s “Minha Casa, Minha Vida” housing subsidy

Regional inequality is a key concern to policy makers. In many countries, including the
US, governments put resources into developing specific areas. While such policies will
have a direct effect on inhabitants, it will also have indirect effects on non-inhabitants,
depending on the elasticity of migration flows. When migration is costly there will be
heterogeneity in the response to policy for both the regions that are directly affected as
well as regions that are indirectly affected. The heterogenous incidence results have impli-
cations for understanding who will benefit from place-based policies, such as investment
in local economic areas. In a world where migration is costless, we would expect a large
migration shock and the benefits to be spread over more people; in contrast where mobil-
ity is limited, spatial economic shocks will be more felt by those who are initially in the
location.
    One example of such a place-based policy in the Brazilian context is the government
program “Minha Casa, Minha Vida” (“My house, My life”). This was a program imple-
mented in 2009 directed at low-mid income prospective home buyers who would like to
live in high-wage locations but cannot afford to do so due to higher cost of living. The
MCMV offered below-market mortgage rates. Because the MCMV program was targeted
at the low-income population only in larger cities it is likely to have a substantial impact
on the economy’s spatial equilibrium.         30

  30 The program offers subsidies and mortgage interest rates significantly below the market rates to house-

holds what meet eligibility criteria and who want to move to state capital or municipalities with more than



                                                    36
    We use our model to undertake a suggestive analysis of such a program in order to
highlight the differential incidence of such place-based policies across the nation. We ap-
proximate the housing support program by providing a 10% rental subsidy in the Brazil’s
three major cities: Sao Paulo, Rio de Janeiro, and Brasilia. We then recompute the new
spatial allocation of labor, focusing on which people will respond to this incentive. We
undertake this exercise for the model with and without costly migration.
    The results are stark. The population response is shown in Figure 6 which shows the
population change in both regions directly affected by the policy change (Brasilia, Rio de
Janiero and Sao Paulo) and other regions that are indirectly affected. The difference across
the two models is stark. In a world without costly migration the migration response is
independent of initial location. Therefore, population responds uniformly across space
to the rent subsidy: all locations other than the three main cities experience a popula-
tion decline of 2.1%, and the three main cities experience a population growth of 6.5%.
The picture looks very different when there is costly migration. On average, regions that
do not get a housing subsidy have a population decline of 1.9% but there is substantial
heterogeneity around this number. More than 10% of regions have a population decline
of 2.7%, while more than 10% have a population decline of one tenth of this level. This
heterogeneity is driven by the differential access to the locations with cheaper rents, de-
pending on origin.



8     Conclusion
How effective is place-based policy to address regional inequality? The key to answering
this question is to understand how labor migration decisions are made. The canonical
model to understand how regions respond to economic shocks assumes that migration
does not depend on origin-destination costs. If this were true, then we should see that
migration is independent of current location. In fact, in the data, the opposite is true:
50,000 people. Benefits vary according to income brackets. Households with monthly income up to BRL
1,800 (USD 500) are eligible for 100% finance at 0% interest rates and mortgage payments that range from 10
to 20% of the household income. This income bracket encompasses most of the program beneficiaries. For
households with gross monthly income up to BR 6,500 (USD 1,800), the government offers below-market
interest rates. Households whose gross monthly income ranges from BR 1,800 to BR 2,350 (USD 500 and
USD 650) are entitled to subsidies up to BR 45,000 (USD 12,390) and pay a 5% interest rate (less than half
the market interest rate for housing financing). Households with monthly income ranging from BR 2,350 to
BR 6,500 (USD 1,800) could be eligible to interest rates that vary from 6 to 8%. A full scope of this program
is outside this paper and is left to future work. For program details, the reader is referred to the Ministry of
Cities’ website http://www.cidades.gov.br/minha-casa-minha-vida.



                                                      37
people are more likely to migrate to locations that are nearby. In this paper we explore
the role of migration costs in facilitating labor migration across space and we then show
that this lack of labor market integration has key implications for the efficacy of place-
based development policy.
   To study the effect and magnitude of migration costs on labor mobility we construct
and estimate a spatial equilibrium model. Our model extends the standard spatial equi-
librium model (Roback, 1982) and allows for preference shocks for location (Moretti (2011)).
Our novel contribution is to include bilateral costs of migration. In the model agents op-
timally choose their location each period, paying a cost if they migrate. We estimate the
model with unusually rich data on 18 million inter-municipality migration decisions in
Brazil over the period 1980-2000. We parameterize migration costs by travel time using
the construction of a planned capital city, Brasilia, to generate plausibly exogenous vari-
ation in the cost of migrating (and in an extension, the cost of trading goods) through the
location of the national road network.
   We first document substantial costs of migration. The average observed migration
cost between two municipalities is equal to 0.8-1.2 times the annual wage; controlling for
the distance between two locations the travel time on the road contributes 10% of this
cost. We then illustrate the implications of costly migration. Compared to the standard
model without migration costs, we find: (i) the population elasticity of migration to wage
shocks depends on the the ease of accessing other labor markets. As such, the average
population elasticity hides substantial variation in the population elasticity of shocks, and
(ii) costly migration leads to highly concentrated distributional effects of regional shocks.
We estimate that the incidence of the same shock is more than 30 times larger for the local
population in the estimates from the model with costly migration than costless migration.
Both results have key implications for understanding the distributional impact of both
negative wage shocks, as well as any positive shocks such as place-based investment.
   Our paper shows an important role for infrastructure that has not been well studied to
facilitate the movement of labor to where its return is highest. Costly migration also con-
tributes a new mechanism to explain underdevelopment in many developing economies.
If it is costly to move out of low income locations labor may not be able to move to where
it is most productive. Likewise, costs of adjustment of other mobile factors of production
such as capital may also hinder the allocation of resources to where it would be most pro-
ductive. The aggregate effects of this misallocation, particularly for developing countries
where infrastructure is poor, is an potentially important mechanism to further explore.


                                             38
References
Allen, Treb and Costas Arkolakis, “Trade and the Topography of the Spatial Economy,”
  Quarterly Journal of Economics, 2014, 129 (3), 1085–1140.
Artuç, E, S Chaudhuri, and J McLaren, “Trade shocks and labor adjustment: A structural
  empirical approach,” The American Economic Review, 2010.
Banerjee, Abhijit, Esther Duflo, and Nancy Qian, “On the Road: Access to Transportation
  Infrastructure and Economic Growth in China,” 2009, pp. 1–22.
Bartik, Timothy J, “Who Benefits from State and Local Economic Development Policies?,”
  Books from Upjohn Press, 1991.
Berry, Steven, James Levinsohn, and Ariel Pakes, “Automobile Prices in Market Equilib-
  rium,” Econometrica, 1995, 63 (4), 841–890.
Bird, Julia and Stephane Straub, “Road Access and the Spatial Pattern of Long-term Local
  Development in Brazil,” 2015.
Bryan, Gharad and Melanie Morten, “Economic Development and the Allocation of La-
  bor: Evidence from Indonesia,” 2015.
  , Shyamal Chowdhury, and Ahmed Mushfiq Mobarak, “Under-investment in a Prof-
  itable Technology : The Case of Seasonal Migration in Bangladesh,” Econometrica, 2014,
  82 (5), 1671–1748.
Busso, Matias, Jesse Gregory, and Patrick M Kline, “Assessing the Incidence and Effi-
  ciency of a Prominent Place Based Policy,” American Economic Review, 2013, 102 (2),
  847–947.
Caliendo, Lorenzo, Maximiliano Dvorkin, and Fernando Parro, “The Impact of Trade on
  Labor Market Dynamics,” 2015.
Chein, Flavia and Juliano Assuncao, “How does Emigration affect Labor Markets? Evi-
 dence from Road Construction in Brazil.,” 2009, pp. 1–32.
de Vasconcelos, Jose Romeu and Marcio Augusto de Oliveira, “Análise da Matrix pop
  Atividade Econômica do Comércio Interestadual no Brasil - 1999,” IPEA DIscussion Pa-
  per, 2006.
Diamond, Rebecca, “The Determinants and Welfare Implications of US Workers’ Diverg-
  ing Location Choices by Skill: 1980-2000,” American Economic Review, 2016, 106 (3), 479–
  524.
Dix-Carneiro, Rafael and Brian Kovak, “Trade Reform and Regional Dynamics: Evidence
  From 25 Years of Brazilian Matched Employer-Employee Data,” 2014, pp. 1–55.
Donaldson, D, “Railroads and the Raj: Estimating the Economic Impact of Transportation
 Infrastructure,” American Economic Review (Forthcoming), 2016.

                                           39
Eaton, Jonathan and Samuel Kortum, “Technology, Geography, and Trade,” Econometrica,
  2002, 70 (5), 1741–1779.

Faber, Benjamin, “Trade Integration, Market Size, and Inudstrialization: Evidence from
  China’s National Trunk Highway System,” Review of Economic Studies, 2014.

Ghani, Ejaz, Arti Grover Goswami, and William R Kerr, “Highway to Success: The Im-
 pact of the Golden Quadrilateral Project for the Location and Performance of Indian
 Manufacturing,” The Economic Journal, 2014, 126 (March), 317–357.

Harris, John and Michael Todaro, “Migration, Unemployment and Develpment: A Two-
 Sector Analysis,” The American Economic Review, 1970, 60 (1), 126–142.

Hassouna, M S and A A Farag, “MultiStencils Fast Marching Methods: A Highly Accurate
 Solution to the Eikonal Equation on Cartesian Domains,” Pattern Analysis and Machine
 Intelligence, IEEE Transactions on, 2007, 29 (9), 1563–1574.

Hornung, Erik, “Railroads and Growth in Prussia,” Journal of the European Economic Asso-
 ciation, 2014, 13 (4), 699–736.

Hsieh, Chang-Tai and Peter J Klenow, “Misallocation and Manufacturing TFP in China
 and India,” Quarterly Journal of Economics, 2009, pp. 1–60.

IBGE, Anuario estatistico do Brasil - 1972 1972.

Kennan, J, “A Note on Discrete Approximations of Continuous Distributions,” 2006.

   and J Walker, “The Effect of Expected Income on Individual Migration Decisions,”
  Econometrica, 2011, 79 (1), 211–251.

Kennan, John, “Average Switching Costs in Dynamic Logit Models,” University of Wiscon-
  sinMadison, 2008, (January).

Kline, Patrick and Enrico Moretti, “People, Places and Public Policy: Some Simple Welfare
  Economics of Local Economic Development Programs,” Annual Review of Economics,
  2014, 6 (April), 629–62.

Lagakos, David, Moll Benjamin, Tommaso Porzio, and Nancy Qian, “Experience Matters:
  Human Capital and Development Accounting,” 2012.

Mangum, Kyle, “Cities and Labor Market Dynamics,” mimeo, 2015.

Michaels, G, “The effect of trade on the demand for skill: evidence from the Interstate
 Highway System,” The Review of Economics and Statistics, 2008.

Monte, Ferdinando, Stephen Redding, and Esteban Rossi-Hansberg, “Commuting, Mi-
 gration, and Local Employment Elasticities,” 2015, pp. 1–57.

Moretti, Enrico, “Local Labor Markets,” Handbook of Labor Economics, 2011.


                                              40
Notowidigdo, Matthew, “The incidence of local labor demand shocks,” 2013.

Ottaviano, Gianmarco I P and Giovanni Peri, “Rethinking the effects of immigration on
  wages,” Journal of the European Economic Association, 2012, 10 (1), 152–197.

Pessino, C, “Sequential Migration Theory and Evidence from Peru,” Journal of Develop-
  ment Economics, 1991.

Redding, S J, “Goods Trade, Factor Mobility and Welfare,” NBER Working Paper, 2015.

Roback, J, “Wages, Rents, and the Quality of Life,” The Journal of Political Economy, 1982.

Saiz, Albert, “The Geographic Determinants of Housing Supply,” Quarterly Journal of Eco-
  nomics, 2010, 125 (3), 1253–1296.

Schulhofer-Wohl, Sam and Greg Kaplan, “Understanding the Long-Run Decline in Inter-
  state Migration,” 2015.

Silva, J M C Santos and Silvana Tenreyro, “The Log of Gravity,” The Review of Economics
   and Statistics, 2006, 88 (November), 641–658.

Sjaastad, L, “The Costs and Returns of Human Migration,” The Journal of Political Economy,
  1962, 70 (5), 80–93.

Tenreyro, Silvana, “Further simulation evidence on the performance of the Poisson
  pseudo-maximum likelihood estimator,” Economics Letters, 2009, 44 (0), 1–8.

Theoharides, Caroline, “Manila to Malaysia, Quezon to Qatar: International Migration
  and the Effects on Origin-Country Human Capital,” Mimeo, 2016.

Tombe, Trevor and Xiadong Zhu, “Trade Liberalization, Internal Migration and Regional
  Income Differences: Evidence from China,” mimeo, 2015, pp. 1–42.

Topalova, P, “Factor Immobility and Regional impacts of Trade Liberalization: Evidence
  on Poverty from India,” American Economic Journal: Applied Economics, 2010, 2 (4), 1–41.

Tunali, I, “Rationality of Migration,” International Economic Review, 2000, 41 (4), 893–920.

Yagan, Danny, “The Enduring Employment Impact of Your Great Recession Location,”
  2016.




                                             41
Figures and Tables




               Figure 1: Map of straight line instrument and radial highways

Notes: Figure shows Brasilia and the 26 state capitals. The map shows radial highways out of Brasilia
and the straight line instrument for roads. The straight line shows the minimum spanning tree instrument
between Brasilia and grouped state capitals. Source: Authors’ calculations based on maps obtained from
the Brazilian Ministry of Transportation.




                                                  42
             Figure 2: Bilateral gross migration flows against bilateral distance

Notes: Each dot is a meso-meso pair. The data are pooled for the 1980-2010 period. (log) travel time is our
bilateral measure of travel time computed based on the actual road networks covering each of the censuses.
(log) distance is the Euclidean distance between meso-meso pairs. Measures of travel time and distance are
net of origin, destination, and year fixed effects. Source: Authors’ calculations based on census data and
maps obtained from the Brazilian Ministry of Transportation.




                                                    43
Figure 3: Inflows, outflows, and net flows, by region




                         44
Figure 4: Importance of bilateral costs for estimating population response to wage shock

Notes: Figure shows estimated population elasticities to an own-region wage shock, using estimates for
the model with bilateral migration costs and the model without bilateral migration cost. Each dot is a meso
region. Source: Authors’ calculations based on census data.




                                                    45
         Figure 5: Correlation of population elasticity with market access measure

Notes: Figure shows correlation of population elasticity with market access (traded goods market access).




                                                   46
                  Figure 6: Population change induced by housing subsidy

Notes: Figure shows how the population changes when rents are subsidized by 10% in the 3 larger cities:
Sao Paulo, Rio de Janeiro, and Brasilia.




                                                  47
          Table 1: Summary statistics
                                       Mean/SD
Demographic
Age                                        36.7
                                          (11.6)
Years schooling                            5.50
                                          (4.51)
Employment
Equiv. wage (all)                          7.61
                                          (38.1)
Equiv. wage (employee only)                6.98
                                          (17.1)
Share pop. who are employees               0.65
                                          (0.48)
Working in agriculture                     0.26
                                          (0.44)
Working in manufacturing                   0.16
                                          (0.36)
Housing
Mean rent                                 321.6
                                         (344.9)
Share paying rent                          0.17
                                          (0.38)
Migration
Municipality migration rate                0.12
                                          (0.33)
Meso-region migration rate                0.072
                                          (0.26)
Missing previous meso                    0.0081
                                         (0.090)
Number people                          17,873,762
Number municipalities                     3,659
Number meso regions                        135
  Notes: Summary statistics calculated from Cen-
  sus microdata. Sample is 20-65 year old males
  with non-zero earnings in main occupation, pool-
  ing 1980, 1991, 2000 and 2010. Young defined as
  below median age. Low skilled defined as below
  median years of schooling. Financial values in year
  2000 Brazilian reals (BRL). 1USD =2.3 BRL.


                        48
       Table 2: Migration flows, by census year
                             (1)     (2)      (3)      (4)
Mean                        1980    1991     2000     2010
Gross migration flow       0.095 0.070 0.061 0.053
Net migration flow         0.046 0.027 0.020 0.019
Net/Gross ratio             0.48  0.39  0.33  0.36
Number meso regions         135      135      135     135
  Notes: Summary statistics calculated from Census micro-
  data. Sample is 20-65 year old males with non-zero earnings
  in main occupation.




                            49
                                                       Table 3: First step estimates: migration costs
                                                                Log (share)                                             Log (share + 0.001)
                                              (1)             (2)           (3)             (4)            (5)            (6)          (7)              (8)
                                             OLS              IV          OLS               IV            OLS             IV          OLS               IV
     Dep. variable: Log π jkt                b/se            b/se         b/se             b/se           b/se           b/se         b/se             b/se
     Fixed cost of migrating                -7.16***        -2.95***      -5.22***        -4.25***      -6.16***        -4.13***      -5.89***        -5.11***
                                             (0.052)         (0.21)        (0.032)          (0.19)       (0.017)         (0.46)        (0.024)          (0.19)
     Bilateral distance (km)               -0.0011***    -0.00025***    -0.00076***     -0.00029**    -0.00026***      0.000059     -0.00012***     0.0000022
                                          (0.0000085)     (0.000041)     (0.000022)      (0.00012)    (0.0000046)     (0.000076)    (0.0000028)     (0.000032)
     Bilateral travel time                   0.37***        -32.1***       0.92***        -9.35***      -0.30***        -14.3***      -0.13***        -5.69***
                                             (0.080)         (1.37)        (0.098)          (2.41)       (0.060)         (3.88)        (0.041)          (1.59)
     Value of living in state of birth                                     1.51***         1.46***                                     0.66***        0.65***




50
                                                                           (0.034)         (0.041)                                     (0.014)         (0.014)
     No. meso pairs                         41,550         41,550         134,405       134,405         72,900         72,900        1,679,130      1,679,130
     No. individuals                      17,477,479     17,477,479      17,477,479    17,477,479     17,477,479     17,477,479     17,477,479     17,477,479
     Mean migration rate                     0.071          0.071           0.071         0.071          0.071          0.071          0.071          0.071
     Mean distance migrated (km)            679.5          679.5           679.5         679.5          679.5          679.5           679.5          679.5
     Mean traveltime migrated               0.071          0.071           0.071         0.071          0.071          0.071           0.071          0.071
       Notes: Log π jkt is the share of people from origin j in time t who move to destination k. The maximum number of observations in Cols (1), (2),
       (5) and (6) is 72,900 (135 origin regions × 135 destination regions × 4 years). The maximum number of observations in the specifications which
       control for state of birth (Cols (3),(4),(7) and (8)) is 1,968,300 (135 × 135 × 4 × 27 states (26 states and the federal district of Brasilia)). There are
       2142 instances where there is no population from state of birth living in origin j. This generates a final sample size for Cols (7) and (8) of 1,679,130
       (1,968,300 - 2142*135). Origin, destination, and year fixed effects estimated but not reported. Mean travel time is the percentage relative to travel
       distance between N-S of Brazil. Standard errors clustered at origin meso x year. Source: Brazilian Census data, 1980-2010.
                         Table 4: Decomposition of migration costs
                                   Baseline    Incl. state birth    Low Skilled       High Skilled
                                     (1)              (2)           (3)     (4)       (5)      (6)
                                                                   Young    Old      Young    Old
All possible moves
Fixed cost (share)                   0.542            0.755        0.832     0.827    0.778     0.846
Distance cost (share)                0.062            0.072        0.027     0.046    0.068     0.045
Road cost (share)                    0.396            0.178        0.143     0.128    0.159     0.111
State of birth cost (share)                           -0.005       -0.003   -0.001    -0.006   -0.002
Total observed cost (share)          1.000             1.000       1.000     1.000    1.000     1.000
Total observed cost (level)          9.069             6.366       5.308     5.764    5.772     5.605
Total unobserved cost (share)        0.000             0.000       0.000     0.000    0.000     0.000
Total cost (level)                   9.069            6.366        5.308     5.764    5.772     5.605
Total cost in wage units (level)    197.602            3.842       2.768     2.986    3.167     2.840
Actual moves that occurred
Fixed cost (share)                   0.688            0.842        0.870     0.895    0.851     0.921
Distance cost (share)                0.035            0.035        0.015     0.020    0.033     0.019
Road cost (share)                    0.277            0.096        0.078     0.076    0.077     0.051
State of birth cost (share)                           0.026        0.038     0.010    0.039     0.009
Total observed cost (share)          1.000             1.000       1.000     1.000    1.000     1.000
Total observed cost (level)          5.401             5.412       4.884     5.136    5.078     5.035
Total unobserved cost (share)        -1.497           -1.845       -1.980   -1.828    -1.927   -1.793
Total cost (level)                   -2.348           -4.370       -4.675   -4.178    -4.522   -3.920
Total cost in wage units (level)     -2.140           -2.277       -2.380   -2.149    -2.338   -2.056
Mean wage                            7.613            7.613        3.689     4.456    6.967    12.645
Mean migration rate                  0.071            0.071        0.094     0.051    0.091     0.054
  Notes: Based on the baseline estimates from first step estimation. Costs converted to wage equivalents
  using a marginal utility of 5.60.




                                                 51
                Table 5: Reduced form results: elasticity of popula-
                tion and rents
                                                          (1)        (2)
                                                         OLS         IV
                                                         b/se       b/se
                 Dep. variable: Change in log pop
                 Log change in wages                      0.16     1.49***
                                                         (0.15)     (0.51)
                 Dep. variable: Change in log rent
                 Log change in population                0.080 0.88***
                                                        (0.055) (0.27)
                 Number of obs                            135        135
                    Notes: Data from the census taking the difference be-
                    tween 2010 and 1980. Instruments are bartik shock and
                    bartik shock interacted with market access variable.




                       Table 6: Structural coefficient estimates
                                       Bilateral costs            Without bilateral costs
                                   No price adj Price adj         No price adj Price adj
                                      b/se          b/se             b/se         b/se
Elasticity rental rates to pop        0.88***         0.88***        0.93***        0.92***
                                       (0.26)          (0.26)         (0.27)         (0.27)
Elasticity utility to wages           6.09***         5.31***        4.94***        4.31***
                                       (1.46)          (1.25)         (1.34)         (1.17)
J statistic                             6.05           5.74           5.07            5.10
p value                                 0.20           0.22           0.28            0.28
  Notes: Estimated using long difference between 1980-2010. Coefficients calculated using two-
  step GMM. Elasticity of utility to rent normalized to -1. Robust standard errors provided.
  Overidentification J statistic and p-value provided. Instruments are bartik shock (and bartik
  shock interacted with price adjustment term for price adjustment equations).




                                             52
                          Table 7: Incidence of wage shock
                          Model with bilateral cost        Model without bilateral cost
                          (1)          (2)                 (3)            (4)
                                Share of j’s pop                   Share of j’s pop
Mean change in utility
Non-local, never in       0.00                             -0.00
Non-local, switch in      0.23            0.24             0.21              0.35
Non-local, always in      0.51            0.41             0.45              0.64
Local, never in           0.00                             -0.00
Local, switch in          0.25            0.05             0.21              0.00
Local, always in          0.51            0.30             0.45              0.00
Share of total utility
Non-local, never in       0.04                             -0.00
Non-local, switch in      0.12                             0.20
Non-local, always in      0.47                             0.80
Local, never in           0.00                             -0.00
Local, switch in          0.03                             0.00
Local, always in          0.34                             0.01
  Notes: Estimates using 1980 data. Each experiment is a 10% wage shock in one of 135 regions.
  Table shows average across all 135 experiments.




                                            53
A     Appendix Figures and Tables




                          Appendix Figure 1: Index of market access

Notes: Calculated using spatial weight from price index. Places that are less connected (by road or by
distance) have a higher elasticity of their consumer price index to own shocks.




                                                 54
           Appendix Table 1: First stage for straight line instrument
                                                   Log distance        Indicator for road
                                                   (1)       (2)          (3)       (4)
Dep. variable: Dist. from paved road              b/se      b/se         b/se      b/se
Predicted road (log km)                        0.113***    0.148***
                                                (0.025)     (0.041)
On straight-line path                                                  0.111***     0.163**
                                                                        (0.041)      (0.064)
Area                                                        0.000*                  0.000***
                                                            (0.000)                  (0.000)
Closer nearest big city                                    -0.105**                 -0.038**
                                                            (0.044)                  (0.018)
Closer to Brasilia                                          0.558*                   0.206*
                                                            (0.326)                  (0.121)
State FE                                          Yes         Yes         Yes         Yes
Year FE                                           Yes         Yes         Yes         Yes
R-Squared                                         0.497      0.515       0.563       0.570
F-stat                                             20.5      12.7         7.3         6.4
Number of municipalities                          3659       3659        3659        3659
  Notes: Table shows OLS regressions. Cols (1) and (2) show distance to nearest road as
  a function of the distance to the straight line distance between Brasilia and state capitals.
  Distances measured in log km. Col (3) regresses an indicator variable for having a paved
  road on an indicator variable for being on the straight line path. Stars indicate statistical
  significance. ∗ ∗ ∗ < 0.01, ∗∗ < 0.05, ∗ < 0.1. Standard errors clustered at municipality
  level..




                                             55
            Appendix Table 2: Summary statistics, by census year
                                         (1)          (2)          (3)          (4)
Mean/sd                                 1980         1991         2000         2010
Demographic
Age                                     35.8         36.4          36.8         37.8
                                       (11.7)       (11.5)        (11.3)       (11.7)
Years schooling                         3.80         5.14          6.35         8.09
                                       (3.97)       (4.36)        (4.37)       (4.37)
Employment
Equiv. wage (all)                       7.32         5.94          7.96         9.01
                                       (17.8)       (14.1)        (29.3)       (66.9)
Equiv. wage (employee only)             6.88         5.62          6.76         8.25
                                       (11.2)       (11.3)        (14.9)       (25.8)
Share pop. who are employees            0.65         0.62          0.64         0.70
                                       (0.48)       (0.49)        (0.48)       (0.46)
Working in agriculture                  0.31         0.30          0.23         0.20
                                       (0.46)       (0.46)        (0.42)       (0.40)
Working in manufacturing                0.18         0.16          0.15         0.14
                                       (0.39)       (0.36)        (0.35)       (0.35)
Housing
Mean rent                               314.1        309.9                     342.7
                                       (360.9)      (350.9)                   (309.7)
Share paying rent                        0.22         0.15         0.13         0.17
                                        (0.42)       (0.35)       (0.34)       (0.37)
Migration
Municipality migration rate             0.15          0.11         0.11         0.11
                                       (0.36)        (0.32)       (0.31)       (0.31)
Meso-region migration rate             0.095         0.070        0.061        0.053
                                       (0.29)        (0.25)       (0.24)       (0.22)
Missing previous meso                  0.014        0.0045       0.0070       0.0045
                                       (0.12)       (0.067)      (0.084)      (0.067)
Number people                        5,896,085    3,540,519     3,965,378    4,471,780
Number municipalities                  3,658        3,659         3,659        3,659
Number meso regions                     135          135           135          135
  Notes: Summary statistics calculated from Census microdata. Sample is 20-65 year old
  males with non-zero earnings in main occupation, pooling 1980, 1991, 2000 and 2010.
  Young defined as below median age. Low skilled defined as below median years of school-
  ing. Financial values in year 2000 Brazilian reals (R). 1USD =2.3R.




                                          56
                            Appendix Table 3: First stage: Road Instrument
                                               Non-zero flows                         All pairs
                                                    (1)                  (2)             (3)              (4)
Dep. var: Travel time on road                      b/se                 b/se           b/se              b/se
Travel time (Straight line instrument)             0.083***             0.11***    0.078***    0.078***
                                                    (0.013)             (0.018)     (0.015)     (0.015)
Distance (km)                                    0.000028***         0.000021*** 0.000019*** 0.000019***
                                                 (0.0000045)         (0.0000031) (0.0000027) (0.0000027)
Dummy for same birth state                                            0.0057***               2.3e-16***
                                                                      (0.00088)                (2.9e-17)
Constant                                           -0.0083             0.015***    0.022***    0.022***
                                                   (0.0077)            (0.0040)    (0.0035)    (0.0034)
Origin-Year FE                                        Yes               Yes              Yes             Yes
Destination-Year FE                                   Yes               Yes              Yes             Yes
Number of meso-pairs                                18,733            805,258          72,900         1,968,300
F Stat on instrument coefficient                     38.92             36.03            27.87           28.27
  Notes: Table shows first stage estimates. The first two columns uses meso-region-year pairs with non-zero migra-
  tion flows. The third and fourth columns includes all meso-region-year-pairs. Standard errors clustered by origin
  region x year. Data: estimated bilateral travel time from digitalized road map data for 1970, 1990, 2000 and 2010.



               Appendix Table 4: Fixed and marginal costs of migration, by year.
                                              (1)             (2)           (3)            (4)          (5)
                                            Pooled           1980          1991           2000         2010
Bilateral travel time                        -9.35***       -25.7         -6.79**        -5.78**        -8.00*
                                               (0.30)       (17.7)         (3.04)         (2.85)        (4.18)
Fixed cost of migrating                      -4.25***      -2.98**       -4.34***       -4.45***      -4.63***
                                              (0.037)       (1.18)         (0.28)         (0.25)        (0.31)
Bilateral distance (km)                   -0.00029***     0.00058      -0.00041***     -0.00022      -0.00039*
                                           (0.000017)     (0.0012)      (0.00011)      (0.00014)     (0.00020)
Value of living in state of birth            1.46***       1.31***       1.44***        1.49***       1.27***
                                              (0.017)       (0.18)        (0.085)        (0.081)       (0.063)
No. meso pairs                             134,405         39,600        31,366         33,991        37,248
No. individuals                           17,477,479     5,814,789      3,524,628      3,937,452     4,451,455
Mean migration rate                          0.071          0.095         0.070          0.061         0.053
Mean bilateral distance migrated             679.5          655.8         710.3          694.9         687.0
Mean traveltime migrated                     0.071          0.057         0.083          0.089         0.074
  Notes: Source: Brazilian Census data, 1980-2010. Location fixed effects estimated but not reported. Standard
  errors clustered at origin region (and origin region x year for the pooled specification).




                                                  57
                        Appendix Table 5: Trade gravity equations
                                          1970                  1999                  Both
                                    (1)           (2)     (3)           (4)     (5)           (6)
Dep. variable: Log trade           b/se          b/se    b/se          b/se    b/se          b/se
Log instrument distance          -0.043**    -0.047**    -0.019     -0.018     -0.023     -0.018
                                  (0.019)     (0.018)    (0.017)    (0.016)    (0.019)    (0.016)
Log distance                     -1.73***    -1.66***   -1.32***   -1.33***   -1.49***   -1.33***
                                   (0.11)     (0.091)    (0.085)    (0.088)    (0.067)    (0.088)
Log rail distance                              -0.45                 0.049                 0.049
                                               (0.27)                (0.24)                (0.24)
Origin FE                           Yes          Yes      Yes          Yes      Yes
Destination FE                      Yes          Yes      Yes          Yes      Yes
Year FE                             Yes          Yes      Yes          Yes      Yes
Number of obs                       477          477      630          630     1107          630
  Notes: Data is state-state bilateral trade flows.




                                                  58
B     Appendix
B.1        Self-reported agricultural income
In the Brazilian census, between 50-70% of the sample who report working in agriculture
are self-employed rather than employees.31 Self-reported income in censuses may not ac-
curately reflect agricultural wage income for at least three reasons: i) self-reported income
may be revenues, rather than income, ii) it may contain payments to both labor as well
as other factors of production such as capital, or iii) it may be more accurately provided
at the household, rather than the individual, level (Lagakos et al. (2012)). In this section
we use data from Brazilian agricultural censuses and present evidence that, despite the
potential problems, agriculture self-employment income as measured in population cen-
suses highly correlates with agriculture profits computed from agricultural censuses. In
addition, we run the reduced form analysis in the paper both including and excluding
non-employees, and results are robust.
    Starting in 1970, the Agriculture Censuses were collected every five years. The agricul-
ture census allows us to measure agricultural income accurately as it covers the universe
of agricultural production unities, regardless of their size, output level, or location.32 It is
worth mentioning that home gardens were not considered as agricultural unities for the
purpose of data collection. Nonetheless, we believe that we only miss some of the pro-
duction for own consumption of those who work mainly outside the agricultural sector.
    We obtain the series of agriculture revenues and expenses at the AMC level from
IPEADATA. Agriculture revenue comprises proceeds from the sale of agricultural prod-
ucts, including final goods produced inside the agricultural unities, as well as revenues
from the rental of land and livestock and services rendered to third parts. Agriculture ex-
penses include expenses with wages, rents, other inputs, and operational expenses. Our
benchmark measure of AMC-level agricultural income is agricultural profits, as measured
by the difference between revenues and expenses. We used the years 1975, 1980, and 1996,
which are the closest to the population census years (1970, 1980 and 1991).
    Appendix Figure 2 displays the scatterplot of the agriculture (log) profits obtained
from the agriculture census against the agriculture self-employment (log) income com-
puted from the population census. The two income measures are positively correlated.
The R-squared from regressing the level of agriculture self-employment income on the
level of agriculture profits indicates is 0.80.




  31 The   share of the population working in labor force declines from 46% in 1970 to 22% in 2010.
  32 The   agricultural censuses include unities located in urban areas.


                                                      59
Appendix Figure 2: Comparison: population and agricultural censuses




                                60
                     Appendix Table 6: Correlation of CPI with other mea-
                     sures of cost of living
                                                                          (1)         (2)
                      Dep var: Relative price index                      b/se        b/se
                      Mean agricultural prices (producer)               0.026**
                                                                       (0.0097)
                      Mean rental rate                                              0.0037
                                                                                    (0.015)
                      Year FE                                             Yes         Yes
                      N                                                   22          40
                        Notes: Each observation is a municipality-year. The CPI is col-
                        lected at 10 locations in Brazil. For each year, we normalize the
                        mean of the index to 1, so the index measures spatial variation
                        in the cost of living. Agriculture prices are available for 1980,
                        1991 and 2000. Rents are available for 1970, 1980, 1991 and 2010.
                        Standard errors clustered at the municipality level.



B.2     Cost of living
Consumer prices are only collected at 10 cities in Brazil. In this section, we show how
the prices correlate with two measures of the cost of living: mean rental rates from the
population census, and producer prices at the municipality level computed from the agri-
cultural census. The dependent variable is the price index, normalized each year to have
value 1. The agricultural price index is a weighted average of the prices of the 4 main
agricultural crops (soy, sugarcane, coffee and corn), sourced from the agricultural census.
The rental rate is the mean rental rate per bedroom, sourced from the population census.
Table 6 show that both are positively correlated with the relative price index, although
the small sample size means that the rental rate is not statistically significant.33




  33 Additionally,the CPI is only collected in cities, as a result, there is less variation in rental rates that in
the entire sample. The variable of (log) rental rates in the municipalities included in the CPI sample is 0.49,
compared with a variance of 0.84 across all municipalities.


                                                        61
C    Derivation of unobservable preference shocks
This appendix derives the unobservable preference shocks that we use in the decomposi-
tion exercise presented in Section 6, following Kennan (2008).
    Consider agent i current living in location j who moves to location k. His utility is
given by:
                                   Vi jk = Vk − c jk + ik ,
where we assume ik are i.i.d. EV1. For the derivation presented below, we assume
                                           −x
F ( x) = exp− exp(−x) ; f ( x) = exp−(x+exp ) .
     We begin by showing that E(k ) = γ. Throughout the calculations, we suppress the
subscript i.
                                          Z ∞
                              E(k ) =          x f ( x)dx,
                                            ∞
                                          Z−∞
                                                               −x )
                                      =         x exp−(x+exp          dx,
                                            ∞
                                          Z−∞
                                      =         − log t exp(−t)dt,
                                           0
                                      = γ,

where we use a change of variable t = exp(− x) and the fact that γ = − 0∞ exp(− x) log xdx.
                                                                            R

   Next, we show that E(V jk |choose k) = E(maxk V jk ) = γ + ln ∑k exp(Vk − c jk ). First,
we establish that maxk V jk also has an EV1 distribution:

 F (max V jk ≤ x) = P(V1 − c j1 + 1 ≤ x) P(V2 − c j2 + 2 ≤ x)...P(VM − c jM +  M ≤ x),
     k
                  = Πk F ( x − (Vk − c jk )),
                  = Πk exp− exp(−x+(Vk −c jk )) ,
                  = exp− ∑k (exp(−x+(Vk −c jk ))) ,
                  = exp− exp(−x) ∑k exp(Vk −c jk ) ,
                  = exp−β exp(−x) ,

where β = ∑k exp(Vk − c jk ). So, the PDF of maxk V jk is:

                                  f ( x) = β exp−(x+β exp(−x)) .




                                                  62
    We can now compute the expected value of this max:
                                      Z ∞
                   E(max V jk ) =             x f ( x)dx,
                        k               ∞
                                      Z−∞
                                  =           xβ exp−(x+β exp(−x)) dx,
                                        ∞
                                      Z−∞
                                  =           xβ exp−x exp−β exp(−x)) dx,
                                       −∞
                                        Z ∞
                                  =−              −(log β − log t) exp−t dt,
                                        0Z       ∞                           Z ∞                     
                                                                  −t                            −t
                                  =−                  log t exp        dt −         log β exp        dt ,
                                              0                               0
                                            Z ∞
                                  =γ+                 ln β exp(−t)dt,
                                              0
                                  = γ + log β,
                                  = γ + log ∑ exp(Vk − c jk ),
                                                       j

where we use a change of variable t = β exp(− x) and the fact that γ = − 0∞ exp(− x) log xdx.
                                                                                                       R

   Finally, we can obtain an expression that allows us to compute the unobserved com-
ponent of migration costs. We know that:

                                      E(V jk |choose k) = γ + log β.                                        (18)

   We need the expected value of V j j , given agent chooses not to stay in j. First, we get
the unconditional expected value:

                                    E(V j − c j j +  j ) = V j − c j j + γ.

    Then, we use the fact that:

E(V j − c j j +  j ) = π j j E(V j − c j j +  j |choose j) + (1 − π j j ) E(V j − c j j +  j |don’t choose j).

    Combining the two and using Equation 18:

                        V j − c j j + γ = π j j (γ + log β) + (1 − π j j ) E(V j − c j j +  j |don’t choose j),
                                                 Vj − c j j     πjj
E(V j − c j j +  j |don’t choose j) = γ +                  −         log β.
                                                  1 − πjj     1 − πjj




                                                            63
We can use the formula for π j j to rearrange this:

                                                       exp(V j − c j j )
                                             πjj =                       ,
                                                      ∑k exp(Vk − c jk )
                                                      exp(V j − c j j )
                                                  =                     ,
                                                            β
                                        V j − c j j = log β + log π j j ,

so we get:
                                                                               log π j j
                       E(V j − c j j +  j |don’t choose i ) = γ + log β +               .
                                                                               1 − πjj
  Now, we can work out what the difference in the unobserved shocks is for someone
who chooses k, and therefore doesn’t choose j:

                                                                                                      log π j j
E(Vk − c jk + k |choose k) − E(V j − c j j +  j |don’t choose j) = γ + log β − (γ + log β +                   ),
                                                                                                      1 − πjj
                                                                                   log π j j
                                                                              =−             .      (19)
                                                                                   1 − πjj

    Writing out the components:

                                                                                      log π j j
      (Vk − V j ) − (c jk − c j j ) + ( E(k |choose k) − E( j |don’t choose j)) = −           .
      | {z }        | {z } |                              {z                    }     1 − πjj
     average return     observed cost                       unobserved cost



    So, using c j j = 0, the total migration cost is given by:

                                                                                 log π j j
          c jk        − ( E(k |choose k) − E( j |don’t choose j)) = Vk − V j +           .        (20)
         |{z}           |                   {z                    }              1 − πjj
      observed cost                       unobserved cost


D     Model with traded goods and endogenous prices
This appendix extends the spatial equilibrium model presented in Section 2 to include
costly trade of goods across space, following Eaton and Kortum (2002). We show that the
main effect of adding costly trade is the addition of a “market access” term that affects
how responsive own-prices are to own-shocks. We then show how to estimate this term
using bilateral trade data. In the text, we present a discussion of how this extension
impacts our main estimates.




                                                        64
D.1       Labor demand
The production side of the economy is based on a standard model of locations producing
goods based on their comparative advantage (Eaton and Kortum, 2002; Redding, 2015).
Assume that there is a continuum of goods, s ∈ [0, 1], which are produced in each location
k at time t according to the following production function:

                                            Ykt (s) = Akt (s) Lαkt (s),

where Akt (s) is location- and good-specific productivity and Lkt (s) is labor.
  Because labor markets are competitive, labor is paid its marginal revenue, so that

                                       wkt (s) = α pkt (s) Akt (s) Lαkt−1 (s),

where wkt (s) is the nominal wage paid to workers in location k in time t and pkt (s) is the
unit price a firm receives from selling the good. We assume that α is equal to one, which
is equivalent to assuming perfect capital mobility (i.e. Moretti (2011)).Each location must
have the same wage across goods it is producing. From this assumption, we derive the
labor demand function for location k in time t as

                                            wkt = pkt (s) Akt (s), ∀s,                   (21)
which implies that labor demand is only a function of location and good-specific produc-
tivity. Additionally, nominal wage differences between two locations reflect productivity
differences and differences in producer prices.


D.2       Price determination
We allow for trade between two locations to take place and affect the local prices faced by
consumers (Eaton and Kortum (2002), Redding (2015)). The cost in location k in time t of
a good of type s made in location j is:

                                              p jkt (s) = d jkt p jt (s)

   where d jkt ≥ 1 are shipping costs. The shipping cost is the amount of the good that
needs to be shipped so that one unit of output from j arrives at k. We assume that good
                                                                    w
markets are competitive, which implies that p jt (s) = MC jt (s) = A (jts) and
                                                                                  jt

                                                                   w jt
                                              p jkt (s) = d jkt
                                                                  A jt (s)
.
   Location k’s productivity draw for each good s comes from a Frechet distribution Fkt =
       −θ
e−Tkt z , whereTkt is the average productivity for location k in time t, and θ represents the
productivity dispersion across goods.34 Consumers in location k purchase each good from
    34 Productivity   shocks are independent across goods, locations, and time.


                                                         65
the locations that produce the good at the lowest cost. Therefore, using the properties of
the Frechet distribution yields an expression for the share of trade flows into k from j:
                                                         −θ
                                X jkt     Tjt d jkt w jt
                                      = M                    −θ
                                                                                           (22)
                                Yk t   ∑m=1 Tmt (dmkt wmt )
   Additionally, from the CES preferences for goods we can derive a consumer price
index for location k as follows:
                                        "                             # −1
                                            M                           θ

                              pkt = γ       ∑     Tmt (dmkt wmt )−θ                        (23)
                                            m=1


D.3    Housing markets
All housing is owned by absentee landlords. The elasticity of rental rates to labor is given
by:

                                   log rkt = ηt + ηr log Lkt ,                             (24)
where ηr is the elasticity of house prices to population.


D.4    Labor supply
Consumers living in location k have Cobb-Douglas preferences over goods consumption
Ck and housing Hk . They also derive some amenity value from living in location k, Xkt :
                                          γ 1−γ
                                   Ukt = Ckt Hkt exp Xkt .
   These preferences, along with the budget set pkt Ckt + rkt Hkt ≤ wkt , yield demand
functions for goods and housing units:

                                            pkt Ckt = γwkt ,
                                     rkt Hkt = (1 − γ )wkt .

   Notice that costly trade implies that the price of the consumption good depends on
location, as places will different shipping costs depending on how isolated they are from
the other markets.
   We can then derive the indirect utility that consumers derive from living in location k:

                  log Ukt = β + βw log wkt − β p log pkt − log rkt + βχ Xkt ,
                          = β + Vkt ,

where β = (γ log(γ ) + (1 − γ ) log(1 − γ ))/(1 − γ ), βw = 1/(1 − γ ), β p = γ /(1 − γ ),
and βχ = 1/(1 − γ ).
    An agent begins the period living in location j. Indirect utility for an individual i living
in region j depends on the wage (w), prices (p), their rental expenses (r), the amenity

                                                    66
value of the city (X), as well as an individual-specific match value (). The indirect utility
is composed of a term that is common to all people who live in region j (V j ) and the
idiosyncratic match component:

                        Vi jt = β + βw log w jt − β p log p jt − log r jt + X jt + i jt ,
                             = β + V jt + i jt ,

     An agent who starts the period in location j can choose to remain in j or relocate to
another location. In total, there are M possible locations, including their current location.
If they relocate from j to location k they must pay a migration cost of c jkt , where c jkt > 0
if j 6= k. Agents observe their match-specific shock for each of the M locations, including
where they currently reside, and then make a decision about where to migrate. The lo-
cation decision for agent i living in location j is therefore to choose the location with the
highest utility:
                                    max{Vkt + ikt − c jkt }.                               (25)
                                              k
   Assume that the individual match specific terms are distributed as random type 1
extreme value: ik ∼ EV1. Then, the probability that the agent moves to location k, given
that they start the period in location j, is given by the logit expression:

                            exp(βw log wkt − β p log pkt − log rkt + βchi Xkt − c jkt )
            π jkt =     M                      p
                                                                                                 .       (26)
                                   w                                 chi
                       ∑m =1 exp (β log wmt − β log pmt − log rmt + β Xmt − c jmt )

   The probability that the agent does not migrate is given by the probability they stay in
their current location:

                               exp(βw log wkt − β p log pkt − log rkt + βchi Xkt )
            π j jt =    M                           p log p
                                                                                              .
                       ∑m    exp ((β w log w    − β            − log r    + β chi X − c     )
                          =1                 mt             mt         mt          mt   jmt

   Given the initial distribution of the population, N j,t−1 , ∀ j = 1, 2, ..., M, the labor sup-
ply in locality k is the net inflow of labor into region k from every region (including those
who start in k and chose not to migrate out):
             M
    Lkt =   ∑ π jkt N j,t−1 ,
            j=1
             M          exp(βw log wkt − β p log pkt − log rkt + βchi Xkt − c jkt )
       =    ∑ ∑M                                                                             N j,t−1 .   (27)
            j=1    m=1    exp(βw log wmt − β p log pmt − log rmt + βchi Xmt − c jmt )

The spatial equilibrium is given by solving a system of simultaneous equations for gross
migration from j to k (π ∗jkt ), equilibrium labor (L∗kt ), wage (w∗kt ), good price (p∗kt ), and
housing price (r∗kt ) for each region k, such that:
  1. Labor demand is given by Equation 21:

                                           log w∗kt log p∗kt = αt + log Akt

                                                       67
    2. Price index is given by Equation 23:
                                              "                                 # −1
                                                  M                               θ
                                                                           −θ
                                    pkt = γ       ∑     Tmt (dmkt wmt )
                                                  m=1


    3. Housing supply is given by Equation 24:

                                          log r∗kt = η + ηr log L∗kt

    4. Migration rates are given by Equation 26:

                             exp(βw log w∗kt − β p log p∗kt − log r∗kt + βchi Xkt − c jkt )
              π ∗jkt =    M                ∗     p     ∗         ∗
                                     w                                 chi
                         ∑m =1 exp (β log wmt − β log pmt − log rmt + β Xmt − c jmt )

    5. Labor supply is given by Equation 27:
                                                        M
                                            L∗kt =      ∑ π ∗jkt N j,t−1
                                                        j=1



E     Estimation of model with price adjustment
Estimation of the components of bilateral migration costs is not affected by including
transportation costs. However, the estimates of the elasticity of rents to population and
the elasticity of utility to wages when there is costly trade will need to account for the
impact of transportation costs on local prices. We suggest the following procedure.
   From equation 22, trade flows are given by:
                                                            −θ
                                   X jkt     Tjt d jkt w jt
                                         = M                    −θ
                                   Ykt    ∑m=1 Tmt (dmkt wmt )

    Therefore, we estimate a fixed effects gravity equation:

    log X jk = φ j + φk + φ1 log Bilateral distance jk + φ2 log Bilateral travel time jk +ϑ jk ,
                          |                             {z                             }
                                                               \
                                                              log d jk

where we instrument Bilateral travel time jk as we do for Equation 14.
   This yields the coefficients for d jkt , ∀ j, k. Then, we log-linearize the price index 23 to
yield:
                                                     d−
                                                             !
                                       M               θ             −1
                                                      nkt             θ
                           log pkt = ∑ Tn M               −θ
                                                               log w nt
                                     n=1          ∑     d
                                                    m=1 mkt
    This gives an adjustment to capture “market access” term (we instrument wage shocks


                                                      68
so only consider own shock wkt ):

                                          1    1
                          ∆ log pkt = −               ∆ log wkt .
                                          θ ∑m=1 d−
                                             M     θ
                                                  mkt

    Once we have recovered the mean level of utility for each region Vkt , we then relate
this to observable changes in wages and rents and estimate the elasticities with adjust-
ment for changes in market access. The change in indirect utility for region k between
period t − 1 and t is given by:

                      ∆Vkt = βw ∆ log wkt − pkt − ∆ log rkt + ∆νkt .

   From the labor demand Equation 21, we derive the following equation:

                           ∆ log wkt − ∆pkt = α b ∆Bkt + ∆εkt ,

where ∆Bkt are the Bartik shocks computed using Equation 3.2.
  The last estimating equation comes from the housing supply in Equation 24:

                          ∆ log rkt = ∆ηt + ηr ∆ log Lkt + ∆ξkt .

   1.0




                                            69
