                                NBER WORKING PAPER SERIES




                        DEALING WITH THE TRILEMMA:
            OPTIMAL CAPITAL CONTROLS WITH FIXED EXCHANGE RATES

                                           Emmanuel Farhi
                                            Ivan Werning

                                        Working Paper 18199
                                http://www.nber.org/papers/w18199


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      June 2012




For useful comments and suggestions we thank Olivier Blanchard and Ricardo Reis. Adrien Auclert
and Nicolas Caramp provided excellent research assistance. The views expressed herein are those
of the authors and do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2012 by Emmanuel Farhi and Ivan Werning. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
Dealing with the Trilemma: Optimal Capital Controls with Fixed Exchange Rates
Emmanuel Farhi and Ivan Werning
NBER Working Paper No. 18199
June 2012
JEL No. E5,F3,F32,F33,F41,F42

                                                ABSTRACT

We lay down a standard macroeconomic model of a small open economy with a fixed exchange rate
and study optimal capital controls (defined as maximizing the utility of a representative household).
We provide sharp analytical and numerical characterizations for a variety of shocks. We find that capital
controls are employed to respond to some shocks but not others. They are particularly effective to
address risk-premium shocks that affect the interest rate differential foreign investors require in a particular
country. We also discuss how the solution depends on the degree of nominal rigidity and the openness
of the economy. We show that capital controls may be optimal even if the exchange rate is not fixed
in response to risk premium shocks or if wages, in addition to prices, are sticky. Finally, we compare
the single country’s optimum to a coordinated world solution. Our results show a limited need for
coordination. However, the uncoordinated solution features the same capital controls as the coordinated
solution.


Emmanuel Farhi
Harvard University
Department of Economics
Littauer Center
Cambridge, MA 02138
and NBER
efarhi@harvard.edu

Ivan Werning
Department of Economics
MIT
50 Memorial Drive, E51-251a
Cambridge, MA 02142-1347
and NBER
iwerning@mit.edu
      Dealing with the Trilemma: Optimal Capital
         Controls with Fixed Exchange Rates∗
                          Emmanuel Farhi                      Iván Werning
                         Harvard University                       MIT
                                              June 2012



        We lay down a standard macroeconomic model of a small open economy with a fixed
        exchange rate and study optimal capital controls (defined as maximizing the utility of
        a representative household). We provide sharp analytical and numerical characteriza-
        tions for a variety of shocks. We find that capital controls are employed to respond to
        some shocks but not others. They are particularly effective to address risk-premium
        shocks that affect the interest rate differential foreign investors require in a particular
        country. We also discuss how the solution depends on the degree of nominal rigidity
        and the openness of the economy. We show that capital controls may be optimal even
        if the exchange rate is not fixed in response to risk premium shocks or if wages, in
        addition to prices, are sticky. Finally, we compare the single country’s optimum to a
        coordinated world solution. Our results show a limited need for coordination. How-
        ever, the uncoordinated solution features the same capital controls as the coordinated
        solution.



1      Introduction
Capital flows have been extensively blamed for episodes of booms and busts in emerg-
ing markets (Calvo, 1998). They may also have contributed to the ongoing crisis in the
eurozone—capital inflows and real appreciations in the periphery during the boom, as
well as capital flight during the downturn. These concerns are especially relevant when
the exchange rate is fixed, as it was for a number of emerging markets seeking to stabilize
inflation and more recently in the EMU. Indeed, Mundell’s trilemma states that a coun-
try cannot simultaneously have free capital flows, independent monetary policy, and a
fixed exchange rate. How then should countries that have fixed their exchange rate cope
    ∗ For
       useful comments and suggestions we thank Olivier Blanchard and Ricardo Reis. Adrien Auclert
and Nicolas Caramp provided excellent research assistance.



                                                    1
with macroeconomic shocks? To what degree should they give up on free capital mobil-
ity to regain monetary policy? Although the International Monetary Fund has recently
sided more sympathetically with the use of capital controls (Ostry et al., 2010), we still
lack a benchmark model to answer these macro-stabilization questions. Our goal is to
fill this gap by studying optimal (defined as maximizing the utility of the representative
household) capital control policy in a standard open economy model with fixed exchange
rates.
     Our model, which builds on Clarida, Gali and Gertler (2002) and Galí and Monacelli
(2005, 2008), introduces capital controls in an open economy model with nominal rigidi-
ties. We study the optimal use of capital controls in response to a great variety of shocks,
including the usual productivity shocks, as well as fluctuations in export demand, terms
of trade, foreign interest rates and risk premia. The latter shocks are especially relevant for
us because they are a proximate cause of capital movements. Risk premium shocks have
been suggested as important drivers of the business cycle in emerging open economies
(see Neumeyer and Perri, 2005). We analyze different price setting assumptions: flexible
prices, rigid prices, one-period in advance sticky prices, and Calvo price setting. As we
show, the optimal use of capital controls depends crucially on the nature of the shock, on
the stickiness of prices, and on the openness of the economy. Capital controls are more
effective the more closed the economy and they are particularly powerful to respond to
fluctuations in the risk premium demanded by foreign investors. Finally, we contrast the
single country optimum, taking as given the rest of the world, with a cooperative world
optimum. Although there are gains from coordination, we show that they take an unex-
pected and somewhat limited form.
     We start with the case of flexible prices. Even with flexible prices, optimal capital
controls are generally nonzero, a point explored in detail in Costinot et al. (2011).1 In
our context, with a small open economy there is no ability to affect the world interest
rate. However, each country still has some monopoly power over their terms of trade.
Without trade barriers capital controls emerge as an imperfect tool to manipulate terms
of trade. By reallocating spending intertemporally a country can raise their export prices
in some periods and lower them in others. This effect is not the focus of this paper.
Indeed, we isolate a few cases where this effect is not at play: when shocks are permanent,
or in the Cole-Obstfeld parametrization (unitary inter- and intra-temporal elasticities).
Nevertheless, flexible prices act as a benchmark to compare our results with nominal
rigidities.
   1 Jeanne
          (2011) shows how capital controls can be used to affect the real exchange rate in a model with
non-tradable goods, where terms of trade are fixed internationally.


                                                   2
    We first contrast the case of flexible prices with its polar opposite: perfectly rigid
prices. Thus, we assume that the exchange rate and prices are fixed forever. As with flexi-
ble prices, capital controls are not employed in response to permanent shocks. In response
to transitory shocks, however, capital controls now play a more important role. They are
used to react to all the shocks we consider. A useful example is the Cole-Obstfeld case
with a trend in productivity. In this case, optimal capital controls are zero when prices
are flexible, but they take the form of a tax on inflows (or a subsidy on outflows) when
prices are completely rigid. With flexible prices, the country’s price index decreases over
time. This expected deflation raises the real interest rate and increases the growth rate of
consumption. With rigid prices, the real interest rate is fixed and hence the growth rate
of consumption is too low, inducing a boom relative to the flexible price allocation. By
taxing inflows (or subsidizing outflows) the country can increase its nominal interest rate,
cooling off the economy. The growth rate of output is also increased, but by less, moving
the trade balance into surplus. In contrast, with flexible prices trade is always balanced
in the Cole-Obstfeld case. This underscores that capital controls are a second best tool, al-
lowing the country to regain some monetary autonomy and therefore some control over
the intertemporal allocation of spending.
    We then study the same model under the intermediate assumption that prices are set
one period in advance, just as in Obstfeld and Rogoff (1995). In this case capital con-
trols have some subtle effects. As explained above, capital controls lead to intertemporal
wealth transfers. Wealth transfers, in turn, lead to terms of trade and real exchange rate
changes—familiar at least Keynes (1929) and Ohlin (1929). Taking these effects into ac-
count complicates the analysis, yet we are able to provide tight characterizations for the
use of capital controls in this context, both for transitory and for permanent shocks of
different kinds. In contrast to the case with rigid prices, capital controls are now also em-
ployed in response to permanent shocks. Indeed, the responses are qualitatively similar
to those for transitory shocks. Intuitively, when prices eventually adjust, even permanent
shocks induce transitory movements in economic variables, which capital controls can
help stabilize to improve welfare.
    We then turn to the case with staggered Calvo pricing, the workhorse assumption in
New Keynesian models. In addition to allowing for more realistic dynamics, this has two
important implications for our analysis. First, it introduces a welfare cost from inflation—
absent in all previous cases. Second, because capital controls affect the dynamics of in-
flation, it creates a prudential motive for policy. Forward looking policy will consider
the effects that current and future temporary shocks have on absolute and relative prices.
With sticky prices these changes may have undesirable consequences in other periods.


                                             3
For example, a temporary capital inflow may heat up the economy and appreciate the
real exchange rate in a way that is harmful once these flows are reverted.
    We provide closed-form solutions for some revealing cases and also explore the model
numerically. As was the case with prices set one period in advance, capital controls are
employed in response to permanent shock, not just temporary shocks. However, now
that prices adjust continuously, the response of capital controls is also more drawn out. In
response to variations in risk premia, capital controls mitigate variations in the domestic
nominal interest rate, but do not perfectly stabilize it. In the closed economy limit it does;
capital controls vary one for one with the risk premium. Our numerical simulations show
that capital controls are employed counter-cyclically for all shocks and are quite effective,
especially in response to risk premium shocks. We also find that capital controls slow
down inflationary dynamics and the adjustment of relative prices. In this way, they help
stabilize the real exchange rate.
    We also provide some new results regarding the role of openness, captured in our
model by a home-bias preference parameter. One may imagine that the constraints im-
posed by a fixed exchange diminish if the economy is less open and perhaps vanish in
the closed economy limit. Without capital controls we show that this limit result is not
true. This lack of continuity with the closed economy model does not rely on the fact that
a fixed exchange rate constrains the interest rate response. It holds even for shocks that
do not affect the natural rate of interest, e.g. a perfectly permanent shock to productiv-
ity. However, with capital controls perfect stabilization does obtain in some, but not all,
cases. In particular, it holds when prices are set one period in advance or, in the Calvo
case, in response to risk premium shocks. But note that, even with optimal capital con-
trols, the economy cannot be perfectly stabilized in response to other shocks, e.g. shocks
to productivity.
    Flexible exchange rates are not always perfect. We highlight two situations where
capital controls are used even with a flexible exchange rate. The first case is that of a risk
premium shock. The second case is the case where wages, in addition to prices, are sticky.
In first case, variations in risk premia create capital flows and optimal policy leans against
these to stabilize the current account and stabilize the nominal exchange rate. Thus, a
lower premium is met with taxes on capital inflows to moderate both capital inflows and
the nominal exchange rate appreciation.
    Returning to the case with fixed exchange rates, we also study government spend-
ing as an alternative stabilization tool. Interestingly, although countercyclical spending
is generally optimal, in contrast with capital controls, their use is independent of the
degree of openness. Moreover, following Werning (2012) we show that in some cases op-


                                              4
timal government spending can be chosen by considering the opportunistic motive for
spending alone, in other words, considering only the fact that public goods are cheaper
to produce in a downturn, without paying attention to its stabilization or stimulus effects.
    Up to this point we have discussed the problem of a small open economy with a fixed
exchange rate, taking as given conditions in the rest of the world, including policy choices
by other countries, equilibrium interest rates and prices. We also consider whether capital
controls have beggar-thy-neighbor effects and whether there are gains from coordinating
their use. We contrast the coordinated solution within a monetary union where countries
cooperate on capital controls to maximize the sum of utilities, to the uncoordinated, non-
cooperative equilibrium, where each country acts in isolation. Perhaps surprisingly, we
find a rather limited role for coordination. In particular, although the aggregates may or
may not differ, capital controls imposed by each country are identical at the uncoordi-
nated equilibrium and coordinated optimum. Interestingly, the gains from coordination
are independent of the degree of heterogeneity across countries.
    The international monetary literature is vast and has led to a detailed understanding of
how monetary policy should be used in open economies (for a recent review see Corsetti
et al. 2010). In comparison, stabilization policy when monetary policy is constrained by
fixed exchange rates, as in a currency union, remains largely unexplored. In their classical
treatments, Mundell (1963) and Fleming (1962) suggested that with fixed exchange rates
and perfect capital mobility one must give up monetary policy, which may be detrimental
to macroeconomic stabilization. Can capital controls then offer a partial substitute to
monetary policy in such a situation? If so how should they be used and how effective
are they? The main contribution of our paper is to provide an extensive analysis of these
questions in a standard open economy model. Our goal is to offer a useful counterpart to
existing analyses of monetary policy. In this vein, we provide sharp results characterizing
the optimal use and effectiveness of capital controls in reaction to a large variety shocks.
We emphasize the roles played by the persistence of disturbances, the degree of nominal
rigidity and the openness of the economy. Taken together, our results help extend our
understanding of stabilization policy past situations where the exchange rate is flexible.
    In recent work, Schmitt-Grohe and Uribe (2012) study a disequilibrium model featur-
ing downward rigid wage and a fixed exchange rate. Although our models are quite
different, their reported simulations show that capital controls are used counter cycli-
cally, consistent with our results on the optimal use of capital controls. A large literature
in international macroeconomics is motivated by the volatility of capital flows, especially
“sudden stops”, see Mendoza (2010) and the references therein. Models with financial
frictions such as Caballero and Krishnamurthy (2001, 2004) emphasize domestic and in-


                                             5
ternational collateral constraints that create inefficiencies and a potential role for inter-
vention in international borrowing, even without nominal rigidities. A related strand
of work emphasizes pecuniary externalities that work through prices in borrowing con-
straints, for example Bianchi and Mendoza (2010), Bianchi (2011), Jeanne and Korinek
(2010), Korinek (2011). All these papers provide a rationale for “prudential” policies that
attempt to prevent excessive borrowing. Martin and Taddei (2010) provide a different
mechanism, with adverse selection, by which international lending is inefficient.


2     A Small Open Economy
We build on the framework by Galí and Monacelli (2005, 2008), who develop a model
composed of a continuum of open economies. Our main focus is on policy in a single
country, which we call Home, taking as given the rest of the world, which we call Foreign.
However, we also explore the joint policy problem for the entire world when coordination
is possible. We make a few departures from Gali and Monacelli’s model to adapt it to the
questions we address. First and foremost, they studied monetary and fiscal policy, so we
must extend the model to include capital controls. Second, in contrast to their simplifying
assumption of complete markets, we prefer to assume international financial markets are
incomplete. No risk sharing between countries is allowed, only risk free borrowing and
lending. Given this assumption, to keep the analysis tractable, we limit our attention to
one-time unanticipated shocks to the economy.2 Third, Gali and Monacelli confine their
normative analysis to the Cole-Obstfeld parameter specification, where various elastici-
ties of substitution are unity. This case is more tractable and we will make extensive use
of this fact here too. However, we also include some results outside of this parameter
configuration. Finally, we also consider a larger variety of shocks to the economy and
consider extensions where we include wage rigidity alongside price stickiness.


2.1    Households
There is a continuum measure one of countries i ∈ [0, 1]. We focus attention on a single
country, which we call Home, and can be thought of as a particular value H ∈ [0, 1]. In
every country, there is a representative household with preferences represented by the
   2 Relative to the literature, this is not a limitation since most studies, including Gali-Monacelli, work

with linearized equilibrium conditions, so that the response to shocks is unaffected by the presence of
future shocks.




                                                     6
utility function                         "                 #
                                                      1+ φ
                                   ∞
                                             Ct1−σ   Nt
                                  ∑ βt             −
                                             1−σ 1+φ
                                                             ,                                     (1)
                                  t =0

where Nt is labor, and Ct is a consumption index defined by

                                                     η −1                   η −1    η −η 1
                                             1                      1
                            Ct = (1 − α) CH,t + α CF,t                                         ,
                                             η          η           η          η




where CH,t is an index of consumption of domestic goods given by

                                         ˆ                                   !     e
                                             1                e −1
                                                                                 e −1

                              CH,t =             CH,t ( j)      e       dj                ,
                                         0


where j ∈ [0, 1] denotes an individual good variety. Similarly, CF,t is a consumption index
of imported goods given by

                                         ˆ                              !       γ
                                                 1     1     γ −1             γ −1

                               CF,t =                Λi,t Ci,t di
                                                       γ       γ
                                                                                      ,
                                             0


where Ci,t is, in turn, an index of the consumption of varieties of goods imported from
country i, given by
                                        ˆ 1               ! e
                                                           e −1
                                                     e −1
                               Ci,t =       Ci,t ( j) dj
                                                       e        .
                                         0

Thus, e is the elasticity between varieties produced within a given country, η the elasticity
between domestic and foreign goods, and γ the elasticity between goods produced in
different foreign countries. An important special case obtains when σ = η = γ = 1. We
call this the Cole-Obstfeld case, in reference to Cole and Obstfeld (1991). This case is more
tractable and has some special implications that are worth highlighting. Thus, we devote
special attention to it, although we will also derive results away from it.
    The parameter α indexes the degree of home bias, and can be interpreted as a measure
of openness. Consider both extremes: as α → 0 the share of foreign goods vanishes; as
α → 1 the share of home goods vanishes. Since the country is infinitesimal, the latter
captures a very open economy without home bias; the former a closed economy barely
trading with the outside world.
                                                                                   ´
    We have included a taste shifter Λi,t , which is always normalized so that Λi,t di =
1, that affects the utility of imports from country i. All countries experience the same
taste configuration {Λi,t }. Thus, variations in Λ H,t allow us to consider variations in the

                                                      7
demand for Home’s exports.
    Households seek to maximize their utility subject to the sequence of budget con-
straints
  ˆ    1                              ˆ     1ˆ 1                                     ˆ   1
           PH,t ( j)CH,t ( j)dj +                  Pi,t ( j)Ci,t ( j)djdi + Dt+1 +               Ei,t Dti +1 di
   0                                    0     0                                      0
                                                                                     ˆ       1
                                                                                                  1 + τt−1
                                    ≤ Wt Nt + Πt + Tt + (1 + it−1 ) Dt +                               i
                                                                                                           Ei,t (1 + iti −1 ) Dti di
                                                                                         0        1 + τt−1

for t = 0, 1, 2, . . . In this inequality, PH,t ( j) is the price of domestic variety j, Pi,t is the
price of variety j imported from country i, Wt is the nominal wage, Πt represents nom-
inal profits and Tt is a nominal lump sum transfer. All these variables are expressed in
domestic currency. The portfolio of home agents is composed of home and foreign bond
holding: Dt is home bond holdings of home agents, Dti is bond holdings of country i of
home agents. The returns on these bonds are determined by the nominal interest rate
in the home country it , the nominal interest rate iti in country i, and the evolution of the
nominal exchange rate Ei,t between home and country i. Capital controls are modeled as
follows: τt is a tax on capital inflows and subsidy on capital outflows in the home country,
and similarly τti is a tax on capital inflows and subsidy on capital outflows in country i.
The proceeds of these taxes are rebated lump sum to the households at Home and country
i, respectively. The Home country taxes inflows to make the after tax (net of any subsidy
paid by their own country of origin) return to foreign investors (1 + it−1 )/(1 + τt−1 ) in
domestic currency.
     We can re-express the household budget constraint as

                        ˆ    1
  Pt Ct + Dt+1 +                 Ei,t Dti +1 di
                         0
                                                                                     ˆ       1
                                                                                                 1 + τt−1
                                   ≤ Wt Nt + Πt + Tt + (1 + it−1 ) Dt +                                    Ei,t (1 + iti −1 ) Dti di,
                                                                                         0       1 + τti−1




                                                                  8
using price indices

                                                     1− η               1− η           1
                               Pt = [(1 − α) PH,t + αPF,t ] 1−η ,
                                      ˆ              ! 1
                                            1                             1− e
                                                            1− e
                             PH,t =             PH,t ( j)          dj              ,
                                        0
                                       ˆ                           !     1
                                            1                           1− γ
                                                      1− γ
                              PF,t =            Λi,t Pi,t di                   ,
                                        0
                                       ˆ                            !    1
                                            1                           1− e

                              Pi,t =            Pi,t ( j)1−e dj                .
                                        0


Here Pt is the Home consumer price index (CPI), PH,t is the Home producer price index
(PPI), PF,t is a price index of imported goods at Home, while Pi,t is country i’s PPI.


2.2   Firms
Technology. A typical firm in the home economy produces a differentiated good with a
linear technology given by
                                  Yt ( j) = A H,t Nt ( j)                        (2)

where A H,t is productivity in the home country. We denote productivity in country i by
Ai,t .
    We allow for a constant employment tax 1 + τ L , so that real marginal cost deflated by
Home PPI is given by
                                          1 + τ L Wt
                                    MCt =              .                                 (3)
                                           A H,t PH,t
We take this employment tax to be constant in our model. We explain below how it is
determined.


Price-setting assumptions. We will consider a variety of price setting assumptions: flex-
ible prices, one-period in advance sticky prices, and sticky prices a la Calvo.
    As in Galí and Monacelli (2005), we maintain the assumption that the Law of One
Price (LOP) holds so that at all times, the price of a given variety in different countries is
identical once expressed in the same currency. This assumption is sometimes known as
Producer Currency Pricing (PCP). This is sometimes contrasted with the assumption of
Local Currency Pricing (LCP), where each variety’s price is set separately for each country
and quoted (and potentially sticky) in that country’s local currency. Thus, LOP does not

                                                    9
necessarily hold. It has been shown by Devereux and Engel (2003) that LCP and PCP
may have different implications for monetary policy. However, for our purposes, these
two polar cases are equivalent since, for the most part, we will study the model assuming
fixed exchange rates.
    First, consider the case of flexible prices. Firm j optimally sets its price PH,t ( j) to max-
imize
                                max ( PH,t ( j)Yt|t − PH,t MCt Yt|t )
                                         PH,t ( j)
                      
                 P ( j) −e
where Yt|t = H,t  PH,t     Yt , taking the sequences for MCt , Yt and p H,t as given.
    Second, consider the case where prices are set one period in advance as in Obstfeld
and Rogoff (1995). Since we consider only one time-unanticipated shocks around the
symmetric deterministic steady state, this simply means that prices are fixed at t = 0 and
flexible for t ≥ 1.
    Third, consider Calvo price setting, where in every period, a randomly selected frac-
tion 1 − δ of firms can reset their prices. Those firms that get to reset their price choose a
reset price Ptr to solve
                                                             !
                                ∞              k
                                                 1
                       max
                        rPt
                                ∑ δk        ∏ 1 + it+h            ( Ptr Yt+k|t − PH,t MCt Yt+k|t )
                               k =0         h =1

                              −e
                       Ptr
where Yt+k|t =        PH,t+k          Ct+k .


2.3   Market Clearing
                                                           ´                            e
                                                                 1         e −1         e −1
Defining aggregate output to be Yt =                            0 Yt ( j )
                                                                             e dj              we obtain the goods market
clearing condition

                                           −η                    ˆ                       !−γ            !−η
                                                                         1                          i
                                                                                                   PF,t
                                     PH,t                                     PH,t
            Yt = (1 − α)                             Ct + αΛ H,t                   i
                                                                                                                Cti di.   (4)
                                      Pt                             0       Ei,t PF,t              Pti

Labor market clearing in the home economy is then
                                                            ˆ    1              −e
                                                  Yt                   Pt ( j)
                                            Nt =                                        dj                                (5)
                                                 A H,t       0          Pt
             ´1
where Nt =    0   Nt ( j)dj.



                                                                10
2.4   Terms of Trade, Exchange Rates and UIP
Let Ei,t be nominal exchange rate between home and i (an increase in Ei,t is a deprecia-
tion of the home currency). Because the Law of One Price holds, we can write Pi,t ( j) =
      i ( j ) and P = E Pi where Pi ( j ) is country i’s price of variety j expressed in its own
Ei,t Pi,t          i,t   i,t i,t            i,t
                         ´                  1
                     i =     1 i         1−e 1−e is country i’s domestic PPI (in terms of country i’s
currency, and Pi,t          0 Pi,t ( j )
currency, as opposed to Pi,t which is expressed in Home currency). We therefore have

                                              PF,t = Et Pt∗

where
                                             ˆ                              !      1
                                                      1                           1− γ
                                                                i1−γ
                                   Pt∗ =                  Λi,t Pi,t di
                                                  0

is the world price index and

                                        ´                                            1
                                            1      1−γ i1−γ                           1− γ
                                           0 Λi,t Ei,t Pi,t di
                                 Et =        ´                                  1
                                                   1      i1−γ                   1− γ
                                                  0 Λi,t Pi,t  di

is the effective nominal exchange rate.
    The effective terms of trade are defined by

                                                          ˆ                         !     1
                                                               1                         1− γ
                                    PF,t                                 1− γ
                               St =      =                         Λi,t Si,t di                  (6)
                                    PH,t                   0


where Si,t = Pi,t /PH,t is the terms of trade of home versus i. The terms of trade can then
be expressed as
                                               Et Pt∗
                                          St =        .                                  (7)
                                                PH,t
The terms of trade can be used to rewrite the home CPI as

                                                                          1− η      1
                                  Pt = PH,t [1 − α + αSt                         ] 1− η .        (8)

   Finally we can define the real exchange rate between home and i as Qi,t = Ei,t Pti /Pt .
Similarly let the effective real exchange rate be

                                                               Et Pt∗
                                              Qt =                    .
                                                                Pt


                                                           11
   Absence of arbitrage requires that

                                         1 + τt          i Ei,t+1
                              1 + it =           ( 1 + i t )      .
                                         1 + τti             Ei,t

for all i ∈ [0, 1]. This equation indicates that capital controls introduce a wedge in the
Uncovered Interest Parity (UIP) equation—an observation that will play an important
role in our analysis.


2.5   Equilibrium Conditions with Symmetric Rest of the World
We now summarize the equilibrium conditions. For simplicity of exposition, we focus
on the case where all foreign countries are identical. Moreover, we assume that foreign
countries do not impose capital controls. We denote foreign variables with a star. Taking
foreign variables as given, equilibrium in the home country can be described by the fol-
lowing equations. We find it convenient to group these equations into two blocks, which
we refer to as the demand block and the supply block.
   The demand block is independent of the nature of price setting. It is composed of the
Backus-Smith condition
                                                    1
                                      Ct = Θt Ct∗ Qtσ ,                                (9)

where Θt is a relative Pareto weight whose evolution is given by equation (13) below, by
the equation relating the real exchange rate to the terms of trade
                                  h                           i 1
                             Q t = ( 1 − α ) ( S t ) η − 1 + α η −1 ,                              (10)

the goods market clearing condition
                                                −η
                                            Qt                              γ
                         Yt = (1 − α)                   Ct + αΛ H,t St Ct∗ ,                       (11)
                                            St

the labor market clearing condition

                                                  Yt
                                         Nt =          ∆t                                          (12)
                                                 A H,t

                                                      ´ 1  PH,t ( j) −e
where ∆t is an index of price dispersion ∆t =          0     PH,t           , the Euler equation


                                               −1 Ct+1
                                                   σ
                                  1 + it =   β         Π t +1
                                                   Ctσ

                                                 12
               P          St    Q t −1
where Πt = Pt+t 1 = Π H,t Q t   S t −1   is CPI inflation, the arbitrage condition between home
and foreign bonds
                                             Θσt+1   1 + it Et
                                                   =              ,                                          (13)
                                              Θtσ    1 + it∗ Et+1
and the country budget constraint
                                                 
                   NFAt = −Ct∗−σ St−1 Yt − Q−
                                            t
                                              1
                                                C            ∗
                                                 t + β (1 + τt ) NFAt+1                                      (14)

where NFAt is the country’s net foreign assets at t, which for convenience, we measure
in the foreign price at home PF,t as the numeraire, and which we adjust by the foreign
marginal utility of consumption Ct∗−σ . The country budget constraint is derived from
the consumer’s budget constraint after substituting out the lump-sum transfer. Under
government budget balance the transfer equals the sum of the revenue from the labor tax
and the tax on foreign investors, net of the revenue lost to subsidize domestic residents’
investments abroad.3 We also impose a No-Ponzi condition so that we can write the
budget constraint in present-value form

                                 ∞           t −1                                                  
                   NFA0 = − ∑ β          t
                                             ∏      (1 + τs∗ )       Ct∗−σ       St−1 Yt   − Q− 1
                                                                                              t Ct       .   (15)
                                t =0         s =0

   The supply block varies with the nature of price setting. With flexible prices, it boils
down to the following condition, which combines the household and firm’s first-order
conditions,
                                               1 + τL φ
                              Ct−σ St−1 Qt = M       N                                 (16)
                                                A H,t t
where M = e−e 1 is the desired markup of price over marginal cost, together with the no
price dispersion assumption ∆t = 1. With one period in advance price stickiness, the
                                                                                  P0∗
only difference is that at t = 0, all prices are fixed. This means that S0 = E0 PH,0  where
P0∗ and PH,0 are fixed. Finally with Calvo price setting, the supply block is more complex.
It is composed of the equations summarizing the first-order condition for optimal price
setting
                                           −1      e −1
                                   1 − δΠeH,t       Ft
                                              =            ,
                                      1−δ          Kt
  3 Ofcourse, we do not require budget balance but since Ricardian equivalence holds here, all other
government financing schemes have the same implications.




                                                          13
                                              1 + τL     φ
                                  Kt = M             Yt Nt ΠeH,t + δβKt+1 ,
                                               A H,t
                                   Ft = Yt Ct−σ St−1 Qt ΠeH,t
                                                           −1
                                                              + δβFt+1 ,

together with an equation determining the evolution of price dispersion

                                              ∆t = h(∆t−1 , Π H,t ),
                                                            e
                                              1−δΠe−1       e −1
where h(∆, Π) =          + (1 − δ )
                      δ∆Πe                    . 1− δ
    For most of the paper, we will be concerned with fixed exchange rate regimes (either
pegs or currency unions) in which case we have the additional restriction that Et = E0 for
all t ≥ 0 where E0 is predetermined.


2.6    Steady State Labor Tax
We allow for a constant tax on labor in each country. We pin this tax rate down by assum-
ing that it is optimally set by each country and considering a symmetric steady state with
flexible prices.4
Proposition 1 (Steady State Tax). Suppose prices are flexible, that productivity is constant
across time and countries and there are no export demand shocks. Then the unique symmetric
                                                                  1    η + γ −1
deterministic equilibrium has a constant labor tax given by τ L = M (1− α ) η + γ −1
                                                                                     − 1 and optimal
capital controls are equal to zero.
    From each country’s perspective, the labor tax is the result of a balancing act between
offsetting the monopoly distortion of individual producers and exerting some monopoly
power as a country. The two terms in the optimal tax formula reflect the two legs of this
tradeoff. Reflecting the former leg of the tradeoff, the optimal labor tax is decreasing in
the degree of monopoly power of individual firms (M). Reflecting the second leg of the
tradeoff, the optimal labor tax is increasing in the degree of openness (α), and decreasing
in the elasticity of substitutions between home and foreign goods (η) as well as in the
elasticity of substitution between goods of different countries (γ).


2.7    Shocks
In the remainder of the paper we will characterize the response to various shocks. We
assume that the economy is initially at the deterministic symmetric steady state and char-
   4 The level of the tax is actually only relevant when we study the model under the Calvo pricing assump-

tion. Our other results apply for any level of the tax rate.

                                                        14
acterize the optimal use of capital controls for a country in response to various shocks. For
the most part, until Section 5, we assume that other countries do not use capital controls,
so that τt∗ = 0 for t ≥ 0.
    We will consider the following shocks:

   i. productivity shocks { A H,t }t≥0 ,

  ii. export demand shocks {Λ H,t }t≥0 ,

  iii. foreign consumption shocks {Ct∗ }t≥0 ,

  iv. wealth shocks to NFA0 ,

   v. risk-premium shocks {Ψt }t≥0 .

The risk premium shock can be introduced as a separate shock or computed as a combi-
nation of the export demand shocks and consumption shocks, as we explain next.
    Shocks to foreign consumption represent changes in both world interest rates and ex-
port demand for the home country. For example, a change that increases the growth rate
of {Ct∗ }t≥0 implies an increase in world real interest rates. In any period t, the level of Ct∗
                                     γ
also affects export demand αΛ H,t St Ct∗ . Thus, a shock to interest rates that keeps export
demand unchanged requires a combination of shocks to both {Ct∗ }t≥0 and {Λ H,t }t≥0 so
that Ct∗ Λ H,t is unchanged. As far as the home country is concerned, changes in interest
rates that leave export demand unchanged are equivalent to shocks to the rate of return in
the home country demanded by investors, due to a wedge between foreign investors and
the home country. Although our model lacks uncertainty, such a wedge could stand in for
the risks of investing in the home country, if these risks are not equally valued between
borrowers and lenders. It may also represent investor’s preferences for a particular coun-
try’s bonds along the lines of portfolio-balance models a la Black (1973) and Kouri (1976).
Thus, we will call this particular combination of shocks, to both {Ct∗ }t≥0 and {Λ H,t }t≥0 , a
risk premium shock Ψt = (Ct∗+1 /Ct∗ )σ .
    In the small open economy context, there are many interpretations for the wealth
shock. It may capture the return on investments in risky assets, the default on debt
held abroad, etc, which are not explicitly modeled. Another important interpretation
for wealth shocks is fluctuations in commodity prices. Suppose in addition to the goods
described previously, the Home country owns an endowment of a commodity good Xt
(e.g. oil, copper, soybeans, etc.) that it does not consume and exports to international
markets taking the price PX,t as given in foreign currency. Thus, the budget constraint



                                                15
becomes
                     ˆ   1
    Pt Ct + Dt+1 +           Ei,t Dti +1 di
                     0
                                                                        ˆ   1
                                                                                1 + τt−1 i
             ≤   Wt Nt + Πt + Et∗ PX,t
                                   ∗
                                       Xt     + Tt + (1 + it−1 ) Dt +                i
                                                                                         Et (1 + iti −1 ) Dti −1 .
                                                                        0       1 + τt−1

where Et∗ is the exchange rate against the reference country for which the price PX,t∗ is

quoted. The only new element is the presence of Et∗ PX,t
                                                       ∗ X on the right hand side of this
                                                           t
constraint. The model is then summarized by the same equilibrium conditions as before
if we reinterpret NFAt as also capturing the present value (discounting using the foreign
interest rate) of the revenue from exports of this commodity. Under this interpretation, a
                            ∗ }
shock to the price path { PX,t  t≥0 or the endowment path { Xt }t≥0 can be captured by its
impact on the present value ∑∞       t ∗−σ P∗ X as a shock to NFA .
                                t=0 β Ct     X,t t                 0



3     Flexible, Rigid and One-Period Sticky Prices
In this section, we study three different price setting assumptions. We first focus on two
extreme cases, perfectly flexible or perfectly rigid prices. We then consider an interme-
diate case where prices are set one period in advance. The next section considers the
canonical New Keynesian pricing assumption with staggered price setting a la Calvo.


3.1     Flexible Prices
We start with the case of flexible prices. The planning problem maximizes utility (1) sub-
ject to the equilibrium conditions (9), (10), (11), (12) with ∆t = 1, (15), and (16). The max-
imization takes place over {Ct , Yt , Nt , St , Qt } taking both domestic productivity { A H,t }
and foreign variables {Ct∗ , Λ H,t } as given.
    If the sequence { A H,t , Ct∗ , Λ H,t } is constant, then the solution for {Ct , Yt , Nt , St , Qt } is
also constant as long as the program is sufficiently convex. We have verified convexity in
the Cole-Obstfeld case. We assume it also holds away from this case so that we can char-
acterize the optimum using first order conditions, as is typically done for other Ramsey
problems.
    Interestingly, even with flexible prices, when the paths for A H,t and Λ H,t are not con-
stant, it is generally optimal to use capital controls. Optimal capital controls can be in-
ferred by taking the first-order conditions of the planning problem above and using the
           Θ                 1
fact that Θt+t 1 = (1 + τt ) σ .

                                                     16
Proposition 2 (Flexible Prices). Assume prices are perfectly flexible. In general, optimal capital
controls are non zero. They equal zero in the following cases:

   i. for permanent shocks to productivity A H,t = A0H for all t ≥ 0;

  ii. for permanent export demand shocks Λ H,t = Λ0H for all t ≥ 0;

  iii. for permanent foreign consumption shocks Ct∗ = C ∗0 for all t ≥ 0;

  iv. for wealth shocks NFA0 6= 0.

When σ = η = γ = 1, optimal capital controls are equal to zero for any { A H,t }t≥0 and {Ct∗ }t≥0 ,
and τt has the same sign as Λ H,t+1 − Λ H,t in response to export demand shocks, and the opposite
sign as Ψt − 1 in response to risk premium shocks.

    The fact that capital controls are in general useful even though prices are flexible might
seem surprising given the fact that we are considering a small open economy, with no
ability to affect the world interest rate. This issue is discussed in detail in Costinot et al.
(2011). The result can be understood by noting that capital controls, by allowing a country
to reallocate demand intertemporally, allow this country to manipulate its terms of trade,
raising them in some periods and lowering them in others. This margin is in general
useful, unless of course the shocks are permanent, in which case no gain can be reached
by engaging in this kind of intertemporal terms of trade manipulation. Moreover, in the
Cole-Obstfeld case, it is not optimal to use capital controls in response to any path for
productivity, foreign consumption shocks or wealth shocks. Capital controls are optimal
in this case, however, in response to export demand shocks.


3.2   Rigid Prices
We now turn to the extreme opposite case, where prices are entirely rigid and fixed at
their steady state values St = Qt = 1 for all t ≥ 0. The planning problem now drops as
constraints equations (10) and (16); the former is dropped since it is automatically satis-
fied, the latter should not be imposed because firms must supply whatever is demanded
at the given price. The planning problem imposes St = Qt = 1 for all t ≥ 0 in all the
remaining constraints. After substituting out the constraints for consumption and labor
it can be written as
                     "                                                   ∗  1+ φ #
                  ∞
                        1                   1                            Ct
        max ∑ βt           Θ1t −σ Ct∗1−σ −     (αΛ H,t + Θt (1 − α))1+φ
        { Θ t } t =0   1−σ                 1+φ                           A H,t


                                                17
subject to,
                                 ∞
                               α ∑ βt Ct∗1−σ [Θt − Λ H,t ] = NFA0 .
                                 t =0

The problem is convex: it features a concave objective and linear constraint in Θt . Putting
a multiplier Γ > 0 on the left-hand side of the budget constraint, the necessary and suffi-
cient first-order condition is

                                                    φ       −(1+φ) ∗σ+φ
               Θ− σ
                t − (1 − α ) ( αΛ H,t + Θt (1 − α )) A H,t        Ct      + Γα = 0.           (17)

The next proposition follow immediately using this equation.

Proposition 3 (Rigid Prices). If prices are completely rigid the optimal capital controls τt are:

   i. the same sign as A H,t+1 − A H,t , in response to productivity shocks;

  ii. the opposite sign as Λ H,t+1 − Λ H,t , in response to export demand shocks;

  iii. the opposite sign as Ct∗+1 − Ct∗ , in response to foreign consumption shocks;

  iv. the opposite sign as Ψt − 1, in response to risk premium shocks;

   v. equal to zero in response to initial wealth shocks.

    It is interesting to contrast the use of capital controls when prices are flexible with
their use when prices are entirely rigid. There are both similarities and differences. In
both cases, capital controls are not used in response to permanent productivity, export
demand, or initial wealth shocks. But the use of capital controls in response to transitory
shocks is quite different. For example, at least in the Cole-Obstfeld case, in response to
productivity shocks or foreign consumption shocks, capital controls are zero when prices
are flexible, but have the opposite sign as Ct∗+1 − Ct∗ or the same sign as A H,t+1 − A H,t
when prices are entirely rigid. In response to export demand shocks, optimal capital
controls τt have the same sign as Λ H,t+1 − Λ H,t when prices are flexible, but the opposite
sign when prices are entirely rigid.
    A useful example is when productivity is increasing over time. In this case, optimal
capital controls are zero when prices are flexible, but are positive when prices are rigid.
With flexible prices, the country’s price index decreases over time. This expected deflation
raises the real interest rate and increases the growth rate of consumption. In the Cole-
Obstfeld case trade is always balanced, so output increases at the same rate. With rigid
prices, the real interest rate is fixed, so the growth rate of consumption is too low. Positive
capital controls help by increasing the nominal interest rate. This increases the growth

                                                 18
rate of consumption. In the process, the growth rate of output is also increased, but less so,
implying that the trade balance moves towards surplus. Since this would not happen at
the flexible price allocation without capital controls, this underscores that capital controls
are a second best tool. They allow the country to regain some monetary autonomy, which
provides control over the intertemporal allocation of spending. However, capital controls
cannot affect the division of spending between home and foreign goods when prices are
completely rigid. In other words, capital controls have no expenditure switching effects.


3.3   One Period in Advance Price Setting
We now assume that prices are set one period in advance, as in Obstfeld and Rogoff
(1995). We continue to examine a shock that hits the economy at t = 0. This implies that
prices are effectively fixed in short run, at t = 0 when the shock hits, but flexible thereafter
t = 1, 2, . . .
    We use dynamic programming to split the planning problem into two. The problem
for t ≥ 1 given NFA1 is identical to the case with flexible prices. Define the value function
                                                                             "                1+ φ
                                                                                                     #
                                                                  ∞
                                                                                 Ct1−σ       Nt
                  V ( NFA1 ) =                max
                                  {Ct ,Θt ,Nt ,Yt ,St ,Qt }∞
                                                                  ∑ β t −1       1−σ
                                                                                         −
                                                                                             1+φ
                                                           t =1   t =1

subject to the equilibrium conditions (9), (10), (11), (12) with ∆t = 1, (16) , for all t ≥ 1,
and the budget constraint

                               ∞                                     
                      NFA1 = − ∑ βs Cs∗−
                                       +1
                                         σ
                                             S −1
                                                   Y
                                               s +1 s +1 − Q −1
                                                             s +1 s +1 .
                                                                 C
                                      s =0

   The t = 0 planning problem is

                                                                   1+ φ
                                                                                             !
                                                C01−σ  N
                             max                      − 0 + βV ( NFA1 )
                       C0 ,Θ0 ,N0 ,Y0 ,NFA1     1−σ 1+φ

subject to (9), (11), (12) with ∆0 = 1, for t = 0, imposing S0 = Q0 = 1 in all these
constraints, and the budget constraint

                              NFA0 = −C0∗−σ (Y0 − C0 ) + βNFA1 .

   With one-period in ahead sticky prices, we are able to provide tight results for tem-
porary productivity and export demand shocks, as well as for permanent productivity,


                                                         19
export demand, and wealth shocks in the Cole-Obstfeld case.

Proposition 4 (Transitory Shocks with Sticky Prices). Suppose that prices are sticky one period
in advance. Then optimal capital controls τ0 in period t = 0

    i. is a decreasing function of A H,0 and equals zero when A H,0 = A H in response to a transitory
       productivity shock (with A H,t = A H for all t ≥ 1);

   ii. is an increasing function Λ H,0 and equals zero when Λ H,0 = 1 in response to a transitory
       export demand shock (with Λ H,t = 1 for all t ≥ 1), in the limit of small time intervals
       ( β → 1);

  iii. has the same sign as C0∗ − C ∗ in response to a transitory foreign consumption shock (with
       Ct∗ = C ∗ for all t ≥ 1) when σ = 1;

  iv. has the same sign as Ψt − 1 in response to a transitory risk premium shock (with Ψt = 1 for
      all t ≥ 1) when σ = 1 in the limit of small time intervals ( β → 1).

In all these cases, optimal capital controls τt are zero for t ≥ 1.

    Overall, this proposition echoes the findings in Proposition 3, which assumed per-
fectly rigid prices.
    To gain some intuition for these results, consider the case of a temporary negative
productivity shock in the Cole-Obstfeld case. With flexible prices, the allocation would
feature constant labor, a temporary decrease in output, consumption, and exports (but
with constant export revenues). At t = 0, there would be a temporary improvement in the
terms of trade brought about by an increase in the prices of home goods, and a constant
wage. The nominal interest rate would be unchanged, but there would be a temporary
high real interest rate brought about by expected deflation as the prices of home goods
revert to their original values.
    Now consider what happens with one period in advance sticky prices. If the exchange
rate were flexible, we would achieve the same real allocation by temporarily raising the
nominal interest rate, letting the exchange rate appreciate at t = 0 and depreciate back at
t = 1. This can be seen as a version of the classical argument in favor of flexible exchange
rate famously put forth by Friedman (1953). This adjustment recreates the temporary
improvement in the terms of trade and the increase in the real interest rate.5
   5 The argument that one can achieve the flexible price allocation relies on the Producer Currency Pricing
(PCP) assumption. With Local Currency Pricing (LCP) exchange rate movements cannot affect relative
prices within a country, so they have no expenditure switching effects. As a result, the first best allocation
is not available even with flexible exchange rates (Devereux and Engel, 2003). Even with LCP, however, a
temporary appreciation increases the nominal, and hence real, interest rate.

                                                     20
    If the exchange rate is not flexible, then this solution cannot be attained because the
terms of trade are fixed at t = 0. Without capital controls, at t = 0, labor temporarily
increases, consumption and output are constant. Compared with the flexible price allo-
cation, output, labor and consumption are higher. Similarly, at t = 0, inflation and the
real interest rate are unchanged and are respectively higher and lower than at the flexi-
ble price allocation. It is therefore intuitively desirable to impose positive capital controls
and increase the nominal interest rate to decrease consumption at t = 0. At t = 0, output
then also decreases, but by less than consumption. Therefore the country runs positive
net exports at t = 0, which implies higher consumption and lower output for t ≥ 1.
    This analysis underscores that capital controls are a second best instrument. They
allow the country to regain some monetary autonomy and therefore some control over
the intertemporal allocation of spending. However, this reallocation is costly since it in-
troduces a wedge between the intertemporal prices for home and foreign households.
Moreover, capital controls cannot affect the division of spending between home and for-
eign goods in the short run when prices are fixed.
    Our next result deals with non-transitory shocks focusing on the Cole-Obstfeld case.
The proof is contained in the appendix.

Proposition 5 (Persistent Shocks with Sticky Prices). Suppose that prices are sticky one period
in advance. Consider the Cole-Obstfeld case σ = η = γ = 1. Then

   i. in response to any shock to the path { A H,t }t≥0 of productivity, optimal capital controls τ0
      are an decreasing function of A H,0 and zero when A H,0 = A H .

   ii. in response to a small enough permanent export demand shock Λ H,t = Λ H for all t ≥ 0
       where Λ H 6= 1, optimal capital controls τ0 are an increasing function of Λ H with τ0 = 0
       when Λ H = 1;

  iii. in response to any shock to the path {Ct∗ }t≥0 of foreign consumption, optimal capital con-
       trols τ0 are an increasing function of C0∗ and zero when C0∗ = C ∗ .

  iv. in response to a small enough wealth shock NFA0 6= 0, optimal capital controls τ0 are an
      increasing function of NFA0 and zero when NFA0 = 0;6

In all these cases, optimal capital controls τt are zero for t ≥ 1.

   This proposition highlights an important insight regarding the effect of intermediate
price rigidity. When prices are perfectly flexible or perfectly rigid, capital controls are not
   6 This   last result is true more generally for any positive shock NFA0 > 0.


                                                       21
used to respond to permanent shocks. In contrast, they are used in these circumstances
when prices are sticky for just one period. Intuitively, when prices can adjust more in the
long run than in the short run, permanent shocks have a different effect in the short and
long run. In this sense, the result is similar to temporary shocks in the case of perfectly
flexible or rigid prices, where capital controls are used.
    A final remark is in order. When exchange rates are fixed our analysis and results hold
under either PCP or LCP assumptions. In the PCP case flexible exchange rates would
obtain the first best allocation. If unavailable, then capital controls are a useful second-
best instrument. Interestingly, in the LCP case, flexible exchange rates are not enough
to obtain the first-best allocation. Indeed, when prices are completely rigid, as in the
previous section, or when prices are set one period in advance, as in this section, capital
controls are a perfect substitute for the exchange rate. Both operate on the UIP margin,
liberating monetary policy, and both lack any expenditure switching effects. This exact
equivalence will no longer hold when staggered price setting, as in the Calvo price setting
case which we turn to next.


3.4       The Role of Openness
The degree to which a fixed exchange rate, coupled with nominal rigidities, lowers wel-
fare depends crucially on the openness of the economy. In particular, in the closed econ-
omy limit with α → 0 the inefficiency stemming from the distorted prices of home versus
foreign goods disappears, because the share of home goods becomes negligible. As we
now show, without capital controls, this does not necessarily imply that welfare losses
vanish. With the nominal interest rate pinned down by the UIP condition, monetary pol-
icy is severely constrained. As a result, intertemporal distortions remain, affecting overall
consumption decisions, even in the limit. Capital controls, however, can resolve these in-
tertemporal matters and restore welfare to the first best level in some, but not all, cases.7

Proposition 6. In the closed economy limit as α → 0

   i. without capital controls: when prices are perfectly rigid or set one period in advance, for
      generic shocks to { A H,t , Λ H,t , Ct∗ }t≥0 and {Ψt }t≥0 welfare is strictly below the level ob-
      tained with flexible prices;

   ii. with capital controls:

          (a) when prices are perfectly rigid:
   7 Weomit wealth shocks because in the closed economy limit they require some rescaling. For example,
one could study the limit where the initial wealth shocks are scaled so that NFA
                                                                              α
                                                                                 0
                                                                                   remains constant.

                                                  22
             i. for generic shocks to { A H,t , Λ H,t , Ct∗ }t≥0 welfare remains strictly below the level
                obtained with flexible prices;
            ii. for risk premium shocks {Ψt }t≥0 , welfare converges to the the level obtained with
                flexible prices;
       (b) when prices are set one period in advance: welfare converges to the level obtained with
           flexible prices.

    The first part of the proposition, highlights an interesting property of open-economy
models: as the economy becomes closed, by taking the import share to zero, we do not
necessarily converge to the closed economy equilibrium. For α > 0, a fixed exchange
rate ensures a unique equilibrium. In contrast, in a closed economy a fixed exchange rate
amounts, through the UIP condition, to setting the interest rate at the foreign interest rate.
As is well known, this closed economy model with a fixed interest rate features a contin-
uum of equilibria. Technically, the equilibrium correspondence with a fixed exchange rate
is not (lower hemi) continuous in the parameter α at α = 0 (it is upper hemi continuous).
Less technically, it suggests caution in using a closed economy model as an approxima-
tion to an open economy. The result is of independent interest, since it is unrelated to
capital controls and we are unaware of any similar result in the literature.
    Why are capital controls always successful at eliminating welfare losses in the closed
economy limit when prices are set for just one period but not when they are permanently
fixed? By affecting the interest rate, capital controls can target any level of total consump-
tion. Although the composition of consumption, between home and foreign goods is
distorted, the associated welfare losses vanish in the limit. On first thought, this would
seem to imply that optimal capital controls help approach the first best welfare as α → 0
quite generally. However, manipulating total consumption via capital controls requires
(small) departures from trade balance (for low α). This creates (small) positive or neg-
ative NFA1 . Now, when prices can adjust in the following period these (small) NFA1
balances have a negligible effects on continuation utility. This result extends when prices
are fixed for any number N > 1 of periods. However, when prices are permanently rigid,
small changes in NFA1 amount to wealth shocks that have non-negligible effects on wel-
fare. For low α and perfectly rigid prices, these small wealth shock may have large effects
on the economy because inducing the necessary trade balance adjustment requires large
changes in overall consumption.
    This raises an interesting question: Does Calvo pricing look closer to rigid price case
or the one-period-in-advance case? In the next section we show that, just as in the case of
fully rigid prices, the first best is not generally attained as α → 0.

                                                  23
    An important exception is the case of risk premium shocks. From the home country’s
perspective, this shock amounts to a world interest rate shock. What is special is that
in the closed economy limit the flexible price allocation, as well as its relative prices, are
unchanged by risk premium shocks. Thus, the economy does not need to adjust to these
shocks, just insulate itself from them and capital controls are able to do precisely this.
Perhaps the surprising result is that this logic does not apply more generally to other
shocks, such as productivity. Even in the closed economy limit, capital controls are not
necessarily sufficient to obtain the flexible price allocation.


4     Staggered Price Setting
In this section, we study the standard New Keynesian version of the model, with stag-
gered price setting a la Calvo. In addition to allowing for more realistic dynamics, this
has two important implications for our analysis. First, it introduces a welfare cost from
inflation, which is not present in the case of prices set one period in advance. Second,
capital controls affect the evolution of absolute and relative prices, including the real ex-
change rate. Forward looking optimal policy must take this into account because prices
only adjust gradually. In this sense, it may introduce a prudential concern for the tempo-
rary movement of relative prices. By this we mean that it might be optimal to use capital
controls now if forcing variables (productivity, export demand, foreign consumption) are
either expected to return to their steady state or remain at their steady state values (e.g.
“hot money”) for a while and deviate only in the future (e.g. “news shocks”).
    As is standard in the literature, we work with a log-linearized approximation of the
model. As before, at t = 0, the economy is hit with an unanticipated shock. It is con-
venient to work with a continuous time version of the model. This does not affect our
results, but it is useful because it implies that no price index can jump at t = 0 and this
simplifies the derivation of initial conditions characterizing the equilibrium. We denote
the instantaneous discount rate by ρ, and the instantaneous arrival rate for price changes
by ρδ .


4.1   Summarizing the Economy and the Experiment
We first describe the natural allocation with no intervention, defined as the allocation that
prevails if prices are flexible and capital controls are not used. We then summarize the
behavior of the sticky price economy with capital controls in log-deviations (gaps) from
the natural allocation. For both the natural and the sticky price allocation with capital


                                             24
controls, the behavior of the rest of the world is taken as given.
    We use lower cases variables to denote gaps from the symmetric deterministic steady
state. We denote the natural allocation with bars, and the gaps from the natural allocation
with hats.


The natural allocation. The shocks we consider are { ah,t , λh,t , c∗t , it∗ , πt∗ }t≥0 and NFA0 .
Although we could imitate a risk premium shock from a combination of c∗t and λh,t , as we
did in the previous section, we shall now tackle this shock separately in a later section.
    We first solve for the allocation as a function of these primitive shocks using the log-
linearized versions of the equilibrium conditions described in Section 2.5. One can show
that the natural allocation is given by

                   σ̂−1 (1 + φ)             α               α ( ω − 1) ∗        αω
             ȳt =             1
                                 ah,t +            1
                                                     λh,t −           1
                                                                        ct −           θ̄,
                    1 + φσ̂ −           1 + φσ̂  −          1 + φσ̂ −        1 + φσ̂−1
                     1+φ                 φα                 σ + φ ∗ σ + φ (1 − α )
             s̄t =             ah,t −             λh,t −            c −                   θ̄,
                   1 + φσ̂ − 1        1 + φσ̂ − 1         1 + φσ̂−1 t        1 + φσ̂−1

with
                          ˆ     ∞                              ω
                                                                             ˆ ∞
           ρ                                                    − 1 σ̂
       θ̄ = NFA0 + ρ                e−ρt λh,t dt +             σ           ρ     e−ρt (ȳt − y∗t )dt,
           α                0                        1+    ω
                                                           σ   − 1 σ̂(1 − α) 0

where y∗t = c∗t , since the world needs to run balanced trade with itself. We can also
compute the natural levels of employment and consumption from the equations ȳt =
ah,t + n̄t and c̄t = θ̄ + c∗t + 1−σ α s̄t , where we have substituted q̄t = (1 − α)s̄t into the
Backus-Smith condition. The constants are given by ν = − log(1 + τ L ), µ = log M,
ω = σγ + (1 − α)(ση − 1), and σ̂ = 1−ασ+αω .
    The natural real interest rate rr¯ t is defined from the home Euler equation c̄˙t = σ−1 (rr
                                                                                              ¯t−
ρ). It is more convenient to work with the natural interest rate r̄t defined in terms of the
home good r̄t = rr¯ t + αs̄˙ t . This turns out to equal

                                   1+φ                  αφ               α ( ω − 1) φ ∗
                     r̄t − ρ =               ȧh,t −             λ̇h,t +             ċ .
                                 1 + φσ̂ − 1         1 + φσ̂ − 1          1 + φσ̂−1 t

Using the home Euler equation c̄˙t = σ−1 (r̄t + αs̄˙ t − ρ), the foreign Euler equation ċ∗t =
σ−1 (it∗ − πt∗ − ρ), and differentiating the Backus-Smith condition c̄t = θ̄ + c∗t + 1−σ α s̄t , we
obtain the following restriction:

                                             it∗ − r̄t = −s̄˙ t + πt∗ .                                  (18)


                                                          25
Summarizing the system in gaps. The equations summarizing an equilibrium are the
log linearized analogues of the equilibrium conditions derived in Section 2.5. The de-
mand block is summarized by three equations,

                                 1−α
                         ŷ˙ t =     (it − it∗ ) + σ̂−1 [it∗ − π H,t − r̄t ],
                                  σ
                                         σθ̂˙ t = it − it∗ ,
                     ˆ ∞                        ω
                                                                ˆ ∞
                           −ρt                    −  1   σ̂
                         e θ̂t dt =             σ                    e−ρt ŷt dt,
                      0              1 + ωσ − 1 σ̂(1 − α) 0

representing the Euler equation (after substituting out for consumption using the goods
market clearing condition and the Backus-Smith condition), the UIP equation and the
budget constraint, respectively.
   The supply block consists of one equation, the New-Keynesian Philips Curve

                                π̇ H,t = ρπ H,t+1 − κ̂ ŷt − λσ̂αω θ̂t

where λ = ρδ (ρ + ρδ ) and κ̂ = λ (φ + σ̂ ).
  Finally, we have the initial condition

                                     ŷ0 = (1 − α)θ̂0 − σ̂−1 s̄0

which formalizes the fact that prices are sticky so that the terms of trade are predeter-
mined at t = 0, i.e. that ŝ0 = −s̄0 .
   These equations are sufficient to pin down an equilibrium in the variables that are
needed to evaluate welfare (see below). We can back out the rest of the variables as fol-
lows. The terms of trade gap ŝt from

                                     ŷt = (1 − α)θ̂t + σ̂−1 ŝt .

which combines the market clearing condition with the Backus-Smith condition. Simi-
larly, we can back out the employment gap n̂t and the consumption gap ĉt from

                                      ŷt = n̂t ,
                                                      ω
                                      ŷt = ĉt + α     ŝt − αθ̂t .
                                                      σ




                                                    26
Finally, capital controls can be inferred from the UIP equation

                                            τt = it − it∗ .


An experiment. Suppose we start in symmetric steady state where it = it∗ = r̄t = ρ,
π H,t = πt∗ = 0, ŷt = 0 and s̄t = 0. Now suppose there is an unexpected shock that
upsets the economy’s primitives { ah,t , λh,t , c∗t , it∗ , πt∗ }t≥0 and NFA0 . Sometimes it is useful
to think directly in terms of a shock to the sequence {r̄t , s̄t , it∗ , πt∗ , λh,t }t≥0 and NFA0 . It
is important to recognize that these variables are not independent since they must still
satisfy the restriction it∗ − r̄t = −s̄˙ t + πt∗ ; this reduces the potential dimensionality of the
shocks one can consider.
    Note that it , r̄t and it∗ enter the log-linearized equilibrium conditions only through two
variables: it − it∗ , which can be thought of as endogenous and controlled by θ̂˙ t = σ−1 τt ,
and r̄t − it∗ , which is an exogenous forcing variable. The only other exogenous shock that
enters this system of equations is the initial natural terms of trade s̄0 . (Alternatively, given
our restriction, one can think of the forcing variable as πt∗ − s̄˙ t .) Note that export demand
shocks {λh,t }t≥0 do not appear in this system of equations. However, as we show below,
they do appear in the welfare loss function. Thus, the entire set of relevant shocks can be
summarized by the path for two forcing variables r̄t − it∗ and λh,t plus the initial change
in the terms of trade s̄0 . Of course, most shocks that affect r̄t , e.g. productivity shocks,
may also affect the initial terms of trade s̄0 . Given this information one can compute the
equilibrium outcome for output gaps {ŷt }t≥0 and inflation {π H,t }t≥0 without capital con-
trols. One can also solve for the optimal allocation and capital controls. This determines
τt = it − it∗ , giving the path for the domestic interest rate as it = it∗ + τt .


4.2    Optimal Capital Controls in the Cole-Obstfeld Case
From now on we focus on the Cole-Obstfeld case. This case is attractive for two reasons.
First, with flexible prices, it is optimal not to use capital controls. Second, it is relatively
easy to derive a second order approximation of the welfare function around the symmet-
ric deterministic steady state.


Loss function. When σ = γ = η = 1, we can derive a simple second order approxi-
mation of the welfare function (see Appendix A.6 for the detailed derivation). The corre-
sponding loss function (in consumption equivalent units) up to a constant independent




                                                 27
of policy can be written as
                                       ˆ      ∞                                                             
                                                      −ρt       1      2    1 2      1                     2
             (1 − α)(1 + φ)                       e               απ π H,t + ŷt + αθ (θ̂t + θ̄ − αψ λh,t ) dt,
                                          0                     2           2        2

                                              2− α
                                                                                         1− α           ρ             ´∞
with απ =        e
                      ,α
             λ (1+ φ ) θ
                             =     α
                                  1+ φ        1− α      + 1 − α , αψ =              2− α         and θ̄ = α NFA0 + ρ   0    e−ρt λh,t dt.
                                                                                    1− α +1− α
    The first two terms in the loss function are familiar in New-Keynesian models and
are identical to those obtained by Galí and Monacelli (2005, 2008). The third term in the
loss function is new and captures the distortions introduced by capital controls. To un-
derstand this term, consider the In the Cole-Obstfeld case, suppose no export demand
shocks and set NFA0 = 0. The term then becomes αθ 21 θ̂t2 and the country’s budget con-
                         ´
straint is simply α e−ρt θ̂t dt = 0, which represents the present value of trade balances
−αθ̂t . Capital controls reallocate total consumption intertemporally, but this reallocation
is costly, i.e. θ̂t2 is minimized at θ̂t = 0.
    Note that απ is independent of α but that αθ goes to zero when α goes to zero. Hence
in the closed economy limit (α → 0), the cost of capital controls vanishes. The reason is
that for a given path of θ̂t , the associated trade balances −αθ̂t vanish as α goes to zero, and
so do the distortions associated with the wedge between home and foreign intertemporal
prices.
    Without shocks to export demand, optimal capital controls are equal to zero when
prices are flexible. In this case, the natural allocation represents an upper bound on wel-
fare with sticky prices. This is not necessarily true when there are shocks to export de-
mand. In that case, optimal capital controls are not zero when prices are flexible, and the
natural allocation is not necessarily and upper bound on welfare with sticky prices.


Planning problem.               The planning problem is a standard optimal control problem
                                   ˆ      ∞                                                             
                                                  −ρt       1      2    1 2      1                     2
                    min                       e               απ π H,t + ŷt + αθ (θ̂t + θ̄ − αψ λh,t ) dt                        (19)
               {π H,t ,ŷt ,it ,θ̂t } 0                     2           2        2

subject to
                                                      π̇ H,t = ρπ H,t − κ̂ ŷt − λαθ̂t ,

                                          ŷ˙ t = (1 − α)(it − it∗ ) − π H,t + it∗ − r̄t ,

                                                                     θ̂˙ t = it − it∗ ,
                                                                ˆ    ∞
                                                                         e−ρt θ̂t dt = 0,
                                                                 0




                                                                            28
                                              ŷ0 = (1 − α)θ̂0 − s̄0 .

The corresponding first-order conditions can be found in the appendix.
    To get a better feel for the planning problem, it is useful to imagine how it would
change if the exchange rate were flexible. The only difference is that it∗ must now be
replaced by it∗ + ėt , and the initial condition becomes ŷ0 = (1 − α)θ̂0 − s̄0 + e0 where
the initial level of the exchange rate e0 and the rate of exchange rate depreciation ėt are
additional control variables. In the case where there are no initial wealth shocks or export
demand shocks (NFA0 = λh,t = 0), it is clear that the solution then features π H,t = ŷt =
                         r̄ −i∗
θ̂t = 0 and it = it∗ + 1t −αt . The associated path for the exchange rate is determined by
                                                                           r̄ −i∗
et = s̄t for all t, which is equivalent to e0 = s̄0 and ėt = 1t −αt .
    With a flexible exchange rate the natural allocation can be attained. This observation
about the stabilizing role of flexible exchange rates goes back to Friedman (1953). With
a fixed exchange rate, perfect macroeconomic stabilization cannot be achieved. A way
to understand this is to go back to Mundell’s trilemma, which states that it is impossible
to have at the same time free capital flows, independent monetary policy, and a fixed
exchange rate. By introducing capital controls, the home country is able to regain some
monetary policy autonomy, even with a fixed exchange rate.


Flexible prices. Note that in the absence of export demand shocks, this proposition
shows that welfare is necessarily lower with sticky prices and optimal capital controls
than with flexible prices and no capital controls (optimal capital controls are zero with
flexible prices in the absence of export demand shocks), and hence the natural allocation
represents an upper bound for welfare. This is not necessarily true when there are export
demand shocks. Moreover in that case, optimal capital controls with flexible prices are
nonzero.

Proposition 7 (Flexible Prices). Suppose prices are completely flexible. Then optimal capital
controls are
                                           αθ αψ
                                  τt = α 2          λ̇ ,
                                       ( 1+φ ) + αθ h,t

and the allocation can be expressed in closed form (see the appendix).8


Rigid prices. When prices are completely rigid the solution can be expressed in closed
form. In Section 3, we found that the optimal Θt satisfied a simple first-order condition.
  8 This result also applies in the limit to flexible prices, i.e.   by taking λ → ∞ while simultaneously varying
           e
απ =   λ (1+ φ )
                   and κ̂ = λ(1 + φ).


                                                          29
The closed form solution we provide next can be seen as a log-linear approximation to
the solution of this first-order condition.

Proposition 8 (Rigid Prices). If prices are completely rigid optimal capital controls are
                                                                                       
                                        1                                     αθ αψ
                                τt =                            r̄t − it∗   +       λ̇    ,
                                     1−α+            αθ
                                                    1− α
                                                                              1 − α h,t

and the allocation can be expressed in closed form (see the appendix).

    Consistent with the earlier Proposition 3, the formula shows that, when prices are
rigid, capital controls are not used in response to a pure terms of trade shock: a permanent
shock in s̄t with no shock to r̄t (for example, due to a permanent shock in productivity).
Capital controls are used in response to natural interest rate (r̄t ) and export demand (λh,t )
shocks. This contrasts with the case of perfectly flexible prices, where capital controls
are used only in response to export demand shocks. Moreover, even in the case of pure
export demand shocks, the response is differently under flexible versus rigid prices.


Closed Economy limit (α → 0). We can also derive the optimal allocation in closed
form for the closed-economy limit α → 0.9 It is important to understand what this limit
represents. Basically, we index the solution of our planning problem (19) by α and look
at the limit (for any t) of this solution when α → 0. This is not equivalent to the planning
for a closed economy. The difference is that a closed economy would not face the budget
            ´∞
constraint 0 θ̂t e−ρt dt = 0. The closed economy solution is trivial and features perfect
                                                                                     ´∞
stabilization ŷt = π H,t = 0 with it = r̄t , θ̂˙ t = r¯t − it∗ and θ̂0 = s̄0 so that 0 θ̂t e−ρt dt = ρ1 s̄0 +
  ´
1 ∞
                                        ´                                                ´
            ∗ −ρt dt. As long as s̄ + ∞ (r̄ − i ∗ ) e−ρt dt 6 = 0, the constraint ∞ θ̂ e−ρt dt = 0
ρ 0 (r̄t − it ) e                   0     0         t    t                                  0  t
binds for the planning problem (19) with α → 0, and the solution of the planning problem
does not converge to the closed economy solution. These observations are consistent with
the discontinuity results in Proposition 6.
    Note that απ is independent of α and that αθ converges to zero.

Proposition 9 (Closed Economy Limit). In the closed economy limit as α → 0,
                                                                                       
                                                            (1 − απ κ̂ )2 νt  1
                                τt =   r̄t − it∗   +Γ                    e −                ,
                                                            απ (ρ − ν)       ραπ

where                                                       p
                                                    ρ−          ρ2 + 4α2π κ̂ 2
                                             ν=                                ,
                                                                  2
   9 To   take this limit, we assume that there are not initial wealth shocks so that NFA0 = 0.

                                                             30
                    ˆ    ∞                                                                                  
                                  −ρt                                                     1      1 − απ κ̂
         Γ = s̄0 +            e         (r̄t − it∗ )        1 + κ̂ + (1 − απ κ̂ )        2
                                                                                             −                       .
                      0                                                                 ρ απ   α π ( ρ − ν )2
The allocation can be expressed in closed form (see the appendix).

    For any finite time t, the proposition provides an accurate approximation to the solu-
tion for small α. However, as long as Γ 6= 0 capital controls do not return to zero in the
long run. By contrast, for α > 0, one can show that capital controls always returns to zero
in the long run. Thus, the double limits limα→0 limt→∞ τt = 0 and limt→∞ limα→0 τt 6= 0
do not coincide. This reflects the fact that, as α → 0, capital controls converges to zero
in the long run, as t → ∞, but do so increasingly slowly. This is something that will be
apparent in our simulations.
    In the particular case where 1 − απ κ̂ = 0, the solution is remarkably simple.

Corollary. In the closed economy limit α → 0, in the special case where 1 − απ κ̂ = 0, capital
controls are given by
                                                        Γ
                                     τt = r̄t − it∗ − κ̂ ,
                                                        ρ
and the allocation is constant: ŷt = −Γ and π H,t = − ρα1π Γ.

    As an example, consider a permanent improvement in the terms of trade, so that s̄0 <
0 with no change in r̄t or it∗ . Then Γ = s̄0 (1 + κ̂ ) < 0 and the solution entails positive
capital controls: τt = −κ̂ Γρ > 0. This conclusion on the use of capital controls in response
to permanent productivity shocks consistent with Proposition 5 and 6. Consider now the
case of a pure (positive or negative) mean-reverting natural interest rate shock to r̄t with
s̄0 = 0 and it∗ = ρ. In this case Γ has the same sign as the natural interest rate shock, and
so does it − r̄t = κ̂ Γρ . In other words, in the closed economy limit, capital controls less
than fully offset natural interest rate shocks.
    This shows that the Calvo pricing case shares properties of the rigid prices case and of
the one period in advance price setting case. As with one period in advance price setting,
and by contrast with rigid prices, capital controls are used to accommodate permanent
shocks to productivity. As with rigid prices, and by contrast with one period in advance
price setting, the natural allocation is not attained in the closed economy limit.
    The solution for capital controls is history dependent as long as Γ 6= 0—it depends on
future and past values of the shocks. Imagine for example that productivity is unchanged
for t ∈ [0, T ], is then expected to gradually decrease to a new lower level over the interval
t ∈ [ T, T 0 ], and then remain constant for t ∈ [ T 0 , ∞). Capital controls would be zero for
t ∈ [0, T ] under flexible prices (Proposition 7), rigid prices (Proposition 8) or prices set
one period in advance (Proposition 4). In contrast, with Calvo pricing, since Γ < 0 capital

                                                                  31
controls are positive τt > 0 for t ∈ [0, T ]. This illustrates a prudential nature of capital
controls, which is absent without staggered price setting.10


4.3    A Risk Premium Shock
Many discussions of capital controls, especially in developing countries, focus on cap-
ital inflow surges that are taken to be exogenous fluctuations in investor sentiments.
To capture this, we now model a risk premium shock ψt . The UIP equation becomes
it = it∗ + ψt + τt , so that the risk premium introduces a wedge between foreign investors
and the home country, in addition to capital controls. We do not attempt to model this
wedge endogenously. Although our model lacks uncertainty, it could stand in for the
risks of investing in the home country, if these risks are not equally valued between bor-
rowers and lenders. It may also represent investor’s preferences for a particular country’s
bonds along the lines of portfolio-balance models a la Black (1973) and Kouri (1976).
     As we already discussed in Section 3, as far as the home country is concerned, this
shock admits an equivalent representation as a combination of a shock to {Ct∗ }t≥0 with
Ċt∗     ∗
Ct∗ = ċt = ψt accompanied by an offsetting shock { Λ H,t }t≥0 to the demand for the home
country’s exports so that Ct∗ Λ H,t = C ∗ . We exploited this equivalent representation in
Section 3. Here instead, we model the risk premium shock directly, which we find in
many respects more enlightening. We confine ourselves to the Cole-Obstfeld case.

The natural allocation. We confine ourselves to shocks to ψt , setting c∗t = at = πt∗ = 0,
                                                                     ´t
NFA0 = 0 and it∗ = ρ. Without capital controls we have θ̄t = θ̄0 + 0 ψs ds. The natural
allocation is then

                                                   α
                                         ȳt = −       θ̄t ,
                                                 1+φ
                                                 1 + φ (1 − α )
                                         s̄t = −                θ̄t ,
                                                     1+φ

where the budget constraint                      ˆ   ∞
                                         θ̄0 +           ψt e−ρt dt = 0
                                                 0

pins down θ̄0 . We can also compute the natural levels of employment and consumption
from the equations ȳt = n̄t and c̄t = θ̄t + (1 − α)s̄t .
  10 For perfectly rigid prices, this is true as a first order approximation, i.e. it is a feature of the log-
linearized solution but not of the full nonlinear solution. The solution for Θt in equation (17) depends on Γ.
However, what Proposition 8 shows is that, to a first-order approximation, the ratio Θt+1 /Θt is independent
of Γ.

                                                         32
    We can compute the natural interest rate

                                                                                    αφ ˙
                                                                 r̄t − ρ =             θ̄t .
                                                                                   1+φ

    The natural allocation features trade imbalances. Indeed net exports are given by
 ¯ t = −αθ̄t , so that for negative risk premium shocks (ψt ≤ 0 for all t), the home country
nx
initially runs a trade deficit, and eventually runs a trade surplus together. Hence a neg-
ative risk premium shock leads on impact to current account deficits or “capital inflow
surges”. Conversely, a positive risk premium shock leads on impact to current account
surpluses or “capital flights” or “sudden stops”.


The planning problem in gaps.                                   We are led to the following planning problem
                                        ˆ   ∞             h                                                                  i
                                    1
                 min                            e   −ρt
                                                              απ π 2H,t   + ŷ2t   + αθ (θ̂t + αψ θ̄t + (1 − αψ )θ̄0 )   2
                                                                                                                                 dt   (20)
             {π H,t ,ŷt ,it ,θ̂t } 2   0


subject to
                                                      π̇ H,t = ρπ H,t − κ̂ ŷt − λαθ̂t ,

                                 ŷ˙ t = (1 − α)(it − it∗ − ψt ) − π H,t + it∗ + ψt − r̄t ,

                                                                 θ̂˙ t = it − it∗ − ψt ,
                                                                 ˆ ∞
                                                                        e−ρt θ̂t dt = 0,
                                                                   0

                                                               ŷ0 = (1 − α)θ̂0 − s̄0 .

Capital controls are given by τt = it − it∗ − ψt .


Flexible prices. With flexible prices, optimal capital controls are not zero, consistent
with Proposition 2.

Proposition 10 (Risk Premium Shock, Flexible Prices). Suppose prices are completely flexible
and the economy is subject to risk-premium shocks ψt . Then optimal capital controls are given by

                                                                               αθ αψ
                                                              τt = −         α 2         ψt ,
                                                                          ( 1+ φ ) + α θ

and the allocation can be expressed in closed form (see the appendix).11
  11 This result also applies in the limit to flexible prices, i.e. by taking λ → ∞ while simultaneously varying

απ = λ(1e+φ) and κ̂ = λ(1 + φ).


                                                                             33
    Optimal capital controls are proportional to the current risk premium ψt shock. The
tax τt has the opposite sign from ψt —policy leans against the wind, reducing the nominal
interest rate it when ψt > 0 and increasing it when ψt < 0. Recall that with no intervention
we have it = it∗ + ψt .
    Optimal capital controls also have the property of stabilizing the trade balance. Since
                                                                             ( 1+α φ )2 +αθ (1−αψ )
                                                  ˆ t + nx
the trade balance with intervention equals nxt = nx      ¯ t = −α                  ( 1+α φ )2 +αθ
                                                                                                    θ̄t   and
without intervention equals nx¯ t = −αθ̄t , the ratio nxt /nx
                                                            ¯ t is constant and less than one.
Optimal capital controls therefore mitigate the capital inflow surges associated with neg-
ative risk premium shocks, as well as the capital flight episodes associated with positive
risk premium shocks.


Rigid prices.    We can prove the analogues of Propositions 8 and 9. When prices are
completely rigid, we find the following simple solution.

Proposition 11 (Risk Premium Shock, Rigid Prices). Suppose that prices are completely rigid,
then optimal capital controls are given by

                                                       2α
                                              1−α+    1+ φ
                                τt = −                            ψt ,
                                                  α 2−α+(1−α)2
                                         1−α+    1+ φ  (1− α )2

and the allocation can be expressed in closed form (see the appendix).

   Once again, policy leans against the wind, more so than under flexible prices (τt reacts
more to ψt with rigid prices than with flexible prices), and the more so, the smaller α. Just
as with flexible prices, optimal capital controls have the property of stabilizing the trade
balance and the ratio nxt /nx¯ t is constant, less than one, and lower than under flexible
                                     ´∞
prices. As shown in the appendix, 0 ŷt e−ρt dt = 0, so that ŷt necessarily takes both signs.


Closed economy limit (α → 0).         We can also look at the closed economy limit α → 0 for
any degree of price rigidity.

Proposition 12 (Risk Premium Shock, Closed Economy Limit α → 0). In the closed economy
limit α → 0, optimal capital controls are τt = −ψt so that the nominal interest rate is it unaffected
by the shock. The allocation coincides with the natural allocation: ŷt = π H,t = 0.

   This result implies that optimal policy is history independent: in response to risk pre-
mium shocks it reacts directly to current shocks only. Again, optimal policy leans against
the wind, but, in this case, the tax perfectly offsets the effect of the risk premium shock on

                                                 34
the domestic nominal interest rate. This policy perfectly stabilizes output and inflation,
attaining the first best. Hence in the closed economy limit, capital controls are the perfect
tool to stabilize risk premium shocks.

Flexible exchange rate. The allocation with flexible prices can be attained with sticky
prices if the exchange rate is allowed to vary. It is interesting to translate our results
under this reinterpretation. Without capital controls, we denote by ēt the path for the
natural nominal exchange rate that implements the natural allocation with zero home
inflation π H,t = 0. Consider the case of a mean-reverting negative risk premium shock.
Then the exchange rate appreciates on impact and then depreciates over time. Moreover
one can show that with flexible exchange rates but in the absence of capital controls, this
allocation is optimal.
      However, a better outcome can be achieved by also using capital controls as in Propo-
sition 10. The path for the nominal exchange rate et that implements this allocation with
zero home inflation π H,t = 0 is smoother with et /ēt constant and less than one (it actually
equals nxt /nx  ¯ t since the relevant elasticity is unitary).
      This however, is still not the optimal joint use of capital controls and exchange rate
policy when prices are sticky, which is the solution of a planning problem similar to the
one in (20) with the following differences: first, there is an additional control variable
ėt ; second, it∗ must be replaced throughout by it∗ + ėt ; third, the initial condition must
be dropped (technically it must be replaced by ŷ0 = (1 − α)θ̂0 − s̄0 + e0 where e0 is an
independent control variable).

Proposition 13 (Risk Premium Shock, Flexible Exchange Rate). Suppose that the exchange
rate is flexible. The optimal solution features nonzero inflation π H,t 6= 0 and capital controls are
given by
                                                    λα
                                     τt = −αψ ψt −      απ π H,t ,
                                                     αθ
and the solution can be expressed in closed form (see the appendix).

    The solution is particularly simple when prices are rigid. Then capital controls are
given by τt = −αψ ψt , and so lean more against the wind than at the allocation character-
ized in Proposition 10. This illustrates an interesting interaction of rigid prices and capital
controls even with a flexible exchange rate. One can also show that capital controls lean
less against the wind when the exchange rate is flexible than when the exchange rate is
fixed.
    Note also that in the closed economy limit, the allocation with optimal capital con-
trols and optimal exchange rate, the allocation with optimal capital controls and fixed

                                                 35
exchange rate, and the allocation with no capital controls but optimal exchange rate, all
coincide with the flexible price allocation of the closed economy limit. Hence in the closed
economy limit, capital controls and exchange rates are both perfect but equivalent tools to
deal with risk premium shocks, and one of them can be dispensed with. However, away
from the closed economy limit, both have a distinct role.


4.4   Numerical Exploration
In this section we numerically explore how capital controls are optimally used to respond
to pure terms of trade shocks, pure natural interest rate shocks, mean-reverting produc-
tivity shocks and risk-premium shocks. We follow Galí and Monacelli (2005) by setting
φ = 3, ρ = 0.04, δ = 1 − 0.754 , e = 6. We report results for two degrees of openness:
α = 0.4 and α = 0.1.
      For our simulations, we will abstract from shocks to initial wealth and export de-
mand (NFA0 = λh,t = 0) and we will assume that r̄t − it∗ = r shock e−ρr t . Hence our
restriction implies that this must necessarily be accompanied by a matching path for
−s̄˙ t + πt∗ . This parametrization is flexible enough to accommodate, for example, pure
terms of trade shocks (permanent shocks to s̄t with no shock to r̄t ), pure natural interest
rate shock (shocks to r̄t and s̄˙ t with no shocks to s̄0 ), and any combination of the two such
as mean-reverting productivity shocks. We will also look at risk premium shocks where
we assume that ψt = ψshock e−ρψ t .


A permanent shock to the terms of trade. Our first experiment is such that s̄t = −0.05
for all t and r̄t = 0 for all t. This represents an improvement in the terms of trade that
causes an appreciation in the real exchange rate. This can be traced back to a permanent
shock to productivity A H,t .
    Figures 1 and 2 show the results for two values of openness, α = 0.4 and α = 0.1,
respectively. The green line is the outcome without interventions (zero capital controls).
The blue line is the outcome with optimal capital controls.
    To gain intuition, consider first the outcome without intervention. On the one hand, if
prices were fully flexible there would be an immediate and permanent upward jump in
the price of home goods PH . On the other hand, with totally rigid prices the equilibrium
features a permanent rise in output and consumption. In the intermediate case, with
Calvo pricing, the equilibrium features a smoother transition towards a higher price for
home goods. As shown in the figure, home inflation and output gaps are positive and
asymptote to zero. Due to the Cole-Obstfeld parameterization, the transition does not


                                              36
affect trade balance. Output and consumption are higher, pushing for higher imports
(foreign revenue is constant), but Home goods are also cheaper, encouraging the relative
consumption of home goods over imports. These two effects cancel each other out.
    Turning to the optimum, Proposition 7 indicates that with flexible prices no interven-
tion is required. With fully rigid prices, Proposition 8 implies that the optimum does
nothing and accepts the permanent change in output. Interestingly, in the intermediate
case, with Calvo pricing, the optimal intervention is not zero, so it is not intermediate be-
tween these two extremes of fully flexible or rigid prices. The reason for this is that, unlike
the case with fully rigid prices, the effects of the shock with Calvo prices without inter-
vention are not permanent. Capital controls can shift spending across time. Intuitively,
this is not desirable if the response without intervention produces constant outcomes.
But capital controls are more useful if the response without intervention is not constant.
In the short run, the optimal policy intervention lowers home consumption and output
relative to the no-intervention equilibrium. The drop in consumption lowers imports,
which creates a trade surplus. The rest of the dynamics are simply convergence. Note
the tradeoff: the optimal policy lowers output and consumption, which makes inflation
lower, slowing the needed adjustment in home prices. Thus, eventually the output gap
with and without intervention cross. (In fact, they cross again due to the income effect
from the accumulated trade surpluses.) Note that when α is lower, the nominal interest
rate it is higher, so that capital controls are used more.


A temporary shock to the natural interest rate. Next we look at a shock to r̄t which
becomes negative (with r̄0 = −0.05) and then mean-reverts to zero with s̄0 = 0. The
coefficient of mean reversion is set to a relatively high value of 1, so that the half-life of
the shock is 0.7 years. This shock can be traced back to a temporary productivity shock
where at t = 0, it becomes known that productivity will be decreasing in the future.
    Figures 3 and 4 show the results for two values of openness, α = 0.4 and α = 0.1,
respectively. The green line is the outcome without interventions (zero capital controls).
The blue line is the outcome with optimal capital controls.
    Consider first the outcome without intervention. If prices were flexible, then π H,t =
 ∗
it − r̄t so there would be a rise in home inflation reducing the real interest rate. Since the
shock is mean reverting, inflation also reverts back to zero. With sticky prices, this infla-
tionary process is smoothed: inflation is at first lower, then higher than the flexible price
outcome. Inflation also converges to zero in the long run. Indeed, the long-run increase
in the price of home goods, PH , is the same in both cases. As a result, the home price
PH,t with sticky prices is perpetually behind where it would be with flexible prices. In


                                              37
other words, the real exchange rate appreciates over time, but it does so faster with flex-
ible prices. This helps explain the observed positive output gap. To further understand
the behavior of the output gap, it is useful to keep in mind the long-run Euler equation
            ´∞
ŷt = ŷ∞ − t (is∗ − r̄s − π H,s )ds together with the fact that the long-run output gap ŷ∞ is
                                         ´∞
zero. Because the long-run increase 0 π H,s ds in PH is the same as under flexible prices,
the output gap is initially zero. Because inflation is initially lower and eventually higher
than under flexible prices, the output gap is positive throughout. However, it converges
to zero, since both it∗ − r̄t converges to zero, by assumption and we have argued that
π H,t converges to zero in the long run. This explains the hump-shaped response for out-
put. Once again, due to the Cole-Obstfeld parameterization, the transition does not affect
trade balance.
    We now turn to the optimal intervention. With fully rigid prices, we have shown
                                          1
that capital controls set it = it∗ +                     ∗
                                            αθ (r̄ t − i t ), displayed as a red line in the figures.
                                      1− α + 1− α
This implies a subsidy on inflows, coupled with a tax on outflows, to reduce the nominal
interest rate. The output gap would still be zero initially and positive throughout, but it is
now smoother than without intervention. The country would initially run a trade surplus.
With Calvo pricing, the solution has similar features. Additionally, there is inflation. The
paths for the output gap and inflation are smoother with the optimal intervention than
with no intervention. When α is lower, the nominal interest rate is much closer to it∗ +
    1              ∗
      αθ (r̄ t − i t ) which is turn closer to r̄ t , so that capital controls are used more. The
1− α + 1− α
paths for the output gap and inflation become much smoother.


A temporary shock to productivity. Finally we look at a mean-reverting negative pro-
ductivity shock. The half-life of the shock is set to 3.5 years and the magnitude is such
that s̄0 = −0.05.
    Figures 5 and 6 show the results two values of openness, α = 0.4 and α = 0.1, respec-
tively. The green line is the outcome without interventions (zero capital controls). The
blue line is the outcome with optimal capital controls. This shocks is a combination of the
first two shocks (with a positive sign on the first one and a negative sign on the second
one). The figures can be understood accordingly.


A temporary risk premium shock.     For our experiment, we look at a shock to ψt
which becomes negative (with ψ̄0 = −0.05) and then mean-reverts to zero, such that




                                                    38
ψt = ψshock e−ρψ t . The half-life of the shock is 3.5 years. In that case, we have

                                              1 + φ(1 − α) ψshock
                                      s̄0 =                       .
                                                 1+φ       ρ + ρψ

Figures 7 and 8 show the results for two values of openness, α = 0.4 and α = 0.1, respec-
tively. The green line is the outcome without interventions (zero capital controls) in gaps.
The blue line is the outcome with optimal capital controls in gaps.The red line represents
optimal capital controls with perfectly rigid prices. The black lines corresponds to the
natural allocation in levels.
    We have shown in Proposition 12 that in the closed economy limit, capital controls
are a perfect stabilization tool to deal with risk premium shocks. These figures confirm
that that even away from this limit, capital controls perform extremely well. Notably, the
optimum with rigid price provides a good benchmark, optimal capital controls are close
to the red line, especially for α = 0.1. It is also apparent that compared with the allocation
with no intervention, the allocation with optimal capital controls increases net exports in
the short run and decreases net exports in the long run. The natural allocation features
trade deficits in the short run, and trade surpluses in the long run. Hence optimal capital
controls help stabilize the trade balance. As is apparent in the figures, optimal capital
controls also smooth out the real exchange rate appreciation brought about by the risk
premium shock.


4.5    Sticky Wages and Flexible Exchange Rates
As Friedman (1953) forcefully argued, flexible exchange rates can act as a substitute for
flexible prices. When prices are sticky, but wages are not, a flexible exchange rate can be
used to achieve the flexible price allocation. In this way, flexible exchange rates yield per-
fect macroeconomic stabilization. But this is no longer possible, in general, when wages
are also sticky. Perfect macroeconomic stabilization is not possible, even with a flexible
exchange rate. This raises the question we address here: are capital controls optimal when
prices and wages are sticky but a flexible exchange rate is managed optimally?
                                                                           ´            ew −1
                                                                                                   e ew−1
                                                                               1                     w
    Assume that labor is an aggregate of different varieties Nt =             0 Nt ( j )
                                                                                          e w  dj          .
                                                          ´                     1
                                                              1         1−ew dj 1−ew , and we let
We denote the corresponding wage index by Wt =               0 Wt ( j )
Mw ≡ ewe−  w
             1 . Wages are set a la Calvo by households, with arrival rate ρδw for wage
change opportunities.
    In the Appendix we present the planning problem with sticky prices and sticky wages.


                                                    39
We allow there for any path of the exchange rate et expressed relative to its prior, steady
state, value. It can be observed from this planning problem that, in general, there is a
role for capital controls when prices and wages are sticky, even when the exchange rate is
flexible. However, the role of capital controls is quite different than with a fixed exchange
rate. With a flexible exchange rate, each country already has the flexibility to set its own
monetary policy. However, this is not enough to perfectly stabilize the economy and
hence capital controls emerge as a second best instrument.
    This role for capital controls entirely disappears when prices and wages are rigid,
so that optimal capital controls are zero. Similarly, in the closed economy limit, capital
controls are useless in the sense that the gains from using capital controls vanish.

Proposition 14 (Sticky Prices, Wages, Flexible Exchange Rate). With sticky prices, sticky
wages and a flexible exchange rate, optimal capital controls are generally nonzero. However, with
completely rigid prices and wages, optimal capital controls are zero. Similarly, in the closed econ-
omy limit α → 0, there are no gains from using capital controls.


4.6   Government Spending
For comparison, we now introduce government expenditures, building more directly on
Galí and Monacelli (2008). Government expenditures Gt enter households’ utility
                                           "                              1+ φ
                                                                               #
                              ∞
                                                        Ct1−σ    Gt1−σ   Nt
                              ∑ βt             (1 − χ )
                                                        1−σ
                                                              +χ       −
                                                                 1−σ 1+φ
                                                                                 ,
                              t =0

              ´                       
                    1     e −1
where Gt =        Gt ( j) dj , where j ∈ [0, 1] denotes the variety of home good. Note
                   0
                            e

that, following Galí and Monacelli, we assume that Gt is spent entirely on home goods.
    To keep the exposition brief, we focus on the Cole-Obstfeld case and abstract from cap-
ital controls. We move directly to a continuous time formulation of the planning problem,
set up as an optimal control:
                              ˆ    ∞
                                        1        1                            1
                        min            [ π 2H,t + λ x (ĉt + (1 − ξ ) ĝt )2 + λ g ĝt 2 ]dt
                               0        2        2                            2

subject to
                                        π̇ H,t = ρπ H,t − κ̂ [ĉt + (1 − ξ ) ĝt ],

                                        ĉ˙t = (1 − G)[−π H,t − (r̄t − i∗ )],

                                                    ĉ0 = −s̄0 (1 − G).


                                                            40
In this program, we have used the following notation. Parameter G = G                   Y is the steady
state share of government spending. Let ξ = (1 + (1 − G) φ)−1 . The rest of the parameter
                  1
are: κ̂ = λ(φ + 1−G  ), and the coefficients in the loss function are given by λ x = κ̂e and
         1+ φ
λ g = λe Γ ξ. The variable ĝt denotes the fiscal gap Gt −            Ḡt
                                                                     Y , ŷt = log(Yt ) − log(Ȳt ) is the
output gap and ĉt = ŷt − G ĝt is the gap in private consumption (domestic and foreign) of
the home good, where bar variables denote the optimal allocation with flexible prices.
    Following Werning (2012), we decompose government expenditures into two compo-
nents.
                                      ĝt = ĝopp (ĉt ) + ĝtstim ,
                                 λ x (1 − ξ )                                   1−ξ
         ĝopp (ĉt ) = −                       ĉt   and    ĝtstim =                       κ̂µπ,t .
                            λ x (1 − ξ )2 + λ g                          λ x (1 − ξ )2 + λ g
The first component ĝopp (ĉt ) is opportunistic spending. It is the level of expenditure that
would be chosen by a government, taking the path for private consumption cˆt as given.
Its determinants are purely microeconomic. It captures the idea that it makes sense to in-
crease government spending when the opportunity cost of labor is low. The second com-
ponent, stimulus spending, ĝtstim , is defined as the residual. Note that stimulus spending
is zero whenever the co-state µπ,t is zero.
    We can then state the following result.

Proposition 15 (Stimulus Spending). Government spending and its components are indepen-
dent of α. Stimulus spending is initially zero: ĝ0stim = 0. In the special case with rigid prices
              1
κ̂ = 0 or κ̂ 1−G = λ x then ĝt stim = 0 for all t ≥ 0.

    With rigid prices, the solution is simple: government spending is purely opportunistic,
and stimulus spending is equal to zero. This suggests that although government spend-
ing may play a role in the optimum, it may mostly due to the opportunistic component.
    An important observation is that the planning problem for fiscal policy, expressed
in gaps, is independent of the openness parameter α, and hence so is its solution. The
openness of the economy only introduces a proportional scaling factor in the associated
loss function. This is an important distinction with capital controls, which became more
effective as the economy became more closed.


5    Policy Coordination
Up to this point we have isolated the problem of a small open economy with a fixed
exchange rate and characterized the optimal use of capital controls taking as given con-
ditions in the rest of the world, including policy choices by other countries, the ensuing

                                                      41
equilibrium interest rates and prices. We have therefore been silent on possible spillover
effects from one country to the other. Do capital controls have beggar-thy-neighbor ef-
fects? Are there reasons to worry about “capital control wars”? Are there gains from
coordinating capital controls?12
    To address these questions, we now consider a coordinated solution within a mone-
tary union using capital controls to maximize the sum of utilities. We will contrast this
solution to the uncoordinated, noncooperative equilibrium, where each country acts in
isolation. We focus on Calvo pricing, in the Cole-Obstfeld case, and focus on shocks to
productivity shocks { ai,t }t≥0 . We set export demand shocks {λi,t }t≥0 and initial wealth
shocks NFAi,0 to zero for simplicity. We should note that the Cole-Obstfeld case is known
to be special regarding the role of coordination with flexible exchange rates—see for ex-
ample Clarida et al. (2002). We focus on that case because with capital controls, one cannot
easily find a second order approximation of the loss function away from it.
    An important consideration is the level of the labor tax and whether we hold it con-
stant in our comparison. At a symmetric steady state with no coordination on this tax,
the rate satisfies M(1 + τL ) = 1−1 α because countries attempt to manipulate their terms of
trade. In contrast, if the labor tax is coordinated then it is set at a lower rate, satisfying
M (1 + τL ) = 1, because the union as a whole refrains from terms of trade manipulation.
    An obvious point is to note that coordination on the labor tax alone may be welfare
improving, even in a steady state without shocks. We have nothing new to say on this.
Instead, we find it more interesting to study coordination on capital controls alone, taking
as given the labor tax level. This comparison may also be more relevant if countries
find it difficult to meddle with other countries’ tax systems—which is likely since these
are largely shaped by other, politically sensitive and country specific, concerns, such as
inequality and redistribution. It also isolates the stabilization motives for coordination,
addressing the question of how best to respond to shocks, rather than the steady-state
terms-of-trade manipulation issue involved in the tax level.


5.1    Uncoordinated Labor Tax
We start with the case where there is no coordination on the labor tax at the symmetric
steady state so that M (1 + τL ) = 1−1 α .
   We define a new reference allocation which corresponds to the flexible price allocation
with no capital controls. This allocation differs from the natural allocation in Section 4,
  12 Korinek(2012) studies policy coordination in the context of models where capital controls are used to
address pecuniary externalities in borrowing constraints.



                                                   42
which we denoted with a single bar, which corresponded to the flexible price allocation in
the home country, taking the rest of the world as given. Here instead, we impose flexible
prices in every country. We denote by s̄¯it the terms of trade of the corresponding allocation,
                             ´1
where by construction 0 s̄¯it di = 0. Because we assume only productivity shocks, we have
              ´1
s̄¯it = ai,t − 0 ai,t di.13
       We denote by ŷˆit and θ̂ˆti the deviations of yit and θti from their flexible price counterparts.
                                                                          ´1                     ´1
We denote by ỹit = ŷˆit − ŷˆ ∗t and θ̃ti = θ̂ˆti − θ̂ˆt∗ where ŷˆ ∗t = 0 ŷˆit di and θ̂ˆt∗ = 0 θ̂ˆti di = 0 the
deviations these variables from the corresponding aggregates. Note that θ̂ˆti is already a
normalized variable so that θ̂ˆti = θ̃ti .


Coordination. For small α, a simple representation of the coordinated loss function with
an uncoordinated labor tax is available—it is valid only for small α, otherwise, a second
order approximation of the constraints is required:
       ˆ   ∞ˆ 1       h                                                                                                  i
   1                                                                                             2α
                  e−ρt απ (π̃ iH,t + πt∗ )2 + (ỹit + ŷˆ ∗t )2 + αθ (θ̃ti )2 −                           (ŷˆ∗t + ỹit ) di dt.
   2   0     0                                                                             (1 − α)(1 + φ)

Intuitively, the extra linear term (1−α2α
                                       )(1+φ) t
                                               (ŷˆ∗ + ỹit ) can be traced back to the fact that the
that the coordinated solution abstains from terms of trade manipulation. As a result the
objective acquires a preference for higher output, leading to a classical inflationary bias.
                          ´1        ´1
   Using the fact that 0 ỹit di = 0 π̃ iH,t di = 0, we are led to the following coordinated
planning problem:

            ˆ    ∞ˆ 1             h
      1
  min                   e   −ρt
                                      απ (π̃ iH,t )2 + (ỹit )2 + αθ (θ̃ti )2
      2      0      0
                                                                                                      2α             i
                                                                   + απ (πt∗ )2 + (ŷˆ∗t )2 −                  ŷˆ ∗t di dt (21)
                                                                                                (1 − α)(1 + φ)

subject to

                                                  π̃˙ iH,t = ρπ̃ iH,t − κ̂ ỹit − λαθ̃ti ,                                   (22)
                                                       ỹ˙ i = (1 − α)θ̃˙ i − π̃ i − s̄¯˙ i ,
                                                       t                       t     H,t   t                                 (23)
                                                             ˆ     ∞
                                                                       e−ρt θ̃ti dt = 0,                                     (24)
                                                               0

                                                           ỹ0i = (1 − α)θ̃0i − s̄¯0i ,                                      (25)
  13 Although     we do not need it for our analysis, not that the natural interest rate is given by and r̄¯ti = ȧi,t .



                                                                          43
                                                                 ˆ       1
                                                                             ỹit di = 0,                                   (26)
                                                                     0
                                                         ˆ       1
                                                                     π̃ iH,t di = 0,                                        (27)
                                                             0

                                                        π̇t∗ = ρπt∗ − κ̂ ŷˆ ∗t ,                                           (28)
                                                                                                   ´1
where the minimization is over the variables π̃ iH,t , πt∗ , ỹit , ŷˆ ∗t , θ̃ti . Note that since 0 s̄¯it di = 0,
                                ´1
the constraints imply that 0 θ̃ti di = 0. This pins down controls through the equation
θ̃˙ ti = τti .
       It follows that we can break down the planning problem into two parts. First, there is
an aggregate planning problem determining the average output gap and inflation ŷˆ ∗t and
πt∗                         ˆ                                                              
                          1 ∞ −ρt                                         2α
                     min        e     απ (πt ) + (ŷˆ t ) −
                                           ∗ 2        ∗  2
                                                                                       ŷˆ dt
                                                                                          ∗
                                                                                                               (29)
                          2 0                               (1 − α)(1 + φ) t
subject to (28).
   Second, there is a disaggregated planning problem determining deviations from the
aggregates for output gap, home inflation and consumption smoothing, ỹit , π̃ iH,t and θ̃ti
                                ˆ    ∞ˆ 1                h                                                       i
                            1
                        min                   e   −ρt
                                                             απ (π̃ iH,t )2         + (ỹit )2   + αθ (θ̃ti )2       didt   (30)
                            2    0        0

subject to (22), (23), (24), (25), (26), and (27). Consider dropping the last two constraints.
The resulting relaxed planning problem can be broken down into separate component
planning problems for each country i ∈ [0, 1]
                                     ˆ    ∞             h                                                       i
                               1
                           min                e   −ρt
                                                            απ (π̃ iH,t )2         + (ỹit )2   + αθ (θ̃ti )2       dt      (31)
                               2      0

subject to (22), (23), (24), (25).


No coordination. With no coordination, each country i ∈ [0, 1] takes the evolution of
aggregates as given and solves the following uncoordinated component planning prob-
lem:             ˆ
               1 ∞ −ρt h                                                                          i
          min        e    απ (π̃ iH,t )2 + 2απ πt∗ π̃ iH,t + (ỹit )2 + 2ŷˆ ∗t ỹit + αθ (θ̃ti )2 dt (32)
               2 0
subject to (22), (23), (24), (25), where the minimization is over the variables π̃ iH,t , ỹit , θ̃ti ,
taking ŷˆ ∗t , and πt∗ as given. As usual, capital controls in country i can be computed by
τti = θ̃˙ ti . Note that the path for aggregates {ŷˆ ∗t ,πt∗ }t≥0 affects the solution to this problem


                                                                             44
solely through linear terms in the objective function.
    A central monetary authority, by setting monetary policy, can choose aggregates {ŷˆ ∗t ,πt∗ }
subject to the following constraints. First, it must ensure that the solutions to the unco-
                                                     ´1                ´1
ordinated component planning problems satisfy 0 ỹit di = 0 and 0 π̃ iH,t di = 0. This
amounts to verifying a fixed point, that aggregates are actually equal to their proposed
path. Second, it must ensure that the aggregate Phillips curve is verified, π̇t∗ = ρπt∗ − κ̂ ŷˆ ∗t .
Both requirements define a set F of feasible aggregate outcomes {ŷˆ ∗t ,πt∗ }t≥0 . The set is a
linear space, which we characterize in closed form below. Which aggregate outcome in
the feasibility occurs depends on the objective of the central monetary authority. For ex-
ample, we can examine the Ramsey problem where the central monetary authority seeks
to maximize aggregate welfare, taking into account that capital controls are set uncoop-
eratively. For small α, this can be represented as the same planning problem as (29) but
where the constraint set is the feasible set F instead of (28).

Proposition 16 (Coordination vs. No Coordination with Uncoordinated Labor Tax). Sup-
pose that countries do not coordinate on the labor tax. At the coordinated solution, the aggregates
solve the aggregate planning problem (29): ŷˆ ∗t = (1−α)(α 1+φ) eνt and πt∗ = (1−α)(α 1+φ) ρ−κ̂ ν eνt for
                           √
                        ρ− ρ2 +4κ̂απ
all t ≥ 0, where ν =          2      . At the uncoordinated solution, the aggregates {ŷˆ ∗t ,πt∗ }t≥0 are
in the feasible set F if and only if

                                       κ̂       λα + (κ̂ (1 − α) + λα) κ̂απ ∗
                            ŷˆ˙ ∗t = − ŷˆ0∗ −                            πt ,
                                       ρ                  κ̂ (1 − α)
                           π̇t∗ = ρπt∗ − κ̂ ŷˆ ∗t .

In particular, ŷˆ ∗t = πt∗ = 0 for all t ≥ 0 is feasible but ŷˆ ∗t =             α
                                                                               (1−α)(1+φ)
                                                                                          eνt   and πt∗ =
    α       κ̂ νt
(1−α)(1+φ) ρ−ν
               e    for all t ≥ 0 is not. Both at the coordinated and at the uncoordinated solu-
tions, the disaggregated variables π̃ iH,t , ỹit , θ̃ti solve the component planning problems (31).

       The propositions shows that the feasible set F is of dimension one, parameterized by
ŷˆ0∗ .For each ŷˆ0∗ there is a unique π0∗ such that the solution of the 2x2 differential system is
bounded. Indeed, the solution converges to a steady state that varies with ŷˆ0∗ and satisfies
ρπ∞   ∗ = κ̂ ŷˆ ∗ . In particular, unless ŷˆ ∗ = 0 then we have ŷˆ ∗ 6 = 0 and π ∗ 6 = 0. More
                 ∞                             0                      ∞              ∞
                                      ˆ ∗                  ˆ ∗      ∗
precisely, one can show that if ŷ0 is positive then ŷ∞ and π∞ are negative, and vice versa
if ŷˆ0∗ is negative.
       Therefore, it is impossible to stimulate output throughout at a feasible solution. This
observation is useful to apprehend the Ramsey problem where the central monetary au-
thority seeks to maximize aggregate welfare, taking into account that capital controls


                                                    45
are set uncooperatively, since the objective function incorporate a linear term in output.
Indeed, one can show that in the particular case where the following condition holds
               1− α
                           , the solution of the Ramsey problem is ŷˆ ∗t = πt∗ = 0 for all
 ρ
ρ−ν = 1+απ κ̂α          +(1−α)(απ κ̂ −1)
                 1+ φ
t≥    0.14
   Note also that the coordinated solution converges to ŷˆ ∗∞ = π∞     ∗ = 0 in the long run.

Since ŷˆ ∗t = πt∗ = 0 is feasible, this shows that in a sense, the benefits of coordination are
temporary since they are concentrated in the short run.


5.2     Coordinated Labor Tax
We now consider the case where there is coordination on the labor tax at the symmetric
steady state so that M(1 + τL ) = 1. With a slight abuse of notation, we keep denoting
with a double bar the corresponding flexible price allocation with no capital controls. We
denote with a double hat the gap of a variable from its flexible price counterpart. We
denote with a tilde a variable minus its mean across countries. For example ỹi = ŷˆi − ŷˆ ∗tt     t
represents the deviation of country i’s output gap from the corresponding aggregate.
    We only summarize the results since the analysis is quite similar to the uncoordinated
labor tax case (the details can be found in the appendix). Starting with the coordinated
solution, we can still decompose the coordinated planning problem into an aggregate
planning problem that determines the aggregates the aggregates{ŷˆ ∗t ,πt∗ }t≥0 and a disag-
gregated planning problem that determines the disaggregated variables π̃ iH,t , ỹit , θ̃ti . The
disaggregated planning problem can then be relaxed and decomposed into independent
component planning problems. The uncoordinated solution can be described by two
requirements: that the aggregates{ŷˆ ∗t ,πt∗ }t≥0 be in a feasibility set F 0 for and that the
disaggregated variables π̃ iH,t , ỹit , θ̃ti solve the component planning problem.
    There are differences with the uncoordinated labor tax case in the objective functions
for these programs. First, the coefficient on 21 (θ̃ti )2 in the coordinated planning problem,
the disaggregated planning problem and the component planning problem, is (1 − α)αθ
instead of αθ . Second now there is no linear term in − (1−α2α            ŷˆ ∗ in the aggregate plan-
                                                                    )(1+φ) t
ning problem, but there is a linear term 12α   i
                                          +φ ỹt in the problem solved by an individual
country under the uncoordinated solution.

Proposition 17 (Coordination vs. No Coordination with Coordinated Labor Tax). Suppose
that countries coordinate on the labor tax. At the coordinated solution, the aggregates solve the
  14 When the condition is not verified, the solution of the Ramsey problem is different: it might be optimal

to have ŷˆ0∗ positive or negative. See the appendix for the full solution.



                                                     46
aggregate planning problem: ŷˆ ∗t = 0 and πt∗ = 0 for all t ≥ 0. At the uncoordinated solution,
the aggregates {ŷˆ ∗t ,πt∗ }t≥0 are in the feasible set F 0 if and only if

                       1 α          λα  1               1
           ŷˆ˙ ∗t = −                 − κ̂ ŷˆ0∗ −            (λα + (κ̂ (1 − α) + λα) απ κ̂ ) πt∗ ,
                       ρ1+φ1−α ρ                    (1 − α) κ̂
          π̇t∗ = ρπt∗ − κ̂ ŷˆ ∗t .

                                 ( 1+α φ )2 1−1 α
In particular, ŷˆ ∗t = −      λα+(κ̂ (1−α)+λα)απ κ̂   and πt∗ = κ̂ρ ŷˆ ∗t for all t ≥ 0 is feasible but ŷˆ ∗t = πt∗ = 0
                            1+         (1−α)κ̂
for all t ≥ 0 is not. Both at the coordinated and at the uncoordinated solutions, the disaggregated
variables π̃ iH,t , ỹit , θ̃ti solve the component planning problems .


5.3    The Role of Coordination
Propositions 16 and 17 help understand the role of coordination. For a given labor tax,
the aggregates ŷˆ ∗t and πt∗ associated with the coordinated solution and the uncoordinated
solutions differ. Indeed, for a given labor tax, the aggregates corresponding to the co-
ordinated solution are not feasible. By contrast, for a given labor tax, the disaggregated
variables π̃ iH,t , ỹit , θ̃ti (and hence capital controls) coincide at the coordinated and unco-
ordinated solutions. They depend only on the labor tax, and not on whether countries
coordinate or not for a given labor tax. In other words, the lack of coordination impacts
the solution by restricting the set of feasible aggregate outcomes, but does not impact
the disaggregated variables and the associated capital controls for any feasible aggregate
outcome.
        Observe that the feasible sets F and F 0 are completely independent of the shocks
s̄¯it . A interesting consequence of this observation is that the gains from coordination are
completely independent of the amount of heterogeneity across countries s̄¯it .


References
Bianchi, Javier, “Overborrowing and Systemic Externalities in the Business Cycle,” Amer-
  ican Economic Review, December 2011, 101 (7), 3400–3426.

   and Enrique G. Mendoza, “Overborrowing, Financial Crises and ’Macro-prudential’
  Taxes,” NBER Working Papers 16091, National Bureau of Economic Research, Inc June
  2010.




                                                              47
Black, Stanley, “International Money Markets and Flexible Exchange Rates,” Studies in
  International Finance, 1973, (25).

Caballero, Ricardo J. and Arvind Krishnamurthy, “International and domestic collat-
  eral constraints in a model of emerging market crises,” Journal of Monetary Economics,
  December 2001, 48 (3), 513–548.

  and , “Smoothing sudden stops,” Journal of Economic Theory, November 2004, 119 (1),
  104–127.

Calvo, Guillermo A., “Capital Flows and Capital-Market Crises: The Simple Economics
  of Sudden Stops,” Journal of Applied Economics, November 1998, 0, 35–54.

Clarida, Richard, Jordi Gali, and Mark Gertler, “A Simple Framework for International
  Monetary Policy Analysis,” Journal of Monetary Economics, July 2002, 49 (5), 879–904.

Cole, Harold L. and Maurice Obstfeld, “Commodity Trade and International Risk Shar-
 ing : How Much Do Financial Markets Matter?,” Journal of Monetary Economics, 1991, 28
 (1), 3–24.

Corsetti, Giancarlo, Luca Dedola, and Sylvain Leduc, “Optimal Monetary Policy in
 Open Economies,” in Benjamin M. Friedman and Michael Woodford, eds., Handbook
 of Monetary Economics, Vol. 3 of Handbook of Monetary Economics, Elsevier, October 2010,
 chapter 16, pp. 861–933.

Costinot, Arnaud, Guido Lorenzoni, and Ivan Werning, “A Theory of Capital Controls
 as Dynamic Terms-of-Trade Manipulation,” NBER Working Papers 17680, National Bu-
 reau of Economic Research, Inc December 2011.

Devereux, Michael B. and Charles Engel, “Monetary Policy in the Open Economy Revis-
 ited: Price Setting and Exchange-Rate Flexibility,” Review of Economic Studies, October
 2003, 70 (4), 765–783.

Fleming, Marcus, “Domestic Financial Policies under Fixed and under Floating Exchange
  Rates,” IMF staff papers, 1962, 9 (3), 369–380.

Friedman, Milton, “The Case for Flexible Exchange Rates,” in “Essays in Positive Eco-
  nomics,” University of Chicago Press, 1953, pp. 157–203.

Galí, Jordi and Tommaso Monacelli, “Monetary Policy and Exchange Rate Volatility in
 a Small Open Economy,” Review of Economic Studies, 07 2005, 72 (3), 707–734.


                                           48
   and , “Optimal monetary and fiscal policy in a currency union,” Journal of Interna-
  tional Economics, September 2008, 76 (1), 116–132.

Jeanne, Olivier, “Capital Account Policies and the Real Exchange Rate,” February 2011.
  Mimeo, Johns Hopkins University.

  and Anton Korinek, “Excessive Volatility in Capital Flows: A Pigouvian Taxation Ap-
  proach,” American Economic Review, May 2010, 100 (2), 403–407.

Keynes, J.M., “The German transfer problem,” The Economic Journal, 1929, 39 (153), 1–7.

Korinek, Anton, “The New Economics of Prudential Capital Controls: A Research
 Agenda,” IMF Economic Review, August 2011, 59 (3), 523–561.

  , “Capital Controls and Currency Wars,” 2012. Mimeo, University of Maryland.

Kouri, Pentti, “The Exchange Rate and the Balance of Payment in the Short Run and in
 the Long Run: A Monetary Approach,” The Scandinavian Journal of Economics, 1976, 78
 (2), 280–304.

Martin, Alberto and Filippo Taddei, “International Capital Flows and Credit Market
 Imperfections: a Tale of Two Frictions,” 2010. Collegio Carlo Alberto.

Mendoza, Enrique G., “Sudden Stops, Financial Crises, and Leverage,” American Eco-
 nomic Review, December 2010, 100 (5), 1941–66.

Mundell, Robert, “Capital Mobility and Stabilization Policy under Fixed and Flexible
 Exchange Rates,” Canadian Journal of Economic and Political Science, 1963, 29 (4), 475–485.

Neumeyer, Pablo A. and Fabrizio Perri, “Business cycles in emerging economies: the
 role of interest rates,” Journal of Monetary Economics, March 2005, 52 (2), 345–380.

Obstfeld, Maurice and Kenneth Rogoff, “Exchange Rate Dynamics Redux,” Journal of
 Political Economy, June 1995, 103 (3), 624–60.

Ohlin, B., “The reparation problem: a discussion,” Economic Journal, 1929, 39 (154), 172–
 182.

Ostry, Jonathan D., Atish R. Ghosh, Karl Habermeier, Marcos Chamon, Mahvash S.
 Qureshi, and Dennis B.S. Reinhardt, “Capital Inflows: The Role of Controls,” 2010.
 IMF Staff Position Note.



                                            49
Schmitt-Grohe, Stephanie and Martin Uribe, “Prudential Policies for Peggers,” NBER
  Working Papers 18031, National Bureau of Economic Research, Inc June 2012.

Werning, Ivan, “Managing a Liquidity Trap: Monetary and Fiscal Policy,” 2012. NBER
 Working Papers.




A     Appendix

A.1    Proof of Proposition 1
To solve for this optimal labor subsidy it is useful to consider the following relaxed prob-
lem, which allows taxes to vary over time. As it turns out, at a steady state, the optimal
tax is constant. Assume that the world is at a symmetric deterministic steady state. Each
country takes the rest of the world as given and uses a time-varying tax on capital inflow
and subsidy on capital outflow controls τt and labor tax τL,t to maximize the welfare of
its households.
    For example, the home country solves
                                                           "                  1+ φ
                                                                                     #
                                                    ∞
                                                               Ct1−σ  N
                                   max             ∑
                           {Ct ,Yt ,Nt ,Θt ,Qt ,St } t=0
                                                                     − t
                                                               1−σ 1+φ

subject to
                                                                   1
                                              Ct = Θt C ∗ Qtσ ,
                                                                                   
                                                           1
                                                           σ −η    η
                           Yt = C    ∗
                                             (1 − α)Qt            St Θ t   + αStγ       ,
                                      h                 i 1
                                                   η −1
                                 Q t = ( 1 − α ) S t + α η −1 ,

                                                           Yt
                                                 Nt =         ,
                                                           A

                                    ∞                              
                            0=     ∑      βt C ∗−σ St−1 Yt − Q−
                                                              t
                                                                1
                                                                  Ct .
                                   t =0




                                                     50
We can then back out the optimal labor tax using and the optimal capital controls using

                                                                            1 + τtL φ
                                                   St−1 Θ− σ ∗−σ
                                                         t C     =M                Nt ,
                                                                              A
                                                             Θ t +1             1
                                                                    = (1 + τt ) σ .
                                                              Θt

Using this program we can prove the following.
     Assuming the optimization problem is sufficiently convex, stationarity implies that
it is optimal to pick constant values for {Ct , Yt , Nt , Θt , Qt , St }. This immediately implies
that τt = 0 and that τL is constant.
     Dropping the t subscripts and substituting some of the constraints, we can rewrite the
planning problem as

       h                                i (1− σ ) η
                            η −1            η −1
           (1 − α ) ( S )          +α                 S(1−σ)(γ−1) C ∗1−σ         1 C ∗1+ φ h                          i 1+ φ
                                                                                                             η −1
max                                                                        −                 ( 1 − α ) ( S )      + α        S (1+ φ ) γ
  S                                 1−σ                                        1 + φ A 1+ φ

This yields a function S(C ∗ ). We then need to solve for S(C ∗ ) = 1. We can then back out
the corresponding τ L from the labor-leisure condition.
   We find
                                                               
                   (1 − α)ηSη −1     ( γ − 1)  h                         i (1− σ ) η
                                                  (1 − α ) ( S ) η −1 + α
                                                                              η −1
  0= h                         i+                                                    S(1−σ)(γ−1) C ∗1−σ
     S (1 − α ) ( S ) η −1
                           +α              S
                                                    
                           ( η − 1) S η − 1        γ C ∗1+ φ h                              i 1+ φ
            − h                               i +  1+ φ (1 − α ) ( S ) η −1 + α                  S (1+ φ ) γ
                  S (1 − α ) ( S )    η −1
                                            +α     S    A


We now impose S = 1 and solve for C ∗

                                                                                                 C ∗1+ φ
                             0 = [(1 − α)η + (γ − 1)] C ∗1−σ − [(η − 1) + γ]
                                                                                                 A 1+ φ

i.e.
                                                      C ∗φ+σ     (1 − α ) η + γ − 1
                                                         1
                                                               =
                                                      A    + φ       η+γ−1
We can now plug this back in the labor-leisure condition

                                                                            C ∗φ+σ
                                                         1 = M (1 + τ L )
                                                                            A 1+ φ



                                                                    51
to obtain the proposition.


A.2      Proof of Proposition 2
The first part of the proposition follows immediately from the planning problem, pro-
vided the program is sufficiently convex, as we assume. We therefore focus on the Cole-
Obstfeld case. The planning problem simplifies to

               ∞                                                                                           
                                                          1        1
       max     ∑β
      {Θt ,St } t=0
                      t
                              log Θt + (1 − α) log St −               L
                                                        1 + φ M (1 + τ )
                                                                         Θ− 1
                                                                          t [(1 − α ) Θt + αΛ H,t ]


subject to

                                      ∞
                      NFA0 = α ∑ βt (Λ H,t − Θt ) ,
                                     t =0
                                                    1     1+ φ ∗ φ +1
                               1 = M (1 + τ L )         S
                                                   1+ φ t
                                                              Ct      Θt   [(1 − α)Θt + αΛ H,t ]φ .
                                                  A H,t

Solving for St as a function of Θt from the second constraint and substituting we can
rewrite this problem as a function of the path for {Θt }. Then the first order condition is
then
           φ + α (1 − α )2 φ         Θt            (1 − α)αΛ H,t 1
                 −                               +                  − ΓΘt = 0.
           1+φ        1 + φ αΛ H,t + (1 − α)Θt         1+φ       Θt
For a given value of Γ, then Θt is independent of A H,t and increasing in Λ H,t . Since
Θ t +1         1
 Θt = (1 + τt ) the result follows.
               σ




A.3      Proof of Proposition 4
We start with transitory productivity shocks. The optimal allocation is constant for t ≥ 1.
                                                                             1− β
Let Θ be the corresponding value of Θ, which is related to Θ0 by (Θ − 1) = β (1 − Θ0 ).
This immediately implies that τt = 0 for t ≥ 1. Then we need to solve the t = 0 problem
maxΘ0 U (Θ0 , A0 ) where
                                                                                                            
                              ∗1− σ Θ 0 C ∗1+φ [(1 − α)Θ0 + α]1+φ
                                      1− σ
                                                                                          1 ∗1− σ
   U ( Θ0 , A0 ) = C                   − 1+ φ                     + βV                      C     α (1 − Θ0 ) .
                                   1−σ  A             1+φ                                 β
                                              0

It is easily verified that U A0 ,Θ0 > 0. This implies that Θ0 is an increasing function of
A0 . This in turn implies that Θ is a decreasing function of A0 . The first result in the
                                                                           1
proposition follows since capital controls τ0 are given by ΘΘ0 = (1 + τ0 ) σ .

                                                            52
    Now consider temporary export demand shocks. The optimal allocation is constant
allocation for t ≥ 1, so we drop the t subscripts. This immediately implies that τt =
0 for t ≥ 1. We are interested
                         1        in the limit of small time intervals ( β → 1). We have
1− β
                           σ − η Θ − S γ −1 Λ H . Using the other constraints, we can write
  β α ( Λ H,0 − Θ0 ) = α Q
the right hand side as a function J (Θ) with J (1) = 0. We find that to a first order in 1 − β
we can write
                                 1
                      Θ = 1+ 0       (1 − β)α (Λ H,0 − Θ0 ) + O(1 − β)2 .
                               J (1)
We can then write welfare for t ≥ 1 as a function H (Θ). We find that up to second order
terms in 1 − β, we have to solve maxΘ0 U (Θ0 , Λ0 ) where

                                    Θ10−σ C ∗1+φ [(1 − α)Θ0 + αΛ H,0 ]1+φ  H 0 (1)
  U (Θ0 , Λ H,0 ) = C ∗1−σ               − 1+ φ                           + 0      α (Λ H,0 − Θ0 ) .
                                    1−σ   A               1+φ               J (1)

It is easily verified that UΛ H,0 ,Θ0 < 0. This implies that Θ0 is a decreasing function of
Λ H,0 . Moreover, up to first order terms in 1 − β, Θ is constant. The second result in the
                                                                           1
proposition follows since capital controls τ0 are given by ΘΘ0 = (1 + τ0 ) σ .
    Finally consider foreign consumption shocks. The optimal allocation is constant for
t ≥ 1. Let Θ be the corresponding value of Θ, which is related to Θ0 by C ∗1−σ (Θ − 1) =
1− β ∗1− σ
  β C0     (1 − Θ0 ). This immediately implies that τt = 0 for t ≥ 1. We have to solve
maxΘ0 U (Θ0 , Λ0 ) where

                                               ∗1+ φ                                               
                                     1− σ
                             ∗1− σ Θ 0       C0    [(1 − α)Θ0 + α]1+φ            1 ∗1− σ
   U (Θ0 , C0∗ )     =      C0              − 1+ φ                    + βV        C      α (1 − Θ0 ) .
                                   1−σ       A            1+φ                    β 0

We find

                                                                    ∗φ
                                                                      C
  U C0∗ ,Θ0   (Θ0 , C0∗ )   =                   − (1 − α)(1 + φ) 10+φ [(1 − α)Θ0 + α]φ
                                (1 − σ)C0∗−σ Θ0−σ
                                                                    A          
                                               ∗−σ    0   1   ∗1− σ
                                     − (1 − σ)C0 αV         C       α (1 − Θ0 )
                                                          β 0
                                                                                                 
                                                 ∗1− σ ∗1− σ             1 2 00 1 ∗1−σ
                                      − (1 − σ)C0     C0     (1 − Θ0 ) α V          C  α (1 − Θ0 ) .
                                                                         β         β 0

Clearly, for σ = 1, we have UC0∗ ,Θ0 (Θ0 , C0∗ ) < 0. The third result follows.




                                                        53
A.4     Proof of Proposition 5
In the Cole-Obstfeld case, we can write V ( NFA1 ) as the maximization over {Θt }t≥1 of

                                       1−α              φ+α
  (1 − α) log( A H,t ) + α log Ct∗ +       log(1 − α) +     log(Θt )
                                       1+φ              1+φ
                                                                                            αΛ   +(1−α)Θt
                                  (1 − α ) φ                             (1 − α) H,t Θt
                                −            log [αΛ H,t + (1 − α)Θt ] −
                                    1+φ                                         1+φ

subject to
                                                 ∞
                                 NFA1 = − ∑ βt α(Λ H,t − Θt ).
                                              t =0

Consider first productivity shocks. For all t ≥ 1 productivity A H,t , the solution of the
planning problem for t ≥ 1 features a constant allocation, for which we drop the t sub-
scripts. This immediately implies that optimal capital controls are zero for t ≥ 1. It is
immediate that the optimal Θ is independent of the path A H,t for t ≥ 1. The result for
productivity shocks then simply follows from Proposition 4.
    Consider next foreign consumption shocks. For all t ≥ 1 productivity Ct∗ , the solution
of the planning problem for t ≥ 1 features a constant allocation, for which we drop the
t subscripts. This immediately implies that optimal capital controls are zero for t ≥ 1. It
is immediate that the optimal Θ is independent of the path Ct∗ for t ≥ 1. The result for
productivity shocks then simply follows from Proposition 4.
    Consider next permanent export demand shocks Λ H,t = Λ H for all t ≥ 0. For all
t ≥ 1 the solution of the planning problem for t ≥ 1 features a constant allocation, for
which we drop the t subscripts. This immediately implies that optimal capital controls
are zero for t ≥ 1. We also find it convenient to define Θ̃0 = Θ0 − Λ H and Θ̃ = Θ − Λ H .
The country budget constraint establishes the following relationship between Θ̃ and Θ̃0 :
        1− β
Θ̃ = − β Θ̃0 . We are left with the following maximization problem
      "                                               1+ φ                                               #
                                     1         C∗                                1+ φ          α
 max log Λ0 + Θ̃0         + log C ∗ −                          Λ H + (1 − α)Θ̃0            + βV (− Θ̃0 )
                                      1+φ        AH                                               β

where

                                                          1−α              φ+α             
  (1 − β)V (Θ̃) = (1 − α) log( A H ) + α log C ∗ +            log(1 − α) +     log Θ̃ + Λ H
                                                          1+φ              1+φ
                                                                                 Λ +(1−α)Θ̃
                                          (1 − α ) φ                    (1 − α) H Λ+Θ̃
                                        −            log Λ H + (1 − α)Θ̃ −
                                            1+φ                                 1+φ

                                                     54
Let U (Θ̃0 , Λ H ) be the objective function. We can compute

               φ+α         1         α(1 − α) Θ̃ − Λ H             1
 UΘ̃0 ,Λ H =                       +                      −
               1 + φ (Θ̃ + Λ H ) 2    1 + φ (Λ H + Θ̃) 3      (Λ H + Θ̃0 )2
                             ∗  1+ φ
                             C                            φ −1 (1 − α )2 φ       1
               − (1 − α ) φ             Λ H + (1 − α)Θ̃0       −
                             AH                                     1 + φ [Λ H + (1 − α)Θ̃]2

For Θ̃0 = 0 (and hence Θ̃ = 0) we always have UΘ̃0 ,Λ H (0, Λ H ) < 0, so that at least
for small shocks, Θ̃0 is decreasing in Λ H and Θ̃ is increasing in Λ H with Θ̃ = Θ̃0 = 0
for Λ H = 1. The result in the proposition follows since capital controls τ0 are given by
 Λ H +Θ̃
Λ H +Θ̃0
         = 1 + τ0 .
     Finally, let’s us consider wealth shocks NFA0 6= 0. For all t ≥ 1 the solution of the
planning problem for t ≥ 1 features a constant allocation, for which we drop the t sub-
scripts. This immediately implies that optimal capital controls are zero for t ≥ 1. We also
find it convenient to define Θ̃0 = Θ0 − 1 − (1 − β) α1 NFA0 and Θ̃ = Θ − 1 − (1 − β) α1 NFA0 .
The country budget constraint establishes the following relationship between Θ̃ and Θ̃0 :
         1− β
Θ̃ = − β Θ̃0 . We are left with the following maximization problem over Θ̃0 :

                             
                       1
  log Θ̃0 + 1 + (1 − β) NFA0 + log C ∗
                       α
                        ∗  1+ φ                                     1+ φ
                   1     C                               1−α
              −                     (1 − α)Θ̃0 + (1 − β)     NFA0 + 1        + βV (Θ̃)
                 1 + φ AH                                 α

where

                                                  1−α
 (1 − β)V (Θ̃) = (1 − α) log( A H ) + α log C ∗ +        log(1 − α)
                                                  1+φ
                                                                                        
  φ+α                         1            (1 − α ) φ                         1−α
+       log Θ̃ + 1 + (1 − β) NFA0 −                   log (1 − α)Θ̃ + (1 − β)     NFA0 + 1
  1+φ                         α              1+φ                               α
                                                                         (1−α)Θ̃+(1− β) 1−α α NFA0 +1
                                                              (1 − α )      Θ̃+1+(1− β) α1 NFA0
                                                          −                                             .
                                                                               1+φ




                                               55
Let U (Θ̃0 , NFA0 ) be the objective function. We have

      1                   φ+α                  1                             1
             U
           1 Θ̃0 ,NFA0
                       =                                       −
  (1 − β ) α              1 + φ [Θ̃ + 1 + (1 − β) α NFA0 ]2 [Θ̃0 + 1 + (1 − β) α1 NFA0 ]2
                                                    1
                            ∗  1+ φ                                           φ −1
                        2    C                                   1−α
              − (1 − α ) φ                 (1 − α)Θ̃0 + (1 − β)        NFA0 + 1
                             AH                                    α
   (1 − α )3 φ                   1                          α (1 − α )           1
 −                                   1
                                                       −  2
     1 + φ [(1 − α)Θ̃ + (1 − β) α NFA0 + 1]2
                                       − α                    1 + φ [Θ̃ + 1 + (1 − β) α1 NFA0 ]3

For Θ̃0 = 0 (and hence Θ̃ = 0) we always have UΘ̃0 ,NFA0 (0, NFA0 ) < 0, so that at least
for small shocks, so that at least for small shocks, Θ̃0 is decreasing in W0 and Θ̃ is in-
creasing in W0 with Θ̃ = Θ̃0 = 0 for Λ H = 1. The result in the proposition follows since
                                    1+(1− β) α1 NFA0 +Θ̃
capital controls τ0 are given by                            = 1 + τ0 . . More generally we have
                                    1+(1− β) α1 NFA0 +Θ̃0
UΘ̃0 ,NFA0 (Θ̃0 , NFA0 ) < 0 for all Θ̃0 < 0 which implies, together with the concavity of U
in Θ̃0 , that for positive shocks to NFA0 , Θ̃0 is a decreasing function of NFA0 so that the
result generalizes to any positive shock to initial wealth NFA0 > 0.


A.5    Proof or Proposition 6
We begin with the latter three claims in the proposition then return to the first claim.
    We note that in general, for rigid prices or for prices set one period in advance, the
planning problem with capital controls for α > 0 can be written in a way that makes it
continuous in α. Then this shows that the unique solution of the planning problem for α >
0 converges to the unique solution of a limit planning problem when α → 0. This limit
planning problem is more constrained than the planning problem of a closed economy
(α = 0): they coincide except that in the latter, the country budget constraint is dropped.
The solution of the closed economy planning problem is the flexible price allocation which
coincides with first best. Hence the optimal allocation with capital controls converges to
the first best allocation as α → 0 if and only if the country budget constraint is not binding
in the limit planning problem. We illustrate this logic in detail for the second claim and
in less detail for the other claims to avoid repetition.
    We start by the case of rigid prices with capital controls. The planning problem for
α > 0 can be rewritten as
                      "                                                    ∗  1+ φ #
                   ∞
                         1                   1                              Ct
        max ∑ βt            Θ1t −σ Ct∗1−σ −      (αΛ H,t + Θt (1 − α))1+φ
         { Θ t } t =0   1−σ                 1+φ                            A H,t



                                                 56
subject to,
                                      ∞
                                      ∑ βt Ct∗1−σ [Θt − Λ H,t ] = 0.
                                     t =0

It is continuous in α and admits a unique solution since the problem is convex. This shows
that the optimal allocation with capital controls as α → 0 converges to the solution of the
following limit planning problem:
                                "                                                     1+ φ #
                         ∞
                                     1                   1   1+ φ             Ct∗
                 max ∑ βt               Θ1t −σ Ct∗1−σ −     Θt                                   (33)
                 { Θ t } t =0       1−σ                 1+φ                   A H,t

subject to,
                                      ∞
                                      ∑ βt Ct∗1−σ [Λ H,t − Θt ] = 0.                             (34)
                                      t =0

For generic shocks to the sequences { A H,t , Λ H,t , Ct∗ }t≥0 , this limit planning problem is
strictly more constrained than the corresponding closed economy planning problem which
coincides with the planning problem (33) but where the budget constraint is dropped. In
the closed economy, capital controls act as a perfect substitute to monetary policy and al-
low to replicate the flexible-price allocation, which coincides with the first best allocation.
The claim that the budget constraint (34) is binding in the limit program (33) can be seen
as follows. Let Ct be the flexible price allocation of the closed economy and let Θ̃t = CC∗t .
                                                                                             t
Then unless
                                 ∞                       
                                 ∑ βt Ct∗1−σ Λ H,t − Θ̃t = 0,
                                     t =0

which does not hold for generic shocks, the budget constraint is binding.
    Next consider the third claim. For risk premium shocks {Ψt }t≥0 , the flexible price
allocation of the closed economy features Ct = C so that Θ̃t = Λ H,t since C = Λ H,t Ct∗ . It
is then immediate that in this case,
                                      ∞                          
                                     ∑ βt Ct∗1−σ       Λ H,t − Θ̃t = 0,
                                     t =0

which shows that the budget constraint is not binding in the limit planning problem.
    We now show that with one period in advance price setting with capital controls the
allocation converges to the flexible price allocation of the closed economy. It suffices to
show that the budget constraint is not binding in the limit α → 0. To see that this is the
case, rewrite limit of the budget constraints as (using the fact that in the limit α → 0,




                                                       57
Q t = St )
                                                 ∞                                                                   
                                                                                                              1
                                                                     −η            η + γ −1
               C0∗1−σ [Λ H,0       − Θ0 ] + ∑ β          t
                                                             Ct∗1−σ Qt            Qt        Λ H,t     − Qt Θt = 0.
                                                                                                              σ

                                                 t =1

Now note that for t ≥ 1, when α → 0, welfare and the equilibrium conditions (9), (10),
                                                                                                                          1
(11), (12) with ∆t = 1, (16) , depend on Θt and Qt only through Θ̃t = Θt Qtσ . It then suf-
fices to let choose Θ̃t = CC∗t where Ct is the flexible price allocation of the closed economy,
                            t
and to pick a sequence {Qt }t≥1 (there are infinitely many such sequences) such that

                                                   ∞                             h                              i
                                                                          −η            η + γ −1
                 C0∗1−σ         Λ H,0 − Θ̃0 +        ∑β       t
                                                                  Ct∗1−σ Qt            Qt        Λ H,t      − Θ̃t = 0,
                                                   t =1

                                   Θ̃t
and to then pick Θt =                1   and Θ0 = Θ̃0 . This immediately shows that the budget con-
                                  Qtσ
straint is not binding in the limit α → 0.
    We now return to the first claim. The result in the case of rigid prices follows directly
from the second claim, which we already proved. It remains to prove the result where
prices are set one period in advance. To see this, and following the proof of the fourth
claim, it suffices to show that among the sequences {Qt }t≥1 such that

                                                   ∞                             h                              i
                                                                          −η            η + γ −1
                 C0∗1−σ         Λ H,0 − Θ̃0 +        ∑β       t
                                                                  Ct∗1−σ Qt            Qt        Λ H,t      − Θ̃t = 0,
                                                   t =1

                   Θ̃t
none satisfies         1   = Θ̃0 , which is clearly true unless
                  Qtσ

                                           ∞                               −η "              η + γ −1                 #
                                                                    Θ̃t                Θ̃t
         C0  ∗1− σ
                       Λ H,0 − Θ̃0 +      ∑ βt Ct∗1−σ                 Θ̃0                Θ̃0
                                                                                                            Λ H,t − Θ̃t = 0,
                                          t =1

which does not hold for generic shocks.


A.6    Derivation of the Loss Function in Section 4
We focus on Cole-Obstfeld case σ = γ = η = 1. We provide an derivation that spans
                                                                      ´t        ´∞
Section 4.2 in which case θ̄t = θ̄ and Section 4.3 in which case θ̄t = 0 ψs ds − 0 ψt e−ρt dt.
   We have the exact relationship

                                                 ct = θt + c∗t + (1 − α)st



                                                                      58
and the following second order approximation

                                          1               1
       yt = c∗t + st + (1 − α)θt + αλh,t + α(1 − α)λ2h,t + α(1 − α)θt2 − α(1 − α)θt λh,t .
                                          2               2

Using these equations, we can derive

 ct = αc∗t + θt α(2 − α) + (1 − α)yt
                                                             h                 i
                                       1              1
                     + (1 − α) −αλh,t − α(1 − α)λh,t + (1 − α)2 −αθt2 + 2αθt λh,t .
                                                 2
                                       2              2

Hence in gaps,

                                                1                                        
                ĉt = (1 − α)ŷt + α(2 − α)θ̂t + (1 − α)2 −αθ̂t (θ̂t + 2θ̄t ) + 2αθ̂t λh,t .
                                                2

We can use this expression to derive

      log Ct = c̄t + ĉt
                                                  1         h                                 i
                                                          2              2
                = c¯t + (1 − α)ŷt + α(2 − α)θ̂t + (1 − α) −α(θ̂t + θ̄t ) + 2α(θ̂t + θ̄t )λh,t .
                                                  2

We have                                                                   
                            1+ φ     1+ φ
                           Nt      N̄t        1+ φ             1         2
                                 =        + N̄t      ŷt + zt + (1 + φ)ŷt ,
                           1+φ     1+φ                         2
where                                         ˆ                −e
                                                    PH,t ( j)          e
                                   zt = log                           ≈ σp2H,t .
                                                     PH,t              2
                                1+ φ
   Using the fact that N̄t             = 1 − α for all t, we get the following expression for the
objective function:
  ˆ   ∞              
          −ρtUt − Ūt
     e                  dt =
  0           CUc
             ˆ ∞       h
  (1−α)(1+φ)                                     2α(2−α)                                                        i
−      2         e −ρt
                         απ π 2H,t + ŷ2t −              θ̂
                                               (1−α)(1+φ) t
                                                                 − 11+
                                                                     −α
                                                                       φ   − α θ̂  (
                                                                                  t tθ̂ + 2 θ̄ t ) + 2α θ̂  λ
                                                                                                           t h,t    dt,
                    0

where απ = e/[λ(1 + φ)].
    We now use a second order approximation of the country budget constraint to replace
the linear term in θ̂t in the expression above. We find that a second order approximation
for nxt :
                                nxt = α(θt − λt + 12 θt2 − 12 λ2t ).


                                                       59
   We first abstract from risk premium shocks. We then have the following second order
approximation for the budget constraint
                                             ˆ       ∞
                                        α                e−ρt (θ̂t + 21 θ̂t (θ̂t + 2θ̄t )) = 0,
                                                 0

so that we can replace the linear term in θ̂t in the expression for welfare to get the follow-
ing expression for the loss function:
                               ˆ                                                                          
                                            −ρt          1      2    1 2 1
          (1 − α)(1 + φ)                e                  απ π H,t + ŷt + αθ θ̂t (θ̂t + 2θ̄t − 2αψ λh,t ) dt,
                                                         2           2     2

or up to a constant
                                   ˆ                                                                      
                                                −ρt          1      2    1 2 1                           2
           (1 − α)(1 + φ)                   e                  απ π H,t + ŷt + αθ (θ̂t + θ̄t − αψ λh,t ) dt,
                                                             2           2     2

where                                                                                              
                         1−α                                                  α             2−α
               α ψ = 2− α                                      and      αθ =                    +1−α .
                     1− α + 1 − α
                                                                             1+φ            1−α
    We now focus on the case of a pure risk premium shock. A first order approximation
                              ´t                           
of the discount factor e−ρt e− 0 ψt dt is e−ρt 1 + θ̄0 − θ̄t . Combining the two, we get the
following second order approximation for the budget constraint
                           ˆ       ∞
                                                  1
                       α               e−ρt (θ̂t + θ̂t (θ̂t + 2θ̄t ) + (θ̄0 − θ̄t )θ̂t ) = 0,
                               0                  2

so that we can replace the linear term in θ̂t in the expression for welfare to get the follow-
ing expression for the loss function:
                       ˆ                                                                               
                               −ρt           1      2    1 2 1
      (1 − α)(1 + φ)       e                   απ π H,t + ŷt + αθ θ̂t (θ̂t + 2(αψ θ̄t + (1 − αψ )θ̄0 )) dt,
                                             2           2     2

or up to a constant
                           ˆ                                                                             
                                       −ρt          1      2    1 2 1                                   2
        (1 − α)(1 + φ)             e                  απ π H,t + ŷt + αθ (θ̂t + αψ θ̄t + (1 − αψ )θ̄0 ) dt.
                                                    2           2     2




                                                                      60
A.7       FOCs for the Optimal Control Problem in Section 4.2
We can incorporate a multiplier Γ on the intertemporal budget constraint. We are left with
the following optimal control problem
                                   ˆ      ∞
                                                    1           1         1
                    min                       e−ρt [ απ π 2H,t + ŷ2t + αθ (θ̂t + θ̄ − αψ λt )2 + Γθ̂t ]dt
               {π H,t ,ŷt ,it ,θ̂t } 0             2           2         2

subject to
                                                    π̇ H,t = ρπ H,t − κ̂ ŷt − λαθ̂t ,

                                              ŷ˙ t = (1 − α)(it − it∗ ) − π H,t + it∗ − r̄t ,

                                                                θ̂˙ t = it − it∗ ,

                                                         ŷ0 = (1 − α)θ̂0 − s̄0 .

       Let µπ,t , µy,t and µθ,t be the costates. We find the following first-order conditions

                                                       µ̇π,t = −απ π H,t + µy,t ,

                                                    µ̇y,t = −ŷt + µπ,t κ̂ + ρµy,t ,

                               µ̇θ,t = −αθ (θ̂t + θ̄ − αψ λh,t ) − Γ + µπ,t λα + ρµθ,t ,

                                                       (1 − α)µy,t + µθ,t = 0,

                                                                 µπ,0 = 0,

                                                        µθ,0 = −(1 − α)µy,0 ,

together with the transversality conditions limt→∞ e−ρt µy,t ŷt = 0, limt→∞ e−ρt µθ,t θ̂t = 0,
and limt→∞ e−ρt µπ,t π̂t = 0.


A.8       Proof of Proposition 7
We have ŷt = − 1+α φ θ̂t and the planning problem is
                              ˆ                "     2                                    #
                                       −ρt      1  α           2    1                     2
                      min          e                     (θ̂t ) + αθ (θ̂t + θ̄ − αψ λh,t ) dt
                                                2 1+φ               2
s.t.                                                        ˆ
                                                                 e−ρt θ̂t dt = 0



                                                                       61
The solution is         "     2      #
                            α
                                  + αθ θ̂t = −αθ θ̄ + αθ αψ λh,t − Γ
                          1+φ
     ´∞                       ´∞
Since 0 e−ρt θ̄dt = α1 NFA0 + 0 e−ρt λh,t dt we find
                                                ˆ ∞           
                                  αθ αψ                    −ρt
                         θ̂t = α 2          λ −ρ     λh,t e dt ,
                              ( 1+φ ) + αθ h,t    0

                                                             ˆ ∞           
                               α         αθ αψ                          −ρt
                     ŷt = −                         λh,t − ρ     λh,t e dt .
                             1 + φ ( 1+α φ )2 + αθ             0


A.9       Proof of Proposition 8
We are led to the following planning problem:
                              ˆ                                                
                                      −ρt       1 2     1                     2
                        min       e              ŷ + αθ (θ̂t + θ̄ − αψ λh,t ) dt
                                                2 t     2
s.t.
                                  ŷ˙ t = (1 − α)(it − it∗ ) + it∗ − r̄t ,

                                                     θ̂˙ t = it − it∗ ,
                                                 ˆ
                                                      θ̂t e−ρt dt = 0,

                                            ŷ0 = (1 − α)θ̂0 − s̄0 .

  Let Γ be the multiplier on the budget constraint, and let µ x,t and µθ,t be the co-states.
We find the following first-order conditions

                                                µ̇y,t = −ŷt + ρµy,t ,

                           µ̇θ,t = −αθ (θ̂t + θ̄ − αψ λh,t ) − Γ + ρµθ,t ,

                                            (1 − α)µy,t + µθ,t = 0.

       This yields
                                αθ                          −1
                             ŷt + (θ̂t + θ̄ − αψ λh,t ) =     Γ,
                              1−α                          1−α
which we can differentiate and combine with the Euler equation to get

                                                        1
                                  it = it∗ +                       αθ (r̄t   − it∗ ),
                                                     1−α+         1− α


                                                            62
implying
                                                  ˆ       t
                                                                 1                                       αθ αψ
                              θ̂t = θ̂0 +                                         αθ (r̄s   − is∗ +            λ̇ )ds.
                                                      0       1−α+               1− α
                                                                                                         1 − α h,s
We therefore have
          ˆ ∞                    ˆ
                    −ρt  1      1 ∞    1                                                                       αθ αψ
               θ̂t e dt = θ̂0 +                                                          αθ (r̄t     − it∗ +         λ̇ )e−ρt dt,
            0            ρ      ρ 0 1−α+                                                1− α
                                                                                                               1 − α h,s
          ´
so that       θ̂t e−ρt dt = 0 requires
                                            ˆ     ∞
                                                         1                                        αθ αψ
                             θ̂0 = −                                      αθ (r̄t      − it∗ +          λ̇ )e−ρt dt,
                                              0       1−α+               1− α
                                                                                                  1 − α h,t

implying
          ˆ       ∞                                                                           ˆ      t
                         1                                    αθ αψ                                         1                      αθ αψ
θ̂t = −                             (r̄t − it∗ +                    λ̇ )e−ρt dt +                                            ∗
                                                                                                                  αθ (r̄s − is +         λ̇ )ds.
              0       1−α+    αθ
                             1− α
                                                              1 − α h,t                          0       1−α+    1− α
                                                                                                                                   1 − α h,s

                                                                                                                                       αθ
The initial condition ŷ0 − (1 − α)θ̂0 + s̄0 = 0 and the optimality condition ŷ0 +                                                   1−α ( θ̂0   +
θ̄ − αψ λh,0 ) = 1−−1α Γ then imply that
                               ˆ       ∞
                       1                                           αθ αψ                         αθ
                          Γ=               (r̄t − it∗ +                  λ̇h,t )e−ρt dt + s̄0 −     (θ̄ − αψ λh,0 ).
                      1−α          0                               1−α                          1−α

This implies that
                               ˆ    ∞
             1−α                              αθ αψ
  ŷt = −                               (r̄t − it∗ + λ̇h,t )e−ρt dt
          1 − α + 1α−θα         0             1−α
                                       αθ      ˆ t
                                      1− α                        αθ αψ                   αθ αψ
                               −                   (r̄s − is∗ +         λ̇h,s )ds − s̄0 +       (λ − λh,0 ).
                                           αθ
                                  1 − α + 1− α 0                 1−α                      1 − α h,t

A.10      Proof of Proposition 9
In the closed economy limit, the planning problem becomes
                                                              ˆ                                 
                                                                       −ρt       1      2    1 2
                                                min                e               απ π H,t + ŷt dt
                                                                                 2           2

s.t.
                                                                  π̇ H,t = ρπ H,t − κ̂ ŷt ,


                                                                                  63
                                ŷ˙ t = it − it∗ − π H,t + it∗ − r̄t ,

                                             θ̂˙ t = it − it∗ ,
                                         ˆ
                                              θ̂t e−ρt dt = 0,

                                             ŷ0 = θ̂0 − s̄0 .

  Let Γ be the multiplier on the budget constraint, and let µ x,t and µθ,t be the co-states.
We find the following first-order conditions

                                        µ̇y,t = ρµy,t + Γ,



                                   ŷ˙ t = −απ κ̂π H,t + κ̂µy,t ,

                                      π̇ H,t = ρπ H,t − κ̂ ŷt .

We can combine the second first order condition with the Euler equation to get

                           θ̂˙ t = (1 − απ κ̂ ) π H,t + κ̂µy,t + r̄t − it∗ .

Finally we have

                                               ŷ0 = −Γ.

   We get
                                      1                            1     1
                  µy,t = eρt [µy,0 + Γ (1 − e−ρt )] = eρt [µy,0 + Γ ] − Γ ,
                                      ρ                            ρ     ρ
which requires
                                             1
                                               Γ = −µy,0 ,
                                             ρ
and implies
                                                     1
                                             µy,t = − Γ.
                                                     ρ
   We are left with the following system:

                                                             Γ
                                     ŷ˙ t = −απ κ̂π H,t − κ̂ ,
                                                             ρ
                                      π̇ H,t = ρπ H,t − κ̂ ŷt ,

                                               ŷ0 = −Γ,

                                                    64
   and then to solve for the value of Γ such that the solution of the differential equation

                                                                            Γ
                                             θ̂˙ t = (1 − απ κ̂ ) π H,t − κ̂ + r̄t − it∗
                                                                            ρ

with the initial condition
                                                                 θ̂0 = ŷ0 + s̄0

features                                                     ˆ
                                                                  e−ρt θ̂t dt = 0.

   Let                                                                 p
                                                                 ρ−        ρ2 + 4α2π κ̂ 2
                                                      ν=
                                                                             2
The closed-form solution is

                                                             1 − απ κ̂
                                                ŷt = Γ                (eνt − 1) − Γ,
                                                            −ν(ρ − ν)
                                                                                                           
                               1 − απ κ̂ νt            1                             −ρ(1 − απ κ̂ ) + ρ − ν
                   π H,t   =Γ            ( e − 1) − Γ                                                         ,
                              απ (ρ − ν)              απ                                  ρ(ρ − ν)
                                                  κ̂           (1 − απ κ̂ )2 νt  1
                   it = r̄t + (1 − απ κ̂ ) π H,t − Γ = r̄t + Γ              e −     Γ,
                                                  ρ            απ (ρ − ν)       ραπ
where
                      ˆ       ∞                                                                                     
                                       −ρt                                                        1      1 − απ κ̂
           Γ = s̄0 +               e         (r̄t − it∗ )        1 + κ̂ + (1 − απ κ̂ )           2
                                                                                                     −                       .
                           0                                                                    ρ απ   α π ( ρ − ν )2

A.11       Proof of Proposition 10
With flexible prices, we have ŷt = − 1+α φ θ̂t and we can drop the initial condition since the
price of home goods can jump. Hence we are led to the planning problem
                           ˆ                  "             2                                                 #
                                ∞
                      1                             α
               min                  e−ρt                             θ̂t2 + αθ (θ̂t + αψ θ̄t + (1 − αψ )θ̄0 )2 dt
               {θ̂t } 2     0                      1+φ

subject to                                                  ˆ    ∞
                                                                     e−ρt θ̂t dt = 0.
                                                             0




                                                                         65
Let Γ be the multiplier on the budget constraint. The solution is given by
                       "           2        #
                             α
                                         + αθ θ̂t = −αθ αψ θ̄t − αθ (1 − αψ )θ̄0 − Γ.
                            1+φ
        ´∞
Since   0    e−ρt θ̄t dt = 0 we find Γ = −αθ (1 − αψ )θ̄0 so that the solution is

                                                           αθ αψ
                                            θ̂t = −      α 2         θ̄t ,
                                                      ( 1+ φ ) + α θ

                                                    α        αθ αψ
                                          ŷt =            α 2         θ̄t .
                                                  1 + φ ( 1+ φ ) + α θ


A.12        Proof of Proposition 11
We have following planning problem
                               ˆ
                                          1         1
                         min        e−ρt [ ŷ2t + αθ (θ̂t + αψ θ̄t + (1 − αψ )θ̄0 )2 ]
                                          2         2

s.t.
                               ŷ˙ t = (1 − α)(it − it∗ − θ̄˙ t ) + it∗ + θ̄˙ t − r̄t ,

                                              θ̂˙ t = it − it∗ − θ̄˙ t ,
                                              ˆ ∞
                                                     e−ρt θ̂t dt = 0,
                                                  0

                                             ŷ0 = (1 − α)θ̂0 − s̄0 .

Let Γ be the multiplier on the budget constraint and let µ x,t and µθ,t be the co-states. We
find the following first-order conditions

                                              µ̇y,t = −ŷt + ρµy,t ,

                          µ̇θ,t = −αθ (θ̂t + αψ θ̄t + (1 − αψ )θ̄0 ) − Γ + ρµθ,t ,

                                            (1 − α)µy,t + µθ,t = 0.

This implies that
                                     αθ                                   −1
                            ŷt +       (θ̂t + αψ θ̄t + (1 − αψ )θ̄0 ) =     Γ,
                                    1−α                                  1−α




                                                          66
and hence differentiating, we get

                      αθ
                 −       (it − it∗ − θ̄˙ t (1 − αψ )) = (1 − α)(it − it∗ − θ̄˙ t ) + it∗ + θ̄˙ t − r̄t .
                     1−α

This can be rewritten as
                                                                                                               
                                               1                                      α θ (1 − α ψ )      ˙
                             it =   it∗   +                    αθ         r̄t +                                 ∗
                                                                                                     − α θ̄t − it ,
                                            1−α+              1− α
                                                                                          1−α

or                                                                                                 
                                                                       α           2−α−(1−α)2
                                                                      1+ φ           (1− α )2
                                             it = it∗ +                                                      ψt ,
                                                                                    α 2−α+(1−α)2
                                                                  1−α+             1+ φ (1− α )2

implying                                                                                                   
                                              1                                                     αθ αψ
                                      τt =                         αθ         r̄t − ψt − it∗      −       ψt .
                                           1−α+                   1− α
                                                                                                    1−α
       We also get
                                                  ˆ   t                                                           
                                                             1                                   α θ (1 − α ψ )
              θ̂t + θ̄t = θ̂0 + θ̄0 +                                       αθ (r̄s      +                      − α θ̄˙ s − is∗ )ds
                                                  0       1−α+             1− α
                                                                                                     1−α

or                                                     ˆ                                                                            
                                                              t                              α θ (1 − α ψ )
                                                                     1                                         α
                 θ̂t + θ̄t = θ̂0 + θ̄0 +                                           αθ                       −                             ψs ds
                                                          0       1−α+            1− α
                                                                                                 1−α          1+φ
                 ´∞                          ´∞
which using          0   e−ρt θ̂t dt =        0       e−ρt θ̄t dt = 0, we can rewrite as

                                                                  2                                                                             2
                         ˆ   ∞             α 2−α−(1−α)                                            ˆ     t            α 2−α−(1−α)
                                          1+ φ (1− α )2                                                             1+ φ (1− α )2
       θ̂t = −θ̄t −                                                           ψs e−ρs ds +                                                                   ψs ds,
                                               α 2−α+(1−α)2                                                                    α 2−α+(1−α)2
                         0       1−α+         1+ φ (1− α )2
                                                                                                    0       1−α+              1+ φ (1− α )2

i.e.
                                                                                  1−α
                                              θ̂t = −                                                       θ̄t .
                                                                                 α 2−α+(1−α)2
                                                                  1−α+          1+ φ (1− α )2

       Finally, using the Euler equation and the initial condition, we find that
                                                                                                       
                                      1 − α + 2 1+α φ                                                       ˆ          ∞                       ˆ       t       
                                                                             1 + φ (1 − α )                                       −ρt
       ŷt = (1 − α)                                                      −                                                ψt e         dt −               ψs ds .
                                             α 2−α+(1−α)2                       1+φ
                              1−α+          1+ φ (1− α )2
                                                                                                                    0                               0




                                                                               67
A.13    Proof of Proposition 12
In the closed economy limit, the planning problem becomes
                                                                           ˆ   ∞       h                i
                                                                       1
                                                    min                            e−ρt απ π 2H,t + ŷ2t dt
                                                {π H,t ,ŷt ,it ,θ̂t } 2   0


subject to
                                                                  π̇ H,t = ρπ H,t − κ̂ ŷt ,

                                                                   ŷ˙ t = it − π H,t − ρ,

                                                                    θ̂˙ t = it − ρ − ψt ,
                                                                    ˆ ∞
                                                                           e−ρt θ̂t dt = 0,
                                                                       0
                                                                                   ˆ    ∞
                                                              ŷ0 = θ̂0 +                   ψt e−ρt dt.
                                                                                    0
                                                                                               ´∞                  ´t
We guess and verify that π H,t = ŷt = 0, θ̂t =                                                 0   ψs e−ρs ds −    0   ψs ds, and it = ρ is a
solution.


A.14    Proof of Proposition 13
With capital controls we have
                                            ˆ    ∞       h                                                     i
                                        1
                   min                               e−ρt απ π 2H,t + ŷ2t + αθ (θ̂t + αψ θ̄t + (1 − αψ )θ̄0 )2 dt
             {π H,t ,ŷt ,it ,θ̂t ,et } 2   0


subject to
                                                           π̇ H,t = ρπ H,t − κ̂ ŷt − λαθ̂t ,

                           ŷ˙ t = (1 − α)(it − it∗ − ėt − ψt ) − π H,t + it∗ + ėt + ψt − r̄t ,

                                                                θ̂˙ t = it − it∗ − ėt − ψt ,
                                                                     ˆ ∞
                                                                          e−ρt θ̂t dt = 0,
                                                                       0

                                                             ŷ0 = (1 − α)θ̂0 + e0 − s̄0 .




                                                                                   68
Note that this allows the planner to control θ̂t and ŷt independently. We can drop the
initial condition. We can therefore rewrite the problem as
                                    ˆ    ∞       h                                                     i
                                1
                min                          e−ρt απ π 2H,t + ŷ2t + αθ (θ̂t + αψ θ̄t + (1 − αψ )θ̄0 )2 dt
             {π H,t ,ŷt ,θ̂t } 2    0


subject to
                                                     π̇ H,t = ρπ H,t − κ̂ ŷt − λαθ̂t ,
                                                            ˆ ∞
                                                                e−ρt θ̂t dt = 0.
                                                            0
   The FOCs are
                                                           −µ̇π,t = απ π H,t ,

                                                            ŷt − κ̂µπ,t = 0,

                                    αθ (θ̂t + αψ θ̄t + (1 − αψ )θ̄0 ) + Γ − λαµπ,t = 0.

Note that this implies the following formula for capital controls

                                                            λα                  λα
                                    τt = −αψ ψt +              µ̇π,t = −αψ ψt −    απ π H,t .
                                                            αθ                  αθ

This formula depends on the endogenous object π H,t which we determine in closed form
below.
   We have the following system of differential equations
                                                                                                      
                                      (λα)2      2                             Γ
             π̇ H,t   = ρπ H,t − κ̂ +                                µπ,t + λα    + αψ θ̄t + (1 − αψ )θ̄0 ,
                                        αθ                                     αθ

                                                           µ̇π,t = −απ π H,t ,

with µπ,0 = 0.                                                                                #
                                                 "                                 (λα)2
                                                       ρ        −       κ̂ 2   +                                     h                               i
                                                                                                                         Γ
   Let Xt = [π H,t , µπ,t ]0 , A =                                                   αθ
                                                                                                    , and Bt = [λα       αθ   + αψ θ̄t + (1 − αψ )θ̄0 , 0]0 .
                                                     −απ                       0
We can rewrite this as
                                                            Ẋt = AXt + Bt .

The solution is                                                                ˆ       t
                                                            At
                                                 X t = e [ X0 +                            e− As Bs ds].
                                                                                   0




                                                                          69
   The matrix A has exactly one negative eigenvalue
                                                                  r                                                  
                                                                                                         (λα)2
                                                   ρ−                 ρ2 + 4απ κ̂ 2 +                      αθ
                                         ν=                                                                               .
                                                                                    2

Let Vν = [vν , 1]0 be the corresponding eigenvector where vν = − α1π . We need X0 +
´ ∞ − As
 0 e     Bs ds to be co-linear with Vν , i.e. we need
                                                                  ˆ       ∞
                                     [π H,0 , 0] +        0
                                                                              e− As Bs ds = µ[vν , 1]0 .
                                                                      0

We can project this equation using E1 = [1, 0]0 and E2 = [0, 1]0 . We find
                                                      ˆ           ∞
                                                                      E20 e− As Bs ds = µ,
                                                              0
                                              ˆ       ∞                                      ˆ           ∞
                                                                                         1
                           π H,0 = −                      E10 e− As Bs ds −                                  E20 e− As Bs ds,
                                                  0                                     απ           0

and X0 = [π H,0 , 0]0 . Hence we have
                                                          ˆ       ∞                          ˆ       ∞
                                     At                                   − As
                          X t = e [ X0 +                              e           Bs ds] −                e− A(s−t) Bs ds,
                                                              0                                  t

and finally                         ˆ                                                                   ˆ
                                          ∞                                                                       ∞
                                                                                     1
                      Xt = e   νt
                                              E20 e− As Bs ds                     [− , 1]0 −                          e− A(s−t) Bs ds.
                                      0                                             απ                        t

   We can now try to determine Γ. For this, we rewrite Bt =                                                                        αθ ΓE1
                                                                                                                                   λ
                                                                                                                                            + B̃t where B̃t =
                        
[λα αψ θ̄t + (1 − αψ )θ̄0 , 0]0 . We then write
                                     ˆ       ∞                                                             ˆ        ∞
                   λ                                                                  1                                                              λ −1
 Xt = e   νt
                     ΓE0 A−1 E1 +                 E20 e− As B̃s ds                 [− , 1]0 −                                 e− A(s−t) B̃s ds − Γ      A E1 ,
                   αθ 2                   0                                          απ                           t                                  αθ

and we can use the budget constraint to find Γ as follows. First use

                                αθ (θ̂t + αψ θ̄t + (1 − αψ )θ̄0 ) + Γ = λαE20 Xt ,

and integrate to find
                                                                                        ˆ    ∞
                                αθ ((1 − αψ )θ̄0 ) + Γ = λαρ                                         e−ρt E20 Xt dt,
                                                                                         0




                                                                               70
which leads to

 αθ ((1 − αψ )θ̄0 ) + Γ =
                          ˆ ∞               ˆ ∞       ˆ ∞                                    
        1      λ     0 −1        0 − As              −ρt      0 − A(s−t)              1 λ 0 −1
λαρ               ΓE A E1 +     E2 e    Bs ds −    e         E2 e        B̃s dsdt − Γ     E A E1 ,
      ρ + ν αθ 2             0                  0         t                           ρ αθ 2

or
                                                h           ´∞                          ´∞          ´∞                            i
                                                     1             0 − As B ds
          −αθ (1 − αψ )θ̄0 + λαρ                    ρ+ν         0 E2 e     s         −   0    e−ρt   t    E20 e− A(s−t) B̃s dsdt
     Γ=                                                                                                                                .
                                                                     ν λ2 α 0 −1
                                                            1+      ρ+ν αθ E2 A E1


     Imagine now that prices are rigid. Then the problem simplifies to
                                                ˆ   ∞       h                                         i
                                            1
                       min                              e−ρt ŷ2t + αθ (θ̂t + αψ θ̄t + (1 − αψ )θ̄0 )2 dt
                 {π H,t ,ŷt ,it ,θ̂t ,et } 2   0


subject to                                                  ˆ   ∞
                                                                    e−ρt θ̂t dt = 0.
                                                            0

The solution is ŷt = 0 and θ̂t = −αψ θ̄t , which implies

                                                                 τt = −αψ ψt .

We can also compute et . For that we use

                                                                           αφ
                                 ŷ˙ t = (1 − α)(it − ρ) + α(ėt + ψt ) −     ψt ,
                                                                          1+φ

                                                    θ̂˙ t = (it − ρ) − (ėt + ψt ),

                                                    ŷ0 = (1 − α)θ̂0 + e0 − s̄0 .

This yields                                                             
                                               α
                                   ėt = −           + (1 − α)(1 − αψ ) ψt ,
                                             1+φ
                                                                   ˆ ∞
                                      1 + φ (1 − α )
                              e0 =                   − (1 − α ) α ψ      ψt e−ρt dt.
                                         1+φ                          0

Hence at least for small α, in response to a negative risk premium shock that mean reverts
to zero, the exchange rate initially appreciates and then depreciates over time.




                                                                       71
   This solution is clearly different from the one with fixed exchange rate which entails

                                                                                2α
                                                                    1−α+       1+ φ
                                           τt = −                                                  ψt .
                                                                           α 2−α+(1−α)2
                                                          1−α+            1+ φ  (1− α )2

   How can we compare them? In both cases, capital controls are used to lean agains the
wind. But the former leans less agains the wind than the latter.
   We can also compare the solution to the flexible price solution

                                                                         αθ αψ
                                                      τt = −           α 2         ψt ,
                                                                    ( 1+ φ ) + α θ

so that we see that capital controls are always used more with rigid prices and flexible
exchange rate than with flexible prices. However, this difference disappears when α → 0.
There the exchange rate required to implement this allocation with sticky prices is

                  1 + φ (1 − α )
                                                    α
                                                 (1+ φ )2
                                                               + α θ (1 − α ψ ) ˆ           t               ˆ    ∞                 
                                                                                                                          −ρt
           et = −                                                                                ψs ds −              e         ψt dt ,
                     1+φ                                     α
                                                          (1+ φ )2
                                                                     + αθ                0                    0


and in particular

                             1 + φ (1 − α )
                                                                  α
                                                               (1+ φ )2
                                                                          + α θ (1 − α ψ ) ˆ           ∞
                        e0 =                                                                               e−ρt ψt dt.
                                1+φ                                     α
                                                                     (1+ φ )2
                                                                                + αθ               0


A.15    Planning Problem with Sticky Wages
Here we allow any path for et . To consider the case with a fixed exchange rate we can
impose the further condition that et = 0. The planning problem is
                                                      ˆ   ∞
                                                  1
                        min                                   e−ρt [απ π 2H,t + απ w (πtw )2 + ŷ2t + αθ θ̂t2 ]dt
             {π H,t ,πtw ,ŷt ,it ,θ̂t ,ω̂t ,et } 2   0



                    π̇tw = ρπtw − λw [(1 − α) + φ]ŷt − λw α(2 − α)θ̂t + λw ω̂t ,

                                  π̇ H,t = ρπ H,t − λω̂t − λαŷt + λα(1 − α)θ̂t ,

                                    ŷ˙ t = (1 − α)it − (π H,t + r̄t ) + α(it∗ + ėt ),

                                                              θ̂˙ t = it − it∗ − ėt ,

                                  ω̂˙ t = πtw − (1 − α)π H,t − α(πt∗ + ėt ) − ω̄˙ t ,

                                                                          72
together with the initial conditions

                                                        ω̂0 = −ω̄0 − αe0 ,

                                              e0 − s̄0 = ŷ0 − (1 − α)θ̂0 ,

and the country budget constraint
                                                         ˆ       ∞
                                                                     e−ρt θ̂t = 0.
                                                             0

By putting a multiplier Γ on the country budget constraint and incorporating it in the
objective, we are left with an optimal control problem with state variables π H,t , πtw , ŷt , θ̂t ,
ω̂t , and control variables it and ėt .


A.16     Proof of Proposition 14
We first look at the case of rigid prices and wages. The planning problem simplifies to
                                                                      ˆ     ∞
                                                                 1
                                          min                                   e−ρt [ŷ2t + αθ θ̂t2 ]dt
                                 {π H,t ,πtw ,ŷt ,it ,θ̂t ,et } 2      0


subject to
                                        ŷ˙ t = (1 − α)it − r̄t + α(it∗ + ėt ),

                                                         θ̂˙ t = it − it∗ − ėt ,
                                                          ˆ ∞
                                                                 e−ρt θ̂t = 0.
                                                             0

Clearly the optimal solution is to set θ̂t = 0, it = r̄t and set ėt equal to it − it∗ , so that
optimal capital controls are zero.
   In the closed economy limit α → 0, capital controls are useless since the loss function
can be solved as the solution of the following planning problem
                                                    ˆ    ∞
                                                1
                            min                              e−ρt [απ π 2H,t + απ w (πtw )2 + ŷ2t ]dt
                    {π H,t ,πtw ,ŷt ,it ,ω̂t } 2    0


subject to
                                     π̇tw = ρπtw − λw (1 + φ)ŷt + λw ω̂t ,

                                                    π̇ H,t = ρπ H,t − λω̂t ,



                                                                       73
                                       ŷ˙ t = it − (π H,t + r̄t ),

                                      ω̂˙ t = πtw − π H,t − ω̄˙ t .

and the initial condition
                                             ω̂0 = −ω̄0 .

Note also that this system is identical to that of a closed economy with sticky prices and
sticky wages.


A.17     Proof of Propositions 16 and 17
We provide the proof for Proposition 16. The proof of Proposition 17 is almost identical.
        We start by showing that at the coordinated solution, the disaggregated variables π̃ iH,t ,
ỹit , θ̃ti that solve the disaggregated planning problem (30) are equivalent to the solution to
the component planning problem (31). Note that the family of problems in (31) constitute
a relaxed version of the problem in (30), since it is identical except that the two aggrega-
tion constraints (26) and (27) are dropped. Also, the component planning problems (31)
for any two different countries i ∈ [0, 1] are identical linear quadratic problems, except
for possibly different paths for the forcing variable s̄¯it . We note three facts. First, if s̄¯it = 0
for all t ≥ 0 then the solution to (31) entails π̃ iH,t , = ỹit = θ̃ti = 0. Second, the solution to
(31) must be linear in the path of the forcing variable {s̄¯it }t≥0 . Third, we have by defini-
           ´1
tion 0 s̄¯it di = 0. Putting these three facts together implies that the family of solutions to
                                                                            ´1              ´1
(31) automatically satisfy the two aggregation constraints 0 = 0 ỹit di and 0 = 0 π̃ iH,t di
(equations (26), and (27)) and therefore coincide with the solution to (30).
        Next we show that that at the uncoordinated solution, the disaggregated variables
π̃ H,t , ỹit , θ̃ti also solve the component planning problems (31). First note that the unco-
    i

ordinated component planning problem (32) coincides with (31) when ŷˆ ∗t = πt∗ = 0 for
all t ≥ 0. Second, for any path of {ŷˆ ∗t , πt∗ , s̄¯it }t≥0 the problem is linear quadratic and the
solution is linear in these variables. Third, an uncoordinated solution {ŷˆ ∗t , πt∗ }t≥0 ∈ F
                                                                    ´1              ´1
requires that the associated solutions to (32) satisfy 0 = 0 ỹit di and 0 = 0 π̃ iH,t di. Putting
these three facts together implies that the family of solutions to (32) for {ŷˆ ∗t , πt∗ }t≥0 ∈ F
coincides with the solution of the component planning problem (31).
        The derivation of the feasible set can be found in the next subsection.




                                                   74
A.18     Derivation of the feasible sets F and F 0 in Propositions 16 and 17
We deal with the case where the labor tax is set at its uncoordinated level. The other case
is similar.
    The uncoordinated component planning problem (32) is linear quadratic, so its solu-
                                                                           ´1
tion, for given {ŷˆ ∗t , πt∗ }t≥0 , is linear in {s̄¯it }t≥0 . Then, since 0 s̄¯it di = 0, it follows that
                                                                                                ´1
the solution to (32) with {ŷˆ ∗t , πt∗ }t≥0 satisfies the aggregation constraints 0 = 0 ỹit di and
     ´1
0 = 0 π̃ iH,t di (equations (26), and (27)) if and only if the solution with s̄¯it = 0 for all t ≥ 0
yields π̃ iH,t = ỹit = θ̃ti = 0 for all t ≥ 0.
    Thus, we have established that {ŷˆ ∗t , πt∗ }t≥0 ∈ F if and only if π̇t∗ = ρπt∗ − κ̂ ŷˆ ∗t and and
the following problem yields π̃ H,t = ỹt = θ̃t = 0:
                     ˆ   ∞       h                                                                   i
                 1
             min             e−ρt απ (π̃ H,t )2 + 2απ πt∗ π̃ H,t + (ỹt )2 + 2ŷˆ ∗t ỹt + αθ (θ̃t )2 dt
                 2   0

subject to
                                          π̃˙ H,t = ρπ̃ H,t − κ̂ ỹt − λαθ̃t ,

                                             ỹ˙ t = (1 − α)θ̃˙ t − π̃ H,t ,
                                                   ˆ ∞
                                                       e−ρt θ̃t dt = 0,
                                                  0

                                                 ỹ0 = (1 − α)θ̃0 ,

where the minimization is over the variables π̃ H,t , ỹt , θ̃t , taking ŷˆ ∗t , and πt∗ as given. We
                                    ´
put a multiplier Γ on the constraint e−ρt θ̃t dt = 0 and incorporate it in the objective to
obtain an optimal control problem. The first-order conditions are

                                       −µ̇π,t = απ π̃ H,t + απ πt∗ − µy,t ,

                                        ρµy,t − µ̇y,t = ỹt + ŷˆ ∗t − κ̂µπ,t ,

                                      ρµθ,t − µ̇θ,t = αθ θ̃t + Γ − λαµπ,t ,

                                             (1 − α)µy,t + µθ,t = 0,

                                                      µπ,0 = 0.

We can combine these equations to get

                     1−α                    αθ                     Γ             1−α
      µπ,t =                   ỹt +                 θ̃t +                +                ŷˆ ∗t ,
               κ̂ (1 − α) + λα       κ̂ (1 − α) + λα       κ̂ (1 − α) + λα κ̂ (1 − α) + λα


                                                          75
leading to the following reduced system (which substitutes both µπ,t and µθ,t out):

          1−α                      αθ                     1−α
                    ỹ˙ t +                 θ̃˙ t +                 ŷˆ˙ ∗t = −απ π̃ H,t + µy,t − απ πt∗ ,
    κ̂ (1 − α) + λα         κ̂ (1 − α) + λα         κ̂ (1 − α) + λα

                          λα                    κ̂αθ                  κ̂Γ             λα
 ρµy,t − µ̇y,t =                   ỹt −                 θ̃t −                +               ŷˆ ∗ ,
                   κ̂ (1 − α) + λα       κ̂ (1 − α) + λα       κ̂ (1 − α) + λα κ̂ (1 − α) + λα t
                                      π̃˙ H,t = ρπ̃ H,t − κ̂ ŷ˜ t − λαθ̃t ,

                                         ỹ˙ t = (1 − α)θ̃˙ t − π̃ H,t ,

                                              ỹ0 = (1 − α)θ̃0 ,
            1−α                    αθ                     Γ             1−α
                      ỹ0 +                 θ̃0 +                +               ŷˆ ∗ = 0.
      κ̂ (1 − α) + λα       κ̂ (1 − α) + λα       κ̂ (1 − α) + λα κ̂ (1 − α) + λα 0
In order for π̃ H,t = ỹt = θ̃t = 0 to be the solution, we must then have

                                         1−α
                                                  ŷˆ˙ ∗ = µy,t − απ πt∗ ,
                                   κ̂ (1 − α) + λα t

                                                   κ̂Γ             λα
                       ρµy,t − µ̇y,t = −                   +               ŷˆ ∗ ,
                                            κ̂ (1 − α) + λα κ̂ (1 − α) + λα t
                                       Γ             1−α
                                              +               ŷˆ ∗ = 0,
                               κ̂ (1 − α) + λα κ̂ (1 − α) + λα 0
We seek bounded solutions. Combining these three equations and using that πt∗ =
 ´
κ e−ρ(s−t) ŷˆ ∗s ds we obtain

                               1               1
                    ŷˆ˙ ∗t = − κ̂ ŷˆ0∗ −            (λα + (κ̂ (1 − α) + λα) απ κ̂ ) πt∗ ,
                               ρ           (1 − α) κ̂
                           ´
which together with πt∗ = κ e−ρ(s−t) ŷˆ ∗s ds fully characterizes the feasibility set F .
    To determine the dimensionality of F we then must solve the following system of
differential equations

                                      1           λα + (κ̂ (1 − α) + λα) απ κ̂ ∗
                           ŷˆ˙ ∗t = − κ̂ ŷˆ0∗ −                             πt ,
                                      ρ                     (1 − α) κ̂
                                             π̇t∗ = ρπt∗ − κ̂ ŷˆ ∗t .




                                                       76
   Let Xt = [ŷˆ ∗t , πt∗ ]0 , B = [− 1ρ κ̂ ŷˆ0∗ , 0]0 and
                                 "                                                         #
                                       0      − (1−1α)κ̂ (λα + (κ̂ (1 − α) + λα) απ κ̂ )
                         A=                                                                    .
                                      −κ̂                          ρ

We have Ẋt = AXt + B.
   We need to find the eigenvalues of A. The characteristic polynomial of A is given by
 2         λα+(κ̂ (1−α)+λα)απ κ̂
x − ρx −            1− α         . This implies that A two real eigenvalues of opposite signs.
Let ν be the negative eigenvalue. Denote the corresponding eigenvector by Vν .
   Let E1 = [1, 0]0 and E2 = [0, 1]0 . We must then solve the system of two equations in
three unknowns (X0 = [ŷˆ0∗ , π0∗ ]0 and αν ):

                                             1
                                     Ei0 X0 − κ̂ ( E10 X0 )( Ei0 A−1 E1 ) = αν Ei0 Vν .
                                             ρ

And we have
                                                           1
                                           Xt = αν eνt Vν + κ̂ ( E10 X0 ) A−1 E1
                                                           ρ
so that limt→∞ Xt = 1ρ κ̂ ( E10 X0 ) A−1 E1 . This means that the feasible set is a one-dimensional
linear space. Moreover, the set of limits is also one-dimensional. This implies that the set
of possible long-term limits for ŷˆ ∗t and πt∗ is the locus 0 = ρπt∗ − κ̂ ŷˆ ∗t .


A.19      The Ramsey Problem
We treat the uncoordinated labor tax case. The coordinated labor tax case is similar. We
want to solve
                      ˆ                                                 
                    1 ∞ −ρt                                 2α
                min       e     απ (πt ) + (ŷˆ t ) −
                                     ∗ 2        ∗  2
                                                                    ŷˆ dt
                                                                       ∗
                    2 0                               (1 − α)(1 + φ) t

subject to {ŷˆ ∗t , πt∗ }t≥0 ∈ F .
   We know that the feasible set F is described by

                                                           1
                                           Xt = αν eνt Vν + κ̂ ( E10 X0 ) A−1 E1
                                                           ρ

where

                                              1
                                      Ei0 X0 − κ̂ ( E10 X0 )( Ei0 A−1 E1 ) = αν Vν ,
                                              ρ


                                                              77
                                         "                                                             #
                                               0       − (1−1α)κ̂ (λα + (κ̂ (1 − α) + λα) απ κ̂ )
                                    A=                                                                     ,
                                              −κ̂                              ρ
ν is the negative eigenvalue of A and Vν the corresponding eigenvector.
    Note that we have

                                                               λα + (κ̂ (1 − α) + λα) απ κ̂
                                              Det( A) = −
                                                                           1−α

and                                                              "                                 #
                                                                           λα+(κ̂ (1−α)+λα)απ κ̂
                                                        1            ρ
                                             A −1   =                              (1−α)κ̂
                                                      Det( A)        κ̂                    0
                                                 1− α
so that A−1 E1 = Det1( A) [ρ, κ̂ ]0 = − λα+(κ̂ (1− α)+λα)απ κ̂
                                                               [ρ, κ̂ ]0 . Note in passing that this shows
that a solution that starts with E10 X0 > 0 ends up with E10 X∞ < 0 and E20 X∞ < 0.
    We have to solve
                               ˆ                                                  
                            1 ∞ −ρt         0                   2α             0
                      min            e     Xt ΩXt −                          E Xt dt
                            2 0                        (1 − α)(1 + φ) 1

subject to
                                                         1
                                                     X0 − κ̂ ( E10 X0 ) A−1 E1 = αν Vν ,
                                                         ρ
                                                                    1
                                                    Xt = αν eνt Vν + κ̂ ( E10 X0 ) A−1 E1 ,
                                                                    ρ
where the minimization is over X0 and αν , and
                                                                     "             #
                                                                          1 0
                                                             Ω=                        .
                                                                          0 απ

We can use the last constraint the rewrite the objective as

          ˆ      ∞             h                                                          2
      1                                2 2νt                 2αν κ̂ 0                     κ̂
  min                e   −ρt
                                   (αν ) e     Vν0 ΩVν +           ( E1 X0 )eνt Vν0 ΩA−1 E1 +   ( E10 X0 )2 E10 A0−1 ΩA−1 E1
      2      0                                                ρ                           ρ
                                                          2ααν eνt              2α 1ρ κ̂                           i
                                                                     0                          0        0 −1
                                                    −               E Vν −                   ( E X ) E A E1 dt
                                                      (1 − α)(1 + φ) 1     (1 − α)(1 + φ) 1 0 1

so that we are left with the following static linear quadratic problem in three variables




                                                                          78
(X0 , αν ):

                                                                                 2
        1h        1                               2κ̂                              κ̂ 1 0 0−1
     min (αν )2        Vν0 ΩVν + αν ( E10 X0 )         V 0 ΩA−1 E1 + ( E10 X0 )2       E A ΩA−1 E1
        2       ρ − 2ν                         ρ(ρ − ν) ν                          ρ  ρ 1
                                       2α                                 2α 1ρ κ̂               i
                        − αν                        0         0
                                                   E1 Vν − ( E1 X0 )                  E10 A−1 E1
                             (1 − α)(1 + φ)(ρ − ν)                   (1 − α)(1 + φ)ρ

subject to
                                       1
                                   X0 − κ̂ ( E10 X0 ) A−1 E1 = αν Vν .
                                       ρ
The FOCs together with the constraints lead to a linear system of five equations in five
unknowns X0 , αν , and the two multipliers λ1 and λ2 on the constraints (there are two
constraints stacked in a vector). Let’s write it:


       1                            κ̂                            α
αν          Vν0 ΩVν + ( E10 X0 )          Vν0 ΩA−1 E1 −                      E0 Vν − λ1 E10 Vν − λ2 E20 Vν = 0,
     ρ − 2ν                      ρ(ρ − ν)               (1 − α)(1 + φ)(ρ − ν) 1


                                         2                       α 1ρ κ̂
        κ̂                               κ̂  1 0 0−1
  αν         V 0 ΩA−1 E1 + ( E10 X0 )                 −1
                                              E A ΩA E1 −                    E0 A−1 E1
     ρ(ρ − ν) ν                          ρ   ρ 1             (1 − α)(1 + φ)ρ 1
                                                               
                                                     1 0 −1                1
                                             + λ1 1 − κ̂E1 A E1 − λ2 κ̂E20 A−1 E1 = 0,
                                                     ρ                     ρ

                                                 λ2 = 0,
                                       1
                               Ei0 X0 − κ̂ ( E10 X0 ) Ei0 A−1 E1 = αν Ei0 Vν .
                                       ρ
Using λ2 = 0, we can rewrite this as a linear system of four equations in four unknowns:

         1                            κ̂                                        α
  αν          Vν0 ΩVν + ( E10 X0 )          Vν0 ΩA−1 E1 − λ1 E10 Vν =                       E10 Vν ,
       ρ − 2ν                      ρ(ρ − ν)                           (1 − α)(1 + φ)(ρ − ν)


                                         2                             
        κ̂                               κ̂  1 0 0−1            1 0 −1
  αν         V 0 ΩA−1 E1 + ( E10 X0 )                −1
                                              E A ΩA E1 + λ1 1 − κ̂E1 A E1 =
     ρ(ρ − ν) ν                          ρ   ρ 1                ρ
                                                                                  α 1ρ κ̂
                                                                                              E10 A−1 E1 ,
                                                                            (1 − α)(1 + φ)ρ

                                                 1
                            −αν Ei0 Vν + Ei0 X0 − κ̂ ( E10 X0 ) Ei0 A−1 E1 = 0.
                                                 ρ

                                                    79
We can also see that X0 = 0 (and αν = 0) is not a solution since λ1 cannot (generically)
simultaneously solve
                                             α
                            λ1 = −                        ,
                                   (1 − α)(1 + φ)(ρ − ν)
                                              α ρ1 κ̂          E10 A−1 E1
                                 λ1 =                                         ,
                                        (1 − α)(1 + φ)ρ 1 − 1ρ κ̂E10 A−1 E1

unless of course we are in the knife-edge case (but is that even possible given the signs of
our variables...) where

                           α                   α 1ρ κ̂      E10 A−1 E1
               −                       =                                     .
                 (1 − α)(1 + φ)(ρ − ν)   (1 − α)(1 + φ)ρ 1 − 1ρ κ̂E10 A−1 E1

Since E10 A−1 E1 =     1
                     Det( A)
                             ρ   = − λα+(κ̂ ((11−−αα)+
                                                     )ρ
                                                        λα)απ κ̂
                                                                 , this condition boils down to

                                                                              1− α
                       α                   ακ̂         λα+(κ̂ (1−α)+λα)απ κ̂
                                   =                                                            ,
             (1 − α)(1 + φ)(ρ − ν)   (1 − α)(1 + φ)ρ 1 −         (1−α)κ̂
                                                                        λα+(κ̂ (1−α)+λα)απ κ̂

or
                             ρ                 κ̂ (1 − α)
                                =
                            ρ−ν   λα + λααπ κ̂ + κ̂ (1 − α)(απ κ̂ − 1)
or
                                   ρ            1−α
                                      = 1+α κ̂                    .
                                  ρ−ν  α 1+φ + (1 − α)(απ κ̂ − 1)
                                           π




A.20    Coordination vs. No Coordination with Coordinated Labor Tax
In this section we outline the coordinated labor tax case: where there is coordination on
the labor tax at the symmetric steady state so that M (1 + τL ) = 1. With a slight abuse of
notation, we keep denoting with a double bar the corresponding flexible price allocation
with no capital controls. We denote with a double hat the gap of a variable from its flexible
price counterpart. We denote with a tilde a variable minus its mean across countries.
For example ỹit = ŷˆit − ŷˆ ∗t represents the deviation of country i’s output gap from the
corresponding aggregate.




                                                        80
Coordinated solution. The coordinated planning problem has the same constraint set
as (21) but a different objective
            ˆ       ∞ˆ 1             h                                                                                 i
        1                                                                                                        ˆ
                           e   −ρt
                                         απ (π̃ iH,t )2   + (ỹit )2   + (1 − α)αθ (θ̃ti )2   + απ (πt∗ )2         ∗ 2
                                                                                                             + (ŷt ) di dt.
        2       0     0


There are two differences with the objective in (21). First, the coefficient on the term 21 θ̂t2
is (1 − α)αθ instead of αθ . Second, there is no linear term in ŷˆ ∗t .
     As above we can break down the planning problem into two parts. First, there is an
aggregate planning problem determining the average output gap and inflation ŷˆ ∗t and
πt∗ . This aggregate planning problem has the same constraint set as (29) but a different
objective                        ˆ
                                1 ∞ −ρt h        ∗ 2     ˆ ∗ 2
                                                               i
                                      e    απ (πt ) + (ŷt ) dt,                        (35)
                                2 0
which features no linear term in ŷˆ ∗t . Second, there is a disaggregated planning problem
determining deviations from the aggregates for output gap, home inflation and consump-
tion smoothing, ỹit , π̃ iH,t and θ̃ti . This disaggregated planning problem has the same con-
straint set as (30) but a different objective
                               ˆ     ∞ˆ 1          h                                              i
                           1
                                               e−ρt απ (π̃ iH,t )2 + (ỹit )2 + (1 − α)αθ (θ̃ti )2 didt,
                           2     0         0


where the coefficient on 12 (θ̃ti )2 is (1 − α)αθ instead of αθ . We can obtain a relaxed problem
                                                     ´1                ´1
by dropping the two aggregation constraints 0 ỹit di = 0 and 0 π̃ iH,t di = 0. This relaxed
planning problem can be broken down into separate component planning problems for
each country i ∈ [0, 1]. This component    h planning problem has the samei constraint set as
                                  ´ ∞
(32) but with the objective 21 0 e−ρt απ (π̃ iH,t )2 + (ỹit )2 + (1 − α)αθ (θ̃ti )2 dt.


Uncoordinated solution. With no coordination, each country i ∈ [0, 1] takes the evo-
lution of aggregates as given and solves an uncoordinated component planning problem
which has the same constraint set as (32) but a different objective
            ˆ       h
      1
  min           e−ρt απ (π̃ iH,t )2 + 2απ πt∗ π̃ iH,t + (ỹit )2 + 2ŷˆ ∗t ỹit
      2
                                                                                                   2α i                          i
                                                                                              +       ỹt + (1 − α)αθ (θ̃ti )2 dt .
                                                                                                  1+φ

There are two differences with the objective in (32). First, the coefficient on (θ̃ti )2 is (1 −
α)αθ instead of αθ . Second, there is a linear term in ỹit . Intuitively, the extra linear term

                                                                          81
 2α i
1+φ ỹtcan be traced back to the fact that the that the uncoordinated solution feature terms
of trade manipulation. As a result the objective acquires a preference for lower output—a
form of anti-inflationary bias.
    Exactly as in the case where there is no coordination on the labor tax, a central mon-
etary authority, by setting monetary policy, can choose aggregates {ŷˆ ∗t ,πt∗ }t≥0 subject to
the following constraints. First, it must ensure that the solutions to the uncoordinated
                                          ´1                ´1
component planning problems satisfy 0 ỹit di = 0 and 0 π̃ iH,t di = 0. This amounts to
verifying a fixed point, that aggregates are actually equal to their proposed path. Sec-
ond, it must ensure that the aggregate Phillips curve is verified, π̇t∗ = ρπt∗ − κ̂ ŷˆ ∗t . Both
requirements define a set F 0 of feasible aggregate outcomes {ŷˆ ∗t ,πt∗ }t≥0 . Which aggregate
feasible outcome is chosen depends on the objective of the central monetary authority. For
example, we can examine the case where the central monetary authority seeks to maxi-
mize aggregate welfare, taking into account that capital controls are set uncooperatively.
For small α, this can be represented as a planning problem of minimizing (35) over the
feasible set F 0 .




                                               82
                      ŷ                                   πH
                                         0.2
 0.04
 0.02                                   0.15
    0                                    0.1
−0.02                                   0.05
−0.04
                                          0
        0    1    2        3   4   5           0   1   2        3   4   5
                      θ̂                                    ˆ
                                                           nx
                                        0.02
 0.04
 0.02                                   0.01
    0
−0.02                                     0
−0.04                               −0.01
        0    1    2     3      4   5      0        1   2        3   4   5
                 τ = i − i∗
  0.1
 0.05
    0
−0.05
−0.1
        0    1    2        3   4   5

            Figure 1: Permanent terms of trade shock, α = 0.4.




                                   83
                      ŷ                                   πH
 0.06                                    0.2
                                        0.15
 0.04
                                         0.1
 0.02
                                        0.05
    0                                     0
        0    1    2        3   4   5           0   1   2        3   4   5
                      θ̂                                    ˆ
                                                           nx
    0                                  0.006

−0.02                                  0.004

−0.04                                  0.002

−0.06                                     0
        0    1    2     3      4   5           0   1   2        3   4   5
                 τ = i − i∗
 0.02

 0.01

    0
−0.01
        0    1    2        3   4   5

            Figure 2: Permanent terms of trade shock, α = 0.1.




                                   84
                     ŷ                                   πH
0.004                                  0.04
0.003                                  0.03
0.002                                  0.02
0.001                                  0.01
    0                                    0
        0   1    2        3   4   5           0   1   2        3   4   5
                     θ̂                                    ˆ
                                                          nx
 0.01                              0.004
    0                              0.002
                                       0
−0.01                             −0.002
                                  −0.004
−0.02                                         0       2        3       5
        0   1    2     3      4   5               1                4
                τ = i − i∗
 0.02

    0
−0.02
−0.04
        0   1    2        3   4   5

    Figure 3: Mean-reverting natural interest rate shock, α = 0.4.




                                  85
                     ŷ                                   πH
0.004                                  0.04
0.003                                  0.03
0.002                                  0.02
0.001                                  0.01
    0                                    0
        0   1    2        3   4   5           0   1   2        3   4   5
                     θ̂                                    ˆ
                                                          nx
 0.02                                 0.004

    0                                 0.002

−0.02                                    0

−0.04                             −0.002
        0   1    2     3      4   5      0        1   2        3   4   5
                τ = i − i∗
 0.04
 0.02
    0
−0.02
−0.04
        0   1    2        3   4   5

    Figure 4: Mean-reverting natural interest rate shock, α = 0.1.




                                  86
                        ŷ                                   πH
                                           0.2
 0.04
 0.02                                      0.1
    0                                       0
−0.02                                    −0.1
−0.04
                                         −0.2
        0     1     2        3   4   5           0   1   2        3   4   5
                        θ̂                                    ˆ
                                                             nx
                                          0.02
 0.04
 0.02                                     0.01
    0
−0.02                                        0
−0.04                                    −0.01
        0     1    2     3       4   5           0   1   2        3   4   5
                  τ = i − i∗
  0.1
 0.05
    0
−0.05
−0.1
        0     1     2        3   4   5

            Figure 5: Mean-reverting productivity shock, α = 0.4.




                                     87
                        ŷ                                   πH
                                           0.2
 0.04
 0.02                                      0.1
    0                                       0
−0.02                                    −0.1
−0.04
                                         −0.2
        0     1     2        3   4   5           0   1   2        3   4   5
                        θ̂                                    ˆ
                                                             nx
    0                                    0.006

−0.02                                    0.004

−0.04                                    0.002

−0.06                                       0
        0     1    2     3       4   5           0   1   2        3   4   5
                  τ = i − i∗
 0.02
 0.02
 0.01
 0.01
    0
        0     1     2        3   4   5

            Figure 6: Mean-reverting productivity shock, α = 0.1.




                                     88
                        ŷ                                    πH
 0.2
                                          0.4
 0.1                                      0.2
   0                                        0
−0.1                                     −0.2
                                         −0.4
−0.2
       0     1      2        3   4   5           0   1     2    3      4   5
                        θ̂                                ˆ and nx
                                                         nx      ¯
   0                                       0.1
−0.1                                      0.05
−0.2                                         0
−0.3                                     −0.05
−0.4                                     −0.1
       0     1      2      3    4    5           0   1    2      3     4   5
                 τ = i − i∗ − ψ                           ŝ and s̄
 0.2                                       0.2
0.15                                       0.1
 0.1                                        0
0.05                                     −0.1
   0                                     −0.2
       0     1      2        3   4   5           0   1    2        3   4   5

           Figure 7: Mean-reverting risk premium shock, α = 0.4.




                                     89
                        ŷ                                    πH
 0.2
                                          0.4
 0.1                                      0.2
   0                                        0
−0.1                                     −0.2
                                         −0.4
−0.2
       0     1      2        3   4   5           0   1     2    3      4   5
                        θ̂                                ˆ and nx
                                                         nx      ¯
   0                                      0.04
−0.1                                      0.02
−0.2                                         0
−0.3                                     −0.02
                                         −0.04
−0.4
       0     1      2      3    4    5           0   1    2      3     4   5
                 τ = i − i∗ − ψ                           ŝ and s̄
 0.1                                       0.2
0.08                                       0.1
0.06
                                            0
0.04
0.02                                     −0.1
   0                                     −0.2
       0     1      2        3   4   5           0   1    2        3   4   5

           Figure 8: Mean-reverting risk premium shock, α = 0.1.




                                     90
                       ŷ                                   π                                  ĉ
   0.04                                  0.2                                0.04

   0.03                                 0.15                                0.03

   0.02                                  0.1                                0.02

   0.01                                 0.05                                0.01

     0                                    0                                   0
          0    1 2 3 4              5          0   1    2       3   4   5          0   1   2        3   4   5
               opp stim
               ĝ , ĝ , ĝ
     0


 −0.01


 −0.02

          0    1   2        3   4   5

Figure 9: Government spending for a permanent terms of trade shock, α = 0.4.




                                                       91
                            ŷ                                   π                                   ĉ
       0.004                                 0.04                                0.008

                                             0.03                                0.006
       0.002
                                             0.02                                0.004

           0                                 0.01                                0.002

                                               0                                    0
               0    1 2 3 4              5          0   1    2       3   4   5           0   1   2        3   4   5
                    opp stim
                    ĝ , ĝ , ĝ
           0

     −0.002

     −0.004

     −0.006

     −0.008
               0    1   2        3   4   5

Figure 10: Government spending for a mean-reverting natural interest rate shock, α = 0.4.




                                                            92
                        ŷ                                        π                                  ĉ
    0.04                                  0.15                                    0.04

                                           0.1
    0.02                                                                          0.02
                                          0.05

       0                                     0                                      0
                                         −0.05
           0    1 2 3 4              5           0   1        2       3   4   5          0   1   2        3   4   5
                opp stim
                ĝ , ĝ , ĝ
    0.01

       0

  −0.01

  −0.02

  −0.03
           0    1   2        3   4   5

Figure 11: Government spending for a mean-reverting productivity shock, α = 0.4.




                                                         93
