                              NBER WORKING PAPER SERIES




                       DISENTANGLING GLOBAL VALUE CHAINS

                                       Alonso de Gortari

                                      Working Paper 25868
                              http://www.nber.org/papers/w25868


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     May 2019




I am extremely grateful to Pol Antras, Elhanan Helpman, and Marc Melitz for their mentorship
and guidance. I especially thank Kirill Borusyak, Sebastian Fanelli, Guillermo Noguera,
Fernando Perez Cervantes, Zhi Wang, Kei-Mu Yi, seminar participants at Banco de Mexico,
Brown, Columbia, CREI, Dartmouth, ECARES, Georgetown McDonough, Harvard, IIES,
ITAM, Maryland, MIT, Michigan, Minnesota, Princeton, Rochester, UCSD, Yale, and
conference participants at the ETSG (Warsaw), FREIT (Sapporo), GVC Conference
(Nottingham), GVC Workshop (Beijing), NBER Economic Consequences of Trade, New Faces
in Trade (Penn State), SAET (Faro), SED (Mexico City), SEM (Xiamen), for very helpful
comments. I gratefully acknowledge the hospitality of Banco de Mexico, where part of this paper
was written. Finally, I thank Gurobi and Odyssey for making this project possible. All errors are
my own. The views expressed herein are those of the author and do not necessarily reflect the
views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2019 by Alonso de Gortari. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including ©
notice, is given to the source.
Disentangling Global Value Chains
Alonso de Gortari
NBER Working Paper No. 25868
May 2019
JEL No. C6,F1,F6

                                         ABSTRACT

The patterns of production underlying the recent rise of global value chains (GVCs) have become
increasingly complex. NAFTA supply chains, for example, are now deeply integrated: Using
Mexican customs data, I find that exports to the U.S. use a much higher share of American inputs
than exports to other countries. However, the conventional framework used to measure GVCs
ignores this heterogeneity since it assumes that all output uses the same input mix. I develop a
new framework that combines input-output data with additional information on supply chain
linkages in order to construct GVCs reflecting the use of inputs observed in the latter. Improving
measurement matters quantitatively since it affects both value-added trade measures and
counterfactual experiments: I show that incorporating Mexican customs data raises the estimated
share of U.S. value in U.S. imported Mexican manufactures from 18% to 30% and amplifies the
welfare cost of a NAFTA trade war.


Alonso de Gortari
Princeton University
Julis Romo Rabinowitz Building 223
Princeton, NJ 08540
alonso.degortari@gmail.com
1     Introduction
While writing this paper, the North American Free Trade Agreement (NAFTA) got renegotiated for the first
time since its 1994 inception, the United Kingdom discussed its exit from the European Customs Union,
and the United States and China sowed the seeds of a possible full-blown trade war. What are the potential
consequences of these policy changes? How do their effects propagate across country borders?
    I argue that quantifying the effects of economic shocks in a world of highly fragmented production
requires a more accurate and systematic understanding of the global value chains (GVCs) underlying world
trade than has so far been achieved. For example, conditional on the level of bilateral trade flows, a NAFTA
trade war has different consequences depending on how deeply integrated NAFTA supply chains are. From
the U.S.’s perspective, restrictions on Mexican imports ripple through the value chain and affect upstream
U.S.-based suppliers more when Mexican imports embody high U.S. content. In contrast, shocks pass
through more sharply to other countries when Mexican imports embody few U.S. inputs.1 Understanding
these effects thus hinges on properly measuring the GVCs linking production across countries.
    GVCs are measured, in practice, using multi-country input-output data and this requires taking a stand
on how to trace value across different stages of production. The conventional approach does this by as-
suming that all output, within each country-industry, is built with the same input mix. This assumption is
sharply at odds with the evidence on supply chain linkages based on richer micro-level datasets showing
that, in reality, the use of inputs depends on the downstream use of output. For example, while the con-
ventional approach assumes a common input mix in all Mexican vehicle production, figure 1 uses Mexican
customs microdata to show that the U.S. accounts for a colossal 74% of the foreign inputs embedded in
vehicles sold to U.S. consumers but for only 18% of the inputs of those sold to German consumers.
    This paper improves GVC measurement by leveraging information beyond that contained in input-
output data − such as customs data − in order to construct more precise value-added trade measures
and counterfactual estimates. The paper revolves around three main contributions. First, I develop a
GVC theory that tractably incorporates the heterogeneity in the use of inputs observed in figure 1 and
that provides a unifying framework for studying the literatures on GVC measurement, value-added trade,
and quantitative trade models. Second, I show that any input-output dataset is consistent with many
model parameterizations and develop numerical procedures for constructing bounds on value-added trade
and the welfare consequences of any counterfactual experiment. Third, I develop two new measurement
frameworks that leverage both input-output data and other sources of information to better capture the
supply chain linkages underlying world trade. The first measurement framework narrows the bounds on
value-added trade measures and counterfactual experiments and the second constructs more precise point
estimates than those based on the assumption that all output uses the same input mix.2
     1
       Mexico became the U.S.’s main trading partner in 2019. This makes U.S.-Mexico trade the largest bilateral trade flow across
any two countries of the world and totals over $600 billion annually.
     2
       Ultimately, the challenge surrounding GVC measurement is about aggregation and would (mostly) disappear in firm- or
product-level input-output datasets. However, current datasets are so highly aggregated that this is a major issue for both aca-
demic and policy work. For example, the widely-used WIOD features only 19 manufacturing industries. To put this into perspec-
tive, this means that 6 trillion dollars of U.S. manufacturing output is divided into only 19 categories. This issue is unlikely to
disappear anytime soon. First, most countries do not collect data on firm-to-firm trade. Second, building a multi-country firm-level
input-output database requires merging firm-level data across countries and faces considerable political and legal roadblocks.


                                                                 1
              Foreign Inputs in                                                    Foreign Inputs in
              Exports to the U.S.                                                 Exports to Germany

                             JPN
                                    DEU                                              USA                       JPN
                                       CAN
                               6% 4%
                                      3%                                                      18%        12%
                                               Other
                                       13%

                                                                                        24%
                     74%                                                   Other
                                                                                                        38%
                                                                                             8%
                                                                                                                    DEU
        USA                                                                           POL

         Figure 1: Distribution of Foreign Inputs Used in Mexican Final Good Motor Vehicle Exports to
         the U.S. and Germany: The shares are constructed using Mexican customs shipment-level data for
         2014; details are discussed in section 2.4.1. In contrast to these charts, the conventional approach
         for measuring GVCs assumes common input distributions across destinations.


    My main empirical result is that measuring GVCs while incorporating Mexican customs data roughly
doubles the share of U.S. value in U.S. imported Mexican manufactures and amplifies the U.S. welfare cost
of a NAFTA trade war. These results are in line with
                                                  1
                                                     Yi’s (2003) landmark study arguing that deep vertical
                                                                                                        2
specialization magnifies the effects of economic shocks and showcase how conventionally measured GVC
flows miss crucial elements present in today’s highly fragmented supply chains. More generally, any
question studied by the GVC literature can be revisited with these new measurement frameworks while
incorporating whatever additional information is both relevant and available in each context.
    I kick off in section 2 by developing a general GVC theory that can accommodate, with further assump-
tions, how different classes of microfounded models behave in equilibrium and their implications on GVC
measurement. This general theory is useful for two reasons. First, because it formalizes the connection
between the literature on value-added trade based on equilibrium theories of production and the litera-
ture on counterfactuals based on microfounded theories of production − two literatures that have evolved
mostly independently and in parallel. Second, because it formalizes the key insight underlying this paper:
That any input-output dataset is consistent with many different GVC networks. In particular, the gen-
eral GVC theory is useful for comparing how different equilibrium theories of production construct GVCs
from input-output data. For example, most trade models incorporate intermediate inputs by assuming that
technology features roundabout production in which all of a country-industry’s output is produced with
the same input mix.3 While microfoundations differ substantially, all roundabout models imply that GVCs
should be constructed recursively from input-output data using first-order Markov chains.
    I argue in favor of models featuring specialized inputs − models in which goods sold to different coun-
tries and industries are built with different input mixes. Specialized inputs models weaken the proportion-
    3
      Roundabout models come in many varieties, some examples include Krugman and Venables (1995), Eaton and Kortum (2002),
Balistreri et al. (2011), di Giovanni and Levchenko (2013), Bems (2014), Caliendo and Parro (2015), Ossa (2015), Allen et al. (2017).



                                                                 2
ality assumptions built into roundabout production models and instead imply that GVCs be constructed
using higher-order Markov chains.4 While roundabout models construct a unique GVC network out of any
given input-output dataset, specialized inputs models are consistent with many GVC networks. Crucially,
specialized inputs can incorporate the heterogeneity in figure 1 while roundabout production cannot.
    The case for specialized inputs is supported by both the anecdotal and empirical evidence on modern
supply chains in which input suppliers customize their goods to be compatible with specific downstream
uses and in which firms make complex decisions when deciding where to locate each stage of their supply
chain. For example, the lithium battery supplier in Apple’s famously long iPod supply chain manufac-
tures it exactly to the size of the metal frame while the screen supplier ensures that the touch, color, and
dimming capabilities are in line with Apple’s iOS software (Linden et al. 2011). Today, this form of input
specialization is ubiquitous (Rauch 1999, Nunn 2007, Antràs and Staiger 2012, Antràs and Chor 2013) and
implies that the use of inputs varies depending on the use of output since firms exporting to different coun-
tries and industries have different supply chains.5 As figure 1 illustrates, Mexican vehicle manufacturers
exporting to the U.S. rely heavily on U.S. supply chains while those exporting to Germany do not.
    Section 3 shows that the distinction between roundabout production and specialized inputs matters
because measures of globalization − i.e. measures quantifying the fragmentation of production such as
value-added trade (Hummels et al. 2001, Johnson and Noguera 2012, Koopman et al. 2014) or average
downstreamness (Antràs et al. 2012) − vary depending on how GVC flows are constructed from input-
output data. In particular, while the literature defines these measures directly with input-output analysis
(Leontief 1941), I define them broadly using the general GVC theory. This is useful because the former are
only consistent with the equilibrium of roundabout production models whereas the general theory can be
used to derive the correct measures for other equilibrium theories such as specialized inputs.
    I quantify the potential mismeasurement by constructing approximate bounds on value-added trade
using the specialized inputs model. I argue that this mismeasurement may be severely misguiding trade
policy since these debates, like the NAFTA renegotiation, are often based on measures of supply chain
integration such as the U.S. content returning home through Mexican imports.6 Higher shares are typically
interpreted as proxying higher costs of disruption − restricting Mexican imports ripple back and hurt the
U.S. more when it provides more value to these supply chains − and conventional (roundabout) estimates
put the U.S. value-added share in Mexican manufacturing imports at about 18%.7 In contrast, I show that
    4
      In equilibrium, specialized inputs can be thought of as a generalization of input-output analysis in which the expenditure
shares are conditional on both the purchasing country-industry and the subsequent supply chain through which inputs flow.
    5
      Various recent studies suggest that the use of inputs, within country-industries, depend on the downstream use of output.
For example, within-industry exports vary across destinations due to quality (Bastos and Silva 2010), trade regime (Dean et al.
2011), and credit constraints (Manova and Yu 2016). Likewise, the use of imports varies across firm size (Gopinath and Neiman
2014, Blaum et al. 2017a, 2017b, Antràs et al. 2017), multinational activity (Hanson et al. 2005), firm capital intensity (Schott 2004),
and the quality of output (Fieler et al. 2017). Further, recent research has made explicit connections between imports and exports
through quality linkages (Bastos et al. 2018), trade participation (Manova and Zhang 2012), and rules-of-origin (Conconi et al.
2018). Finally, production processes vary also in terms of the intensity of labor inputs. Processing trade firms export lower-cost
labor assembly goods (De La Cruz et al. 2011, Koopman et al. 2012) while firms exporting to richer countries hire higher-skilled
workers (Brambilla et al. 2012, Brambilla and Porto 2016). Thus, value-added shares also differ depending on the use of output.
    6
      For example, U.S. Secretary of Commerce Wilbur Ross argued in the Washington Post (September 21, 2017) that disrupting
Mexican-American supply chains was not worrisome since Mexican imports contained ‘only’ 16% of U.S. value-added (in 2011).
    7
      In contrast to figure 1, computing value-added trade requires tracing where value is created along all stages of production.



                                                                   3
the 2014 World Input-Output Database (WIOD) is consistent with bounds as low as 3% and as high as 52%
− that is, the data is consistent with both little and highly integrated Mexican-American supply chains.
    Analogously to value-added trade, section 4 shows that different GVC flows lead to different quanti-
tative counterfactual predictions. For the sake of clarity, and at the cost of generality, I illustrate this with
the simplest specialized inputs microfoundation − a perfect competition Armington model where each
country-industry produces a specific variety for each market. Since this model features specialized inputs,
many parameterizations fit the input-output data and this matters quantitatively because the welfare gains
from trade depend on the expenditure share on domestic inputs used in the production of domestically-
sold goods. In other words, mapping the model to different GVC networks delivers different counterfactual
estimates following any economic shock − even though all parameterizations replicate the same data in
the benchmark equilibrium. In particular, roundabout production is the knife-edge parameterization in
which welfare depends on the aggregate domestic expenditure share as in Arkolakis et al. (2012).8
    I quantify the potential mismeasurement by constructing bounds on counterfactual estimates using
the specialized inputs model − i.e. the GVC networks that minimize/maximize the gains from trade. For
example, the autarky bounds in the 2014 WIOD with a trade elasticity of 5 are wide and increasing in
trade openness: the U.S. gains (relatively closed) lie between 2.6-4.0% but the Taiwan gains (relatively
open) lie between 12-129%. Intuitively, the lower (upper) bounds correspond to GVCs in which many
(few) domestic inputs are used to produce domestically-sold goods. Meanwhile, the knife-edge roundabout
model where all output uses the same input mix predicts gains of 3.5% and 18%.9 Similar insights hold for
the case of general counterfactuals. For example, the roundabout hat algebra approach of Dekle et al. (2007)
implies that a NAFTA trade war in which the U.S. doubles import barriers on Mexican final goods decreases
welfare by 0.09% in the U.S. and 0.85% in Mexico. I show that the hat algebra approach can be extended
to specialized inputs and this delivers welfare bounds of 0.07-0.13% for the U.S. and 0.21-1.40% for Mexico.
The bounds are considerably large and are related to the importance of supply chain linkages across the
NAFTA region. Intuitively, the U.S. (Mexico) upper bound corresponds to GVCs in which Mexican final
goods use U.S. (Mexican) inputs intensively while the lower bounds correspond to the opposite case.
    In sum, the key message of sections 2, 3, and 4, is that many GVC networks are consistent with any
input-output dataset and that constructing bounds based on specialized inputs is useful for determining the
potential mismeasurement trickling over from the GVC flows to measures of globalization and quantitative
counterfactual estimates. Since all GVC networks exhaust the information contained in the input-output
data, the latter can shed no further light on which estimates are most accurate.
    Section 5 improves measurement by using readily available information − such as customs data − in
conjunction with input-output data. In a first approach, I impose this information as linear constraints on
the optimization problems to narrow the specialized inputs bounds. For example, while Mexican customs
data is silent regarding the share of foreign inputs relative to total inputs used in U.S.-bound car exports,
    8
       The sufficiency of input-output data for both measuring GVCs and quantifying the effects of economic shocks is intimately
linked to the roundabout assumptions. In the more general case of specialized inputs, however, this sufficiency no longer holds.
     9
       While these exercises rely on a specific class of microfoundations, I conjecture that richer models yield similar qualitative
implications. Other specialized inputs microfoundations include Yi (2003), Yi (2010), Costinot et al. (2012), Antràs and Chor (2013),
Fally and Hillberry (2016), Johnson and Moxnes (2016), Blanchard et al. (2017), Antràs and de Gortari (2017), and Oberfield (2018).



                                                                  4
it reveals that 74% of all foreign inputs are U.S. inputs. This effectively constrains the relative distribution
of foreign inputs and tightens the bounds on the U.S. content in Mexican imports from 3-52% to 5-35%.
    In a second approach, I use the customs data together with auxiliary assumptions to discipline a set of
targets in the objective function of a minimum-cost flow problem that searches over all GVCs consistent
with a given input-output dataset. This approach thus constructs the best informed guess of the true GVC
network while exploiting more information than that contained in input-output data and is useful when
the additional information is insufficient for measuring GVC flows directly. For example, since customs
data contains no information on domestic transactions, GVCs cannot be directly measured because there
is not enough information to convert the foreign input expenditure shares in figure 1 into overall input ex-
penditure shares.10 Measurement can still be improved in these situations by taking a stand on how to map
the additional information into expenditure shares with auxiliary assumptions. These shares will not, in
general, aggregate up perfectly to the input-output data since they rely on imperfect assumptions and this
is where the optimization problem becomes useful. The latter takes these shares as targets and reallocates
flows in order to construct the GVC flows closest to the researcher’s targets among all those consistent
with a given input-output dataset. In sum, while these GVCs ultimately still depend on some assumptions,
they are closer to the true GVCs underlying input-output data since they weaken the roundabout GVCs’
strong (theoretical) assumptions by using additional (empirical) information.
    Incorporating Mexican customs data reveals that Mexican-American supply chains are more integrated
and disrupting them is more costly than previously thought. Specifically, I map the customs data to the
optimization targets by taking the stand that Mexico only does processing trade − i.e. that exports use
only imported inputs. The GVCs based on this best-informed guess then imply that 30% of the value in
U.S. imported Mexican manufactures is U.S. value-added and not 18% as given by the roundabout GVCs.
In addition, the welfare costs of a NAFTA trade war are amplified (dampened) for the U.S. (Mexico) as
consequence of the increased (decreased) share of U.S. (Mexican) value-added in exports to the U.S.
    The two GVC measurement frameworks are easily adaptable and can incorporate additional informa-
tion in a practical manner. While large datasets on supply chain linkages are rarely available, researchers
often have access to partial snippets of the overall supply chains underlying global trade that are extremely
informative about how intermediate inputs are used. My application focuses on Mexico since I have access
to Mexican microdata, but the tools can be readily applied to study any other aspect of global production
networks with other datasets. Further, since most countries collect customs data, measuring GVCs in many
countries through this approach can be immediately done once access to this data is obtained.
    The paper’s structure is as follows. Section 2 provides the GVC framework used to compare the equi-
librium theories of roundabout production and specialized inputs in the three next sections. Section 3
studies value-added trade, section 4 studies counterfactuals, and section 5 studies GVC measurement. The
appendix provides additional results and details on numerical implementation.11
   10
       Directly measuring GVC segments requires very rich data such as datasets covering the universe of country-level firm-to-
firm transactions. However, these are quite rare. Belgian data is one exception (see Tintelnot et al. 2017, Kikkawa et al. 2017).
    11
       From a history of science standpoint, this paper is inspired by Samuelson (1952) who asked how to measure bilateral trade
flows in the presence of only aggregate export data. This paper takes the same idea to the next iteration: How to measure GVC
flows in the presence of only bilateral input-output data? From a philosophy of science standpoint, this paper is inspired by
Popper (1959) and argues for a falsifiable approach to GVC measurement. That is, instead of imposing the theoretically-based


                                                               5
2      The Hunt for GVCs: The Measurement Challenge
This section provides the GVC framework used throughout the paper to discuss measures of globalization,
counterfactuals, and measurement in a GVC world. I proceed in four steps. First, I describe the data con-
tained in multi-country input-output datasets. Second, I develop a general theory that provides notation
and a unifying framework for comparing specific theories of production − this will also prove useful for
deriving explicitly the connection between the literature on measures of globalization and the literature
on structural models and counterfactuals. Third, I use the general GVC theory to discuss this paper’s main
focus, the specialized inputs solution, and describe how it nests the conventional roundabout approach as
a special case. Fourth, and finally, I provide empirical evidence in favor of specialized inputs using Mexican
customs shipment-level data and U.S. domestic input-output tables.

2.1     Multi-Country Input-Output Data
Let J denote both the set and number of countries and K the set and number of industries. I define
S = J × K as the set and number of country-industries, with a generic element s ∈ S being a country-
industry denoted as s = {j, k} with j ∈ J and k ∈ K. Multi-country input-output datasets typically contain
data on bilateral intermediate input flows across two country-industry pairs, with X (s 0 , s) the dollar value
of intermediate inputs sold from country-industry s 0 to country-industry s, and final good flows between
a country-industry and consumers, with F (s 0 , j) the dollar value of final goods sold from country-industry
s 0 to consumers in country j. These are the basic building blocks from which all other aggregate moments
are built. For example, the gross output and gross domestic product of country-industry s 0 equal
                    X          X                                                  X
             GO s 0 =  X s 0, s +  F s 0, j ,                      GDP s 0 = GO s 0 −  X s, s 0 .
                                                                                             

                           s∈S               j∈J                                                s∈S


      There are currently various sources of multi-country input-output datasets such as those produced by
the World Input-Output Database Project (WIOD), the Global Trade Analysis Project (GTAP), the Institute
for Developing Economies (IDE-JETRO), the Eora Global Supply Chain Database (Eora MRIO), and the
OECD Inter-Country Input-Output Tables (ICIO). Each dataset has its own advantages and limitations and
the analysis in this paper can be readily applied to each. I focus throughout on the WIOD − the most
widely used dataset by the international trade literature − which is available in its 2016 release for J = 44
countries, K = 56 industries (19 in manufacturing), and for the years 2000-2014 (see Timmer et al. 2015).

2.2     A General GVC Theory
GVC flows constitute the key building blocks of this theory. Define G (·) as the dollar value of goods
flowing from an initial country-industry down through a specific ordered set of country-industries all the
way to final consumption. To fix ideas, suppose there is a single industry (i.e., S = J). Take three countries
j, j 0 , j 00 ∈ J. Then G (j 0 , j) denotes the dollar value of final goods sold from j 0 to j while G (j 00 , j 0 , j) is the
roundabout approach outright, I argue in favor of studying GVCs under initially broad sets of plausibly accurate GVCs obtained
through specialized inputs and to then refine these estimates as more information becomes available.


                                                              6
dollar value of intermediate inputs sold from j 00 to j 0 which j 0 uses as inputs for the final goods sold to j.
    More generally, intermediate inputs may be traded at a stage of production that is N ∈ N stages
upstream relative to the production of final consumption goods. I write a generic truncated GVC flow as
GN jN , jN−1 , . . . , j1 , j where the superscript N on GN (·) indicates the dimension of this function, i.e.
                             

N is the number of nodes previous to final consumption that are specified. Every node corresponds to a
country jn ∈ J ∀n and the n is only meant to indicate the node at which country jn is located. The flow
GN jN , jN−1 , . . . , j1 , j thus indicates the dollar value of inputs from jN sold to jN−1 , that jN−1 uses to
                             

produce new inputs sold to jN−2 , so on and so forth, until the goods arrive at j1 and are put into final goods
shipped and sold to consumers in j. Since using apostrophes is cumbersome with large N, in general I will
use the notation G1 j1 , j instead of G (j 0 , j) and likewise G2 j2 , j1 , j instead of G (j 00 , j 0 , j).
                                                                            

    The extension to a multi-industry world is immediate. GVCs can be defined generically as follows.

Definition 2.1. For any length N ∈ N, GN : SN × J → R+ is the function describing truncated GVC
flows leading to final consumption in countries in J through a sequence of N upstream stages of production
                              Q
given by an element of SN = N     n=1 S.

A generic GVC is GN sN , . . . , s1 , j and, as before, I refer to the elements of a country-industry pair as
                                       

sn = {jn , kn } with jn ∈ J the country and kn ∈ K the industry of sn ∈ S, where the n is only meant
to indicate the node of GN (·) at which sn is located. For example: a flow of length N = 1 could be
G1 s1 , j = G1 ({Mexico,cars} , U.S.), the sales of Mexican cars to U.S. consumers, while a flow of length
         

N = 2 could be G2 s2 , s1 , j = G2 ({U.S.,steel} , {Mexico,cars} , U.S.), the sales of U.S. steel in the form of
                             

intermediate inputs that are used exclusively by the Mexican car industry to produce final goods sold to
U.S. consumers. Analogously for any N ∈ N and any sequence of production in SN that produces a final
good eventually sold to consumers in some country in J.
     The measurement challenge embedded in this GVC theory is that the word truncated appears in def-
inition 2.1. Specifically, GN (·) is a truncated GVC because it only specifies the flow through N stages of
production even though its most upstream stage, sN , also uses inputs and the full chain of production
is characterized by a (potentially) infinite number of stages. Since GN (·) is unobserved in the data, the
challenge is to develop a theory of production − i.e. a reasonable set of assumptions − that links GVC
flows across different stages of production. That is, take an arbitrary GN sN , sN−1 , . . . , s1 , j . Since this
                                                                                                     

tells how many inputs are sold from sN to the sequence sN−1 → · · · → s1 → j then there has to be some
relation with the flow GN−1 sN−1 , . . . , s1 , j of inputs that sN−1 itself sells to this production sequence.
                                                 

    In its most general form, the only restriction I impose is that flows across different stages of production
must satisfy
                           X
                                  GN sN , sN−1 , . . . , s1 , j 6 GN−1 sN−1 , . . . , s1 , j .
                                                                                           
                                                                                                               (1)
                          sN ∈S

That is, the right-hand side denotes the value of intermediate inputs sold by sN−1 to be used through
the sequence in GN−1 sN−1 , . . . , s1 , j . The left-hand side denotes the total value of intermediate inputs,
                                          

across all sources sN ∈ S, sold to sN−1 and used down this same sequence of production. Imposing equa-
tion (1) thus implies that the total value of inputs purchased by sN−1 for a specific downstream sequence
of production need be less or equal than the value of the output that sN−1 itself produces for that sequence.

                                                           7
    This theory is general and can encompass most production processes. It relies only on the key restric-
tion that the value of output not fall as goods flow down the value chain. Whenever the value of output
increases, thus implying equation (1) holds with strict inequality, I say that value was added at the N − 1th
stage of production to the inputs purchased from stage N. For example, this theory assumes that
                             X
                                     G2 s2 , {Mexico,cars} , U.S. 6 G1 ({Mexico,cars} , U.S.) .
                                                                 

                             s2 ∈S

The right-hand side indicates the dollar value of Mexican cars sold to U.S. consumers and corresponds to
a truncated GVC flow because the Mexican car industry uses intermediate inputs produced further up-
stream to produce these cars. Meanwhile, G2 ({U.S.,steel} , {Mexico,cars} , U.S.) is the dollar value of U.S.
steel bought as inputs directly in order to produce these exports, so that the summation across all pos-
sible input sources s2 ∈ S yields aggregate input sales to the downstream sequence on the right-hand
side. The inequality holds strictly if the Mexican car industry adds domestic value-added directly into the
intermediate inputs purchased from the previous stage of production.
    I refer to equation (1) as the GVC challenge which can only be solved by taking a stand on how to trace
value across stages of production. That is, on how GN sN , sN−1 , . . . , s1 , j and GN−1 sN−1 , . . . , s1 , j
                                                                                                               

relate to each other across all stages and sequences of production.12

2.2.1    Relation to Multi-Country Input-Output Data

GVC flows are not observed directly in input-output data. Rather, the data contains only some (non-
exhaustive) information about the true GVCs. Disentangling GVCs from the data then requires using an
equilibrium theory of production in order to fill in with assumptions whatever information is not available.
    I now describe the information that is available in input-output data. The first thing to note is that the
data provides precise information about the last stage of production. Hence, the simplest GVC flows, those
with N = 1, are observed and final good flows can be defined in terms of GVCs as

                                                     F s 0 , j = G1 s 0 , j .
                                                                          
                                                                                                                                 (2)

This mapping is the basic building block from which all theories of intermediate input trade will build
upon since this is the only part of the supply chain that is observed directly in input-output data.
    Second, bilateral intermediate input flows are much more complicated since they aggregate the dollar
value of inputs traded across two country-industries across all stages of the supply chain. The relation
between these aggregate flows and GVC flows is given by
                                           ∞
                                           X X                 XX
                                 0
                                                                           GN s 0 , s, sN−2 , . . . , s1 , j .
                                                                                                           
                           X s ,s =                      ···                                                                     (3)
                                          N=2 sN−2 ∈S          s1 ∈S j∈J

   12
      Two further comments about the interpretation of GN (·). First, GVCs can be interpreted directly as firm-level supply chains
by fixing K as the set of firms instead of the set of industries. Second, though the paper is written in terms of a static production
world where all goods are produced simultaneously, this theory can also accommodate dynamic models since s can be interpreted
as a country-industry-time triple in which inputs of past periods flow down the value chain to be used as inputs in future periods.



                                                                  8
The flow GN (·) is the input value from s 0 sold to s at the Nth stage of production and used through the
downstream sequence sN−2 → · · · → s1 → j. Summing up across sN−2 ∈ S, …, s1 ∈ S, j ∈ J thus delivers
the aggregate input value from s 0 sold to s at the Nth stage of production used across all downstream
sequences of production. The first summation across N > 2 then sums up the input value traded across
all stages of production. This aggregate value thus equals the input flows reported in input-output data.
     Hence, while input-output data provide precise information on X (s 0 , s) and F (s 0 , j), disentangling the
GVC flows GN sN , . . . , s1 , j across all upstream production stages N > 2 requires further assumptions
                                

since a lot of the information is potentially lost in the aggregation into bilateral input flows in (3).

2.3     The Specialized Inputs Solution
Disentangling GVCs in the presence of intermediate input trade is a hard task since, in principle, many
theories of production can solve the GVC challenge in (1). Importantly, constructing a GVC network out of
input-output data only requires specifying how GVCs behave in equilibrium and not on how such equilib-
rium was achieved. While microfoundations vary substantially, for the purposes of GVC measurement the
specific microfoundation can be ignored and all that matters is how the theory implies that value be traced
across stages of production in equilibrium. Of course, computing counterfactuals does require unpacking
a microfoundation and this will be done in the further downstream sections.
      I propose the following specialized inputs solution to resolve the measurement challenge in (1). The
key assumption is that the use of inputs depends on the destination and use of output, both in terms of
whether goods are sold as final goods or intermediate inputs and to which industry in the latter case.
Starting from the observed GVC G1 s1 , j , the input flow used directly for the production of final goods is
                                        

given by
                                      G2 s2 , s1 , j = aF s2 s1 , j F s1 , j ,
                                                                          
                                                                                                               (4)

where aF (s 00 |s 0 , j ) is the share of inputs from country-industry s 00 used in the final goods produced by
country-industry s 0 that are sold to consumers in market j. Similarly, the mapping into previous stages is
given by assuming that the use of intermediate inputs in the production of new intermediate inputs equals

             GN sN , sN−1 , . . . , s1 , j = aX sN sN−1 , sN−2 GN−1 sN−1 , . . . , s1 , j , ∀N > 3,
                                                                                       
                                                                                                               (5)

where aX (s 00 |s 0 , s ) is the share of inputs from country-industry s 00 used in the production of intermediate
inputs by country-industry s 0 sold to country-industry s. Note that while the intermediate input shares
depend on the destination and use of inputs, they are common across all stages of production. That is, the
input mix used to produce inputs in s 0 and sold to s is the same in all production stages N > 2.
      In this context, value-added shares also depend on the destination and use of output and are given by
                            X                                                 X
           βF s 0 , j = 1 −   aF s 00 s 0 , j > 0,           βX s 0 , s = 1 −   aX s 00 s 0 , s > 0.
                                                                                            

                            s 00 ∈S                                              s 00 ∈S

These shares have to be greater or equal than zero given the assumption in (1) that the dollar value of
output never falls as goods flow along the value chain. Further, at least one of these shares has to be


                                                         9
strictly positive since GDP in every country-industry s 0 in the data is positive.
    In practice, there are many different sets of input shares that perfectly fit the data (i.e. many GVC
networks replicate the same bilateral trade, gross output, and gross domestic product flows). To see this,
substitute in the specialized inputs solution in (4) and (5) into the set of linear constraints relating GVC
flows to the observed input-output data in (3) and rearrange to obtain
                                         X                           X
                            X s 00 , s 0 =  aX s 00 s 0 , s X s 0 , s +  aF s 00 s 0 , j F s 0 , j .
                                                                                                
                                                                                                                                 (6)
                                                s∈S                                        j∈J


In words, the right-hand side sums up all the intermediate inputs from s 00 used by s 0 to produce further
downstream inputs sold to all s ∈ S and final goods sold to all j ∈ J. Since this is the total value of inputs
sold from s 00 to s 0 , it has to equal the observed flow X (s 00 , s 0 ).13
   Since all of the information in input-output data is contained in X (s 0 , s) and F (s 0 , j), any set of input
shares aX (s 00 |s 0 , s ) and aF (s 00 |s, j ) satisfying (6) for all bilateral pairs characterize a system of GVC flows
that perfectly fit the observable data. Crucially, fitting the data requires imposing S × S restrictions but
the specialized inputs GVC network depends on S × S × (S + J) input shares. These degrees of freedom
imply that there are many different GVC networks that replicate the same observable data.
    This specialized inputs solution nests the standard approach used by the literature to disentangle GVCs.
Specifically, both the literature on counterfactuals and the literature on measures of globalization have
largely focused on the roundabout solution in which the GVC challenge is solved by assuming that every
single dollar of output within each country-industry is produced using the exact same input mix. That is

                                  GN sN , sN−1 , . . . , s1 , j = a sN sN−1 GN−1 sN−1 , . . . , s1 , j ,
                                                                                                    
                                                                                                                                 (7)

for all N > 2. Crucially, note that this roundabout solution is nested in the specialized inputs solution and
corresponds to the knife-edge case in which aX (s 00 |s 0 , s ) = aF (s 00 |s 0 , j ) = a (s 00 |s 0 ) ∀s ∈ S and ∀j ∈ J.
    The roundabout equilibrium theory of production is a very special solution to the GVC challenge since
it corresponds to the case in which GVCs are fully and uniquely characterized by the input-output data
with the input expenditure shares given by the aggregate value of inputs purchased relative to the produced
gross output. To see this note that from (6)
                                                                                             
                                                          X                  X                                 X (s 0 , s)
               X s 00 , s   0
                                  = a s 00 s    0
                                                                X s 0, s +           F s 0, j  ,   ⇒ a s 0 |s =
                                                                                          
                                                                                                                           .    (8)
                                                                                                                 GO (s)
                                                          s∈S                j∈J

   13
        This is obtained as follows. Substituting (4) and (5) into (3) delivers

                              X ∞  X        X       X        XX Y
                                                                     "N                    #
                     00 0                                                       n n−1 n−2
                                                                                                                   
                 X (s , s ) =                            ...                aX s s , s       a F s 2 s1 , j F s 1 , j .
                                   N=2 sN ∈s 00 sN−1 ∈s 0 sN−2 ∈S   s1 ∈S j∈J    n=3


This expression is tedious but straightforward and sums up the inputs sold by s 00 to s 0 across all stages and chains of production.
Conditional on N, the first two stages of the sequence are sN = s 00 and sN−1 = s 0 (I abuse notation slightly by indicating
summations over single-valued sets). The subsequent summations sum up the use of inputs across all downstream sequences of
production sN−2 ∈ S, . . . , s1 ∈ S, j ∈ J, while the summation over N > 2 sums up the exchange of inputs across all production
stages. Leveraging the recursive structure of the specialized inputs solution assumed in (5) delivers the succinct expression in (6).



                                                                                10
Since gross output is larger than aggregate input purchases, this also implies that every dollar of output of
                                                                     P
s has an equal share of domestic value-added given by β (s) = 1 − s 0 ∈S a (s 0 |s ) = GDP (s) /GO (s).
    The roundabout solution is currently the most popular approach for incorporating intermediate in-
puts into structural models of international trade (see footnote 3).14 In particular, it is so highly tractable
that the measurement problem regarding how to disentangle GVCs is completely eliminated as long as
one has input-output data at hand.15 In other words, any roundabout microstructure has GVCs that can
be characterized, in equilibrium, by the mapping in (7) and is thus equivalent to input-output analysis
(Leontief 1941) − a measurement framework fully characterized by input-output data and with no degrees
of freedom.16 Importantly, though, while input-output analysis is defined directly as the set of technical
coefficients in (8), I derived these input shares from first principles in the sense that I imposed assumptions
on the mapping of GVCs across different stages of the value chain in (7) and then derived the input shares
as an implication. This latter approach is more useful since it can be used to compare the implications of
imposing different assumptions, such as specialized inputs, on the GVC challenge in (1).17

2.3.1    Taking Stock

Throughout this paper I study the implications of modeling GVCs through the lens of the specialized inputs
solution while comparing the results to those obtained from the benchmark roundabout GVCs. This com-
parison requires making an important conceptual shift regarding how input-output datasets are typically
interpreted. Since the roundabout GVCs fit the data perfectly in a unique way, working with these flows
implicitly implies assuming that further disaggregating the data would yield no additional insights or infor-
mation. In contrast, the specialized inputs solution fits the data perfectly in many ways and thus implicitly
assumes there is important information hidden by the aggregation present in input-output datasets. This
paper’s exercises are thus concerned with using the specialized inputs solution to systematically under-
stand the implications of such aggregation in currently available input-output datasets.
    As a final comment, note that there are many other possible solutions to the GVC challenge in (1)
that can be used to study the rich supply chain patterns underlying input-output tables. For example, a
previous draft of this paper studied GVCs through a less stringent lens in which, for a any given positive
    14
       It is also enormously influential beyond trade. Roundabout production has been widely used ever since Samuelson (1951)
provided the key insight that input-output analysis is consistent with the equilibrium of a constant returns to scale production
economy. For example, it has been used in the macroeconomics literature following the seminal input-output models of Domar
(1961), Hulten (1978), and Long and Plosser (1983) to study business cycles (Basu 1995), growth (Jones 2011), misallocation (Jones
2013, Bigio and La’O 2016, Caliendo et al. 2017), aggregate fluctuations (Acemoglu et al. 2012, Carvalho and Gabaix 2013, Carvalho
2014, di Giovanni et al. 2014, Baqaee 2014, Baqaee and Farhi 2017), and development accounting (Bartelme and Gorodnichenko
2015, Cuñat and Zymek 2017). As the GVC literature, these papers can be extended to specialized inputs.
                                                                                                        Q
    15
       Formally, the data fully and uniquely characterizes roundabout GVCs since GN sN , . . . , s1 , j = Nn=2 a (s |s
                                                                                                                   n n−1
                                                                                                                            ) F (s1 , j) .
    16
       Input-output analysis is typically described using matrix algebra. Imposing the GVC mapping in (7) on the definition of
bilateral intermediate input flows in (3) and using matrix algebra implies that X = aF + a2 F + · · · = a [I − a]−1 F, where
GO = [I − a]−1 F is gross output and [I − a]−1 is known as the Leontief inverse matrix.
    17
       An even more extreme set of assumptions than the roundabout solution is to assume that GVC linkages are nonexistent.              I
call this the ‘only trade in final goods’ solution which solves the GVC challenge in (1) by assuming GN sN , sN−1 , . . . , s1 , j = 0
                                                                                                                                  

for all N > 2. This is only consistent with the data if X (s 0 , s) = 0, which is obviously not true in current datasets since over
two-thirds of world trade is in intermediate inputs. Nonetheless, these restrictions were still widely imposed even a few decades
ago as can be seen in the Armington model of Anderson (1979) and the Ricardian model of Dornbusch et al. (1977).




                                                                   11
integer M, the GVC solution was resolved through

                   GN sN , sN−1 , . . . , s1 , j = aX sN sN−1 , . . . , sN−M GN−1 sN−1 , . . . , s1 , j ,
                                                                                                     


for all N > M. This corresponds to a richer form of input specialization in which the use of inputs depends
not only on the immediate downstream use of the input, but on the M − 1 further downstream stages.18
Formally, this approach builds GVCs recursively using Mth order Markov chains and the above specialized
inputs and roundabout solutions correspond to the special cases of 2nd and 1st order Markov chains. This
generality, however, comes at a considerable cost in dimensionality since it requires SM+1 intermediate
input expenditure shares and so I focus on the latter relatively low-dimensional cases. Furthermore, note
that while specialized inputs generalizes the roundabout solution, it still features a flavor of roundabout
production in that aX (s 00 |s 0 , s ) is common across all stages of production. This need not be the case since
one could move beyond recursive GVCs by assuming input shares that vary across stages of production and
with, perhaps, finite GVCs in which output at some stage N > 1 consists entirely of domestic value-added.
      Throughout this paper I focus on the specialized inputs solution since it is, in my view, the most
natural and both analytically and computationally tractable way of generalizing the roundabout solution
in order to account for the patterns observed in figure 1. But the reader should keep in mind that this GVC
framework can be used to study many other ways of disentangling GVCs in future research.

2.4       Evidence for Specialized Inputs
The empirical evidence in favor of specialized inputs has been steadily accumulating over the last couple of
years (see footnote 5). On the intermediate input side, Manova and Zhang (2012) found that large Chinese
firms export to more countries and use inputs from more source countries than small firms while Bastos
et al. (2018) showed that Portuguese firms selling to richer countries export higher quality products built
with higher quality inputs. On the value-added side, Brambilla et al. (2012) and Brambilla and Porto (2016)
discovered that Argentinian firms exporting to richer countries hire relatively more skilled workers and
pay higher wages while Koopman et al. (2012) and Kee and Tang (2016) established that Chinese processing
trade firms use less domestic value-added than non-processing trade exporting firms. These facts imply
that both the use of intermediate inputs and value-added varies at the country-industry level depending
on the use of output in a variety of settings. I now provide further evidence for Mexico and the U.S.

2.4.1      Evidence from Firm-Level Data

The case for specialized inputs is supported by Mexican customs data. Specifically, I use the universe of
import/export shipments in 2014 to show that the use of inputs varies in exports to different markets. I
proceed in three steps. First, for each firm I construct its aggregate input purchases from and exports to
each country. Second, I assume that all output within each firm is produced using the same input mix
and obtain the dollar value of imports from each country used in the exports to each country at the firm-
   18
        All of this paper’s results can be generalized to this setting and are available upon request.




                                                                   12
                   Chemicals                          Computers, Electronics                            Electrical
    USA     54      69      38      38        USA     15      22       7      12        USA     49      10      16      33

    CHN     17       5      16       2        CHN     43      39      38      32        CHN     22      25      31      8

    CAN      2       0       3       0        CAN      1       2       1       1        CAN     1       0       1       4

    DEU      3       3       5      42        DEU      1       1       1       4        DEU     3       14      2       21

   ROW      24      23      38      18       ROW      40      36      53      51       ROW      25      51      50      34

           USA     CHN     CAN     DEU               USA     CHN     CAN     DEU               USA     CHN     CAN     DEU

                 Food, Tobacco                               Machinery                               Motor Vehicles
    USA     64      69      58      47        USA     57      39      54      19        USA     74      69      46      18

    CHN      2       5       2       5        CHN     17      14      12      24        CHN     3       3       5       3

    CAN      3       4       4       7        CAN      3       1       5       2        CAN     3       6       5       2

    DEU      2       2       1       2        DEU      3      10       3      16        DEU     4       6       9       38

   ROW      29      20      35      39       ROW      20      36      26      39       ROW      16      16      35      39

           USA     CHN     CAN     DEU               USA     CHN     CAN     DEU               USA     CHN     CAN     DEU

                 Other Transport                               Textiles                               Wood, Paper
    USA     80      12      22      50        USA     70      10      56       5        USA     71      24      29      33

    CHN      3      70       2       5        CHN     11      62      12      62        CHN     12      52      8       12

    CAN      5       0      12       0        CAN      1       0       5       0        CAN     1       0       22      0

    DEU      1       1      10      14        DEU      1       0       5       5        DEU     1       1       1       28

   ROW      11      17      54      31       ROW      17      28      22      28       ROW      15      23      40      27

           USA     CHN     CAN     DEU               USA     CHN     CAN     DEU               USA     CHN     CAN     DEU

          Figure 2: Foreign Input Shares in Mexican Manufacturing Exports Across Destinations: Each chart
          presents the share of foreign inputs sourced from Mexico’s four main trade partners and a rest of
          world remainder (y-axis) used in Mexico’s manufacturing exports to each of its four main trade
          partners (x-axis). That is, cells across rows within each column sum up to 100%. The shares are
          constructed using Mexican customs shipment-level data and these nine manufacturing industries
          account for 95% of Mexico’s final good manufacturing exports. In contrast, assuming the round-
          about solution at the industry-level implies common input distributions across export destinations.


level.19 . Third, I take all of the firms within a manufacturing industry and compute the aggregate value of
imports from a given source used in the exports to a given destination. This delivers the distribution of
foreign inputs used in exports to each destination market − which should be common across markets if
the roundabout solution were accurate at the industry-level.20
    Figure 2 confirms the prevalence of specialized inputs in Mexican manufacturing final good exports at
the level of aggregation consistent with typical multi-country datasets.21 Specifically, each column in each
   19
       This assumption is strong in multi-product firms where different goods likely use different inputs. However, imposing a
common input mix within the firm is weaker than imposing it within industries; Ludema et al. (2018) take the same approach.
    20
       Customs data does not contain domestic purchases so value-added shares cannot be measured at the firm-level and this
analysis also rests on assuming common value-added shares across firms within an industry. Imposing the roundabout solution
at the industry-level also assumes this and so, in this respect, this analysis is just as restrictive as the conventional approach.
    21
       The latter is an important point since one could define different firms as different manufacturing industries and then the


                                                                13
chart plots the share of foreign inputs sourced from Mexico’s four main trade partners − the U.S., China,
Canada, and Germany − and a rest of world remainder used in exports to each of these markets. In other
words, the cells across a column represent the distribution of foreign inputs used to produce a specific
type of manufacturing exports and add up to 100%. For example, motor vehicles is Mexico’s main export
industry and the corresponding chart shows that the use of inputs in exports to the U.S. and Germany
differ substantially (i.e. these are the distributions in figure 1).
    Overall, figure 2 shows substantial heterogeneity in input shares in sales to different destinations and
reveals interesting patterns. In particular, the U.S. tends to have an outsized role as input supplier in
the exports that return to its own market − thus confirming the widely-available anecdotal evidence that
Mexico-U.S. trade is based heavily on goods that cross the border back and forth. Sections 3 and 5 will show
this translates into a high share of U.S. content in U.S.-bound exports through richer empirical analysis
that traces where value is created across all stages of the value chain.

2.4.2    Evidence from Disaggregate Domestic Input-Output Tables

The case for specialized inputs is also supported by domestic input-output tables. Specifically, the U.S.
Bureau of Economic Analysis reports data for the year 2007 at a level of disaggregation of both 389 and
71 industrial categories (roughly 6- and 3-digit NAICS codes). This data is useful because it can help study
whether the use of inputs − at the industry-level − varies depending on the industry to which output is sold
to. I conduct the following thought experiment: Compare the input shares of the 6-digit industries bundled
into single 3-digit industries. If only 6-digit industries with common input mixes are bundled together then
there is no aggregation issue. If not, then the roundabout solution at the 3-digit is misspecified.
    Figure 3 illustrates the aggregation issue in the 3-digit computers and electronics industry. The latter is
composed of twenty 6-digit industries − the five largest are semiconductors, navigation instruments, elec-
tronic computers, communication equipment, and other electronics − while its four largest input suppliers
are other electronic components, semiconductors, broadcast and wireless communication equipment, and
computer storage devices. Figure 3’s left panel shows that imposing the roundabout solution at the 3-digit
implies all 6-digit subindustries use the same input and value-added mix. Figure 3’s right panel, however,
uses the disaggregate 6-digit data to show that input shares vary substantially within each subindustry.
For example, computer storage devices are used intensively in electronic computers (14.9% of output value)
but only marginally in other subindustries; in contrast, the left chart assumes a common 2.4% share.22 Ap-
pendix section A.1 shows that similar patterns hold across all U.S. manufacturing industries in that there
is substantial heterogeneity in input shares across sales to different industries. This exercise motivates
the use of the specialized inputs solution when studying multi-country input-output tables since these are
typically available at an industrial classification level similar to the 3-digit NAICS.
distribution of inputs used in exports to different destinations would be common by construction since I have assumed a com-
mon use of inputs within the firm. However, the charts in figure 2 are presented at the relevant level of aggregation since, for
example, manufacturing flows in the WIOD are available for only 19 aggregate manufacturing industries. Going forward, while
multi-country datasets are likely to become more disaggregate over time it is unlikely that these datasets become available at a
disaggregate enough level to be consistent with the roundabout solution at the industry-level anytime soon (see footnote 2).
    22
       Note that what matters is the relative difference in shares across columns; the shares in levels are low since there are 389
6-digit industries. Also note that, in contrast to figure 2, these are shares of output value and thus include a row for value-added.


                                                                 14
                   Imposing Roundabout Production on 3-Digit Data                                                                  True 6-Digit Input Shares
                          Implies These 6-Digit Input Shares
     Other electronic
                      1           4.4            4.4           4.4            4.4            4.4                   1       1.0            5.7            1.0            3.8            8.2
      components

         Semiconductors 2         3.5            3.5           3.5            3.5            3.5                   2       4.4            1.5            6.3            1.5            1.4

       Broadcast and
                     3            2.8            2.8           2.8            2.8            2.8                   3       0.1            1.5            0.0           19.5            0.3
    wireless comm. eq.

     Computer storage4            2.4            2.4           2.4            2.4            2.4                   4       0.0            1.3           14.9            0.3            0.0
        devices

     Inputs from 385 5           34.2           34.2          34.2           34.2           34.2                   5      48.5           33.7           54.1           25.1           62.0
     other industries

          Value-added 6          52.7           52.7          52.7           52.7           52.7                   6      46.0           56.3           23.7           49.8           28.1

                                   1rs             2t.           3 rs            4 eq.            5 ics                    r1s              2t.             3rs             4eq.          5 ics
                            u   cto            n ins          p ute         t i on            t ron                  u cto             n ins            p ute          t ion            tron
                         nd                  o              m             a                 c                      d                 o               om              a                c
                       co                ati             co         un
                                                                       ic
                                                                                      re
                                                                                         le
                                                                                                             ico
                                                                                                                 n               ati            t. c           un
                                                                                                                                                                  ic
                                                                                                                                                                                re
                                                                                                                                                                                   le
                    mi               vig             ct.                          the                                        vig           lec                              the
                  Se             Na              Ele           o mm             O                       S em            Na               E               o mm              O
                                                            C                                                                                          C

             Figure 3: Implied and True Input and Value-Added Shares Within the Computer and Electronics
             Industry: Each chart presents the expenditure share on the top four input suppliers, the other 385
             input suppliers, and value-added (y-axis) in the production of the top five subindustries (x-axis).
             The left chart plots shares implied by imposing the roundabout solution on the aggregate 3-digit
             industry computer and electronics while the right panel plots the true shares using the disaggregate
             6-digit data. Data is from 2007 U.S. input-output tables from the Bureau of Economic Analysis.


     Overall, while further disaggregating input-output tables is a key avenue for improving GVC measure-
ment, this paper’s main argument is that there is a lot of currently available data − such as customs −
that can already be used to improve GVC measurement even though it cannot be used to explicitly break
up input-output tables.23 Section 5 develops two methods for doing so. The next two sections lead to the
section on measurement by first building the argument for why measuring GVCs accurately matters so
much for understanding global trade in a world of highly fragmented production.


3        GVCs and Measures of Globalization
A first strand of the GVC literature is concerned with developing measures that better capture the extent of
fragmentation of production across borders and stages of the supply chain than those based on traditional
gross trade flow statistics. The most influential measures are those based on value-added trade (Hummels
et al. 2001, Johnson and Noguera 2012, Koopman et al. 2014, Wang et al. 2013), which capture where value is
created rather than where value is shipped from, and those based on upstreamness (Fally 2012, Antràs et al.
2012, Antràs and Chor 2013), which capture a country’s average position along the value chain. Without
being exhaustive, the literature has also developed measures to capture the factor content of trade (Trefler
and Zhu 2010), value-added exchange rates (Bems and Johnson 2017), international inflation spillovers
(Auer et al. 2017), and business cycle synchronization (di Giovanni and Levchenko 2010, Johnson 2014b,
    23
     The issue of aggregation in input-output data motivated an important literature in the 1950’s with several papers developing
conditions under which aggregation is innocuous. The outlook on whether they might hold in practice was grim, though. In the
words of Hatanaka (1952) and McManus (1956), “There is very little chance that they will be fulfilled by any model”.


                                                                                             15
Duval et al. 2016, di Giovanni et al. 2017). I refer to these generically as measures of globalization.
      This section shows that measures of globalization vary substantially across GVC networks built from
the same input-output dataset. For clarity, I focus on value-added trade decompositions but the same ideas
hold generally. I proceed in three steps. First, I show that any measure of globalization can be defined using
the general theory of GVCs from section 2. This contrasts with the conventional approach which defines
these measures directly with the roundabout solution. The more general definition proves useful since this
permits the comparison of different equilibrium theories of production in terms of their implications on
these measures. Second, I show how to construct bounds on value-added when imposing the specialized
inputs solution. Third, and finally, I use the WIOD to construct the bounds on the share of U.S. value-added
in imported Mexican final goods and find they are very wide. This suggests that conventional roundabout
value-added estimates may be highly mismeasured.

3.1     Decomposing Value-Added Trade
Decomposing final good consumption into where value-added is produced is useful for understanding how
final consumption in some country, say the U.S., is linked to the production of another, say China, through
final good exports of a third country, say Mexico. Further, this decomposition is useful for constructing
value-added trade imbalances such as the difference between the aggregate flow of, say, Chinese value-
added consumed in the U.S. arriving through final good exports of any country and the total U.S. value-
added that is eventually consumed in China. More specifically, in the most general form, the value-added
from s 00 that arrives through final good exports of s 0 and is consumed in country j is defined as
                                                                                   
                                                          X
  VA s 00 s 0 , j = 1[s 00 =s 0 ] G1 s 0 , j −                   G2   s2 , s 0 , j 
                                                                                 

                                                          s2 ∈S
                                                                                                                                             (9)
            ∞
            X X                 X                                                       X
                                        GN−1 s 00 , sN−2 , . . . , s2 , s 0 , j −              GN   sN , s 00 , sN−2 , . . . , s2 , s 0 , j  .
                                                                                                                                           
        +                 ···
            N=3 sN−2 ∈S         s2 ∈S                                                   sN ∈S


The first term imputes value-added created directly at the assembly stage, appearing only if s 00 = s 0 , while
the remaining terms impute value-added created by s 00 at all further upstream stages of production and
which eventually arrives, through any possible sequence, to s 0 to be shipped to consumers in j.
      Value-added trade can be rewritten in terms of a model’s equilibrium GVC network once one takes a
stand on the equilibrium theory of production solving the GVC challenge in (1). To exemplify this, I show
how this decomposition simplifies when assuming the specialized inputs solution in (4) and (5). To make
the exposition clearer, I derive the decomposition separately for the value-added created at each upstream
stage N. First, the value created by s 00 at the most downstream stage N = 1 embedded in the final good
sales of s 0 to j equals
                                            VA1 s 00 s 0 , j = 1[s 00 =s 0 ] βF s 0 , j F s 0 , j ,
                                                                                               
                                                                                                                                            (10)

where the superindex on VA is meant to index the stage at which this value is produced. Clearly, since the
most downstream stage is that of final production, s 00 adds value to the final good sales of s 0 if and only


                                                                        16
if s 00 = s 0 , and the decomposition is given by the share of value-added βF (s 0 , j) in each dollar of output
times the sales of final goods. Second, the value-added generated at the N = 2 upstream stage is given by

                                     VA2 s 00 s 0 , j = βX s 00 , s 0 aF s 00 s 0 , j F s 0 , j ,
                                                                                            
                                                                                                                                      (11)

and equals the intermediate input value-added share times the level of inputs from s 00 used in final good
sales from s 0 to j. Third, and finally, the value-added created at any further upstream stage N > 3 equals

                                X           X                     Y
                                                                  " N                                    #
              00    0                                00
      N                                                    N−1                 n       n−1        n−2
                                                                                                             aF s2 s 0 , j F s 0 , j , (12)
                                                                                                                                 
 VA       s        s ,j =             ...       βX s , s                aX s       s         ,s
                              sN−1 ∈S   s2 ∈S                     n=3


with sN = s 00 and s1 = s 0 . Hence, the total value-added of s 00 embedded in final good sales of s 0 to j is
given by the sum of value-added by s 00 created at all stages of production
                                                              ∞
                                                            X
                                            VA s 00 s 0 , j =   VAN s 00 s 0 , j .
                                                                                

                                                                  N=1

    While writing the decomposition in terms of summations across stages of production is useful for
illustrating the intuition behind it, in practice it is tedious to implement numerically. This can be avoided
by writing the definitions compactly with linear algebra. To see this, first, organize final good flows F (s 0 , j)
into a vector F of size 1×SJ. Second, organize the input shares aX (s 00 |s 0 , s ) into a matrix aX stacked as

                            aX (1 |1, 1 ) aX (1 |1, 2 ) . . . aX (1 |1, S ) aX (1 |2, 1 ) . . . aX (1 |S, S )
                                                                                                                             

                            aX (2 |1, 1 ) aX (2 |1, 2 ) . . . aX (2 |1, S ) aX (2 |2, 1 ) . . . aX (2 |S, S )
                                                                                                                             
                                                                                                                             
          aX = 
                                ..            ..                  ..            ..                  ..                       ,
                                                                                                                              
                                 .             .                   .             .                   .                       
                            aX (S |1, 1 ) aX (S |1, 2 ) . . . aX (S |1, S ) aX (S |2, 1 ) . . . aX (S |S, S )

of size S × S2 , and let aF be an analogous matrix of elements aF (s 00 |s 0 , j ) but of size S × SJ. Third, let
βX and βF be vectors of elements βX (s 0 , s) and βF (s 0 , j) and of size 1 × S2 and 1 × SJ. Finally, denote
the Kronecker product with ⊗ and the Khatri-Rao, or column-wise Kronecker, product with ∗ to define
the following auxiliary matrices. Let F̃ = F ∗ (ISJ×SJ ) be of size SJ × SJ, ãX = aX ∗ (IS×S ⊗ 11×S ) of
size S2 × S2 , ãF = aF ∗ (IS×S ⊗ 11×J ) of size S2 × SJ, β̃X = βX ∗ (IS×S ⊗ 11×S ) of size S × S2 , and
β̃F = βF ∗ (IS×S ⊗ 11×J ) of size S × SJ. The matrix with elements VA (s 00 |s 0 , j ) of size S × SJ, stacked
as aX , is given by
                                                VA = β̃F F̃ + β̃X [I − ãX ]−1 ãF F̃.                                                (13)

    The relation between matrix and full notation is that the term β̃F F̃ summarizes the value-added created
at the most downstream stage and is the matrix representation of (10). Analogously, β̃X (ãX )N−2 ãF F̃
is the matrix representation of VAN (s 00 |s 0 , j ) for N > 2 so that the second term in (13), given by
P∞                N−2
   N=2 β̃X (ãX )     ãF F̃ = β̃X [I − ãX ]−1 ãF F̃, is the matrix representation of (11) and (12).
    Since the roundabout solution is a special case of specialized inputs, its value-added decomposition is



                                                                  17
nested in (13). Indeed, imposing the GVC mapping in (7) on (9) delivers the value-added decomposition

                                                                       VA = β [I − a]−1 F̃,                                    (14)

where now F̃ = F ∗ (IS×S ⊗ 11×J ) is a matrix of size S × SJ, β is a diagonal matrix of elements β (s) of
size S × S , and a is the matrix of technical coefficients a (s 0 |s ) of size S × S. This is the standard formula
used in the GVC literature and mirrors those in Johnson and Noguera (2012) and Koopman et al. (2014).
    The key difference between the specialized inputs and roundabout decomposition of value-added trade
is that the former depends on an inverse matrix [I − ãX ]−1 of size S2 × S2 while the latter depends on
the Leontief inverse matrix [I − a]−1 of size S × S. The former is larger since it summarizes the larger
set of information contained in the specialized inputs technical coefficients in which input shares vary
depending on the use and destination of output.24
      This discussion illustrates the value of section 2’s general GVC theory. While value-added trade has
been conventionally defined directly in terms of roundabout GVCs as in (14), defining this measure gener-
ally in (9) is useful for deriving this decomposition under alternative equilibrium theories of production.25

3.2      Bounding Value-Added Trade
Conditional on an input-output dataset and an equilibrium theory of production, measures of globalization
can be bounded. In particular, the specialized inputs bounds on the value-added from country-industry t 00
embedded in the final goods shipped from country-industry t 0 to consumers in country i are given by
                                            ∞
                                            X
                                                  VAN t 00 t 0 , i ,
                                                                  
             min/max
  {aX (s 00 |s 0 ,s ),aF (s 00 |s 0 ,j )}
                                            N=1
                                                         X                           X
                                            X s 00 , s 0 =  aX s 00 s 0 , s X s 0 , s +  aF s 00 s 0 , j F s 0 , j , ∀s 00 , s 0 ,
                                                                                                                
            subject to
                                                                  s∈S                             j∈J
                                             X
                                                             00    0                0
                                                                         
                                                      aX s        s , s 6 1, ∀s , s,                                           (15)
                                            s 00 ∈S
                                             X
                                                      aF s 00 s 0 , j 6 1, ∀s 0 , j,
                                                                     

                                            s 00 ∈S

                                            aX s 00 s 0 , s , aF s 00 s 0 , j > 0, ∀s 00 , s 0 , s, j.
                                                                            


The endogenous variables are the destination-specific input shares for the production of both inputs and
final goods. The linear constraints restrict the optimization problem to only search across GVC networks
that perfectly replicate all entries in the observed input-output data.
      In practice, I solve an approximate version of this optimization problem which is much easier to com-
pute numerically and delivers very precise solutions. Solving (15) exactly is challenging numerically for
     24
        The invertibility of these matrices can be shown with the arguments of Hawkins and Simon (1949). In the words of Solow
(1952), the necessary condition is that no group of industries be “self-exhausting”.
     25
        Further, defining concepts cleanly at this general level should also prove useful for resolving outstanding debates in the
literature based on specific equilibrium theories of production. For example, the ongoing debate about how to define certain
(roundabout) value-added measures between Koopman et al. (2014), Los et al. (2016), Johnson (2017), and Koopman et al. (2018).



                                                                               18
two reasons. First, because it involves searching globally over the full GVC network across all countries
and industries − this makes it highly dimensional. Second, because computing value-added trade requires
tracing value across all stages of production and across all possible production paths − this makes it highly
nonlinear.26 I avoid these issues by instead solving an approximate version in which I truncate the objective
function and solve for the N-th order bounds as the solutions to

                                                                    X
                                                                    N
                                                                          VAN t 00 t 0 , i ,
                                                                                          
                                                   min /max                                                                                    (16)
                                                                   N=1

subject to the same constraints in (15). This is more easily implemented numerically since the first-order
bounds, when N = 1, are characterized by a linear program while the second-order bounds, when N = 2,
are defined by a quadratic program. Both can be feasibly solved in high dimensions. The problem can be
further simplified by focusing on the heterogeneity in input shares while keeping common value-added
shares βX (s 0 , s) = βF (s 0 , j) = GDP (s 0 ) /GO (s 0 ). The second-order bounds now correspond to a linear
program while the third-order bounds, with N = 3, are solved by a quadratic program.27
      The approximate bounds from (16) are close to the exact bounds from (15) as long as N is big enough
and, in practice, the second- and third-order bounds appear to be very well estimated.28 Specifically, Ap-
pendix section A.2 computes the exact and approximate bounds on value-added when using a small ag-
gregated version of the 2014 WIOD. The results show that the differences between the approximate and
exact bounds are negligible. While this exercise cannot be computed in larger datasets, this suggests that
computing approximate bounds is sufficient for obtaining a good estimate of the value-added trade bounds.
      As a final point, note that computing bounds on any other measure of globalization can be done anal-
ogously to (15) by changing the objective function to whatever variable one is interested in.

3.3      U.S. Value-Added Returned Home Through Imported Mexican Final Goods
One of the most important features of trade in the NAFTA region is that supply chains have become
deeply integrated. This integration is often proxied with measures such as the amount of U.S. value-added
that returns home through final good imports from its NAFTA partners and, in particular, these statistics
received widespread attention during the recent NAFTA renegotiation (see footnote 6). These measures
matter because, first, they say something about how each NAFTA country is exploiting its comparative
advantage by specializing on specific segments of the supply chain instead of on specializing on different
goods and, second, because it informs about how changes in trade barriers ripple across country borders.29
    26
       Formally, the problem is highly dimensional because if there are J countries and K industries, then JK × JK× (JK + J)
endogenous variables need to be solved for. The problem is highly nonlinear because VAN (t 00 |t 0 , i ) is a polynomial of order N
in the endogenous variables and the objective function is an infinite sum    P of polynomials of every     P order
    27
       In this case the linear inequality constraints in (15) are replaced by s 00 ∈S aX (s 00 |s 0 , s ) = s 00 ∈S aF (s 00 |s 0 , j ) = 1−β (s 0 ).
An additional feature of focusing on these approximate bounds is that the size of the optimization problem is smaller and only
requires searching within each country-industry s 0 instead of across the global network.
    28
       This occurs because value created in very upstream stages represents a tiny share of final good output and so higher-order
polynomials beyond N are negligible when N is large. In the limit N → ∞, the approximate bounds converge to the true bounds.
Formally, the gross value traded at upstream stage N decays at least at rate (1 − min {βX (s 0 , s)})N−2 (1 − min {βF (s 0 , j)}).
    29
       Policymakers typically interpret a high share of U.S. content in, say, Mexican imports as higher supply chain integration
and so higher costs of disruption. The exact quantitative effects, of course, depend on elasticities of substitution and the costs of


                                                                        19
                                   100%
                                   90%
  Share That Is U.S. Value-Added


                                   80%
                                   70%
                                   60%
                                   50%
                                   40%
                                   30%
                                   20%
                                   10%
                                    0%

                                           tal     s   cs      al    er    ry   co     tile
                                                                                            s
                                                                                              po
                                                                                                rt        ls       s         s
                                                                                                        ca duct astic Prod tica
                                                                                                                                       .        ls         in.  tal
                                                                                                                                                                    s
                                        To hicle troni ectric Pap hine bac           ex rans         mi       o        l       i l         u          i c M c Me
                                             e       c    l      d ,  a c     o    T               e        r        P       O           e        l l
                                           V      Ele   E      o     M od, T            rT     Ch tal P ber,             ef.          ac      eta Basi
                                       tor     s,           Wo          Fo           he            Me Rub ke, R Pha
                                                                                                                                   rm
                                                                                                                                          n-M
                                     Mo uter                                      Ot                                                  N o
                                        mp                                                                      Co
                                     Co




                                     Figure 4: Share of U.S. Value-Added in U.S. Imported Mexican Final Goods: Roundabout point
                                     estimates are based on the input-output analysis decomposition in (14). Specialized inputs bounds
                                     correspond to either the second-order or third-order bounds on the decomposition in (13) computed
                                     with (16) when N = 2 or N = 3, whichever is more extreme, and with common value-added shares.
                                     Numbers at top are gross Mexican final good imports in each manufacturing industry (in billion
                                     dollars). Data is from the 2014 WIOD.


                           But how much U.S. value actually returns home through, say, Mexican imports? Figure 4 shows that
conventional estimates might be off by a wide margin. Specifically, figure 4 provides estimates for the
U.S. content in imported Mexican manufacturing final goods in the 2014 WIOD. The roundabout point
estimates correspond to the conventional estimates used in both academia and policy in which, for exam-
ple, about 18% of the $118 billion of imported Mexican manufactures corresponds to U.S. value created at
upstream production stages. Figure 4 also provides the approximate bounds when using the specialized
inputs decomposition in (13) together with the optimization problem in (16). This shows that the true
share may be as low as 3% or as high as 52%. Furthermore, the bounds are considerably wide across all
manufacturing industries. Intuitively, the shares vary because, conditional on the level of U.S. imported
Mexican goods, the upper bound corresponds to GVCs in which Mexico produces these goods with a lot
of U.S. inputs while the lower bound corresponds to GVCs in which Mexico uses few U.S. inputs.
                           That value-added measures are highly mismeasured appears to be a fairly common feature. For ex-
ample, Johnson and Noguera (2012) and Johnson (2014a) showed the U.S.-China trade deficit looks less
extreme if it is computed as the difference between the U.S. value consumed in China and the Chinese
value consumed in the U.S. instead of the difference in gross exports between the two countries. Policy-

relocating supply chains across countries. However, Blanchard et al. (2017) showed this basic intuition holds formally. Specifically,
they show that countries like the U.S. should set lower tariffs on imports containing a high share of their own domestic content.


                                                                                                20
makers tend to favor this definition of trade imbalances since they, arguably, provide a better measure of
the relative linkages between both economies.30 However, Appendix section A.3 shows that the potential
mismeasurement in the value-added trade balance is so large that this statistic might actually be either a
surplus or a much higher deficit. In other words, this mismeasurement dwarfs, by orders of magnitude,
the difference between the conventional estimates of value-added and gross trade balances.
     Overall, since economists often take the roundabout value-added estimates at face value and given that
these measures feature prominently in both academic and policy debates, I hope these exercises convince
the reader of the importance of understanding how much hinges on this assumption. Crucially, this illus-
trates that some conventional wisdom facts may be pure artifice of how the roundabout solution constructs
GVCs. Since the bounds are so wide, this motivates the need of developing new measurement frameworks.
I now take a detour through a parallel literature using input-output data to compute counterfactual exper-
iments and show that similar insights apply there. The last section revisits both literatures and shows that
additional information beyond that contained in input-output data can be used to improve measurement.


4        GVCs and Counterfactuals
A second strand of the GVC literature is concerned with understanding the implications of economic
shocks, such as changes in trade barriers, on international trade. In particular, in an influential contribu-
tion, Arkolakis et al. (2012) (ACR henceforth) argued that, with some assumptions in hand, the welfare
gains from trade − across a variety of microfoundations including roundabout production − rely only on
domestic expenditure shares and thus depend only on data and a trade elasticity.
     This section shows that, in more complex equilibrium theories of production, the quantitative im-
plications of economic shocks differ depending on how GVCs are constructed using input-output data.
Conceptually, the starting point is the specialized inputs and roundabout solutions to the GVC challenge
in (1) discussed previously since these theories determine how to build the observed equilibrium’s GVC
network. The next step is to go deeper and unpack the microfoundation underlying these equilibrium the-
ories of production in order to pin down how the GVC network changes following any economic shock.
In other words, while computing value-added trade required assuming either the roundabout or special-
ized inputs solution, it required only assuming that these are the GVCs delivered in equilibrium but it did
not require specifying the specific microfoundation that delivers such equilibrium. In contrast, computing
counterfactuals does require taking a stand on a specific microfoundation in order to do empirical analysis.
In this sense, this section is more restrictive than the previous one.
     I proceed in four steps. First, I develop the simplest microfoundation for specialized inputs through a
variant of the Armington model. Second, I extend the ACR insights and show that the gains from trade
depend on the change in a set of domestic expenditure shares − though here the relevant shares are
the expenditures on domestic inputs used for the production of domestically-sold goods. Since any input-
output dataset is consistent with many GVC networks delivering different values for the latter, this implies
    30
    Pascal Lamy, the former director of the WTO, claimed in the Financial Times (January 24, 2011) that “…if we are to debate
something as important as trade imbalances, we should do it on the basis of numbers that reflect reality… Take the bilateral deficit
between China and the U.S. A series of estimates based on true domestic content can cut the overall deficit… by half, if not more.”


                                                                21
that any counterfactual exercise is consistent with a range of numerical values. Third, I show formally that
the aggregate domestic expenditure share is not the relevant sufficient statistic in a world of specialized
inputs because it fails to capture how changes in trade barriers ripple through GVC linkages. Fourth, and
finally, I show how to construct bounds on counterfactual exercises based on the class of models consistent
with the above sufficient statistics formulas and illustrate this empirically with the 2014 WIOD.

4.1     Armington Meets Specialized Inputs
I extend the Armington model with roundabout production (such as in Costinot and Rodrı́guez-Clare 2014)
to specialized inputs. There are J countries and K industries, with each country-industry s ∈ J × K
producing J differentiated varieties − each tailored to a specific market. The model is based on five main
assumptions: (i) both intermediate inputs and final goods are produced with the same technology, (ii)
production is specialized in terms of destination country but not destination industry, (iii) production
features constant returns to scale with an upper-tier Cobb-Douglas production function across labor and
intermediate inputs from each industry and a lower-tier constant elasticity of substitution (CES) composite
of inputs across source countries, (iv) market structure is perfect competition, (v) the only source of value-
added in country j is equipped labor L (j) and commands a wage w (j).
      While this model is stylized, it is a strict generalization of the standard Armington model corresponding
to the special case in which each country-industry produces the same differentiated variety for all markets.

4.1.1    Production

Formally, assumptions (iii) and (iv) imply the model can be described directly in terms of unit prices, the
dual, with the price of a unit of goods from s 0 sold to j given by the marginal cost

                                                                                                                         γ(k 00 |s 000,j )
                        0         Y            X                                                         1−σ(k 00 )
                                                                                                                              1−σ(k      )
          0           0 β(s ,j)                                  00    0            00   0       00   0
                                                                                                                                                (17)
      p s ,j = w j                                        α s        s ,j       p s ,j τ s ,j                                                ,
                                  k 00 ∈K   s 00 ∈J×k 00


where notation is such that country-industry pairs are summarized by s 00 = {j 00 , k 00 } and s 0 = {j 0 , k 0 }. The
upper-tier Cobb-Douglas is characterized by β (s 0 , j), the value-added share, and γ (k 00 |s 0 , j ), the expendi-
                                                      P
ture share on industry k 00 inputs, with β (s 0 , j) + k 00 ∈K γ (k 00 |s 0 , j ) = 1. The lower-tier CES composite
is characterized by two parameters. First, an elasticity σ (k 00 ) > 1 governing the substitutability of indus-
try k 00 inputs purchased across sources j 00 ∈ J − i.e. the industry k 00 composite combines inputs across
sources as indexed by s 00 ∈ J×k 00 . Second, a set of exogenous input shifters α (s 00 |s 0 , j ) governing the
                                                                                    P
relative expenditure on industry k 00 inputs from each source j 00 ∈ J satisfying s 00 ∈J×k 00 α (s 00 |s 0 , j ) = 1
∀k 00 ∈ K. In addition, p (s 0 , j) depends on the endogenous wage paid in s 0 , w (j 0 ) , and the prices that j 0 it-
self pays for inputs purchased from each source s 00 , p (s 00 , j 0 ), times an exogenous trade cost τ (s 00 , j 0 ) > 1
governing how many units melt when shipped from s 00 to j 0 .
      Production is specialized in that s 0 puts in specific shares of domestic value-added and inputs from each
s 00 into its exports to each market j. That is, of every dollar sold from s 0 to j a share β (s 0 , j) is domestic


                                                                      22
value-added embedded directly by s 0 while the expenditure share on s 00 inputs is endogenous and given
by
                                                                                                          00 )
                  00   0                  α (s 00 |s 0 , j ) (p (s 00 , j 0 ) τ (s 00 , j 0 ))1−σ(k
                                                                                                                       × γ k 00 s 0 , j .
                                                                                                                                      
            a s        s ,j = P                                                                           1−σ(k 00 )
                                                                                                                                            (18)
                                    t 00 ∈J×k 00   α (t 00 |s 0 , j ) (p (t 00 , j 0 ) τ (t 00 , j 0 ))
These input expenditure shares are disciplined by the parameters α (s 00 |s 0 , j ) and I interpret this hetero-
geneity as a simple way of (exogenously) capturing the interdependencies across different stages of the
value chain. For example, if U.S. workers prefer to work with Mexican inputs built with U.S. parts than
with Mexican inputs built with Chinese parts, then Mexico will put in more U.S. than Chinese parts into
its U.S. exports even if both are available at the same price in the Mexican market.
     Four comments are in order. First, unpacking or endogenizing α (s 00 |s 0 , j ) in order to study why
expenditure shares depend on the use of output is a fascinating research topic, but beyond this paper’s
scope. Moreover, while developing theories of how GVCs are formed is important, it is equally as important
to develop frameworks that can better measure these linkages in the data so that these theories can be
tested and validated. Having said that, I have attempted to tackle the former question in complementary
research (Antràs and de Gortari 2017). Second, while α (s 00 |s 0 , j ) is an exogenous shifter, the expenditure
shares a (s 00 |s 0 , j ) are endogenous since they also depend on the endogenous input prices p (s 00 , j 0 ). Third,
input specificity is eroded as goods flow down the value chain since every country j 0 has access to specific
inputs from each source s 00 , but can use them to produce new goods for any downstream market j. Fourth,
this microfoundation is slightly more restrictive than the specialized inputs described in (4) and (5) since
input shares for all goods are common and only vary across destinations: aX (s 00 |s 0 , s ) = aF (s 00 |s 0 , j ) =
a (s 00 |s 0 , j ). I focus the main text on this more restrictive model only to not make the already heavy
notation even heavier − while the autarky exercises below rely on this microfoundation, the NAFTA trade
war counterfactuals are done using a more general model with separate aX (s 00 |s 0 , s ) and aF (s 00 |s 0 , j ) .

4.1.2   Consumers

As is standard, I assume consumers aggregate goods across industries using an upper tier Cobb-Douglas ag-
gregator with ζ (k 0 |j ) denoting the expenditure share on industry k 0 final goods by consumers in country
j. Further, within each industry consumers aggregate varieties across source countries into a CES com-
posite with the same elasticity of substitution σ (k 0 ) > 1 as above and with the free parameters ϕ (s 0 |j )
disciplining the share of final goods from s 0 purchased by consumers in each j. The price index is then

                                                                                                                  ζ(k 0 |j0)
                                 Y              X                                                 1−σ(k 0 )
                                                                                                                       1−σ(k   )
                                                                  0              0            0
                                                           ϕ s |j
                                                                                    
                       P (j) =                                           p s ,j τ s ,j                                           ,        (19)
                                 k 0 ∈K       s 0 ∈J×k 0


and the expenditure share on final goods from each source country-industry s 0 equals
                                                                                                   0
                                                ϕ (s 0 |j ) (p (s 0 , j) τ (s 0 , j))1−σ(k )
                       πF s 0 |j = P                                                                             × ζ k 0 |j .
                                                                                                                          
                                                                                                   1−σ(k 0 )
                                                                                                                                            (20)
                                            t 0 ∈J×k 0     ϕ (t 0 |j ) (p (t 0 , j) τ (t 0 , j))



                                                                          23
4.1.3    Mapping the Model to Input-Output Data

Mapping the model to the data requires building the model’s analogs of the input-output table elements.
From the consumer’s side, final good purchases in j from source s 0 equal a share of aggregate income

                                                    F s 0 , j = πF s 0 |j × w (j) L (j) .
                                                                        


The intermediate input side is constructed by noting that a share of the dollar exports to a given market is
used to pay for the inputs embedded in them. Thus, aggregate intermediate input sales from s 00 to s 0 must
equal the total value of inputs used by s 0 to produce exports sold to all destinations
                                                                                                         
                                                    X                          X
                             X s 00 , s   0
                                                          a s 00 s 0 , j             X s 0, s + F s 0, j  .
                                                                                                      
                                                =                                                                            (21)
                                                    j∈J                       s∈j×K


Given the input shares and final good flows, these S × S equations implicitly define the S×S input flows.31
    There are multiple parameterizations of this model that can perfectly fit the input-output data. Specifi-
cally, conditional on any vector of iceberg trade costs τ (s 0 , j) > 1 and elasticities of substitution σ (k) > 1,
the parameters ϕ (s 0 |j ) adjust to match final good flows, the input mix parameters α (s 00 |s 0 , j ) adjust to
match intermediate input flows, and the Cobb-Douglas shares β (s 0 , j), γ (k 00 |s 0 , j ), and ζ (k 0 |j ) adjust
to match GDP and gross output. Since the microstructure permits destination-specific input expenditure
shares, it can produce many different GVC networks that aggregate up to the same input-output data.
      In particular, the roundabout model corresponds to the knife-edge case of no specialization in which
exports to all markets use the same input mix.32 With these restrictions, (21) delivers the property of
roundabout models that input shares are proportional to bilateral trade shares as described in (8). That is,
when the model is parameterized such that β (s 0 , j) = β (s 0 ), γ (k 00 |s 0 , j ) = γ (k 00 |s 0 ), and α (s 00 |s 0 , j) =
α (s 00 |s 0 ) for all j ∈ J, then a (s 00 |s 0 , j ) = a (s 00 |s 0 ) = X (s 00 , s 0 ) /GO (s 0 ).
      Hence, while roundabout models may fit the data perfectly, this cannot be interpreted as evidence for
the roundabout approach since many specialized inputs models fit it perfectly. Moreover, input-output
data contains no information identifying which specialized inputs parameterization is most accurate.

4.2      The Gains from Trade
Building on the insights of ACR, the welfare change following any shock to trade barriers depends on a set
of domestic expenditure shares. I derive this formula using the exact hat-algebra approach in four steps.
Specifically, let a hat variable denote the ratio of a given variable x across two equilibria, i.e. x̂ = x1 /x0 ,
    31
       Alternatively, input flows can be computed directly with linear algebra through X = a [I − a]−1 F. This approach is remi-
niscent of the Leontief inverse matrix but requires a matrix of size S2 × S2 instead of size S × S.
    32
       To be clear, I am using the term roundabout when referring to production processes in which all output uses the same
input mix and in which the model is implemented literally in that the industries in the theory are mapped one-to-one to the
industries in the data (for example, as in Costinot and Rodrı́guez-Clare 2014, Caliendo and Parro 2015, and Caliendo et al. 2017).
More generally, this specialized inputs model can also be interpreted as a more disaggregate multi-industry roundabout model in
which country j has K × J industries in which the goods produced by industry k for country j are only sold to country j. The
mapping to the data is not one-to-one, however, since the theory has K × J industries per country whereas the data has K.



                                                                         24
and let τ̂ (s 0 , j) denote the (exogenous) change in trade costs of goods shipped from s 0 to j. As is standard,
to make notation cleaner I assume that domestic trade costs do not change, i.e. τ̂ (s 0 , j) = 1 ∀s 0 ∈ j × K.
     First, I derive the change in expenditure shares. From (18), the change in input expenditures from
source s 00 used by s 0 for goods sold to j as a share of overall expenditure on industry k 00 inputs equals
                                                                                                              00 )
                         â (s 00 |s 0 , j )                       (p̂ (s 00 , j 0 ) τ̂ (s 00 , j 0 ))1−σ(k
                                             =P                                                                                                    .        (22)
                         γ (k 00 |s 0 , j )                      a (t 00 |s 0 , j ) × (p̂ (t 00 , j 0 ) τ̂ (t 00 , j 0 ))1−σ(k
                                                                                                                                            00 )
                                                  t 00 ∈J×k 00

Analogously, from (20), the change in the share of final good expenditures from source s 0 by consumers
in j relative to overall expenditure on industry k 0 final goods equals
                                                                                                        0
                              π̂F (s 0 |j )                        (p̂ (s 0 , j) τ̂ (s 0 , j))1−σ(k )
                                            =P                                                                                          .                   (23)
                               ζ (k 0 |j )                         πF (t 0 |j ) × (p̂ (t 0 , j) τ̂ (t 0 , j))1−σ(k )
                                                                                                                                    0
                                                    t 0 ∈J×k 0

Both expenditure changes (22) and (23) depend on the exogenous Cobb-Douglas and elasticity parameters,
the exogenous change in trade costs, the initial GVC network, and the endogenous change in unit prices.
     Second, to derive price changes in terms of domestic expenditures, substitute (22) into (17) to obtain

                                   0          Y            − 1−σ 1k 00                        γ(k |s ,j )
                                                                                                  00 0
                 0               0 β(s ,j)            00 0                        00 0     00 0
                                                                                      
            p̂ s , j = ŵ j                       â s s , j       (      ) × p̂ s , j τ̂ s , j               ,                                             (24)
                                             k 00 ∈K


where s 00 can be a source located in any country, that is s 00 ∈ J × k 00 . Then take (24) defined in terms of
domestic industries of j, i.e. s 0 = {j, k 0 } and s 00 = {j, k 00 }, and substitute (24) repeatedly into itself. In the
limit, domestic unit prices depend exclusively on changes in domestic expenditure shares
                                                                                                                                   δ(k 00 |s 0 ,j )
                                  Y                   β(s 00 ,j)
                                                                          Y                                 (k |s ,j )
                                                                                                        − γ1−σ
                                                                                                                     000   00

               p̂ s 0 , j =                                                         â s 000 s 00 , j           k 000
                          
                                           ŵ (j)                 ×                                                  (         )                      ,   (25)
                               s 00 ∈j×K                               s 000 ∈j×K


with s 0 , s 00 , and s 000 domestic industries of j. The change in domestic prices thus depends on the change in
domestic wages and in expenditures on domestic inputs used in the production of domestically-sold goods.
Further, (25) captures the domestic expenditure change across all stages of the supply chain through
                                                                                X
              δ k 00 s 0 , j = 1[k 00 =k 0 ] + γ k 00 s 0 , j +                           γ k 00 s 000 , j γ k 000 s 0 , j + . . . .
                                                                                                                       

                                                                             s 000 ∈j×K


That is, δ (k 00 |s 0 , j ) captures the aggregate (gross) use of k 00 inputs used in all upstream production stages of
a purely domestic supply chain for inputs that are eventually embedded in goods sold by s 0 domestically.33
     Third, the change in the price index of country j can be written in terms of the change in final expen-
   33
      Note that δ (k 00 |s 0 , j ) contains value-added counted multiple times. Since the focus is on domestic shares, writing the Cobb-
Douglas shares γ (k 00 |s 0 , j ) for country j as a K × K matrix γ delivers the corresponding δ (k 00 |s 0 , j ) shares as δ = [I − γ]−1 .




                                                                           25
diture shares from some source s 0 by substituting in (23) into equation (19)

                                     Y          − 1−σ1 k 0                        ζ(k |j )
                                                                                     0
                                             0                       0        0
                                        π̂F s |j
                                                                         
                            P̂ (j) =                   (     ) × p̂ s , j τ̂ s , j            .                                                                    (26)
                                       k 0 ∈K

   Finally, substituting the price changes in (25) into the price index change in (26), defined domestically
with s 0 ∈ j×K, delivers the welfare change Ŵ (j) = ŵ (j) /P̂ (j) in terms of domestic expenditure changes
                                                                                                                                                ζ(k 0 |j )
                  Y                      1−σ1 k 0           Y         Y                               γ( k
                                                                                                                000 |s 00 ,j )δ(k 00 |s 0 ,j )

    Ŵ (j) =              π̂F s 0 |j         ( )    ×                            â s 000 s 00 , j                 1−σ(k 000 )                               .   (27)
               s 0 ∈j×K                                  s 00 ∈j×K   s 000 ∈j×K


    This formula incorporates various elements found previously such as the GVC elements from Antràs
and de Gortari (2017), the domestic expenditure shares from ACR, and the multi-industry input-output
linkages of Caliendo and Parro (2015). Specifically, first, in a single-industry world this formula becomes
                                                                                                      1
                                                                                                     1−σ
                                                                                         1−β(j,j)
                                          Ŵ (j) = π̂F (j |j ) × â (j |j, j )            β(j,j)            ,                                                      (28)

and the change in welfare depends on the change in the share of final goods purchased domestically and the
change in the share of domestic inputs used in the production of domestically-sold inputs. Each term cap-
tures the relative importance of domestic goods in the production of a purely domestic supply chain.34 This
formula is similar to that derived by Antràs and de Gortari (2017) in a multi-stage Ricardian model where
welfare depends on the expenditure share on goods produced through purely domestic supply chains.
   Second, ACR’s benchmark analysis without intermediate inputs is nested here by imposing β (j, j) = 1
                                                                                     1
                                                         Ŵ (j) = π̂F (j |j ) 1−σ .

Further, ACR’s generalization to intermediate inputs under the roundabout solution while imposing sym-
metry, i.e. π̂F (j |j ) = â (j |j ), is also nested and given by
                                                                                     1
                                                     Ŵ (j) = π̂F (j |j ) β(j)(1−σ) .                                                                              (29)

Hence, ACR’s insight that the gains from trade depend on some form of domestic expenditure shares is also
true in the world of specialized inputs. Third, and finally, imposing the roundabout assumptions directly on
(27) delivers the formula of Caliendo and Parro (2015). In sum, (27) extends the roundabout multi-industry
ACR formula with input-output linkages to specialized inputs.
   34
      The exponents capture the gross domestic output used in the production of a dollar of final goods: The power 1 on π̂F (j |j )
is the dollar of final goods while the power on â (j |j, j ) equals the use of intermediate inputs across all stages of the supply chain

                        (1 − β (j, j)) × 1 + (1 − β (j, j)) × (1 − β (j, j)) × 1 + · · · = (1 − β (j, j)) /β (j, j) .




                                                                       26
4.3     The Import Demand System is Not CES
Before delving further, it is helpful to pause and analyze why specialized inputs imply that aggregate
expenditure shares are insufficient for tracing the implications of changes in trade barriers. In a nutshell,
this occurs because GVCs play a role in propagating trade shocks and specialized inputs determine the
structure of these trade linkages. In words, if both Ford and Volkswagen assemble vehicles in Mexico
but have different supply chains, then changes in Mexican trade costs with different export partners have
asymmetric effects on input suppliers depending on the structure of Ford and Volkswagen’s supply chains.
      Formally, this can be stated in terms of ACR’s restriction concerning how third country trade shocks
pass through into relative imports; I discuss only the intuition, the proof is in appendix section C. In
a single-industry world, the partial elasticity of imports in j 0 from source j 00 6= j 0 relative to domestic
purchases (i.e. from j 0 ) with respect to changes in trade costs with a third country i 00 6= j 0 depends on (i)
the direct effect on relative imports present when j 00 = i 00 , (ii) a substitution effect from i 00 inputs into both
j 00 and j 0 inputs, and (iii) a supply chain effect into j 00 and j 0 inputs derived from the change in downstream
production. Crucially, the latter two effects depend on the differential importance of each export market j
for inputs from j 00 relative to j 0 and on how trade costs with i 00 affect exports to each j.
      The latter two effects thus illustrate how changes in third-country trade barriers affect imports asym-
metrically depending on the depth of supply chain integration. These channels are in line with the empiri-
cal evidence suggesting that specialized inputs play a crucial role in propagating trade shocks. For example,
Barrot and Sauvagnat (2016), Carvalho et al. (2016), and Boehm et al. (2018) show that supply chain dis-
ruptions due to natural disasters are propagated by input specificity through trade networks. Increases in
suppliers’ marginal costs mostly affect tightly-linked firms, rather than entire industries symmetrically as
in roundabout models. The knife-edge roundabout model, however, is the one case in which the effect is
symmetric since all exports get built with the same inputs. In other words, in roundabout models all export
markets j are equally important for inputs from j 00 and j 0 and so the two latter effects disappear. This is
the very special case in which model satisfies the ACR condition “the import demand system is CES”.
      Finally, note that the gravity equation’s empirical success is not evidence for the roundabout model.
Appendix section C.1 shows that gravity regressions fare well across simulations of the specialized inputs
model even though structural gravity does not hold: While third country trade costs shift bilateral trade
flows asymmetrically, on aggregate the bilateral terms dominate. In practice, this misspecification leads
to attenuated trade elasticity estimates and is similar to introducing classical measurement error − thus
suggesting a downward bias in gravity-based elasticities when deep supply chain linkages are pervasive.

4.4     Bounding Counterfactuals
4.4.1    Autarky Gains from Trade - Single Industry Bounds

I begin by showcasing the bounds approach to counterfactuals in a simplified setting. For now, I ig-
nore the data’s industrial dimension and assume there is a single industry per country, i.e. S = J, and
compute the bounds on the gains relative to autarky. In this case, the change in expenditure shares
equals the observed equilibrium’s expenditure shares, i.e. π̂F (j 0 |j 0 ) = πF (j 0 |j 0 ) /1 and â (j 0 |j 0 , j 0 ) =


                                                           27
                                                                                                                    P
a (j 0 |j 0 , j 0 ) / (1 − β (j 0 , j 0 )). Since πF (j 0 |j 0 ) is observed in the data and β (j 0 , j 0 ) = 1−        j 00 ∈J a (j
                                                                                                                                       00 |j 0 , j 0 ),

the only endogenous variables are the input shares a (j 00 |j 0 , j ).
     The autarky bounds for country j 0 in any model delivering a welfare formula as in (28) are given by
                                                       P
                                                           j ∈J00 a (j 00 |j 0 , j 0 )            a (j 0 |j 0 , j 0 )
                           min/max                         P                           ×  ln P                           ,
                     {a(j 00 |j 0 ,j )}j 00 ∈J,j∈J   1 − j 00 ∈J a (j 00 |j 0 , j 0 )          j 00 ∈J a (j |j , j )
                                                                                                              00 0 0
                                                                  X
                                                     X j 00 , j 0 =         a j 00 j 0 , j X j 0 , j + F j 0 , j , ∀j 00 ,
                                                                                                                    
                           subject to
                                                                          j∈J                                                                  (30)
                                                      X
                                                                     00    0
                                                                               
                                                               a j        j , j 6 1, ∀j,
                                                     j 00 ∈J

                                                     a j 00 j 0 , j > 0, ∀j 00 , j.
                                                                   


The objective function is a concave transformation of (28), while the constraints restrict the search to GVCs
that replicate the input-output data.35 This optimization is relatively easy to solve since the objective
function is well-behaved and the constraints are linear. In the special case with constant value-added
shares, i.e. β (j 0 , j) = β (j 0 ) ∀j ∈ J, this becomes a simple linear program bounding a (j 0 |j 0 , j 0 ) directly.
     Crucially − and in contrast to the value-added bounds optimization in (15) − computing these bounds
requires only zooming in on all import-export linkages within country j 0 . That is, while the world economy
depends on J × J × J input shares, (30) solves only for J × J endogenous variables. This occurs for two
reasons: First, because the autarky gains only depend on domestic expenditure shares and so the objective
function only depends on a (j 00 |j 0 , j ) across j 00 and j. Second, because under this simple version of special-
ized inputs, the input-output data constraints only depend on matching the input sales into the domestic
market and the output sales out of the domestic market instead of on the whole input-output dataset.
In other words, computing these bounds requires only searching for extremal domestic GVC linkages.36
Figure 5 illustrates this in a simple two-country network with constant value-added shares.
     Figure 6 plots the gains from trade relative to autarky in the roundabout model (ACR) and in specialized
inputs models with both common and destination-specific value-added shares (note the log scale) using the
2014 WIOD. Since the latter class of models nest the former the bounds are wider and any value within the
bounds is feasible since the optimization constraints are linear and any convex combination of the lower
and upper bounds is a possible initial trade equilibrium. Now, while the optimization does not depend
on the trade elasticity, the latter is necessary for transforming the solutions into bounds. However, while
using specialized inputs models to measure elasticities is a fascinating research topic, it is beyond this
paper’s scope. Thus, I simply set a roundabout trade elasticity of 1 − σ = −5, in line with mainstream
estimates (Anderson and van Wincoop 2003, Costinot and Rodrı́guez-Clare 2014, Head and Mayer 2014).
Importantly, though, note that the log autarky gains from trade are proportional to 1/ (1 − σ), which
implies that changing σ only shifts the bars in figure 6 up (if σ is lower) and down (if σ is higher) as can
be seen in Appendix section A.5 for the case of 1 − σ = −2.5 and 1 − σ = −10.
    35
      Computing autarky bounds incorporates trade imbalances automatically. First, the imbalances observed in the benchmark
equilibrium are fed in through the input-output data. Second, the autarky equilibrium assumes, by construction, no imbalances.
   36
      This breaks down with a higher degree of specialization. For example, bounds on GVCs built with third-order Markov
chains, i.e. a (j 000 |j 00 , j 0 , j ), would be wider, but computing them comes at a substantial cost in dimensionality (see section 2.3.1).


                                                                                28
                                                                            X(H,H) + F (H,H)
          Home                 X(H,H) =$48                                                                    Home
                                                                                 =$100

                                                            Home

         Foreign                X(F,H) =$12                                 X(H,F) + F (H,F)                 Foreign
                                                                                 =$20



                                                                     Roundabout        Lower Bound        Upper Bound
    a (H |H, H ): Share of H inputs in sales to H                        40%                48%                 38%
    a (H |H, F ): Share of H inputs in sales to F                        40%                 0%                 50%
    X (H |H, H ): Dollar value of H inputs in sales to H                 $40                $48                 $38
    X (H |H, F ): Dollar value of H inputs in sales to F                  $8                 $0                 $10
    Ŵ (H) : Autarky gains from trade in H                               7.6%               3.7%                8.7%


         Figure 5: GVC Networks in a Simple Home vs Foreign Example: For simplicity, let Home’s value-
         added share be common across destinations and given by β (H) = $60/$120 = 50%, while its
         domestic final good share is πF (H |H ) = $52/$60 = 87%. The gains are relative to autarky and
         computed using (28) with 1 − σ = −5. Since home is a relatively closed economy, the upper bound
         is mechanically close to the roundabout estimates. That is, the latter assign a lot of domestic inputs
         into all output and so many domestic inputs can be shifted out of exports into domestically sold
         goods ($8) but few domestic inputs can be shifted into exports from domestically sold goods ($2).


    The bounds on the gains from trade are wide and increasing in trade openness. For example, the U.S.
ACR gains, a relatively closed economy with only 10% of its total inputs purchased abroad, are low at 2.9%
while the range with destination-specific value-added shares lies between 1.2-3.1% indicating the gains
might actually be 60% lower or 10% higher. The range is relatively small, however, with a ratio between
the upper and lower bounds of 2.6. In contrast, very open economies are consistent with a wide range
of domestic GVC networks since one can find both trade equilibria in which goods sold domestically use
either mostly domestic inputs or almost no domestic inputs. For example, Taiwan imports about 40% of its
total inputs and has a bounds ratio of 45%/3% = 15. Full results are reported in appendix section A.4.37

4.4.2    Autarky Gains from Trade - Multiple Industry Bounds

Computing the autarky bounds with multi-industry data is analogous but more complex numerically. In
particular, incorporating destination-specific (Cobb-Douglas) value-added and industry shares is challeng-
ing since the welfare gains in (27) are highly nonlinear in these terms. First, because the direct and in-
direct linkages captured by δ (k 00 |s 0 , j ) are a function of these shares (see footnote 33). Second, because
the Cobb-Douglas shares capture cross-industry linkages and so the optimization has to be done glob-
ally across all of a country’s GVC network and cannot be done in isolation within each country-industry.
   37
     These bounds feature a mechanical correlation where distance between the ACR gains and the upper bound increases with
trade openness. This occurs because trade equilibria where domestically-sold goods use arbitrarily few domestic goods (a high
upper bound) can only be found in countries that trade a lot (figure 5 provides further intuition). In practice, extremely open
economies like the small European markets on the right of figure 6 feature upper bounds that are quite literally off the charts.


                                                              29
                            128%
 Autarky Gains from Trade



                             64%

                             32%

                             16%

                              8%

                              4%

                              2%

                              1%

                            0.5%


                                    SWE



                                    ROW




                                     EST
                                     ESP
                                     FRA




                                     PRT




                                     SVK
                                       ITA




                                     TUR




                                     SVN




                                       IRL
                                    RUS




                                    DEU


                                      FIN
                                    CHE


                                    HRV
                                    MEX




                                    KOR
                                      IND


                                      IDN


                                    NOR




                                    GRC




                                    ROU




                                    TWN
                                     LVA




                                     LTU
                                     BEL




                                     LUX
                                     POL


                                     AUT


                                     NLD


                                     CZE
                                    USA
                                    BRA



                                    AUS




                                    CYP
                                    CAN




                                    DNK
                                    CHN




                                    GBR




                                    BGR




                                    HUN
                                     JPN




                                    MLT
                                Figure 6: Single-Industry Autarky Welfare Gains from Trade: Both roundabout estimates and spe-
                                cialized inputs bounds based on (28); the latter computed with (30). All counterfactuals use round-
                                about trade elasticity 1 − σ = −5. Note the log scale. Data is from 2014 WIOD (at country level).


Hence, to make things simple, I avoid these issues and focus on the special case where industry-level
expenditures are fixed and given by the data − that is, β (s 0 , j) = β (s 0 ) = GDP (s 0 ) /GO (s 0 ) and
                                     P
γ (k 00 |s 0 , j ) = γ (k 00 |s 0 ) = s 00 ∈J×k 00 X (s 00 , s 0 ) /GO (s 0 ) ∀j ∈ J.
                            The autarky bounds for country j 0 in any multi-industry model delivering the welfare formula (27) are
found by solving for the extremal GVC networks within every pair of industries separately. Specifically,
the extremal domestic shares in country j 0 for the industry pair k 00 and k 0 are found through

                                                   a s 00 s 0 , j 0 ,
                                                                   
                                min/max
          {a(t 00 |s 0 ,j )}t 00 ∈J×k 00 ,j∈J
                                                                                                                            
                                                                     X                        X
                                                   X t 00 , s 0 =          a t 00 s 0 , j             X s 0 , s + F s 0 , j  , ∀t 00 ∈ J×k 00 ,
                                                                                                                         
                                subject to
                                                                     j∈J                  s∈j×K                                                     (31)
                                                      X
                                                                  a t 00 s 0 , j = γ k 00 s   0
                                                                                                    , ∀j ∈ J,
                                                                                               

                                                   t 00 ∈J×k 00

                                                   a t 00 s 0 , j > 0, ∀t 00 ∈ J×k 00 , j ∈ J,
                                                                 


where s 00 = {j 0 , k 00 } and s 0 = {j 0 , k 0 } are domestic country-industries. Optimization problem (31) is a
linear program with J × J endogenous variables and easy to solve numerically. The bounds are then
constructed by solving this problem for the K × K industry pairs and inserting the solutions into the


                                                                                     30
                             128%
  Autarky Gains from Trade



                              64%

                              32%

                              16%

                               8%

                               4%

                               2%

                               1%

                             0.5%




                                    SWE




                                    ROW
                                     ESP
                                     FRA
                                       ITA




                                     TUR




                                       IRL
                                    RUS




                                    DEU

                                      FIN
                                    CHE
                                    MEX




                                    KOR
                                      IND




                                      IDN



                                    NOR




                                    GRC




                                    TWN

                                     BEL
                                     POL

                                     AUT

                                     NLD
                                    USA
                                    BRA




                                    AUS




                                    CAN




                                    DNK
                                    CHN




                                    GBR
                                     JPN




                                 Figure 7: Multi-Industry Autarky Welfare Gains from Trade: Both roundabout estimates and spe-
                                 cialized inputs bounds based on (27); the latter computed with (31). All counterfactuals use round-
                                 about trade elasticities 1 − σ (k) = −5 ∀k ∈ K. Note the log scale. Data is from 2014 WIOD and
                                 aggregated to J = 30 largest economies with K = 25 industries each (see appendix section B).


terms â (s 00 |s 0 , j 0 ) = a (s 00 |s 0 , j 0 ) /γ (k 00 |s 0 ) and π̂F (s 0 |j 0 ) = πF (s 0 |j 0 ) /ζ (k 0 |j 0 ) in (27).
                             It is well known that multi-industry models deliver larger gains from trade (Costinot and Rodrı́guez-
Clare 2014) and figure 7 shows the same is true for the bounds. This is not by construction, rather, the
multi-industry bounds are larger and overlap little with the single-industry bounds because heterogeneity
in openness across industries leads to disproportionate effects on the gains from trade. To understand this
better, imagine a world in which the input mix used across all industries were common. As shown by Ossa
(2015), the multi-industry gains in this very special world are still higher as long as there is heterogeneity
in the elasticities of substitution across industries. However, with common elasticities, the gains are the
same in both the multi- and single-industry data. Yet, figure 7 is built with common elasticities and delivers
higher multi-industry gains. This happens because even relatively closed countries have some very open
industries and this delivers a very high upper bound even in the presence of zero heterogeneity in the
trade elasticities (see footnote 37). Full results are reported in appendix section A.4.

4.4.3                           Arbitrary Changes in Trade Costs

Computing real world or policy-motivated counterfactuals can be done with specialized inputs models
through a generalization of the roundabout exact hat algebra approach as in Dekle et al. (2007). Specifi-
cally, equations (22), (23), (24), and an additional fixed point for the change in wages, deliver the change


                                                                                 31
in expenditure shares â (s 00 |s 0 , j ) and π̂F (s 0 |j ) − and thus the change in welfare in (27) − following
any change to trade barriers τ̂ (s 0 , j) as a function of the benchmark equilibrium’s expenditure shares
a (s 00 |s 0 , j ) and πF (s 0 |j ); see appendix section D.1 for details. Hence, counterfactual equilibria are easily
computed when one knows the GVC flows underlying the observed input-output data.
    Constructing welfare bounds on general counterfactuals, however, is much more complex relative to
the autarky case because the welfare change depends not only on the benchmark equilibrium’s expendi-
ture shares but also on how these change following the trade shock. This implies that the optimization now
involves two sets of constraints: First, the constraints ensuring that the benchmark equilibrium’s expendi-
ture shares be consistent with the observed data (as in the autarky case) and, second, the set of fixed point
constraints delivering the change in the endogenous variables conditional on both the benchmark equi-
librium’s expenditure shares and the (exogenous) change to trade barriers. Constructing exact bounds is
thus very demanding computationally for two reasons. First, because the fixed point constraints are highly
nonlinear (these do not appear in autarky case since the autarky expenditure shares are known). Second,
because the counterfactual equilibrium now depends on the whole set of expenditures shares across all
countries and industries (whereas in autarky only domestic shares matter). Overall, this implies that the
optimization problem depends on many more endogenous variables and is characterized by both a nonlin-
ear objective function and nonlinear constraints.38 The formal procedure is described in appendix section
D.2 but, in practice, can only be solved in very low dimensional cases with current computing power.
    In order to make progress, I have developed an approximate bounds approach which is straightforward
to implement and reveals a lot of information about the potential size of the true bounds. In a nutshell, this
approach builds upon the fact that, for a given change in trade barriers, a researcher can often make an
informed guess about the GVC networks in which these shocks are either very costly or not. For example,
let us study this question with the slightly more general model in which expenditure shares vary across
inputs and final goods, i.e. with aX (s 00 |s 0 , s ) and aF (s 00 |s 0 , j ). Now imagine that the U.S. increases
trade barriers on Mexican final good imports. If the U.S. contributes a lot of inputs to these final goods,
i.e. if aF ({USA, k 00 } |{MEX, k 0 } , USA ) is high, then this will have a strong ripple effect and hurt upstream
U.S.-based suppliers more than if these shares are low. Likewise, if Mexico contributes a lot of inputs and
aF ({MEX, k 00 } |{MEX, k 0 } , USA ) is high, then this change in trade barriers will hurt Mexican suppliers
more than if these shares are low. Furthermore, since the bilateral trade data is observed, a researcher can
actually find the extreme values for these expenditure shares using a linear program and then compute the
welfare change associated with these GVC flows through the specialized inputs hat algebra.
    Figure 8 shows the approximate bounds on two NAFTA trade war counterfactuals constructed through
this approach − the left panel shows the U.S. and Mexico welfare losses when the U.S. increases trade
barriers on Mexican final good manufactures by 100% while the right panel shows the losses when Mexico
increases barriers on U.S. intermediate input manufactures by 100%. Each panel is based on three extremal
GVC networks (described in the legend) − with the associated welfare numbers depicted in the three
corners of the plotted sets. In particular, the three extremal values in the left panel correspond to the
    Formally, computing the autarky bounds requires solving K × K linear optimization problems of size J × J each, whereas
   38

computing bounds in general requires solving a single global nonlinear problem with J × K × J × K × J endogenous variables.



                                                            32
                                     U.S. Increases Trade Barriers on                                               Mexico Increases Trade Barriers on
                                      Mexican Final Goods by 100%                                                    U.S. Intermediate Inputs by 100%
                           1.50                                                                               3.0
 Mexico Welfare Loss (%)




                                                                                    Mexico Welfare Loss (%)
                           1.25                                                                               2.5

                           1.00                                                                               2.0

                           0.75                                                                               1.5

                           0.50                                                                               1.0

                           0.25                                                                               0.5

                           0.00                                                                               0.0
                              0.06       0.08     0.10      0.12      0.14                                      0.06     0.08     0.10    0.12    0.14
                                         U.S. Welfare Loss (%)                                                           U.S. Welfare Loss (%)




                               Figure 8: Welfare Losses of a NAFTA Trade War: Each panel plots the joint counterfactual U.S.
                               and Mexico welfare loss following an increase in trade barriers across 10,000 GVC networks that
                               replicate every single datapoint in the 2014 WIOD. The left panel corresponds to a 100% increase in
                               trade barriers on U.S. imported Mexican final good manufactures and the right panel corresponds
                               to a 100% increase in trade barriers on Mexican imported U.S. intermediate input manufactures.
                               Within each panel, each dot is the welfare losses associated with a set of GVC flows constructed as
                               a random linear combination of the GVC flows underlying the three extremal values (described in
                               the legend). The diamond in the middle corresponds to the conventional roundabout welfare losses.


GVC networks in which the use of Mexican/U.S./other countries’ inputs in Mexican final goods exports
to the U.S. is maximized. Further, each smaller point corresponds to the welfare losses in a GVC network
built as a linear combination of the three extremal GVC networks. Since each extremal GVC network
replicates the 2014 WIOD, so does each linear combination (remember equation 6) and so any point in
figure 8 corresponds to the welfare losses in a set of GVC flows consistent with the 2014 WIOD. The right
panel does a similar experiment but is based on the extremal GVC networks maximizing the share of U.S.
inputs used in Mexican domestic sales, exports to the U.S., and exports to all other countries. The precise
equations and procedure used to construct figure 8 is described in appendix section D.3.
                           Figure 8 suggests that roundabout counterfactual estimates are also potentially highly mismeasured in


                                                                               33
general counterfactuals. These correspond to the welfare losses obtained when implementing the standard
exact hat algebra with the observed input-output expenditure shares. This delivers U.S. and Mexico welfare
losses of 0.09% and 0.85% (left panel) and 0.11% and 1.39% (right panel). The approximate bounds, however,
show that U.S. losses in the left panel may be anywhere between 0.07% to 0.13% and Mexico losses between
0.21% to 1.40%. The right panel bounds for the U.S. are 0.07% to 0.14% and for Mexico are 0.71% to 2.73%.
These are substantial measurement differences. Further, figure 8 captures a trade-off between U.S. and
Mexican welfare losses governed by the relative importance of Mexican/U.S. inputs in exports to the U.S.
(left) and by the relative importance of U.S. inputs in domestic sales/exports to the U.S. (right).
     Overall, figure 8 suggests this approach delivers informative bounds as long as the researcher focuses
on extremal GVC networks relevant to the question at hand. To see this, note that the welfare losses
associated to the extremal GVC networks in figure 8 make intuitive sense. For example, the GVCs in which
Mexico uses the most/least amount of Mexican inputs to produce final goods exports to the U.S. (the two
triangles in the left panel) correspond to a world in which Mexican supply chains are very highly/little
exposed to U.S. exports. Hence, choosing GVCs in which Mexico is very highly/little exposed to a NAFTA
trade war delivers maximal/minimal Mexican welfare losses. A similar intuition can be derived for the
other extremal GVC networks in figure 8. This implies that implementing this approach should generally
be straightforward. In this case, it is relatively obvious that the GVC flows which maximize/minimize
the welfare losses of a NAFTA trade war are those associated with very highly/little integrated Mexican-
American supply chains. Analogous insights can be used when studying other trade shocks.
     In sum, the bounds in figures 6, 7, and 8 show that quantitative counterfactual predictions based on
input-output data vary substantially depending on how GVCs are measured.39 As in the case of value-
added trade in section 3, since all GVC networks perfectly fit the same data, the latter can shed no further
light on which specific estimates are most reasonable. The next section makes progress by improving
measurement in order to shed light on which estimates are most reasonable.


5        GVCs and Measurement: Bringing in New Sources of Information
This last section is devoted to a third strand of the GVC literature concerned with measuring GVC flows. In
an ideal world, GVCs would be measured directly on the universe of firm-to-firm trade flows. Instead, since
this data is not available, GVCs are typically measured on input-output data together with the roundabout
assumptions. I now show that other sources of readily available information − such as customs data − can
be used to improve measurement in conjunction with input-output data and some auxiliary assumptions.
This approach’s main attribute is that it can be implemented when a researcher has some information about
the GVCs underlying input-output data, but that is insufficient for fully measuring the flows directly − as
    39
      Importantly, note these bounds do not necessarily depend on the Armington microstructure, but hold true for any mi-
crostructure delivering the sufficient statistics welfare formula (27). That said, more realistic models incorporating elements such
as tariff income, fixed costs, and monopoly power may not be consistent with ACR-type formulas. My goal has been to illustrate
in the simplest way how quantitative results differ depending on how input-output datasets are interpreted. While outside the
scope of this paper, I conjecture that richer microfoundations − which may or may not deliver ACR-type formulas − deliver
similar qualitative results in the sense that multiple GVC networks both replicate the input-output data and deliver different
quantitative counterfactual estimates.



                                                                34
is most often the case. For example, with customs data that provides the universe of import and export
transactions but that provides no information on domestic transactions.40
      I proceed in three steps. First, I discuss the information on GVC linkages contained in customs datasets
and why a measurement procedure is required in order to exploit this information to measure GVC flows.
Second, I show how this type of information can be used without additional assumptions to further narrow
the specialized inputs bounds derived in previous sections. Third, I develop a new measurement framework
that uses this information to provide alternative and better measured point estimates than those based on
the roundabout GVCs. In a nutshell, the difference between these two approaches is that the first one
exploits the additional information through linear constraints on the bounds optimization problems while
the second one exploits the information through the objective function of a minimum-cost flow problem
that construct specific sets of GVC flows. Throughout, I implement these approaches by revisiting the
value-added and NAFTA counterfactual exercises studied in sections 3 and 4.

5.1     Improving Measurement with Customs Data
Customs micro-level datasets are highly informative about international trade flows since they report the
universe of firm-level imports and exports. With some assumptions − as discussed in section 2.4.1 − this
data delivers the use of foreign inputs from each specific source relative to overall foreign input expenditure
shares. For example, the measured share of U.S. car part inputs in Mexican final good car exports to the
U.S. equals
                                        aF ({USA, cars} |{MEX, cars} , USA )
                            P               P                                           = 47%.                                  (32)
                                              k 00 ∈K aF ({j , k } |{MEX, cars} , USA )
                                                            00 00
                                j 00 ∈J\MEX

To fix ideas, the 74% in figure 1 corresponds to the aggregate share across all U.S. manufacturing inputs
                           P
(i.e. summing (32) across k 00 ∈K delivers 74%).41
      This information delivers crucial insights into how supply chains are linked across borders, but cannot
be used to measure GVC flows directly. This occurs because customs datasets contain no information on
domestic transactions and thus do not reveal the connection between relative foreign input expenditures
and overall input expenditure shares. In other words, the denominator in (32) cannot be measured in
customs data because it requires knowing what share of overall output value is spent on foreign inputs −
which requires knowing the expenditure on domestic input purchases and domestic value-added.
      Nonetheless, knowing that U.S. car parts account for 47% of all foreign inputs in U.S.-bound car ex-
ports is very useful information and the next two sections propose two new approaches for using this
information systematically to improve measurement. These represent a middle ground between the pure
measurement and roundabout approaches: they complement the input-output data with firm-level data
   40
       Other papers have studied GVCs when incorporating firm-level data (recent examples include Fetzer et al. 2018, Michel
et al. 2018, Tang et al. 2018). Whereas the traditional focus has been to further disaggregate input-output tables, this section
makes three broader contributions. First, it is based on a GVC framework that explicitly connects GVC measurement with both
the literatures on value-added trade and on quantitative trade models. Second, it develops an entirely new approach to GVC
measurement: the bounds approach. Third, this section’s two measurement frameworks are not restricted to one specific context
or dataset but are quite general and can be used in a variety of settings while exploiting different forms of additional information.
    41
       Customs data contains import transactions by country-industry source − and the subsequent analysis is implemented at
this level of aggregation. Figures 1 and 2 describe foreign input expenditure shares at the country level to keep the charts tidy.



                                                                 35
while imposing some assumptions to fill in the gaps induced by the lack of domestic transactions data.

5.2     Disentangling GVCs: Narrowing the Bounds
Measurement can be improved through a first approach in which additional information is used to narrow
the specialized inputs bounds. I do this by exploiting the new information through additional constraints
on the bounds optimization problems described above.
      For example, a natural set of constraints to impose with customs data is to ensure that GVCs respect
the distribution of foreign input expenditures − regardless of the use of domestic inputs or value-added.
In other words, from (32) it is natural to impose
                                                                       P        P
   aF ({USA, cars} |{MEX, cars} , USA ) 6 (47% + ∆)                                    aF ({j 00 , k 00 } |{MEX, cars} , USA ) ,
                                                                 j 00 ∈J\MEX k 00 ∈K
                                                                       P        P                                                  (33)
   aF ({USA, cars} |{MEX, cars} , USA ) > (47% − ∆)                                    aF ({j 00 , k 00 } |{MEX, cars} , USA ) .
                                                                 j 00 ∈J\MEX k 00 ∈K


For now, assume that ∆ = 0 so that these two inequality constraints imply a single equality constraint.
This ensures that U.S. car parts account for 47% of all foreign inputs in Mexican car exports to the U.S.
regardless of whether the overall use of foreign inputs is large or small. In other words, the information in
customs data is fully exploited without taking a stand on whether Mexican car exports use a lot of domestic
inputs and value-added or not. What the constraints do imply, however, is that whenever foreign inputs
are used, then 47% have to be U.S. car parts. Imposing these additional constraints across all sources and
destinations on the above optimization problems thus delivers value-added and counterfactual bounds
based on GVCs that both fit the input-output data and respect the information contained in customs data;
see appendix section E.1 for details.
      More generally, ∆ > 0 is useful since customs data contains information on trade from all sources
and to all destinations and thus imposes a large number of additional constraints. This is problematic
numerically because constraining the optimization so heavily can lead to either no feasible solutions or
to severely distorted bounds.42 By giving the expenditure shares some slack, the problem is more easily
implemented numerically. Hence, the ensuing results include inequality constraints with ∆ = 0.05.
      Table 1 shows the restricted specialized inputs bounds when exploiting Mexican customs data through
linear constraints in the bounds optimization problems. For reference, column I lists the roundabout point
estimates while columns II and III list the (unrestricted) specialized inputs bounds from figures 4 and 8.
The restricted bounds in columns IV and V are built using exactly the same procedure as the bounds in
columns II and III but when incorporating the whole set of inequality constraints as exemplified above.
Appendix section A.6 depicts a graphical comparison of both the restricted and unrestricted bounds.
      Regarding value-added, table 1 reveals that the restricted lower bounds are similar whereas the re-
stricted upper bounds fall substantially relative to the unrestricted bounds. For manufacturing as a whole,
the bounds tighten from 3-52% to 5-35%. On the one hand, the lower bounds correspond to GVCs in which
the use of non-U.S. inputs is maximized − effectively maximizing the use of Mexican inputs. The lower
    42
       For example, if the constraints are all equalities then perfectly hitting some tiny expenditure shares, such as the relative use
of inputs from small countries like Luxembourg or Malta, can severely impact the expenditure shares of larger countries.


                                                                  36
                                                Roundabout            Specialized Inputs Bounds
                                                   Point           Unrestricted          Restricted
                                                 Estimates        Lower Upper         Lower Upper
          U.S. Value-Added in
                                                      I              II       III         IV       V
          Mexican Imports (%)
          Total Manufactures                         18              3        52          5        35
          Basic Metals                                9              0        31          0         9
          Chemicals                                  17              3        63          7        49
          Coke, Refined Oil Products                 14              3        78          7        78
          Computers, Electronics                     23              2        58          5        20
          Electrical                                 19              5        51          6        32
          Food, Tobacco                               9              3        55          3        55
          Machinery                                  14              3        41          5        28
          Metal Products                             14              3        59          3        41
          Motor Vehicles                             17              5        52          5        43
          Non-Metallic Minerals                       8              0        47          0        47
          Other Transport                            16              2        44          3        38
          Pharmaceuticals                             9              1        39          1        30
          Rubber, Plastics                           19              2        58          5        54
          Textiles                                   12              2        40          4        31
          Wood, Paper                                14              2        49          4        44


          U.S. Increases Trade Barriers on
          Mexican Final Goods by 100%
          Mexico Welfare Loss                       0.85           0.21      1.40        0.29     1.37
          U.S. Welfare Loss                         0.09           0.07      0.13        0.07     0.11

          Mexico Increases Trade Barriers on
          U.S. Intermediate Inputs by 100%
          Mexico Welfare Loss                       1.39           0.71      2.73        0.84     2.67
          U.S. Welfare Loss                         0.11           0.07      0.14        0.08     0.14

        Table 1: Bounds on the U.S. Value-Added in U.S Imported Mexican Final Goods and on the Welfare
        Costs of a NAFTA Trade War: Column I is computed with the roundabout GVCs while columns
        II and III correspond to the specialized inputs bounds depicted in figures 4 and 8. The restricted
        bounds in columns IV and V are computed using the same procedure as the unrestricted bounds
        in columns II and III but when adding the linear constraints as in equation (33) based on Mexican
        customs data. Input-Output data is from the 2014 WIOD.


bounds change little because the relative use of foreign inputs is largely irrelevant and thus assuming a
given share of U.S. inputs in the latter imposes effectively few new constraints. On the other hand, the
restricted upper bounds fall substantially because the unrestricted bounds correspond to GVCs in which
exports to the U.S. use mostly U.S. inputs. Imposing the customs data lowers these bounds by shifting out
U.S. inputs until a specific mix of foreign inputs is obtained. Computers and electronics are a particularly
illustrative example since the customs data shows that, in reality, U.S. inputs in this industry are rarely
used to produce exports to the U.S. (remember figure 2). Hence, while the input-output data is consistent
with a high share of U.S. value in computers and electronics exports, the customs data severely restricts

                                                          37
the use of U.S. inputs and thus lowers the upper bound from 58% to 20%. Interestingly, the roundabout
point estimate for computers and electronics (23%) is actually outside of the restricted bounds.43
      Regarding NAFTA counterfactuals, the restricted bounds change only in the specific cases in which
the customs data constrains the relevant GVC flows substantially. For example, when trade barriers on
Mexican final goods increase, all bounds are relatively unchanged except the upper bound for U.S. welfare.
The latter falls because the highest U.S. welfare cost is associated with GVCs in which Mexican exports
to the U.S. get built exclusively with U.S. inputs (remember figure 8). Incorporating the customs data
lowers the upper bound since it prescribes a high, but lower than one, share of U.S. inputs in terms of
overall foreign inputs. The other bounds are less directly associated with U.S. intermediate inputs and thus
change little. In the second counterfactual, the lower bounds increase slightly because they correspond to
GVCs in which U.S. inputs are used in sales to countries other than the U.S. and Mexico. However, since
customs data requires these exports to have a certain share of other foreign inputs whenever U.S. inputs
are used, this ends up limiting the amount of U.S. inputs that can be shifted out of domestic sales and
exports to the U.S. The net effect is to increase the lower bounds slightly.
      Overall, table 1 shows that currently available information, such as that in customs data, can be used
straightforwardly in conjunction with input-output data to improve measurement without further assump-
tions. The constraints in (33) are specific to this context, and can be immediately applied when customs
datasets for other countries are available, but are also easily adjusted depending on the type of available
data. For example, Conconi et al. (2018) showed that rules-of-origin − which incentivize Mexican ex-
porters to use a high share of U.S. inputs in exports to the U.S. − have important trade diverting effects
in the NAFTA region. Hence, if one did not have customs data, one could instead adapt the NAFTA rules-
of-origin criteria into additional linear constraints as in (33) in order to ensure that Mexico’s exports to
its NAFTA partners embody more NAFTA inputs than exports to other countries. This would narrow the
specialized inputs bounds as in table 1 and deliver insights into how GVCs are linked in the NAFTA region.

5.3     Disentangling GVCs: Constructing New Point Estimates
Alternatively, measurement can be improved through a second approach in which additional information
is used to construct a specific set of GVCs delivering value-added and counterfactual point estimates. This
approach is more stringent than the bounds approach since it requires imposing additional assumptions in
order to move from measuring bounds to point estimates, but, nonetheless improves measurement relative
to the roundabout estimates since it based on more data and less assumptions than the latter. This approach
is useful since both policy and academic debates often require having specific numbers in mind.
      I measure new point estimates by exploiting additional information through the objective function of
a minimum-cost flow problem. Specifically, I propose a new GVC measurement framework that exploits
    43
       The restricted and unrestricted upper bounds are the same for coke and refined oil products, food and tobacco, and non-
metallic minerals since these industries rely mostly on agricultural and mining intermediate inputs. Since the share of U.S. inputs
from the latter industries greatly exceeds the share of output sold to the U.S., there exist GVC flows in which these exports are
built entirely with U.S. inputs. Further, since customs data only has manufacturing inputs, this information does not constrain
agricultural and mining input shares and thus the restricted bounds are unchanged.




                                                                38
this new information in conjunction with input-output data as follows
                                                                                                                                         
                         aX s 00 s 0 , s s 00 ∈S,s∈S , βX s 0 , s s∈S , aF s 00 s 0 , j s 00 ∈S,j∈J , βF s 0 , j
                                                                                                              
   min              h                                                                                                                   j∈J
                                                                                                                                                  ,
                                 X                               X
                    X s 00 , s 0 =      aX s 00 s 0 , s X s 0 , s +  aF s 00 s 0 , j F s 0 , j , ∀s 00 ,
                                                                                            
subject to
                                               s∈S                                              j∈J
                     X
                                          00       0                     0
                                                                            
                              aX s             s , s + βX s , s = 1, ∀s,                                                                  (34)
                    s 00 ∈S
                     X
                              aF s 00 s 0 , j + βF s 0 , j = 1, ∀j,
                                                         

                    s 00 ∈S

                    aX s 00 s 0 , s , aF s 00 s 0 , j , βX s 0 , s , βF s 0 , j > 0, ∀s 00 , s, j.
                                                                            


The objective function h (·) depends on the endogenous input and value-added expenditure shares and
(potentially) some exogenous parameters. For example, a simple and tractable objective function is given
by targeting exogenous values for each share and minimizing the weighted sum of squared deviations
          X X                                                  2 X
             ω0X s 00 s 0 , s aX s 00 s 0 , s −a0X s 00 s 0 , s + ω0X s 0 , s βX s 0 , s −β0X s 0 , s
                                                                                                2
h (·) =
          s 00 ∈S s∈S                                                                                    s∈S
           X X                                                                                      2 X 0 0  
                                     00        0                   00    0                 00    0
                                                                                                         ωF s , j βF s 0 , j − β0F s 0 , j .
                                                                                                                                      2
      +                   ω0F    s         s ,j             aF s        s ,j −   a0F   s        s ,j +
          s 00 ∈S   j∈J                                                                                 j∈J


In this case, a0X (s 00 |s 0 , s ), a0F (s 00 |s 0 , j ), β0X (s 0 , s), and β0F (s 0 , j) are targets for the endogenous variables
and ω0X (s 00 |s 0 , s ), ω0F (s 00 |s 0 , j ), ω0X (s 0 , s), and ω0F (s 0 , j) correspond to the weights on each target. While
other objective functions can be used, I focus on this quadratic form since it is the simplest nonlinear
function that can be solved in high dimensions (i.e., it has linear first-order conditions).44
   Both the targets and the weights in h (·) are chosen by the researcher and this is where the additional
information is used to discipline the GVC flows. The constraints on (34) restrict the search to GVC flows
consistent with the input-output data and it is in this sense that the optimization exhausts the information
contained in the latter. The additional information is then used to pin down a specific set of GVC flows,
out of this restricted set, through the objective function by ensuring that the constructed GVCs are the
closest to the researcher’s targets in the sense of minimizing the objective function.
    Conceptually, this measurement framework can be thought of as a variant of a minimum-cost flow
problem in which the flow across two nodes is fixed and given by the bilateral flows across any two country-
industries in the input-output data. The optimization then finds the specialized inputs GVC flows crossing
through multiple nodes that are optimal in the sense of minimizing the deviation from the researcher’s
targets (i.e. the flow cost is the penalty of deviating from these targets). These GVC flows are better
measured as long as the researcher’s targets are closer to the true GVC flows underlying input-output than
the roundabout GVCs. A graphical description conveying the intuition of this measurement framework is
described in Appendix section E.3 and is a useful companion to the main text.
    This measurement framework is useful whenever the additional information is insufficient for mea-
   44
      This approach follows a long tradition of exploiting linearity to solve for high-scale optimization problems in economics
and developed by such giants as Kantorovich (1939), Koopmans and Beckmann (1957), Dorfman et al. (1958), and Dantzig (1963).


                                                                                       39
suring GVC flows directly, as in the case of customs data described in section 5.1. This procedure provides
a workaround by letting a researcher take a stand on how to map the customs data into the input shares
through the targets. For example, if one takes the stand that Mexico does only processing trade − i.e.
that imported inputs are only used to produce exports and that exports only use imported inputs − then
the foreign expenditure shares in (32) can easily be mapped into overall expenditure shares since the de-
nominator simply equals the aggregate input expenditure share. In general, though, researcher’s targets
will not aggregate up to the input-output data since they are based on additional information plus some
auxiliary assumptions. This is where the optimization problem (34) comes in: it reallocates flows in order
to deliver GVC flows that aggregate up to the input-output data while also respecting the researcher’s
targets. In sum, while both the roundabout GVCs and the GVCs built through (34) ultimately depend on
some assumptions, the latter are built by replacing some assumptions with additional information and thus
should be closer to the true GVCs underlying input-output data.
    In terms of numerical implementation, careful inspection of (34) reveals the problem is defined for a
specific country-industry s 0 . That is, (34) delivers input shares from all sources s 00 in the production of in-
termediates sold to all country-industries s and countries j. This problem is larger than the multi-industry
counterfactual bounds in (31) since the latter has more structure because the upper tier Cobb-Douglas pro-
duction function requires only searching for the input shares from suppliers within industry k 00 . However,
it is a smaller problem than the multi-industry value-added bounds in (15) which requires searching over
the full GVC network and thus for input shares across all country-industries s 0 simultaneously. While
the measurement problem (34) is also large and nonlinear, exact solutions can be computed (see appendix
section E.2 for implementation details). Overall, measuring a full GVC network when minimizing the
weighted sum of squared deviations requires choosing a set of weights and targets and solving S optimiza-
tion problems, one for each s 0 ∈ S, of size (S + 1) × (S + J) each.45
    Table 2 presents value-added and counterfactual point estimates based on GVCs constructed through
(34). Specifically, column I presents the roundabout point estimates while columns II and V correspond
to the GVC networks in which the customs data is mapped into the targets by assuming a full processing
trade assumption. For example, in the case of U.S. car parts used in Mexican car exports to the U.S. in (32),
the target becomes

                  a0F ({USA, cars} |{MEX, cars} , USA ) = 47% × 1 − β0 ({MEX, cars} , USA) .
                                                                                          
                                                                                                                             (35)

The GVCs underlying column II assume that the value-added share is common in all output so that the
value-added target equals β0 ({MEX, cars} , USA) = GDP({MEX, cars})/GO({MEX, cars}). Column V in-
stead assumes that exports have a 50% higher and domestic sales have a 50% lower value-added share than
the overall value-added share and thus β0 ({MEX, cars} , j) = 1.5 × GDP({MEX, cars})/GO({MEX, cars})
when j 6= MEX and with a multiple of 0.5 when j = MEX. To summarize, the value-added and welfare
numbers in columns II and V are those based on GVCs in which the Mexican expenditure shares are built
     45
        The problem cannot be made smaller without further structure because the input shares across suppliers and destinations of
s 0 are interlinked through the constraints. The problem can be generalized, though, by choosing an objective function featuring
complementarities across country-industries s 0 ∈ S and thus solving for the full GVC network in a single optimization problem.



                                                               40
                                                           Roundabout                     Specialized Inputs Point Estimates
                                                              Point                  Common V.A. Share        Low Export V.A. Share
                                                            Estimates               100% 75% DKWW             100% 75% DKWW
                                                                                     P.T. P.T.     P.T.        P.T.    P.T.   P.T.
     U.S. Value-Added in
                                                                   I                   II        III         IV                V         VI           VII
     Mexican Imports (%)
     Total Manufactures                                           18                  27         25          26                30        30           30
     Basic Metals                                                  9                   5          5           5                 6         4            4
     Chemicals                                                    17                  33         29          24                37        34           27
     Coke, Refined Oil Products                                   14                  47         23          17                25        24           16
     Computers, Electronics                                       23                  13         15          13                16        18           16
     Electrical                                                   19                  25         25          26                28        28           30
     Food, Tobacco                                                 9                  37         31          29                38        36           36
     Machinery                                                    14                  20         20          21                24        25           25
     Metal Products                                               14                  27         26          26                32        29           29
     Motor Vehicles                                               17                  37         33          37                39        39           40
     Non-Metallic Minerals                                         8                  24         22          21                17        18           20
     Other Transport                                              16                  24         24          24                30        30           30
     Pharmaceuticals                                               9                  15         15          12                24        22           23
     Rubber, Plastics                                             19                  34         32          31                41        38           39
     Textiles                                                     12                  24         24          25                26        28           29
     Wood, Paper                                                  14                  33         29          29                38        35           35

     U.S. Increases Trade Barriers on
     Mexican Final Goods by 100%
     Mexico Welfare Loss                                         0.85                0.56       0.55        0.52              0.48      0.38         0.37
     U.S. Welfare Loss                                           0.09                0.10       0.10        0.10              0.10      0.11         0.11

     Mexico Increases Trade Barriers on
     U.S. Intermediate Inputs by 100%
     Mexico Welfare Loss                                         1.39                1.05       1.11        1.18              0.89      0.91         0.97
     U.S. Welfare Loss                                           0.11                0.12       0.12        0.12              0.13      0.12         0.12

            Table 2: Point Estimates for the U.S. Value-Added in U.S Imported Mexican Final Goods and the
            Welfare Costs of a NAFTA Trade War: Column I is computed with the roundabout GVCs while
            columns II-VII correspond to the GVCs obtained through (34) when disciplining the targets with
            Mexican customs data. Columns II-IV assume common value-added shares in all Mexican output
            while columns V-VII assume 50% lower value-added shares in exports than in domestically-sold
            output. Columns II and V further impose a full processing trade assumption on exports, columns
            III and VI impose a 75% processing trade assumption on exports, and columns IV and VII assume
            the industry-level processing trade shares in De La Cruz et al. (2011) (see table 7 of that paper).


through (34) when defining the targets across all sources and destinations as in (35) and with column
II imposing common value-added shares and column V lower value-added shares in exports.46 Finally,
since computing both value-added and general counterfactuals requires the full set of GVC flows across all
    46
       I define the objective function weights as ω0X (s 00 |s 0 , s ) = a0X (s 00 |s 0 , s ) X (s 0 , s), ω0F (s 00 |s 0 , j ) = a0F (s 00 |s 0 , j ) F (s 0 , j),
ω0X (s 0 , s) = β0X (s 0 , s) X (s 0 , s), and ω0F (s 0 , j) = a0F (s 0 , j) F (s 0 , j). These are designed to put more weight on the targets corre-
sponding to bilateral trade flows which are more important and to the most important input suppliers therein.




                                                                               41
countries, I proceed conservatively and keep the roundabout expenditure shares in all other countries.47
     The main takeaway from columns II and V is that Mexican-American supply chains are more inte-
grated than as suggested by conventional estimates. For example, in motor vehicles − the largest im-
ported manufacturing industry − the U.S. imports back around 37-39% of its own domestic value whereas
the roundabout estimates predict a smaller share of only 17%. For overall manufacturing, the U.S. share
is about 27-30% and also substantially higher than the roundabout estimate of 18%. These differences are
in line with the input shares observed in figure 2: while the customs data show that Mexico uses a high
share of American inputs to produce exports to the U.S., these estimates trace value across all stages of
production and confirm that a large part of these exports is American value-added. While the roundabout
approach waters down the U.S. content in exports to the U.S. by assuming a common U.S. content share in
all exports, the specialized inputs point estimates increase the U.S. content in exports to the U.S. and lower
it in exports to other countries (with the exception of computers and electronics).
     In terms of counterfactuals, incorporating the deep integration between the U.S and Mexico increases
the U.S. welfare loss of a NAFTA trade war and decreases Mexican losses. These opposing effects are due
to the asymmetric implications of Mexican customs data for each country: increasing the share of U.S.
inputs in U.S.-bound Mexican exports increases the exposure of U.S. consumers to a NAFTA trade war
while decreasing the exposure of Mexican consumers. However, note that I targeted the roundabout input
shares within the U.S. since I do not have U.S. customs data. This suggests that incorporating the latter
− which would likely reveal a high share of Mexican inputs in Mexican-bound exports − would further
adjust the welfare estimates. Relative to the narrowing bounds approach in table 1, table 2 shows that
improving the estimates for general counterfactuals depends crucially on both the GVC linkages observed
in customs data and also on taking a stand on the domestic links within the Mexican economy. While
improving value-added trade measures through the narrowing bounds approach yields important insights,
improving counterfactual estimates is better done through the procedure in (34).
     These estimates are thus based on three building blocks: 1) input-output data, 2) customs data, and 3)
a full processing trade assumption. The latter is reasonable since Mexico is one of the two large countries
in which processing trade is widely prevalent (the other is China). For example, De La Cruz et al. (2011)
show that in 2003 about 96.6% of transportation equipment exports were processing trade of which 74% is
foreign value-added. More generally, that exports use a higher share of imported inputs than domestically-
sold goods is a fairly common feature across countries (see Kee and Tang 2016 for evidence on China and
Tintelnot et al. 2017 on Belgium). Furthermore, the low domestic value-added shares in exports in column
V is also supported by previous evidence such as De La Cruz et al. (2011) and Koopman et al. (2012). Finally,
note that table 2’s results are conservative since the underlying GVCs are only better measured for Mexico
− remember that the GVC flows across all other countries are still given by the roundabout GVCs − and
would likely rise when also improving measurement elsewhere (especially in the U.S. and Canada).
     That said, one might still object to the full processing trade assumption as being reasonable. Table 2’s
other columns present the results when implementing the measurement framework (34) with alternative
    47
      That is, when s 0 ∈ (J\MEX) × K I set aX (s 00 |s 0 , s ) = aF (s 00 |s 0 , j ) = X (s 00 , s 0 ) /GO (s 0 ) . To fix ideas, note that solving
(34) with the roundabout shares as targets in all countries delivers the roundabout GVCs.



                                                                        42
auxiliary assumptions. Columns III and VI relax the processing trade assumption and repeat the exercises
of columns II and V, but when assuming that 75% of Mexican exports correspond to a processing trade
regime and 25% correspond to a standard export regime.48 Columns IV and VII instead assume that the
degree of processing trade varies across industries and is given by the shares found by De La Cruz et al.
(2011) for Mexico using 2003 data. As is clear, less pervasive processing trade tends to lower U.S. content
shares while but, overall, the U.S. content shares are still much higher than in the roundabout case.49
     More generally, (34) provides a common ground for a systematic conversation on the best practices for
GVC measurement − one based on a GVC theory of specialized inputs and for which explicit connections
to both the literatures on measures of globalization and quantitative trade models were drawn out above.
By delivering specific GVC flows measured with the same input-output data as the standard roundabout
GVCs but disciplined with additional information and less stringent auxiliary assumptions, it provides
researchers with a tool for systematically understanding how these assumptions feed into value-added
trade and counterfactual estimates. Table 2 provides an empirically-based set of numbers exemplifying
how Mexican customs data and processing trade assumptions interact and thus gives grounds for a well-
informed discussion on how specific assumptions map into specific estimates. This same approach can
easily be implemented with other datasets and assumptions − with customs data from many countries
being an ideal setting − and will hopefully be an useful tool for studying GVCs in future research.50


6        Conclusion
In sum, this paper’s message is twofold. First, that conventional GVC flow estimates are potentially mis-
measured and that this trickles down into the answers to both quantitative counterfactuals and the mea-
sures of globalization used to quantify the fragmentation of production across countries. Second, that
by incorporating more information and improving GVC measurement, researchers can then go back and
answer these questions more precisely. While this point is, perhaps, obvious, it has mostly been ignored.
     In particular, Mexican customs data confirms the anecdotal evidence that Mexican-American supply
chains are highly integrated and measuring GVCs while incorporating this information increases the U.S.
content of imported Mexican manufactures and the U.S. welfare cost of a NAFTA trade war. These facts
are in line with the intuition on how GVC linkages magnify the effects of economic shocks (Yi 2003) and
dampen a country’s incentive to manipulate its terms-of-trade: Import tariffs are more costly when imports
    48
     These targets are built as follows. In the case of U.S. car parts in Mexican car exports, the targeted share is
                                                                                                        !
                                          3            1          X ({USA, cars} , {MEX, cars})
aF ({USA, cars} |{MEX, cars} , USA ) =       × 47% + × P
                                                                                                                                      
 0
                                                                                                          × 1 − β0 ({MEX, cars} , USA) .
                                                               j 0 ∈J,k 0 ∈K X ({j , k } , {MEX, cars})
                                          4            4                          0   0


That is, I assume that 75% of these car exports are built exclusively with foreign inputs, with the U.S. share given by the customs
data, and that 25% are built with both foreign and domestic inputs according to the roundabout shares.
    49
       In some cases the U.S. content increases when processing trade falls. Why this happens is best illustrated with computers
and electronics: While the overall industry purchases a lot of U.S. inputs, customs data shows that these inputs are rarely used in
exports to the U.S. Hence, full processing trade imposes the customs input expenditure shares and thus severely lowers the U.S.
content share to 13% in column II. Relaxing processing trade instead puts more weight on regular exports, which I assume are
built using the roundabout shares and thus have high U.S. input shares. This increases the U.S. content to 15% in column III.
    50
       As in the narrowing bounds case, researcher’s can also incorporate more abstract forms of information − such as rules-of-
origin − as long as one takes a stand on how to map such information into the optimization targets.


                                                                  43
have more domestic content because they ripple back and hurt domestic suppliers (Blanchard et al. 2017).
    The avenue for future research is extraordinarily rich. First, section 5’s two measurement approaches
are quite versatile and can be used to conduct many new exercises. In particular, while I have restricted
attention to Mexican customs data, the exact same computations can be immediately implemented with
other countries’ customs data. Further, improving measurement with multiple customs datasets at the
same time would be an ideal setting for studying the global fragmentation of international trade more
precisely. Second, these new measurement frameworks may be a useful stepping-stone towards future
alternative and more effective frameworks that also incorporate new information. In this sense, this paper
is only a first step in a research line on the best methods and practices for conducting GVC measurement.
By abandoning the roundabout approach, the possibilities become endless.51


References
Acemoglu, D., V. M. Carvalho, A. Ozdaglar, and A. Tahbaz-Salehi (2012): “The Network Origins of
  Aggregate Fluctuations,” Econometrica, 80, 1977–2016.
Allen, T., C. Arkolakis, and Y. Takahashi (2017): “Universal Gravity,” NBER Working Paper 20787.
Anderson, J. E. (1979): “A Theoretical Foundation for the Gravity Equation,” The American Economic Re-
  view, 69, 106–116.
Anderson, J. E. and E. van Wincoop (2003): “Gravity with Gravitas: A Solution to the Border Puzzie,”
  The American Economic Review, 93, 170–192.
Antràs, P. and D. Chor (2013): “Organizing the Global Value Chain,” Econometrica, 81, 2127–2204.
Antràs, P., D. Chor, T. Fally, and R. Hillberry (2012): “Measuring the Upstreamness of Production and
  Trade Flows,” The American Economic Review, 102, 412–416.
Antràs, P. and A. de Gortari (2017): “On the Geography of Global Value Chains,” NBER Working Paper
  23456.
Antràs, P., T. C. Fort, and F. Tintelnot (2017): “The Margins of Global Sourcing: Theory and Evidence
  from U.S. Firms,” American Economic Review, 107, 2514–2564.
Antràs, P. and R. W. Staiger (2012): “Offshoring and the Role of Trade Agreements,” American Economic
  Review, 102, 3140–3183.
Arkolakis, C., A. Costinot, and A. Rodríguez-Clare (2012): “New Trade Models, Same Old Gains?”
  American Economic Review, 102, 94–130.
Auer, R. A., A. A. Levchenko, and P. Saur (2017): “International Inflation Spillovers Through Input Link-
  ages,” NBER Working Paper 23246.
Balistreri, E. J., R. H. Hillberry, and T. F. Rutherford (2011): “Structural estimation and solution of
  international trade models with heterogeneous firms,” Journal of International Economics, 83, 95–108.
Baqaee, D. R. (2014): “Cascading Failures in Production Networks,” 1–60.
Baqaee, D. R. and E. Farhi (2017): “The Macroeconomic Impact of Microeconomic Shocks: Beyond Hul-
  ten’s Theorem,” NBER Working Paper 23145.
Barrot, J.-N. and J. Sauvagnat (2016): “Input Specificity and the Propagation of Idiosyncratic Shocks in
  Production Networks,” The Quarterly Journal of Economics, 1543–1592.
    51
       Finally, there remains the issue of constructing multi-country input-output datasets themselves accurately. While this pa-
per’s theoretical and numerical procedures are derived with an accurate dataset in mind, the empirical results are all based on
the WIOD. The latter is not free of measurement assumptions and so, in principle, its input-output flows might be mismeasured.
Going forward, new dataset releases are getting more accurate so that this issue becomes less important and, further, I believe
this paper’s insights might be used in future research to better measure both input-output data and GVCs simultaneously. For
example, in the spirit of Batten (1982), Golan et al. (1994), Canning and Wang (2005), and Wang et al. (2010).


                                                               44
Bartelme, D. and Y. Gorodnichenko (2015): “Linkages and Economic Development,” NBER Working
  Paper 21251.
Bastos, P. and J. Silva (2010): “The quality of a firm’s exports: Where you export to matters,” Journal of
  International Economics, 82, 99–111.
Bastos, P., J. Silva, and E. Verhoogen (2018): “Export Destinations and Input Prices,” American Economic
  Review, 108, 353–392.
Basu, S. (1995): “Intermediate Goods and Business Cycles: Implications for Productivity and Welfare,” The
  American Economic Review, 85, 512–531.
Batten, D. F. (1982): “The Interregional Linkages between National and Regional Input-Output Models,”
  International Regional Science Review, 7, 53–67.
Bems, R. (2014): “Intermediate inputs, external rebalancing and relative price adjustment,” Journal of Inter-
  national Economics, 94, 248–262.
Bems, R. and R. C. Johnson (2017): “Demand for Value Added and Value-Added Exchange Rates,” American
  Economic Journal: Macroeconomics.
Bigio, S. and J. La’O (2016): “Financial Frictions in Production Networks,” .
Blanchard, E. J., C. P. Bown, and R. C. Johnson (2017): “Global Value Chains and Trade Policy,” .
Blaum, J., C. Lelarge, and M. Peters (2017a): “Firm Size and the Intensive Margin of Import Demand,” .
——— (2017b): “The Gains From Input Trade With Heterogeneous Importers,” American Economic Journal:
  Macroeconomics, Forthcomin.
Boehm, C. E., A. Flaaen, and N. Pandalai-Nayar (2018): “Input Linkages and the Transmission of Shocks:
  Firm-Level Evidence from the 2011 Tohoku Earthquake,” The Review of Economics and Statistics, Forth-
  comin.
Brambilla, I., D. Lederman, and G. Porto (2012): “Exports, Export Destinations, and Skills,” The American
  Economic Review, 102, 3406–3438.
Brambilla, I. and G. G. Porto (2016): “High-income export destinations, quality and wages,” Journal of
  International Economics, 98, 21–35.
Caliendo, L. and F. Parro (2015): “Estimates of the Trade and Welfare Effects of NAFTA,” Review of
  Economic Studies, 82, 1–44.
Caliendo, L., F. Parro, and A. Tsyvinski (2017): “Distortions and the Structure of the World Economy,”
  NBER Working Paper 23332.
Canning, P. and Z. Wang (2005): “A Flexible Mathematical Programming Model To Estimate Interregional
  Input-Output Accounts,” Journal of Regional Science, 45, 539–563.
Carvalho, V. and X. Gabaix (2013): “The Great Diversification and its Undoing,” The American Economic
  Review, 103, 1697–1727.
Carvalho, V. M. (2014): “From Micro to Macro via Production Networks,” Journal of Economic Perspectives,
  28, 23–48.
Carvalho, V. M., M. Nirei, Y. U. Saito, and A. Tahbaz-Salehi (2016): “Supply Chain Disruptions: Evi-
  dence from the Great East Japan Earthquake,” .
Conconi, P., M. García-Santana, L. Puccio, and R. Venturini (2018): “From Final Goods to Inputs : the
  Protectionist Effect of Rules of Origin,” American Economic Review, Forthcomin.
Costinot, A. and A. Rodríguez-Clare (2014): “Trade Theory with Numbers: Quantifying the Conse-
  quences of Globalization,” in Handbook of International Economics, Elsevier B.V., vol. 4, 197–261.
Costinot, A., J. Vogel, and S. Wang (2012): “An Elementary Theory of Global Supply Chains,” The Review
  of Economic Studies, 80, 109–144.
Cuñat, A. and R. Zymek (2017): “International Value-Added Linkages in Development Accounting,” Work-
  ing paper.
Dantzig, G. B. (1963): Linear Programming and Extensions, Princeton University Press.



                                                     45
De La Cruz, J., R. B. Koopman, Z. Wang, and S.-J. Wei (2011): “Estimating Foreign Value-Added in Mex-
  ico’s Manufacturing Exports,” U.S. International Trade Commission Working Paper.
Dean, J. M., K. C. Fung, and Z. Wang (2011): “Measuring Vertical Specialization: The Case of China,”
  Review of International Economics, 19, 609–625.
Dekle, R., J. Eaton, and S. Kortum (2007): “Unbalanced Trade,” American Economic Review: Papers &
  Proceedings, 97, 351–355.
di Giovanni, J. and A. A. Levchenko (2010): “Putting the Parts Together: Trade, Vertical Linkages, and
  Business Cycle Comovement,” American Economic Journal: Macroeconomics, 2, 95–124.
——— (2013): “Firm entry, trade, and welfare in Zipf’s world,” Journal of International Economics, 89, 283–
  296.
di Giovanni, J., A. A. Levchenko, and I. Mejean (2014): “Firms, Destinations, and Aggregate Fluctua-
  tions,” Econometrica, 82, 1303–1340.
——— (2017): “The Micro Origins of International Business Cycle Comovement,” NBER Working Paper 21885.
Domar, E. D. (1961): “On the Measurement of Technological Change,” The Economic Journal, 71, 709–729.
Dorfman, R., P. A. Samuelson, and R. M. Solow (1958): Linear Programming and Economic Analysis,
  McGraw-Hill.
Dornbusch, R., S. Fischer, and P. A. Samuelson (1977): “Comparative Advantage, Trade, and Payments
  in a Ricardian Model with a Continuum of Goods,” The American Economic Review, 67, 823–839.
Duval, R., N. Li, R. Saraf, and D. Seneviratne (2016): “Value-added trade and business cycle synchro-
  nization,” Journal of International Economics, 99, 251–262.
Eaton, J. and S. Kortum (2002): “Technology, Geography, and Trade,” Econometrica, 70, 1741–1779.
Fally, T. (2012): “Production Staging: Measurement and Facts,” .
Fally, T. and R. Hillberry (2016): “A Coasian Model of International Production Chains,” NBER Working
  Paper 21520, 1–53.
Fetzer, J. J., T. Highfill, K. W. Hossiso, T. F. Howells, E. H. Strassner, and J. A. Young (2018): “Ac-
  counting for Heterogeneity within U.S. Industries: Extended Supply-Use Tables and Trade in Value
  Added Using Enterprise and Establishment Level Data,” NBER Working Paper 25249.
Fieler, A. C., M. Eslava, and D. Y. Xu (2017): “Trade, Quality Upgrading, and Input Linkages: Theory and
  Evidence from Colombia,” American Economic Review, Forthcomin.
Golan, A., G. Judge, and S. Robinson (1994): “Recovering Information from Incomplete or Partial Multi-
  sectoral Economic Data,” The Review of Economics and Statistics, 76, 541–549.
Gopinath, G. and B. Neiman (2014): “Trade Adjustment and Productivity in Large Crises,” American
  Economic Review, 104, 793–831.
Hanson, G. H., R. J. Mataloni, and M. J. Slaughter (2005): “Vertical Production Networks in Multina-
  tional Firms,” The Review of Economics and Statistics, 87, 664–678.
Hatanaka, M. (1952): “Note on Consolidation Within a Leontief System,” Econometrica, 20, 301–303.
Hawkins, D. and H. A. Simon (1949): “Note: Some Conditions of Macroeconomic Stability,” Econometrica,
  17, 245–248.
Head, K. and T. Mayer (2014): “Gravity Equations: Workhorse, Toolkit, and Cookbook,” in Handbook of
  International Economics, Elsevier B.V., vol. 4, 131–195.
Hulten, C. (1978): “Growth Accounting with Intermediate Inputs,” The Review of Economic Studies, 45,
  511–518.
Hummels, D., J. Ishii, and K.-M. Yi (2001): “The nature and growth of vertical specialisation in world
  trade,” Journal of International Economics, 54, 75–96.
Johnson, R. C. (2014a): “Five Facts about Value-Added Exports and Implications for Macroeconomics and
  Trade Research,” Journal of Economic Perspectives, 28, 119–142.
——— (2014b): “Trade in Intermediates and Business Cycle Comovement,” American Economics Journal:
  Macroeconomics, 6, 39–83.

                                                   46
——— (2017): “Measuring Global Value Chains,” NBER Working Paper 24027.
Johnson, R. C. and A. Moxnes (2016): “Technology, Trade Costs, and the Pattern of Trade with Multistage
  Production,” .
Johnson, R. C. and G. Noguera (2012): “Accounting for Intermediates: Production Sharing and Trade in
  Value Added,” Journal of International Economics, 86, 224–236.
Jones, C. I. (2011): “Intermediate Goods and Weak Links in the Theory of Economic Development,” Amer-
  ican Economic Journal: Macroeconomics, 3, 1–28.
——— (2013): “Misallocation, Input-Output Economics, and Economic Growth,” in Advances in Economics
  and Econometrics, ed. by D. Acemoglu, M. Arellano, and E. Dekel, Cambridge University Press, tenth
  worl ed.
Kantorovich, L. V. (1939): Mathematicheskie Metody Organizatsii i Planirovania Proizvodstva, Leningrad
  State University Publishers.
Kee, H. L. and H. Tang (2016): “Domestic Value Added in Exports: Theory and Firm Evidence from China,”
  American Economic Review, 106, 1402–1436.
Kikkawa, A. K., G. Magerman, and E. Dhyne (2017): “Imperfect Competition and the Transmission of
  Shocks: The Network Matters,” .
Koopman, R., Z. Wang, and S.-J. Wei (2012): “Estimating domestic content in exports when processing
  trade is pervasive,” Journal of Development Economics, 99, 178–189.
——— (2014): “Tracing Value-Added and Double Counting in Gross Exports,” American Economic Review,
  104, 459–494.
Koopman, R., Z. Wang, S.-J. Wei, and K. Zhu (2018): “A Comparison of Two Approaches to Gross Trade
  Decomposition,” .
Koopmans, T. C. and M. Beckmann (1957): “Assignment Problems and the Location of Economic Activi-
  ties,” Econometrica, 25, 53–76.
Krugman, P. and A. J. Venables (1995): “Globalization and the Inequality of Nations,” The Quarterly
  Journal of Economics, 110, 857–880.
Leontief, W. (1941): The Structure of American Economy 1919-1929: An Empirical Application of Equilibrium
  Analysis, Oxford University Press.
Linden, G., K. Kraemer, and J. Dedrick (2011): “Innovation and Job Creation in a Global Economy: The
  Case of Apple’s iPod,” Journal of International Commerce and Economics, 3, 223–239.
Long, J. B. and C. I. Plosser (1983): “Real Business Cycles,” Journal of Political Economy, 91, 39–69.
Los, B., M. P. Timmer, and G. J. de Vries (2016): “Tracing Value-Added and Double Counting in Gross
  Exports: Comment,” The American Economic Review, 106, 1958–1966.
Ludema, R. D., A. M. Mayda, M. Yu, and Z. Yu (2018): “The political economy of protection in GVCs:
  Evidence from Chinese micro data,” .
Manova, K. and Z. Yu (2016): “How firms export: Processing vs. ordinary trade with financial frictions,”
  Journal of International Economics, 100, 120–137.
Manova, K. and Z. Zhang (2012): “Export Prices and Destinations,” The Quarterly Journal of Economics,
  127, 379–436.
McManus, M. (1956): “On Hatanaka’s Note on Consolidation,” Econometrica, 24, 482–487.
Michel, B., C. Hambÿe, and B. Hertveldt (2018): “The Role of Exporters and Domestic Producers in
  GVCs: Evidence from Belgium Based on Extended National Supply-And-Use Tables Integrated into a
  Global MultiRegional Input-Output Table,” NBER Working Paper 25155.
Nunn, N. (2007): “Relationship-Specificity, Incomplete Contracts, and the Pattern of Trade,” The Quarterly
  Journal of Economics, 122, 569–600.
Oberfield, E. (2018): “A Theory of Input-Output Architecture,” Econometrica, 86, 559–589.
Ossa, R. (2015): “Why trade matters after all,” Journal of International Economics, 97, 266–277.
Popper, K. R. (1959): The Logic of Scientific Discovery, London: Hutchinson.

                                                   47
Rauch, J. E. (1999): “Networks versus markets in international trade,” Journal of International Economics,
   48, 7–35.
Samuelson, P. A. (1951): “Abstract of a Theorem Concerning Substituteability in Open Leontief Models,” in
   Activity Analysis of Production and Allocation, ed. by T. C. Koopmans, John Wiley & Sons, Inc., 142–146.
——— (1952): “Spatial Price Equilibrium and Linear Programming,” The American Economic Review, 42,
   283–303.
Schott, P. K. (2004): “Across-Product versus Within-Product Specialization in International Trade,” The
   Quarterly Journal of Economics, 119, 647–678.
Solow, R. M. (1952): “On the Structure of Linear Models,” Econometrica, 20, 29–46.
Tang, H., F. Wang, and Z. Wang (2018): “Domestic Segment of Global Value Chains in China under State
   Capitalism,” .
Timmer, M. P., E. Dietzenbacher, B. Los, R. Stehrer, and G. J. de Vries (2015): “An Illustrated User Guide
   to the World Input-Output Database: The Case of Global Automotive Production,” Review of International
   Economics, 23, 575–605.
Tintelnot, F., A. K. Kikkawa, M. Mogstad, and E. Dhyne (2017): “Trade and Domestic Production
   Networks,” .
Trefler, D. and S. C. Zhu (2010): “The structure of factor content predictions,” Journal of International
   Economics, 82, 195–207.
Wang, Z., M. Gehlhar, and S. Yao (2010): “A globally consistent framework for reliability-based trade
   statistics reconciliation in the presence of an entrepôt,” China Economic Review, 21, 161–189.
Wang, Z., W. Shang-Jin, and K. Zhu (2013): “Quantifying International Production Sharing at the Bilateral
   and Sector Levels,” NBER Working Paper 19677.
Yi, K.-M. (2003): “Can Vertical Specialization Explain the Growth of World Trade?” Journal of Political
   Economy, 111, 52–102.
——— (2010): “Can Multistage Production Explain the Home Bias in Trade?” The American Economic Review,
   100, 364–393.




                                                    48
A      Additional Results
A.1     Evidence for Specialized Inputs from Domestic Input-Output Tables
Figure 9 summarizes the industry aggregation bias across all U.S. manufacturing as proxied by the coef-
ficient of variation−standard deviation relative to mean−of input shares from each source within each
3-digit code.52 In the absence of aggregation bias, there is no heterogeneity in input shares at the 6-digit
level and the coefficient of variation is zero. Alternatively, when the aggregation is done across industries
with substantial heterogeneity the coefficient of variation is large. Each column in figure 9 corresponds
to a given 3-digit manufacturing industry, with each circle corresponding to the coefficient of variation
of input shares from some 6-digit input supplier across the 6-digit subindustries of the 3-digit industry;
the size of each circle is proportional to the importance of each input supplier. Figure 9 reveals one key
takeaway: There is substantial variation in input shares within each 3-digit industry. For example, the
five biggest circles for computers and electronics are those from the sources in figure 3. The largest circle
corresponds to other electronic components (the most important supplier) and, as figure 3’s right panel
shows, since there is relatively little variation in input shares the coefficient of variation is 0.8. In contrast,
the high variation in computer storage devices visible in figure 3 yields a coefficient of variation of 2.7.




          Figure 9: Variation in Domestic Industry Input Shares in U.S. Manufacturing Sales Across Domes-
          tic Industries: Each circle corresponds to the coefficient of variation − standard deviation relative
          to mean − of the input shares from a specific 6-digit input supplier across all 6-digit subindustries
          within each 3-digit industry on the x-axis. Circle size is proportional to the share of aggregate input
          purchases by the 3-digit industry from each source. In contrast to this chart, assuming the round-
          about solution at the 3-digit industry-level implies zero variation across all 6-digit subindustries.
          Data is from 2007 U.S. input-output tables from the Bureau of Economic Analysis.


    52
       Specifically, for each 3-digit industry k3dig ∈ K3dig I compute the coefficient of variation of the input shares a (t |k ) from a
given source t ∈ K6dig across all the 6-digit subindustries k bundled in k3dig . For example, for the 3-digit industry computers and
electronics, figure 9 plots one circle for the coefficient of variation of a (printed circuit assembly |k ) across all 6-digit subindustries
indexed by k, and another circle for a (computer storage devices |k ). Analogously, across all 6-digit suppliers t ∈ K6dig .



                                                                    49
A.2   Comparing Approximate and Exact Value-Added Bounds
In order to feasibly compute the exact bounds on the value-added decomposition, I aggregate the 2014
WIOD data up to the single-industry dimension and include only the largest seven countries, plus Mexico,
plus a rest of world composite. This smaller input-output dataset implies that the optimization problem
(15) is characterized by 1,458 endogenous variables and 273 linear constraints when imposing constant
value-added shares (i.e. β (j 0 , j) = GDP (j 0 ) /GO (j 0 ) for all j).
    Table 3 presents both the exact and approximate bounds on the share of value-added from each country
in the final good exports that Mexico sells to each country. In other words, it has the bounds on the share
VA (j |MEX, j ) /F (MEX, j) for each j in the table. For example, the last row corresponds to the bounds
on the share of U.S. value-added returning home through Mexican final good exports while the second
row of numbers captures the share of Chinese value-added returning home through Mexican final good
exports. The exact lower and upper bounds are the same across all countries (except Mexico) because it
turns out that the aggregate amount of inputs used in each country’s final good imports from Mexico are
lower than each country’s input exports to Mexico. That is, X (j, MEX) > (1 − β (MEX)) F (MEX, j). Since
β (MEX) = 58%, this implies that up to 42% of these final good exports is foreign value-added. Further,
since each country exports more than enough inputs to cover these input requirements, the share of each
country’s value-added returning home is at most 42%. On the other hand, the lower bound is 0% because
Mexico’s final good exports can always be produced using inputs from countries different to the importer
of the final goods.
    As is clear, the approximate bounds are very close to the true bounds. While this exercise cannot be
repeated in larger datasets since the exact bounds cannot be computed, this exercise suggests that the
approximate bounds are probably close to the true bounds in most cases.


                                                    Approximate Bounds          Exact Bounds
                                  Roundabout
                                                    Lower     Upper            Lower Upper
                  Brazil               0.2            0.0      39.3              0.0     42.0
                  China                1.5            0.0      42.0              0.0     42.0
                  France               0.2            0.0      40.2              0.0     42.0
                  Germany              0.6            0.1      41.8              0.0     42.0
                  Japan                0.7            0.1      42.0              0.0     42.0
                  Mexico              83.0           75.9      92.2             75.8     92.6
                  U.K.                 0.2            0.0      41.5              0.0     42.0
                  U.S.                 8.6            0.0      39.5              0.0     42.0


        Table 3: Approximate and Exact Bounds on the Share of Value-Added Returning Home Through
        Mexican Final Good Exports: The approximate bounds correspond to either the second-order or
        third-order bounds on the decomposition in (13) computed with (16) when N = 2 or N = 3,
        whichever is more extreme, and with common value-added shares. The exact bounds correspond
        to the optimization problem in (15). Data is from the 2014 WIOD aggregated up to the level of nine
        countries and a single industry per country.




                                                       50
A.3                                U.S.-China Value-Added Trade Deficit
Johnson and Noguera (2012) and Johnson (2014a) showed the trade deficit looks less extreme if it is com-
puted as the difference between the U.S. value consumed in China and the Chinese value consumed in the
U.S. instead of the difference in gross exports between the two countries. But is it really true that the U.S.-
China trade deficit is smaller when computed in value-added terms? Figure 10 plots the U.S.-China trade
balance both in gross and value-added terms between 2000-2014. The difference between the gross trade
balance (circles) and the value-added trade balance based on the roundabout solution (diamonds) replicate
previous findings. However, specialized inputs tell a potentially different story.53 The second-order bounds
show that the value-added balance might actually be a surplus or, alternatively, that the value-added deficit
is larger than the gross deficit. Intuitively, the bounds correspond to GVCs in which China exports back
to the U.S. much more (or much less) U.S. value than what the roundabout solution predicts. The bounds
deliver a stark message: The difference between the conventional estimates of value-added and gross trade
balances is dwarfed by the former’s potential mismeasurement.


                                   $100


                                     $0
    Billion Dollars, 2014 Prices




                                   -$100


                                   -$200


                                   -$300


                                   -$400


                                   -$500
                                           2000 2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011 2012 2013 2014




                                    Figure 10: U.S.-China Trade Imbalances: The series with circles corresponds to the gross trade
                                    balance. The other three series correspond to the value-added trade balance. Roundabout point
                                    estimates (diamonds) are based on the input-output analysis decomposition in (14). Specialized in-
                                    puts bounds (triangles) correspond to second-order bounds on the decomposition in (13) computed
                                    with (16) when N = 2 and with common value-added shares. Data is from the 2000-2014 WIOD.




    53
       These bounds are found by replacing the objective function in (15) with the difference between the Chinese consumption of
U.S. value-added and the U.S. consumption of Chinese value-added.


                                                                                   51
A.4   Autarky Gains from Trade


                 % of    Aggregate            Single-Industry              Multi-Industry
       Country
                 World   Domestic            Common        Dest.-Spec.           Common
                                     ACR                                 ACR
                 GDP      Share               Bounds        Bounds                Bounds
       AUS         1.8        87.9    4.5    2.3     4.8   1.9     5.2    7.0    5.9    13.1
       AUT         0.5        68.6   12.0    5.5    16.0   3.9    21.5   19.0   11.7   140.1
       BEL         0.7        57.6   19.6    8.0    34.6   4.7    82.5   30.3   17.2   227.6
       BGR         0.1        67.3   16.4    7.5    22.3   4.8    36.4   26.5   19.7   223.0
       BRA         3.0        88.2    3.0    1.8     3.1   0.9     3.2    3.6    2.7     4.9
       CAN         2.3        78.3    7.3    3.7     8.4   2.6     9.6   12.8    8.9    68.8
       CHE         0.9        77.0    9.3    3.8    11.7   3.8    15.3   13.6    9.2    61.1
       CHN        13.7        93.6    3.8    1.0     4.0   1.0     4.6    3.9    2.3     4.3
       CYP         0.0        68.5   11.3    7.0    13.8   5.1    15.6   19.9   18.2    51.6
       CZE         0.3        64.4   19.3    6.1    31.0   4.8   108.8   31.4   21.1   261.2
       DEU         4.9        76.0    8.5    3.2    10.6   3.1    13.3   11.3    7.4    70.5
       DNK         0.4        65.1   11.6    5.0    16.4   2.9    22.3   20.2   12.9   175.7
       ESP         1.7        80.3    6.6    3.3     7.6   2.2     8.6   10.5    7.3    42.8
       EST         0.0        60.3   19.6    8.6    31.6   6.1    66.2   55.9   37.9   287.9
       FIN         0.3        74.1    9.3    4.3    11.4   2.5    14.1   12.3    8.0    70.5
       FRA         3.5        79.0    6.6    3.5     7.6   2.2     8.4    9.1    6.2    44.7
       GBR         3.7        82.1    6.1    3.3     6.8   2.5     7.4    9.5    6.9    33.7
       GRC         0.3        75.1    7.5    5.1     8.4   3.2     8.9   10.5    8.4    39.7
       HRV         0.1        69.7   10.8    5.6    13.7   3.9    16.8   24.9   20.5   121.6
       HUN         0.2        48.6   25.4   10.1    73.9   4.8   817.3   39.9   22.7   474.5
       IDN         1.2        81.8    5.1    2.6     5.8   1.2     6.4    6.9    5.0    20.5
       IND         2.8        83.9    3.9    2.1     4.2   0.7     4.6    4.7    3.3    20.2
       IRL         0.3        39.7   30.2   10.9      ∞    5.7      ∞    38.4   23.7     ∞
       ITA         2.7        83.4    5.8    2.5     6.6   1.9     7.5    7.2    4.8    28.2
       JPN         6.0        85.3    4.3    2.4     4.6   1.2     4.9    6.2    5.2    10.9
       KOR         1.8        78.2    9.8    2.5    12.2   2.0    18.4   12.7    8.9    39.6
       LTU         0.1        55.8   16.9    8.7    28.8   6.6    39.4   26.3   19.8   176.2
       LUX         0.1        41.1   66.7   11.4      ∞    7.5      ∞    99.5   65.4     ∞
       LVA         0.0        74.6   12.6    5.9    15.5   4.9    20.9   32.3   26.0   140.3
       MEX         1.7        71.6    6.8    4.0     8.2   1.8     9.0   11.2    7.6    41.8
       MLT         0.0        41.2   46.7   16.7      ∞    5.2      ∞    59.9   42.9     ∞
       NLD         1.1        63.2   14.7    5.4    23.5   4.6    41.3   28.9   18.0   217.3
       NOR         0.6        78.0    6.2    2.4     7.5   2.4     8.6    9.3    6.9    28.3
       POL         0.7        74.6   11.0    4.5    13.7   3.7    18.4   17.8   11.1   111.2
       PRT         0.3        74.3    9.0    4.9    10.6   3.2    12.3   14.3    9.9   104.0
       ROU         0.3        75.4    9.7    4.5    11.8   3.0    14.8   14.0   11.6    51.8
       RUS         2.3        90.6    5.0    3.0     5.4   3.0     5.8    6.6    5.8     8.7




                                               52
             % of     Aggregate                Single-Industry                 Multi-Industry
Country
             World    Domestic                Common       Dest.-Spec.                Common
                                      ACR                                    ACR
             GDP       Share                   Bounds       Bounds                     Bounds
 SVK          0.1          59.5       20.8   7.7    36.6   5.4   123.7       40.9   28.4    318.5
 SVN          0.1          65.1       15.3   6.9    21.9   5.8    33.1       24.4   16.3    185.1
 SWE          0.7          74.5        9.2   4.1    11.4   3.5    13.9       12.4    8.0     60.8
 TUR          1.0          78.7        7.0   3.2     8.2   2.1     9.5       11.4    7.8     77.1
 TWN          0.7          66.5       14.4   4.3    21.9   3.0    44.5       18.4   12.2    129.4
 USA         23.1          89.7        2.9   1.9     3.0   1.2     3.1        3.5    2.6      4.0
 ROW         14.2          79.5       10.6   5.8    12.1   3.8    14.6       12.5    8.6     24.5
 Mean         2.3          72.0       12.8   5.2    14.9   3.4    42.5       20.3   14.0    102.8
Weighted     10.6          83.8        6.3   3.0     7.3   2.1    10.6        8.4    5.8     30.0

Table 4: Welfare Gains from Trade Relative to Autarky: The aggregate domestic share refers to the
aggregate share of inputs purchased domestically and is a good proxy for trade openness. Com-
mon bounds refers to common value-added shares across destinations in the single-industry case
and common value-added and industry-level expenditure shares across destinations in the multi-
industry case. The weighted means use world GDP shares as weights. Data is from 2014 WIOD.




                                               53
A.5   Autarky Gains from Trade - Alternative Trade Elasticities
Computing the bounds on the autarky gains from trade does not depend on the elasticities of substitution,
but transforming the extremal GVC flows into welfare numbers does. In particular, note from (28) that the
log gains from trade are proportional to 1/ (1 − σ). Hence, computing the bounds across different levels
of σ only shifts the log bounds on the autarky gains from trade as can be seen in the following two figures.



                                      128%
           Autarky Gains from Trade




                                      64%

                                      32%

                                      16%

                                       8%

                                       4%

                                       2%

                                       1%

                                      0.5%
                                             SWE



                                             ROW




                                              EST
                                              ESP
                                              FRA




                                              PRT




                                              SVK
                                                ITA




                                              TUR




                                              SVN




                                                IRL
                                             RUS




                                             DEU


                                               FIN
                                             CHE



                                             HRV
                                             MEX




                                             KOR
                                               IND



                                               IDN

                                             NOR




                                             GRC




                                             ROU




                                             TWN
                                              LVA



                                              LTU
                                              BEL




                                              LUX
                                              POL

                                              AUT


                                              NLD



                                              CZE
                                             USA
                                             BRA



                                             AUS




                                             CYP
                                             CAN




                                             DNK
                                             CHN




                                             GBR




                                             BGR




                                             HUN
                                              JPN




                                             MLT
        Figure 11: Single-Industry Autarky Welfare Gains from Trade: These bounds are constructed with
        the same GVC flows as figure 6 but with a trade elasticity of 1 − σ = −2.5.




                                      128%
           Autarky Gains from Trade




                                      64%

                                      32%

                                      16%

                                       8%

                                       4%

                                       2%

                                       1%

                                      0.5%
                                             SWE



                                             ROW




                                              EST
                                              ESP
                                              FRA




                                              PRT




                                              SVK
                                                ITA




                                              TUR




                                              SVN




                                                IRL
                                             RUS




                                             DEU


                                               FIN
                                             CHE



                                             HRV
                                             MEX




                                             KOR
                                               IND



                                               IDN

                                             NOR




                                             GRC




                                             ROU




                                             TWN
                                              LVA



                                              LTU
                                              BEL




                                              LUX
                                              POL

                                              AUT


                                              NLD



                                              CZE
                                             USA
                                             BRA



                                             AUS




                                             CYP
                                             CAN




                                             DNK
                                             CHN




                                             GBR




                                             BGR




                                             HUN
                                              JPN




                                             MLT




        Figure 12: Single-Industry Autarky Welfare Gains from Trade: These bounds are constructed with
        the same GVC flows as figure 6 but with a trade elasticity of 1 − σ = −10.


                                                     54
A.6                                Narrowing the Specialized Inputs Bounds

                                  100%
                                  90%
 Share That Is U.S. Value-Added




                                  80%
                                  70%
                                  60%
                                  50%
                                  40%
                                  30%
                                  20%
                                  10%
                                   0%

                                           tal   s     cs      al   er     ry   co         les port icals ucts stics                    .
                                                                                                                                      od ticals Min. etals
                                         To hicle troni ectric Pap hine bac          e xti       n s     m     od     l a      i l Pr      u     ic    M
                                                    c     l       ,    c      o    T          r a      e     r      P                   ce    all asic
                                           Ve     le    E      od   Ma od, T                T        Ch tal P ber,           O
                                                                                                                          ef. arma -Met
                                      o tor rs, E           Wo           o          th er                e      b       R                           B
                                    M       ute
                                                                       F          O                    M    Ru oke,          Ph Non
                                      o mp                                                                        C
                                    C




                                    Figure 13: Share of U.S. Value-Added in U.S. Imported Mexican Final Goods: Roundabout point
                                    estimates, unrestricted bounds, and restricted bounds correspond to the values reported in table 1.




                                                                                           55
Figure 14: Welfare Losses of a NAFTA Trade War: Roundabout point estimates and unrestricted
bounds are the same as in figure 8. The darker extremal values are computed exactly as the original
ones but when adding the additional constraints in (33). The darker set is the convex hull of these
constrained extreme values and proxies the constrained approximate bounds on the welfare costs
of a NAFTA trade war.




                                                56
B    WIOD Aggregation
Throughout the paper I aggregate the WIOD’s 56 industries slightly in order to eliminate some very small
industries and reduce the size of the numerical optimization problems. The following table presents the
aggregation across industries.

                                                                        Raw WIOD     Aggregated WIOD
     Industries
                                                                    #     % of GDP   #     % of GDP
     Crop, animal production, hunting, related service activities    1      3.1       1      7.2
     Forestry and logging                                            2      0.2       1      7.2
     Fishing and aquaculture                                         3      0.3       1      7.2
     Mining and quarrying                                            4      3.7       1      7.2
     Manufacture of food products, beverages and tobacco             5      4.3       2      4.3
     Manufacture of textiles, wearing apparel and leather            6      1.7       3      1.7
     Manufacture of wood and of products of wood and cork            7      0.6       4      2.3
     Manufacture of paper and paper products                         8      0.6       4      2.3
     Printing and reproduction of recorded media                     9      0.3       4      2.3
     Manufacture of coke and refined petroleum products             10      2.4       5      2.4
     Manufacture of chemicals and chemical products                 11      2.6       6      2.6
     Manufacture of basic pharmaceutical products                   12      0.8       7      0.8
     Manufacture of rubber and plastic products                     13      1.1       8      1.1
     Manufacture of other non-metallic mineral products             14      1.2       9      1.2
     Manufacture of basic metals                                    15      2.8      10      2.8
     Manufacture of fabricated metal products                       16      1.5      11      1.5
     Manufacture of computer, electronic and optical products       17      2.5      12      2.5
     Manufacture of electrical equipment                            18      1.5      13      1.5
     Manufacture of machinery and equipment n.e.c.                  19      2.2      14      2.4
     Manufacture of motor vehicles, trailers and semi-trailers      20      2.8      15      2.8
     Manufacture of other transport equipment                       21      0.9      16      0.9
     Manufacture of furniture; other manufacturing                  22      0.8       4      2.3
     Repair and installation of machinery and equipment             23      0.2      14      2.4
     Electricity, gas, steam and air conditioning supply            24      3.3      17      3.9
     Water collection, treatment and supply                         25      0.2      17      3.9
     Sewerage; waste collection, treatment and disposal             26      0.3      17      3.9
     Construction                                                   27      7.5      18      7.5
     Wholesale and retail trade and repair of motor vehicles        28      0.9      19      8.9
     Wholesale trade, except of motor vehicles and motorcycles      29      4.9      19      8.9
     Retail trade, except of motor vehicles and motorcycles         30      3.1      19      8.9
     Land transport and transport via pipelines                     31      2.6      20      4.5
     Water transport                                                32      0.4      20      4.5
     Air transport                                                  33      0.5      20      4.5
     Warehousing and support activities for transportation          34      1.0      20      4.5
     Postal and courier activities                                  35      0.2      21      7.1




                                                        57
                                                                      Raw WIOD         Aggregated WIOD
Industries
                                                                  #     % of GDP        #         % of GDP
Accommodation and food service activities                        36        2.4         21           7.1
Publishing activities                                            37        0.4         22           8.1
Motion picture, video, television, sound recording, music        38        0.4         22            8.1
Telecommunications                                               39        1.5         22           8.1
Computer programming, consultancy, information service           40        1.3         22            8.1
Financial service, except insurance and pension funding          41        2.9         23            4.7
Insurance, reinsurance and pension funding                       42        1.3         23           4.7
Activities auxiliary to financial services and insurance         43        0.5         23            4.7
Real estate activities                                           44        5.4         24           5.4
Legal, accounting; head offices; management consultancy          45        2.2         22            8.1
Architectural and engineering; technical testing and analysis    46        0.7         22            8.1
Scientific research and development                              47        0.5         22           8.1
Advertising and market research                                  48        0.3         22           8.1
Other professional, scientific and technical; veterinary         49        0.7         22            8.1
Administrative and support service                               50        2.3         21           7.1
Public administration, defense, compulsory social security       51        5.4         25           11.8
Education                                                        52        2.3         25           11.8
Human health and social work activities                          53        4.0         25           11.8
Other service activities                                         54        2.1         21           7.1
Activities of households as employers                            55        0.1         21           7.1
Activities of extraterritorial organizations and bodies          56        0.0         21            7.1

             Table 5: WIOD Industrial Classification: The shares refer to percent of world GDP.




                                                    58
C       The Import Demand System is Not CES
For the sake of clarity, I restrict attention to a single industry world (the multi-industry extension is im-
mediate). To begin, define the dollar value of inputs from source j 00 used by country j 0 to produce exports
for market j as
                                    X j 00 j 0 , j = a j 00 j 0 , j X j 0 , j + F j 0 , j ,
                                                                                      
                                  P
                                    j∈J X (j |j , j ) . Take j 6= j and i 6= j . Start with the identity X (j , j ) =
and  note that X  (j 00 , j 0 ) =            00 0              00    0       00  0                           00 0
P
   j∈J X (j |j , j ) and differentiate with respect to trade costs with a third country to obtain
           00 0


                                         ∂ ln X (j 00 , j 0 ) X X (j 00 |j 0 , j ) ∂ ln X (j 00 |j 0 , j )
                                                              =                                            .
                                         ∂ ln τ (i 00 , j 0 )    X (j 00 , j 0 ) ∂ ln τ (i 00 , j 0 )
                                                                 j∈J

From the definition of X (j 00 |j 0 , j ) , differentiate and obtain

                         ∂ ln X (j 00 |j 0 , j )   ∂ ln a (j 00 |j 0 , j ) ∂ ln (X (j 0 , j) + F (j 0 , j))
                                                 =                        +                                 ,
                          ∂ ln τ (i 00 , j 0 )      ∂ ln τ (i 00 , j 0 )         ∂ ln τ (i 00 , j 0 )
                                                   ∂ ln X (j 0 |j 0 , j ) ∂ ln a (j 00 |j 0 , j ) ∂ ln a (j 0 |j 0 , j )
                                                 =                        +                      −                         .
                                                    ∂ ln τ (i 00 , j 0 )    ∂ ln τ (i 00 , j 0 )      ∂ ln τ (i 00 , j 0 )

From the definition of input expenditures in (18), differentiate and obtain

                                      ∂ ln a (j 00 |j 0 , j )
                                                              = (1 − σ) 1[j 00 =i 00 ] − a i 00 j 0 , j .
                                                                                                       
                                                  00
                                       ∂ ln τ (i , j )  0


Substituting these two equations into the ratio of bilateral imports yields

    ∂ ln X (j 00 , j 0 ) /X (j 0 , j 0 )
          ∂ ln τ (i 00 , j 0 )
                        X  X (j 00 |j 0 , j ) ∂ ln X (j 00 |j 0 , j ) X (j 0 |j 0 , j ) ∂ ln X (j 0 |j 0 , j ) 
                   =                                                     −                                        ,
                                  X (j 00 , j 0 ) ∂ ln τ (i 00 , j 0 )     X (j 0 , j 0 ) ∂ ln τ (i 00 , j 0 )
                        j∈J
                        X  X (j 00 |j 0 , j )  ∂ ln X (j 0 |j 0 , j )                           
                                                                                                         X (j 0 |j 0 , j ) ∂ ln X (j 0 |j 0 , j )
                                                                                                                                                  
                   =                                                      + (1 − σ) 1[j 00 =i 00 ] −                                                .
                                  X (j 00 , j 0 )   ∂ ln τ (i 00 , j 0 )                                   X (j 0 , j 0 ) ∂ ln τ (i 00 , j 0 )
                      j∈J

Hence, the partial elasticity of imports in j 0 from source j 00 6= j 0 relative to domestic purchases with respect
to changes in trade costs with a third country i 00 6= j 0 equals

   ∂ ln X (j 00 , j 0 ) /X (j 0 , j 0 )                            X  X (j 00 |j 0 , j ) X (j 0 |j 0 , j )  ∂ ln X (j 0 |j 0 , j )
                                        = (1 − σ) 1[j 00 =i 00 ] +                       −                                           . (36)
         ∂ ln τ (i 00 , j 0 )                                           X (j 00 , j 0 )    X (j 0 , j 0 )      ∂ ln τ (i 00 , j 0 )
                                                                      j∈J

    The first term captures the direct effect on relative imports present when j 00 = i 00 ; this is the only
effect in roundabout models. More generally, however, GVC linkages play a role. The partial elasticity
∂ ln X (j 0 |j 0 , j ) /∂ ln τ (i 00 , j 0 ) captures the change in domestic input purchases due to both a substitution
from domestic inputs towards more imports from i 00 and a supply chain effect derived from the change in
downstream production as proxied by the change in exports to each j. That is

                            ∂ ln X (j 0 |j 0 , j )                 00 0
                                                                             ∂ ln (X (j 0 , j) + F (j 0 , j))
                                                   = − (1 − σ) a i    j , j  +                                 .
                             ∂ ln τ (i 00 , j 0 )                                   ∂ ln τ (i 00 , j 0 )



                                                                          59
Further, the term in parenthesis in (36) amplifies/dampens the effect on relative imports depending on the
differential importance of each export market j for inputs from j 00 relative to j 0 .
    In words, if Mexican exports to Germany use mostly Japanese inputs, then a reduction in Mexico-
Germany shipping costs reduces both imports from Japan and domestic input sales following the substi-
tution towards more German inputs. However, imports from Japan fall relatively more since exports to
Germany use Japanese inputs intensively. On net, the supply chain effect exerts an opposing force and
increases Japanese imports relatively more than domestic sales following the rise in exports to Germany.
    The supply chain effect thus illustrates how changes in third-country trade barriers affect imports
asymmetrically depending on the depth of supply chain integration. The knife-edge roundabout model,
however, is the one case in which the effect is symmetric since all exports get built with the same inputs.
In other words, the roundabout model satisfies the ACR condition “the import demand system is CES”

                                                           ∂ ln X (j 00 , j 0 ) /X (j 0 , j 0 )
              if a j 00 j 0 , j = a j 00 j 0 ∀j 00 ,
                                           
                                                       ⇒                                        = (1 − σ) 1[j 00 =i 00 ] .
                                                                 ∂ ln τ (i 00 , j 0 )

C.1    Gravity Regressions in Specialized Inputs Models
I illustrate the effects of running gravity regressions on data generated by specialized inputs models
through simulations. Assume that there are J = 25 countries and a single industry per country. In
each simulation I sample parameters from random distributions. Specifically, I take draws β (j 0 , j) ∼
Uniform(0, 1), P  α (j 00 |j 0 , j ) ∼ Lognormal(0, P  1), ϕ (j 0 |j ) ∼ Lognormal (0, 1). I normalize the latter two
shares so that j 00 ∈J α (j |j , j ) = 1 and j 0 ∈J ϕ (j 0 |j ) = 1. To obtain symmetric trade costs I take
                                    00 0

ρ (j 0 , j) ∼ Uniform (0, 1/2) and define τ (j 0 , j) = 1 + ρ (j 0 , j) ρ (j, j 0 ) for j 0 6= j and τ (j, j) = 1. For the
roundabout model I run similar simulations while imposing common input shares α (j 00 |j 0 ).
     The only missing parameter is the elasticity of substitution that I set to σ = 6 so that the roundabout
trade elasticity is 1 − σ = −5. In each simulation I construct the input-output table and run the following
regression
                                   ln X j 0 , j = δ0 + δexp j 0 + δimp (j) + θ ln τ j 0 , j ,
                                                                                            

where δ0 is the intercept, and δexp (j 0 ) and δimp (j) are exporter and importer fixed effects. The coefficient
θ equals the trade elasticity in the roundabout model if input shares are driven entirely by trade costs, i.e.
if α (j 0 |j ) = 1/J for all pairs. More generally, the coefficient θ will differ from the trade elasticity since
these parameters do vary.
    Figure 15 presents the range of estimates for θ across 10, 000 simulations of the roundabout and spe-
cialized inputs models. As discussed, θ differs from the trade elasticity because of the exogenous input
share parameters but note that on average it exactly equals the trade elasticity. In contrast, in specialized
inputs models structural gravity does not hold and thus the recovered value for the trade elasticity θ does
not match its structural interpretation. That is, on average, θ 6= 1 − σ. While the average estimate in the
roundabout model hits precisely the structural trade elasticity value of 1 − σ = −5, the average estimate in
specialized inputs is lower at −4.47 reflecting the fact that trade costs with third countries affect bilateral
trade flows through supply chain linkages. This attenuation can be understood as introducing classical
measurement error by consequence of model misspecification.




                                                             60
Figure 15: Gravity Regressions: The histograms correspond to trade elasticity estimates across
10, 000 simulations of roundabout and specialized inputs models. All simulations use 1 − σ = −5.




                                              61
D     Computing Counterfactuals for Arbitrary Changes in Trade Barriers
D.1    Specialized Inputs Hat Algebra
Suppose, for now, that we have an observed GVC network described by the input shares a (s 00 |s 0 , j ) and
πF (s 0 |j ). Remember that the input-output flows X (s 0 , s) and F (s 0 , j) are known, that the elasticities σ (k)
are given, and that we seek to solve for the change in all endogenous variables following an arbitrary
change to trade barriers τ̂ (s 0 , j). This can be done in six steps. First, the Cobb-Douglas expenditure shares
can be recovered from the GVC network as follows
                                                             X
                                          β s 0, j = 1 −           a s 00 s 0 , j ,
                                                                                

                                                                                 s 00 ∈J×K
                                                                               X
                                              γ k 00 s 0 , j =                            a s 00 s 0 , j ,
                                                                                                       

                                                                           s 00 ∈J×k 00
                                                                               X
                                                   ζ k 0 |j =                           πF s 0 |j .
                                                                                                

                                                                           s 0 ∈J×k 0

Clearly, the Cobb-Douglas shares add up to one
                                              X
                                  β s 0, j +    γ k 00 s 0 , j = 1,
                                                             

                                                                       k 00 ∈K
                                                                                 X
                                                                                          ζ k 0 |j = 1.
                                                                                                  

                                                                                k 0 ∈K

Second, conditional on a change in wages ŵ (j), the change in unit prices p̂ (s 0 , j) is found through the
following fixed point
                                                                                                                                       δ(k 00 |s 0 ,j )
                                       Y                          00 ,j)         Y                                 γ(k 000 |s 00 ,j )
                                                                                                                  − 1−σ k 000
                 p̂ s 0 , j =                  ŵ (j)β(s                                   â s 000 s 00 , j
                                                                                                               
                                                                           ×                                             ( )                               ,
                                   s 00 ∈j×K                                   s 000 ∈j×K
                                                                                                       00 )
                 00    0                                 (p̂ (s 00 , j 0 ) τ̂ (s 00 , j 0 ))1−σ(k
                                                                                                                                 × γ k 00 s 0 , j .
                                                                                                                                                
          â s        s ,j = P                                                                                    1−σ(k 00 )
                                        t 00 ∈J×k 00   a (t 00 |s 0 , j ) × (p̂ (t 00 , s 0 ) τ̂ (t 00 , j 0 ))

Third, this delivers the change in final good shares and final good flows
                                                                                                   0
                               0                            (p̂ (s 0 , j) τ̂ (s 0 , j))1−σ(k )
                      π̂F s |j = P                                                                                         × ζ k 0 |j ,
                                                                                                                                    
                                                                                                              1−σ(k 0 )
                                            t 0 ∈J×k 0 πF (t |j ) × (p̂ (t , j) τ̂ (t , j))
                                                               0             0       0

                                         π̂F (s 0 |j ) πF (s 0 |j ) × ŵ (j) GDP (j)
                       F̂ s 0 , j =
                                 
                                                                                      .
                                                            F (s 0 , j)

Fourth, the change in bilateral intermediate input flows can be found with the fixed point
                                                                                                              
                      1      X                                   X
  X̂ s 00 , s 0 =              â s 00 s 0 , j a s 00 s 0 , j     X̂ s 0 , s X s 0 , s + F̂ s 0 , j F s 0 , j  .
                                                                                                        
                      00  0
                  X (s , s )
                                       j∈J                                                s∈j×K




                                                                                62
Fifth, the change in unit wages can be updated through
                                                                                                                                        
              1      X        X                          X                                            X
                                    X̂ s 0 , s X s 0 , s +  F̂ s 0 , j F s 0 , j −                              X̂ s 00 , s X s 00 , s 0 .
                                                                                                                          0
                                                                                                                                    
ŵ (j) =                   
          GDP (j) 0
                      s ∈j×K   s∈J×K                                    j∈J                         s 00 ∈J×K

Sixth, and finally, repeat steps two to five using the new guess for the change in unit wages until a fixed
point is found. This delivers a new equilibrium in which the endogenous variables for any country can be
found as the product of the benchmark variable times the hat variable. The change in welfare can be found
by substituting the change in the shares of the GVC network into the welfare formula (27).

D.2    Solving for the Exact GVC Bounds
The previous subsection showed how to compute the change in welfare following an arbitrary change to
trade barriers for a given benchmark GVC network. Computing the bounds requires, in addition, searching
across all GVC networks consistent with a given input-output dataset and finding the ones that minimize
or maximize these gains. In other words, the bounds are found by solving

         min/max               the welfare formula in (27),
                                                                                                           
                                                      X                         X
                               X s 00 , s   0
                                                            a s 00 s 0 , j           X s 0 , s + F s 0 , j  , ∀s 00 , s 0 ,
                                                                                                        
         subject to                               =
                                                      j∈J                     s∈j×K
                                   X
                                               a s 00 s 0 , j = γ k 00 , s 0 , ∀k 00 , s 0 , j
                                                                           

                                s 00 ∈J×k 00
                                      00 0
                                         s , j > 0, ∀s 00 , s 0 , j,
                                              
                               a s
                               the specialized inputs hat algebra holds.

    The optimization problem solves jointly for a GVC network that fits the input-output data in the bench-
mark equilibrium and the counterfactual equilibrium following the exogenous change to trade barriers.
The solution is given by the combination of benchmark and counterfactual equilibria that minimize or
maximize the gains from trade for some country j. Solving this problem is very hard numerically because
the objective function is highly nonlinear, the constraints are highly nonlinear, and the problem is very
large because it depends on solving for the full GVC network across all country-industries in the world.

D.3    Solving for Approximate GVC Bounds
Approximate bounds on the welfare change following an arbitrary change to trade barriers is done by
focusing on the extremal GVC networks relevant to the question at hand. To illustrate this, let us use
the slightly more general model in which expenditure shares vary across inputs and final goods, i.e. with
aX (s 00 |s 0 , s ) and aF (s 00 |s 0 , j ), to study two counterfactuals. This approach takes four steps. First, for a
given change in trade barriers, finding the extremal GVC flows that minimize/maximize a shock’s propa-
gation to specific countries is found intuitively (this is usually straightforward). Second, the expenditure
shares associated to these networks is computed through linear programming problems. Third, the associ-
ated change in welfare is computed using the specialized inputs hat algebra. Fourth, approximate bounds
are built using linear combinations of these benchmark extremal GVC networks. I exemplify this through
the two counterfactual exercises in figure 8.
    First, if the U.S. increases trade barriers on Mexican final good manufacturing imports then this will
have a minimal/maximal effect on Mexican/U.S. welfare depending on whether these final goods are built


                                                                   63
with Mexican/U.S. value-added or intermediate inputs. Thus, careful inspection of this problem reveals
that the GVC flows that minimize/maximize welfare in this counterfactual are those associated with very
little/highly integrated Mexican/U.S. supply chains. Specifically, the three benchmark networks used in
the left panel of figure 8 correspond to:

   1. Find the GVCs with maximal Mexican value added directly to final good exports to the U.S. That is,
      for each manufacturing industry k 0 , solve
                                                                    
                           X X                00 00                     
                                                      MEX, k 0 , USA  F MEX, k 0 , USA .
                                                                                          
               max 1 −               aF j , k
                             j 00 ∈J k 00 ∈K

      These GVCs maximize Mexican welfare losses.

   2. Find the GVCs with maximal U.S. inputs used in final good exports to the U.S. That is, for each
      manufacturing industry k 0 , solve
                           X                                  
                                  aF USA, k 00  MEX, k 0 , USA F MEX, k 0 , USA .
                                                                                    
                   max
                            k 00 ∈K

      These GVCs maximize U.S. welfare losses.

   3. Find the GVCs with maximal non-Mexican and non-U.S. inputs used in final good exports to the U.S.
      That is, for each manufacturing industry k 0 , solve
                           X         X                                   
                                          aF j 00 , k 00    MEX, k 0 , USA F MEX, k 0 , USA .
                                                                                            
               max
                     j 00 ∈J\{MEX,USA} k 00 ∈K

      These GVCs minimize both Mexican and U.S. welfare losses.

The extremal GVC networks correspond to these three cases − when solving them across all manufacturing
industries k 0 and when imposing the constraints that these expenditure shares aggregate up to the input-
output data (as in (15)). For each of these extremal GVC networks, I proceed conservatively and assume that
the GVC flows crossing through all other countries are given by the roundabout GVCs. Having computed
these extremal GVC networks, I then compute the associated change in welfare using the specialized inputs
hat algebra described above. Finally, I compute the intermediate dots depicted in figure 8 by taking linear
combinations of these three benchmark GVCs − and which also satisfy the restrictions in (15) since they are
linear − and computing the associated welfare losses through the specialized inputs hat algebra. Repeating
this 10,000 times deliver 10,000 numbers for the joint Mexican and U.S. welfare losses associated to 10,000
GVC flows that perfectly replicate every single entry of the 2014 WIOD.
    Second, the bounds on the welfare losses when Mexico increases trade barriers on U.S. intermediate in-
put imports are computed analogously but with different extremal GVC networks. In this case, this change
in trade policy will have a minimal/maximal effect on Mexican/U.S. welfare depending on whether these
inputs are used to produce goods sold to Mexican/U.S. buyers. Thus, careful inspection of this problem re-
veals again that the GVC flows that minimize/maximize welfare in this counterfactual are those associated
with very little/highly integrated Mexican/U.S. supply chains. Specifically, the three benchmark networks
used in the right panel of figure 8 correspond to:

   1. Find the GVCs with maximal U.S. inputs used in goods sold domestically. That is, for each manufac-




                                                    64
      turing industry k 0 , solve
                      X X                                                    
                                  aX USA, k 00             MEX, k 0 , {MEX, k} X MEX, k 0 , {MEX, k}
                                                                                                     
              max
                      k 00 ∈K k∈K
                           X                                         
                                          USA, k 00     MEX, k 0 , MEX F MEX, k 0 , MEX .
                                                                                       
                      +             aF
                          k 00 ∈K

      These GVCs maximize Mexican welfare losses.

   2. Find the GVCs with maximal U.S. inputs used in goods sold to the U.S. That is, for each manufacturing
      industry k 0 , solve
                         X X                                          
                              aX USA, k 00       MEX, k 0 , {USA, k} X MEX, k 0 , {USA, k}
                                                                                                  
              max
                      k 00 ∈K k∈K
                           X                                         
                                          USA, k 00     MEX, k 0 , USA F MEX, k 0 , USA .
                                                                                       
                      +             aF
                          k 00 ∈K

      These GVCs maximize U.S. welfare losses.

   3. Find the GVCs with maximal U.S. inputs used in goods sold to countries other than Mexico and the
      U.S. That is, for each manufacturing industry k 0 , solve
                         X       X X                                            
                                           aX USA, k 00         MEX, k 0 , {j, k} X MEX, k 0 , {j, k}
                                                                                                      
           max
                  j∈J\{MEX,USA} k 00 ∈K k∈K
                            X             X                                    
                                                       USA, k 00    MEX, k 0 , j F MEX, k 0 , j .
                                                                                               
                  +                             aF
                      j∈J\{MEX,USA} k 00 ∈K

      These GVCs minimize both Mexican and U.S. welfare losses.

The bounds on welfare are then computed exactly as in the first counterfactual, but when using these three
GVC networks as the benchmark extremal networks.




                                                            65
E      GVCs and Measurement
E.1     Disentangling GVCs: Narrowing the Bounds
The restricted bounds on the U.S. value-added in Mexican final good imports and on the welfare losses of
a NAFTA trade war are computed exactly as in the unrestricted case, but when imposing additional linear
inequality constraints. Within each manufacturing industry k 0 , I impose these constraints for final good
production across all combinations of source country-industries {j 00 , k 00 } and destination countries j
                                                                                           P        P
 aF ({j 00 , k 00 } |{MEX, k 0 } , j ) 6 (χF ({j 00 , k 00 } |{MEX, k 0 } , j ) + ∆)                     aF ({i 00 , l 00 } |{MEX, k 0 } , j ) ,
                                                                                     i 00 ∈J\MEX l 00 ∈K
                                                                                           P        P
 aF ({j 00 , k 00 } |{MEX, k 0 } , j ) > (χF ({j 00 , k 00 } |{MEX, k 0 } , j ) − ∆)                     aF ({i 00 , l 00 } |{MEX, k 0 } , j ) ,
                                                                                      i 00 ∈J\MEX l 00 ∈K

where χF ({j 00 , k 00 } |{MEX, k 0 } , j ) is a relative foreign input expenditure share measured in customs data.
I also impose analogous conditions for the case of intermediate input production − while also assuming
that these shares vary only depending on the purchasing country and not purchasing industry since the
customs data does not reveal which foreign industry buys Mexican exports. That is
                 
 aX j 00 , k 00      MEX, k 0 , {j, k}
                                           
                                                                 X        X                  
                   6 χX j 00 , k 00            MEX, k 0 , j + ∆                   aX i 00 , l 00  MEX, k 0 , {j, k} ,
                                                                                                                  

                                                                           i 00 ∈J\MEX l 00 ∈K
        00 00       
                      MEX, k 0 , {j, k}
                                        
 aX     j ,k
                                                                             X          X            00 00       
                     > χX j 00 , k 00      MEX, k 0 , j − ∆                                                          MEX, k 0 , {j, k} .
                                                                                                                                    
                                                                                                 aX    i ,l
                                                                           i 00 ∈J\MEX l 00 ∈K


E.2     Disentangling GVCs: Constructing New Point Estimates
I write the optimization problem in (34), when minimizing the weighted sum of squared deviations, in
terms of linear algebra. I proceed in five steps. First, since the optimization is done separately within each
country-industry s 0 ∈ S, fix s 0 . Second, use the input-output data to define the vectors X1 = [X (s 0 , s)],
X2 = [X (s 00 , s 0 )], and F1 = [F (s 0 , j)] of size 1 × JK, JK × 1, and 1 × J. Third, define the endogenous
variables as vectors
           aX (1 |s 0 , 1 )                                            aF (1 |s 0 , 1 )
                                                                                     
                    ..                                                    ..         
                                               βX (s 0 , 1)                                        βF (s 0 , 1)
                     .                                                   .                               
         aX (1 |s , S ) 
                        0                                             aF (1 |s , J ) 
                                                                                 0
                                                                                     
  aX =                                             ..                                                 ..
         aX (2 |s 0 , 1 )  , βX =                                  aF (2 |s 0 , 1 )  , βF = 
                                                             , aF = 
                                                                                                             
                            
                                                     .
                                                                                        
                                                                                                        .       ,
                                               βX (s , S)
                                                       0                                           βF (s , J)
                                                                                                          0
                                                                                     
                   ..                                                      ..        
                    .                                                       .        
              aX (S |s 0 , S )                                                         aF (S |s 0 , J )

of sizes JKJK × 1, JK × 1, JKJ × 1, and J×1. Fourth, stack the targets and weights into analogous
vectors and call them a0X , β0X , a0F , β0F , ω0aX , ω0βX , ω0aF , and ω0βF . The optimization problem in (34) can




                                                                      66
be written as a quadratic program as follows
                          T     0            
                                              
                                                               
                 aX − a0X        ωa              aX − a0X
                βX − β0X       ω0 X                  0
                                   βX             βX − βX
                                                                
      min       aF − a0  diag  ω0a
                                                                ,
                                               
                         
                                                  aF − a0
                                
                                 0F           
                                               
                                                                
                       F                                  F
                 βF − β0F         ωβF              βF − β0F
                                                                                     
                                                              aX                               
                     IJK×JK ⊗ X1  0JK×JK IJK×JK ⊗ F1 0JK×J     βX                           X2
 subject to       11×JK ⊗ IJK×JK IJK×JK   0JK×JKJ    0JK×J  
                                                               aF
                                                                                       =  1JK×1  ,
                                                                                      
                       0J×JKJK     0J×JK 11×JK ⊗ IJ×J IJ×J                                   1J×1
                                                                βF
                      
                   aX
               
                  βX  > 0,
                  aF 
                   βF

where diag{·} is a diagonal matrix, ⊗ is the Kronecker product, I is the identity matrix, and 0 and 1 are
matrices of zeros and ones. Often, numerical quadratic programming solvers define the objective function
as 21 xT Qx+cT x, in which case the above objective function can be rewritten in these terms as
                                          0                           0         0
                                                                               
                                                                                           
                  aX                      ωa                          ωa          a
                 βX                     ω0 X                        ω0 X      X  0
                                            βX                            βX          β
                                                                                     X
                                                                                             
              x=
                 aF  ,        Q = diag                 ,   c = −diag                       .
                                          ω0aF                        ω0aF     
                     
                                                                                     a0
                                         
                                          0        
                                                                      
                                                                        0        
                                                                                  
                                                                                             
                                                                                        F
                  βF                       ωβF                           ωβF          β0F

E.3    Disciplining GVCs: Graphical Intuition
Concretely, the paper’s message is simple and the intuition can be conveyed through the graphical repre-
sentation in figure 16. The large cloud in figure 16a represents the highly-dimensional space of all GVC
flows consistent with some aggregate input-output dataset, with the yellow star representing the true
(unobserved) GVCs. Figure 16b shows that the roundabout GVCs are mismeasured and let the distance be-
tween them and the true ones proxy how close they are (for example, as given by the Euclidean distance).
Figure 16c depicts the set of specialized inputs GVCs that are consistent with the input-output data and
with the roundabout GVCs contained as a specific set of flows. In general, it is likely that the true GVCs
are not consistent with specialized inputs (the world is a complicated place) and so the true GVCs are out-
side of this set. Still, figure 16d shows that the goal of the measurement framework is not necessarily to
measure the true GVC flows (this is an impossible task), but rather to improve upon the roundabout GVC
flows. The key identification assumption can be described as using additional information in order to shift
the GVC estimates into the shaded region. A researcher can use additional data or her own priors over the
data generating process to discipline the GVC estimates as she considers reasonably. If done correctly, this
improves the GVC estimates relative to roundabout GVCs.




                                                    67
                   True GVCs
                   → unobserved               !∗                                                             !∗


  General space of
                                                                         !#$%&'()$%*
     GVCs: !

(a) GVCs live in a high dimensional space of which the        (b) The roundabout GVCs are only one of many pos-
true GVCs are a single point.                                 sible data generating processes. The distance between
                                                              two points proxies how similar they are.




     Specialized inputs                       !∗                                                             !∗
     feasible set                                                                                     Many GVCs
                                                                                                      dominate
                                                                                                      roundabout
          !"#$%&'(#$)                                                    !#$%&'()$%*


(c) Relaxing the proportionality assumptions as in the        (d) Even if the true GVC flows cannot be recovered,
specialized inputs measurement framework increases            there exist a whole set of specialized inputs GVCs that
the size of the set of GVCs that can be estimated. The        are better measured than the roundabout GVCs.
specialized inputs measurement framework can back
out any flows within this set as long as the objective
function is defined appropriately.

                        Figure 16: The Specialized Inputs Measurement Framework.




                                                         68
