                                 NBER WORKING PAPER SERIES




      BLOCK RECURSIVE EQUILIBRIA FOR STOCHASTIC MODELS OF SEARCH
                              ON THE JOB

                                             Guido Menzio
                                             Shouyong Shi

                                         Working Paper 14907
                                 http://www.nber.org/papers/w14907


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      April 2009




We are grateful for comments received from participants at the Society for Economic Dynamics Meeting
in New Orleans (January 2008) and Cambridge (July 2008), and at the macroeconomics seminars at
the University of Michigan, Stanford University and the Minneapolis FED. Discussions with Pete
Klenow, Narayana Kocherlakota, Dale Mortensen, Giuseppe Moscarini, and Victor Rios-Rull led to
significant improvements in the paper. Menzio gratefully acknowledges the financial support and the
hospitality of the Hoover Institution. Shi gratefully acknowledges the financial support from the Bank
of Canada Fellowship and from the Social Sciences and Humanities Research Council of Canada.
The usual disclaimer applies. The views expressed herein are those of the author(s) and do not necessarily
reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2009 by Guido Menzio and Shouyong Shi. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
Block Recursive Equilibria for Stochastic Models of Search on the Job
Guido Menzio and Shouyong Shi
NBER Working Paper No. 14907
April 2009
JEL No. E32,J64

                                               ABSTRACT

In this paper, we develop a general stochastic model of directed search on the job. Like in the analogous
models of random search on the job, the state of the economy in our model includes the infinite-dimensional
distribution of workers across different employment states (unemployment, and employment at different
wages). Unlike the analogous models of random search on the job, our model admits an equilibrium
in which the agents' value and policy functions do not depend on the distribution of workers. We refer
to this type of equilibrium as a Block Recursive Equilibrium. Therefore, while solving the equilibrium
of a random search model in a stochastic environment is a difficult task both analytically and computationally,
solving the Block Recursive Equilibrium of our model is as easy as solving a representative agent
model.


Guido Menzio
Department of Economics
University of Pennsylvania
467 McNeil Building
3718 Locust Walk
Philadelphia, PA 19104
and NBER
gmenzio@econ.upenn.edu

Shouyong Shi
University of Toronto
Department of Economics
150 St. George Street
Toronto, Ontario
Canada, M5S 3G7
shouyong@chass.utoronto.ca
1. Introduction

This paper studies a general model of search on the job that allows for aggregate shocks, idio-
syncratic shocks, and diﬀerent specifications of the contractual environment. The paper’s main
result is to formally establish the existence of a type of equilibria, called Block Recursive Equi-
libria (BRE), which are tracvtable for studying equilibrium dynamics. To attain this result, we
depart from the bulk of the literature on search on the job, and we assume that the search process
is directed1 –in the sense that a worker knows the terms of trade oﬀered by diﬀerent firms before
he chooses where to apply for a job–rather than random (or undirected)–in the sense that a
worker does not have any information about terms of trade oﬀered by diﬀerent firms.

       The models of random search on the job by Burdett and Mortensen (1998), Postel-Vinay and
Robin (2003), and Burdett and Coles (2003) are a useful tool for studying labor markets because
they can simultaneously and parsimoniously explain a number of qualitative features of the data.
For example, they can explain the empirical regularities in the transition of workers between the
states of employment, unemployment and across jobs that pay diﬀerent wages (e.g. the negative
relationship between job hazard and tenure). They can explain why similar workers employed at
similar firms are paid diﬀerent wages. They can explain why wages tend to increase with tenure
and experience.2

       However, these models are diﬃcult to solve outside of steady-state because the distribution of
workers across diﬀerent employment states (unemployment, and employment at diﬀerent wages)
is an infinite-dimensional state variable which non-trivially aﬀects the agents’ value and policy
functions.3 This technical feature limits the use of these models. For example, a macroeconomist
cannot measure the eﬀect of aggregate productivity shocks on the flows of workers across diﬀerent
employment states and on the wage distribution by simply comparing steady-states (unless he
has reason to believe that these shocks are very persistent and that the transition phases have
negligible length). A public economist cannot measure the welfare eﬀect of a change to the
unemployment benefit legislation by comparing two steady-states (unless he has reason to believe
   1
     The directed search literature was pioneered by Montgomery (1991), Peters (1991), Moen (1997), Acemoglu
and Shimer (1999), and Burdett Shi and Wright (2001).
   2
     Mortensen (1994), Pissarides (1994), and Barlevy (2002) are other popular models of search on the job. These
models have qualitative properties that are very diﬀerent from those of the models by Burdett and Mortensen
(1998), Postel-Vinay and Robin (2002), and Burdett and Coles (2003). For example, they cannot generate residual
wage inequality.
   3
     Recently, Moscarini and Postel-Vinay (2008) have succeded in characterizing the transitional dynamics of the
model by Burdett and Mortensen (1998) (henceforth, BM98). Their results also suggest that it might be possible
to solve the equilibrium of BM98 in a fully stochastic environment. The current paper provides a model that has
the same qualitative properties as BM98 and can be solved in a stochastic environment as easily as a representative
agent model.

                                                        1
that the agents’ discount factor is approximately zero and, hence, the transition phases are
unimportant). And if an econometrician estimates the steady-state of a model, he has to be
careful in using data from a period of time when the fundamentals of the economy have remained
approximately unchanged.4

       Moreover, the hypothesis that the search process is random appears at odds with the existing
empirical evidence. For example, in a recent survey of the US labor market, Hall and Krueger
(2008, Table 1) find that 84 percent of white, male, non-college workers either “knew exactly” or
“had a pretty good idea” about how much their current job would pay from the very beginning
of the application process (the time of the first interview). Another piece of evidence against the
random search hypothesis and in favor of directed search comes from Holzer, Katz and Krueger
(1991). Using data from the 1982 Employment Opportunity Pilot Project Survey, these authors
find that firms in high-wage industries tend to attract more applicants per vacancy that firms in
industries where the terms of trade are less generous. These findings should not be surprising, as
directed search reflects the fundamental idea in economics that prices help a market allocating
resources.

       In this paper, we consider a stochastic model of directed search on the job. This model
is rather general in that it allows for aggregate shocks, idiosyncratic shocks, and for diﬀerent
specifications of the contractual environment (fixed-wage contracts and dynamic contracts). For
this model, we prove existence of an equilibrium in which the agents’ value and policy functions do
not depend on the infinite-dimensional distribution of workers across diﬀerent employment states.
We refer to this equilibrium as a Block Recursive Equilibrium (BRE). Like the equilibrium of the
models by Burdett and Mortensen (1998), Postel-Vinay and Robin (2002), and Burdett and Coles
(2003), the BRE of our model generates worker flows between employment, unemployment, and
across employers; it generates a negative relationship between job hazard and tenure; it generates
residual wage inequality, and a positive return to tenure and experience. However, unlike the
equilibrium of these other models, the BRE of our model can be easily computed in and out of
the steady-state. Therefore, our model can be used, without qualifications, to carry out the labor
market measurements that we have described in the previous paragraph.

       It is precisely the diﬀerence in the nature of the search process that explains why our model
   4
     Postel-Vinay and Robin (2002) explicitely acknowledge that estimating the steady-state of an OJS model
restricts their choice of data: “We have deliberately selected a much shorter period than is available because we
want to find out whether it is possible to estimate our model over a homogeneous period of the business cycle.
It would have been very hard to defend the assumption of time-invariant parameters (the job oﬀer arrival rate
parameters in particular) had we been using a longer panel.” Similarly, Jolivet et alii (2006) state that “We choose
to restrict our analysis to a 3-year sample for three reasons. [...] Third, the model assumes that the labor market
is in a steady-state, an asusmption that would be harder to defend over a longer period of time.”
                                                         2
admits a Block Recursive Equilibrium and the models by Burdett and Mortensen (1998), Postel-
Vinay and Robin (2002), and Burdett and Coles (2003) do not. The search process is directed
in our model but undirected in the other models. If the search process is directed, workers
in diﬀerent employment states choose to apply for diﬀerent jobs, because they have diﬀerent
preferences over the probability of getting a job and the value oﬀered by a job. Therefore, the
distribution of workers across employment states does not aﬀect the benefit to the firm from
creating a vacancy that oﬀers certain terms of trade, the tightness of the labor market and,
ultimately, the agents’ value and policy functions. In contrast, if the search process is random,
workers in diﬀerent employment states search for the same jobs. Therefore, the distribution of
workers across diﬀerent employment states aﬀects the probability that a firm meets a worker
who is willing to accept certain terms of trade, the benefit to the firm of creating a vacancy, the
tightness of the labor market and, ultimately, the agents’ value and policy functions. At the end
of Section 5, we will provide a more detailed explanation for why directed search is important for
existence of a BRE.

   The main contribution of this paper is to prove existence of a BRE for a relatively gen-
eral model of directed search on the job which allows for aggregate shocks, idiosyncratic shocks,
workers’ risk aversion, and for diﬀerent specifications of the contractual environment. This con-
tribution provides a solid foundation for future applications of models of directed search on the
job. Moen and Rosen (2004) were the first to develop a model of search on the job in which the
search process is, to some extent, directed (workers can choose where to apply for a job within
a restricted set of vacancies). Delacroix and Shi (2006) examine a model of directed search on
the job with fixed-wage contracts. However, their analysis only focuses on the steady-state equi-
librium. Shi (2008) was the first to prove the existence of a BRE for a model of directed search
on the job. However, his model restricts attention to a deterministic environment and to the
case of wage/tenure contracts. Menzio and Shi (2008) were the first to prove existence of a BRE
for a stochastic model of directed search on the job. In addition, they calibrate their model and
use it to measure the contribution of aggregate productivity shocks to the cyclical volatility of
unemployment, vacancies, and other labor market variables. However, their model only restricts
attention to the case of complete labor contracts. In order to generalize the results from Shi
(2008) and Menzio and Shi (2008), the current paper has to develop a diﬀerent existence proof.
Parts of the existence proof in Shi (2008) rely on the absence of aggregate shocks and on the as-
sumption of wage/tenure contracts. The existence proof in Menzio and Shi (2008) is based on the
equivalence between the solution to the social planner’s problem and the equilibrium allocation.
This equivalence does not hold when employment contracts are incomplete.
                                                3
2. The Model

2.1. Agents and Markets

The economy is populated by a continuum of workers with measure one and a continuum of
firms with positive measure. Each worker has a periodical utility function υ(.) defined over
consumption, where υ : R → R is a twice-continuously diﬀerentiable, strictly increasing, weakly
concave function such that υ 0 (.) ∈ [υ 0 , ῡ0 ], 0 < υ0 ≤ ῡ 0 . Each worker maximizes the expected sum
of periodical utilities discounted at the factor β ∈ (0, 1). The unemployment benefit is b.

      Each firm operates a constant returns to scale technology which turns one unit of labor into
y + z units of consumption. The first component of productivity, y, is common to all firms, and
its value lies in the set Y = {y1 , y2 , ...yN(y) }, where y ≡ y1 < ... < yN(y) ≡ ȳ and N (y) ≥ 2 is
an integer. The second component of productivity, z, is specific to each firm-worker pair, and its
value lies in the set Z = {z1 , z2 , ...zN (z) }, where z ≡ z1 < ... < zN(z) ≡ z̄ and N (z) ≥ 1 is an
integer. Each firm maximizes the expected sum of periodical profits discounted at the factor β.

      The labor market is organized in a continuum of submarkets indexed by the expected lifetime
utility x that the firms oﬀer to the workers, x ∈ X = [x, x̄], with x < υ(b)/ (1 − β) and x̄ >
υ(ȳ + z̄)/ (1 − β). Specifically, whenever a firm meets a worker in submarket x, the firm oﬀers
the worker an employment contract that gives him the expected lifetime utility x. In submarket
x, the ratio of the number of vacancies created by firms to the number of workers looking for
jobs is given by θ(x, ψ) ≥ 0 and is determined in the equilibrium, where ψ is the aggregate state
of the economy described below. In the remainder of the paper, we shall refer to θ(x, ψ) as the
tightness of submarket x.5

      Time is discrete and continues forever. At the beginning of each period, the state of the
economy can be summarized by the triple (y, u, g) ≡ ψ. The first element of ψ denotes the
aggregate component of labor productivity, y ∈ Y . The second element denotes the measure of
workers who are unemployed, u ∈ [0, 1]. The third element is a function g : X × Z → [0, 1], with
g(V, z) denoting the measure of workers who are employed at jobs that give them the lifetime
utility Ṽ ≤ V and that have an idiosyncratic component of productivity z̃ ≤ z.

      Each period is divided into four stages: separation, search, matching and production. During
the separation stage, an employed worker is forced to move into unemployment with probability
δ ∈ (0, 1). Also, during the separation stage, an employed worker has the option to voluntarily
move into unemployment.
  5
    In submarkets that are not visited by any workers, θ(x, ψ) is an out-of-equilibrium conjecture that helps
determining the equilibrium behavior.
                                                     4
       During the second stage, a worker gets the opportunity of searching for a job with a probability
that depends on his recent employment history. In particular, if the worker was unemployed at
the beginning of the period, he can send an application with probability λu ∈ (0, 1]. If the worker
was employed at the beginning of the period and did not lose his job during the separation stage,
he can search with probability λe ∈ (0, 1]. If the worker lost his job during the separation stage,
he cannot search immediately. Conditional on being able to search, the worker chooses which
submarket to visit. In this sense, search is directed. Also, during the search stage, a firm chooses
how many vacancies to create and where to locate them. The cost of maintaining a vacancy for
one period is k > 0. Both workers and firms take the tightness θ(x, ψ) parametrically.6

       During the matching stage, the workers and the vacancies in submarket x come together
through a frictional meeting process. In particular, a worker meets a vacant job with probability
p(θ(x, ψ)), where p : R+ → [0, 1] is a twice continuously diﬀerentiable, strictly increasing, strictly
concave function such that p(0) = 0 and p0 (0) < ∞. Similarly, a vacancy meets a worker
with probability q(θ(x, ψ)), where q : R+ → [0, 1] is a twice continuously diﬀerentiable, strictly
decreasing function such that q(θ) = p(θ)/θ, q(0) = 1, and p(q −1 (.)) being concave.7 When a
vacancy and a worker meet, the firm that owns the vacancy oﬀers to the worker an employment
contract that gives him the lifetime utility x. If the worker rejects the oﬀer, he returns to his
previous employment position. If the worker accepts the oﬀer, the two parties form a new match.
To simplify the exposition, we assume that all new matches have the idiosyncratic component of
productivity z0 ∈ Z.

       During the last stage, an unemployed worker produces and consumes b ∈ (0, ȳ + z̄) units
of output. A worker employed at a job z produces y + z units of output and consumes w
of them, where w is specified by the worker’s labor contract. At the end of the production
stage, Nature draws next period’s aggregate component of productivity, ŷ, from the probability
distribution Φŷ (ŷ|y), and next period’s idiosyncratic component of productivity, ẑ, from the
probability distribution Φẑ (ẑ|z).8 The draws of the idiosyncratic component of productivity are
independent across matches.9
   6
     That is, workers and firms treat the tightness θ(x, ψ) just like households and firms treat prices in a Walrasian
Equilibrium.
   7
     The last property of q(θ) is needed to guarantee that the worker’s search problem is strictly concave and its
solution unique. The reader should notice that this property (as well as the other properties of p and q) are satisfied
by many standard specifications of the matching process. For example, it is satisfied by the CES matching process
q(θ) = [α/(α + θσ )]1/σ , p(θ) = θ [α/(α + θσ )]1/σ , α ∈ (0, 1) and 1 ≥ σ > 0.
   8
     Throughout this paper, the caret on a variable indicates the variable in the next period.
   9
     In order to keep the exposition simple, we have chosen to restrict attention to aggregate and idiosyncratic
shocks that aﬀect only labor productivity. However, the proof of the existence of a Block Recursive Equilibrium
does not depend on this choice, and can be easily generalized to the case in which aggregate and idiosyncratic
shocks aﬀect the search process, the value of unemployment, labor income taxes, etc.
                                                          5
2.2. Contractual Environment

We consider two alternative contractual environments. In the first environment, the firm commits
to an employment contract that specifies the worker’s wage as a function of the history of realiza-
tions of the idiosyncratic productivity of the match, z, the history of realizations of the aggregate
state of the economy, ψ, and the history of realizations of a two-point lottery that is drawn at
the beginning of every production stage.10 In the remainder of the paper, we shall refer to this as
the “dynamic contract” environment, since we will formulate the contracts recursively as in the
literature on dynamic contracts (e.g., Atkeson and Lucas, 1992).11 In the second environment,
the firm commits to a wage that remains constant throughout the entire duration of the employ-
ment relationship. This constant wage is allowed to depend only on the outcome of a two-point
lottery that is drawn at the beginning of the employment relationship. In the remainder of the
paper, we shall refer to this as the “fixed-wage contract” environment.

    We are interested in these two contractual environments because they have been the focus
of the literature on random search on the job. The “dynamic contract” environment generalizes
the environment considered by Burdett and Coles (2003) and Shi (2008) to an economy with
stochastic productivity.12 The “fixed-wage contract” environment is the same environment that
has been considered by Burdett and Mortensen (1998), van den Berg and Ridder (1998), and
Jolivet et al. (2006). Notice that, under both specifications of the environment, contracts are
incomplete because wages cannot be made contingent upon the outside oﬀers received by the
worker.


2.3. Worker’s Problem

Consider a worker whose current employment position gives him a lifetime utility V and who has
the opportunity to look for a job at the beginning of the search stage. His search decision is to
choose which submarket x to visit. If the worker visits submarket x, he succeeds in finding a job
with probability p(θ(x, ψ)), and fails with probability 1 − p (θ (x, ψ)). If he succeeds, he enters
the production stage in a new employment relationship which gives him the lifetime utility x. If
he fails to find a new match (or if he does not apply for a job), he enters the production stage by
  10
     We allow the specifications of the employment contract to depend on the history of realization of these two-
point lotteries in order to guarantee that the firm’s value function is concave. In this sense, lotteries play a similar
role in our model as in Prescott and Townsend (1984).
  11
     In contrast to most models in the literature on dynamic contracts, however, there is no private information in
our model, and a worker can quit for another job or into unemployment in any period during the contract.
  12
     In the special case where workers are risk neutral, the dynamic contracts considered in this paper attain the
same allocation as the complete contracts considered in Menzio and Shi (2008) do. Therefore, the proof of the
existence of a Block Recursive Equilibrium in this paper generalizes the existence proof in Menzio and Shi (2008).

                                                           6
retaining his current employment position, which gives him a lifetime utility V . Therefore, the
worker’s lifetime utility at the beginning of the search stage is V + max{0, R(V, ψ)}, where

                                      R(V, ψ) = max p(θ(x, ψ))(x − V ).                                        (2.1)
                                                   x∈X

Denote m(V, ψ) as the solution to the maximization problem in (2.1), and p̃(V, ψ) as the composite
function p(θ(m(V, ψ), ψ)).

       Next, consider an unemployed worker at the beginning of the production stage, and denote
as U(ψ) his lifetime utility. In the current period, the worker produces and consumes b units of
output. During the next search stage period, the worker is unemployed and has the opportunity
to look for a job with probability λu . Therefore, the worker’s lifetime utility U (ψ) is equal to
                                            h               n                oi
                         U (ψ) = υ(b) + βEψ̂ U (ψ̂) + λu max 0, R(U (ψ̂), ψ̂) .                                (2.2)



2.4. Firm’s Problem
2.4.1. Dynamic Contracts

Consider a firm that has just met a worker in submarket x. The firm oﬀers to the worker an
employment contract that specifies his wage at every future date as a function of the realized
history of the idiosyncratic productivity of the match, the realized history of the aggregate state of
the economy, and the history of realizations of a two-point lottery that is drawn at the beginning
of every production stage. The firm chooses the employment contract in order to maximize its
profits and provide the worker with the promised lifetime utility x. Charcaterizing the solution
to this problem is diﬃcult because the dimension of the history upon which wages are contingent
grows to infinity with time. However, following the literature on dynamic contracts (e.g. Atkeson
and Lucas, 1992), we can rewrite this problem recursively by using the worker’s lifetime utility
as an auxiliary state variable.13

       In the recursive formulation of the problem, the state of the contract at the beginning of each
production stage is described by the worker’s lifetime utility, V , by the state of the aggregate
economy, ψ, and by the idiosyncratic productivity of the match, z. Let s denote (ψ, z). Given V
and s, the firm chooses a two-point lottery over the worker’s wage w in the current period, the
worker’s probability d of becoming unemployed in the next separation stage, and the worker’s
  13
    More precisely, we can prove that the value function of the firm’s contracting problem is the unique solution
to the recursive problem (2.3). Also, we can prove that the firm’s contracting problem yields the same solutions
as the recurive problem (2.3). The proof of these equivalence results is standard. However, all details are available
upon request.

                                                         7
lifetime utility V̂ at the beginning of the next production stage. That is, the firm chooses a two-
point lottery c = (πi , wi , di , V̂i )2i=1 , where πi is the probability with which the realization of the
lottery is (wi , di , V̂i ). The firm’s choice is subject to a promise-keeping constraint, which requires
c to provide the worker with the lifetime utility V , and to an individual rationality constraint,
which requires the separation probability d to be consistent with the worker’s incentives to quit.
The firm chooses c to maximize the sum of its profits in the current period and its profits from
the next period onward. Therefore, the firm’s maximized value J(V, s) is equal to
                     P2      n                    h              ³                        ´                 io
 J(V, s) = max            π
                       i=1 i  y + z − w  i + βEŝ  (1 − di (ŝ))  1 − λe p̃(V̂i (ŝ) , ψ̂)  J(V̂i (ŝ) , ŝ)
               πi ,wi ,dˆi ,V̂i
   s.t.     πi ∈ [0, 1], wi ∈ R, di : Ψ × Z → [δ, 1], V̂i : Ψ × Z → X, for i = 1, 2,
            P2                               n                                                              o
                   π
               i=1 i  =  1,     di (ŝ)  =     δ  if U(  ψ̂) ≤ V̂i (ŝ) +   λe R( V̂i (ŝ) , ψ̂),   1  else    ,
            P2        n                    h                                   ³                                 ´io
               i=1 πi  υ(w  i ) +  βE   ŝ  di (ŝ)  U (ψ̂) + (1  −  d i (ŝ))  V̂i (ŝ) +   λ e R(V̂i (ŝ) , ψ̂)    = V.
                                                                                                                            (2.3)
We denote the optimal policy function associated with (2.3) as c(V, s) = (πi , wi , di , V̂i )2i=1 , where
πi = πi (V, s), wi = wi (V, s), di = di (V, s, ŝ), and V̂i = V̂i (V, s, ŝ), for i = 1, 2.


2.4.2. Fixed-Wage Contracts

With fixed-wage contracts, we assume that workers are risk averse; i.e., υ(w) = w for all w.
Consider a worker who is employed for a wage of w at the beginning of the production stage,
and denote as H(w, ψ) his lifetime utility. In the current period, the worker consumes w units
of output. During the next separation stage, the worker is forced to become unemployed with
probability δ, and has the option of keeping his job with probability 1 − δ. If the worker becomes
unemployed, he does not have the opportunity to look for a new job during the next search stage.
If the workers keeps his job, he has the opportunity to look for a better job with probability λe .
Therefore, the worker’s lifetime utility H(w, ψ) is equal to
                       n                         h                                  io
  H(w, ψ) = w + βEψ̂ d(ψ̂)U (ψ̂) + (1 − d(ψ̂)) H(w, ψ̂) + λe max{0, R(H(w, ψ̂), ψ̂)} ,
          n                                n                 o       o                                                      (2.4)
  d(ψ̂) = δ if U (ψ̂) ≤ H(w, ψ̂) + λe max 0, R(H(w, ψ̂), ψ̂) , 1 else .

We denote as h(V, ψ) the wage that provides an employed worker with the lifetime utility V .
That is, h(V, ψ) is the solution of the equation H(w, ψ) = V with respect to w.

    Next, consider a firm that employs a worker for a wage of w at the beginning of the production
stage, and denote as K(w, s) its lifetime profit. In the current period, the firm’s profit is given
by y + z − w. The discounted sum of profits from the next period onward is (1 − d(ψ̂))(1 −
                                                              8
λe p̃(H(w, ψ̂), ψ̂))K(w, ŝ). Therefore, K(w, s) is equal to
                                           h                                           i
               K(w, s) = y + z − w + βEŝ (1 − d(ψ̂))(1 − λe p̃(H(w, ψ̂), ψ̂))K(w, ŝ)) ,
                      n                                 n                  o          o             (2.5)
               d(ψ̂) = δ if U (ψ̂) ≤ H(w, ψ̂) + λe max 0, R(H(w, ψ̂), ψ̂) , 1 else .

       Finally, consider a firm that has just met a worker in submarket x = V , and denote as
J(V, ψ, z0 ) its lifetime profit. The firm oﬀers to the worker a two-point lottery over the constant
wage w. The firm’s oﬀer is required to provide the worker with the lifetime utility V (if accepted).
Therefore, the firm’s lifetime profit J(V, ψ, z0 ) is equal to
                                                 P
                           J(V, ψ, z0 ) = max 2i=1 πi K(h(Ṽi , ψ), ψ, z0 ),
                                                 πi ,Ṽi

                                   s.t.       πi ∈ [0, 1], Ṽi ∈ X, for i = 1, 2,                   (2.6)
                                              P2                P2
                                                 i=1 πi = 1,      i=1 πi Ṽi = V.

We denote the optimal policy function associated with (2.6) as c = (πi , Ṽi )2i=1 , where πi = πi (V, s)
and Ṽi = Ṽi (V, s), for i = 1, 2.


2.5. Market Tightness

During the search stage, a firm chooses how many vacancies to create and where to locate them.
The firm’s benefit of creating a vacancy in submarket x is the product between the probability
of meeting a worker, q(θ(x, ψ)), and the value of meeting a worker, J(x, ψ, z0 ). The firm’s cost
of creating a vacancy in submarket x is k. When the benefit is strictly smaller than the cost, the
firm’s optimal policy is to create no vacancies in x. When the benefit is strictly greater than the
cost, the firm’s optimal policy is to create infinitely many vacancies in x. And when the benefit
and the cost are equal, the firm’s profi is independent of the number of vacancies it creates in
submarket x.

       In any submarket that is visited by a positive number of workers, the tightness θ(x, ψ) is
consistent with the firm’s optimal creation strategy if and only if

                                          k ≥ q(θ(x, ψ))J(x, ψ, z0 ),                               (2.7)

and θ (x, ψ) ≥ 0, with complementary slackness. In any submarket that workers do not visit, the
tightness θ (x, ψ) is consistent with the firm’s optimal creation strategy if and only if q(θ(x, ψ))J(x, ψ, z0 )
is smaller than or equal to k. Following most of the literature on directed search, we restrict at-
tention to equilibria in which the tightness θ (x, ψ) satisfies condition (2.7) in all submarkets.14
  14
       See Acemoglu and Shimer (1999), Delacroix and Shi (2006), Menzio (2007), and Shi (2008)
                                                           9
3. Block Recursive Equilibrium: Definition and Procedure

The previous section motivates the following definition of a recursive equilibrium:

Definition 3.1. A Recursive Equilibrium consists of a market tightness function θ : X×Ψ → R+ ,
a search value function R : X × Ψ → R, a policy function m : X × Ψ → X, an unemployment
value function U : Ψ → R, a firm’s value function J : X × Ψ × Z → R, a contract policy function
c : X × Ψ × Z → C, and a transition probability function for the aggregate state of the economy
Φψ̂ : Ψ × Ψ → [0, 1]. These functions satisfy the following requirements:
(i) θ satisfies (2.7) for all (x, ψ) ∈ X × Ψ;
(ii) R satisfies (2.1) for all (V, ψ) ∈ X × Ψ, and m is the associated policy function;
(iii) U satisfies (2.2) for all ψ ∈ Ψ;
(iv) J satisfies (2.3) or (2.6) for all (V, ψ, z) ∈ X ×Ψ×Z, and c is the associated policy function;
(v) Φψ̂ is derived from the policy functions, (m, c), and the probability distributions for (ŷ, ẑ).


    Solving a recursive equilibrium outside of the steady-state requires solving a system of func-
tional equations in which the unknown functions depend on the entire distribution of workers
across employment states, (u, g). Since this distribution is a large dimensional object (for ex-
ample, it is an infinite dimensional object in the version of the model with dynamic contracts),
solving a recursive equilibrium outside of the steady-state is a diﬃcult task both analytically and
computationally. In contrast, solving the following class of equilibria is much easier because it
involves solving a system of functional equations in which the unknown functions have at most
three dimensions.

Definition 3.2. A Block Recursive Equilibrium (BRE) is a recursive equilibrium such that the
functions {θ, R, m, U, J, c} depend on the aggregate state of the economy, ψ, only through the
aggregate component of productivity, y, and not through the distribution of workers across em-
ployment states, (u, g).


    In this paper, we establish existence of a Block Recursive Equilibrium. To this aim, we define
J (X × Y × Z) (henceforth J ) as the set of firm’s value functions J : X × Y × Z → R such that:
(J1) For all (y, z) ∈ Y × Z and all V1 , V2 ∈ X, with V1 ≤ V2 , the diﬀerence J(V2 , y, z) − J(V1 , y, z)
is bounded between −B̄J (V2 − V1 ) and −B J (V2 − V1 ), where B̄J ≥ B J > 0 are some constants;
                                                                 ¯ 15 (J3) For all (y, z) ∈ Y × Z,
(J2) For all (V, y, z) ∈ X × Y × Z, J(V, y, z) is bounded in [J, J];
  15
     We list this property separately in addition to (J1) to emphasize the fact that the bounds J and J¯ are uniform
for all functions in the set J and for all (V, y, z).
                                                        10
J(V, y, z) is concave in V . In words, a firm’s value function J in the set J depends on ψ only
through y. Moreover, a firm’s value function J in the set J is bounded; it is strictly decreasing
and weakly concave in V ; and its “derivative” with respect to V is bounded above and below, i.e.
J is bi-Lipschitz continuous in V .16 In Appendix A, we prove that J is a non-empty, bounded,
closed and convex subset of the space of bounded, continuous functions on X × Y × Z, with the
sup norm.17

       In Section 4, we take an arbitrary firm’s value function J from the set J . Given J, we prove
that the market tightness function, θ, that solves the equilibrium condition (2.7) depends on
the state of the economy, ψ, only through the aggregate component of productivity, y, and not
through the distribution of workers across employment states, (u, g). Intuitively, since the value
of filling a vacancy in submarket x does not depend on the distribution of workers and the cost
of creating a vacancy is constant, the equilibrium probability of filling a vacancy in submarket x,
and hence the tightness of submarket x, must be independent of the distribution of workers.

       Given θ, we prove that the search value function, R, that solves the equilibrium condition
(2.1) depends on ψ only through y. Intuitively, R does not depend on (u, g), because neither the
probability that a worker finds a job in submarket x nor the benefit to a worker from finding a
job in submarket x depends on the employment status of other workers in the economy. Given
R, we prove that the unemployment value function, U, that solves the equilibrium condition
(2.2) depends on ψ only through y. Intuitively, U does not depend on (u, g), because neither
the output of an unemployed worker nor his return to searching depends on the distribution of
workers across diﬀerent employment states.

       In Section 5, we insert J, θ, R, and U in the RHS of the equilibrium condition (2.3) to
construct an update of the firm’s value function, where T maps the function J with which the
above procedure starts into a new function. First, we prove that T J depends on ψ only through
y. Intuitively, T J does not depend on (u, g) because the output of a match in the current period,
the probability that a match survives until the next production stage, and the value to the firm
of a match at the next production stage are all independent of the distribution of workers across
employment states. Second, we prove that T J is bounded between J and J; ¯ it is strictly decreasing
and weakly concave in V ; and its “derivative” with respect to V is bounded between −B̄J and
  16
      A function J (x) is Lipschitz over x ∈ X if |J(x2 ) − J (x1 )| ≤ B1 |x2 − x1 | for all x1 , x2 ∈ X, where B1 is a
finite constant. The function is bi-Lipschitz if, in addition, |J(x2 ) − J (x1 )| ≥ B2 |x2 − x1 | for all x1 , x2 ∈ X, where
B2 is a strictly positive constant. We need the firm’s value function J to be bi-Lipschitz in order to ensure the set
J to be closed and convex. In addition, bi-Lipschitz continuity implies that J is strictly decreasing, a property
that will be used to establish important properties such as those of the market tightness.
   17
      Throughout this paper, the norm is the sup norm unless it is specified otherwise.

                                                            11
−B J . Intuitively, the firm’s updated value function, T J, is bounded because the output of the
match is bounded and there is time discounting; T J is decreasing because a firm finds it costly to
provide a worker with higher lifetime utility; T J is concave because the contract between a firm
and a worker includes a lottery; and the “derivative” of T J is bounded because the derivative of
the worker’s utility function is bounded. Third, we prove that T J is continuous in J.

   From the first two properties of T J above, it follows that the equilibrium operator T maps
the set of firm’s value functions J into itself. From the third property of T J, it follows that the
equilibrium operator T is continuous in J. From bi-Lipschitz continuity of T J, it follows that
the family of functions T (J ) is equicontinuous. Overall, the equilibrium operator T satisfies the
assumptions of Schauder’s fixed point theorem (see Stokey and Lucas with Prescott, 1989), and,
hence, there exists a J ∗ ∈ J such that J ∗ = T J ∗ . Applying one more time the above procedure
that leads to the mapping T , but with the firm’s value function J ∗ , we can construct equilibrium
policy functions θ∗ , R∗ , m∗ , U ∗ , and c∗ . These functions and J ∗ constitute a Block Recursive
Equilibrium for the version of the model with dynamic contracts. In Section 6, we use a similar
argument to prove existence of a Block Recursive Equilibrium for the version of the model with
fixed-wage contracts.


4. General Properties of an Equilibrium

4.1. Market Tightness

Start with an arbitrary value function of the firm, J ∈ J , we construct the market tightness
function and analyze its properties. For all (x, ψ) ∈ X × Ψ such that J(x, y, z0 ) ≥ k, the solution
to the equilibrium condition (2.7) is given by a market tightness of q −1 (k/J(x, y, z0 )), where
                                                            ¯ For all (x, ψ) ∈ X × Ψ such that
q −1 (k/J(x, y, z0 )) is bounded between 0 and θ̄ ≡ q −1 (k/J).
J(x, y, z0 ) < k, the solution to the equilibrium condition (2.7) is given by a market tightness of 0.
The condition J(x, y, z0 ) ≥ k is satisfied if and only if x ≤ x̃(y), where x̃(y) is the solution to the
equation J(x, y, z0 ) < k with respect to x. From these observations, it follows that the function
θ : X × Y → [0, θ̄] defined as
                                       (
                                           q −1 (k/J(x, y, z0 )), if x ≤ x̃(y),
                           θ(x, y) =                                                              (4.1)
                                           0,                     else,

is the unique solution to the equilibrium condition (2.7) for all (x, ψ) ∈ X × Ψ.

   The market tightness function, θ, has several properties. First, θ depends on the aggregate
state of the economy, ψ, only through the aggregate component of productivity, y, and not
through the distribution of workers across diﬀerent employment states, (u, g). Second, the market
                                                12
tightness function, θ, is strictly decreasing with respect to x. Intuitively, since the firm’s value
from filling a vacancy is lower in a submarket with a higher x, the firm’s probability of filling
a vacancy must be higher. Third, the market tightness function, θ, is Lipschitz continuous in
x for all x, and bi-Lipschitz in x for x < x̃(y). Intuitively, since the firm’s value function, J,
is bi-Lipschitz continuous in x and the derivative of the function q −1 (.) is bounded, the market
tightness function defined in (4.1) is also bi-Lipschitz continuous for all such x that θ (x, y) > 0.
Finally, the probability that a worker meets a vacancy in submarket x, p(θ(x, y)), decreases at
an increasing rate as x increases. This property follows from the concavity of the firm’s value
function J and of the composite function p(q −1 (.)). These properties of θ are summarized in the
following lemma and proved in Appendix B.


Lemma 4.1. (i) For all y ∈ Y , the market tightness function, θ, is such that

           B̄J                                          B k
                  (x2 − x1 ) ≤ θ(x2 , y) − θ(x1 , y) ≤ 0 J ¯2 (x2 − x1 ),   if x1 ≤ x2 ≤ x̃(y),
        q 0 (θ̄)k                                     q (0)J
          B̄J                                                                                      (4.2)
         0
                (x2   − x1 ) ≤ θ(x2 , y) − θ(x1 , y) ≤ 0,                   if x1 ≤ x̃(y) ≤ x2 ,
        q (θ̄)k
       θ(x2 , y) − θ(x1 , y) = 0,                                           if x̃(y) ≤ x1 ≤ x2 ,

where B J and B̄J are the bi-Lipschitz bounds on all functions in J . (ii) For all y ∈ Y and all
x ∈ [x, x̃ (y)], the composite function p(θ(x, y)) is strictly decreasing and strictly concave in x.


   The function θ (x, y) constructed above depends on the arbitrary function J. Consider two
arbitrary functions Jn , Jr ∈ J . Let θn denote the market tightness function computed with
Jn , and θr with Jr . In the following lemma, we prove that, if the distance between Jn and Jr
converges to zero, so does the distance between θn and θr . That is, we prove that the market
tightness function, θ, is continuous with respect to the firm’s value function J with which it is
computed. This result will be used in Sections 5 and 6 to establish that the equilibrium operator
T is continuous.


Lemma 4.2. For any ρ > 0 and any Jn , Jr ∈ J , if kJn − Jr k < ρ, then
                                                              £             ¤
                                kθn − θr k < αθ ρ, αθ ≡ −B̄J / q 0 (θ̄)B J k .                     (4.3)

Proof: For the sake of brevity, let us suppress the dependence of various functions on (y, z).
Let ρ > 0 be an arbitrary real number. Let Jn and Jr be arbitrary functions in J such that
kJn − Jr k < ρ. Let y be an arbitrary point in Y . From property (J1) of the set J , it follows
                                                       13
that Jr (x + B −1                                                    −1
               J ρ) − Jr (x) ≤ −ρ and, hence, Jr (x) − ρ ≥ Jr (x + B J ρ). From property (J1), it
also follows that Jr (x) − Jr (x − B −1                                           −1
                                     J ρ) ≤ −ρ and, hence, Jr (x) + ρ ≤ Jr (x − B J ρ). From these
observations and kJn − Jr k < ρ, it follows that

                                 Jn (x) < Jr (x) + ρ ≤ Jr (x − B −1
                                                                 J ρ),
                                                                                                    (4.4)
                                 Jn (x) > Jr (x) − ρ ≥ Jr (x + B −1
                                                                 J ρ).



From the first line in (4.4) and equation (4.1), it follows that θn (x) ≤ θr (x − B −1
                                                                                    J ρ). Similarly,
from the second line in (4.4) and equation (4.1), it follows that θn (x) ≥ θr (x + B −1
                                                                                     J ρ). Hence,

                           θn (x) − θr (x) < θr (x − B −1
                                                       J ρ) − θr (x) ≤ αθ ρ,

                           θn (x) − θr (x) > θr (x + B −1
                                                       J ρ) − θr (x) ≥ −αθ ρ,

where αθ is defined in (4.3). Thus, |θn (x) − θr (x)| ≤ αθ ρ. Since this result holds for all (x, y, z) ∈
X × Y × Z, we conclude that kθn − θr k < αθ ρ.          ¥


4.2. Search Problem

Given the firm’s value function J ∈ J , the market tightness function θ defined in (4.1) sat-
isfies the equilibrium condition (2.7).      Given θ, the search value function, R, that satisfies
the equilibrium condition (2.1) is equal to maxx∈X f (x, V, y) for all (x, ψ) ∈ X × Ψ, where
f (x, V, y) ≡ p(θ(x, y))(x − V ). Note that, for all (V, ψ) ∈ X × Ψ, the objective function, f ,
depends on the aggregate state of the economy, ψ, through the aggregate component of produc-
tivity, y, and not through the distribution of workers across diﬀerent employment states, (u, g).
Also, note that the choice set, X, is independent of the aggregate state of the economy, ψ. From
these observations, it follows that the optimal search decision and the search value function, R,
depend on ψ only through y and not through (u, g).

   Given θ, a search policy function satisfies the equilibrium condition (2.1) if its value belongs
to arg maxx∈X f (x, V, y) for all (V, ψ) ∈ X × Ψ. For all (V, ψ) ∈ X × Ψ, the objective function,
f , is negative for all x in the interval [x, V ], strictly positive for all x in the interval (V, x̃(y)),
and equal to zero for all x in the interval [x̃(y), x̄]. Moreover, the objective function is strictly
concave in x for all x in the interval (V, x̃(y)) (Shi, 2008, Lemma 3.1). Therefore, if V < x̃(y),
the argmax is unique and belongs to the interval (V, x̃(y)). If V ≥ x̃(y), the argmax includes any
point between V and x̄. From these observations, it follows that the function m : X × Y → X
defined as                          (
                                        arg maxx∈X f (x, V, y),   if V < x(y),
                        m(V, y) =                                                                   (4.5)
                                        V,                        else,
                                                   14
is the unique solution to the equilibrium condition (2.1).

   In Lemma 4.3, we prove that the search value function, R, is decreasing in V . Intuitively,
since the value to a worker from finding a job in submarket x is decreasing in the value of his
current employment position, V , and the probability that a worker finds a job in submarket x is
independent of V , the return to search is decreasing in V . Also, in Lemma 4.3, we prove that the
search policy function, m, is increasing in V . Intuitively, since the marginal rate of substitution
between the value oﬀered by a new job and the probability of finding a new job is decreasing in V ,
the optimal search strategy is increasing in V . Monotonicity of m in V implies that the workers
choose to separate themselves into diﬀerent submarkets in job search. Moreover, in Lemmas 4.3
and 4.3, we prove that the search value and policy functions are Lipschitz continuous in V . These
results will be used in Sections 5 and 6 to prove that the equilibrium operator T is continuous.


Lemma 4.3. For all y ∈ Y and all V1 , V2 ∈ X, V1 ≤ V2 , the search value function, R, is such
that
                                 −(V2 − V1 ) ≤ R(V2 , y) − R(V1 , y) ≤ 0,                             (4.6)

and the search policy function, m, is such that

                                   0 ≤ m(V2 , y) − m(V1 , y) ≤ V2 − V1 .                              (4.7)

Proof: For the sake of brevity, let us suppress the dependence of the functions θ, x̃, m and p
on y. Let V1 and V2 be two arbitrary points in X, with V1 ≤ V2 . The diﬀerence R(V2 ) − R(V1 )
is such that
       R(V2 ) − R(V1 ) ≤ f (m(V2 ), V2 ) − f (m(V2 ), V1 ) ≤ −p(θ(m(V2 )))(V2 − V1 ) ≤ 0,
       R(V2 ) − R(V1 ) ≥ f (m(V1 ), V2 ) − f (m(V1 ), V1 ) ≥ −p(θ(m(V1 )))(V2 − V1 ) ≥ −(V2 − V1 ).

where the first inequality in both lines makes use of the fact that R(Vi ) is equal to f (m(Vi ), Vi )
and greater than f (m(V−i ), Vi ) where −i 6= i and i, −i = 1, 2. Thus, (4.6) holds.

Turn to (4.7). If V1 ≥ x̃, then m(V2 ) = V2 and m(V1 ) = V1 . In this case, (4.7) clearly holds. If
V2 ≥ x̃ ≥ V1 , then m(V2 ) = V2 and m(V1 ) ∈ (V1 , x̃). Also in this case, (4.7) holds.

Now, consider the remaining case where V1 ≤ V2 < x̃. Since f (m(V1 ), V1 ) ≥ f (m(V2 ), V1 ) and
f (m(V2 ), V2 ) ≥ f (m(V1 ), V2 ), we have

                  0   ≥ f (m(V2 ), V1 ) − f (m(V1 ), V1 ) + f (m(V1 ), V2 ) − f (m(V2 ), V2 )
                      = p(θ(m(V2 )))(V2 − V1 ) − p(θ(m(V1 )))(V2 − V1 )
                      = [p(θ(m(V2 ))) − p(θ(m(V1 )))] (V2 − V1 ).
                                                  15
Since p(θ(x)) is decreasing in x, the previous inequality implies that m(V2 ) − m(V1 ) ≥ 0.

If m(V2 ) − m(V1 ) = 0, (4.7) holds. If m(V2 ) − m(V1 ) > 0, let ∆ be an arbitrary real number in
the open interval between 0 and (m(V2 ) − m(V1 ))/2. Using the definition of R, we can deduce
from the inequality f (m(V1 ), V1 ) ≥ f (m(V1 ) + ∆, V1 ) the following result:
                                                p(θ(m(V1 ) + ∆))∆
                           m(V1 ) − V1 ≥                                   .
                                           p(θ(m(V1 ))) − p(θ(m(V1 ) + ∆))
Similarly, because f (m(V2 ), V2 ) ≥ f (m(V2 ) − ∆, V2 ), we have
                                                p(θ(m(V2 ) − ∆))∆
                           m(V2 ) − V2 ≤                                   .
                                           p(θ(m(V2 ) − ∆)) − p(θ(m(V2 )))
Recall that the function p (θ (x)) is decreasing and concave in x for all x ≤ x̃ (y). Since m (V1 ) +
∆ ≤ m (V2 ) − ∆, then p(θ(m(V1 ) + ∆)) ≥ p(θ(m(V2 ) − ∆)). Similarly, since m (V1 ) < m (V2 ),
p(θ(m(V1 ))) − p(θ(m(V1 ) + ∆)) ≤ p(θ(m(V2 ) − ∆)) − p(θ(m(V2 ))). From these observations and
the inequalities above, it follows that m(V2 ) − m(V1 ) ≤ V2 − V1 . Hence, (4.7) holds.         ¥

     Now we turn to the composite function p̃(V, y) = p(θ(m(V, y), y)). The probability p̃ (V, y) is
the probability that an employed worker finds a new job during the matching stage, given that
his current job gives him the lifetime utility V and the aggregate component of productivity is y.
The following corollary states that the function p̃ (V, y) is decreasing and Lipschitz continuous in
V:


Corollary 4.4. For all y ∈ Y and all V1 , V2 ∈ X, V1 ≤ V2 , the quitting probability p̃ is such that

                       −B̄p (V2 − V1 ) ≤ p̃(V2 , y) − p̃(V1 , y) ≤ −B p (V2 − V1 ) ,                (4.8)
                        £         ¤
where B̄p = −p0 (0)B̄J / q 0 (θ̄)k > 0 and B p = 0.

Proof: Let y be an arbitrary point in Y , and let V1 , V2 be two points in X with V1 ≤ V2 . From
Lemma 4.3, it follows that the diﬀerence m(V2 , y) − m(V1 , y) is greater than 0 and smaller than
V2 − V1 . From Lemma 4.1, it follows that the diﬀerence θ(m(V2 , y), y) − θ(m(V2 , y), y) is greater
                    £         ¤
than (V2 − V1 )B̄J / q 0 (θ̄)k and smaller than 0. Finally, since p is a concave function of θ, the
diﬀerence p(θ(m(V2 , y), y)) − p(θ(m(V2 , y), y)) is such that
                         £         ¤
              p0 (0)B̄J / q 0 (θ̄)k (V2 − V1 ) ≤ p(θ(m(V2 , y), y)) − p(θ(m(V1 , y), y)) ≤ 0.

These are the bounds in (4.8).         ¥

     Now, consider two arbitrary functions Jn , Jr ∈ J . Let θn denote the market tightness
function computed with Jn , Rn and mn the search value and policy functions computed with
                                           16
θn , and p̃n (V, y) the composite function p(θn (mn (V, y), y)). Similarly, let θr denote the market
tightness function computed with Jr , Rr and mr the search value and policy functions computed
with θr , and p̃r (V, y) the composite function p(θr (mr (V, y), y)). In the following lemma, we prove
that, if the distance between Jn and Jr converges to zero, so does the distance between Rn and
Rr and the distance between p̃n and p̃r . That is, we prove that the search value function R and
the separation probability p̃ are continuous with respect to the firm’s value function J. These
results will be used in Sections 5 and 6 to establish that the equilibrium operator T is continuous.



Lemma 4.5. For any ρ > 0 and any Jn , Jr ∈ J , if kJn − Jr k < ρ, then

                               kRn − Rr k < αR ρ,       αR ≡ p0 (0)αθ (x̄ − x),                  (4.9)

                kp̃n − p̃r k < αp (ρ) ,    αp (ρ) ≡ max{2B̄p ρ1/2 + p0 (0) αθ ρ, 2αR ρ1/2 }.    (4.10)

As ρ → 0, αp (ρ) → 0.

Proof: For the sake of brevity, let us suppress the dependence of various functions on V and
y. Let ρ > 0 be an arbitrary real number. Let Jn and Jr be arbitrary functions in J such that
kJn − Jr k < ρ. Let (V, y) be an arbitrary point in X × Y . The distance between Rn (V, y) and
Rr (V, y) is such that

                  |Rn − Rr |     ≤ max |[p(θn (x)) − p(θr (x))] (x − V )|
                                   x∈X
                                   ½                             ¾½             ¾
                                 ≤ max |p(θn (x)) − p(θr (x))|      max |x − V |
                                     x∈X                              x∈X
                                  ½    ¯R              ¯¾
                                       ¯ θn (x) 0      ¯
                                 ≤ max ¯ θr (x) p (t)dt¯ (x̄ − x) < p0 (0)αθ (x̄ − x)ρ,
                                     x∈X

where the last inequality makes use of the bounds in (4.3). Since this result holds for all (V, y) ∈
X × Y , we conclude that kRn − Rr k < αR ρ.

Now, consider the function p̃. Without loss of generality, assume mr (V, y) ≤ mn (V, y). (If
mr (V, y) > mn (V, y), just switch the roles of mn and mr in the proof below.) First, consider the
case where p(θr (mr )) ≤ p(θn (mn )). In this case, the distance between p(θn (mn )) and p(θr (mr ))
is such that

               (0 ≤) p (θn (mn )) − p (θr (mr )) ≤ p (θn (mr )) − p (θr (mr )) < p0 (0) αθ ρ,

where the first inequality makes use of the fact that p(θn (x)) is decreasing in x and mn ≥ mr ,
and the second inequality makes use of the bounds in (4.3).
                                              17
Second, consider the case where p(θr (mr )) > p(θn (mn )) and mn − 2ρ1/2 ≤ mr ≤ mn . In this
case, the distance between p(θn (mn )) and p(θr (mr )) is such that
                     (0 <) p (θr (mr )) − p (θn (mn ))
                      =    p (θr (mr )) − p (θr (mn )) + p (θr (mn )) − p (θn (mn ))
                      <    2B̄p ρ1/2 + p0 (0) αθ ρ,
where the last inequality makes use of the bounds in (4.8) and in (4.3). Note that this bound is
larger than the one in the previous case.

Finally, consider the remaining case where p(θr (mr )) > p(θn (mn )) and mr < mn − 2ρ1/2 < mn .
First, note that mr ≥ V , because mr ∈ (V, x̃r ) if V < x̃r , and mr = V if V ≥ x̃r . This observation
implies that mn > V + ρ1/2 , because if mn ≤ V + ρ1/2 then mr < V − ρ1/2 < V , which is a
contradiction. Second, note that mn > V implies mn < x̃n , because mn ∈ (V, x̃n ) if V < x̃n , and
mn = V if V ≥ x̃n . This observation implies that mn < x̃n .

Note that p(θn (mn ))(mn − V ) ≥ p(θn (mn − ρ1/2 ))(mn − ρ1/2 − V ), because mn is the optimal
search decision when J = Jn . Therefore, we have
                                 £                                ¤¡              ¢
              p(θn (mn ))ρ1/2 ≥   p(θn (mn − ρ1/2 )) − p(θn (mn )) mn − ρ1/2 − V
                                 £                                ¤¡             ¢
                              ≥   p(θn (mr )) − p(θn (mr + ρ1/2 )) mn − ρ1/2 − V
                                 £                                ¤¡             ¢
                              ≥   p(θn (mr )) − p(θn (mr + ρ1/2 )) mr + ρ1/2 − V .
To obtain the second inequality we have used the facts that p(θn (x)) is concave in x for all
x ∈ [x, x̃n ], that mr +ρ1/2 < mn < x̃n , and that mn −ρ1/2 −V > 0. To obtain the third inequality
we have used the facts that mr + ρ1/2 < mn − ρ1/2 , and that p(θn (mr )) − p(θn (mr + ρ1/2 )) > 0.
Next, note that p(θr (mr ))(mr − V ) is greater than p(θr (mr + ρ1/2 ))(mr + ρ1/2 − V ). Therefore,
we have
                                 h                                i³            ´
                p(θr (mr ))ρ1/2 ≤ p(θr (mr )) − p(θr (mr + ρ1/2 )) mr + ρ1/2 − V .

Subtracting this inequality from the previous result and dividing by ρ1/2 , we obtain
  (0 <) p(θr (mr )) − p(θn (mn ))
              £                                                               ¤¡             ¢
   ≤ ρ−1/2 p(θr (mr )) − p(θn (mr )) + p(θn (mr + ρ1/2 )) − p(θr (mr + ρ1/2 )) mr + ρ1/2 − V
   <    2p0 (0)αθ ρ1/2 (x̄ − x) = 2αR ρ,
where the last line makes use of the fact that the distance between p(θr (m)) and p(θn (m)) is
smaller than p0 (0)αθ ρ, and that mr + ρ1/2 − V is smaller than x̄ − x.

Overall, we have established that the distance between p(θr (mr )) and p(θn (mn )) is such that

             |p(θr (mr )) − p(θn (mn ))| < max{2B̄p ρ1/2 + p0 (0) αθ ρ, 2αR ρ1/2 } = αp (ρ)

Since this result holds for all (V, y) ∈ X × Y , we conclude that ||p̃r − p̃n || < αp (ρ).    ¥
                                                      18
4.3. Unemployment Value

Given the firm’s value function J ∈ J , the solution to the equilibrium condition (2.7) is the
market tightness, θ, defined in (4.1). Given θ, the solution to the equilibrium condition (2.1) is
the search value function, R, defined as R(V, y) = maxx∈X f (x, V, y). Given R, an unemployment
value function is a solution to the equilibrium condition (2.2) if and only if it is a fixed point of
the mapping TU defined as
                                           n                               o
                    (TU ϕ)(ψ) = υ(b) + βEψ̂ ϕ(ψ̂) + λu max{0, R(ϕ(ψ̂), ŷ)} .                   (4.11)

In the next lemma, we prove that there exists a unique fixed point of the mapping TU within
the set C(Y ) of bounded continuous functions ϕ : Y → R. Therefore, there exists a unique
unemployment value function, U ∈ C(Y ), that satisfies the equilibrium condition (2.2), and that
depends on the aggregate state of the economy, ψ, only through the aggregate component of
productivity, y, but not through the distribution of workers across diﬀerent employment states,
(u, g).

Lemma 4.6. (i) There exists a unique function U ∈ C(Y ) such that U = TU U . (ii) For all y ∈ Y ,
       £      ¤
U (y) ∈ U , Ū , where U = (1 − β)−1 υ(b) > x and Ū = υ(b) + β x̄ < x̄.

Proof: In Appendix C.         ¥

    Now, consider two arbitrary functions Jn , Jr ∈ J . Let θn denote the market tightness function
computed with Jn , Rn the search value function computed with θn , and Un the unemployment
value function computed with Rn . Similarly, let θr denote the market tightness function computed
with Jr , Rr the search value function computed with θr , and Ur the unemployment value function
computed with Rr . In the following lemma, we prove that, if the distance between Jn and Jr
converges to zero, so does the distance between Un and Ur .

Lemma 4.7. For any ρ > 0 and any Jn , Jr ∈ J , if kJn − Jr k < ρ, then

                          kUn − Ur k < αU ρ,       αU ≡ βλu αR / (1 − β) .                      (4.12)

Proof: For the sake of brevity, let us suppress the dependence of various functions on ŷ. Let ρ > 0
be an arbitrary real number. Let Jn and Jr be arbitrary functions in J such that kJn − Jr k < ρ.
Let y be an arbitrary point in Y . The distance between Un (y) and Ur (y) is such that
              |Un (y) − Ur (y)|
          ≤   βEŷ {|[Un + λu Rn (Un )] − [Ur + λu max Rn (Ur )]| + λu |Rn (Ur ) − Rr (Ur )|}
          <   β kUn − Ur k + βλu αR ρ.
                                                 19
To obtain the second inequality we have used the fact that the distance between Un + λu Rn (Un )
and Un + λu Rn (Un ) is smaller than the distance between Un and Ur . Since the above result holds
for all y ∈ Y , it follows that kUn − Ur k < αu ρ.                     ¥


5. Block Recursive Equilibrium with Dynamic Contracts

5.1. Updated Value Function of the Firm

In the previous section, we have chosen an arbitrary firm’s value function, J ∈ J . Given J, we
have computed the market tightness function, θ, that satisfies the equilibrium condition (2.7).
Given θ, we have computed the search value and policy functions, R and m, that satisfy the
equilibrium condition (2.1). Given R, we have computed the unemployment value function, U ,
that satisfies the equilibrium condition (2.2). In this section, we insert J, θ, R, m and U into the
right hand side of the equilibrium condition (2.3) to compute an update, J,     ˜ of the firm’s value
function J. This process implicitly defines a mapping T through J˜ = T J. More specifically, J˜ is
given by18
        ˜ y, z)
        J(V,
               P2      n                  h                                                                        io
 =        max   i=1 πi  y + z − wi + βEŝ  (1 − di (ŷ, ẑ))(1 − λ e p̃(V̂i (ŷ, ẑ) , ŷ))J(V̂i (ŷ, ẑ) , ŷ, ẑ)
        πi ,wi ,dˆi ,V̂i

 s.t.   πi ∈ [0, 1], wi ∈ R, di : Y × Z → [δ, 1], V̂i : Y × Z → X, for i = 1, 2,
        P2                                  n                                                                           o
           i=1 πi =  1,     di (ŷ, ẑ)  =    δ   if U  (ŷ) ≤ V̂i (ŷ,  ẑ) +   λ e R(  V̂i (ŷ, ẑ) , ŷ),   1  else    ,
        P2        n                    h                                                                                        io
               π
           i=1 i   υ(w  i ) +  βE   ŝ  di (ŷ, ẑ)  U (ŷ) + (1  −  d  i (ŷ, ẑ))( V̂i (ŷ, ẑ) +   λ  e R(V̂i (ŷ, ẑ) , ŷ))   = V.
                                                                                                                                    (5.1)
                                             ˜ has four important properties. First, J˜ depends
     The updated value function of the firm, J,
on the aggregate state of the economy, ψ, only through the aggregate component of productivity,
y, and not through the distribution of workers across diﬀerent employment states, (u, g). This
property follows immediately from the fact that both the objective function and the choice set on
                                                                                                ˜
the right hand side of (5.1) depend on y but not on (u, g). Second, the updated value function, J,
is bi-Lipschitz continuous in V . More specifically, for all (y, z) ∈ Y × Z and all V1 , V2 ∈ X, with
                         ˜ 2 , y, z)− J(V
V1 ≤ V2 , the diﬀerence J(V           ˜ 1 , y, z) is bounded between −(V2 −V1 )/υ 0 and −(V2 −V1 )/ῡ 0
                                                                      £   ¤
(see part (i) in the proof of Lemma 5.1). Third, J˜ is bounded in J, J¯ , where the bounds J and
   18
       In a Block Recursive Equilibrium, the distribution of workers across employment states in the next period,
(û, ĝ), is uniquely determined by the realization of the aggregate component of productivity in the next period,
ŷ, and by the state of the economy in the current period, ψ. Therefore, in the contracting problem (5.1), next
period’s separation probability, di , and continuation value, V̂i , can be written as functions of ŷ only.


                                                                 20
J¯ are independent of J and J˜ (see (5.2) below). Finally, J˜ is concave in V , as a result of the use
of the lottery in the contract (see part (iii) in the proof of Lemma 5.1).

    The bounds B J , B̄J , J, and J¯ are set as
                                        (¯                           ¯ ¯                     ¯)
          1         1                      ¯ȳ + z̄ − υ −1 (x − β x̄)¯ ¯y + z − υ−1 (x̄ − βx)¯
    B̄J = 0 , B J = 0 , −J = J¯ = max                                 ,                         .                 (5.2)
         υ         ῡ                            1 − β(1 − δ)               1 − β(1 − δ)

With these bounds, J˜ satisfies conditions (J1)-(J3) and, hence, belongs to the set J , as stated in
the next lemma.


Lemma 5.1. Set the bounds B J , B̄J , J, and J¯ as in (5.2). Then, the updated value function,
˜ belongs to the set J .
J,

                                      ˜ y, z) is equal to maxγ∈Γ F (γ, V, y, z), where γ is
Proof: For all (V, y, z) ∈ X × Y × Z, J(V,
defined as the tuple (π1 , Ṽ1 , V̂1 , V̂2 ); Γ is defined as the set of γ’s such that π1 ∈ [0, 1), Ṽ1 ∈ R,
V̂1 : Y × Z → X, and V̂2 : Y × Z → X; and F (γ, V, y, z) is defined as
                  P        n                h                                                                       io
  F (γ, V, y, z) = 2i=1 πi y + z − wi + βEŝ (1 − di (ŷ, ẑ))(1 − λe p̃(V̂i (ŷ, ẑ) , ŷ))J(V̂i (ŷ, ẑ) , ŷ, ẑ) ,

       s.t.       π2 = 1 − π1 , Ṽ2 = (V − π1 Ṽ1 )/π2 ,
                               n                                                          o
                  di (ŷ, ẑ) = δ if U(ŷ) ≤ V̂i (ŷ, ẑ) + λe R(V̂i (ŷ, ẑ), ŷ), 1 else ,
                               ³         h                                                                         i´
                  wi = υ −1 Ṽi − βEŝ di (ŷ, ẑ)U (ŷ) + (1 − di (ŷ, ẑ))(V̂i (ŷ, ẑ) + λe R(V̂i (ŷ, ẑ), ŷ)) .
                                                                                                                    (5.3)
Let F 0 (γ, V, y, z) denote the derivative of F (γ, V, y, z) with respect to V . It is immediate to verify
that                                                         ∙        ¸
                                    0                  1       1    1
                                  F (γ, V, y, z) = − 0      ∈ − 0,− 0 .
                                                    υ (w2 )    υ   ῡ


(i) First, we want to prove that J˜ satisfies property (J1) of the set J . To this aim, let (y, z) be an
arbitrary point in Y × Z, and let V1 , V2 be two points in X with V1 ≤ V2 . The distance between
˜ 2 , y, z) and J(V
J(V              ˜ 1 , y, z) is such that
             ¯                           ¯
             ¯˜              ˜ 1 , y, z)¯¯ ≤ maxγ∈Γ |F (γ, V2 , y, z) − F (γ, V1 , y, z)|
             ¯J(V2 , y, z) − J(V
                                                    ¯R                      ¯
                                                    ¯ V                     ¯
                                           ≤ maxγ∈Γ ¯ V21 F 0 (γ, t, y, z)dt¯
                                                    RV
                                           ≤ maxγ∈Γ V21 |F 0 (γ, t, y, z)| dt ≤ |V2 − V1 | /υ0 .

The inequality above implies that the function J˜ is Lipschitz continuous in V . Therefore, it
is absolutely continuous and almost everywhere diﬀerentiable with respect to V (see Royden,
                                            21
1988, page 112). The function F is diﬀerentiable with respect to V . Therefore, at any point of
diﬀerentiability, the derivative of J˜ with respect to V is equal to F 0 (γ ∗ (V, y, z), V, y, z), where
γ ∗ (V, y, z) belongs to arg maxγ∈Γ F (γ, V, y, z) (see Milgrom and Segal, 2003, Theorem 1). From
these properties of J, ˜ it follows that the diﬀerence J(V            ˜ 1 , y, z) is such that
                                                        ˜ 2 , y, z) − J(V
                                        Z   V2                                   ∙                  ¸
                       ˜ 1 , y, z) =
         ˜ 2 , y, z) − J(V                                                          V2 − V1 V2 − V1
         J(V                                     F 0 (γ ∗ (t, y, z), t, y, z)dt ∈ −        , −        .
                                          V1                                           υ0      ῡ0



(ii) Next, we want to prove that J˜ satisfies property (J2) of the set J . To this aim, let (V, y, z)
be an arbitrary point in X × Y × Z. Also, let γ0 denote the tuple (π1,0 , Ṽ1,0 , V̂1,0 , V̂2,0 ), where
                                                          ˜ y, z) is such that
π1,0 = 0, Ṽ1,0 = x̄, V̂1,0 = V̂2,0 = x. The firm’s value J(V,
                                                        nP                              P2              o
        ˜ y, z)                                           2
        J(V,          ≤ ȳ + z̄ + βδ J¯ − min(πi ,Ṽi )   i=1 πi υ −1 (Ṽ − β x̄), s.t.
                                                                         i               i=1 πi Ṽi = V
                                                            ¯
                      ≤ ȳ + z̄ + βδ J¯ − υ −1 (x − β x̄) ≤ J,

where the first inequality makes use of the bounds on y, z, w and J, and the second inequality
                                                               ˜ y, z) is such that
makes use of the convexity of υ −1 (.). Also, the firm’s value J(V,

                      ˜ y, z) ≥ F (γ0 , V, y, z) ≥ y + z − υ −1 (x̄ − βx) + βδJ ≥ J,
                      J(V,

where the first inequality makes use of the fact that γ0 belongs to Γ, and the second inequality
makes use of the bounds on y, z, w and J.

(iii) In Appendix F, we prove that J˜ is concave with respect to V . Hence, J˜ satisfies property
(J3) of the set J .        ¥

   Now, consider two arbitrary functions Jn , Jr ∈ J . Let θn , Rn , p̃n , Un , Fn and J˜n denote
the functions computed with Jn . Similarly, let θr , Rr , p̃r , Ur , Fr and J˜r denote the functions
computed with Jr ∈ J . The next lemma proves that as the distance between Jn and Jr converges
to zero, the distance between J˜n and J˜r converges to zero as well. That is, the mapping T is
continuous.


Lemma 5.2. For any ρ > 0 and any Jn , Jr ∈ J , if kJn − Jr k < ρ, then

                                      kJ˜n − J˜r k < βλe αp (ρ) J¯ + αJ ρ,                                  (5.4)

where                        £        ¡            ¢             ¤
                αJ ≡ αw + β (1 + λe ) 1 + B̄J αV̂ + λe B̄p αV̂ J¯ ,
                                                            ¡              ¢
                αV̂ ≡ (λe αR + αU + 1)/ (1 − λe ) , αw ≡ β αU + αV̂ + λe αR /υ 0 .
                                                         22
Proof: For the sake of brevity, suppress the dependence of various functions on (ŷ, ẑ). Let ρ > 0
be an arbitrary real number. Let Jn and Jr be arbitrary functions in J such that kJn − Jr k <
ρ. Let (V, y, z) to an arbitrary point in X × Y × Z. Without loss in generality, assume that
J˜n (V, y, z) ≤ J˜r (V, y, z). (If J˜n (V, y, z) > J˜r (V, y, z), just switch the roles of J˜n and J˜r in the
proof below).

Denote as γr = (π1,r , Ṽ1,r , V̂1,r , V̂2,r ) a tuple such that γr ∈ Γ and Fr (γr , V, y, z) = J˜r (V, y, z). Also,
denote as wi,r and di,r the wage and the separation probability implied by (5.3) for F (γ, V, y, z) =
Fr (γr , V, y, z). Denote as γn the tuple (π1,n , Ṽ1,n , V̂1,n , V̂2,n ), where π1,n = π1,r , Ṽ1,n = Ṽ1,r , and
               ⎧
               ⎪
               ⎪   V̂i,r , if [V̂i,r + λe Rn (V̂i,r ) − Un ][V̂i,r + λe Rr (V̂i,r ) − Ur ] > 0,
               ⎨
      V̂i,n =      Un − λe Rn (V̂i,n ) + ρ, if V̂i,r + λe Rn (V̂i,r ) ≤ Un , V̂i,r + λe Rr (V̂i,r ) ≥ Ur ,      (5.5)
               ⎪
               ⎪
               ⎩
                   Un − λe Rn (V̂i,n ) − ρ, if V̂i,r + λe Rn (V̂i,r ) ≥ Un , V̂i,r + λe Rr (V̂i,r ) < Ur .

Let wi,n and di,n denote the wage and separation probability implied by (5.3) for F (γ, V, y, z) =
Fn (γn , V, y, z). Note that (5.5) implies di,n = di,r .

First, we want to bound the distance ||V̂i,n − V̂i,r ||. To this aim, let (ŷ, ẑ) denote an arbitrary
point in Y × Z. Consider the case in which V̂i,r + λe Rn (V̂i,r ) − Un has the same sign as V̂i,r +
λe Rr (V̂i,r ) − Ur . In this case, V̂i,n = V̂i,r and, hence, ||V̂i,n − V̂i,r || < αV̂ ρ. Next, consider the case
in which V̂i,r + λe Rn (V̂i,r ) − Un has a diﬀerent sign from V̂i,r + λe Rr (V̂i,r ) − Ur . In this case, the
absolute value of V̂i,r + λe Rn (V̂i,r ) − Un is such that
      ¯                            ¯     ¯                                                          ¯
      ¯                            ¯     ¯                                                          ¯
      ¯V̂i,r + λe Rn (V̂i,r ) − Un ¯ ≤ ¯V̂i,r + λe Rn (V̂i,r ) − Un − (V̂i,r + λe Rr (V̂i,r ) − Ur )¯
                                                                                                               (5.6)
                                       ≤ (λe αR + αU ) ρ,

where the second inequality makes use of the bounds in (4.9) and (4.12). Moreover, the absolute
value of V̂i,r + λe Rn (V̂i,r ) − Un is such that
    ¯                            ¯     ¯                                                          ¯
    ¯                            ¯     ¯                                                          ¯
    ¯V̂i,r + λe Rn (V̂i,r ) − Un ¯ = ¯V̂i,r + λe Rn (V̂i,r ) − Un − (V̂i,n + λe Rn (V̂i,n ) − Un )¯ − ρ
                                                ¯              ¯                                               (5.7)
                                                ¯              ¯
                                    ≥ (1 − λe ) ¯V̂i,r − V̂i,n ¯ − ρ,

where the equality makes use of the definition of V̂i,n in (5.5), and the inequality makes use of
the bounds in (4.6). From (5.6) and (5.7), it follows that (0 <) V̂i,n − V̂i,r < αV̂ ρ and, hence,
|V̂i,n − V̂i,r | < αV̂ ρ. Since these results hold for all (ŷ, ẑ) ∈ Y × Z, we have

                                              ||V̂i,n − V̂i,r || < αV̂ ρ.                                      (5.8)


Second, we want to bound the distance |wi,r − wi,n |. From the definitions of wi,r and wi,n , it
                                            23
follows that υ(wi,r ) and υ(wi,n ) are
                                                    h                                             i
                        υ(wi,r )      = Ṽi,r − βEŝ di,r Ur + (1 − di,r )(V̂i,r + λe Rr (V̂i,r )) ,
                                                    h                                               i
                        υ(wi,n )      = Ṽi,n − βEŝ di,n Un + (1 − di,n )(V̂i,n + λe Rn (V̂i,n ))
                                                    h                                              i
                                      = Ṽi,r − βEŝ di,r Un + (1 − di,r )(V̂i,n + λe Rn (V̂i,n )) ,

where the last line makes use of the fact that, by construction, Ṽi,n = Ṽi,r and di,n = di,r . From
the previous equations, it follows that the distance between υ(wi,n ) and υ(wi,r ) is such that

     |υ(wi,n ) − υ(wi,r )|         ≥ υ 0 |wi,n − wi,r | ,
                                           n              ¯h                   i h                      i¯o
                                                          ¯                                              ¯
     |υ(wi,n ) − υ(wi,r )|         ≤ βEŝ |Un − Ur | + ¯ V̂i,n + λe Rn (V̂i,n ) − V̂i,r + λe Rn (V̂i,r ) ¯
                                          n¯h                    i h                      i¯o                            (5.9)
                                            ¯                                              ¯
                                   +βEŝ ¯ V̂i,r + λe Rn (V̂i,r ) − V̂i,r + λe Rr (V̂i,r ) ¯
                                        ¡                   ¢
                                   < β αU + αV̂ + λe αR ρ,

where the last inequality makes use of the bounds in (4.12), (5.8) and (4.9). Taken together, the
two inequalities in (5.9) imply that

                                                       |wi,n − wi,r | < αw ρ.                                           (5.10)


Third, we want to bound the distance between (1−λe p̃n (V̂i,n ))Jn (V̂i,n ) and (1−λe p̃r (V̂i,r ))Jr (V̂i,r )
To this aim, note that the distance between Jn (V̂i,n ) and Jr (V̂i,r ) is such that
    ¯                         ¯ ¯                           ¯ ¯                           ¯ ¡            ¢
    ¯                         ¯ ¯                           ¯ ¯                           ¯
    ¯Jn (V̂i,n ) − Jr (V̂i,r )¯ ≤ ¯Jn (V̂i,n ) − Jn (V̂i,r )¯ + ¯Jn (V̂i,r ) − Jr (V̂i,r )¯ < 1 + B̄J αV̂ ρ,            (5.11)

where the last inequality makes use of the bounds in (5.8). Also, note that the distance between
p̃n (V̂i,n )Jn (V̂i,n ) and p̃r (V̂i,r )Jr (V̂i,r ) is such that
                          ¯                                                 ¯
                          ¯                                                 ¯
                          ¯p̃n (V̂i,n )Jn (V̂i,n ) − p̃r (V̂i,r )Jr (V̂i,r )¯
                                       ¯                          ¯              ¯                           ¯
                                       ¯                          ¯              ¯                           ¯
                      ≤ p̃n (V̂i,n ) ¯Jn (V̂i,n ) − Jr (V̂i,n )¯ + p̃n (V̂i,n ) ¯Jr (V̂i,n ) − Jr (V̂i,r )¯
                             ¯           ¯¯                           ¯ ¯             ¯¯                            ¯   (5.12)
                             ¯           ¯¯                           ¯ ¯             ¯¯                            ¯
                          + ¯Jr (V̂i,r )¯ ¯p̃n (V̂i,n ) − p̃n (V̂i,r )¯ + ¯Jr (V̂i,r )¯ ¯p̃n (V̂i,r ) − p̃r (V̂i,r )¯
                          ¡                              ¢
                      <     1 + B̄J αV̂ + B̄p αV̂ J¯ ρ + αp (ρ) J,         ¯

where we have used Lemma 4.10 to bound the last diﬀerence. From (5.11) and (5.12), it follows
that                         ¯                                                                    ¯
                             ¯                                                                    ¯
                             ¯(1 −  λ   p̃ (V̂
                                      e n i,n    ))J   ( V̂
                                                     n i,n    ) −  (1 − λ   p̃ (V̂
                                                                           e r i,r   ))Jr i,r ¯
                                                                                          (V̂    )
                             ¯                         ¯        ¯                                               ¯
                             ¯                         ¯        ¯                                               ¯       (5.13)
                       ≤     ¯Jn (V̂i,n ) − Jr (V̂i,r )¯ + λe ¯p̃n (V̂i,n )Jn (V̂i,n ) − p̃r (V̂i,r )Jr (V̂i,r )¯
                                               £            ¡             ¢                  ¤
                       <     λe αp (ρ) J¯ + (1 + λe ) 1 + B̄J αV̂ + λe B̄p αV̂ J¯ ρ.
                                                                  24
Finally, we want to bound the distance between J˜r (V, y, z) and J˜n (V, y, z). To this aim, note
that the diﬀerence J˜r (V, y, z) − J˜n (V, y, z) is positive (by assumption). Also, note that the diﬀer-
ence J˜r (V, y, z) − J˜n (V, y, z) is smaller than Fr (γr , V, y, z) − Fn (γn , V, y, z) because J˜r (V, y, z) =
Fr (γr , V, y, z) and Fn (γn , V, y, z) ≤ J˜n (V, y, z). From these observations and the bounds (5.8),
(5.10) and (5.13), it follows that

    0≤       J˜r (V, y, z) − J˜n (V, y, z) ≤ Fr (γr , V, y, z) − Fn (γn , V, y, z)
             P2           n                         h¯                                                      ¯io
                                                     ¯                                                      ¯
        ≤            π
                 i=1 i,r   |w i,n −  w i,r | + βEŝ  ¯ (1 − λ p̃ (V̂
                                                             e n i,n  ))J  (V̂
                                                                          n i,n  ) − (1 − λ p̃ (V̂
                                                                                           e r i,r ))Jr i,r ¯
                                                                                                       (V̂ )
                               ©             £          ¡           ¢              ¤ª
        <    βλe αp (ρ) J¯ + αw + β (1 + λe ) 1 + B̄J αV̂ + λe B̄p αV̂ J¯ ρ,

Since the above inequality holds for all (V, y, z) ∈ X × Y × Z, it implies the result stated in the
lemma.          ¥


5.2. Existence of a Block Recursive Equilibrium

Now, we are in the position to establish the paper’s main result.


Theorem 5.3. There exists a Block Recursive Equilibrium.

Proof: First, fix ε > 0 to be an arbitrary real number. Let ρε be the unique positive solution
for ρ of the equation βλe αp (ρ) J¯ + αj ρ = ε. For all Jn , Jr ∈ J such that kJn − Jr k < ρε , Lemma
5.2 implies that kT Jn − T Jr k < ε. Hence, the equilibrium operator T is continuous. Next, let ρy
denote the minimum distance between distinct elements of the set Y , and ρz the minimum distance
between distinct elements of the set Z, i.e. ρy = minY |yi − yj | and ρz = minZ |zi − zj |.19 Also,
let k.kE denote the standard norm on the Euclidean space X × Y × Z. Let ρ̃ε = min{υ 0 ε, ρy , ρz }.
For all (V1 , y1 , z1 ), (V2 , y2 , z2 ) ∈ X × Y × Z such that k(V2 , y2 , z2 ) − (V1 , y1 , z1 )kE < ρ̃ε and all
J ∈ J , Lemma 5.1 implies that T J satisfies the property (J1) of the set J and, consequently,
|(T J)(V2 , y2 , z2 ) − (T J)(V2 , y2 , z2 )| < ε. Hence, the family of functions T (J ) is equicontinuous.
Finally, Lemma 5.1 implies that the equilibrium operator T maps the set of functions J into
itself.

From these properties, it follows that the equilibrium operator T satisfies the conditions of
Schauder’s fixed point theorem (Stokey and Lucas with Prescott, 1989, Theorem 17.4). There-
fore, there exists a firm’s value function J ∗ ∈ J such that T J ∗ = J ∗ . Denote as θ∗ the market
tightness function computed with J ∗ . Denote as R∗ and m∗ the search value and policy func-
tions computed with θ∗ . Denote as U ∗ the unemployment value function computed with R∗ .
  19
       If Y contains only one element, we can set ρy = 1. Similarly, if Z contains only one elemet, set ρz = 1.
                                                           25
Denote as c∗ the contract policy function computed with J ∗ , θ∗ , R∗ , m∗ , and U ∗ . The functions
{θ∗ , R∗ , m∗ , U ∗ , J ∗ , c∗ } satisfy the conditions (i)—(v) in the definition of a recursive equilibrium.
The functions {θ∗ , R∗ , m∗ , U ∗ , J ∗ , c∗ } depend on the aggregate state of the economy, ψ, only
through the aggregate component of productivity, y, and not through the distribution of workers
across diﬀerent employment states, (u, g). Hence, the functions {θ∗ , R∗ , m∗ , U ∗ , J ∗ , c∗ } constitute
a Block Recursive Equilibrium.           ¥

       Directed search is necessary for existence of a Block Recursive Equilibrium. To see this
necessity clearly, suppose that search is random. Then the equilibrium condition (2.7) is replaced
by
                                   k ≥ max q(θ(ψ))I (x, ψ) J(x, ψ, z0 ),                                (5.14)
                                        x∈X

and θ(ψ) ≥ 0, with complementary slackness. The term on the LHS of (5.14) is the cost of
creating a vacancy. The expression on the RHS of (5.14) is the maximized benefit of creating a
vacancy. The first term on the RHS is the probability that a firm meets a worker. The second
term denotes the probability that a worker met by a firm is willing to accept an employment
contract that provides him with the lifetime utility x. The third term is the value to the firm
of being matched with a worker to whom it has promised the lifetime utility x. With random
search, x is a random draw from the oﬀer distribution, and so a worker’s acceptance probability of
a new match depends on the distribution of workers across employment states. The equilibrium
condition (5.14) holds only if the distribution aﬀects also the equilibrium market tightness or
the firm’s value function. In either case, the equilibrium fails to be block recursive with random
search. In contrast, directed search eliminates the dependence of the acceptance probability on
the distribution of workers because a worker always accepts a job that he chooses to search for;
that is, I (x∗ , ψ) = 1 where x∗ = m (V, ψ).20

       For the sake of completeness, let us list three other assumptions about the production tech-
nology and the search process that are necessary for existence of a Block Recursive Equilibrium:
the linear production function, the vacancy cost independent of the aggregate vacancy rate, and
a matching technology with constant returns to scale. If the production function were either con-
cave or convex, the distribution of workers across diﬀerent employment states would aﬀect the
output of a match and, in turn, the firm’s value function, the market tightness function and the
value of unemployment. If the vacancy cost depends the aggregate vacancy rate, the distribution
of workers across diﬀerent employment states would aﬀect the aggregate vacancy rate, the vacancy
  20
    When m (V, ψ) is strictly increasing in V , the workers are endogenously separated into diﬀerent submarkets
in the search process. This endogenous separation is a common feature of directed search (e.g., Moen, 1997, and
Acemoglu and Shimer, 1999), and it also holds in the presence of ex ante heterogeneity (e.g., Shi, 2001).

                                                      26
cost and, ultimately, the equilibrium market tightness. Finally, if the matching process between
vacancies and applicants exhibits non-constant returns to scale, the distribution of applicants
across diﬀerent submarkets (and, hence, the distribution of workers across diﬀerent employment
states) would aﬀect the market tightness function and, in turn, the firm’s and worker’s value
functions. We emphasize that these assumptions are standard and that they alone do not lead
to block recursivity of an equilibrium. For example, they are maintained in the models of search
on the job by Burdett and Mortensen (1998), Postel-Vinay and Robin (2002), and Burdett and
Coles (2003), where the equilibrium fails to be block recursive because search is undirected.


6. Block Recursive Equilibrium with Fixed-Wage Contracts

In the model with fixed-wage contracts, the equilibrium operator T may not be continuous. For
example, the search value function, Rn , and the unemployment value function, Un , computed with
the firm’s value function Jn may be such that the worker prefers being employed at the wage w
than being unemployed. However, given a firm’s value function Jr that is arbitrarily close to Jn ,
the search value function, Rr , and the unemployment value function, Ur , may be such that the
worker’s preference ordering between employment at the wage w and unemployment is reversed.
When this is the case, the probability with which a worker leaves a job that pays the wage w is
not continuous in J and, hence, the firm’s value from employing a worker at the wage w, K(w, s)
defined in (2.5), and the firm’s updated value function, T J, are not continuous in J.21

       Since the equilibrium operator T may not be continuous, we cannot appeal to Schauder’s
theorem in order to prove existence of a fixed point of T , and, in turn, existence of a Block
Recursive Equilibrium. Instead, we adopt the following strategy. We consider a proxy of the
model with fixed-wage contracts in which a worker is not allowed to voluntarily quit his jobs
during the separation stage. Formally, in this proxy model, the equilibrium conditions (2.4) and
(2.5) are replaced by
                           n                 h                                     io
         H(w, ψ) = w + βEψ̂ δU (ψ̂) + (1 − δ) H(w, ψ̂) + λe max{0, R(H(w, ψ̂), ψ̂)} ,                        (6.1)

and
                                                 h                                        i
              K(w, s) = y + z − w + β (1 − δ) Eŝ (1 − λe p̃(H(w, ψ̂), ψ̂))K(H(w, ψ̂), ŝ) .                 (6.2)

We prove that the equilibrium operator associated with the proxy model admits a fixed point
because it satisfies all the conditions of Schauder’s theorem (including continuity). Finally, we
  21
    This discontinuity does not occur with dynamic contracts, because the future wage path (i.e., the promised
future value) can be adjusted to ensure that job separation rates are close to each other whenever the firm’s value
functions are close to each other. See the proof of Lemma 5.2.
                                                        27
use the fixed point to construct a Block Recursive Equilibrium of the proxy model. If, along the
equilibrium path, a worker never has the incentive to quit his job during the separation stage,
the BRE of the proxy model is also a BRE of the original model.


6.1. Employment Value

Given an arbitrary firm’s value function J ∈ J , let R denote the search value function that
solves the equilibrium condition (2.1), and U the unemployment value function that solves the
equilibrium condition (2.2). Given R and U , an employment value function is a solution to the
equilibrium condition (6.1) if and only if it is a fixed point of the mapping TH defined as
                            n                 h                                     io
     (TH ϕ)(w, ψ) = w + βEψ̂ δU (ŷ) + (1 − δ) ϕ(w, ψ̂) + λe max{0, R(ϕ(w, ψ̂), ŷ)} .          (6.3)

In Lemma 6.1, we prove that there exists a unique fixed point of the mapping TH within the set
C(W ×Y ) of bounded continuous functions ϕ : W ×Y → R (where W is defined below). Therefore,
there exists a unique employment value function, H, that satisfies the equilibrium condition (6.1),
and depends on the aggregate state of the economy, ψ, only through the aggregate component of
productivity, y. Moreover, in Lemma 6.1, we prove that H is strictly decreasing and bi-Lipschitz
continuous in w.


Lemma 6.1. Let W = [w, w̄], where w̄ is given by [1 − β(1 − δ)]x̄ − βδU and w by x − β[1 −
β(1 − δ)]−1 (w̄ + βδ Ū ). (i) There exists a unique function H ∈ C(W × Y ) such that H = TH H.
(ii) For all y ∈ Y and all w1 , w2 ∈ W , w1 ≤ w2 , H is such that

                   w2 − w1 ≤ H(w2 , y) − H(w1 , y) ≤ (w2 − w1 ) / [1 − β(1 − δ)] .              (6.4)

(iii) For all y ∈ Y , H is such that

                             H(w, y) ≤ x,      x̄ ≤ H(w̄, y), all y ∈ Y .                       (6.5)

Proof: In Appendix D.          ¥

   From the properties of the employment value function, H, we can derive some properties of
the wage function, h, which is the solution of the equation H(w, ψ) = V with respect to w. First,
since H is strictly increasing in w, h is well-defined. Second, since H is strictly increasing and
bi-Lipschitz continuous in w, h is strictly increasing and bi-Lipschitz in V . More specifically, for
all y ∈ Y and all V1 , V2 ∈ X, with V1 ≤ V2 , we have

                      [1 − β(1 − δ)](V2 − V1 ) ≤ h(V2 , y) − h(V1 , y) ≤ V2 − V1 .              (6.6)
                                                 28
Finally, since H is strictly increasing in w and satisfies property (6.5), h(V, y) belongs to the
interval W for all (V, y) ∈ X × Y .

   Now, consider two arbitrary functions Jn , Jr ∈ J . Let Rn , Un , Hn and hn denote the functions
computed with Jn . Similarly, let Rr , Ur , Hr and hr denote the functions computed with Jr ∈ J .
Lemma 6.2 proves that as the distance between Jn and Jr converges to zero, the distance between
Hn and Hr and the distance between hn and hr both converge to zero. That is, H and h are
continuous in J.


Lemma 6.2. For any ρ > 0 and any Jn , Jr ∈ J , if kJn − Jr k < ρ, then

                                kHn − Hr k < αh ρ,      khn − hr k < αh ρ,
                                                                                                     (6.7)
                                αh ≡ β (αu + λe αR ) / (1 − β) .

Proof: Let ρ > 0 be an arbitrary real number; let Jn and Jr be arbitrary functions in J such
that kJn − Jr k < ρ. Let (w, y) be an arbitrary point in W × Y . Then, the distance between
Hn (w, y) and Hr (w, y) is such that

      |Hn (w, y) − Hr (w, y)|
  ≤   βEŷ {|Un (y) − Ur (y)| + λe |max{0, Rn (Hn (w, ŷ), ŷ)} − max{0, Rr (Hn (w, ŷ), ŷ)}|}
  +   βEŷ {|Hn (w, ŷ) + λe max{0, Rr (Hn (w, ŷ), ŷ)} − Hr (w, ŷ) − λe max{0, Rr (Hr (w, ŷ), ŷ)}|}
  <   β (αu + λe αR ) ρ + β kHn − Hr k ,

where the last inequality makes use of the bounds in (4.12), (4.9), and (4.6). Since the above
result holds for all (w, y) ∈ W × Y , the RHS is an upper bound on kHn − Hr k. Re-arranging
terms yields the bound on kHn − Hr k given by (6.7).

Now, let (V, y) be an arbitrary point in X × Y . The distance between hn (V, y) and hr (V, y) is
such that
               |hn (V, y) − hr (V, y)|   ≤ |Hn (hn (V, y), y) − Hn (hr (V, y), y)|
                                         = |Hr (hr (V, y), y) − Hn (hr (V, y), y)| < αh ρ,
where the first inequality uses the fact that Hn (w, y) satisfies condition (6.4), and the equality
uses the fact that Hn (hn (V, y), y) = Hr (hr (V, y), y) = V . Since the above result holds for all
(V, y) ∈ X × Y , the RHS is an upper bound on khn − hr k, as given by (6.7).                 ¥


6.2. Value Function of the Firm

Let H and p̃ denote the employment value function and the separation probability computed
with an arbitrary function J ∈ J . Given H and p̃, a firm’s value function is a solution to the

                                                   29
equilibrium condition (6.2) if and only if it is a fixed point of the mapping TK defined as

                (TK ϕ)(w, s) = y + z − w + β (1 − δ) Eŝ [(1 − λe p̃(H(w, ŷ), ŷ))ϕ(w, ŝ)] .               (6.8)

In Lemma 6.3, we prove that there exists a unique fixed point of the mapping TK within the set
C(W × Y × Z) of bounded continuous functions ϕ : W × Y × Z → R. Therefore, there exists a
unique firm’s value function, K, that satisfies the equilibrium condition (6.2), and that depends
on the aggregate state of the economy, ψ, only through the aggregate component of productivity,
y. Then, we prove that K is bounded between K and K̄, where
                                      (¯           ¯               )
                                        ¯y + z − w̄¯ |ȳ + z̄ − w|
                       −K = K̄ = max                 ,               .
                                        1 − β(1 − δ) 1 − β(1 − δ)

Finally, we prove that K is bi-Lipschitz continuous in w. That is, for all w1 ≤ w2 , the diﬀerence
K(w2 , y, z) − K(w1 , y, z) is bounded between −B̄K (w2 − w1 ) and −B K (w2 − w1 ), where
                                    ¡              ¢
                       1 − β (1 − δ) 1 + λe B̄p K̄              1 − β(1 − δ)(1 + λe B̄p K)
          BK =                                          , B̄K =                            ,
                [1 − β (1 − δ)] [1 − β(1 − δ)(1 − λe )]              [1 − β(1 − δ)]2

In the remainder of this section, we will assume that the parameters of the model are such that
0 < B K ≤ B̄K < ∞.22


Lemma 6.3. (i) There exists a unique function K ∈ C(W × Y × Z) such that K = TK K. (ii)
For all (y, z) ∈ Y × Z and all w1 , w2 ∈ W , with w1 ≤ w2 , K is such that

                    −B̄K (w2 − w1 ) ≤ K(w2 , y, z) − K(w1 , y, z) ≤ −B K (w2 − w1 ) ,                        (6.9)

(iii) For all (w, y, z) ∈ W × Y × Z, K is such that

                                             K(w, y, z) ∈ [K, K̄].                                          (6.10)

Proof: In Appendix E.             ¥

    Now, consider two arbitrary functions Jn , Jr ∈ J . Let Rn , Un , Hn , hn and Kn denote the
functions computed with Jn . Similarly, let Rr , Ur , Hr , hr and Kr denote the functions computed
with Jr ∈ J . Lemma 6.4 proves that as the distance between Jn and Jr converges to zero, the
distance between Kn and Kr goes to zero as well.
  22
     It is immediate to verify that the condition 0 < B K ≤ B̄K < ∞ is satisfied as long as the probability λe that
an employed worker has the opportunity of searching is not too large.



                                                        30
Lemma 6.4. For any ρ > 0 and any Jn , Jr ∈ J , if kJn − Jr k < ρ, then

                        kKn − Kr k < αK (ρ),
                                              ¡                 ¢±                                              (6.11)
                        αK (ρ) ≡ β(1 − δ)λe K̄ B̄p αh ρ + αp (ρ) [1 − β(1 − δ)] .

Proof: Let ρ > 0 be an arbitrary real number; let Jn and Jr be arbitrary functions in J such
that kJn − Jr k < ρ. Let (w, y, z) be an arbitrary point in W × Y × Z. The distance between
Kn (w, y, z) and Kr (w, y, z) is such that

      |Kn (w, y, z) − Kr (w, y, z)|
  ≤   β(1 − δ)Eŝ {|Kn (w, y, z) − Kr (w, y, z)|}
  +   β(1 − δ)λe K̄Eŝ {|p̃n (Hn (w, ŷ), ŷ) − p̃n (Hr (w, ŷ), ŷ)| + |p̃n (Hr (w, ŷ), ŷ) − p̃r (Hr (w, ŷ), ŷ)|}
              £                                             ¤
  <   β(1 − δ) kKn − Kr k + λe K̄ (Bp αh ρ + αp (ρ)) ,

where the last inequality makes use of the bounds in (6.7), (6.9) and (4.4). Since this result holds
for all (w, y, z) ∈ W × Y × Z, the RHS is an upper bound on kKn − Kr k. Re-arranging terms
yields the bound on kKn − Kr k given by (6.11).                           ¥


6.3. Existence of a Block Recursive Equilibrium

In the previous subsections, we have computed the employment value function, H, the wage
function, h, and the firm’s value function, K, associated with an arbitrary J ∈ J . In this
subsection, we insert K and h into the right hand side of the equilibrium condition (2.6), and we
compute an update, J˜ = T J, for the value function J. More specifically, J˜ is given by
                           ˜ y, z) = max P2 πi K(h(Ṽi , y), y, z),
                          J(V,                  i=1
                                                 πi ,Ṽi
                                                     P2                                                         (6.12)
                                s.t.          V =          i=1 πi Ṽi ,

                                              πi ∈ [0, 1], π1 + π2 = 1, Ṽi ∈ X.


                         ˜ has four properties. First, J˜ depends on the aggregate state of
   The updated function, J,
the economy, ψ, only through the aggregate component of productivity, y. This property follows
immediately from the fact that both the objective function and the choice set on the right hand
                                                                               ˜ is bi-Lipschitz
side of (5.1) depend on ψ only through y. Second, the updated value function, J,
continuous in V . More specifically, for all (y, z) ∈ Y × Z and all V1 , V2 ∈ X, with V1 ≤ V2 , the
           ˜ 2 , y, z)−J(V
diﬀerence J(V           ˜ 1 , y, z) is bounded between −B̄K (V2 −V1 ) and −B K (1−β(1−δ))(V2 −V1 )
                                                                       £     ¤
(see part (i) in the proof of Lemma 6.5). Third, J˜ is bounded in J, J¯ for some bounds J and
J¯ that are independent of J and J.    ˜ More specifically, for all (V, y, z) ∈ X × Y × Z, J(V,
                                                                                           ˜ y, z)
is greater than K and smaller than K̄ (see part (ii) in the proof of Lemma 6.5). Finally, J˜ is
                                             31
concave in V (see part (iii) in the proof of Lemma 6.5). Therefore, given the appropriate choices
                      ¯ the updated value function, J,
of B J , B̄J , J, and J,                            ˜ satisfies conditions (J1), (J2) and (J3) and,
hence, it belongs to the set J . This argument is formalized in the following lemma:



Lemma 6.5. Set J = K, and J¯ = K̄. Set B J = B K (1 − β(1 − δ)) and B̄J = B̄K . Then, the
                        ˜ belongs to the set J .
updated value function, J,

                                                                   ˜ y, z) is such that
Proof: (i) Let (V, y, z) be an arbitrary point in X × Y × Z. Then, J(V,
                 ˜ y, z) ≤ max
                 J(V,         Ṽ1 ∈X K(h(Ṽ1 , y), y, z) ≤ maxw∈W K(w, y, z) ≤ K̄,
                 ˜ y, z) ≥ min
                 J(V,         Ṽ1 ∈X K(h(Ṽ1 , y), y, z) ≤ minw∈W K(w, y, z) ≥ K,

where we used the fact that if Ṽ1 ∈ X then h(Ṽ1 , y) ∈ W . The above inequalities imply that J˜
satisfies property (J1) of the set J .

(ii) Let (y, z) be an arbitrary point in Y × Z, and V1 , V2 two arbitrary points in X, with
V1 ≤ V2 . Let {πi,1 , Ṽi,1 }2i=1 denote the maximizer of (6.12) for V = V1 , and {πi,2 , Ṽi,2 }2i=1 the
maximizer of (6.12) for V = V2 . Let {∆i,1 }2i=1 be a vector such that Σ2i=1 πi,1 (Ṽi,1 + ∆i,1 ) = V2
and ∆i,1 ∈ [0, x̄ − Vi,1 ]. Also, let {∆i,2 }2i=1 be a vector such that Σ2i=1 πi,2 (Ṽi,2 − ∆i,2 ) = V1 and
∆i,2 ∈ [0, Vi,2 − x]. Note that {πi,1 , Ṽi,1 + ∆i,1 }2i=1 belongs to the choice set of (6.12) for V = V2 .
Therefore,
                                       P2        h                                                                i
       ˜ 2 , y, z) − J(V
       J(V           ˜ 1 , y, z)   ≥       πi,1   K(h(  Ṽ i,1 +   ∆ i,1 , y),  y, z) − K(h(     Ṽi,1 , y), y, z)
                                       i=1
                                           hP            ³                                           ´i
                                                2
                                   ≥ −B̄K          π
                                                i=1 i,1     h( Ṽi,1 +   ∆  i,1 , y) − h(Ṽi,1 , y)

                                   = −B̄K (V2 − V1 ).

Next, note that {πi,2 , Ṽi,2 − ∆i,2 }2i=1 belongs to the choice set of (6.12) for V = V2 . Therefore,
                                        P2        h                                              i
       ˜             ˜
      J(V2 , y, z) − J(V1 , y, z) ≤ i=1 πi,2 K(h(Ṽi,2 , y), y, z) − K(h(Ṽi,2 − ∆i,2 , y), y, z)
                                              hP          ³                                   ´i
                                                 2
                                    ≤ −B K       i=1 πi,2  h(Ṽi,2 , y) − h(Ṽ i,2 − ∆i,2 , y)

                                   = −B K (1 − β(1 − δ))(V2 − V1 ).

The above inequalities imply that J˜ satisfies property (J2) of the set J .

(iii) Finally, Appendix F shows that J˜ is concave with respect to V . Hence, J˜ satisfies property
(J3) of the set J .      ¥

   Now, consider two arbitrary functions Jn , Jr ∈ J . Let Hn , hn , Kn and J˜n denote the functions
computed with Jn . Similarly, let Hr , hr , Kr and J˜r denote the functions computed with Jr ∈ J .
                                                       32
Lemma 6.4 proves that as the distance between Jn and Jr converges to zero, the distance between
J˜n and J˜r goes to zero as well.

Lemma 6.6. For any ρ > 0 and any Jn , Jr ∈ J , if kJn − Jr k < ρ, then

                        ||J˜n − J˜r k < αJ (ρ),   αJ (ρ) ≡ αK (ρ) + B̄K αh ρ.                    (6.13)

Proof: Let ρ > 0 be an arbitrary real number; let Jn and Jr be arbitrary functions in J such
that kJn − Jr k < ρ. Denote as Hn , hn and Kn the functions computed with Jn , and Hr hr and
Kr the functions computed with Jr . Let (V, y, z) be an arbitrary point in X × Y × Z.             The
distance between J˜n (V, y, z) and J˜r (V, y, z) is such that
               ¯                              ¯
               ¯˜                 ˜           ¯
               ¯ n
                J  (V, y, z)    − Jr (V, y, z)¯
                            h¯                             ¯ ¯                              ¯i
                              ¯                            ¯ ¯                              ¯
            ≤ maxṼ1 ∈X ¯Kn (hn (Ṽ1 )) − Kn (hr (Ṽ1 ))¯ + ¯Kn (hr (Ṽ1 )) − Kr (hr (Ṽ1 ))¯
                            £                               ¤
            ≤ maxV1 ∈X B̄K khn − hr k + kKn − Kr k ≤ αK (ρ) + B̄K αh ρ,
where the last inequality makes use of the bounds in (6.7), (6.9) and (6.11). Since this result
holds for all (V, y, z) ∈ X × Y × Z, the RHS is an upper bound on ||J˜n − J˜r ||. ¥

   Lemma 6.5 implies that the equilibrium operator T maps the set J into itself. Moreover,
since the functions in the set J are bi-Lipschitz and the sets Y and Z are finite, Lemma 6.5
implies that the family of functions T (J ) is equicontinuous. In addition, Lemma 6.6 implies that
the operator T is continuous. Since these properties of the operator T are suﬃcient to apply
Schauder’s fixed point theorem, there exists a function J ∗ ∈ J such that T J ∗ = J ∗ . Clearly, the
firm’s value function J ∗ , together with the associated tightness function θ∗ , search value function
R∗ , search policy function m∗ , and unemployment value function U ∗ , constitute a Block Recursive
Equilibrium. This completes the proof of the following theorem:

Theorem 6.7. There exists a Block Recursive Equilibrium for the proxy of the model with
fixed-wage contracts.

   For any Block Recursive Equilibrium of the proxy model, we can compute the worker’s value
of unemployment, U ∗ (y), and the worker’s value of employment at the beginning of the search
stage, H ∗ (w, y) + λe max{0, R∗ (H ∗ (w, y), y)}. A BRE of the proxy model is a BRE of the original
model if
                         U ∗ (y) ≤ H ∗ (w, y) + λe max{0, R∗ (H ∗ (w, y), y)}                    (6.14)

for all equilibrium wages w and for all realizations of the aggregate component of productivity
y. This condition implicitly restricts the parameter values of the model. We do not explicitly
                                               33
characterize this restriction here. However, notice that, since unemployed workers search for jobs
that oﬀer lifetime utility H ∗ (w, y) greater than U ∗ (y) and since employed workers search for even
better jobs, (6.14) is likely to be satisfied as long as aggregate productivity shocks are suﬃciently
small. This is the case in the calibrated example below.


7. A Calibrated Example

In Sections 5 and 6, we have established existence of a Block Recursive Equilibrium for our
stochastic model of directed search on the job. In this section, we want to illustrate additional
properties of a BRE. To this aim, we calibrate the parameters of the model using the data on
the US labor market. Given the calibrated parameters, we construct the equilibrium operator T
and we apply it to an arbitrary value function, J ∈ J , until we reach a fixed point, J ∗ . Then,
we construct a BRE by computing the agents’ value functions, policy functions and the market
tightness function associated with J ∗ . For the sake of brevity, we report our findings only for the
version of the model with fixed-wage contracts.

      The workers’ preferences are described by the discount factor β, and the value of leisure b.
The search technology is described by the probability that an unemployed worker is able to look
for a job, λu , by the probability that an employed worker is able look for a job, λe , and by the
job-finding probability function, p(θ). We assume that p(θ) is of the form θ(1 + θγ )−1/γ . The
production technology is described by the vacancy creation cost k, the exogenous job-destruction
probability δ, and the stochastic processes for the idiosyncratic and the aggregate components
of productivity. We assume that the idiosyncratic component of productivity, z, is always equal
to zero, and that the aggregate component of productivity, y, obeys a two-state Markov process,
with y ∈ {0.95, 1.05}. The unconditional mean of y is normalized to 1.

      We set the model period to be one quarter. We set β equal to 0.987, so that the annual interest
rate in the model is 5 percent. We set k, δ, and λe equal to 0.001, 0.045, and 0.3 respectively,
so that the average transition rates between employment, unemployment, and across employers
are the same in the model as in the US data.23 We normalize λu to 1. We tentatively set γ
equal to 0.5, which implies an the elasticity of substitution between vacancies and applicants of
2/3. Finally, we set b equal to 0.7, so that the consumption value of leisure is 70 percent of the
consumption value of work (a figure that is empirically supported by Hall and Milgrom, 2008).

      Given these parameter values, we compute a BRE of the proxy model. In Figure 1, we plot the
market tightness as a function of the value oﬀered by the firms to the workers, x, and conditional
 23
      The data used for the calibration are described in Section 5 of Menzio and Shi (2008).
                                                         34
on the realization of the aggregate component of productivity, y. In accordance with Lemma 4.1,
we find that the market tightness is decreasing with respect to x. Moreover, we find that the
market tightness is higher when the aggregate component of productivity is higher. Intuitively,
when y is higher, firms create more vacancies per applicant because the value of filling a vacancy
is higher.

      In Figure 2, we plot the worker’s optimal search strategy as a function of the value, V , of
his current employment position, and conditional on the realization of the aggregate component
of productivity, y. In accordance with Lemma 4.3, we find that the worker seeks jobs that oﬀer
more generous terms of trade (and are harder to get) when the value of his current employment
position is higher. Moreover, we find that the worker seeks jobs that oﬀer more generous terms
of trade and are easier to get when the aggregate component of productivity is higher (see Figure
3).

      In Figure 4, we plot the worker’s employment value as a function of the wage w, conditional on
the realization of the aggregate component of productivity, y. Similarly, in Figure 5, we plot the
firm’s value of employing a worker as a function of the wage w, conditional on y. We find that the
worker’s value of being employed is increasing in w, while the firm’s value of having an employee
is decreasing in w. Moreover, we find that the worker’s and firm’s values are both increasing with
respect to the the aggregate component of productivity. Intuitively, when y is higher, the worker’s
value is higher because the value of unemployment and the return to searching are higher. The
firm’s value is higher because its periodical profit (conditional on the survival of the employment
relationship) is higher. From these properties of H ∗ and K ∗ , it follows immediately that the
firm’s value of filling a vacancy in submarket x is decreasing in x, and increasing in y (see Figure
6).

      The equilibrium functions θ∗ , m∗ , and H ∗ illustrate that the BRE preserves some attractive
qualitative features of the models by Burdett and Mortensen (1998), Postel-Vinay and Robin
(2002) and Burdett and Coles (2003). For example, the BRE generates residual wage inequality
because, if ex-ante homogeneous workers have diﬀerent luck with their job searches, they will be
employed at diﬀerent wages. The BRE features a positive return to tenure because workers who
are employed at lower wages search in tighter submarkets and, hence, have a higher probability
of leaving their job. For the very same reason, the BRE also features a negative relationship
between tenure and job hazard.

      Finally, using the equilibrium functions θ∗ , m∗ , H ∗ , K ∗ , J ∗ and U ∗ , we simulate the life of an
unemployed worker. We find that, whenever the worker is employed, he prefers keeping his job
                                                      35
than moving into unemployment. That is, we find that condition (6.14) is satisfied everywhere
along the equilibrium path. Therefore, the BRE of the proxy model is also a BRE of the original
model with fixed-wage contracts.


8. Conclusions

In this paper, we prove existence of a Block Recursive Equilibrium for a general model of directed
search on the job, which allows for aggregate shocks, idiosyncratic shocks, risk aversion, and
diﬀerent specifications of the contractual environment. The BRE of our model preserves a number
of attractive qualitative properties of the models of random search on the job by Burdett and
Mortensen (1998), Postel-Vinay and Robin (2002), and Burdett and Coles (2003). That is,
the BRE features flows of workers between employment, unemployment, and across diﬀerent
employers; it features residual wage inequality, and a positive return to tenure and experience.
However, the BRE of our model diﬀers from these models in that it takes into account directed
search and that it is tractable for studying dynamics. In the equilibrium of the random search
models, the distribution of workers across diﬀerent employment states is an infinite-dimensional
object which non-trivially aﬀects the agents’ value and policy functions. In the BRE of our model,
the distribution of workers across diﬀerent employment states does not aﬀect the agents’ value
and policy functions. For this reason, while solving the equilibrium of the random search model
in a stochastic environment is a diﬃcult task both computationally and analytically, solving the
BRE of our model is as easy as solving a representative agent model. These properties of the
BRE make our model both a useful and a practical tool for studying labor market dynamics.


References

 [1] Acemoglu, D., and R. Shimer (1999): Eﬃcient Unemployment Insurance, Journal of Political
    Economy, 107, 893-928.

 [2] Atkeson, A., and R.E. Lucas, Jr. (1992): On Eﬃcient Distribution with Private Information,
    Review of Economic Studies, 59, 427-453.

 [3] Barlevy, G. (2002): The Sullying Eﬀect of Recessions, Review of Economic Studies, 69,
    65—96.

 [4] Burdett, K., and M. Coles (2003): Equilibrium Wage-Tenure Contracts, Econometrica, 71,
    1377-1404.

                                               36
 [5] Burdett, K., and D. Mortensen (1998): Wage Diﬀerentials, Employer Size, and Unemploy-
    ment, International Economic Review, 39, 257-273.

 [6] Burdett, K. S. Shi, and R. Wright (2001): Pricing and matching with frictions, Journal of
    Political Economy, 109, 1060-85.

 [7] Delacroix, A., and S. Shi (2006): Directed Search on the Job and the Wage Ladder, Inter-
    national Economic Review, 47, 651-699.

 [8] Hall, R., and A.B. Krueger (2008): Wage Formation between newly Hired Workers and
    Employers: Survey Evidence, manuscript, Stanford University.

 [9] Hall, R., and P. Milgrom (2008): The Limited Influence of Unemployment of the Wage
    Bargain, American Economic Review.

[10] Holzer, H., L. Katz, and A. Krueger (1991): Job Queues and Wages, Quarterly Journal of
    Economics, 106, 739—68.

[11] Jolivet, G., F. Postel-Vinay, and J. Robin (2006): The Empirical Content of the Job Search
    Model: Labor Mobility and Wage Distributions in Europe and the US, European Economic
    Review, 50, 877-907.

[12] Menzio, G. (2007): A Theory of Partially Directed Search, Journal of Political Economy,
    115, 748-769.

[13] Menzio, G., and S. Shi (2008): Eﬃcient Search On the Job and the Business Cycle, Working
    Paper 308, University of Toronto.

[14] Milgrom, P., and I. Segal (2002): Envelope Theorems for Arbitrary Choice Sets, Economet-
    rica, 70, 583-601.

[15] Moen, E. (1997): Competitive Search Equilibrium, Journal of Political Economy, 105, 694—
    723.

[16] Moen, E., and A. Rosen (2004): Does Poaching Distort Training? Rev. Econ. Studies 71:
    1143—62.

[17] Montgomery, J. (1991): Equilibrium Wage Dispersion and Interindustry Wage Diﬀerentials,
    Quarterly Journal of Economics, 106, 163—79.

[18] Mortensen, D. (1994): The Cyclical Behavior of Job and Worker Flows, Journal of Economic
    Dynamics and Control, 18, 1121-1142.
                                              37
[19] Moscarini, G., and F. Postel-Vinay (2008): Non Stationary Search Equilibrium. Manuscript,
    Yale University.

[20] Peters, M. (1991): Ex Ante Price Oﬀers in Matching Games: Non-Steady State, Economet-
    rica, 59, 1425-1454.

[21] Pissarides, C. (1994): Search Unemployment with On-the-job Search, Review of Economic
    Studies, 61, 457-475.

[22] Postel-Vinay, F., and J. Robin (2002): Equilibrium Wage Dispersion with Worker and Em-
    ployer Heterogeneity, Econometrica, 70, 2295-2350.

[23] Prescott, E.C., and R.M. Townsend (1984): Pareto Optima and Competitive Equilibria with
    Adverse Selection and Moral Hazard, Econometrica, 52, 21-46.

[24] Royden, H. (1988): Real Analysis. Upper Saddle River, New Jersey: Prentice-Hall.

[25] Shi, S. (2009): Directed Search for Equilibrium Wage-Tenure Contracts, Econometrica, 77,
    561-584.

[26] Shimer, R. (2005): The Cyclical Behavior of Unemployment and Vacancies, American Eco-
    nomic Review, 95, 25-49.

[27] Stokey, N., R.E. Lucas, with E. Prescott (1989): Recursive Methods in Economic Dynamics.
    Cambridge, Massachusetts: Harvard University Press.




                                             38
                                                Appendix
A. Properties of the Set of Functions J

Lemma A.1. J is a non-empty, bounded, closed and convex subset of the space of bounded,
continuous functions on X × Y × Z, with the sup norm.

Proof: (i) Clearly, the set J is non-empty and bounded.

(ii) Next, we need to prove that the set J is closed. To this aim, let {Jn }∞
                                                                            n=1 be an arbitrary
sequence with Jn ∈ J for every n, and with Jn → J (in the sup norm). Note that, since Jn → J,
for every ε > 0, there exists N (ε) ≥ 1 such that n ≥ N (ε) =⇒ kJn − Jk < ε.

For arbitrary (y, z) ∈ Y × Z and arbitrary V1 , V2 ∈ X, with V1 ≤ V2 , suppose that the diﬀerence
J(V2 , y, z) − J(V1 , y, z) is strictly smaller than −B̄J (V2 − V1 ). Let ε > 0 be one third of the
diﬀerence between −B̄J (V2 − V1 ) and [J(V2 , y, z) − J(V1 , y, z)]. Let n be a natural number greater
than N (ε). Since ||Jn − J|| < ε, the diﬀerence Jn (V2 , y, z) − Jn (V1 , y, z) is such that
             Jn (V2 , y, z) − Jn (V1 , y, z)   < J(V2 , y, z) − J(V1 , y, z) + 2ε
                                                   1
                                               =   3   [J(V2 , y, z) − J(V1 , y, z)] − 23 B̄J (V2 − V1 )
                                               < −B̄J (V2 − V1 ).
The last inequality contradicts Jn ∈ J .                Therefore, J(V2 , y, z) − J(V1 , y, z) is greater than
−B̄J (V2 − V1 ) for all (y, z) ∈ Y × Z and all V1 , V2 ∈ X, with V1 ≤ V2 . Using a similar argument,
we can prove that J(V2 , y, z) − J(V1 , y, z) is smaller than −B J (V2 − V1 ) for all (y, z) ∈ Y × Z and
all V1 , V2 ∈ X, with V1 ≤ V2 . That is, J satisfies property (J1) of the set J .
                                                                               ¯ Hence, J satisfies
For all (V, y, z) ∈ X × Y × Z, it is immediate to verify that J(V, y, z) ∈ [J, J].
property (J2) of the set J . For arbitrary (y, z) ∈ Y × Z, arbitrary V1 , V2 ∈ X, and arbitrary α ∈
[0, 1], suppose that J(Vα , y, z) is strictly smaller than αJ(V1 , y, z) + (1 − α)J(V2 , y, z), where Vα =
αV1 +(1−α)V2 . Let ε > 0 be one third of the diﬀerence between [αJ(V1 , y, z) + (1 − α)J(V2 , y, z)]
and J(Vα , y, z). n be a natural number greater than N (ε). Since ||Jn − J|| < ε, we have
                        Jn (Vα , y, z)   < J(Vα , y, z) + ε
                                         = αJ(V1 , y, z) + (1 − α)J(V2 , y, z) − 2ε
                                         < αJn (V1 , y, z) + (1 − α)Jn (V2 , y, z) − ε
                                         < αJn (V1 , y, z) + (1 − α)Jn (V2 , y, z).
The last inequality contradicts Jn ∈ J . Therefore, J(Vα , y, z) is greater than αJ(V1 , y, z) + (1 −
α)J(V2 , y, z) for all (y, z) ∈ Y × Z, all V1 , V2 ∈ X and all α ∈ [0, 1]. That is, J satisfies property
(J3) of the set J . This establishes that J ∈ J and, hence, that the set J is closed.
                                                39
(iii) Finally, we need to prove that the set J is convex. To this aim, consider arbitrary J1 ,
J2 ∈ J and an arbitrary α ∈ [0, 1]. Denote Jα (V, y, z) = αJ1 (V, y, z) + (1 − α)J2 (V, y, z). For all
(y, z) ∈ Y × Z and all V1 , V2 ∈ X, with V1 ≤ V2 , the diﬀerence Jα (V2 , y, z) − Jα (V1 , y, z) is such
that
                       Jα (V2 , y, z) − Jα (V1 , y, z)
                =      α [J1 (V2 , y, z) − J1 (V1 , y, z)] + (1 − α) [J2 (V2 , y, z) − J2 (V1 , y, z)]
                       £                                     ¤
                ∈       −B J (V2 − V1 ), −B̄J (V2 − V1 ) .
Hence, Jα satisfies property (J1) of the set J . For all (V, y, z) ∈ X×Y ×Z, it is immediate to verify
                        ¯ Hence, Jα satisfies property (J2) of the set J . For all (y, z) ∈ Y × Z,
that Jα (V, y, z) ∈ [J, J].
V1 , V2 ∈ X, and ζ ∈ [0, 1], let Vζ = ζV1 + (1 − ζ) V2 . Then, Jα (Vζ , y, z) is such that

            Jα (Vζ , y, z)
       =    αJ1 (Vζ , y, z) + (1 − α)J2 (Vζ , y, z)
       ≥    α [ζJ1 (V1 , y, z) + (1 − ζ)J1 (V2 , y, z)] + (1 − α) [ζJ2 (V1 , y, z) + (1 − ζ)J2 (V2 , y, z)]
       =    ζJα (V1 , y, z) + (1 − ζ)Jα (V2 , y, z).

Hence, Jα satisfies property (J3) of the set J . This establishes that Jα ∈ J and, hence, that the
set J is convex.             ¥

B. Proof of Lemma 4.1

(i) For the sake of brevity, let us suppress the dependence of various functions on y and z. Let y
be an arbitrary point in Y , and let x1 , x2 be two points in X with x1 ≤ x2 . First, consider the
case in which x1 ≤ x2 ≤ x̃. In this case, the diﬀerence θ(x2 ) − θ(x1 ) is equal to
                                                                                               Z   k/J(x2 )
                 θ(x2 ) − θ(x1 ) = q −1 (k/J(x2 )) − q −1 (k/J(x1 )) =                                        q −10 (t)dt,           (B.1)
                                                                                               k/J(x1 )

where the first equality makes use of (4.1), and the second equality makes use of the fact that
J(x1 ) ≥ J(x2 ) ≥ k > 0. For all x ∈ [x, x̃], the derivative of the inverse function q −1 (.) evaluated
at k/J(x) is equal to 1/q 0 (θ(x)) ∈ [1/q 0 (θ̄), 1/q 0 (0)], where 1/q 0 (θ̄) ≤ 1/q 0 (0) < 0. Therefore, the
last term in (B.1) is such that
                       µ                   ¶       Z   k/J(x2 )                                    µ                         ¶
                 1           k      k                                 −10             1                  k      k
               0
                                 −             ≤                  q         (t)dt ≤ 0                        −                   .   (B.2)
              q (θ̄)       J(x2 ) J(x1 )           k/J(x1 )                        q (0)               J(x2 ) J(x1 )

    The diﬀerence k/J(x2 ) − k/J(x1 ) is equal to
                                                                        Z    J(x1 )
                                           k      k                                   k
                                               −       =                                 dt.
                                         J(x2 ) J(x1 )                      J(x2 )    t2

                                                              40
For all x ∈ [x,x̃], J(x) is strictly decreasing in x and it is bounded between J¯ and k. Therefore,
the integral on the RHS above is such that
                      Z J(x1 )
                               k        1                     B̄J
                                 2
                                   dt ≤ [J(x1 ) − J(x2 )] ≤       (x2 − x1 ),
                        J(x2 ) t        k                      k
                      Z J(x1 )                                                                        (B.3)
                               k         k                     B k
                                 2
                                   dt ≥ ¯2 [J(x1 ) − J(x2 )] ≥ ¯J2 (x2 − x1 ).
                        J(x2 ) t        J                        J
Taken together, (B.2) and (B.3) imply that the diﬀerence θ(x2 ) − θ(x1 ) is such that
                           B̄J                                    B k
                                  (x2 − x1 ) ≤ θ(x2 ) − θ(x1 ) ≤ 0 J ¯2 (x2 − x1 ).                   (B.4)
                        q 0 (θ̄)k                               q (0)J


Next, consider the case in which x1 ≤ x̃ ≤ x2 . In this case, the diﬀerence θ(x2 ) − θ(x1 ) is such
that
                                                       BJ k
                θ(x2 ) − θ(x1 ) = θ(x̃) − θ(x1 ) ≤            (x̃ − x1 )   ≤ 0,
                                                     q (0)J¯2
                                                      0
                                                       B̄J                      B̄J
                θ(x2 ) − θ(x1 ) = θ(x̃) − θ(x1 ) ≥    0
                                                             (x̃ − x1 )   ≥    0
                                                                                      (x2   − x1 ),
                                                     q (θ̄)k                  q (θ̄)k
where the first equality in both lines makes use of the fact that θ(x2 ) = θ(x̃), and the first
inequality in both lines makes use of the bounds in (B.4). Finally, consider the case in which
x̃ ≤ x1 ≤ x2 . In this case, (4.1) implies that θ(x1 ) = θ(x2 ) = 0.

(ii) The function p(θ) is strictly increasing in θ. The function θ(x) is strictly decreasing in x for
all x ∈ [x, x̃]. Therefore, the composite function p (θ (x)) is strictly decreasing in x for x ∈ [x, x̃].
In order to prove that the composite function p (θ (x)) is strictly concave in x for x ∈ [x, x̃],
consider arbitrary x1 , x2 ∈ [x, x̃], with x1 6= x2 , and an arbitrary number α ∈ (0, 1). Let
xα = αx1 + (1 − α)x2 . Since the function J(x) is concave in x and the function k/x is strictly
convex in x, we have
                      k                 k                 k                k
                           ≤                         <α        + (1 − α)        .
                    J(xα )   αJ(x1 ) + (1 − α)J(x2 )    J(x1 )           J(x2 )
Since p(q −1 (.)) is strictly decreasing and weakly concave, the previous inequality implies that
                p(q −1 (k/J(xα ))    > p(q −1 (αk/J(x1 ) + (1 − α)k/J(x2 )))
                                                                                                      (B.5)
                                     ≥ αp(q −1 (k/J(x1 ))) + (1 − α)p(q −1 (k/J(x2 ))).
Since q −1 (k/J(x)) is equal to θ(x) for all x ∈ [x, x̃], (B.5) can be rewritten as

                              p(θ(xα )) > αp(θ(x1 )) + (1 − α)p(θ(x2 )).                              (B.6)

This establishes that the composite function p (θ (x)) is strictly concave in x for all x ∈ [x, x̃].
¥
                                                     41
C. Proof of Lemma 4.6

(i) For all ϕ1 , ϕ2 ∈ C(Y ), with ϕ1 ≤ ϕ2 , the diﬀerence TU ϕ2 − TU ϕ1 is such that
          (TU ϕ2 )(y) − (TU ϕ1 )(y)
                                                                                                (C.1)
      = βEψ̂ {ϕ2 (ŷ) − ϕ1 (ŷ) + λu [max{0, R(ϕ2 (ŷ), ŷ)} − max{0, R(ϕ1 (ŷ), ŷ)}]} ≥ 0,
where the last inequality uses the fact that the function V + λu max{0, R(V )} is increasing in V .
For all ϕ ∈ C(Y ) and all a ≥ 0, TU (ϕ + a) is such that
     [TU (ϕ + a)] (y)   = (TU ϕ)(y) + βEψ̂ {a + λu [max{R(ϕ + a), 0} − max{R(ϕ), 0}]}
                                                                                                (C.2)
                        ≤ (TU ϕ)(y) + βa,
where, for the sake of brevity, we have suppressed the dependence of various variables from the
aggregate state ŷ. Conditions (C.1) and (C.2) are suﬃcient to prove that the operator TU is a
contraction mapping (Stokey and Lucas with Prescott, 1989, Theorem 3.3). Hence, there exists
one and only one U such that TU U = U .

(ii) Let ϕ ∈ C(Y ) be a function that is bounded between U and Ū . Then, TU ϕ is such that
                                      (TU ϕ)(y) ≥ υ(b) + βU = U ,
                                                                                                (C.3)
                                      (TU ϕ)(y) ≤ υ(b) + β x̄ = Ū ,
where the first line makes use of the facts that ϕ ≥ U and R(ϕ(ŷ), ŷ) ≥ 0; and the second line
makes use of the fact that ϕ+λu max{0, R(ϕ(ŷ), ŷ)} ≤ x̄. From the inequalities in (C.3), it follows
that the operator TU maps the set of functions that are bounded between U and Ū into itself.
Since the operator TU is a contraction, it follows that its fixed point, U , is bounded between U
and Ū.      ¥



D. Proof of Lemma 6.1

(i) For all ϕ1 , ϕ2 ∈ C(W × Y ), with ϕ1 ≤ ϕ2 , the diﬀerence TH ϕ2 − TH ϕ1 is such that
                  (TH ϕ2 )(w, y) − (TH ϕ1 )(w, y)
                                 ∙                                            ¸
                                   ϕ2 (w, ŷ) + λe max{0, R(ϕ2 (w, ŷ), ŷ)}                    (D.1)
                  = β(1 − δ)Eŷ                                                 ≥ 0,
                                   −ϕ1 (w, ŷ) − λe max{0, R(ϕ1 (w, ŷ), ŷ)}
where the last inequality uses the fact that the function V + λe max{0, R(V, ŷ)} is increasing in
V . For all ϕ ∈ C(W × Y ) and all a ≥ 0, TH (ϕ + a) is such that
 [TH (ϕ + a)] (w, y)    = w + βEŷ {δU + (1 − δ) [ϕ(w, ŷ) + λe max{0, R(ϕ(w, ŷ), ŷ)}]}
                        +β(1 − δ)Eŷ {a + λe max{0, R(ϕ(w, ŷ), ŷ)} − λe max{0, R(ϕ(w, ŷ) + a, ŷ)}}
                        ≤ (TH ϕ)(w, y) + β(1 − δ)a,
                                                                                                (D.2)
                                                    42
where the last inequality uses the fact that R(V, ŷ) − R(V + a, ŷ) ≤ 0. Conditions (D.1) and (D.2)
are suﬃcient to prove that the operator TH is a contraction mapping. Hence, there exists one
and only one H such that TH H = H.

(ii) Let ϕ ∈ C(W × Y ) be a function that satisfies condition (6.4). Let y be an arbitrary point
in Y , and w1 , w2 two arbitrary points in W with w1 ≤ w2 . For all ŷ ∈ Y , the diﬀerence
f (w2 , ŷ) − f (w1 , ŷ) is bounded between 0 and [1 − β(1 − δ)]−1 (w2 − w1 ). Therefore,

                (TH ϕ)(w2 , y) − (TH ϕ)(w1 , y)
                                         ∙                                              ¸
                                             ϕ(w2 , ŷ) + λe max{0, R(ϕ(w2 , ŷ), ŷ)}
                = w2 − w1 + β(1 − δ)Eŷ                                                                (D.3)
                                             −ϕ(w1 , ŷ) − λe max{0, R(ϕ(w1 , ŷ), ŷ)}
                ∈ [1, 1/[1 − β(1 − δ)]] (w2 − w1 ) .

The bounds in (D.3) imply that the operator TH maps functions that satisfy (6.4) into functions
that satisfy (6.4). Since TH is a contraction, its unique fixed point H satisfies (6.4).
                    ¡         ¢
(iii) Let V̄ denote w̄ + βδ Ū /[1 − β (1 − δ)]. Let ϕ ∈ C(W × Y ) be an arbitrary function such
that (TH f ) (w̄, y) ∈ [x̄, V̄ ] for all y ∈ Y . The function TH ϕ is such that (TH ϕ) (w̄, y) ∈ [x̄, V̄ ] for
all y ∈ Y , because
                              (TH ϕ) (w̄, y) ≥ w̄ + βδU + β (1 − δ) x̄ = x̄,
                              (TH ϕ) (w̄, y) ≤ w̄ + βδ Ū + β (1 − δ) V̄ = V̄ .
Therefore, the fixed point, H, is such that H (w̄, y) ∈ [x̄, V̄ ] for all y ∈ Y . Moreover, H(w, y) ≤ x
for all y ∈ Y , because
                             £                 £                          ¤¤
              H(w, y) ≤ w + β δ Ū + (1 − δ)Eŷ V̄ + λe max{0, R(V̄ , ŷ)} ≤ x.              ¥




E. Proof of Lemma 6.3

(i) It is immediate to verify that, for all ϕ1 , ϕ2 ∈ C(W × Y × Z), if ϕ1 ≤ ϕ2 then TK ϕ1 ≤ TK ϕ2 .
It is also immediate to verify that, for all ϕ ∈ C(W × Y × Z) and all a > 0, TK (ϕ + a) is smaller
than TK ϕ + βa. These two conditions are suﬃcient to prove that the operator TK is a contraction
mapping. Hence, there exists one and only one K ∈ C(W × Y × Z) such that TK K = K.

(ii)-(iii) Let ϕ ∈ C(W × Y × Z) satisfy conditions (6.9)—(6.10). Let (y, z) be an arbitrary point in
Y × Z, and w1 , w2 arbitrary points in W with w1 ≤ w2 . The diﬀerence between (TK ϕ)(w2 , y, z)




                                                     43
and (TK ϕ)(w1 , y, z) is such that

           (TK ϕ)(w2 , y, z) − (TK ϕ)(w1 , y, z)
      =    w1 − w2 + β(1 − δ)Eŝ {[1 − λe p̃(H(w2 , ŷ), ŷ)] [ϕ(w2 , ŷ, ẑ) − ϕ(w1 , ŷ, ẑ)]}
      +    β(1 − δ)Eŝ {λe [p̃(H(w1 , ŷ), ŷ) − p̃(H(w2 , ŷ), ŷ)] ϕ(w1 , ŷ, ẑ)}               (E.1)
             n                                                                       o
      ≤    − 1 + β(1 − δ)(1 − λe )B K − [1 − β (1 − δ)]−1 β(1 − δ)λe B̄p K̄ (w2 − w1 )

      =    −B K (w2 − w1 ),

where the first inequality makes use of the bounds in (6.6), (6.9), (4.8) and (6.10). Moreover, the
diﬀerence between (TK ϕ)(w2 , y, z) and (TK ϕ)(w1 , y, z) is such that

                  (TK ϕ)(w2 , y, z) − (TK ϕ)(w1 , y, z)
                    n                                                   o
             ≥    − 1 + β(1 − δ)B̄K − [1 − β (1 − δ)]−1 β(1 − δ)λe B̄p K (w2 − w1 )                (E.2)
             =    −B̄K (w2 − w1 ),

where the first inequality makes use of the bounds (6.6), (6.9), (4.8) and (6.10).

Let w be an arbitrary point in W . Then, TK ϕ is such that
                       (TK ϕ)(w, y, z) ≤ ȳ + z̄ − w + β(1 − δ)K̄ ≤ K̄,
                                                                                                   (E.3)
                       (TK ϕ)(w, y, z) ≥ y + z − w̄ + β(1 − δ) (1 − λe ) K ≥ K.

Inequalities (E.1)—(E.3) imply that the operator TK maps functions that satisfy conditions (6.9)—
(6.10) into functions that satisfy (6.9)—(6.10). Since the operator TK is a contraction, its unique
fixed point, K, satisfies conditions (6.9)—(6.10).          ¥



F. Two-Point Lotteries and Concavity of the Value Function

Let K (x) be a continuous function, where x ∈ [x, x̄]. Consider the following problem with a
two-point lottery:
                     J (V ) = max(π,x1 ,x2 ) [πK (x1 ) + (1 − π) K (x2 )]
                                                                                                   (F.1)
                     s.t.     πx1 + (1 − π) x2 = V ,        x1 ≤ V ≤ x2 , π ∈ [0, 1] .

The above problem encompasses the maximization problems in (5.1) and (6.12) as special cases.
(In these problems, the lottery is contingent on the realizations of aggregate and match-specific
shocks, (y, z), which is suppressed here.)


We want to prove that J (V ) is concave. To this end, consider arbitrary V ∈ (x, x̄). Let (x∗1 , x∗2 )
be the solution for (x1 , x2 ) in (F.1). If K (V ) is strictly convex at V , it must be true that
                                                44
x∗1 < V < x∗2 . Thus, if x∗1 = x∗2 , then J (V ) = K (V ) must be concave at V . In the remainder
of the proof, it suﬃces to examine the case where x∗1 < x∗2 . For any arbitrary x1 , x2 ∈ (x, x̄),
x1 < x2 , denote the line segment connecting K(x1 ) and K(x2 ) as x1 x2 , and denote the slope of
x1 x2 as
                                            K(x2 ) − K(x1 )
                                      L(x1 , x2 ) ≡         .
                                                x2 − x1
Using the constraint in (F.1) to express π = (x2 − V )/(x2 − x1 ), we can rewrite J(V ) in the
following equivalent forms:

           J(V ) = max [K (x2 ) − (x2 − V )L(x1 , x2 )] = max [K(x1 ) + (V − x1 )L(x1 , x2 )] .
                   (x1 ,x2 )                                 (x1 ,x2 )

The following results hold:

(A) For all x ∈ [x, x̄], K(x) must lie on or below the extension of x∗1 x∗2 , i.e., K(x) ≤ K(x∗1 ) +
      L(x∗1 , x∗2 )(x − x∗1 );

(B) If x∗2 > V , then x∗1 = arg minx≤x∗2 L(x, x∗2 ) and x∗2 = arg maxx≥x∗1 L(x∗1 , x).


Proofs of (A) and (B). For (A), consider first the case x ∈ [x∗1 , x∗2 ]. (We will return to the case
 / [x∗1 , x∗2 ] after proving (B).) Result (A) holds trivially when x = x∗1 or x = x∗2 . To show that
x∈
(A) also holds for x ∈ (x∗1 , x∗2 ), suppose to the contrary that (A) is violated by some x0 ∈ (x∗1 , x∗2 ).
Then, K(x0 ) > K(x∗1 ) + L(x∗1 , x∗2 )(x0 − x∗1 ). If x0 = V , then (x0 , x0 ) is optimal. If x0 < V , then
(x0 , x∗2 ) is feasible and dominates (x∗1 , x∗2 ). If x0 > V , then (x∗1 , x0 ) is feasible and dominates
(x∗1 , x∗2 ). The result in each of these cases contradicts the optimality of (x∗1 , x∗2 ).

For (B), we only prove the first part, i.e., the part for x∗1 , since the proof of the result for x∗2 is
similar. From the first rewritten form of the maximization problem, L(x∗1 , x∗2 ) ≤ L(x, x∗2 ) for all
x ≤ V . For x ∈ (V, x∗2 ), K(x) is on or below the line connecting K(x∗1 ) and K(x∗2 ) (see the proven
part of (A) above), and so L(x∗1 , x∗2 ) ≤ L(x, x∗2 ). Thus, (B) holds.
                                           / [x∗1 , x∗2 ]. If (A) did not hold for some x0 < x∗1 , then
    Now we prove that (A) also holds for x ∈
L(x0 , x∗2 ) < L(x∗1 , x∗2 ), which would contradict (B). If (A) did not hold for some x0 > x∗2 , then
L(x∗1 , x0 ) > L(x∗1 , x∗2 ), which would again contradict (B).          ¥



Lemma F.1. J (V ) is a concave function.

Proof. Let V1 and V2 be two arbitrary values in [x, x̄], and let Vα = αV1 + (1 − α)V2 , where
α ∈ (0, 1). Denote (x∗1i , x∗2i ) as the solution to the maximization problem when V = Vi , where
i ∈ {1, 2, α}. We show that J(Vα ) ≥ αJ(V1 ) + (1 − α) J(V2 ).
                                               45
Applying (A) to any x ∈ [x∗11 , x∗21 ], we know that K(x) cannot lie above the extension of x∗1α x∗2α .
Thus, all points on x∗11 x∗21 must lie on or below the extension of x∗1α x∗2α . This implies that
J(V1 ) ≤ J(Vα )−Lα (Vα −V1 ), where Lα = L(x∗1α , x∗2α ). Similarly, applying (A) to any x ∈ [x∗12 , x∗22 ]
yields: J(V2 ) ≤ J(Vα ) + Lα (V2 − Vα ). Thus,

         αJ(V1 ) + (1 − α)J(V2 ) ≤ J(Vα ) + Lα [α (V1 − Vα ) + (1 − α) (V2 − Vα )] = J(Vα ).

This completes the proof of the lemma.            ¥




                                                      46
  .




1200                                                                                                      81.9
                                 Figure 1: Market Tightness                                                                      Figure 2: Optimal Search Strategy
1100                                                                                                      81.7
1000
                                                                                                          81.5
 900
                                                                                                          81.3
 800
                                                                                                          81.1
 700
                                                                                                          80.9
 600
                                                                                                          80.7
 500
                                                                                                          80.5
 400

 300                                                                                                      80.3

 200                                                                                                      80.1

 100                                                                                                      79.9

      0                                                                                                   79.7
          79.7    79.9    80.1     80.3       80.5      80.7     80.9    81.1   81.3   81.5   81.7               79.7   79.9   80.1      80.3    80.5     80.7     80.9    81.1   81.3   81.5   81.7

                                          theta(x,yl)          theta(x,yh)                                                                 m(V,yl)          m(V,yh)          V

 1
                            Figure 3: Job Finding Probability                                             81.5
                                                                                                                                      Figure 4: Value of Employment
0.9                                                                                                       81.3

0.8                                                                                                       81.1

0.7                                                                                                       80.9

0.6                                                                                                       80.7

0.5                                                                                                       80.5

0.4                                                                                                       80.3

0.3                                                                                                       80.1

0.2                                                                                                       79.9

0.1                                                                                                       79.7

 0                                                                                                        79.5
      79.7       79.9    80.1     80.3       80.5       80.7    80.9     81.1   81.3   81.5   81.7               0.70   0.74   0.77      0.81    0.84     0.88     0.91    0.95   0.98   1.02

                                             p(V,yl)           p(V,yh)                                                                          H(w,yl)          H(w,yh)


1.4                                                                                                       1.4
                                Figure 5: Value of an Employee                                                                        Figure 6: Firm's Value Function
1.2                                                                                                       1.2
  1                                                                                                         1
0.8                                                                                                       0.8
0.6                                                                                                       0.6
0.4                                                                                                       0.4
0.2                                                                                                       0.2
  0                                                                                                         0
-0.2                                                                                                      -0.2
-0.4                                                                                                      -0.4
-0.6                                                                                                      -0.6
-0.8                                                                                                      -0.8
  -1                                                                                                       -1
-1.2
                                                                                                          -1.2
          0.70   0.74    0.77      0.81       0.84      0.88     0.91    0.95   0.98   1.02
                                                                                                                 79.7   79.9   80.1      80.3    80.5     80.7    80.9     81.1   81.3   81.5   81.7

                                            K(w,yl)            K(w,yh)                                                                          J(V,yl)          J(V,yh)




                                                                                                     47
