                              NBER WORKING PAPER SERIES




    UNOBSERVED HETEROGENEITY, STATE DEPENDENCE, AND HEALTH PLAN
                             CHOICES

                                          Ariel Pakes
                                         Jack R. Porter
                                         Mark Shepard
                                      Sophie Calder-Wang

                                       Working Paper 29025
                               http://www.nber.org/papers/w29025


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     July 2021




We thank Hanbin Yang for truly outstanding research assistance, and Liran Einav, Jeremy Fox,
Ben Handel, and Amanda Starc for comments. We also acknowledge the Massachusetts Health
Connector (and especially Marissa Woltmann) for help in providing and interpreting the data. We
gratefully acknowledge data funding from Harvard's Lab for Economic Applications and Policy.
The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2021 by Ariel Pakes, Jack R. Porter, Mark Shepard, and Sophie Calder-Wang. All rights
reserved. Short sections of text, not to exceed two paragraphs, may be quoted without explicit
permission provided that full credit, including © notice, is given to the source.
Unobserved Heterogeneity, State Dependence, and Health Plan Choices
Ariel Pakes, Jack R. Porter, Mark Shepard, and Sophie Calder-Wang
NBER Working Paper No. 29025
July 2021
JEL No. C13,D12,I11,L60,M31

                                         ABSTRACT

We provide a new method to analyze discrete choice models with state dependence and
individual-by-product fixed effects and use it to analyze consumer choices in a policy-relevant
environment (a subsidized health insurance exchange). Moment inequalities are used to infer state
dependence from consumers' switching choices in response to changes in product attributes. We
infer much smaller switching costs on the health insurance exchange than is inferred from
standard logit and/or random effects methods. A counterfactual policy evaluation illustrates that
the policy implications of this difference can be substantive.


Ariel Pakes                                     Mark Shepard
Department of Economics                         Harvard Kennedy School
Harvard University                              Mailbox 114
Littauer Room 117                               79 JFK Street
Cambridge, MA 02138                             Cambridge, MA 02138
and NBER                                        and NBER
apakes@fas.harvard.edu                          mark_shepard@hks.harvard.edu

Jack R. Porter                                  Sophie Calder-Wang
University of Wisconsin-Madison                 University of Pennsylvania
1180 Observatory Drive                          Wharton School
6448 Social Sciences Building                   Vance Hall
Madison, WI 53706-1320                          Philadelphia, PA 19104
jrporter@ssc.wisc.edu                           sophiecw@wharton.upenn.edu
    Unobserved Heterogeneity, State Dependence, and Health
                        Plan Choices.
                                                                                                       
          Ariel Pakes, Jack Porter, Mark Shepard, and Sophie Calder-Wang
                                              June 21, 2021


                                                   Abstract
           We provide a new method to analyze discrete choice models with state dependence and
       individual-by-product fixed effects, and use it to analyze consumer choices in a policy-relevant
       environment (a subsidized health insurance exchange). Moment inequalities are used to
       infer state dependence from consumers' switching choices in response to changes in product
       attributes. We infer much smaller switching costs on the health insurance exchange than
       is inferred from standard logit and/or random effects methods. A counterfactual policy
       evaluation illustrates that the policy implications of this difference can be substantive.


1      Introduction.
Since Heckman (1978, 1981), distinguishing the impacts of unobserved heterogeneity from those
of state dependence has been a central issue in empirical work in economics, as the distinction
has implications for the interpretation and policy implications of many observed phenomena. The
analysis of unemployment durations seeks to separate out the causal effects of being unemployed
on future employment from unobserved heterogeneity in worker employability (see Kroft et al.
(2013) and the articles cited therein). Both the marketing and I.O. literatures face the problem of
distinguishing switching costs from unobserved preferences in explaining the constancy of individ-
ual purchasing patterns over time (see the review by Keane (1997) and more recently, Shin, Misra,
and Horsky (2012)). Network models often need to distinguish between common preferences and
the causal effects of the network (see for example, Sorensen (2006) and more recently Conley and
Udry (2010)). A similar problem arises in distinguishing between the effects of moral hazard and
adverse selection in evaluating policies designed to monitor behavior in insurance markets (Abbring
et al., 2003).
    In this paper, we develop a new method to estimate state dependence in a choice model that
allows for flexible unobserved heterogeneity through individual-by-product fixed effects. We apply
the method to the issue of understanding persistence in health insurance plan choices. This problem
    
    Pakes: Harvard University, apakes@fas.harvard.edu.         Porter: University of Wisconsin-Madison, jr-
porter@ssc.wisc.edu. Shepard: Harvard University, mark shepard@hks.harvard.edu. Calder-Wang: University of
Pennsylvania, sophiecw@wharton.upenn.edu. We thank Hanbin Yang for truly outstanding research assistance, and
Liran Einav, Jeremy Fox, Ben Handel, and Amanda Starc for comments. We also acknowledge the Massachusetts
Health Connector (and especially Marissa Woltmann) for help in providing and interpreting the data. We gratefully
acknowledge data funding from Harvard's Lab for Economic Applications and Policy.


                                                       1
is policy-relevant as governments set rules for market-based health insurance programs and the
Affordable Care Act exchanges, Medicare Part D, and Medicaid managed care cover more than 75
million people and cost over $700 billion in public spending per annum in the U.S. alone. Recent
applied work suggests that choice persistence driven by state dependence (e.g., switching costs);
may lead to larger insurance markups (Ho, Hogan, and Scott Morton, 2017), may interact with
problems created by adverse selection (Handel, 2013; Polyakova, 2016), and may lead to invest-
then-harvest pricing dynamics (Ericson, 2014). It is unsurprising then that regulators often seek
to encourage switching through reminders and outreach, with the idea that more active consumer
shopping will lead to better market outcomes. However as noted by Dafny, Ho, and Varela (2013),
if choice persistence is primarily driven by preference heterogeneity, the policy implications may
be simply to encourage more product variety.
     Separating preference heterogeneity from state dependence in health insurance demand is chal-
lenging. Health plans may differ on a complex bundle of attributes, including financial coverage,
customer service, and medical provider networks. Preferences for provider networks (the key plan
attribute in our empirical setting) are particularly challenging to predict because of their multi-
dimensional nature and the individual-specific ways that preferences vary. For instance, patients
may care strongly about provider coverage in the immediate neighborhood of their home or work,
or coverage of specific doctors or hospitals with whom they have relationships (Shepard, 2020;
Tilipman, 2020). This implies an individual-by-plan specific match factor unlikely to be captured
by standard methods for dealing with unobserved heterogeneity, including coarse plan fixed effects
or independently distributed random effects. Correctly estimating state dependence requires an
econometric approach that allows for very flexible heterogeneity.
     To deal with these challenges, we consider a semiparametric discrete choice model with lagged
dependent variables and individual-by-product fixed effects. Consumer i at time t faces a set
of choices Dt where #Dt = Dt . Given price pd,i,t for choice d  Dt and last period's choice
yi,t-1  Dt-1 , the utility associated with choice d at time t is

                        Ud,i,t =   - pd,i,t - 1{yi,t-1 = d}0 i + d,i + d,i,t                    (1.1)

where 0 represents the price equivalent of "switching" for individual i , i allows the importance
of price to vary by individual, d,i denotes individual (additive) product preferences, and d,i,t
captures the remaining unobserved variation in random utility. I.e. we estimate the importance of
switching costs relative to price, allowing for a flexible tradeoff between these variables and other
additively separable preferences.
   The observed choice (or state) is

                                        yi,t = arg max Ud,i,t .
                                                   dDt

We consider various approaches to exploiting the information provided by switching in combination
with different specifications for the distribution of {d,i,t }dDt ,1tT . The fixed effects paradigm
with fixed T is adopted throughout, and no restrictions are placed on the joint distribution of the
individual effects and the prices or any other observed individual characteristics. We also do not
use or assume any explicit restrictions from initial conditions.
    In general, 0 is only partially identified (Honor´e and Tamer, 2006). We generate moment in-
equalities with intuitive identifying implications for 0 , and these inequalities are used to provide
confidence bounds on 0 . The inequalities are based on the relationship between consumer switch-
ing and changes in product attributes (in our case, price, as we condition on other attributes). An

                                                  2
example, which we return to in the empirical work, is a product j that experiences a large price
increase in period t - 1 followed by an even larger price reduction in t. Our method infers a lower
bound on 0 based on the share of consumers who have switched away from j in t - 1 and who do
not switch back in t.
     These bounds can then be used in either a deeper analysis of the factors associated with the
({d,i }d,i , {i }i ) and/or, as we do below, in assessing the impact of counterfactual prices1 . Our
empirical work is focused on distinguishing between state dependence and unobserved heterogene-
ity in health insurance choices and follows other recent work on the same topic (Handel, 2013;
Polyakova, 2016; Ho, Hogan, and Scott Morton, 2017). This is a market where switching behavior
is "infrequent" (a precise definition is given below), but we will also consider the implications of
our approach in empirical settings where switching is more frequent.
     Before summarizing our results a word on what we do not do is in order. We do not consider
the mechanism that generated the state dependence, which likely would depend on the application.
Relatedly, equation (1.1) does not explicitly allow for forward looking agents. While these methods
could be adapted to specifications that include additional lags of the dependent variable, we do
not pursue that generalization here. The moment inequalities we derive are unlikely to provide
a sharp characterization of the identifying information on 0 , but we exploit variation in choices
in a straightforward way that should appeal to practitioners.2 Note that 0 is needed to analyze
equilibrium responses to policy and/or environmental change. This is one reason our focus is on
it, rather than on the quantiles or averages of utilities, which is the focus of Chernozhukov et al.
(2013), or the treatment effect parameters defined in Torgovitsky (2019).

Related Econometric Literature. We build on two strands of the literature: papers that
analyze discrete choice models with fixed effects and papers that add state dependence to that
problem. The literature on discrete choice with fixed effects provides an analogue of "within"
estimation in panel data models with continuous dependent variables where the between/within
distinction has been a focus of analysis. Chamberlain (1980) shows how an assumption of "logit"
disturbances generates a consistent conditional likelihood estimator for that problem. Manski's
(1987) maximum score estimator provides consistent estimates for the binary choice problem with
fixed effects and a non-parametric disturbance distribution. Papers by Shi, Shum, and Song (2018)
and Pakes and Porter (2016), which we come back to below, use an assumption of stationarity
of the marginal distribution of disturbances over time to obtain their estimators for multinomial
problems. Also related is work by Tebaldi et al. (2019) that develops a method to estimate static
demand for health insurance in a model with flexible, non-parametric preference heterogeneity.
    Building on this fixed effects literature, Honor´
                                                    e and Kyriazidou (2000) allow for state depen-
dence and fixed effects in point identified binary and multinomial choice problems. They use a
conditioning argument and observations that are matched across periods to obtain their estima-
tors. A recent paper by Honor´    e and Weidner (2020) considers a binary logit model with state
dependence but does not require matching. Honor´    e and Tamer (2006) examine identified sets from
a related model, and Khan et al. (forthcoming) investigate different assumptions on disturbances
   1
     More generally there could be more than one observed characteristic of interest whose value changes over time
for a given individual, and/or for which the form of its interactions with either i or i can be specified a priori,
in which case the target parameter would be a vector. In our empirical work we condition on cells with common
observed characteristics, so using a single target parameter, which also simplifies the exposition, seems appropriate.
   2
     One could analyze the distinction between the identified set defined by our moment inequalities and the sharp
set in special cases where the sharp set is known as in the dynamic binary response model with discrete covariates
(Khan et al., 2020).


                                                          3
using both conditioning and matching. Torgovitsky (2019) considers state dependence through a
nonparametric dynamic binary potential outcome framework and provides an approach to com-
puting sharp bounds on state dependent treatment effects under various sets of assumptions.

Methods Used. We begin by considering models with a nonparametric  distribution. The
nonparametric analysis adapts moment inequalities
   · from Pakes and Porter (2016; henceforth P &P ), which analyzes discrete choice models with
     individual-by-product additively separable fixed effects but without state dependence, and

   · from revealed preference (without disturbances, fixed effects, or state dependence; this liter-
     ature dates back to Samuelson, 1938),
to our problem. Revealed preference generates inequalities that can be used either with or without
a parametric distribution of disturbances. To generate either a meaningful lower bound ( > 0) or
upper bound ( < ), the non-parametric revealed preference inequalities require a condition on
switching behavior in the data (observing a minimum switching rate). This condition is not satisfied
in our health insurance choice data where switching is relatively uncommon. So the empirical
results from the revealed preference assumptions use the parametric version of the inequalities it
generates.

Empirical Results. Our empirical results analyze health insurance choices in the Common-
wealth Care (or "CommCare") program in Massachusetts, enacted as part of the "RomneyCare"
reform. The program provided subsidized health insurance to low-income citizens via an insurance
exchange that let consumers choose among competing private plans. The program started in 2007
and grew steadily during 2007 and 2008. We begin our analysis in 2009 at the time of the first large
price change (conditioning on choices prior to this) and use plan switching behavior from 2009 to
2014, the year of transition to the Affordable Care Act exchange, for our empirical estimates.
    The non-parametric extension of the P&P inequalities applied to our full sample generate an
inordinate number of inequalities and only generates a lower bound for 0 at a significance level
(an "") of .05. The lower bound estimate        ^ = $20 per month is about one-third of average
(after-subsidy) consumer premiums in the market. The theory underlying the P&P inequalities
indicate that there are four subsamples that should generate bounds and that we can use those
subsamples without creating a selection problem, thus mitigating the impact of slack moments
on the test statistics from the full sample. When we use these subsamples, we generate an upper
bound estimate   ^ = $57. The parametric revealed preference results we turn to next sharpens the
lower bound, moving it up to $32, but produces an upper bound of $56 almost identical to the
P&P results. For comparison the average premium per member per month of the different plans
varied between $48 and $62.
    To see how allowing for fixed effects impacts these results, we also provide estimates of com-
parison models that allow for state dependence but do not allow for fixed effects. In particular
we estimate logit models with fixed effects interacted with: (i) increasing numbers of individual
characteristics; (ii) random effects that condition on the initial choice, and (iii) random initial
conditions (the initial condition estimator). The point estimates of 0 obtained range from $118 to
$77. Prior results on this data are consistent with these findings (see Shepard (2020), who finds a
point estimate of 0  $100). So the estimates that omit fixed effects are two to three times larger
than those that allow for them. We examine the implications of this difference for a counterfactual
pricing policy of interest, and find that they are likely to be rather dramatic.

                                                 4
Outline of Paper. We begin with the nonparametric results, first adapting the P&P inequalities
to allow for state dependence and providing the associated empirical results, and then adapting the
revealed preference inequalities. The revealed preference parametric inequalities for the parametric
case are provided next, first without and then with the additional structure of extreme value
disturbances. The latter are exceptionally easy to implement. Before going to the parametric
revealed preference empirical results, we present the results from the parametric comparison models
that do not allow for fixed effects. The empirical results for the parametric revealed preference
bounds with fixed effects are provided next together with the counterfactual analysis. We conclude
with a brief summary. All proofs are provided in Appendix C.

Notation. Let i,t  [ 1,i,t , . . . D,i,t ], i  [ i,1 , . . . i,T ], i  [1,i , . . . , D,i ], pi,t  [p1,i,t , . . . pD,i,t ],
and pi  [pi,1 , . . . , pi,T ]. While pi denotes price in our application, it could include any time-varying
observed covariates more generally.


2      P&P Approach
2.1      Identifying Inequalities
The following assumption underlies our first set of inequalities.

Assumption 2.1. For any t, the disturbance i,t is: (i) conditionally independent of pi and yi,s
for all s < t given i and i , and (ii) is stationary over time, that is

                      i,t   | pi , yi,t-1 , yi,t-2 , . . . , yi,0 , i , i    i,t   | i , i    i,1   | i , i .

    Assumption 2.1 is common in dynamic panel settings. It includes strict exogeneity of the time-
varying covariates pi while placing no restrictions on the correlation between i and pi , or i and
i . Nor does it impose any restriction on the distribution of d,i,t across choices d, so d,i,t can be
freely correlated with c,i,t , (c, d)  D2 . However, Assumption 2.1 does not allow for dependence
over time in { i,t }; the model filters the individual-specific dependence over time through yi,t-1 .
We will assume the i are identically distributed across individuals i, though, in principle, the
identification results could be re-written to allow for non-identical distributions.
    We now adapt the inequalities from the discrete choice model without state dependence pro-
vided in P&P (Lemma 2.2 below), to the model with state dependence. Consider any two periods
t and s, with t > s. For a fixed , order choices by the difference in the structural part of the
utility function between t and s, where the structural part of utility is defined as Ud,i,t - d,i,t from
equation (1.1). Since the i and the i do not vary over time, the choice with the largest structural
utility difference also does not depend on their values:

  d1 (yi,t-1 , yi,s-1 , pi,t , pi,s ; ) = maxdD [(-pd,i,t - {yi,t-1 = d}) - (-pd,i,s - {yi,s-1 = d})] , (2.1)

while for j = 2, . . . D, the choice with j th largest difference is

dj (yi,t-1 , yi,s-1 , pi,t , pi,s ; ) = maxd{
                                            / d1 ,...dj -1 } [(-pd,i,t - {yi,t-1 = d}) - (-pd,i,s - {yi,s-1 = d})] .


In words, d1 is the choice whose structural component of random utility improves most between
periods s and t (conditional on lagged choices), d2 improves the next most, and so on. So if
yi,t-1 = yi,s-1 , d1 would be the option whose price falls most between s and t. In general, however,

                                                                    5
d1 depends on both price changes and the lagged choice in each period. This dependence on lagged
choices is what allows us to generate moment inequalities that help bound 0 .
    Since i,t |zi , yi,t-1 , i , i  i,s |zi , yi,s-1 , i , i , the relative magnitude of the conditional proba-
bilities for yi,t = d1 and yi,s = d1 depends only on the difference in the structural part of the utility.
Moreover since the fixed effects are the same across periods, the difference in the structural part of
utility over time for a given choice does not depend on the fixed effects. So when  = 0 equation
(2.1) ensures that the conditional probability of observing d1 (·; 0 ) in period t is greater than in
period s. More generally, this argument leads to the following result.

Lemma 2.2. Suppose Assumption 2.1 holds. Assume t > s, and D0  D. If

                   min - pd,i,t - {yi,t-1 = d}0 -            - pd,i,s - {yi,s-1 = d}0
                   dD0

                          max - pc,i,t - {yi,t-1 = c}0 -                - pc,i,s - {yi,s-1 = c}0
                             c/ D0

then
                      Pr(yi,t  D0 |pi , yi,t-1 , i , i )  Pr(yi,s  D0 |pi , yi,s-1 , i , i ).

Let d0 j denote dj (yi,t-1 , yi,s-1 , pi,t , pi,s ; 0 ). Then the choice sets (or the D0 ) that satisfy the suppo-
sition of this lemma are D0 = {d0                     0 0                  0            0
                                            1 } , {d1 , d2 }, . . ., and {d1 , . . . , dD-1 }.
     In words, the lemma states the following. If the structural utility for individual i (including
any switching costs) for all options d  D0 improves by more than all options c                             / D0 between
periods s and t, then an individual will be more likely to choose an option d  D0 at time t than at
time s. This is true regardless of the value of the unobserved fixed effects in i (or of i provided
it is positive).
     Notice that the conditioning sets for the probabilities in the concluding inequality differ due to
the presence of the lagged dependent variable at different points in time. This feature distinguishes
the dynamic model from the static model, and underlies the need for a different argument for
identification than that used in P & P.
     To see how Lemma 2.2 can yield an inequality for identification in the dynamic model, consider
the special case where s = t - 1 and D0 is a singleton, e.g. yi,t-1 = d0                                       0
                                                                                                  1 and D0 = {d1 } in the
                                                                                                0            0
supposition of Lemma 2.2. Applying Lemma 2.2 we obtain Pr(yi,t = d1 |pi , yi,t-1 = d1 , i , i ) 
Pr(yi,t-1 = d0                                                                                0
              1 |pi , yi,t-2 , i , i ). Multiplying both sides by Pr(yi,t-1 = d1 |pi , yi,t-2 , i , i ) we obtain

       Pr(yi,t = d0             0                                0             0
                  1 , yi,t-1 = d1 |pi , yi,t-2 ) = E [Pr(yi,t = d1 , yi,t-1 = d1 |pi , yi,t-2 , i , i )|pi , yi,t-2 ]
                                                                                                2
                                                  E [ Pr(yi,t-1 = d0
                                                                   1 |pi , yi,t-2 , i , i )         |pi , yi,t-2 ]
                                                                                       2
                                                       Pr(yi,t-1 = d0
                                                                    1 |pi , yi,t-2 )       .                            (2.2)

Here the first inequality follows from the lemma, and the second from Jensen's Inequality. Dividing
both sides of (2.2) by Pr(yi,t-1 = d01 |pi , yi,t-2 ) yields

                         Pr(yi,t = d0            0                               0
                                    1 |yi,t-1 = d1 , pi , yi,t-2 )  Pr(yi,t-1 = d1 |pi , yi,t-2 ),                      (2.3)

as in Theorem 2.4 below.
    Notice that the slackness in the last inequality generating (2.2) is due to the fact that it ignores
the variance in Pr(yi,t-1 = d0  1 |pi , yi,t-2 , i , i ) conditional only on (pi , yi,t-2 ). This conditional
variance, in turn, depends on the variance of the i and i . The {i , i }i are explained by both

                                                             6
the observable and the unobservable determinants of utility, and the richer the set of observable
characteristics that the analyst can condition on, the lower the conditional variance of the i and i
in the data generating the inequality, and the more powerful the inequality in (2.2). This motivates
our decision to form moments from cells with common observable characteristics and yi,t-2 in the
empirical analysis which follows.
     The result in the theorem to follow extends the argument in (2.2) and (2.3) in two ways.
First, we broaden the argument to apply to choice probabilities of non-singleton sets. Lemma 2.2
considers the case where the conditioning set at time t - 1 includes the lagged value yi,t-1 . To
extend the argument in (2.2) from a singleton value d0   1 to a set of choices D0 , we apply Lemma 2.2
for each value yi,t-1  D0 , which requires the supposition in Lemma 2.2 to hold for each value
yi,t-1  D0 . Second, when s < t - 1, yi,t-1 only enters the inequality in the lemma through the
conditional probability for yi,t , which means yi,t-1 can be allowed to take values different than yi,t .
The condition below generalizes the supposition of Lemma 2.2 to accommodate these cases.
Condition 2.3. Assume t > s, and D0 , D1  D. Given pi,t , pi,s , yi,s-1 , and 0 , for all d  D1 ,

                 min - pd,i,t - {d = d}0 -          - pd,i,s - {yi,s-1 = d}0
                 dD0

                        max - pc,i,t - {d = c}0 -             - pc,i,s - {yi,s-1 = c}0     .
                           c/ D0

    This condition ensures that structural utility differences for the choices in D0 are larger at time
t for any value of the lagged dependent variable in D1 than at time s with a lagged dependent
value of yi,s-1 .
Theorem 2.4. Suppose Assumption 2.1 holds.

 (a) For s = t - 1, for any choice set D0 = D1 satisfying Condition 2.3,

                       Pr(yi,t  D0 | pi , yi,t-1  D0 , yi,t-2 )  Pr(yi,t-1  D0 | pi , yi,t-2 )

 (b) For s < t - 1, for any choice sets D0 and D1 satisfying Condition 2.3,

         Pr(yi,t  D0 | pi , yi,t-1  D1 , yi,s  D0 , yi,s-1 )  Pr(yi,t-1  D1 , yi,s  D0 | pi , yi,s-1 )

Remark 2.5. If s = t - 1, Lemma 2.2 will generate D - 1 inequalities. However since Condition 2.3
with D0 = D1 requires the assumption of the lemma to hold for every yi,t-1  D0 , the amount of
inequalities Theorem 2.4(a) generates will depend on 0 , with the maximum number equal to D - 1
and the minimum of one. In contrast if, as in Theorem 2.4(b), s < t - 1 the fact that Condition 2.3
allows the choice set D1 for yi,t-1 to be distinct from the choice set D0 leads to potentially many
more inequalities than D, though again the actual number will depend on . Also inequalities can
be built for temporal sequences of sets each of which satisfies the appropriate condition.

Generating Empirical Inequalities: Examples
To see the usefulness of Theorem 2.4 in application, consider two simple cases with a singleton
D0 = {d}, and a single alternate option c = d. The theorem generates inequalities which can be
implemented empirically. The simplest way to see the information these inequalities provide about
the parameter 0 is to find the values of 0 that are ruled out by violation of the inequalities. That
is, it is useful to examine the implications of the contrapositive of the theorem.

                                                      7
    In the first example, we compare the probability of switching from choice c to choice d at
time t - 1, Pr(yi,t-1 = d | yi,t-2 = c, pi ), with the probability of staying with choice d at time
t, Pr(yi,t = d | yi,t-1 = d, yi,t-2 = c, pi ). With a positive cost of switching 0 , the probability of
"staying" would generally be expected to be larger than the probability of "switching", even if
the relative price of choice d increased by a small amount from t - 1 to t. Theorem 2.4(a) makes
precise this intuition: if the relative price of d increases by less than twice the switching cost, then
staying at time t is more likely than switching at time t - 1.
    Assume the relative price of d does increase between t - 1 and t. Suppose, however, that the
fraction switching from choice c to d at time t - 1 is larger than the fraction staying with choice
d at time t. That is, suppose the inequality in the conclusion of Theorem 2.4(a) fails:
                 Pr(yi,t = d | yi,t-1 = d, yi,t-2 = c, pi ) < Pr(yi,t-1 = d | yi,t-2 = c, pi ).
This can only happen if the supposition of the theorem also fails, i.e. the inequality in Condition 2.3
is reversed. With a bit of rearrangement, this reversed inequality can be written as
        20 < pd,i - pc,i , where pd,i  pd,i,t - pd,i,t-1 ,              and pc,i  pc,i,t - pc,i,t-1 .
So a sufficiently large likelihood of switching implies an upper bound on how high switching costs
can be.
    In the second example, we obtain a lower bound on switching costs by comparing the probability
of staying with choice d at time t - 2 to switching from choice c to choice d at time t. This requires
the subscriber to have switched to c in t - 1, so we are considering a situation where the relative
price of d rose in t - 1 and then fell sharply in t. If the fall was sharp enough for the relative price
of d to be considerably lower at t than in t - 2, then the probability of switching into d at time
t for the subscriber should be higher than the probability of staying with choice d at time t - 2.
The reversal of this inequality underlies our lower bound.
    To formalize this intuition it is useful to start with Condition 2.3 and the implications of
Lemma 2.2. Set D0 = {d}, D1 = {c} and yi,t-3 = d, the inequality in Condition 2.3 can be written
as:
          ¯pc,i - ¯ pd,i  20 , where ¯    pd,i  pd,i,t - pd,i,t-2 , and ¯  pc,i  pc,i,t - pc,i,t-2 .
Under this condition, Lemma 2.2 and Assumption 2.1 yield that
    Pr(yi,t = d | yi,t-1 = c, yi,t-2 = d, yi,t-3 = d, pi , i , i )  Pr(yi,t-2 = d | yi,t-3 = d, pi , i , i ).
The lemma shows that if the relative price of choice d has gone down by more than twice the cost
of switching, then the probability of switching at t will be greater than the probability of staying
at t - 2. Unfortunately, these probabilities are not directly useful empirically since we do not
observe the individual effects i or i . Theorem 2.4(b) aggregates this probability inequality to a
more empirically useful conclusion:
  Pr(yi,t = d | yi,t-1 = c, yi,t-2 = d, yi,t-3 = d, pi )  Pr(yi,t-1 = c, yi,t-2 = d | yi,t-3 = d, pi ).       (2.4)
Notice that the righthand side probability is smaller than the "aggregated" probability of staying
at time t - 2, Pr(yi,t-2 = d | yi,t-3 = d, pi ). This is the slackness introduced to enable aggregation
in the theorem.
    Finally, we can consider the contrapositive in this example. Suppose we observe that the
relative price of d has decreased between times t - 2 and t and yet the conclusion of the theorem
in (2.4) fails:
     Pr(yi,t = d | yi,t-1 = c, yi,t-2 = d, yi,t-3 = d, pi ) < Pr(yi,t-1 = c, yi,t-2 = d | yi,t-3 = d, pi ).

                                                       8
Then, it must follow that Condition 2.3 also fails and the decline in the relative price of d must
have been less than twice the switching costs:

                                            20 > ¯
                                                 pc,i - ¯
                                                        pd,i .                                               (2.5)

To summarize, if a decline in the relative price of d does not induce sufficient switching into choice
d, then switching costs must not be too low.
    These examples show how Theorem 2.4 can be used to generate bounds on 0 . In both examples
we compare events at different points in time for the same individuals. So we hold the individual's
preferences fixed. Then we consider events that force a trade-off between changes in relative prices
and switching costs. These events must include switching to distinguish state dependence from
heterogeneity. We turn now to showing how this reveals bound on  in our data.

2.2     Empirical Results: Massachusetts Health Insurance Data.
We analyze health insurance plan choices made by enrollees in the Commonwealth Care ("Comm-
Care") program in Massachusetts between 2009-2014. The program provided heavily subsidized
insurance to low-income adults (earning less than 300% of the Federal Poverty Level) via a market
featuring competing private health insurers. Five insurers participate in the market during our
data period, with each insurer (by rule) offering a single plan. Program rules required each enrollee
to make a separate choice; there was no family coverage, and kids were covered in the separate
Medicaid program. Individuals make plan choices at two times: (1) when they join the market as
a new enrollee, and (2) during an annual open enrollment month when they are allowed to switch
plans. Because our focus is on switching costs, we study open enrollment choices, setting the prior
choice (the state, yi,t-1 ) equal to the individual's plan in the month prior to open enrollment.3 For
more detail on the data and the CommCare program see Shepard (2020); Finkelstein, Hendren,
and Shepard (2019); McIntyre, Shepard, and Wagner (2021).
    We want to capture switching costs that are not induced by changes in the individual's choice
environment, just by prices, and this requires the choice set to be the same in the two periods we
compare. We therefore remove comparisons for individuals who changed regions (there are five
in the data), or who faced different plan offerings in the comparison periods, and use separate
inequalities for each pair of income groups in years t and s. We distinguish income groups be-
cause subsidies--and therefore post-subsidy premiums--vary across five income groups (0-100%
of poverty, and four 50% of poverty groups from 100-300%). Lower-income groups both pay lower
premiums overall and have narrower premium differences across plans. This generates substantial
price variation that we can use to estimate 0 . Besides variation across income groups due to
subsidies, price variation was limited by regulations. Prices could vary by region in 2009-2010 but
not from 2011-on. No variation was allowed on other factors including age, gender, health status,
or any other characteristics.
    Our model assumes that individual-level unobserved plan preferences (d,i ) are stable over
time. This is a sensible assumption given the nature of plans in the CommCare market. Coverage
is heavily regulated, with all cost sharing and covered medical services completely standardized
   3
    Individuals are also allowed to switch plans when they change income group or move across regions. We treat
changes occurring at these times as separate choices for estimation purposes. There are a small number of instances
where individuals switch plans outside of the standard open enrollment, and we drop these observations from the
data.




                                                        9
across insurers. The only flexible plan attributes are provider networks.4 These were largely stable
during our sample period with one major exception. Network Health (one of our plans) drops
Partners HealthCare (the state's largest medical system) from its hospital network at the start of
2012. To account for this, we treat Network as two different plans, one before and one after 2012,
and apply the rules above with that understanding. There were no other major changes in the
networks of the plans during our study period. However, one plan enters mid-sample (Celticare in
2010), and one plan (Fallon) exits several areas in 2011.
    As noted to form the sample analogues of the inequalities in Theorem 2.4 we form cells with
the same observed characteristics and yi,s-1 . The observed characteristics of a cell are denoted by
xi and are defined by the Cartesian product of; a) couple of years, b) region c) plan availability and
d) income group. So the {i , i }i represent differences in tastes among consumers with the same
xi and yi,s-1 . Recall that though the ratio of price sensitivity to switching cost is held constant,
the price sensitivities themselves (the i in equation (1.1)) can vary in an arbitrary way, and are
not identified in the non-parametric analysis.
    Table 1 provides summary statistics on the data used, which is constructed from all the cells
defined above that have more than 20 members. We then sum the inequalities generated by these
cells across regions and plan availabilities to obtain our groups, and use these in estimation. There
are 242 groups (defined by couple of years, income, and prior choice) and about 75,000 individual
comparisons. Given Assumption 2.1 the variables defining our groups are condiionally independent
of the values of the disturbances in the comparison periods, so we can use subsets of the groups
in estimation without incurring a selection bias. As noted, the number of inequalities obtained in
this way depends on the value of  being tested but, when using the full sample is always large,
varying between nine and twenty-four thousand, all but two of which will be slack.

                     Table 1: Summary Statistics for the Non-Parametric Estimator


 (s, t)             Number of        Number of    Number of       Number of       Minimum        Maximum
                     Members           Groups      Members          Groups       Number of       Number of
                                                     Above           Above        Moments         Moments
                                                     Cutoff          Cutoff
 (2009, 2010)             19,550            96         17,349              66           1,494          3,671
 (2010, 2011)             13,989            96         13,181              76           3,181          8,748
 (2012, 2013)             47,266           120         44,438             100           4,251         11,225
 Total                    80,805           312         74,968             242           8,926         23,644
Notes: The cell size cutoff is 20.

    These inequalities are divided by their estimated standard errors, stacked, and the inequality
with the largest negative value was calculated for each candidate . As suggested by Armstrong
(2014), this became the sample value of the test statistic for that . The simulated value of the
test statistic for the given  was obtained once without any adjustment for slack moments, and
once using the adjustment proposed in Romano, Shaikh, and Wolf (2014, henceforth RSW), and
the variance covariance required for these calculations was obtained via a bootstrap.
   4
    Preferences across plan provider networks are likely to be quite heterogeneous across individuals in hard-to-
observe ways, making them a good candidate for our flexible fixed effects approach. For instance, Shepard (2020)
and Tilipman (2020) find that consumers value provider networks heavily based on existing relationships with
doctors and hospitals, which vary substantially even across enrollees living in the same location.

                                                       10
                                                         Figure 1: Choices and Premiums

                                                 Average Enrollee Premiums by Insurer

                                   100
                                   80
               Premium ($/month)




                                             Fallon
                                   60




                                                            NHP
                                   40




                                                                  BMC      Network
                                   20




                                                                          CeltiCare                   Network change
                                   0




                                         2007        2008         2009       2010      2011             2012         2013
                                                                         CommCare Year
                                          Average premiums for above-poverty enrollees only. Below poverty people pay $0.




    Figure 1 provides the average prices paid by consumers (i.e. after subsidy) by year and plan.5
Our inequalities compare changes in choices to changes in prices, so the within-plan variance in
prices over time underlies our set estimator of 0 . The variance in prices within plan and time
period is largely tied to income (though up to 2010 there was also regional variation in prices),
which is the reason we separated groups by income.
    The figure indicates that prices do go both up and down within a plan over time. This is largely
a result of perceived changes in demand and plans adapting pricing strategies as they learned about
the market and as regulatory rules changed. Importantly, with one exception, these do not appear
to reflect changes in plan quality. As noted above, most insurance attributes, including cost
sharing and covered medical services, were standardized by regulators so that all plans provided
identical benefits within a given income group. The only significant non-standardized attribute is
the covered network of doctors and hospitals, which are relatively stable over time (see Appendix
A Figure 6) with one key exception: a major network narrowing by Network Health in 2012. We
denote this narrowing by the vertical line in Figure 1 and account for this explicitly in our analysis
by treating Network Health as a different plan on either side of this cutoff.
    The largest price change in Figure 1 is the increase and then decrease in price of BMC in
2012-2013 relative to other plans. As noted there were no major changes in BMC's network or
other quality attributes at this time. Instead, this change appears to reflect BMC's strategic
response to a new competitive rule introduced by market regulators in 2012. The rule specified
that new enrollees with incomes below the poverty line ­ who are fully subsidized, so pay $0 for
any plan ­ were limited to choosing one of the two lowest-price plans (to the state). This created
an auction-like dynamic in which the two lowest-bidding plans "won" access to this large group,
  5
      Prices set in 2007 were locked in from 2007-08, which is why there are no separate points shown for 2008.


                                                                            11
representing about half of new enrollees. In 2012, Network Health and CeltiCare bid low and won
this auction, while BMC chose to raise its price and earn a larger margin on those members who
did not move (BMC had the largest share in 2011). However, having lost almost half of its market
share during 2012, BMC reversed course in 2013 and undercut both its competitors. This allowed
it to rebuild its market share during 2013 leading into the important transition of CommCare into
an Affordable Care Act exchange in 2014.
    Table 2 summarizes the path of enrollment between 2011 and 2013 for people enrolled in
CommCare in 2011. The top panel indicates that about two thirds of those enrolled in CommCare
in 2011 had moved out of CommCare by 2013. This is a market with a lot of "churn" (partly
induced by movements in and out of low-income eligibility due to employment changes). The
bottom panel reports on switching behavior among subscribers who stayed in CommCare between
2011 and 2013. The fraction who switch plans in 2012 is 14.5%; BMC, the plan with the largest
price increase, loses 19% of its 2011 subscribers. Though all prices changed in 2013, BMC is the
only plan whose average price decreased. It saw 36% of those who switched out in 2012 switch
back in 2013, while only 4% of those who switched out of other plans in 2012 switched back in
2013. These changes underlie much of the empirical work that follows.

        Table 2: Statistics on Enrollment and Switching for 2011 Enrollees over 2011-2013

                                                        All 2011              By 2011 Plan
                                                        Enrollees           BMC      All Other Plans
      Number of Enrollees
         Total Enrollees in 2011                        111,226            36,235           74,991
           Leave Market before 2013                      76,007            24,812           51,195
           Stay in Market 2011-13                        35,219            11,423           23,796
      Switching Rates (among stayers in market)
          Switch Plans from 2011-2012                      14.5%             19.0%            12.3%
          Switch in 2012, Switch Back in 2013               2.5%              6.8%             0.5%
          Switch in 2012, Do Not Switch Back 2013          11.9%             12.1%            11.8%
Note: The table shows statistics on enrollment and swithing rates over the 2011-13 period. The sample is people
enrolled in CommCare in 2011 who are not in the below-poverty income group (who do not pay premiums so do
not experience the premium changes shown in Figure 1), and the columns separate this group by plan in 2011. The
top panel shows enrollment numbers, and the bottom panel shows switching rates among people who stay in the
market from 2011-13.




Estimates. We begin with estimates that use the full dataset (Figure 2), then explain how theory
directs us to choose particular subsets of the data, and finally show the results for those subsets
(Figure 3).
    The blue line in Figure 2 provides the value of the test statistic that the data generates for
alternative values of . The long-dashed red line provides the five percent critical value for the
 values obtained from a test statistic that does not use a correction for slack moments, and the
dotted red line is the test statistic when we use the RSW correction. Acceptable values of  are all
values where the blue line is lower than the red lines. The blue line crosses the red lines at  = $19.6
and since it remains below it thereafter, $19.6 becomes    ^ , the lower bound of the 95% confidence
set for 0 based on the full dataset. Notice, however, that the blue line is always noticeably above

                                                      12
zero, indicating that there are groups in the data which violate one or more inequalities at higher
levels of , but the violations are not significant at  = .05 when we use all the moments counted
in Table 1.




                     Figure 2: Non-parametric Estimates of Switching Costs (0 )

Note: The non-parametric estimator restricts the comparisons to individuals with the same choice sets at time s
and t. Cell level moments are constructed, and then aggregated into groups. The lower bound identified is at $19.6.

     While the full dataset is a useful starting point, we also consider using only the conditional
moment inequalities associated with groups expected to be most informative about the cost of
switching. Since prices appear only in the conditioning sets of the moments, we use price in-
formation to determine these groups. The examples introduced following Theorem 2.4 illustrate
how theory leads us to expect certain price movements to be especially helpful in providing upper
and lower bound information on 0 . Recall that the first example yielded an upper bound when
switching to choice d in the previous period was more likely than staying with d in the current
period. This circumstance is expected when a sharp relative price drop in choice d at t - 1 induces
sufficient switching into d at t - 1, and is followed by a relative price increase of d at time t which
induces sufficient switching back out of d. Generally, this is the situation for BMC's competitors
from 2011-13.
     The second example showed how a lower bound could be achieved when the relative price of d
declines over two periods yet the likelihood of staying with choice d two periods ago followed by a
switch away from d in the next period, is larger than the likelihood of a switch back to choice d in
the current period. This might occur if there is a relative price increase in choice d at time t - 1
and an even larger price fall in t. If a sufficient number of the subscribers who shifted out of d in
t - 1 did not shift back when its relative price was lower in t then when they chose it in t - 2, we
would infer a lower bound to . This describes the situation for BMC pricing over 2010-2013.
     Figure 1 shows the large BMC price increase between 2010 to 2012 followed by the even larger
decrease in 2013 that yielded the lower bound in Figure 2 via (2.5). Panel (a) of Figure 3 shows
prices facing a particular income group in the Boston area, and panel (b) shows the prices for
an income group in Western Massachusetts. These two panels show that there are groups with
price changes in those years that satisfy the condition for the upper bound, that is for which
(pd,i,t - pc,i,t ) - (pd,i,t-1 - pc,i,t-1 ) > 0 (with choice c = BMC). The bottom panels summarize the
test statistics for: these two groups (panels c and d), the two groups for which 0 < (pd,i,t-2 -
pc,i,t-2 ) - (pd,i,t - pc,i,t ) and hence might generate lower bounds (panels e and f), and finally in
panel (g) the test when we use the inequalities generated by all four of the selected groups.

                                                        13
                                                     Enrollee Premiums                                                              Enrollee Premiums
                                 200                                                                            200




             Premium ($/month)




                                                                                            Premium ($/month)
                                 150                                                                            150


                                 100                                                                            100


                                 50                                                                             50


                                  0         Network change                                                       0         Network change
                                   2011                   2012                      2013                          2011                   2012                    2013
                                                      CommCare Year                                                                  CommCare Year
                                               BMC           CeltiCare     Fallon                                             BMC           CeltiCare   Fallon
                                               NHP           Network                                                          NHP           Network



                                          (a) Upper bound cell #1                                                        (b) Upper bound cell #2




                                          (c) Upper bound cell #1                                                        (d) Upper bound cell #2




                                          (e) Lower bound cell #3                                                        (f) Lower bound cell #4




                                                                         (g) Combining four cells

          Figure 3: Average premiums and non-parametric estimators in two selected cells

Note: The figures show cells in the data that have price changes that satisfy the conditions for a bound. Cells are
defined by individuals who are in a given region and follow a specific income group path across the years 2011-2013.
They focus on the year pair (2012, 2013) for individuals whose lagged choice in 2011 is BMC to capture the large
increase in BMC premium in 2012 and then the large drop in 2013. Plan prices differ across income groups due to
subsidy schedules, and choice sets differ across regions. Panels (a) to (d) focus on two cells where we obtain upper
bounds. Panels (a) and (b) show premiums of available plans. Panels (c) and (d) show test statistics and critical
values. Panels (e) and (f) show test statistics and critical values based on two cells where we obtain lower bounds.
Lastly, panel (g) shows test statistics and critical values combining the four cells in panels (c) to (f). Panels (a) and
(c) correspond to the cell with income 250-300% of poverty in 2012 and 2013, in Boston with choice set: {BMC,
CeltiCare, NHP, Network}. Panels (b) and (d) correspond to the cell with income 250-300% of poverty in 2012
and 2013, in Western MA with choice set: {BMC, CeltiCare, Network}. Panel (e) corresponds to the cell with
income 100-150% of poverty in both 2012 and 2013, in Western MA with choice set: {BMC, Network}. Panel (f)
corresponds to the cell with income 100-150% of poverty in 2012 and 150-200% of poverty in 2013, in Western MA
with choice set: {BMC, Network}.
                                                                                       14
    Panels (e) and (f) correspond to cells that underlie the lower bound in Figure 2. Panel (c)
shows an indication of an upper bound at  = 49 though it is not significant at our significance
level of  = .05, but panel (e) shows an upper bound of  = 54 which is significant at  = .05.
When we put the four groups which satisfy our exogenous selection criteria together in panel (g)
and use an  = .05 we obtain the confidence interval 0  [^   = 19.6, ^ = 57].


2.3    Non-Parametric Revealed Preference.
Revealed preference and the random utility model in (1.1) imply that the probabilities of se-
quences of choices that difference out the fixed effects are determined by 0 and the distribution
of disturbances. The bounds on 0 that this generates depend on the assumption made on the
distribution of the disturbances. The next section considers parametric distributional assumptions.
This section focuses on nonparametric assumptions on the disturbance distribution.
    With at least one switch in choice across time, we show that information is available on 0 for
arbitrary {d,i }d,i . At least three time periods of data are needed to observe a lagged dependent
value prior to a switch in choices. For choices c = d, suppose that yi,t = d and yi,s = c. Equation
(1.1) tells us that if (d, c)  Dt and yi,t = d, then Ud,i,t  Uc,i,t . If yi,t-1 = r this implies
           - [pd,i,t - pc,i,t ] - [1{r = d} - 1{r = c}]0 i + [d,i - c,i ] + [                 d,i,t   -       c,i,t ]    0.
Analogously if (d, c)  Ds and yi,s = c, then Uc,i,s  Ud,i,s and
      - [pc,i,s - pd,i,s ] - [1{yi,s-1 = c} - 1{yi,s-1 = d}]0 i + [c,i - d,i ] + [                     c,i,s   -        d,i,s ]    0.
Note that when s = t - 1, r = c in the above inequalities. If we add these two inequalities, the
fixed effects cancel and we obtain
           0          - [(pd,i,t - pc,i,t ) - (pd,i,s - pc,i,s )] - [1{r = d} - 1{r = c}
                    -(1{yi,s-1 = d} - 1{yi,s-1 = c})]0 i + [          d,i,t   -   c,i,t   -(    d,i,s     -      c,i,s )]                (2.6)
    Since this result depends only on the double differences of certain variables we introduce nota-
tion for those differences,
      pa,b
       i,,         pa,i, - pb,i, - (pa,i, - pb,i, ),               a,b
                                                                   i,,            a,i,    -    b,i,     -(        a,i,      -     b,i,   ),
 1a,b (r, r )  1{r = a} - 1{r = b} - [1{r = a} - 1{r = b}]
and rewrite the revealed preference inequality in (2.6) as
                                pd,c          d,c
                                 i,t,s + 0 · 1 (r, yi,s-1 ) i  
                                                                                    d,c
                                                                                    i,t,s .                                              (2.7)

    Note that 1d,c (r, yi,s-1 )  {-2, -1, 0, 1, 2}. If s = t - 1, then to obtain inequality (2.6) we
set r = c in which case 1d,c (c, yi,t-2 )  0. If s < t - 1, since i  0, then all r with the same
value of 1d,c (r, yi,s-1 ) can be pooled together to form an inequality which bounds 0 .
                    d,c                                                                               d,c
Theorem 2.6. Let Ft,s   (·) denote the conditional distribution function of                           i,t,s   given (pi , yi,s-1 , i )
and assume d, c  Dt  Ds and d = c. Then,
                                                     d,c      d,c          d,c
 (a) Pr(yi,t = d, yi,t-1 = c|pi , yi,t-2 , i )  1 - Ft,t-1 ((pi,t,t-1 + 0 1 (c, yi,t-2 ))i ), and
 (b) Assuming 0  0,
                                                                                       d,c
                             Pr(yi,t = d, yi,t-1 = r, yi,s = c|pi , yi,s-1 , i )  1 - Ft,s ((pd,c
                                                                                              t,s + 0 y)i ).
       r:1d,c (r,yi,s-1 )y


                                                        15
    Part (a) of Theorem 2.6 follows directly from equation (2.7). For part (b) notice that the event
defined by (2.7) yields a bound for all r where 1d,c (r, yi,s-1 ) = y and will contain the upper
bound event for all r such that 1d,c (r , yi,s-1 )  y, as long as 0  0. The inequality in (b)
follows, and we show below why adding the associated probabilities is likely to be helpful.



                                   d,c
                              1 - Ft,s (·)



                        Ph


                        Pl

                                                                                 
                                     l       h                h         l
                                      Figure 4: Identified set for 0

    To see the potential usefulness of the Theorem 2.6 inequalities, Figure 4 illustrates the bounds
                                                         d,c
on the parameter 0 in the case where Ft,s                    and i are known. Fix pd,c     i,t,t-1 and suppose
      d,c                                     d,c        d,c          d,c
1 (c, yi,s-1 ) > 0. Plotting 1 - Ft,s (pi,t,s + 1 (c, yi,s-1 )) as a function of , we obtain
the red curve that is decreasing in . Then, the values of  satisfying an inequality of the form
             d,c
P  1 -Ft,s       (pd,c                  d,c
                        i,t,s + 1 (c, yi,s-1 )) will be the  values to the left of the red line at P illus-
trating how an upper bound on 0 would be implied by Theorem 2.6. When 1d,c (c, yi,s-1 ) < 0,
       d,c
1 - Ft,s   (pd,c                d,c
                 i,t,s + 1 (c, yi,s-1 )) is an increasing function of  as illustrated by the upward
                                                                          d,c
sloping green line. In this case, the inequality P  1 - Ft,s                  (pd,c         d,c
                                                                                i,t,s + 1 (c, yi,s-1 )) yields
a lower bound on 0 . Finally, the different values of P show that larger P values yield tighter
bounds on 0 , which explains how the accumulation of probabilities through the sum in part (b)
can sharpen the information on 0 .
    The ability to make use of these potential bounds on 0 rests on the available information
                                                 d,c
about the conditional distribution Ft,s              and i . We consider two approaches. First, we take
a nonparametric approach, and show that common stochastic assumptions on i,t lead to the
conclusion that the median of  d,c            i,t,s is zero. With just this assumption and no assumptions
on the i beyond nonnegativity, we show that the inequalities in Theorem 2.6 provide identifying
information on 0 when the choice probabilities on the lefthand side of the inequalities in that
                                                                d,c
theorem exceeds one half. Second, we assume that Ft,s               comes from a given parametric distribution,
and i is assumed to be a function of observables xi . After providing the inequalities implied by
                                    d,c
Theorem 2.6 for a general Ft,s          , we consider the additional inequalities that result from assuming
  d,c
Ft,s is a logistic distribution.

                                                      16
    The nonparametric assumption on the random utility errors considered thus far is Assump-
tion 2.1. This assumes both stationarity and conditional independence across time. It is straight-
forward to show that the conditional distribution of  d,c      i,t,s is then symmetrically distributed
                    d,c
around zero and Ft,s (0) = 0.5. This median zero restriction is sufficient to generate a bound on 0
using the inequalities in Theorem 2.6. Moreover, this median zero restriction can also be obtained
under stochastic assumptions that weaken the stationarity requirement. The extension we consider
in our empirical work and which is likely relevant for other applied problems is the case where a
pair of choices c and d are available in different time periods, but the other choices could change
across time. Then it is sufficient to assume that the disturbance in random utility for this couple
of choices is stationary and conditionally independent across time. Alternatively, the median zero
restriction can be obtained under stochastic assumptions where stationarity is completely relaxed.
It suffices to assume d,i,t - c,i,t and d,i,s - c,i,s are symmetrically distributed about zero. These
could have different distributions, but given conditional independence across time, the conditional
distribution of  d,c                                                            d,c
                      i,t,s is symmetrically distributed around zero, so that Ft,s (0) = 0.5. Note that
the assumption that d,i,t - c,i,t and d,i,s - c,i,s are symmetrically distributed about zero would
follow from an assumption of exchangeability of the disturbances across choices (Manski, 1975;
Fox, 2007; Yan, 2013).
    Next we state the implication of a median zero assumption when combined with the inequalities
of Theorem 2.6.
                        d,c
Corollary 2.7. Suppose Ft,s (0) = 0.5 and i > 0.

 (a) If Pr(yi,t = d, yi,t-1 = c | pi , yi,t-2 )  0.5, then pd,c          d,c
                                                            i,t,t-1 + 0 1 (c, yi,t-2 )  0; and

 (b) If    r:1d,c (r,yi,s-1 )y   Pr(yi,t = d, yi,t-1 = r, yi,s = c | pi , yi,s-1 )  0.5, then pd,c
                                                                                               t,s + 0 y  0.



In this corollary, the revealed preference implications of the zero median restriction generate in-
equalities which condition on only observable variables, in contrast with the statement Theorem 2.6,
and give the corollary its identifying power.
    To examine the direction of the bounds on 0 provided by Corollary 2.7, suppose, for some y,
  r:1d,c (r,yi,s-1 )y Pr(yi,t = d, yi,t-1 = r, yi,s = c | pi , yi,s-1 )  0.5 as in part (b). When y > 0, the
corollary implies the upper bound
                                                       pd,c     i,t,t-1
                                              0  -                      .
                                                               y
When y < 0 the corollary implies the lower bound

                                                pd,c
                                                 i,t,t-1
                                              -           0 ,
                                                y

which will be useful when pd,c  i,t,t-1 > 0.
                                        d,c
    Without further restrictions on Ft,s    (·), when Pr(yi,t = d, yi,t-1 = c|pi , yi,t-2 ) < 0.5, no identify-
ing information on 0 is provided by Theorem 2.6 and the additional assumptions in Corollary 2.7.
Unfortunately, none of the groups in our data corresponding to different conditioning sets satisfy
the probability condition required to obtain the non-parametric bounds given in Corollary 2.7.




                                                       17
Summary: Non-Parametric Bounds. The median zero condition on the twice differenced
random utility disturbance does not require a disturbance distribution that is stationary over
time. This median restriction
        · only generates bounds if there is a group with a switching probability greater than one half.6
This condition is not satisfied in our (and we expect most) health insurance data, but it likely is
satisfied in some retail markets (particularly those with both regular and"sale" prices).
    The P &P bounds do require the stationarity assumption but can generate bounds with switch-
ing probabilities less than a half. In particular it generates
        · a lower bound if price first rises and then falls to lower than its initial level, and not all
          people who switched out switch back, and

        · an upper bound if people switch out because of a relative price rise and then do move back
          when its price falls sufficiently.
Using an  = .05 the P&P bounds for our data generate the confidence interval 0  [$20, $57].


3         Bounds from a Parametric                            Distribution.
The parametric model requires a distributional assumption for the random utility disturbances and
a functional form for i . We will assume that i can be written as a function of observed variables
xi that does not vary over time, or i =  (xi ). One could parametrize this function, but we do
not pursue this option explicitly here. To parametrize the disturbance distribution, Assumption
2.1 is replaced by
                                                                            d,c
Assumption 3.1. Assume the conditional distribution of                      i,t,s   given (pi , yi,s-1 , xi ) takes a
                                   d,c
known parametric form with c.d.f. Ft,s (·;  ).
Typically Assumption 3.1 would be satisfied by assuming that d,i,t is conditionally independent
                                                                                   d,c
across time and specifying parametric joint distributions across choices to yield Ft,s (·;  ).
   With Assumption 3.1, we can identify separate coefficients on price and the lagged dependent
variable, so we re-write the utility equation (1.1) as

                          Ud,i,t = (-pd,it 0 - 1{yi,t-1 = d}0 )  (xi ) + d,i +        d,i,t ,                  (3.1)

                                          with     0  0 and 0  0.
    We remain focused on estimating the tradeoff between price sensitivity and switching costs, i.e.
0  0 /0 , and as in the non-parametric analysis, assume that 0 does not dependent on xi . We
begin by examining the revealed preference inequalities that hold for any parametric distribution
of the disturbances. Then we add the extra information we gain by assuming the disturbances at
                                                                     d,c
each t are extreme value ("logistic") distributions7 (in which case Ft,s (·;  ) has the analytic form
given in section 3.1). Inequality (2.7) does not depend on the form of the distribution function,
    6
     The actual condition is somewhat different for the upper and lower bound. For an upper bound we need two
switches (three periods of data) with a probability greater than .5. For a lower bound we only need one switch but
also a choice not to switch (so four periods of data) with a probability greater than .5.
   7
     Other specific distributions would likely add different information. We use the extreme value distribution
because it was used extensively in prior work and generates a transparent set of restrictions.

                                                       18
so provided (d, c)  Dt  Ds , it is still the case that Theorem 2.6 holds, only now with the
parameterization in equation (3.1) which gives us the following corollary.8
Corollary 3.2. Suppose Assumption 3.1 holds, and assume d, c  Dt  Ds and d = c. Then,
                                                       d,c      d,c          d,c
  (a) Pr(yi,t = d, yi,t-1 = c|pi , yi,t-2 , xi )  1 - Ft,t-1 ((pi,t,t-1 0 + 1 (c, yi,t-2 )0 ) (xi );  ), and
                                                                                         d,c
  (b)                         Pr(yi,t = d, yi,t-1 = r, yi,s = c|pi , yi,s-1 , xi )  1 - Ft,s ((pd,c
                                                                                                t,s 0 + y0 ) (xi );  ).
        r:1d,c (r,yi,s-1 )y




Anatomy of the Parametric Inequalities. Each inequality generated by the parametric
model generates a line which divides the (,  ) plane into acceptable and non-acceptable half-
spaces. The slope and/or quadrant of the acceptable half-space differs with
                   t,s
    · the sign of yc,d (which can be greater than, less than, or equal to zero), and

    · the sign of pd,c
                   t,s (which can be greater than or less than zero).

                                       d,c                d,c
In addition, if the the median of Ft,s     (·) = 0, then Ft,s (Pr(·|·))-1 differs in sign according as
Pr(·|·)<
       > 1/2, and the six inequalities have different implications for the two cases. Accordingly
there are twelve cases to consider. Appendix B considers each with explanatory graphs.
   Since none of the relevant probabilities are greater than a half in our data, there are only six
cases to consider and Appendix B shows that only four generate restrictions in the appropriate
quadrants.9 We use all inequalities generated by these four in our empirical analysis.

3.1      The Magic of Logits
Implementation of the parametric revealed preference approach in empirical work requires func-
                  d,c
tional forms for Ft,s (·), and any particular choice may well generate additional restrictions on the
parameters. As in much of the prior empirical work and the comparison models we turn to below,
we assume a Gumbel (logistic) distribution for and explore its additional implications.
Assumption 3.3. (a) Assume i,t is independent of the conditioning set (pi , yi,t-1 , . . . , yi,0 , xi , i ),
and (b) 1,i,t , . . . , D,i,t are independent (and identically distributed) across choices, where 1,i,t has
a standard Gumbel distribution.
    Assumption 3.3 yields the traditional logit form for the choice probabilities,

               Pd,i,t|yi,t-1  Pr(yi,t = d | pi , yi,t-1 , xi , i )
                         exp[(-pd,i,t 0 - 1{yi,t-1 = d}0 )  (xi ) + d,i ]      Nt (d, yi,t-1 )ed,i
                  =                                                                                .
                          r exp[(-pr,i,t 0 - 1{yi,t-1 = r }0 )  (xi ) + r,i ]   Mt (yi,t-1 , i )
   8
     Corollary 3.2 does not exhaust the inequalities generated by the model. When s < t - 1, it derives an inequality
for the probability of (yi,t = d, yi,t-1 = r, yi,s = c); a different inequality can be obtained by integrating out yi,t-1
conditional on yi,s-1 . To use that inequality that we have to account for the fact that we do not know what yi,t-1
would have been had yi,s = c, and replace the integrand for that case with the max operator. We experimented
with this inequality in our early empirical work but it did not generate binding constraints.
   9
     These are the inequalities for the following cases: all three cases corresponding to a positive price change
(pd,c                                                                  d,c
      t,s > 0), and the case with a negative price change (pt,s < 0) and 1
                                                                                         d,c
                                                                                             (c, yi,t-2 ) > 0 (or y > 0), see
Appendix B for details.

                                                             19
This implies that (conditional on yi,t-2 ) the ratio of the probability of choosing d at t and c at
t - 1, to the probability of choosing c at t and d at t - 1 is
            Pd,i,t|c    Pc,i,t-1|yi,t-2   Nt (d, yi,t-1 = c) Nt-1 (c, yi,t-2 )   Mt (yi,t-1 = d, i )
                                        =                                      ×
         Pd,i,t-1|yi,t-2 Pc,i,t|d          Nt-1 (d, yi,t-2 ) Nt (c, yi,t-1 = d) Mt (yi,t-1 = c, i )

And, for this particular comparison of choices, the fixed effects in the numerator terms cancel.
Moreover, the ratio of denominators can be bounded by functions that do not depend on the fixed
effects: exp(0  (xi ))  Mt (yi,t-1 = d, i )/Mt (yi,t-1 = c, i )  exp[-0  (xi )]. This gives us the
inequalities

                   Nt (d, yi,t-1 = c) Nt-1 (c, yi,t-2 )
        exp[0  (xi )]
                     Nt-1 (d, yi,t-2 ) Nt (c, yi,t-1 = d)
               Pd,i,t|c Pc,i,t-1|yi,t-2                    Nt (d, yi,t-1 = c) Nt-1 (c, yi,t-2 )
                                            exp[-0  (xi )]                                       .
            Pd,i,t-1|yi,t-2 Pc,i,t|d                        Nt-1 (d, yi,t-2 ) Nt (c, yi,t-1 = d)

    So the ratio of the odds of choosing (yi,t-1 = c, yi,t = d) to (yi,t-1 = d, yi,t = c) is bounded
by functions that are independent of the {i }i . This finding is reminiscent of Chamberlain (1980)
who derived a conditional likelihood that did not depend on the {i }i for the static multinomial
logit panel case (the model with no lagged dependent variable). Once we allow for a lagged
dependent variable and rearrange terms we get the inequalities in the theorem that follows for
choice probabilities at t and t - 1. A more detailed argument shows that similar inequalities are
valid for the odds ratio at t and t - 2 (see Remark 3.6).

Theorem 3.4. Suppose Assumption 3.3 holds, s  {t - 1, t - 2}, and (d, c)  Dt  Ds . Then,

                              Pr(yi,t = d, yi,s = c | pi , yi,s-1 = c, xi = x)
exp 0 pc,d
       t,s  (x)                                                                 exp      20 + 0 pc,d
                                                                                                 t,s        (x) .
                              Pr(yi,t = c, yi,s = d | pi , yi,s-1 = c, xi = x)


Remark 3.5. Theorem 3.4 compares the probability of sequences that start at yi,s-1 = c and
go to (yi,s = c, yi,t = d) versus those that go to (yi,s = d, yi,t = c). Under the logit assumption,
both sequences have positive probability, and the first inequality provides upper [lower] bound
information on 0 when pc,d       t,s is positive [negative]. The second inequality yields lower bound
information on 0 , so together these inequalities provide a lower bound to 0 = 0 /0 .
    To obtain upper bound information on 0 , we incorporate the inequalities in Corollary 3.2.
For example, when pc,d                             d,c
                            t,t-1 < 0 and 1 (c, yi,t-2 ) > 0, the inequality in Corollary 3.2(a)
yields upper bound information on 0 , and the first logit inequality in Theorem 3.4 yields lower
bound information on 0 . Together these inequalities generate upper bound information on 0 .
If 1d,c (c, yi,t-2 ) > 0, then, regardless of the sign of pc,d   t,t-1 , Corollary 3.2(a) provides upper
bound information on 0 , which given the logit inequalities yields upper and lower bounds to 0 .


Remark 3.6. Theorem 3.4 does not exhaust the additional inequalities available when the distur-
bance distribution is logistic. For completeness, additional inequalities are stated as Theorem C.2
in Appendix C and cover the cases: (i) yi,s-1 = r      / {c, d}; and (ii) s < t - 2. In different
applications, these additional inequalities could be quite useful, but here they are relegated to the
appendix as our data does not have groups of sufficient size to exploit them.

                                                     20
4      Parametric Empirical Results.
Table 3 provides summary statistics for the data and inequalities used in the parametric analysis.
The only difference between the sample used for the non-parametric analysis (described in section
2.2) and that used in the parametric analysis, is that in the parametric analysis we keep groups
who face different plan offerings in the comparison periods (recall that our assumptions ruled this
out for the non-parametric analysis). This increases the size of the data set considerably. The
number of inequalities available for the parametric analysis is, on the other hand, much smaller
than in the non-parametric analysis.

                         Table 3: Summary Statistics for the Parametric Estimator


       (s, t)               Number of           Number of           Number of       Number of            Number of
                             Members              Groups             Members          Groups              Moments
                                                                       Above           Above
                                                                       Cutoff          Cutoff
       (2009,   2010)               59,322               100           32,738                 69               248
       (2009,   2011)               39,955               100           24,740                 78               296
       (2010,   2011)               59,629               100           34,300                 83               217
       (2012,   2013)               69,441               125           43,138                 99               522
       Total                       228,347               425          134,916                329             1,283
Notes: The cell size cutoff is 20.

    We begin with a subsection describing empirical findings from models that allow for state
dependence but not flexible fixed effects. This will enable us to compare the results from the
inequalities in section 3 to those from the point identified models that have been used to model
state dependence in prior work. All results, both from the comparison models and from the models
of section 3, assume that the distribution of the disturbances is logistic.10 Note that in this case the
distribution of the double difference of disturbances (for  d,c   t,s ) needed to form the inequalities
from Corollary 3.2 is analytic, which simplifies computation of those inequalities.11

4.1     Comparison Models: State Dependence Without Fixed Effects.
Table 4 summarizes the results from a number of specifications. The estimate of the switching cost
is always obtained as the ratio of the lagged dependent variable coefficient to the price coefficient.12
  10
     We have also done several of the comparison models assuming normal errors. These generated modestly higher
values for the state dependence coefficient.
  11
     That distribution and its density have analytic forms for the logit case, which are

                                   exp(y )(y - 1) + 1                exp(y )(exp(y )(y - 2) + y + 2)
                        F (y ) =                      , and f (y ) =                                 .
                                     (exp(y ) - 1)2                           (exp(y ) - 1)3

  12
    Its standard error is obtained from a Taylor expansion (i.e., the Delta method), which in this context should
be accurate as all the price coefficients are two or more orders of magnitude greater than their standard errors.
As in all discrete choice models the comparison models require a normalization. We normalize the variance of the
disturbance to one. So both the coefficient of price and of the lagged dependent variable should be thought of as
the variable's coefficient divided by this standard error.


                                                               21
                                         Table 4: Multinomial Logit Estimation

                               Simple        Plan        Plan ×       Detailed   Plan Dum.    + New Enr     + New Enr
                                           Dummies     Region Dum.   Plan Dum.     + RE      (Plan Dum.)   (Dum. + RE)
                                 (1)          (2)           (3)          (4)         (5)          (6)          (7)
 Normalize   i,j,t   to EV1
 Switching Cost ( )             -4.157       -4.234       -4.184       -4.184      -4.549       -4.028        -4.713
                               (0.008)      (0.009)      (0.010)      (0.010)     (0.015)      (0.006)       (0.010)
 Price Coefficient ( )         -0.0361      -0.0507       -0.0529      -0.0541     -0.0539     -0.0342        -0.0423
                              (0.0003)     (0.0003)      (0.0003)     (0.0003)    (0.0004)    (0.0001)       (0.0002)
 Normalize  to 1
 Switching Cost ( = / )        115.20       83.50         79.03        77.34       84.42       117.60         111.40
                               (0.75)       (0.43)        (0.41)       (0.40)      (0.43)      (0.44)         (0.43)
 Plan Dummies                     --          Yes          Yes          Yes         Yes          Yes           Yes
 Plan Dummies × Region           --            --          Yes          Yes         --           --             --
 × Area, Age-Sex, Illness        --            --           --          Yes          --           --            --
 Plan Random Effects             --            --           --           --         Yes           --           Yes
 N Plan Dummies + REs             0            5            22          247          9            5             10
 N Individuals × Years        1,457,682    1,457,682    1,457,682    1,457,682   1,457,682    4,255,857     4,255,857



    The first four columns of the table present results from specifications in which the individual-
specific fixed effects used in the inequality analysis are replaced with increasingly detailed interac-
tions of individual characteristics with plan dummies. Column (1) has no plan dummies; column
(2) has simple plan dummies; column (3) interacts the plan dummies with region; and column
(4) interacts them with twenty age-sex groups, with thirty eight geographic areas ("service areas"
determined by the state), and with three chronic illness groups (where the three sets of interac-
tions are additively separable). After excluding interactions with no observations, this generates
247 dummy variables. The switching cost estimate declines monotonically as we add interactions,
from $115.20 (0.75) to $77.34 (0.40), where here and below the numbers in parentheses are stan-
dard errors. Notably, these estimates of 0 are all substantially larger than the upper bound of
$57 generated by the non-parametric P&P inequalities.
    Next we replace the fixed effects in the inequality analysis with random effects. That is we
interact the plan dummies with agent-specific independent normal random variables that are held
constant over the period the individual is observed, and use simulated maximum likelihood to
estimate. We begin the random effect analysis by allowing for random effects conditional on the
first observed choice. So this analysis assumes both that: (i) the within group variance in the
plan specific effects is normal with variances that vary by plan (but not by group), and (ii) is
uncorrelated with the initial observed choice. This mimics what researchers have done in related
problems when they do not have sufficient information on the actual initial choices of individuals.
The results from this specification are provided in column (5) of the table. The random effects
model generates a switching cost of $84.42 (0.43), and estimated dummy variables for the plan
and standard errors for the random effects which are both highly significant (the t-values for the
standard errors varied from eight to over fifty), for all but the smallest plan (Fallon).
    We are in the enviable position of knowing the first time a consumer enters the Massachusetts
exchange. So provided we are willing to assume that any pre-exchange health choice of these indi-
viduals does not influence their behavior on the exchange, we can implement an "initial conditions
estimator" that allows for normal random draws on preferences for the exchange's plans that are
known to the consumers before making their first choice. Column (7) provides the simulated max-

                                                               22
imum likelihood estimates for this specification.13 Since column (7) adds the first choice to the
switching choices analyzed in columns (1) to (5), it uses a different data set than those columns
did. So for comparison column (6) uses the column (7) data in a model without random effects;
i.e. column (6) mimics column (2) but uses the data set used in column (7).
     When we include initial choices and simple plan dummies (but no random effects) in column (6),
our estimated switching cost is $117.60 (0.44), noticeably larger than in the analogous specification
without initial choices (column (2)). When we also include random effects in column (7), the plan
dummies and the estimated standard deviations of the random effects for all plans are estimated
to be even larger than those from column (5), with t-values for the estimated variances of the
plan specific random effects for all plans (including Fallon) now ranging from twelve to over one
hundred. Perhaps more surprising is that the estimates of 0 in both columns (6) and (7) are
quite similar at $117.60 (0.44) and $111.40 (0.43). One interpretation of this in light of the finding
of a lower estimate of 0 in column (5) is that due to the experience they had in making health
insurance choices before entering CommCare, consumers priors when entering the program were
that plans differed in their coverage, out of pocket payments, and the like. After entering they
learn that regulation requires these features to not vary across plans. As a result they become
more price sensitive14 .
     We conclude that models that do not allow for individual by product fixed effects generate
estimates of 0 that lie somewhere between $77 and $118. This accords well with published work
on this data which generates estimates of about $100 (see Shepard (2020)). Recall from Figure 1
that average monthly premiums ranged from $20 to $90. So the models without fixed effect generate
switching costs which are four to five times the average monthly premium for the lowest cost plan
and about equal to the average monthly premium for the highest cost plan. These estimates are
noticeably larger than the non-parametric upper bound obtained from the P&P analysis. One
question that remains is how much of the difference can be attributed to the logit assumption and
how much to the absence of fixed effects.

4.2     Parametric Inequality Estimators: State Dependence with Fixed
        Effects.
This subsection uses the inequalities from Corollary 3.2 and Theorem 3.4, and the sample described
in Table 3 (also used in columns (1) to (5) of Table 4), to estimate bounds on 0 . This generates
over 1,200 inequalities from about 330 groups with an average size of over 400 individuals.
    When we used the estimation algorithm described in section 2.2 for the current specification, the
simulated value of the test statistic obtained from the normal approximation to the distribution of
the moments often implied probabilities that were negative, rendering the assumptions underlying
that asymptotic approximation inappropriate. We present the point estimate from that estimation
algorithm but do not want to rely on its simulated test statistics for inference. Instead we use the
Bayesian approach proposed by Kline and Tamer (2020) with the implementation in Chamberlain
  13
     We also tried to use the estimator suggested by Honor´   e and Kyriazidou (2000), an estimator which does allow
for both fixed effects and switching costs. However, their method requires observing four-period sequences in which
a person switches plans, followed by two periods in which both choice sets and plan attributes (here, prices) are
unchanged. Even though our data contains observation on 623,000 individuals making 1,877,000 individual choices,
these restrictions are quite limiting because the data include frequent price and choice set changes. Imposing the
restrictions the Honore and Kyriazadou estimator requires leaves us with data on 36 individuals and 144 choices.
This is simply not enough data to obtain estimates with reasonable precision.
  14
     For a model with fixed effects that explicitly allows for Bayesian learning see Aguirregabiria et al. (2021).


                                                        23
and Imbens (2003). This combines an uninformative prior with the data to generate a posterior
distribution for the probabilities.15 We then take draws from this posterior, calculate the (possibly
set-valued) estimate of the parameters that minimizes the sup-norm of the negative part of the
inequalities for each draw, and then find a conservative 95 percent confidence set for 0 , 0 , and
separately for 0  0 /0 .




                  Figure 5: Identified set and Bayesian confidence set for 0 and 0 .

Notes: Cell level moments based on revealed preference and magic of logit inequalities are constructed, and then
aggregated into groups.

    The results are plotted in (,  ) space in Figure 5. The point estimate from minimizing the
largest of the negative parts of the moments is given by the dark blue dot. The 95% confidence
sets for 0 , 0 and linear combinations of the two are obtained from the 2.5% and 97.5% quantiles
of the distribution of their lower and upper bounds found from the posterior draws. The accepted
(0 , 0 ) combinations are given by the area interior to the shape produced by the blue dots in the
figure. The (0 , 0 ) combinations that generated the lower and upper P&P bounds for 0 are given
by the dashed grey lines.
    The "point estimate" of 0 from the moment minimization problem was      ^ =$48. The Bayesian
  15
     Treating the choice probabilities for each cell as a multinomial distribution, Chamberlain and Imbens (2003)
show that the Dirichlet distribution with parameters set to the observed frequencies is the posterior distribution
for the multinomial distribution with uninformative Dirichlet prior. Since the parameter identified set is a simple
transformation of the cell probabilities (reduced form parameters), we form a credible set for the identified set by
straightforward simulation from the Dirichlet posterior, following Kline and Tamer (2020). Given the large number
of inequalities, when a simulated draw of probabilities generates an empty identified set, we conservatively include
the parameter value(s) that minimize the criterion based on the worst violation of the inequalities. Kline and Tamer
(2020) show the asymptotic connection to a frequentist confidence interpretation of the resulting intervals.


                                                        24
bootstrap produces a 95% credible interval of (^   = $32,   ^ = $56). Recall that the lower bound
from the P&P estimates was $20, so the parametric assumptions lead to a considerably tighter
lower bound. The upper bound, on the other hand, is almost identical to the upper bound of $57
we obtained from the P&P estimates that used the sample selected on the basis of exogenous price
movements.
    The lower bound is 30 to 40% of the estimates of 0 obtained from the comparison models in
section 4.1 that do not allow for flexible fixed effects and the upper bound is 50 to 70% of those
estimates. So the comparison models seem to overestimate the switching cost by a considerable
amount. We turn next to an investigation of whether this difference is likely to influence the
economic implications of the estimated models.

Counterfactual Comparisons. We now explore whether the difference between the 0 bounds
obtained from the inequality estimator, and the 0 estimates obtained from the comparison models
that allow for state dependence but not individual-by-product specific fixed effects, is likely to have
economically important implications for a counterfactual of interest. BMC, the largest plan with
over a third of the market in 2011 (see Table 2), increased its relative price dramatically in 2012
and then decreased it by an even greater amount in 2013. We consider predictions for what would
have happened had they instead kept their price constant at the average of the 2012 and 2013
prices in those two years.
    The calculation conditions on the 2011 choices of enrolled individuals. We then predict BMC's
market share in 2012 twice; once using the actual and once the counterfactual prices. Finally,
we use these predictions and the actual and counterfactual prices in 2013 to obtain the predicted
shares from the counterfactual policy for the two year period from 2011-2013. The predictions
for these sequences are done in pairs, one of which uses the (0 , 0 ) estimates from a comparison
model in Table 4, the other uses the 0 estimate from the relevant comparison model but restricts
 to equal     ^ where    ^ = $48.28, as in Figure 5. The latter need not equal what our model
would predict, as that would require either a model or bounds for the {i,d }i,d . Still the difference
between the two predictions should provide an indication of whether the implications of a model
that allowed for fixed effects are likely to be different than a model which does not.
    Table 5 provides the results. The bottom row shows that the average BMC premiums, averaged
over all incumbent enrollees who were not in the below-poverty group (and hence paid premiums),
was $58.4 per month in 2011. In 2012 that average increased to $91.1, and in 2013 it fell to
$41.5; the changes that generated the sharp spike in the price plot in Figure 1. We consider
counterfactual prices that equal the average of the prices in 2012 and 2013 in each income group,
and then maintains that price in both years. That results in an average price of $63 in 2012 and
$65 in 2013 (with the slight difference coming from changes in the relative size of different income
groups in the two years).
    The actual predictions differ somewhat between the pairs defined by the comparison models
but their qualitative nature does not. The fall in price in 2012 from the $91.1 to $63 leads to
a prediction of an 11% to 15% increase in share when we use the parameters estimated by the
comparison models, but a prediction of a dramatic 53% to 67% increase in share when we constrain
^ = 48.28. In 2013 when the counterfactual average price was $65 compared to the actual average

price of $41.5 , the estimates from the comparison models predict an 8 to 14% higher share from
the higher counterfactual price. In contrast when we use     ^ = 48.28 the higher counterfactual price
in 2013 generates a two period prediction of a 17 to 20% lower share than the prediction from the
status quo prices.
    Recall that this is the prediction for 2013 which conditions on 2011 shares and the counterfactual

                                                  25
prices in both 2012 and 2013. The comparison models do predict the shares fall from 2012 to 2013
(by 1 to 2%). However because the comparison models' estimates of 0 are so high, this decrease
is more than offset by the comparison model's increased share in 2012. That is, the impact of
the higher 0 estimates in the comparison models' prediction in any one year spills over to the
following years, making longer term predictions particularly problematic.

                                          Table 5: Counterfactual Comparisons

                                  2011                         2012                                   2013
         Specification        market shares     status-quo   counterfactual   % diff   status-quo   counterfactual   % diff

    Market shares without imposing 

             Plan FE              0.357             0.289            0.321     11.0        0.266            0.304     14.2
    Plan × Region FE              0.357             0.289            0.320     10.6        0.266            0.298     12.2
       Plan FE + RE               0.357             0.282            0.324     15.1        0.289            0.311      7.6

    Market shares imposing 

             Plan FE              0.357             0.186            0.306     64.1        0.399            0.326    -18.3
    Plan × Region FE              0.357             0.205            0.313     52.8        0.381            0.318    -16.6
       Plan FE + RE               0.357             0.183            0.305     66.8        0.410            0.329    -19.7

        Premium                   58.4                91.1             62.9                  41.5             65.3

Note: Table shows a counterfactual comparison of BMC market shares among current enrollees above 100% FPL.
The top panel shows observed market shares in 2011, and then predicted market shares under status-quo premium
and counterfactual premium, as well as their percentage difference in 2012 and 2013. We include results based
on two FE specifications and one random coefficient specification. "Imposing " indicates whether we restrict the
switching cost coefficient. The bottom panel shows the average BMC premium under status-quo and counterfactual
in 2011-2013.




5      What Have We Learned?
We have provided both empirical results on switching costs in health insurance choices and method-
ological results on estimating models with individual by choice specific fixed effects and state
dependence.
    Our empirical results indicate that health insurance estimates of state dependence that do not
allow for very flexible unobserved heterogeneity seem to seriously bias estimates of switching costs
upwards; in our data by a factor of 50-130 percent. We found this regardless of whether the model
without individual by product specific fixed effects allows for a rich set of plan interactions, random
effects conditional on the initial choice, or random effects known prior to the initial choice. Rather,
it appears important to allow for flexible individual-level preferences, likely because of the very
heterogeneous way that similar consumers value plan provider networks (the key plan attribute in
our context). For instance, people may care very strongly about whether their current doctor or
hospital is covered in a given plan (Shepard, 2020; Tilipman, 2020), an individual-by-plan specific
match factor that is not likely to be captured with coarse plan interactions. Our counterfactual,
the reversal of what seems to be a failed pricing experiment by the largest insurer, illustrated that
the difference in estimated switching costs matters. The comparison models' predicted a one year
share change of 10-15% while when we use our estimate of  we find a share change of 55-65%.
Moreover the analogous predicted differences for the share change over the two years that includes

                                                               26
the insurer's policy reversal actually differ in sign; so longer-term predictions using the comparison
models'  estimates can be particularly problematic.
    Our methodological results on estimators that allow for both state dependence and fixed effects
depend on what the researcher is willing to assume on the distribution of the disturbances. If one
does not want to assume a parametric distribution for and switching probabilities are less than a
half, then finite positive bounds for 0 , the ratio of price sensitivity to switching costs, are obtained
employing the stationarity assumption in P&P. If switching probabilities are greater than a half,
then revealed preference inequalities can be used to bound 0 either without, or if one is willing
to make the stationarity assumption, in concert with, the P&P inequalities. If we are willing
to make a parametric assumption on the distribution, then it is possible to get finite positive
bounds without switching probabilities that are greater than a half from revealed preference. And,
if the specified distribution is the logistic (or Gumbel) distribution then there will be positive
finite upper and lower bounds. Moreover the estimators obtained from the logisitic distribution
are exceptionally easy to compute.



References
Abbring, J. H., J. J. Heckman, P.-A. Chiappori, and J. Pinquet (2003): "Adverse
 Selection and Moral Hazard in Insurance: Can Dynamic Data Help to Distinguish?" Journal of
 the European Economic Association, 1, 512­521.

Aguirregabiria, V., J. Gu, and Y. Luo (2021): "Sufficient statistics for unobserved hetero-
 geneity in structural dynamic logit models," Journal of Econometrics.

Armstrong, T. B. (2014): "Weighted KS statistics for Inference on Conditional Moment In-
 equalities," Journal of Econometrics, 181, 92­116.

Chamberlain, G. (1980): "Analysis of Covariance with Qualitative Data," The Review of Eco-
 nomic Studies, 47, 225­238.

Chamberlain, G. and G. W. Imbens (2003): "Nonparametric Applications of Bayesian Infer-
 ence," Journal of Business & Economic Statistics, 21, 12­18.

Chernozhukov, V., I. Ferna    ´ ndez-Val, J. Hahn, and W. Newey (2013): "Average and
 Quantile Effects in Nonseparable Panel Models," Econometrica, 81, 535­580.

Conley, T. G. and C. R. Udry (2010): "Learning About a New Technology: Pineapple in
 Ghana," American Economic Review, 100, 35­69.

Dafny, L., K. Ho, and M. Varela (2013): "Let Them Have Choice: Gains from Shifting Away
 from Employer-Sponsored Health Insurance and Toward an Individual Exchange," American
 Economic Journal: Economic Policy, 5, 32­58.

Ericson, K. M. M. (2014): "Consumer Inertia and Firm Pricing in the Medicare Part D Pre-
 scription Drug Insurance Exchange," American Economic Journal: Economic Policy, 6, 38­64.

Finkelstein, A., N. Hendren, and M. Shepard (2019): "Subsidizing Health Insurance for
  Low-income Adults: Evidence from Massachusetts," American Economic Review, 109, 1530­67.

                                                   27
Fox, J. (2007): "Semiparametric Estimation of Multinomial Discrete-Choice Models using a
 Subset of Choices," The RAND Journal of Economics, 38, 1002­1019.

Handel, B. R. (2013): "Adverse Selection and Inertia in Health Insurance Markets: When
 Nudging Hurts," American Economic Review, 103, 2643­82.

Heckman, J. (1978): "Simple Statistical Models for Discrete Panel Data Developed and Applied
 to Test the Hypothesis of True State Dependence against the Hypothesis of Spurious State
 Dependence," Annales de l'ins´e, Apr­Sep, 227­269.
                              e´

Heckman, J. J. (1981): "Heterogeneity and State Dependence," in Studies in Labor Markets,
 University of Chicago Press, 91­140.

Ho, K., J. Hogan, and F. Scott Morton (2017): "The Impact of Consumer Inattention
 on Insurer Pricing in the Medicare Part D Program," The RAND Journal of Economics, 48,
 877­905.
     ´, B. E. and E. Kyriazidou (2000): "Panel Data Discrete Choice Models with Lagged
Honore
 Dependent Variables," Econometrica, 68, 839­874.

Honore´, B. E. and E. Tamer (2006): "Bounds on Parameters in Panel Dynamic Discrete
 Choice Models," Econometrica, 74, 611­629.

Honore´, B. E. and M. Weidner (2020): "Moment Conditions for Dynamic Panel Logit Models
 with Fixed Effects," Tech. rep.

Keane, M. P. (1997): "Modeling Heterogeneity and State Dependence in Consumer Choice
 Behavior," Journal of Business & Economic Statistics, 15, 310­327.

Khan, S., F. Ouyang, and E. Tamer (forthcoming): "Inference on Semiparametric Multino-
 mial Response Models," Quantitative Economics.

Khan, S., M. Ponomareva, and E. Tamer (2020): "Identification of Dynamic Binary Re-
 sponse Models," Tech. rep., Working Paper.

Kline, B. and E. Tamer (2020): "Bayesian Inference in a Class of Partially Identified Models,"
 Quantitative Economics, 7, 329­366.

Kroft, K., F. Lange, and M. J. Notowidigdo (2013): "Duration Dependence and Labor
 Market Conditions: Evidence from a Field Experiment," The Quarterly Journal of Economics,
 128, 1123­1167.

Manski, C. (1975): "Maximum Score Estimation of the Stochastic Utility Model of Choice,"
 Journal of Econometrics, 3, 205­228.

Manski, C. F. (1987): "Semiparametric Analysis of Random Effects Linear Models from Binary
 Panel Data," Econometrica, 357­362.

McIntyre, A., M. Shepard, and M. Wagner (2021): "Can Automatic Retention Improve
 Health Insurance Market Outcomes?" Tech. rep., Harvard University Working Paper.



                                             28
Pakes, A. and J. Porter (2016): "Moment Inequalities for Multinomial Choice with Fixed
  Effects," Tech. rep., National Bureau of Economic Research.

Polyakova, M. (2016): "Regulation of Insurance with Adverse Selection and Switching Costs:
 Evidence from Medicare Part D," American Economic Journal: Applied Economics, 8, 165­95.

Romano, J. P., A. M. Shaikh, and M. Wolf (2014): "A Practical Two-Step Method for
 Testing Moment Inequalities," Econometrica, 82, 1979­2002.

Samuelson, P. A. (1938): "A Note on the Pure Theory of Consumer's Behaviour," Economica,
  5, 61­71.

Shepard, M. (2020): "Hospital Network Competition and Adverse Selection: Evidence from the
  Massachusetts Health Insurance Exchange," Tech. rep., Harvard University Working Paper.

Shi, X., M. Shum, and W. Song (2018): "Estimating Semi-Parametric Panel Multinomial
  Choice Models Using Cyclic Monotonicity," Econometrica, 86, 737­761.

Shin, S., S. Misra, and D. Horsky (2012): "Disentangling Preferences and Learning in Brand
  Choice Models," Marketing Science, 31, 115­137.

Sorensen, A. T. (2006): "Social Learning and Health Plan Choice," The Rand Journal of
  Economics, 37, 929­945.

Tebaldi, P., A. Torgovitsky, and H. Yang (2019): "Nonparametric estimates of demand
 in the california health insurance exchange," Tech. rep., National Bureau of Economic Research.

Tilipman, N. (2020): "Employer Incentives and Distortions in Health Insurance Design: Impli-
  cations for Welfare and Costs," Tech. rep., Working Paper.

Torgovitsky, A. (2019): "Nonparametric inference on state dependence in unemployment,"
 Econometrica, 87, 1475­1505.

Yan, J. (2013): "A Smoothed Maximum Score Estimator for Multinomial Discrete Choice Mod-
 els," University of Wisconsin Working Paper.




                                              29
Appendix

A      Plan Hospital Networks

                                               Figure 6: Hospital Coverage in Massachusetts Exchange Plans
                              1




                                                                       NHP
                                                                                                                BMC
                                          .8
               Share of Hospitals Covered




                                                                                                        Network Health
                                 .6




                                                                   CeltiCare
                      .4      .2




                                                      Fallon
                                                (Central Mass.)
                              0




                                               2009            2010           2011          2012               2013            2014
                                                                                  Fiscal Year

NOTE: The graph shows the shares of Massachusetts hospitals covered by each CommCare plan, where shares
are weighted by hospital bed size in 2011. Fallon's hospital coverage share is much lower than other plans largely
because it mainly operates in central Massachusetts and therefore does not have a statewide network. The large
decline in Network Health's network size in 2012 reflects its dropping of the Partners Healthcare System and several
other providers from its network.




B      Revealed Preferences Cases
Below we graphically display the information on the parameters (0 , 0 ) contained in Corollary 3.2.
Given y, define
                              d,c -1
                           (Ft,s )   1-                           d,c
                                                               r:yt,s (r,yi,s-1 )y   Pr(yi,t = d, yi,t-1 = r, yi,s = c|z, yi,s-1 ); 
            
          q =
                                                                                        (xi )
                                                              d,c
Figure 7 [8] considers the case where q  > 0 [< 0]. If Ft,s       (0) = 0.5, then the case q  > 0 [< 0]
corresponds to r:yd,c (r,yi,s-1 )y Pr(yi,t = d, yi,t-1 = r, yi,s = c|z, yi,s-1 ) < 0.5 [ > 0.5].
                                                      t,s




                                                                                     30
                          Figure 7: Corollary 3.2 Inequalities for q  > 0

                                        y>0                          y<0                         y=0


                                                                                              


                              q
                               y


           pd,c
            t,s > 0
                                                                                                                 
                                              q                                                          q
                                              pd,c              q                                        pd,c
                                                                                                           t,s
                                                t,s
                                                                 y




                                                                                              




           pd,c
            t,s < 0
                              q
                               y
                                                                                                                 
                                                                                      q
                                                           q                          pd,c
                                                                                        t,s
                                                            y




   Two cases in Figure 7 corresponding to pd,c      t,s < 0 and y  0 are uninformative. For these
cases, the whole first quadrant satisfies the inequality. In our empirical work, we use the remaining
four cases to inform bound on 0 . As noted previously, the case q  < 0 does not occur in the
empirical work, so we do not make use of the cases in Figure 8.

                          Figure 8: Corollary 3.2 Inequalities for q  < 0

                                        y>0                          y<0                         y=0


                                                                                              




           pd,c
            t,s > 0
                                                           q
                                                            y
                                                                                                                 
                                                                                      q
                              q                                                       pd,c
                                                                                        t,s
                               y




                                                                                              


                                                           q
                                                            y


           pd,c
            t,s   <0
                                                                                                                 
                                                      1                    q                     q
                                   q                                       pd,c
                                                                             t,s                 pd,c
                                                                                                   t,s
                                    y




                                                      31
C        Proofs
Proof of Lemma 2.2:

      For all c  D0 , d  D0 ,

              (-pc,i,s - 1{yi,s-1 = c}0 ) i - (-pd,i,s - 1{yi,s-1 = d}0 ) i + (c,i - d,i )
                 (-pc,i,t - 1{yi,t-1 = c}0 ) i - (-pd,i,t - 1{yi,t-1 = d}0 ) i + (c,i - d,i )
Hence,

  i,s d,i,s  max [(-pc,i,s - 1{yi,s-1 = c}0 ) i - (-pd,i,s - 1{yi,s-1 = d}0 ) i + (c,i - d,i ) + c,i,s ]
                 cD0


          i,t d,i,t  max [(-pc,i,t - 1{yi,t-1 = c}0 ) i - (-pd,i,t - 1{yi,t-1 = d}0 ) i + (c,i - d,i ) + c,i,t ]
                         cD0


  =       i,t (-pd,i,t - 1{yi,t-1 = d}0 ) i + d,i + d,i,t  max [(-pc,i,t - 1{yi,t-1 = c}0 ) i + c,i + c,i,t ]
                                                                        cD0

So,
Pr(yi,t  D0 | pi , yi,t-1 , i , i )

  = Pr              i,t (-pd,i,t - 1{yi,t-1 = d}0 ) i + d,i + d,i,t
             dD0

                        max [(-pc,i,t - 1{yi,t-1 = c}0 ) i + c,i + c,i,t ]                i , i
                          cD0


   Pr               i,s (-pd,i,s - 1{yi,s-1 = d}0 ) i + d,i + d,i,s
             dD0

                      max [(-pc,i,s - 1{yi,s-1 = c}0 ) i + c,i + c,i,s ]                 i , i
                         cD0

  = Pr(yi,s  D0 | pi , yi,s-1 , i , i )
   In the second and third probabilities, the terms pi,t , pi,s , yi,t-1 , and yi,s-1 denote the realized
value of the price variable and lagged dependent variable from the conditioning statement.

Proof of Theorem 2.4:

(a) The supposition of Lemma 2.2 is satisfied for D0 and yi,t-1 = d for any d  D0 . Hence,
             Pr(yi,t  D0 , yi,t-1  D0 | pi , yi,t-2 , i , i )
                =           Pr(yi,t  D0 , yi,t-1 = d | pi , yi,t-2 , i , i )
                     d D0

                =           Pr(yi,t  D0 | pi , yi,t-1 = d , i , i ) · Pr(yi,t-1 = d | pi , yi,t-2 , i , i )
                     d D0

                            Pr(yi,t-1  D0 | pi , yi,t-2 , i , i ) · Pr(yi,t-1 = d | pi , yi,t-2 , i , i )
                     d D0

                = [Pr(yi,t-1  D0 | pi , yi,t-2 , i , i )]2

                                                           32
Next, apply Jensen's Inequality to integrate out (i , i ).

                     Pr(yi,t  D0 , yi,t-1  D0 | pi , yi,t-2 )
                      = E [ Pr(yi,t  D0 , yi,t-1  D0 | pi , yi,t-2 , i , i ) | pi , yi,t-2 ]
                       E [Pr(yi,t-1  D0 | pi , yi,t-2 , i , i )]2 | pi , yi,t-2
                        [E [ Pr(yi,t-1  D0 | pi , yi,t-2 , i , i ) | pi , yi,t-2 ]]2
                       = [Pr(yi,t-1  D0 | pi , yi,t-2 )]2

(b) s < t - 1.
The supposition of Lemma 2.2 is satisfied for D0 and yi,t-1 = d for any d  D1 . Hence,

      Pr(yi,t  D0 , yi,t-1  D1 , yi,s  D0 | pi , yi,s-1 , i , i )
        =          Pr(yi,t  D0 , yi,t-1 = d , yi,s  D0 | pi , yi,s-1 , i , i )
            d D1

        =          Pr(yi,t  D0 | pi , yi,t-1 = d , i , i ) · Pr(yi,t-1 = d , yi,s  D0 | pi , yi,s-1 , i , i )
            d D1

                   Pr(yi,s  D0 | pi , yi,s-1 , i , i ) · Pr(yi,t-1 = d , yi,s  D0 | pi , yi,s-1 , i , i )
            d D1
        = Pr(yi,s  D0 | pi , yi,s-1 , i , i ) · Pr(yi,t-1  D1 , yi,s  D0 | pi , yi,s-1 , i , i )
         [Pr(yi,t-1  D1 , yi,s  D0 | pi , yi,s-1 , i , i )]2


Next, apply Jensen's Inequality to integrate out (i , i ).

               Pr(yi,t  D0 , yi,t-1  D1 , yi,s  D0 | pi , yi,s-1 )
                = E [Pr(yi,t  D0 , yi,t-1  D1 , yi,s  D0 | pi , yi,s-1 , i , i ) | pi , yi,s-1 ]
                 E Pr(yi,t-1  D1 , yi,s  D0 | pi , yi,s-1 , i , i )2 | pi , yi,s-1
                   (E [Pr(yi,t-1  D1 , yi,s  D0 | pi , yi,s-1 , i , i ) | pi , yi,s-1 ])2
                  = [Pr(yi,t-1  D1 , yi,s  D0 | pi , yi,s-1 )]2


Proof of Theorem 2.6:

(a)

A       (i,t , i,t-1 ) | (-pd,i,t - 1{c = d}0 ) i + d,i + d,i,t  max (-pd ,i,t - 1{c = d }0 ) i + d ,i + d ,i,t ,
                                                                        d =d


      (-pc,i,t-1 - 1{yi,t-2 = c}0 ) i + c,i + c,i,t-1  max (-pc ,i,t-1 - 1{yi,t-2 = c }0 ) i + c ,i + c ,i,t-1
                                                                 c =c


       (i,t , i,t-1 ) | (-pd,i,t - 0 ) i + d,i + d,i,t  (-pc,i,t ) i + c,i + c,i,t ,

       (-pc,i,t-1 - 1{yi,t-2 = c}0 ) i + c,i + c,i,t-1  (-pd,i,t-1 - 1{yi,t-2 = d}0 ) i + d,i + d,i,t-1

       (i,t , i,t-1 ) | d,c       d,c          d,c
                        i,t,t-1  pi,t,t-1 + 0 1 (c, yi,t-2 )) i ,



                                                        33
   which implies


       Pr(yi,t = d, yi,t-1 = c | pi , yi,t-2 , i , i )  Pr((i,t , i,t-1 )  A | pi , yi,t-2 , i , i )
          Pr(d,c       d,c          d,c
             i,t,t-1  pi,t,t-1 + 0 1 (c, yi,t-2 )) i | pi , yi,t-2 , i , i )


   Integrate both sides with respect to the conditional distribution of i , and the result follows.

(b) s < t - 1.
Define
                             d,c
                            Bt,s (p, y, i ) =       (i,t , i,s ) | d,c
                                                                   i,t,s  (p + 0 y)i

                     d,c
and note that since Ft,s denotes the c.d.f. of the conditional distribution of d,c
                                                                               i,t,s

                                        d,c                                   d,c
                      Pr((i,t , i,s )  Bt,s (p, y) | pi , yi,s-1 , i ) = 1 - Ft,s ((p + 0 y)i )

where p, y are constant values or functions of the conditioning set.
  Using the same argument as in (a),

A(r) =       (i,t , i,s ) | (-pd,i,t - 1{r = d}0 ) i + d,i + d,i,t  max (-pd ,i,t - 1{r = d }0 ) i + d ,i + d ,i,t ,
                                                                                  d =d


            (-pc,i,s - 1{yi,s-1 = c}0 ) i + c,i + c,i,s  max (-pc ,i,s - 1{yi,s-1 = c }0 ) i + c ,i + c ,i,s
                                                                         c =c


             (i,t , i,s ) | d,c     d,c        d,c
                            i,t,s  pi,t,s + 0 1 (r, yi,s-1 ) i

         d,c
      = Bt,s (pd,c      d,c
               i,t,s , 1 (r, yi,s-1 ), i )

                                     d,c               d,c
   Note that if 0  0 and y  y, then Bt,s (p, y , i )  Bt,s (p, y, i ). It follows that for any r such
         d,c                     d,c      d,c
that 1 (r, yi,s-1 )  y, A(r)  Bt,s (pi,t,s , y, i ). And so,

                                                               d,c
                                                        A(r)  Bt,s (pd,c
                                                                     i,t,s , y, i )
                                 r:1d,c (r,yi,s-1 )y




                                     Pr(yt = d, yt-1 = r, ys = c | pi , yi,s-1 , i , i )
            r:1d,c (r,y   i,s-1 )y


                                           Pr({(i,t , i,s )  A(r)}  {yi,t-1 = r} | pi , yi,s-1 , i , i )
                     r:1d,c (r,yi,s-1 )y


                  Pr (i,t , i,s )                                A(r) | pi , yi,s-1 , i , i
                                           r:1d,c (r,yi,s-1 )y
                                    d,c
                  Pr((i,t , i,s )  Bt,s (pd,c
                                          i,t,s , y, i ) | pi , yi,s-1 , i , i )                           (C.1)

The conclusion of part (b) follows by integrating out both sides of the inequality with respect to
the conditional distribution of i .

                                                            34
Proof of Corollary 2.7:
The supposition in part (a) implies that Pr(yi,t = d, yi,t-1 = c | pi , yi,t-2 , i )  0.5 for some i .
The assumptions of the corollary then lead immediately to the conclusion by Theorem 2.6. Part
(b) follows similarly.


Lemma C.1.           (a) Let Mt (c, i ) =        rDt   exp[(-0 pr,t - 0 1{c = r}) (x) + r,i ]. For any c, d,
                                                          Mt (d, i )
                                            e-0  (x)                  e0  (x)
                                                          Mt (c, i )
                                                 exp[-0 (1{r=d}+1{c=r }) (x)-0 pr   ,i,s+1  (x)+r ,i )
  (b) Let St,s (d, c, i ) = rDt-1 ,r Ds+1                           Mt (r,i )
                                                                                                         Pr(yi,t-1 = r | pi , yi,s+1 =
      r , xi = x, i ). For any c, d,
                                                         St,s (d, c, i )
                                         e-20  (x)                        e20  (x)
                                                         St,s (c, d, i )

Proof of Lemma C.1:
(a) For any c, d, r, -1 - 1{c = r}  -1{d = r}  1 - 1{c = r}, and so

e-0  (x) Mt (c, i ) =             e0  (x)(-1-1{c=r}) exp[-0 pr,t  (x) + r,i ]
                            rDt

                                  e0  (x)(-1{d=r}) exp[-0 pr,t  (x) + r,i ]
                            rDt

                       = Mt (d, i )                e0  (x)(1-1{c=r}) exp[-0 pr,t  (x) + r,i ] = e0  (x) Mt (c, i )
                                             rDt

Result (a) follows.

(b) For any c, d, r, r ,
-2 - 1{r = c} - 1{d = r }  -1{r = d} - 1{c = r }  2 - 1{r = c} - 1{d = r }.
Hence,
e-20  (x) St,s (c, d, i )
                        e0 (-2-1{r=c}-1{d=r }) (x) e-0 pr ,i,s+1  (x)+r ,i
  =                                                                        Pr(yi,t-1 = r | pi , yi,s+1 = r , xi = x, i )
       rDt-1 ,r Ds+1
                                         Mt (r, i )
                        e0 (-1{r=d}-1{c=r }) (x) e-0 pr ,i,s+1  (x)+r ,i
                                                                         Pr(yi,t-1 = r | pi , yi,s+1 = r , xi = x, i )
       rDt-1 ,r Ds+1
                                        Mt (r, i )
  = St,s (d, c, i )
                        e0 (2-1{r=c}-1{d=r }) (x) e-0 pr ,i,s+1  (x)+r ,i
                                                                          Pr(yi,t-1 = r | pi , yi,s+1 = r , xi = x, i )
       rDt-1 ,r Ds+1
                                         Mt (r, i )

   e20  (x) St,s (c, d, i )
and (b) follows.

The following theorem extends the results in Theorem 3.4.

                                                          35
Theorem C.2. Suppose Assumption 3.3 holds, and (d, c)  Dt  Ds . Let  = 1{r = c}, and
       1 if s = t - 1 or t - 2
=
       3 if s < t - 2
Then, for s  t - 1 and r = d,
                                                                                           c,d
               Pr(yi,t = c, yi,s = d | pi , yi,s-1 = r, xi = x) e( -)0  (x) e0 (pt,s ) (x)

                        Pr(yi,t = d, yi,s = c | pi , yi,s-1 = r, xi = x)
                                                                                                    c,d
                        Pr(yi,t = c, yi,s = d | pi , yi,s-1 = r, xi = x) e( +)0  (x) e0 (pt,s ) (x)

Remark C.3. The case r = d is implied by the case r = c.

Proof of Theorem C.2:
(i) s = t - 1.

               Pr(yi,t = d, yi,t-1 = c | pi , yi,t-2 , xi = x, i )

                 = Pr(yi,t = d | pi , yi,t-1 = c, xi = x, i ) Pr(yi,t-1 = c | pi , yi,t-2 , xi = x, i )

                      e(-0 pd,i,t -0 1{c=d}) (x)+d,i e(-0 pc,i,t-1 -0 1{yi,t-2 =c}) (x)+c,i
                 =
                                Mt (c, i )                    Mt-1 (yi,t-2 , i )

                      e-0 pd,i,t  (x) e(-0 pc,i,t-1 -0 1{yi,t-2 =c}) (x) e-0 1{c=d} (x) ed,i +c,i
                 =
                                            Mt (c, i )Mt-1 (yi,t-2 , i )

   Similarly, for Pr(yi,t = c, yi,t-1 = d | pi , yi,t-2 , xi = x, i ).
   So,

     Pr(yi,t = d, yi,t-1 = c | pi , yi,t-2 , xi = x, i )   e-0 pd,i,t  (x) e(-0 pc,i,t-1 -0 1{yi,t-2 =c}) (x) Mt (d, i )
                                                         = -0 p  (x) (-0 p
     Pr(yi,t = c, yi,t-1 = d | pi , yi,t-2 , xi = x, i )   e    c,i,t     e      d,i,t-1 -0 1{yi,t-2 =d}) (x) M (c,  )
                                                                                                               t     i
                                                                                                        Mt (d, i )
      = exp -0 pd,c          i,t,t-1  (x) exp [-0 (1{yi,t-2 = c} - 1{yi,t-2 = d})  (x)]
                                                                                                        Mt (c, i )



   By Lemma C.1,
                                                                           d,c
 Pr(yi,t = c, yi,t-1 = d | pi , yi,t-2 , xi = x, i ) e-0  (x) e-0 (pi,t,t-1 ) (x) e-0 (1{yi,t-2 =c}-1{yi,t-2 =d}) (x)
  Pr(yi,t = d, yi,t-1 = c | pi , yi,t-2 , xi = x, i )
                                                                       d,c
  Pr(y = c, y
         i,t           = d|p ,y
                     i,t-1        i   i,t-2, x = x,  ) e0  (x) e-0 (pi,t,t-1 ) (x) e-0 (1{yi,t-2 =c}-1{yi,t-2 =d}) (x)
                                              i        i



   The result for the case s = t - 1 follows by integrating out i .




                                                             36
(ii) s = t - 2.

Pr(yi,t = d, yi,t-2 = c | pi , yi,t-3 , xi = x, i )
  =               Pr(yi,t = d | pi , yi,t-1 = r, xi = x, i ) Pr(yi,t-1 = r | pi , yi,t-2 = c, xi = x, i )
       rDt-1

              · Pr(yi,t-2 = c | pi , yi,t-3 , xi = x, i )
                                                                        
                        -0 (1{r=d}+1{c=r}) (x) -0 pr,i,t-1  (x)+r,i         -0 pd,i,t  (x) -0 pc,i,t-2  (x)-0 1{yi,t-3 =c} (x) d,i +c,i
                    e                           e                       e                 e                              e
  = 
           rDt-1
                                         Mt (r, i )                                       Mt-1 (c, i )Mt-2 (yi,t-3 , i )

    Similarly, for Pr(yi,t = c, yi,t-2 = d | pi , yi,t-3 , xi = x, i ).

    Hence,

    Pr(yi,t = d, yi,t-2 = c | pi , yi,t-3 , xi = x, i )   e-0 (pd,i,t +pc,i,t-2 ) (x) e-0 1{c=yi,t-3 } (x) Mt-1 (d, i )
                                                        = -0 (pc,i,t +p
    Pr(yi,t = c, yi,t-2 = d | pi , yi,t-3 , xi = x, i )   e             d,i,t-2 ) (x) e-0 1{d=yi,t-3 } (x) M
                                                                                                             t-1 (c, i )


                                                                                                                Mt-1 (d, i )
      = exp -0 pd,c
                i,t,t-2  (x) exp [-0 (1{yi,t-3 = c} - 1{yi,t-3 = d})  (x)]
                                                                                                                Mt-1 (c, i )

   As in the s = t - 1 case, the result for s = t - 2 now follows by application of Lemma C.1(a)
and integrating out i .


(iii) s < t - 2.

Pr(yi,t = d, yi,s = c | pi , yi,s-1 , xi = x, i )
  =                         [Pr(yi,t = d | pi , yi,t-1 = r, xi = x, i ) Pr(yi,t-1 = r | pi , yi,s+1 = r , xi = x, i )
       rDt-1 ,r Ds+1

                 · Pr(yi,s+1 = r | pi , yi,s = c, xi = x, i ) Pr(yi,s = c | pi , yi,s-1 , xi = x, i )]
                                                                                                                                    
                                  -0 (1{r=d}+1{c=r }) (x) -0 pr   ,i,s+1  (x)+r
                              e                         e                         ,i
  =                                                                                    Pr(yi,t-1 = r | pi , yi,s+1 = r , xi = x, i )
           rDt-1 ,r Ds+1
                                                 Mt (r, i )

           e-0 pd,i,t  (x) e(-0 pc,i,s -0 1{yi,s-1 =c}) (x) ed,i +c,i
       ·
                       Ms+1 (c, i )Ms (yi,s-1 , i )

    Similarly, for Pr(yi,t = c, yi,s = d | pi , yi,s-1 , xi = x, i ).

    Using the notation from Lemma C.1(b),

Pr(yi,t = d, yi,s = c | pi , yi,s-1 , xi = x, i )   e-0 (pd,i,t +pc,i,s ) (x) e-0 1{c=yi,s-1 } Ms+1 (d, i ) St,s (d, c, i )
                                                  = -0 (pc,i,t +p ) (x) -0 1{d=y
Pr(yi,t = c, yi,s = d | pi , yi,s-1 , xi = x, i )   e                         e        i,s-1 } M
                                                                                                 s+1 (c, i ) St,s (c, d, i )
                                                                  d,i,s


                                                                                                Ms+1 (d, i ) St,s (d, c, i )
 = exp -0 pd,c           t,s  (x) exp [-0 (1{yi,s-1 = c} - 1{yi,s-1 = d})  (x)]
                                                                                                Ms+1 (c, i ) St,s (c, d, i )


    Now apply both parts of Lemma C.1 and integrate out i . The result for s < t - 2 follows.


                                                                  37
