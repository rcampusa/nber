                             NBER WORKING PAPER SERIES




                           DYNAMIC PORTFOLIO SELECTION
                          BY AUGMENTING THE ASSET SPACE

                                      Michael W. Brandt
                                      Pedro Santa-Clara

                                     Working Paper 10372
                             http://www.nber.org/papers/w10372


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                   March 2004




We thank Michael Brennan, John Campbell, Rick Green, Francis Longstaff, Eduardo Schwartz,
Rob Stambaugh, Rossen Valkanov, Luis Viceira, Shu Yan, an anonymous referee, and seminar
participants at Barclays Global Investors, Lehman Brothers, and Morgan Stanley for helpful
comments. The views expressed herein are those of the authors and not necessarily those of the
National Bureau of Economic Research.

©2004 by Michael W. Brandt and Pedro Santa-Clara. All rights reserved. Short sections of text,
not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
Dynamic Portfolio Selection by Augmenting the Asset Space
Michael W. Brandt and Pedro Santa-Clara
NBER Working Paper No. 10372
March 2004
JEL No. G0, G1

                                            ABSTRACT


We present a novel approach to dynamic portfolio selection that is no more difficult to implement

than the static Markowitz model. The idea is to expand the asset space to include simple

(mechanically) managed portfolios and compute the optimal static portfolio in this extended asset

space. The intuition is that a static choice among managed portfolios is equivalent to a dynamic

strategy. We consider managed portfolios of two types: "conditional" and "timing" portfolios.

Conditional portfolios are constructed along the lines of Hansen and Richard (1987). For each

variable that affects the distribution of returns and for each basis asset, we include a portfolio that

invests in the basis asset an amount proportional to the level of the conditioning variable. Timing

portfolios invest in each basis asset for a single period and therefore mimic strategies that buy and

sell the asset through time. We apply our method to a problem of dynamic asset allocation across

stocks, bonds, and cash using the predictive ability of four conditioning variables.



Michael W. Brandt                                      Pedro Santa-Clara
Fuqua School of Business                               Anderson School
Duke University                                        UCLA
1 Towerview Drive                                      110 Westwood Plaza, Suite C4.21
Durham, NC 27708                                       Los Angeles, CA 90095
and NBER                                               and NBER
mbrandt@duke.edu                                       pedro.santa-clara@anderson.ucla.edu
1       Introduction
Several studies have pointed out the importance of dynamic trading strategies to
exploit the predictability of the first and second moments of asset returns and to hedge
changes in the investment opportunity set. However, computing these optimal dynamic
investment strategies has proven to be a rather formidable problem. Because closed-
form solutions are only available for a few cases, researchers have explored a variety of
numeric methods, including solving partial differential equations, discretizing the state-
space, and using Monte Carlo simulation. Unfortunately, these techniques are out of
reach for most practitioners and have therefore remained largely in the ivory tower. The
workhorse of portfolio optimization in industry remains the static Markowitz approach.
    Our paper presents a novel approach to dynamic portfolio selection that is no
more difficult to implement than the static Markowitz model. The idea is to expand
the asset space to include simple (mechanically) managed portfolios and compute the
optimal static portfolio within this extended asset space. The intuition is that a static
choice of managed portfolios is equivalent to a dynamic strategy. The optimal dynamic
strategy can therefore be expressed as a fixed combination of mechanically managed
portfolios. We consider managed portfolios of two types: “conditional” and “timing”
portfolios. Conditional managed portfolios are constructed along the lines of Hansen and
Richard (1987).1 For each variable that affects the distribution of returns and for each
basis asset, we consider a portfolio that invests in the basis asset an amount proportional
to the level of the conditioning variable. Timing portfolios invest in each asset for a single
period and in the risk-free rates in all other periods. Timing portfolios mimic strategies
that buy and sell the asset through time. For example, holding a constant amount of
all the timing portfolios related to a single asset approximates a strategy that holds a
constant proportion of wealth in the asset. In contrast, hedging demands induce the
investor to hold different amounts of the timing portfolios through time.
    Having expanded the asset space with managed portfolios, we can use the Markowitz
solution to find the optimal strategy for a mean-variance investor. The optimal strategy
is a combination of managed portfolios but it is trivial to recover the corresponding
investment in the basis assets at each point in time given the values of the conditioning
    1
   Hansen and Richard (1987) introduced this idea to develop tests of conditional asset pricing models.
Bansal and Harvey (1996) use conditional portfolios in performance evaluation.


                                                  1
variables. We show that the weight invested in each basis asset at each point in time
is a simple linear function of the state variables. Our approach can thus be seen
as parameterizing the portfolio policy as a function of the state variables and then
maximizing the investor’s utility by choosing optimally the coefficients of this function.
    The advantage of framing the dynamic portfolio problem in a static context is that
all the refinements developed over the years for the Markowitz model are at our disposal.
These include the use of portfolio constraints, shrinkage estimation, and the combination
of the investor’s prior beliefs with the information contained in the history of returns.
    In general, our approach relies on sample moments of the long-horizon returns of the
expanded set of assets. However, if the log returns on the basis assets and the log state
variables follow a vector auto-regression (VAR) with normally distributed innovations,
as is typically assumed in the line of research initiated by Campbell and Viceira (1999),2
the long-horizon moments of returns can all be expressed in terms of the parameters of
the VAR. In this special but popular case, we use our approach to obtain approximate
closed-form solutions for the finite-horizon dynamic portfolio choice which complement
the approximate closed-form solutions for the infinite-horizon case with intermediate
consumption derived by Campbell and Viceira.
    Our approach is similar in spirit to that of Cox and Huang (1989) and its empirical
implementation by Aı̈t-Sahalia and Brandt (2004). They solve the dynamic portfolio
problem in two steps. The investor first chooses the optimal portfolio of Arrow-Debreu
securities and then figures out how to replicate this portfolio by dynamically trading the
basis assets or derivatives on the basis assets. In contrast, we solve the portfolio problem
in one step as the optimal choice across simple dynamic trading strategies. Note also
that the Cox-Huang approach requires financial markets to be complete, for only then
all Arrow-Debreu securities can be replicated, whereas we do not need to assume market
completeness since the investor only chooses among feasible strategies.
    Our paper also relates to Ferson and Siegel (2001). They assume that the conditional
mean vector and covariance matrix of asset returns are known functions of the state
variables and then derive the optimal portfolio weights by maximizing a mean-variance
utility function (in an unconditional sense similar to ours). They show that the
resulting portfolio weights are also functions of the state variables since they depend
  2
      See also the survey by Campbell and Viceira (2002).

                                                   2
on the conditional means and conditional variances and covariances of asset returns.
In contrast, we model the portfolio weights directly as functions of the state variables
and find the coefficients of these functions that maximize the investor’s utility. Our
portfolio weights implicitly take into account the impact of the state variables on both
the means and the variances and covariances of asset returns since all of these moments
affect the portfolio’s expected return and risk, and thereby the investor’s expected utility.
Therefore, our method can be interpreted as an approximation of the solution offered by
Ferson and Siegel. For instance, by postulating that the optimal portfolio weights are
linear in the state variables, we implicitly constrain the forms of the mean vector and
the covariance matrix of returns as functions of the state variables.
    The two methods are quite different when applied in practice. To use Ferson and
Siegel’s approach, we need to estimate conditional means, variances, and covariances of
returns as functions of the state variables. While conditional mean functions can easily
be estimated by regressing returns on the state variables, it is notoriously difficult to
estimate a conditional covariance matrix as a function of state variables in a manner
that guarantees positive positive semi-definiteness at all times. In contrast, estimating
the portfolio weight function in our approach does not require imposing any sort of
nonlinear constraints. Furthermore, our approach has the advantage of being much
more parsimonious. Suppose we are interested in forming optimal portfolios of N assets.
With Ferson and Siegel’s approach, we have to estimate N functions of the state variables
for the expected return vector and N (N +1)/2 functions for the covariance matrix. With
our approach, we only need to estimate N functions for the optimal portfolio weights.
The gains in computation and estimation precision are evident.
    The paper proceeds as follows. We first describe our approach in Sections 2.1 and 2.2.
We then illustrate the mechanics of our approach through a simple example in Section
2.3 and examine its accuracy in Section 2.4. Section 3 deals with the special case in which
the log returns and log state variables follow a Gaussian VAR and Section 4 discusses
briefly how several refinements of the static Markowitz approach can be directly applied
to our approach. We illustrate our approach through an empirical application in Section
5 and conclude in Section 6.




                                             3
2         The Method
We solve a conditional portfolio choice problem with parameterized portfolio weights
of the form xt = θzt , where zt denotes a vector of state variables and θ is a matrix of
coefficients. This conditional portfolio choice problem is mathematically equivalent to
solving an unconditional problem within an augmented asset space that includes naively
managed zero-investment portfolios with excess returns of the form zt times the excess
return of each basis asset. We first establish this idea in the context of a single-period
problem and then extend the approach to the multiperiod case. Finally, we illustrate
both cases in a simple example and examine the accuracy of the solutions in a numerical
experiment.


2.1        Single-Period Problem
Suppose we want to find the optimal portfolio policy under a quadratic criterium on the
excess returns of the portfolio:
                                           h
                                             p    γ p 2i
                                     max Et rt+1 − (rt+1 ) ,                                         (1)
                                                  2
                                      p      p
where γ is a positive constant and rt+1  = Rt+1 − Rtf is the excess return on the portfolio
from t to t + 1.3 Throughout the paper we use capital letters to denote gross returns
and lower-case letters to denote excess returns. We date all variables with a subscript
that corresponds to the time at which the variable is known. For example, returns of
risky assets from time t to time t + 1 are denoted Rt+1 . The risk-free rate for the same
period is denoted Rtf , since that is known at the beginning of the return period.
        Denote the vector of portfolio weights on the risky assets at time t by xt . The above
    This criterium function arises from quadratic utility over wealth u(Wt+1 ) = Wt+1 − a2 Wt+1
    3                                                                                       2
                                                                                                . In this
                                                              a Wt                            κ
case, the relative risk aversion coefficient is given by κ = 1−a Wt , so we can write a Wt = 1+κ  . Now
reconsider the utility function:
                                    a                p  a      p
                u(Wt+1 )   = Wt+1 − (Wt+1 )2 = Wt Rt+1 − (Wt Rt+1 )2
                                    2                   2                        
                               h
                                  p    a      p
                                                   i
                                                           p         κ      p
                           = Wt Rt+1  − Wt (Rt+1 )2 = Wt Rt+1 −           (Rt+1 )2 ,
                                       2                         2(1 + κ)
        p
where Rt+1  denotes the gross return on the investor’s portfolio. For a given (constant) initial wealth
                                                                                               κ
Wt , maximizing the expectation of the function above is equivalent to problem (1) with γ = 1+κ   .


                                                   4
optimization problem then becomes:
                                  h         γ >            i
                            max Et x> r
                                    t t+1 −  x  r      >
                                                  t+1 t+1 t ,
                                                     r   x                              (2)
                             xt             2 t

where rt+1 = Rt+1 − Rtf is the vector of excess returns on the N risky assets. By
formulating the problem in terms of excess returns, we are implicitly assuming that the
remainder of the value of the portfolio is invested in the risk-free asset with return Rtf .
   When the returns are iid and the portfolio weights are constant through time, xt = x,
we can replace the conditional expectation with an unconditional one and solve for the
weights:
                                  1        >
                                               −1
                             x = E rt+1 rt+1       E [rt+1 ] .                       (3)
                                  γ
This is the well-known Markowitz solution, which can be implemented in practice by
replacing the population moments by sample averages:
                                 T −1                 T −1
                                                 −1  X        
                               1 X           >
                            x=         rt+1 rt+1            rt+1 .                      (4)
                               γ t=1                   t=1


(Notice that the 1/T terms in the sample averages cancel.)
   Consider now the more realistic case of non-iid returns and assume that the optimal
portfolio policies are linear in a vector of K state variables (the first of which we will
generally take to be a constant):
                                         xt = θzt ,                                   (5)

where θ is an N × K matrix. Our problem is then:
                             h              γ                        i
                       max Et (θzt )> rt+1 − (θzt )> rt+1 rt+1
                                                           >
                                                               (θzt ) .                 (6)
                        θ                   2

We can use the following result from linear algebra:

                       (θzt )> rt+1 = zt> θ> rt+1 = vec(θ)> (zt ⊗ rt+1 ),               (7)

where vec(θ) piles up the columns of matrix θ into a vector and ⊗ is the Kronecker




                                               5
product of two matrices, and write:

                                         x̃ = vec(θ)                                   (8)
                                     r̃t+1 = zt ⊗ rt+1 .                               (9)

Our problem can now be written as:
                                   h           γ                  i
                             max Et x̃> r̃t+1 − x̃> r̃t+1 r̃t+1
                                                            >
                                                                x̃ .                  (10)
                              x̃               2

Since the same x̃ maximizes the conditional expected utility at all dates t, it also
maximizes the unconditional expected utility:
                                     h
                                         >   γ >         >
                                                               i
                             max E x̃ r̃t+1 − x̃ r̃t+1 r̃t+1 x̃ ,                     (11)
                              x̃             2

which corresponds simply to the problem of finding the unconditional portfolio weights
x̃ for the expanded set of (N × K) assets with returns r̃t+1 . The expanded set of
assets can be interpreted as managed portfolios, each of which invests in a single basis
asset an amount proportional to the value of one of the state variables. We term these
“conditional portfolios.”
   It follows that the optimal x̃ is:

                          1          >
                                          −1
                      x̃ =  E r̃t+1 r̃t+1     E [r̃t+1 ]
                          γ
                                                                                      (12)
                          1                             −1
                         = E (zt zt> ) ⊗ (rt+1 rt+1>
                                                      )      E [zt ⊗ rt+1 ] ,
                          γ

which we can again implement in practice by replacing the population moments by
sample averages:
                           T                         −1  XT           
                         1 X        >            >
                    x̃ =       (zt zt ) ⊗ (rt+1 rt+1 )          zt ⊗ rt+1 .           (13)
                         γ t=0                              t=0


From this solution we can trivially recover the weight invested in each of the basis assets
by adding the corresponding products of elements of x̃ and zt .
   Note that the solution (13) depends only on the data and hence does not require


                                                 6
any assumptions about the distribution of returns besides stationarity. In particular, it
does not require any assumptions about how the distribution of returns depends on the
state variables. The state variables can predict time-variation in the first, second, and,
if we consider more general utility functions, even higher-order moments of returns. As
Brandt (1999) and Aı̈t-Sahalia and Brandt (2001) emphasize, the advantage of focusing
directly on the portfolio weights is that we bypass the estimation of the conditional return
distribution. This intermediate estimation step typically involves ad-hoc distributional
assumptions and inevitably misspecified models for the conditional moments of returns.
In contrast, estimating the conditional portfolio weights in a single step is robust to
misspecification of the conditional return distribution. It can also result in more precise
estimates if the dependence of the optimal portfolio weights on the state variables is less
noisy than the dependence of the return moments on the state variables.
   At this point, it is instructive to compare our approach to Ferson and Siegel (2001).
They assume that the conditional expected returns and conditional variances and
covariances of asset returns are known functions of the state variables:

                                    rt+1 = µ(zt ) + t+1 ,                             (14)

where the conditional covariance matrix of t+1 is Σ(zt ). Ferson and Siegel then derive
the mean-variance optimal portfolio weights as a function of the state variables:

                              x(zt ) = π(µ(zt ) − Rf ι)> Λ(zt ),                       (15)

where
                                                                     −1
                    Λ(zt ) = (µ(zt ) − Rf ι)(µ(zt ) − Rf ι)> + Σ(zt )
                            
                                                                         ,             (16)

ι is a vector of ones, and π is a constant.
    Our approach of modeling the portfolio weights as a function of the state variables
can be seen as an approximation of the solution provided by Ferson and Siegel. For
instance, postulating that the portfolio weights are linear in the state variables:

                                         x(zt ) = θzt                                  (17)

implicitly constrains the functional forms of µ(z) and Σ(z) in equations (15) and (16).

                                              7
Ferson and Siegel show that when the returns are homoskedastic, the optimal portfolio
weights are approximately linear in the expected returns for an extended range of the
state variables around their unconditional mean. Therefore, if the expected returns
are linear in the state variables, the portfolio weights will also be linear in the state
variables. Of course, homoskedastic returns with linear means is only one of many
return models that deliver approximately linear portfolio weights. Also, our approach
can easily accommodate non-linear portfolio weights by simply including non-linear
transformations of the state variables in the portfolio weight functions.
    Applying Ferson and Siegel’s approach in practice raises a number of issues. While
the conditional mean functions µ(zt ) can easily be estimated by regressing excess
returns rt+1 on the state variables zt , it is notoriously difficult to estimate a conditional
covariance matrix Σ(zt ) as a function of the state variables in a manner that guarantees
positive semi-definiteness at all times. Estimating the portfolio weight function in our
approach does not require imposing any sort of nonlinear constraints. Furthermore, our
approach has the advantage of being much more parsimonious. Suppose that we are
interested in forming optimal portfolios of N assets. With Ferson and Siegel’s approach,
we have to estimate N functions of the state variables for the expected return vector
and N (N + 1)/2 functions for the covariance matrix. With our approach, we only need
to estimate N functions for the optimal portfolio weights. The gains in computation
and estimation precision are evident.
    Since we express the portfolio problem in an estimation context, we can use standard
sampling theory to compute standard errors for the portfolio weights and then test
hypotheses about them. Specifically, following Britten-Jones (1999), we can interpret
the solution (13) as being proportional (with constant of proportionality 1/γ) to the
coefficients of a standard least-squares regression of a vector of ones on the excess
returns r̃t+1 . This allows us to compute standard errors for x̃ from the standard errors
of the regression coefficients. These standard errors can be used to test, for example,
whether some state variable is a significant determinant of the portfolio policy. Using
our notation, the covariance matrix of the vector x̃ is:

                         1    1
                          2
                                   (ιT − r̃x̃)> (ι − r̃x̃)(r̃> r̃)−1                     (18)
                         γ T −N ×K



                                              8
where ιT denotes a T × 1 vector of ones and r̃ is a T × K matrix with the time series of
returns of the K managed portfolios.
    As we already mentioned, the assumption that the optimal portfolio weights are
linear functions of the state variables is innocuous because zt can include non-linear
transformations of a set of more basic state variables yt . This means that the linear
portfolio weights can be interpreted as a more general portfolio policy function xt = g(yt )
for any g(·) that can be spanned by a polynomial expansion in the more basic state
variables yt . In other words, our approach can in principle accommodate very general
dependence of the optimal portfolio weights on the state variables.
    In practice, we need to choose a finite set of state variables and possible non-linear
transformations of these state variables to use in the portfolio policy. From a statistical
perspective, variable selection for modeling portfolio weights is no different from variable
selection for modeling returns. Variables can be chosen on the basis of individual t
tests and joint F tests computed with the covariance matrix of the portfolio weights
in equation (18), or on the basis of out-of-sample performance. From an economic
perspective, however, there are distinct advantages in focusing directly on the optimal
portfolio weights. As Aı̈t-Sahalia and Brandt (2001) demonstrate, it is more natural in
an asset allocation framework to choose variables that predict optimal portfolio weights
than it is to choose variables that predict moments of return. In particular, a variable
may be a statistically important predictor of both means and variances, but be useless
for determining optimal portfolio weights because the variation in the moments offset
each other (e.g., the corresponding conditional Sharpe ratio is constant).
    Finally, we can extend our approach to allow some or all of the state variables to
be asset-specific. In a companion paper, Brandt, Santa-Clara, and Valkanov (2003), we
study optimal stock portfolios by parameterizing the weight invested in each stock as
a function of the company’s characteristics, including its book-to-market ratio, market
capitalization, and return over the past year. Importantly, the parameters of the weight
function are constrained to be the same for all stocks, which makes the problem highly
tractable and computationally efficient. The resulting optimal portfolios (of this very
large set of assets) do not suffer from exploding weights (as mean-variance efficient
portfolios often do) and have outstanding performance both in and out of sample.



                                             9
2.2      Multiperiod Problem
The idea of augmenting the asset space with naively managed portfolios extends to the
multiperiod case. Consider an investor who maximizes the following two-period mean-
variance objective:                h
                                     p        γ p       i
                            max Et rt→t+2  − (rt→t+2  )2 ,                       (19)
                                              2
        p
where rt→t+2 denotes the excess return of a two-period investment strategy:

                  p
                        = Rtf + x>
                                        f      >
                                                           f f
                 rt→t+2          t rt+1 Rt+1 + xt+1 rt+2 − Rt Rt+1
                                 f                   f
                                                                                                        (20)
                          = x>                 >                  >         >
                             t (Rt+1 rt+1 ) + xt+1 (Rt rt+2 ) + (xt rt+1 )(xt+1 rt+2 ).

                                                           p
The first line of this expression shows why we call rt→t+2       a two-period excess return.
The investor borrows a dollar at date t and allocates it to the risky and risk-free assets
according to the first-period portfolio weights xt . After the first period, at date t + 1, the
one-dollar investment results in (Rtf + x>t rt+1 ) dollars, which the investor then allocates
again to the risky and risk-free assets according to the second-period portfolio weights
xt+1 . Finally, at date t + 2, the investor has (Rtf + x>              f      >
                                                             t rt+1 )(Rt+1 + xt+1 rt+2 ) dollars
but must pay Rtf Rt+1
                    f
                        dollars for the principal and interest of the one-dollar loan. The
remainder is the two-period excess return.
    The second line of equation (20) decomposes the two-period excess return into three
terms. The first two terms have a natural interpretation as the excess return of investing
in the risk-free rate in the first (second) period and in the risky asset in the second (first)
period.4 Notice that the portfolio weights on these two intertemporal portfolios are the
same as the weights on the risky asset in the first and second periods, respectively. The
third term in this expression captures the effect of compounding.
    Comparing the first two terms to the third, we see that the latter is two orders of
magnitude smaller than the former. The return (x>           >
                                                  t rt+1 )(xt+1 rt+2 ) is a product of two
single-period excess returns, which means that its units are typically of the order of
1/100th of a percent per year. The returns on the first two portfolios, in contrast, are
                       f
   4
     To see that x>t (Rt+1 rt+1 ) is a two-period excess return from investing in risky assets in the first
period and the risk-free asset in the second period, just follow the argument above with xt+1 = 0.
Investing the first-period proceeds of (Rtf + x> t rt+1 ) in the risk-free asset in the second period yields
   f             f                         f f                                                       f
(Rt +xt rt+1 )Rt+1 . After paying back Rt Rt+1 , the investor is left with an excess return of x>
        >
                                                                                                 t (Rt rt+1 ).




                                                     10
products of a gross return (Rtf or Rt+1
                                    f
                                        ) and an excess return (rt+1 or rt+2 ), so their units
are likely to be percent per year.
    Given that the compounding term is orders of magnitude smaller than the two
intertemporal portfolios, we will for now ignore it. (We discuss the effect of ignoring
the compounding term below.) The two-period portfolio choice is then simply a choice
between two intertemporal portfolios, one that holds the risky asset in the first period
only and the other that holds the risky asset in the second period only. We term these
“timing portfolios.” We can solve the dynamic problem as a simple static choice between
these two managed portfolios. In particular, for the two-period case, the sample analogue
of the optimal portfolio weights are given by:
                                T −2                       T −2
                                                      −1  X           
                              1 X               >
                         x̃ =         r̃t→t+2 r̃t→t+2            r̃t→t+2 ,                 (21)
                              γ t=1                         t=1

                     f
where r̃t→t+2 = [Rt+1   rt+1 , Rtf rt+2 ]. The first set of elements of x̃ (corresponding to the
           f
returns Rt+1  rt+1 ) then represents the fraction of wealth invested in the risky assets in
the first period and the second set of elements (corresponding to Rtf rt+2 ) are for the
risky assets in the second period.
    In a general H-period problem, we proceed in exactly the same fashion. We construct
a set of timing portfolios:
                                          H−1
                                           Y                      H−1
                                                     f
                             r̃t→t+H =              Rt+i rt+j+1          ,                 (22)
                                             i=0                   j=0
                                             i6=j


where each term represents a portfolio that invests in risky assets in period t + j and
in the risk-free rate in all other periods t + i, with i 6= j. The sample analogue of the
optimal portfolio weights are then again given by the static solution:
                              T −H                 −1  TX−H        
                            1 X               >
                       x̃ =         r̃t→t+H r̃t→t+H            r̃t→t+H .                   (23)
                            γ t=1                          t=1


It is important to realize that, in contrast to a long-horizon buy-and-hold problem,
the random components of the timing portfolios are non-overlapping. We thereby


                                                11
avoid the usual statistical problems associated with overlapping long-horizon returns.
Notice, however, that as the length of the horizon H increases, we loose observations
for computing the mean and covariance matrix of r̃t→t+H , which may compromise the
statistical precision of the solution.
   We can naturally combine the ideas of conditional portfolios and timing portfolios.
For this, we replace the risky returns rt+j+1 in equation (22) with the conditional portfolio
returns zt+j ⊗ rt+j+1 . The resulting optimal portfolio weights x̃ from equation (23) then
provide the optimal allocations to the conditional portfolios at each time t + j.
    The obvious appeal of our approach is its simplicity. Naturally, this simplicity comes
with drawbacks. First, by ignoring the compounding terms, our approach no longer
provides the exact solution to the multiperiod problem. Writing out the return on an
H-period dynamic portfolio strategy analogous to the two-period case in equation (20)
shows that the multiperiod portfolio returns are only spanned when we include the
compounding terms in the static portfolio problem. Unfortunately, the presence of
the compounding terms imposes a set of non-linear constraints on the static portfolio
weights. The portfolio weights on the compounding terms are constrained to be products
of the portfolio weights on the timing portfolios. Due to the non-linearity of these
constraints, solving the static constrained problem with compounding terms for a large
number of assets and/or a large number of rebalancing periods is not much simpler than
solving the corresponding dynamic problem using numeric optimization techniques. Our
suggestion is to ignore the compounding terms on the grounds that they are orders
of magnitude smaller than the timing portfolio returns. However, in ignoring the
compounding terms, our solution is at best a good approximation of the solution to
the multiperiod problem. The quality of the approximation is naturally specific to each
application. Intuitively, it depends on the growth rate of wealth per period and on the
number of periods considered. We further examine this issue in Section 2.4.
    The second drawback of our approach is that it can be quite data-intensive for
problems with very long horizons. For example, suppose we want to solve a ten-year
portfolio choice problem with quarterly rebalancing using a 60-year post-war data sample
of quarterly returns and state variable realizations. Since each timing-portfolio involves
a ten-year return, we would only have six independent observations to compute the
moments of the timing-portfolio returns and hence the optimal portfolio weights. The

                                             12
obvious way to overcome this data issue is to impose a statistical model for the returns
and state variables that allows us to compute the long-horizon moments analytically (or
by simulation) from the parameters of the statistical model. Specifically, if the log returns
on the basis assets and the log state variables follow a VAR with normally distributed
innovations, the long-horizon moments can be expressed in terms of the parameters of
the VAR. This use of a statistical model allows us to solve dynamic portfolio choice
problems with arbitrarily long horizons using only a finite data sample. We elaborate
on this idea in Section 3.


2.3    Illustrative Example
To illustrate more concretely the mechanics of our approach, consider a time series of
only six observations (for simplicity) of excess returns of two risky assets, stocks denoted
by s and bonds denoted by b:                       
                                           r1s r1b
                                         s
                                         r2 r2b 
                                                    
                                        
                                         ··· ··· 
                                                                                       (24)
                                                   
                                           r6s r6b
The optimal static portfolio in equation (4) directly gives us the weight xs invested in
the stock and the weight xb invested in the bond (with the remainder invested in the
risk-free asset). The solution takes into account the sample covariance matrix of asset
returns and the vector of sample mean excess returns.
    Suppose now that there is one conditioning variable, such as the dividend yield or the
spread between long and short Treasury yields, which affects the conditional distribution
of returns. We observe a time series of this state variable:
                                              
                                           z0
                                              
                                         z1 
                                         ··· ,                                      (25)
                                              
                                              
                                           z5

where the dating reflects the fact that z is known at the beginning of each return
period. We take into account the information in the conditioning variable by estimating


                                             13
a portfolio policy that depends on it.   For this, we expand the matrix of returns (24) in
the following manner:                                       
                                  r1s      r1b z0 r1s z0 r1b
                                s
                                           r2b z1 r2s z1 r2b 
                                                             
                                r2
                               
                                ···
                                                                                          (26)
                                         ··· ··· ···       
                                  r6s        b      s
                                           r6 z5 r6 z5 r6  b


and compute the optimal static portfolio of this expanded set of assets. This static
solution gives us a vector of four portfolio weights x̃ corresponding to each of the basis
assets and managed portfolios in the matrix above. We find the weight invested in
stocks at each time by using the first and third elements of x̃, xst = x̃1 + x̃3 zt . Similarly,
the weight invested in the bond at each time is xbt = x̃2 + x̃4 zt . Note that when we
use the Markowitz solution (4) on the matrix of returns of the expanded asset set (26),
the covariance matrix and vector of means takes into account the covariances among
returns and between returns and lagged state variables. The latter covariances capture
the impact of predictability of returns on the optimal portfolio policy.
   Consider now a two-period portfolio choice problem. We construct the matrix of
returns of the timing portfolios as described in equation (22):

                                r1s R1f R0f r2s r1b R1f R0f r2b
                                                               
                               s f       f           f   f
                               r3 R3 R2 r4s r3b R3 R2 r4b  .                             (27)
                                                                

                                r5s R5f R4f r6s r5b R5f R4f r6b

This matrix contains two-period non-overlapping returns of four trading strategies. The
corresponding optimal portfolio vector x̃ gives us the weights on “stocks in period 1,”
“stocks in period 2,” “bonds in period 1,” and “bonds in period 2.” The covariance
matrix and vector of means which show up in the static portfolio solution account for
the contemporaneous covariances of returns as well as the one-period serial covariances
of returns. The latter covariances induce hedging demands.
   Finally, we can consider a two-period problem with the conditioning variable. The




                                              14
returns of the expanded asset set are:

            r1s R1f R0f r2s r1b R1f R0f r2b z0 r1s R1f R0f z1 r2s z0 r1b R1f R0f z1 r2b
                                                                                       
           s f       f           f   f              f   f                 f   f
           r3 R3 R2 r4s r3b R3 R2 r4b z2 r3s R3 R2 z3 r4s z2 r3b R3 R2 z3 r4b  .          (28)
                                                                                        

            r5s R5f R4f r6s r5b R5f R4f r6b z4 r5s R5f R4f z5 r6s z4 r5b R5f R4f z5 r6b

The optimal portfolio of these eight assets now includes the weight on “stocks in period
1, conditional on the level of z,” for example. The portfolio solution takes into account
the covariances between returns and state variables over subsequent periods.


2.4    Importance of the Compounding Terms
Our approach to the multiperiod portfolio problem relies critically on the presumption
that the compounding terms (i.e., the cross-products of the excess returns in different
time periods) are negligible relative to the returns on the timing portfolios. We now
examine to what extent and under which circumstances this is valid.
   We apply our method to the following model for monthly excess stock and bond
returns (the basis assets) and the term spread (the state variable):
                     s
                                                          s 
             ln(1 + rt+1 )       0.0059       0.0060            t+1
                      b                                        b 
            ln(1 + rt+1 )  =  0.0007  +  0.0035  × zt +  t+1  ,                    (29)
                                                

                 zt+1           −0.0028       0.9597            zt+1

with                                                   
                  st+1              0.0018 0.0002 −0.0005
                 b 
                 t+1  ∼ MVN 0,  0.0002 0.0006  0.0007  .                             (30)
                                                         

                  zt+1             −0.0005 0.0007  0.0802
The choice of state variable is based on our empirical results in Section 5, where we
identify the term spread as an important return predictor (other important predictors
include the dividend yield and detrended short-term interest rate). The functional form
of the model follows the literature on portfolio choice under predictability and is also
related to our setup in Section 3. The parameter values are OLS estimates based on
monthly data from January 1945 through December 2000.
   To assess the importance of the compounding terms in the solution of the multiperiod

                                                15
portfolio problem, we compare portfolio policies that ignore the compounding terms
(using our simplified approach based on the timing portfolios) with policies that
incorporate the compounding terms (obtained through numeric optimization). We label
these solutions “approximate” and “exact,” respectively.5 Intuitively, there are two
factors that affect the role of the compounding terms, the rebalancing frequency and
the portfolio horizon. The less frequently the portfolio is rebalanced, the larger are the
magnitudes of the excess returns per period, and therefore the larger are the magnitudes
of the compounding terms. The longer the horizon, the more compounding terms there
are in the expanded budget constraint. Hence, we study multiperiod portfolio problems
with rebalancing frequencies ranging from monthly to annual and horizons ranging from
one to five years.
    The results of our experiments are displayed in Table 1. The table describes the
multiperiod returns from the approximate and exact portfolio policies for an investor
with quadratic utility and γ = 4 (the value we use in our empirical application). Panel
A presents the results for unconditional portfolio policies and panel B the results for
conditional policies in which the stock and bond returns each period are scaled by the
state variable. All summary statistics (mean, standard deviation, Sharpe ratio, and
certainty equivalent return) are annualized. Finally, the last row in each panel reports
the average absolute difference between the approximate and exact allocations to (scaled)
stock and bond in all periods.
    Broadly reviewing the results across horizons, rebalancing frequencies, and panels,
it is clear that, consistent with our intuition, the compounding terms are relatively
unimportant in the multiperiod portfolio problem. For example, the largest increase
in the annualized Sharpe ratio from taking into account the compounding terms in the
unconditional case is 0.0026, which corresponds to an increase in the annualized certainty
equivalent return of only three basis points. The largest average absolute difference in
the unconditional portfolio weights is 4.26 percent, which is less than 1/10th of the
magnitude of the typical allocation to stocks and far smaller than the standard errors
   5
     The exact solution is obtained by numerically maximizing the expected utility of terminal wealth
with respect to the portfolio weights in every period. For a given set of portfolio weights, the moments
of the multiperiod portfolio returns are evaluated using 1,000,000 data points simulated from the
model (29). To keep the comparison as fair as possible and to abstract from sampling error, we use the
same simulations to evaluate the moments of the timing portfolios for the approximate solution.



                                                  16
on the unconditional portfolio weights in our empirical application. The results are
similar for the conditional case. The certainty equivalent gains from taking into account
the compounding terms are less than 12 basis points per year and the average absolute
differences in the portfolio weights are less than five percent.
    Analyzing the results more closely reveals some intuitive patterns. The importance
of the compounding terms increases with the horizon (holding constant the rebalancing
frequency) as well as with the rebalancing frequency (holding constant the horizon).
The compounding terms are more important for the conditional polices because these
are associated with a higher expected growth rate of wealth and a larger number of
compounding terms due to the inclusion of the scaled returns.
   We conclude from this experiment that our approach of solving the multiperiod
portfolio problem with timing portfolios, which ignore the compounding of excess
returns over time, results in little economic loss. This is particularly true for problems
with relatively short horizons and infrequent rebalancing. This small economic loss
is more than compensated by the computational gains arising from the simplicity of
our approach, especially when compared to the usual numeric solutions of multiperiod
portfolio problems.



3    Optimal Portfolio Weights Implied by a VAR
As mentioned above, our approach can be data intensive for solving portfolio problems
with very long horizons. However, this issue can be overcome by using a statistical
model for the returns and state variables. For example, consider a problem with a single
risky asset and one conditioning variable and assume that the log (gross) return and
log conditioning variable evolve jointly according to the following restricted VAR with
normally distributed innovations:
                       "              #       "        #       "        #
                           ln Rt+1                a1               b1
                                          =                +                ln zt + t+1 ,   (31)
                            ln zt+1               a2               b2

where t+1 ∼ N[0, Ω]. We also assume for simplicity that the risk-free rate is constant.




                                                       17
   The dynamics of returns in equation (31) imply the following expanded VAR:

                                    ln Yt+1 = A + B ln Yt + νt+1 ,                               (32)

where ln Yt+1 = [ln Rt+1 , ln zt+1 , ln zt , ln zt + ln Rt+1 ]> and ηt+1 ∼ N[0, Γ] with
                                                                                       
             a1                0   b1      0   0                      ω11 ω12       0 ω11
                                                                                       
            a2              0   b2      0   0                    ω12 ω22       0 ω12   
   A=            ,   B=                         ,   and Γ =                            ,   (33)
     
            0    
                  
                         
                              0    1      0   0   
                                                   
                                                                
                                                                      0   0        0 0     
                                                                                            
             a1                0 b1 + 1    0   0                      ω11 ω12       0 ω11

where ωij are the elements of the covariance matrix Ω. The first two unconditional
moments of this expanded VAR are given by:

                             µ ≡ E[ln Yt+1 ] = (I − B)−1 A
                                                                                                 (34)
                       vec(Σ) ≡ vec(Var[ln Yt+1 ]) = (I − B ⊗ B)vec(Γ).

We use this expanded VAR to solve for the moments of returns involved in our solution
to the dynamic portfolio choice problem.


3.1      Single-Period Problem
Consider first the single-period portfolio problem. Following equation (9), we construct
excess returns on the managed portfolios:

                               r̃t+1 = [Rt+1 − Rf , zt (Rt+1 − Rf )]>                            (35)

From the extended VAR (34), these returns can be written as:

                                         r̃t+1 = ΛYt+1 + λ,                                      (36)

where:                         "                   #              "         #
                                   1 0  0  0                          −Rf
                        Λ=                              and λ =                 .                (37)
                                   0 0 −Rf 1                           0




                                                   18
The optimal single-period portfolio choice for the expanded asset space in equation (13)
depends on the first two moments of these returns, which are given by:

               E[r̃t+1 ] = ΛE[Yt+1 ] + λ and Var[r̃t+1 ] = ΛVar[Yt+1 ]Λ> ,             (38)

where, from the joint log-normality of Yt+1 and the unconditional moments of the VAR:
                                                                   
                                              1
                  E[Yt+1 ] = exp E[ln Yt+1 ] + Diag [Var[ln Yt+1 ]]
                                              2                                        (39)
                                                  
                 Var[Yt+1 ] = exp Var[ln Yt+1 ] − 1 E[Yt+1 ]E[Yt+1 ]> .
                                 


The moments in equation (38), and hence the optimal portfolio weights, can therefore
be evaluated using the unconditional moments of the VAR in equation (34).


3.2    Multiperiod Portfolio Choice
Consider next a two-period dynamic problem. The excess returns of the conditional and
timing portfolios are:

 r̃t→t+2 = [(Rt+1 − Rf )Rf , zt (Rt+1 − Rf )Rf , Rf (Rt+2 − Rf ), Rf zt+1 (Rt+2 − Rf )]
            |                {z              } |                  {z                }
                    stocks in period 1,                  stocks in period 2,
                     conditional on z                     conditional on z              (40)
                 "      #  "       #   "   # >
              f     Λ 0       Yt+1        λ
         =R                           +           .
                    0 Λ       Yt+2        λ

The corresponding first and second moments are:
                                  "             # "     # " #
                                       Λ     0      Yt+1       λ
                E[r̃t→t+2 ] = Rf                E          +
                                        0    Λ      Yt+2       λ
                                      "        #     "      #"        #                (41)
                                         Λ   0         Yt+1    Λ> 0
               Var[r̃t→t+2 ] = (Rf )2            Var                    ,
                                         0   Λ         Yt+2      0 Λ>




                                                 19
where:
               "          #      ( "        #        "   "          ##)
                   Yt+1             ln Yt+1     1           ln Yt+1
          E                 = exp E           + Diag Var
                   Yt+2             ln Yt+2     2           ln Yt+2
               "          #       (   "         #)   ! "         # "       #>       (42)
                   Yt+1                 ln Yt+1            Yt+1       Yt+1
         Var                = exp Var              −1 E            E
                   Yt+2                 ln Yt+2            Yt+2       Yt+2

and from the unconditional moments of the VAR:
                              "         # " #
                                ln Yt+1     µ
                            E            =
                                ln Yt+2     µ
                              "         # "       #                                 (43)
                                ln Yt+1      Σ BΣ
                          Var            =          .
                                ln Yt+2     BΣ Σ

   Finally, consider an N -period dynamic problem. Using basic matrix algebra, the
excess returns on the conditional and timing portfolios can be written as:
                                                             
                                                       Yt+1              
                                   N −1
                    r̃t→t+N = Rf
                                                                      
                                               IN ⊗ Λ  · · ·  + ιN ⊗ λ ,          (44)
                                                              

                                                        Yt+N

where IN and ιN denote an N -dimensional identity matrix and vector of ones,
respectively. The corresponding first and second moments are:
                                                                  
                                                            Yt+1               
                                      N −1
                   E[r̃t→t+N ] = Rf
                                                                            
                                                  IN ⊗ Λ E  · · ·  + ιN ⊗ λ
                                                                   

                                                             Yt+N
                                                                                  (45)
                                                                Yt+1
                                      2(N −1)
               Var[r̃t→t+N ] = Rf                 IN ⊗ Λ Var  · · ·  IN ⊗ Λ> ,
                                                                             

                                                                Yt+N




                                                    20
where:
                                                          
          Yt+1             ln Y  t+1                   ln Y t+1   
                                        1
                                                                  
     E  · · ·  = exp E      ···      + Diag Var  · · · 
                                                            
                                          2                       
          Yt+N             ln Yt+N f s                 ln Yt+N
                                                                  
                                                            >           (46)
          Yt+1          
                                ln Yt+1           Yt+1         Yt+1
    Var  · · ·  = exp Var  · · ·  − 1 E  · · ·  E  · · · 
                                                              
                                         
          Yt+N                  ln Yt+N              Yt+N         Yt+N
                                         


and:
                        
                   Yt+1
              E  · · ·  = ιN   ⊗µ
                        

                   Yt+N
                                                                      
                                B0     B1     B2      · · · B N −1                (47)
                   Yt+1
                                  B1     B0     B1      · · · B N −2
                                                                      
                                                                     
                                                                        ⊗ Σ.
             Var  · · ·  = 
                 
                                 ···    ···    ···     ···    ···     
                   Yt+N
                                                                      
                                   N −1   N −2
                                 B      B      B N −3   ···    B0

To summarize, the optimal portfolio weights for the N -period dynamic problem with
conditional and timing portfolios, which depend on the first and second moments of the
managed portfolio returns, can be evaluated analytically using the coefficient matrix B
and the unconditional moments µ and Σ of the VAR (which in turn depend on A, B,
and Γ). Since we can estimate the VAR with a relatively modest time-series of returns
and state variable realizations, we can solve dynamic portfolio choice problems with
arbitrarily long horizons using finite data samples in this VAR context. Of course, this
comes at the cost of having to impose strong structure on the dynamics of returns.


4      Extensions and Refinements
Our approach can be extended and refined along a number of dimensions. In this section,
we show how to generalize the investor’s utility function and how to compute robust
portfolio weights for a large numbers of assets using techniques developed originally for
the static Markowitz approach.

                                           21
4.1     Objective Functions
The mean-variance objective function can be extended to an arbitrary utility function
u(Wt+1 ). In that case, we solve the problem:
                                      h                      i
                                max Et u(Rtf + (θzt )> rt+1 ) ,                               (48)
                                  θ


or the corresponding first-order conditions, using numeric optimization methods. While
high-dimensional numeric solutions are non-trivial, our approach benefits from being
static and unconstrained (since we ignore the compounding terms). Furthermore, there
exists by now an extensive literature on effective and fast algorithms for solving high-
dimensional optimization problems that can applied to our framework.6
    The quadratic objective function (1) can alternatively be interpreted as a second-
order approximation of a more general utility function, such as power or more
general HARA preferences. To increase the precision of this approximation, Brandt,
Goyal, Santa-Clara, and Stroud (2003) propose a fourth-order expansion that includes
adjustments for the skewness and kurtosis of returns and their effects on expected utility.
Specifically, the expansion of expected utility around the current wealth growing at the
risk-free rate is:
   h        i    h                                   1                       2
 Et u(Wt+1 ) ≈ Et u Wt Rtf + u0 Wt Rtf Wt xt > rt+1 + u00 Wt Rtf Wt xt > rt+1
                                                              
                                                       2                         (49)
                   1 000    f
                                  >
                                         3   1   0000   f
                                                                >
                                                                    4 i
                + u Wt Rt Wt xt rt+1 + u Wt Rt Wt xt rt+1 .
                   6                          24

In this case, the FOCs define an implicit solution for the optimal weights in terms of the
joint moments of the derivatives of the utility function and returns:
      n h                          i o−1 n h                     i
xt ≈ − Et u00 Wt Rtf (rt+1 rt+1 > ) Wt2    × Et u0 Wt Rtf (rt+1 ) Wt
                                                        

      1 h 000                   2      i    1 h 0000                3 i  (50)
                   f                                      f
                      >                                     >
     + Et u Wt Rt xt rt+1 rt+1 Wt + Et u Wt Rt xt rt+1 rt+1 Wt4 .
                                          3
      2                                      6

This implicit expression for the optimal weights is easy to solve in practice. Start with
  6
    These algorithms including variants of the Newton method (e.g., Conn, Gould, and Toint, 1988;
Moré and Toraldo, 1989), the quasi-Newton or BFGS method (e.g., Byrd, Lu, Nocedal, and Zhu, 1995),
and the sequential quadratic programming approach (e.g., Gill, Murray, Saunders, 2002).



                                                22
an initial “guess” for the optimal weights (such as equal weights in each asset), denoted
xt (0). Then, enter this guess on the right-hand side of equation (50) and obtain a
new solution for the optimal weights on the left-hand-side, denoted xt (1). After a few
iterations n, the guess xt (n) is very close to the solution xt (n + 1) and we can take this
value to be the solution of equation (50). Brandt, Goyal, Santa-Clara, and Stroud show
that this expansion is highly accurate for investment horizons up to one year, even when
returns are far from normally distributed. It is straightforward to use this expansion
approach in our extended asset space approach.
   We can also consider performance benchmarks in the objective function. Frequently,
money managers are evaluated on their performance relative to a benchmark index
portfolio over a given period. Such problems can easily be solved within our approach.
Simply use returns of the basis assets in excess of the benchmark index (instead of in
excess of the risk-free interest rate), Rt −Rti ι, in the portfolio optimization. The objective
function defined on these excess returns thus defines a gain from beating the benchmark
index with low tracking error. The optimal portfolio weights can be interpreted as
deviations from the benchmark, usually termed “active” weights.
   Finally, we can expand the mean-variance objective to penalize covariance with the
return of a particular portfolio such as the market, rm .7 In this case, the objective is:
                                      h
                                           p      γ p 2        p    m
                                                                       i
                                 Et       rt+1   − (rt+1 ) − λrt+1 rt+1 ,                 (51)
                                                  2

with some positive penalty constant λ. The solution in the unconditional case is
(replacing sample moments for the population moments):
                                                  T −1
                                             −1  X                    
                               1         >                     m
                            x=    Ert+1 rt+1            (1 − λrt+1 )rt+1 ,                (52)
                               γ                   t=1


which can trivially be extended to the conditional and multiperiod problems.


4.2       Constraints, Shrinkage, and Prior Views
A benefit of framing the dynamic portfolio problem in a static context is that we have
at our disposal all of the refinements of the Markowitz approach developed over the
  7
      Or, similarly, penalize covariance with consumption growth.

                                                       23
past decades. These include the use of portfolio constraints to avoid extreme positions
(e.g., Frost and Savarino, 1988; Jagannathan and Ma, 2003), the use of shrinkage
to improve the estimates of the means (e.g., Jobson and Korkie, 1981) as well as of
the covariance matrix (e.g., Ledoit, 1995), and the combination of the investor’s prior
from an alternative data source or the belief in a pricing model with the information
contained in returns (e.g., Treynor and Black, 1973; Black and Litterman, 1992; Pastor
and Stambaugh, 2000).
   For the last approach, which is particularly useful in practice, a natural prior is that
the market is in equilibrium. In that case the market portfolio is the tangency portfolio.
Suppose that the estimated portfolio weight on asset i is of the form xit = a + bzt , and
assume that z has been standardized to have mean zero. Using the equilibrium prior, we
would shrink a towards the market capitalization weight of the asset and b towards zero.
The shrinkage weights can be determined from the standard errors of the estimates of a
and b, coupled with a prior on the efficiency of the market.


5    Application
There is substantial evidence that economic variables related to the business cycle
help forecast stock and bond returns. For instance, Campbell (1991), Campbell and
Shiller (1988), Fama (1990), Fama and French (1988,1989), Hodrick (1992), and Keim
and Stambaugh (1986) report evidence that stock market returns are predictable by
the dividend-price ratio, short-term interest rate, term spread, and credit spread. Fama
and French (1989) show that the same variables also predict bond returns. We use
these four conditioning variables in a simple application of our method to the dynamic
portfolio choice between stocks, bonds, and cash. This application is similar to Brennan,
Schwartz, and Lagnado (1997) and Campbell, Chan, and Viceira (2003).
    We take the stock to be the CRSP value-weighted market index, the bond to be the
index of long-term Treasuries constructed by Ibbotson Associates, and cash to be the
three-month Treasury bill, also obtained from Ibbotson Associates. The dividend-price
ratio (D/P) is calculated as the difference between the log of the last twelve month
dividends and the log of the current price index of the CRSP value-weighted index.
The relative Treasury bill (Tbill) stochastically detrends the raw series by taking the


                                            24
difference between the Treasury bill rate and its twelve-month moving average. The term
spread (Term) is the difference between the yields on 10-year and 1-year government
bonds. The default spread (Default) is calculated as the difference between the yield
on BAA- and AAA-rated corporate bonds. The interest rate data is obtained from the
DRI/Citibase database. We standardize the three conditioning variables to ease the
interpretation of the coefficients of the portfolio policy. The sample period is January
1945 through December 2000.
    Table 2 reports the results for both unconditional and conditional portfolio policies
at monthly, quarterly, and annual holding periods. The investor is assumed to have
quadratic utility. We set γ = 4 in all cases, as this leads to an unconditional asset
allocation that holds a small but positive amount in cash, which is roughly similar to
portfolios typically recommended by financial consultants.
   There are some differences in the unconditional portfolio weights across the three
holding periods. With monthly rebalancing, the weight in equities is 51.15 percent,
whereas it is only 37.13 and 41.66 percent at the quarterly and annual frequencies,
respectively. This pattern is due to differences in the joint distribution of stock and
bond excess returns over the different holding periods. In particular, there is a small
amount of positive serial correlation in returns at the monthly frequency that turns
negative at the quarterly and annual frequencies. This makes the volatility of stock and
bond returns proportionately lower at the monthly frequency.
    The conditional policies are quite sensitive to the state variables. For the monthly
conditional policy, the coefficients of the bond weight on Term, Default, and D/P, as
well as the coefficient of the stock weight on Default and D/P are all significant at the 95
percent level. Furthermore, the average weight held in stocks by the conditional policy
is 81.21 percent, which significantly exceeds the corresponding unconditional weight of
51.15 percent. The reason is that the predictability in the first and second moments of
returns allows the investor to be more aggressive on average since the exposure can be
reduced in bad times. The average weight on bonds of the conditional policy is actually
negative, −36.24 percent, compared to the unconditional weight of 47.09 percent. An
F -test of the hypothesis that all coefficients on the state variables are equal to zero
has a p-value of zero. Finally, the (annualized) Sharpe ratio of the conditional policy
is 0.92, which is twice that of the unconditional policy of 0.46. Overall, it is clear that

                                            25
the conditional return distribution is very different on average than the unconditional
return distribution.
    The results are less pronounced for the longer holding periods. At the quarterly
frequency, for example, only the coefficients of the bond weight on Default and of the
stock weight on Tbill are significant. However, the hypothesis that all coefficients on
the state variables are zero is still rejected with a p-value of zero. More importantly, the
Sharpe ratio of the conditional policy is still one and a half times that of the unconditional
policy, 0.64 versus 0.41. The results for the annual policy are qualitatively similar, with
an increase in Sharpe ratio from 0.44 to 0.54. Judging by the relative increase in the
Sharpe ratio, the conditioning information becomes less important as the holding period
increases. On the one hand, this is sensible, as a conditional strategy turns into an
unconditional one in the limit as the horizon increases. On the other hand, this result is
at odds with the general notion that returns become more predictable at longer horizon.
The reason for why this long-run predictability is not as noticeable in our results is that
for our sample period the interest rate variables are the most important predictors and
those variables mainly forecast returns at short horizons (e.g., Fama and French, 1989).


    Figure 1 displays the time series of portfolio weights of the conditional policies.
For comparison, the figure also shows the unconditional portfolio weights. Overall,
the shorter the holding period, the more extreme positions the policies take at times.
It is striking that the conditional policies can be substantially different at different
frequencies.
    As mentioned earlier, by focussing directly on the portfolio weights we capture time-
variation in the entire return distribution as opposed to just the expected returns. To
get a sense of the importance of this aspect of our approach, we compare the conditional
policies to more traditional strategies based only on predictive return regressions.
Specifically, we regress the excess stock and bond returns on the state variables and
then use the corresponding one-period ahead forecasts of the returns together with the
unconditional covariance matrix to form portfolio weights. In this way, the strategy only
takes into account the predictability of expected returns and ignores the impact of the
state variables on variances and covariances. Table 3 compares the two approaches, and
Figure 2 plots the time series of portfolio weights on the stock.

                                             26
    The advantage of our approach is most striking at the quarterly frequency. Both
strategies generate an average premium of about nine percent per year, but our
conditional strategy has a volatility that is less than half that of the regression-based
strategy, 14.5 versus 32.6 percent, resulting in a Sharpe ratio that is more than twice as
large. In fact, the investor would be willing to pay an annual fee of more than 16 percent
to obtain the improved performance associated with exploiting the joint time-variation
of the entire return distribution, as opposed to exploiting just the time-variation of the
mean returns. Although the differences between the strategies are less dramatic at the
monthly and annual frequencies, the conclusion holds nevertheless. The fee the investor
is willing to pay for using the conditional strategy is about two percent for monthly
returns and more than four percent for annual returns. It is interesting to note that
as the holding period increases, the benefit of our approach shifts from generating a
substantially higher expected return at a slightly higher level of risk to generating a
slightly lower expected return at a substantially lower level of risk.
   We now turn our attention to multiperiod strategies. Table 4 reports the portfolio
weights of the multiperiod portfolio policy for a one-year horizon with monthly or
quarterly rebalancing. For simplicity, we report only the unconditional strategy and
the conditional strategy with a single state variable, the detrended T-bill rate. The
table reports the estimated portfolio weights for month one, four, eight, and twelve as
well as for all four quarters of the twelve-month or four-quarter problems, respectively.
    With monthly rebalancing, the weight on stocks decreases and the weight on bonds
increases as the end of the horizon approaches. This horizon pattern is roughly the same
for the unconditional and conditional policies, which means that it is generated by the
serial-covariance structure of the returns on the basis assets. With quarterly rebalancing,
the unconditional and average conditional (the constant term in the conditional policy)
stock holdings are similar to each other and to the results with monthly rebalancing.
The unconditional and average conditional bond holdings, in contrast, are very different
from each other. In the unconditional policy, the bond holding increases from −4 to
56 percent as the end of the horizon approaches, while in the conditional policy the
average bond holding decreases from −17 to −27 percent. This difference in the horizon
patterns can only be attributed to the serial-covariance structure of the conditional
portfolio returns, which illustrates the importance of augmenting the asset space in this


                                            27
multiperiod problem.
    Finally, notice that the Sharpe ratios of the multiperiod policies are higher than in
the corresponding single-period case. Consistent with the prediction of intertemporal
portfolio theory, both the mean and the volatility of the portfolio returns are lower.
Given the serial-covariance structure in the data, the investor sacrifices mean return for
intertemporal diversification.


6    Conclusion
We presented a simple approach for dynamic portfolio selection. The solution extends
the Markowitz approach to the choice between managed portfolios: conditional portfolios
that invest in each asset a weight proportional to some conditioning variable, and timing
portfolios that invest in each asset in a single period. The intuition underlying our
approach is that the static choice among these mechanically managed portfolios is
equivalent to a dynamic strategy in the basis assets. Our hope is that, by making
dynamic portfolio selection no more difficult to implement than the static Markowitz
approach, it will finally leave the confines of the ivory tower and make its way into the
day-to-day practice of the investment industry.




                                           28
References
Aı̈t-Sahalia, Yacine, and Michael W. Brandt, 2001, Variable selection for portfolio choice,
   Journal of Finance 56, 1297–1351.

       , 2004, Portfolio and consumption choice with option-implied state prices,
  Working Paper, Princeton University.

Bansal, Ravi, and Campbell R. Harvey, 1996, Performance evaluation in the presence of
  dynamic trading strategies, Working Paper, Duke University.

Black, Fisher, and Robert Litterman, 1992, Global portfolio optimization, Financial
  Analysts Journal 48, 28–43.

Brandt, Michael W., 1999, Estimating portfolio and consumption choice: A conditional
  method of moments approach, Journal of Finance 54, 1609–1646.

       , Amit Goyal, Pedro Santa-Clara, and Jonathan R. Stroud, 2003, A simulation
  approach to dynamic portfolio choice with an application to learning about return
  predictability, Working Paper, Duke University.

Brandt, Michael W., Pedro Santa-Clara, and Rossen Valkanov, 2003, Equity portfolios
  with parametric weights: Exploiting size, book to market, and momentum, Working
  Paper, Duke University.

Brennan, Michael J., Eduardo S. Schwartz, and Ronald Lagnado, 1997, Strategic asset
  allocation, Journal of Economic Dynamics and Control 21, 1377–1403.

Britten-Jones, Mark, 1999, The sampling error in estimates of mean-variance efficient
  portfolio weights, Journal of Finance 54, 655–671.

Byrd, Richard H., Peihuang Lu, Jorge Nocedal, and Ciyou Zhu, 1995, A limited memory
  algorithm for bound constrained optimization, SIAM Journal on Scientific Computing
  16, 1190–1208.

Campbell, John Y., 1991, A variance decomposition for stock returns, Economic Journal
  101, 157–179.



                                            29
       , Yeung Lewis Chan, and Luis M. Viceira, 2003, A multivariate model of strategic
  asset allocation, .

Campbell, John Y., and Robert J. Shiller, 1988, Stock prices, earnings, and expected
  dividends, Journal of Finance 43, 661–676.

Campbell, John Y., and Luis M. Viceira, 1999, Consumption and portfolio decisions
  when expected returns are time varying, Quarterly Journal of Economics 114, 433–
  495.

       , 2002, Strategic Asset Allocation: Portfolio Choice for Long-Term Investors
  (Oxford University Press: New York, NY).

Conn, Andy R., Nick I.M. Gould, and Philippe Toit, 1988, Global convergence for a
  class of trust-region algorithms for optimization with simple bounds, SIAM Journal
  of Numerical Analysis 25, 433–460.

Cox, John C., and Chi-Fu Huang, 1989, Optimal consumption and portfolio policies
  when asset prices follow a diffusion process, Journal of Economic Theory 49, 33–83.

Fama, Eugene F., 1990, Stock returns, expected returns, and real activity, Journal of
  Finance 45, 1089–1108.

       , and Kenneth R. French, 1988, Permanent and temporary components of stock
  prices, Journal of Political Economy 96, 246–273.

       , 1989, Business conditions and expected returns on stocks and bonds, Journal
  of Financial Economics 25, 23–49.

Frost, Peter A., and James E. Savarino, 1988, For better performance: Constrain
  portfolio weights, Journal of Portfolio Management 15, 29–34.

Gill, Philip E., Walter Murray, and Michael A. Saunders, 2002, SNOPT: an SQP
  algorithm for large-scale constrained optimization, SIAM Journal of Optimization
  12, 979–1006.

Hansen, Lars P., and Scott F. Richard, 1987, The role of conditioning information in
  deducing testable restrictions implied by dynamic asset pricing models, Econometrica
  55, 587–613.

                                          30
Hodrick, Robert J., 1992, Dividend yields and expected stock returns: Alternative
  procedures for inference and measurement, Review of Financial Studies 5, 257–286.

Jagannathan, Ravi, and Tongshu Ma, 2003, Risk reduction in large portfolios: Why
  imposing the wrong constraints helps, Journal of Finance 58, 1651–1683.

Jobson, J. David, and Bob Korkie, 1981, Putting Markowitz theory to work, Journal of
  Portfolio Management 7, 70–74.

Keim, Donald B., and Robert F. Stambaugh, 1986, Predicting returns in the stock and
  bond markets, Journal of Financial Economics 17, 357–390.

Ledoit, Olivier, 1995, A well-conditioned estimator for large dimensional covariance
  matrices, Working Paper, UCLA.

Moré, Jorge J., and Gerardo Toraldo, 1989, Algorithms for bound constrained quadratic
 programming problems, Numerical Mathematics 55, 377–400.

Pastor, Lubos, and Robert F. Stambaugh, 2000, Comparing asset pricing models: An
  investment perspective, Journal of Financial Economics 56, 335–381.

Treynor, Jack L., and Fisher Black, 1973, How to use security analysis to improve
  portfolio selection, Journal of Business 46, 66–86.




                                         31
                             Table 1: Approximation Error in Multiperiod Portfolio Policies
     This table describes approximate and exact portfolio policies for an investor with quadratic utility and γ = 4. The approximate solution
     is based on timing portfolios which ignore the compounding of excess returns over time. The exact solution takes compounding into
     account. Panel A is for unconditional portfolio policies involving stocks and bonds. Panel B is for conditional portfolio policies in which
     the stock and bond returns are also scaled by the term spread. Each panel reports the annualized mean, standard deviation, Sharpe ratio,
     and certainty equivalent of the multiperiod portfolio returns. It also reports the average absolute difference between the approximate
     versus exact allocations.

                                                       Panel A: Unconditional Policies


                                   1 Year Horizon                          2 Year Horizon                          5 Year Horizon

                            Monthly            Quarterly           Quarterly          Semi-Annual         Semi-Annual          Annual
                         Approx. Exact       Approx. Exact       Approx. Exact       Approx. Exact       Approx. Exact      Approx. Exact

            Mean           0.0452 0.0427       0.0446 0.0425       0.0401 0.0367      0.0393 0.0365       0.0359 0.0311       0.0350 0.0308




32
         Std. Dev.         0.0918 0.0867       0.0909 0.0867       0.0857 0.0783      0.0846 0.0783       0.0839 0.0720       0.0826 0.0722
        Sharpe Ratio       0.4924 0.4925       0.4906 0.4902       0.4673 0.4684      0.4647 0.4657       0.4281 0.4317       0.4242 0.4267
        Cert. Equiv.       0.0215 0.0216       0.0214 0.0214       0.0185 0.0187      0.0184 0.0185       0.0155 0.0159       0.0154 0.0157
       Avg |∆ Weight|          0.0296              0.0246              0.0383             0.0331              0.0426              0.0369



                                                        Panel B: Conditional Policies


                                   1 Year Horizon                          2 Year Horizon                          5 Year Horizon

                            Monthly            Quarterly           Quarterly          Semi-Annual         Semi-Annual          Annual
                         Approx. Exact       Approx. Exact       Approx. Exact       Approx. Exact       Approx. Exact      Approx. Exact

            Mean           0.0777 0.0668       0.0738 0.0655       0.0637 0.0540      0.0603 0.0527       0.0627 0.0496       0.0586 0.0479
         Std. Dev.         0.1225 0.1041       0.1179 0.1040       0.1122 0.0939      0.1083 0.0940       0.1295 0.0995       0.1251 0.1002
        Sharpe Ratio       0.6343 0.6417       0.6260 0.6298       0.5672 0.5745      0.5565 0.5608       0.4840 0.4987       0.4680 0.4775
        Cert. Equiv.       0.0332 0.0344       0.0329 0.0336       0.0267 0.0279      0.0264 0.0271       0.0235 0.0257       0.0233 0.0247
       Avg |∆ Weight|          0.0312              0.0267              0.0395             0.0346              0.0431              0.0370
                                          Table 2: Single-Period Portfolio Policies
This table shows estimates of the single-period portfolio policy. Standard errors for the coefficients of the portfolio policies in parenthesis.
The p-value refers to an F -test of the hypothesis that all the coefficients on the state variables other than the constant are jointly zero.
The last three rows present statistics of the returns generated by the portfolio policies. Data from January of 1945 to December of 2000.


                  State                   Monthly                             Quarterly                             Annual
                  Variable      Unconditional   Conditional          Unconditional    Conditional        Unconditional    Conditional


        Stock     Const           0.764 (0.185)    0.873   (0.186)   0.770 (0.179)     0.649   (0.185)   0.572 (0.139)     0.591   (0.177)
                  Term                            -0.166   (0.184)                     0.304   (0.223)                     0.249   (0.203)
                  Default                         -0.504   (0.173)                    -0.333   (0.183)                     0.046   (0.155)
                  D/P                              0.796   (0.306)                     0.126   (0.190)                     0.037   (0.149)
                  TBill                           -0.485   (0.459)                    -0.434   (0.235)                    -0.172   (0.242)

        Bond      Const          -0.005 (0.323)    0.291   (0.174)   -0.040 (0.319)   -0.084   (0.389)   -0.074 (0.255)   -0.696   (0.323)
                  Term                            -0.096   (0.173)                     0.840   (0.336)                     0.352   (0.278)
                  Default                         -0.465   (0.404)                     0.144   (0.351)                     0.337   (0.291)
                  D/P                              0.672   (0.310)                    -0.076   (0.458)                    -0.264   (0.373)
                  TBill                            0.773   (0.247)                     0.601   (0.346)                    -0.152   (0.397)

        p-value                                        0.000                              0.000                               0.000

        Mean Excess Return           0.063             0.157             0.065            0.126              0.049            0.095
        Std. Dev. Return             0.111             0.178             0.109            0.146              0.087            0.101
        Sharpe Ratio                 0.589             0.882             0.602            0.864              0.571            0.938
            Table 3: Traditional versus Optimal Conditional Policies
This table shows estimates of the traditional approach to tactical asset allocation. In this approach,
conditional expected returns are obtained from an in-sample regression of returns on the state
variables and the Markowitz solution is applied to these conditional expected returns together with
the unconditional covariance matrix. Panel A displays the estimated regressions of stock and bond
returns on the conditioning variables, each estimated at monthly, quarterly, and annual frequency.
Panel B summarizes the traditional portfolio policy (Trdnl) and, for comparison, the full conditional
policy (Cndtnl) that takes into account the impact of the conditioning variables both on expected
returns and their covariance matrix. The first two rows present the time-series average of the weights
on stocks and bonds of the two policies. The next three lines offer statistics for the time series of
portfolio returns. The last row shows the yearly fee that a mean-variance investor would be willing to
pay to be able to use the full conditional policy instead of using traditional approach.


                                   Panel A: Regression Estimates


                     Coefficient              Monthly          Quarterly              Annual


             Stock   Cnst            0.0813 (0.0220)      0.0896 (0.0265)    0.0828 (0.0236)
                     Term           -0.0618 (0.0233)     -0.0423 (0.0281)   -0.0258 (0.0264)
                     Default         0.0355 (0.0254)      0.0735 (0.0301)    0.0057 (0.0286)
                     D/P            -0.0950 (0.0259)     -0.0431 (0.0315)    0.0177 (0.0286)
                     Tbill          -0.0619 (0.0224)     -0.0374 (0.0274)   -0.0332 (0.0245)
                     R2                  0.0266               0.0339             0.0500

             Bond    Cnst            0.0170 (0.0089)      0.0170 (0.0098)    0.0164 (0.0098)
                     Term           -0.0144 (0.0094)      0.0044 (0.0104)    0.0053 (0.0110)
                     Default         0.0328 (0.0103)      0.0248 (0.0111)    0.0155 (0.0119)
                     D/P            -0.0178 (0.0104)     -0.0040 (0.0116)   -0.0044 (0.0119)
                     Tbill           0.0004 (0.0091)      0.0090 (0.0102)   -0.0213 (0.0102)
                     R2                  0.0126               0.0216             0.1182



                                     Panel B: Portfolio Policies


                                         Monthly            Quarterly           Annual
                                      Trdnl Cndtnl        Trdnl Cndtnl       Trdnl Cndtnl


            Mean Weight Stock        0.5196     0.8121   0.3853    0.5580    0.4923    0.4562
            Mean Weight Bond         0.4783    -0.3624   0.4251    0.6356    0.3929    0.3208

            Mean Excess Return       0.1615     0.1985   0.0940    0.0921    0.0884    0.0574
            Std. Dev. Return         0.1969     0.2154   0.3257    0.1449    0.2098    0.1059
            Sharpe Ratio             0.8204     0.9215   0.2885    0.6361    0.4213    0.5423

            Equalization Fee         0.0195              0.1679              0.0428
                         Table 4: Multiperiod Portfolio Policies
This table shows estimates of the multiperiod portfolio policy with a one-year horizon and monthly or
quarterly rebalancing. Standard errors for the coefficients of the portfolio policies in parenthesis. The
p-value refers to an F -test of the hypothesis that all the coefficients on the state variables other than
the constant are jointly zero. The last three rows present statistics of the returns generated by the
portfolio policies.



   Asset Month/ State                      Monthly                             Quarterly
         Quarter Variable        Unconditional     Conditional        Unconditional      Conditional


   Stock 1/1        Cnst        0.4899 (0.1429)  0.5046   (0.1437)   0.4495 (0.1188)  0.4219   (0.1207)
                    Tbill                       -0.2568   (0.1428)                   -0.0598   (0.3368)
             4/2    Cnst        0.4563 (0.1445) 0.4998    (0.1449)   0.3720 (0.1171) 0.4469    (0.1174)
                    Tbill                       -0.2264   (0.1451)                    0.0923   (0.3427)
             8/3    Cnst        0.4354 (0.1453) 0.4174    (0.1453)   0.3942 (0.1172) 0.4129    (0.1177)
                    Tbill                       -0.1549   (0.1442)                    0.3406   (0.3388)
             12/4   Cnst        0.2788 (0.1437) 0.2206    (0.1436)   0.2477 (0.1198) 0.2074    (0.1214)
                    Tbill                       -0.3654   (0.1439)                    0.6009   (0.3275)

   Bond 1/1         Cnst       -0.2249 (0.3589) -0.2174   (0.3622) -0.0367 (0.3237) -0.1729 (0.1114)
                    Tbill                        0.0685   (0.2059)                   0.0537 (0.1946)
             4/2    Cnst        0.0575 (0.3578) 0.0688    (0.3608) 0.1104 (0.3236) -0.1597 (0.1119)
                    Tbill                        0.0528   (0.2059)                   0.0553 (0.2145)
             8/3    Cnst        0.5084 (0.3561) 0.5267    (0.3579) 0.4375 (0.3234) -0.1322 (0.1121)
                    Tbill                        0.0176   (0.2060)                   0.0194 (0.2153)
             12/4   Cnst        0.6943 (0.3559) 0.6646    (0.3613) 0.5633 (0.3188) -0.2662 (0.1151)
                    Tbill                        0.0343   (0.2063)                   0.1320 (0.1962)

   p-value                          0.0000             0.0000            0.0000             0.0000

   Mean Excess Return               0.0424             0.0570            0.0407             0.0505
   Std. Dev. Return                 0.0882             0.0972            0.0858             0.0914
   Sharpe Ratio                     0.4812             0.5860            0.4740             0.5524
   Figure 1: Portfolio Weights of Conditional and Unconditional Policies
This figure displays the time series of conditional portfolio weights. The solid line corresponds to the
portfolio weight on the stock and the dash-dotted line corresponds to the portfolio weight on the bond.
The constant portfolio weights from the unconditional policy are depicted as straight lines.

                                                         Monthly Rebalancing
                               10
           Portfolio Weights




                                5


                                0


                               −5
                                    1930   1940   1950      1960         1970    1980   1990   2000
                                                         Quarterly Rebalancing
                                6
           Portfolio Weights




                                4

                                2

                                0

                               −2
                                    1930   1940   1950      1960        1970     1980   1990   2000
                                                          Annual Rebalancing
           Portfolio Weights




                                2

                                1

                                0

                               −1

                                    1930   1940   1950      1960         1970    1980   1990   2000
                                                                Year
 Figure 2: Portfolio Weights of Conditional and Regression-Based Policies
This figure displays the time series of the portfolio weight on the stock obtained from the conditional
approach as solid line and from the regression-based approach as dashed line. In the regression-based
approach, conditional expected returns are computed from an in-sample regression of returns on the
state variables, and the Markowitz solution is applied to these conditional expected returns together
with the unconditional covariance matrix.

                                                         Monthly Rebalancing
                               10
           Portfolio Weights




                                5


                                0


                               −5
                                    1930   1940   1950      1960         1970    1980   1990   2000
                                                         Quarterly Rebalancing
                                6
           Portfolio Weights




                                4

                                2

                                0

                               −2
                                    1930   1940   1950      1960        1970     1980   1990   2000
                                                          Annual Rebalancing
           Portfolio Weights




                                2

                                1

                                0

                               −1

                                    1930   1940   1950      1960         1970    1980   1990   2000
                                                                Year
