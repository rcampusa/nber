                              NBER WORKING PAPER SERIES




           PLACE-BASED REDISTRIBUTION IN LOCATION CHOICE MODELS

                                          Morris Davis
                                        Jesse M. Gregory

                                       Working Paper 29045
                               http://www.nber.org/papers/w29045


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     July 2021




We thank participants at The Future of Cities conference at Northwestern University as well as
David Albouy, Cecile Gaubert, Jonathan Dingel, Jan Eeckhout, Andra Ghent, John Kennan,
Patrick Kline, Fabrizio Perri, Esteban Rossi-Hansberg and Chris Taber for helpful conversations.
The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2021 by Morris Davis and Jesse M. Gregory. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Place-Based Redistribution in Location Choice Models
Morris Davis and Jesse M. Gregory
NBER Working Paper No. 29045
July 2021
JEL No. H0,R38

                                         ABSTRACT

In many recent location choice models, households randomly vary with respect to their utility of
living in a location. We demonstrate that the distribution generating this randomness is
fundamentally not identifiable from location choice data and as a result the optimal allocation as
chosen by a social planner is not identified. We propose an algorithm for setting the distribution
generating the random utility across locations that implies a planner will optimally choose no
redistribution in the absence of externalities or equity motives between different groups of
people. Our algorithm preserves a planner's motives to redistribute due to equity considerations
between different types of people and efficiency in production, the focus of many recent studies.


Morris Davis
Rutgers University
Rutgers Business School
Newark, NJ 07102
mdavis@business.rutgers.edu

Jesse M. Gregory
Department of Economics
University of Wisconsin-Madison
1180 Observatory Drive
Madison, WI 53706-1393
and NBER
jmgregory@ssc.wisc.edu
1. Introduction

   For decades, federal, state and local governments have directly or indirectly redistributed
income across locations. This redistribution can take many forms: It can be a subsidy for
development of new low-income housing (Davis et al., 2019); a subsidy to local businesses
operating in low-income areas such as Empowerment Zones (Busso et al., 2013); a large-scale
government works projects (Kline and Moretti, 2014); or other forms. Thus, a central area
of investigation in economics is to understand the context in which redistribution across
locations improves welfare.
   Recent papers by Fajgelbaum and Gaubert (2019), Rossi-Hansberg et al. (2020) and
Gaubert et al. (2020) extend this tradition by studying optimal transfers of income across
households and locations using sophisticated equilibrium location choice models. The mod-
els include well-documented externalities in production and multiple types of households,
for example low- and high-skill. These papers quantify, using the filter of the calibrated
model, transfers across people and locations that improve expected utility for reasons of
both efficiency and equity.
   We show that in location choice models a planner will have three motives to redistribute
resources across locations and people relative to an environment in which households con-
sume the income they generate and do not receive (or pay) transfers. The first, which we
call "across-type equity," is to narrow inequality in consumption across different types of
households, for example low-skill and high-skill. The second, which we call "efficiency,"
arises from externalities and spillovers across types in production; the planner will transfer
resources to provide incentives for households to internalize the external impacts of their
decisions. Understanding motives for redistribution arising from these first two reasons has
been the focus of recent studies.
   We show that a planner has a third reason to redistribute in these models: To equate the
average marginal utility of consumption of otherwise identical households that make different
location choices. A typical prediction is that a planner will redistribute resources from ex-
ante identical households choosing to live and work in high-income locations to households
choosing low-income locations. We call this third motive "within-type transfers."
   To understand why a planner may wish to make within-type transfers in location choice

                                              1
models, we need to provide some background. For all locations to be occupied in models with
ex-ante identical households, some households must choose to live in low-income locations.
In an older literature that relies on the Rosen-Roback model (Roback, 1982) to describe the
economic environment, utility in every location is assumed identical and each household is
indifferent as to its location. The Rosen-Roback model implies that population elasticities
are infinite with respect to a small change in location attributes such as consumption or
amenities holding all else fixed.
   This infinite elasticity is not realistic and many researchers now use a different frame-
work where utility in every location is not assumed to be equal. Instead, households receive
"location attachment" draws that affect the utility of living in each location. These draws
randomly vary across locations and households, and with these draws included in the model
households are not indifferent to where they live. Some households will not leave their loca-
tion in response to marginal changes in utility, and researchers can calibrate the distribution
of the draws to match empirical population elasticities with respect to changes in wages,
amenities, or other location characteristics. The fact that some households are sticky with
respect to location choice raises the possibility of welfare-improving place-based policies. The
calibration of the distribution of the location attachment draws that generates this stickiness
enables accurate predictions about behavioral responses to policy.
   Unfortunately, we document that the exact distribution of these location attachment
draws is fundamentally not identifiable from location choice data: A continuum of distri-
butions predict exactly the same elasticities and probability distribution over all location
choices. We show this lack of identification implies the size and direction of optimal within-
type transfers are not identified, even when a model includes all three motives for redistribu-
tion. Different, untestable assumptions about the distribution of location attachment draws
can lead to large swings in predicted optimal within-type transfers and the uncertainty this
creates potentially swamps predicted redistribution arising from the motives of across-type
equity or efficiency. When researchers compare policies across a number of scenarios we often
do not know the role played by within-type transfers in generating changes to policy as com-
pared to the roles of across-type equity or efficiency. We therefore propose an adjustment
to the standard planning problem that eliminates within-type transfers, while preserving


                                               2
motives for the planner to redistribute for reasons of across-type equity or efficiency.
   Our paper proceeds as follows. We start by studying a simple model with only one
type of household and no externalities where the only reason for redistribution arises from
within-type transfers. We assume the location attachment draws are iid from the Fr´
                                                                                  echet
distribution, as is typical. We then derive the result that a planner will redistribute income
from households choosing to live in high-income locations to households choosing to live in
low-income locations.
   Next, we use the intuition of optimal unemployment insurance from the work of Chetty
(2006) to show why this result arises. Optimal transfers across locations equate across-
location differences in the average marginal utility of consumption to the deadweight loss in
tax collection arising from a marginal change in these transfers. The Fr´
                                                                        echet distribution
implies a particular outcome for differences in the average marginal utility of consumption
across locations. The Fr´
                        echet distribution is just one possible distribution for the location
attachment draws. If researchers are only interested in predictions as to how location choices
respond to various changes in wages or amenities, then the choice of the Fr´
                                                                           echet from the
class of distributions we describe is harmless, as the other distributions imply exactly the
same location choice elasticities. It is only when researchers wish to study optimal policy
that the choice of the Fr´
                         echet has consequences. We show using both theory and simulations
that we can choose from an infinite class of distributions of location attachment draws to
have the following features: (i) the probability distribution over location choices is exactly
the same as when the draws are from the Fr´
                                          echet but (ii) differences in the average marginal
utility of consumption across locations can vary by a wide margin, fundamentally changing
predicted optimal within-type transfers. We show this uncertainty can overwhelm predicted
transfers arising from across-type equity or efficiency considerations in more complicated
models.
   Since location choice data cannot be used to identify the distribution of the location
attachment draws, and therefore optimal within-type transfers, we propose a method for
researchers to set the distribution of these draws that does not change any aspect of the
distribution over location choices or alter any location choice elasticity, but sets differences
in the average marginal utility of consumption across locations equal to zero. In a simple


                                               3
model with one type of household and no externalities, after applying our adjustment a
planner will not redistribute resources across locations. In a more complex model, with
multiple types of households and an externality and spillovers across types in production,
our adjustment removes motives for redistribution arising from within-type transfers, but
preserves motives to redistribute arising from across-type equity and efficiency.


2. Proving Lack of Identification of Within-Type Transfers

2.1. A Common Model

   We start by considering the predictions of a simple location choice model with no ex-
ternalities and one type of household that is at the core of some more complicated models.
The economy consists of a measure 1 of ex-ante identical households and each household
must choose where to live from one of n = 1, . . . , N discrete locations. Households value
consumption, which is produced and transferrable across locations. Each household living in
location n produces zn units of output. Ln is the measure of households living and working
in n.
   Denote cn as consumption enjoyed by each household living in location n, not necessarily
equal to zn . The utility of household i choosing to live in location n is


                                         uni = An cn eni


An are amenities freely enjoyed by all households living in location n. eni is a level of at-
tachment to location n by household i that varies across locations and households. Each
household draws and observes eni for n = 1, . . . , N before making a location choice. House-
holds differ only with respect to these draws. We assume, as is common, that the eni are
drawn iid across locations for each household and iid across all households from the Fr´
                                                                                       echet
distribution with shape parameter  .
   Consider a planner with the objective to maximize expected utility subject to satisfying
aggregate feasibility,   n zn Ln   =   n cn Ln ,   population feasibility, 1 =   n   Ln , and respects
that households choose the location offering the maximum value of uni , i.e. household i
                                  N
chooses n        
         i when ni = argmax {uni }n=1 . We show in Appendix A that a planner that



                                                    4
maximizes expected utility will relate the per-household consumption differential between
any two locations n and n to the per-household income differential of those locations as
follows


                              cn - cn
                                    = (1 -  ) (zn - zn )                                 (1)
                                        1
                              with  =
                                      1+

Equation (1) illustrates what we call within-type transfers, as the planner optimally redis-
tributes consumption from households living in high income locations to those living in low
income locations. Households choosing to work and live in low income locations receive sub-
sidies that are funded by otherwise identical households choosing to work to work and live
in high income locations. At a typical calibration of  = 2 (Rossi-Hansberg et al., 2020),
 = 1/3.

2.2. Economics of Within-Type Transfers

   So why does the planner wish to redistribute income in this model? After all, there
are no externalities and all households have the ability to choose any location in which to
live and earn the income of that location. We use intuition from the literature on optimal
unemployment insurance show why a planner makes within-type transfers. Consider a simple
setup with only 2 locations where locations differ in their income per household, denoted w1
and w2 . Assume residents of location 2 pay a tax t to finance a subsidy b paid to residents
of location 1. For example, when z1 = w1 and z2 = w2 it can be shown equation (1) implies

                            (1 - L1 ) (z2 - z1 )         L1 (z2 - z1 )
                      b =                        and t =
                                  1+                        1+

   Each household draws idiosyncratic preferences for locations we label as 1 and 2 and
chooses the location that provides the highest utility. Utility is derived from consumption
bundled with each individual's draws of 1 and 2 . Expected utility in this simple model is

                                                                               L1
          V   = E1 ,2 max u w1 + b, 1 , u w2 - t(b), 2       with   t(b) =          b
                                                                             1 - L1



                                             5
The second expression is the government balanced budget condition assuming there is a
measure 1 of households in the economy.
                                                             dV
       The optimal subsidy is the value of b at which           = 0. To characterize this optimal
                                                             db
subsidy, begin with the expression,

                           dV        V   dt V   L1 dt L1 V
                                =      +      +   +       
                           db        b   db t   b   db t L1
                                                                            =0


Importantly, the third term is equal to zero because individuals who switch locations in
response to a marginal policy change receive the same utility in both locations.1
       The partial effects of changing b and t depend only on the populations of the two locations
and the average marginal utility of consumption of residents in each location, denoted µ1
and µ2 :

                                                        µ1

               V                u w1 + b, 1
                     = L1 E                 u w1 + b, 1 > u w2 - t, 2
               b                   w1
               V                        u w2 - t, 1
                     = -(1 - L1 ) E                 u w1 + b, 1 < u w2 - t, 2
               t                           w2
                                                               µ2


The government balanced budget condition implies that

                                                      1      dL   b
                                    dt     L1
                                       =        1 + db L1
                                    db   1 - L1    1 - L1

The first term is the mechanical change in the tax is necessary to finance the change in
transfers in the absence of any behavioral responses. The second term captures the fact that
an additional tax increase is necessary to offset the population response to the change in

   1
    dt/db is not a partial derivative both because people move as a result of the policy and because of the
need to balance the budget.




                                                    6
taxes/transfers. We can now write

                                                          1  dL    b
                     dV                        L1
                           = L1 µ1 -                1 + db L1 (1 - L1 )µ2
                     db                      1 - L1    1 - L1
                                                      dL1 b
                                                       db L1
                           = L 1 µ1 - µ2        1+
                                                      1 - L1

In the case when the current transfer is b = 0, the planner wishes to transfer consumption
to the location with the higher marginal utility of consumption. At the optimal transfer b
(satisfying dV /db = 0), we have

                                                    1   dL     b
                                       µ1 - µ2
                                               = db L1                                     (2)
                                          µ2     1 - L1

This result is exactly analogous to the Baily-Chetty formula of Chetty (2006) characterizing
the optimal generosity of unemployment insurance. The left-hand side is the insurance
benefit of moving 1 dollar (in total) from location 2 to location 1, which, for most commonly
considered utility functions, is decreasing in b. The right-hand side describes the marginal
cost of raising one dollar in total from location 2, which captures the fact that as benefits
rise, the population of location 1 also increases which causes an excess burden of transferring
one additional dollar.

2.3. Location Choice and Location Specific Preference Draws

   In a two location model where ein are iid drawn from the Fr´
                                                              echet, we can derive the
left-hand side of equation (2). A household chooses location 1 whenever e1 > e2 t where
t = A2 c2 / (A1 c1 ). This implies the following expected values

                                                                         1
                         E e1    e1 > e2 t    = (1 + t )1/  1 -
                                                                         
                                                                   1/         1
                      E e2      e2 > e1 /t    = (1 + (1/t) )             1-
                                                                              

where  is the gamma function. The average marginal utility of consumption of households
living in locations 1 and 2 is equal to the appropriate expression above multiplied by A1
for location 1 and A2 for location 2. After cancelling redundant terms, the left-hand side of

                                                  7
equation (2) is equal to2

                                                                            1/
                                                        (A1 c1 ) + (A2 c2 )
                                                             
                                    1/
                 A1      1 + t                   A1           (A1 c1 )      
                                         - 1 =                             
                                                                               - 1
                 A2    1 + (1/t)                 A2  (A2 c2 ) + (A1 c1 ) 
                                                              (A2 c2 )
                                               1/c1 - 1/c2
                                             =
                                                   1/c2

       We now write down a transformation of the location attachment draws that yields exactly
the same probability distribution over all location choices but different values for the left-
hand side of equation (2) and therefore different optimal within-type transfers. Start by
noting that the optimal location choice for household i, call it ni , satisfies



                          ni = argmax [A1 c1 e1i , A2 c2 e2i , . . . , AN cN eN i ]



Suppose a researcher had considered a different distribution for the location attachment
draws, eni , such that the optimal location choice for household i resulting from this distri-
bution, call it ni , satisfies



                          ni = argmax [A1 c1 e1i , A2 c2 e2i , . . . , AN cN eN i ]



When eni = Di eni , with Di random but taking on a single realized value for each household
i, optimal location choices for every household are identical to those when household utility
is An cn eni :


                      ni = argmax [A1 c1 e1i , A2 c2 e2i , . . . , AN cN eN i ]

                          = argmax [A1 c1 Di e1i , A2 c2 Di e2i , . . . , AN cN Di eN i ]

                          = argmax [A1 c1 e1i , A2 c2 e2i , . . . , AN cN eN i ]

                          = ni


   2
     Note that the Fr´echet shape parameter  only determines the marginal deadweight loss from increasing
transfers, the right-hand side of equation (2). This expression shows  does not determine any benefits, the
left-hand side of equation (2).


                                                      8
Di is fundamentally not identifiable from location choice data as optimal choices from eni
are all exactly the same as with eni .3

2.4. Lack of Identification of Optimal Transfers

       For predicting population responses to various changes in location attributes such as
consumption and amenities, setting Di = 1 for all households is harmless as location choice
predictions do not depend on Di . For the purposes of deriving optimal within-type transfers,
setting Di = 1 for all households is an arbitrary assumption with significant consequences
as any correlation of Di with one or more of the draws of eni for n = 1, . . . , N can change
predicted optimal transfers.
       To see this, define utility in location n for household i as


                                    An cn eni   with eni = Di eni


where eni are drawn iid from the Fr´
                                   echet and Di is defined as:

                                                        N          -1

                                            Di =             e n
                                                              ni
                                                       n=1


The parameters 1 , 2 , . . . , N govern the correlation of Di and each eni ; for now, we as-
sume these parameters are the same for all households. Throughout the text, we describe
1 , 2 , . . . , N as nuisance parameters since they are not identifiable from location choice
data. Now consider three cases of (1 , 2 ) for the two location model with A1 = A2 = 1 and
z1 = z2 .

   3
     We can use the results of Matzkin (1993) to formally state what is identified in this model. Define utility
in location n for household i as An cn Di eni . For arbitrary location m, the probability a household chooses
to live in m, call it m , is

              m {An }N          N
                     n=1 , {cn }n=1
          =   Prob{log Am + log cm + log Di + log emi > log An + log cn + log Di + log eni }   for n = m
          =   Prob{log emi - log eni > log An - log Am + log cn - log cm }   for n = m

The joint CDF of the N-1 terms (log emi - log eni ) is all that is nonparametrically identified, assuming
sufficient continuous variation in consumption or amenities. Notice that the Di terms do not appear and
therefore they are not identifiable.



                                                       9
· Case 1: 1 = 2 = 0


         Utility in location 1 = c1 e1i and Utility in location 2 = c2 e2i


  Household i chooses location 1 as long as e1i /e2i  c2 /c1 . Given the eni are drawn iid
  from the Fr´
             echet distribution, optimal transfers are characterized by equation (1), and
  since z1 = z2 the planner optimally sets c1 = c2 and no resources are transferred across
  locations.

· Case 2: 1 = 0 and 2 = 1

                                        e1i
        Utility in location 1 = c1                 and Utility in location 2 = c2
                                        e2i

  Household i chooses location 1 as long as e1i /e2i  c2 /c1 implying that for any given
  values of e1i and e2i , households choose exactly the same locations as in case 1.

  The planner will not optimally choose to set c1 = c2 . Suppose that c1 = c2 and
  households choose location 1 whenever e1i /e2i > 1. The marginal utility of consumption
  for all households living in location 2 is always 1. The average marginal utility of
  consumption for all households choosing to live in location 1 at at this allocation is

                                      e1i     e1i
                                  E               >1     > 1
                                      e2i     e2i

  When c1 = c2 , the average marginal utility of consumption of residents optimally
  choosing to live in location 1 is strictly larger than the average marginal utility of
  consumption of residents choosing to live in location 2. Therefore, the planner will
  transfer some consumption from location 2 to location 1 and c1 > c2 .

· Case 3: 1 = 1 and 2 = 0 such that

                                                                             e2i
        Utility in location 1 = c1 and Utility in location 2 = c2
                                                                             e1i

  As with cases 1 and 2, household i chooses location 1 as long as e1i /e2i  c2 /c1 . For any


                                              10
      given values of e1i and e2i , households optimally sort into exactly the same locations
      as in cases 1 and 2. Now consider the allocation c1 = c2 , such that households choose
      to live in location 2 whenever e2i /e1i > 1. The marginal utility of consumption for all
      households living in location 1 is 1. The average marginal utility of consumption for
      all households choosing to live in location 2 is

                                          e2i   e2i
                                      E             >1     > 1
                                          e1i   e1i

      At the allocation c1 = c2 , the average marginal utility of consumption of households
      optimally choosing to live in location 2 is strictly larger than the average marginal
      utility of consumption of households choosing to live in location 1. The planner will
      transfer some consumption from location 1 to location 2 and c2 > c1 , exactly the
      opposite result as in case 2.

   In each of cases 1-3, households choose to live in location 1 as long as e1i /e2i  c2 /c1 and
this choice is completely independent of the values of 1 and 2 . Yet in case 1 the planner
chooses no transfers, in case 2 the planner transfers consumption from location 2 to location
1, and in case 3 the planner transfers consumption from location 1 to location 2. Thus, the
size and direction of the transfers is determined by the nuisance parameters 1 and 2 .
   This simple example is sufficient for the general point we wish to make: Since 1 , 2 , . . . , N
are not identified from location choice data, optimal within-type transfers across locations
are also not identified.

2.5. Numerical Examples

   To illustrate the potential quantitative significance of this problem, we simulate the
planning solution to a two location version of the model when utility for household i in
location n is defined as


                             uni = An cn eni
                                                                N          -1

                       with eni = Di eni        and Di =             e n
                                                                      ni
                                                               n=1




                                                11
where eni is drawn iid from the Fr´
                                  echet distribution with shape parameter  = 2. In simula-
tions we consider values of 1  {0.0, 0.5, 1.0} and 2  {0.0, 0.5, 1.0}. For all combinations
of 1 and 2 , we consider the case of equally productive locations, z1 = z2 = 1.0, and location
1 more productive, z1 = 4/3 and z2 = 2/3. We set A1 = A2 = 1.0 in all simulations.
   Given the draws of eni , we assume each household chooses the location that provides
the highest level of utility and then determine the allocation of consumption to residents of
each location that maximizes overall average utility in the economy, subject to the resource
constraint       Ln (zn - cn ) = 0 and population constraint       Ln = 1. Note that when 1 =
             n                                                 n
2 = 1, eni is drawn iid from the Weibull distribution, the focus of an early draft of our
paper.
   The top panel of Figure 1 shows results for the case in which residents of both locations are
equally productive and the bottom panel shows results when residents of location 1 are more
productive. The y-axis of the top panel marks per-household consumption in location 1 less
that of location 2, c1 - c2 , and the y-axis of the bottom panel marks the ratio of the difference
in per-household consumption to the difference in per-household income, (c1 - c2 ) / (z1 - z2 ).
The x-axis of both panels marks the value of 2 and the different lines show results for various
values of 1 . The dashed black lines mark allocations where consumption in each location
equals production in that location and no within-type transfers occur.
   The case of iid draws from the Fr´
                                    echet is shown at (1 , 2 ) = (0, 0), the dark blue circle in
each panel. In this case, when the two locations are equally productive, there are no transfers
(top panel); and when households in location 2 are more productive than in location 1, the
planner redistributes (c1 - c2 ) / (z1 - z2 ) = 2/3 = 1 - (1 +  )-1 of that difference, exactly as
predicted by equation (1). Unfortunately, Figure 1 also makes clear that optimal transfers
can vary quite a lot depending on the other values of the nuisance parameters (1 , 2 ). For
any value of 1 , increasing 2 ­ a movement from left to right along any given line ­ increases
consumption allocated to households living in location 1 relative to those living in location
2. For any given value of 2 , increasing 1 ­ moving down from a higher line to a lower line
holding 2 fixed ­ increases allocations of consumption to households living in location 2
relative to those in location 1. These patterns are consistent with the intuition of the three
cases discussed in section 2.4.


                                               12
3. Method for Eliminating Motive for Within-Type Transfers

3.1. The Method

   Since location choice data do not identify optimal within-type transfers, we advocate
setting the distribution of the location attachment draws such that the planner optimally
chooses no within-type transfers in a simple model with one type of household and no exter-
nalities. Below, we propose a 5-step algorithm to find a distribution of location attachment
draws that accomplishes this objective and does not change any household's optimal location
choice. Throughout the text, we describe this algorithm as implementing an adjustment to
the planning problem:

  1. Guess a variable called i = 1.0 for all households in the simulation
  2. Multiply the utility function by i . Find the allocation of cn for all n = 1, . . . , N and

       = 1, . . . , T that is feasible and maximizes the planner's objectives at the current
      guess for i .
  3. Given each household's optimal choice at this allocation, ni , compute i as the inverse
      of the marginal utility of consumption for that household at the optimally chosen
      location. For example, using the framework described in section 2.5, if we define ni as
      the optimally chosen location for household i at the current guess of cn then we set

      i = (Ani Di eni )-1 .
  4. Compute i = i + d · (i - i ), where d  (0, 1] is a dampening factor.
  5. Update i = i and repeat steps 2-5 until cn has converged.


This algorithm finds the solution the planner's problem that is consistent with the marginal
utility of consumption equal to 1 for all households, thus setting the left-hand side of equation
(2) to zero.

3.2. The Adjustment Applied to the Simple Model

   Denote the planner's objective as O. In the model we have analyzed so far, our adjustment
normalizes the location attachment draws as follows


          O = Ei max {An cn eni }N
                                 n=1         where eni = i eni and eni = Di eni              (3)
                        n


                                               13
In the above, eni are the normalized draws and i is set to the inverse of the marginal
utility of consumption for household i at the planner's optimal allocation. Explaining, if
household i optimally chooses location n                                                    
                                        i given the planner's allocation c1 , c2 , . . . , cN , then
                        -1
i = Ani
        Di enii
                             . Since i is fixed across locations for any given household it does
not affect any location choices of households; additionally, since i rescales the draws such
that all households have the same marginal utility of consumption of 1, the planner has
no motives for within-type transfers. Given any initial researcher chosen distribution of
location attachment draws eni , eni implies exactly the same optimal location choices but
removes motives for the planner to implement within-type transfers.
      Referring to Figure 1, when we set i in this way, the planner optimally chooses the
dashed line at 0.0 in the top panel (c1 = c2 = z1 = z2 ) and the dashed line at 1.0 in the
bottom panel for any combination of the nuisance parameters (1 , 2 ) determining Di .

3.3. More Complicated Models

3.3.1. Theory
      In our introduction, we describe three possible motives for a planner to redistribute re-
sources across people and locations: Across-type equity, efficiency, and within-type transfers.
So far, we have analyzed a simple model where a planner has no motives for redistribution
due to across-type equity (as there is only one type of household) or efficiency (as there are
no externalities). We now show that in a more complicated model where all three motives
may be present, our adjustment removes motives for within-type redistribution but motives
for redistribution due to across-type equity and efficiency remain.
      Consider an environment in which there are are n = 1, . . . , N discrete locations,  =
1, . . . , T distinct types of people, and possible externalities and complementarities across
types in production. We assume a planner can choose any level of consumption for any type
of household in any location, as long as the overall allocation satisfies aggregate feasibility
conditions and respects individual optimization, i.e. households are assumed to optimally
choose locations given their location attachment draws and given the allocation of consump-
tion across locations.4

  4
      In this framework, the planner does not need to and will not want to implement across-location transfers


                                                      14
    The planner chooses consumption for each type in each location to maximize the social
welfare function


                                                   L U (V  )                                                      (4)
                                               


where  is the planner's Pareto weight on type  households in the economy, L is the
total population of type  , V  is the expected utility associated with a type  household and
U is a concave function. The constraints on the problem are listed below, with Lagrange
multipliers placed to the left of the brackets:

 Expected Utility, by type:  = 1, . . . , T                                         Eeni max uni             -V         = 0
                                                                                                n

 Resource constraint:                                                                            P           t   
                                                                                                              n Ln      = 0
                                                                                                      n   

 Population, by type:  = 1, . . . , T                                                             L -            Ln     = 0
                                                                                                             n
 Optimization, by type and location:  = 1, . . . , T and n = 1, . . . , N                       [ L - L ] = 0
                                                                                              Wn n     n


 L                                             
  n is the population of type  in location n, uni for agent i of type  is the function

un (cn , Di , eni ) with c                   
                          n = zn - tn where zn is income generated by one type  worker in

location n.5                                        
             n is the probability that n = argmaxn un i for n = 1, . . . , N .

    In Appendix B.1 we derive the solution to this problem; below we copy the equation
from that Appendix that characterizes optimal location- and type-specific transfers for type
 in location n

                   U   µn - U ¯
                              µ     n                           1                    m
                                -     =                                    tmL
                                                                              
                      U ¯ µ       U ¯
                                    µ                           Ln     m
                                                                                    tn


                           (1)                    (2)                      (3)

This solution is similar to the solution of the simple model, equation (2), but modified to

as a means to implement across-type transfers. We can modify the environment to restrict transfers across
locations to be identical across types. If different types tend to occupy different locations, then across-
location transfers accomplish some across-type redistribution (Gaubert et al., 2020). This changes details of
the solution but does not affect our general conclusions.
   5
     This can be a function of L                                                 1    2            T
                                n for  = 1, . . . , T , for example zn = z zn , Ln , Ln , . . . , Ln where zn is TFP
for location N .



                                                        15
allow for multiple types of people in the economy and the possibility of complementarities
across types and externalities in production. For a given type  in location n, the first term
on the left-hand side captures the difference in the Pareto-weighted (U   ) marginal utility
of consumption of that type in that location (µn ) from the economywide-average marginal

utility of consumption (U ¯
                          µ) and the second term captures the economy-wide utility net
benefit of production spillovers generated by that type in that location (     6
                                                                           n ). The difference

of these two terms is equated to the marginal deadweight loss from increasing transfers, the
third term.
       In Appendix B.2, we derive the impact of our procedure on the solution for the optimal
transfer to type  in location n, which we copy below

                                                            1                   m
                        U   - U            -     
                                                 n   =                 tmL
                                                                          
                                                                                                          (5)
                                                            Ln     m
                                                                               tn


After the adjustment, the planner continues to have motives to transfer resources across
types and locations. The right-hand side of equation (5), the marginal deadweight loss
from increasing transfers, does not change. The term in parentheses on the left-hand side,
U   -U , is constant across locations for any given type, but this term allows for transfers
arising from motives of across-type equity based on differences in Pareto weights  and the
slope of the concave function U evaluated at the optimal policy.7 The term                  
                                                                                            n   measures the
impact of spillovers and externalities in production and within-type variation in this term
determines across-location, within-type transfers.

3.3.2. Numerical Examples
       We now demonstrate that optimal transfers across locations are unidentified in more
complicated models by examining these transfers in an environment with two locations and

   6
     The U  term is the derivative of the U function in the planner's objective function for type  .  is a
scalar related to economy-wide fiscal externalities, marginal utilities of consumption and average production
externalities and spillovers.
   7
     Our adjustment causes the marginal utility of consumption of all households of all types to be identical.
This means that the planner will not redistribute from high-income types to low-income types unless the
Pareto weights for low-income types are higher than for high-income types. Researchers can pick Pareto
weights to replicate optimal across-type transfers that are the solution to the planner's problem prior to
applying our adjustment, if desired.



                                                     16
two types of people. In what follows, the planner maximizes equation (4) where U is the
natural logarithm function and 1 = 2 = 0.5 such that the planner cares about both
types equally. Denote cn as the consumption the planner allocates to type  agents living in

location n. Utility of household i of type  in location n is


                           An cn eni
                                                                            -1
                                                                  
                           where eni = Di eni and Di =          e1i1 e2i2


implying V  = Ei [max An c   
                          n Di eni ]. In all simulations, we draw eni iid from the Fr´
                                                                                     echet
distribution with shape parameter  = 2. We always set (    
                                                       1 , 2 ) = (0, 0) for type  = 2 and

consider (    
          1 , 2 ) = (0, 0) , (0, 1) , (1, 0) and (1, 1) for type  = 1. As before, A1 = A2 = 1.

   In each location, the two types of labor are aggregated as follows to form a composite
labor input

                                                               1/
                               Ln =        1    1
                                           n · Ln      + L2
                                                          n



L1      2
 n and Ln are the measures of type 1 and type 2 households in location n, respectively.

Total output produced in location n is zn Ln with zn = 4/3 in location 1 and 2/3 in loca-
tion 2. We consider two different values for ,  = 1.0 (perfect substitutes) and  = 0.5
(complementarities across types in production).
   In all simulations, we set 1
                              n = 1 for location 2 (n = 2). In simulations without any

externalities, we set 1
                      n = 1 for location 1. In simulations with an externality, we specify an

increasing impact of the share of type 1 workers on type 1 productivity in location 1

                                                           
                                                   L1
                                                    n
                                       1
                                       n   =
                                                L1
                                                 n +  L2
                                                       n


for n = 1 (only) with  = 0.15. In all simulations we specify population measures of 0.32
type 1 households and 0.68 type 2 households.
   Figure 2 shows results for optimal within-type redistribution across locations for type
1 agents for the economy without an externality (top panel) and the economy with an
externality (bottom panel). We measure this redistribution as (c1    1       1    1
                                                                1 - c2 ) / (w1 - w2 ), where


                                               17
 1
wn is the marginal product of labor of type 1 agents living in location n, measured as

                                                             -1
                                 1
                                wn = zn L1- 1
                                            n           L1
                                                         n



A value of 1.0 indicates that no within-type redistribution across locations occurs for type
1 agents; a value less than 1.0 indicates that consumption is redistributed from type 1
households living in location 1 to those living in location 2; and, and a value greater than 1.0
indicates consumption is redistributed from type 1 households living in location 2 to those
living in location 1.
   For now, ignore the black lines in Figure 2 and focus only on the blue and red lines. The
solid blue and red lines in both panels correspond to  = 1, perfect substitutes, and the
dashed blue and red lines correspond to  = 0.5. The x-axis of each graph shows the value
of 2 for  = 1, either 0 or 1. The y-axis shows the measure of within-type redistribution

for Type 1 households. Finally, the blue lines correspond to values for 1 = 0 for  = 1 and

the red lines correspond to values for 1 = 1, also for  = 1.

   A few points jump out from this figure. First, by comparing the results in the bottom
panel to those in the top panel, we can see the impact of the externality on redistribution: For
any given parameterization of ,       
                                1 and 2 for  = 1, the planner wants less redistribution

from type 1 residents in location 1 to location 2 when the externality is present. Second,
by comparing the dashed to solid lines for either the blue or red lines, we can observe how
the elasticity of substitution of the two types in production affects optimal redistribution
from type 1 residents in location 1 to location 2. Finally, the figure shows how the nuisance
parameters                                                                   
           1 and 2 for  = 1 affect optimal redistribution. When the value of 1 is large

relative to 2 for  = 1, the marginal utility of consumption of households optimally choosing

location 1 is relatively low, and the planner optimally redistributes consumption away from
location 1 and towards location 2. When the value of                        
                                                     2 is large relative to 2 for  = 1, the

opposite happens. As the panels make clear, the unidentifiable variation in       
                                                                            1 and 2 for

 = 1 can cause optimal transfers across locations for type 1 agents to be almost anything,
even in the presence of a large externality in production in one location.
   To implement our adjustment, we redefine the location attachment draws for household


                                              18
i of type  in location n such that utility is


         A n cn eni                                                                                       (6)
                                                                        -1
                                                                                                        -1
         where eni = i eni , eni = Di eni , Di =            e1i1 e2i2        and i =    Anii
                                                                                             Di enii




where ni is the optimally chosen location for agent i given realized eni at the planner's
                                                  
optimal allocation of consumption for that type cn for n = 1, . . . , N . Including i in utility

in this way ensures that the average marginal utility of consumption in a location is constant
across locations at the planner's chosen allocation, and thus the planner has no motive to
redistribute to equate within-type marginal utilities of consumption.8
       The impact of the adjustment on redistribution among Type 1 agents is shown by the
black lines in Figure 2. In the top panel, the version of the model with no externalities,
the planner chooses no redistribution. This result does not depend on the the value of ,
     
1 or 2 for  = 1. In the bottom panel, the planner chooses to redistribute from type 1

agents living in location 2 to type 1 agents living in location 1, to incentivize type 1 agents to
live in location 1 due to the production externality. The amount of redistribution does not
depend on 1 or 2 but does depend on the elasticity of substitution in production between
the two types of agents. This example shows our adjustment allows for the direct study of
optimal place-based transfers in response to production externalities and spillovers across
types, without the size and the direction of those transfers influenced by differences in the
marginal utility of consumption across locations that are not identifiable from location choice
data.

3.4. Discussion of Uniqueness

       In all simulations where we apply our adjustment, we use the 5-step procedure outlined
in section 3.1 to find optimal allocations. Since we are embedding something that looks like
a fixed point into the planning problem, readers might be concerned this procedure may not
produce a unique candidate solution. The procedure finds an allocation with the following

   8
    As discussed, the planner may still want to redistribute across locations and types for reasons of across-
type equity or efficiency.



                                                     19
property: With weights i set equal to the inverse of the marginal utility of consumption
at the candidate allocation, the candidate allocation solves the adjusted planner's problem
­ adjusted to include i . An allocation has this property if and only if it is a solution to
equation (5). Therefore, if equation (5) has a unique solution our procedure also produces
a unique solution. Uniqueness of equation (5) depends on researcher choices that determine
elasticities, externalities, and Pareto weights.9 As long as researchers can prove equation (5)
has a unique solution, then our experience suggests our procedure will find that solution as
long as the dampening factor d is sufficiently small.10


4. Additional Thoughts and Conclusions

       The essence of results we document have been identified in at least one other area of
economics. For example, we can relate the differences in predicted optimal transfers between
our cases 2 and 3 from section 2.4 to intuition from Klevin et al. (2009) on optimal taxation
of married couples. In that paper, the secondary earner can choose not to work for one of
two reasons: he/she either receives a bad draw of market earnings or a good draw of home
productivity. Klevin et al. (2009) show that optimal policy depends on which of the two
explanations caused the secondary earner to not work in the market.11
       One path for future research may be to use data to estimate differences across locations in
the average marginal utility of consumption of otherwise identical households. Researchers
in other fields of economics have attempted to estimate state dependence in the marginal
utility of consumption. For example, health economists have tried to identify how the state
of a person's health affects their marginal utility of consumption. Finkelstein et al. (2009)
survey the various approaches and results in the literature and conclude, "Currently available
estimates offer little in the way of a consensus on the sign or magnitude of health state
dependence." The hurdle for estimation is high in location choice models, as researchers
need to understand variation in the average marginal utility of consumption across locations
and we believe this will be difficult to measure. Even if a policy experiment exogenously

   9
     For example, multiple candidate solutions may exist depending on the properties of agglomeration ex-
ternalities in the model.
  10
     We set the dampening factor to 1 (no dampening) in all the numerical examples in this paper.
  11
     We thank Patrick Kline for suggesting this connection.


                                                   20
shifts location choices of some marginal households, optimal policy depends on the marginal
utility of consumption of all households including ­ perhaps most importantly ­ those least
likely to move. Until we have direct evidence on differences in the average marginal utility
of consumption across locations, we advocate imposing a solution to planning problems that
removes a planner's incentives for within-type transfers across locations absent motives of
productive efficiency or externalities.




                                            21
References

Busso, M., Gregory, J., Kline, P., 2013. Assessing the incidence and efficiency of a prominent
  place based policy. American Economic Review 103, 897­947.

Chetty, R., 2006. A general formula for the optimal level of social insurance. Journal of
  Public Economics 90, 1879­1901.

Davis, M.A., Gregory, J., Hartley, D.A., 2019. The long-run effects of low-income housing
  on neighborhood composition. Working Paper.

Fajgelbaum, P.D., Gaubert, C., 2019. Optimal spatial policies, geography and sorting.
  Forthcoming, Quarterly Journal of Economics.

Finkelstein, A., Luttmer, E.F.P., Notowidigdo, M.J., 2009. Approaches to estimating the
  health state dependence of the utility function. American Economic Review 99, 116­121.

Gaubert, C., Kline, P., Yagan, D., 2020. Placed-based redistribution. Working Paper.

Klevin, H., Kreiner, C., Saez, E., 2009. The optimal income taxation of couples. Economet-
  rica 77, 537­560.

Kline, P., Moretti, E., 2014. Local economic development, agglomeration economies and the
  big push: 100 years of evidence from the tennessee valley authority. Quarterly Journal of
  Economics 129, 275­331.

Matzkin, R.L., 1993. Nonparametric identification and estimation of polychotomous choice
  models. Journal of Econometrics 58, 137­168.

Roback, J., 1982. Wages, rents, and the quality of life. Journal of Political Economy 90,
  1257­1278.

Rossi-Hansberg, E., Sarte, P.D., Schwartzman, F., 2020. Cognitive hubs and spatial redis-
  tribution. Working Paper.




                                             22
Figure 1: Redistribution from Location 2 to 1, Various Values of 1 and 2



                 c1-c2

               .3


               .2


               .1


                0


               -.1


               -.2

                                                                                      1 = 0.0          Adj: 1 = 0.0
               -.3
                                                                                      1 = 0.5          Adj: 1 = 0.5
                                                                                      1 = 1.0          Adj: 1 = 1.0
               -.4
                     0        .1        .2        .3        .4         .5        .6         .7    .8      .9          1
                                                                       2



                                                  (a) z1 = z2 = 1.0


      (c1-c2)/(z1-z2)

     1.4


     1.2


      1


      .8


      .6


      .4

                                                                                      1 = 0.0          Adj: 1 = 0.0
      .2
                                                                                      1 = 0.5          Adj: 1 = 0.5
                                                                                      1 = 1.0          Adj: 1 = 1.0
      0
           0             .1        .2        .3        .4         .5        .6         .7        .8      .9           1
                                                                  2



                                              (b) z1 = 4/3, z2 = 2/3




                                                             23
Figure 2: Redistribution from Location 2 to 1, Type 1, Various Values of       
                                                                         1 and 2




          Type 1: (c1-c2)/(w1-w2)

          2.5
                            = 1.0, Type 1 1 = 0.0              = 1.0, Type 1 1 = 1.0
         2.25               = 0.5, Type 1 1 = 0.0              = 0.5, Type 1 1 = 1.0
                            = 1.0, Type 1 1 = 0.0              = 1.0, Type 1 1 = 1.0
            2
                            = 0.5, Type 1 1 = 0.0              = 0.5, Type 1 1 = 1.0
         1.75

          1.5

         1.25

            1

          .75

           .5

          .25

            0
                0                   .2              .4              .6                 .8   1
                                                    Type 1 value of 2


                                             (a) No Externalities


          Type 1: (c1-c2)/(w1-w2)

          2.5
                            = 1.0, Type 1 1 = 0.0              = 1.0, Type 1 1 = 1.0
         2.25               = 0.5, Type 1 1 = 0.0              = 0.5, Type 1 1 = 1.0
                            = 1.0, Type 1 1 = 0.0              = 1.0, Type 1 1 = 1.0
            2
                            = 0.5, Type 1 1 = 0.0              = 0.5, Type 1 1 = 1.0
         1.75

          1.5

         1.25

            1

          .75

           .5

          .25

            0
                0                   .2              .4              .6                 .8   1
                                                    Type 1 value of 2


                                    (b) Externality in Location 1 from L1
                                                                        1




                                                         24
Appendix A. Planning Solution

   Denote An as amenities in location n and cn as consumption in location n such that the
deterministic portion of utility in location n is un = An cn and utility for person i in location
n is uni = un eni where eni is drawn iid from the Fr´
                                                    echet distribution with parameter  . Also
denote Ln as the population in location n and let G denote the pre-determined amount of
government expenditure that needs to be funded by taxation. The planner solves:


                                           max         U
                                        {cn ,Ln }N
                                                 n=1



subject to the following constraints (Lagrange multipliers are to the left of the brackets)

                                                                                   1
                                                                                   
         Expected Utility                                                     un       -U       = 0
                                                                         n

         Resource constraint                     P             Ln zn -        L n cn - G        = 0
                                                           n              n

         Population:                                                     µ 1-              Ln   = 0
                                                                                       n

         Utility n=1,. . . ,N                                            n [An cn - un ] = 0
                                                                         un 
         Individual optimization n=1,. . . ,N:                  Wn              - Ln = 0
                                                                         U

First-order conditions are

                        un :    0 = Ln U - n un + Wn Ln
                        cn :    0 = n un - P Ln cn
                        Ln :    0 = P (zn - cn ) Ln - Wn Ln - µLn
                        U:      0 = 1 -  - (/U )                   n   Wn Ln

From the FOC for U we have (/U ) (         n   Wn Ln ) = 1 - . Add the Focs for un to get 1 =

  n n   (un /U ). Now add the FOCs for cn to get (U/P ) = GDP - G where GDP =                             zn Ln .
                                                                                                      n
   Now start with the FOC for Ln


                           0 = P (zn - cn ) Ln - Wn Ln - µLn




                                                 25
Use FOC for un

                         1          1          1             1
           Wn Ln =         (n un ) - (Ln U ) =   (P Ln cn ) - (Ln U )
                                                             

Insert

                                    1                   1
            0 = P Ln zn - P Ln cn - (P Ln cn ) +          (Ln U ) - µLn
                                                        
                            1          1                µ
            0 = zn - cn - (cn ) +        (U ) -
                                      P                 P
                        1+            U         µ
              = zn -           cn +           -
                                      P     U

Rearrange terms and substitute for U/P to get

                                              µ 
                                                 -
                     cn =         zn     +    U  (GDP - G)                           (A.1)
                               1+           1+


If we multiply the above equation by Ln and then sum over n, we get the expression

                     µ
                 -     (GDP - G) = (1 +  ) (GDP - G) - GDP
                     U
                                 = GDP - (1 +  ) G                                   (A.2)


After inserting equation (A.2) into (A.1), we get the following expression for optimal con-
sumption in location n


                          cn = (1 -  ) zn + T
                                 1
                    where  =            and T =  · GDP - G
                               1+




                                            26
Appendix B. Multiple Types of Households, Multiple Locations and Produc-
                    tion Externalities

Appendix B.1. No Adjustment

       We now consider an environment with n = 1, . . . , N discrete locations and  = 1, . . . , T
types. We assume a planner can choose any level of consumption for any type in any location,
as long as the allocation satisfies aggregate feasibility conditions and respects individual op-
timization, i.e. households optimally choose locations given their location attachment draws
and given the allocation of consumption across locations.
       The objective of the planner is as follows


                                        max                 L U (V  )
                                               N
                                 {{tn ,Ln } =1 }n=1
                                         T
                                                      


where U is a concave function, L                                             
                                n is the population of type  in location n, L is the

total population of type  and V  is the expected utility associated with type  . Then
planner maximizes this function subject to constraints listed below. Note that in the list of
constraints the Lagrange multipliers are to the left of the brackets:

 Expected Utility, by type:  = 1, . . . , T                                   Eeni max uni            -V       = 0
                                                                                          n

 Resource constraint:                                                                     P           t   
                                                                                                       n Ln    = 0
                                                                                               n   

 Population, by type:  = 1, . . . , T                                                      L -            Ln   = 0
                                                                                                      n
 Optimization, by type and location:  = 1, . . . , T and n = 1, . . . , N                 [ L - L ] = 0
                                                                                        Wn n     n


u                                                                                     
 ni for agent i of type  is the function un (cn , Di , eni ) with cn = zn - tn where zn is income

generated by one type  worker in location n which can be a function of Ln for  = 1, . . . , T ,
             
for example zn = z zn , L1    2            T
                         n , Ln , . . . , Ln where zn is TFP for location N . As specified, this

framework allows for complementarities across types or externalities involving one or more
types in production.12                                        
                       n is the probability that n = argmaxn un i for n = 1, . . . , N .


  12
    As an example, in a decentralized economy firms may take as given in location n multifactor productivity
                                    
of an where an = zn (L n ) , with Ln an externality in type   workforce. The planner explicitly takes into
consideration the impact of allocations on the externality.



                                                      27
    The first-order conditions are:

              U
 V :     0 =   
                  L - 
              V                
                 Eeni max u ni 
                        n
 Ln :    0 =                    + P t      
                                      n -  - Wn
                                                 
                
                      L  
                         n
                              
                           
                E    max un i                     
                eni n                              m
 tn :    0 = -                 + P L 
                                       +   W  
                                               L
                              
                                     n       m
                     c                            t 
                              
                      n                  m          n



where we have made use in the last equation that c    
                                                  n /tn = -1.

    To reduce notation, for any given type  define the derivative of the expected value with
respect to Ln as



        Eeni max uni             Eeni max uni           c     Eeni max uni
               n                       n                 n          n              
                           =                          ·     =                 ·   n
              L n                     cn                L n        cn


Also define

                                 Eeni max uni             L
                                       n                   n
                                                      =        µn
                                      cn                  L

where µn is the average of the marginal utility of consumption of type  agents that have

chosen to live in location n:

                                           uni
                                µn = E            n = argmax uni
                                           cn


After substituting U  = U/V  , this allows us to rewrite the FOCs as:


 V :     0 = U   L - 
                   L n        
 Ln :    0 =         
                          µn n    + P t        
                                       n -  - Wn
                   L
                  Ln                           m
 tn :    0 = -         µ 
                         n + P Ln
                                
                                  +    W  
                                         m L
                  L                 m         tn




                                                 28
   Consider the FOC for L                     
                         n after reducing for  :


                                                              
                          0 =                 U   L   
                                                   n µn      n      + P t        
                                                                         n -  - Wn
                                         


Multiply everything by Ln and sum over n



                                                     
       0 =           Ln            U   L   
                                        n µn        n       +P          t   
                                                                         n Ln - 
                                                                                 
                                                                                              Ln-
                                                                                                               
                                                                                                             Wn Ln
                 n                                                  n                    n               n


Define total tax revenues collected for type  residents as T  . After rearranging terms, this
reduces to

                              Ln                                             T                               Ln
            =                                 U   L   
                                                   n µn         n       +P               -         
                                                                                                  Wn
                     n
                              L          
                                                                             L                n
                                                                                                             L

Insert this expression for   into the FOC for Ln , rearrange terms, and replace n with m

everywhere:

    
   Wm =
                 T                       L                                                   L                             
   P tm-P            +            
                                 Wm       m
                                                +       U   L    
                                                              m µm       m   -                m
                                                                                                             U   L    
                                                                                                                   m µm   m
                 L                       L                                                   L
                          m                                                          m                   




   Now return to the tn equation and substitute for 

                                                                                  m
                                 U    L           
                                       n µn = P L n +
                                                                      
                                                                    Wm L
                                                                m
                                                                                 tn


            
Insert for Wm

   U   L   
        n µn =

                          T                    L                          
                                                                                         L                                     m
   P Ln+       P tm-P            +        
                                         Wm     m
                                                    +      U   L   
                                                                m µm     m   -            m
                                                                                                     U   L   
                                                                                                          m µm       m    L
           m
                          L                    L                                         L                                    tn
                                     m                                           m                



Note that since the overall population of type  is fixed, this implies                                   (    
                                                                                                          m /tn ) = 0.
                                                                                                     m




                                                           29
Thus, the above can be reduced to:

                                                             m                                                   m
          U    L           
                n µn = P L n + P                   tmL
                                                      
                                                                    +             U   L   
                                                                                       m µm           m     L
                                            m
                                                            tn            m    
                                                                                                                tn


Add across  and rearrange:

                                                                           m                                                   m
       U   L   
            n µn -                   U   L   
                                          m µm              m      L              = P                Ln+P           tmL
                                                                                                                       

                             m   
                                                                          tn                                    m
                                                                                                                              tn


Sum over n

                                                                           m                                                   m
           U   L   
                n µn -                  U   L   
                                             m µm              m   L              = P                Ln+P               tmL
                                                                                                                           

 n                       n       m
                                                                          tn               n                n       m
                                                                                                                              tn
                                     


Define U , µ
           ¯,        and  as follows


                            U =                     U    Ln
                                        n       
                                                -1
                             µ
                             ¯ =        U                      U    L   
                                                                     n µn
                                                     n      
                                                                     m
                                 =                       tmL
                                                            

                                        n            m
                                                                    tn

                                                                                                m
                              =                                U          Lm µm m   L   

                                        n            m   
                                                                                               tn


For economic interpretation, µ
                             ¯ is the Pareto-weighted average marginal utility of consump-
tion in the economy;             measures the impact on the tax base generated by the location
responses to a marginal increase in taxes that is uniformly applied across locations and
types;  measures the Pareto-weighted sum of the marginal change in economy-wide utility
arising from spillovers generated by the location responses to a marginal increase in taxes
that is uniformly applied across locations and types.13

  13
    In the special case in which utility is linear in consumption and location-specific preferences are additive
to utility then   (        
                      m /tn ) = 0 giving =  = 0.
                 n




                                                               30
   With this notation, we write

                                                         
                                                                     
                                                    1 -
                                      U ¯
                                        µ -             U ¯
                                                          µ
                                  P =        = U ¯
                                                 µ          
                                        1+            1+    



Insert this definition of P and return to the FOC for tn

                                                                           
                                                                              
                                                                       1-
                                                         m                U ¯
                                                                            µ                                    m
U   L    
                            U   L    
                                                 L                             L                    t  
                                                                      
      n µn -                      m µm      m                   = U ¯
                                                                    µ          n+                    mL
                   m
                                                        tn
                                                                       1+
                                                                                                m
                                                                                                                tn
                       



Divide by Ln

                                                                                
                                                                                  
                                                                           1-
              1                                          m                    U ¯µ           1                    m
U   µ                         U   L   
                                                    L                                                    t   
                                                                      
     n-                            m µm                         = U ¯
                                                                    µ
                                                m
                                                                                   1+                     mL
             L n       m
                                                        tn
                                                                             1+             L n     m
                                                                                                                 tn
                           



                1+
Define  =      1- 
                           . Then
                   U µ
                     ¯




                    1                                            m                     1                    m
U   µn-                               U   L   
                                           m µm      m   L              = U ¯
                                                                            µ 1+                  tmL
                                                                                                      
                   L n        m
                                                                tn                    L n    m
                                                                                                           tn
                                  


Subtract U ¯
           µ and then divide.

                                      1                                  m
                                                U   L   
                                                     m µm       m   L
 U   µn - U ¯
            µ                        L n   m                            tn            1                    m
              -                                                                 =                 tmL
                                                                                                      
    U ¯µ                                             U ¯
                                                       µ                             L n    m
                                                                                                          tn


         
Define   n   as the Pareto-weighted sum of the marginal change in economy-wide utility arising
from spillovers generated by the location responses to a marginal increase in taxes that is
applied in location n to type  :

                                           1                                     m
                              n   =                     U   L   
                                                             m µm       m   L
                                           Ln   m    
                                                                                tn




                                                           31
Rewrite the above as

               U   µn - U ¯
                          µ     n                    1                 m
                            -     =                            tmL
                                                                  
                  U ¯ µ       U ¯
                                µ                    Ln               tn
                                                           m                              (B.1)
                       (1)              (2)                    (3)

For a given type  in location n, the first term on the left-hand side captures the difference in
the Pareto-weighted marginal utility of consumption of that type in that location from the
economywide-average and the second term captures the economy-wide utility (net) benefit
of production spillovers generated by that type in that location. The difference of these two
terms is equated to the the marginal deadweight loss from increasing transfers for that type
in that location, the third term.
   We can rewrite this third term to gain some intuition. To start, note the following

                                      n          m
                                        = -
                                     tn     m=n
                                                t 
                                                  n



Then the third term becomes

                                               
                                                                
                                                   m
                                                   
                                                    tm
                             1     
                                  n    m=n
                                               t   n
                                                                
                                    L tn -                                                (B.2)
                                                                
                                                
                             L     
                                  tn           
                                                                
                              n                 m               
                                               t 
                                           m=n   n


This "fiscal externality" is the amount by which the tax from type  in location n exceeds
the tax that the marginal leavers of type  will be exposed to, on average, conditional on
leaving location n.

Appendix B.2. With our Proposed Adjustment
   It is convenient to rewrite equation (B.1) as follows

        U   (µ             
              n - µ ) + U  µ - U ¯
                                 µ     n                         1                m
                                   -     =                                tmL
                                                                              
                    U ¯µ             U ¯
                                       µ                         Ln   m
                                                                                 tn


where µ =         (L        
                    n /L ) µn . We have shown earlier that location data do not pin down
              n
within-type transfers that are only based on differences in within-type marginal utility of

                                              32
consumption across locations, the term involving µ     
                                                  n - µ . For this reason, we advocate

setting µ     
         n = µ , thereby eliminating the desire for a planner to redistribute for this motive.

       If researchers wish to eliminate these transfers, they simply need to ensure that the
average marginal utility of consumption for a given type does not vary across locations. There
are many possible ways to generate this outcome. We propose simply setting µ     
                                                                            n = µ = 1

for all households, which also implies µ
                                       ¯ = 1. After this adjustment, the optimal tax on type
 at location n satisfies:

                                                              1                   m
                       U   - U           -     
                                               n   =                       tmL
                                                                              
                                                                                                   (B.3)
                                                              Ln       m
                                                                                 tn


                                                                   
With one type and no externalities in production,                  n   = 0 and  = 0. The condition for
optimality can be written as

                                                1                      m
                                    ·U =                      tm
                                                Ln        m
                                                                       tn

Notice that the left-hand side does not vary across locations. The only solution that satisfies
this equation for every location is tn = 0 for all n.14
       Returning to the multiple-type case of equation (B.3) , the framework has the capacity
to deliver both transfers across and within types. The term U   - U  is constant across
locations for any given type, but allows transfers of consumption across types based on
differences in Pareto weights and the slope of the concave function U evaluated at the optimal
                      
policy. The term      n   measures the impact of spillovers and externalities in production (which
we believe the data can identify).15 Within-type variation in this term determines across-
location, within-type transfers.




  14
      = 0 when tn = 0 at every n.
  15
    Recall we have set µ                   
                         n = 1, such that n contains Pareto weights, elasticities of location choices with
respect to income, and production-function spillovers and externalities.


                                                     33
