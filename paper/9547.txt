                                 NBER WORKING PAPER SERIES




                               STRATEGIC ASSET ALLOCATION
                             IN A CONTINUOUS-TIME VAR MODEL

                                           John Y. Campbell
                                            George Chacko
                                            Jorge Rodriguez
                                            Luis M. Viciera

                                          Working Paper 9547
                                  http://www.nber.org/papers/w9547


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                      March 2003




Campbell acknowledges the financial support of the National Science Foundation, and Chacko and Viceira
acknowledge the financial support of the Division of Research of the Harvard Business School. We are
grateful to David Bates for challenging us to explore the consistency of continuous-time and discrete-time
solution methods for VAR portfolio choice problems. The views expressed herein are those of the authors
and not necessarily those of the National Bureau of Economic Research.

©2003 by John Y. Campbell, George Chacko, Jorge Rodriguez, Luis M. Viciera. All rights reserved. Short
sections of text not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit including ©notice, is given to the source.
Strategic Asset Allocation in a Continuous-Time VAR Model
John Y. Campbell, George Chacko, Jorge Rodriguez, Luis M. Viciera
NBER Working Paper No. 9547
March 2003
JEL No. G12

                                           ABSTRACT

This note derives an approximate solution to a continuous-time intertemporal portfolio and
consumption choice problem. The problem is the continuous-time equivalent of the discrete-time
problem studied by Campbell and Viceira (1999), in which the expected excess return on a risky

asset follows an AR(1)process, while the riskless interest rate is constant. The note also shows how
to obtain continuous-time parameters that are consistent with discrete-time econometric estimates.

The continuous-time solution is numerically close to that of Campbell and Viceira and has the
property that conservative long-term investors have a large positive intertemporal hedging demand
for stocks.



John Y. Campbell                                     George Chacko
Department of Economics                              Harvard Business School
Littauer Center 213                                  Morgan Hall 389
Harvard University                                   Boston, MA 02163
Cambridge, MA 02138                                  gchacko@hbs.edu
and NBER
john_campbell@harvard.edu

Jorge Rodriguez                                      Luis M. Viciera
Sloan School of Management                           Harvard Business School
E52-458                                              Morgan Hall 395
50 Memorial Drive                                    Boston, MA 02163
Cambridge, MA 02142                                  and NBER
jorge.rodriguez@sloan.mit.edu                        lviciera@hbs.edu
1      Introduction

Campbell and Viceira (1999) study the impact of predictable variation in stock returns
on intertemporal optimal portfolio choice and consumption. They consider an infinitely
lived investor who faces a constant riskless interest rate and a time-varying equity premium.
They model this time-variation using a discrete-time, homoskedastic VAR (1) process for log
excess stock returns and a state variable driving changes in expected returns. This model
of investment opportunities implies that the Sharpe ratio is linear in the state variable.

    Campbell and Viceira assume that the investor has recursive Epstein-Zin utility (Epstein
and Zin 1989, 1991), a generalization of power utility that allows both the coeﬃcient of
relative risk aversion and the elasticity of intertemporal substitution in consumption to be
constant free parameters. They derive an approximate analytical solution for the optimal
portfolio rule, and show that this rule is linear in the state variable. When they calibrate
this model to U.S. stock market data for the postwar period, they find that intertemporal
hedging motives greatly increase the average demand for stocks by investors whose relative
risk aversion coeﬃcients exceed one.

    Because Campbell and Viceira work in discrete time, no exact portfolio solutions are
available in their model except in the trivial case of unit risk aversion, which implies myopic
portfolio choice. Campbell and Viceira claim, however, that their solution becomes exact
in the limit of continuous time when the elasticity of intertemporal substitution equals
one.   They base this claim on the fact that they use an approximation to the investor’s
intertemporal budget constraint which becomes exact as the time interval of their model
shrinks.

    This paper presents a continuous-time analysis of Campbell and Viceira’s portfolio choice
problem. The paper finds a continuous-time representation of the VAR(1) process in their
paper, and solves a continuous-time version of their model. The solution is exact when


                                              1
the elasticity of intertemporal substitution equals one, and approximate otherwise.       The
continuous-time solution has the same qualitative properties as the discrete-time solution in
Campbell and Viceira, and is quantitatively similar. However the continuous-time solution
is likely to be more appealing and intuitive to finance theorists who are accustomed to
working in continuous time.




2     Investment Opportunity Set

2.1    A continuous-time VAR

We start by assuming that there are two assets available to the investor, a riskless asset with
instantaneous return
                                          dBt
                                              = rdt,                                       (1)
                                           Bt
and a risky asset (“stocks”) whose instantaneous return and expected return follow a continuous-
time bivariate process:


             ¡                        ¢                                      
             d log St + 12 σ 2S t − θt         0 1       log St + 12 σ 2S t − θt
                                         =                                    dt     (2)
                   d (µt − θ)                  0 −κ             µt − θ
                                                                                
                                                 σS        0                dZS,t
                                             +       p 2                        ,
                                                 ρσ µ         2
                                                        σµ − ρ σµ2          dZµ,t

where dZS,t and dZµ,t are independent Wiener processes.

    Equation (2) implies that the instantaneous return on stocks (dSt /St ) follows a Geometric
Brownian Motion, whose drift (or instantaneous expected return) µt follows a mean-reverting
process. Section 2.3 below shows that this is the continuous-time counterpart of the discrete-
time VAR(1) process in Campbell and Viceira (1999).

                                               2
   We can write (2) in compact form as

                                             dyt = Ayt dt + CdZt .                            (3)

Note that the instantaneous variance of dy is given by CC 0 :
                                                                
                                                   2
                                                 σS     ρσ S σ µ
                         Var (dy) = CC 0 =                      .
                                                            2
                                               ρσ S σ µ   σµ


2.2     Time-aggregation of the continuous-time VAR

Bergstrom (1984) and Campbell and Kyle (1993) show how to derive the discrete-time
process implied by a continuous-time VAR when we take point observations of the continuous
time process at evenly spaced points {t0 , t1 ..., tn , tn+1 , ....}, with ∆t = tn − tn−1 . Direct
application of their results shows that the process y in (3) has the following discrete-time
VAR(1) representation:
                                ytpn +∆t = exp {∆tA} ytpn + uptn +1 ,                         (4)

where                                    Z    ∆t
                           uptn +1   =              exp {(∆t − τ ) A} CdZtn +τ ,              (5)
                                             τ =0
and
                                                               ∞
                                                               X Ar
                                         exp {A} = I +                    .                   (6)
                                                               r=1
                                                                     r!

   We prove in Appendix A that exp{sA} is equal to
                                                       
                                       1 κ1 (1 − e−κs )
                          exp (As) =                   .                                    (7)
                                               −κs
                                       0      e

Thus we can write (4) in matrix form as:
                                                   ¡          ¢                        
                σ 2S                                1       −κ∆t                σ 2S
  log Stn +∆t + 2 (tn + ∆t) − θ (tn + ∆t)       1 κ 1−e               log Stn + 2 tn − θtn
                                          =                                            
                                                                                           (8)
                   µtn +∆t − θ                  0        e−κ∆t               µtn − θ
                                              +utn +∆t ,

                                                          3
where
                                                      ¡                   ¢                 
                                Z       ∆t           1           −κ(∆t−τ )
               uS,tn +∆t                         1           1−e                  σ       0
 utn +∆t =                =                       κ                          S p             dZtn +τ . (9)
               uµ,tn +∆t            0            0           e−κ(∆t−τ )           ρσ µ  2    2 2
                                                                                       σµ − ρ σµ



   >From equation (9), it follows that the variance-covariance matrix of the innovations
utn +∆t in the discrete-time representation of the continuous-time VAR is given by
                                 Z ∆t
                   ¡ p    ¢
              Var utn +∆t =            exp {(∆t − τ ) A} CC 0 exp {(∆t − τ ) A0 } dτ                        (10)
                                  τ =0
                                                  
                                 Z ∆t
                                         B11 B12
                             =                     dτ ,
                                  0      B12 B22

where

                                2ρσ S σ µ ¡               ¢ σ 2µ ¡              ¢2
                 B11 = σ 2S +               1 − e−κ(∆t−τ ) + 2 1 − e−κ(∆t−τ ) ,
                                    κ                           κ
                                                 2 ¡                         ¢
                                               σ µ
                 B12   = ρσ S σ µ e−κ(∆t−τ ) +       e−κ(∆t−τ ) − e−2κ(∆t−τ ) ,
                                                κ
                          2 −2κ(∆t−τ )
                 B22   = σµe            .


   Therefore, given values for the parameters of the continuous-time process (2), we can
easily aggregate to any frequency ∆t, by using (8) and (10). The discrete-time representa-
tion is especially useful in recovering the parameters of the continuous-time VAR (2) from
estimates of the equivalent discrete-time VAR (8). We do this in the next section.



2.3     Recovering continuous-time parameters from a discrete-time
        VAR

In their analysis of optimal consumption and portfolio choice with time-varying expected
returns, Campbell and Viceira (1999, 2000) assume that the log excess returns on stocks is

                                                                   4
described by the following discrete-time VAR(1):
                                                                        
    ∆ log Stn +∆t − rf           0          0 1     ∆ log Stn − rf      ε
                      =             +                        +  tn +∆t  , (11)
         xtn +∆t             (1 − φ) µ      0 φ          xtn            η tn +∆t

where rf is the return (assumed constant) on a T-bill with maturity ∆t.

   We now show that the discrete-time VAR given in (11) and the continuous-time VAR
given in (2) are equivalent representations of the same process. To see this, note that we
can rewrite the discrete-time aggregation of y in (8) as follows:
                             ³              ´         ¡           ¢ 
                                      σ 2S             1        −κ∆t
  ∆ log Stn +∆t − r∆t             θ − 2 − r ∆t − κ 1 − e              θ
                       =                  ¡           ¢                                    (12)
        µtn +∆t                                    −κ∆t
                                              1−e          θ
                                         ¡          ¢                                       
                                      1         −κ∆t                   σ 2S
                                   1 κ 1−e                   log Stn + 2 tn − θtn      u
                              +                                                 +  S,tn +∆t  .
                                   0        e−κ∆t                     µtn              uµ,tn +∆t

Using the following linear transformation for the process µt ,
                     µ             ¶
                           σ 2S          1¡           ¢     1¡          ¢
                vt = θ −        − r ∆t −    1 − e−κ∆t θ +      1 − e−κ∆t µt ,
                            2            κ                  κ

we can further rewrite (12) in the same form as (11):
                                                                        
             ∆ log Stn +∆t − r∆t                          0
                                 =  ¡              ¢ ³           ´                     (13)
                                                             σ2
                   vtn +∆t                 1 − e−κ∆t θ − 2S − r ∆t
                                                                              
                                            0     1         ∆ log Stn +∆t − r∆t
                                        +                                     
                                            0 e−κ∆t                 vtn
                                                                           
                                            1          0            u
                                        +       ¡           ¢    S,tn +∆t  .
                                            0 κ1 1 − e−κ∆t          uµ,tn +∆t


   A simple comparison of the coeﬃcients in (11) and (13) gives us a system of equations
that relate the discrete-time parameters of the VAR process in Campbell and Viceira (1999)
to the continuous-time parameters of our continuous time VAR process. For the intercept

                                               5
and slope parameters we have the following equivalence relations:

                                          rf = r∆t,                                                         (14)
                                               µ            ¶
                                                    σ 2S
                                           µ= θ−         − r ∆t,                                            (15)
                                                     2
                                          φ = e−κ∆t .                                                       (16)


       Finally, using (10), we obtain the following equivalence relations for the variance and
covariance parameters:
                         ¡       ¢          1 ¡               ¢2
                    Vartn ηtn +∆t =          2
                                                 1 − e−κ∆t Vartn (uµ,tn +∆t )                               (17)
                                           κ
                                           σ 2µ ¡              ¢ ¡
                                                          −κ∆t 2         −2κ∆t
                                                                                  ¢
                                      =            1 −  e           1 − e           ,
                                           2κ3
                ¡                 ¢        1¡               ¢
           Covtn εtn +∆t , ηtn +∆t =            1 − e−κ∆t Covt (uS,tn +∆t , uµ,tn +∆t )                     (18)
                                           κ
                                           ρσ S σ µ ¡        −κ∆t 2
                                                                   ¢     σ 2µ ¡            ¢
                                                                                       −κ∆t 2
                                      =               1 −   e         +         1 −   e
                                              κ2                         κ3
                                                 2 ¡               ¢¡              ¢
                                               σµ
                                           − 3 1 − e−2κ∆t 1 − e−κ∆t ,
                                              2κ
                     Vartn (εtn +∆t ) =    Vartn (uS,tn +∆t )                                               (19)
                                           µ                           ¶
                                               2     2ρσ S σ µ σ 2µ               2ρσ S σ µ ¡      −κ∆t
                                                                                                        ¢
                                      =      σS +                + 2 ∆t −                     1 − e
                                                          κ         κ                 κ2
                                              2σ 2µ ¡             ¢ σ 2µ ¡                 ¢
                                           − 3 1 − e−κ∆t + 3 1 − e−2κ∆t .
                                               κ                       2κ


       Campbell-Viceira (2000) report estimates of the VAR (11) based on US quarterly data
for the period 1947.Q1-1995.Q4. Table I shows the value of the parameters of the continuous-
time equivalent VAR implied by their estimates.2
   2
       There is an estimation error in Campbell and Viceira (1999) that results in an underestimation of the
degree of predictability in stock returns in their paper. Campbell and Viceira (2000) report correct estimates,
and calibration results based on the corrected estimates.




                                                        6
2.4    A common mistake

Anyone used to working with the discrete-time representation of a univariate continuous-
time process will find natural and intuitive the relation between the intercept and slope of the
continuous-time VAR and its discrete-time representation implied by equations (14)-(16).
However, equations (17)-(19) show that the equivalence relation for the variance-covariance
matrix of innovations is less obvious. Using an intuitive extension of the usual matching
rules for simple, univariate process, one might be tempted to write:

                                      Vartn (εn+1 ) ≈ σ 2S ∆t                               (20)
                                  ¡                  ¢
                             Covtn εtn +∆t , η tn +∆t ≈ ρσ S σ µ ∆t
                                          ¡          ¢
                                    Vartn η tn +∆t ≈ σ 2µ ∆t.


    It should be apparent from equations (17)-(19) that this matching is incorrect–though
equation (20) is a first-order Taylor expansion of the correct expression for Vartn (εn+1 ) given
in (19). The use of (20) is particularly dangerous when ∆t 6= 1, as might be the case when
one is using annualized parameters and quarterly data. In this case portfolio solutions based
on (20) can be quite diﬀerent from the correct solutions that we will derive using equations
(17)-(19).




3     Intertemporal Portfolio Choice

We have shown in Section 2, that the investment opportunity set described by equations
(1) and (2) is equivalent to the investment opportunity set that Campbell and Viceira
(1999) assume in their discrete-time, intertemporal optimal consumption and portfolio choice
model. In this section we solve their model in continuous time, using the techniques described
in Chacko and Viceira (2000) and Campbell and Viceira (2002), and we show that the

                                               7
solution is invariant to the choice of discrete-time or continuous-time approximations to
solve for the model.



3.1     Assumptions on investment opportunities and preferences

We consider an investor who has only two assets available for investment, a riskless bond
and stocks, and no labor income. Return dynamics are given by (1) and the bivariate system
(2). For convenience, we rewrite the system (2) as

                                      dSt
                                          = µt dt + σ S dZeS ,
                                       St

where
                               dµt = κ (θ − µt ) dt + σ µ dZeµ ,
                                     p
where dZeS = dZS , and dZeµ = ρdZS + 1 − ρ2 dZµ . Note that the instantaneous correlation
between dSt /St and dµt is ρ.

   These assumptions on investment opportunities imply that the wealth dynamics for the
investor are given by

                       dWt = rWt dt + αt Wt [(µt − r) dt + σ S dZS ] − Ct dt,           (21)

where αt is the fraction of wealth invested in stocks.

   Campbell and Viceira (1999) assume that the investor has recursive Epstein-Zin prefer-
ences over consumption. Duﬃe and Epstein (1992a, b) provide an equivalent continuous-time
parameterization of recursive preferences:
                                        Z ∞
                                   Jt =     f (Cs , Js ) ds,
                                            t

where f (Cs , Js ) is a normalized aggregator of current consumption and continuation utility



                                                 8
that takes the form
                                                  Ã                       !(1− ψ1 )      
                                β                            C
                  f (C, J) =        1   (1 − γ) J                    1                − 1 .   (22)
                               1−   ψ                  ((1 − γ) J)   1−γ




Here β > 0 is the rate of time preference, γ > 0 is the coeﬃcient of relative risk aversion,
and ψ > 0 is the elasticity of intertemporal substitution.

   There are two interesting special cases of the normalized aggregator (22): ψ = 1/γ and
ψ = 1. The case ψ = 1/γ is interesting because in that case the normalized aggregator (22)
reduces to the standard, additive power utility function–from which log utility obtains by
setting γ = 1. In the second special case, the aggregator f (Cs , Js ) takes the following form
as ψ → 1:                                   ·                                  ¸
                                                             1
                  f (Cs , Js ) = β (1 − γ) J log (C) −          log ((1 − γ) J) .               (23)
                                                            1−γ
The case ψ = 1 is important because it allows an exact solution to our dynamic optimization
problem for investors who are more risk averse than an investor with unit coeﬃcient of
relative risk aversion. We now explore this solution, as well as an approximate solution for
investors with ψ 6= 1 in the next section.



3.2    Bellman equation

Duﬃe and Epstein (1992a, b) show that the standard Bellman principle of optimality applies
to recursive utility. The Bellman equation for this problem is

            0 =    sup {f (Ct , Jt ) + JW [Wt (r + αt (µt − r)) − Ct ] + Jµ κ (θ − µt )
                  {αt ,Ct }
                                                                    ¾
                    1       2 2 2                          1      2
                   + JW W Wt αt σ S + JW µ Wt αt ρσ S σ µ + Jµµ σ µ ,                           (24)
                    2                                      2

where f (Ct , Jt ) is given in (22) when ψ 6= 1, or (23) when ψ = 1. Jx denotes the partial
derivative of J with respect to x, except Jt , which denotes the value of J at time t.


                                                  9
   The first order condition for consumption is given by
                                                         1−γψ
                                      −ψ
                                Ct = JW  [(1 − γ) J]      1−γ   βψ ,                   (25)

which reduces to Ct = (J/JW ) (1 − γ) β when ψ = 1.

   The first order condition for portfolio choice is given by
                                      µ         ¶            µ      ¶
                               −JW       µt − r        JW µ    ρσ µ
                       αt =                       −                   .                (26)
                             Wt JW W       σ 2S      Wt JW W σ S

   Substitution of the first order conditions (25) and (26) into the Bellman equation (24)
results in the following partial diﬀerential equation for the value function J:
                ³               1−γψ
                                           ´    n               1−γψ
                                                                         o
                  −ψ                  ψ           −ψ                   ψ
           0 = f JW {(1 − γ) J}  1−γ β , Jt − JW JW [(1 − γ) J]  1−γ β                 (27)
                                              1
                  +JW Wt r + Jµ κ (θ − µt ) + Jµµ σ 2µ
                      (                       2                              )
                          2          2                               2
                    1   JW (µt − r)         JW JW µ ρσ µ (µt − r)   JW µ 2 2
                  −                    +2                         +      ρ σµ .
                    2 JW W      σ 2S         JW W         σS        JW W

Of course, the form of this equation depends on whether we consider the case ψ 6= 1 and use
the normalized aggregator in (22), or we consider the case ψ = 1 and use the normalized
aggregator (23).Appendix B shows the partial diﬀerential equation that obtains in each case.

   Campbell and Viceira (1999) claim that their discrete-time solution is exact for the case
ψ = 1 up to a discrete-time approximation to the log return on wealth, and note that this
approximation becomes exact in continuous-time. The continuous-time model in this paper
confirms their claim. We show in Appendix B that (27) has an exact analytical solution in
the case ψ = 1. This solution is

                                                          Wt1−γ
                                   J (Wt , µt ) = I (µt )       ,                      (28)
                                                          1−γ

with                                      ½                  ¾
                                                        C0 2
                             I (µt ) = exp A0 + B0 µt +   µ ,                          (29)
                                                        2 t

                                                10
where A, B, and C are functions of the primitive parameters of the model describing invest-
ment opportunities and preferences.

   In the more general case ψ 6= 1, there is no exact analytical solution to (27). However,
we can still find an approximate analytical solution following the methods described in
Campbell and Viceira (2002) and Chacko and Viceira (1999). We start by guessing that the
value function in this case also has the form given in (28), with

                                                        1−γ
                                    I (µt ) = H (µt )−( 1−ψ ) .                              (30)

Substitution of (30) into the Bellman equation (27) results in an ordinary diﬀerential equa-
tion for H(µt ). This equation does not have an exact analytical solution in general. However,
we show in Appendix B that taking a loglinear approximation to one of the terms in the
equation results in a new equation for H(µt ) that admits an analytical solution. The form
of this solution is an exponential-quadratic function similar to (29):
                                         ½                     ¾
                                                         C1 2
                            H (µt ) = exp A1 + B1 µt +      µ .                              (31)
                                                          2 t


   The term that we need to approximate in the ordinary diﬀerential equation for H(µt ) is
β ψ H(µt )−1 . Simple substitution of (28) and (31) into the first order condition (25) shows that
this term is simply the optimal consumption-wealth ratio Ct /Wt . Thus this loglinearization
is equivalent to loglinearizing the optimal consumption-wealth ratio around one particular
point of the state space. Campbell and Viceira (2002) and Chacko and Viceira (1999)
suggest approximating this term around the unconditional mean of the log consumption
wealth-ratio.This choice has the advantage that the solution will be accurate if the log
consumption-wealth is not too variable around its mean. Appendix B provides full details
of this solution procedure.




                                                11
3.3    Optimal portfolio choice

The optimal portfolio policy of the investor obtains from substitution of the the solution
for the value function into the first order condition (26). In the case ψ = 1, substitution of
(28)-(29) into the first order condition (26) gives
                             µ ¶            µ       ¶
                                1 µt − r           1 σµ
                        αt =              + 1−          ρ (B0 + C0 µt ) ,                (32)
                               γ     σ 2S          γ σS

where B0 = −B0 /(1 − γ) and C0 = −C0 /(1 − γ).

   In the case ψ 6= 1, substitution of the approximate solution (28)-(30)-(31) into the first
order condition (26) gives
                            µ ¶        µ    ¶
                             1 µt − r      1 σµ
                       αt =           + 1−      ρ (B1 + C1 µt ) ,                        (33)
                             γ   σ 2S      γ σS

where B1 = −B1 /(1 − ψ) and C1 = −C1 /(1 − ψ). Appendix B shows that B1 and C1 do not
depend on ψ, except through a loglinearization parameter.

   Equations (32) and (33) show that the optimal allocation to stocks is a weighted average
(with weights 1/γ and 1 − 1/γ) of two terms, both of them linear in the expected return
on stocks µt . The first term is the myopic portfolio allocation to stocks, and the second
term is the intertemporal hedging demand for stocks. The myopic portfolio allocation is
proportional to (1/γ), so that it approaches zero as we consider increasingly risk averse
investors. The intertemporal hedging component is proportional to (1 − 1/γ), so that one
might be tempted to conclude that it does not approach zero in the limit as γ → 0. However,
we need to consider that B0 (or B1 ) and C0 (or C1 ) are also functions of γ. We can show that
the limit of the overall expression approaches zero as γ → 0.




                                               12
3.4       Numerical calibration

Section 3.3 derives the optimal portfolio rule for the continuous-time version of the discrete-
time model in Campbell and Viceira (1999). This portfolio rule is similar to the discrete
time portfolio rule in their model3 . We can use the parameter values given in Table I to
calibrate the continuous-time portfolio rule (33), and compare the resulting mean allocations
to those reported in Table III of Campbell and Viceira (2000).4 Note that the linearity of
the optimal portfolio rule (32)-(33) implies that
                         µ ¶           µ       ¶
                           1 θ−r             1 σµ
               E [αt ] =             + 1−         ρ (Bi + Ci θ) ,                 i = 0, 1,              (34)
                           γ    σ 2S         γ σS

where the first element of the sum is the mean myopic portfolio allocation, and the second
element is the mean intertemporal hedging portfolio allocation.

      Table II has a structure identical to Table III in Campbell and Viceira (2000) to facilitate
comparison. Panel A in Table II shows mean optimal portfolio allocations implied by the
parameter values given in Table I. These allocations are similar, but not identical, to those
given in panel A of Table III in Campbell and Viceira (2000). This is a direct result of the
nonlinearity in the time-aggregation of the variances and covariances of innovations (σ S , σ µ ,
ρ), and the persistence parameter κ.

      Panel B in Table II shows the percentage that the mean intertemporal hedging portfolio
allocation                               µ    ¶
                                             1 σµ
                                          1−      ρ (Bi + Ci θ)
                                             γ σS
represents over the total mean allocation (34). The numbers in this panel are very similar
to those reported in Table III of Campbell and Viceira (2000), and support one of the main
  3
      To see this, compare equation (33) with the expressions in Proposition 1 of Campbell and Viceira (1999).
  4
      Appendix B shows that B1 and C1 depend on the loglinearization parameter h1 = E[ct − wt ], which
is endogenous. However, one can solve for h1 using the simple numerical recursive algorithm described in
Campbell and Viceira (1999).


                                                      13
conclusions in Campbell and Viceira (1999): That given the historical experience in the US
stock market, intertemporal hedging motives greatly increase the average demand for stocks
by investors who are more risk averse than a logarithmic investor. For highly conservative
investors, hedging may represent 90% or even more of the total mean demand for stocks.




4     Conclusion

This paper presents a continuous-time version of the model of optimal intertemporal port-
folio choice and consumption with time-varying equity premium of Campbell and Viceira
(1999). It shows that this model has an exact analytical solution when the investor has
unit elasticity of intertemporal substitution in consumption and an approximate analytical
solution otherwise. For calibration purposes, we also derive the discrete-time representation
of the continuous-time VAR describing the asset return dynamics. This aggregation result
is useful to recover the parameters of the model from discrete-time estimates. Our equiva-
lence result shows that intuitive discrete-time representations of univariate continuous-time
processes do not translate immediately to multivariate processes which are cross-sectionally
correlated.

    Our calibration results show that our portfolio choice model exhibits the same properties
as its discrete-time counterpart. In particular, given the historical experience in the US
stock market, intertemporal hedging motives greatly increase the average demand for stocks
by investors who are more risk averse than a logarithmic investor. For highly conservative
investors, hedging may represent 90% or even more of the total mean demand for stocks.




                                             14
5   References

Bergstrom, A.R., 1984, “Continuous Time Stochastic Models and Issues of Aggregation
    over Time”, in Z. Griliches and M.D. Intriligator eds. Handbook of Econometrics Vol.
    2, North-Holland, Amsterdam.

Campbell, John Y. and Albert S. Kyle, 1993, “Smart Money, Noise Trading, and Stock
    Price Behavior”, Review of Economic Studies 60, 1—34.

Campbell, John Y. and Luis M. Viceira, 1999, “Consumption and Portfolio Decisions when
    Expected Returns are Time Varying”, Quarterly Journal of Economics 114, 433—495.

Campbell, John Y. and Luis M. Viceira, 2000, “Consumption and Portfolio Decisions when
    Expected Returns are Time Varying: Erratum”, unpublished paper, Harvard Univer-
    sity.

Campbell, John Y. and Luis M. Viceira, 2002, Strategic Asset Allocation: Portfolio Choice
    for Long-Term Investors, Oxford University Press, New York, NY.

Chacko, George and Luis M. Viceira, 1999, “Dynamic Consumption and Portfolio Choice
    with Stochastic Volatility in Incomplete Markets,” NBER Working Paper No. 7377.

Epstein, Lawrence and Stanley Zin, 1989, “Substitution, Risk Aversion, and the Temporal
    Behavior of Consumption and Asset Returns: A Theoretical Framework”, Economet-
    rica 57, 937—69.

Epstein, Lawrence and Stanley Zin, 1991, Substitution, Risk Aversion, and the Temporal
    Behavior of Consumption and Asset Returns: An Empirical Investigation”, Journal of
    Political Economy 99, 263—286.




                                          15
6     Appendix A

We find exp(As) by use of an induction proof. We first prove by induction that the matrix
An is given by                                                       
                                                    0 (−κ)n−1
                                      An =                           .                   (35)
                                                                 n
                                                    0    (−κ)

    To prove this result, assume that An is given by (35). Then An+1 is given by

                             An+1 = An
                                    A                                       
                                       0 (−κ)n−1                       0   1
                                  =                                         
                                       0 (−κ)n                         0 −κ
                                                                
                                       0 (−κ)n
                                  =                             ,
                                       0 (−κ)n+1

which is the desired result.

    The matrix exp (As) is given by I + As + · · · + An sn /n! + · · · . Equation (35) allows us
to write the exponential matrix as


                                                                           
                                         1 0             X∞
                                                                0  (−κ) n−1 n
                                                                           s
                    exp (As) =                 + 1                         
                                         0   1        n! n=1    0 (−κ) s n n

                                               P∞                 
                                             1               n−1 n
                                         1             (−κ)      s
                                   =        n!    n=1
                                                   P∞              
                                                1               n
                                         0      n!   n=0 (−κs)
                                               P∞                 
                                             1               n−1 n
                                         1         n=1 (−κ)      s
                                   =        n!                    .
                                         0         exp (−κs)

Now, notice that
                        Ã                       !
                            1 X
                               ∞
                                                        1 X
                                                             ∞
                   d
                                   (−κ)n−1 sn       =          (−κs)n = exp (−κs) ,
                   ds       n! n=1                      n! n=0

                                                        16
so that
                                                        Z
                           1 X
                               ∞
                                  (−κ)n−1 sn =              exp (−κs) ds
                           n! n=1
                                                        −1
                                                  =        exp (−κs) + C.
                                                        κ
                                ¡P∞                  ¢
Since at s = 0 we have that          n=1   (−κ)n−1 sn /n! = 0, it follows that for the equation to
hold at s = 0 we must have that C = κ1 .

    Therefore
                             1 X
                                 ∞
                                                1
                                    (−κ)n−1 sn = (1 − exp (−κs)) ,                              (36)
                             n! n=1             κ
from which it follows that we can write the matrix exp (As) as
                                                           
                                           1 κ1 (1 − e−κs )
                             exp (As) =                    .                                  (37)
                                                   −κs
                                           0      e



7     Appendix B

7.1       Exact analytical solution when ψ = 1

Substitution of (28) and (29) into the Bellman equation (27) leads, after some simplification,
to the following equation:
                         ½                       ¾
                   1                        C0 2
         0 = −         β A0 + B0 µt +         µ + β log β + r − β
                  1−γ                       2 t
                 κ (θ − µt )                      σ 2µ    ©                     ª
               +              (B0 + C0 µt ) +              C0 + (B0 + C0 µt )2
                   1−γ                        2 (1 − γ)
                    (                                                                       )
                                2
                  1 (µt − r)         ρσ µ (µt − r)                      2 2               2
               +                  +2                   (B0 + C0 µt ) + ρ σ µ (B0 + C0 µt ) .
                 2γ       σ 2S              σS




                                                   17
We can now obtain A0 , B0 and C0 from the system of recursive equations that results from
collecting terms in µ2t , µt , and constant terms:
                         µ               ¶        µ                       ¶
                   σ 2µ         1−γ 2        2        β        1 − γ ρσ µ            1
             0 =           1+         ρ C0 + − − κ +                        C0 +          ,   (38)
                    2             γ                   2          γ σS              2γσ 2S
                               1−γ r        1 − γ ρrσ µ
             0 = κθC0 −               2
                                          −             C0                                    (39)
                                 γ σS          γ    σS
                       µ                 µ              ¶                  ¶
                                       2        1−γ 2           1 − γ ρσ µ
                   + −κ − β + σ µ 1 +                 ρ C0 +                 B0 ,
                                                  γ               γ σS
                                                                       r2     σ 2µ
             0 = −βA0 + (1 − γ) β log β + (1 − γ) (r − β) +                 +      C0         (40)
                                                                     2γσ 2S    2
                           µ               ¶        µ                    ¶
                      σ 2µ        1−γ 2         2       1 − γ σµ
                   +          1+         ρ B0 + −                ρr + κθ B.
                        2           γ                     γ σS

We can solve this system by solving equation (38) and then using the result to solve (39)
and finally solve (40). Equation (38) is a quadratic equation whose only unknown is C0 .
Thus it has two roots. Campbell and Viceira (1999) show that only one of them maximizes
expected utility. This root is the one associated with the negative root of the discriminant
of the equation. This is also the only root that ensures that C0 = 0 when γ = 1, that is, in
the log utility case. This is a necessary condition for intertemporal hedging demand to be
zero, as we know it must in the log utility case.

   We can use these results to obtain the optimal portfolio policy of the investor from the
first order condition (26), and the optimal consumption policy from the first order condition
(25). The optimal portfolio policy is given in equatio (32) in text. It is easy to see that the
optimal consumption policy is Ct /Wt = β, a constant consumption-wealth ratio equal to the
rate of time preference.




                                                   18
7.2    Approximate analytical solution when ψ 6= 1

Substitution of (28) and (30) into the Bellman equation (27) gives, after some simplification,
the following ordinary diﬀerential equation:

                                       Hµ
      0 = −β ψ H −1 + βψ + r (1 − ψ) −    κ (θ − µt )                                   (41)
                 Ã                      H       !
                          µ           ¶ µ ¶2
            σ 2µ    Hµµ         1−γ       Hµ
          +       −     + 1+
             2       H          1−ψ       H
                   µ      ¶2                  µ        ¶               µ   ¶2
            1 − ψ µt − r        1 − γ Hµ        µt − r     1 (1 − γ)2 Hµµ
          +                   −          ρσ µ            +                    ρ2 σ 2µ .
               2γ      σS         γ H             σS       2 γ (1 − ψ)   H

This ordinary diﬀerential equation does not have an exact analytical solution, unless ψ = 1.

   Though there does not exist an exact analytical solution to (41), we can still find an
approximate analytical solution following the methods described in Campbell and Viceira
(2002).and Chacko and Viceira (1999). First, we note that substitution of the solution guess
(28)-(30) into the first order condition (25) gives

                                       Ct
                                          = β ψ H (µt )−1 .
                                       Wt

We can now use the following approximation for β ψ H −1 around the unconditional mean of
the log consumption-wealth ratio:

                           β ψ H (µt )−1 = exp {ct − wt }

                                          ≈ h0 + h1 (ct − wt )

                                          = h0 + h1 (ψ log β − ht ) ,                    (42)

where ct = log Ct , wt = log Wt , ht = log H (µt ), and

                                   h1 = exp {E [ct − wt ]} ,                             (43)

                                   h0 = h1 (1 − log h1 ) .                               (44)



                                               19
   Substitution of the approximation (42) for the first term of (41) transforms this ordi-
nary diﬀerential equation into another one that has an exact solution, with the following
exponential-quadratric form:
                                            ½                  ¾
                                                          C1 2
                               H (µt ) = exp A1 + B1 µt +   µ .
                                                          2 t

The coeﬃcients A1 , B1 , and C1 , can be obtained by solving the approximated Bellman
equation
               ½            µ                    ¶¾
                                            C1 2
0 = −h0 − h1 ψ log β − A1 + B1 µt +           µ     + βψ + r (1 − ψ) − κ (θ − µt ) (B1 + C1 µt )
                                            2 t
           ·                           µ          ¶               ¸         µ          ¶
      σ 2µ                  2            1−γ                    2   1 − ψ µt − r 2
    +       −((B1 + C1 µt ) + C1 ) +           + 1 (B1 + C1 µt ) +
       2                                 1−ψ                          2γ            σS
                                µ        ¶        µ      ¶
      1−γ                         µt − r     1−γ 1−γ
    −        (B1 + C1 µt ) ρσ µ            +               (B1 + C1 µt )2 ρ2 σ 2µ ,
          γ                         σS        2γ    1−ψ

which implies the following system of recursive equations:



                           µ            ¶        µ                      ¶
               σ 2µ 1 − γ       1−γ 2       2      h1        1 − γ ρσ µ           1−ψ
           0 =               1+       ρ C1 +          +κ−                 C1 +           ,   (45)
                2 1−ψ             γ                2           γ σS               2γσ 2S
                          1−ψ r      1 − γ ρrσ µ
           0 = κθC1 +           2
                                  −              C1                                          (46)
                            γ σS       γ    σS
                   µ                   µ              ¶                  ¶
                               21−γ           1−γ 2           1 − γ ρσ µ
               + κ + h1 + σ µ            1+         ρ C1 −                 B1 ,
                                1−ψ             γ               γ σS
                                                             1 − ψ r2     σ 2µ
           0 = h1 A1 − h0 − h1 ψ log β + βψ + r (1 − ψ) +               −      C1            (47)
                                                               2γ σ 2S     2
                             µ            ¶        µ                  ¶
                  σ 2µ 1 − γ      1−γ 2       2      1 − γ σµ
               +              1+        ρ B1 +                ρr − κθ B1 .
                   2 1−ψ            γ                  γ σS

We can solve this system by solving equation (45) and then using the result to solve (46)
and finally solve (47). Equation (45) is a quadratic equation whose only unknown is C.
Thus it has two roots. Campbell and Viceira (1999) show that only one of them maximizes
expected utility. This root is the one associated with the positive root of the discriminant of


                                                 20
the equation. Note also that this equation implies that C/(1 − ψ) does not depend on ψ–
except through the loglinearization parameter h1 –which in turn implies, through equation
(46), that B/(1 − ψ) does not depend on ψ either.




                                           21
                        TABLE I

        Continuous-Time Parameter Values
Implied by Campbell-Viceira (2000) VAR Estimates


Model:


                     dBt /Bt = rdt,

               dSt /St = µt dt + σS dZ̃S ,

              dµt = κ(θ − µt )dt + σµ dZ̃µ ,

                     dZ̃S dZ̃µ = ρdt

Parameter Values (at quarterly frequency):

          r                        0.0818e-2

          κ                        4.3875e-2

          θ                        1.3980e-2

         σS                        7.8959e-2

         σµ                        0.5738e-2

          ρ                       -0.9626
                                 TABLE II
      Mean Optimal Percentage Allocation to Stocks and
 Percentage Mean Hedging Demand Over Mean Total Demand

R.R.A.                                   E.I.S.


         (A) Mean optimal percentage allocation to stocks:
           1/.75 1.00  1/1.5   1/2    1/4     1/10   1/20                 1/40
 0.75    180.31    198.02   209.80   214.47   220.42   223.53   224.49   224.97
 1.00    211.12    211.12   211.12   211.12   211.12   211.12   211.12   211.12
 1.50    239.07    223.64   211.64   206.76   200.57   197.39   196.40   195.92
 2.00    248.85    227.85   210.53   203.36   194.22   189.52   188.07   187.36
 4.00    241.99    220.24   200.14   191.27   179.59   173.46   171.56   170.63
 10.0    183.24    173.55   163.80   159.06   152.29   148.46   147.23   146.62
 20.0    125.04    123.63   122.17   121.42   120.29   119.61   119.38   119.27
 40.0     75.57     77.74    80.00    81.17    82.98    84.12    84.51    84.71

         (B) Fraction due to hedging demand (percentage):
          1/.75     1.00     1/1.5     1/2      1/4     1/10     1/20     1/40
 0.75     -56.12   -42.16   -34.17   -31.26 -27.71 -25.94 -25.39 -25.13
 1.00       0.00     0.00     0.00     0.00   0.00   0.00   0.00   0.00
 1.50      41.13    37.06    33.49    31.93 29.82 28.69 28.34 28.16
 2.00      57.58    53.67    49.86    48.09 45.65 44.30 43.87 43.66
 4.00      78.19    76.03    73.63    72.40 70.61 69.57 69.23 69.07
 10.0      88.48    87.84    87.11    86.73 86.14 85.78 85.66 85.60
 20.0      91.56    91.46    91.36    91.31 91.22 91.17 91.16 91.15
 40.0      93.02    93.21    93.40    93.50 93.64 93.73 93.75 93.77
