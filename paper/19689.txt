                                NBER WORKING PAPER SERIES




              COMPARATIVE ADVANTAGE AND OPTIMAL TRADE POLICY

                                           Arnaud Costinot
                                           Dave Donaldson
                                           Jonathan Vogel
                                            Ivan Werning

                                        Working Paper 19689
                                http://www.nber.org/papers/w19689


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    December 2013




We thank Gene Grossman and Andrés Rodríguez-Clare as well as seminar participants at Brown, Princeton
University, Sciences Po, and ECARES for useful comments. Rodrigo Rodrigues Adao provided superb
research assistance. Costinot and Donaldson thank the National Science Foundation (under Grant SES-
1227635) for research support. Vogel thanks the Princeton International Economics Section for their
support. The views expressed herein are those of the authors and do not necessarily reflect the views
of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2013 by Arnaud Costinot, Dave Donaldson, Jonathan Vogel, and Ivan Werning. All rights reserved.
Short sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.
Comparative Advantage and Optimal Trade Policy
Arnaud Costinot, Dave Donaldson, Jonathan Vogel, and Ivan Werning
NBER Working Paper No. 19689
December 2013
JEL No. F10,F11,F13

                                            ABSTRACT

The theory of comparative advantage is at the core of neoclassical trade theory. Yet we know little
about its implications for how nations should conduct their trade policy. For example, should import
sectors with weaker comparative advantage be protected more? Conversely, should export sectors
with stronger comparative advantage be subsidized less? In this paper we take a first stab at exploring
these issues. Our main results imply that in the context of a canonical Ricardian model, optimal import
tariffs should be uniform, whereas optimal export subsidies should be weakly decreasing with respect
to comparative advantage, reflecting the fact that countries have more room to manipulate prices in
their comparative-advantage sectors. Quantitative exercises suggest substantial gains from such policies
relative to simpler tax schedules.


Arnaud Costinot                                    Jonathan Vogel
Department of Economics, E17-232                   Department of Economics
MIT                                                Columbia University
77 Massachusetts Avenue                            420 West 118th Street
Cambridge MA 02139                                 New York, NY 10027
and NBER                                           and NBER
costinot@mit.edu                                   jvogel@columbia.edu

Dave Donaldson                                     Ivan Werning
Department of Economics, E17-222                   Department of Economics, E17-234
MIT                                                MIT
77 Massachusetts Avenue                            77 Massachusetts Avenue
Cambridge, MA 02139                                Cambridge, MA 02139
and NBER                                           and NBER
ddonald@mit.edu                                    iwerning@mit.edu
1    Introduction
Two of the most central questions in international economics are “Why do nations trade?”
and “How should a nation conduct its trade policy?” The theory of comparative advan-
tage is one of the most influential answers to the former question. Yet, it has had little
impact on answers to the latter question. Our goal in this paper is to explore the relation-
ship between comparative advantage and optimal trade policy.
    Our main result can be stated as follows. The trade taxes that maximize domestic
welfare in the models we consider, which we label optimal trade taxes, should be uni-
form across imported goods and weakly monotone with respect to comparative advan-
tage across exported goods. Examples of optimal trade taxes include (i) a zero import
tariff accompanied by export taxes that are weakly increasing with comparative advan-
tage or (ii) a uniform, positive import tariff accompanied by export subsidies that are
weakly decreasing with comparative advantage. While the latter pattern accords well
with the observation that countries tend to protect their least competitive sectors in prac-
tice, in our model larger subsidies do not stem from a greater desire to expand production
in less competitive sectors. Rather, they reflect tighter constraints on the ability to exploit
monopoly power by contracting exports. Put simply, countries have more room to ma-
nipulate world prices in their comparative-advantage sectors.
    Our starting point is a canonical Ricardian model of trade. We focus on this model be-
cause this is the oldest and simplest theory of comparative advantage as well as the new
workhorse model for quantitative work in the field; see Eaton and Kortum (2012). We
consider a world economy with two countries, Home and Foreign, one factor of produc-
tion, labor, a continuum of goods, and Constant Elasticity of Substitution (CES) utility, as
in Dornbusch et al. (1977), Wilson (1980), Eaton and Kortum (2002), and Alvarez and Lu-
cas (2007). Labor productivity can vary arbitrarily across sectors in both countries. Home
sets trade taxes in order to maximize domestic welfare, whereas Foreign is passive. In the
interest of clarity we assume no other trade costs in our baseline model.
    In order to characterize the structure of optimal trade taxes, we use the primal ap-
proach and consider first a fictitious planning problem in which the domestic government
directly controls consumption and output decisions. Using Lagrange multiplier methods,
we then show how to transform this infinite dimensional problem with constraints into
a series of simple unconstrained, low-dimensional problems. This allows us to derive
sharp predictions about the structure of the optimal allocation. Finally, we demonstrate
how that allocation can be implemented through trade taxes and relate optimal trade
taxes to comparative advantage.


                                              1
    Our approach is flexible enough to be used in more general environments that fea-
ture non-CES utility, arbitrary neoclassical production functions, and trade costs. In
all such extensions we demonstrate that our techniques remain well-suited to analyz-
ing optimal trade policy and show that our main insights are robust. For example, our
main prediction—that optimal trade taxes are uniform across imported goods and weakly
monotone with respect to comparative advantage across goods—holds without further
qualification in a Ricardian model with uniform iceberg trade costs. Perhaps surprisingly,
given the leap in generality, this prediction is only somewhat more nuanced without CES
utility or with arbitrary neoclassical production functions.
    The approach developed here can also be used for quantitative work. We apply our
theoretical results to study the design of optimal trade policy in a world economy com-
prising two countries: the United States and the Rest of the World. We consider two
separate exercises. In the first exercise, all goods are assumed to be agricultural goods,
whereas in the second, all goods are assumed to be manufactured goods. We find that
U.S. gains from trade under optimal trade taxes are 20% larger than those obtained under
laissez-faire for the agricultural case and 33% larger for the manufacturing case. Inter-
estingly, a significant fraction of these gains arises from the use of trade taxes that are
monotone in comparative advantage. Under an optimal uniform tariff, gains from trade
for both the agriculture and manufacturing exercises would only be 9% larger than those
obtained under laissez-faire. While these two-country examples are admittedly stylized,
they suggest that the economic forces emphasized in this paper may be quantitatively
important as well. We hope that future quantitative work, in the spirit of Ossa (2011), will
further explore this issue in an environment featuring a large number of countries and a
rich geography of trade costs.
    Our paper makes two distinct contributions to the existing literature. The first one, at
the intersection of international trade and public finance, is related to the classical prob-
lem of optimum taxation in an open economy; see e.g. Torrens (1844) and Mill (1844). In
his survey of the literature, Dixit (1985) sets up the general problem of optimal taxes in
an open economy as a fictitious planning problem and derives the associated first-order
conditions. As Bond (1990) demonstrates, such conditions impose very weak restrictions
on the structure of optimal trade taxes. Hence, optimal tariff arguments are typically cast
using simple general equilibrium models featuring only two goods or partial equilibrium
models. In such environments, characterizing optimal trade taxes reduces to solving the
problem of a single-good monopolist/monopsonist and leads to the prediction that the
optimal tariff should be equal to the inverse of the (own-price) elasticity of the foreign



                                             2
export supply curve.1
    In this paper we go beyond the previous prediction by studying the relationship be-
tween comparative advantage and optimal trade taxes in the context of a canonical Ri-
cardian model. In this environment, countries buy and sell many goods whose prices
depend on the entire vector of net imports through their effects on wages. Thus the (own-
price) elasticity of the foreign export supply curve no longer provides a sufficient statistic
for optimal trade taxes. Nevertheless our analysis shows that for any wage level, optimal
trade taxes must satisfy simple and intuitive properties. What matters for one of our main
results is not the entire schedule of own-price and cross-price elasticities faced by a coun-
try acting as a monopolist, which determines the optimal level of wages in a non-trivial
manner, but the cross-sectional variation in own-price elasticities across sectors holding
wages fixed, which is tightly connected to a country’s comparative advantage.
    The paper most closely related to ours is Itoh and Kiyono (1987), which shows that in
a Ricardian model with Cobb-Douglas preferences, export subsidies that are concentrated
on “marginal” goods are always welfare-enhancing. Though the logic behind their result
is distinct from ours—a point we come back to in Section 4.3—it resonates well with our
finding that, at the optimum, export subsidies should be weakly decreasing with com-
parative advantage, so that “marginal” goods should indeed be subsidized more. Our
analysis extends the results of Itoh and Kiyono (1987) by considering a Ricardian envi-
ronment with general CES utility and, more importantly, by solving for optimal trade
taxes rather than providing examples of welfare-enhancing policies.2 Beyond general-
ity, our results also shed light on the simple economics behind optimal trade taxes in a
canonical Ricardian model: taxes should be monotone in comparative advantage because
countries have more room to manipulate prices in their comparative-advantage sectors.
    More broadly, these novel results have implications for the recent debate regarding
the consequences of micro-level heterogeneity for the welfare gains from trade; see Help-
man (2013). In recent work, Arkolakis et al. (2012) have shown that, depending on how
the question is framed, answers to micro-level questions may be of no consequence for
predicting how international trade affects welfare within a broad class of models. These
results rely on calibrating certain macro responses, thereby holding them fixed across
models. Melitz and Redding (2013) offer a different perspective in which these behavioral
responses are not held fixed. Regardless of these debatable methodological choices, our
paper emphasizes policy margins that bring out the importance of micro structure. Our
   1 This idea is at the center of recent work emphasizing the role of terms-of-trade manipulation in the

analysis of optimal tariffs and its implication for the WTO; see Bagwell and Staiger (1999).
   2 Opp (2009) also studies optimal trade taxes in a two-country Ricardian model with CES utility, but his

analysis focuses on optimal tariffs that are uniform across goods.

                                                    3
qualitative results—that trade taxes should be monotone in comparative advantage—and
our quantitative results—that such trade taxes lead to substantially larger welfare gains
than uniform trade taxes—illustrate that the design of and the gains associated with op-
timal trade policy may crucially depend on the extent of micro-level heterogeneity. Here,
micro-level data matter, both qualitatively and quantitatively, for answering a key nor-
mative question in the field: How should a nation conduct its trade policy?3
    The second contribution of our paper is technical. The problem of finding optimal
trade taxes in a canonical Ricardian model is infinite-dimensional (since there is a contin-
uum of goods), non-concave (since indirect utility functions are quasi-convex in prices),
and non-smooth (since the world production possibility frontier has kinks). To make
progress on this question, we follow a three-step approach. First, we use the primal ap-
proach to go from taxes to quantities. Second, we identify concave subproblems for which
general Lagrangian necessity and sufficiency theorems problems apply. Third, we use
the additive separability of preferences to break down the maximization of a potentially
infinite-dimensional Lagrangian into multiple low-dimensional maximization problems
that can be solved by simple calculus. Beyond the various extensions presented in this
paper, the same approach could be used to study optimal trade taxes in economies with
alternative market structures such as Bertrand competition, as in Bernard et al. (2003), or
monopolistic competition, as in Melitz (2003).
    From a technical standpoint, our approach is also related to recent work by Amador
et al. (2006) and Amador and Bagwell (2013) who have used general Lagrange multiplier
methods to study optimal delegation problems, including the design of optimal trade
agreements, and to Costinot et al. (2013) who have used these methods together with
the time-separable structure of preferences typically used in macro applications to study
optimal capital controls. We briefly come back to the specific differences between these
various approaches in Section 3. For now, we note that, as in Costinot et al. (2013), our ap-
proach relies heavily on the observation, first made by Everett (1963), that Lagrange mul-
tiplier methods are particularly well suited for studying “cell-problems,” i.e., additively
separable maximization problems with constraints.4 Given the importance of additively
separable utility in the field of international trade, we believe that these methods could

    3 Though we have restricted ourselves to a Ricardian model for which the relevant micro-level data

are heterogeneous productivity levels across goods, not firms, the exact same considerations would make
firm-level data critical inputs for the design of optimal policy in imperfectly competitive models.
    4 In spite of this mathematical connection, there is no direct relationship between the results of Costinot

et al. (2013), derived in a dynamic endowment economy, and the results of this paper, derived in a static
Ricardian economy. From an economic standpoint, our predictions about the structure of optimal taxes rely
crucially on the endogenous allocation of labor across sectors according to comparative advantage; they
therefore have no counterparts in an endowment economy.

                                                      4
prove useful beyond the question of how comparative advantage shapes optimal trade
taxes. We hope that our paper will contribute to make such methods part of the standard
toolbox of trade economists.
    The rest of our paper is organized as follows. Section 2 describes our baseline Ricar-
dian model. Section 3 sets up and solves the planning problem of a welfare-maximizing
country manipulating its terms-of-trade. Section 4 shows how to decentralize the solution
of the planning problem through trade taxes and derive our main theoretical results. Sec-
tion 5 explores the robustness of our main insights to the introduction of non-CES utility,
general production functions, and trade costs. Section 6 applies our theoretical results to
the design of optimal trade taxes in the agricultural and manufacturing sectors. Section 7
offers some concluding remarks. All formal proofs can be found in the Appendix.


2     Basic Environment

2.1     A Ricardian Economy
Consider a world economy with two countries, Home and Foreign, one factor of produc-
tion, labor, and a continuum of goods indexed by i.5 Preferences at home are represented
by the Constant Elasticity of Substitution (CES) utility,
                                                      ´
                                            U (c) ≡       i   ui (ci )di,

                                                                       1−1/σ
                                                                                 .
where c ≡ (ci ) ≥ 0 denotes domestic consumption; ui (ci ) ≡ β i (ci         − 1) (1 − 1/σ)
denotes utility per good; σ ≥ 1 denotes the elasticity of substitution between goods; and
                                                       ´
( β i ) are exogenous preference parameters such that i β i di = 1. Preferences abroad have
a similar form with asterisks denoting foreign variables. Production is subject to constant
returns to scale in all sectors. ai and ai∗ denote the constant unit labor requirements at
home and abroad, respectively. Labor is perfectly mobile across sectors and immobile
across countries. L and L∗ denote labor endowments at home and abroad, respectively.


2.2     Competitive Equilibrium
We are interested in situations in which the domestic government imposes ad-valorem
trade taxes-cum-subsidies, t ≡ (ti ), whereas the foreign government does not impose

    5 Allsubsequent´ results generalize trivially to economies with a countable number of goods. Whenever
the integral sign
             ´    “ ” appears, one should simply think of a Lebesgue integral. If the set of goods is finite or
countable, “ ” is equivalent to “∑.”

                                                      5
any tax. Each element ti ≥ 0 corresponds to an import tariff if good i is imported or an
export subsidy if it is exported. Conversely, each element ti ≤ 0 corresponds to an import
subsidy or an export tax. Tax revenues are rebated to domestic consumers through a
lump-sum transfer, T. Here, we characterize a competitive equilibrium for arbitrary taxes.
Next, we will describe the domestic government’s problem that determines optimal taxes.
   At home, domestic consumers choose consumption to maximize utility subject to their
budget constraints; domestic firms choose output to maximize profits; the domestic gov-
ernment balances its budget; and the labor market clears:
                                     ´                      ´
                   c ∈ argmaxc̃≥0         i   ui (c̃i )di        i   pi (1 + ti ) c˜i di ≤ wL + T ,     (1)
                  qi ∈ argmaxq˜i ≥0 { pi (1 + ti ) q̃i − wai q̃i } ,                                    (2)
                       ´
                  T = i pi ti (ci − qi ) di,                                                            (3)
                       ´
                  L = i ai qi di,                                                                       (4)

where p ≡ ( pi ) ≥ 0 is the schedule of world prices; w ≥ 0 is the domestic wage; and
q ≡ (qi ) ≥ 0 is domestic output. Similarly, utility maximization by foreign consumers,
profit maximization by foreign firms, and labor market clearing abroad imply
                                                  ´                      ´
                      c∗ ∈ argmaxc̃≥0                  i   ui∗ (c̃i )di       i   pi c˜i di ≤ w∗ L∗ ,   (5)
                      qi∗ ∈ argmaxq˜i ≥0 { pi q̃i − w∗ ai∗ q̃i } ,                                      (6)
                            ´
                      L∗ = i ai∗ qi∗ di,                                                                (7)

where w∗ ≥ 0 is the foreign wage and q∗ ≡ qi∗ ≥ 0 is foreign output. Finally, good
                                                

market clearing requires
                                 ci + ci∗ = qi + qi∗ .                          (8)

In the rest of this paper we define a competitive equilibrium with taxes as follows.
Definition 1. A competitive equilibrium with taxes corresponds to a schedule of trade taxes
t ≡ (ti ), a lump-sum transfer, T, a pair of wages, w and w∗ , a schedule of world prices, p ≡ ( pi ),
a pair of consumption schedules, c ≡ (ci ) and c∗ ≡ ci∗ , and a pair of output schedules, q ≡ (qi )
                                                        

and q∗ ≡ qi∗ , such that conditions (1)-(8) hold.
               

    By Walras’ Law, competitive prices are only determined up to a normalization. For
expositional purposes, we set prices throughout our analysis so that the marginal utility
of income in Foreign, that is the Lagrange multiplier associated with the budget constraint
in (5), is equal to one. Hence the foreign wage, w∗ , also represents the real income of the
foreign consumer.

                                                             6
2.3        The Domestic Government’s Problem
We assume that Home is a strategic country that sets ad-valorem trade taxes t ≡ (ti ) and a
lump-sum transfer T in order to maximize domestic welfare, whereas Foreign is passive.6
Formally, the domestic government’s problem is to choose the competitive equilibrium
with taxes, (t, T, w, w∗ , p, c, c∗ , q, q∗ ), that maximizes the utility of its representative con-
sumer, U (c). This leads to the following definition.
Definition 2. The domestic government’s problem is maxt,T,w≥0,w∗ ≥0,p≥0,c,c∗ ,q,q∗ U (c) subject to
conditions (1)-(8).
     The goal of the next two sections is to characterize how unilaterally optimal trade
taxes, i.e., taxes that prevail at a solution to the domestic government’s problem, vary
with Home’s comparative advantage, as measured by the relative unit labor requirements
ai∗ /ai . To do so we follow the public finance literature and use the primal approach as in,
for instance, Dixit (1985).7 Namely, we will first approach the optimal policy problem of
the domestic government in terms of a relaxed planning problem in which domestic con-
sumption and domestic output can be chosen directly (Section 3). We will then establish
that the optimal allocation can be implemented through trade taxes and characterize the
structure of these taxes (Section 4).8


3     Optimal Allocation

3.1        Home’s Planning Problem
Throughout this section we focus on a fictitious environment in which there are no taxes
and no competitive markets at home. Rather the domestic government directly controls



    6 Inother words, we focus on the best-response of the domestic government to zero taxes abroad. We
conjecture that many of our qualitative predictions about the domestic government’s best-response would
extend to other foreign policy vectors, and in turn, apply to the Nash equilibrium of a game in which both
countries are strategic. Of course, from a quantitative standpoint, welfare at Home may be much lower in
such a Nash equilibrium.
    7 An early application of the primal approach in international trade can be found in Baldwin (1948).
    8 As will become clear, our main results do not hinge on this particular choice of instruments. We

choose to focus on trade taxes-cum-subsidies for expositional convenience because they are the simplest
tax instruments required to implement the optimal allocation. It is well known that one could allow for
consumption taxes, production taxes, or import tariffs that are not accompanied by export subsidies. One
would then find that constraining consumption taxes to be equal to production taxes or import tariffs to
be equal to export subsidies, i.e. restricting attention to trade taxes-cum-subsidies, has no effect on the
allocation that a welfare-maximizing government would choose to implement.

                                                    7
domestic consumption, c, and domestic output, q, subject to the resource constraint,
                                                       ´
                                                           i ai qi di   ≤ L.                                (9)

In other words, we ignore the equilibrium conditions associated with utility and profit
maximization by domestic consumers and firms; we ignore the government’s budget con-
straint; and we relax the labor market clearing condition into inequality (9). We refer to
this relaxed maximization problem as Home’s planning problem.
Definition 3. Home’s planning problem is maxw∗ ≥0,p≥0,c≥0,c∗ ,q≥0,q∗ U (c) subject to conditions
(5)-(9).
    In order to prepare our discussion of optimal trade taxes, we will focus on the foreign
wage, w∗ , net imports m ≡ c − q, and domestic output, q, as the three key control vari-
ables of the domestic government. To do so, we first establish that the conditions for an
equilibrium in the rest of the world—namely, foreign utility maximization, foreign profit
maximization, and good and labor market clearing—can be expressed more compactly as
a function of net imports and the foreign wage alone.

Lemma 1. (w∗ , p, m, c∗ , q∗ ) satisfies conditions (5)-(8) if and only if

                               pi = pi (mi , w∗ ) ≡ min ui∗0 (−mi ) , w∗ ai∗ ,                             (10)
                                                       

                              ci∗ = ci∗ (mi , w∗ ) ≡ max {−mi , di∗ (w∗ ai∗ )} ,                           (11)
                              qi∗ = qi∗ (mi , w∗ ) ≡ max {0, mi + di∗ (w∗ ai∗ )} ,                         (12)

for all i, with di∗ (·) ≡ ui∗0−1 (·), ui∗0 (−mi ) ≡ ∞ if mi ≥ 0, and
                                         ´      ∗ ∗
                                             i ai qi   (mi , w∗ ) di = L∗ ,                                (13)
                                          ´
                                              i   pi (mi , w∗ )mi di = 0.                                  (14)

    According to Lemma 1, when Home’s net imports are high, mi + di∗ (w∗ ai∗ ) > 0, foreign
firms produce good i, the world price is determined by their marginal costs, w∗ ai∗ , and
foreign consumers demand di∗ (w∗ ai∗ ).9 Conversely, when Home’s net imports are low,
mi + di∗ (w∗ ai∗ ) < 0, foreign firms do not produce good i, foreign consumption is equal to
Home’s net exports, −mi , and the world price is determined by the marginal utility of the
foreign consumer, pi (mi , w∗ ) = ui∗0 (−mi ) . Equations (13) and (14), in turn, derive from
the foreign labor market clearing condition and the foreign consumer’s budget constraint.

   9 Recall   that good prices are normalized so that the marginal utility of income in Foreign is equal to one.

                                                                  8
   Let p (m, w∗ ) ≡ ( pi (mi , w∗ )), c∗ (m, w∗ ) ≡ (ci∗ (mi , w∗ )), and q∗ (m, w∗ ) ≡ (qi∗ (mi , w∗ ))
denote the schedule of equilibrium world prices, foreign consumption, and foreign out-
put as a function of Home’s net imports and the foreign wage. Using Lemma 1, we can
characterize the set of solutions to Home’s planning problem as follows.

Lemma 2. Suppose that (w0∗ , p0 , c0 , c0∗ , q0 , q0∗ ) solves Home’s planning problem. Then
(w0∗ , m0 = c0 − q0 , q0 ) solves
                                                       ´
                                          max               i   ui (qi + mi )di                     (P)
                                     w∗ ≥0,m,q≥0


subject to
                                                       ´
                                                            i ai qi di   ≤ L,                      (15)
                                      ´      ∗ ∗
                                          i ai qi   ( mi   , w∗ ) di     ≤ L∗ ,                    (16)
                                       ´
                                           i   pi (mi , w∗ )mi di ≤ 0.                             (17)

Conversely, suppose that w0∗ , m0 , q0 solves (P). Then there exists a solution to Home’s plan-
                                            

ning problem, w0∗ , p0 , c0 , c0∗ , q0 , q0∗ , such that p0 = p m0 , w0∗ , c0 = m0 + q0 , c0∗ =
                                                                       

c∗ m0 , w0∗ , and q0∗ = q∗ m0 , w0∗ .
                                         


    The first inequality (15) corresponds to the resource constraint at home and does not
merit further comment. The final two inequalities, (16) and (17), are the counterparts of
equations (13) and (14) in Lemma 1. One can think of Inequality (17) as Home’s trade
balance condition. It characterizes the set of feasible net imports. If Home were a small
open economy, then it would take pi (mi , w∗ ) as exogenously given and the solution to
(P) would coincide with the free trade equilibrium. Here, in contrast, Home internalizes
the fact that net import decisions affect world prices, both directly through their effects
on the marginal utility of the foreign consumer and indirectly through their effects on the
foreign wage, as reflected in inequality (16).
    Two technical aspects of Home’s planning problem are worth mentioning at this point.
First, in spite of the fact that the foreign consumer’s budget constraint and the foreign
labor market clearing condition must bind in a competitive equilibrium, as shown in
Lemma 1, the solution to Home’s planning problem can be obtained as the solution to a
new relaxed problem (P) that only features inequality constraints. This will allow us to
invoke Lagrangian necessity theorems in Section 3.2. Second, Home’s planning problem
can be decomposed into an inner and an outer problem. Define W ∗ as the set of values
for w∗ such that there exist import and output levels m, q ≥ 0 that satisfy (15)-(17). The


                                                            9
inner problem takes w∗ ∈ W ∗ as given and maximizes over import and output levels,
                                                                      ´
                                            V (w∗ ) ≡ max                 i   ui (qi + mi )di                                                (Pw∗ )
                                                        m,q≥0


subject to (15)-(17). The outer problem then maximizes the value function from the inner
problem over the foreign wage,
                                       max   V ( w ∗ ).
                                       ∗   ∗          w ∈W

    It is the particular structure of the inner problem (Pw∗ ) that will allow us to make
progress in characterizing the optimal allocation. In the next two subsections, we will
take the foreign wage w∗ as given and characterize the main qualitative properties of the
solutions to (Pw∗ ). Since such properties will hold for all feasible values of the foreign
wage, they will hold for the optimal one, w0∗ ∈ arg maxw∗ ∈W ∗ V (w∗ ), and so by Lemma
2, they will apply to any solution to Home’s planning problem.10 Of course, for the pur-
poses of obtaining quantitative results we also need to solve for the optimal foreign wage,
w0∗ , which we will do in Section 6.
    Two observations will facilitate our analysis of the inner problem (Pw∗ ). First, as we
will formally demonstrate, (Pw∗ ) is concave, which implies that its solutions can be com-
puted using Lagrange multiplier methods. Second, both the objective function and the
constraints in (Pw∗ ) are additively separable in (mi , qi ). In the words of Everett (1963),
(Pw∗ ) is a “cell-problem.” Using Lagrange multiplier methods, we will therefore be able
to transform an infinite dimensional problem with constraints into a series of simple un-
constrained, low-dimensional problems.


3.2    Lagrangian Formulation
The Lagrangian associated with (Pw∗ ) is given by
                              ´                              ´                       ´                                 ´
 L (m, q, λ, λ∗ , µ; w∗ ) ≡       i   ui (qi + mi ) di − λ       i ai qi di   − λ∗          ∗ ∗
                                                                                         i ai qi   (mi , w∗ ) di − µ       i   pi (mi , w∗ )mi di,

where λ ≥ 0, λ∗ ≥ 0, and µ ≥ 0 are the Lagrange multipliers associated with constraints
(15)-(17). As alluded to above, a crucial property of L is that it is additively separable in
(mi , qi ). This implies that in order to maximize L with respect to (m, q), one simply needs

  10 Thisis a key technical difference between our approach and the approaches used in Amador et al.
(2006), Amador and Bagwell (2013), and Costinot et al. (2013). The basic strategy here does not consist
in showing that the maximization problem of interest can be studied using general Lagrange multiplier
methods. Rather, the core of our approach lies in finding a subproblem to which these methods can be
applied. Section 5 illustrates the usefulness of this approach by showing how our results can easily be
extended to environments with non-CES utility and arbitrary neoclassical production functions.

                                                                    10
to maximize the good-specific Lagrangian,

     Li (mi , qi , λ, λ∗ , µ; w∗ ) ≡ ui (qi + mi ) − λai qi − λ∗ ai∗ qi∗ (mi , w∗ ) − µpi (mi , w∗ )mi ,

with respect to (mi , qi ) for almost all i. In short, cell problems can be solved cell-by-cell,
or in the present context, good-by-good.
    Building on the previous observation, the concavity of (Pw∗ ), and Lagrangian necessity
and sufficiency theorems—Theorem 1, p. 217 and Theorem 1, p. 220 in Luenberger (1969),
respectively—we obtain the following characterization of the set of solutions to (Pw∗ ).

Lemma 3. For any w∗ ∈ W ∗ , m0 , q0 solves (Pw∗ ) if and only if m0i , q0i solves
                                                                         


                                     max Li (mi , qi , λ, λ∗ , µ; w∗ )                                     (Pi )
                                    mi ,qi ≥0


for almost all i, with the Lagrange multipliers (λ, λ∗ , µ) ≥ 0 such that constraints (15)-(17) hold
with complementary slackness.

    Let us take stock. We started this section with Home’s planning problem, which is
an infinite dimensional problem in consumption and output in both countries as well
as world prices and the foreign wage. By expressing world prices, foreign consumption
and foreign output as a function of net imports and the foreign wage (Lemma 1), we
then transformed it into a new planning problem (P) that only involves the schedule
of domestic net imports, m, domestic output, q, and the foreign wage, w∗ , but remains
infinitely dimensional (Lemma 2). Finally, in this subsection we have taken advantage of
the concavity and the additive separability of the inner problem (Pw∗ ) in (mi , qi ) to go from
one high-dimensional problem with constraints to many two-dimensional, unconstrained
maximization problems (Pi ) using Lagrange multiplier methods (Lemma 3).
    The goal of the next subsection is to solve these two-dimensional problems in (mi , qi )
taking the foreign wage, w∗ , and the Lagrange multipliers, (λ, λ∗ , µ), as given. This is all
we will need to characterize qualitatively how comparative advantage affects the solu-
tion of Home’s planning problem and, as discussed in Section 4, the structure of optimal
trade taxes. Once again, a full computation of optimal trade taxes will depend on the
equilibrium values of (λ, λ∗ , µ), found by using the constraints (15)-(17) and the value of
w∗ that maximizes V (w∗ ), calculations that we defer until Section 6.




                                                     11
3.3     Optimal Output and Net Imports
Our objective here is to find the solution m0i , q0i of
                                                    


   max Li (mi , qi , λ, λ∗ , µ; w∗ ) ≡ ui (qi + mi ) − λai qi − λ∗ ai∗ qi∗ (mi , w∗ ) − µpi (mi , w∗ )mi .
  mi ,qi ≥0


While the economic intuition underlying our results will become transparent once we re-
introduce trade taxes in Section 4, we focus for now on the simple maths through which
 m0i , q0i comes about. We proceed in two steps. First, we solve for the output level q0i (mi )
          

that maximizes Li (mi , qi , λ, λ∗ , µ; w∗ ), taking mi as given. Second, we solve for the net
import level m0i that maximizes Li mi , q0i (mi ) , λ, λ∗ , µ; w∗ . The optimal output level is
                                                                      

then simply given by q0i = q0i m0i .
                                           

    Since Li (mi , qi , λ, λ∗ , µ; w∗ ) is strictly concave and differentiable in qi , the optimal out-
put level, q0i (mi ), is given by the necessary and sufficient first-order condition,
                                       
                      ui0 q0i (mi ) + mi ≤ λai , with equality if q0i (mi ) > 0.

The previous condition can be rearranged in a more compact form as

                                  q0i (mi ) = max {di (λai ) − mi , 0} .                                (18)

Note that the domestic resource constraint (15) must be binding at any solution of (Pw∗ ).
Otherwise the domestic government could strictly increase utility by increasing output.
Thus λ must be strictly positive by Lemma 3, which implies that q0i (mi ) is well-defined.
    Let us now turn to our second Lagrangian problem, finding the value of mi that maxi-
mizes Li mi , q0i (mi ) , λ, λ∗ , µ; w∗ . The same arguments as in the proof of Lemma 3 imply
                                       

that the previous Lagrangian is concave in mi with a kink at mi = MiI ≡ −di∗ (w∗ ai∗ ) < 0,
when Foreign starts producing good i; see equation (12). Accordingly, we cannot search
for maxima of Li mi , q0i (mi ) , λ, λ∗ , µ; w∗ by looking for stationary points. But this tech-
                                                

nicality is of little consequence for our approach, the end goal of which is the maximiza-
tion of the Lagrangian with respect to mi , not the location of its stationary points.
    To study how Li mi , q0i (mi ) , λ, λ∗ , µ; w∗ varies with mi , we consider three regions
                                                  

separately: mi < MiI , MiI ≤ mi ≤ MiI I , and mi > MiI I , where MiI I ≡ di (λai ) > 0 is the
import level at which Home stops producing good i; see equation (18). First, suppose that
mi < MiI . In this region, equations (10), (12), and (18) imply
                                      
      Li mi , q0i (mi ) , λ, λ∗ , µ; w∗ = ui (di (λai )) − λai di (λai ) + λai mi − µmi ui∗0 (−mi ) .


                                                    12
                     Li                                   Li




                           mIi MiI 0 MiII            mi                   MiI 0 MiII                mi

                              (a) ai /ai∗ < A I .                    (b) ai /ai∗ ∈ A I , A I I .
                                                                                             


                     Li                                   Li




                               MiI 0 MiII            mi                   MiI 0 MiII mIII mi
                                                                                      i

                             (c) ai /ai∗ = A I I .                      (d) ai /ai∗ > A I I .


                                     Figure 1: Optimal net imports.

                                               −1/σ
CES utility further implies ui∗0 ci∗ = β∗i ci∗       . Thus, Li is strictly increasing if mi ∈
                                      
                                                                          ∗        −σ∗
       I                                         I    I          I
 −∞, mi and strictly decreasing if mi ∈ mi , Mi , with mi ≡ − σ∗ −1 µβ∗         λai
                                                                                         . Fur-
                                                                           σ
                                                                                  i
                                                                   ∗
thermore, by definition of MiI ≡ −di∗ (w∗ ai∗ ) = −(w∗ ai∗ /β∗i )−σ , the interval miI , MiI is
                                                                                            
                                 µw∗
non-empty if aa∗i < A I ≡ σ σ−∗ 1 λ . When the previous inequality is satisfied, the concavity
                           ∗

                 i
of Li implies that Home exports miI units of good i, as illustrated in Figure 1a, whereas
Foreign does not produce anything.
   Second, suppose that mi ∈ MiI , MiI I . In this region, equations (10), (12), and (18)
                                       

imply
                                   
  Li mi , q0i (mi ) , λ, λ∗ , µ; w∗
                  = ui (di (λai )) − λai di (λai ) + (λai − (λ∗ + µw∗ ) ai∗ ) mi − λ∗ ai∗ di∗ (w∗ ai∗ ) ,

                                                               ai                   λ∗ +µw∗               ai
which is strictly decreasing in mi if and only if                    < AI I ≡               .      When             ∈ AI , AI I ,
                                                                                                                              
                                                               ai∗                      λ                 ai∗
the concavity of Li implies that Home will export MiI units of good i, as illustrated in
Figure 1b. For these goods, Foreign is at a tipping point: it would start producing if
Home’s exports were to go down by any amount. In the knife-edge case, aa∗i = A I I , the
                                                                                                                i
Lagrangian is flat between MiI and MiI I so that any import level between MiI and MiI I is

                                                      13
optimal, as illustrated in Figure 1c. In this situation, either Home or Foreign may produce
and export good i.
   Finally, suppose that MiI I ≤ mi . In this region, equations (10), (12), and (18) imply
                                                  
         Li       mi , q0i (mi ) , λ, λ∗ , µ; w∗       = ui (mi ) − (λ∗ + µw∗ ) ai∗ mi − λ∗ ai∗ di∗ (w∗ ai∗ ) ,

which is strictly increasing if mi ∈ MiI I , miI I and strictly decreasing if mi ∈ miI I , ∞ ,
                                                                                              

with miI I ≡ di (λ∗ + µw∗ ) ai∗ . Furthermore, by definition of MiI I ≡ di (λai ), MiI I , miI I
                                                                                                
                               λ∗ +µw∗
is non-empty if aa∗i > A I I ≡     λ   . When this inequality is satisfied, the concavity of Li
                         i
implies that Home will import miI I units of good i, as illustrated in Figure 1d.
    We summarize the above observations in the following proposition.

Proposition 1. If m0i , q0i solves (Pi ), then optimal net imports are such that: ( a) m0i = miI , if
                              

ai /ai∗ < A I ; (b) m0i = MiI , if ai /ai∗ ∈ A I , A I I ; (c) m0i ∈ MiI , MiI I if ai /ai∗ = A I I ; and (d)
                                                                                    

m0i = miI I , if ai /ai∗ > A I I , where miI , MiI , miI I , M I I , A I , and A I I are the functions of w∗ and
(λ, λ∗ , µ) defined above.

   Proposition 1 highlights the importance of comparative advantage, i.e., the cross-
sectoral variation in the relative unit labor requirement ai /ai∗ , for the structure of op-
                                        ∗       −σ∗
timal imports. Recall that miI ≡ − σ∗σ−1 µβ  λai
                                               ∗      < 0, MiI ≡ −di∗ (w∗ ai∗ ) < 0, and
                                                                     i
MiI I ≡ di (λai ) > 0. Thus Proposition 1 implies that Home is a net exporter of good i,
m0i < 0, only if ai /ai∗ ≤ A I I . Using Lemmas 2 and 3 to go from (Pi ) to Home’s planning
problem, this leads to the following corollary.

Corollary 1. At any solution to Home’s planning problem, Home produces and exports goods in
which it has a comparative advantage, ai /ai∗ < A I I , whereas Foreign produces and exports goods
in which it has a comparative advantage, ai /ai∗ > A I I .

    According to Corollary 1, there will be no pattern of comparative advantage reversals
at an optimum. Like in a free trade equilibrium, there exists a cut-off such that Home
exports a good only if its relative unit labor requirement is below the cut-off. Of course,
the value of that cut-off as well as the export levels will, in general, be different from those
in a free trade equilibrium.


4     Optimal Trade Taxes
We now demonstrate how to implement the solution of Home’s planning problem using
trade taxes in a competitive equilibrium.

                                                                14
4.1   Wedges
Trade taxes cause domestic and world prices to differ from one another. To prepare our
analysis of optimal trade taxes, we therefore start by describing the wedges, τi0 , between
                                                                   − 1
the marginal utility of the domestic consumer, ui0 (c0i ) = β i c0i σ , and the world price,
p0i , that must prevail at any solution to Home’s planning problem:

                                                    u 0 c0
                                                           
                                               τi0 ≡ i 0 i − 1.                                       (19)
                                                       pi

By Lemma 1, we know that if w0∗ , p0 , c0 , c0∗ , q0 , q0∗ solves Home’s planning problem—
                                                                 

and hence satisfies conditions (5)–(8)—then p0i = pi m0i , w0∗ . By Lemma 2, we also know
                                                                         

that if w0∗ , p0 , c0 , c0∗ , q0 , q0∗ solves Home’s planning problem, then w0∗ , m0 = c0 − q0 , q0
                                                                                                   

solves (P). In turn, this implies that m0 = c0 − q0 , q0 solves (Pw∗ ) for w∗ = w0∗ , and by
                                                                   

Lemma 3, that m0i , q0i solves (Pi ) for almost all i. Accordingly, the good-specific wedge
                              

can be expressed as
                                              ui0 q0i m0i + m0i
                                                                 
                                          0
                                        τi =                        − 1,
                                                  pi m0i , w0∗
                                                               

for almost all i, with pi (m0i , w0∗ ) and q0i (m0i ) given by equations (10) and (18) and m0i
satisfying conditions ( a)-(d) in Proposition 1. This further implies

                                                                                           0 0∗
                                                                                 σ ∗ −1 µ w
                           
                                σ ∗ −1 0                        ai
                           
                           
                                  σ∗ µ       − 1,         if   ai∗   < AI ≡       σ∗       λ0
                                                                                                  ;
                                                                                    0  0      0
                                     λ0 a i                                              ∗      ∗
                           
                                                                ai                µ w +λ
                   τi0 =            w0∗ ai∗
                                              − 1, if A I <     ai∗   ≤   AI I ≡       λ0
                                                                                                  ;   (20)
                               λ0∗
                           
                                    + µ0      − 1,                             if aa∗i > A I I .
                           
                           
                               w0∗
                           
                                                                                    i


Since A I < A I I , we see that good-specific wedges are (weakly) increasing with ai /ai∗ .
For goods that are exported, ai /ai∗ < A I I , the magnitude of the wedge depends on the
                                                                                       ∗
strength of Home’s comparative advantage. It attains its minimum value, σ σ−∗ 1 µ0 − 1,
for goods such that ai /ai∗ < A I and increases linearly with ai /ai∗ for goods such that
ai /ai∗ ∈ ( A I , A I I ). For goods that are imported, ai /ai∗ > A I I , wedges are constant and
                                       0∗
equal to their maximum value, wλ 0∗ + µ0 − 1.


4.2   Comparative Advantage and Trade Taxes
Let us now demonstrate that any solution w0∗ , p0 , c0 , c0∗ , q0 , q0∗ to Home’s planning
                                                                       

problem can be implemented by constructing a schedule of trade taxes, t0 = τ 0 , and a
                        ´
lump-sum transfer, T 0 = i pi τi0 m0i di. Since the domestic government’s budget constraint


                                                      15
is satisfied by construction and the resource constraint (9) must bind at any solution to
Home’s planning problem, equations (3) and (4) trivially hold. Thus we only need to
check that we can find a domestic wage, w0 , such that the conditions for utility and profit
maximization by domestic consumers and firms at distorted local prices p0i 1 + t0i , i.e.,
                                                                                      

conditions (1) and (2), are satisfied as well.
    Consider first the problem of a domestic firm. At a solution to Home’s planning prob-
lem, we have already argued in Section 3.3 that for almost all i,
                                               
                        ui0       q0i   + m0i       ≤ λ0 ai , with equality if q0i > 0.

By definition of τ 0 , we also know that ui0 q0i + m0i = ui0 c0i = p0i 1 + τi0 . Thus if
                                                                            

t0i = τi0 , then                   
                         p0i 1 + t0i ≤ λ0 ai , with equality if q0i > 0.            (21)

This implies that condition (2) is satisfied, with the domestic wage in the competitive
equilibrium given by the Lagrange multiplier on the labor resource constraint, w0 = λ0 .
   Let us turn to the domestic consumer’s problem. By definition of τ 0 , if t0i = τi0 , then
                                                                 
                                                      0    0      0
                                            ui0      ci = pi 1 + ti .

Thus for any pair of goods, i1 and i2 , we have
                                                 
                                            ui01 c0i1 1 + t0i1 p0i1
                                                  =               .                       (22)
                                            ui02 c0i2 1 + t0i2 p0i2

Hence, the domestic consumer’s marginal rate of substitution is equal to the domestic
relative price. By Lemma 1, we know that trade must be balanced at a solution to Home’s
                       ´                                        ´                  ´
planning problem, i p0i m0i di = 0. Together with T 0 = i pi τi0 m0i di = i pi t0i m0i di, this
implies
                           ´ 0        0 0
                                                ´ 0       0
                                                             0      0
                            i pi 1 + ti ci di = i pi 1 + ti qi di + T .                      (23)
                                       

                                       ´
Since conditions (4) and (21) imply i p0i 1 + t0i q0i di = λ0 L, equation (23) implies that the
                                                   

domestic consumer’s budget constraint must hold for w0 = λ0 . Combining this observa-
tion with equation (22), we can conclude that condition (1) must hold as well.
    At this point, we have established that any solution w0∗ , p0 , c0 , c0∗ , q0 , q0∗ to Home’s
                                                                                       

planning problem can be implemented by constructing a schedule of trade taxes, t0 = τ 0 ,
                                   ´
and a lump-sum transfer, T 0 = i pi τi0 m0i di. Since Home’s planning problem, as described
in Definition 3, is a relaxed version of the domestic government’s problem, as described in

                                                            16
           t0i                                                         t0i
                                                                AI I
                                                         t̄ =   AI
                                                                       −1



      t̄ = 0                                                            0
    AI
    AI I
           −1
                                                   ai                                                      ai
                       AI         AI I             ai∗                             AI         AI I         ai∗

                  (a) Export taxes.                             (b) Export subsidies and import tariffs.


                                      Figure 2: Optimal trade taxes.


Definition 2, this immediately implies that t0 , T 0 , w0 , w0∗ , p0 , c0 , c0∗ , q0 , q0∗ is a solution
                                                                                          

to the original problem. Conversely, suppose that t0 , T 0 , w0 , w0∗ , p0 , c0 , c0∗ , q0 , q0∗ is a
                                                                                                   

solution to the domestic’s government problem, then w0∗ , p0 , c0 , c0∗ , q0 , q0∗ must solve
                                                                                            

Home’s planning problem and, by condition (1), the optimal trade taxes t0 must satisfy

                                                    ui0 c0i
                                                            
                                            t0i   =           − 1,
                                                      νp0i

with ν > 0 the Lagrange multiplier on the domestic consumer’s budget constraint. By
equation (19), this implies that 1 + t0i = ν1 (1 + τi0 ). Combining this observation with
equation (20), we obtain the following characterization of optimal trade taxes.

Proposition 2. At any solution of the domestic government’s problem, trade taxes, t0 , are such
that: ( a) t0i = (1 + t̄) ( A I /A I I ) − 1, if ai /ai∗ < A I ; (b) t0i = (1 + t̄) ai /ai∗ /A I I − 1, if
                                                                                                 

ai /ai∗ ∈ A I , A I I ; and (c) t0i = t̄, if ai /ai∗ > A I I , with t̄ > −1 and A I < A I I .
                    


    Proposition 2 states that optimal trade taxes vary with comparative advantage as
wedges do. Trade taxes are at their lowest values, (1 + t̄) ( A I /A I I ) − 1, for goods in which
Home’s comparative advantage is the strongest, ai /ai∗ < A I ; they are linearly increasing
with ai /ai∗ for goods in which Home’s comparative advantage is in some intermediate
range, ai /ai∗ ∈ A I , A I I ; and they are at their highest value, t̄, for goods in which Home’s
                           

comparative advantage is the weakest, ai /ai∗ > A I I .
    Since only relative prices and hence relative taxes matter for domestic consumers and
firms, the overall level of taxes is indeterminate. This is an expression of Lerner symmetry,
which is captured by the free parameter t̄ > −1 in the previous proposition. Figure 2

                                                         17
illustrates two polar cases. In Figure 2a, there are no import tariffs, t̄ = 0, and all exported
goods are subject to an export tax that rises in absolute value with comparative advantage.
                                                                               II
In Figure 2b, in contrast, all imported goods are subject to a tariff t̄ = AA I − 1 ≥ 0, whereas
exported goods receive a subsidy that falls with comparative advantage. For expositional
purposes, we focus in the rest of our discussion on the solution with zero import tariffs,
t̄ = 0, as in Figure 2a.
      To gain intuition about the economic forces that shape optimal trade taxes, consider
first the case in which foreign preferences are Cobb-Douglas, σ∗ = 1, as in Dornbusch
et al. (1977). In this case, A I = 0 so that the first region, ai /ai∗ < A I , is empty. In the
second region, ai /ai∗ ∈ A I , A I I , there is limit pricing: Home exports the goods and sets
                                     

export taxes t0i < t̄ = 0 such that foreign firms are exactly indifferent between producing
and not producing those goods, i.e., such that the world price satisfies p0i = λ0 ai /ν(1 +
t0i ) = w0∗ ai∗ . The less productive are foreign firms relative to domestic firms, the more
room Home has to manipulate prices, and the bigger the export tax is (in absolute value).
Finally, in the third region, ai /ai∗ > A I I , relative prices are pinned down by the relative
unit labor requirements in Foreign. Since Home has no ability to manipulate these relative
prices, a uniform import tariff (here normalized to zero) is optimal.
      In the more general case, σ∗ ≥ 1, as in Wilson (1980), Eaton and Kortum (2002), and
Alvarez and Lucas (2007), the first region, ai /ai∗ < A I , is no longer necessarily empty.
The intuition, however, remains simple. In this region the domestic government has in-
centives to charge a constant monopoly markup, proportional to σ∗ /(σ∗ − 1). Specifically,
                                                                                              ∗
the ratio between the world price and the domestic price is equal to 1/(1 + t0i ) = σ∗σ−1 µν0 .
In the region ai /ai∗ ∈ A I , A I I , limit pricing is still optimal. But because A I is increasing
                                  

in σ∗ , the extent of limit pricing, all else equal, decreases with the elasticity of demand in
the foreign market.


4.3   Discussion
Proposition 2 accords well with the observation that governments often protect a small
number of less competitive industries. Yet in our model, such targeted subsidies do not
stem from a greater desire to expand production in these sectors. On the contrary, they re-
flect tighter constraints on the ability to exploit monopoly power by contracting exports.
According to Proposition 2, Home can only charge constant monopoly markups for ex-
ported goods in which its comparative advantage is the strongest. For other exported
goods, the threat of entry of foreign firms leads markups to decline together with Home’s
comparative advantage.


                                                18
    An interesting issue is whether the structure of optimal trade taxes described in Propo-
sition 2 crucially relies on the assumption that domestic firms are perfectly competitive.
Since Home’s government behaves like a domestic monopolist competing à la Bertrand
against foreign firms, one may conjecture that if each good were produced by only one
domestic firm, then Home would no longer have to use trade taxes to manipulate prices:
domestic firms would already manipulate prices under laissez-faire. This conjecture,
however, is incorrect for two reasons.
    The first reason is that although the government behaves like a monopolist, the do-
mestic government’s problem involves non-trivial general equilibrium considerations.
Namely, it internalizes the fact that by producing more goods at home, it lowers foreign
labor demand, which must cause a decrease in the foreign wage and an improvement of
Home’s terms-of-trade. These considerations are captured by the foreign resource con-
straint (16) in Home’s planning problem. As we discuss in more details in Section 6.1,
provided that the Lagrange multiplier associated with that constraint, λ0∗ , is not zero,
the optimal level of the markup charged by the domestic government will be different
from what an individual firm would have charged, i.e., σ∗ / (σ∗ − 1). In our quantitative
exercises, such general-equilibrium considerations have small effects on optimal taxes.
    The second reason is that to manipulate prices, Home’s government needs to affect the
behaviors of both firms and consumers: net imports depend both on supply and demand.
If each good were produced by only one domestic firm, Home’s government would still
need to impose good-varying consumption taxes that mimic the trade taxes described
above (plus output subsidies that reflect general equilibrium considerations). Intuitively,
if each good were produced by only one domestic firm, consumers would face monopoly
markups in each country, whereas optimality requires a wedge between consumer prices
at home and abroad.
    As mentioned in the Introduction, our findings are related to the results of Itoh and
Kiyono (1987). They have shown that in the Ricardian model with Cobb-Douglas pref-
erences considered by Dornbusch et al. (1977), export subsidies may be welfare enhanc-
ing. A key feature of the welfare-enhancing subsidies that they consider is that they are
not uniform across goods; instead, they are concentrated on “marginal” goods. This is
consistent with our observation that, at the optimum, export taxes should be weakly de-
creasing (in absolute value) with Home’s relative unit labor requirements, ai /ai∗ , so that
“marginal” goods should indeed be taxed less. The economic forces behind their results,
however, are orthogonal to those emphasized in Proposition 2. Their results reflect the
general-equilibrium considerations alluded to above: by expanding the set of goods pro-
duced at home, the domestic government can lower the foreign wage and improve its


                                            19
terms-of-trade. In contrast, the heterogeneity of taxes across goods in Proposition 2 de-
rives entirely from the structure of the inner problem (Pw∗ ), which takes the foreign wage
as given. This implies, in particular, that Proposition 2 would still hold if Home were a
“small” country in the sense that it could not affect the foreign wage.11


5      Robustness
In this section we incorporate general preferences, general technology, as well as trade
costs into the Ricardian model presented in Section 2. Our goal is twofold. First, we want
to demonstrate that Lagrange multiplier methods, and in particular our strategy of identi-
fying concave cell-problems, remain well suited to analyzing optimal trade policy in these
alternative environments. Second, we want to explore the extent to which the predictions
derived in Section 4 hinge on the assumption of CES utility, the fact that comparative
advantage derives from differences in technologies alone, or the absence of trade costs.
To save on space, we focus on sketching alternative environments and summarizing their
main implications.


5.1     Preferences
While the assumption of CES utility is standard in the Ricardian literature—from Dorn-
busch et al. (1977) to Eaton and Kortum (2002)—it implies strong restrictions on the
demand-side of the economy: own-price elasticities and elasticities of substitution are
both constant and pinned down by a single parameter, σ. In practice, price elasticities
may vary with quantities consumed and substitution patterns may vary across goods.
    Here we relax the assumptions of Section 2 by assuming (i ) that Home’s preferences
are weakly separable over a discrete number of sectors, s ∈ S ≡ {1, ..., S}, and (ii ) that
subutility within each sector, U s , is additively separable, though not necessarily CES.
Specifically, we assume that Home’s preferences can be represented by the following util-
ity function,
                               U = F (U 1 (c1 ), ...., U S (cS )),

where F is a strictly increasing function; cs ≡ (ci )i∈I s is the consumption of goods in




    11 Theobservation that optimal trade policy may not converge towards zero as the economy becomes
arbitrarily small is related to the point made by Gros (1987) in a monopolistically competitive model and
Alvarez and Lucas (2007) in a Ricardian model.

                                                   20
sector s, with I s the set of goods that belongs to that sector; and U s is such that
                                                        ´
                                          U s (cs ) =       i ∈I s   uis (ci )di.

Foreign’s preferences are similar, and asterisks denote foreign variables. Section 2 cor-
responds tothe special.   case in which there is only one sector, S = 1, and U s is CES,
                 1−1/σ s
uis (ci ) ≡ βsi ci       −1   (1 − 1/σs ).12
     For expositional purposes, let us start by considering an intermediate scenario in
which utility is not CES while maintaining the assumption that there is only one sec-
tor, S = 1. It should be clear that the CES assumption is not crucial for the results derived
in Sections 2.2-3.2. In contrast, CES plays a key role in determining the optimal level
                              ∗       −σ∗
of net imports, miI = − σ∗σ−1 µβ   λai
                                     ∗      , in Section 3.3 and, in turn, in establishing that
                                          i
trade taxes are at their lowest values, (1 + t̄) ( A I /A I I ) − 1, for goods in which Home’s
comparative advantage is the strongest in Section 4.2. Absent CES utility, trade taxes
on imported goods would still be uniform, but trade taxes on exported goods, like the
optimal monopoly markup, would now also vary with the elasticity of demand.
    Now let us turn to the general case with multiple sectors, S ≥ 1. With weakly
separable preferences abroad, one can check that foreign consumption in each sector,
cs∗ ≡ ci∗ i∈I s , must be such that
         

                                                      ´
                           cs∗ ∈ argmaxc̃≥0 U s∗ (c̃)| i∈I s pis c̃i di ≤ Es∗ ,
                                           


Accordingly, by the same argument as in Lemma 1, we can write the world price and
foreign output for all s ∈ S and i ∈ I s as

                        pis (mi , w∗ , Es∗ ) ≡ min uis∗0 (−mi ) νs∗ ( Es∗ ) , w∗ ai∗ ,                       (24)
                                                  


and
                      qis∗ (mi , w∗ , Es∗ ) ≡ max {mi + dis∗ (w∗ ai∗ /νs∗ ( Es∗ )), 0} ,                     (25)
                                                                           ´
where ν ( Es∗ ) is the Lagrange multiplier associated with the constraint, i∈I s pis c̃i di ≤ Es∗ .
   In this situation, Home’s planning problem can still be decomposed into an outer
problem and multiple inner problems, one for each sector. At the outer level, the gov-
ernment now chooses the foreign wage, w∗ , together with the sectoral labor allocations
in Home and Foreign, Ls and Ls∗ , and the sectoral trade deficits, D s , subject to aggregate

   12 The analysis in this section trivially extends to the case in which only a subset of sectors have additively

separable utility. For this subset of sectors, and this subset only, our predictions would remain unchanged.

                                                        21
factor market clearing and trade balance. At the inner level, the government treats Ls ,
Ls∗ , D s , and w∗ as constraints and maximizes subutility sector-by-sector. More precisely,
Home’s planning problem can be expressed as

                         max                     F (V 1 ( L1 , L1∗ , D1 , w∗ ), ..., V S ( LS , LS∗ , D S , w∗ ))
             { Ls ,Ls∗ ,D s }   s∈S   ,w∗ ∈W ∗


subject to

                                                        ∑s∈S Ls = L,
                                                       ∑s∈S Ls∗ = L∗ ,
                                                        ∑s∈S D s = 0,

where the sector-specific value function is now given by
                                                                            ´
                          V s ( Ls , Ls∗ , D s , w∗ ) ≡            max
                                                                   s s          i ∈I s   uis (mi + qi )di
                                                                 m ,q ≥0


subject to
                                                                       ´
                                                                     i ∈I s ai qi di        ≤ Ls ,
                                 ´              ∗ s∗
                                      i ∈I s ai qi ( mi  , w∗ , w∗ Ls∗ − D s ) di           ≤ Ls∗ ,
                                      ´          s         ∗   ∗ s∗
                                         i ∈I s pi ( mi , w , w L      − D s )mi di ≤ D s .

    Given equations (24) and (25), the sector-specific maximization problem is of the same
type as in the baseline case (program P). As in Section 3.2, we can therefore reformu-
late each infinite-dimensional sector-level problem into many two-dimensional, uncon-
strained maximization problems using Lagrange multiplier methods. Within any sector
with CES utility, all of our previous results hold exactly. Within any sector in which util-
ity is not CES, our previous results continue to hold subject to the qualification about
monopoly markups discussed above.


5.2   Technology
As is well known, the Ricardian model can always be interpreted as a neoclassical model
with multiple factors of production under the restriction that all goods use factors of pro-
duction in the same proportions. In practice, however, factor intensities do differ across
sectors. Thus, relative production costs depend not only on productivity differences—as
in our baseline model—but also on factor intensities and factor prices. Here we generalize

                                                                  22
the model of Section 2.1 to allow for arbitrary neoclassical production functions. In spite
of the generality of this new environment, we find that our main prediction survives:
due to limit pricing, taxes remain weakly monotone with respect to relative cost across
exported goods.
    The new environment can be described as follows. There are multiple factors of pro-
duction indexed by n, each of which are perfectly mobile across goods and immobile
across countries. We now denote by L ≡ ( Ln ) ≥ 0 the exogenous vector of factor en-
dowments at home. Production of each good is subject to constant returns to scale. If
li ≡ (lin ) units of each factor are employed in sector i at home or abroad, then total output
is given by f i (li ) or f i∗ (li ). The Ricardian model considered in Section 2.1 corresponds to
the special case in which f i (li ) = li /ai .
    The competitive equilibrium can still be described as in Section 2.2. Besides the fact
that multiple factor markets must now clear at home and abroad, the only additional
equilibrium condition is that firms must choose unit factor requirements to minimize
their costs,
                      ai (w) ≡ ( ain (w)) = argminai ≡(ain ) { ai · w| f i ( ai ) ≥ 1} ,

where w ≡ (wn ) is now the vector of factor prices and · denotes the scalar product. A
similar condition holds abroad, with asterisks denoting foreign factor prices and foreign
production functions.
    Regarding Home’s planning problem, the same argument as in Lemma 1 implies that
the world price, foreign consumption, foreign unit factor requirements, and foreign pro-
duction can be expressed more compactly as functions of net imports and foreign factor
prices alone. Similarly, Home’s planning problem can still be decomposed into an outer
problem and an inner problem. At the inner level, the government treats the vector of
foreign factor prices, w∗ ≡ (wn∗ ), as given and chooses net imports and output, m, q ≥ 0,
as well as domestic unit factor requirements, a ≥ 0. At the outer level, the government
then chooses the vector of foreign factor prices, w∗ . Using the same approach as in Section
3.2 and substituting for the optimal unit factor requirements, we can then reduce Home’s
Problem to maximizing with respect to (mi , qi ) the good-specific Lagrangian,

Li (mi , qi , λ, λ∗ , µ; w∗ ) ≡ ui (qi + mi ) − λ · ai (λ)qi − λ∗ · ai∗ (w∗ ) qi∗ (mi , w∗ ) − µpi (mi , w∗ ) mi ,

where λ ≡ (λn ) and λ∗ ≡ (λ∗n ) now denote the vectors of Lagrange multipliers associated
with the domestic and foreign resource constraints, respectively.
    Solving for optimal output and net imports follows similar arguments as in Section
3.3. First, we find optimal output, q0i (mi ), as a function of net imports. Second, we find


                                                      23
the value of mi that maximizes Li . As in the baseline model, the Lagrangian has two
kinks. The first one occurs at mi = MiI ≡ −di∗ w∗ · ai∗ (w∗ ) < 0, when Foreign starts
                                                             

producing good i, and the second occurs at mi = MiI I ≡ di (λ · ai (λ)) > 0, when Home
stops producing good i. Letting γi ≡ λ · ai (λ) and γi∗ ≡ w∗ · ai∗ (w∗ ) denote the unit
costs of production in the two countries and considering separately the three regions
partitioned by the two kinks, we obtain the following generalization of Proposition 1.
                                                                                                             −σ∗
                                                                                                    σ ∗ γi
Proposition 3. Optimal net imports are such that: ( a)                    m0i     =miI       ≡ − σ∗ −1 µβ∗         , if γγ∗i   <
                                                                                                            i              i
                                                  λ∗ · ai∗ (w∗ )                                                 ∗ ∗
                                                                                    0 ∈ M I , M I I if γi = λ · ai (w )
                                                                                                                          ∗
   ∗
                                     h ∗                             
µ σ σ−∗ 1 ; (b) m0i = MiI , if γγ∗i ∈ µ σ σ−∗ 1 ,                      ;   c   m
                                                                                                   
                                                        γi∗      + µ     (   )      i         i   i     γi∗         γi∗        +
                                 i
                                                                                ∗ · a∗ (w∗ )
µ; and (d) m0i = miI I ≡ di λ∗ · ai∗ (w∗ ) + µγi∗ , if γγ∗i >
                                                                             λ      i
                                                                                     γi∗     + µ.
                                                                     i

     Starting from Proposition 3 and using the same arguments as in Section 4.1, one can
                                                        ∗
show that wedges should be constant and equal to σ σ−∗ 1 µ − 1 in Region (a) and linear in
 γi∗ in Region (b). This implies that optimal taxes on exported goods should be constant
λγi

for goods in which Home’s relative cost is the lowest (Region a) and monotone in relative
costs for other goods (Region b). Like in our baseline Ricardian model, the previous
monotonic relationship reflects the constraints on the ability of the domestic government
to manipulate world prices in that region.
     Proposition 3, however, differs from Proposition 1 in two important respects. First, it
establishes a relationship between imports and relative costs, not a relationship between
imports and comparative advantage. Since unit costs of production—unlike unit labor
requirements in a Ricardian model—are endogenous objects, it is a priori possible that
no goods may fall into Regions (a), (b), and (d).13 An important question, therefore, is
whether there are other canonical models for which Proposition 3 can be re-stated in terms
of primitive assumptions about technology and factor endowments. Another prominent
example for which this is the case is the Heckscher-Ohlin model considered by Dornbusch
et al. (1980). In an economy with a continuum of goods, CES utility, two factors (capital
and labor), and identical technologies across countries, one can show that at the solution
of the planning problem, the capital-abundant country should have relatively lower costs
in the capital-intensive sectors. Accordingly, optimal taxes should be constant on the most
capital-intensive goods and monotone in capital intensity for other exported goods, i.e.
monotone in comparative advantage.
     The second difference between Propositions 1 and 3 is more subtle and relates to op-
timal taxes on imported goods. Compared to the baseline Ricardian model, the domestic
   13 This would happen if all goods are produced by both countries, perhaps because in the short-run there

are factors of production specific to each sector in all countries, as assumed in the Ricardo-Viner model. In
such a situation, all goods would fall in Region (c).

                                                              24
government may now manipulate the relative price of its imports. In the Ricardian model,
those relative prices were pinned down by relative unit labor requirements abroad. In this
more general environment, the domestic government may affect the relative price of its
imports by affecting relative factor demand abroad and, in turn, relative factor prices.
Whenever the vector of Lagrange multipliers associated with the foreign resource con-
straint, λ∗ , is not collinear with the vector of foreign factor prices, w∗ , it will have in-
centives to do so, thereby leading to taxes on imported goods that may now vary across
goods.
    Based on the quantitative results presented in Section 6, we expect the manipulation
of relative factor demand abroad to be relatively unimportant in practice. Even when
considering a country as large as the United States, we find that λ∗ is close to zero. This
is suggestive of most countries being “small” in the sense that they cannot affect factor
market clearing conditions in the rest of the world. Yet, as our analysis demonstrates,
this does not imply that most countries would not want to manipulate world prices to
their advantage. Even if λ∗ is equal to zero—so that λ∗ is trivially collinear with w∗ —
Proposition 3 shows that a small, but strategic country would like to impose taxes on
exported goods that are weakly monotone in relative costs. Put differently, whereas the
ability to affect factor prices in the rest of the world clearly depends on country size, the
incentives for limit pricing do not.


5.3   Trade Costs
Trade taxes are not the only forces that may cause domestic and world prices to diverge.
Here we extend our model to incorporate exogenous iceberg trade costs, δ ≥ 1, such that
if 1 unit of good i is shipped from one country to another, only a fraction 1/δ arrives. In
the canonical two-country Ricardian model with Cobb-Douglas preferences considered
by Dornbusch et al. (1977), these costs do not affect the qualitative features of the equilib-
rium beyond giving rise to a range of commodities that are not traded. We now show that
similar conclusions arise from the introduction of trade costs in our analysis of optimal
trade policy.
    We continue to define world prices, pi , as those prevailing in Foreign and let
                                            (
                                                δ,     if mi ≥ 0,
                               φ ( mi ) ≡                                                (26)
                                                1/δ,   if mi < 0,

denote the gap between domestic and world prices in the absence of trade taxes.
   As in our benchmark model, the domestic government’s problem can be reformulated

                                                 25
and transformed into many two-dimensional, unconstrained maximization problems us-
ing Lagrange multiplier methods. In the presence of trade costs, Home’s objective is to
find the solution m0i , q0i of the good-specific Lagrangian,
                           


   max Li (mi , qi , λ, λ∗ , µ; w∗ ) ≡ ui (qi + mi ) − λai qi
  mi ,qi ≥0

                                                       − λ∗ ai∗ qi∗ (mi , w∗ ) − µpi (mi , w∗ )φ (mi ) mi ,

where pi (mi , w∗ ) and qi∗ (mi , w∗ ) are now given by

                          pi (mi , w∗ ) ≡ min ui∗0 (−mi φ (mi )) , w∗ ai∗ ,                             (27)
                                              

                          qi∗ (mi , w∗ ) ≡ max mi φ (mi ) + di∗ (w∗ ai∗ ), 0 .                          (28)
                                              


Compared to the analysis of Section 3, if Home exports −mi > 0 units abroad, then
Foreign only consumes −mi /δ units. Conversely, if Home imports mi > 0 units from
abroad, then Foreign must export mi δ units. This explains why φ (mi ) appears in the two
previous expressions.
     The introduction of transportation costs leads to a new kink in the good-specific La-
grangian. In addition to the kink at mi = δMiI ≡ −δdi∗ (w∗ ai∗ ), there is now a kink at
mi = 0, reflecting the fact that some goods may no longer be traded at the solution of
Home’s planning problem. As before, since we are not looking for stationary points,
this technicality does not complicate our problem. When maximizing the good-specific
Lagrangian, we simply consider four regions in mi space: mi < δMiI , δMiI ≤ mi < 0,
0 ≤ mi < MiI I , and mi ≥ MiI I .
     As in Section 3, if Home’s comparative advantage is sufficiently strong, ai /ai∗ ≤ 1δ A I ≡
           ∗
                                                                    ∗         −σ∗
1 σ∗ −1 µw                                    0 = δ 1− σ ∗ m I ≡ −                      ∗
δ σ∗     λ   , then optimal net imports are m i             i
                                                                     σ    λai
                                                                    σ∗ −1 µβ ∗      δ1−σ . Similarly,
                                                                                  i
                                                                               λ∗ +µw∗
if Foreign’s comparative advantage is sufficiently strong, ai /ai∗ > δA I I ≡ δ λ , then
                                 ∗
optimal net imports are m0i = δ−σ miI I ≡ di (λ∗ + µw∗ ) δai∗ . Relative to the benchmark
                                                              

model, there
           is now a range of goods for which comparative advantage is intermediate,
ai /ai ∈ 1δ A I I , δA I I , in which no international trade takes place. For given values of
     ∗

the foreign wage, w∗ , and the Lagrange multipliers, λ, λ∗ , µ, this region expands as trade
costs become larger, i.e., as δ increases.
    Building on the previous observations, we obtain the following generalization of Propo-
sition 1.
                                                         0                    ∗
                                                               1−σ m I , if a /a∗ ≤ 1 A I ; ( b )
Proposition 4. Optimal net
                        imports are such that: ( a) mi = δ      i        i     i δ
                         1   1                                            1
mi = δMi , if ai /ai ∈ δ A , δ A ; (c) mi ∈ δMi , 0 if ai /ai = δ A ; (d) m0i = 0,
 0        I        ∗       I    I I        0           I          ∗            I I



                                                  26
                                                                                                 ∗
                   1 II
if ai /ai∗ ∈       δ A , δA
                            II       ; (e) m0i ∈ 0, MiI I if ai /ai∗ = δA I I ; and ( f ) m0i = δ−σ miI I , if
                                                        

ai /ai∗ > δA I I .

    Using Proposition 4, it is straightforward to show, as in Section 4.1, that wedges across
traded goods are (weakly) increasing with Home’s comparative advantage. Similarly, as
in Section 4.2, one can show that any solution to Home’s planning problem can be imple-
mented using trade taxes and that the optimal taxes vary with comparative advantage as
wedges do. In summary, our main theoretical results are also robust to the introduction
of exogenous iceberg trade costs.


6     Applications
To conclude, we apply our theoretical results to two sectors: agriculture and manufactur-
ing. Our goal is to take a first look at the quantitative importance of optimal trade taxes
for welfare, both in an absolute sense and relative to the simpler case of uniform import
tariffs.
    In both applications, we compute optimal trade taxes as follows. First, we use Propo-
sition 1 to solve for optimal imports and output given arbitrary values of the Lagrange
multipliers, (λ, λ∗ , µ), and the foreign wage, w∗ . Second, we use constraints (15)-(17) to
solve for the Lagrange multipliers. Finally, we find the value of the foreign wage that
maximizes the value function V (w∗ ) associated with the inner problem. Given the opti-
mal foreign wage, w0∗ , and the associated Lagrange multipliers, λ0 , λ0∗ , µ0 , we finally
                                                                              

compute optimal trade taxes using Proposition 2.


6.1     Agriculture
In many ways, agriculture provides an ideal environment in which to explore the quan-
titative importance of our results. From a theoretical perspective, the market structure in
this sector is arguably as close as possible to the neoclassical ideal. And from a measure-
ment perspective, the scientific knowledge of agronomists provides a unique window
into the structure of comparative advantage, as discussed in Costinot and Donaldson
(2011). Finally, from a policy perspective, agricultural trade taxes are pervasive and one
of the most salient and contentious global economic issues, as illustrated by the World
Trade Organization’s current, long-stalled Doha round.
Calibration. We start from the Ricardian economy presented in Section 2.1 and assume
that each good corresponds to one of 39 crops for which we have detailed productivity


                                                          27
data, as we discuss below. All crops enter utility symmetrically in all countries, β i =
β∗i = 1, and with the same elasticity of substitution, σ = σ∗ . Home is the United States
and Foreign is an aggregate of the rest of the world (henceforth R.O.W.). The single factor
of production is equipped land. We also explore how our results change in the presence
of exogenous iceberg trade costs, as in Section 5.3.
     The parameters necessary to apply our theoretical results are: (i ) the unit factor re-
quirement for each crop in each country, ai and ai∗ ; (ii ) the elasticity of substitution, σ;
(iii ) the relative size of the two countries, L∗ /L; and (iv) trade costs, δ, when relevant. For
setting each crop’s unit factor requirements, we use data from the Global Agro-Ecological
Zones (GAEZ) project from the Food and Agriculture Organization (FAO); see Costinot
and Donaldson (2011). Feeding data on local conditions—e.g., soil, topography, eleva-
tion and climatic conditions—into an agronomic model, scientists from the GAEZ project
have computed the yield that parcels of land around the world could obtain if they were
to grow each of the 39 crops we consider in 2009.1415 We set ai and ai∗ equal to the aver-
age hectare per ton of output across all parcels of land in the United States and R.O.W.,
respectively.
     The other parameters are chosen as follows. We set σ = 2.9 in line with the median es-
timate of the elasticity of substitution across our 39 crops in Broda and Weinstein (2006).16
We set L = 1 and L∗ = 10.62 to match the relative acreage devoted to the 39 crops con-
sidered, as reported in the FAOSTAT data in 2009. Finally, in the extension with trade
costs, we set δ = 1.72 so that Home’s import share in the equilibrium without trade pol-
icy matches the U.S. agriculture import share—that is, the total value of U.S. imports over
the 39 crops considered divided by the total value of U.S. expenditure over those same
crops—in the FAOSTAT data in 2009, 11.1%.
Results. The left and right panels of Figure 3 report optimal trade taxes on all traded
crops i as a function of comparative advantage, ai /ai∗ , in the calibrated examples without
trade costs, δ = 1, and with trade costs, δ = 1.72, respectively.17 The region between
   14 While there are 43 crops in the original GAEZ database, we collapse this to 39 because of our need to
merge the GAEZ crops with those in the FAOSTAT data (on trade flows and land usage). In doing so, we
combine wetland rice and dryland rice, pearl millet and foxtail millet, and phaseolus bean and gram, in
each case taking the maximum predicted GAEZ yield as the yield of the combined crop. In addition, we
dropped jatropha from the analysis because this crop is not tracked in the FAOSTAT data.
   15 The GAEZ project constructs output per hectare predictions under different assumptions on a farmer’s

use of complementary inputs (e.g. irrigation, fertilizers, and machinery). We use the measure that is con-
structed under the assumption that irrigation and a “moderate” level of other inputs (fertilizers, machinery,
etc.) are available to farmers.
   16 The elasticity of substitution estimated by Broda and Weinstein (2006) are available for 5-digit SITC

sectors. When computing the median across our 39 crops, we restrict ourselves to 5-digit SITC codes that
can be matched to raw versions of the 39 FAO crops.
   17 We compute optimal trade taxes, throughout this and the next subsection, by performing a grid search



                                                     28
            0                                                   0


        -20%                                                 -20%
  t0i




                                                       t0i
        -40%                                                 -40%


        -60%                                                 -60%
                0   0.4    0.8 1.2        1.6      2                0   0.4    0.8 1.2        1.6     2
                             ai /ai∗                                             ai /ai∗

Figure 3: Optimal trade taxes for the agricultural case. The left panel assumes no trade
costs, δ = 1. The right panel assumes trade costs, δ = 1.72.


the two vertical lines in the right panel corresponds to goods that are not traded at the
solution of Home’s planning problem.
    As discussed in Section 4.2, the overall level of taxes is indeterminate. Figure 3 focuses
on a normalization with zero import tariffs. In both cases, the maximum export tax is close
to the optimal monopoly markup that a domestic firm would have charged on the foreign
market, σ/ (σ − 1) − 1 ' 52.6%. The only difference between the two markups comes
from the fact that the domestic government internalizes the effect that the net imports of
each good have on the foreign wage. Specifically, if the Lagrange multiplier on the foreign
resource constraint, λ0∗ , were equal to zero, then the maximum export tax, which is equal
A I /A I I − 1, would simplify to the firm-level markup, σ/ (σ − 1) − 1. In other words, such
general equilibrium considerations appear to have small effects on the design of optimal
trade taxes for goods in which the U.S. comparative advantage is the strongest. In light
of the discussion in Section 4.3, these quantitative results suggest that if domestic firms
were to act as monopolists rather than take prices as given, then the domestic government
could get close to the optimal allocation by only using consumption taxes that mimic the
optimal trade taxes.
    The first and second columns of Table 1 display U.S. and R.O.W. welfare gains from
trade, i.e. the percentage change in total income divided by the CES price index rela-
over the foreign wage w∗ so as to maximize V (w∗ ). Since Foreign cannot be worse off under trade than
under autarky—whatever world prices may be, there are gains from trade—and cannot be better off than
under free trade—since free trade is a Pareto optimum, Home would have to be worse off—we restrict
our grid search to values of the foreign wage between those that would prevail in the autarky and free
trade equilibria. Recall that we have normalized prices so that the Lagrange multiplier associated with the
foreign budget constraint is equal to one. Thus w∗ is the real wage abroad.

                                                    29
                             No Trade Costs (δ = 1)                     Trade Costs (δ = 1.72)
                              U.S.      R.O.W.                           U.S.      R.O.W.
              Laissez-Faire 39.15%      3.02%                           5.02%       0.25%
              Uniform Tariff 42.60%     1.41%                           5.44%       0.16%
              Optimal Taxes 46.92%      0.12%                           5.71%       0.04%

                         Table 1: Gains from trade for the agricultural case.


tive to autarky, in the baseline model with no trade costs, δ = 1. Three rows report
the values of these gains from trade under each of three scenarios: (i ) a laissez-faire
regime with no U.S. trade taxes, (ii ) a U.S. optimal uniform tariff, and (iii ) U.S. opti-
mal trade taxes as characterized in Proposition 2.18 In this example, optimal trade taxes
that are monotone in comparative advantage increase U.S. gains from trade in agricul-
ture by 20% (46.92/39.15 − 1 ' 0.20) and decrease R.O.W.’s gains from trade by 96%
(1 − 0.12/3.02 ' 0.96), both relative to the laissez-faire case. This suggests large ineffi-
ciencies from terms-of-trade manipulation at the world level. Interestingly, we also see
that more than half of the previous U.S. gains arise from the use of non-uniform trade
taxes since a uniform tariff would increase U.S. gains by only 9% (42.60/39.15 − 1 ' 0.09).
    The third and fourth columns of Table 1 revisit the previous three scenarios using the
model with trade costs, setting δ = 1.72. Not surprisingly, as the U.S. import shares goes
down from around 80% in the model without trade costs to its calibrated value of 11.1% in
the model with trade costs, gains from trade also go down by an order of magnitude, from
39.15% to 5.02%. Yet, the relative importance of trade taxes that vary with comparative
advantage remains fairly stable. Even with trade costs, gains from trade for the United
States are 14% larger under optimal trade taxes than in the absence of any trade taxes
(5.71/5.02 − 1 ' 0.14) and, again, slightly more than half of these gains arise from the use
of non-uniform trade taxes (5.44/5.02 − 1 ' 0.08).


6.2     Manufacturing
There are good reasons to suspect that the quantitative results from Section 6.1 may not
generalize to other tradable sectors. In practice, most traded goods are manufactured
goods and the pattern of comparative advantage within those goods may be very differ-
ent than within agricultural products. We now explore the quantitative importance of
such considerations.

   18 Scenarios  (i ) and (ii ) are computed using the equilibrium conditions (1)-(8) in Section 2.2. In scenario
(i ), we set ti = 0 for all goods i. In scenario (ii ) we set ti = t for all imported goods, we set ti = 0 for other
goods, and we do a grid search over t to find the optimal tariff.

                                                        30
Calibration. As in the previous subsection, we focus on the baseline Ricardian economy
presented in Section 2.1 and the extension to iceberg trade costs presented in Section 5.3.
Home and Foreign still correspond to the United States and R.O.W., respectively, but
we now assume that each good corresponds to one of 400 manufactured goods that are
produced using equipped labor.19
    Compared to agriculture, the main calibration issue is how to set unit factor require-
ments. Since one cannot measure unit factor requirements directly for all manufactured
goods in all countries, we follow the approach pioneered by Eaton and Kortum (2002)
and assume that unit factor requirements are independently drawn across countries and
goods from an extreme value distribution whose parameters can be calibrated to match
a few key moments in the macro data. In a two-country setting, Dekle et al. (2007) have
shown that this approach is equivalent to assuming

                                  1                                        1
                                  i θ                                  1−i
                                                                   
                                                                              θ
                            ai =               and       ai∗   =                  ,                (29)
                                  T                                     T∗

with θ the shape parameter of the extreme value distribution, that is assumed to be com-
mon across countries, and T and T ∗ the scale parameters, that are allowed to vary across
countries. The goods index i is equally spaced between 1/10, 000 and 1 − 1/10, 000 for
the 400 goods in the economy.
    Given the previous functional form assumptions, we choose parameters as follows.
We set σ = 2.5 to match the median estimate of the elasticity of substitution among 5-
digit SITC manufacturing sectors in Broda and Weinstein (2006), which is very close to
the value used in the agricultural exercise.20 We set L = 1 and L∗ = 19.2 to match
population in the U.S. relative to R.O.W., as reported in the 2013 World Development
Indicators for 2009. Since the shape parameter θ determines the elasticity of trade flows
with respect to trade costs, we set θ = 5, which is a typical estimate in the literature; see
e.g. Anderson and Van Wincoop (2004) and Head and Mayer (2013). Given the previous
parameters, we then set T = 5, 194.8 and T ∗ = 1 so that in the equilibrium without trade
policy Home’s share of world GDP matches the U.S. share, 26.2%, as reported in the World
Development Indicators for 2009. Finally, in the extension with trade costs, we now set
δ = 1.44 so that Home’s import share in the equilibrium without trade policy matches the
U.S. manufacturing import share—i.e., total value of U.S. manufacturing imports divided
  19 The number of goods is chosen to balance computational burden against distance between our model

and models with a continuum of goods such as Eaton and Kortum (2002). We find similar results with other
numbers of goods.
  20 SITC manufacturing sectors include “Manufactured goods classified chiefly by material,” “Machinery

and transport equipment,” and “Miscellaneous manufactured articles.”

                                                  31
            0                                          0


         -20%                                       -20%
   t0i




                                              t0i
         -40%                                       -40%


         -60%                                       -60%
                0    0.2       0.4     0.6                 0    0.2       0.4      0.6
                           ai /ai∗                                    ai /ai∗

Figure 4: Optimal trade taxes for the manufacturing case. The left panel assumes no trade
costs, δ = 1. The right panel assumes trade costs, δ = 1.44.


by total value of U.S. expenditure in manufacturing—as reported in the OECD STructural
ANalysis (STAN) database in 2009, 24.7%.
Results. Figure 4 reports optimal trade taxes as a function of comparative advantage for
manufacturing. As before, the left and right panels correspond to the models without
and with trade costs, respectively, under a normalization with zero import tariffs. Like
in the agricultural exercise of Section 6.1, we see that the maximum export tax is close to
the optimal monopoly markup that a domestic firm would have charged on the foreign
market, σ/ (σ − 1) − 1 ' 66.7%, suggesting that the U.S. remains limited in its ability to
manipulate the foreign wage.
    Table 2 displays welfare gains in the manufacturing sector. In the absence of trade
costs, as shown in the first two columns, gains from trade for the U.S. are 33% larger un-
der optimal trade taxes than in the absence of any trade taxes (36.85/27.70 − 1 ' 0.33) and
86% smaller for the R.O.W. (1 − 0.93/6.59 ' 0.86). This again suggests large inefficiencies
from terms-of-trade manipulation at the world level. Compared to our agricultural ex-
ercise, the share of the U.S. gains arising from the use of non-uniform trade taxes is now
even larger: more than two thirds (30.09/27.70 − 1 ' 0.09 as compared to 0.33).
    As in Section 6.1, although the gains from trade are dramatically reduced by trade
costs—they go down to 6.18% and 2.02% for the U.S. and the R.O.W, respectively—the
importance of non-uniform trade taxes relative to uniform tariffs remains broadly sta-
ble. In the presence of trade costs, gains from trade for the U.S., reported in the third
column, are 49% larger under optimal trade taxes than in the absence of any trade taxes
(9.21/6.18 − 1 ' 0.49), and more than half of these gains (since 7.31/6.18 − 1 ' 0.18) arise

                                             32
                            No Trade Costs (δ = 1)                  Trade Costs (δ = 1.44)
                             U.S.      R.O.W.                        U.S.      R.O.W.
             Laissez-Faire 27.70%      6.59%                        6.18%       2.02%
             Uniform Tariff 30.09%     4.87%                        7.31%       1.31%
             Optimal Taxes 36.85%      0.93%                        9.21%       0.36%

                      Table 2: Gains from trade for the manufacturing case


from the use of trade taxes that vary with comparative advantage.
    In contrast to the equivalence results of Arkolakis et al. (2012), the present results
speak well to the importance of micro-level heterogeneity for the design of and gains from
trade policy. In this example, the functional form assumption imposed on the distribu-
tion of unit labor requirements—equation (29)—implies that the model satisfies a gravity
equation, as in Eaton and Kortum (2002). Conditional on matching the same trade elas-
ticity and observed trade flows, the welfare changes associated with any uniform trade
tax would be the same as in a simple Armington or Krugman (1980) model.21 This equiv-
alence is reflected in the fact that the optimal uniform tariff in the present example is
equal to the inverse of the trade elasticity multiplied by the share of foreign expendi-
ture on foreign goods, as established by Gros (1987) in the context of the Krugman (1980)
model. Since the United States is small compared to the rest of the world, this is roughly
1/θ ' 20%, both in the exercises with and without trade costs. In contrast, Figure 4 shows
that the optimal export tax is around 60% and slowly decreasing in absolute value with
Foreign’s relative unit labor requirements. As shown in Table 2, these differences in de-
sign are associated with significant welfare effects, at least within the scope of this simple
calibrated example.
    Intuitively, the equivalence emphasized by Arkolakis et al. (2012) builds on the ob-
servation that at the aggregate level, standard gravity models are equivalent to endow-
ment models in which countries exchange labor and relative labor demand curves are
iso-elastic. Hence, conditional on the shape of these demand curves, the aggregate im-
plications of uniform changes in trade costs, i.e. exogenous demand shifters, must be
the same in all gravity models. For those particular changes, the micro-level assump-
tions through which iso-elastic demand curves come about—either CES utility functions
in the Armington model or an extreme value distribution in the Eaton and Kortum (2002)
model—are irrelevant. Trade taxes, however, are imposed on goods, not labor. When het-

   21 The basic argument is the same as the one used by Arkolakis et al. (2012) to establish that the welfare
changes associated with any movement in iceberg trade costs are the same in the Armington, Krugman
(1980), and Eaton and Kortum (2002) models. See Costinot and Rodríguez-Clare (2013) for a general dis-
cussion of the effects of trade policy in gravity models.

                                                     33
erogeneous across goods, such taxes no longer act as simple labor demand shifters and
the equivalence in Arkolakis et al. (2012) breaks down. This is precisely what happens
when trade taxes are chosen optimally.


7    Concluding Remarks
Comparative advantage is at the core of neoclassical trade theory. In this paper we have
taken a first stab at exploring how comparative advantage across nations affects the de-
sign of optimal trade policy. In the context of a canonical Ricardian model of interna-
tional trade we have shown that optimal trade taxes should be uniform across imported
goods and weakly monotone with respect to comparative advantage across exported
goods. Specifically, export goods featuring weaker comparative advantage should be
taxed less (or subsidized more) relative to those featuring stronger comparative advan-
tage, reflecting the fact that countries have more room to manipulate world prices in their
comparative-advantage sectors.
    Though the focus of our paper is primarily normative, the previous results also have
positive implications. Like perfectly competitive models providing a benchmark to iden-
tify market failures, we view our model with a welfare-maximizing government as a
useful benchmark to assess the importance of political-economy considerations in prac-
tice. Previous empirical work by Broda et al. (2008) and Bagwell and Staiger (2011) sug-
gests that terms-of-trade considerations do affect observed trade policies across countries
and industries. In future work it would be interesting to explore empirically the extent
to which comparative advantage shapes trade taxes across import-oriented and export-
oriented sectors. The extent to which it does may provide a new window on the prefer-
ences and constraints faced by policymakers, including in agriculture where protection-
ism remains a salient global policy issue.
    At a technical level, characterizing optimal trade taxes in a Ricardian model is non-
trivial. As mentioned in the Introduction, the maximization problem of the country ma-
nipulating its terms-of-trade is infinite-dimensional, non-concave, and non-smooth. A
second contribution of our paper is to show how to use Lagrange multiplier methods to
solve such problems. Our basic strategy can be sketched as follows: (i ) use the primal ap-
proach to go from taxes to quantities; (ii ) identify concave subproblems for which general
Lagrangian necessity and sufficiency theorems apply; and (iii ) use the additive separabil-
ity of preferences to break the Lagrangian into multiple low-dimensional maximization
problems that can be solved by simple calculus. Although we have focused on optimal
trade taxes in a Ricardian model, our approach is well suited to other additively separable

                                            34
problems. For instance, one could use these tools to compute fully optimal policy in the
Melitz (2003) model, extending the results of Demidova and Rodríguez-Clare (2009) and
Felbermayr et al. (2011).
    Finally, we have studied the quantitative implications of our theoretical results for the
design of unilaterally optimal trade taxes in agricultural and manufacturing sectors. In
our applications, we have found that trade taxes that vary with comparative advantage
across goods lead to substantially larger welfare gains than optimal uniform trade taxes.
In spite of the similarities between welfare gains from trade across models featuring dif-
ferent margins of adjustment—see e.g. Atkeson and Burstein (2010) and Arkolakis et al.
(2012)—this result illustrates that the design of and the gains associated with optimal
trade policy may crucially depend on the extent of heterogeneity at the micro level.




                                             35
References
Alvarez, Fernando and Robert E. Lucas, “General Equilibrium Analysis of the Eaton-
  Kortum Model of International Trade,” Journal of Monetary Economics, 2007, 54 (6), 1726–
  1768.

Amador, Manuel and Kyle Bagwell, “The Theory of Optimal Delegation with an Appli-
 cation to Tariff Caps,” Econometrica, 2013, 81 (4), 1541–600.

  , Ivan Werning, and George-Marios Angeletos, “Commitment versus Flexibility,”
  Econometrica, 2006, 74 (2), 365–396.

Anderson, James E. and Eric Van Wincoop, “Trade Costs,” Journal of Economic Literature,
 2004, 42 (3), 691–751.

Arkolakis, Costas, Arnaud Costinot, and Andres Rodríguez-Clare, “New Trade Models,
  Same Old Gains?,” American Economic Review, 2012, 102 (1), 94–130.

Atkeson, Andrew and Ariel Burstein, “Innovation, Firm Dynamics, and International
  Trade,” Journal of Political Economy, 2010, 118 (3), 433–489.

Bagwell, Kyle and Robert W. Staiger, “An Economic Theory of GATT,” American Eco-
  nomic Review, 1999, 89 (1), 215–248.

  and , “What Do Trade Negotiators Negotiate About? Empirical Evidence from the
  World Trade Organization,” American Economic Review, 2011, 101 (4), 1238–73.

Baldwin, Robert E., “Equilibrium in International Trade: A Diagrammatic Approach,”
  Quarterly Journal of Economics, 1948, 62 (5), 748–762.

Bernard, Andew B., Jonathan Eaton, J. Bradford Jensen, and Samuel Kortum, “Plants
  and Productivity in International Trade,” American Economic Review, 2003, 93 (4), 1268–
  1290.

Bond, Eric W, “The Optimal Tariff Structure in Higher Dimensions,” International Eco-
  nomic Review, February 1990, 31 (1), 103–16.

Broda, Christian, Nuno Limao, and David E. Weinstein, “Optimal Tariffs and Market
  Power: The Evidence,” American Economic Review, December 2008, 98 (5), 2032–65.

Broda, Cristian and David Weinstein, “Globalization and the Gains from Variety,” Quar-
  terly Journal of Economics, 2006, 121 (2), 541–585.

                                           36
Costinot, Arnaud and Andres Rodríguez-Clare, Trade Theory with Numbers: Quantifying
 the Consequences of Globalization, Vol. 4 of Handbook of International Economics, Elsevier,
 2013.

  and Dave Donaldson, “How Large Are the Gains from Economic Integration? Theory
  and Evidence from U.S. Agriculture, 1880-2002,” mimeo MIT, 2011.

  , Guido Lorenzoni, and Ivan Werning, “A Theory of Capital Controls as Dynamic
  Terms-of-Trade Manipulation,” mimeo MIT, 2013.

Dekle, Robert, Jonathan Eaton, and Samuel Kortum, “Unbalanced Trade,” NBER work-
 ing paper 13035, 2007.

Demidova, Svetlana and Andres Rodríguez-Clare, “Trade policy under firm-level het-
 erogeneity in a small economy,” Journal of International Economics, 2009, 78 (1), 100–112.

Dixit, Avinash, “Tax policy in open economies,” in A. J. Auerbach and M. Feldstein,
 eds., Handbook of Public Economics, Vol. 1 of Handbook of Public Economics, Elsevier, 1985,
 chapter 6, pp. 313–374.

Dornbusch, Rudiger S., Stanley Fischer, and Paul A. Samuelson, “Comparative Ad-
 vantage, Trade, and Payments in a Ricardian Model with a Continuum of Goods,” The
 American Economic Review, 1977, 67 (5), 823–839.

Dornbusch, Rudiger, Stanley Fischer, and Paul Samuelson, “Heckscher-Ohlin Trade
 Theory with a Continuum of Goods,” Quarterly Journal of Economics, 1980, 95 (2), 203–
 224.

Eaton, Jonathan and Samuel Kortum, “Technology, Geography and Trade,” Econometrica,
  2002, 70 (5), 1741–1779.

  and    , “Putting Ricardo to Work,” Journal of Economic Perspectives, 2012, 26 (2), 65–90.

Everett, Hugh, “Generalized Lagrange Multiplier Methods for Solving Problems of Opti-
  mal Allocation of Resources,” Operations Research, 1963, 11 (3), 399–417.

Felbermayr, Gabriel J., Benjamin Jung, and Mario Larch, “Optimal Tariffs, Retaliation
  and the Welfare Loss from Tariff Wars in the Melitz Model,” CESifo Working Paper Series,
  2011.




                                            37
Gros, Daniel, “A Note on the Optimal Tariff, Retaliation and the Welfare Loss from Tariff
 Wars in a Framework with Intra-Industry Trade,” Journal of Intermational Economics,
 1987, 23, 357–367.

Head, Keith and Thierry Mayer, Gravity Equations: Toolkit, Cookbook, Workhorse, Vol. 4 of
 Handbook of International Economics, Elsevier, 2013.

Helpman, Elhanan, “Foreign Trade and Investment: Firm-Level Perspectives,” mimeo
 Harvard University, 2013.

Itoh, Motoshige and Kazuharu Kiyono, “Welfare-Enhancing Export Subsidies,” Journal
  of Political Economy, February 1987, 95 (1), 115–37.

Krugman, Paul, “Scale Economies, Product Differentiation, and the Pattern of Trade,”
  The American Economic Review, 1980, 70 (5), 950–959.

Luenberger, David G., Optimization by Vector Space Methods, John Wiley and Sons, Inc,
  1969.

Melitz, Marc and Stephen Redding, “Firm Heterogeneity and Aggregate Welfare,”
 mimeo Harvard University, 2013.

Melitz, Marc J., “The Impact of Trade on Intra-Industry Reallocations and Aggregate
 Industry Productivity,” Econometrica, 2003, 71 (6), 1695–1725.

Mill, J.S, Essays on Some Unsettled Questions of Political Economy, London: Parker, 1844.

Opp, Marcus M., “Tariff Wars in the Ricardian Model with a Continuum of Goods,” Jour-
 nal of Intermational Economics, 2009, 80, 212–225.

Ossa, Ralph, “Trade Wars and Trade Talks with Data,” NBER Working Paper, 2011.

Torrens, R., The Budget: On Commercial Policy and Colonial Policy, London: Smith, Elder,
  1844.

Wilson, Charles A., “On the General Structure of Ricardian Models with a Continuum
 of Goods: Applications to Growth, Tariff Theory, and Technical Change,” Econometrica,
 1980, 48 (7), 1675–1702.




                                            38
A     Proofs
A.1     Lemma 1
Proof of Lemma 1. (⇒) Suppose that (w∗ , p, m, c∗ , q∗ ) satisfies conditions (5)-(8). Let us start with
the first-order condition associated with utility maximization abroad. Since we have normalized
prices so that the marginal utility of income in Foreign is equal to one, the necessary first-order
condition associated with (5) implies

                                            ui∗0 (ci∗ ) = pi ,                                     (30)
                                           ´       ∗        ∗ ∗
                                             i pi ci di = w L .                                    (31)

Turning to the necessary first-order condition associated with profit maximization abroad, condi-
tion (6), we get
                                  pi ≤ w∗ ai∗ , with equality if qi∗ > 0.                          (32)

Together with the definition of mi ≡ ci − qi , the good market clearing condition (8) implies

                                                   ci∗ = qi∗ − mi .                                (33)

Combining conditions (30), (32), and (33) and using the convention ui∗0 (−mi ) ≡ ∞ if mi ≥ 0, we
obtain equation (10). Similarly, we can rearrange equations (30) and (33) as

                                                   ci∗ = di∗ ( pi ) ,                              (34)
                                                   qi∗   =   ci∗   + mi ,                          (35)

where di∗ (·) ≡ ui∗0−1 (·) denotes the foreign demand for good i. Equation (12) immediately derives
from equations (32), (34), and (35). Equation (11) can then be obtained from equations (12) and
(33). To conclude, note that equations (7) and (12) immediately imply equation (13), whereas
equations (7) and (32) imply
                                           ´
                                               i   pi qi∗ di = w∗ L∗ .

Combining the previous expression with equations (10), (30), and (33), we obtain equation (14).
    (⇐) Now suppose that (w∗ , p, m, c∗ , q∗ ) satisfies equations (10)-(14). Equations (10) and (11)
imply (30), whereas equations (10), (12), (13), and (14) imply equation (31). Since the foreign
consumer’s utility maximization problem is concave, the two first-order conditions (30) and (31)
are sufficient for condition (5) to hold. Similarly, equations (10) and (12) imply condition (32). Since
the foreign firm’s profit maximization problem is concave, this first-order condition is sufficient
for condition (6) to hold as well. Finally, equations (12) and (13) imply equation (7) and equations
(11) and (12) imply equation (8).



                                                             39
A.2     Lemma 2
Proof of Lemma 2. (⇒) Suppose that w0∗ , p0 , c0 , c0∗ , q0 , q0∗ solves Home’s planning problem. By
                                                                 

Definition 3, w0∗ , p0 , c0 , c0∗ , q0 , q0∗ solves
                                            

                                                                        ´
                                                   max                      ui (ci ) di
                                     w∗ ≥0,p≥0,c≥0,c∗ ,q≥0,q∗


subject to (5)-(9). By definition of m ≡ c − q, we know that ci = mi + qi for all i. By Lemma 1, we
also know that (w∗ , p, c, c∗ , q, q∗ ) satisfies conditions (5)-(8) if and only if equations (10)-(14) hold.
The two previous observations imply that w0∗ , m0 = c0 − q0 , q0 solves
                                                                          

                                                          ´
                                             max              i   ui (qi + mi )di                       (P0 )
                                        w∗ ≥,m,q≥0


subject to
                                                          ´
                                                              i ai qi di    ≤ L,                        (36)
                                         ´      ∗ ∗                             ∗
                                             i ai qi   (mi , w∗ ) di = L ,                              (37)
                                          ´
                                              i   pi (mi , w∗ )mi di = 0.                               (38)

The rest of the argument proceeds by contradiction. Suppose that w0∗ , m0 , q0 solves (P0 ), but
                                                                                    

does not solve (P). Then there must exist a solution w1∗ , m1 , q1 of (P) such that at least one of the
                                                                  

two constraints (16) and (17) is slack. There are three possible cases. First, constraints (16) and (17)
may be simultaneously slack. In this case, starting from m1 , one could strictly increase imports
for a positive measure of goods by a small amount, while still satisfying (15)-(17). This would
strictly increase utility and contradict the fact that w1∗ , m1 , q1 solves (P). Second, constraint (16)
                                                                    

may be slack, whereas constraint (17) is binding. In this case, starting from w∗1 and m1 , one could
strictly increase imports for a positive measure of goods and decrease the foreign wage by a small
amount such that (17) still binds. Since (15) is independent of w∗ and m and (16) is slack to start
with, (15)-(17) would still be satisfied. Since domestic utility is independent of w∗ , this would
again increase utility and contradict the fact that w1∗ , m1 , q1 solves (P). Third, constraint (17)
                                                                 

may be slack, whereas constraint (16) is binding. In this case, starting from w∗1 and m1 , one could
strictly increase imports for a positive measure of goods and increase the foreign wage by a small
amount such that (16) still binds. For the exact same reasons as in the previous case, this would
again contradict the fact that w1∗ , m1 , q1 solves (P).
                                                

    (⇐) Suppose that w0∗ , m0 , q0 solves (P). From the first part of our proof we know that at
                                         

any solution to (P), (16) and (17) must be binding. Thus m0 , q0 , w0∗ solves (P0 ). Now con-
                                                                              

sider w0∗ , p0 , c0 , c0∗ , q0 , q0∗ such that p0 = p m0 , w0∗ , c0 = m0 + q0 , c0∗ = c∗ m0 , w0∗ , and
                                                                                                  

q0∗ = q∗ m0 , w0∗ . From Lemma 1, w0∗ , p0 , c0 , c0∗ , q0 , q0∗ therefore also satisfies constraints (5)-
                                                                

(9). Furthermore, from the first part of our proof, any solution w1∗ , p1 , c1 , c1∗ , q1 , q1∗ to Home’s
                                                                                               



                                                           40
planning problem must also solve (P0 ) and, in turn, satisfy
                                           ´                                   ´
                                               i   ui (q1i + m1i )di =             i   ui (q0i + m0i )di.

This implies that w0∗ , p0 , c0 , c0∗ , q0 , q0∗ solves Home’s planning problem.
                                                



A.3       Lemma 3
Proof of Lemma 3. (⇒) Suppose that m0 , q0 solves (Pw∗ ). Let us first demonstrate that (Pw∗ ) is a
                                          

concave maximization problem. Consider f i (mi ) ≡ pi (mi , w0∗ )mi . By equation (10), we know that
                                                   (
                                                                 mi w∗ ai∗ ,           if mi > −di∗ (w∗ ai∗ ),
                             f i ( mi ) =                                                                               .
                                                          mi ui∗0 (−mi ),              if mi ≤ −di∗ (w∗ ai∗ ).

For mi > −di∗ (w∗ ai∗ ), we have f i0 (mi ) = w∗ ai∗ . For mi < −di∗ (w∗ ai∗ ), σ∗ ≥ 1 implies f i0 (mi ) =
                      1                                                1
 1 − σ1∗ β∗i (−mi )− σ∗ > 0 and f i00 (mi ) = σ1∗ 1 − σ1∗ β∗i (−mi )− σ∗ −1 > 0. Since
                                                        


                                                                                                                  1
                                                                                                                      
                                                   0
                            lim                f ( mi ) =        w∗ ai∗   >                lim                 1− ∗         w∗ ai∗ ,
                    mi →+ −di∗ (w∗ ai∗ )                                       mi →− −di∗ (w∗ ai∗ )              σ

f i is convex and increasing for all i.
    Now consider gi (mi ) ≡ ai∗ qi∗ mi , w0∗ . By equation (12), we know that
                                            

                                       (
                                                       mi ai∗ + ai∗ di∗ (w∗ ai∗ ),           if mi > −di∗ (w∗ ai∗ ),
                        gi ( m i ) =
                                                                                   0,        if mi ≤ −di∗ (w∗ ai∗ ).

For mi > −di∗ (w∗ ai∗ ), we have gi0 (mi ) = ai∗ . For mi < −di∗ (w∗ ai∗ ), g0 (mi ) = 0. Thus gi is convex
and increasing for all i.
    Since ui is strictly concave in (mi , qi ), ai qi is linear in qi , and f i and gi are convex in mi , the
objective function is a concave functional, whereas the constraints are of the form G (m, q) ≤ 0,
with G a convex functional. Accordingly, Theorem 1, p. 217 in Luenberger (1969) implies the
existence of (λ, λ∗ , µ) ≥ 0 such that m0 , q0 solves
                                              


                                       ´                                        ´
  max L (m, q, λ, λ∗ , µ; w∗ ) ≡           i   ui (qi + mi ) di − λ                    i ai qi di
  m,q≥0
                                                                                               ´                                   ´
                                                                                       − λ∗            ∗ ∗
                                                                                                    i ai qi   (mi , w∗ ) di − µ        i   pi (mi , w∗ )mi di.




                                                                          41
and the three following conditions hold:
                                                                                 ´         0
                                                                     λ L−            i ai qi di         = 0,
                                                                                                    
                                                             ´
                                         λ∗ L∗ −                    ∗ ∗
                                                                 i ai qi      m0i , w    ∗     di       = 0,
                                                                                                   
                                                             ´
                                                                     pi (m0i , w∗ )m0i di               = 0.
                                                                                                    
                                                         µ       i


Since m0 , q0 satisfies constraints (15)-(17), we therefore have
             

                             ´         0
                    λ ≥ 0,       i ai qi di   ≤ L, with complementary slackness,                                                                 (39)
                             ´
                   λ∗ ≥ 0,          ∗ ∗
                                 i ai qi      m0i , w∗ di ≤ L∗ , with complementary slackness,                                                   (40)
                                                      
                             ´
                    µ ≥ 0,       i   pi (mi , w∗ )m0i di ≤ 0, with complementary slackness.                                                      (41)

To conclude, note that if m0 , q0 solves maxm,q≥0 L (m, q, λ, λ∗ , µ; w∗ ), then for almost all i, m0i , q0i
                                                                                                            

must solve


   max Li (mi , qi , λ, λ∗ , µ; w∗ ) ≡ ui (qi + mi ) − λai qi
  mi ,qi ≥0

                                                                                                        − λ∗ ai∗ qi∗ (mi , w∗ ) − µpi (mi , w∗ )mi .

(⇐) Now suppose that m0i , q0i solves (Pi ) for almost all i with λ, λ∗ , µ such that conditions (39)-
                              

(41) hold. This implies
                                       m0 , q0 ∈ arg max L (m, q, λ, λ∗ , µ; w∗ ) .
                                              
                                                                     m,q≥0

Suppose first that all Lagrange multipliers are strictly positive: λ > 0, λ∗ > 0, µ > 0, then
conditions (39)-(41) imply
                                                                        ´         0
                                                                            i ai qi di     = L,
                                                ´      ∗ ∗
                                                    i ai qi          m0i , w   ∗     di = L∗ ,
                                                                                 
                                                 ´
                                                     i   pi (m0i , w∗ )m0i di = 0.

Thus Theorem 1, p. 220 in Luenberger (1969) immediately implies that m0 , q0 is a solution to
                                                                            

(Pw∗ ). Now suppose that at least one Lagrange multiplier is equal to zero. For expositional pur-
poses suppose that λ = 0, whereas λ∗ > 0 and µ > 0. In this case, we have

                                        m0 , q0 ∈ arg max L (m, q, 0, λ∗ , µ; w∗ )
                                               
                                                                      m,q≥0


and
                                                ´      ∗ ∗
                                                    i ai qi          m0i , w∗ di = L∗ ,
                                                                             
                                                 ´
                                                     i   pi (m0i , w∗ )m0i di = 0.

                                                                             42
Thus Theorem 1, p. 220 in Luenberger (1969) now implies that m0 , q0 is a solution to
                                                                    

                                                     ´
                                             max         i   ui (qi + mi ) di
                                             m,q≥0


subject to
                                    ´      ∗ ∗
                                        i ai qi   (mi , w∗ ) di ≤ L∗ ,
                                     ´
                                         i   mi pi (mi , w∗ )di ≤ 0.
        ´         0
Since         ≤ L by condition (39), m0 , q0 is therefore also a solution to (Pw∗ ). The other cases
            i ai qi di
                                            

can be dealt with in a similar manner.




                                                              43
