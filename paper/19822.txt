                                   NBER WORKING PAPER SERIES




A THEORY OF INCOME TAXATION UNDER MULTIDIMENSIONAL SKILL HETEROGENEITY

                                             Casey Rothschild
                                              Florian Scheuer

                                           Working Paper 19822
                                   http://www.nber.org/papers/w19822


                        NATIONAL BUREAU OF ECONOMIC RESEARCH
                                 1050 Massachusetts Avenue
                                   Cambridge, MA 02138
                                       January 2014




  We thank Lizi Chen, Gordon Dahl, Alex Diesl, Roger Gordon, Guy Laroque, Guido Menzio, Torsten
  Persson, Edouard Schaal, Johannes Spinnewijn, Venky Venkateswaran, Gianluca Violante and seminar
  participants at Bocconi, IIES Stockholm, LSE/IFS, NYU, University of Pennsylvania, Toulouse, UC
  San Diego and Zurich for helpful comments. All errors are our own. The views expressed herein are
  those of the authors and do not necessarily reflect the views of the National Bureau of Economic Research.

  NBER working papers are circulated for discussion and comment purposes. They have not been peer-
  reviewed or been subject to the review by the NBER Board of Directors that accompanies official
  NBER publications.

  © 2014 by Casey Rothschild and Florian Scheuer. All rights reserved. Short sections of text, not to
  exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
  © notice, is given to the source.
A Theory of Income Taxation under Multidimensional Skill Heterogeneity
Casey Rothschild and Florian Scheuer
NBER Working Paper No. 19822
January 2014
JEL No. D5,D6,D8,E2,H2,J3

                                             ABSTRACT

We develop a unifying framework for optimal income taxation in multi-sector economies with general
patterns of externalities. Agents in this model are characterized by an N-dimensional skill vector
corresponding to intrinsic abilities in N potentially externality-causing activities. The private return
to each activity depends on individual skill and an aggregate activity-specific return, which is a fully
general function of the economy-wide distribution of activity-specific efforts. We show that the N-
dimensional heterogeneity can be collapsed to a one-dimensional, endogenous statistic sufficient
for screening. The optimal tax schedule features a multiplicative income-specific correction to an
otherwise standard tax formula. Because externalities change the relative returns to different activities,
corrective taxes induce changes in the across-activity allocation of effort. These relative return effects
cause the optimal correction to diverge, in general, from the Pigouvian tax that would align private
and social returns. We characterize this divergence and its implications for the shape of the tax schedule
both generally and in a number of applications, including externality-free economies, increasing and
decreasing returns to scale, zero-sum activities such as bargaining or rent extraction, and positive or
negative spillovers.


Casey Rothschild
Wellesley College
106 Central Street
Wellesley, MA 02481
crothsch@wellesley.edu

Florian Scheuer
Department of Economics
Stanford University
579 Serra Mall
Stanford, CA 94305
and NBER
scheuer@stanford.edu
1      Introduction
How to design redistributive income tax systems is both a classic question in economics
and a recurrent topic in public policy debates, as exemplified by the recent “Occupy”
and “Tea Party” movements. While the standard equity-efficiency tradeoff, i.e., the ten-
sion between redistributional goals and tax distortions, which has long been emphasized
by the formal optimal taxation literature,1 has played some role, the recent debate has
pointed to two central issues that have not been captured by this canonical framework.
First, the trend towards greater income inequality in the past decades (as documented
e.g. by Atkinson et al., 2011) has gone hand in hand with shifts in the sectoral structure
of the economy, for instance a flow towards finance at the top of the income distribution.
Second, supporters of the recent calls for higher taxes on high earners have questioned
whether wages in some occupations actually fully reflect the true social marginal product
of these activities.
    Motivated by these observations, this paper provides a general framework for the
analysis of optimal income taxation in multi-sector economies with endogenous wages
and arbitrary patterns of externalities. In particular, individuals can pursue N different
activities, the returns to each of which may depend on the aggregate efforts in this and
all other activities, and in a way not necessarily aligned with marginal products. We
allow for an extremely rich structure of heterogeneity, where individuals can differ along
N continuous dimensions of private information, namely a skill type for each of the N
activities. Tax policies in this setting reflect two key novel effects: First, sectoral shifts
of effort in response to changes in the relative returns to different activities induced by
changes in the income tax; and second, Pigouvian motives for taxation, correcting the
wedge between wages and social returns to effort in different sectors and hence different
parts of the income distribution.
   Our unifying theory encompasses many applications as special cases, some of which
have appeared earlier in our work. In Rothschild and Scheuer (2013b), we have consid-
ered the simplest framework for illustrating the first of the two effects above: A two-sector
economy with a constant returns to scale aggregate production function and private re-
turns equal to marginal products. With complementary sectors, the income tax schedule
can be used to manipulate the relative returns to the two sectors and thereby achieve
redistribution indirectly through general equilibrium effects. In Rothschild and Scheuer
(2013a), we have added the second effect, again in the most parsimonious way: One of
the two activities is rent-seeking and imposes negative externalities, so its private returns
    1 See   Mirrlees (1971), Diamond (1998), Saez (2001), Werning (2007).


                                                        1
exceed its social marginal product, and the second, traditional activity generates no ex-
ternalities. We use this to demonstrate how the optimal correction can deviate from the
partial equilibrium, Pigouvian correction due to the general equilibrium effects from sec-
toral shifts of effort between productive and unproductive work.
    Although instructive, these examples remain restrictive in capturing many real-world
settings. For instance, imagine a team production setting where individuals spend effort
both to actually produce output and to claim credit (and get paid) for the output they
or others have produced. Since claiming credit is a zero sum activity from a social per-
spective, its private returns will typically exceed its social returns. On the other hand, the
some of the returns to the productive activity are captured by effort in the other activity.
Hence, this is a setting where both activities generate externalities—one negative, and the
other positive.
   Some recent contributions to the taxation literature have addressed related phenom-
ena. For instance, Piketty et al. (2013) have emphasized that some top incomes may
come at the expense of lower incomes, e.g. because executive officers may set their com-
pensation through bargaining, so when they claim a larger share of the resources in the
company, they leave less for workers. Besley and Ghatak (2013) argue that some sectors
may capture resources from other sectors, e.g. in the form of bailouts from productive
workers to the financial sector. Lockwood et al. (2013) consider a model with multiple
occupations, some over- and some underpaid, with different relative representations in
different parts of the income distribution, justifying a purely Pigouvian role for the in-
come tax. However, all these papers assume a very simple pattern of externalities, in the
sense that whenever some activity is overpaid, this comes at the expense of everyone else
uniformly, rather than at the expense of some more than others.
    In contrast, the unifying framework we develop here allows us to consider activi-
ties that can be linked through arbitrarily rich externality structures: some activities may
generate positive and others negative externalities, and the externalities may be borne dif-
ferently by different activities. For instance, an increase in aggregate effort in the claiming
credit activity in the above example clearly reduces the returns to the productive activity.
But it may also reduce the return to claiming credit itself, e.g. when this activity is subject
to crowding. Depending on which effect is stronger, the relative return to the unproduc-
tive activity may rise or fall. This in turn determines whether a marginal tax increase at
incomes where the unproductive activity is strongly represented leads to a beneficial flow
of effort to the productive activity, or a perverse shift to the unproductive activity.
    These sectoral shift effects in response to relative return changes turn out to play an
important role for optimal tax policy. We derive a useful formula for our general frame-


                                              2
work that offers insight into the size and direction of the divergence between the optimal
correction and the partial equilibrium Pigouvian correction that ignores these relative re-
turn effects. We also show that this divergence vanishes precisely when a variation in
the marginal income tax rate at a given income level induces no relative return changes.
We use these general results in various specific applications to characterize both the opti-
mal level and the optimal progressivity of the income tax schedule for any redistributive
objectives, captured by arbitrary Pareto weights.
   Since our model naturally involves N dimensions of private information, we begin
by demonstrating how they can be collapsed into a single dimension relevant for screen-
ing, extending our previous work in Rothschild and Scheuer (2013a,b).2 Although set-
tings with multidimensional heterogeneity are frequently challenging to solve (Rochet
and Choné, 1998), we identify a one-dimensional, but endogenous, summary statistic for
heterogeneity in our framework. Because taxes can only condition on income, not on
how it is earned through different activities, an individual always earns a given amount
of income through a cost-minimizing combination of efforts in the N activities. For any
vector of activity-specific returns, this results in a well-defined wage that determines her
preferences over consumption-income bundles. We can therefore work with a screening
problem in terms of these wages, with the only complication that they depend on sectoral
returns and therefore the vector of aggregate efforts in all activities.
   We first solve this screening problem for any given combination of sectoral efforts
(the “inner” problem), which allows us to obtain a formula for the marginal income tax
rate in any Pareto optimum (Proposition 1). It closely mirrors the formula for a standard
Mirrlees model, but features an additional adjustment factor that captures the optimal
correction both for externalities and relative return effects. The remainder of the paper
is then focused on characterizing precisely this adjustment factor. Since this is closely
related to finding the optimal combination of aggregate efforts in each activity for a given
set of Pareto weights (the “outer” problem), we describe the welfare effects of marginal
variations in these efforts in some detail, which prominently feature the sectoral shift
effects that we emphasize (Lemma 4).
    We then use the resulting optimality condition to characterize the adjustment factor
in the marginal tax rate formula and, more importantly, compare it to the partial equilib-
rium, Pigouvian correction, which is simply the income share weighted average, at each
income level, of the wedges between the private returns and social marginal products of
the activities, as e.g. in Lockwood et al. (2013). Proposition 2 shows that the two coincide
   2 For other recent studies of optimal taxation under multidimensional heterogeneity, see e.g. Kleven et
al. (2009), Choné and Laroque (2010) and Scheuer (2013).


                                                    3
precisely at income levels where a variation in the marginal tax rate has no relative return
effects. Based on this, Proposition 3 provides conditions under which the dimensionality
of the Pareto problem can be reduced: If there are K directions in the space R N of ag-
gregate sectoral effort vectors in which there are both no relative return effects and no
externalities, then the outer problem effectively collapses to an N − K-dimensional prob-
lem with N − K consistency constraints. We identify both special cases in Rothschild and
Scheuer (2013a,b) as applications of this general principle, where two-sector models can
be solved with a single sufficient statistic for the wage distribution.
   We then illustrate how the general tools developed here can be used to characterize
the shape of optimal tax schedules in a number of important applications, two of which
extend our earlier work and the rest of which are novel. The first investigates how the
results from the externality-free environment with two sectors considered in Rothschild
and Scheuer (2013b) extend to settings with more than two sectors (Proposition 4). We
argue that the presence of additional sectors can reinforce the regressive adjustment to
the standard Mirrleesian tax schedule that we found for the two-sector model, effectively
moving the optimal progressivity of the income tax closer to that in a model with fixed
occupations, such as Stiglitz (1982).
   The second application adds aggregate externalities in the form of increasing or de-
creasing returns to scale to the two-sector model. In this case, the adjustment factor can
be transparently decomposed into a local and global component (Proposition 5). The first,
which depends on the income shares of the two activities at any given income level, has
the same regressive form as in the no externalities case, capturing relative return effects.
The second, uniform across income levels, accounts for the externalities and simply scales
all marginal tax rates up (down) under decreasing (increasing) returns to scale.
    We then consider the case where aggregate technology exhibits constant returns to
scale, but the sectoral income shares are decoupled from marginal products, as motivated
by the example discussed at the beginning (Proposition 6). For instance, suppose the
relatively high-wage activity is also the overpaid activity, in the sense that its aggregate
income share exceeds what would correspond to its marginal product. Then the Pigou-
vian correction implies a more progressive income tax schedule than in a standard Mir-
rlees model. However, the optimal correction exceeds this Pigouvian correction at any
given income level if an increase in the marginal tax rate reduces the relative return to the
overpaid activity and thus induces a beneficial shift of effort out of it, and vice versa.
    Finally, we turn to two applications that we can fully characterize for general N,
namely the case where all returns depend only on the aggregate effort in one activity
(Proposition 7), or where the returns to all activities are fixed, except for one, which


                                             4
depends on the aggregate efforts in all activities (Proposition 8). The first is a gener-
alization of Rothschild and Scheuer (2013b), allowing for more than one traditional ac-
tivity and positive or mixed externalities, such as positive spillovers from research or
entrepreneurial activities onto other sectors, but within-sector crowding effects.
   By restricting attention to taxes on income, rather than instruments that perfectly tar-
get its decomposition into earnings from specific activities, our paper crucially differs
from most of the literature on corrective taxation in the presence of externalities.3 This
restriction prevents the simple “principle of targeting” (Dixit, 1985) from applying, un-
der which the optimal correction is equal to the Pigouvian tax, and therefore makes our
analysis both theoretically interesting and practically relevant. Instead, we show how,
under imperfect instruments, the adjustment to the optimal tax formula diverges from
the Pigouvian tax depending on relative return effects.
    Our analysis is more closely related to Diamond (1973), who shows that the optimal
linear tax on an externality producing consumption good can be expressed as a correc-
tion capturing the direct effect on the demand for the good, and an adjustment term that
reflects the indirect, general equilibrium effect of the changes in consumption of the good
induced by the direct effect. We have a distinct motivation for such general equilibrium
effects, namely in the form of effort choice along various activities, which allows us to pro-
vide insights into how the optimal correction deviates from the Pigouvian tax. Moreover,
whereas Diamond’s analysis is in the Ramsey framework, we focus on nonlinear taxation
in a Mirrlees setting, including both redistributive and corrective motives for taxation.4
    The paper is organized as follows. Section 2 introduces the model, provides some sim-
ple illustrations of its flexibility, and shows how the multidimensional screening problem
can be collapsed. Section 3 provides the general N-sector results, including the marginal
tax rate formula and the key optimality conditions for the outer problem. Section 4 pro-
vides a further characterization for N = 2 and Section 5 collects the discussion of the
applications. All proofs are relegated to an appendix.


2      The Model

2.1     Setup
We consider an economy in which individuals can pursue N different activities, indexed
by i. Each agent is characterized by an N-dimensional unobservable skill vector θ ∈ Θ ≡
    3 See   Sandmo (1975), Sadka (1978), Cremer et al. (1998) and Kopczuk (2003).
    4 Similarly to Diamond (1973), Lockwood et al. (2013) also abstract from redistributive concerns.


                                                       5
ΠiN=1 Θi , where the ith element θi ∈ Θi = [θ i , θ i ] captures her skill in activity i. We assume
θi > 0 for all i. Skills are distributed with a continuous N-dimensional cdf F : Θ → [0, 1]
and associated pdf f (θ ).
     Individual preferences are characterized by a continuously differentiable and con-
cave utility function over consumption c and the vector of efforts in each activity, e =
(e1 , ..., e N ), given by U (c, e) = u(c, m(e)) ≡ u(c, l ). We assume uc > 0, ul < 0, and
that the effort aggregator m(e) is increasing in all arguments, continuously differentiable,
strictly quasiconvex and linear homogeneous.5 We denote the consumption and vector
of activity-specific efforts of an individual of type θ by c(θ ) and e(θ ) = (e1 (θ ), ..., e N (θ )),
and the total individual effort and utility by l (θ ) ≡ m(e(θ )) and V (θ ) ≡ u(c(θ ), l (θ )).
     Aggregate output (and hence income) Y ( E) consists of the aggregate incomes gener-
ated in each activity Y i ( E), so Y ( E) = ∑iN=1 Y i ( E), where
                                                     !
                                              Ei ≡           θi ei (θ )dF (θ )                                       (1)
                                                         Θ

is the aggregate effective (i.e., skill-weighted) effort in activity i, and each Y i can depend
on the entire vector of aggregate efforts E ≡ ( E1 , ..., EN ). The income of an individual of
type θ in activity i is yi (θ ), and her total income from all activities is y(θ ) ≡ ∑iN=1 yi (θ ).
                                                                     "
Accordingly, aggregate total and sectoral incomes are Y ( E) = Θ y(θ )dF (θ ) and Y i ( E) =
"
  Θ yi ( θ ) dF ( θ ) for all i.
    At this point, we remain fully general about the form of technology linking the N
sectors, with the only assumption that each unit of effective effort in a given sector has
the same private return. Formally, for each activity i, there exists some return ri ( E) such
that yi (θ ) = ri ( E)θi ei (θ ) for all θ ∈ Θ. As a result, using (1), Y i ( E) = ri ( E) Ei and we
can write Y ( E) = ∑iN=1 ri ( E) Ei . Note that the returns ri may deviate from the marginal
product of effort in activity i, given by Yi ( E) ≡ ∂Y ( E)/∂Ei , thus allowing for arbitrary
patterns of externalities as illustrated next.


2.2     Examples
A simple example occurs when Y ( E) is a standard neoclassical production function with
ri ( E) = Yi ( E) for all E, so returns correspond to marginal products. For instance, in the
   5 This allows for preferences ũ ( c, m̃ ( e )) where m̃ is homothetic even if not linear homogeneous:  then there
exists some increasing h(.) and linear homogeneous m(e) such that we can write m̃(e) = h(m(e)), and we
can define u(c, l ) ≡ ũ(c, h(l )). Hence, ũ(c, m̃(e)) = u(c, m(e)) for all (c, e). An example is û(c) − ∑iN=1 hi (ei )
when all hi (.) are homogeneous of the same degree. A limiting case would obtain for m(e) = ∑iN=1 ei , so
that m is weakly but not strictly quasiconvex. Then individuals would always specialize in the activity that
yields them the highest returns, as in the Roy models considered in Rothschild and Scheuer (2011, 2013).


                                                              6
limiting case where m(e) becomes linear and individuals always specialize in one of the
N activities, we could interpret Y ( E) as an aggregate production function for an economy
with N complementary sectors or occupations i, and characterize an optimal income tax
in such a multi-sector Roy (1951) model, as in Rothschild and Scheuer (2013b) for N = 2.
    The recent debate about tax policy has started to question whether private and social
returns always coincide. For instance, incomes in some activities may come at the expense
of others, through bargaining, rent-seeking or negative externalities. Consider e.g. the
team production setting from the introduction where individuals spend time and effort
both to produce output (activity 2) and to get credit (and compensated) for this output (ac-
tivity 1). This can be captured by Y ( E) = E2 and Y 1 ( E) = a( E1 ) E2 , Y 2 ( E) = (1 − a( E1 )) E2 ,
where a( E1 ) is some increasing function. Here, activity 2 generates positive externalities
as it increases the returns r1 = a( E1 ) E2 /E1 to activity 1, and activity 1 imposes negative
externalities on activity 2. For instance, in Biais et al. (2011), fast traders impose ex-
ternalities on slow traders through adverse selection from their information advantage.
Glode and Lowery (2012) consider a model where financial sector workers engage in both
(unproductive) speculative trading and surplus creation (e.g. from market making) and
argue that profits from both activities are interlinked.
     Another example for a pure zero sum activity would be a setting where activity 1 just
takes away output produced through activity 2 one-for-one, so that Y ( E) = Y ( E2 ) and
Y 1 ( E1 ) = E1 , Y 2 ( E) = Y ( E2 ) − E1 . Here, both activities again generate externalities, but
only on the returns r2 ( E) = (Y ( E2 ) − E1 )/E2 to the productive activity 2 (the returns to
activity 1 are fixed at 1, so it bears no externalities). The opposite special case is considered
in Rothschild and Scheuer (2013a) (again for N = 2), where only one (rent-seeking) activ-
ity imposes (negative) externalities on itself and all other activities, so ri ( E1 ) for all i and
all ri are decreasing. This could capture negative externalities from search activities with
crowding effects, e.g. for profitable arbitrage opportunities in financial markets, or tour-
naments and races with winner-takes-all compensation in the arts, entertainment, law or
R&D. On the other hand, our general framework can also allow for positive externalities,
such as spillover effects from entrepreneurial and innovative activities.
     These examples make clear that individual activities may be hard to target separately.
As emphasized in Lockwood et al. (2013), it may also be the case that some identifiable
sectors or professions are on average over- or underpaid. Our analysis formally applies in
these settings as well. Of course, separate, occupation-specific tax schedules—which we
do not consider here—will typically be desirable in these settings. Our analytical frame-
work is still useful insofar as implementability problems, including relabeling of activities
when there is a “fuzzy frontier,” special interest lobbying for lower taxes, horizontal eq-


                                                   7
uity concerns, or multiple activities within professions (in which case our analysis applies
even to a profession-specific tax), render such targeted taxes impractical. We revisit the
above and other examples in Section 5.


2.3   Income Tax Implementation
We first describe the set of feasible allocations using a direct mechanism and then link this
to the implementation through a nonlinear income tax schedule. Individuals announce
their type θ and then get assigned consumption c(θ ), total income y(θ ), and the fraction of
income earned through each activity i, given by qi (θ ) ≡ yi (θ )/y(θ ) = ri ( E)θi ei (θ )/y(θ ).
Let q(θ ) ≡ (q1 (θ ), ..., q N (θ )) ∈ ∆ N −1 be the vector of these income shares, where ∆ N −1 =
{q ∈ R N | ∑iN=1 qi = 1, qi ≥ 0} is the N − 1 dimensional unit simplex.
    Assuming that only income y and consumption c are observable, but not an indi-
vidual’s skill type θ nor their sectoral efforts ei (nor the income shares qi ), the incentive
constraints that guarantee truth-telling of the agents are:
                      #          #                                        $$
                               q1 ( θ ) y ( θ )         q N (θ )y(θ )
                 u c ( θ ), m                   , ... ,
                                θ1 r1 ( E )              θ N r N ( E)
                           % #             #                                      $$&
                                  '             p1 y ( θ ' )          p N y(θ ' )
               ≥ max u c(θ ), m                              , ... ,                  ∀θ, θ ' ∈ Θ,   (2)
                 p∈∆ N − 1                     θ1 r1 ( E )           θ N r N ( E)

since each type θ can imitate type θ ' by earning the income of type θ ' using a continuum
of efforts combinations and hence income shares p = ( p1 , ..., p N ) in the N activities.
    The following two results show how the N-dimensional incentive constraints (2) can
be collapsed into a one-dimensional screening problem in terms of an endogenous sum-
mary statistic of heterogeneity. First, incentive compatibility implies that each type θ has
a well-defined wage w ≡ y/l and vector of sectoral income shares q, which both depend
on E but are otherwise independent of the allocation.

Lemma 1. Suppose that only income y and consumption c are observable, whereas an individual’s
skill type θ and vector of efforts e and income shares q are private information. Then, in any
incentive compatible allocation {c(θ ), y(θ ), q(θ ), E},
                                                   #                                   $ −1
                              y(θ )                       p1                  pN
                    w(θ ) ≡          = max m                      , ... ,                   (3)
                              l (θ )   p ∈ ∆ N −1     θ1 r1 ( E )         θ N r N ( E)
and q(θ ) is the corresponding arg max.

   Lemma 1, which generalizes the result for N = 2 in Rothschild and Scheuer (2013a),
establishes that, in any incentive compatible allocation, each type’s wage w(θ ) is fully

                                                      8
                          ݁ଶ


                     ݉ሺ݁ሻ ൌ ߙ݈

                     ݉ሺ݁ሻ ൌ ݈
                                                                                  ෍ ߠ௜ ‫ݎ‬௜ ሺ‫ܧ‬ሻ݁௜ ൌ ߙ‫ݕ‬
                                                                                   ௜


                                                                    ෍ ߠ௜ ‫ݎ‬௜ ሺ‫ܧ‬ሻ݁௜ ൌ ‫ݕ‬    ݁ଵ
                                                                     ௜


               Figure 1: Determination of wages and income shares given E

pinned down by the vector E. To make this explicit, we write wE (θ ) in the following.
Moreover, the vector of income shares q(θ ) is chosen so as to minimize the overall effort
m(e) subject to achieving a given amount of income: By (3) and linear homogeneity of m,
                          #                                       $ −1                        N
                                  p1 y                pN y                        y
   wE (θ ) = max ym
             p ∈ ∆ N −1        θ1 r1 ( E )
                                           , ... ,
                                                   θ N r N ( E)
                                                                         = max
                                                                            e    m(e)
                                                                                      s.t.   ∑ θ i r i ( E ) ei = y   (4)
                                                                                             i =1

for any y. Again by linear homogeneity of m, the vector q(θ ) only depends on the vector
of skill ratios φ ≡ (θ1 /θ N , ..., θ N −1 /θ N ) in addition to E, which is why we write q E (φ)
henceforth, with φ ∈ Φ ≡ (0, ∞) N −1 . Since m is strictly quasiconvex, q E (φ) is uniquely
determined by E for each φ.
    Figure 1 illustrates the intuition underlying Lemma 1 for the case of two activities. By
(4), individuals choose their efforts e1 and e2 to minimize their overall effort m(e) subject
to achieving a given amount of income y. When the targeted amount of income changes,
say by factor α, their optimal effort ratio e1 /e2 , and m(e), also increase by the factor α due
to the linear homogeneity of m. Hence, their income shares q1 and q2 as well as their wage
y/m(e) are independent of y and only depend on the slope of the lines in Figure 1, which
is fully pinned down by the returns ri ( E).
    All individuals with the same wage w have the same preferences over (c, y)-bundles
given by u(c, y/w). As is standard, we assume the single crossing property, i.e., that the
marginal rate of substitution between y and c, −ul (c, y/w)/ (wuc (c, y/w)), is decreasing
in w. Under this condition, any incentive compatible allocation can be implemented with
a non-linear income tax T (y).

Lemma 2. Consider the observability assumptions from Lemma 1 and suppose that the allocation

                                                            9
{c(θ ), y(θ ), q(θ ), E} is incentive compatible. Then
(i) wE (θ ) = wE (θ ' ) = w implies u(c(θ ), y(θ )/w) = u(c(θ ' ), y(θ ' )/w), and
(ii) {c(θ ), y(θ ), q(θ ), E} can be implemented by offering the single non-linear income tax schedule
T ∗ (y) corresponding to the retention function R∗ (y) = y − T ∗ (y) defined by
                           % ' #                $    #           $        &
                              '         y(θ )              y
                  ∗           '
                R (y) ≡ max c 'u c(θ ),           ≥ u c,           ∀θ ∈ Θ                         (5)
                         c              wE (θ )          wE (θ )

and letting all agents choose one of their most preferred (c, y)-bundles from the resulting budget
set B∗ = {(c, y)|c ≤ y − T ∗ (y)}.

    Lemma 2 does not rule out the possibility that two individuals with the same w (but
different q’s) choose different (c, y)-bundles, even though, by property (i), these bundles
must be located on the same indifference curve in the (c, y)-space. To trace out the Pareto
frontier, we can nevertheless restrict attention to allocations {c(w), y(w), E} that pool all
same-wage individuals at the same (c, y)-bundle by the arguments in Rothschild and
Scheuer (2013b). We focus on such allocations in the following.


3     N Sectors

3.1    Definitions
We use general cumulative Pareto weights Ψ(θ ) defined over the N-dimensional Θ-space
with the corresponding density ψ(θ ) to trace out the set of Pareto efficient allocations. The
                          "
social planner maximizes Θ V (θ )dΨ(θ ) subject to resource and self-selection constraints.
The observation that makes this problem tractable is that, by Lemma 1, fixing the vector
E determines the wage wE (θ ) and the vector of income shares q E (φ) for each type θ. For
any given E, the cdf over (w, φ)-vectors, given by
                                     !
                       GE (w, φ) ≡                                                    dF (θ )
                                         {θ |wE (θ )≤w, θi /θ N ≤φi ∀i =1,...,N −1}

with the corresponding density gE (w, φ) will be useful in the following. It is useful pre-
cisely because all individuals who earn the same wage w, and are therefore located on
the same iso-wage curve in θ-space as drawn in Figure 2, are pooled in the same alloca-
tion. Nonetheless, these individuals differ in their relative skills φ through which they
achieve wage w. Hence, conditional on E, each θ-type is fully identified by her (w, φ)-
combination. We denote the support of the wage distribution for any E by [w E , w E ],
where w E = wE (θ 1 , ..., θ N ) and w E = wE (θ 1 , ..., θ N ). This allows us to obtain the wage

                                                       10
                                   ߠଶ

                                                                         ߠଵ
                                                                  ߶ଵ ൌ
                                                                         ߠଶ

                                                                                         ߠଵᇱ
                                                                                ߶ଵ Ԣ ൌ
                                                                                         ߠଶ Ԣ




                                                                    ‫ݓ‬ா ሺߠሻ ൌ ‫ݓ‬
                                                                             ഥ

                                                                                         ߠଵ

             Figure 2: Pooling along iso-wage curves in θ-space conditional on E

distribution for any given E simply as the marginal distribution
                                        !                                ! w!
                           FE (w) ≡                          dF (θ ) =              dGE (z, φ)
                                            {θ |wE (θ )≤w}                wE    Φ

                                                   "
with the corresponding density f E (w) = Φ dGE (w, φ) as well as the sectoral densities
            "
f Ei (w) ≡ Φ qiE (φ)dGE (w, φ). Hence, the sectoral densities can be interpreted as an aver-
age value of qi for all individuals at wage w, and f E (w) = ∑iN=1 f Ei (w) for all w ∈ [w E , w E ].6
Finally, for any given E, we can derive Pareto weights over wages Ψ E (w), as well as their
density and sectoral decomposition ψE (w) = ∑iN=1 ψEi (w), completely analogously from
Ψ ( θ ).
      By the discussion following Lemma 2, we can focus on incentive compatible alloca-
tions {c(w), y(w), E} that only condition on an individual’s wage w, which then imply
total effort and utility l (w) ≡ y(w)/w and V (w) ≡ u(c(w), l (w)) as well as the activity-
specific efforts ei (θ ) = qiE (φ)y(wE (θ ))/(θi ri ( E)).


3.2       Inner and Outer Problems for Pareto Efficiency
As in Rothschild and Scheuer (2013a,b), we decompose the problem of finding Pareto
optimal allocations into two steps. The first step involves finding the optimal vector of
aggregate efforts E. We call this the “outer” problem. The second (which we call the “in-
ner” problem) involves finding the optimal resource-feasible and incentive-compatible
allocation for a given E. This inner problem is an almost standard Mirrlees problem; the
      the limiting case with m(e) = ∑iN=1 ei , (3) immediately implies qiE (φ) ∈ {0, 1} and wE (θ ) =
   6 In

max{θ1 r1 ( E), ..., θ N r N ( E)}. Then f Ei (w)/ f E (w) can be interpreted as the share of i-sector workers at w,
whereas here it is the i-sector income share at wage w.


                                                             11
only difference is that the induced vector of aggregate effective efforts has to be consistent
with the E that we are fixing for the inner problem. For some given Pareto weights Ψ(θ )
(and hence induced weights Ψ E (w)), we therefore define the inner problem as follows
(where c(V, l ) is the inverse function of u(c, l ) w.r.t. c):
                                                              ! wE
                                    W ( E) ≡          max            V (w)dΨ E (w)                                       (6)
                                                  V (w),l (w) w E

                                                                       l (w)
subject to               V ' (w) = ul (c(V (w), l (w)), l (w))               ∀w ∈ [w E , w E ]                           (7)
                                                                          w
                                              ! wE
                                      1
                              Ei =                      wl (w) f Ei (w)dw ∀i = 1, ..., N                                 (8)
                                   ri ( E )      wE
                           ! wE                             ! wE
                                  wl (w) f E (w)dw ≥               c(V (w), l (w)) f E (w)dw.                            (9)
                            wE                               wE

We employ the standard Mirrleesian approach of optimizing directly over allocations,
i.e., over effort e(w) and consumption or, equivalently, utility V (w) profiles. The social
planner maximizes a weighted average of individual utilities V (w) subject to three sets
of constraints. (9) is a standard resource constraint. The N constraints in (8) ensure that
aggregate effective effort in each sector i indeed sums up to Ei , as the right-hand-side is
              ! wE                         ! wE !                                          !
      1                                                 y(w)qiE (φ)
                     y(w) f Ei (w)dw   =                            gE (w, φ)dφdw =                θi ei (θ )dF (θ ).   (10)
   ri ( E )    wE                           wE      Φ     ri ( E )                             Θ


Finally, the allocation V (w), l (w) needs to be incentive compatible, i.e.,
                                                                       #                   $
                                                                 l (w' )w'   '
                           V (w) ≡ u(c(w), l (w)) = max u c(w ),                               .                        (11)
                                                     w'              w

It is a well-known result that under single-crossing, the global incentive constraints (11)
are equivalent to the local incentive constraints (7) and the monotonicity constraint that
income y(w) must be non-decreasing in w.7 We follow the standard approach of dropping
the monotonicity constraint, which could easily be checked ex post. If the solution to
problem (6) to (9) does not satisfy it, bunching would need to be considered.
     Once a solution V (w), l (w) to the inner problem has been found, the resulting welfare
is given by W ( E). The outer problem is then simply maxE W ( E).
     Solving the inner problem (6) to (9) for a given E yields the following optimal marginal
tax rate formula:
  7 See,   for instance, Fudenberg and Tirole (1991), Theorems 7.2 and 7.3.



                                                             12
Proposition 1. The marginal tax rate in any Pareto optimum without bunching is such that
                    (                        )
                                       i (w) #                            $
                           N
                                ξ i  f               η ( w ) 1 + ε u ( w ) −1
    1 − T (y(w)) = 1 − ∑
         '                             E
                                               1+                             with       (12)
                              r ( E) f E (w)
                         i =1 i
                                                    w f E (w) εc (w)
                     ! wE #                           $         #! s #              $           $
                                 ψE ( s ) u c ( s )                        εu (t)       dy(t)
           η (w) =            1−                          exp            1− c                       f E (s)ds   (13)
                      w          f E (s) λ                        w        ε (t)        y(t)
for all w ∈ [w E , w E ], where λ is the multiplier on the resource constraint (9), λξ i are the multi-
pliers on the N consistency constraints (8), λη̂ (w) = λη (w)/uc (w) the multipliers on the local
incentive constraints (7), and εc (w) (εu (w)) the (un)compensated wage elasticity of total effort l.
    These formulas closely mirror the formulas in a standard Mirrlees model (see e.g.
equations (15) to (17) in Saez, 2001). The term η (w) captures the redistributive motives
of the government and income effects from the terms in the exponential function. This
simplifies with quasilinear preferences u(c, l ) = c − h(l ), where income effects disappear,
as in Diamond (1998). Then uc (w) = λ = 1 and εu (w) = εc (w) ∀w, so that η (w) =
Ψ E (w) − FE (w). Hence the marginal tax rate is increasing in the degree to which Ψ E (w)
shifts weight to low-wage individuals compared to FE (w).
    The only difference from standard formulas is that, at each wage, the marginal keep
shares 1 − T ' (y(w)) are adjusted by a correction factor 1 − ∑iN=1 ( f Ei (w)/ f E (w))(ξ i /ri ( E)).
As we discuss further below, this factor is a local correction for the general equilibrium ef-
fects and/or externalities caused by income earned by wage w individuals. In particular,
the multiplier ξ i on the ith constraint (8) is the general equilibrium Pigouvian corrective tax
on effective effort in sector i—i.e., the optimal corrective tax taking general equilibrium
effects into account. The term ∑iN=1 ( f Ei (w)/ f E (w))(ξ i /ri ( E)) is therefore an income-share
weighted average of the general equilibrium Pigouvian corrective taxes ξ i /ri on the in-
comes earned in the various activities.
    We next use the conditions for an optimal E from outer problem to explore the re-
lationship between the general equilibrium corrections ξ i /ri and the partial equilibrium
Pigouvian taxes τpi that would align the social and private marginal products of effort in
sector i, defined by ri ( E)(1 − τpi ( E)) ≡ Yi ( E).


3.3    Outer Problem
At the optimal E from the outer problem, there must be zero net welfare effects from a
marginal change in any Ei . We can divide the marginal welfare effects of such a change
into four classes: (i) the direct effect on the left-hand side of the ith consistency constraint
(8) and three other effects, (ii)-(iv), which are best understood by considering the effect


                                                           13
of a marginal change in Ei on any given type θ. The change in Ei changes the wage of
individual i. We designate by (ii) the direct effects that this wage change has on (6) to
(9), holding fixed the type’s effort and utility. We designate by (iii) the indirect effects
that this wage change has on θ’s effort-utility allocation as she moves along the fixed
schedules l (w), V (w) when her wage changes. Finally, the change in Ei also changes the
returns ri ( E) to effort in the various sectors; in turn, this changes θ’s optimal allocation
of efforts ei (θ ) across the various sectors for any given total effort l (w). We designate
by (iv) the welfare effects of this effort-composition change on the right-hand side of the
consistency constraints (8).
    One approach would be to compute these effects (in terms of the multipliers on the
constraints) using the envelope theorem and holding the schedules l (w), V (w) fixed. A
more useful alternative, pursued in the following, is to simultaneously vary the schedules
l (w), V (w) in way that undoes the change in average effort and utility at each w coming
from (iii). In particular, note that (4) can equivalently be written as

                                                     ∑iN=1 θi ri ( E)ei
                                wE (θ ) = max                           s.t. m(e) = l.                     (14)
                                                e         m(e)

Using the envelope theorem and denoting the semi-elasticities of the returns r j ( E) in ac-
tivity j w.r.t. Ei by
                                 j        ∂r j ( E) 1
                               β i ( E) ≡               ,
                                           ∂Ei r j ( E)
the semi-elasticity of wages w.r.t. Ei is

                                                                          j
                   ∂wE (θ ) 1     ∑N
                                   j =1 θ j e j ( θ ) r j ( E ) β i ( E )
                                                                                  N
                                                                                           j     j
                    ∂Ei wE (θ )
                                =
                                             wE (θ )l
                                                                          =       ∑ q E ( φ ) β i ( E ),   (15)
                                                                                j =1


i.e., the income-share weighted average of the return semi-elasticities. The change in
effort for individuals with original wage w and income share vector q due to the wage
                                                                                  j j
change resulting from a marginal increase dEi in Ei is therefore l ' (w)w ∑ N
                                                                            j=1 q E β i ( E ) dEi
and the average effort change at w is simply

                          N        *          ' +                             N        j
                                         j    '       j                              f E (w) j
               l (w)w ∑ E
               '
                                       q E (φ)' w   β i ( E)dEi    = l (w)w ∑
                                                                      '
                                                                                            β ( E)dEi ,    (16)
                         j =1                                                 j =1
                                                                                     f E (w) i

           j              "       j
where E [q E (φ)|w] =         Φ q E ( φ ) g E ( φ | w ) dφ   is the average of q j over the set {θ |wE (θ ) = w}




                                                              14
of all wage-w individuals. Defining
                                                              N            j
                                                                          f E (w) j
                                               δEi (w)    ≡   ∑                  β ( E ),                                               (17)
                                                              j =1
                                                                          f E (w) i

this motivates the variation in the l-schedule l˜(w) = l (w) − l ' (w)wδEi (w)dEi . Analo-
gously, we can vary the V-schedule by Ṽ (w) = V (w) − V ' (w)wδEi (w)dEi . Performing
this variation in schedules simultaneously with the increase in Ei greatly simplifies the
outer problem effects (iii) by making sure that both average effort and utility for the set of
types at each wage w remain unchanged when Ei increases marginally. In fact, this varia-
tion also ensures that average consumption is unchanged at each w when Ei increases.8
    We refer below to subshift 1 as the change in the total effort l (w) and utility V (w) of
types originally at wage w that is due to the change in wages coming from the marginal
increase in Ei , holding the l- and V-schedules fixed (i.e., effect (iii) from above). In the ad-
ditional subshift 2, we move the schedules from l (w), V (w) to l˜(w), Ṽ (w). This additional
subshift does not alter the welfare effect of a marginal change in Ei , since the variation in
schedules has a zero total welfare effect by the envelope theorem if l (w) and V (w) are a
solution to the inner problem.


3.3.1     Redistributive Effects

The only effects on the objective come from (iii). The effect from subshift 1 at each w is
                                     j         j
(by analogy to (16)) V ' (w)w ∑ N
                                j=1 ψE ( w ) β i ( E ). The effect of the variation in the V-schedule
from subshift 2 is simply −V ' (w)wδEi (w). Taking these together, the total effect is

                             ! wE
                                             (    j               j
                                                                               )
            N                                    ψE ( w )   f (w)                                     N
                    j                                                                                         j
           ∑      β i ( E)
                              wE
                                     '
                                    V (w)w
                                                 ψE ( w )
                                                          − E
                                                            f E (w)
                                                                                   ψE (w)dw ≡ −λ ∑ β i ( E) R j ( E)                    (18)
           j =1                                                                                      j =1


with                                                          (                             )
                                          ! wE '                      j               j
                                              V (w)w              f E ( w ) ψE ( w )
                             R j ( E) ≡                                    −                    ψE (w)dw.                               (19)
                                          wE          λ           f E ( w ) ψE ( w )

Note that ∑ Nj=1 R j ( E ) = 0; this is because the effect captures a re-allocation of utility
across workers with different sectoral intensities q at each w. For the same reason, each
R j disappears if we put the same welfare weight on all types θ who earn the same wage w
          j                   j
(so that ψE (w)/ψE (w) = f E (w)/ f E (w) for all j, w, as would be the case with the relative
weights Ψ(θ ) = Ψ̃( F (θ ))). Otherwise, if a marginal increase in Ei increases the returns to
   8 To wit, dropping the common argument w and,using (7) and            - (50) yields
                                                                                   ,                                      -
               ˜                1              ul ˜          1 '    ul '               ul l               uc c' +ul l/w
c̃ − c = c(Ṽ, l ) − c(V, l ) = uc (Ṽ − V ) − uc (l − l ) = uc V − uc l wδEi = − wu       c
                                                                                             +                  uc            wδEi = c' wδEi .


                                                                  15
activities in which workers with a high relative welfare weight earn much of their income,
then the resulting re-allocation in utilities is welfare enhancing.


3.3.2    Incentive Constraint Effects

Again, the only effects here are from (iii). There are no effects from subshift 1, since
individuals just move along incentive compatible schedules. For subshift 2, note that

                                            d (V ' ( w ) w ) i                      '
                     Ṽ ' (w) = V ' (w) −                   δE (w)dEi − V ' (w)wδEi (w)dEi ,
                                                 dw

so the change in the local incentive constraints (7) is

                                                 l˜(w)                         l (w)
          Ṽ ' (w) − V ' (w) + ul (c̃(w), l˜(w))        − ul (c(w), l (w))
                                                    w                             w
              d (V ' ( w ) w ) i                      '          d ( u l ( c ( w ) , l (w))l (w)) i
        = −                   δE (w)dEi − V ' (w)wδEi (w)dEi −                                   δE (w)dEi
                   dw                                                             dw
                            '
        = −V ' (w)wδEi (w)dEi

since (7) requires wV ' (w) + ul (w)l (w) = 0 for all w. Using (17), the incentive effects from
(iii) are therefore

                              ! wE
                                                          (    j
                                                                        )
                 N                                            f E (w)                       N
                       j                    V ' (w) d                                             j
             − ∑ β i ( E)λ           η (w)w                                 dw ≡ −λ ∑ β i ( E) Ij ( E),   (20)
                j =1           wE           uc (w) dw         f E (w)                      j =1


where λη̂ (w) = λη (w)/uc (w) is the multiplier on (7) and

                                          ! wE
                                                                    (        j
                                                                                      )
                                                        V ' (w) d           f E (w)
                              Ij ( E) ≡          η (w)w                                   dw.             (21)
                                           wE           uc (w) dw           f E (w)

As before, we have ∑ N    j=1 I j ( E ) = 0. To interpret the terms I j , suppose η ( w ) > 0, so
the incentive constraints bind downwards. Then a marginal increase in Ei is welfare re-
ducing
  ,      (respectively,
                  -     increasing) if it increases (decreases) the returns to activities j with
     j
d f E (w)/ f E (w) /dw > 0, i.e., to activities that are locally associated with high wages in
the first place. This is because an increase in Ei makes the wage distribution more (less)
unequal in this case, which tightens (loosens) the local incentive constraints. The effect
is therefore a generalized version of the one pointed out by Stiglitz (1982) for a two-type
model with two sectors.
    Figure 3 illustrates this for N = 2, so (20) becomes −λ( β1i − β2i ) I1 . If sector 1 is locally


                                                        16
                                                                                   ݂ாଵ ‫ݓ‬
                                                                                   ݂ா ‫ݓ‬




                                                                                           ‫ݓ‬




                                                         ݂ாᇱ ሺ‫ݓ‬ሻ                 ݂ா ሺ‫ݓ‬ሻ

                                                                                           ‫ݓ‬
                                Figure 3: Incentive constraint effects

the high-wage sector and an increase in Ei reduces the relative return to activity 1, so
β1i − β2i < 0, then it locally compresses the wage distribution. This is because higher
wage individuals on average have a greater effort intensity in activity 1 and thus see their
wage fall relative to lower wage, activity 2 intensive individuals. This moves wages closer
together locally and is welfare improving. The total effect in (20) integrates over all these
local wage compression effects.


3.3.3   Resource Constraint Effects

Because of the subshift 2 variation in schedules that undoes the average change in c and
l from the marginal increase in Ei at each w, there are no net effects from (iii) here. We
are therefore only left with the direct wage shift effect (ii). At each w, the average wage
change (using (17)) is wδEi (w), so the effect on the resource constraint is

                   ! wE                                  N                 ! wE
                                                                  j                        j
               λ          δEi (w)wl (w) f E (w)dw   =λ∑         β i ( E)          y(w) f E (w)dw.   (22)
                    wE                                   j =1               wE


   It is useful to write this in terms of the Pigouvian taxes tip ( E), i = 1, ..., N, defined
by ri ( E) − tip ( E) ≡ ∂Y ( E)/∂Ei , i.e., as the tax on equivalent effort in sector i that fills
the wedge between the private and social returns to i-sector effort (the corresponding tax
on income in sector i is τpi ( E) = tip ( E)/ri ( E)). Then tip ( E) can be expressed as an output




                                                    17
weighted sum of the corrections for the externalities from Ei :
                                                          N
                                                                j
                                         tip ( E) = − ∑ β i ( E)Y j ( E).                                      (23)
                                                         j =1

In particular, if effort in activity i raises the returns to this and other activities, it gener-
ates positive externalities, so the Pigouvian tax is negative, and vice versa. Using this
in (22) yields a resource constraint effect of simply −λtip ( E). Hence, a marginal increase
in Ei increases (decreases) welfare through this effect if it generates positive (negative)
externalities.


3.3.4   Consistency Constraint Effects

Consider the effects of a marginal increase in Ei on consistency constraint j. First, there
is the direct effect (i), which is simply λξ j δij , where δij is the Kronecker δ. Second, there
are various effects on the right-hand side. For these, it is useful to rewrite consistency
                                      "
constraint j following (10) as Ej = Θ θ j e j (θ )dF (θ ) and to note that
                                                                                       e (θ )
                                            θ j e j (θ )                         θ j e j (θ )
                                                                                      N
                 θ j e j (θ ) = l (wE (θ ))              = l (wE (θ )) ,                           -
                                            m(e(θ ))                  m
                                                                         e1 ( θ )         e   (θ )
                                                                                  , ..., N −1 , 1
                                                                            e N (θ )        e N (θ )


by linear homogeneity of m and the fact that l = m(e). For the same reason and by (4),
the effort ratios ζ j ≡ e j /e N only depend on the vector of relative returns
                                          #                                            $
                                                 r1 ( E )               r N −1 ( E )
                             x E (φ) ≡        φ1          , ... , φN −1              ,1 .
                                                 r N ( E)                 r N ( E)

That is, ζ ≡ (ζ 1 , .., ζ N −1 , 1) is homogenous of degree zero in the return vector (θ1 r1 ( E), ...,
θ N r N ( E)). Using this, the effective effort integrated over on the right-hand side of consis-
tency constraint j is
                                                                                           ζ j ( x E (φ))
           θ j e j (θ ) = l (w)θ j Ω j (ζ ( x E (φ))) with Ω j (ζ ( x E (φ))) ≡                            .   (24)
                                                                                          m (ζ ( x E (φ)))

This reveals that there are two distinct effects here: first, the change in the overall level
of effort l (·) for each individual (which is part of effect (iii)), holding constant the cross-
sectoral allocation of efforts, and second, the re-allocation of effort across sectors due to
the change in the relative returns x E caused by the increase in Ei (effect (iv)).
    Overall effort re-allocation effect. As for the former, the change in l (·) for individ-
uals of wage w and type φ from subshift 1 is wl ' (w) ∑kN=1 qkE (φ) βki ( E), and using θ j Ω j =


                                                          18
θ j e j /l = wq j /r j , the effect on (24) is

                                          j              N
                                      wq E (φ) '
                                                l (w)w ∑ qkE (φ) βki ( E).
                                       r j ( E)        k =1

Averaging over the set {θ |wE (θ ) = w} of all wage w individuals gives

                                  1       N                      *                    ' +
                                               k        2 '         j         k       '
                                        ∑
                              r j ( E ) k =1
                                             β i ( E ) w l ( w )E q E ( φ ) q E ( φ ) ' w .


The average change in l (·) at w induced by the change in the l-schedule in subshift 2 is
                 .           ' /
−wl ' (w) ∑kN=1 E qkE (φ)' w βki ( E), and so the average change in sector j equivalent effort
in (24) is
                           1       N                      *          ' + *           ' +
                                        k        2 '         j       '       k       '
                   −             ∑
                       r j ( E ) k =1
                                      β i ( E ) w l ( w )E q E ( φ ) ' w E q E ( φ ) ' w .

Integrating over all wages gives a total effect on consistency constraint j of

                                                       N
                                              −λξ j   ∑ βki (E)Ckj (E),                        (25)
                                                      k =1
                                              ! wE      ,          ' -
                                   1                       j       '
where                  Ckj ( E) ≡          w2 l ' (w)Cov q E , qkE ' w f E (w)dw               (26)
                               r j ( E) wE
           0      1      .     /       . / . /
with Cov q j , qk = E q j qk − E q j E qk . The intuition is tightly linked to our varia-
tion: The schedule change in l (w) is constructed to zero out the average change in effort
at any given w, across all activities. If the j-sector income share q j were uncorrelated with
this effort change at any given w, then j-sector effort would also remain unchanged. If it
were positively correlated, however, then it would increase, and vice versa. In particular,
if a marginal increase in Ei increases the returns to activities k in which individuals have a
high income share who also earn a lot of their income in activity j, then individuals with a
high q j see their wage increase more than proportionally and therefore move up along the
l (w)-schedule relative to others. Hence, if l ' (w) ≥ 0, this variation effectively re-allocates
effort towards activity j, thus increasing the right-hand side of consistency constraint j.
     Figure 4 illustrates this for N = 2, so by (25) the effect on consistency constraint 1
becomes −λξ 1 ( β1i − β2i )C11 and the effect on consistency constraint 2 is λξ 2 ( β1i − β2i )C22 ,
where we used q2E = 1 − q1E . Suppose an increase in Ei increases the relative return to
activity 1, as drawn in the figure, so β1i − β2i > 0. This has different effects on individu-
als who earned the same wage w before the change (and thus were located on the same
iso-wage curve in θ-space in the left panel) but did so using different intensities. Those

                                                             19
                 ߠଶ                      ࡱ࢏ ՛֜ ࢞૚ ՛            ‫ݓ‬

                        ‫ݓ‬ா෠ ߠ ൌ ‫ݓ‬
                                ഥ



                      ‫ݓ‬ா ሺߠሻ ൌ ‫ݓ‬
                               ഥ

                                                               ‫ݓ‬
                                                               ഥ




                                                          ߠଵ                   ‫ݍ‬തଵ ሺ‫ݓ‬
                                                                                    ഥሻ            ͳ ‫ݍ‬ଵ


                             Figure 4: Overall effort re-allocation effect

with a high intensity q1 in activity 1 (because of a high θ1 /θ2 -ratio) see their wage in-
crease whereas the others see it fall. If l ' (w) ≥ 0, so C11 , C22 ≥ 0, the former group will
increase their effort and the latter reduce it, thus leading to a flow of effort out of sector
2 and into 1. The figure also makes clear that this effect relies on there being variation
in intensities at a given wage: if every wage-w earner had the same (average) intensity
q1 (w) and so Var(q1 |w) = 0, then the rotation shown in the right panel would be without
consequences, since C11 , C22 = 0.
    Sectoral shift effect. Second, the effect of Ei through the change in the vector of effort
ratios ζ on (24) is,9

                                     N    N   ∂Ω j (ζ ( x E (φ))) ∂ζ l ( x E (φ)) ∂θk rk ( E)
                         l (w)θ j   ∑∑               ∂ζ l         ∂(θk rk ( E)) ∂Ei
                                                                                              .                  (27)
                                    k =1 l =1

                                                                        j
We can rewrite this using q j = r j θ j Ω j /w and hence q E (φ) = Zj ( x E (φ))Ω j (ζ ( x E (φ))) with
                                                                    (                                    )
                              r j ( E)θ j     j                            p1           p
              Zj ( x E (φ)) ≡             = x E (φ) min m                 1
                                                                                , ..., N −N1−1 , p N         ,   (28)
                                   w               p ∈ ∆ N −1           x E (φ)       x E (φ)

where we used (3) and homogeneity of degree one of m. This makes explicit that the
income share q j is also only a function of the relative returns x, and in fact is a product of
two terms, one of which, Zj , directly depends on x and the other of which, Ω j , depends
   9 Our assumptions on m ensure that ζ
                                           l ( x E ( φ )) is continuous and differentiable almost everywhere—with
potential non-differentiabilities only at the borders of corners where ζ l ( x E (φ)) = 0.




                                                           20
on x only through the vector of effort ratios ζ. It is instructive to rewrite (27) by defining

                                                          N   ∂Ω j (ζ ( x E (φ))) ∂ζ l ( x E (φ))
                        j
                      Qk ( x E (φ)) ≡ Zj ( x E (φ)) ∑                                                 θ N r N ( E ).   (29)
                                                         l =1
                                                                     ∂ζ   l       ∂ ( r k ( E ) θ k )

Intuitively, there are two components to the effect of a change in the return to sector
k relative to N (holding all other returns constant relative to sector N) on the sectoral
income share q j : the mechanical effect of changing returns (through Zj ), holding constant
all efforts, and the indirect sectoral shift effect (through Ω j ) due to the reallocation of effort
                    j
across sectors. Qk measures only the latter component, i.e., the substitution effect on Q j
that results from the change in the sectoral effort ratios ζ in response to a change in the
sector-k returns rk ( E)θk , but holding relative returns x fixed otherwise. Substituting this
in (27), the effect becomes

                  N
                        w       j            ∂rk ( E)θk   1       y(w) N k                 j
      l (w)θ j   ∑ r j ( E)θ j k E
                              Q   ( x ( φ ))                    =           ∑    β i ( E) Qk ( x E (φ)) x kE (φ)
                 k =1
                                                ∂Ei r N ( E)θ N   r j ( E ) k =1

since ∂(rk ( E)θk )/∂Ei = βki ( E)rk ( E)θk . Integrating over all wages and all φ gives a total
effect on consistency constraint j of

                                                    − λξ j ∑ βki ( E)Skj ( E)                                          (30)
                                                               k
                                                  ! wE             !
                                           1                                 j
with                        Skj ( E) ≡                   y(w)              Qk ( x E (φ)) x kE (φ)dGE (w, φ).           (31)
                                       r j ( E)    wE                  Φ

As a result, if a marginal increase in Ei increases the returns to activities k (i.e. βki ( E) > 0)
              j
for which Qk > 0 (so that an increase in rk θk increases the income share earned in activity
j through a re-allocation of the effort ratios towards e j ), then it induces a shift of effort
into sector j and thus increases the right-hand side of the j-th consistency constraint. This
is again illustrated in Figure 5 for N = 2. If an increase in Ei increases the relative return
r1 /r2 to activity 1, individuals will shift their effort allocation e1 /e2 towards activity 1,
thus reinforcing the overall effort reallocation effect illustrated in Figure 4.
    Adding up. Per the preceding discussion, the Ckj and Skj effects can both be inter-
preted as across sector re-allocations. Formally, as the following lemma shows, the shifts
of incomes across sectors induced by those two effects have to sum to zero across all j—i.e.,
the r j -weighted rows sum to zero. The lemma also establishes the more mechanical facts
that the columns of Ckj and Skj sum to zero.
Lemma 3. (i) ∑ N                               N
                    j=1 r j ( E )Ckj ( E ) = ∑ j=1 r j ( E ) Skj ( E ) = 0 for all k = 1, ..., N.
(ii) ∑kN=1 Ckj ( E) = ∑kN=1 Skj ( E) = 0 for all j = 1, ..., N.

                                                                       21
                        ݁ଶ
                                     ෍ ߠ௜ ‫ݎ‬௜ ሺ‫ܧ‬෠ ሻ݁௜ ൌ ‫ݕ‬ො
                                       ௜



                                                        ݁ଵ
                                                           ՛
                                                        ݁ଶ


                                                               ෍ ߠ௜ ‫ݎ‬௜ ሺ‫ܧ‬ሻ݁௜ ൌ ‫ݕ‬
                                                                ௜


                                                                          ‫ݎ‬ଵ
                                    ݉ሺ݁ଵ ǡ ݁ଶ ሻ ൌ ݈            ‫ ܧ‬՜ ‫ܧ‬෠ ֜      ՛
                                                                          ‫ݎ‬ଶ
                                                                           ݁ଵ

                                  Figure 5: Sectoral shift effect

    The intuition for part (i) of Lemma 3 hinges on the fact that the r j ( E)-weighted sum
                                                               "w
of the right-hand sides of the N constraints in (8) is w E y(w) f E (w)dw, and the sectoral
                                                                  E
composition of income at wage w is irrelevant for this sum. Per (29) and the subsequent
                             j
discussion, the changes { Qk } j=1,...,N in {Skj }k=1,...,N reflect changes in the income shares q j ,
                        " wE
and thus do not affect w y(w) f E (w)dw. Similarly, subshift 2 ensures, by construction,
                           E
that l (w) and hence (for effect (iii)) wl (w) = y(w) is unchanged on average at each w.
Hence, both effects reflect income shifts across activities in response to return changes,
which have to add up to zero.
   The converse adding-up property in part (ii) of the lemma is simply due to the fact
that proportional changes in all returns (i) do not affect individuals’ cross-sectoral effort
allocation since m is linear homogeneous, so there are no sectoral shift effects, and (ii)
cause equi-proportional changes in the wages of all types θ in subshift 1, and hence no
cross-sectoral re-allocation of overall effort l (w) at any wage. A direct consequence of this
is that (25) and (30) are non-zero only if a change in Ei affects relative returns.


3.3.5   Putting Them Together

To find the total welfare effect of a marginal change in Ei , we combine (18), (20), (22), with
(25), (30) and the direct effect ξ j δij for all consistency constraints j. Moreover, because of
the adding-up property in Lemma 3 (ii) and the fact that ∑ j Ij = ∑ j R j = 0, only relative
return changes matter for the effects (18), (20), (25) and (30), so we can equivalently write
                   j                                                             j          j
(18) as −λ ∑ j ( β i − β iN ) R j and analogously for the others. Defining ∆β i ( E) ≡ β i ( E) −
                                                               2
                                                     j            j
β iN ( E) as the semi-elasticity of the returns (∂x E (φ)/∂Ei ) x E (φ) establishes the following
lemma, which summarizes the results from this subsection:

                                                     22
Lemma 4. At any Pareto optimum with Ei > 0, the welfare effect of a marginal change in Ei is
                 3                            (                                                  )4
      ∂W ( E)                           j                                0                     1
              = λ ξ i − tip ( E) − ∑ ∆β i ( E) Ij ( E) + R j ( E) + ∑ ξ k Cjk ( E) + S jk ( E)      ,
       ∂Ei                         j                                k


with R j ( E), Ij ( E), tip ( E), Cjk ( E) and S jk ( E) respectively given by (19), (21), (23), (26) and (31).
                                          j
      This makes clear that, if ∆β i = 0 for all j, i.e., an increase in Ei has no effect on the
vector of relative returns x, then ξ i = tip ( E) at the optimum. Any deviation of ξ i from
tip ( E) is due to the relative return effects I, R, C and S.


3.4        Marginal Tax Rate Results and Outer Problem Dimensionality
                                                                                               j
Define ∆β, C, and S, respectively, as the matrices with (i, j)th elements ∆β i ( E), Cij ( E),
and Sij ( E). Define !I and !R as the column vectors with elements Ii ( E) and Ri ( E), respec-
tively. Finally, define !ξ and !t p respectively as the column vectors with elements ξ i and
tip ( E), and use IN to denote the N × N identity matrix. If the optimal allocation has
Ei > 0 for all i,10 the N of optimality conditions for Ei from Lemma 4 can be written as
                                                                 ,       -
                                (IN − ∆β (C + S )) !ξ = !t p + ∆β !I + !R .                               (32)

     Because the returns ri ( E) are endogenous, individuals may impose externalities when
they exert effort to earn income in sector i. tip ( E) is the tax on sector-i effective effort
needed to align an individual’s private and social returns to sector-i effort in the partial-
equilibrium sense—i.e., holding fixed others’ behavior (and, as discussed above, τpi =
tip /ri is the corresponding tax on sector-i income). If there were no general-equilibrium
effects, we would expect the Pigouvian corrective tax on income earned by wage w in-
                      0               1
dividuals to be ∑i f Ei (w)/ f E (w) τpi ( E), i.e., a weighted average of the sector-specific
Pigouvian corrections, with weights reflecting the share of income earned in the various
sectors. Intuitively, an increase in the marginal income tax rate at a given income does
not directly affect any individual’s optimal sectoral income shares qi , so a marginal tax
distorts average sectoral incomes yi (w) earned by individuals at any w in proportion to
the income share f Ei (w)/ f E (w) at w.
     Of course, there will typically be indirect, general equilibrium effects as well: changes
in E change returns ri ( E) and hence individuals’ optimal cross-sectoral effort allocations.
                                              0              1
The actual externality correction term ∑i f Ei (w)/ f E (w) (ξ i /ri ) from (12) includes these
  10 If   Ei = 0, the following analysis would apply to the subset of non-zero Ei .


                                                        23
general equilibrium effects. We can use the system (32) to compare the general- and
partial-equilibrium corrections. They would obviously coincide if τpi ( E) = ξ i /ri , or equiv-
alently tip ( E) = ξ i , for each sector i, as would be the case if ∆β were identically zero and
 there were no relative effects of any change in E.
     More generally, the general- and partial-equilibrium corrections at wage w coincide
 whenever the proportional change in income ∆Y i ∝ f Ei (w)/ f E (w) induced by an addi-
 tional marginal income tax at wage w implies an aggregate effort change ∆Ei = ∆Y i /ri in
 a direction in which there are no relative return effects. Formally, let !n denote the column
 vector with ith element ni = ( f Ei (w)/ f E (w))(1/ri ( E)) and !n' its transpose. If !n' ∆β = 0, so
 that there are no relative wage effects in the direction !n' , then left-multiplying (32) yields
!n'!ξ = !n'!t p , i.e.,
                                N f i (w)             N f i (w)
                                              ξi
                               ∑ f E (w) ri (E) = ∑ f EE (w) τpi (E)
                                      E
                              i =1                  i =1

and the general equilibrium correction coincides with the partial equilibrium correction.11
    Intuitively, any wedge between the partial- and general-equilibrium corrections is at-
tributable to relative return effects: if a marginal tax at wage w does not cause any change
in relative returns, then imposing it will change the aggregate efforts E, but it will not
change any type’s optimal cross-sectoral effort allocation, and hence will have no indirect
feedback effects on E. When there are relative return effects, and !n' ∆β += 0, then the opti-
mal correction, per (12), will in general diverge from the partial-equilibrium correction.
    We can also ask when, additionally, the optimal correction in (12) is zero—i.e., when
   0 i             1               0                 1
∑i f E (w)/ f E (w) (ξ i /ri ) = ∑i f Ei (w)/ f E (w) τpi ( E) = 0, so that the marginal tax rate
formula (12) is the same as in a standard one-dimensional Mirrlees model. The following
result provides a simple characterization.

Proposition 2. Suppose Y ( E) > 0. Then !n' is a direction of both no relative return effects and
no externalities, i.e., !n' ∆β = 0 and !n'!t p = 0, if and only if it is a left-nullvector of β: !n' β = 0.

   Let N − K denote the rank of the R N → R N mapping r ( E) = (r1 ( E), ..., r N ( E))' and
hence of the matrix β. Since the return vector r ( E) is a sufficient statistic for individual be-
havior, conditional on a given tax code (equivalently, an l (w)- and V (w)-schedule),12 one
might hope to reduce the dimensionality of the outer problem when K > 0—i.e., when-
ever, by Proposition 2, there exist directions !n' in which there are both no externalities
and no relative return effects.
  11 Itis worth noting that ∆β is singular (its last column is identically zero), so it has a non-empty left-
nullspace. There are no relative return effects at w precisely when !n' lies in this left-nullspace.
  12 So that r ( E ) is also sufficient for describing the variation, with E, of the tax code that leads to (32).




                                                       24
  This is the case, for example, in the framework of Rothschild and Scheuer (2013b),
where N = 2 and Y ( E) has constant returns to scale with ri ( E) = Yi ( E), so that private
returns equal marginal products. Since the latter are homogeneous of degree zero, they
are only a function of ρ ≡ E1 /E2 , and it is easy to verify that the second row of β is just
−ρ times the first row. In other words, β has rank N − K = 1 for all E, and, as shown by
Rothschild and Scheuer (2013b), the outer problem can be written in terms of the single
variable ρ and with a single consistency constraint
                                       " wE
                                        w      wl (w)dFρ1 (w)/r1 (ρ)
                                 ρ=    " wEE                           .
                                        wE     wl (w)dFρ2 (w)/r2 (ρ)

    Similar reductions in dimensionality can occur for N > 2. Suppose, for instance,
                j          j         j            j
N = 3 and β 2 ( E) = aβ 1 ( E) and β 3 ( E) = bβ 1 ( E) for all j, where a and b are constants.
Here, E1 , E2 and E3 have effects on the returns r j that only differ in their magnitude or
sign (in percentage terms). Then there is a two-dimensional plane with directions of no
relative return effects and no externalities spanned by the vectors (− a, 1, 0) and (−b, 0, 1).
The vector orthogonal to both is (1, a, b), so Ẽ1 = E1 + aE2 + bE3 is a sufficient statistic for
the return vector r ( E). The outer problem can again be written with a single consistency
constraint, namely a weighted average of the three consistency constraints in (8).
    In fact, the following proposition shows that the dimensionality of the outer problem
can be reduced with a proper choice of coordinates whenever the rank of β is less than N.

Proposition 3. Suppose that β has rank N − K in some open neighborhood of the optimum E∗ .
Then there exists an open neighborhood U ∈ R N on which the Pareto problem can be written
as a function of the schedules l (w), V (w), and some ρ ∈ R N −K and with N − K consistency
constraints, one for each component of ρ.

     Whenever we can reduce dimensionality through a change in coordinates, we can,
 of course, also reformulate the marginal tax rate formula from the inner problem (12) in
 terms of this new basis. As before, let !n be the vector with elements f Ei (w)/( f E (w)ri ( E)),
!ξ the vector with elements ξ i , where ξ i are the multipliers in the original E coordinate sys-
 tem, and L as the matrix with elements Lij = ∂Gi ( E∗ )/∂Ej (at an optimum E∗ ), where G is
 the coordinate transformation defined in the proof of Proposition 3. Then the correction
 term in (12) in terms of E, ∑iN=1 ( f Ei (w)/ f E (w))(ξ i /ri ( E)), can be replaced in the new co-
 ordinates with !n' L!ξ̃, where !ξ̃ is the vector whose first N − K elements are the multipliers
 of the consistency constraints in the new coordinate system and last K elements are zero.
     Finally, for the system of optimality conditions (32) to be fully informative about the
 optimal vector !ξ, the matrix A ≡ IN − ∆β (C + S ) needs to be invertible and hence non-

                                                   25
singular at the optimum, which we assume in the following. If A had less than full rank,
there would be multiple solutions for !ξ in (32), and so the outer problem variation we
used to obtain this system would not fully identify !ξ. This full-rank assumption implies
that all eigenvalues of A must be nonzero. In fact, defining !r as the column vector of
sectoral returns ri ( E), the adding up property of the sectoral shift matrices C and S in
Lemma 3 (i) immediately implies that A!r = !r, so that !r is always an eigenvector of A
with associated eigenvalue 1.
   For the analysis of some of the examples later on, we will assume that all other eigen-
values of A are not only nonzero, but strictly positive as well. In Appendix B, we show
that this assumption corresponds to a notion of stability of the fixed point for E at the
optimum, which is closely related to the variation underlying (32).


4     Two Sectors
If N = 2, we can use the system of optimality conditions (32) to solve for !ξ explicitly. Note
first that, in this case, q2E (φ) = 1 − q1E (φ) and so Cov(q1E , q2E |w) = −Var(q1E |w). Moreover,
by the proof of Lemma 3, Q21 ( x E (φ)) = − Q11 ( x E (φ)), so that we can write
                            (                                                  )
                                ∆β11 ( E)/r1 ( E) −∆β11 ( E)/r2 ( E)
            ∆β (C + S ) =                                                          (C ( E) + S( E))
                                ∆β12 ( E)/r1 ( E) −∆β12 ( E)/r2 ( E)

where                                            ! wE
                   C ( E) ≡ r1 ( E)C11 ( E) =           w2 l ' (w)Var(q1E |w) f E (w)dw               (33)
                                                  wE

and                                       ! wE          !
              S( E) ≡ r1 ( E)S11 ( E) =          y(w)           Q11 ( x1E (φ)) x1E (φ)dGE (w, φ).     (34)
                                            wE              Φ

Since Q11 > 0 (the substitution effect leads to a re-allocation of effort towards activity 1
when the relative return to this activity increases), we have S( E) ≥ 0, and also C ( E) ≥ 0
if l (w) is increasing in w at the optimum.
      Since (∆β12 ( E), −∆β11 ( E)) is always a left-nullvector of ∆β and therefore a direction
of no relative return effects when N = 2, we can interpret the orthogonal direction
(∆β11 ( E), ∆β12 ( E)) as the direction of maximal relative return effects. Let γ2 ( E) be the sec-
ond, non-unit eigenvalue of the matrix A = I2 − ∆β (C + S ), i.e.,
                                     (                              )
                                         ∆β12 ( E) ∆β11 ( E)
                     γ2 ( E) = 1 +                 −                    (C ( E) + S( E)),             (35)
                                          r2 ( E )   r1 ( E )


                                                   26
                           ‫ܧ‬ଶ
                                            ȟߚଵଵ ǡ ȟߚଶଵ
                                                                   ݂ாଵ‫ݓ כ‬   ݂ ଶ‫ݓ כ‬
                                                                          ǡ ா
                                                                  ݂ா‫ݎ ݓ כ‬ଵ ݂ா ‫ݎ ݓ כ‬ଶ

                                                                                      ȟߚଶଵ ǡ െȟߚଵଵ

                            ‫ܧ‬ଶ‫כ‬                                                            ‫ݎ‬ଵ ‫ܧ‬
                                                                                                ൌ݇
                                                                                           ‫ݎ‬ଶ ‫ܧ‬




                                                                 ‫ݐ‬ԦƸ௣


                                                          ‫ܧ‬ଵ‫כ‬                         ‫ܧ‬ଵ

  Figure 6: Adjustment factor and directions of no and maximal relative return effects

which is associated with the eigenvector (∆β11 ( E), ∆β12 ( E))' . If the optimum involves a
stable fixed point for E in the sense of our discussion in Appendix B, then γ2 ( E) > 0.
   Using this, solving system (32) yields:

Lemma 5. At any Pareto optimum with N = 2,

                       (               )                            ,                         -
                           ∆β11 ( E)       I1 ( E) + R1 ( E) +          τp1 ( E) − τp2 ( E)       (C ( E) + S( E))
         !ξ = !t p +                                                                                                 .   (36)
                           ∆β12 ( E)                                        γ2 ( E)

    The system (36) makes it easy to interpret the corrective term in the marginal tax
rate formula (12). As before, we obtain ξ i = tip ( E) if ∆β1i ( E) = 0, i = 1, 2, so that a
change in Ei has no relative return effects at the optimum. More generally, if the vector !n
with elements f Ei (w)/(ri ( E) f E (w)) is parallel to the direction of no relative return effects
(∆β12 ( E), −∆β11 ( E)), then the marginal tax rate formula (12) coincides with the weighted
sum of the partial equilibrium Pigouvian corrections, as discussed for the case of general
N in section 3.4, so that !n'!ξ = !n'!t p . For any other !n, the correction term !n'!ξ will diverge
from the Pigouvian correction !n'!t p , with the magnitude of this divergence determined by
the magnitude of the second term in (36) and the angle between !n and the direction of no
relative return effects (∆β12 ( E), −∆β11 ( E)). This is illustrated in Figure 6, which shows an
iso-relative return curve in ( E1 , E2 )-space as well as the (tangent) direction of no relative
return effects starting from a Pareto optimum ( E1∗ , E2∗ ), the (perpendicular) direction of
maximal relative return effects, and the projection of the vector !n on the latter.
    By Propositions 2 and 3, the outer problem can be reduced, via an appropriate change
of variables, to a one-dimensional problem whenever the direction of no relative return

                                                            27
effects is also a direction of no externalities or, equivalently, whenever !t p is parallel to the
direction of maximal relative return effects: !t p = x (∆β11 , ∆β12 ) for some x, as is the case in
Figure 6. Clearly, this is trivially the case when there are no externalities (so that x = 0, see
Rothschild and Scheuer, 2013b) or only one activity affects returns (so that ∆β12 = t2p = 0,
see Rothschild and Scheuer, 2013a), as we will discuss in more detail below.
    In the remainder of the paper, we will use formula (36) in order to sign the deviation
of ξ i from tip in various applications of our general model, and to explore its implications
for the shape of the optimal non-linear income tax schedule.


5      Applications

5.1     No Externalities
Suppose Y ( E) is homothetic, and let us consider, to begin, the externality-free case where
private returns coincide with marginal products: ri ( E) = Yi ( E) for all i. The following
lemma shows that, in this case, Y ( E) must exhibit constant returns to scale:
Lemma 6. If Y ( E) is homothetic and there are no externalities then Y ( E) is linear homogeneous.
      In Rothschild and Scheuer (2013b), we have considered the special case with N = 2.
The general framework developed in Section 3 can be used to investigate the novel effects
that can arise when sectoral choice is along more than one margin. The simplest way to
shed light on this is to add a third, linear sector, leading to the production function Y ( E) =
Ŷ ( E1 , E2 ) + E3 , where Ŷ exhibits constant returns to scale and ri ( E) = Yi ( E) for i = 1, 2, 3.
This is particularly tractable as E3 has no effects on any returns and ρ ≡ E1 /E2 remains a
sufficient statistic for the wage distribution. The general system of optimality conditions
(32) can be solved to obtain the following modified marginal tax rate adjustment factor.
Proposition 4. If N = 3, Y ( E) = Ŷ ( E1 , E2 ) + E3 , Ŷ is homothetic and there are no externalities,
then the numerator in the marginal tax rate formula (12) is
                                                                     (                                 )
                  3     f Ei (w) ξ i            f 1 (w) + f E2 (w)              f E1 (w)
            1− ∑                           = 1+ E                                            − α̂(ρ)       ξ̂   (37)
                 i =1
                        f E ( w ) ri ( E )            f E (w)            f E1 (w) + f E2 (w)

with

                1                           β11 ( I1 + R1 ) + β21 ( I2 + R2 )
    ξ̂ = −                                                                                   ,                  (38)
           r1 (1 − α̂) 1 − β11 (C11 + S11 − ρ(C12 + S12 )) − β21 (C21 + S21 − ρ(C22 + S22 ))

where α̂(ρ) ≡ Y 1 /Ŷ is the sector 1 income share relative the income of sectors 1 and 2 together.

                                                        28
     In the two-sector case where E3 and f E3 (w) vanish, Lemma 3 implies C21 = −C11 ,
r1 C12 = −r2 C11 , and r2 C22 = r1 C11 , and analogously for the Sij terms. Hence, know-
ing any one of the four flow terms Cij + Sij determines the other three. Similarly, I2 +
R2 = −( I1 + R1 ). Denoting by σ(ρ) the substitution elasticity of Y ( E) and by α(ρ) ≡
Y 1 ( E)/Y ( E) the aggregate income share of sector 1, the adjustment factor then collapses
to the formula from Rothschild and Scheuer (2013b):

Corollary 1. If N = 2, Y ( E) is homothetic, and there are no externalities, then the numerator in
the marginal tax rate formula (12) is
                                        (                     )
        2     f Ei (w) ξ i                  f E1 (w)                                ( I1 + R1 ) /σ
  1− ∑                           = 1+                − α(ρ)       ξ with ξ ≡                          ,   (39)
       i =1
              f E ( w ) ri ( E )            f E (w)                            α(1 − α)Y + (C + S) /σ

where C = r1 C11 and S = r1 S11 by (33) and (34).

    This makes clear that the adjustment factor vanishes as σ (ρ) → ∞ and technology
becomes linear. Otherwise, suppose sector 1 is the high-wage sector and redistributive
motives at least weakly favor the low-wage sector 2, so that I1 ( E) > 0 and R1 ( E) ≥ 0.
Then ξ > 0, so marginal keep shares are scaled up compared to the standard formula
in parts of the wage distribution where sector 1 is prevalent and hence its local income
share f E1 (w)/ f E (w) exceeds its aggregate income share α(ρ), and scaled down otherwise.
In other words, marginal tax rates are scaled down for high wages and scaled up for low
wages, making the tax schedule less progressive than in a standard Mirrlees model; for
                                                      0                   1
example, the top marginal tax rate is T ' (y(w)) = α − f E1 (w)/ f E (w) ξ < 0.
    The intuition is that the optimal income tax makes use of general equilibrium effects to
indirectly redistribute from high to low wage earners, introducing a regressive force when
the sectors are complementary: lowering taxes at wages where activity 1 is prevalent
increases ρ and therefore increases the returns to the low-wage activity 2.13 On the other
hand, the sectoral reallocation effects C + S > 0 lower ξ̄ and hence blunt the magnitude
of the regressive adjustment to the tax schedule relative to a model with fixed sectoral
efforts. Intuitively, a regressive tax beneficially redistributes via an increase in the relative
returns to the low-income sector 2; but in so doing, it leads individuals to shift effort into
sector 2, which counteracts the original relative return effect. The optimal tax schedule
is therefore more regressive than in a Mirrlees (1971) model with fixed wages, but less
regressive than in an endogenous wage model with fixed occupations like Stiglitz (1982).
  13 Note  that constant returns to scale and concavity of Y imply σ ≥ 0. Also, the exact same results obtain
if sector 2 is the high-wage sector and sector 1 the low-wage sector, and redistributive motives again favor
the low-wage sector.


                                                          29
      The adjustment vanishes at wage levels w where f E1 (w)/ f E (w) = α, so that the local
and aggregate income shares coincide. This is because, there, !n' = ( f E1 (w)/( f E (w)Y1 ),
f E2 (w)/( f E (w)Y2 )) reduces to ( E1 /Y, E2 /Y ) and therefore points in the direction of no
relative return effects (ρ, 1), as discussed in section 3.4. Moreover, any direction here is
trivially a direction of no externalities, any nonzero adjustment term in (12) is exclusively
due to relative return effects.
       When the third sector is active, the adjustment factor in (37) similarly vanishes when-
ever f E1 (w)/( f E1 (w) + f E2 (w)) = α̂. However, it is now scaled down by the local share
( f E1 (w) + f E2 (w))/ f E (w) of income earned in sectors 1 and 2, reflecting the fact that the
relative return effects only operate through this fraction of the population. In addition,
the term ξ̂ in (38) will generally diverge from the term ξ̄ in (39). This is because, although
the formula for ξ̂ in (38) is the same in a two- and a three-sector model, the adding up
properties in Lemma 3 that pin down the relationship between the four Cij + Sij , i, j = 1, 2
terms in a two-sector model do not pin them down when there is a third sector. Never-
theless, it is instructive to use Lemma 3 to re-write (38) as

                                      ( I1 + R1 ) /σ̂ + E1 β21 ( I3 + R3 )
          ξ̂ ≡                                                            *                          +,   (40)
               α̂(1 − α̂)Ŷ + σ̂ + α̂ σ̂ + α̂(1 − α̂) E1 β 1 Ĉ31 +
                             Ĉ11 +Ŝ11      Ĉ13 +Ŝ13                2
                                                                            α̂
                                                                               Ŝ31
                                                                                    −   Ĉ32 +Ŝ32
                                                                                           1−α̂

where σ̂ (ρ) is the substitution elasticity of Ŷ and Ĉij ≡ r j Cij , Ŝij ≡ r j Sij . Comparing with
(39) reveals an extra term in the numerator and two extra terms in the denominator.
    The first extra term in the denominator, namely α̂(Ĉ13 + Ŝ13 )/σ̂, arises formally from
the row adding up constraint in Lemma 3: with two sectors, any outflow −(Ĉ11 + Ŝ11 )
of sector 1 earnings caused by the r1 -decrease associated with increased E1 flows me-
chanically into sector 2; with a third sector, some will flow instead to sector 3 (whenever
Ĉ13 + Ŝ13 < 0). Unlike flows into sector 2, sector 3 inflows do not decrease ρ = E1 /E2 ,
however, and therefore do not further blunt the desirable effects of an increase in E1 .
Hence, relative to the two-sector model, the presence of the third sector, reflected in this
term, makes ξ̂ larger, and the optimal tax more regressive. Informally: the third sector
moves the optimal tax closer to Stiglitz (1982) and away from Mirrlees (1971).
    The second extra term in the denominator, whose sign only depends on the differ-
ence in square brackets because β21 > 0, arises from property (ii) in Lemma 3. With two
sectors, a proportional increase in both r1 and r2 induces no sectoral shifts and hence
has no effect on ρ. However with three sectors, a proportional increase in r1 and r2 in-
duces an income shift out of sector 3 and into sectors 1 and 2, which affect ρ insofar as
the term in square brackets is non-zero: this occurs precisely when a change in r3 leads
to unequal percentage changes in sector 1 and 2 incomes (which, by Lemma 3 (ii), im-

                                                   30
plies the same for a proportional and simultaneous change in r1 and r2 ). For example,
if (Ĉ31 + Ŝ31 )/α̂ < (Ĉ32 + Ŝ32 )/(1 − α̂) < 0, sector 1 income changes by relatively more
than sector 2 income when r1 and r2 change proportionally. This means that the effects of
r1 are effectively larger than the effects of r2 . In our Ĉ11 + Ŝ11 normalization in (40), the
r2 -effects of an increase in E1 are therefore reduced, reinforcing the first extra effect.
     Finally, assuming for simplicity R3 = 0, the extra term in the numerator can be un-
derstood as follows. (Analyzing R3 += 0 is straightforward.) Suppose that f E1 (w)/ f E (w)
is increasing in w, so sector 1 is the high income sector. With two sectors, this mechan-
ically implies that sector 2 must be the low income sector. The wage changes induced
by an increase in E1 thus beneficially redistribute, by reducing r1 and increasing r2 , from
the high income sector 1 to the low income sector 2. But if there is a third sector and
f E3 (w)/ f E (w) is decreasing, so that I3 < 0, then sector 2 is less of a low income sector (in
fact, f E2 (w)/ f E (w) could be increasing), so the wage changes induced by an increase in
E1 are distributionally less desirable. On the other hand, if I3 > 0 so sector 3 is also a
high-income sector, then sector 2 must be an even lower income sector than otherwise, so
the indirect redistributive benefits of an increase in E1 are magnified, and so is ξ̂ and the
regressive adjustment to the tax schedule.


5.2   Increasing or Decreasing Returns to Scale
Now let Y ( E) be any homothetic production function. Then it can be written as Y ( E) =
h(Ỹ ( E)), where h(Ỹ ) is some increasing function and Ỹ ( E) is a constant returns to scale
production function as in the preceding subsection. Let N = 2 and denote the substitution
elasticity of Ỹ ( E) as before by σ(ρ) and the sector 1 income share by α(ρ) ≡ Ỹ 1 ( E)/Ỹ ( E)
with ρ = E1 /E2 . Suppose the total output Y is divided across sectors according to the
Ỹ-income shares, i.e. Y1 ( E) = α(ρ)Y ( E) and Y 2 ( E) = (1 − α(ρ))Y ( E). Then by linear
private returns,
                 r1 ( E) = α(ρ)Y ( E)/E1 and r2 ( E) = (1 − α(ρ))Y ( E)/E2 .                         (41)

Denoting the elasticity of h by ε h ( E) ≡ h' (Ỹ ( E))Ỹ ( E)/Y ( E), we have increasing returns
to scale when ε h > 1 and decreasing returns to scale when ε h < 1. Lemma 5 then yields
the following result:

Proposition 5. If N = 2, Y ( E) = h(Ỹ ( E)) with Ỹ ( E) linear homogeneous, and returns are
given by (41), then the numerator of the marginal tax rate formula (12) is
                                                     (                     )
                     2     f Ei (w) ξ i                  f E1 (w)
                1− ∑                          = 1+                − α(ρ)       ξ − (1 − ε h ( E)),   (42)
                    i =1
                           f E ( w ) ri ( E )            f E (w)

                                                         31
where ξ is given in (39).

   Unsurprisingly, (42) collapses back to (39) if ε h = 1 and externalities disappear. Oth-
erwise, the optimal adjustment in (42) can be transparently decomposed into two parts:
the first, local one (which varies across wage (income) levels and therefore affects the
progressivity of the tax) is exactly the same as in Corollary 1. The second, new compo-
nent 1 − ε h ( E) is of a global nature, since it uniformly scales up or down marginal keep
shares 1 − T ' (y) independent of y. In particular, if ε h ( E) < (>)1, we have decreasing
(increasing) returns to scale and marginal tax rates are scaled up relative to an economy
with constant returns to scale. This makes individuals internalize the externalities from
non-constant returns to scale, which are only a function of aggregate output and therefore
independent its sectoral composition.
   The first correction component only depends on properties of the inner constant re-
turns to scale production function Ỹ (since this is what drives the relative returns effects),
so it has exactly the same structure as in the preceding subsection. For instance, at wage
levels such that f E1 (w)/ f E (w) = α(ρ), there are again no relative return effects from a
variation in the marginal tax rate, so the optimal adjustment equals the Pigouvian correc-
tion 1 − ε h , which only depends on the properties of the outer function h(Ỹ ). Finally, the
adjustment in this direction never vanishes when ε h += 1. This is because, in this setting,
there exists no direction of both no relative return effects and no externalities. As before,
the direction of no relative return effects, in terms of E, is (ρ, 1), whereas the direction of
no externalities, in terms of incomes is (−1, 1) (since τp1 = τp2 = 1 − ε h ), which translates
into (−1/r1 , 1/r2 ) in terms of E and points into a different quadrant.14 Hence, β has full
rank and both consistency constraints are needed in this example.


5.3    A Pure Resource Transfer Activity
In the preceding subsection, we allowed for aggregate externalities, but the sectoral com-
position of incomes was still governed at the aggregate level by the constant returns to
scale income shares α(ρ) and 1 − α(ρ). Let us next consider the opposite case: Y ( E) ex-
hibits constant returns to scale, but the aggregate income share of sector 1 may not neces-
sarily be given by α(ρ) = Y1 ( E) E1 /Y ( E). Instead, we consider a general sectoral income
decomposition a( E) and 1 − a( E) across the two sectors. If a( E) += α(ρ), effort in one
activity is underpaid relative to its marginal product, and the other is overpaid.
  14 Moreover,  the signs of the changes ∆E1 and ∆E2 in E1 and E2 induced by a variation in the marginal
tax rate at any given income are the same. Hence, (∆E1 , ∆E2 ) can never point in the direction of zero
externalities and the Pigouvian correction 1 − ε h in (42) never disappears unless ε h = 1.



                                                  32
  To illustrate how this affects optimal tax policy, we consider here the extreme example
where Y ( E) = E2 , so total output only depends on effort in activity 2, but a( E) = a( E1 ) is
an increasing function. Then effort in activity 1 is pure “stealing” of (or getting credit for)
output produced in the other activity, generating income at the expense of others without
adding anything to aggregate resources. In Appendix C, we show how our general for-
mulation can be used to allow for all intermediate cases where effort in an activity may
both contribute to output and increase its income share (the latter possibly decoupled
from social marginal products), with similar results.
    Since the social marginal product of activity 1 is zero, we have α = 0 and activity 1
is overpaid for any a > 0. In particular, τp1 = 1 and τp2 = − a/(1 − a): Because activity
1 is pure rent-seeking, the Pigouvian tax is 100%, whereas activity 2 generates positive
externalities (it increases the returns r1 = a( E1 ) E2 /E1 to activity 1), so it commands a
Pigouvian subsidy. Moreover, we have aτp1 + (1 − a)τp2 = 0, i.e. the Pigouvian correction
is zero at the aggregate level. This is because externalities here only result from the dis-
tribution of incomes across sectors, not from overall output (in contrast to the preceding
subsection).
    Defining the elasticity of a as ε 1 ( E1 ) ≡ (∂a( E1 )/∂E1 ) E1 /a( E1 ) yields

Proposition 6. If a( E) = a( E1 ) and Y ( E) = E2 , then

              2                                                     #           $ 2
                    f Ei (w) ξ i  0                     1 f E1 (w)      a        f E (w)
             ∑      f E ( w ) ri
                                 = 1 − (1 − a − ε 1 ) ξ
                                                          f E (w)
                                                                   + −
                                                                       1−a
                                                                           + aξ
                                                                                 f E (w)
                                                                                               (43)
             i =1

with
                                       I1 + R1 + (C + S)/(1 − a)
                                 ξ=                                 .
                                      a(1 − a)Y + (1 − ε 1 )(C + S)
    ξ ≥ 0 whenever the rent-seeking activity 1 is also the high income activity, so I1 ≥ 0,
and Pareto weights are (weakly) higher among same-wage earners on those with a high
income share in the productive activity 2, so R1 ≥ 0 (and recall that the denominator
corresponds to an eigenvalue of the matrix A, so it is positive in a stable fixed point
according to Lemma 7 in Appendix B).
    The terms in brackets, weighted by the local income shares, collect both the Pigouvian
tax rates and the adjustments for relative return effects. In particular, as seen above, there
is a Pigouvian tax of 1 on activity 1 and a subsidy − a/(1 − a) on activity 2. The relative
return effects are also intuitive. For instance, considering activity 2, the total subsidy is
always less, in absolute value, than the Pigouvian subsidy. This is not surprising: A sub-
sidy on activity 2, raising E2 , has no effect on the returns r2 = 1 − a( E1 ) to activity 2, but it
increases the returns to activity 1, so it always increases the relative returns x1 . Since this

                                                  33
leads to a wasteful shift of effort into activity 1, the optimum involves an undercorrection
relative to the Pigouvian subsidy.
    As for the correction on sector 1, the relative returns adjustment depends on ε 1 ≷ 1 − a.
Intuitively, an increase in E1 has two effects: it increases x1 because it increases a( E1 ),
thereby reducing r2 and increasing r1 . But it also affects crowding in activity 1. In
particular, if a( E1 ) does not increase much with E1 , an increase in E1 in fact reduces
r1 = a( E1 ) E2 /E1 . Therefore, x1 increases when the elasticity ε 1 is large and vice versa, de-
pending on whether the within-sector crowding or the across-sector stealing effect domi-
nates. For instance, when ε 1 < 1 − a, then a reduction in E1 increases the relative returns
to activity 1 as the crowding effect dominates, so a tax increase would lead to a flow of
effort into the rent-seeking activity 1. The optimal correction on activity 1-intensive parts
of the income distribution is therefore also less than the Pigouvian correction.
    An alternative way of writing (43) is
                                           (                 )       (                             )
                2     f Ei (w) ξ i             f E1 (w)                  f E1 (w)
                                      1
               ∑      f E ( w ) ri
                                   =
                                     1−a       f E (w)
                                                        −a       −
                                                                         f E (w)
                                                                                  (1 − ε 1 ) − a       ξ,   (44)
               i =1


where the first term collects the Pigouvian corrections (recall that τp1 = 1, which gets
multiplied by the usual difference between the local and aggregate income shares of ac-
tivity 1) and the second the relative return effects. This reveals that this particular ex-
ample remains a two-dimensional problem in terms of the outer problem, since the di-
rections of no externalities and no relative return effects do not coincide. The direction
of no externalities is ( a, 1 − a) in (Y 1 , Y 2 )-space, so the Pigouvian term disappears when
f E1 (w)/ f E (w) = a. On the other hand, the direction of no relative return effects, in terms
of incomes, is ( a, 1 − a − ε 1 ), so the second term disappears whenever the local income
share of sector 1 is a/(1 − ε 1 ).
      It is also worth pointing out that (44) has sharp implications for the optimal progres-
sivity of the income tax schedule. In particular, under the above conditions the Pigouvian
motives for taxation here lead to a more progressive tax schedule than in a standard Mir-
rlees model (for instance, the top marginal tax rate is positive), in contrast to what we
found in subsection 5.1. The relative return effects then determine whether the progres-
sivity is even more or less pronounced than in this Pigouvian benchmark.


5.4   Externalities from One Activity
Suppose all the returns only depend on aggregate effort in one activity, i.e. ri ( E) = ri ( E1 )
for all i = 1, ..., N. A special case of this setting was analyzed in Rothschild and Scheuer

                                                      34
(2013a) for N = 2, where a rent-seeking activity 1 imposed negative externalities on both
                                                                                j
activities, but a traditional activity 2 did not impose any externalities, so β 1 < 0 and
  j
β 2 = 0 for j = 1, 2. We can use the tools developed here to solve this model for general N
and any form of externalities generated by sector 1.
                           j
    In particular, since β i = 0 for all i = 2, ..., N and all j, the matrix β has rank one
(all rows except for the first are zero) and the optimality condition (32) implies ξ i = 0
for all i += 1. Intuitively, there is a whole N − 1-dimensional subspace of directions of
no externalities and no relative return effects, spanned by all the vectors in E-space with
a zero first element. Only E1 generates externalities and relative return effects, so the
dimensionality of the outer problem reduces to one. This leads to the following result:

Proposition 7. If ri ( E) = ri ( E1 ) for all i = 1, ..., N, then the numerator of the marginal tax rate
formula in (12) is 1 − ξ f E1 (w)/ f E (w) with

                                                                j
                                             τp1 + ∑ jN=−11 ∆β 1 ( Ij + R j )/r1
                                      ξ=                        j
                                                                                   .                                (45)
                                                     −1
                                              1 − ∑N
                                                   j=1 ∆β 1 (C j1 + S j1 )


      The optimal adjustment to the marginal income tax formula is ξ weighted by the local
income share of the externality generating activity 1 at w. ξ in turn deviates from the
                                                                             j
Pigouvian correction τp1 only if there are relative return effects, so ∆β 1 += 0 for some j.
These enter in an intuitive way. For instance, suppose activity 1 generates negative exter-
nalities, so τp1 > 0. Then the denominator in (45) increases ξ compared to this Pigouvian
correction if an increase in E1 on average raises the relative returns to activities j with
Cj1 , S j1 > 0, and vice versa. This is because an increase in the relative returns x j to these
activities leads to a flow of effort into activity 1, since Cov(q1 , q j ) > 0 and Q1j > 0 in
this case. A tax on sector 1 income, through reducing E1 and thus inducing the opposite
flow of effort out of activity 1, is therefore even more desirable than based on the purely
Pigouvian motives.15
      The second term in the numerator of (45) further increases ξ compared to τp1 if the
activities whose relative returns increase in response to an increase in E1 are also high
                                                              j
income, low Pareto weight activities on average (so ∆β 1 is positively correlated with
Ij , R j ).16 Then an increase in the marginal income tax at wage levels where activity 1
is prevalent raises the returns to lower wage, high redistributive preference activities by
  15 Note  that the denominator of (45) is always positive when the optimum involves a stable fixed point
for E1 in terms of Lemma 7 in Appendix B, since it is the eigenvalue of the matrix A associated with the
unit eigenvector (1, 0, 0, ..., 0)' .
  16 Recall that                                 j                                                   j
                 ∑ j Ij = ∑ j R j = 0, so ∑ j ∆β 1 ( Ij + R j ) can be interpreted as N times Cov(∆β 1 , Ij + R j ) across
activities j.


                                                           35
decreasing E1 , thus achieving indirect redistribution. Of course, analogous results can be
obtained from (45) when the tax leads to the opposite sectoral shifts, giving rise to an un-
dercorrection at the optimum, or when activity 1 imposes positive or mixed externalities.
   The special case considered in Rothschild and Scheuer (2013a) for N = 2 immediately
emerges as
                                                 τp1 + ∆β11 ( I1 + R1 )/r1
                                           ξ=
                                                   1 − ∆β11 (C + S)/r1
with C and S given by (33) and (34). If l (w) is increasing, so that C > 0, and if we also
have I1 , R1 > 0 (because the externality-causing activity i = 1 is also a high wage and
low redistributive preference activity), then an undercorrection with ξ < τp1 is optimal
if ∆β11 < 0 (so a decrease in E1 increases the relative returns x1 and leads to a perverse
sectoral shift into activity 1) and an overcorrection with ξ > τp1 otherwise. Note again
that these results do not depend on the form of the externalities generated by activity 1;
in particular, they are not confined to the special case in Rothschild and Scheuer (2013a)
with only negative externalities.


5.5     Externalities Targeted at One Activity
Let us finally turn to the opposite case, where the returns to only one activity depend
on E, so that r1 ( E) is general but ri ( E) = ri are constants for all i = 2, ..., N. A simple
example with N = 2 would be another specification of a pure resource transfer activity
with Y ( E) = Y ( E1 ) and Y 1 ( E) = Y ( E1 ) − E2 and Y 2 ( E2 ) = E2 . Hence, all output is
produced through activity 1, and activity 2 takes away some of this output one-for-one.17
                 j
    Generally, β i = 0 for all j += 1 and β again has rank one in this case, this time with all
columns being zero except for the first, which has elements β1i (and ∆β = β). Intuitively,
any movement in E-space that changes r1 ( E) generates both an externality and a relative
return change. Conversely, since tip = − β1i Y 1 in this example, all the N − 1 dimensions
of R N orthogonal to the vector ( β11 , β12 , ..., β1N ) are directions of both no externalities and
no relative return effects because changes of E in these directions leave r1 ( E) unchanged.
As a result, there is only one effective consistency constraint in the outer problem here,
which is a β1i -weighted sum of the original N constraints (8).
    Using this, (32) immediately implies ξ i /β1i = ξ 1 /β11 for all i and therefore the follow-
ing result:
  17 For N = 2, this is a special case of the example considered in Appendix C with a( E) = 1 − E2 /Y ( E1 ).
But we could imagine a more general model with N − 1 stealing sectors i = 2, ..., N and Y 1 ( E) = Y ( E1 ) −
∑iN=2 (1 + k i ) Ei , Y i ( Ei ) = Ei for i ≥ 2, where these activities differ in terms of the share k i of resources lost
in the process of transferring them.


                                                           36
Proposition 8. If ri ( E) is fixed for all i += 1, then the optimal adjustment term in (12) is

                 N     f Ei (w) ξ i    N f i ( w ) β1
                                                                       −Y1 + I1 + R1
                ∑      f E ( w ) ri
                                    =∑ E
                                          f E ( w ) r
                                                      i
                                                      i
                                                        ξ with ξ =
                                                                   1 − ∑ N
                                                                             β 1 (C + S )
                                                                                          .                (46)
                i =1                 i =1                                i =1 i    1i  1i

   Since both the externalities and the relative return effects induced by a change in Ei
are scaled by the magnitude of β1i , the optimal correction (in terms of income) in each
dimension i is proportional to β1i /ri . Hence, the adjustment factor vanishes whenever the
vector of local income shares at w is orthogonal to the vector of these magnitudes, i.e.
∑i ( f Ei (w)/ f E (w))( β1i /ri ) = 0. Intuitively, this is a wage level at which a variation in the
marginal income tax rate leads to changes in E that leave r1 ( E) unaffected, so the optimal
marginal tax rate is as if all returns were fixed locally.
    Otherwise, suppose, for instance, that all activities increase r1 ( E), so β1i ( E) > 0 and
∑i ( f Ei (w)/ f E (w))( β1i /ri ) > 0 for all w. The first term in the numerator of ξ in (46) captures
the Pigouvian subsidy for these positive externalities, since

                                       N     f Ei (w) β1i 1    N f i (w)
                                    −∑                    Y =∑ E           τpi .
                                      i =1
                                             f E ( w ) ri         f
                                                             i =1 E
                                                                     ( w )

In this case, the Pigouvian correction alone would lead to a negative adjustment term and
therefore lower marginal tax rates in (12). The denominator and the second term I1 + R1
in the numerator capture the deviation from this Pigouvian adjustment due to the relative
return effects from the increase in r1 induced by the subsidy.18
    The term I1 + R1 in the numerator of ξ captures the direct effect of the rise in r1 : If
activity 1 is in fact a relatively high wage activity with little redistributive weight, so
I1 + R1 > 0, then the increase in r1 is not desirable for distributional reasons, which is why
the optimal subsidy is less than the Pigouvian subsidy, and vice versa. The denominator is
a multiplier term coming from the indirect effects of the increase in r1 through the induced
sectoral reallocations of effort. It is easiest to understand when N = 2, in which case it
reduces to 1 − ( β11 /r1 − β12 /r2 )(C + S) with C and S given in (33) and (34). Intuitively,
the increase in r1 , raising the relative returns to activity 1, will always lead to a flow of
effort from activity 2 to 1. Whether this flow reinforces or mitigates the original increase
in r1 depends on the relative magnitudes of the externalities from E1 and E2 . In particular,
since the flow increases E1 and reduces E2 , there will be a further increase in r1 if β11 is large
compared to β12 , and a reduction otherwise. The denominator scales the direct effects in
  18 The        denominator of ξ in (46) is positive if the optimum involves a stable fixed point of E according
to Lemma 7 in Appendix B, since it is an eigenvalue of the matrix A associated with the eigenvector
( β11 , β12 , ..., β1N )' .


                                                         37
the numerator to account for these indirect multiplier effects of the sectoral shifts on r1 .


6    Conclusion
As suggested by the examples in the preceding section, the framework developed here
is flexible enough to handle a wide variety of applications. It is important to emphasize,
however, that these examples are not exhaustive: the optimal tax formula (12) and the
characterization of the correction term in that formula through condition (32) are fully
general and could be used to explore other special cases in future research.
    While adapting these formulas for applied policy work will be non-trivial and is be-
yond the scope of this paper, they provide useful insights into the nature of evidence
that would be required to implement them. For instance, in the pure resource transfer
example discussed in Section 5.3, the Pigouvian component of the correction would be
entirely pinned down by the aggregate income share accruing to the transfer activity. The
divergence between this and the optimal correction in turn only depends on the elastic-
ity of this income share with respect to aggregate effort in this activity: If this elasticity
is low, the within-sector crowding effects dominate and the transfer activity itself bears
the bulk of the externalities. As such, the Pigouvian tax induces a perverse shift of effort
into this activity, and the optimal correction falls short of it. If the elasticity is high, the
externalities are borne primarily by the productive activity, so a tax induces the opposite,
beneficial shift and an overcorrection is optimal. Thus, information on these income shares
and elasticities would be of direct use for optimal policy design.
   More generally, the key applied-policy lesson is that in settings with externalities, the
simple Pigouvian wedge between the private and social marginal returns of the average
worker at a given income is not sufficient for determining the optimal corrective adjust-
ment to the marginal tax rate at that income level. Policy makers need to know not just
who is over- or underpaid and by how much, but also on whom the resulting externalities
are imposed.


References
ATKINSON , A., T. P IKETTY, AND E. S AEZ (2011): “Top Incomes in the Long-Run of His-
  tory,” Journal of Economic Literature, 49, 3–71.

B ESLEY, T., AND M. G HATAK (2013): “Bailouts and the Optimal Taxation of Bonus Pay,”
   American Economic Review, Papers and Proceedings, 103, 163–167.

                                              38
B IAIS , B., T. F OUCAULT, AND S. M OINAS (2011): “Equilibrium High Frequency Trading,”
  Mimeo, TSE.

B OOTHBY, W. (1986): An Introduction to Differentiable Manifolds and Reimannian Geometry.
   Academic Press, Orlando, Florida, 2 edn.

C HONÉ , P., AND G. L AROQUE (2010): “Negative Marginal Tax Rates and Heterogeneity,”
   American Economic Review, 100, 2532–2547.

C REMER , H., F. G AHVARI , AND N. L ADOUX (1998): “Externalities and Optimal Income
   Taxation,” Journal of Public Economics, 70, 343–364.

D IAMOND , P. (1973): “Consumption Externalities and Imperfect Corrective Pricing,” Bell
   Journal of Economics and Management Science, 4, 526–538.

D IAMOND , P. (1998): “Optimal Income Taxation: An Example with a U-shaped Pattern
   of Optimal Tax Rates,” American Economic Review, 88, 83–95.

D IXIT, A. (1985): “Tax Policy in Open Economies,” in Handbook of Public Economics, ed. by
   A. Auerbach, and M. Feldstein, pp. 2475–2490. North Holland, Amsterdam.

F UDENBERG , D., AND J. T IROLE (1991): Game Theory. MIT Press, Cambridge.

G LODE , V., AND R. L OWERY (2012): “Compensating Financial Experts,” Mimeo, University
   of Pennsylvania.

K LEVEN , H. J., C. T. K REINER , AND E. S AEZ (2009): “The Optimal Income Taxation of
   Couples,” Econometrica, 77, 537–560.

K OPCZUK , W. (2003): “A Note on Optimal Taxation in the Presence of Externalities,”
   Economics Letters, 80, 81–86.

L OCKWOOD , B., C. N ATHANSON , AND G. W EYL (2012): “Taxation and the Allocation of
   Talent,” Mimeo, Harvard University and University of Chicago.

M IRRLEES , J. (1971): “An Exploration in the Theory of Optimum Income Taxation,” Re-
  view of Economic Studies, 38, 175–208.

P IKETTY, T., E. S AEZ , AND S. S TANTCHEVA (2013): “Optimal Taxation of Top Labor In-
   comes: A Tale of Three Elasticities,” American Economic Journal: Economic Policy, forth-
   coming.



                                            39
R OCHET, J.-C., AND P. C HONÉ (1998): “Ironing, Sweeping and Multidimensional Screen-
    ing,” Econometrica, 66, 783–826.

R OTHSCHILD , C., AND F. S CHEUER (2011): “Optimal Taxation with Rent-Seeking,” NBER
   Working Paper 17035.

          (2013a): “Optimal Taxation with Rent-Seeking,” Mimeo, Stanford University and
    Wellesley College.

           (2013b): “Redistributive Taxation in the Roy Model,” Quarterly Journal of Eco-
    nomics, 128, 623–668.

R OY, A. (1951): “Some Thoughts on the Distribution of Earnings,” Oxford Economic Papers,
   3, 135–146.

S ADKA , E. (1978): “On the Optimal Taxation of Consumption Externalities,” Quarterly
   Journal of Economics, 92.

S AEZ , E. (2001): “Using Elasticities to Derive Optimal Tax Rates,” Review of Economic
   Studies, 68, 205–229.

S ANDMO , A. (1975): “Optimal taxation in the presence of externalities,” The Swedish Jour-
   nal of Economics, 77, 86–98.

S CHEUER , F. (2013): “Entrepreneurial Taxation with Endogenous Entry,” forthcoming,
   American Economic Journal: Economic Policy.

S TIGLITZ , J. (1982): “Self-Selection and Pareto Efficient Taxation,” Journal of Public Eco-
   nomics, 17, 213–240.

W ERNING , I. (2007): “Pareto-Efficient Income Taxation,” Mimeo, MIT.


A      Proofs

A.1     Proof of Lemma 1
Using (2) for θ = θ ' and homogeneity of degree one of m, we have
                                   #                                     $                    #                                      $
                                        p1 y ( θ )         p y(θ )                                    p1                  pN
          q(θ ) ∈ arg min m                        , ... , N                 = arg min m                      , ... ,                    .
                      p ∈ ∆ N −1       θ1 r1 ( E )        θ N r N ( E)           p ∈ ∆ N −1       θ1 r1 ( E )         θ N r N ( E)
                                                                                                        #                                     $
                                                                                                             q1 ( θ )            q (θ )
The result in (3) follows from w(θ ) ≡ y(θ )/l (θ ) and l (θ ) ≡ m(e(θ )) = y(θ )m                                      , ... , N                 .
                                                                                                            θ1 r1 ( E )        θ N r N ( E)

                                                                    40
A.2     Proof of Lemma 2
The proof is analogous to that of Lemma 1 in Rothschild and Scheuer (2013b) for N = 2.


A.3     Proof of Proposition 1
Putting multipliers λ on (9), ξ i λ on the consistency constraints (8), and η̂ (w)λ on (7), the Lagrangian corre-
sponding to (6)-(9) is, after integrating by parts (7),
               ! wE                            ! wE                            ! wE
                                                                                                                       l (w)
      L =              V (w)ψE (w)dw −                 V (w)η̂ ' (w)λdw +                ul (c(V (w), l (w)), l (w))         η̂ (w)λdw
                 wE                              wE                                wE                                     w
                   N       5                  ! wE                        6        ! wE
                                 1
               + ∑ ξ i λ Ei −                         wl (w) f Ei (w)dw       +λ          (wl (w) − c(V (w), l (w))) f E (w)dw.          (47)
                 i =1
                              ri ( E )         wE                                   wE


Using ∂c/∂V = 1/uc and compressing notation, the first order condition for V (w) is

                                                                        1            u (w) l (w)
                                 η̂ ' (w)λ = ψE (w) − λ f E (w)             + η̂ (w)λ cl         .                                       (48)
                                                                     uc (w)          uc (w) w

Defining η (w) ≡ η̂ (w)uc (w), this becomes

                                     uc (w)                   ucc (w)c' (w) + ucl (w)l ' (w) + ucl (w)l (w)/w
              η ' ( w ) = ψE ( w )          − f E (w) + η (w)                                                 .                          (49)
                                        λ                                          uc (w)

Using the first order condition corresponding to the incentive constraint (11),

                                                                                          l (w)
                                         uc (w)c' (w) + ul (w)l ' (w) + ul (w)                  = 0,                                     (50)
                                                                                             w

the fraction in (49) can be written as −(∂MRS(w)/∂c)y' (w)/w, where M (c, l ) ≡ −ul (c, l )/uc (c, l ) is the
marginal rate of substitution between effort and consumption and MRS(w) ≡ M (c(w), l (w)), so (with a
slight abuse of notation) ∂MRS(w)/∂c stands short for ∂M (c(w), l (w))/∂c. Substituting in (49) and rear-
ranging yields
                          ∂MRS(w)         y' (w)                                uc (w)
                        −           l (w)        η ( w ) = f E ( w ) − ψE ( w )        + η ' ( w ).      (51)
                             ∂c           y(w)                                     λ
Integrating this ODE gives
                                     ! wE #                     $     #! s                           $
                                                         uc (s)            ∂MRS(t)        y' (t)
                   η (w)     =                f E ( s ) − ψE ( s )exp               l (t)        dt ds
                                      w                    λ             w   ∂c           y(t)
                                     ! wE #                $       #! s #    u    $          $
                                              ψ (s) uc (s)                  ε (t) dy(t)
                             =              1− E              exp         1− c                  f E (s)ds,                               (52)
                                      w        f E (s) λ             w      ε (t)     y(t)

where the last step follows from l (w)∂MRS(w)/∂c = 1 − εu (w)/εc (w) after tedious algebra (e.g. using
equations (23) and (24) in Saez, 2001).
   Using ∂c/∂l = MRS, the first order condition for l (w) is
          #                    $          N                        5                                                6
               MRS(w)                          ξi i                  (−ucl (w)ul (w)/uc (w) + ull (w)) l (w) ul (w)
λw f E (w) 1 −                     − λw ∑         f (w) = −η̂ (w)λ                                          +         ,
                 w                          r ( E) E
                                        i =1 i
                                                                                      w                         w



                                                                     41
which after some algebra can be rewritten as
                       #                      $        N                               #                                         $
                           MRS(w)                          ξi i                             ∂MRS(w) l   MRS(w)
             w f E (w) 1 −                        −w∑          f (w) = η (w)                          +                              ,         (53)
                             w                          r
                                                    i =1 i
                                                           ( E) E                             ∂l    w     w

where ∂MRS(w)/∂l again stands short for ∂M (c(w), l (w))/∂l. With MRS(w)/w = 1 − T ' (y(w)) from the
first order condition of the workers, this becomes
                                                     5              #                   $6
                   N
                        ξ i f Ei (w)                       η (w)         ∂MRS(w)   l
              1− ∑                           '
                                     = (1 − T (y(w))) 1 +             1+                   .                                                   (54)
                     r ( E) f E (w)
                 i =1 i
                                                          w f E (w)        ∂l    MRS(w)

Simple algebra again shows that 1 + ∂ log MRS(w)/∂ log l = (1 + εu (w))/εc (w), so that the result follows
from (52) and (54).


A.4      Proof of Lemma 3
(i) For Ckj , this follows from

                            N                         ! wE              N    ,          ' -
                                                                                j       '
                           ∑ r j (E)Ckj (E) =                w2 l ' (w) ∑ Cov q E , qkE ' w dw = 0
                           j =1                         wE               j =1

                   ,           ' -       ,                 ' -      ,      ' -
because ∑ N    Cov   q
                       j
                         , q k ' w = Cov     N
                                                 q
                                                   j
                                                     , q k ' w = Cov 1, qk ' w = 0 for all w. For S , we prove
          j =1         E E     '           ∑ j =1 E E      '             E'                        kj
                                         j
the result by showing that ∑ N
                             j=1 Qk ( x E ( φ )) = 0 for all φ ∈ Φ. For this, use (28) and (29) to write


                            N        j                N                                                              N
              ∂1                ∂q (φ)                     ∂Zj ( x E (φ))                             1                      j
      0=
         ∂(θk rk ( E))
                       =   ∑ ∂(θkErk (E)) =           ∑    ∂ ( θ  r
                                                                 k k ( E ))
                                                                            Ω j (ζ ( x E (φ))) +
                                                                                                 θ N N ( E)
                                                                                                    r            ∑ Qk (xE (φ))           ∀φ.
                           j =1                       j =1                                                       j =1


Hence, showing that ∑ j Ω j ∂Zj /∂(θk rk ( E)) = 0 will complete the proof. Using (28), we have
                                                                                #                                    $
                                       r j ( E)θ j                                      p1                 pN
                       Zj ( x E (φ)) ≡             = r j ( E)θ j min m                          , ...,                   ,                     (55)
                                            w                   p ∈ ∆ N −1          r1 ( E ) θ1        r N ( E)θ N

so
                                                ∂Zj         δkj                        qk
                                                          =     − r j θ j mk (e/y)             ,                                               (56)
                                             ∂ (r k θ k )   w                      (r k θ k )2
where mk denotes the (homogeneous of degree zero) partial derivative of m w.r.t. its k-th argument. Note
that the first order conditions for the minimization in (55) are mk (e/y)/(rk θk ) = m N (e/y)/(r N θ N ) for all
k = 1, ..., N, which implies

                                              N                                       N
           1   m(e)                                           qk       m N (e/y)                   m N (e/y)  m (e/y)
             =      = m (e/y) =              ∑ mk (e/y) rk θk      =                 ∑ qk =                  = k      ∀k,                      (57)
           w    y                            k =1
                                                                         rN θN       k =1
                                                                                                     rN θN     rk θk




                                                                    42
where the second equality uses linear homogeneity of m, the third uses Euler’s theorem, and the forth and
sixth the first order conditions. Substituting this in (56) and using Ω j = e j /m(e) = e j w/y yields
                                             (                )            (                     )                      (                   )
               ∂Zj                    ej w  δjk    r j θ j qk           ej       rj θj     rθ
                                                                                          k j j
                                                                                                                   yj        δjk     qk
       ∑ Ω j ∂(θk rk )   =        ∑    y     w
                                                −
                                                    w rk θk
                                                                =∑
                                                                        y
                                                                             δjk
                                                                                 rj θj
                                                                                       −q
                                                                                           rk θk
                                                                                                   =          ∑    y        rk θk
                                                                                                                                  −
                                                                                                                                    rk θk
       j                          j                                  j                                         j
                                        1 , j              -     1 , k          -
                         =        ∑         q δjk − q j qk =           q − qk = 0,
                                  j
                                      rk θk                    rk θk

where the third equality uses δjk /r j θ j = δjk /rk θk . The remaining steps are algebra and establish the result.
                                                                         j
      (ii) ∑kN=1 Skj ( E) = 0 follows from (31) and ∑kN=1 Qk ( x E (φ)) x kE (φ) = 0 for all φ. To see the latter, use (29)
and
                              N                                               N
                                  ∂ζ l ( x E (φ)) k                               ∂ζ l ( x E (φ))
                             ∑                      x ( φ )r N ( E ) θ N =
                                  ∂ (r k ( E ) θ k ) E                       ∑                      r ( E)θk = 0 ∀l
                                                                                  ∂ (r k ( E ) θ k ) k
                             k =1                                            k =1

by the zero-homogeneity of ζ and Euler’s theorem. ∑kN=1 Ckj ( E) = 0 follows from (26) and an analogous
argument to part (i).


A.5       Proof of Proposition 2
From (23), !n'!t p = !n' β!        Y denotes the column vector of aggregate sectoral incomes Y i ( E). By
                          Y, where !
definition, ∆β = β (IN − ON ), where ON is matrix with (i, j)th element δNj (i.e., with ones in the last row
and zeros otherwise). The “if” is thus immediate. For “only if”, observe that the last column of IN − ON
is zero and let D denote the matrix whose first N − 1 columns coincide with IN − ON and whose N th
column is !Y. Then !n' ∆β = 0 and !n'!t p = 0 only if !n' βD = 0. Since !
                                                                        Y ≥ 0 with at least one strictly positive
                                   '                     '
entry, D is non-singular. Hence, !n βD = 0 only if !n β = 0.


A.6       Proof of Proposition 3
Since wE (θ ) and q E (θ ) depend on E only through the returns vector r ( E), this vector is a sufficient statistic
for individual decisions given any l (w) and V (w), and hence for the solution to the inner problem. β has the
same rank, N − K, as the matrix of partial derivatives Dr (·), as ln(·) is a diffeomorphism. By the Constant
Rank Theorem (Boothby, 1986, Theorem 7.1), there exist open neighborhoods UE ⊂ R N of E∗ and Ur ⊂ R N
of r ( E∗ ) and diffeomorphisms G from UE onto a open subset of R N and H from Ur onto an open subset
of R N such that H (r ( G −1 ( x1 , · · · , x N ))) = ( x1 , ..., x N −K , 0, · · · , 0). Defining ρ ≡ ( x1 , · · · , x N −K ), we have
r ( G −1 (ρ, x N −K +1 , · · · , x N )) = H −1 (ρ, 0, · · · , 0), so ρ is sufficient for r.
      To find the consistency constraints associated with ρ, let E (r ( E); l (·)) denote the vector of right-hand
sides of (8). Then the ith consistency constraint, i = 1, · · · , N − K is ρi = Gi (E ( H −1 (ρ, 0, · · · , 0); V (·), l (·))),
i.e., the ith component of G ( E) = G (E (r ( E); l (·)), written in terms of ρ.


A.7       Proof of Lemma 5
Dropping the arguments E, the optimality conditions (32) can be written for N = 2 as
                                                                  (               )
                                                                      ∆β11
                                                   A!ξ = !t p +                       ( I1 + R1 ).                                              (58)
                                                                      ∆β12

                                                                       43
     0           1'
Since ∆β11 , ∆β12 is an eigenvector of A, it is also an eigenvector of A−1 (with associated eigenvalue 1/γ2 ),
and we can write (58) as                              (       )
                                                         ∆β 1
                                              − 1
                                      !ξ = A !t p +         1   I1 + R1
                                                                        .
                                                         ∆β12      γ2

Moreover, defining the eigenbasis
                                                 (                      )               (         )
                                                     r1       ∆β11                            a
                                         B≡                                   and                     ≡ B −1!t p ,
                                                     r2       ∆β12                            b
                        (        )           (          )                                                      (                     )
                            r1                   ∆β11                        1       1                             ∆β12   ∆β11
we can write !t p = a                  +b                   . Using this and    = 1−                                    −                (C + S), we have
                            r2                   ∆β12                        γ2      γ2                             r2     r1
                            (        )       (          (           )              (              ) )(             )        (        )          (          )
      −1!          −1            a                            r1                       ∆β11                    a                r1         b        ∆β11
  A     tp   = A        B                =       A−1                        A−1                                        =a                +
                                 b                            r2                       ∆β12                    b                r2         γ2       ∆β12
                          (              )          (               )              (              )        (                    )
                                ∆β11           b        ∆β11                           ∆β11           b        ∆β12   ∆β11
             = !t p − b                      +                          = !t p −                                    −            ( C + S ).
                                ∆β12           γ2       ∆β12                           ∆β12           γ2        r2     r1

Hence,                                       (            )              0                   1
                                                 ∆β11        I1 + R1 − b ∆β12 /r2 − ∆β11 /r1 (C + S)
                              !ξ = !t p +                                                              .                                                   (59)
                                                 ∆β12                          γ2
                                                                             0                   1
Finally, note that the second row of B −1                 is (−1/r1 , 1/r2 )/ ∆β12 /r2 − ∆β11 /r1 , so
                                                          (                   )7 (                         )
                                                              t1p       t2p            ∆β12   ∆β11
                                                 b=−                −                       −                  .
                                                              r1        r2              r2     r1

Substituting in (59) yields the result.


A.8         Proof of Lemma 6
Since ri ( E) = Yi ( E) when there are no externalities, Y ( E) = ∑iN=1 ri ( E) Ei = ∑iN=1 Yi ( E) Ei . The lemma then
follows from Euler’s Theorem.


A.9         Proof of Proposition 4
Observe first that β3i = 0 for all i, so the third row of ∆β is zero. Using this together with !t p = 0 in (32)
immediately implies ξ 3 = 0. Straightforward calculations yield β11 ( E) = − β12 ( E)/ρ = Y1' (ρ)/( E2 Y1 (ρ)),
β21 ( E) = − β22 ( E)/ρ = Y2' (ρ)/( E2 Y2 (ρ)), ∆β11 ( E) = −1/( E1 σ̂ (ρ)), and ∆β12 ( E) = 1/( E2 σ̂ (ρ)), where
−1/σ̂(ρ) = ρ(Y1' (ρ)/Y1 (ρ) − Y2' (ρ)/Y2 (ρ)) is the substitution elasticity of Ŷ. Hence, the second row of
∆β is −ρ times the first row, which implies ξ 2 = −ρξ 1 . We can therefore use the first row of the sys-
tem (32) to solve for ξ 1 , which (using β31 = 0) yields ξ 1 /r1 = −(1 − α̂)ξ̂ where ξ̂ is given in (38), and
ξ 2 /r2 = −ρξ 1 /r1 = α̂ξ̂. Finally, substituting these two and ξ 3 = 0 in the adjustment term delivers (37).




                                                                              44
A.10       Proof of Proposition 5
Tedious algebra yields

                            1 − α(ρ)                                                    1 − α(ρ)
          β11 ( E) E1 = −            − α(ρ)(1 − ε h ( E)),          β12 ( E) E2 =                − (1 − α(ρ))(1 − ε h ( E)),
                              σ(ρ)                                                        σ(ρ)

                               α(ρ)                                                     α(ρ)
               β21 ( E) E1 =        − α(ρ)(1 − ε h ( E)),       β22 ( E) E2 = −              − (1 − α(ρ))(1 − ε h ( E)),
                               σ(ρ)                                                     σ(ρ)

so ∆β11 (ρ) E1 = −∆β22 (ρ) E2 = −1/σ(ρ). Moreover, τp1 ( E) = τp2 ( E) = 1 − ε h ( E). Substituting in (36) yields
ξ 1 /r1 = 1 − ε h ( E) − (1 − α(ρ))ξ and ξ 2 /r2 = 1 − ε h ( E) + α(ρ)ξ, and using this in (12) yields (42).


A.11       Proof of Proposition 6
Proposition 6 is a direct Corollary of Proposition 9 in Appendix C for ε 2 = α = 0.


A.12       Proof of Proposition 7
We can use the first row of (32) to explicitly solve for ξ 1 , using ξ i = 0 for all i += 1:

                                                                             j
                                                      t1p + ∑ jN=−11 ∆β 1 ( Ij + R j )
                                              ξ1 =                       j
                                                     1 − ∑ jN=−11 ∆β 1 (Cj1 + S j1 )

                        j
where t1p = − ∑ N        j
                j=1 β 1 Y and C j1 and S j1 are given in (26) and (31). This immediately yields the result.



A.13       Proof of Proposition 8
Using ξ i = ξ 1 β1i /β11 , we can use the first equation in the system (32) to solve for ξ 1 :
                                                                    7(                                )
                                        ,                       -                 N
                                  ξ 1 = t1p + β11 ( I1 + R1 )            1 − ∑ β1i (C1i + S1i )
                                                                                 i =1


Again using ξ i = ξ 1 β1i /β11 and tip = t1p β1i /β11 delivers the result.



B      Eigenvalues and Stability
For any given vector E, and holding for instance the schedule l (w) fixed, the right-hand sides of the system
of consistency constraints (8) yield some implied vector of sectoral efforts E ( E), and the constraints require
that the optimal E is a fixed point of this mapping: E = E ( E). It is reasonable to assume that the optimal
E is in fact a stable fixed point of this mapping, since otherwise we would have no reason to expect that it
will be reached when the government offers the optimal tax schedule T (y).
    However, as discussed in detail in section 3.3, the variation underlying (32) is not keeping the sched-
ule l (w) fixed, so the appropriate notion of stability of the fixed point needs to account for the sched-
ule variation in subshift 2 when E changes. Formally, suppose we start from some optimal vector E∗


                                                                    45
and schedule l ∗ (w) and move locally away from E∗ to E. The resulting average effort change at w is
∑iN=1 l ∗ (w)wδEi ∗ (w)( Ei − Ei∗ ) by (16) and (17). Our variation constructs an effort schedule lE (w) in sub-
         '

shift 2 by making the negative of this adjustment to l ∗ (w) at each w and for each E, i.e.

                                                            N
                                     lE (w) ≡ l ∗ (w) − ∑ l ∗ ' (w)wδEi ∗ (w)( Ei − Ei∗ ).                                         (60)
                                                           i =1

Note that the adjustments to the effort schedule underlying lE (w) are linear in E. If there is no bunching
at the original optimum, so y∗ (w) is increasing, we know that y E (w) ≡ wlE (w) will be increasing in w as
well for E close to E∗ , so it will be implementable with some nonlinear income tax schedule TE (y). This tax
schedule is such that average effort at each w is unchanged when varying E close to E∗ .
     We are interested in the stability of the optimal fixed point E∗ when the government offers this E-
                                         "w
contingent tax schedule. Let Ei ( E) = w E y E (w) f Ei (w)dw/ri ( E) and imagine a dynamic system with
                                                 E


                                                Ėi = Ei ( E) − Ei ,       i = 1, ..., N.                                          (61)

Denoting the Jacobian of the right-hand side of this system, E ( E) − E, by J , stability of the fixed point E∗
requires the real parts of all eigenvalues of J to be negative. Since E ( E) − E is the negative of the consistency
constraints (8), J = −A by our derivation of the consistency constraint effects in section 3.3. This leads to
the following result:

Lemma 7. A fixed point E of the system (61) is stable if and only if all eigenvalues of the matrix A = IN − ∆β (C +
S ) in (32) have positive real parts.



C         General Sectoral Income Shares
C.1       The General Case
Let Y ( E) have constant returns to scale and Y 1 ( E) = a( E)Y ( E) and Y 2 ( E) = (1 − a( E))Y ( E), so that, by
linear returns,
                         r1 ( E) = a( E)Y ( E)/E1 and r2 ( E) = (1 − a( E))Y ( E)/E2 .                        (62)

Defining
                                           ∂a( E) E1                 ∂(1 − a( E))    E2
                              ε 1 ( E) ≡              and ε 2 ( E) ≡
                                            ∂E1 a( E)                    ∂E2      1 − a( E)
yields:

Proposition 9. If N = 2, Y ( E) has constant returns to scale and private returns are given by (62), then the
adjustment to the marginal tax rate formula (12) is
                                                                       (                                                   )
            2     f Ei (w) ξ i   f 1 (w) a − α   f 2 (w) α − a             f E1 (w)                   f 2 (w)
           ∑      f E ( w ) ri
                               = E
                                 f E (w) a
                                               + E
                                                 f E (w) 1 − a
                                                               +
                                                                           f E (w)
                                                                                    (ε 1 − (1 − a)) + E
                                                                                                      f E (w)
                                                                                                              (a − ε 2 )       ξ
           i =1

with
                                                                     a−α
                                                      I1 + R1 +    a (1− a )
                                                                             (C   + S)
                                           ξ=                                               .                                      (63)
                                                a(1 − a)Y + (1 − ε 1 − ε 2 )(C + S)


                                                                  46
Proof. We have

                                                                     1 − a( E)                                       a( E)
β11 ( E) E1 = −(1 − α(ρ)) + ε 1 ( E),     β12 ( E) E2 = 1 − α(ρ) −             ε 2 ( E ),   β21 ( E) E1 = α(ρ) −            ε ( E ),
                                                                       a( E)                                       1 − a( E) 1

                                                                         ε 1 ( E)                        ε 2 ( E)
           β22 ( E) E2 = −α(ρ) + ε 2 ( E),     ∆β11 ( E) E1 = −1 +                and ∆β12 ( E) E2 = 1 −          .
                                                                       1 − a( E)                          a( E)
Moreover, τp1 ( E) = ( a( E) − α(ρ)/a( E) and τp2 ( E) = (α(ρ) − a( E))/(1 − a( E)). We can also compute

                                        ∆β12 ( E) ∆β11 ( E)     1 − ε 1 ( E) − ε 2 ( E)
                                                  −          =                          .
                                         r2 ( E )   r1 ( E )   a( E)(1 − a( E))Y ( E)

Substituting in (36) yields ξ 1 /r1 = ( a − α)/a + (ε 1 − (1 − a))ξ with ξ as given in (63), and analogously
ξ 2 /r2 = (α − a)/(1 − a) + ( a − ε 2 )ξ. The result then follows from substituting those into the adjustment
formula.

     The first two terms are simply the weighted average of the Pigouvian corrections for the two activities,
since τp1 = ( a − α)/a and τp2 = (α − a)/(1 − a), where the weights are the local income shares. In particular,
if a > α, meaning that activity 1 is overpaid relative to its social marginal product, then τp1 > 0 and
τp2 < 0. As discussed in Section 5.3, aτp1 + (1 − a)τp2 = 0. In other words, the direction of no externalities,
in terms of sectoral incomes, here is always ( a, 1 − a) (equivalently, in terms of sectoral effective efforts, it is
( a/r1 , (1 − a)/r2 ), which using (62) is parallel to (ρ, 1)). Hence, at wage levels where the local and aggregate
income shares coincide, the Pigouvian correction vanishes.
     The terms in brackets capture the deviation from this weighted Pigouvian correction due to the relative
return effects of a variation in the marginal tax rate. Since ε 1 − (1 − a) = (1 − a)∆β11 E1 and a − ε 2 = a∆β12 E2 ,
this deviation can be rewritten as
                                              (                                     )
                                                f E1 (w) ∆β11 E1   f E2 (w) ∆β12 E2
                                   a (1 − a )                    +                    ξ.
                                                f E (w) a          f E (w) 1 − a

In particular, by the general analysis in section 4, the direction of no relative return effects, again in terms
of incomes, is (∆β12 r1 , −∆β11 r2 ), which again using (62) is parallel to ( a∆β12 /E1 , −(1 − a)∆β11 /E2 ). Hence,
whenever the vector of local income shares ( f E1 (w)/ f E (w), f E2 (w)/ f E (w)) points in this direction, the terms
in brackets cancel, and the optimal correction coincides with the Pigouvian one.
     Otherwise, the wedge depends on the sign of the relative return effects. For instance, suppose activity
1 is the overpaid one, so a > α, and at the same time the high-wage, low redistributive preference activity.
Then ξ > 0 (since I1 , R1 > 0 and the denominator is positive whenever the optimum involves a stable
fixed point by Lemma 7 in Appendix B). Moreover, suppose that both an increase in E1 and an increase
in E2 reduce the relative returns x1 to activity 1 (so that ε 1 < 1 − a and ε 2 > a). Intuitively, this would
be a situation where activity 1 is, for instance, subject to crowding, whereas activity 2 mostly depresses
the returns to the other activity. Then an increase in the marginal tax rate at a wage level w, by reducing
both E1 and E2 , induces a flow of individuals into the overpaid activity 1 by increasing x1 . Since this is not
desirable, the optimal correction is in this case less than the Pigouvian correction.
     A special case for the income share function a( E) that leads to a particularly transparent characteriza-
tion, apart from the example discussed in Section 5.3, occurs when a is homogeneous of degree zero.



                                                              47
C.2      Incomes Shares Homogeneous of Degree Zero
Suppose a( E) is only a function of ρ = E1 /E2 , as is α. Then it is easy to check that (1 − a)ε 2 = aε 1 . Hence,
∆β11 E1 = −∆β12 E2 and the direction of no relative return effects (in E-space) is simply (1, ρ), as in the
preceding subsections. More importantly, as shown above, the direction of no externalities is always (1, ρ)
as well, so the two coincide in this case and the outer problem effectively reduces to a one-dimensional
problem. This leads to a particularly simple formula for the optimal correction factor.

Corollary 2. If a( E) is homogeneous of degree zero, then
                                                        (                 )#                         $
                             2     f Ei (w) ξ i    1        f E1 (w)           a−α
                            ∑      f E ( w ) ri
                                                =
                                                  1−a       f E (w)
                                                                     −a
                                                                                a
                                                                                   − (1 − a − ε 1 ) ξ ,      (64)
                            i =1


where ξ is given in (63).

     The first bracketed term, which parallels the corresponding terms in (39) and (42), compares the local
income share from activity 1 to its aggregate income share a at each wage w. In parts of the income distribu-
tion where sector 1 dominates, the second bracketed term applies the Pigouvian correction for this sector,
τp1 = ( a − α)/a, adjusted by a term that accounts for the relative return effects. These now only depend on
ε 1 = a' (ρ)ρ/a(ρ) since the relative return effects of E1 and E2 are always opposite. For instance, suppose
activity 1 is again the high income activity and is overpaid, so a > α and ξ > 0. (Note though that the labels
of the sectors do not matter here; what is required to be able to sign ξ is only that the overpaid activity is
also the high-income, low redistributive preference activity, so that the numerator in (63) is either positive
or negative.) If ε 1 > 1 − a, then the second bracketed term exceeds the Pigouvian correction since an in-
crease in the marginal tax rate at w (by reducing E1 ) reduces the relative return x1 and therefore induces a
beneficial shift of effort out of activity 1, and vice versa. Both the Pigouvian and relative return corrections
vanish when f E1 (w)/ f E (w) = a.




                                                                  48
