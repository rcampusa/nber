                                NBER WORKING PAPER SERIES




    RESTORING THE PRODUCT VARIETY AND PRO-COMPETITIVE GAINS FROM
     TRADE WITH HETEROGENEOUS FIRMS AND BOUNDED PRODUCTIVITY

                                         Robert C. Feenstra

                                        Working Paper 19833
                                http://www.nber.org/papers/w19833


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     January 2014




Thanks are due to Costas Arkolakis, Andrés Rodríguez-Clare, Kadee Russ and seminar participants
at the NBER and UCLA for helpful comments. Financial support from the National Science Foundation
is gratefully acknowledged. The views expressed herein are those of the author and do not necessarily
reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2014 by Robert C. Feenstra. All rights reserved. Short sections of text, not to exceed two paragraphs,
may be quoted without explicit permission provided that full credit, including © notice, is given to
the source.
Restoring the Product Variety and Pro-competitive Gains from Trade with Heterogeneous
Firms and Bounded Productivity
Robert C. Feenstra
NBER Working Paper No. 19833
January 2014
JEL No. F12

                                              ABSTRACT

The monopolistic competition model in international trade offers three sources of gains from trade
that do not arise in competitive models: expansion in product variety; a pro-competitive reduction
in the markups charged by firms; and the self-selection of more efficient firms into exporting. Recent
literature on trade with heterogeneous firms has emphasized the third of these effects, and the first
two effects are ruled out when using a Pareto distribution for productivity with a support that is unbounded
above. The goal of this paper is to restore a role for product variety and pro-competitive gains from
trade by using a bounded Pareto distribution for productivity.


Robert C. Feenstra
Department of Economics
University of California, Davis
One Shields Avenue
Davis, CA 95616
and NBER
rcfeenstra@ucdavis.edu
                                                    1


1. Introduction

        The monopolistic competition model in international trade offers three sources of gains

from trade that do not arise in competitive models. First, opening to trade can lead to expansion

in product variety, as goods not available in autarky become imported. This first source is

emphasized in the earliest writings by Krugman (1979) and throughout Helpman and Krugman

(1985). A second source of gains emphasized by these authors is that the pro-competitive effect

of trade reduces the markups charged by firms, and therefore lowers consumer prices. In order

for this fall in prices to translate in a social gain, and not just a re-distribution from firms to

consumers, we need the assumption of zero profits due to free entry. Then the reduced ratio of

price to marginal cost implies a reduced ratio of average to marginal costs, too, so that firms are

taking greater advantage of economies of scale. In this way, the consumer gains due to reduced

markups become social gains because of the accompanying expansion of firm scale.

        The third source of gains arises in the more recent models of monopolistic competition

and trade with heterogeneous firms, due to Melitz (2003). In this case, trade will lead to the self-

selection of more efficient firms into exporting, while less efficient firms exit the market, leading

to rise in average productivity. This third source of gains has been the focus of recent literature.

For example, if we add the assumption that firm productivity is unbounded above with a Pareto

distribution, as in Chaney (2008), then it can be shown that the gains from trade in the Melitz

(2003) model are entirely due to the selection of firms: the welfare gains from new imported

varieties are just offset by the loss from fewer domestic varieties (Feenstra, 2010); and of course,

there is no change in markups due to CES preferences. Even without the unbounded Pareto

assumption, Melitz and Redding (2013) have recently argued that the rise in average productivity

due to firm selection and trade in the Melitz model is what distinguishes it most clearly from the
                                                          2

homogeneous firm model of Krugman (1980). Even if we allow for non-CES preferences with

heterogeneous firms, so that in principal a pro-competitive effect could operate, Arkolakis,

Costinot, Donaldson and Rodriguez-Clare (ACDR, 2012) have recently shown that neither this

effect nor product variety leads to any gains; so once again, the key source of gains from trade

comes from the selection of firms.1 That result in ACDR depends on the assumption of a Pareto

distribution of productivity with a support that is unbounded above, which is the starting point

for this paper.

         The goal of this paper is to restore a role for product variety and pro-competitive gains

from trade with heterogeneous firms, by using a bounded (or truncated) Pareto distribution for

productivity. The empirical relevance of this approach is beyond question: Helpman, Melitz and

Rubenstein (2008) have used the bounded Pareto to obtain a gravity equation in trade that is

consistent with the many instances of zero trade flows between countries.2 It is surprising, then,

that the bounded Pareto has not received more theoretical attention (though it is consistent with

Melitz, 2003, who did not constrain the distribution). One reason for the popularity of the

unbounded Pareto is that, like CES preferences, it leads to highly tractable solutions for trade and

welfare. A secondary goal of this paper is to show that the bounded Pareto distribution still

yields tractable solutions, even with a class of preferences allowing for non-constant markups.

         Specifically, we will work with a class of preferences introduced by Diewert (1976)

known as the quadratic mean of order r (QMOR) expenditure function. This is perhaps the most


1
   ACDR further show that total gains are reduced by the pro-competitive effect – which becoming an “anti-
competitive” effect – when tastes are non-homothetic. That result is obtained because the positive overall gains leads
to an expansion of demand in favor of the higher-markup varieties, which worsens the distortion as compared to the
first-best with constant markups (Dhingra and Morrow, 2012). In contrast, we assume homothetic tastes so this
“anti-competitive” effect does not occur.
2
   Another motivation for using bounded productivity comes from the theory of globalization put forth by John
Sutton and summarized in his Clarendon Lectures (Sutton, 2012). Sutton uses three assumptions to derive the
interaction of firms as globalization proceeds, the third of which is “you can’t make something out of nothing”
(Sutton, 2012, p. 55). That assumption is intended to rule out unbounded productivity.
                                                         3

general parametric form for expenditure that is dual to homothetic preferences. It differs from the

class of preferences used by ACDR because it is homothetic, and more important, because it

gives an explicit functional form for the expenditure needed for one unit of utility – that is, for

the cost of living.3 In contrast, ACDR rely on an implicit solution for welfare by integrating from

demand, which makes it challenging to deal with non-infinitesimal changes in product variety.4

The QMOR expenditure function is introduced in section 2 where, because we are dealing with a

monopolistic competition model, we assume that demand is symmetric across varieties and also

that it has a finite reservation price. Given these properties, we establish the sign pattern of the

parameters needed to ensure that the QMOR expenditure function is globally well-behaved: a

feature that has not been assured in prior applications, mainly empirical.

        Our use of the QMOR expenditure function sets this paper apart from other recent,

theoretical literature dealing with variable markups in international trade. A more common

choice is to use the additively separable utility function introduced by Krugman (1979), possibly

with an explicit functional form for the sub-utility from each variety.5 Zhelobodko et al (2010,

2011), Kichko et al (2013) and Dhingra and Morrow (2012) consider a broader class of

additively separable functions than Krugman (1979) by allowing the elasticity of demand to be

increasing or decreasing in quantity. These authors argue for a pro-competitive effect of trade in

the latter case only (as assumed by Krugman and holding here). But when these authors consider

heterogeneous firms, they do not appear to recognize that a Pareto distribution with unbounded

support implies that the pro-competitive effect vanishes, as we shall explain here.



3
  The class of preferences used by ACDR includes one homothetic case – the translog preferences – which are also
included within the QMOR class. This is the only case that is common to both classes, as explained in section 2.
4
  In ongoing work, these authors propose a quantitative method to perform this integration, thereby obtaining
welfare from estimated demand.
5
   Behrens and Murata (2007, 2012) use exponential functions and the latter paper includes pro-competitive effects,
while Saure (2009) and Simonovska (2010) use a logarithmic function with displaced origin.
                                                          4

          Another line of literature related to this paper assumes a finite number of firms, in which

case markups are endogenous even with nested-CES preferences.6 Initiated by Atkeson and

Burstein (2008), this framework is used by Edmond, Midrigan and Xu (2012) to compute the

pro-competitive gains from trade between the United States and Taiwan. Specializing to the case

of Bertrand competition between firms, De Blas and Russ (2012) contrast the results obtained by

Bernard, Eaton, Jensen, and Kortum (2003) using an infinite number of rivals to those obtained

instead with a finite number of rivals; only in the latter case does a pro-competitive effect of

trade operate. Our paper is most closely related to Holmes, Hsu and Lee (2013), who also use

Bertrand competition and show that if and only if the distribution of productivities is unbounded

Pareto, then trade leads to gains only through selection and not through markups. In these papers,

Bertrand competition occurs between firms producing perfect substitutes, so there are no gains

from product variety.

          Before proceeding, we should give a brief intuition as to why the pro-competitive effect

of trade vanishes with heterogeneous firms and the unbounded Pareto distribution. Suppose that

we measure markups by the ratio (not the difference) of price and marginal cost. The most

productive firm has zero cost, but a non-zero price, so its markup is infinite. The least productive

surviving firm will have its marginal cost equal to the reservation price, so its markup is zero.

This range of [0,+) for markups applies equally well to domestic and foreign firms, even if the

latter face variable trade costs. Furthermore, the distribution of markups within this range is

determined by the Pareto distribution of productivity. So changes in trade costs have no impact at

all on the distribution of markups, from either domestic or foreign firms, but still affect the mass

(or extensive margin) of exporters. The fixed distribution of markups no longer holds, however,


6
    Eaton, Kortum and Sotelo (2012) also consider a model with a finite but stochastic number of firms.
                                                  5

when productivity and markups are bounded above, since then the highest foreign markup

depends on trade costs (so trade costs also affect the intensive margin).

       Our paper proceeds as follows. We show in sections 2 and 3 that the QMOR expenditure

function allows us to decompose the cost of living – and therefore welfare – into components

that correspond to product variety, the pro-competitive effect, and the selection effect which is

captured by average firm productivity. In the trade environments we shall consider, we are able

to establish how these components change individually and jointly due to liberalization. This

allows us to establish the gains comparing autarky to frictionless trade (section 4), and for small

changes in trade costs around the frictionless equilibrium (section 5). Importantly, we contrast

the source of gains with unbounded versus bounded Pareto, and show that it is only in the

bounded case where the product variety and pro-competitive gains apply.

       Finally, we are able to compare the magnitude of total gains from trade using unbounded

versus bounded Pareto. Measured in relation to initial utility, we find that the proportionate rise

in welfare due to trade liberalization is largest in the unbounded Pareto case, despite the fact that

neither the product variety nor the pro-competitive channels operate in this case. Constraining

the Pareto distribution to be bounded allows those extra sources of gains to operate, but reduces

the gains due to firm selection, so that the total proportionate gains are lower. This result is

related to Melitz and Redding (2013), who compare a heterogeneous firm model (with any

productivity distribution) to a homogeneous firm model (i.e. with a degenerate distribution), both

with CES preferences. They find higher proportionate gains when productivity is disperse across

firms. We are using non-CES preferences, and find higher proportionate gains when productivity

is the most disperse across firms, i.e. unbounded above. Conclusions are given in section 6, and

the proofs of propositions are in the Appendix.
                                                          6


2. Consumer Preferences

Expenditure Function

       We shall adopt the quadratic mean of order r (QMOR) expenditure function, which is

defined by Diewert (1976, p. 130) over a discrete number of goods with price vector p as:

                                                              1/ r
                       er (p)    i  j bij pir /2 p rj /2        , r  0,
                                                            

where r and bij are parameters. We shall consider the symmetric case where bii = and bij = for

i  j, so that the QMOR function is re-expressed over a continuum of goods indexed by  as:

                                                                          1/ r
                                
                                                                     
                                                                 2
                       er (p)    pr d             p d 
                                                            r /2
                                                                                 , r  0.     (1)
                                

This function is the expenditure needed to obtain one unit of utility, or the cost of living. For

specific values of the parameters r,  and , this expenditure function takes on familiar forms.

For  > 0,  = 0 and r =(1–), the expenditure function is CES, so that r < 0 for  > 1. For r = 2,

we obtain a quadratic expenditure function, but without the additively separable outside good

used by Melitz and Ottaviano (2008). For r = 1, we obtain what Diewert (1971) calls a

Generalized Leontief function (since the dual to a Leontief production function is linear in prices

like the first term of (1) for r =1, while the second term adds generality). And as we show below,

as r  0 then (1) approaches a translog function. So the quadratic mean of order r function nests

the commonly used homothetic cases.

       While the special cases of the quadratic mean of order r function have been applied

empirically, it has not been applied in a monopolistic competition setting. To do so, we need to

recognize that demand is positive if and only if prices are less than a reservation price p*, equal

across goods since the expenditure function is symmetric. In the CES case the reservation price

is infinite, but we will focus here on finite reservation prices, while obtaining CES as a limiting
                                                      7

case. Goods that are not available should have their prices in (1) replaced by p*, because that is

the economically relevant price to evaluate expenditure, demand and welfare. To formalize

this, without replacing any prices define    | p  p * as the set of available goods, with

mass N   d   0 . Denote the mass of all possible goods by N   d  N . Then replacing
            

the prices in (1) by p* for    , we rewrite the expenditure function as:

                                                                              2
                er (p)    pr d   ( N  N )( p*)r     pr /2d 
                                                                       
                                                                                                 1/ r
                        2  ( N  N )( p*) r /2  pr /2d   ( N  N )2 ( p*)r                    .
                                                                                   

Differentiating this expression with respect to p*, dividing by ( N  N ) and multiplying by

utility u, we obtain the demand for a good with price p*. Setting this demand equal to zero we

solve for the reservation price:

                                                                                      2/ r
                                       N           
                                                        2/ r
                                                                                 
                                                                      pr /2 d 
                                                                    1
                        p*                                                                .              (2)
                              N  [ N  ( /  )]               N             
                                                                                

       The second term in (2) is a mean of order r/2 of the prices p (also called a power mean),

and for all values of r this mean lies between the minimum and maximum values of p. The

reservation price is above this mean price if and only if the first term in (2) is greater than unity.

To ensure this and also rule out the CES case of an infinite reservation price, we assume:


Assumption 1

   (a) If r < 0 then  > 0,  < 0 and [ N  ( /  )] < 0 ;

   (b) If r > 0 then  < 0,  > 0 and 0 <[ N  ( /  )] < N ;

                          1 2         2
   (c) As r  0 then         and    for any  > 0.
                         N  r         rN
                                                            8

It is readily confirmed that parts (a) and (b) of Assumption 1 ensure that the first term on the

right of (2) exceeds unity, so the reservation price exceeds the mean price. Part (c) is consistent

with (a) and (b) in the sense that either set of inequalities hold for small r so the first term of (2)

is again greater than unity. Furthermore, in this limit it is shown by Diewert (1980, p. 451) and in

the Appendix that the expenditure function in (1) approaches the translog form,

                              1               
                ln e0 (p) 
                              
                              N  ln p d 
                                             2 N      ln p (ln p  ln p ' )dd ' .
        While we have motivated Assumption 1 by the requirement that the reservation price in

(2) exceeds the mean price, we should be more rigorous in checking that the QMOR expenditure

function satisfies the necessary conditions for an expenditure function: that it is positive and non-

decreasing, homogeneous of degree one and concave in prices. Concavity implies that demand

curves slope downwards, which will ensure that the reservation price in (2) exceeds all prices p

for goods with positive demand, and not just the mean price. Confirming that these regularity

conditions hold ensures that the expenditure function can be derived from a well-behaved

homothetic utility function.

        To check these conditions, substitute the reservation price (2) back into (1) to obtain

expenditure defined over the available goods    | p  p * :

                                                                                     1/ r
                                                                            
                                                                                 2
                er (p)    pr d                           p r /2
                                                                            d            .    (3)
                                      N  [ N  ( /  )]                

We can compute demand by setting p '  p for prices in a small interval  '  [ ,    ] ,

differentiate (3) with respect to p, divide by , multiply by utility u and use (2) to obtain:

                                                   r 1            r /2 
                                      p                    p*
                        q (p)   u                1            .                       (4)
                                      er (p )          p          
                                                                       
                                                  9


Note that this expression equals CES demand if we specify  > 0,  = 0 and r = (1–) < 0 for

 > 1, in which case p* and the final bracketed term above vanishes. For p < p* this final

term has the same sign as  under Assumption 1, so demand is positive except when the price is

greater than or equal to the reservation price p*. This guarantees that the expenditure function is

non-decreasing in prices.

       We can eliminate utility u in (4) by using total expenditure     p q (p)d  er (p)u .
Evaluating the integral using (4), we solve for reduced-form expenditure:
                                                                     1/ r
                                          p    p *   
                                                 r          r /2
                                    
                       er (p)  p *          1       d          .                 (5)
                                        p *       
                                                        p


Again, for p < p* the term in square brackets in (5) has the same sign as  under Assumption 1,

so expenditure is positive provided that a non-empty set of goods are purchased. Another

condition that we need to confirm is that the expenditure function is concave in prices. Concavity

implies that demand is downward sloping, and for the symmetric QMOR expenditure function,

the reverse is also true as we show in the Appendix. We directly evaluate the elasticity of

demand by differentiating (4) with respect to p  p * , holding utility u and expenditure er (p )

constant, obtaining:

                                       r  p *         p *  r /2  
                                                   r /2
                       ln q
                           1  r                       1  .                    (6)
                       ln p          2  p           p        
                                          
                                            
                                                         
                                                        0

The final term above approaches zero in the CES case when  0 and r =(1–) < 0, so p* 

and 1– r = . But with  0 under Assumption 1, this term is positive for p  p * and so

  1  r . With r  0 we then obtain   1  r  1  2r  1. For 0  r  2 , the term in curly

brackets in (6) exceeds unity, so that   1  r  2r  1  2r  0 . Summarizing, we have:
                                                  10


Proposition 1
Under Assumption 1, for N > 0 and r < 2 the QMOR expenditure function (3) is globally positive,
non-decreasing, homogeneous of degree one and concave in prices, with a finite reservation price.


       Proposition 1 is the first time that the QMOR expenditure function has been shown to be

globally well-behaved, and the fact that we can establish these properties is made possible by the

assumed symmetry across goods. For values of r > 2, the demand curves in (4) are still down-

ward sloping in a neighborhood of the reservation price, but we cannot guarantee this property

globally. A final property is obtained by differentiating (6) and simplifying, to obtain:

                             
                         ln( p / p*)
                                                                
                                          1  r    1  2r  0 ,


so the elasticity is increasing in price, using the inequalities discussed just before Proposition 1.


Welfare Gains

       Having confirmed that the expenditure function is well-behaved for r < 2, we should

explain how our demand system relates to that used by ACDR and also derive conditions to

ensure welfare gains. Assume for convenience that labor is the only factor of production and

each consumer has one unit, so that income equals the wage, w. Then w  uer (p) , which we can

use in (4) and (5) to obtain the demand shares:

                                                                 p    p *  
                                                                       r         r /2
                 p q (p) d ( p / p*)
        s (p)                        , with d ( p / p*)         1     ,           (7)
                     w         D (p )                            p *    p  


and D(p)   d ( p / p*)d . The term D(p) in the denominator of the share expression ensures
             

that the shares integrate to unity. In comparison, ACDR assume an expression for the demand

shares that depend on the wage, the price p, and also the reservation price p*, but does not
                                                           11


involve any term like D(p) . Nevertheless, the shares integrate to unity because of the presence

of the reservation price. It turns out that the ACDR demand shares and those in (7) have only one

case in common: the translog case, as r 0. The translog demand shares are given by:

                                                 1                 1           
                                      s (p)         ln p      ln p d   .
                                                 N                N           

Setting the demand share equal to zero, we see that the reservation price is:

                                                 1    1
                                      ln p*          ln p d  ,                                                       (8)
                                                N  N

so that the demand share is also expressed as s (p)    ln p  ln p * . Integrating over the set

of products  , we immediately see that the shares integrate to unity without the presence of a

term like D(p) . Indeed, using Assumption 1(c) it can be shown that lim r 0 D(p)  1 in the

translog case.7 ACDR consider a whole family of demand functions with the convenient property

that the shares are defined using the price and the reservation price. All those demand functions

except for the translog correspond to non-homothetic utility functions, while the translog is the

only case in common with our homothetic expenditure function.

          Combining (5) with the definition of D(p) , we see that:

                                                er (p)  p * D(p)1/ r .                                                   (9)

With labor as the only factor of production, and firm profits equal to zero under monopolistic

competition, welfare is u  w / er (p) , so a drop in the expenditure function will indicate welfare

gains. Proposition 1 guarantees that as the price of any good falls from the reservation price, then

welfare rises so increased variety is beneficial for the consumer. Our goal here is to develop



7                                                                 2   ( p * / p )r / 2  1   ln( p * / p ); see the Appendix.
    This is shown from (7), (8), Assumption 1(c), and lim r  0    r                       
                                                            12

more general sufficient conditions for welfare to rise from one equilibria to another. To achieve

this, we need a characterization of the term D.

       Such a characterization is easiest in the translog case, for which:

                                                                 2
                                               p            1
                     ln  D(p)1/ r       ln     d                  s (p)
                 lim                                                                     2
                                                                                             d .
                r 0                    2    p *         2            


The first equality can be shown by taking the limit of ln[ D(p)1/ r ] (see the Appendix), while the

second follows from the translog share s (p)    ln p  ln p * . Combining this result with

the translog reservation price in (8), we find that log expenditure is:

                                         1               1    1
                         ln e0 (p)       ln p d            s (p)2d .
                                       N               N
                                         2  
                                     Pro-competitive &        Product
                                        selection effects                 Herfindahl index
                                                              variety


Thus, expenditure is decomposed into three terms: the first reflects the pro-competitive and

selection effects in lowering average prices; the second reflects the benefits of product variety;

while the third is the Herfindahl index. Having more dispersed expenditure shares will lower the

Herfindahl index and raise expenditure, thereby lowering welfare. That counter-intuitive result is

interpreted by Feenstra and Weinstein (2010) as reflecting “crowding” in product space.

       For other values of r, we can still obtain a type of Herfindahl index by defining the

“adjusted” demand shares:
                                                     s (p)( p * / p )r /2
                                  z (p)                                            .
                                                  s ' (p)( p * / p ' )r /2d '

For the translog case, r = 0, these adjusted shares equal the conventional shares, while for the

quadratic case, r = 2, these adjusted demand shares equal the quantity share of each product.

Then defining the Herfindahl index, H   z (p)2 d , it is shown in the Appendix that,
                                                     
                                                            13

                                                            1/ r                        1/ r
                                                                  
                        D(p)1/ r     N     1   N    H  ,
                                                                                                      (10)
                                        
                                                          
                                                           
                                                           
                                          constant>0                         in H

where the final term is decreasing in the Herfindahl index H (since [ N  ( /  )] has the same

sign as r, from Assumption 1).

        Recall that expenditure is er (p)  p * D(p)1/ r , from (9). As the reservation price falls,

then so does expenditure and welfare rises. But that gain is offset if the Herfindahl index also

falls. In the trade environments we shall consider, that result will be likely whenever variety

increases: while there is not a one-to-one correspondence between changes in the mass of

products N and the Herfindahl, in all cases that we examine an increase in N implies a lower

Herfindahl, which in turn implies an increase in D(p)1/ r . It follows that if expenditure falls, then

it falls by less than the reduction in the reservation price. The question is whether we achieve

some bound to this offsetting effect on welfare due to crowding in product space. That question

is answered in the affirmative, as shown by the following decomposition of expenditure:

Lemma 1
Under Assumption 1, the cost of living can be decomposed alternatively as:

                                              1/ r                               1/ r
                                                     
                er (p)  p *    N          1   N    H 
                                                   
                             
                                 constant>0                         in H
                                                     1/ r                                 1/ r
                                                                                                      (11)
                                                                            
                            p *    N                           r /2
                                                              s (p) p d                    .
                                                                          
                                               
                                     constant>0                        in prices p

Sufficient conditions for a fall in the cost of living and rise in welfare are that: (i) the reservation
price falls; and (ii) the Herfindahl index does not fall or the weighted-average price term on the
second line does not rise.
                                                         14

         The first line of (11), obtained by substituting (10) into (9), has already been discussed.

It shows that if the reservation price is falling, but the Herfindahl index is also falling due to an

increase in variety, then the decline in the cost of living (and increase in welfare) will be less

than that in p*. We have referred to this outcome as a crowding effect. Now suppose that the

Herfindahl falls when comparing two equilibria, which will tend to increase the cost of living,

but that the reservation price also falls. Can we easily determine whether welfare rises or falls?

The second line of (11) gives an affirmative answer. Regardless of the change in the Herfindahl,

the cost of living falls and welfare rises if – along with the fall in the reservation price – the

share-weighted mean of order –r/2 shown on the second line does not rise. If the share-weighted

mean of prices is falling, then it follows that the decline in the cost of living and increase in
welfare exceeds the fall in        p * . So under these conditions, the changes in p* and              p*
effectively become bounds for the change in the cost of living.

         In the next section we shall further decompose the reservation price into terms reflecting

(i) product variety, (ii) the markups charged by firms, and (iii) an average of firm costs. The

latter will reflect selection across firms. Using this decomposition in (11), we will obtain a

decomposition of the cost of living into the three potential sources of gains from trade, together

with an additional term (either the Herfindahl index or the share-weighted average of prices) that

essentially combines all of these effects.8


3. Autarky Equilibrium

         We have already assumed that labor is the only factor of production, and now we

normalize the wage at unity. As in Melitz (2003), we assume that firms receive a random draw of

productivity denoted by  , so marginal costs are a /  , where a is the labor need per unit of

8
  Substituting the reservation price from (2) into (11), we obtain a further decomposition of expenditure into terms
reflecting an exact price index similar to that in Diewert (1976), and changes in variety. See the Appendix.
                                                         15


output for a firm with the lowest productivity of   1. We will allow the Pareto distribution of

productivity to have either an upper-bound in its support, as in Helpman, Melitz and Rubenstein

(2008), or to be unbounded above:

Assumption 2
(a) The productivity distribution is Pareto, G ( )  (1    ) / (1  b ) , 1    b, where
the upper bound is b  (1, ] and  > max{0, –r};
(b) There is a sunk cost F of obtaining a productivity draw, but no fixed cost of production.


In part (a), we allow the Pareto distribution to be unbounded (b = ) or bounded (b < ). The

restriction that  > max{0,– r} becomes  > ( – 1) > 0 in the CES case, which is needed for

certain first moments to converge in that case; this restriction is needed here for the same reason.

The assumption that there is no fixed cost of production in (b) is made for convenience and

follows Melitz and Ottaviano (2008).

         The optimal price for a firm with productivity  is p  ( a /  ) / (  1) . We follow

ACDR and let   p / ( a /  ) denote the ratio of price to marginal cost, while v  p * /(a /  )

denotes the ratio of the reservation price to marginal cost. From (6), the elasticity  ( p / p*) is a

function of the price relative to the reservation price, so  (  / v ) and using this notation the

markup of the firm is written as:

                                ( / v)             r /2
                                                                 1                    1
                                                             r (   1)  1  ,
                               (  / v )  1  v             2                   2

where the second expression follows from (6) and is used to solve for  ( v ) .9 Differentiating this

expression, it is shown in the Appendix that elasticity of the markup is 0  v  '( v ) /   1 , so that

9
  The left side of the second expression can be evaluated at  =1 and  = v to show that it is above and below ½, so
that a solution   (1, v) where it equals ½ always exists.
                                                         16

changes in marginal cost are only partially passed-through to prices.

       We can now write the equilibrium conditions in autarky. A firm paying the sunk cost of F

receives a draw of productivity  with probability g ( )  G '( ). We make a change of variables

from  to v. Since v  p * /(a /  ) then   av / p * , so using the Pareto distribution:

                                                                          
                               1           v  1  p *      p*
                g ( )d               d                  dv      g ( v )dv .        (12)
                             1  b           1  b    a        a 


This change of variables – suggested by ACDR – will considerably simplify our expressions.

Because there are no fixed costs of production, the lowest-productivity firm that will continue

production will have marginal costs equal to the reservation price, so v = 1 is the lower bound.

The upper bound for v, denoted by v*, is obtained when productivity is b  av / p * , so that:

                                            v*  bp * / a.

       Starting with the demand share d / D(p) from (7), we multiply that by expenditure L to

obtain total demand, and then by ( – 1)/ to obtain profits. Using the bounds v  [1, v*], the

expected profit from entering the market must equal the sunk costs of F in equilibrium, so that:

                      v*                                           
                       (v )  1   (v )   L   p * 
                F             d  v   D(p)   a  g ( v )dv
                   1     ( v )                    
                       v*                                  
                           (v )  1   (v )   p * 
                      L            d  v  a  g ( v )dv                                 (13)
                             ( v )                
                      1
                              v*                     
                                                                       ,
                                     (v )   p * 
                            Ne  d         g ( v )dv
                               1
                                    v   a 

where in the second line we substitute the expression for D(p)   d ( p / p*)d . Rather than
                                                                           

using the general notation  for the set of available products, with the change in variables in (12)

we are now defining that set by the bounds for v and the mass of entering firms N e . The mass of
                                                        17

firms remaining after those with lowest productivity exit will be:

                                   v*                                
                                    p*                  p*
                          N  Ne      g ( v )dv  N e     G ( v*) ,                       (14)
                                 1  a                   a 

which also equals Ne[1 – G(a/p*)], where (a/p*) is the productivity of the firm with marginal

cost (a/) just equal to the reservation price. So as usual in the Melitz model, the mass of

surviving firms N equals the mass of entering firms times the probability of survival, and this

probability is equivalently written as [1 – G(a/p*)] = ( p * / a ) G ( v*) .

        We have already used the condition that expenditure equals the workforce L, so that full-

employment holds. The remaining equilibrium condition is obtained from the reservation price in

(2), re-written slightly by dividing by p* and using the Pareto distribution from (12):

                                        v*   ( v )  r /2  p *             
                       
                 N  [ N  ( /  )]   N e                                   .
                                                                  g ( v ) dv
                                                                                 
                                                                                               (15)
                                            1  v           a                

The solution to the equilibrium conditions (13)-(15) is summarized in the following result:

Proposition 2
Under Assumptions 1 and 2: (a) the autarky equilibrium conditions (13)-(15) have a positive
solution for p*, Ne and N; (b) if and only if b = , the solution for Ne is proportional to the
country size L, while the solution for N is independent of country size L.


        The existence result in (a) relies on  > max{0, –r} in Assumption 2, so that the integrals

in (13) and (15) remain bounded even for v*. The results in part (b), when productivity is

unbounded, are obtained by inspection of the equilibrium conditions. In that case the upper-limit

of integration in (13) is infinite, so the two integrals are constant and (13) becomes

F  1L / N e . It is immediate that the mass of entrants is proportional to country size in this
                                                      18

case. This result is also obtained by ACDR, and follows from the “proportionality relation”

between expected profits from entering the market and expected revenue. While these two

variables are proportional for every firm in the CES case (i.e. regardless of productivity), they

are proportional in expected terms for the general demand system that we or ACDR adopt,

provided that the Pareto distribution is unbounded above and there are no fixed costs of

production. Those two assumptions ensure that the upper (v = ) and lower (v =1) limits of

integration in (13) are exogenous.

       Part (b) gives a second implication of unbounded productivity that is less well known

than the linear relationship between entry and country size, and concerns the mass N of surviving

firms. Substituting (14) into (15), the equilibrium condition for the reservation price becomes:


                                             v*   ( v )  r /2  g ( v ) 
                         N       N                1            dv  ,        (16)
                                                          
                                             1                   
                                                        v               G ( v*)
                                                                                   

which equals a positive constant on the left, from Assumption 1. For b =  and v*  bp * / a  ,

it follows that (16) solves uniquely for N, independent of p* and country size L. This surprising

result is also found by Arkolakis, Costinot and Rodriguez-Clare (2010) for the translog case, and

ACDR for their more general demand function. A related result has been shown by Baldwin and

Forslid (2010), who consider the Helpman, Melitz and Rubenstein (2008) model with CES

preferences and a bounded Pareto distribution for firm costs. They show that a reduction in

variable trade costs has no effect on the variety of products consumed when the fixed costs of

exporting and domestic production are equal: new import varieties reduce domestic varieties

one-for-one in that case. In contrast, we have excluded the CES case in Assumption 1 and also

exclude fixed costs, and find that product variety is independent of country size if and only if the

Pareto distribution is unbounded, b = . This finding will have strong implications for the
                                                             19

sources of gains from trade, examined in the following section.

        Before turning to that discussion, we use the firm-level structure introduced in this

section to further decompose the cost of living. The reservation price in Lemma 1 can be written

as the product of terms that reflect the average of firm markups and costs, as follows:


Lemma 2

The reservation price in the closed economy is:
                                    2/ r  v *                     2/ r v*                      2/ r
                                                     g( v )                     g (v ) 
                                                                                r /2
                   N                                                      p*
    p*  
                                          (v ) r /2
                                                            dv                      dv    ,          (17)
            N  [ N  ( /  )] 
                                 1        G ( v*) 
                                                    1  v  G ( v*) 
                                                                      
                                                                                
                in variety N                    Average markup              Average of costs

                                                                                      ( v*)  v* g( v )dv .
where g( v )  g ( v ) / v r /2 is an “adjusted” density function with distribution G                1




The first term appearing on the right of (17) is the same variety term appearing in (2). The

second term is a mean of order r/2 of the markups  ( v ) . To interpret the last term, recall that

v  p * /( a /  ) is the ratio of the reservation price to marginal cost, so p * / v  a /  is the

marginal cost of a firm with productivity  . The last term in (17) is therefore a mean of order r/2

of the marginal cost of firms. If all three terms in Lemma 2 fall and also the share-weighted price

term in Lemma 1 does not rise, then we are assured of a welfare gain. We now examine trade

environments allowing for such welfare gains.


4. Frictionless Trade

        We initially consider frictionless trade, where in addition to the assumption of no fixed

costs of production or export, we also ignore variable costs of trade (while introducing such trade

costs in the next section). We suppose that the expenditure function in (1) along with

Assumptions 1 and 2 holds across countries. In this environment, moving from autarky to
                                                        20

frictionless trade is equivalent to growth in the labor force L. We have already shown in

Proposition 2 that with an unbounded Pareto distribution, product variety N does not change but

Ne rises in proportion to L. It follows that the probability of survival is falling, so there is a

positive selection effect: only firms with productivity above a higher cutoff level produce in the

larger market, while smaller firms are crowded out. Furthermore, this selection effect is the only

source of welfare gain in the larger market: variety N is independent of L and it will follow that

the Herfindahl index in (11) does not change; the average markup in (17) does not change

because the upper-limit of integration is v *  p*b/a   as b  ; and it follows from Lemmas

1 and 2 that only the fall in firms’ costs changes the reservation price and welfare.

        When productivity is bounded, however, then we shall find that all three sources of gains

from country growth operate: variety increases, the average markup falls, and there is a positive

selection effect. To show this, we perform the comparative statics on (13)-(15). Differentiating

(14)-(15) and simplifying, we obtain:

                                                         Ne          b           ( v*)  r /2 
         d ln N e   (1  A)d ln p*,       A                                 1        ,
                                                  [ N  ( /  )]  1  b         v *       

where v * = p*b/a. Re-express (13) by moving the denominator D(p) to the left, obtaining:

                      v*
                           (v )  1             ( v )   p * 
                 0       (v )  L  FN e d 
                                                     v
                                                             
                                                               a
                                                                      g ( v )dv.
                                                                     
                      1


Totally differentiating this condition, and substituting for d ln N e from above, we obtain:

                             1 A                                            d ln L
                 d ln N e            d ln L        and      d ln p*                   ,               (18)
                            1 A  B                                      1  A  B 

           L   ( v*)  1        d [  ( v*) / v*]b
where B                    N e                 
                                                          .
           F   ( v*)            D(p)(1  b )
                                                      21

        To give the intuition for these results, consider the free entry condition (13). The markups

appearing in the numerator of this expression are increasing as the reservation price rises or

marginal cost falls,  '( v )  0 , and likewise for the Lerner index [  ( v )  1] /  ( v ). The rising

markup follows from the fact that the demand elasticity is increasing in price, as noted earlier. So

as the reservation price falls, the expected markup in the numerator of (13) falls relative to the

integral in the denominator. It follows that Ne rises less than proportionately with L. That is

shown in the first result in (18), where A > 0 for b <  from Assumption 1, while B > 0 for b < 

because the Lerner index takes on its highest value at the upper bound v*, so that:


                   L   ( v*)  1  L
                                         v*
                                             (v )  1  
                                                               d     g (v)  dv  N
                                                                      (v)

                                          ( v )   v*
                                                                       v
                                                                                       e.
                   F   ( v*)  F       1                 1 d     g (v ')dv ' 
                                                                     ( v ')
                                                                      v'


The inequality states that the highest Lerner index exceeds its average, and then the equality

follows directly from the free entry condition (13) and ensures that B > 0 for b < .

         When productivity is unbounded and b  , then A, B  0, and so in that case we have

d ln N e  d ln L , as asserted in Proposition 2(b). For unbounded productivity we also have that

the reservation price changes by d ln p*   d ln L /  in (18) and, as discussed above, this change

is purely due to the drop in the average of firm costs, i.e. the self-selection of more efficient

firms in the larger market.

        When productivity is bounded, however, then the reservation price falls by less than

d ln L /  , as shown by (18) with A, B > 0 . That means that the increased selection of firms is

offset. We conclude that country growth has two opposing effects on product variety N: entry of

firms Ne rises less than proportionately with L; but also the reservation price falls by less, so the

increased selection is offset. It turns out that this second effect dominates so that product variety
                                                 22

N rises with L. This result can be seen from the equilibrium condition for the reservation price in

(16), where the left side is constant while the integral on the right is a weighted average of terms

that are increasing in v, so the integral is too (as shown in the Appendix). It follows with b   ,

a fall in v*  bp * / a is associated with a rise in N. These various results are summarized as:


Proposition 3
Under Assumptions 1 and 2, an increase in country size L under frictionless trade leads to:
(a) when b = , then p* falls only due to the drop in the average of firm costs, with the
Herfindahl index H fixed; (b) when b < , then variety N rises, the Herfindahl falls, and the
average of firm costs, markups and the weighted-average price term in (11) all fall; (c) the
proportional welfare gain when b <  is less than that with b = .


       Part (a), with an unbounded Pareto distribution, has already been discussed above and the

constant Herfindahl is shown in the Appendix. The rise in product variety with bounded Pareto,

in part (b), has also been motivated by the comparative statics above and the falling Herfindahl is

shown in the Appendix. The fact that the average of firm costs and markups both fall follows

quite easily from those terms in (17): as the reservation price falls then so does v*  p*b/a, and

so we are excluding the highest markup term  ( v*) in (17); but because p* appears explicitly

within the integral of costs, we are also reducing the average of firm costs, as confirmed in the

Appendix. The hardest piece to prove is that the share-weighted mean price term appearing in

(11) also falls as country size increases, which together with the drop in the reservation price,

ensures that the representative consumer gains in the larger country.

       Part (c) shows that despite the fact that all three sources of gains from trade operate in the

bounded Pareto case, the total proportional gains from trade are smaller with bounded than with

unbounded Pareto. This result follows from our welfare decomposition in Lemma 1 and the
                                                   23


comparative statics above. With b = , we found that d ln p*   d ln L /  and the Herfindahl

index is fixed, so it follows immediately from the first line of (11) that the increase in welfare is

d ln L /  . But with b < , we found above that d ln p*   d ln L /  , and we also confirm in the

Appendix that the Herfindahl index is falling as variety increases. For both reasons, if follows

that the frictionless trade leads to an increase in welfare that is less than d ln L /  , obtained in

the unbounded case.

        The result in part (c) is related to that in Melitz and Redding (2013), who focus on the

CES case only. They show that, provided there are fixed costs of exporting, then the gains from

trade with heterogeneous firms exceed that with homogeneous firms as in the Krugman (1980)

model. Homogeneous firms are an extreme case of bounded Pareto where there is a mass point at

a single productivity. So Melitz and Redding (2013) are comparing any productivity distribution

for heterogeneous firms (including bounded or unbounded Pareto) with a degenerate distribution

with a single mass point. In comparison, we find that even without fixed costs of trade, the gains

from frictionless trade with unbounded Pareto exceed those with bounded Pareto for the QMOR

class of preferences. So we are comparing the unbounded Pareto case to any bounded Pareto (but

not including the degenerate case b = 1, ruled out in Assumption 2).

        With this difference in our comparisons understood, the spirit of our results are similar:

having a greater spread of productivities leads to higher proportional gains from trade. That is an

especially surprising result in our context because by restricting the range of productivities we

give scope for additional sources of gains from trade – due to product variety and reduced

markups – that do not operate with the unbounded Pareto distribution. We have found with

unbounded Pareto that these additional sources of gains necessarily reduces the self-selection of

more efficient firms, so that the total proportional gains are lower.
                                                   24

        This result can be usefully compared to the formula for welfare gains found by ACDR,

which emphasizes the share of total consumption purchased from the domestic market. Denoting

that fraction by , the domestic labor force by L , and the world labor force by L  L , then  =1

in autarky and  = L / L with frictionless trade. With growth it follows that d ln    d ln L  0.

Applying our result above that the welfare gain is  d ln p*  d ln L /  with unbounded Pareto,

but smaller with bounded Pareto, we have therefore proved:


Corollary 1
The gain from frictionless trade equals  d ln  /   0 with an unbounded Pareto distribution, but
is strictly less than this amount with a bounded Pareto distribution for productivity.


Our calculation of the gains from trade goes beyond ACDR by allowing for changes in product

variety and markups under a bounded Pareto distribution, even though it is their own formula

(obtained with unbounded Pareto) that becomes the upper bound.


5. Variable Trade Costs

        We now allow for variable costs of trade, but for simplicity, will suppose that the trading

                                        2 denote the number of (identical) countries in the
countries are symmetric. We shall let C

world, but due to trade costs, each country does not necessarily trade with all others. We number

countries by their proximity to an exporter, so c = 1 denotes the local market, c = 2 denotes the

next closest market, etc. In equilibrium we allow for trade with whole countries or a fraction of a

country, as explained below. We shall assume the following structure of trade costs:

Assumption 3

Numbering countries by their proximity to an exporter, delivering one unit to country c means
                                                                             .
that  (c )   0c   1 units must be sent, with  0  1,   0 and 1  c  C
                                                 25


These costs apply onto to cross-border trade, while local sales (c = 1) have   1. Notice that

number of countries c that a nation is trading with plays the same role in Assumption 3 as

distance does in an empirical specification of variable transport costs, while 0 plays the same

role as a “border effect,” i.e. the extra amount that must be sent regardless of distance. We can

briefly provide a micro-structure that justifies the trade costs described in Assumption 3.

                                                                                2 , with the
       Suppose that countries are located evenly on a circle of circumference C

capital city at the center of each country. By construction, the capitals are distance ½ from each

                                                             4. We assume that imported
border, as shown in Figure 1 for a circle of circumference C

goods must reach the capital city (e.g. an airport) before being costlessly dispersed throughout

the country. Then letting dist denote the distance a good travels to reach the border of an



                                                      =4
                                      Circumference = C                   indicates a border



                Trading edge                                         Capital in country 1
                in country 3                           1/2
                                      distance

                                                               1/2




                                                          distance

               No trade
               with country 4                                         Trading edge
                                                                      in country 2




                       Figure 1: Geography of Trade with Four Countries
                                                      26

importing country, the good travels (½+dist) to reach the capital city. We assume that the
                                             
variable trade costs are    0 ½  dist  . Since goods can enter from the border on either side,

if dist = 1 then the importer is trading with (c  1)  2 countries (not counting itself), while if dist

= 2 then the importer is trading with (c  1)  4 countries (not counting itself). Trade with a

fraction of a country is also allowed, as illustrated Figure 1 where country 1 is trading with a

fraction of countries 2 and 3 up to the “trading edge.” In general we solve for (c  1)  2dist so

that dist  (c  1) / 2 . Substituting this into the formula for trade costs we obtain:

                                                 
                         (c )   0 ½  dist    0 [½  (c  1) / 2]   0 2  c  .

Absorbing 2  into the border costs  0 , we obtain Assumption 3.


Equilibrium Conditions

        With Assumption 3, we can readily solve for the number C of countries that each nation

trades with in the symmetric equilibrium. The most efficient firm in any country has marginal

labor costs of a/b to produce one unit of output. Normalizing the wage at unity in every country,

in equilibrium the marginal cost of producing enough to deliver one unit to the most distant

country C will just equal the reservation price in that country:


                                       b                    .
                                  0C  a  p * , for 1  C  C                                 (19)


This equilibrium condition provides a very simple relation between the border effect 0 and the

equilibrium number of trading partners. Of course, changes in the trade costs 0 will also affect

the reservation price in (19), so we will need to specify all the equilibrium conditions to account

for the endogenous response of both C and p*. Note that if the trade cost 0 are sufficiently close
                                                           
                                                    ( a / b)  p*, then the most efficient firm from
to unity and  is close enough to zero to have  0 C
                                                .
each country sells to every market, so that C  C
                                                        27

        To write the other equilibrium conditions with trade, we revisit the change in variables

introduced for the autarky economy. When a firm is selling to a foreign country, we let

v  p * /( a /  ) denote the ratio of the reservation price to the marginal costs inclusive of the

variable trade costs. It follows that    av / p * , so that from (12):

                                                                           
                               1           v  1  p *        p*
                g ( )d               d                    dv       g ( v )dv .        (20)
                             1  b           1  b  a           a 

From the final expression in (20), we see that higher trade costs  implies a lower density of

firms in any interval dv, which shows how the trade costs affect the extensive margin of

exporting firms. But in contrast to the unbounded Pareto case, trade costs now also affect the

intensive margin of exporters, and of the highest-productivity exporter in particular.

        The upper bound for v when selling to the domestic market is still denoted by v*  bp * / a,

and the upper bound when selling to a foreign country c is:

                                           v * / (c )  bp * / a (c ) .                       (21)

With unbounded productivity, b  , the ratio of reservation price to marginal costs for foreign

firms – inclusive of the variable trade costs – is in the range [1,+), the same as for home firms.

So there is no difference in the distribution of marginal costs and prices charged by home and

foreign firms: both countries have firms with essentially zero costs, charging an infinite markup,

and firms with marginal costs equal to the reservation price, with zero markup. But with bounded

productivity, we see from (21) that the ratio of the reservation price to marginal costs is in the

range v/ [1, bp * / a ), which depends on the reservation price and trade costs. Now the price

of the highest productivity firm is affected by trade costs, and we refer to this as an impact on the

intensive margin of the highest productivity firm.
                                                                        28

         We continue to let N denote the total mass of products available to the representative

consumer in each country, so this notation from section 2 stands. But in section 3, dealing with

the autarky economy, we previously let Ne denote the mass of entering firms, while N was the

mass of surviving firms. With trade we need to introduce a new notation for the mass of firms in

a single country, so we now let Me denote the mass of entering firms in a single country, and M

denote the mass of surviving firms. These are related by the equilibrium condition (14), re-

written using this new notation as,

                                          v*                                           
                                        p*                  p*
                              M  Me      g ( v )dv  M e     G ( v*).                                            (22)
                                     1  a                   a 

Conditional on selling at home, the probability of firms in the interval dv selling to country c is

then obtained by dividing (20) by the final terms in (22):

                                        [ p * / a (c )] g ( v )               (c ) g ( v )
                                                                        dv                       dv .
                                          ( p * / a ) G ( v*)                     G ( v*)

         The total mass of products N available within a country is obtained by starting with the

mass M available in each country, and then integrating over the conditional density above:

                           C         v */ ( c )                           
                                                      (c ) g ( v )
                    N  M 1                                         dvdc 
                            1            1
                                                        G ( v*)               
                                                                                                                       (23)
                                          C (1  )  (C  1)( v*)                 
                         M 1   0               
                                                                                       ,
                                        1  ( v*)     1  ( v*)                 

where C (1  )  (C1   1) / (1   ) is the Box-Cox transformation of C.10 We see from (23)

that trade costs have a direct negative effect on the mass of products available in a country

through  0 , and also an indirect effect through the reservation price; both of these channels


10
  The result in (23) is obtained by first integrating over v, obtaining  ( c ) G[ v*/ ( c )]/ G ( v*) ; then using the
Pareto distribution and trade costs in Assumptions 2 and 3; and then integrating over trading partners c.
                                                          29

reflect the extensive margin of exporting firms, using the conditional density above. In addition,

changes in trade costs have two further effects: through changing the range of countries C that

are exporting to each destination; and through changing the mass of domestic products M.

       While we will need to take into account all these effects, for the moment just concentrate

on the direct impact of trade costs on the mass of exporting firms and countries, holding fixed the

mass of domestic products M and also p*. The effect of changing trade costs on the number of

trading partners C can be obtained quite easily from the equilibrium condition (19). Using that

condition to solve for C, substituting the result into (23), and differentiating with respect to trade

costs while holding M and p* fixed, we can obtain:

                        d ln N                   MC  C (1  ) ( v*) 
                                                                   .
                        d ln 0   M , p*
                                                  N  [1  ( v*) ] 

This expression shows the partial effect of declining trade costs on expanding the range of

available products, through the extensive margin of exporting firms and countries. The result is

increasing in the number of trading partners C, because C (1  ) is increasing in C regardless of

the sign of 1– . In other words, the greatest impact of reducing trade costs on product variety

                                                                     ) , so the gain in variety
comes when a country is already trading with the most partners (C  C

comes exclusively from expanding the extensive margin of exporting firms rather than by

expanding the range of exporting countries.

       Returning to the full equilibrium conditions, they are (19) for the number of trading

partners, (22) for the mass of domestically produced goods, and (23) for the mass of products

available to consumers. We still need the free entry condition analogous to (13) in the closed

economy, which is now written as:
                                                                   30


                                         LJ    ( v ) 1  d   ( v )  
                                                                  
                                                ( v )   v  
                                      F                                        ,                                  (24)
                                            M e J   d   ( v )  
                                                        v 

                            v*                
                                                              C v */ ( c )                   
                                                                                            
with,           J[ f ]        f ( v )  pa*  g ( v )dv  
                                                                           f ( v )  ap(*c )  g ( v )dvdc .
                                                                                            
                                                                                                                   (25)
                            
                            1  
                                                             
                                                              1 1
                                  domestic market                             export markets


To move from the free entry condition in the closed economy to the open economy in (24), we

have added the integrals over trading partners so that expected profits are computed over

domestic sales plus exports. We have introduced the notation J  [ f ] as a functional depending on

 , from the trade costs, that integrates any function f(v) over the densities of firms selling in the

domestic and all export markets. In each case, we use the density of these firms given by (12)

and (20), including the terms (p*/a) and (p*/a(c)) appearing in these densities, reflecting the

probability of selling domestically or exporting. Because these probabilities determine the mass

of firms, they influence the extensive margin. The similar terms v*  bp*/a and (v*/0) also

appear in (25) in the upper limits of integration, where they influence the intensive margin of the

highest-productivity firm selling at home and also exporting.

        A final equilibrium condition is needed to solve for the reservation price, analogous to

(15), and rewritten by adding the integral over trading partners:

                                                                       ( v )  r / 2 
                                      N   N           M e J   v   .                                 (26)
                                                                                     

The complete set of equilibrium conditions are (19) and (22)–(26).

        Before considering changes in trade costs, we also need to generalize Lemma 2 and

define the average of firm costs and markups in the open economy, as follows:
                                                                   31

Lemma 3

The reservation price in the open economy is:
                                                                                                             2/ r
                                                                               2/ r       p* r / 2  
                                                  J   ( v )     r /2                 J  
                                                                                          v   
                                          2/ r
                         N                                 
         p*                                                                                                  ,       (27)
                 N  [ N  ( /  )] 
                                            J  1
                                                       
                                                                                      J  1 
                         
                     in variety N                                     
                                                  Average markup
                                                                                       Average of costs

                                                                                      ( v*)  v* g( v )dv ,
where g( v )  g ( v ) / v r /2 is an “adjusted” density function with distribution G                                 1

and J  f  is defined as in (25) but using this density g( v ) .


The first term on the right of (27) is identical to that in (17), where we continue to let N   d
                                                                                                                             

denote the mass of products available to consumers in any country. The set  now includes both

domestic goods and imported products, and the integrals over these goods are taken using the

functionals J   f  and J  f  . The interpretation of the two other terms on the right is very

similar to what we had in the closed economy. The second term is the average over domestic and

foreign firms of their price-cost ratios  ( v ) . Recalling that v denotes the ratio of the reservation

price to a firm’s marginal cost, then p*/v is the firm’s marginal cost and the third term is the

average over all domestic and foreign firms of their marginal costs.


Change in Trade Costs

        It is useful to start with the share of expenditure coming from domestic production, or .

Integrating over the demand shares in (17), we obtain in the symmetric equilibrium:


                                                           
                                                  v*
                                                             ( v )  p* 
                                          Me  d                             g ( v )dv
                                                              v       a 
                                                1
                                                                                            .                               (28)
                                                      M e J   d   ( v )  
                                                                 v 
                                                                      32

Of course, the mass of entering firms cancels in the numerator and denominator. The change in

this share due to a change in trade costs is greatly simplified if the functional in the denominator

is constant. In fact, there are two cases where that results holds:


Lemma 4

The functional J   f  is not affected by a change in trade costs if: (i) productivity is unbounded

or product is bounded and the derivative is calculated at the frictionless equilibrium; and (ii) the

change in the reservation price is d ln p*  (1   )d ln 0 .


        To establish this result, consider first the case where productivity is unbounded. The
                                                                                              ,
upper limits of integration in (25) for v are , and the mass of trading partners becomes C  C

because some firm is efficient enough to export to every country. So (25) simplifies to:

                                               C                                  
                                                                                                             (1  )  ,
                                      g ( v )dv 1    (c ) dc    f ( v )  pa*  g ( v )dv 1   0 C
   J[ f ]    f   ( v )  pa* 
                                               1               1                             
                                                                                                                               (29)
               1                                                
                                                                                                        Inverse of 


where the final term is obtained by completing the integral over trade costs. That final term also

measures the ratio of total product variety available in each country to the domestic varieties

available, since from (23):

                                                           (1  )
                                  N  M 1   0 C
                                                    ,                     as v*  .                                         (30)
                                        
                                                   Inverse of 


As we have already noted, with unbounded productivity there is no difference between the home

and foreign firms on the intensive margin (their range of prices and markups is the same), but

only on the extensive margin (reflecting the mass of home and foreign firms). It follows that the

share of consumption purchased from home firms is simply  = M/N, which equals the inverse

of the bracketed term in (29) and (30), as indicated.
                                                           33

         It is now a straightforward matter to differentiate (29) to obtain:

                                           C   (1  ) 
         d ln J  [ f ]   d ln p *      0                  d ln 0  0  d ln p*  (1   )d ln 0 .
                                                     (1  ) 
                                        1   0 C
                                         
                                                (1  )


Thus, this functional is constant if d ln p*  (1   )d ln 0 . To interpret this result, a drop in trade

costs lowers the reservation price, which reduce the value of the functional (over sales, markups,

or any other function f ) in the domestic market. But since d ln p*  d ln 0 , then exporters face

enhanced opportunities abroad since the drop in their trade costs exceeds the fall in the foreign

reservation prices. These two effects both operate on the extensive margin (reflecting the

probability of being a domestic firm or exporter in a range dv), and just cancel.

         Surprisingly, we obtain the same result when we allow for bounded productivity and

introduce an intensive margin, provided that we evaluate the change in the functional around the

frictionless equilibrium with 0 = 1 and  = 0. Because we are evaluating derivatives with respect

to trade costs 0, it is mathematically correct to evaluate the equilibrium conditions at  = 0,

totally differentiate with respect to 0, and then evaluate at 0 = 1. This technique simplifies the

analysis considerably. In particular, at the frictionless equilibrium, any exporting firm will sell to

                                                                           ( a / b)  p * . 11 Except in
all countries so the equilibrium condition (19) will hold instead as  0 C

                            ( a / b)  p * , the strict inequality  C
the knife-edge case where C                                               ( a / b)  p * will continue
                                                                      0


to hold for 0 in a neighborhood of unity. Therefore, for  = 0 we can again hold the number of

                              even as we change the trade costs slightly.
trading partner fixed at C  C


11                                      
                                         ( a / b)  p*, then the most efficient firm from each country sells to every
   As discussed just after (19), if  0 C
                    .
market, so that C  C
                                                                        34

                                     , the functional becomes:
       Evaluated with  = 0 and C  C

                                v*                                               v*/ 0                  
                                                       
                                                                          1)                         
                 J 0[ f ]          f   ( v )  pa* 
                                                 
                                                           g ( v )dv  (C                f ( v )  ap*  g ( v )dv.
                                                                                                   0   
                                                                                                                        (33)
                                1                                                  1


We can readily compute the impact of a change around the frictionless equilibrium, as follows:

        J 0 [ f ]              v*                                                         
                            
                           C   f ( v )  pa*  g ( v )dv  f ( v*)  pa*  g ( v*)v * ,
         ln p *                                                       
                     0 1
                               1                                                           

        J 0 [ f ]                    v*                                                         
                           (
                              C  1)   f ( v )  pa*  g ( v )dv  f ( v*)  pa*  g ( v*)v * .
         ln 0                      1
                                                                               
                                                                                                    
                     0 1


The first term within the brackets reflects the change in the extensive margin, while the second

term reflects the change in the intensive margin. The total change in the functional is constant if:

        J 0 [ f ]                          J 0 [ f ]                                   C  1
                            d ln p *                            d ln 0  0  d ln p*          d ln 0 .
                                                                                             
                                                                                                                        (34)
         ln p *                            ln 0                                        
                                                                                            C
                     0 1                                   0 1                          
                                                                                                        (1  )


       This result shows that the import competition created by the fall in trade costs and the

reservation price is just offset by the export opportunities created, so that the functional is

constant, when (34) holds. This is the same formula for the price change result that we found

above, for unbounded productivity, when evaluating the effect of trade costs on the extensive

margin only. Now we see that this result also holds when incorporating the intensive margin and

when evaluated at the frictionless equilibrium. In that case, the share of expenditure  is simply

   , so that the change in the reservation price in (34) is once again d ln p*  (1   )d ln , as
1/ C                                                                                           0


we found with the unbounded Pareto.

       We now argue that the change in the reservation price of d ln p*  (1   )d ln 0 is in fact

the equilibrium change. This result follows because the various functionals appearing in the
                                                         35

equilibrium conditions are all (locally) constant. In the free entry condition (24), for example, the

functionals evaluate expected profits, and since these are constant it follows that the mass of

entrants in each country, Me, is constant in the denominator.12 Then from the equilibrium

condition (26), it is immediate that product variety N is constant. Furthermore, since the

denominator of (24) is the term D(p) introduced earlier, it is constant and then so is the

Herfindahl index. We confirm in the Appendix that these various results are enough to ensure

that the change in prices d ln p*  (1   )d ln 0 is the equilibrium change. Finally, because the

Herfindahl index does not change, it follows from Lemma 1 the change in welfare equals

 d ln p*  (1   )d ln 0 . We summarize these results with:


Proposition 4
Under Assumptions 1–3, a small reduction in trade costs implies the following results whether
productivity is unbounded or is bounded with the change evaluated at the frictionless equilibrium:
(a) no change in the mass of entrants Me, the mass of varieties N, or the Herfindahl index H;
(b) the same proportionate fall in the reservation price and rise in welfare of (1   )d ln 0 ,
which is due only to the selection of firms.


         The final result in Proposition 4 – that only the selection effect operates around the

frictionless trade equilibrium – follows because the functionals defining the average markup in

Lemma 3 are locally constant so there is no change in the average markup. To interpret this

result, a drop in trade costs lowers the reservation price and therefore lowers the markups

charged by home firms, while the lowest-productivity firms exit. But since d ln p*  d ln 0 , then



12
  That result may appear surprising in view of Proposition 2, which stated that country growth leads to more
entrants. But the worldwide mass of entrants that are potentially exporting to each country is still growing. We could
define that worldwide mass as Ne, computed as in (23) but with Me on the right. With a fall in trade costs, it would
follow that Ne is rising.
                                                   36

foreign exporters have a greater drop in their trade costs than in the home reservation price, and

they will raise their markups. That allows some low-productivity foreign firms to enter and begin

exporting to the home market. In the end, with unbounded productivity the home and foreign

markups are both in the range [1, +), before and after the drop in trade costs. The changes in

the extensive margin of domestic and foreign firms due to falling trade costs have no effect on

this distribution of markups, or on the average markup.

        What we now find is that this result holds even with bounded productivity. In that case,

the markup charged by the highest productivity home firm is reduced, and the markup charged

by the highest productivity foreign exporter is increased. These changes in the intensive margin

also cancel when evaluated for a small change in trade costs at the frictionless equilibrium, so

there is no pro-competitive effect. In addition, we have found that the mass of varieties N is

locally constant, so that there is no variety effect either.

        Because we already know the impact of a large change in trade costs from Proposition 3,

moving from autarky to frictionless trade, the results in Proposition 4 cannot hold for all

parameter values away from the frictionless equilibrium. Rather, for some parameter values we

must observe the same qualitative results as reported in Proposition 3:

Corollary 2
With bounded productivity, a reduction in trade costs 0 evaluated at some values of 0 >1 or
 > 0 leads to: (a) a fall in the reservation price and rise in welfare less than (1   )d ln 0 ;
(b) reduced gains due to the selection effect, but positive gains due to increased product variety
and a reduction in the average markup.


We have not established that the results in Corollary 2 hold for all values of 0 >1 and  > 0,

though we would conjecture that such a result holds.
                                                     37

        There is one final result that differs for bounded and unbounded productivities, even at

the frictionless equilibrium. While we have found that d ln p*  (1   )d ln 0 holds in either

case, that is not the formula used by ACR and ACDR to characterize the gains from reduced

trade costs. Rather, these authors focus on the change in the share of consumption coming from

domestic producers, or  in (28). We have already argued that the functional in the denominator

of this expression is constant with unbounded productivity, and locally constant with bounded

productivity. So given the change in the reservation price d ln p*  (1   )d ln 0 , the change in 

comes from the numerator only, and is readily calculated as:

                                                                        d ln 
         
              
d ln      v*
                     v* 
                d  ( v*) g ( v*)v *  
                                          
                                                      
                                                         
                                                         
                                                            d ln p*  
                                                                           
                                                                                if b  
                                            d ln p*   
         
              1 d  
                         (v)
                          v
                              g ( v ) dv    
                                                       d ln p*   d ln  if d ln p*  0 and b  .
                                                                          

With unbounded productivity, since lim v* g ( v*)v*  0 we obtain the formula for welfare gain

found by ACR and ACDR,  d ln p*   d ln  /  . With bounded productivity, however, the fall

in the share of consumption coming from home production exceeds that obtain with unbounded

productivity. It follows that the formula  d ln  /  now overstates the welfare gains from

reducing trade costs:

Corollary 3
The gain from a small reduction in trade costs equals  d ln  /   0 with an unbounded Pareto
distribution for productivity, but is strictly less than this amount with a bounded Pareto
distribution when evaluated at the frictionless equilibrium.


This result is very similar in spirit to Corollary 1, and shows that the formula for gains from trade

from ACDR holds as an upper bound in the two cases we have considered: a large reduction in
                                                      38

trade costs from autarky to frictionless trade; and a small reduction in trade costs when evaluated

at the frictionless equilibrium.

       To explain why the share of share of consumption coming from home production falls

more when productivity is bounded, we note that the fall in the mass of surviving domestic firms

M is also larger with bounded productivity, since from (22) we obtain (with Me fixed):

                                                g ( v*)v * 
                                   d ln M   
                                                  G ( v*) 
                                                              d ln p * .
                                            

The fall in the mass of domestic firms due to a reduction in trade costs is therefore d ln M 

 d ln p*   (1   )d ln 0  0 when productivity is unbounded. From the above equation,

domestic varieties fall even more when productivity is bounded (and evaluated at the frictionless

equilibrium). We interpret that extra drop in the mass of firms as resulting from the extra import

competition in the intensive margin, as applies when productivity is bounded.


6. Conclusions

       Our goal in this paper has been to evaluate the gains from trade when firm markups are

endogenous. To achieve that, we have introduced a quite general class of preferences represented

by the quadratic mean of order r expenditure function, due to Diewert (1976). Prior applications

of this expenditure/cost function have been mainly empirical, i.e. estimating the function for

specific values of the parameter r. In that case, the concavity and other properties of the function

are checked at the estimated parameters. For theoretical purposes, we want to ensure that the

function is globally well behaved. We have shown that this is the case for a symmetric function

and the parameter values in Assumption 1.

       Despite the general class of preferences we use, however, the crucial feature of the model

allowing for multiple sources of gains from trade comes from the supply side of the model. With
                                                 39

heterogeneous firms, the very simple result of Krugman (1979) linking a drop in the markup to

(frictionless) trade no longer applies necessarily. We have shown that this result does not apply

when the distribution of firm productivity is Pareto and the support is unbounded above,

allowing for infinite productivity and zero costs. That assumption was not part of the Melitz

(2003) model, but was introduced by Chaney (2008), enabling him to derive a “distorted” gravity

equation even with heterogeneous firms. In the absence of fixed costs, we have found that this

distribution rules out a pro-competitive gain from trade and also rules out any variety gain,

suggesting that alternative forms for the productivity distribution should be investigated. Here

we have focused on the Pareto distribution with a support that is bounded above. It is know from

the work of Helpman, Melitz and Rubenstein (2008) that this distribution allows for a tractable

gravity equation, at least in its empirical specification, and we have shown that it can also be

used to obtain theoretical results.

       We have investigated two case of trade liberalization. The first, following Krugman

(1979), was growth in country size. That exercise is meant to capture the movement from

autarky to frictionless trade with another country. Equivalently, we can think of trade costs

falling from some high level leading to autarky to zero, so the results for this case correspond to

a large change in trade costs. We found in Proposition 3 that the product variety and pro-

competitive gains from trade operate if and only if productivity is bounded above. This result

shows that the main analytical results of ACDR, who assume that productivity is unbounded, are

quite special and only allow for gains due to firm selection. Despite that limitation, their formula

applies as an upper bound to the proportional gains obtained from frictionless trade when

productivity is bounded and all three types of gains operate. When variety and pro-competitive
                                                  40

gains operate (due to bounded productivity), then the selection effect is sufficiently offset that

the total gains from trade are reduced.

        The second case we have investigated is a small change in trade costs in a symmetric

equilibrium. When productivity is unbounded then this small change can be evaluated in the

presence of trade frictions, but when productivity is bounded then we focus on a small change

around the frictionless equilibrium. In both cases, we find the import competition due to the a

reduction in trade costs is just offset by the export opportunities created. For example, the fall in

domestic markups is just offset by a rise in foreign markups, so that the average markup does not

change. More generally, the fall in trade costs has no impact on the entry of domestic firms,

product variety available to consumers, or on the average markup, so that the gains from trade

are due entirely to the exit of less efficient firms. If productivity is bounded and we move away

from the frictionless equilibrium, then the product variety and pro-competitive gains must come

back into play.

        There are a number of directions for further research. First, the two cases of trade

liberalization we have examined did not take advantage of the geography of trade and trade costs

illustrated in Figure 1: with finite reservation prices, bounded productivity and positive trade

costs, there will be countries not trading with each other. In contrast, the two cases we

considered implied that each country trades with all others (since either there is a firm productive

enough to do so, or with bounded productivity we evaluated the change in trade costs at the

frictionless equilibrium). We suggested in the previous section that even when countries trade

with all others, there is still a potentially large impact of trade liberalization on variety through

the extensive margin of exporting firms. Still, it would be of interest to examine how product

variety changes when new countries begin exporting, especially since that is the focus of the
                                                  41

empirical work in Broda and Weinstein (2006) and is very easily measured in the trade data.

       Second, we have not allowed for fixed costs of domestic production or exporting. The

presence of such fixed costs would make the lowest profitable marginal cost endogenous (instead

of unity as used here because we divide marginal cost by the reservation price). That change

alone would re-introduce the product variety and pro-competitive channels as potential channels

of gain. While it is challenging to allow for fixed costs and the QMOR demand system in

general, its formulation is simplified in the translog case, which deserves more attention. Of

course, with fixed costs then we should also allow these costs to fall as an alternative force

leading to increased trade, and evaluate the gains.

         Finally, while the bounded Pareto given us a particularly sharp comparison with the

unbounded case, we should also allow for other distributions for firm productivity. Head, Mayer

and Thoenig (2013) argue that the log-normal distribution offers a better approximation to actual

firm sizes than the Pareto. Edmond, Midrigan and Xu (2012) allow for a “double” Pareto as a

way to better approximate the actual distribution, and Holmes, Hsu and Lee (2013) also

investigate distributions other than the Pareto. These authors show that the pro-competitive gains

from trade tend to be greater outside the unbounded Pareto case, while Feenstra and Weinstein

(2010) estimate these gains for the United States without making any assumption on the

distribution. For all these reasons, we expect that future literature will be less likely to adopt the

unbounded Pareto case as representative when investigating the gains from trade.
                                                                           42


Appendix:

Translog expenditure function:

We start with the translog expenditure function, re-written slightly from the main text as:

                                         1                            
                         ln e0 (p) 
                                        N  ln p d   ln p2 d 
                                                       2              2 N                        ln p ln p ' d d ' ,

using N   d . Our goal is to show that this is the limit of the QMOR function as r0, under

                                                                                                    lim  x r 1   lim  x r / 2 1 
Assumption 3(c). We show this in reverse. By using ln x                                                                            we re-write
                                                                                                   r  0  r  r /2  0  r /2 

the translog function as:

 lim  err 1       1        lim  pr 1                  lim  pr / 2 1 
                                                                                   2
                                                                                                            lim  pr / 2 1  lim  pr /'2 1 
      
r  0  r 
                 
                    N            
                             r  0  r 
                                            d   
                                                      2
                                                                    
                                                           r /2  0  r /2 
                                                                                      d 
                                                                                              2 N                               
                                                                                                          r /2 0  r /2  r /2 0  r /2 
                                                                                                                                                 dd '.




Dropping the limit operator, multiplying through by r and completing the squares, we obtain:

                     1                  2                             2
er (p) r  1           ( pr  1)d      ( pr  2 pr /2  1)d                                  ( p p '  p  p '  1)dd ' .
                                                                                                            r   r        r       r
                    N                   r                             rN

                                      2          2
Because N   d and using    1      and       from Assumption 1(c), this becomes:
                                N      r          rN

                                                                   2                  2
er (p) r    pr d     pr pr ' dd '                        (2 p  1)d                        ( p  p '  1)dd ' .
                                                                                                                    r        r
                                                                    r                  rN

The last terms cancel, and so raising both side to the power 1/r we obtain (1). Doing the same

steps in reverse, it follows that the translog function is the limiting value of (1) as r0.

          The other property we wish to establish is the limiting value of D(p) as r0. Using the

                                 2 
definition in (7) with    1 
                                   r 
                                        :
                           N

                      1 2   p    p *  
                                          r                                                                  r
                                                                      lim  ( p * / p )       1   p 
                                                     r /2                                r /2
     D (p )                                              d   
 lim                  lim
                r 0 
                                           1 
                            r   p *    p                                                    d ,
r 0
              
                      N                                        
                                                                     r 0
                                                                                  r/2             p * 
                                                            43


which equals        ln p *  ln p  d   s (p)d  1 , as desired. We also need to check the
limiting value of D(p)1/ r . It is convenient to start with the formula for D(p)1/ r established

below in (A1). Again using the parameter values in Assumption 1(c), we obtain:

                                                              p  r /2 
                                                                               2 
                                  1        r         2                      
             ln  D(p)                                    
          lim                        lim
                      1/ r
                                    ln 1         1
                                                                  1 d 
         r 0              r 0 r           
                                        2 N  N
                                                        r   p * 
                                                                            
                                                                                   .
                                                                               
                                                                                

If a finite limit exists, then the expression in curly brackets must approach unity, so its natural

log approaches zero. In that case, we can use the approximation ln(1  x )  x , which will be

arbitrarily close for x0, to rewrite the above expression as:

                                                                      r /2    
                                                                                  2  
                               lim 
                                   1     r          2        p                 
              ln  D(p)  
                                                      r    p * 
          lim          1/ r
                                               1                          1 d 
         r 0               r 0 r  2 N  N                                    .
                                                                                 
                                                                                    

Eliminating terms in the curly brackets that approach zero, we obtain:

                                              p  r /2 
                                                             2                                    2
                            lim 1  2                                lim ( p / p*)r /2  1
     ln  D(p)1/ r                          p *   1 d    2   r 0
 lim
r 0              
                       
                           r 0 r
                                   r                                                            d ,
                                                                                            
                                                                   
                                                                                     r/2


which gives the result shown in the main text since the above limit is ln( p / p*) . Having

established these translog properties referred to in the main text, we prove all remaining results

for the QMOR function with r  0, appealing to continuity to establish them for r = 0.


Proof of Proposition 1:

(a) Consider the expenditure function (3) for r < 2, r  0 , with the set of available goods defined

by    | p  p * using the reservation price in (2). Multiplying all prices (including prices

for goods not available and also p*) by  > 0 has no effect on , so that er ( p)   er (p) in (3)
                                                                44

and the expenditure function is homogeneous of degree one. We have already confirmed in the

text that demand in non-negative, so that the expenditure function is non-decreasing in prices,

and strictly positive for expenditure on a non-empty set of goods. The remaining condition we

need to confirm is concavity in prices, which is shown in several steps.

`       Letting    ln q /  ln p denote the elasticity of demand from (6), we argued in the

main text that   1  r  0 for r  1 and also   0 for 1  r  2 We use these conditions to

establish the concavity of the expenditure function. It is convenient to use the following

characterization of concavity for a function defined over Rn, but which we apply to the

expenditure function defined over a continuum of prices:

Lemma A1 (Marshall and Olkin, 1979, p. 446): Let SRn be an open convex set, φ: S → R. For

x, yS, define the one variable function f() = φ(x+(1–)y) on the interval (0, 1). Then φ is

concave on S if and only if f is concave on (0, 1) for all x, yS .

       Following this Lemma, we consider prices p ( )   p  (1   ) p and reservation prices

p * ( ) obtained by using p ( ) in (2), along with     | p  p * ( ) . Then from (3),

                                                                                             1/ r
                                                                            
                                                                                2
         f ( )  er ( p  (1   )p ')    p ( ) d  A   p ( ) d  
                                                       r                  r
                                                                                                    ,
                                           
                                                                          

where A   / [ N  ( N  ( /  ))] . Small changes in the set   have no effect on expenditure

because these borderline goods have zero demand. So differentiating, we obtain:

                                                 p * ( )  r /2             1
    f ( )     e1r  r       p ( )   r 1 
                                                1           ( p  p )d   q ( )( p  p )d ,
                                                 p ( )                    u
                                                                               
                                                               45


where the first equality uses p * ( ) from (2) and the second uses demand q ( ) defined as in

(4) using prices p ( ) and utility u. With fixed income, utility depends on prices and . For

example, with income of unity, utility is u  1 / er ( p  (1   )p' ). Using the first expression

above to again differentiate e1r  r , and the second expression to differentiate q ( ) holding

utility fixed, we obtain :

                               (1  r ) f '( )2 1 q ( )
                   f "( )                                 ( p  p )2 d
                                      er         u  p ( )
                                                       

                                (1  r ) f '( )
                                               2
                                                  1                 ( p  p )2
                                                   ( )q ( )               d ,
                                       er         u                   p ( )
                                                           


where the second line uses  ( ) defined as the elasticity of demand at prices p ( ) . For

1  r  2 we have shown that   0 , so we immediately obtain f "( )  0 , as desired.

         For r  1 we use  ( )  1  r to obtain:


                      (1  r )                                                  ( p  p )2     
                         u                                            
          f "( )                  q (  ) h (  )( p  p ) d      q (  )               d  ,
                                                                                     p (  )       
                                                                                                

                  f '( )      q ( )( p  p )d
where h( )                                                  . It follows that f "( )  0 if the expression in
                    er
                                 q ( ) p ( )d
brackets above is less than or equal to zero:

                   h(  )   q ( )( p '     p ' )d '      q ( )( p '    p ' )2 / p ' ( )d ' ,
                             '                                 '


where we introduce the notation  ' for convenience. This inequality is established by
                                                                                         2
                       p (  ) 1/ 2                p ( ) 
                                                                       1/ 2
                                                                                             
expanding the square       '                
                                        ( p  p )                     ( p '  p ' )   0, and using the
                          p ( )                     p ' (  ) 
                                                                                         
definition of h( ) . QED
                                                                 46


Proof of Lemma 1:

        To establish the first line of (11), we need to show that (10) holds. From (2), dividing by

p* and rearranging terms, we obtain:

                                                                                   r /2
                                                                          p 
                                      N   N                              d .
                                                   
                                                              
                                                                  p*


Noting that N   d  , we have  [ N  ( /  )]    ( p / p*)r /2  1d , which is a
                                                                          

positive constant from Assumption 1. Subtracting this term from the definition of D(p) , and

completing the square, we obtain,

                                                                                           1/ r
                                                 p  r /2 
                                                                  2 
                                                              
                 D(p)1/ r       N               1 d                              .
                               
                                                                                                        (A1)
                                                           
                                                    p*             
                                                                   

Using (7), the “adjusted” demand shares are:

                                 s (p)( p * / p )r /2                     ( p / p*)r /2  1
                 z (p)                                                                             ,
                              s (p)( p * / p )              d         ( p / p*)  1d
                                                         r /2                             r /2



The denominator on the right is a positive constant  [ N  ( /  )] , as noted above. Then

defining the Herfindahl index, H   z (p)2 d , it follows from (A1) that (10) holds. Using
                                                

this in (9), we obtain the first line of (11).

        To obtain the second line of (11), we develop a second expression for the term D(p) .

From (7), we can write:

                                      p*
                                                r /2
                                                             1        p *  r /2 
                             s (p)  p           d 
                                                            D(p)   p 
                                                                           1d ,
                                                                                   
                                                                                 

where the integral on the right is once again  [ N  ( /  )]  0. It follows that,
                                                                 47

                                                                                                     1/ r
                                                             
                                                                 1/ r                     
                                           N                                r /2                     1
                                                                          s (p) p d 
                                1/ r                                                                                  (A2)
                          D(p)                                
                                                                                                    p* .

Using this in (9), we obtain the second line of (11).

        By substituting the reservation prices from (2) into (11), we can further obtain:

                                                                                                      1/ r
                                                                        
                                                                                 p d 
                                                   1/ r                         1 r /2
                            N [ N  ( /  )]                                         
                 er (p)                          
                                                                                N
                             N  [ N  ( /  )] 
                                                     s (p) p r /2 d 
                                                                           
                                                                         
                                        in N
                                                                     Exact price index without variety


This final expression for the cost of living consists of a term that declines as product variety

rises, and an exact price index without accounting for variety. This formula for the exact price

index is very similar to that found in Diewert (1976, p. 131), and can be shown to be identical to

that formula for the symmetric case we are considering here. QED


Proof of Lemma 2:

Working from (2), the reservation price equals:

                                                                                     2/ r
                       N           
                                         2/ r           p 
                                                               r /2    
         p*                                   p*  
                                                     1
                                                                   d 
                      
               N  [ N  ( /  )]                               
                                                      N p*
                                                                                              2/ r
                       N           
                                          2/ r
                                                    v*   ( v ) r /2 g ( v ) 
                                              p*                        dv 
                      
               N  [ N  ( /  )]                1  v  G ( v*) 
                                                                                    2/ r
                       N                    
                                          2/ r v *
                                                                     g( v )                G ( v*)      2/ r
             
                                                  (v )   r /2
                                                                      ( v*) 
                                                                            dv             p*         
               N  [ N  ( /  )]              1                G                      G ( v*) 

The first line follows from (2) using simple algebra, and the second line follows by expressing

the integral using the change in variables in (12), where the term (p*/a) from (12) cancels in the

numerator and denominator of the conditional density g(v)/G(v*). Then the third line follows by
                                                                            ( v*)  v* g( v )dv .
defining the “adjusted” density function g( v )  g ( v ) / v r /2 , with G                                 1
                                                             48

        Using the definition of the “adjusted” distribution function, the final term on the third line

above is easily re-written as it appears in Lemma 2. QED


Proof of Proposition 2:

(a) Using (14) and (16) to substitute for Ne in (13), we obtain:

                       v*   ( v )  1    ( v )             v* 
                                                                           (v ) 
                                                                                    r /2                
                                       
                                          d           g ( v ) dv   v 
                                                                                        1 g ( v ) dv 
                    
        F     p *   1   (v )   v                          1                        
                                                                                                        
                                                                                                      .   (A4)
        L     a                             
                                                            v*
                                                                    (v )                              
                                           N    d                  g ( v )dv                    
                                                        1         v    
                                                                                                        

We need to show that the integral in the denominator on the right is bounded above even as

v*  bp * / a  . That integral is:

                v*                           v*
                       (v )                     1
                 d  v g (v )dv           d  v g (v )dv   for  ( v )  1, since d '  0
                1                             1
                                            v* v  r g ( v )dv for   0, r  0 in (7)
                                            1
                                          
                                               v*
                                           
                                                  v  r /2 g ( v )dv for   0, r  0 in (7)
                                           1

where the second line follows by inspection of d(1/v) in (7). Using g ( v )   v  1 / (1  b ) and

 > max{0,–r} from Assumption 2, it is readily confirmed by computing the last two integrals

above that they are bounded above even as v*  bp * / a  . Both the integrals in the numerator

are increasing in v*, using Assumption 1, and the first term on the right of (A4) approaches

infinity as p*  . It follows that the right side of (A4) approaches infinity as p*  .

        We next consider p*0. Since the first integral in the numerator of (A4) is less than the

integral in the denominator, their ratio is less than unity. The second integral in the numerator of

(A4) approaches zero as v*  bp * / a  0. It follows that the right-hand side approaches zero as
                                                         49


p*  0. Therefore, there will exist a value for p*  (0, ) such that (A4) holds, and this is the

equilibrium value. Then N is computed from (16) and Ne from (14). Part (b) is proved in the

main text. QED


To establish Proposition 3 we use the following result on the elasticity of the markup  ( v ) :


                 ' v  (  1  r )2 /  (  1)                     'v               'v 1
Lemma A2:                                                   , so 0        1 and lim       .
                                      2
                                                                                v 1     2
                        
                         1     (    1   r )   /   (    1)  

                                         ( v ) r / 2 1 
Proof: In the main text we report that            r (  ( v )  1)  1  2 , which follows from
                                                                                 1
                                        v            2

(6). Rearranging this expression we obtain,

                                       v r / 2        1  v r / 2 
                 r   ( v )  1  1              1  2   ( v )   ,                        (A5)
                                        (v )                        

and differentiating we can obtain:

                                        1  r (  1)  1  1  v  
                                        r/2                               r/2
                                  v
                                                2         2   (v)  
                                      2                           
                  'v                                                      .
                      
                            v  r / 2  1 r (  1)   1  v  r / 2  
                        1                              1             
                                                   2   
                                2                   2   ( v )   

Substituting from Lemma A2 and (A5), and using 1 /   (  1) /  and (1   ) /   1 /  ,
                 1 r (  1) 
which implies    2  2        = (  1  r ) / 2 , we obtain the desired result. The limiting value for
                             

'v/ as v  1 and    is obtained using L’Hôpitals Rule. QED


Proof of Proposition 3:

(a) To establish part (a), we need to show that the Herfindahl index is fixed in the unbounded

Pareto case; the remaining statements have been proved in the main text. Using (10) and (A2),

we have:
                                                                        50

                                                                                     1/ r
           
                                       1/ r      d ( p / p*)  p  r /2     
                                                                        
        1   N    H                                             d
                                                 D (p )  p * 
                                                                              
                                                                        r /2                          1/ r
                                           v*   ( v )    ( v )          p*                                           (A6)
                                      Ne  d                                      g ( v ) dv 
                                         1       v  v                    a                  
                                                                                                  
                                                   v*   (v )   p * 
                                             Ne  d                        g ( v ) dv          
                                                 1      v  a                                   

where in the second line we have converted from integrals over  to integrals over v, using the

change in variables in (12). Clearly, various terms in the numerator and denominator of the

second line cancel. When b = , then we are left with two integrals with an upper limit of

integration of v* = , and the ratio of these integrals are independent of p* and Ne . Therefore,

the Herfindahl is fixed.

(b) (i) To show that N rises with L, we differentiate (14) and use the Pareto distribution:

                       ( a / p*)                        
d ln N  d ln N e                                    d ln p *
                       ( a / p*)  b                     
                  Ne          b                        ( v*)  r /2       b                    d ln L
                                                                           
                                                         v *    ( a / p*)  b            
                                                            1
             [ N  ( /  )]  1  b                                                                    1  A  B 
                                                                          
          
                           1
                                                                                            
                                              r/2
                                  ( v*)
                               v*               1 b                                       b d ln L
                                                                                      
                         1   g (v)dv  (a / p*)                                    (1  b ) 1  A  B 
                                                                             
         
               v*        (v)
                                 r/2
                                                    p*                            b              
             
          1 
                          v                         a
                                                                                             

where the second line follow by substituting from (18) and simplifying; and the third line follows

from (14) and (16). The term in curly brackets is positive if and only if,


         
        v* 
                                 
                         r/2
                (v)
                               1   p *               ( a / p*)  b  v*  p * 
                                                                             
                 v
                                         g ( v )dv                                  g ( v )dv .
                            1  a                          1  b      1  a 
                          r/2
                ( v*)
        1                                               
                v*               

This inequality holds because (1) = 1, while (v)/v declines to (v*)/v* < 1 for v* > 1, and
                                                                     51

Lemma A2 ensures that this decline in monotonic. It follows that the term in square brackets in

the first integral above is less than unity for v < v*.

(ii) Next, we consider the average of costs in (17). Differentiating using d ln v*  d ln p*,

         G ( v*) 1/ r   1 v *  g( v*) g ( v*)  
d ln  p *                      G        
                                          ( v*) G ( v*)  
                                                              d ln p *
          G ( v*)        
                                 2 r                       
                                             ( v*) r /2  v* v  r /2 g ( v ) dv  
                               1 g ( v*)v * 
                              
                                                                1            G ( v*) 
                                                        v *    r /2 g ( v )           d ln p *
                               2 rG ( v*) 
                                                    1     v
                                                                     G ( v*)
                                                                              dv       
                                                                                         

                                                                                         r v*  2 1 G ( v )
                                           v*  r /2 g ( v )                                    r
Integrating by parts we have                v               dv      ( v*) r /2          v               dv           , so that,
                                          1         G ( v*)                              2 1         G ( v*)


                                                                          v*  2r 1 G ( v ) 
                                                            g ( v*)v *  1 v
                              1/ r 
                     
                    G ( v*)   (1  C1 )                                            G ( v*)
                                                                                              dv 
        d ln  p *                     d ln p*, with C                                        .
                                                               G ( v*)  v* v  r /2 g ( v ) dv 
                                                          1
                    G ( v*)                                           1
                                     2
                                                                                                 
                                                                                    G ( v*)     

                                                       g ( v*)v *            v * g ( v ) v   r 1 G ( v )    v*         2r 1 G ( v ')     
Note that C1 can be re-written as C1 
                                                        G ( v*)          1      G ( v ) 
                                                                                           v 2
                                                                                                   G ( v*)    1    v'
                                                                                                                                 G ( v*)
                                                                                                                                          dv ' dv
                                                                                                                                              
                                                                                                                                                     ,

where the final expression in square brackets acts as weights, i.e. it integrates to unity. It follows

that 0 < C1 < 1 if g ( v*)v * / G( v*) is declining in v*, as is confirmed for the Pareto distribution.

        For the average of markups in (17), differentiation gives us:

                                                                             v*         r /2 g ( v ) 
                                                  v * g( v*)   ( v*)  1  ( v ) G ( v*) dv 
                                      1/ r                             r /2
              v*            g( v ) 
        d ln    ( v )r /2                    
                              ( v*)                 ( v*)            v*     r /2 g ( v )           d ln p * .
              1            G                   rG
                                                              
                                                                      1  (v ) G (v*) dv            
                                                                                                       

                                                                                                                         G ( v )/ v
                                                                                                        ( v )r /2   ' v  
                                             v*                 g ( v )                         r v*
Integrating by parts we obtain,            1      ( v )r /2    ( v*) dv
                                                                G
                                                                               ( v*) r /2 
                                                                                                 2 1 
                                                                                                                     G ( v*)
                                                                                                                                       dv ,     so,


                                                                                     v*  ( v )r /2   ' v  G ( v )/ v dv 
                                                                        v * g( v*)  1
                                      1/ r
              v*            g( v )             C2                                                         
                                                                                                        G ( v*)            
        d ln    ( v )r /2                        d ln p*, with C2 
                              ( v*)                                      ( v*)        v*         r /2 g ( v )
                                                                                                                               .
              1            G                  2                       G          1  ( v ) G ( v*) dv 
                                                                                                                             
                                                                             52


Because 0 < 'v/ < 1 from Lemma A2, we see that C2 is less than,

                                g( v*)v *              ( v ) v 
                                                     v* g                       ( v )/ v        v*                    ( v ')/ v '     
                                                   1              (v )                       1      ( v ')r /2
                                                                                                                      G
                       C2                                                r /2 G                                                    dv ' dv   ,
                                   ( v*)
                                  G                      (v ) 
                                                        G                       ( v*)
                                                                               G                                       
                                                                                                                       G ( v*)          

where the final expression in square brackets acts as weights, i.e. it integrates to unity. It follows

                                 ( v*) is declining in v*, as is readily confirmed for the “adjusted”
that 0 < C2 < 1 if g( v*)v * / G

Pareto distribution defined in the main text.

(iii) Finally, we need to show that the share-weighted mean of prices in (11) falls as the labor

force L grows. The share-weighted mean of prices after cancelling common terms in (A6) is,

                                                     1/ r                                                                                         1/ r
                                  r /2
                                                                         p*       v*   ( v )    ( v )  r /2            
                        s (p) p d                                           d                           g ( v ) dv                           ,
                                                              ( v*)1/ r
                                                                  D                1  v   v                               

                 ( v*)  v* d   ( v )  g ( v )dv . The above expression changes by:
where we define D                         1      v 


                                   1/ r            ( v*)    ( v*)   r / 2                                         
                                           1 1  d  v*   v*                g ( v*)v * d   ( v*)  g ( v*)v *  
d ln   s (p) p r /2d                                                                      v*                    d ln p * .
                                                      v*   ( v )    ( v )   r / 2                    ( v*)
                                        2 r
                                                   1 d  v   v                  g ( v )dv         D
                                                                                                                            
                                                                                                                          

                               d [  ( v ) / v ]g ( v )dv , we obtain:
Integrating by parts using d D

            v*   ( v )   r / 2                               r/2                         r/2
                                                                                                       '( v ) 1  
                                         ( v*)   ( v*)            r    ( v ) 
                                                                             v*
              
           1  v 
                                  dD   D
                                                     v*                 2 1  v 
                                                                                                     
                                                                                                      
                                                                                                                 D ( v )dv
                                                                                                                v
                                                                                                                                 .


Expressing the long term in square brackets above with a common denominator, we can

substitute the above integral and rearrange terms to obtain:

                                                                          v*   ( v )   r / 2   '( v ) v  D     (v )    
                          
                              1/ r
                                    C           
                                                  d   ( v*) 
                                                               g ( v *)     
                                                                                
                                                                                         
                                                                                         
                                                                                                   
                                                                                                        
                                                                                                                  1         dv  
                                                                                                                                    
d ln   s (p) p r /2d   3 d ln p*, C3  1   v*                                                           
                                                                             1     v                                     v
                                                      ( v*) / v *                                           r / 2               
                                                                            d   ( v )    ( v ) 
                                                                               v*
                               2               D                                                               g ( v )dv  
                                                                         1  v  v                                           

From Lemma A2 we have that 0 < '(v)v/ < 1 for v > 1, and so –1 < ['(v)v/ ] – 1 < 0. It
                                                                                            53

follows that C3 < 1 and a sufficient condition for C3 > 0 is:

                                                                  r/2
                                                                                                                                                             r /2     (v)           
d   ( v*)  g ( v*)           d   ( v )    ( v )                                                                                     (v ) 
                             v*
                                                                                           v*                                                                         D
                                                                         g ( v )dv                       ( v )  g ( v )v                                                         
    v*                             v  v                                                                                                     v 
                                                                                             d 
                                                                                                                                                                         v
                           1                                                                                                                                                        dv ,
    ( v*) / v *                     v*   ( v )   r / 2 D                                                         ( v )  v*   ( v ') 
                                                             (v)                                                                             r /2                    
                                                                                                                v D
                                                                                                                            1  v ' 
   D                                                              dv
                                                                                                                                                                       D ( v ')
                                                                                                                                                                                  dv ' 
                                                                                           1
                                    1  v                    v                                                                                                         v'            

where the equality follows by rearranging terms. Notice that the final term in square brackets

acts as a weight, i.e. it integrates to unity. It is immediate that the inequality will hold if

d   ( v*)  g ( v*)v * / D
                              ( v*) is declining in v*. To verify this, we take logs and differentiate,
   v* 


  d ln    ( v*) 
           d
d ln v *   v* 
                                         
                    g ( v*)v * / D( v*)     ( v*)  1
                                  
                                                                                                    '( v*) v*
                                                                                                       ( v*)
                                                                                                                 1         d             ( v*) 
                                                                                                                                            
                                                                                                                                             v* 
                                                                                                                                                      
                                                                                                                                                          g ( v*)v *
                                                                                                                                                            ( v*)
                                                                                                                                                           D
                                                                                                                                                                     0

                              ( v*)  1                        '( v*) v *
                                                                        ( v*)
                                                                                   1d               ( v*) 
                                                                                                     
                                                                                                      v* 
                                                                                                               
                                                                                                                    g ( v*)v *
                                                                                                                      ( v*)
                                                                                                                     D
                                                                                                                               .


                     ( v*)  v* d   ( v )  g ( v )dv , we can integrate by parts to obtain:
From the definition D                              1         v 


            ( v*)  d   ( v*)  g ( v*)v *  v*  g '( v )v   ( v )  1
           D
                         v*                    1                                                                    '( v ) v
                                                                                                                           (v)
                                                                                                                                    1     g(v) d       (v) 
                                                                                                                                                          
                                                                                                                                                           v 
                                                                                                                                                                   dv ,



so that, d   ( v*) 
                 v*
                           g ( v*)v *
                             ( v*)
                           D
                                       1     1   ( v )  1
                                              v*
                                             1                                                                '( v ) v
                                                                                                                 (v)
                                                                                                                          1  d     (v )  g (v )
                                                                                                                                      
                                                                                                                                       v D
                                                                                                                                               
                                                                                                                                                  ( v*)
                                                                                                                                                         dv.


Substituting this expression above, the inequality we wish to establish is:

   1   ( v*)  1
                                             1  (v)  1  1 d Dg((vv*)) dv
                                     '( v*) v*
                                      ( v*)
                                                1
                                                                         1
                                                                          v*                                              '( v ) v
                                                                                                                           (v)
                                                                                                                                                    (v) 
                                                                                                                                                  
                                                                                                                                                   v 
                                                                                                                                                          



                1   ( v )  1          1                                 (v )  1        1  dv
                                                                                            v*
                                                         (v )
                                                        D
                                                       '( v ) v
                                                                        (v ) d 
                                                                       D
                                                                                                       v*
                                                                                                                                                           '( v ) v
                                                                  
                                                    D
                                                         ( v*)
                                                        (v )          
                                                                       D( v*) dv                                                                        (v)
                                                                                       1               1


                1   ( v*)  1            1                 ( v )  1        1  dv,
                                                                 (v ) d 
                                                                D
                                                         '( v*) v*
                                                                                     v*
                                                                                                                                           '( v ) v
                                                              
                                                          ( v *)         
                                                                D( v*) dv                                                                 (v)
                                                                                        1


where in the second line we integrate by parts, with lim v 1  ( v )  1 D
                                                                             ( v )  0 as can be

confirmed using L’Hôpitals Rule and Lemma A2. Therefore, the inequality we wish to establish

is that the final integral above is positive, and a sufficient condition for this to hold is that:
                                                                              54


                                                  d 
                                                  dv 
                                                         (v )  1       '( v ) v
                                                                             (v)
                                                                                      1  >0.                                                     (A6)


Using Lemma A2, we see that the expression in square brackets approaches – as v  1 while it

equals a finite negative number for v = v*, so the positive relationship with v shown in (A6)

holds globally. To confirm (A6) locally, we substitute for 'v/ using Lemma A2 and

differentiate using  '( v )  0 , obtaining a long polynomial involving r and . It can be confirmed

that the polynomial is negative, so that with  '( v )  0 , then the positive sign in (A6) is obtained.

                                                                                 1/ r
(c) We have shown that d ln   s (p) p r /2 d 
                                                                                               C3
                                                                                                   d ln p * , with 0 < C3 < 1. It follows
                                                                                            2

from the first two lines of (11) that,

                                           1/ r                                    1/ r 
                                                                                      
           d ln 1   N                        d ln    s (p) p r /2d  / p *                                     C3  1 d ln p * .
                                                                                                                           1
                                      H                                      
                                                                                    
                                                                                                                           2




                       
                                 1/ r
Since 1  N   H                 is decreasing in H (from Assumption 1), then if the reservation price
                      

falls so
           1
           2
                C3  1 d ln p*  0, it follows that H must also be falling.                                       QED


Proof of Lemma 3:

Working from (2), the reservation price equals:
                                                                                                                                                           2/ r
                                2/ r                                                                                2/ r          ( v )  r / 2  
                                                    r /2      
                                                                             2/ r                                           J    v   
           N                                  p                                        N                  
p*                                    p* 1                                                                          p*                        
                                                                                                         
      N  N                                          d
                                                                                       N  N               
                                                                                                                                                                  .
                                         N  p *                                                                               J  [1]       
                                                                                                                                              

The first equality follows from (2) using simple algebra, and the second equality follows by

integrating over all domestic and foreign products in the set , and expressing the integral using

the change in variables in (12) and (20) and then using the functional in (25). Then by definition

of the “adjusted” density function g( v )  g ( v ) / v r /2 , used in the functional J[ f ] , we have:
                                                                       55


                              r/2
                                                                                      
                                                                                 r /2  J   p *  
                                                                                                             
           J     ( v )   J   ( v ) r /2  
                                                                                                      r/2
                                                                                                    ,
                                                                   J       ( v )                        
                    v                        p*   
                                                        J    1                            v   
        p*                                                                                               
                  J  [1]                J [1]      J  1       J 1         J  1 
                                                                                                           

so that Lemma 3 is established. QED


Proof of Proposition 4:

We need to prove that the change in price d ln p*  (1   )d ln 0 is the equilibrium change, and

will do so by also showing that Me and N are constant. It will follow that the term D(p) in the

denominator of (24) is constant, and it follows that the Herfindahl index is also constant. From

Lemma 1 the change in welfare equals therefore equals  d ln p*  (1   )d ln 0 .

(i) Consider first the case of unbounded productivity. By integrating over trade costs, the free

entry condition (24) becomes:

                                                                                          
                                         (1  ) 
                        L 1   0 C
                                                           ( v ) 1   ( v )   p* 
                                                   
                                                                       d                   g ( v )dv
                                                            ( v )   v   a 
                 F                                   1
                                                              
                                                                                                           .
                                                                                       
                                            (1  ) 
                            M e 1   0 C                       d   ( v )   p*  g ( v )dv
                                
                                                                  v  a 
                                                               1


The term involving trade costs in brackets cancels in the numerator and denominator as does the

term (p*/a). The remaining integrals are constant because their upper-limits do not depend on

p* or trade costs. It follows immediately that the mass of entering firms Me is constant.

       Likewise using v*  and v*/(c)  , condition (26) becomes:

                                                                              
                                               (1  )    ( v ) 
                                                                                               r /2
                               p* 
        N   N       Me     1   0 C              v 
                                                                                                      g ( v )dv
                             a                           1
                                                                                                                                   (A7)
                                                                    r /2                                     r /2
                                   (1  ) 
                        1    C                  (v )                                  (v ) 
                 M
                        
                             0                 
                                                  v 
                                                                            g ( v )dv  N                          g ( v )dv,
                                                                                          1
                                                 1
                                                                                                v 

where the first equality follows by evaluating the integrals in (26), the second follows from using
                                                       56


M = Me(p*/a) , and the third line follows from using (30). Again, the final integral is constant

because its upper-limit does not depend on p* or trade costs. From this condition we therefore

uniquely solve for product variety N available to consumers, independent of trade costs. Then

differentiating the first equality in (A7) for fixed N and Me, we obtain:

                                      C  (1  ) 
                 0   d ln p *      0                 d ln 0  d ln p*  (1   )d ln 0 .
                                               (1  ) 
                                    1    C
                                   
                                          0 
                                            (1  )


It follows that d ln p*  (1   )d ln 0 is the equilibrium change in the reservation price.

(ii) Next, consider the case of bounded productivity. We will argue that d ln p*  (1   )d ln 0

satisfies all the equilibrium conditions and implies that Me and N are locally constant around the

frictionless equilibrium. We have already argued in the text that d ln p*  (1   )d ln 0 implies

that the functional on the right of (26) is locally constant, so that:

                                                     N           
                                    d ln N                         d ln M e .                         (A8)
                                            N  [ N  ( /  )] 

                                                                              , to obtain:
We can also use the equilibrium conditions (22) and (23), with  = 0 and C  C

                                                                                
                         p*                  C  1  (C  1)( v*) 
                 N  Me      G ( v*)  1   0              
                                                                                
                                                                                       .
                         a                        
                                                                 
                                                                                   
                                            1   ( v*)        1   ( v *)
                               M                              h ( 0 , v*)


We can then calculate the total change in N around the frictionless equilibrium as:

                        g ( v*)v *              ln h                   ln h
d ln N  d ln M e                d ln p *               d ln 0                  d ln p *
                         G ( v*)                ln 0  1            ln v *  0 1
                                                          0

                            ( v*)          1
                                           C               C    1        
          d ln M e                       d ln 0                    d ln 0  (0)d ln p *
                         1  ( v*)     C            C  1  ( v*)    

          d ln M e .
                                                  57


To move from the first line to the second, it is readily confirmed from the definition of h( 0 , v*)

that the final derivative is zero when evaluated at 0 = 1, while the derivative with respect to 0 is

as shown. The second term on the second line is obtained by substituting d ln p*  (1   )d ln 0

              and using the Pareto distribution to evaluate g(v*)v*/G(v*). It is readily seen that
with   1 / C

the second and third terms sum to zero, so that the final line is obtained. From Assumption 1 we

have [ N  ( /  )]  0, so the only way that d ln N  d ln M e is consistent with (A8) is if

d ln N  d ln M e  0. It follows that these are the equilibrium changes, in conjunction with

d ln p*  (1   )d ln 0 . QED
                                              58


References

Arkolakis, Konstantinos, Arnaud Costinot and Andrés Rodriguez-Clare, 2010, “Gains From
      Trade under Monopolistic Competition: A Simple Example with Translog Expenditure
      Functions and Pareto Distributions of Firm-Level Productivity,” available at (2/7/13):
      http://www.econ.yale.edu/~ka265/research/GainsfromTrade/Translog%2010-09-05.pdf
Arkolakis, Konstantinos, Arnaud Costinot and Andrés Rodriguez-Clare, 2012, “New Trade
      Models, Same Old Gains? American Economic Review, 102(1), 94-130.
Arkolakis, Konstantinos, Arnaud Costinot, David Donaldson and Andrés Rodriguez-Clare, 2012,
      “The Elusive Pro-Competitive Effect of Trade,” March 16, available at (2/7/13):
      http://www.econ.yale.edu/~ka265/research/ACDR/ACDRdraft.pdf ; and later draft of
      June 18, 2012.
Atkeson, Andrew, and Ariel Burstein, 2008, “Pricing-to-Market, Trade Costs, and International
      Relative Prices,” American Economic Review, 98(5), 1998-2031.
Baldwin, Richard E. and Rikard Forslid, 2010, “Trade Liberalization with Heterogeneous
      Firms,” Review of Development Economics, 14(2), 161-176.
Behrens, Kristian and Yasusada Murata, 2007, “General Equilibrium Models of Monopolistic
      Competition: A New Approach,” Journal of Economic Theory, 13, 776-787.
Behrens, Kristian and Yasusada Murata, 2012, “Globalization and Individual Gains from Trade,”
      Journal of Monetary Economics, 59, 703-720.
Bernard, Andrew B., Jonathan Eaton, J. Bradford Jensen and Samuel Kortum, 2003, “Plants and
       Productivity in International Trade,” American Economic Review, 93(4), 1268-1290.
Broda, Christian and David E. Weinstein, 2006, “Globalization and the Gains from Variety,”
       Quarterly Journal of Economics, May, 121(2), 541-585.
Chaney, Thomas, 2008, “Distorted Gravity: the Intensive and Extensive Margins of International
      Trade,” American Economic Review, 98(4), September, 1707-1721.
De Blas, Beatriz and Katheryn Niles Russ, 2012, “Understanding Markups in the Open
       Economy,” Universidad Autonoma de Madrid and University of California, Davis.
Diewert, W. Erwin, 1971, “An Application of the Shephard Duality Theorem: A Generalized
      Leontief Production Function,” Journal of Political Economy, 79(3), 481-507.
Diewert, W. Erwin, 1976, “Exact and Superlative Index Numbers,” Journal of Econometrics, 4,
      115-145.
Diewert, W. Erwin, 1980, “Aggregation Problems in the Measurement of Capital,” in Dan
      Usher, ed., 1980, The Measurement of Capital, NBER and University of Chicago Press,
      433 – 538.
Dhingra, Swati and John Morrow, 2012, “The Impact of Integration on Productivity and Welfare
      Distortions Under Monopolistic Competition,” CEP Discussion Papers dp1130, LSE.
Eaton, Jonathan , Samuel S. Kortum, Sebastian Sotelo, 2012, “International Trade: Linking
       Micro and Macro,” NBER Working Paper 17864.
                                               59

Edmond, Chris, Virgiliu Midrigan and Daniel Yi Xu, 2012, “Competition, Markups, and the
     Gains from International Trade,” NBER working paper no. 18041.
Feenstra, Robert C., 2010, “Measuring the Gains from Trade under Monopolistic Competition,”
       Canadian Journal of Economics, February, 1-28.
Feenstra, Robert C. and David E. Weinstein, 2010, “Globalization, Markups and U.S. Welfare,”
       NBER working paper no. 15749.
Head, Keith, Thierry Mayer and Mathias Thoenig, 2013, “Welfare and Trade without Pareto,”
       University of British Columbia, Sciences Po, and University of Lausanne.
Helpman, Elhanan and Paul R. Krugman, 1985, Market Structure and Foreign Trade.
      Cambridge: MIT Press.
Helpman, Elhanan, Marc J. Melitz and Yona Rubinstein, 2008, “Estimating Trade Flows:
      Trading Partners and Trading Volumes,” Quarterly Journal of Economics, 123, 441-487.
Holmes, Thomas J., Wen-Tai Hsu and Sanghoon Lee, 2013, “Allocative Efficiency, Mark-ups,
      and the Welfare Gains from Trade,”
      http://www.econ.umn.edu/~holmes/papers/alloc_eff_trade_july2013.pdf
Kichko, Sergey, Sergey Kokovin, Evgeny Zhelobodko, 2013, “Trade Patterns and Export Pricing
      Under non-CES Preferences” http://ideas.repec.org/p/wsr/wpaper/y2013i124.html
Krugman, Paul K., 1979, “Increasing Returns, Monopolistic Competition, and International
     Trade,” Journal of International Economics, 9, 469-479.
Krugman, Paul R., 1980, “Scale Economies, Product Differentiation, and the Pattern of Trade,”
     American Economic Review, 70, December, 950-959.
Marshall, A.W., and I. Olkin, 1979, Inequalities: Theory of Majorization and its Application.
      Academies Press, New York.
Melitz, Marc J., 2003, “The Impact of Trade on Intra-Industry Reallocations and Aggregate
        Industry Productivity,” Econometrica, 71(6),1695-1725.
Melitz, Marc J. and Gianmarco I. P. Ottaviano, 2008, “Market Size, Trade, and Productivity,”
        Review of Economic Studies, 75(1), 295-316.
Metliz, Marc J. and Stephen Redding, 2013, “Firm Heterogeneity and Aggregate Welfare,”
        NBER working paper no. 18919.
Saure, Philip, 2009, "Bounded Love of Variety and Patterns of Trade", Swiss National Bank.
Simonovska, Ina, 2010, “Income Differences and Prices of Tradables,” NBER working paper
      16233.
Sutton, John, 2012, Competing in Capabilities: The Globalization Process, Clarendon Lectures
        in Economics, Oxford: Oxford University Press.
Zhelobodko, Evgeny, Sergey Kokovin and Jacques-François Thisse, 2010, “Monopolistic
      Competition: Beyond the CES,” CEPR Discussion Papers 7947.
Zhelobodko, Evgeny, Sergey Kokovin, Mathieu Parenti and Jacques-François Thisse, 2011,
      “Monopolistic Competition in General Equilibrium: Beyond the CES,” CORE Discussion
      Papers 2011010, Université Catholique de Louvain.
