                              NBER WORKING PAPER SERIES




                       TAX MECHANISMS AND GRADIENT FLOWS

                                       Stefan Steinerberger
                                         Aleh Tsyvinski

                                       Working Paper 25821
                               http://www.nber.org/papers/w25821


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     May 2019




Stefan Steinerberger is supported by the NSF (DMS-1763179) and the Alfred P. Sloan
Foundation. We thank Manuel Amador, Andy Atkeson, Felix Bierbrauer, Patrick Bolton, Jaroslav
Borovicka, Pierre Boyer, Hector Chade, Alfred Galichon, Martin Hellwig, Oleg Itskhoki, Ilse
Lindenlaub, Benny Moldovanu, Chris Phelan, Georgii Riabov, Larry Samuelson, Florian
Scheuer, Philipp Strack, Kjetil Storesletten, Juuso Valimaki, and, especially, Nicolas Werquin.
The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2019 by Stefan Steinerberger and Aleh Tsyvinski. All rights reserved. Short sections of text,
not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
Tax Mechanisms and Gradient Flows
Stefan Steinerberger and Aleh Tsyvinski
NBER Working Paper No. 25821
May 2019
JEL No. E62,H21

                                          ABSTRACT

We demonstrate how a static optimal income taxation problem can be analyzed using dynamical
methods. We show that the taxation problem is intimately connected to the heat equation and
derive a new property of the optimal tax which we call the fairness principle. The optimal tax at a
given income is equal to the weighted by the heat kernels average of optimal taxes at other
incomes and income densities. The fairness principle arises not due to equality considerations but
represents an efficient way to smooth the burden of taxes and generated revenues across incomes.
Just as nature distributes heat evenly, the optimal way for a government to raise revenues is to
distribute the tax burden and raised revenues evenly among individuals. We then construct a
gradient flow of taxes – a dynamic process changing the existing tax system in the direction of
the increase in tax revenues – and show that it takes the form of a heat equation. The fairness
principle holds also for the short-term asymptotics of the gradient flow. The gradient flow is a
continuous process of a reform of the nonlinear tax and thus unifies the variational approach to
taxation and optimal taxation


Stefan Steinerberger
Yale University
Department of Mathematics
10 Hillhouse Avenue
New Haven, CT 06510
stefan.steinerberger@gmail.com

Aleh Tsyvinski
Department of Economics
Yale University
Box 208268
New Haven, CT 06520-8268
and NBER
a.tsyvinski@yale.edu
Introduction
The classic static optimal nonlinear income taxation problem (Mirrlees 1971) is one of the
prototypical examples of mechanism design problems.1 Diamond (1998) and Saez (2001) derive
expressions for the optimal taxes that are widely used in public finance. Yet, even in the simplest
cases, those do not provide closed-form solutions or a full characterizaton for the optimal income
tax. The solution is a coupled system of differential equations and has relatively few known
characteristics.2
    A new aspect of our analysis is in the application of dynamical methods to static mechanism
design problems. Starting from a given tax (either optimal or suboptimal), we associate with it
a dynamical system – the analysis of which yields a new view of the problem. This dynamical
system is tightly connected to a heat equation, one of the most well-studied and well-behaved
partial differential equations.
    Our main result shows that the optimal tax satisfies a certain invariance relationship which
we call a fairness principle. The fairness principle states that an optimal tax at a given income
is equal to the properly weighted average of the taxes at all other incomes. We call it “fair” not
because the planner has a social welfare function that places a weight on equality but rather
that it is efficient to treat agents at various incomes similarly. In this sense, fairness is a different
version of smoothing the burden of the deadweight losses of taxes and raising revenues.
    We start by analyzing the static optimal nonlinear income tax. We associate with the
equation determining the optimal tax a dynamical object – the heat kernel which determines
a family of averaging functions at different times (or scales). We show that the optimal tax is
invariant under the heat kernel. Specifically, the optimal tax at any given income is determined
as a weighted average of the optimal taxes at other incomes and of income densities. Importantly,
we show that this averaging is done at all times (scales). What we mean by this is that as the
heat kernel is spreading wider (with, say, time), the optimal tax is equal to the average tax at
the wider sets of incomes and income densities: from the weight placed on incomes just around
the point to more and more incomes. In other words, the planner at the optimum ensures
that the deadweight loss or the behavioral effect of taxes is distributed fairly – as the weighted
average of taxes at all scales. This behavioral effect is added to the statutory impact of taxes
or the mechanical effect which is also a weighted average over all scales of income densities. A
fact of crucial importance is that the fairness principles for different scales are tightly linked via
the so called semigroup property and is thus far from arbitrary. That is, there is one unified
weighting scheme across all of the income scales. We then show that the behavior of the heat
kernel is essentially Gaussian. For any time (scale), we provide a Gaussian upper bound that
shows that the heat kernel decays as the Gaussian. For the small time asymptotics, the heat
kernel is exactly a Gaussian scaled by the density and the elasticity at the given income at the
   1
     See, e.g., the book by Salanie (2011).
   2
     See, e.g., Hellwig (2010) for the state-of-the art analysis of incentive problems with unidimensional charac-
teristics.



                                                        2
optimum. A corollary of the fairness principle is a formula determining the optimal marginal
tax by the global behavior of the level of the optimal tax code. These results are new to the
taxation and mechanism design literature.
    Second, we construct a gradient flow for any initial (optimal or suboptimal) tax function. The
gradient flow is a dynamical system that changes the underlying tax function in the direction of
the steepest descent of the tax revenue functional. We show that the fairness principle also holds
along the trajectory of the gradient flow. Specifically, we prove that the small time behavior of
the gradient flow (that is, the short-time asymptotics) is such that the evolved tax is equal to the
Gaussian average of the current taxes at all incomes and income densities, where the Gaussian
is adjusted by the density and the elasticity at the current tax system. The optimal tax is a
stationary point of the gradient flow. That is, starting from the optimum both the averaging
and the agents’ behavior stays constant.
    We then propose to use the operator-splitting methods corresponding to the changes in the
tax revenues and to the agent’s behavior and show that the gradient flow is a heat equation
within each step of operator splitting. The operator splitting technique has a natural economic
meaning. On the trajectory of the tax reform, the government, for an infinitesimally short time,
evolves taxes in the direction of increased revenues, keeping the density of agents’ incomes and
elasticities fixed at their value observed in the current economy. Then the densities and the
elasticities are recomputed. That is, the government evaluates the changes in revenues under
the current information given by the exogenous sufficient statistics evaluated at a given time.3
Within each step of this process, the gradient flow of tax revenues is a heat equation. Having
identified the heat equation as the principal object governing the evolution of the tax function,
there is a wealth of additional results one can obtain to study its behavior. We primarily focus on
showing that the gradient flow possesses a very nice underlying smoothing structure. First, we
show that the gradient flow is trying to smooth out the rough irregularities in the tax schedule.
That is, it acts first in the income regions which have the largest deviation of the marginal
tax from the properly defined reference point. These deviations are weighted by the natural
weighing measure that depends on the labor income elasticity and the density of the incomes.
Second, we show that the reform viewed as the gradient flow leads to the continuous tax systems,
mollifying any tax scheme instantaneously. Third, we use the Sturm-Liouville theory to describe
further characteristics of the gradient flow and, in particular, to show exponential decay of the
variability of the tax system compared to the reference point.
    The fact that the gradient flow gives rise to a law of motion for the tax function characterized
by a parabolic PDE (namely, a heat equation) is subtle and is at the essence of the economics
of the problem. The well-known and much studied heat equation arises in a new, and possibly
surprising, setting: in an environment where a government is interested in collecting income
tax revenue and the agents are heterogeneous in their skills. In a broad sense, the agents and
the government have opposing objectives: to maximize revenue for the government, and to
  3
      See, e.g., Kleven (2018) for a recent review of the sufficient statistics approach in taxation.



                                                           3
maximize the utility for the agents, given taxes. We show, among other things, that a local
process where the government tries to maximize its income via taxation leads, in a natural
way, to the heat equation. Just as nature wants to distribute heat evenly on a background
(leading to the spreading of heat), the optimal way for a government to raise revenues is to
distribute the tax burden and raised revenues evenly among individual subjects – this is perhaps
particularly surprising. This fairness is indeed a phenomenon coming from agents adapting to
uneven taxation systems by working more or less, respectively. We believe this to be a new way
of arriving at the heat equation and a new tax and revenue smoothing result in taxation.
    The construction of the dynamical system that we propose also contributes to unifying
the optimal and the variational approach to taxation. The variational approach considers a
potentially suboptimal tax and proceeds with varying it locally to derive the formulas for the
effects of the tax reforms.4 When considering the effects of the local tax reform, a natural
question to ask is whether there is a process of reforms that may lead to the optimum. Tirole and
Guesnerie (1981) construct such a process for linear taxes based on gradient projections, leading
to an ordinary differential equation. The environment with nonlinear taxes is significantly more
challenging as now the whole tax function is evolved as opposed to just one linear tax – we
therefore have the steepest descent path in a space of functions. We have constructed such
a process that leads, within each step, to a well-behaved partial differential equation. One
advantage of this process is that it uses, similarly to the variational approach, only the current
information about the economy, such as elasticities and the density of incomes. The second
advantage is that it gives rise to one of the most regular and well-behaved mathematical objects
– the heat equation – allowing for a wealth of characterizations. Additionally, our analysis
shows that continuous version of the iterative fixed point method commonly used for computing
optimal taxes (see, e.g., Brewer, Saez, and Shepard 2010) can be represented within each step
as a heat equation.
    Our analysis of the static taxation problem from the dynamical point of view, the con-
struction of the gradient flow, and the analysis of the optimum and the gradient flow from the
dynamical perspective are new to the mechanism design and optimal taxation literature.
    More broadly, there are several papers that are connected to our work. Bolton and Harris
(2010) is perhaps the most comparable in terms of the approach. They associate a dynamic risk
sharing rule with that of the static problem. Furthemore, Bolton and Harris (2010) obtain an
elegant asymptotic expansion of the dynamic problem around a myopic optimum showing how
the static problem is modified by the dynamic correction terms.
    Sonnenschein (1981, 1982) and Artzner, Simon, and Sonnenschein (1986) derive a heat equa-
tion as a gradient process of the firms adjusting the commodity they produce by maximizing the
   4
    See, e.g., Saez (2001), Kleven and Kreiner (2006), and Golosov, Tsyvinski, and Werquin (2014) for the
methodology; Kleven, Kreiner, and Saez (2009) and Jacquet and Lehmann (2015) for the analysis of the multidi-
mensional types; Saez and Stantcheva (2016) and Bierbrauer and Boyer (2018) for the political economy context;
Sachs, Tsyvinski, and Werquin (2016) and Scheuer and Werning (2016) for the analysis in general equilibrium;
and Saez and Stantcheva (2018) for capital income taxation.




                                                      4
rate of change in profit subject to a quadratic cost of adjustment. McCann (2014) argues that
this result is a precursor to some of the results on the gradient flows in the optimal transport
literature.5
    Some of the techniques that we use have parallels in the optimal transport literature (see,
e.g., Villani (2003)) in which there is a renewal of interest in economics (see, e.g., early work
of Chiappori, McCann, and Nesheim (2010), a comprehensive book by Galichon (2016), or a
review in the context of matching models by Chiappori and Salanie (2016)). One important
result in the optimal transport literature is showing that a Fokker-Planck equation arises as a
gradient flow in a Wasserstein space (Jordan, Kinderlehrer, and Otto (1998)). In mechanism
design, optimal transport has been recently used in the context of multi-dimensional screening
by Figalli, Kim, and McCann (2011) and Daskalakis, Deckelbaum, and Tzamos (2017).
    Our analysis is interesting also from the purely mathematical point of view. The heat
equation is a classical object in mathematics and physics (indeed, so classical that Fourier’s
specific way of solving it via trigonometric series is the origin of harmonic analysis, an entire
subfield of mathematics). Its importance suggests that it should indeed appear in a wide variety
of settings. Here, we present a new setting in which the heat equation naturally arises.
    The paper is structured over two main parts that while connected are self-contained. Section
3 deals with the optimal nonlinear tax. Section 4 deals with the gradient flow of taxes.


1        Environment
For clarity of exposition, we start by presenting the simplest economic environment of tax
mechanisms.

1.1        Individuals
Agents are characterized by an exogenous and fixed productivity type θ ∈ Θ ⊂ R+ . Preferences
over consumption c and labor effort l are represented by the utility function U (c, l) = c − v (l),
where the disutility of labor effort v is twice continuously differentiable, increasing and strictly
convex. The government levies a tax liability T : R+ → R which can be an arbitrarily non-
linear function of the individual’s labor income y = θ × l. The agent’s budget constraint is
c = θl − T (θl).
    The optimization problem of an individual with type θ reads:

                                                max θl − T (θl) − v(l).                         (1)
                                                l≥0


We denote by l(θ, T ) ∈ R+ the argmax of this problem and by y(θ, T ) ∈ R+ the agent’s labor
income. For ease of notation, when there is no ambiguity we remove the argument T from these
variables and write them as l (θ), y (θ).
    5
        See also Blanchet and Carlier (2015).



                                                         5
Characterization of individual behavior. Assuming that the tax function T is continu-
ously differentiable, labor income y (θ) ≡ y(θ, T ) is characterized by the first-order condition:
                                                                       
                                                                 y(θ)
                                     1 − T 0 (y (θ)) = v 0        θ
                                                                            1
                                                                            θ   .                          (2)

We assume that no individual θ is indifferent between two or more incomes in the initial equilib-
rium: for all θ, the individual problem (1) has a unique global maximum given the tax system
T . It is straightforward then to show that there is a one-to-one map between productivity types
θ and pre-tax incomes y(θ).

Productivity and income distributions. We denote by H (θ) the c.d.f. of θ ∈ Θ, and by
h (θ) the corresponding density function. We assume that the set Θ is a compact interval of
R+ , and that the density of types h is equal to zero at the boundaries of Θ. We also denote by
Φ (y) and φ (y) the c.d.f. and the p.d.f. of incomes y ∈ Y ⊂ R+ . We assume that the density
of incomes φ is continuous and bounded away from zero on any finite interval [y, ȳ] ⊂ Y with
y > 0.6

1.2    Government
We define government revenue by
                                                 Z
                                    R (T ) =           T (y(θ, T ))dH (θ) .                                (3)
                                                   Θ

It is equal to the sum over agents θ ∈ Θ of the tax liability on their income y(θ, T ), taking into
account their optimizing behavior given the tax system T .7
     We denote by
                                       ∂ ln(1 − T 0 (y))    yT 00 (y)
                             p (y) = −                   =
                                            ∂ ln y         1 − T 0 (y)
the local rate of progressivity of the tax schedule. It is equal to (minus) the elasticity of the
retention rate 1 − T 0 (y) with respect to income y (see, e.g., Musgrave and Thin (1948)).

1.3    Taxable income elasticity
The structural labor supply elasticity of agent θ with respect to the retention rate r (θ) =
1 − T 0 (y(θ)) is defined by
                                      ∂ ln y (θ)      v 0 (l (θ))
                             e (θ) =             =                    .
                                      ∂ ln r (θ)   l (θ) v 00 (l (θ))
   6
     Our results can be straightforwardly generalized to the case of types and incomes in the whole space R+ by
using an increasing sequence of compact sets Θ, Y ⊂ R+ .
   7
     It is immediate to extend our results to the case of the government maximizing a social welfare function.




                                                        6
We define the compensated labor income response along the non-linear budget constraint by

                                            y (θ)       e (θ)
                                ε (θ) =                             .                          (4)
                                            r (θ) 1 + p(y (θ))e (θ)

Assuming that there is a one-to-one map between types θ and incomes y (θ), we can equiva-
lently denote the labor supply responses ε (θ) by ε (y). In the sequel we use both notations
interchangeably. We assume that ε (y) is continuous and bounded away from zero on any subin-
terval [y, ȳ] ( Y.
    The variable ε (θ) is equal to the partial derivative of labor income y (θ) with respect to the
retention rate r (θ), normalized by the term 1 + p(y (θ))e (θ). Intuitively, this term accounts for
the fact that the agent’s labor income adjustment in response to an exogenous increase in his
retention rate r (θ) leads to an endogenous shift in his tax rate by p(y (θ)), which in turn causes
a further labor income adjustment e (θ). Solving for the fixed point leads the total response (4).


2     Tax reforms and optimum taxation
In this section we define a notion of local tax reforms, and derive their effects on individual
behavior and government revenue. We then derive a formula for the optimal tax. All of the
results in this section are standard in the literature.

2.1   Variations of taxes
We define a direction of reform of the tax function T as a continuously differentiable function
T̂ : R+ → R. The perturbed tax function is then T + µT̂ , where µ > 0 is the size of the reform
in the direction T̂ . In this section, we derive the first-order change in government revenue R(T )
in response to the tax reform µT̂ as µ → 0. That is, we compute the Gateaux differential of the
functional T 7→ R(T ), formally defined by:

                                                R(T + µT̂ ) − R(T )
                             δR(T, T̂ ) ≡    lim                    .
                                            µ→0         µ

   We first describe the impact of a tax reform T̂ of the tax schedule T on the government
revenue.

Lemma 1. The Gateaux differential of government revenue in the direction T̂ is given by:
                           Z                    Z
             δR(T, T̂ ) =     T̂ (y) φ (y) dy −   T 0 (y) ε (y) T̂ 0 (y) φ (y) dy.       (5)
                                  Y                    Y


Proof. The Gateaux differential of the government revenue functional in the direction T̂ is given
by:




                                                   7
                                      Z                        Z
                      δR(T, T̂ ) =         T̂ (y) φ (y) dy +       T 0 (y) δy (θ) φ (y) dy,
                                       Y                       Y

   where the differential of the agent’s income δy (θ) is given by the Gateaux differential of the
agent’s first order condition (2):
                                                                                   
                           00                     0                00       y (θ)       1
                        −T (y (θ))δy (θ) − T̂ (y (θ)) = v                                  δy (θ) .
                                                                              θ         θ2

Solving for δy and using the definition of elasticity ε (y) gives δy (θ) = −T̂ 0 (y (θ))ε (y (θ)) .

    Equation (5) shows that the first-order effect of the tax reform T̂ on government revenue,
δR(T, T̂ ), is given by the sum of two terms. The first integral on the right hand side is the
statutory impact of the reform, i.e., the amount of revenue raised mechanically by changing the
tax payment of each agent with income y by T̂ (y). This term simply sums these additional tax
payments over the whole population, using the density of incomes φ (·), assuming that everyone’s
behavior remains unchanged following the reform. The second integral is the excess burden, or
the deadweight loss, of the tax reform. Specifically, consider the agents who earned income y
in the initial equilibrium, i.e., before the tax reform. An increase in their marginal tax rate
by T̂ 0 (y) lowers the labor income of these agents by ε (y), by definition of their labor income
response along the non-linear initial tax schedule. This in turn reduces government revenue by a
fraction T 0 (y) of this income loss. Summing these effects over the population using the density
of incomes φ (·) leads to expression (5).
    Note that this expression gives the effects of tax reforms T̂ (y) in closed-form since all of the
variables (the tax schedule T (y), the labor supply elasticities ε (y), the density of incomes φ (y))
are observed or can be estimated empirically in the economy with the given tax T (y).

2.2    Optimal Tax
Lemma 1 provides a formula for the revenue effects of any tax reform T̂ in the economy starting
from any, optimal or suboptimal, tax schedule T .
     We now obtain a characterization of the optimal (i.e., government revenue maximizing) tax
schedule T∗ by imposing that no tax reform has a non-zero first-order effect on government
revenue, i.e., δR(T∗ , T̂ ) = 0 for all T̂ : R+ → R. Let ε∗ (y), φ∗ (y), and Φ∗ (y) denote the
compensated labor income response and the p.d.f. and c.d.f. of incomes given the tax schedule
T∗ .
     Integrating by parts the Gateaux differential of the government revenue functional (5)
                                Z                       Z
                                                                         d
                                                                           T 0 (y) ε (y) φ (y) dy,
                                                                                              
                 δR(T, T̂ ) =       T̂ (y) φ (y) dy +       T̂ (y)
                                Y                       Y               dy




                                                        8
   and setting it to zero for any T̂ (y) yields:

                                               d
                                                 T∗0 (y) ε∗ (y) φ∗ (y) .
                                                                      
                               0 = φ∗ (y) +                                                      (6)
                                              dy

  Integrating with respect to y yields the the following Corollary (due to Mirrlees 1971, Dia-
mond 1998, Saez 2001).

Corollary 1. The optimal tax schedule T∗ satisfies: for all y ∈ Y,

                                                   1 1 − Φ∗ (y)
                                   T∗0 (y) =                    ,                                (7)
                                                 ε∗ (y) φ∗ (y)

    Formula (7) shows that the optimal marginal tax rate at income level y is the product of
two terms. First, it is proportional to the inverse compensated labor income response to tax
rates at income y, 1/ε∗ (y): the higher the disincentive effect of marginal tax rates, the lower
the optimal tax rate. The second term is related to the hazard rate of the income distribution,
(1 − Φ∗ (y))/(φ∗ (y)) and is a benefit-cost ratio that measures the fraction of agents whose tax
liability increases by a lump-sum amount in response to a marginal tax rate increase at income
y, relative to the fraction of agents whose labor supply is distorted.
    It is important to note that, while certainly important to gain economic insights, the formula
(7) is not a full solution for the optimum tax as y itself does depend on T in a nonlinear way
since individuals optimize with respect to the tax code.
    It is useful to discuss two different variants of the optimal tax formula used in the literature.
Saez (2001) derives the formula that is identical to (7). On the left hand side of this formula is
the marginal tax on income which is the main object of interest. The right hand side is, however,
defined over endogenous variables – the elasticity along the nonlinear budget constraint ε∗ (y),
the density φ∗ (y) and the c.d.f. Φ∗ (y) of incomes are evaluated at the optimum and hence
themselves depend on the income tax schedule T∗ (y). The Diamond (1998) formula, in the case
                                               1+1/
of iso-elastic preferences for labor v (l) = l1+1/ , is given by

                                 T∗0 (y (θ))
                                                               
                                                            1       1 − F (θ)
                                               =       1+                     .
                               1 − T∗0 (y (θ))                       θf (θ)

    The right hand side is a closed-form expression, since the distribution of types θ (cdf F ,
pdf f ) is exogenous and the elasticity  is given. However, the left hand side is not a closed
form expression for the income tax schedule T (·). Indeed, note that the left hand side gives the
marginal tax rate faced by a type θ. But this tax rate is evaluated at the income y (θ) that the
agent earns given the (optimal) tax schedule. This variable is endogenous, and is given as the
implicit solution to the first order condition of the agent, which obviously does not give y (θ) as
a function of θ in closed form (even with the isoelastic functional form of the disutility of labor).
In other words, the Diamond formula gives the tax on the type θ. We are interested in the tax



                                                   9
schedule in the space of incomes. However, the relationship between the income and the type
is unknown. In fact, it is the essence of the nonlinear income tax problem that the types are
unobservable and the tax schedule is over incomes. The Diamond and the Saez formulas are
essentially identical to each other and neither provides a full characterization of the optimum.


3     The optimal tax and the fairness principle
In this section, we provide a new property of the optimum – the fairness principle – viewing the
static optimal taxation problem from a dynamical point of view.
    First, we rewrite the optimal static
                                        tax formula
                                                    in an operator notation. Consider a second
                                 ∂          ∂
order differential operator L = ∂y σ∗ (y) ∂y , where σ∗ (y) = ε∗ (y) φ∗ (y) . The optimal tax in
(7) is then given by
                                           LT∗ = −φ∗ .

    It is known that operators of this type can be associated with the heat kernel (Grigor’yan
2009). We also show in Section 4 that the heat equation arises from studying the gradient flow
of the tax reform, that is, the trajectory of the steepest increase in revenue. The static optimal
tax is a stationary point of such a dynamical system.
    For the analysis of the optimal tax we proceed as follows. We first introduce the heat kernel
and show that the optimal tax satisfies a certain invariance property – the fairness principle –
with respect to this object. Specifically, the optimal tax at a given income can be represented
as the weighted (by the heat kernel) average of the optimal taxes at the other incomes. We then
characterize the form of the heat kernel and show that it behaves as a Gaussian average that
proportionally downweights more distant incomes. This weighting is indexed by time (or, maybe
more intuitively, by scale) where averaging is done over a broader set of incomes. Importantly,
this weighting is tightly connected to each other at every scale, thus providing one unifying
weighting scheme at every scale (or set of incomes). Finally, we show a representation of the
optimal marginal income tax as well as the higher derivatives of the optimal tax schedule in
terms of the levels of the optimal taxes.
    We first introduce the heat kernel. Let qt (x, y) be the heat kernel given by the solution to
the Kolmogorov forward equation
                                                                             
                               ∂              ∂                     ∂
                                  qt (x, y) =          ε∗ (y) φ∗ (y) qt (x, y) ,                                (8)
                               ∂t             ∂y                    ∂y

   and limt→0 qt (x, y) = δ (x − y), where δ is a Dirac delta function.8
   An example of the heat kernel is a Gaussian in Figure 1, we show later in this section that the
heat kernel satisfying equation (8) behaves similarly to the Gaussian. The heat kernel qt (x, y),
   8
     The kernel qt (x, y) solves both the forward and the backward Kolmogorov equation ∂t qt (x, y) = Ly qt (x, y) =
Lx qt (x, y) .




                                                         10
for a given income x, is a function of two variables – income y and time t. One can think of
time as a different scale over incomes. At time (scale) zero, the kernel puts the weight one on
income x. The larger times (scales) average and encompass a wider set of incomes.
    We now state and prove the new property of the optimal tax – the fairness principle.

Proposition 1. (Fairness principle for the optimum). The optimal tax T∗ (y) is invariant under
the heat kernel qt (x, y) given by (8), for any x ∈ Y and any t > 0:
                                   Z tZ                                    Z
                     T∗ (x) =                qs (x, y) φ∗ (y) dyds +           qt (x, y) T∗ (y) dy.   (9)
                                       0

Proof. Consider the derivative
                               Z                                Z
                          ∂                                         ∂
                                    qt (x, y) T∗ (y) dy =              qt (x, y) T∗ (y) dy =
                          ∂t                                        ∂t

by Kolmogorov forward equation
                                Z                                  
                                       ∂                  ∂
                           =                 ε∗ (y) φ∗ (y) qt (x, y) T∗ (y) dy =
                                       ∂y                 ∂y

integrating twice by parts and rearranging
                                   Z                                         
                                                 ∂                     ∂
                            =          qt (x, y)          ε∗ (y) φ∗ (y) T∗ (y) dy =
                                                 ∂y                    ∂y

using equation (6)                                 Z
                                              =−          qt (x, y) φ∗ (y) dy.

Integrating the equation
                                Z                                    Z
                           ∂
                                       qt (x, y) T∗ (y) dy = −           qt (x, y) φ∗ (y) dy,
                           ∂t

we get               Z                                              Z tZ
                         qt (x, y) T∗ (y) dy = T∗ (x) −                    qs (x, y) φ∗ (y) dyds.
                                                                     0




    This proposition states that the optimal tax T∗ (x) is fair in the following sense – the optimal
tax at a given income x is equal to the weighted (by the heat kernel) average of taxes at other
incomes and income densities. The level of the optimal tax at a given income x is determined
as the average of taxes at all other incomes and at all times (scales) t. We start by focusing
                                          R
on the more interesting second integral, qt (x, y) T∗ (y) dy, in (9). Since this term arises from
the behavioral effect of taxation it means that the planner smoothes the distortions or the
deadweight loss of taxes at every scale t. The averaging is done with the 1-parameter family of


                                                              11
local averaging functions qt (x, y), where each function corresponds to one particular instance
of the underlying fairness principle. In other words, the optimal tax wants to ensure that an
agent at a given income x is paying roughly the average of the amount of taxes paid by people
working just a little less or just a little more (“little less” or “little more” is determined by the
heat kernel that downweights the more distant incomes). This quantifies an underlying notion
of fairness that is in no way built into the system. The first integral represents the mechanical
effect of raising taxes and is a weighted average of all densities of incomes y at all times (scales)
t.9 Of course, our term fairness has nothing to do with the notions of the social welfare function
or the redistributional preferenes for the government. In fact, the government here maximizes
revenues. Yet, the most efficient way to raise revenue is to do it fairly in the sense of equating
(with certain weights) the tax at any income to the taxes of incomes at all scales.
    The key to our results is to view the static optimal tax from the dynamic point of view
by associating the heat kernel qt (x, y) with the operator L determining the optimal tax. The
optimal tax T∗ (x) is of course time-independent. Yet, one can think of it as being invariant
under a dynamic system that starts from this tax and applies the heat kernel qt (x, y) to it. At
time 0, the optimal tax is just equal to itself – thus being trivially fair. As time goes on, the
heat kernel shows that the optimal tax is fair in the sense that it is equal to the average over
an increasingly wider distribution qt (x, y). One can alternatively think of the variable t not as
time but as a scale – and the tax being fair at each scale t encompassing the weight of more and
more incomes. We expand on the dynamic system interpretation of the optimum in the next
section where the optimum arises as a stationary point of a gradient flow.




                                                       y

Figure 1: The heat kernel qt (x, y) for various times t (smaller times correspond to larger maxima).

   The precise form of the fairness principle depends on the precise form of qt . We now turn to
the more detailed characterization of the heat kernel.
Proposition 2. (1) The heat kernel (8) satisfies a Gaussian upper bound, for any t > 0:

                                                               (x − y)2
                                                                       
                                          c1
                              qt (x, y) ≤ √ exp (c2 t) exp −c3            ,
                                            t                      t
   9
    One reason why this term is somewhat less central is that, for small t, it is of the smaller order then the
second integral term (see Proposition 3 and footnote 16).



                                                      12
for some positive constants c1 , c2 , c3 ;
    (2) For t → 0,
                                                                                       !
                                               1        (y − x − σ∗0 (x) t)2
                         qt (x, y) ∼ p            exp −                                    ,
                                       4πσ∗ (x) t            4σ∗ (x) t

where σ∗ (x) = ε∗ (x) φ∗ (x);
   (3) For all point x, y and all times t, s > 0, the heat kernel satisfies the semigroup property:
                                                         Z
                                       qt+s (x, y) =         qt (x, z)qs (z, y)dz.

    This proposition shows that the heat kernel essentially behaves similarly to the properly
scaled Gaussian average.10 The first part of the proposition shows that the heat kernel satisfies
a Gaussian upper bound for all times t. The second part of the proposition shows that for short
t, the heat kernel is exactly the Gaussian. The third part of the proposition shows a fact of
crucial importance – the heat kernels are tightly linked in at all time scales. We now provide a
more extensive discussion of these results.
    The heat kernel qt is in general a very benign object that is fairly easy to compute to any
desired degree of accuracy. Three basic properties are (1) qt (x, y) ≥ 0, (2) qt (x, y) = qt (y, x)
and (3) preservation of integral mass
                                                   Z
                                                       qt (x, y)dy = 1.

We can thus, for a given point x, understand qt (x, y) as a one-parameter family of probability
distributions in the variable y. This motivates understanding them as averaging objects. A
classical result of Aronson (1968) is that the heat kernel qt (x, y) on a general manifold M
(satisfying very mild regularity assumptions) satisfies what is called a Gaussian upper bound

                                                    d(x, y)2
                                                            
                                        c1
                         qt (x, y) ≤          exp −            ,          ∀t > 0, x, y ∈ M,
                                       tn/2           c2 t

where d(x, y) is the geodesic distance between x and y, and c1 and c2 are positive constants.
In particular, while the heat kernel qt (x, y) may no longer look like a Gaussian centered at y
having variance t, it certainly has the same decay behavior. That is, it acts as a local averaging
                            √
operator at scale d(x, y) ∼ t. In other ways, the fairness principle averages the nearby income,
                                         √
where the nearby is given by the scale t.11 In the proposition, we use a slightly more general
  10
     In one dimension that we have, the body of literature on parabolic PDEs shows that for almost any modifi-
cation of the problem, the heat kernel looks and behaves exactly as a Gaussian – this is true for the heat kernels
on arbitrary manifolds, for very wide classes of conductivities σ, and for a very broad range of spaces (see e.g,
Grigor’yan (2009) or Bogachev, Krylov, Röckner, and Shaposhnikov (2015) for extensive reviews).
  11
     If one is interested in the higher order expansions, those can be straightforwardly derived in closed form to
any order using the parametrix method which represents the heat kernel as the sum of the Gaussian and the




                                                             13
result in Metafune, Ouhabaz, and Pallara (2011).
    Finally, the classical results for the short-time asymptotics (see, e.g., Varadhan (1967),
Molchanov (1975), and Grigor’yan (2009)) imply that for t → 0, the heat kernel is the Gaussian
with the scale determined by the conductivity parameter ε∗ (x) φ∗ (x). In the next section, we
provide additional results and intuition for this small time asymptotics.
                                                                                            √
    Returning to the interpretation of qt as creating an averaging operator at scale ∼ t, the
third part of the proposition shows the fairness principles for different scales are linked. A fact
of crucial importance is that they are tightly linked via what is known as the semigroup property
(see, e.g., Grigor’yan 2009). This shows that the behavior of qt is tightly linked to both past and
future behavior of the heat kernel and is thus far from arbitrary. That is, there is one unified
weighting scheme at all income scales.
    We now obtain from Proposition 1 the corresponding representation for the marginal tax.

Corollary 2. The fairness principle is invariant under differentiation and implies that the
marginal tax is given by
                            Z tZ                               Z              
              ∂                       ∂                              ∂
                 T∗ (x) =                qs (x, y) φ∗ (y) dyds +        qt (x, y) T∗ (y) dy,
              ∂x             0        ∂x                             ∂x

for any x ∈ Y and any t > 0

     The relevant quantity, ∂x qt (x, y), is quite simple to understand in one dimension: since
qt (x, y) is a probability distribution, its derivative has total integral 0. This means that ∂x qt (x, y)
has a positive part and a negative part with the same total L1 −mass and acts as a discrete dif-
ferentiation operator. We plot it in Figure 2 (together with the higher derivatives of qt (x, y)).
In economic terms, the integral evaluates a weighted average of taxes paid by individuals with
slightly higher incomes, subtracts a weighted average of taxes for individuals with slightly lower
incomes, and this results in the quantity determining the size of the marginal tax T∗0 (x). More-
over, this fairness principle for the marginal tax holds, as the original fairness principle, for all
t > 0.
     It is an elementary mathematical fact that given any function f ∈ C 1 (R), it is possible to
change it ever so slightly into a function f2 ∈ C 1 (R) such that f1 and f2 give almost the same
values everywhere
                                         max |f1 (x) − f2 (x)| ≤ ε
                                            x∈R

but f2 has a very different derivative

                                                                   1
                                          max |f10 (x) − f20 (x)| ≥ .
                                          x∈R                      ε

Put differently, even a very good understanding of the optimal tax code T∗ need not a priori
higher order corrections (see, e.g., Friedman (2008)).




                                                         14
                                                         y




           Figure 2: qt (dashed), its derivative qt0 and its second derivative (bold) qt00 .


translate into a good understanding of the marginal tax T∗0 . We show here that this is not the
case, the marginal tax is uniquely determined by the global behavior of the optimal tax code.
    One way of interpreting this statement is as follows: for any function f ∈ C 1 , f at a point is
the local average of its neighboring values (indeed, this follows from continuity and boundedness
and does not require differentiability)
                                             Z
                                       lim       qt (x, y)f (y)dy = f (x).
                                      t→0+

The fairness principle states that the optimal tax code satisfies a much stronger relationship
                                Z tZ                               Z
                     T∗ (x) =           qs (x, y) φ∗ (y) dyds +        qt (x, y) T∗ (y) dy
                                 0

for all times t > 0. We can now see whether there is an analogous result for the derivative.
Differentiating the fairness principle yields
                          Z tZ                                Z              
            ∂                        ∂                              ∂
               T∗ (x) =                 qs (x, y) φ∗ (y) dyds +        qt (x, y) T∗ (y) dy
            ∂x            0          ∂x                             ∂x

and it is of interest to understand whether there is an analogous result for all functions f .
We perform the relevant computations, for simplicity of exposition, for the heat kernel of the
Laplacian on R, i.e.
                                                 1 − |x−y|2
                                   qt (x, y) = √     e 4t .
                                                 4πt
A simple computation shows that

                                     ∂                (x − y) |x−y|2
                                        qt (x, y) = − √ 3/2 e− 4t
                                     ∂x              4 πt




                                                        15
and from this we see that
                                           Z                
                                                 ∂
                                     lim            qt (x, y) f (y) dy = f 0 (x)
                                    t→0+         ∂x

This follows easily from a Taylor expansion of f around x. While this relationship is true for all
continuous f ∈ C 1 (R), it only holds in the limit t → 0. In contrast, as shown by the derivative
of the fairness principle, the optimal tax code T∗ satisfies a relationship of this type for all t > 0.
The same principle holds for higher derivatives, and these results can be obtained in the same
manner.
    Summarizing, in this section we derive a new characterization of the optimal tax. The
fairness principle, while still of course not a closed-form solution, provides a new set of insights
on the nature of the optimal tax.


4        Gradient flows of taxes
We now turn to the analysis of taxes from a different point of view. We construct a dynamic
system, a gradient flow, which starts at any (optimal or suboptimal) tax function and then
changes the tax system in the direction of the increased revenues. The optimal tax is a stationary
point of this system.
    In this section, we use the straightforward adaptation of notation in Section 1 to index the
relevant variables by time.
    We start by formally defining the gradient flow.

Definition 1. For all t ≥ 0 and y ∈ Y, the gradient flow of the government revenue functional
R(Tt ) is defined as the dynamical system:

                                 ∂Tt (y)                    ∂ 0
                                            = φt (y) +        [T (y) εt (y) φt (y)],                               (10)
                                   ∂t                       ∂y t

where φt is governed by Tt according to the change of variables φt (y (θ)) = (yt0 (θ))−1 h (θ) and
by equation (2).12

4.1      Mathematical foundations
Finite-dimensional spaces. Gradient flows are natural mathematical objects attached to
functions or functionals, mapping to real numbers. For simplicity, start with a differentiable
function V : Rn → R and define the gradient flow as a curve x : [0, ∞] → Rn starting at some
point x0 ∈ Rn with the property that the curve always flows in the direction of steepest descent
    12
    If the government is social welfare maximizing, it is immediate to show that the gradient flow has the form
of ∂T∂t
     t (y)                         ∂
           = φt (y) (1 − γt (y)) + ∂y [Tt0 (y) εt (y) φt (y)], where γt (y) is the social marginal utility of income (see
Diamond (1975)).




                                                           16
of V . Intuitively, this direction is determined by the gradient of V . Formally, we want to choose
the vector x̂ ∈ Rn with kx̂k`2 = 1 that minimizes

                                 1
                           lim     [ V (x + µx̂) − V (x) ] = h ∇V , x̂ i`2 ,
                          µ→0    µ

where the equality follows from the definition of the gradient. This gives rise to an ordinary
differential equation that describes the law of motion of xt ∈ Rn for t ≥ 0:

                                        d
                                           xt = − ∇ V (xt ),
                                        dt

with the property that V is decreasing along the flow of x since

                            d                d
                               V (xt ) = h∇V, xt i = −k∇V (xt )k2 < 0.
                            dt               dt

While this model is rather classical and the existence and uniqueness properties of the solution
are well known, understanding the actual dynamical behavior can pose considerable challenges
(recent examples being given by Tao (2017), Steinerberger (2018)).

Infinite-dimensional spaces. The very same principle can be applied in settings where the
underlying domain is not finite-dimensional but instead given by the space of functions. We
illustrate this with a representative example. We may define a functional Ψ by assigning to any
twice-differentiable function f ∈ C 2 (R, R), the number
                                                     Z
                                                 1
                                    V (f ) =              |f 0 (x) |2 dx.
                                                 2    R


It is easy to show that the Gateaux differential of V in the direction fˆ is given by δV (f, fˆ) =
          ˆ0                                                   (f, fˆ) = − R f 00 (x) fˆ (x) dx. More
R 0                                                                       R
  R f (x) f (x) dx. An integration by parts implies that δV
generally, for any function f ∈ C 2 (Rn , R), let V (f ) = Rn |∇f |2 . We then have δV (f, fˆ) =
                                                            R

             ˆ                                                                      ˆ            ˆ
R
  Rn ∇f · ∇f . By Green’s first identity, this can be represented as a functional f 7→ h−∆f, f iL2 ,
where ∆ denotes the Laplace operator, thus recovering the same structure as above. That is, in
order to flow in the direction of steepest descent of the functional V , we must set

                                           ∂
                                              ft = ∆ ft .
                                           ∂t

This gives rise to a law of motion for the function f characterized by a parabolic PDE (namely,
a heat equation). Needless to say, even showing that all of these operations remain valid for
any time t > 0 is a difficult task, the theory of partial differential equations being substantially
more challenging than that of ordinary differential equations.




                                                     17
4.2    The gradient flow of taxes
We now turn to the formal derivation of the the gradient flow (10). An integration by parts in
the second integral of equation (5) implies that the impact of the tax reform T̂t on government
revenue can equivalently be rewritten as
                                         Z
                                                                                       ∂ 0
                     δR(Tt , T̂t ) =           Λt (y) T̂t (y) dy, with Λt ≡ φt +         [T εt φt ]                    (11)
                                           Y                                           ∂y t

Assuming that the space of functions C 2 (R, R) is endowed with the L2 norm kT k2 = (T (y))2 dy,
                                                                                      R

this can be expressed as hΛt , T̂t i.13 Therefore, the gradient flow we obtain in this case can be
written as the dynamical system (10).
    The gradient flow (10) can be equivalently derived as the solution to the problem of choosing
the trajectory of the tax schedule t 7→ Tt that maximizes at each instant t the increase in
government revenue:

                                                             ∂
                                                    max         R(Tt ),
                                                     Tt      ∂t

in the L2 norm. Specifically, the evolution of government revenue R(Tt ) over time for a given
trajectory Tt is given by
                             Z                              Z                                      
       ∂                ∂                                         ∂Tt             0          ∂yt
          R(Tt ) =               Tt (yt (θ)) dH (θ) =                 (yt (θ)) + Tt (yt (θ))     (θ) dH (θ) .
       ∂t               ∂t                                        ∂t                         ∂t

Imposing that the individual’s first-order condition remains satisfied over time requires (by
differentiation of (2)) that
                                ∂yt               ∂T 0 (yt (θ))
                                     (θ) = −εt (θ) t            .
                                 ∂t                     ∂t
That is, at each instant, individual θ adjusts his income in the opposite direction and propor-
tionally to the change in the marginal tax rate that he faces.
    Plugging this equation back into the law of motion of government revenue and integrating
the second term by parts leads to
                          Z                                                                                   
         ∂                       ∂Tt            ∂                                                    ∂Tt (y)
            R(Tt ) =                 { φt (y) +   [ T 0 (y) εt (y) φt (y) ] } dy =          Λt (y) ,               .
         ∂t                      ∂t             ∂y t                                                   ∂t

This expression is maximized when              ∂Tt                    ∂    0
                                                ∂t (y)   = φt (y) +   ∂y [Tt (y)εt (y) φt (y)],   thus leading to (10).
  13
     We could have considered the weighted-L2 norm kT k2 = κt (y) (T (y))2 dy, for some weights κt (y) and
                                                                    R

this expression can be represented as hκ−1 t Λt , T̂t i with the resulting gradient flow
                                                                                         ∂Tt (y)
                                                                                           ∂t
                                                                                                 = (κt (y))−1 φ (y) +
        −1 ∂   0
(κt (y)) ∂y [Tt (y) εt (y) φt (y)]. The analysis for this case is identical. There is a re-interpretation of such a
weight as simply changing the metric of the underlying manifold R: put differently, one can interpret everything
as an equal-weight problem on a curved geometry; heat and associated processes are not very sensitive to “curving”
(heat propagates on a plane and on a sphere in roughly the same sense). See, e.g., Taylor (1996), Hörmander
(2003), and Grigor’yan (2009).




                                                            18
    For another way to understand the economic meaning of (10), consider the problem of
choosing the tax reform T̂ that maximizes the increase in government revenue, subject to the
following quadratic cost of reforming the tax payments:14
                                                     Z
                                                   1
                                max δR(Tt , T̂ ) −     (T̂ (y))2 dy.
                                 T̂                2 Y

Using the representation (11), the solution is given by

                                                    T̂t (y) = Λt (y) .

Now, the law of motion of the tax schedule in the small interval of time δt → 0 is given by
Tt+δt (y) = Tt (y) + T̂t (y) δt, or T̂t (y) = ∂T∂t
                                                t (y)
                                                      . We therefore obtain the gradient flow (10).

4.3       Short-term evolution and fairness property
In this section, we describe the short-term evolution of the tax schedule Tt̃ under the gradient
                                                                    
flow by solving the heat equation (10) over a short time interval t, t̃ . We derive a version of
the fairness principle that now applies to any point on the path of evolution of the tax system.

Proposition 3. (Fairness principle for the gradient flow). Consider any initial time t with
the corresponding tax profile Tt (y), density of incomes φt (y), elasticity εt (y), and conductivity
σt (y) = φt (y)εt (y). Then, for small t̃, the tax Tt̃ (y), generated by the gradient flow (10), is
given by a weighted Gaussian average of the incomes:

                                                  
                                                                     Z   ȳ
                                  Tt̃ (x) ∼ t̃ − t φt (x) +                   qt,t̃ (x, y) Tt (y)dy,
                                                                     y

                                                                         2
                                                                          
                                    1                 (y−x−σt0 (x)(t̃−t))
       where qt,t̃ (x, y) =   q                 exp −    4σt (x)(t̃−t)
                                                                            .
                               4πσt (x)(t̃−t)

Proof. The proof uses the Feynman-Kac formula for path integrals (Lorinczi, Hiroshima, and
Betz 2011) to study the short-time behavior of solutions of equations of the type (10). Let B (s)
denote the diffusion process that satisfies the SDE.

                                        dBs = σs0 (Bs ) ds +
                                                                     p
                                                                         2σs (Bs )dWs ,

where W is a Brownian motion. We then have
                                                   hR                   i
                                                      t̃
                                  Tt̃ (x) = E         t    φs (B (s)) ds + E[Tt (Bt̃ )],
  14
     Again, we can use weights κ (y) > 0 in the cost function (e.g., they can be equal to the density function
φt (y)) and derive essentially the same results.




                                                                19
where the expectation runs over the diffusion process Bs , started in y and running up to t̃.15
We can now perform a Taylor expansion of these quantities. Up to the first order, diffusivity
is constant at a certain scale. The short-time asymptotics for Brownian motion is then given by a
Gaussian distribution Bt̃ ∼ x+σt0 (x) t̃ − t + 2σt (x)Wt ∼ N x + σt0 (x) t̃ − t , 2σt (x) t̃ − t
                                             p                                                 

and
                                                                                    2 !
                                            1                 y − x − σt0 (x) t̃ − t
          distribution of Bt̃ ∼ q                    exp −                              .
                                      4πσ (x) t̃ − t              4σt (x) t̃ − t
                                                       t


Then, up to a first order for t̃ small,
                                         Z    t̃                         
                                                   φt (B (s)) ds ∼ t̃ − t φt (x) .
                                          t

This implies that
                                                        
                                        Tt̃ (x) ∼ t̃ − t φt (x) + E[Tt (Bt̃ )]
                                                                                    2 !
                               ȳ                             y − x − σt0 (x) t̃ − t
                           Z
                                                  1
       ∼ t̃ − t φt (x) +            q                  exp −                            Tt (y)dy.       (12)
                           y          4πσt (x) t̃ − t             4σt (x) t̃ − t



     This equation extends the notion of fairness that we derived for the optimal tax to that of
the trajectory of the gradient flow of taxes. The government that considers a tax reform in the
direction of maximizing revenues changes the tax such that the new, evolved tax Tt̃ (x) is equal
to the weighted average of the initial taxes Tt (y) plus another source term φt (x) that evaluates
the mechanical effect of the revenues collected. In other words, the gradient flow wants to ensure
that an agent at a given income x is paying roughly the average of the amount of taxes paid by
people working just a little less or just a little more. The conductivity εt (x) φt (x) determines the
scale of the Gaussian and the drift correction and the function φt (x) determines the asymptotic
deviation.16
     Note, that the property (12) holds for any starting time t on the gradient flow trajectory
and that we average over the known and given parameters εt (x) and φt (x) evaluated at the
time t. That is, it is a closed-form expression. This characterization is valid for the short time
t̃ as these parameters are essentially frozen over that short time interval. For the large time, it
is also a fairly good approximation of the heat kernel, but with the conductivity and the source
  15
      Technically, we need to specify boundary conditions for the Brownian motion B(s), however, since we are
only using Brownian motion for very small times t̃, it does not matter very much whether we prescribe absorbing
boundary conditions corresponding to Dirichlet conditions or reflecting boundary conditions corresponding to
Neumann conditions.
   16
      Of course, this equation also holds for the optimal tax, as it is a stationary point of the gra-
dient flow in which       both the taxes and agents’ behavior no longer change: T∗ (x) = tφ∗ (x) +
                                0      2
R ȳ
     √ 1               ( y−x−σ  ∗ (x)t)
 y
               exp −       4σ∗ (x)t
                                         T∗ (y)dy + o (t).
       4πσ∗ (x)t




                                                               20
needing to be adjusted as the agents change their behavior in response to the evolution of the
tax function. In contrast, the results for the optimal tax are derived for any time (scale) t as
well as for the short term asymptotics but include the elasticities and the densities evaluated at
the optimum.
    There is also a sense in which the gradient flow acts on the points that deviate most from
this principle. It is encoded in the equation
                                                      
                                      Tt̃ (x) ∼ t̃ − t φt (x) + E[Tt (Bt̃ )].

Say the source is φt ≡ 0 and suppose that Tt = 1 everywhere except in x = 0. Then Tt̃ (0) = 1 as
the averaging corrects this deviation. We elaborate the discussion of the smoothing properties
of the gradient flow in the next section.

4.4      Gradient flow as a heat equation
In this section, we propose a construction of a trajectory of the tax reform and show how the
gradient flow of the revenue functional gives rise to the heat equation.
    Equation (10) changes the tax schedule in favor of increasing government revenue, letting φt
and εt be endogenously driven by Tt – that is, taking into account the fact that the density and
the elasticity change in response to the evolution of taxes.
    We propose to evolve the system separately (this underlying idea is a straightforward appli-
cation of “operator splitting”). The simplest instance of this idea is as follows. Suppose we are
given a system of ordinary differential equations given as

                                             d
                                                u(t) = (A + B)u(t),
                                             dt

then the solution is given by the matrix exponential u(t) = et(A+B) u(0). A formal Taylor series
expansion suggests that

                                    et(A+B) = Id + t(A + B) + O(t2 )
                                              = (Id + tA)(Id + tB) + O(t2 )
                                              = etA etB u(0) + O(t2 ).

These computations are purely formal but they do suggest that, at least for small values of t,
we may solve the system by first evolving along the simpler system u̇(t) = Au and then along
the system u̇ = Bu and alternate in this manner (Varga (1962), Glowinski and Osher (2016)).
    We apply the very same method in our problem: more precisely, we fix the distribution of
incomes φt and the elasticity εt for a short period of time δt, evolve Tt , and then re-compute
φt+δt and εt+δt based on the new tax function Tt+δt .17 In standard situations, this procedure
 17
      This also can be regarded as a classical numerical technique for systems of this type.



                                                         21
will converge to a solution path of the dynamical system as δt → 0 (Glowinski, Osher, and Yin
(2016)). The operator splitting technique also has a natural economic meaning. The government
evolves taxes in the direction of increased revenues, keeping the density of agents’ incomes
and elasticities fixed at their value observed in the current economy. That is, the government
evaluates the changes in revenues under the current information given by the exogenous sufficient
statistics evaluated at a given initial time.
    This implies equation (10) is a heat equation (with source term φ and local conductivity
σ = εφ), i.e. a PDE of the form

                                   ∂T           ∂         ∂T
                                      = φ (y) +    [σ (y)    ]                                (13)
                                   ∂t           ∂y        ∂y

and guarantees in particular that the problem always has a solution (the heat equation being
well-posed). We also note that our assumption that the density tends to 0 at the boundary of the
interval implies that no boundary conditions need be imposed. Since heat equations are among
the most well-known and well-behaved partial differential equations, we can apply standard
mathematical results to obtain theoretical properties of the evolution of the tax schedule over
time.
    Fixing φ and ε, letting T evolve for a short amount of time, then unfreezing φ and ε and
recomputing it can be regarded as a classical example of operator splitting. While the analysis
of convergence of this dynamic system is outside the scope of the paper, one can expect that
for sufficiently short time steps, the solution converges to the global optimum at a great level of
generality. For example, the review of Glowinski, Osher, and Yin (2016, p.13) concludes: “Last
but not least, operator splitting algorithms are theoretically attractive because they converge
under very few assumptions.” More broadly, the splitting procedure we use is similar in spirit to
the ones used in physical sciences where the split terms correspond to different physical processes
– for example, splitting convection from diffusion (see, e.g. MacNamara and Strang (2016)) or
splitting fast from slow variables.

4.5   Smoothing properties of the heat equation
We now present various smoothing properties of the gradient flow arising within a step of the
operator splitting; this gradient flow is realized by a heat equation. Most of the results in this
section are straightforward adaptations of very classical results for the heat equation. Since
the heat equation can alternatively be realized as a gradient flow in a certain Sobolev-type
space, it has a very nice underlying smoothing structure which is reflected in a large number of
beneficial mathematical properties. Moreover, since the heat equation is one of the most studied
(and well-behaved) objects in mathematics, the list of the useful properties is very large. We
therefore focus only on some of them in this section that show how the heat equation smoothes
the underlying functions. Various other properties could be of interest but are outside the scope
of this paper. For the rest of the section to ease the notational burden we suppress the indexing


                                                22
of taxes with t whenever it does not cause confusion.
    Since the initial tax system can be arbitrary, we need to introduce the proper reference point
for the analysis of smoothing of a given tax system. We proceed as follows. Since φ(y) and σ (y)
are fixed, the solution will converge to a fixed point as t → ∞ and the unique fixed point is
given by setting ∂T /∂t = 0 resulting in

                                                 ∂         ∂T (y)
                                  0 = φ (y) +       [σ (y)        ].                           (14)
                                                 ∂y         ∂y

We define the solution to this equation as τ (y). This stationary point is the solution to the
problem of maximizing tax revenue, conditional on keeping the density of agents’ incomes and
elasticities fixed. In other words, this is the tax schedule under exogenous sufficient statistics
that would be optimal if these sufficient-statistic variables were fixed and equal to their value
observed in the current economy, i.e., given the current tax Tt .
    It is important to note, however, that we are not interested in letting the gradient flow for
all t → ∞ and thus finding τ but only evolving it for a very small time t (so as to respect
the operator splitting). In this sense, τ serves as a proper reference point to describe various
smoothing properties of the gradient flow.
    We first relate the gradient flow arising from revenue maximization to another gradient flow
with strong smoothing properties.

Proposition 4. Equation (14) coincides with the gradient flow of the functional J given by the
weighted Sobolev-type seminorm H 1
                                      Z
                                    1                          2
                          J (T ) =       σ(y) T 0 (y) − τ 0 (y) dy
                                    2

Proof. Let us compute the directional derivative in the direction of a function w evaluated at T

                                              J (T + εw) − J (T )
                                δJ (w) = lim                      .
                                          ε→0         ε

We see that

                    J (T + εw) − J (T )
                                             Z
                lim                     =        σ(y)(T 0 (y) − τ 0 (y))w0 (y) dy
                ε→0         ε
                                             Z
                                                         ∂
                                                            σ(y) τ 0 (y) − T 0 (y) dy.
                                                                                  
                                         =       w (y)
                                                         ∂y

This shows that the negative gradient flow is given by

           ∂T    ∂                             ∂                ∂
                    σ(y) τ 0 (y) − T 0 (y) = −    σ(y)τ 0 (y) +    σ(y)T 0 (y) .
                                                                           
              =−
           ∂t    ∂y                            ∂y               ∂y
                                         ∂
Using the equation for τ , we see that − ∂y (σ(y)τ 0 (y)) = φ(y) and we have established the desired



                                                  23
claim.

      This proposition has an interesting economic meaning. This gradient flow has the effect of
trying to smooth out rough irregularities in the difference between T and τ – a large value of
|T 0 (y) − τ 0 (y) | implies the existence of a large value of (T 0 (y) − τ 0 (y))2 and the flow is trying
to decrease this as quickly as possible. We note that the quantity σ(y) ≥ 0 serves as a natural
weighting measure: if σ(y) is large, then irregularities in that region count even more severely
and are dampened quicker than in regions where σ(y) is very small.
      Moreover, if T (y) has large amounts of strong oscillations or maybe even discontinuous
jumps, then the gradient flow acts strongest on those parts first. This leads to the following
proposition which follows from the classical result on parabolic equations.

Proposition 5. Let T (t, y) denote the solution of (13). If σ (y) is bounded away from 0 and
T (0, y) is bounded, then T (t, y) is infinitely differentiable for any t > 0.

    This implies that the tax reform viewed as the gradient flow leads to the continuous tax
systems. Moreover, the gradient flow has the effect of mollifying any tax scheme instantaneously.
    The next proposition shows that the gradient flow smoothes a measure of variability of
the tax schedule, the squared deviation from the limiting stationary solution. Moreover, such
smoothing is exponential. As we discussed above, this result is not about the convergence to
the optimal tax T∗ but rather about the smoothing behavior of the gradient flow at each step
of the operator splitting. As the initial tax function T (0, y) and hence the associated agents’
behavior (that determine φ (y) and ε (y)) can be arbitrary, the correct reference point for this
smoothing behavior is the corresponding stationary solution τ (y).

Proposition 6. Let T (t, y) be the solution to (13), T (0, y) be an arbitrary initial tax schedule,
and τ (y) be the solution to the stationary problem (14), and λ1 be the first eigenvalue of the
associated Sturm-Liouville operator:

                                          ∂T           ∂         ∂T
                                             = φ (y) +    [σ (y)    ].                                (15)
                                          ∂t           ∂y        ∂y

Then, ∀t > 0 :
                      Z    b                                        Z   b
                                               2           −2λ1 t
                               (T (t, y) − τ (y)) dy ≤ e                    (T (0, y) − τ (y))2 dy.
                       a                                            a
Proof. We use the standard Sturm-Liouville theory (see Zettl (2010), Teschl (2012), Titchmarsh
(1962)) to prove this result. This equation can be studied by first solving for the stationary
problem
                                               ∂         ∂τ
                                   0 = φ (y) +    [σ (y)    ].
                                               ∂y        ∂y
Subtracting both equations leads to an equation for z(t, x) = T (t, x) − τ (x) given by

                                              ∂z   ∂        ∂z
                                                 =    [σ (y) ].
                                              ∂t   ∂y       ∂y


                                                       24
It remains to study problems of this type. We will do so by studying the spectrum of the
associated differential operator H given by

                                                             ∂        ∂z
                                                    Hz = −      [σ (y) ]
                                                             ∂y       ∂y

or, in other words, we study the problem Hz = λz. This eigenvalue problem has a discrete
sequence of admissible values λ for which the equation has a solution: these values 0 < λ1 <
λ2 < . . . are the eigenvalues of this operator of Sturm-Liouville type, the corresponding solutions
will be denoted by η1 , η2 , . . . and are assumed to be L2 −normalized, i.e. kηn kL2 = 1. We note
that λ0 = 0 is a special value and η0 = const. We see that these eigenfunctions are necessarily
orthogonal in L2 (a, b) since, again by integration by parts,
                          Z    b                              Z    b
                                                    1
                                   ηk (y)η` (y)dy =             −(σ(y)ηk0 (y))0 η` (y)dy
                           a                        λk         a
                                                               Z b
                                                             1
                                                        =−          −σ(y)ηk0 (y)η`0 (y)dy
                                                            λk a
                                                            Z b
                                                          1
                                                        =       (−σ(y)η`0 (y))0 ηk (y)dy
                                                          λk a
                                                          λ` b
                                                            Z
                                                        =       ηk (y)η` (y)dy
                                                          λk a

If k 6= `, then the factor in front of the integral is different from 1 and the integral is therefore 0.
This together with the completeness of the system of eigenfunctions in L2 allows us to expand
an arbitrary initial function T (0, x) into a series
                                                           ∞
                                                           X
                               T (0, x) = τ (x) +                 hz(0, x), ηk (x)i ηk (x).
                                                           k=1

We will abbreviate ak = hz(0, x), φk (x)i for simplicity of exposition. We then claim that
                                                                  ∞
                                                                  X
                                           T (t, x) = τ (x) +            ak e−λk t ηk (x)
                                                                   k=1

is a solution of the partial differential equation (15). This can be verified by computing
                               ∞
                               X                                   ∞                             
              d   d       d                     −λk t
                                                                    X              d   d       d
                −   σ(x)                     ak e       ηk (x) =          ak         −   σ(x)          e−λk t ηk (x).
              dt dx      dx                                                        dt dx      dx
                                    k=1                             k=1

The separation of variables implies that
                                                                                                         
               d   d       d           −λk t                −λk t                      d      d
                 −   σ(x)              e       ηk (x) = e               − λk ηk (x) −    σ(x) ηk (x)            =0
               dt dx      dx                                                          dx     dx




                                                              25
as desired. Since we now have a complete description of a solution, we can analyze the conver-
gence to the limiting function arising for t → ∞ at a greater level of detail: we have

                                                   ∞
                                                                                      !2                      ∞
    Z   b                                 Z   b    X                                                  Z   b   X
                                                                   −λk t
                              2
            (T (t, y) − τ (y)) dy =                       ak e               ηk (y)        dy =                   ak e−λk t ηk (y)a` eλ` t η` (y)dy
    a                                     a        k=1                                                  a k,`=1
                                             ∞
                                          Z bX                                                 ∞
                                                                                               X                              ∞
                                                                                                                              X
                                      =                 a2` e−2λl t ηl (y)2 dy =                      a2` e−2λk t ≤ e−2λ1 t         a2` .
                                          a `=1                                                `=1                            `=1

We note that
                                                  ∞
                                                  X                Z     b
                                                        a2`   =              (T (0, y) − τ (y))2 dy
                                                  `=1                a

and that we have therefore shown that
                          Z     b                                                       Z      b
                                    (T (t, y) − τ (y))2 dy ≤ e−2λ1 t                               (T (0, y) − τ (y))2 dy.
                            a                                                              a

Appealing to the classical Rayleigh-Ritz formula, we see that
                                                                                Rb
                                                                                  a   σ(y)f 0 (y)2 dy
                                                  λ1 = R           inf                Rb                                                         (16)
                                                              b                                2
                                                              a   f (y)dy=0            a f (y) dy

where the last step follows from the classical Neumann eigenvalue computation for the homo-
geneous rod (see Courant and Hilbert (1989)). This shows that for sufficiently regular values of
φ(y), we can expect λ1 > 0 and therefore the distance to τ (y) undergoes exponential decay.

   Finally, note that the short term asymptotics results in Section 4.3 do not require the use of
operator splitting methods.


5       Conclusion
We have shown that dynamical methods can provide new insights on the analysis of static
optimal taxation problems. We show that the heat kernel and the heat equation are intimately
connected with the analysis of this classic problem. Since the heat equation is one of the
most basic mathematical objects, it possesses a variety of useful properties that can enrich our
understanding of the mechanism design problems. One such new characteristic is the fairness
property where the taxation system implies that a tax on a given income is a proper average
of taxes at other incomes and income densities. The fairness principle does not stem from any
desire of the planner to be fair but rather shows that the most efficient way to raise revenues is
to equalize a properly weighted average of taxes at any given income. We have shown that this
principle holds for both the optimum at any scale and for the gradient flow for the short time
approximation. The derivation of the fairness principle fundamentally relies on the dynamical



                                                                               26
view of the static problem.
    We now briefly outline some extensions. We considered the simplest taxation environment
to starkly highlight the main contributions of the paper. Several extensions, some of which we
already discussed in the body of the paper are immediate. Consider a model where utility is not
quasi-linear, the government maximizes social welfare function, agents have multidimensional
types (not incomes). This model delivers a gradient flow that is very similar to the one that we
constructed, with the properly modified elasticities and the social welfare weights. More broadly,
one can consider a variety of other mechanism design problems – nonlinear pricing, matching,
etc., – where gradient flows, or more broadly viewing a static problem from the point of view
of a dynamical system, may be useful in characterizing the static optimum and the evolution of
the locally improving suboptimal policies.




                                               27
References


    Aronson, Don. Non-negative solutions of linear parabolic equations, Ann. Sci. Norm. Sup.
22, p. 607–694. 1968.
    Artzner, Philippe, Carl P. Simon, and Hugo Sonnenschein. " Convergence of Myopic Firms
to Long-Run Equilibrium via the Method of Characteristics." Models of Economic Dynamics.
Springer, Berlin, Heidelberg, 157-183. 1986.
    Bierbrauer, Felix, and Pierre Boyer. "Politically feasible reforms of non-linear tax systems."
2018.
    Blanchet, Adrien, and Guillaume Carlier. "Optimal transport and Cournot-Nash equilibria."
Mathematics of Operations Research 41, no. 1: 125-145. 2015.
    Bogachev, Vladimir I., Nicolai V. Krylov, Michael Röckner, and Stanislav V. Shaposhnikov.
Fokker-Planck-Kolmogorov Equations. Vol. 207. American Mathematical Soc., 2015.
    Bolton, Patrick, and Christopher Harris. “The dynamics of optimal risk sharing.” No.
w16094. National Bureau of Economic Research. 2010.
    Brewer, Mike, Emmanuel Saez, and Andrew Shephard. "Means-testing and tax rates on
earnings." Dimensions of Tax Design: the Mirrlees Review. 2010.
    Chiappori, Pierre-André, Robert J. McCann, and Lars P. Nesheim. "Hedonic price equilibria,
stable matching, and optimal transport: equivalence, topology, and uniqueness." Economic
Theory 42, no. 2: 317-354. 2010.
    Chiappori, Pierre-André, and Bernard Salanié. "The econometrics of matching models."
Journal of Economic Literature 54, no. 3 : 832-61, 2016.
    Courant, Richard and David Hilbert, Methods of mathematical physics. Vol. I. Interscience
Publishers, Inc., New York, N.Y., 1953.
    Daskalakis, Constantinos, Alan Deckelbaum, and Christos Tzamos. "Strong Duality for a
Multiple-Good Monopolist." Econometrica 85, no. 3: 735-767. 2017.
    Diamond, Peter A. " A many-person Ramsey tax rule." Journal of Public Economics 4.4:
335-342. 1975.
    Diamond, Peter A. " Optimal income taxation: an example with a U-shaped pattern of
optimal marginal tax rates." American Economic Review: 83-95. 1998.
    Figalli, Alessio, Young-Heon Kim, and Robert J. McCann. "When is multidimensional
screening a convex program?." Journal of Economic Theory 146, no. 2: 454-478. 2010.
    Friedman, Avner. Partial differential equations of parabolic type. Courier Dover Publica-
tions, 2008.
    Galichon, Alfred. Optimal transport methods in economics. Princeton University Press.
2016.
    Glowinski, Roland, Stanley J. Osher, and Wotao Yin, eds. Splitting Methods in Communi-
cation, Imaging, Science, and Engineering. Springer, 2017.


                                               28
    Grigor’yan, Alexander. Heat Kernel and Analysis on Manifolds, AMS/IP Studies in Ad-
vanced Mathematics. 2009.
    Golosov, Mikhail, Aleh Tsyvinski, and Nicolas Werquin. A variational approach to the
analysis of tax systems. No. w20780. National Bureau of Economic Research, 2014.
    Hellwig, Martin F. "Incentive problems with unidimensional hidden characteristics: A unified
approach." Econometrica 78, no. 4: 1201-1237. 2010.
    Hörmander, Lars. The Analysis of Linear Partial Differential Operators I – IV, Springer,
2003.
    Jordan, Richard, David Kinderlehrer, and Felix Otto. " The variational formulation of the
Fokker-Planck equation." SIAM Journal on Mathematical Analysis 29.1: 1-17. 1998.
    Jacquet, Laurence, and Etienne Lehmann. "Optimal Income Taxation when Skills and
Behavioral Elasticites are Heterogeneous." 2015.
    Kleven, Henrik Jacobsen. "Sufficient Statistics Revisited." 2018.
    Kleven, Henrik Jacobsen, and Claus Thustrup Kreiner. "The marginal cost of public funds:
Hours of work versus labor force participation." Journal of Public Economics 90, no. 10-11:
1955-1973. 2006.
    Kleven, Henrik Jacobsen, Claus Thustrup Kreiner, and Emmanuel Saez. "The optimal
income taxation of couples." Econometrica 77, no. 2: 537-560. 2009.
    Lörinczi, Jozsef, Fumio Hiroshima, and Volker Betz. Feynman-Kac-type theorems and Gibbs
measures on path space: with applications to rigorous quantum field theory. Vol. 34. Walter
de Gruyter, 2011.
    MacNamara, Shev, and Gilbert Strang. In Glowinski, Roland, Stanley J. Osher, and Wotao
Yin. Operator splitting. In Splitting Methods in Communication, Imaging, Science, and Engi-
neering (pp. 95-114). Springer, Cham. 2016.
    Metafune, Giorgio, El Maati Ouhabaz, and Diego Pallara. "Long time behavior of heat
kernels of operators with unbounded drift terms." Journal of Mathematical Analysis and Ap-
plications 377, no. 1: 170-179. 2011.
    McCann, Robert J. " Academic wages, singularities, phase transitions and pyramid schemes."
Proceedings of the International Congress of Mathematicians (Seoul 2014). Vol. 3. 2014.
    Mirrlees, James A. " An exploration in the theory of optimum income taxation." The Review
of Economic Studies 38.2: 175-208. 1971.
    Molchanov, Stanislav A. " Diffusion processes and Riemannian geometry." Russian Mathe-
matical Surveys 30, no. 1: 1-63. 1975.
    Musgrave, Richard A., and Tun Thin. " Income tax progression, 1929-48." Journal of Polit-
ical Economy 56.6: 498-514. 1948.
    Sachs, Dominik, Aleh Tsyvinski, and Nicolas Werquin. Nonlinear tax incidence and optimal
taxation in general equilibrium. No. w22646. National Bureau of Economic Research. 2016.
    Saez, Emmanuel. Using elasticities to derive optimal income tax rates. The Review of
Economic Studies, vol. 68, no 1, p. 205-229. 2001.



                                              29
    Saez, Emmanuel, and Stefanie Stantcheva. "Generalized social marginal welfare weights for
optimal tax theory." American Economic Review 106, no. 1: 24-45. 2016.
    Saez, Emmanuel, and Stefanie Stantcheva. "A simpler theory of optimal capital taxation."
Journal of Public Economics 162: 120-142. 2018.
    Salanie, Bernard. The economics of taxation. MIT press, 2011.
    Scheuer, Florian, and Iván Werning. Mirrlees meets diamond-mirrlees. No. w22076. Na-
tional Bureau of Economic Research. 2016.
    Sonnenschein, Hugo. " Price dynamics and the disappearance of short-run profits: An
example." Journal of Mathematical Economics 8.2: 201-204. 1981.
    Sonnenschein, Hugo. " Price dynamics based on the adjustment of firms." The American
Economic Review 72.5: 1088-1096. 1982.
    Steinerberger, Stefan. " Fast escape in incompressible vector fields." Monatshefte für Math-
ematik 186, no. 3: 525-537. 2018.
    Tao, Terence. " On the universality of potential well dynamics." arXiv preprint arXiv:1707.02389.
2017.
    Taylor, Michael. Partial Differential Equations I-III, Springer. 1996.
    Teschl, Gerald. Ordinary differential equations and dynamical systems. Vol. 140. American
Mathematical Soc., 2012.
    Tirole, Jean, and Roger Guesnerie." Tax reform from the gradient projection viewpoint."
Journal of Public Economics 15.3: 275-293. 1981.
    Titchmarsh, Edward Charles. Eigenfunction expansions associated with second-order differ-
ential equations. Part I. Second Edition Clarendon Press, Oxford. 1962.
    Varadhan, Sathamangalam R. Srinivasa. " On the behavior of the fundamental solution of
the heat equation with variable coefficients." Communications on Pure and Applied Mathematics
20, no. 2: 431-455. 1967.
    Varga, Richard S. Matrix Iterative Analysis, New Jersey: Prentice-Hall, 1962
    Villani, Cedric. Topics in optimal transportation. No. 58. American Mathematical Soc.,
2003.
    Zettl, Anton. Sturm–Liouville Theory. Providence: American Mathematical Society, 2005.




                                               30
