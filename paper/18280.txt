                              NBER WORKING PAPER SERIES




                                       FISCAL UNIONS

                                         Ivan Werning
                                        Emmanuel Farhi

                                      Working Paper 18280
                              http://www.nber.org/papers/w18280


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                           August 2012, Revised March 2017




For useful comments and conversations we thank Fernando Alvarez, George-Marios Angeletos,
Marco Bassetto, Giancarlo Corsetti, Jordi Gali, Pierre-Oliver Gourinchas, Olivier Jeanne, Patrick
Kehoe, Guido Lorenzoni, Tomaso Monacelli, Maurice Obstfeld, Kenneth Rogoff, Robert Staiger
and Jean Tirole. We thank seminar participants at Bocconi, Brown, Chicago, Columbia, CREI,
Harvard, LSE, MIT, Princeton, University of Wisconsin, Wharton, Bank of England, ECB, IMF,
NBER, NY Fed, SITE. We thank Andreas Schaab for superlative research assistance. The views
expressed herein are those of the authors and do not necessarily reflect the views of the National
Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2012 by Ivan Werning and Emmanuel Farhi. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Fiscal Unions
Ivan Werning and Emmanuel Farhi
NBER Working Paper No. 18280
August 2012, Revised March 2017
JEL No. E62,E63,F02,F15,F3,F40

                                          ABSTRACT

We study cross-country risk sharing as a second-best problem for members of a currency union
using an open economy model with nominal rigidities and provide two key results. First, we show
that if financial markets are incomplete, the value of gaining access to any given level of
aggregate risk sharing is greater for countries that are members of a currency union. Second, we
show that even if financial markets are complete, privately optimal risk sharing is constrained
inefficient. A role emerges for government intervention in risk sharing both to guarantee its
existence and to influence its operation. The constrained efficient risk sharing arrangement can be
implemented by contingent transfers within a fiscal union. We find that the benefits of such a
fiscal union are larger, the more asymmetric the shocks affecting the members of the currency
union, the more persistent these shocks, and the less open the member economies. Finally we
compare the performance of fiscal unions and of other macroeconomic stabilization instruments
available in currency unions such as capital controls, government spending, fiscal deficits, and
redistribution.


Ivan Werning
Department of Economics, E52-536
MIT
77 Massachusetts Avenue
Cambridge, MA 02139
and NBER
iwerning@mit.edu

Emmanuel Farhi
Harvard University
Department of Economics
Littauer Center
Cambridge, MA 02138
and NBER
emmanuel.farhi@gmail.com
                                             Fiscal Unions∗
                                 Emmanuel Farhi                      Iván Werning
                               Harvard University                           MIT

                                                   March 2017


        We study cross-country risk sharing as a second-best problem for members of a currency union
        using an open economy model with nominal rigidities and provide two key results. First, we show
        that if financial markets are incomplete, the value of gaining access to any given level of aggregate
        risk sharing is greater for countries that are members of a currency union. Second, we show that
        even if financial markets are complete, privately optimal risk sharing is constrained inefficient. A
        role emerges for government intervention in risk sharing both to guarantee its existence and to
        influence its operation. The constrained efficient risk sharing arrangement can be implemented by
        contingent transfers within a fiscal union. We find that the benefits of such a fiscal union are larger,
        the more asymmetric the shocks affecting the members of the currency union, the more persistent
        these shocks, and the less open the member economies. Finally we compare the performance of
        fiscal unions and of other macroeconomic stabilization instruments available in currency unions
        such as capital controls, government spending, fiscal deficits, and redistribution.



1      Introduction
The benefits of flexible exchange rates were famously argued for by Friedman (1953) and are widely
accepted by economists. Countries in a currency union forego the possibility of adjustments to their
exchange rates in response to asymmetric shocks. How costly is this loss in flexibility and what can
be done to compensate for it? These questions are precisely those tackled by the Optimal Currency
Area (OCA) literature (for the pioneering articles, see Mundell, 1961; McKinnon, 1963; Kenen, 1969).
   In a seminal contribution, Kenen (1969) argued that fiscal integration was critical to a well-
functioning currency union:

        “It is a chief function of fiscal policy, using both sides of the budget, to offset or compen-
        sate for regional differences, whether in earned income or in unemployment rates. The
    ∗ For
        useful comments and conversations we thank Fernando Alvarez, George-Marios Angeletos, Marco Bassetto,
Giancarlo Corsetti, Jordi Gali, Pierre-Oliver Gourinchas, Olivier Jeanne, Patrick Kehoe, Guido Lorenzoni, Tomaso Mona-
celli, Maurice Obstfeld, Kenneth Rogoff, Robert Staiger and Jean Tirole. We thank seminar participants at Bocconi,
Brown, Chicago, Columbia, CREI, Harvard, LSE, MIT, Princeton, University of Wisconsin, Wharton, Bank of England,
ECB, IMF, NBER, NY Fed, SITE. We thank Andreas Schaab for superlative research assistance.


                                                           1
      large-scale transfer payments built into fiscal systems are interregional, not just interper-
      sonal [...]” (pg. 47)

Countries such as the United States, which can be thought as a currency and fiscal union of regions,
share federal revenues and transfers—through the unemployment insurance program, federal in-
come and social security taxes and, in extreme cases, direct federal assistance—in a manner that
provides macroeconomic stabilization across regions. The ongoing crisis in the Eurozone, where
such mechanisms are lacking, is seen by many as a vindication of Kenen’s fiscal integration crite-
rion. Going forward, many policy discussions center around the construction of a fiscal union. How
should a fiscal union be designed and how effective can we expect it to be?
    Unfortunately, the OCA literature is couched in terms of Keynesian models that lack proper
micro-foundations. As a result, the treatment of welfare is cursory. Recently, the New Open Econ-
omy Macro literature has developed open economy New Keynesian models with explicit micro-
foundations and applied them to currency areas (see e.g. Benigno 2004; Beetsma and Jensen 2005;
Gali and Monacelli 2008; Ferrero 2009). Our goal is to revisit Kenen’s idea using such a model. This
allows for a rigorous treatment of optimal policy design. Indeed, we are able to deliver a complete
characterization of the required transfers and of their effectiveness as a function of a small number
of key characteristics of the economy.
    We tackle the design of a fiscal union within a currency union as an optimal international risk
sharing arrangement. We begin our analysis with the simplest possible model: a static setting with
a traded good, a non-traded good and labor as in Obstfeld and Rogoff (2000). We then extend the
analysis to a standard dynamic model featuring non-trivial intra-temporal trade and price adjust-
ment dynamics that builds on Gali and Monacelli (2005, 2008). The key features in both settings are
fixed exchange rates, price or wage stickiness, and limited openness in the form of non-traded goods
or home bias. In this context, we set up and study the second-best planning problem for constrained
efficient risk sharing via international transfers among countries in a currency union.1
    International transfers have a dual role ex post. First, they help smooth consumption across
countries. This is their usual direct microeconomic role. Second, under a fixed exchange rate, in
the presence of nominal price or wage rigidities, and with non-traded goods or home bias, interna-
tional transfers also have an indirect effect by influencing total spending across goods produced by
different countries—a mechanism first discussed in the famous Transfer Problem debate involving
Keynes (1929) and Ohlin (1929). Transfers from countries in a boom to countries in a bust improve
macroeconomic stability in the currency union. We show that this dual role gives rise to an ag-
gregate demand externality ex ante: the social benefits from international risk sharing are greater
   1 We follow the approach of the OCA literature by taking the existence of a currency union as an exogenous constraint

and not attempting to model the reasons for its formation in the first place. In other words, we abstract from the potential
benefits and focus on the costs of currency unions. We characterize to what extent these costs can be mitigated by the
establishment of a fiscal union. Of course, one potential concern is that the factors leading to the formation of currency
unions could influence the optimal design of fiscal unions. Unfortunately, there is no consensus among economists on
the benefits of currency unions. In addition, at least in the case of the Eurozone, the adoption of the euro was part of a
larger political unification project. For all these reasons we believe that treating the existence of a currency union as an
exogenous constraint is a useful starting point.


                                                             2
than what is appreciated by private economic agents, since they do not internalize these indirect
macroeconomic stability effects and only value the direct microeconomic consumption smoothing
role. Indeed, our main result is that even under ideal conditions with complete financial markets to
support these international transfers, the competitive equilibrium without government intervention
does not provide the constrained Pareto efficient level of international risk sharing.2
    The constrained inefficiency of private international risk sharing can be addressed by govern-
ment intervention. Indeed constrained efficient outcomes can be implemented in a number of ways.
If individuals do have access to complete financial markets, then constrained efficiency can be en-
sured by introducing quantity restrictions or tax incentives that distort their individual portfolios
choices. A second possibility is for the government to take over intergenerational risk sharing by
assuming the necessary positions in financial markets itself. Equivalently, instead of using financial
markets, it can arrange ex ante with other union members for state-contingent international fiscal
transfers ex post. In either case, it must then also take steps to ensure that the private sector does not
undo these arrangements by setting up the aforementioned quantity restrictions or tax incentives, or
by employing more extreme measures such as banning financial markets.
    We view the complete financial markets paradigm as a useful assumption to highlight that the
constrained inefficiency of private risk sharing that we derive does not arise from inefficiencies in
financial markets. However, our preferred interpretation is that financial markets are incomplete
so that markets for sharing aggregate risk across countries are imperfect or nonexistent. This only
strengthens the argument for building a fiscal union to share risks across members within a currency
union.3 Indeed, the constrained efficient risk sharing arrangement can then be implemented through
ex-post international fiscal transfers that are contingent on the shocks experienced by each country.
Since agents have no access to financial markets, neither restrictions nor taxes on private portfolios
are needed. Under this interpretation, our paper can be seen as offering a precise characterization
of these ex-post international fiscal transfers and clarifying that for members of a currency union: (i)
the value of gaining access to any given level of international risk sharing is greater; and (ii) inter-
national fiscal transfers should go beyond emulating the outcome that private risk sharing would
reach if financial markets were complete. These two points are distinct but complement each other
to motivate the formation of fiscal unions within currency unions.
    Importantly, we do not reach the same conclusion for countries outside a currency union with
flexible exchange rates. As long as they exercise their independent monetary policy optimally, it is
optimal to let agents trade freely in a complete set of financial markets or to replicate this outcome
through international fiscal transfers. Our argument for government involvement in international
risk sharing relies on membership in a currency union precisely because this constrains monetary
policy and prevents the stabilization of asymmetric shocks: fiscal and currency unions go hand in
   2 These aggregate demand externalities are pervasive in New-Keynesian models and their normative implications

have recently been analyzed in different contexts in parallel and independent work by Farhi and Werning (2012), Farhi
and Werning (2016), Korinek and Simsek (2016), and Schmitt-Grohe and Uribe (2016).
   3 Atkeson and Bayoumi (1993) examine cross-regional insurance in the United States and conclude that “integrated

capital markets are [...] unlikely to provide a substantial degree of insurance against regional economic fluctuations [...]
This task will continue to be primarily the business of government.”


                                                             3
hand.
    Our results qualify a view often presented in the OCA literature that international fiscal transfers
and international risk sharing through private financial markets are substitutes since both buffer
against asymmetric macroeconomic shocks in a currency union. For example, Mundell (1973) argues
that a common currency could help improve international risk sharing by increasing cross holdings
of assets or deepening financial markets. While our model is silent on whether a currency union may
facilitate the development of financial markets, it shows that the benefits of risk sharing are larger
in a currency union and that government intervention is needed to reap the full benefits. Indeed,
we establish that private risk sharing is not constrained Pareto efficient in a currency union, so that
financial integration alone is not sufficient.
    We emphasize three key determinants of the macroeconomic stabilization performance of fiscal
unions in currency unions: the asymmetry of the shocks hitting the members of the currency union,
the persistence of these shocks, and the openness of the member economies. Indeed, symmetric
shocks can be accommodated with union-wide monetary policy so that transfers should be used only
in response to asymmetric shocks. Optimal transfers are increasing in the persistence of these shocks
but hump-shaped as a function of openness. However, a given transfer is more effective at stabilizing
the economy when the economy is more closed. Hence more stabilization is achieved at the optimum
both when the economy is more closed and when shocks are more persistent. Indeed, we show that
full stabilization is achieved in the limit as shocks become permanent and the economy becomes
closed. This contrasts with the ideas in McKinnon (1963), who discusses reasons why openness may
mitigate the costs of currency unions.
    We extend the model by introducing agent heterogeneity with a fraction of hand-to-mouth con-
sumers and a fraction of permanent-income consumers. This extension allows us to capture a key
feature of the data—the high average marginal propensity to consume out of transitory income and
its heterogeneity across the population—while preserving enough tractability to lend itself to a full-
fledged normative analysis. With hand-to-mouth consumers, the performance of transfers in deal-
ing with transitory shocks is improved. This is because in contrast to the consumption spending of
permanent-income consumers, the consumption spending of hand-to-mouth consumers tracks inter-
national fiscal transfers and hence can be efficiently targeted over time to stabilize the economy. For
example in the case of a transitory recessive shock, international fiscal transfers can be front-loaded
to provide stimulus in the short run when it is needed.
    We compare international fiscal transfers with other macroeconomic stabilization instruments in
currency unions, such as capital controls (Farhi and Werning 2012; Schmitt-Grohe and Uribe 2012)
and different variants of domestic fiscal policy ranging from government spending (as analyzed in
Beetsma and Jensen 2005; Gali and Monacelli 2008; Ferrero 2009; Farhi and Werning 2012, 2017) to
redistribution and budget deficits. Ideally, it is best to jointly use all these different instruments to-
gether, to the extent that they are available, and our main results about the optimal design of fiscal
unions are robust to the inclusion of these other instruments. But one might also want to assess the
relative performance of these instruments. To that end, we discuss theoretically and compare numer-


                                                    4
ically the relative performance of these different instruments depending on a number of important
parameters of the economy such as the fraction of hand-to-mouth consumers, the openness of the
economy, the rigidity of prices, and the persistence of shocks.
    Finally, and although this is not our main focus, we briefly explore the robustness of our results in
the presence of agency problems at the national level, such as limited commitment or moral hazard.
We show how these incentive problems, together with the forces that we have identified above,
jointly influence the optimal design of fiscal unions, and that our main insights carry over.
    The rest of the paper is organized as follows. The static model is covered in Sections 2 and 3. The
dynamic model is developed in Sections 4 and 5. The numerical illustrations are covered in Section
6. Section 7 contains our conclusions. The online appendix contains all the proofs and derivations as
well as several extensions.


Related literature. First and foremost, our paper is related to the Optimal Currency Area (OCA)
literature. This literature has emphasized a number of important factors for successful currency
unions: factor mobility (Mundell, 1961), openness (McKinnon, 1963), fiscal integration (Kenen, 1969),
and financial integration (Mundell, 1973). Our paper formalizes and refines the arguments of Kenen
(1969), by seeing fiscal unions as the implementation of an optimal risk sharing arrangement within
in a currency union, in a model with explicit micro-foundations. We offer a precise characterization
of the size, direction, and effectiveness of fiscal transfers. Our results qualify the view implicit in
Mundell (1973) that financial integration is a substitute for fiscal integration. Finally, our work con-
trasts with the ideas in McKinnon (1963), who discusses reasons why openness may mitigate the
costs of currency unions. In our paper, fiscal unions are more effective when member countries are
more closed. However, our results are fully compatible with the notion that openness is beneficial in
a currency union lacking a fiscal union.
    Our modeling approach follows the New Keynesian tradition embraced by the New Open Econ-
omy Macro literature. In particular, our static analysis builds on the model of Obstfeld and Rogoff
(2000), and our dynamic analysis builds on the model of Gali and Monacelli (2005, 2008). A flexi-
ble exchange rate allows the implementation of the flexible price allocation (see e.g. Benigno, 2000;
Clarida et al., 2002; Gali and Monacelli, 2005). A fixed exchange rate represents a constraint on
macroeconomic stabilization, and raises the question of the optimal use of monetary policy in a cur-
rency union. Benigno (2004) analyzes the case of a currency union with complete markets, shows
that monetary policy at the union level cannot achieve perfect stabilization with asymmetric shocks,
and characterizes optimal monetary policy at the union level.
    Our paper explores the optimal use of macroeconomic instruments beyond monetary policy, fo-
cusing, in particular, on cross-country transfers or interventions in financial markets. Other studies
have focused on different policy instruments. Beetsma and Jensen (2005) and Gali and Monacelli
(2008) analyze optimal fiscal policy in a currency union by characterizing how government pur-
chases of domestic goods can help stabilize the economy in response to asymmetric shocks. Adao et
al. (2009) and Farhi et al. (2014) show that with a rich enough set of distortionary taxes, the flexible


                                                   5
price allocation can be achieved.4 In our view, however, there are important practical limitations that
constrain the extent to which these tax incentives can be used, leaving considerable room for other
instruments. Ferrero (2009) analyzes another dimension of fiscal policy, focusing on distortionary
taxes and government debt. Farhi and Werning (2012), Schmitt-Grohe and Uribe (2012), and Farhi
and Werning (2016) analyze capital controls. None of these papers considers fiscal transfers across
union members and most assume complete private financial markets. Our work complements these
contributions by analyzing fiscal transfers as another macroeconomic tool.
    Few papers consider optimal policy with incomplete financial markets. An exception is Benigno
(2009) who analyzes optimal monetary policy in the case of incomplete markets and flexible ex-
change rates. Nominal rigidities create a tradeoff between completing markets and stabilizing the
economy. On the one hand, if prices were flexible, the optimum would imitate complete markets by
tailoring the real returns of international bonds. On the other hand, if markets could be completed
or if transfers imitated complete markets, the optimum would be fully efficient. Our modeling as-
sumptions and results are essentially the polar opposite. Our analysis assumes that the exchange
rate is fixed, so that the aforementioned tradeoff is not considered. Furthermore, in the presence of
non-traded goods or home bias, our main result is that complete markets, or transfers that imitate
complete markets, lead to a suboptimal outcome.5
    Auray and Eyquem (2013) consider a currency union with sticky prices. They do not attempt to
study optimal policy but using a set of numerical calibrations, they show that it is possible in some
cases for the laissez faire complete markets equilibrium with a full set state-contingent bonds and no
government interventions in financial markets to deliver lower welfare than the incomplete markets
laissez faire equilibrium with only non-state-contingent bonds or with no bonds. This possibility is
also present in our model because of the market failure that opens up a wedge between privately
and socially optimal portfolios.6
    The key ingredient of the New Open Economy Macro literature is the presence of nominal rigidi-
ties. Another important ingredient, present in some but not all papers in that literature, is the as-
   4 Kehoe   and Pastorino (2017) builds on our environment but include such flexible instruments in the form of flexi-
ble country-specific and state-contingent taxes on non-traded goods, ensuring that the first best can be achieved (as if
exchange rates were flexible) without transfers if markets are complete, that optimal transfers simply replicate the com-
plete markets allocation if markets are incomplete, and also negating the need for any other macroeconomic stabilization
instrument such as government spending or capital controls.
    5 Other features could lead to a similar result even in the absence of home bias or non-traded goods. For example, in

the dynamic model of Sections 4-5, when prices are sticky but not fully rigid, complete markets, or transfers that imitate
complete markets are suboptimal. This is because even in the absence of home bias, transfers still influence the domestic
wage through a wealth effect, and hence also influence inflation and therefore macroeconomic stabilization. This effect,
which arises only when prices are sticky but not fully rigid, would not be internalized by private agents when they
form their portfolios under complete markets. This justifies interventions in financial markets if markets are complete,
or transfers that do not replicate complete markets if markets are incomplete. See Section 6 and in particular footnote 38
for a discussion.
    6 This result, while interesting, is neither our main focus nor our main contribution, which is to study: (i) the socially

optimal use of fiscal transfers to share risk between countries when markets are incomplete; (ii) the socially optimal
use of state-contingent bonds to share risk between countries when markets are complete with optimal government
interventions in financial markets; (iii) how effective these transfers may be in mitigating the inefficiencies from nominal
rigidities and fixed exchange rates. We fully characterize how to optimally design a fiscal union within a monetary union
decentralized as in (i) or as in (ii), and to understand how effective such fiscal unions are as in (iii).


                                                              6
sumption of home bias or non-traded goods. This ingredient is absolutely central for our theory,
and it is also at the core of all analyses of the Transfer Problem. Given these ingredients, we study a
policy instrument that has not been considered before in the literature.


2     A Static Model of a Currency Union
We start with a simple static model that illustrates our main idea most transparently. Later we show
that the same effects are present in standard dynamic open economy models. The model builds on
the model with traded and non-traded goods presented in Obstfeld and Rogoff (2000). There is a
continuum of countries in a currency union. There is a traded good, a non-traded good and labor.
The traded good is supplied inelastically and traded competitively. The non-traded good is supplied
from labor by monopolistic firms. The prices set by these monopolistic firms are sticky.7
    We offer two market settings and associated policy interventions for the same model environ-
ment. The first assumes complete financial markets and features portfolio taxes as the policy in-
strument to influence equilibrium risk sharing across countries. The second assumes incomplete
markets, so that private agents have no opportunities to share risk internationally. In this case we
focus on government arranged international fiscal transfers across countries to provide international
risk sharing. Importantly, we show that both settings lead to the same set of implementable al-
locations. This allows us to characterize efficient allocations using the same second-best Ramsey
planning problems for both settings in Section 3.
    In our view, the first setting offers several conceptual advantages even though is it less realistic.
First, it allows us to make the point that constrained efficient allocations require government inter-
vention even if financial markets are complete. By implication if markets are incomplete, government
intervention should not simply mimic the complete-markets outcome. Second, we can provide sim-
ple formulas for the interventions in the form of portfolio taxes. The incomplete markets setting,
on the other hand, seems more realistic and the implementation of constrained efficient allocations
involves cross-country risk sharing through international fiscal transfers, providing a foundation for
fiscal unions. In any case, although we favor the incomplete-market setting and its implementation
in practical terms, the characterization using complete markets sheds light on both.
    We first present the model with complete markets in Sections 2.1-2.4. We then introduce the
incomplete markets in Section 2.5.


2.1     Households
There is a single period and a continuum of countries indexed by i ∈ [0, 1]. We start by assuming that
all countries belong to a currency union, but will relax this later. Uncertainty affects preferences and
technology: the state of the world s ∈ S has density π (s) and determines preferences and technology,
    7 In Appendix B.1, we show that all our results go through if wages are nominally rigid instead of prices.   In particular,
Propositions 1–12 are still valid.



                                                             7
possibly asymmetrically, in all countries.
   In each country i ∈ I, there is a representative agent with preferences over non-traded goods,
traded goods and labor given by the expected utility
                                      Z
                                           U i (CNT
                                                 i
                                                    (s), CTi (s), N i (s); s)π (s)ds.

Below we make some further assumptions on preferences.
   Agents can trade in a complete set of financial markets before the realization of the state of the
world s ∈ S. Households are subject to the following budget constraints
                                               Z
                                                   Di (s) Q(s)π (s)ds ≤ 0,                                           (1)

       i   i
      PNT CNT (s) + PT (s)CTi (s) ≤ W i (s) N i (s) + PT (s) ETi (s) + Πi (s) + T i (s) + (1 + τDi (s)) Di (s),      (2)

where PNT  i is the price of non-traded goods which as we will see shortly, does not depend on s due to

the assumed price stickiness; PT (s) is the price of traded goods in state s; W i (s) is the nominal wage
in state s; ETi (s) is country i’s endowment of traded goods in state s; Πi (s) represents aggregate
profits in state s; T i (s) is a lump sum rebate; Di (s) is the nominal payoff of the household portfolio
in state s; Q(s) is the price of one unit of currency in state s in world markets, normalized by the
probability of state s; and τDi (s) is a state-contingent portfolio return subsidy.8 The lump sum rebate
T i (s) is used to rebate the proceeds from the tax on financial transactions to households. We some-
times also consider lump-sum transfers over and above such rebates to redistribute wealth across
countries. Note that the nominal price of traded goods is assumed to be the same across countries,
reflecting the law of one price and the fact that all countries in the union share the same currency.
     The households’ first-order conditions can be written as

                                   UCi T (s)[1 + τDi (s)]        UCi T (s0 )[1 + τDi (s0 )]
                                                             =                                ,                      (3)
                                          Q(s) PT (s)             Q(s0 ) PT (s0 )
                                                 UCi T (s)  UCi NT (s)
                                                          =      i
                                                                       ,                                             (4)
                                                   PT (s)     PNT
                                                  i (s)
                                                 UN       UCi NT (s)
                                                − i     =      i
                                                                     .                                               (5)
                                                 W (s)      PNT

2.2    Firms
We assume that the traded good is in inelastic supply: each country is endowed with a quantity
ETi (s) of traded goods. These goods are traded competitively in international markets.
     Non-traded goods are produced in each country by competitive firms that combine a continuum
   8 Above we assumed that the returns from firms are not subsidized. Another possibility is to subsidize profits Πi (s)
                  i ( s ) as financial returns. None of our analysis or conclusions are affected by this modeling choice.
at the same rate τD




                                                             8
of non-traded varieties indexed by j ∈ [0, 1] using the constant returns to scale CES technology

                                                                                            1
                                                               1                           1− 1ε
                                                      Z                               
                                                                    i,j      1
                                    i
                                   YNT (s) =                       YNT (s)1− ε dj                  ,
                                                           0

with elasticity ε > 1.
   Each variety is produced by a monopolist using a linear technology

                                               i,j
                                             YNT (s) = Ai (s) N i,j (s).

Each monopolist hires labor in a competitive market with wage W i (s), but pays W i (s)(1 + τLi ) net of a
country specific tax on labor. Monopolists must set prices in advance, at the beginning of the period,
before the realization of uncertainty. The demand for each variety is given by CNT i ( s )( Pi,j /Pi )−ε
                R i,j                                                                        NT    NT
        i
where PNT   = ( ( PNT )1−ε dj)1/(1−ε) is the price of non-traded goods. They solve

                                                       Q(s)
                                             Z
                                     max                  i
                                                                Πi,j (s)π (s)ds,
                                       i,j
                                      PNT            1 + τD (s)

where                                                                   !−ε
                                                 i                  i,j
                                           1
                                         i,j + τ                  P
                         Πi,j (s) =      − i L W i (s)]CNT
                                      [ PNT                i
                                                             (s)   NT
                                                                    i
                                                                            .
                                            A (s)                 PNT

Aggregate profits are given by Πi (s) = Πi,j (s)dj.
                                        R

   In a symmetric equilibrium, all monopolists in country i set the same profit maximizing price.
Rearranging the first-order condition yields the familiar expression for the price as a markup over a
weighted average of the marginal cost across states

                                                                    Q(s) W i (s) i
                                                                      i ( s ) Ai ( s ) C NT ( s ) π ( s ) ds
                                                           R
                            i                     ε                1+τD
                           PNT = (1 + τLi )                                                                    .   (6)
                                                 ε−1                     Q(s)        i
                                                                           i ( s ) C NT ( s ) π ( s ) ds
                                                                   R
                                                                        1+τD


2.3    Government
The government is subject to the budget constraint

                             T i (s) = τLi W i (s) N i (s) − τDi (s) Di (s) + T̂ i (s).                            (7)

Here T̂ i (s) are net international fiscal transfers which redistribute resources across countries subject
to the constraint                               Z
                                                   T̂ i (s)di = 0,                                     (8)

for all s ∈ S.




                                                                    9
2.4    Equilibrium with Complete Markets
An equilibrium is such that households and firms maximize, the government’s budget constraint is
satisfied, and markets clear9 :

                                                 i
                                                CNT ( s ) = A i ( s ) N i ( s ),                                  (9)
                                            Z                  Z
                                                CTi (s)di =        ETi (s)di.                                    (10)

These conditions imply that the financial markets clear so that Di (s)di = 0 for all s ∈ S.
                                                                 R

   The conditions for an equilibrium (1)–(10) act as constraints on the planning problem we study
next in Section 3.10 In a spirit similar to Lucas and Stokey (1983), we seek to drop variables and
constraints as follows. Given quantities, equations (3), (5) and (6) can be used to back out certain
prices, wages and taxes. Since these variables do not enter the welfare function they can be dispensed
with from our planning problem, along with equations (1), (2), (3), (5), (6), (7), and (8). We summarize
these arguments in the following proposition.

Proposition 1 (Implementability, Complete Markets). An allocation {CTi (s), CNT        i ( s ), N i ( s )} together

with prices { PT (s), PNTi } form part of an equilibrium with complete markets if and only if equations (4) and

(9) hold for all i ∈ I, s ∈ S and equation (10) holds for all s ∈ S.

    Importantly, we cannot dispense with equation (4). This equation summarizes the restriction
imposed by a currency union—that the price of traded goods cannot vary across countries—and
price stickiness—that the price of non-traded goods cannot vary across states of the world. Consider
attempting to use equation (4) as a residual to back out the prices that support a given allocation,
as we did with equations (3), (5) and (6). Equation (4) requires that the relative price of traded to
non-traded goods equal UCi T (s)/UCi NT (s). For any arbitrary allocation, this required relative price
can be computed, but the problem is that it may not be possible to express it as a ratio of a price that
is independent of i and a price that is independent of s, i.e. as a ratio PT (s)/PNT     i . This is why we

must keep equation (4) as a constraint.
    Our constructive proof shows that an allocation {CTi (s), CNTi ( s ), N i ( s )} and prices { P ( s ), Pi }
                                                                                                   T        NT
that satisfy the conditions in the propositions are actually part of several equilibria. We emphasize
two dimensions of indeterminacy. First, we can choose any set of state prices Q(s). Second, we can
choose different transfers T̂ i (s). These two dimensions are actually related in the sense that different
state prices require different ex-post fiscal transfers.
    The first dimension of indeterminacy can be intuitively understood as follows. The relevant
                                                                Q(s)
state prices for households are adjusted for portfolio taxes 1+τ i (s) . Scaling up state prices Q(s) and
                                                                                   D
the corresponding portfolio taxes 1 + τDi (s) by a function λ(s) leaves these tax-adjusted state prices
   9 Our  notation already takes into account the symmetry of prices, output, and labor across varieties j within each
country i.
  10 In addition, the budget constraints (1) and (2) must hold as an equality.




                                                            10
unchanged. However this change indirectly transfers resources across countries and states. These
indirect transfers need to be compensated by adjusting transfers T̂ i (s).
   The second dimension of indeterminacy can be intuitively understood as follows. To what extent
transfers across countries actually operate through financial markets Di (s) or transfers T̂ i (s) is not
pinned down. This can easily be seen by starting with the household’s budget constraint, holding
with equality, and substituting out profits Πi (s) and transfers T i (s) to arrive at the following country
budget constraint
                      Z          h                                 i             Z
                          Q(s)       PT (s)(CTi (s) −   ETi (s))       π (s) =       Q(s) T̂ i (s)π (s)ds,

which states that the expected value of the trade balance must be covered by the expected value
of international fiscal transfers. Indeed, this is the only constraint on fiscal transfers. For example,
one possibility is to constrain transfers to be non-state-contingent T̂ i (s) = T̂ i . All risk sharing is
then being delivered through financial markets, and portfolio taxes are required to make sure that
private agents secure the right amount of insurance Di (s). Another possibility is to set T̂ i (s) =
PT (s)(CTi (s) − ETi (s)). In that case, all risk sharing is being delivered through transfers. Portfolio
taxes are then required to ensure that private agents do not “undo” these transfers.


2.5   Equilibrium with Incomplete Markets
We also consider an alternative setup where markets are incomplete, in the sense that there are no
financial markets before the realization of the state of the world s ∈ S. We split the representative
agent in country i into a continuum of households j ∈ [0, 1]. Household j is assumed to own the firm
of variety j. Household j maximizes utility
                                       Z
                                           U i (CNT
                                                 i
                                                    (s), CTi (s), N i (s); s)π (s)ds,

                                                                                                  i,j
by choosing {CTi (s), CNT
                       i ( s ), N i ( s )} and the prices set by its own firm P , taking aggregate prices
                                                                               NT
                     i , W i ( s )} and aggregate demand {C̄ i ( s )} as given, subject to
and wages { PT (s), PNT                                          NT

                i   i
               PNT CNT (s) + PT (s)CTi (s) ≤ W i (s) N i (s) + PT (s) ETi (s) + Πi,j (s) + T i (s),          (11)

where                                                                                           !−ε
                                                                                          i,j
                                              i,j    1 + τi                             PNT
                            Πi,j (s) =     [ PNT    − i L W i (s)]C̄NT
                                                                    i
                                                                       (s)               i
                                                                                                      .
                                                     A (s)                              PNT




                                                             11
The corresponding first-order conditions are symmetric across j and given by (4) and (5) and the
price setting condition

                                                                 UCi (s) W i (s)
                                                                                        i ( s ) π ( s ) ds
                                                                                      C̄NT
                                                             R        T
                                 i                      ε         PT (s) Ai (s)
                                PNT   =   (1 + τLi )                                                         .        (12)
                                                       ε−1            UCi (s)
                                                                                     i ( s ) π ( s ) ds
                                                                                   C̄NT
                                                                 R          T
                                                                          PT (s)

                                                          i ( s ) = C i ( s ) for all i and s.
In equilibrium we impose the consistency condition that C̄NT          NT
    The government budget constraint simplifies to

                                            T i (s) = τLi W i (s) N i (s) + T̂ i (s).                                 (13)

    We can now define an equilibrium with incomplete markets. An equilibrium specifies quantities
           i ( s ), N i ( s )}, prices and wages { P ( s ), Pi , wi ( s )}, taxes { τ i , T i ( s )} and international fis-
{CTi (s), CNT                                       T        NT                      L
                   i
cal transfers { T̂ (s)} such that households and firms maximize, the government’s budget constraint
is satisfied, and markets clear. More formally, the conditions for an equilibrium are given by (4), (5),
(8), (11) holding with equality, (12) with C̄i (s) = Ci (s), and (13).
    As in the complete markets implementation, we can drop variables and constraints as follows.
Given quantities, equations (5) and (12) can be used to back out certain prices, wages and taxes. Since
these variables do not enter the welfare function they can be dispensed with from our planning
problem, along with equations (5), (8), (11), (12), and (13). We summarize these arguments in the
following proposition.

Proposition 2 (Implementability, Incomplete Markets). An allocation {CTi (s), CNT       i ( s ), N i ( s )} together
                        i } form part of an equilibrium with incomplete markets if and only if equations (4) and
with prices { PT (s), PNT
(9) hold for all i ∈ I, s ∈ S and equation (10) holds for all s ∈ S.

    Propositions 1 and 2 reach the same implementability conditions for the complete- and incomplete-
market settings. Although the set of implementable quantities {CTi (s), CNT       i ( s ), N i ( s )} and prices
           i } is the same, the required policy instruments are of course different.
{ PT (s), PNT
    Under complete markets, portfolio taxes {τDi (s)} are needed, and transfers { T̂ i (s)} are largely
indeterminate. In contrast, in the incomplete market setting no restriction on private portfolios are
introduced since no assets are available to private agents. In this case, transfers { T̂ i (s)} are uniquely
determined as T̂ i (s) = PT (s)(CTi (s) − ETi (s)) and are typically state-contingent.


2.6    Homothetic Preferences
We characterize the key condition (4) further by making some weak assumptions on preferences:
(i) preferences over consumption goods are weakly separable from labor; and (ii) preferences over
                                                        P (s)
consumption goods are homothetic. Denoting by pi (s) = PTi the relative price of traded goods in
                                                                                       NT




                                                                 12
state s in country i, these assumptions imply that

                                          i
                                         CNT (s) = αi ( pi (s); s)CTi (s),

for some function αi ( p; s) that is increasing and differentiable in its first argument. This conveniently
encapsulates the restriction implied by the first-order condition (4). This condition is crucial because
the stickiness of non-traded prices, together with the lack of monetary independence, places restric-
tions on the possible variability across i ∈ I, for any state of the world s, in the relative price pi (s).


3       Constrained Efficient Risk Sharing in the Static Model
In this section we characterize constrained Pareto efficient allocations. Before doing so, it is use-
ful to briefly describe first-best allocations. They are characterized by two requirements. First, the
marginal rate of substitution between labor and non-traded goods must be equal to the correspond-
ing marginal rate of transformation11

                                                 i (s)
                                              −U N
                                               i
                                                       = A i ( s ),
                                              UCNT (s)
for every sate s and country i. Second, the standard optimal risk-sharing conditions
                                                                    0
                                              UCi T (s)         UCi T (s)
                                                           =                  ,
                                             UCi T (s0 )        UCi T (s0 )
                                                                   0



must hold for every pair of states (s, s0 ) and countries (i, i0 ). For every first-best allocation, we can
                                                   i 0
find Pareto weights λi such that UCi T (s) = λi0 UCi T (s) for every state s and pair of countries (i, i0 ) and
                                                 λ
conversely, to any set of Pareto weights λi corresponds a first-best allocation, so that we can think of
the set of first-best allocations as being indexed by these Pareto weights.
    As we shall see, first-best allocations are typically not achievable in a currency union with nom-
inal rigidities under our competitive equilibrium notion with or without complete markets. Instead
we seek to characterize second best allocations that are constrained Pareto efficient among the al-
locations that are the outcomes of a competitive equilibrium. For this purpose, it is useful to first
introduce the labor wedge
                                                              UNi (s)
                                                         1
                                        τ i (s) = 1 + i               ,
                                                       A (s) UCi (s)
                                                                NT

for every state s and country i. Labor wedges are zero at first-best allocations, but are typically not
in equilibrium allocations. The optimal risk sharing condition above holds at allocations which are
the outcomes of competitive equilibria with complete markets when there are no interventions in
financial markets. They typically do not hold at allocations which are the outcomes of competitive
    11 In
     this and other expressions and functions we streamline the notation by leaving the dependence on some of the
arguments implicit.


                                                           13
equilibria with complete markets when there are interventions in financial markets, or which are the
outcome of competitive equilibria with incomplete markets. A fundamental result of our analysis
below is that they typically do not hold at second-best allocations.


3.1    Indirect Utility Function for Transfers
Define the indirect utility function

                                                                                           αi ( p; s)
                                                                                                           
                                              i                  i        i
                                        V (CT , p; s) = U                α ( p; s)CT , CT , i         CT ; s .
                                                                                            A (s)

In an equilibrium with CTi (s) and pi (s), ex-post welfare in state s in country i is then given by
V i (CTi (s), pi (s); s). The derivatives of the indirect utility function will prove useful for our analysis.

Proposition 3. The derivatives of the indirect utility function are

                                   αip (s)                                                                       αi ( s ) i
                       Vpi (s) =              CTi (s)UCi T (s) τ i (s)        and   VCi T (s) = UCi T (s)[1 +             τ (s)].
                                   pi ( s )                                                                      pi ( s )

     These observations about the derivatives and their connection to the labor wedge will be key to
our results. A private agent values a transfer in traded goods according to its private marginal utility
UCi T (s), but the actual social marginal value in equilibrium is VCi T (s). The wedge between the two
            αi ( s )          Pi C       (s)
equals pi (s) τ i (s) = PNT(s)CNT (s) τ i (s), the labor wedge weighted by the relative expenditure share of
                         T      T
non-traded goods relative to traded goods. We will sometimes refer to it as the weighted labor wedge
for short.
    In particular, a private agent undervalues transfers VCi T (s) > UCi T (s) whenever the economy is
experiencing a recession, in the sense of having a positive labor wedge τ i (s) > 0. Conversely, private
agents overvalue the costs of making transfers VCi T (s) < UCi T (s) whenever the economy is booming,
in the sense of having a negative labor wedge τ i (s) < 0. These effects are magnified when the
economy is relatively closed, so that the relative expenditure share of non-traded goods is large.12
    When country i receives a transfer, its consumers feel richer and increase their spending on both
traded and non-traded goods in equal proportions. Since prices are fixed, the resulting increased
demand for non-traded goods translates one-for-one into an increase in output. This in turn gener-
ates more income, further raising spending etc. This mechanism is at the core of the famous Transfer
Problem controversy between Keynes (1929) and Ohlin (1929). These equilibrium effects, which are
not internalized by private agents, open up a wedge between the social and private marginal values
of transfers.
  12 Note that this definition of boom and bust is anchored in the difference between output and the potential level of
output, in the sense that a boom is defined to be a situation where output is above potential. These Keynesian notions of
boom and bust are the relevant ones for the allocation of transfers across countries. It is perfectly possible for output to
be below potential but for potential output to be high, so that the country could be growing and experiencing a bust at
the same time.



                                                                              14
    Since the increase in demand for both goods is proportional, the “dollar-for-dollar” output mul-
tiplier of transfers is precisely given by the relative expenditure share of non-traded to traded goods
 i Ci (s)
PNT   NT
          The labor wedge τ i (s) summarizes the net calculation for utility of the increase in non-
PT (s)CTi (s)
              .
traded consumption and the increase in labor that accompany the increase in output. This explains
                                                                                                                 i Ci (s)
                                                                                                                PNT
why the wedge between the social and private marginal valuations is precisely                                         NT
                                                                                                                PT (s)CTi (s)
                                                                                                                              τ i (s).13


3.2       Second-Best Ramsey Planning Problem
We consider a planning problem that allows us to characterize the set of constrained Pareto efficient
allocations. The planning problem is indexed by a set of nonnegative Pareto weights λi . By vary-
ing these Pareto weights, we can trace out the entire constrained Pareto frontier. The second-best
planning problem is
                                                                                              !
                                                                                PT (s)
                                                       Z Z
                                      max                     λi V i    CTi (s), i ; s            π (s) di ds                              (14)
                                        i ,C i ( s )
                                PT (s),PNT  T
                                                                                 PNT

subject to                                             Z                     Z
                                                            CTi (s)di   =        ETi (s)di.

    Let µ(s)π (s) be the multiplier on the resource constraint in state s ∈ S. The first-order conditions
for CTi (s), PT (s) and PNT
                         i  are respectively

                                                                    λi VCi T (s) = µ(s),
                                                                      1
                                                           Z
                                                             Vpi (s) i λi di = 0,
                                                                    PNT
                                                  Z
                                                       Vpi (s) pi (s)π (s)ds = 0.

                                                                                               i
These first-order conditions tightly characterize the solution. The first-order condition for PNT im-
plies our first proposition.

Proposition 4 (Optimal Price Setting). At a constrained Pareto efficient equilibrium, for every country i, a
weighted average of labor wedges across states is zero
                                         Z
                                             αip (s) CTi (s) UCi T (s) τ i (s) π (s) ds = 0.

   In the absence of uncertainty this proposition implies a zero labor wedge in each state. With
uncertainty, in general the labor wedge for a given country takes on both signs across states with a
  13 It is theoretically possible for the marginal value of a transfer to be negative VCi T (s) < 0 if the labor wedge is
sufficiently negative, especially if the share of non-traded goods, relative to traded goods, is large enough. In this
extreme case a country can improve welfare by making gift transfers, without any counterpart transfer in the opposite
direction. If τ i is sufficiently negative then unilateral gift transfers to other countries are welfare enhancing for country i.
This extreme case will not be our focus and is not employed in any of our results below. However, it is a stark example
of just how divergent public and private valuations of transfers can become.

                                                                        15
weighted average of zero.14
   The first-order condition for PT (s) implies the following proposition.
Proposition 5 (Optimal Monetary Policy). At a constrained Pareto efficient equilibrium, in every state s,
a weighted average of labor wedges across countries is zero
                                       Z
                                           αip (s)CTi (s)UCi T (s) τ i (s)λi di = 0.

    This proposition establishes that optimal monetary policy targets a weighted average across
countries for the labor wedge. It sets this target to zero in each state of the world. The intuition
for the result is that monetary policy can be chosen at the union level, and can adapt across states
to the average condition. If all countries are identical and the shock is symmetric, then we obtain
perfect stabilization in each country: τ i (s) = 0 for all i ∈ I, s ∈ S. By contrast, when shocks across
countries are not symmetric then perfect stabilization is impossible. However, at the union level the
economy is stabilized in the sense that the weighted average for the labor wedge across countries is
set to zero for all states of the world s ∈ S.15
    Finally, the first-order condition for CT (s) says that the marginal utility of transfers in traded
goods adjusted for the Pareto weight λi VCi T (s) should be equalized across countries for every state s,
or in other words that for every pair of states (s, s0 ), and pair of countries (i, i0 ), we have
                                                                               0
                                                      VCi T (s)          VCi T (s)
                                                                    =                  .
                                                     VCi T (s0 )         VCi T (s0 )
                                                                               0




It is more revealing to rewrite this condition using our expressions for the derivative of VCi T (s).
Proposition 6 (Constrained Efficient Risk Sharing). At a constrained Pareto efficient equilibrium, for
every pair of states (s, s0 ), and pair of countries (i, i0 ), risk sharing takes the following form
                                                                                             0
                                               αi ( s ) i                          0       αi ( s ) i 0
                              UCi T (s)[1 +               τ (s)]         UCi T (s)[1 +       0      τ (s)]
                                               pi ( s )                                    pi ( s )
                                                                    =                                           .    (15)
                                               αi ( s 0 ) i 0                                0
                                                                                           αi ( s 0 ) i 0 0
                             UCi T (s0 )[1 +   pi ( s 0 )
                                                          τ (s )]       UCi T (s0 )[1 +
                                                                           0
                                                                                             0        τ (s )]
                                                                                           pi ( s 0 )


  If markets are complete and portfolio taxes are not employed, then the risk sharing condition (3)
imposes the additional constraint that for every pair of states (s, s0 ) and countries (i, i0 ), we have
                                                                                   0
                                                     UCi T (s)           UCi T (s)
                                                                    =                  .                             (16)
                                                     UCi T (s0 )         UCi T (s0 )
                                                                               0


  14 Inthe absence of uncertainty, the labor tax to cancel the monopolistic markup τLi = −1/ε. With uncertainty, in
general τLi 6= −1/ε. When the sub-utility function between CNT and CT is a CES so that α(·; s) has constant elasticity,
independent of s, then τLi = −1/ε is optimal even with uncertainty. The proof is contained in the Appendix A.3.
  15 The result is related to the result in Benigno (2004) and Gali and Monacelli (2008) that optimal monetary policy in a

currency union ensures that the union average output gap, in a linearized version of the model, is zero in every period.
Here the result is obtained without linearizing the model and it is expressed in terms of the labor wedge, instead of the
output gap.

                                                                    16
Comparing these conditions, one may expect the private risk sharing condition (16) to be incom-
patible with the constrained efficient risk sharing condition (15) except in special cases. Indeed, we
next show that because labor wedges must average to zero across states and countries according to
Propositions 4 and 5, they are indeed incompatible unless the first best is attainable. This implies
that equilibria with privately optimal risk sharing are constrained Pareto inefficient.16

Proposition 7 (Inefficiency of Private Risk Sharing). An equilibrium with complete markets and no port-
folio taxes (τDi (s) = 0 for all i ∈ I, s ∈ S) is constrained Pareto inefficient unless τ i (s) = 0 for all i ∈ I, s ∈ S,
in which case it is first best.

   With complete markets but without interventions in financial markets, private agents do not
secure the constrained efficient amount of risk sharing in financial markets. They do not fully in-
ternalize the macroeconomic stability consequences of their portfolio decisions, opening a role for
government intervention in financial markets.17


3.3    Implementation
We now turn to the implementation of constrained Pareto efficient allocations. With complete mar-
kets, constrained Pareto efficient equilibria can be decentralized with appropriate labor taxes τLi and
corrective portfolio taxes τDi (s). Proposition 6 leads to a neat characterization of the required taxes.

Proposition 8 (Complete Markets and Portfolio Taxes). If private asset markets are complete, constrained
Pareto efficient allocations can be implemented by the following portfolio return subsidy/taxes

                                                             αi ( s ) i
                                                 τDi (s) =            τ ( s ).
                                                             pi ( s )

    Insurance for bad states of the world, where the weighted labor wedge is high, should be rela-
tively subsidized. Government intervention secures additional transfers from low weighted labor
wedge countries (“boom” countries) to high weighted labor wedge countries (“bust” countries).
This reduces the demand for non-traded goods in the boom countries and increases it in the bust
countries, stabilizing output and income. These stabilization benefits are not internalized by private
agents, hence the need for government intervention.
    It is interesting to note that the taxes do not depend directly on the Pareto weights λi , but only
indirectly through the relative expenditure share of non-traded goods and the labor wedge. This
underscores the fact that they are imposed to correct a macroeconomic aggregate demand externality
and not to redistribute.
  16 Note   that our definition of constrained efficient risk sharing is a second best concept which is different from the
concept of first best risk sharing. At the first best, both the constrained efficient risk sharing condition (15) and the
privately optimal risk sharing condition (16) hold, because the labor wedges are all equal to zero. Away from the first
best, these two conditions differ. Another way of stating our result is that it is optimal to deviate from the target of
first-best risk sharing in order to help achieve the other target of stabilizing the economy.
   17 We should also point out that the Propositions 5 and 6 go through if non-traded goods prices are entirely predeter-

mined (i.e. are exogenously fixed).


                                                             17
   The implementation of the social optimum with corrective portfolio taxes is only one interest-
ing possibility. Another equally interesting interpretation of our results assumes that private asset
markets are nonexistent, so that private opportunities for risk sharing are unavailable. The same
optimum can then be implemented through state-contingent transfers.18

Proposition 9 (Incomplete Markets and Ex-Post Transfers). If private asset markets are incomplete so
that state-contingent assets are unavailable, constrained Pareto efficient allocations can also be implemented
through state-contingent transfers

                                           T̂ i (s) = PT (s)(CTi (s) − Ei (s)).

    Under this alternative implementation, no restriction on private portfolios are needed since no
assets are available to private agents. Our results can then be seen as offering a precise character-
ization of the required transfers. A key conclusion of our analysis is that these transfers would go
beyond replicating the outcome that private risk sharing decisions would achieve if markets were
complete.
    It is also possible to imagine implementations that are in between the two polar cases of correc-
tive portfolio taxes with complete markets and state-contingent transfers with incomplete markets.
In general, government positions in asset markets, or state-contingent transfers, combined with re-
strictions or tax incentives on private portfolios are required.
    It is important to stress that our results hold for any constrained Pareto efficient allocation, or
equivalently, for any set of Pareto weights λi . They are not driven by a desire to redistribute across
countries and instead reflect an insurance motive. One way to see this is that in general it is always
possible to find Pareto weights λi such that T̂ i (s)π (s)ds = 0 for every country i. For example, in
                                                  R
                                                                                                     0
the special case where countries are ex-ante identical these Pareto weights are equal λi = λi for all
pair of countries (i, i0 ). Our results hold for this particular set of Pareto weights. Except in knife edge
circumstances where the corresponding allocation is first best, portfolio taxes will be required for its
implementation if markets are complete, and transfers will go beyond replicating complete markets
if markets are incomplete.
  18 We could also envision intermediate cases of incomplete markets, in which case both portfolio taxes and transfers
will be required in conjunction. In these cases, transfers are useful and required to the extent that they expand risk-
sharing possibilities beyond those available through financial markets, and portfolio taxes are required to influence
risk-sharing through financial markets. Assume for simplicity that S is discrete that there are N aggregate states of
nature, and that there the space A of asset payoffs that is available through traded securities is of dimension M ≤ N.
Then the decentralization requires both portfolio taxes and fiscal transfers. In general, to implement the optimum in that
way requires access to a set state-contingent fiscal transfers F such that A + F = R N . This implies that dim(F ) = N −
dim(A) − dim( A ∩ F ) ≥ N − M. If this is not the case, then in some cases, the constrained Pareto efficient allocations
that we have characterized cannot be decentralized, which means that we need to set up a different, more constrained,
planning problem.




                                                           18
3.4    Countries Outside the Currency Union
Up to this point we have assumed that all countries belong to the currency union. Now, imagine that
only a subset of countries I ⊆ [0, 1] are members. The rest manage monetary policy independently
                      / I sets its own local nominal price for the traded good PTi (s) = Ei (s) PT (s) in
as follows. Country i ∈
its home currency by manipulating the level of its exchange rate Ei (s) against the union’s currency.19
The planning problem becomes

                                                                                                          Pi ( s )
                                                                  !                                                  !
                                                       PT (s)
                           Z                                                   Z
                     max              λi V i   CTi (s), i ; s         di +               λi V i   CTi (s), Ti ; s        di   (17)
                               i∈ I                     PNT                         /I
                                                                                   i∈                      PNT

subject to                                            Z                    Z
                                                          CTi (s)di   =        ETi (s)di.

                    / I outside the union, the first-order condition for PTi (s) is
    For a country i ∈

                                                       Vpi (CTi (s), pi (s); s) = 0.

                                       αip (s) i
Since Vpi (CTi (s), pi (s); s) =               C (s)UCi T (s) τ i (s),
                                       pi ( s ) T
                                                                         it follows that

                                                τ i (s) = 0        for all s ∈ S, i ∈
                                                                                    / I.

A flexible exchange rate leads to perfect stabilization, in the sense that the labor wedge is set to zero
for all states of the world. This result is reminiscent of the arguments set forth by Friedman (1953)
and Mundell (1961) in favor of flexible exchange rates. For countries in the currency union, optimal
monetary policy is still imperfect and characterized by the average condition for the labor wedge in
Proposition 5.
    The constrained efficient risk sharing condition in Proposition 6 still applies to all countries, in-
side or outside the currency union. However, since τ i (s) = 0 for s ∈ S, i ∈
                                                                            / I, this condition coincides
with the privately optimal risk sharing condition for countries outside the currency union. As a
result, there is no need to upset private risk sharing.

Proposition 10 (Countries Outside the Currency Union). None of the results are affected by considering
countries outside the union. Countries that have independent monetary policy manage to obtain a zero labor
wedge τ i (s) = 0. If markets are complete, they should not intervene in financial markets τDi (s) = 0. If
markets are incomplete, they should seek to secure ex-post transfers T̂ i (s) that replicate privately optimal risk
sharing outcomes.

    If markets are incomplete, then transfers might be required even outside a currency union. In-
terestingly, we will show that, in the dynamic version of the model with only traded goods and
  19 Sincethe price of traded goods is modeled as flexible here, we do not require assumptions about Producer Currency
Pricing (PCP) versus Local Currency Pricing (LCP).


                                                                      19
home bias in preferences, there are cases (the Cole-Obstfeld case) where transfers are not required
for countries outside a currency union, whereas they are required for countries inside a currency
union.
    Crucially, our results establish that inside a currency union, transfers should go beyond repli-
cating the outcome that would arise if markets were complete. In this sense, our results yield two
important insights. First, currency unions and fiscal unions go hand in hand. Second, fiscal integra-
tion and financial integration are not perfect substitutes.
    How are attitudes towards risk affected by membership in a union? We show that members
are more risk averse in the following sense. Suppose country i belongs to the currency union with
equilibrium relative price pi (s). The advantage of leaving the union is that the relative price pi
is not constrained and welfare attains the first best level conditional on CTi . Define V i∗ (CTi ; s) =
max p V i (CTi , p; s). It follows that

                                        V i (CTi , pi (s); s) ≤ V i∗ (CTi ; s),                             (18)

with equality if and only if pi (s) ∈ arg max p V i (CTi , p; s), in which case the labor wedge is zero,
τ (s) = 0. Thus, for every state s, the function V i∗ is the upper envelope over V i (CTi , p; s) for different
values of p and is tangent to it precisely at a level of p that implies a zero labor wedge. In this sense,
V i (CTi , pi (s); s) is more concave than V i∗ and member countries are more risk averse. We shall put
this inequality to use in the next section.


3.5   Value of Risk Sharing
Our simple model allows for three random disturbances: (i) shocks to productivity of labor in the
production of non-traded goods; (ii) shocks to preferences (demand); and (iii) shocks to the endow-
ment of traded goods. Proposition 7 shows that if the equilibrium with complete markets but with-
out portfolio taxes does not attain the first best, then it is constrained inefficient. As we show next,
this is the case except in knife-edge cases. Examining these knife-edge cases turns out to be inter-
esting, because even when the equilibria coincide with the first best we find that the planner values
the availability of insurance strictly more than private agents do, and do in that sense, risk sharing
is of greater social than private value. Extrapolating beyond our model, this could help explain why
macro insurance markets may be missing, even if their social value is significant.
    To engineer an example where the first best is attainable it is useful to specialize the model by
using the utility function

                                                                                   1
                      U i (CT , CNT , N; s) = log(CT ) + αi (s) log(CNT ) −           N 1+ φ ,              (19)
                                                                                  1+φ

with φ ≥ 0.

Proposition 11. Suppose that the utility function is given by (19), then the equilibrium with complete markets
but without portfolio taxes is constrained efficient if and only if it is first best, which occurs if and only if

                                                         20
productivity shocks and preference shocks are such for all pairs of countries (i, i0 ), the ratio

                                                                                 1−+φφ
                                                      Ai ( s )       αi ( s )
                                                                 

                                                      Ai ( s )       αi ( s )
                                                        0              0



is constant for all s ∈ S.

   The key constraint imposed by nominal rigidities and a single monetary policy is condition (4),
rewritten here for convenience as
                                      UCi NT (s)     i
                                                    PNT
                                                 =
                                      UCi T (s)    PT (s)

where PT (s) is only allowed to vary with s not i, while PNT     i  is allowed to vary with i but not s.
One can handle fixed differences across countries and union-wide shocks to this marginal rate of
substitution, but not individual variations.
    Proposition 11 defines a precise notion of symmetric shocks to productivity and preferences for
which the first best allocation is attainable without portfolio taxes. For example, if the only shocks are
to productivity, then this condition requires that productivity vary proportionally across countries. A
currency union can handle such a shock using union-wide monetary policy. A similar point applies
to taste shocks.
    This discussion highlights just how special these circumstances are. Note, however, that the
proposition implies that traded good endowment shocks can be properly insured with complete
markets and without portfolio taxes. To understand this result, suppose we only have shocks to
the endowment of traded goods. Then the first best features perfect risk sharing in the consump-
tion of traded goods so that only aggregate fluctuations in the endowment of traded goods affect
the consumption of traded goods. Due to the separability of preferences, the first best allocation
for non-traded goods and labor is not affected by these shocks. It follows that the marginal rate of
substitution only varies with union-wide shocks, and the first best is implementable as an equilib-
rium.20,21
    It is useful to have a case, however artificial, where private risk sharing is constrained efficient
so that we can isolate a separate result. We show that members of a currency union value this risk
sharing more than countries outside it. Moreover, this is is not true of the value placed on risk
sharing by private individuals. This highlights the role of the aggregate demand externality from
risk sharing decisions, which is not internalized by private agents.

                                                                                                               R1
  20 In     more detail, suppose Ai (s) = Ai and αi (s) = αi . The first best allocation features CTi (s) = λ1i 0 Ei (s)di, N i (s) =
      1                             1
 αi 1+φ , and CNT   i ( s ) = Ai αi 1+φ . This allocation is supported as an equilibrium without portfolio taxes by Pi
                                                                                                                               NT =
   i
      1+φ φ    i i
                                R1 i        − 1 i        i
                                                            1+φ φ   i                    i   ε −1
 α           /(λ A ), PT (s) = ( 0 E (s)di ) , W (s) = α           /λ , Q(s) = 1 and 1 + τL = ε .
  21 Of course, the case of traded good endowment shocks is somewhat artificial, relying on the modeling asymmetry

that non-traded goods are produced but traded goods are not. If instead traded goods were produced from labor and
another fixed input (capital or land) subject to (industry specific) productivity shocks, then these shocks would also
have to satisfy the restriction of being symmetric to attain the first best—just as in the case of productivity shocks in the
non-traded goods.


                                                                 21
                                                                            V ∗ (·)

                                                                             V (·)




                                                                                      CT
                                         E( L)       Ē        E( H )

Figure 1: Welfare as perceived by individual agents (upper green curve) and country as a whole
(lower blue curve).

Proposition 12. Suppose that there are only traded good endowment shocks and that all risk is idiosyncratic,
so that the aggregate endowment of traded goods is constant across states. If we exclude a country from risk
sharing, then its utility loss is greater if it belongs to a currency union. If we exclude a single individual within
a country from risk sharing, then the utility loss is the same whether or not his country belongs to a currency
union.

    Figure 1 illustrates the basic logic behind the first part this proposition for an example with two
equiprobable endowment values. Since the aggregate endowment is constant, the price of traded
goods is constant and complete markets without portfolio taxes offer fair insurance. The resulting
equilibrium features constant consumption of the traded good at the average value of the endow-
ment and constant prices and wages. This is true for both members and non members. When the
country is excluded from risk sharing its consumption of the traded good must now fluctuate with
its endowment, creating a mean-preserving spread in consumption of traded goods and a loss in
expected utility. The crucial point is that the loss is greater for union members because they are more
risk averse, according to inequality (18). Indeed, given that prices are constant and the utility func-
tion is independent of the state s this inequality simplifies to V i (CTi , p̄) ≤ max p V i (CTi , p) = V i∗ (CTi ).
These two indirect utility functions are depicted in the figure. They are tangent at the average value
of the endowment Ē because this represents the equilibrium consumption level with risk sharing.
    As to the second part of the proposition, it follows easily from the observation that in the context
of this specific example, the equilibrium with risk sharing is the same whether or not the country
belongs to the currency union. In both cases the first best allocation is attained. Therefore, if an
individual is excluded from risk sharing, he faces the same prices whether the country is a member
or not. Thus, the drop in utility is the same.




                                                          22
3.6         Insurance vs. Incentives: Limited Commitment and Moral Hazard
Explicit or implicit insurance arrangements inevitably raise concerns of incentives. We have ab-
stracted from these considerations, not because we believe them to be unimportant, but in order to
isolate the effects of the aggregate demand externality on optimal risk sharing. Modeling them re-
quires making specific choices regarding the underlying agency problems.The possibilities are vast
and exploring them all is beyond the scope of this paper, but we believe that the main insights of our
analysis would carry over.22
     In the appendix, we analyze two examples, one where countries have a limited ability to commit
to paying international transfers to other countries (Appendix B.2) and one where countries can en-
gage in a form of moral hazard which influences the distribution of states of the world (Appendix
B.3). In both cases, there is a meaningful tradeoff between insurance and incentives, and the opti-
mality condition characterizing the optimal resolution of this tradeoff involves the social marginal
utility of transfers, a key sufficient statistic which is different for countries in a currency union where
                             αi ( s )
it is given by UCi T (s)[1 + pi (s) τ i (s)] than for countries with a flexible exchange rate where it is given
by UCi T (s).


4       A Dynamic Model
The static model reveals some key results in a simple and transparent manner. However, it is per-
haps too simple to explore the issues in greater depth, and in particular to think about two key
determinants of fiscal unions: price adjustment dynamics and the persistence of shocks. We now
build a richer, dynamic model similar to Farhi and Werning (2012) which in turn builds on Gali and
Monacelli (2005, 2008). We present the model with incomplete markets where agents can only trade
short-term risk free bonds as in Farhi and Werning (2012).23 Just as in the static model, we tackle the
optimal design of international state-contingent fiscal transfers.
   In Section 5, we analyze the model using a log-linear approximation of the nonlinear model
around its perfect foresight symmetric steady state. We derive an impulse response characterization
of optimal transfers following a shock. It is well understood that in log-linearized models, agents
behave according to a certainty equivalence principle, and that the impulse response to a particular
shock is independent of the probability distribution of shocks in the nonlinear model. For these
reasons, and to simplify the exposition, we focus our presentation of the nonlinear model in this
section on the perfect foresight case where one-time unanticipated shocks to the path of productivity
    22 In
        practice of course, institutional mechanisms exist to mitigate these agency problems. For example, most fiscal
unions such as the US channel a large part of their transfers through more or less rules-based automatic stabilizers
(through the unemployment insurance program, federal income and social security taxes, bailout funds), probably for
reasons of political acceptability and transparency, but also to mitigate the difficulties associated with collecting and dis-
tributing discretionary transfers ex post. Other examples are state debt limits in the US, and collective budget procedures
and enforcement mechanisms that already exist in Europe.
   23 We will also compare it to the complete financial market case when we turn to the log-linearized version of the model

in Section 5.



                                                             23
in each country are realized at t = 0, with no further uncertainty.24 The assumption of incomplete
markets translates into the requirement that absent international transfers, the initial net foreign asset
position of any given country be independent of the particular realization of the shock. International
transfers between countries can be arranged contingent on the realization of shocks and it is precisely
the optimal arrangement of these transfers in response to shocks that we seek to characterize.25


4.1    Households
There is a continuum of measure one of countries i ∈ [0, 1]. We focus attention on a single country,
which we call Home, and which can be thought of as a particular value H ∈ [0, 1]. In every country,
there is a representative household with preferences represented by the utility function

                                                                  1+ φ
                                               ∞
                                                         Ct1−σ
                                                     "                 #
                                                                 Nt
                                              ∑ βt             −
                                                         1−σ 1+φ
                                                                         ,
                                              t =0

                                                                                            η −1        η −1    η −η 1
                                                                                         1           1
where Nt is labor, and Ct is a consumption index defined by Ct = (1 − α) CH,t + α CF,t                  . Here
                                                                                         η     η     η     η


                                                                                                e
                                                                                 1     e −1
                                                                              R            
                                                                                              e −1
CH,t is an index of consumption of domestic goods given by CH,t = 0 CH,t ( j) e dj                 , where j ∈
[0, 1] denotes an individual good variety. Similarly, CF,t is a consumption index of imported goods
                                γ−γ 1
                    R 1 γ−γ 1
                  
given by CF,t =      0 Ci,t di         , where Ci,t is, in turn, an index of the consumption of varieties of
                                                                         e
                                                           1       e −1
                                                        R
                                                                         e −1
goods imported from country i, given by Ci,t = 0 Ci,t ( j) e dj               .
    Thus e is the elasticity between varieties produced within a given country, η the elasticity be-
tween domestic and foreign goods, and γ the elasticity between goods produced in different foreign
countries. An important special case is the Cole-Obstfeld case which obtains when σ = η = γ = 1.
This case, which was first studied by Cole and Obstfeld (1991), is more tractable and has some special
implications which we will highlight later in Sections (5)-(6).
    The parameter α indexes the degree of home bias and can be interpreted as a measure of open-
ness. As α approaches zero, the share of foreign goods vanishes. As α approaches one, the share of
home goods vanishes. Since the country is infinitesimal, the latter captures a very open economy
without home bias, while the former captures a closed economy barely trading with the outside
world.
  24 Consider a fully stochastic version of the nonlinear model where shocks are drawn from a given distribution in every

period starting at t = 0. Take the point-wise limit when the variance of the distribution of shocks goes to zero of the
impulse response to a given shock of the log-linearized version of this model. It coincides with the impulse response
of the log-linearized version of the perfect foresight model to a one-time unanticipated shock. Because markets are
incomplete, the performance of the log-linear approximation of the perfect foresight model as an approximation of the
fully stochastic version of the nonlinear deteriorates in the long run as the economy moves away from the steady state
in response to successive shocks, but because of discounting, this does not affect the validity of our characterization of
optimal transfers and of their benefits in response to shocks at t = 0. These issues do not arise in the perfect foresight
version of the model with one-time unanticipated shocks.
  25 As should be clear from this description, our notion of market incompleteness is that markets are incomplete across

states of the world but not over time.


                                                            24
   Households seek to maximize their utility subject to the sequence of budget constraints

  Z 1                              Z 1Z 1                                     Z 1
          PH,t ( j)CH,t ( j)dj +            Pi,t ( j)Ci,t ( j)djdi + Dt+1 +         Ei,t Dti +1 di
      0                             0   0                                      0
                                                                                                     Z 1
                                                         ≤ Wt Nt + Πt + Tt + (1 + it−1 ) Dt +              Ei,t (1 + iti −1 ) Dti di
                                                                                                      0

for t = 0, 1, 2, . . . In this inequality, PH,t ( j) is the price of domestic variety j, Pi,t ( j) is the price of
variety j imported from country i, Wt is the nominal wage, Πt represents nominal profits, and Tt is
a nominal lump sum transfer. All these variables are expressed in domestic currency. The portfolio
of home agents is composed of home and foreign bond holding: Dt is home bond holdings of home
agents, Dti is bond holdings of country i of home agents. The returns on these bonds are determined
by the nominal interest rate in the home country it , the nominal interest rate iti in country i, and the
evolution of the nominal exchange rate Ei,t between Home and country i.


4.2       Firms
Technology. A typical firm in the home economy produces a differentiated good with a linear
technology given by
                                     Yt ( j) = A H,t Nt ( j),

where A H,t is productivity in the home country. We denote productivity in country i by Ai,t .
    We allow for a constant employment tax 1 + τ L , so that real marginal cost deflated by Home PPI
is given by
                                                 1 + τ L Wt
                                         MCt =               .
                                                  A H,t PH,t
We take this employment tax to be constant in our model. We pin down this tax rate by assuming
that it is set optimally and cooperatively set at a symmetric steady state with flexible prices. The tax
rate is simply set to offset the monopoly distortion so that τ L = − 1ε .


Price-setting assumptions. As in Gali and Monacelli (2005), we maintain the assumption that the
Law of One Price (LOP) holds so that at all times, the price of a given variety in different countries
is identical once expressed in the same currency. This assumption is known as Producer Currency
Pricing (PCP) and is sometimes contrasted with the assumption of Local Currency Pricing (LCP),
where each variety’s price is set separately for each country and quoted (and potentially sticky) in
that country’s local currency. Thus, LOP does not necessarily hold. It has been shown by Devereux
and Engel (2003) that LCP and PCP may have different implications for monetary policy. However,
for our purposes, these two polar cases are equivalent since, for the most part, we will study the
model assuming fixed exchange rates.
    We consider Calvo price setting, where in every period, a randomly selected fraction 1 − δ of




                                                                  25
firms can reset their prices. Those firms that get to reset their price choose a reset price Ptr to solve

                                           ∞       k
                                                                 !
                                                       1
                                   max
                                    r
                                    Pt
                                          ∑ δk    ∏ 1 + it+h          ( Ptr Yt+k|t − PH,t MCt Yt+k|t )
                                          k =0    h =1

                                  −e
                          Ptr
                     
where Yt+k|t =           PH,t+k         Ct+k , taking the sequences for MCt , Yt , and PH,t as given.


4.3    Government
The government is subject to the budget constraint

                                                          Tt = τL Wt Nt + T̂t .                                                      (20)

Here T̂t are net international fiscal transfers. The transfers T̂t are the focus of our analysis. More
precisely, we allow for international fiscal transfers across countries, contingent on the shocks expe-
rienced by these countries.


4.4    Terms of Trade and Real Exchange Rate
It is useful to define the following price indices: home’s Consumer Price Index (CPI) Pt = [(1 −
     1− η       1− η 1                                                R1                  1
α) PH,t + αPF,t ] 1−η , home’s Producer Price Index (PPI) PH,t = [ 0 PH,t ( j)1−e dj] 1−e , and the index for
                             R 1 1− γ    1                 R1                1
imported goods PF,t = [ 0 Pi,t di ] 1−γ , where Pi,t = [ 0 Pi,t ( j)1−e dj] 1−e is country i’s PPI.
     Let Ei,t be the nominal exchange rate between home and i (an increase in Ei,t is a depreciation
of the home currency). Because the Law of One Price holds, we can write Pi,t ( j) = Ei,t Pi,t        i ( j ) where
  i ( j ) is country i’s price of variety j expressed in its own currency. Similarly, P = E Pi where
Pi,t                                                                                        i,t     i,t i,t
           R1 i           1
  i                 1 −
Pi,t = [ 0 Pi,t ( j) ] 1−e is country i’s domestic PPI in terms of country i’s own currency. We therefore
                        e
                                    R 1 i1−γ     1
have PF,t = Et Pt∗ , where Pt∗ = [ 0 Pi,t di ] 1−γ is the world price index and Et is the effective nominal
exchange rate.26
     The effective terms of trade are defined by

                                                                          1
                                                                                           1−1 γ
                                                      PF,t
                                                                 Z
                                                                               1− γ
                                                 St =      =                  Si,t di               ,
                                                      PH,t            0

where Si,t = Pi,t /PH,t is the terms of trade of home versus i. The terms of trade can be used to rewrite
                                                   1− η    1
the home CPI as Pt = PH,t [1 − α + αSt ] 1−η .
   Finally we can define the real exchange rate between home and i as Qi,t = Ei,t Pti /Pt where Pti is
country’i’s CPI. We define the effective real exchange rate to be

                                                                      Et Pt∗
                                                               Qt =          .
                                                                       Pt
                                                                      R1                            1     R1                 1
  26 The                                                                       1−γ i1−γ                          i1−γ
           effective nominal exchange rate is defined as Et = [        0      Ei,t Pi,t     di ] 1−γ /[   0    Pi,t     di ] 1−γ .


                                                                   26
4.5   Equilibrium Conditions
We now summarize the equilibrium conditions. Equilibrium in the home country can be described
by the following equations. We find it convenient to group these equations into two blocks, which
we refer to as the demand block and the supply block.
   The demand block is independent of the nature of price setting. It is composed of the Backus-
Smith condition
                                                        1
                                          Ct = Θi Cti Qi,t
                                                       σ
                                                           ,

where Θi is a relative Pareto weight which depends on the realization of the shocks, the goods market
clearing condition
                                           −η                         Z 1
                                    PH,t
                                                                                                            
                         Yt =                      (1 − α)Ct + α                Cti (Sti Si,t )γ−η Qi,t di       ,
                                                                                                    η
                                     Pt                                     0


were Sti is denotes the effective terms of trade of country i, the labor market clearing condition

                                                                  Yt
                                                      Nt =             ∆t
                                                                 A H,t

                                                         R 1  PH,t ( j) −e
where ∆t is an index of price dispersion ∆t =               0        PH,t          , the Euler equation


                                                              −1 Ct+1
                                                                  σ
                                                 1 + it =   β         Π t +1
                                                                  Ctσ

             Pt+1
where Πt =    Pt    is CPI inflation, the arbitrage condition between home and foreign bonds

                                                                            Ei,t+1
                                                 1 + it = (1 + iti )               ,
                                                                             Ei,t

for all i ∈ [0, 1], and the country budget constraint

                         ∞      t −1                      ∞          t −1
                                             !                                      !
                                    1                                     1
                         ∑     ∏ 1 + is          T̂t = − ∑           ∏ 1 + is           ( PH,t Yt − Pt Ct ) .        (21)
                        t =0   s =0                      t =0        s =0

   Equation (21) is central to our analysis and it is useful to unpack it. We define NFA0 as the net
present value of transfers received by Home expressed in terms of the initial home CPI

                                                            ∞        t −1
                                                                                     !
                                                  1                       1
                                           NFA0 =
                                                  P0      ∑          ∏ 1 + is            T̂t .
                                                          t =0       s =0

Equation (21) can be restated as equating the net present value of transfers to the net present value




                                                                27
of trade deficits
                                            ∞     t −1
                                                             !
                                     1                 1
                            NFA0 = −
                                     P0    ∑      ∏ 1 + is       ( PH,t Yt − Pt Ct ) .
                                           t =0   s =0

This makes clear that the net present value of transfers NFA0 acts like a de facto like initial net foreign
asset position which depends on the shock. With ex-ante identical countries, absent international
fiscal transfers, we would have NFA0 = 0. Characterizing the optimal value of NFA0 depending on
the shocks is one the main focuses of our analysis below. We will also compare the optimal value
of NFA0 to the value that would obtain if private agents could engage in risk sharing through a
complete set of financial markets. One of our main results will establish that these values differ, and
to characterize how they differ.
    Finally with Calvo price setting, the supply block is composed of the equations summarizing the
first-order condition for optimal price setting. These conditions are provided in Appendix C.1. We
will only analyze a log-linearized version of the model with Calvo price setting (see Section 5).
    For most of the paper, we will be concerned with fixed exchange rate regimes (either pegs or
currency unions) in which case we have the additional restriction that Et = E0 for all t ≥ 0 where E0
is predetermined.


5    Optimal Transfers in the Dynamic Model
As is standard in the literature, we work with a log-linearized approximation of the model around
a symmetric steady state where productivity (and hence output) in all countries is equal to one. As
before, at t = 0, the economy is hit with an unanticipated shock. It is convenient to work with a con-
tinuous time version of the model. This does not affect our results, but it is useful because it implies
that no price index can jump at t = 0 and this simplifies the derivation of initial conditions char-
acterizing the equilibrium. We denote the instantaneous discount rate by ρ, and the instantaneous
arrival rate for price changes by ρδ .
     From now on we focus on the Cole-Obstfeld case σ = η = γ = 1. This case is attractive for
the following reason. Even when prices are sticky, the allocation with incomplete markets and no
transfers coincides with the equilibrium with complete markets and no interventions in financial
markets. Risk sharing is delivered with balanced trade. This means that we can interpret any devi-
ation from balanced trade at the optimum with transfers as an indication that private risk sharing
through complete financial markets, if they were available, would be constrained inefficient. Third,
it is possible to derive a simple second-order approximation of the welfare function around the sym-
metric deterministic steady state. Away from the Cole-Obstfeld case, this derivation is much more
involved.
     We start by considering the case where all countries are members of the same currency union. We
then consider the case where some countries are in a currency union, while others remain outside,
with a flexible exchange rate and independent monetary policy.



                                                     28
5.1    The Log-Linearized Economy
We denote with lowercase variables the log deviations from the symmetric steady state of the corre-
sponding uppercase variable introduced in Section 4. We denote with a star the union average of a
                                  R1                R1                   R1
given variable. For example ỹ∗t = 0 ỹit di, c̃∗t = 0 c̃it di, and a∗t = 0 ai,t di.


Shocks. The shocks hitting the model are ai,t . They have both an aggregate component a∗t and an
idiosyncratic component ai,t − a∗t . We can think of the aggregate component as reflecting symmetric
shocks and of the idiosyncratic component as capturing asymmetric shocks.


The natural allocation. We define the natural allocation as the flexible price allocation when there
are no transfers across countries. We describe this allocation in log deviations from the symmetric
steady state with a lower case, and tilde.
     At the natural allocation, output in country i is given by ỹit = ai,t , consumption is given by
c̃it = αa∗t + (1 − α) ai,t , labor is given by ñit = 0, and the terms of trade are given by s̃t i = ai,t − a∗t ,
                              R1         R1         R1
where by construction 0 s̃it di = 0 ỹit di = 0 ãi,t di = 0.27 In addition, trade is balanced. Finally,
aggregate output is equal to aggregate consumption and is given by ỹ∗t = c̃∗t = a∗t .


Summarizing the system in gaps. We denote by ŷit and θ̂ i the deviations of yit and θ i from their
natural counterparts. We further define the gaps of these variables to their respective union average
as ȳˆit = ŷit − ŷ∗t , θ̄ˆi = θ̂ i − θ̂ ∗ , and π̄ˆ iH,t = π iH,t − πt∗ . We have ȳˆit di = θ̄ˆi di = π̄ˆ iH,t di = 0. Note
                                                                                   R          R         R

that θ̂ i is already a normalized variable so that θ̂ ∗ = 0 and θ̂ i = θ̄ˆi .
     The deviation of the trade balance from its natural counterpart of zero is constant and equal to
−αθ̄ˆi . The net present value of transfers must pay for the net present value of the trade deficits, so
that NFA  ˆ¯ i = α θ̄ˆi .
              0     ρ
     The disaggregated variables solve two ordinary differential equations, namely the Phillips curve

                                                π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − λαθ̄ˆi

and the Euler equation
                                                        ȳˆ˙ it = −π̄ˆ iH,t − s̃˙ it ,

with the initial condition
                                                     ȳˆ0i = (1 − α)θ̄ˆi − s̃0i ,

where λ = ρδ (ρ + ρδ ) and κy = λ(1 + φ) index price flexibility. We assume that the zero lower bound
on the nominal interest is not binding. Then the only constraint on the aggregates is that they must
satisfy the aggregate New Keynesian Philips Curve

                                                       π̇t∗ = ρπt∗ − κy ŷ∗t .
  27 Although   we do not need it for our analysis, note that the natural interest rate is given by r̃ti = ȧi,t .


                                                                    29
Thus, there are many possible paths for the aggregate variables, depending on the stance of monetary
policy at the union level.
      From these equations we can infer aggregate consumption ĉ∗t = ŷ∗t . We can also infer the dis-
aggregated variables for country i as follows. The terms of trade gap s̄ˆit can be backed out from
ȳˆit = (1 − α)θ̄ˆi + s̄ˆit , which combines the market clearing condition with the Backus-Smith condition.
Similarly, we can back out the employment gap n̄ˆ it and the consumption gap c̄ˆit from technology
ȳˆit = n̄ˆ it and market clearing ȳˆit = c̄ˆit + αs̄ˆit − αθ̄ˆi .


Loss function. We are interested in characterizing the symmetric constrained Pareto efficient al-
location that provides optimal ex-ante risk sharing behind the veil of ignorance before shocks are
realized. To do so, we maximize an unweighted utilitarian welfare function. A simple representa-
tion of the loss function associated with this welfare criterion is as follows (see Farhi and Werning,
2012):
                   (1 + φ) ∞ 1 −ρt h
                                        απ (π̄ˆ iH,t + πt∗ )2 + (ȳˆit + ŷ∗t )2 + αθ (θ̄ˆi )2 di dt,
                           Z Z                                                                i
                                   e
                       2    0    0
                                     α (2− α )
where απ = λ(1e+φ) and αθ = 1+φ .
    The first two terms in the loss function are familiar in New Keynesian models and are identical to
those obtained by Gali and Monacelli (2005, 2008). The third term captures the direct welfare effects
of transfers and penalizes deviations from privately optimal risk sharing. This term disappears in
the closed-economy limit as α → 0.28


5.2       Optimal Transfers in a Currency Union
Before we begin the analysis of optimal transfers, it is useful to make the following observation.29
Throughout Sections 4-6, we assume that markets are incomplete. Suppose for a moment that mar-
kets are complete. Then the best equilibrium with complete markets and no intervention in financial
markets has θ̃ i = 0. It coincides with the best equilibrium with incomplete markets and no trans-
fers.30 This equivalence is due to our Cole-Obstfeld specification. As a result, we can interpret any
nonzero transfer at the optimum with incomplete markets as an indication that private risk sharing
through complete financial markets, if those were available, would be constrained inefficient. See
Appendix C.3 for details.
    We set up the planning problem for optimal transfers under incomplete markets. We use the fact
     R1          R1
that 0 ȳˆit di = 0 π̄ˆ iH,t di = 0. We are led to the following second-best planning problem
                          Z ∞Z 1
                      1
                                     e−ρt απ (π̄ˆ iH,t )2 + (ȳˆit )2 + αθ (θ̄ˆi )2 + απ (πt∗ )2 + (ŷ∗t )2 di dt
                                         h                                                                 i
                  min                                                                                                  (22)
                      2     0    0
  28 Note  that from the perspective of an individual country i, transfers also have a first-order effect on welfare. The
loss function of an individual country inherits a term − 12 0 e−ρt 1+φ θ̄ˆi dt. This term represents the pure distributional
                                                           R∞     2α(2−α)
                                                                                                       R 1 ˆi
aspect of transfers. These distributional concerns are zero-sum and wash out in the aggregate since        θ̄ di = 0.
                                                                                                               0
  29 In Appendix C.4, we solve for the positive effects of transfers in a currency union.
  30 In both cases, optimal monetary policy ensures that the aggregate output gap and inflation are zero ŷˆ ∗ = π ∗ = 0.
                                                                                                             t    t


                                                               30
subject to

                                          π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − λαθ̄ˆi ,                                   (23)
                                                ȳˆ˙ it = −π̄ˆ iH,t − s̃˙ it ,                                          (24)

                                                ȳˆ0i = (1 − α)θ̄ˆi − s̃0i ,                                            (25)
                                                      Z 1
                                                            θ̄ˆi di = 0,                                                (26)
                                                        0

                                                 π̇t∗ = ρπt∗ − κy ŷ∗t ,                                                (27)

where the minimization is over the variables π̄ˆ iH,t , πt∗ , ȳˆit , ŷ∗t , θ̄ˆi .
   In Appendix C.2, we show how to decompose this planning problem into an aggregate planning
problem that determines πt∗ and ŷ∗t , and a disaggregated planning problem that determines π̄ˆ iH,t , ȳˆit ,
and θ̄ˆi for all i. Furthermore, we show that the disaggregated planning problem can be relaxed and
broken down into separate component planning problems indexed by i. The aggregate planning
problem does not depend on the shocks. The disaggregated planning problem depends only on the
asymmetric component of shocks captured by the natural terms of trade s̃it = ai,t − a∗t . The symmetric
component of shocks a∗t does not explicitly show up in the planning problem expressed in gaps.
   Monetary policy can be chosen at the union level so that monetary conditions are tailored to the
average country, a result which echoes Proposition 5 from the static model and is reminiscent of the
results in Benigno (2004) and Gali and Monacelli (2008).
Proposition 13 (Optimal Monetary Policy). At the second-best optimum, union-wide aggregates are zero
ŷ∗t = πt∗ = 0.
    This means that monetary policy at the union level can perfectly stabilize the symmetric compo-
nent of shocks. Monetary policy is powerless, however, in dealing with the asymmetric component
of shocks.
    We now characterize disaggregated variables at the second-best optimum and study how trans-
fers are optimally used to stabilize the asymmetric component of shocks s̃it . We provide closed-form
solutions for two enlightening special cases: rigid prices and the closed-economy limit. We then
explore the general case using extensive numerical simulations in Section 6.

The case of rigid prices.    We first treat the case of rigid prices κy = 0.
Proposition 14 (Rigid Prices). Suppose that prices are rigid, then at the second-best optimum we have
                                          Z ∞                                                     Z ∞
                           α (1 − α )                                      i       ρ (1 − α )
               ˆ¯ i =
              NFA 0                             e−ρt s̃it dt    and     θ̄ˆ =                           e−ρt s̃it dt.
                        (1 − α )2 + α θ    0                                    (1 − α )2 + α θ   0


   Importantly, we find that the net present value of transfers NFA ˆ¯ i and θ̄ˆi and are nonzero, so
                                                                       0
that the optimal solution does not coincide with the solution that would have arisen with complete
markets and no interventions in financial markets.

                                                               31
    Countries experiencing shocks that depreciate their natural terms of trade s̃it receive positive
transfers. With positive home bias (α < 1), these transfers increase the demand for home goods
and help alleviate the temporary recession resulting from the inability of the terms of trade to imme-
diately depreciate to their natural level in the short run.
    Optimal transfers are increasing in the size of the shocks. They are also increasing in the per-
sistence of the shocks. This is intuitive since consumers permanently increase their consumption in
response to the transfers. As a result, the more transitory the shock, the less the increase in spending
is concentrated when the economy is depressed in the short run. In other words, transfers affect the
economy permanently and are therefore better suited to deal with persistent shocks.
    Optimal transfers depend crucially on the openness of the economy as captured by the degree of
home bias α. They are non-monotonic in the degree of openness. Indeed, the net present value of
transfers is zero for α = 0 (closed economy) and for α = 1 (fully open economy).
    The reasons for zero transfers with α = 0 and with α = 1 are very different. For α close to 0,
transfers have large expenditure switching effects across goods from different countries and there-
fore large effects on output. For α close to 1, transfers have small expenditure switching effects and
therefore small effects on output. So for α close to 0, we get small transfers because transfers are
very effective, and indeed we get θ̄ˆi 6= 0 so that the allocation remains significantly different from
the one arising with no transfers. By contrast for α close to 1, we get small transfers because transfers
are very ineffective, and we get θ̄ˆi = 0 so that the allocation approaches the one prevailing with no
transfers.

The case of the closed-economy limit. We now return to the case where prices are not entirely
rigid, κy > 0, but we place ourselves in the closed-economy limit α → 0.

Proposition 15 (Closed-Economy Limit). In the closed-economy limit and when s̃it = s̃0i e−ψt , at the second-
best optimum we have

                                                              ρ − 2ν       (απ νκy − ρ − ψ)ψ
                                                                                                 
                             θ̄ˆi = s̃0i
          ˆ¯ i = 0                                   κy
         NFA 0         and                                  +                                       .
                                               κy − (ρ + ψ)ψ απ ν2 + 1 (ρ + ψ − ν)[κy − (ρ + ψ)ψ]

    This proposition shows that the intuition given above in the case of rigid prices for the increased
effectiveness of transfers as the economy becomes more closed generalizes to the case where prices
are not entirely rigid. As we approach the closed-economy limit, optimal transfers become van-
ishingly small ( NFAˆ¯ i = 0 in the limit) but the allocation remains significantly different from the
                       0
allocation with no transfers (θ̄ˆi 6= 0 in the limit).

Proposition 16 (Closed-Economy Limit, Permanent Shocks). In the closed-economy limit, in response to
a permanent shock s̃it = s̃0i , the second-best optimum achieves the first best ȳˆit = π̄ˆ iH,t = 0 with

                                                 ˆ¯ i = 0 and
                                                NFA 0             θ̄ˆi = s̃0i .

   Transfers are particularly useful in the case where shocks are permanent so that ψ = 0. In this

                                                           32
case we have θ̄ˆi = s̃0i and we get perfect stabilization of output and inflation. This striking result
illustrates that for rather closed economies in a currency union, even modest transfers can achieve
large stabilization benefits. It offers an interesting contrast to the arguments presented by McKin-
non (1963) that common currencies are more costly for economies that are more closed, but did not
consider transfers. Our result shows that this matters since transfers are more potent in more closed
economies.


5.3    The Role of Fixed Exchange Rates
We now clarify the role of fixed exchange rates for our results. We assume that only a subset of
countries I ⊆ [0, 1] are in the currency union. Countries outside the currency union have flexible
exchange rates and PCP.31
   We can write down the corresponding planning problem as follows
                          Z ∞Z 1
                      1
                                    e−ρt απ (π̄ˆ iH,t )2 + (ȳˆit )2 + αθ (θ̄ˆi )2 + απ (πt∗ )2 + (ŷ∗t )2 di dt
                                        h                                                                 i
                  min
                      2    0    0

subject to
                                                     π̇t∗ = ρπt∗ − κy ŷ∗t ,
                                                          Z 1
                                                                θ̄ˆi di = 0,
                                                           0
for i ∈ I,

                                              π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − λαθ̄ˆi ,
                                                    ȳˆ˙ it = −π̄ˆ iH,t − s̃˙ it ,

                                                    ȳˆ0i = (1 − α)θ̄ˆi − s̃0i ,

and for i ∈
          / I,
                                              π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − λαθ̄ˆi .

         For countries outside the currency union the only constraint is the Phillips curve. The Euler
equation and the initial condition do not appear as constraints because with a flexible exchange rate
ēˆit , they become
                                             ȳˆ˙ it = ēˆ˙it − π̄ˆ iH,t − s̃˙ it ,

                                                ȳˆ0i = ēˆ0i + (1 − α)θ̄ˆi − s̃0i .

Thus, these equations simply define the required value for the path of the exchange rate ēˆit . As a
  31 For  countries in a currency union the distinction between LCP and PCP is irrelevant. Here for countries outside a
currency union, we have assumed PCP. Under LCP, fluctuations in the exchange rate would not be enough to deliver
the first best, and there would remain a role for transfers for countries outside of the currency union, but our analysis of
optimal transfers in a currency union would be unchanged.



                                                                 33
result, the solution entails π̄ˆ iH,t = ȳˆit = θ̄ˆi = 0 for i ∈
                                                               / I. These countries do not send or receive
transfers. They reach the same allocation as under complete markets and without interventions in
financial markets.

Proposition 17 (Countries Outside the Currency Union). For countries outside the currency union,
second-best optimal transfers are zero and θ̄ˆi = 0. They achieve perfect stabilization π̄ˆ iH,t = ȳˆit = 0.

   This proposition echoes Proposition 10 and shows that in our model, the role of transfers hinges
on the fixed exchange rates prevailing in a currency union.


6     Numerical Illustration
In Section 5 we set up a framework to analyze optimal transfers in a currency union and provided
complete analytical characterizations for two extreme but enlightening special cases: rigid prices
and the closed-economy limit. In this section, we undertake a systematic numerical exploration
away from these special cases. We also compare the relative effectiveness of transfers and of other
macroeconomic stabilization instruments available in currency unions such as domestic fiscal policy
and capital controls. We focus throughout on asymmetric shocks, since symmetric shocks can be
perfectly stabilized by union-wide monetary policy.


6.1   Extending and Calibrating the Model
We start by extending the dynamic model of Sections 4-5. First, we incorporate hand-to-mouth
agents. Second, we allow for other instruments such as domestic fiscal policy as well as capital
controls. Given space constraints, we only give high-level descriptions of our extensions here. All
the details and derivations can be found in a comprehensive and entirely self-contained appendix
(Appendix D).

Hand-to-mouth consumers. In the dynamic model of Sections 4-5, agents have access to perfect fi-
nancial markets and behave like permanent-income consumers. There is ample evidence that this is
counterfactual, and that a substantial fraction of consumers act as if they are borrowing constrained
or don’t have access to financial markets. As we shall see below, accounting for this feature is im-
portant to understand the role of transfers.
    We therefore enrich the model by introducing a fraction χ of hand-to-mouth consumers with no
access to financial markets who simply consume their income in every period with a high marginal
propensity to consume out of transitory income of one. The remaining fraction 1 − χ of consumers
has perfect access to financial markets and acts in accordance with the permanent-income hypothesis
with a low marginal propensity to consume out of transitory income. The baseline model of Sections
4-5 corresponds to the particular case χ = 0.
    This modeling device strikes an attractive balance between on the one hand capturing consumer
heterogeneity and borrowing constraints and on the other hand maintaining enough tractability to

                                                     34
perform an extensive quantitative normative analysis. A substantial technical difficulty is the deriva-
tion of the loss function, which unlike in the baseline model with only permanent-income consumers,
requires a second-order approximation of several equilibrium constraints to substitute out the linear
terms in the second-order approximation of welfare. This is required to obtain an expression with
only second-order terms which can then be maximized subject to a first-order approximation of the
equilibrium conditions.
    Permanent-income consumers are exactly like in the baseline model. Hand-to-mouth consumers
consume their income in every period. This income is composed of their labor income and their share
of the profits of domestic firms net of a lump-sum tax (which is negative in the case of a rebate). We
assume that profits are distributed uniformly in the population. In every period, international trans-
fers are assumed to flow through the government which receives them and rebates them uniformly
across the population.
    The optimal policy problem for a given shock then consists in finding the temporal sequence of
transfers that minimizes the loss function subject to the log-linearized equilibrium constraints of the
economy. The presence of hand-to-mouth consumers requires solving not only for the overall level
of transfers, as captured by their net present value as in the case where there are only permanent-
income consumers, but also for their timing and hence for the entire path of transfers.


Alternative macroeconomic instruments. In the dynamic model of Sections 4-5, international trans-
fers are the only policy instrument. We extend the model to allow for other policy instruments:
capital controls and domestic fiscal policy. In Farhi and Werning (2012), we used the same model
presented in Sections 4-5 without hand-to-mouth consumers to study time-varying capital controls
as well as time-varying domestic government spending on domestic goods.32,33,34 The appendix ex-
tends this analysis to allow for hand-to-mouth consumers. While Ricardian equivalence holds in
the domestic economy in the model without hand-to-mouth consumers, it does not in the extended
model with hand-to-mouth consumers. In the latter case, other dimensions of domestic fiscal policy
pertaining to the timing and distribution of domestic taxes become relevant. We consider time-
varying government spending financed by uniform taxes on all consumers, time-varying deficits
  32 For  government spending, our analysis replicates Gali and Monacelli (2008). See Section 4.6 of the NBER working
paper version of Farhi and Werning (2012).
  33 It is important to clarify the difference between international transfers and our interpretation of capital controls.

Whereas international transfers affect the allocation of consumption across states of the world, capital controls affect
the allocation of consumption over time in each state. In our rendition, capital controls are therefore different from the
state-contingent portfolio taxes that we analyzed in the complete markets implementation of the static model in Sections
2-3 where this dynamic temporal dimension is entirely absent. The optimal use of capital controls can be derived by
studying a planning problem related to (22). The differences are as follows. First, in the objective function (22) and in the
New Keynesian Philips curve (23), the constant variable θ̄ˆi is now replaced by the time-dependent variable θ̄ˆti . Second,
the initial condition (25) now features θ̄ˆ0i instead of θ̄ˆi . Third, there is an additional set of constraints e−ρt θ̄ˆti dt = 0 if
                                                                                                                R
international transfers are not available but only capital controls are available.
  34 We refer the reader to Appendix B.4 for a treatment of government spending in the context of the static model of

Sections 2-3. We characterize the jointly optimal use of international transfers and government spending. Our analysis
underscores that both instruments should be used in conjunction. Moreover, we show that our characterization of fiscal
unions is robust to the availability of government spending as an additional instrument. We also compare their relative
performance depending on a number of deep economic parameters.


                                                                35
in the form of debt-financed tax cuts combined with future tax increases falling uniformly on con-
sumers, time-varying redistribution between consumers, and various combinations of these different
options.


Calibration. To allow for maximal comparability between our different instruments, we perform
all our numerical simulations within the same extended model with a steady-state share of domestic
government spending of 0.2 as in Gali et al. (2007).35 We set standard values for φ = 3 corresponding
to a Frisch elasticity of labor supply of 0.33, for the elasticity of substitution between varieties e =
11, and for the discount rate ρ = 0.06. In our benchmark calibration we set ρδ = 0.79 (“sticky”)
corresponding to an average price duration of 5.6 quarters following Altig et al. (2011); we also
experiment with ρδ = 1.66 (“more flexible”) corresponding to an average price duration of 3 quarters
and with fully rigid prices ρδ = 0 (“rigid”). We set the degree of openness to α = 0.4 (“open”)
corresponding to a relatively open economy as in Gali and Monacelli (2008); we also experiment
with a more closed economy α = 0.1 (“closed”) and with a very closed economy α = 0.01 (“very
closed”). We consider both the version of the model without hand-to-mouth consumers χ = 0
(“no HtM”), and with hand-to-mouth consumers. When we consider hand-to-mouth consumers,
we follow Gali et al. (2007) and set χ = 0.5 (“HtM”) which matches the range of estimated values for
the proportion of rule-of-thumb consumers documented in Mankiw (2000).


6.2    Transfers
In this section, we focus on international transfers. To do so, we assume that all the other instruments
are passive or equivalently that they are at their natural level, by which we mean that they are
given by their optimal values under flexible prices given the shock. We refer to the corresponding
allocation as the natural allocation which is first-best efficient. In our model, the natural level of
capital controls is zero as in steady state. By contrast, the natural levels of government spending and
taxes are different from their steady state values, depend on the shock, and are not constant over
time. However, they do not reflect any macroeconomic stabilization motive and hence represent a
passive form of fiscal policy.36,37 We start with the case without hand-to-mouth consumers and then
                                                                                                          1+ φ
  35 Following                                                                      C 1− σ   G 1− σ   N
                Gali and Monacelli (2008), we take the utility function to be (1 − υ) 1t−σ + υ 1−
                                                                                                t
                                                                                                  σ − 1+φ , and we calibrate
                                                                                                       t

υ to match a steady state government spending share of 0.2.
   36 That optimal capital controls are zero with flexible prices as in the steady state reflects our focus on coordinated

welfare from the perspective of the currency union as opposed to the individual perspective of the country, which
neutralizes terms of trade manipulations motives for capital taxation. With flexible prices, optimal government spending
and taxes are different from their steady state values, but taxes are uniform across agents and the government budge is
balanced in every period.
   37 What constitutes passive fiscal policy is debatable. An alternative to our definition, which we do not pursue, would

be to broaden the notion of passive fiscal policy to encompass the “opportunistic” dimension of fiscal policy, which
captures the notion that in the presence of nominal rigidities, the microeconomic opportunity cost of fiscal resources
might differ from its natural level, and so that on purely microeconomic grounds, there is a case for deviating from the
natural fiscal policy. Only the “stimulus” dimension of fiscal policy, which recognizes that with nominal rigidities, there
might be a case for fiscal policy to deviate from what would be warranted on purely microeconomic grounds, would then
be defined as active. See Werning (2012) for an elaboration of these concepts in the case of government spending. Our


                                                            36
consider the case with hand-to-mouth consumers.


No hand-to-mouth consumers. Figure 2 displays the behavior of the economy with optimal trans-
fers and with no transfers in response to a permanent shock with s̃it = 0.05. The top panel corre-
sponds to α = 0.01, the middle panel to α = 0.1 and the bottom panel to α = 0.4. In this figure, time
is measured in years, output is measured in gaps from the natural allocation, and inflation is an-
nualized. The allocation without transfers features deflation and a recession in the short run which
vanishes in the long run as prices adjust: the output gap increases from −5% to 0 and the inflation
rate from −6% to 0. The allocation with transfers features less deflation and smaller recession in the
short run, but lower output in the long run. For example, with α = 0.1, the output gap at impact is
only −1.2% and the inflation rate −1.4%. The allocation without transfers is independent of open-
ness α. By contrast, the solution with optimal transfers is more stable the more closed the economy
(the lower α). Optimal transfers stabilize the economy more effectively when the economy is more
closed.
       Figure 3 displays a measure of macroeconomic stabilization due to transfers. As a measure of
stabilization, we compute the fraction of the welfare loss without transfers that is eliminated by the
introduction of optimal transfers, where welfare losses are computed with respect to the baseline
of the natural allocation. We feed in exponentially decaying shocks s̃it = e−ψt s̃0i . We then plot our
stabilization measure as a function of openness α and the persistence of the shock as measured by its
half life − log(0.5)/ψ. The measure of stabilization is invariant with respect to the size of the shock
s̃0i .
       Using the same shock, Figure 4 displays NFA  ˆ¯ i , which can be interpreted as the net present value
                                                       0
of transfers as a fraction of GDP, as a function of the same two parameters. These numbers scale in
proportion the size of the shock which we normalize to s̃0i = 0.05.
       Stabilization is increasing in the persistence of the shock and decreasing in openness. Optimal
transfers are increasing in the persistence of the shock starting at zero for fully transitory shocks,
but hump-shaped as a function of openness, starting at zero in the closed-economy limit. Significant
stabilization is achieved with relatively modest transfers when the economy is relatively closed and
shocks are relatively permanent.38


Hand-to-mouth consumers. With only permanent-income consumers, transfers are not a well tar-
geted instrument to deal with transitory shocks. For example in the case of a transitory recessive
shock, permanent-income consumers spend the permanent value of the transfers in every period,
definition of passive fiscal policy, which identifies as active any deviation from the natural fiscal policy, excludes both
the “opportunistic” and the “stimulus” dimensions of fiscal policy. It should be clear that compared to this alternative,
our choices only increase the benefits of active fiscal policy.
   38 When prices are perfectly rigid, we saw earlier in Proposition 14 that transfers were zero both when α = 0 (but

stabilization is not zero) and when α = 1 (and stabilization is zero). When prices are not perfectly rigid, transfers are
still exactly zero when α = 0 but not when α = 1 (and stabilization is not zero). When the economy is completely open
with α = 1, transfers still influence the domestic wage through a wealth effect and hence inflation as long as prices are
not entirely rigid. Therefore, transfers help mitigate the deflation and remain useful for stabilization.



                                                            37
both in the short run, when their extra spending is needed to stimulate output, and in the long
run, when it is not. This changes in the presence of hand-to-mouth consumers with high marginal
propensities to consume out of transitory income. The spending of these consumers can be front-
loaded by front-loading transfers. As a result, transfers become a more effective instrument to deal
with transitory shocks and, in other words, the performance of transfers depends less on the per-
sistence of shocks. A similar intuition applies to the dependence of the performance of transfers
on the degree of price rigidity, since greater price flexibility makes the impact of a given shock on
macroeconomic stability more transitory given that prices adjust faster. What matters is the persis-
tence of the effects of the shock on macroeconomic stability, either because the shocks themselves are
persistent or because price are somewhat sticky. We will make repeated use of this terminology in
the discussion below and refer to a shock with transitory effects as a situation where either the shock
itself is transitory or where prices are somewhat flexible.
    Figure 5 displays the behavior of the economy with optimal transfers and with no transfers in
response to a permanent shock with s̃it = 0.05. The top panel corresponds to α = 0.01, the middle
panel to α = 0.1 and the bottom panel to α = 0.4. The figure also documents the optimal path
of transfers. Because prices are sticky but not perfectly rigid, the effects of the shock on macroeco-
nomic stability are transitory even though the shock is permanent. In the absence of transfers, the
economy experiences a recession with a negative output gap and deflation in the short run but the
economy equilibrates in the long run returning to zero output gap and no inflation. The equilib-
rium allocation without transfers is actually identical to that which obtains with no hand-to-mouth
consumers. This is due to our Cole-Obstfeld specification: In the absence of transfers and with-
out hand-to-mouth consumers, trade remains balanced and permanent-income consumers end up
consuming their income in every period just like hand-to-mouth consumers. This invariance with
respect to the fraction of hand-to-mouth consumers breaks down with transfers. As is intuitive, the
figure shows that optimal transfers are significantly front-loaded. This contrasts with the baseline
case with only permanent-income consumers where the timing of transfers is irrelevant.
    Figure 6 displays the amount of stabilization (defined as above) achieved by transfers as a func-
tion of openness α and the persistence of the shock as measured by its half life − log(0.5)/ψ. Figure 7
displays the net present value of transfers as a fraction of GDP as a function of the same two param-
eters. The main differences from the baseline case with only permanent-income consumers χ = 0
discussed above are that: Stabilization is much less dependent on the persistence of the shock and
the level of transfers is higher. This is because with hand-to-mouth consumers, transfers become a
more effective stabilization tool for shocks with transitory effects on the economy.39
  39 That stabilization increases is intuitive since transfers become more effective. That the net present value of transfers

increases is less obvious because in general, making an instrument more effective could either increase or decrease its
optimal use. That it could increase its use is intuitive since the instrument becomes more attractive—a form of policy
substitution effect. That it could reduce it is due to the fact that a given improvement in the objective can be achieved
with a lesser use of the tool—a form of policy income effect. In the case at hand regarding the effectiveness of transfers
as the fraction of hand-to-mouth consumers in the economy increases, the policy substitution effect dominates the policy
wealth effect, and as a result transfers are used more.




                                                             38
6.3   Transfers vs. Other Macroeconomic Instruments
In this section we compare the effectiveness of international transfers to that of other macroeco-
nomic stabilization instruments: capital controls and domestic fiscal policy. Of course international
transfers, capital controls, and domestic fiscal policy are different instruments. In general no single
instrument can achieve perfect macroeconomic stabilization, and it is best to use all three in conjunc-
tion. This is not what interests us here. Instead, we seek to characterize the relative effectiveness of
these different instruments. We shall see that their relative ranking varies in intuitive ways depend-
ing on the fraction of hand-to-mouth consumers, the openness of the economy, the persistence of
shocks, and the degree of nominal rigidity.




Table 1: Stabilization achieved by different macroeconomic instruments, for permanent shocks (top
panel) and transitory shocks with a half life of one year (bottom panel). The measure of the stabi-
lization of a given instrument is the fraction of the welfare loss which is eliminated by allowing for
the optimal use of this instrument, where welfare losses are computed with respect to the baseline
of the natural allocation. The labels “more flexible”, “sticky”, and “rigid”, correspond to ρδ = 1.66,
ρδ = 0.79, and ρδ = 0. The labels “open” and “closed” correspond to α = 0.4 and α = 0.1. The labels
“No HtM” and “HtM” correspond to χ = 0 and χ = 0.5.

   We compute the amount of stabilization (defined as above) achieved by these different instru-
ments. The results are reported in the top and bottom panels of Table 1. The panels cover not only
our benchmark calibration with ρδ = 0.79 (“sticky”) and α = 0.4 (“open”), but also variants with

                                                  39
ρδ = 1.66 (“more flexible”) and ρδ = 0 (“rigid”) as well as with α = 0.1 (“closed”), for an economy
without hand-to-mouth consumers (“No HtM”) and with hand-to-mouth consumers (“HtM”). We
feed in exponentially decaying shocks s̃it = e−ψt s̃0i with size s̃0i and half life − log(0.5)/ψ. The top
panel focuses on permanent shocks with an infinite half life (“permanent”) and the bottom panel on
transitory shocks with a half life of one year (“transitory”). We do not need to specify the size of
shocks since our stabilization measure is invariant to it.
    For each of these cases, we report the stabilization measure obtained for the optimal use of differ-
ent macroeconomic stabilization instruments. “No policy” corresponds to international transfers at
their natural values of zero, capital controls at their natural values of zero, and government spend-
ing and taxes at their natural values, i.e. the natural allocation. This constitutes the baseline from
which we consider one-at-a-time deviations by allowing for a specific instrument to be optimized
at a level different from its natural value. “Transfers” corresponds to time-varying international
transfers. “Capital controls” corresponds to time-varying capital controls. “Government spending”
corresponds to time-varying deviations of government spending from its natural value financed
by contemporaneous and uniform taxes on all consumers. “Redistribution” corresponds to time-
varying budget-balanced redistribution between permanent-income consumers and hand-to-mouth
consumers. “Deficits” corresponds to time-varying uniform taxes (and government debt) on all con-
sumers. “Joint fiscal policy” corresponds to the combination of all the aforementioned domestic
fiscal policy instruments with time-varying government spending and time-varying taxes that are
differentiated across consumers.
    We start with the case where there are no hand-to-mouth consumers. In this case, Ricardian
equivalence holds in the domestic economy and so the timing and distribution of taxes over time are
irrelevant. The relative performance of these instruments depends on the parameters of the economy,
and in particular on two key parameters: the degree of openness, and the persistence of the effects
of the shocks, where as explained above the latter reflects both the persistence of the shock itself and
the rigidity of prices. In general, international transfers and capital controls are more potent when
the economies are relatively closed.40 By contrast, the effectiveness of government spending is inde-
pendent of the degree of openness—an exact result which relies on our Cole-Obstfeld specification.41
International transfers are better suited to deal with shocks with persistent effects whereas capital
controls are better suited to deal with transitory shocks. This is because international transfers per-
manently shift the level of spending whereas capital controls influence the timing of spending. The
effectiveness of government spending is less dependent on the persistence of the effects of shocks.42
  40 For   capital controls, we have made this point in formal propositions and simulations in this paper and in Farhi and
Werning (2012).
   41 We showed in Farhi and Werning (2012) and we confirm here that under our Cole-Obstfeld specification, optimal

government spending, the output gap, and inflation are independent of openness.
   42 The intuition is also supported by the following formal results. In the closed-economy limit, when shocks s̃ i =
                                                                                                                        t
ai,t − a∗t are permanent, international transfers achieve the first best, while capital controls and government spending
do not. In this case, there is no residual macroeconomic stabilization role for capital controls or government spending
once international transfers are available. Conversely, in the limit where productivity shocks s̃t i = ai,t − a∗t are purely
transitory, optimal international transfers are zero and do not perform any macroeconomic stabilization role, while
optimal capital controls and government spending do help stabilize the economy.


                                                            40
    We now turn to the case with hand-to-mouth consumers. As explained above, the presence
of hand-to-mouth consumers improves the performance of international transfers in dealing with
shocks with transitory effects. By contrast, the presence of hand-to-mouth consumers leaves the
performance of capital controls and government spending almost unchanged. In fact, in the case of
government spending, under our Cole-Obstfeld specification, hand-to-mouth consumers are irrel-
evant in the sense that their presence does not change the equilibrium allocations, simply because
trade remains balanced for any path of government spending, and so permanent-income consumers
end up simply consuming their income in every period just like hand-to-mouth consumers. This
exact irrelevance does not hold in the case of capital controls, but it remains a good approximation
under our various calibrations.
    The presence of hand-to-mouth consumers also opens up other dimensions of domestic fiscal pol-
icy. For example when facing a recessive shock with transitory effects on the economy, it is optimal
to redistribute towards hand-to-mouth consumers in the short run and towards permanent-income
consumers in the long run. This is because hand-to-mouth consumers spend the extra revenue when
they get it whereas permanent-income consumers spread their loss in revenue by reducing spending
uniformly over time. Redistribution towards hand-to-mouth consumers therefore increases spend-
ing in the short run when it is needed. Similarly, redistribution towards permanent-income con-
sumers in the long run mitigates the decrease in their spending due to redistribution away from
them in the short run. Furthermore, a given amount of transitory redistribution towards hand-to-
mouth consumers has a more stimulative effect in the short run and a more depressive effect in the
long run when the economy is more closed because the corresponding changes in spending fall more
on domestic goods. These intuitions explain why the performance of redistribution is higher when
the economy is more closed or when the shocks have more transitory effects.
    Perhaps surprisingly, optimal deficits achieve exactly the same outcomes as optimal redistribu-
tion. This is because under our calibrations, optimal redistribution has the property that the redis-
tribution towards hand-to-mouth consumers in the short run and towards permanent-income con-
sumers in the long run exactly cancel out in a net present value sense, a consequence, we conjecture,
of our Cole-Obstfeld specification. As a result, an alternative implementation of the corresponding
allocation can be found in the form uniform (across consumers) tax cuts in the short run, financed
by debt which is purchased by permanent-income consumers and repaid in the long run by uniform
(across consumers) tax increases.


7   Conclusion
In this paper, we have characterized fiscal unions as optimal risk sharing arrangements. We have
shown that they play a special role within currency unions. We have given a precise description
of the effectiveness of such a fiscal union and of the size of the underlying transfers as a function
of a small numbers of key characteristics of the currency union, such as the rigidity of prices, the
openness of member countries, the asymmetry of shocks, and their persistence. Finally we have


                                                 41
compared the performance of fiscal unions to that of other macroeconomic stabilization instruments
available in currency unions such as capital controls, government spending, fiscal deficits, and re-
distribution.


References
Adao, Bernardino, Isabel Correia, and Pedro Teles, “On the relevance of exchange rate regimes for
 stabilization policy,” Journal of Economic Theory, July 2009, 144 (4), 1468–1488.

Altig, David, Lawrence Christiano, Martin Eichenbaum, and Jesper Linde, “Firm-Specific Capital,
  Nominal Rigidities and the Business Cycle,” Review of Economic Dynamics, April 2011, 14 (2), 225–
  247.

Atkeson, Andrew and Tamim Bayoumi, “Private Capital Markets in a Currency Union,” in P.R.
  Masson and M.P. Taylor, eds., Policy Issues in the Operation of Currency Unions, Cambridge Univer-
  sity Press, 1993.

Auray, Stephane and Aurelien Eyquem, “On Financial Market Incompleteness, Price Stickiness,
 and Welfare in a Monetary Union,” Annals of Economics and Statistics, 2013, (109-110), 205–233.

Beetsma, Roel M.W.J. and Henrik Jensen, “Monetary and fiscal policy interactions in a micro-
  founded model of a monetary union,” Journal of International Economics, December 2005, 67 (2),
  320–352.

Benigno, Pierpaolo, “Optimal Monetary Policy for Open Economies,” Princeton University Ph.D
  dissertation 2000.

  , “Optimal monetary policy in a currency area,” Journal of International Economics, July 2004, 63 (2),
  293–320.

  , “Price Stability with Imperfect Financial Integration,” Journal of Money, Credit and Banking, 02
  2009, 41 (s1), 121–149.

  and Michael Woodford, “Linear-quadratic approximation of optimal policy problems,” Journal of
  Economic Theory, 2012, 147 (1), 1–42.

Clarida, Richard, Jordi Gali, and Mark Gertler, “A Simple Framework for International Monetary
  Policy Analysis,” Journal of Monetary Economics, July 2002, 49 (5), 879–904.

Cole, Harold L. and Maurice Obstfeld, “Commodity Trade and International Risk Sharing: How
 Much Do Financial Markets Matter?,” Journal of Monetary Economics, 1991, 28 (1), 3–24.

Devereux, Michael B. and Charles Engel, “Monetary Policy in the Open Economy Revisited: Price
 Setting and Exchange-Rate Flexibility,” Review of Economic Studies, October 2003, 70 (4), 765–783.

                                                  42
Farhi, Emmanuel and Ivan Werning, “Dealing with the Trilemma: Optimal Capital Controls with
  Fixed Exchange Rates,” NBER Working Papers 18199, National Bureau of Economic Research, Inc
  June 2012.

   and , “A Theory of Macroprudential Policies in the Presence of Nominal Rigidities,” Economet-
  rica, 09 2016, 84, 1645–1704.

  and , “Fiscal Multipliers: Liquidity Traps and Currency Unions,” forthcoming in the Handbook of
  Macroeconomics, 2017.

  , Gita Gopinath, and Oleg Itskhoki, “Fiscal Devaluations,” Review of Economic Studies, 2014, 81
  (2), 725–760.

Ferrero, Andrea, “Fiscal and monetary rules for a currency union,” Journal of International Economics,
  February 2009, 77 (1), 1–10.

Friedman, Milton, “The Case for Flexible Exchange Rates,” in “Essays in Positive Economics,” Uni-
  versity of Chicago Press, 1953, pp. 157–203.

Gali, Jordi and Tommaso Monacelli, “Monetary Policy and Exchange Rate Volatility in a Small
 Open Economy,” Review of Economic Studies, 07 2005, 72 (3), 707–734.

   and , “Optimal monetary and fiscal policy in a currency union,” Journal of International Eco-
  nomics, September 2008, 76 (1), 116–132.

  , J. David Lopez-Salido, and Javier Valles, “Understanding the Effects of Government Spending
  on Consumption,” Journal of the European Economic Association, 03 2007, 5 (1), 227–270.

Kehoe, Patrick and Elena Pastorino, “Financial Markets and Fiscal Unions,” NBER Working Papers
 23235, National Bureau of Economic Research, Inc January 2017.

Kenen, Peter, “The Theory of Optimum Currency Areas: An Eclectic View,” in R.A. Mundell and
 A.K. Swoboda, eds., Monetary Problems of the International Economy, Chicago University Press, 1969.

Keynes, J.M., “The German transfer problem,” The Economic Journal, 1929, 39 (153), 1–7.

Korinek, Anton and Alp Simsek, “Liquidity Trap and Excessive Leverage,” American Economic Re-
 view, March 2016, 106 (3), 699–738.

Lucas, Robert E., Jr. and Nancy L. Stokey, “Optimal Fiscal and Monetary Policy in an Economy
  without Capital,” Journal of Monetary Economics, 1983, 12, 55–93.

Mankiw, Gregory N., “The Savers-Spenders Theory of Fiscal Policy,” American Economic Review,
 May 2000, 90 (2), 120–125.

McKinnon, Ronald, “Optimum Currency Areas,” American Economic Review, 1963, 53, 717–724.


                                                 43
Mundell, Robert, “A Theory of Optimum Currency Areas,” American Economic Review, September
 1961, 51 (4), 657–665.

  , “The Economics of Common Currencies,” in H.G. Johnson and A.K. Swoboda, eds., Uncommon
  Arguments for Common Currencies, Allen and Unwin, 1973.

Obstfeld, Maurice and Kenneth Rogoff, “New directions for stochastic open economy models,”
 Journal of International Economics, February 2000, 50 (1), 117–153.

Ohlin, B., “The reparation problem: a discussion,” Economic Journal, 1929, 39 (154), 172–182.

Samuelson, Paul, “The Pure Theory of Public Expenditure,” The Review of Economics and Statistics,
  1954, 36, 387–389.

Schmitt-Grohe, Stephanie and Martin Uribe, “Prudential Policies for Peggers,” NBER Working
  Papers 18031, National Bureau of Economic Research, Inc June 2012.

   and , “Downward Nominal Wage Rigidity, Currency Pegs, and Involuntary Unemployment,”
  Journal of Political Economy, October 2016, 124, 1466–1514.

Werning, Ivan, “Managing a Liquidity Trap: Monetary and Fiscal Policy,” 2012. NBER Working
 Papers.




                                                 44
                             Output gap                                PPI inflation
                0                                         0



             -0.02

                                                       -0.05

             -0.04



             -0.06                                      -0.1
                     0   1    2     3     4   5                0   1     2      3      4   5

                             Output gap                                PPI inflation
                0                                         0



             -0.02

                                                       -0.05

             -0.04



             -0.06                                      -0.1
                     0   1    2     3     4   5                0   1     2      3      4   5

                             Output gap                                PPI Inflation
                0                                         0



             -0.02

                                                       -0.05

             -0.04



             -0.06                                      -0.1
                     0   1    2     3     4   5                0   1     2      3      4   5

Figure 2: Allocations with optimal transfers (blue) and no transfers (green). The top panel corre-
sponds to α = 0.01, the middle panel to α = 0.1 and the bottom panel to α = 0.4. Inflation is
annualized and time is measured in years. Calibration with no hand-to-mouth consumers χ = 0.


                                                  1



                                                  45
                            1

                           0.8

                           0.6

                           0.4

                           0.2

                            0
                            1
                                 0.8                                              10
                                       0.6                                    8
                                             0.4                          6
                                                                      4
                                                   0.2            2
                                                         0   0

Figure 3: Stabilization effect of transfers as a function of openness measured by α ∈ (0, 1) and per-
                                                    log(0.5)
sistence measured by the half-life of the shock − ψ ∈ (0, 10). The measure of the stabilization of
transfers is the fraction of the welfare loss without transfers which is eliminated by the introduction
of optimal transfers, where welfare losses are computed with respect to the baseline of the natural
allocation. Calibration with no hand-to-mouth consumers χ = 0.




                          0.04

                          0.03

                          0.02

                                                             1
                          0.01

                             0
                             1
                                 0.8                                              10
                                       0.6                                    8
                                             0.4                          6
                                                                      4
                                                   0.2            2
                                                         0   0

Figure 4: Net present value of transfers as fraction of GDP for a 5% shock to the terms of trade as a
function of openness measured by α ∈ (0, 1) and persistence measured by the half-life of the shock
  log(0.5)
− ψ ∈ (0, 10). Calibration with no hand-to-mouth consumers χ = 0.


                                                             46
                        Output gap                           PPI inflation                           Transfer
           0                                    0                                    0.006



        -0.02                                                                        0.004

                                             -0.05

        -0.04                                                                        0.002



        -0.06                                 -0.1                                      0
                0   1     2   3      4   5           0   1      2    3       4   5           0   1    2   3     4   5

                        Output gap                           PPI inflation                           Transfer
           0                                    0                                     0.04


                                                                                      0.03
        -0.02

                                             -0.05                                    0.02

        -0.04
                                                                                      0.01


        -0.06                                 -0.1                                      0
                0   1     2   3      4   5           0   1      2    3       4   5           0   1    2   3     4   5

                        Output gap                           PPI Inflation                           Transfer
           0                                    0                                      0.1



        -0.02

                                             -0.05                                    0.05

        -0.04



        -0.06                                 -0.1                                      0
                0   1     2   3      4   5           0   1      2    3       4   5           0   1    2   3     4   5

Figure 5: Allocations with optimal transfers (blue) and no transfers (green). The top panel corre-
sponds to α = 0.01, the middle panel to α = 0.1 and the bottom panel to α = 0.4. Inflation is
annualized and time is measured in years. Calibration with fraction of hand-to-mouth consumers
χ = 0.5.

                                                                1


                                                               47
                            1

                           0.8

                           0.6

                           0.4

                           0.2

                            0
                            1
                                 0.8                                                  10
                                       0.6                                        8
                                             0.4                              6
                                                                          4
                                                   0.2            2
                                                         0

Figure 6: Stabilization effect of transfers as a function of openness measured by α ∈ (0, 1) and per-
                                                    log(0.5)
sistence measured by the half-life of the shock − ψ ∈ (0, 10). The measure of the stabilization of
transfers is the fraction of the welfare loss without transfers which is eliminated by the introduction
of optimal transfers, where welfare losses are computed with respect to the baseline of the natural
allocation. Calibration with fraction of hand-to-mouth consumers χ = 0.5.




                          0.12


                          0.08


                          0.04                               1


                             0
                             1
                                 0.8                                                  10
                                       0.6                                        8
                                             0.4                              6
                                                                          4
                                                   0.2                2
                                                         0

Figure 7: Net present value of optimal transfers as fraction of GDP for a 5% shock to the terms of
trade as a function of openness measured by α ∈ (0, 1) and persistence measured by the half-life of
             log(0.5)
the shock − ψ ∈ (0, 10). Calibration with fraction of hand-to-mouth consumers χ = 0.5.



                                                             48
A     Online Appendix: Proofs and Details for Static Model in Sec-
      tions 2-3

A.1    Proof of Proposition 1
We have already proved that the conditions in the proposition are necessary for an allocation to-
gether with prices to form part of an equilibrium with complete markets. We now need to establish
these conditions are sufficient. The proof is constructive. Start with an allocation together with
prices that satisfy these conditions. We choose wages W i (s) to satisfy the labor-leisure condition
(5) for each i ∈ I and s ∈ S. Given some set of state prices Q(s), we pick portfolio taxes τDi (s)
to satisfy the risk sharing condition (3) for each i ∈ I and s ∈ S. Note a first dimension of inde-
terminacy here: we can always multiply state prices Q(s) and portfolio taxes 1 + τDi (s) by some
arbitrary common function λ(s) of s. We then pick labor taxes τLi to satisfy the price setting equation
(6). Finally, for a given set of ex-post fiscal transfers T̂ i (s) that satisfy the country budget constraint
  Q(s) T̂ i (s)π (s)ds = Q(s) PT (s)(CTi (s) − ETi (s)) π (s) and the condition that aggregate net inter-
R                       R                              

national transfers are zero in every state (8), we compute transfers to households T i (s) using the
government budget constraint (7). We can then compute the required portfolio positions Di (s) us-
ing the ex-post household budget constraint (2). These choices guarantee that the ex-ante household
budget constraint (1) is verified. Note a second dimension of indeterminacy, as we have some degree
of freedom in choosing ex-post fiscal transfers T̂ i (s).


A.2    Proof of Proposition 2
We have already proved that the conditions in the proposition are necessary for an allocation to-
gether with prices to form part of an equilibrium with complete markets. We now need to establish
these conditions are sufficient. The proof is constructive. Start with an allocation together with
prices that satisfy these conditions. We choose wages W i (s) to satisfy the labor-leisure condition (5)
for each i ∈ I and s ∈ S. We then pick labor taxes τLi to satisfy the prices setting equation (12). We
choose transfers T i (s) to satisfy the household budget constraint (11). We then choose ex-post fiscal
transfers T̂ i (s) to satisfy the government budget constraint (13). We can verify that these choices
satisfy (8).


A.3    Price Setting with Constant Elasticity of Substitution
We have
                                     τ i (s)UCi NT (s)CNT
                                                       i ( s ) π ( s ) ds
                                 R
                                                                              1 ε−1
                            1−       R i             i
                                                                          =           .
                                         UCNT (s)CNT (s)π (s)ds             1 + τLi ε




                                                         49
                                              i
We can rewrite the first-order condition for PNT as

                                 Z αi ( s )
                                    p         i         i         i          1
                                    i
                                            p   ( s ) α   ( s ) C T ( s )  i
                                                                                UCi T (s) τ i (s) π (s) ds = 0.
                                   α (s)                                  p (s)

     αip (s) i
If   αi ( s )
              p (s)   is constant then this implies that
                                             Z
                                                   i
                                                  CNT (s) UCi NT (s) τ i (s) π (s) ds = 0.

                            1 ε −1
Thus in this case          1+τLi ε
                                     = 1 or τLi = −1/ε.


A.4         Proof of Proposition 7
Consider an equilibrium such that τ i (s) 6= 0 for some i ∈ I, s ∈ S. Assume, towards a contradiction,
that the allocation is constrained Pareto efficient.
                                                                                   αi ( s )
    We consider two cases in turn. First, suppose that VCi T (s) = UCi T (s)(1 + pi (s) τ i (s)) < 0 for some
set Ω ⊂ I × S of positive measure of countries and states. Define the sections Ω(s) = {i : (i, s) ∈ Ω}.
Then there exists a perturbation that for each s ∈ S : (a) lowers CTi (s) for i ∈ Ω(s) and improves wel-
fare V i (s); (b) increases CTi (s) for i ∈
                                          / Ω(s) and improves welfare V i (s); and (c) satisfies the resource
              R i           R i
constraint CT (s)di = ET (s)di. This perturbation is feasible and creates a Pareto improvement, a
contradiction.
                                             αi ( s )
    Next, consider the case where 1 + pi (s) τ i (s) ≥ 0 for all i ∈ I, s ∈ S. For each state s consider
                                                                         αi ( s ) i
ranking countries by their weighted labor wedge                          pi ( s )
                                                                                  τ ( s ).   By Proposition 6 it must be that

                                                       αi ( s ) i                   αi ( s ) i 0
                                                 1+    pi ( s )
                                                                τ (s)        1+     pi ( s )
                                                                                             τ (s )
                                                        0               =            0
                                                      αi ( s ) i 0                 αi ( s ) i 0 0
                                                 1+     0      τ (s)         1+      0      τ (s )
                                                      pi ( s )                     pi ( s )


for all i, i0 , s and s0 . This implies that the ranking must be the same in all states s. It follows that there
                                                                                               αi ( s )
is a country i∗ that is at top of the ranking for all states s, i.e. i∗ ∈ ∩s∈S arg maxi∈ I pi (s) τ i (s). Propo-
                                                                                                      ∗
sition 5 then implies that this country has a positive labor wedge: τ i (s) ≥ 0 for all s. Proposition 4
                     ∗
then implies that τ i (s) = 0 for all s. Therefore we have that τ i (s) ≤ 0 for all i ∈ I, s ∈ S. Proposition
5 then implies that actually τ i (s) = 0 for all i ∈ I, s ∈ S.




                                                                        50
B     Online Appendix: Extensions for Static Model in Sections 2-3

B.1    Sticky Wages
In order to have a well defined wage setting problem we assume that labor services are produced by
combining a variety of differentiated labor inputs according to the constant returns CES technology

                                                                                                  1
                                                              1                                 1− ε1w
                                                     Z                                     
                                                                              1− ε1w
                                         N i (s) =                N i,h (s)            dh                .
                                                          0

The rest of the technology is as before. We assume that in each country there is a continuum of
workers h ∈ [0, 1], each supplying a particular variety h ∈ [0, 1] with preferences
                                     Z
                                               i,h
                                         U i (CNT  (s), CTi,h (s), N i,h (s); s)π (s)ds.

The budget constraints are the same as before
                                              Z
                                                  Di,h (s) Q(s)π (s)ds ≤ 0,



          i,h
   i
  PNT (s)CNT  (s) + PT (s)CTi,h (s) ≤ (1 − τLi )W i,h N i,h (s)
                                                                   + PT (s) ETi (s) + Πi (s) + T i (s) + (1 + τDi (s)) Di,h (s),

except that the wage W i,h is now specific to each worker h but independent of s because wages
are set in advance of the realization of the state s. Note that prices of non-traded goods are now
state-contingent. For convenience, we now assume that the worker pays for the labor tax; firms are
untaxed.
    Workers set their own wages W i,h taking into account that in each state of the world s labor
demand is given by N i (s)(W i,h /W i )−ε w where W i = ( (W i,h )1−ε w dh)1/(1−ε w ) is the wage index for
                                                                 R

labor services. In a symmetric equilibrium, all workers set the same wage W i,h = W i , and consume
                             i,h           i ( s ), C i,h ( s ) = C i ( s ) and N i,h ( s ) = N i ( s ). The wage W i is
and work the same so that CNT     (s) = CNT          T                T
given by
                                       1                  − N i ( s )U Ni ( s ) π ( s ) ds
                                                       R
                                i              ew
                            W =                                                            .
                                     1 − τLi ew − 1 R UCi NT (s) i
                                                             Pi ( s )
                                                                      N (s)π (s)ds
                                                                          NT

                                                      i,j
                                                        i ( s ). This price is given by
All varieties sell at the same price so that PNT (s) = PNT

                                                   i                   e    Wi
                                                  PNT (s) =                         .
                                                                     e − 1 Ai ( s )

   All the results that we derived in the version of the model with sticky prices carry through with
no modification to this specification with sticky wages. In particular, Propositions 1–12 are still

                                                                     51
valid. However, the corresponding allocations can be different than under sticky prices if there are
productivity shocks.


B.2       Limited Commitment
Explicit or implicit insurance (risk sharing) arrangements inevitably raise concerns of incentives.
We have abstracted from these considerations, not because we believe them to be unimportant, but
in order to isolate the effects that our aggregate demand externality has on optimal risk sharing.
Modeling limits to insurance due to incentive problems requires making specific choices about the
underlying shocks, the asymmetry of information, the available monitoring technologies, or the type
of commitment problem, etc. Although the possibilities are vast and exploring them all is beyond
the scope of this paper, we believe the main insights of our analysis would carry over.43
    In the online appendix B.3, we analyze an example with moral hazard. Here instead, we develop
an example with limited commitment. Consider the implementation with incomplete markets and
international transfers, where all international risk sharing occurs through international transfers. Ex
post, in every state of the world s, some countries i are net contributors to the union with T̂ i (s) ≤ 0,
and some countries i are net beneficiaries with T̂ i (s) ≥ 0. This poses no particular problem to the
extent that there exists a strong enough union-wide institutional enforcement mechanism. But with
imperfect enforcement and limited commitment, the concern arises that governments of ex-post net
contributor countries do no in fact contribute the transfers that were agreed upon ex ante behind the
veil of ignorance before the realization of the shock.
    To make things stark, consider the extreme case where there is no institutional enforcement mech-
anism. Governments can default on their promised transfers T̂ i (s), and have no ability to commit.
We assume that default leads to a utility loss for which we adopt a flexible parametrization K i (s).
The planning problem can now be written as
                                                                                             !
                                                                                    PT
                                                        Z Z
                                                               i    i
                                        max                   λV        CTi (s),     i
                                                                                       ;s        π (s)dids              (28)
                                         i ,C i ( s )
                                    PT ,PNT  T
                                                                                   PNT

subject to                                              Z                    Z
                                                            CTi (s)di =          ETi (s)di                              (29)

and                                                           !                                  !
                                                PT                                    PT
                               Vi      CTi (s), i ; s              ≥ Vi      ETi (s), i ; s          − K i ( s ).       (30)
                                               PNT                                   PNT
The only difference introduced by the limited commitment problem is the presence of the incen-
  43 In practice of course, institutional mechanisms exist to mitigate these agency problems. For example, most fiscal
unions such as the US channel a large part of their transfers through more or less ex-ante-rules-based automatic stabiliz-
ers (through the unemployment insurance program, federal income and social security taxes, bailout funds), probably
for reasons of political acceptability and transparency, but also to mitigate the difficulties associated with collective and
distributing discretionary ex-post transfers in a world with limited commitment. Another example is state debt-limit in
the US, or collective budget procedures and enforcement mechanisms that already exist in Europe.


                                                                        52
tive compatibility constraint (30), requiring each country to be better off sticking to the fiscal union
arrangement than defaulting and reverting to autarky while experiencing the endowment loss asso-
ciated with default.
    Let µ > 0 be the multiplier on (29) and νi (s) ≥ 0 be the multiplier on (30). The condition for
constrained efficient risk sharing becomes

                                                         αi ( s ) i
                                   UCi T (s)[1 +          i
                                                                 τ (s)][1 + νi (s)] = µ.                (31)
                                                         p (s)

By contrast, the corresponding corresponding condition for a country outside the currency union is

                                                    UCi T (s)[1 + νi (s)] = µ.                          (32)

Condition (32) shows that even with flexible exchange rates, limited commitment endogenously
limits insurance (risk sharing) possibilities. A high value of the multiplier νi (s) indicates that it
is relatively tempting for country i to default in a state s. The optimal contract then adjusts the
transfer T̂ i (s) and the traded goods consumption CTi (s) so that default is prevented. Condition (31)
shows how the optimal provision of insurance (risk sharing) and incentives must be modified when
the country is in a currency union. The provision of incentives requires the private consumption of
traded goods to vary with the realization of government consumption. Because prices are sticky, this
generates a non-zero pattern of labor wedges τ i (s). This in turn opens up a wedge between the social
and private marginal utility of income, which creates another force agains the perfect equalization
of consumption of traded goods across states for each country.
    This example shows that the optimal risk sharing arrangements are different for countries that
belong to a currency union than that for countries who have a flexible exchange rate. This is true with
or without enforcement frictions. In both cases, the optimal arrangement involves a key sufficient
                                                                           αi ( s )
statistic, the social marginal utility of transfers given by UCi T (s)[1 + pi (s) τ i (s)] for a country in a
currency union and given by UCi T (s) for a country outside a currency union.


B.3    Moral Hazard
Suppose that the government can exert effort e ex ante to affect the distribution of the endowment
of the traded good ex post, but that effort e is not observable, creating a moral hazard problem. We
focus on a single country i ∈ [0, 1]. We assume that the shock s is purely idiosyncratic and only
affects the value of the endowment ETi (s) in country i. Naturally, monetary policy at the union level
should not react to to the idiosyncratic shocks s of an infinitesimal country, so that PT (s) = PT is
constant. These assumptions simplify the exposition. The principal-agent problem is then
                                                                        !
                                                                   PT
                                                Z
                                 max                Vi    CTi (s), i        π (s|e)ds − h(e)            (33)
                               i ,C i ( s ),e
                              PNT  T
                                                                  PNT



                                                                53
subject to                                 Z
                                               (CTi (s) − ETi (s))π (s|e)ds ≤ 0                                               (34)

and
                             !                                                      !
                        PT                                                     PT
      Z                                                  Z
          Vi   CTi (s), i        π (s|e)ds − h(e) ≥          Vi       CTi (s), i        π (s|e0 )ds − h(e0 )   for all e0 .   (35)
                       PNT                                                    PNT

The first constraint (34) simply conditions the average level of expected transfers; this reflects the
fact that insurance is priced fairly i.e. (Q(s) = 1), since the shock is experienced by a single country
and does not affect aggregate resources at the union level. The last constraint (35) is the incentive
compatibility condition, requiring the country’s effort to be optimal, taking the schedule CTi (s) as
given.
    In the absence of nominal rigidities or for a country with flexible exchange rates and independent
monetary policy, we would solve the same problem but using V i∗ (CTi (s)) = max pi V i CTi (s), pi in
                                                                                                        
                        
                       P
place of V i CTi (s), PiT . Note that V i CTi , pi ≤ V i∗ (CTi ) with equality at a single value of CTi , so
                                                  
                         NT

that V i∗ is an upper envelope of V i . When prices are rigid it is as if the country were more risk
averse, in the sense described earlier. In the presence of moral hazard, higher risk aversion affects
the optimal insurance (risk sharing) contract CTi (·).
   Consider the planning problem (33). Let µ be the multiplier on (34) and dν(e0 ) be the measure
multiplier on (35). The corresponding for constrained efficient risk sharing becomes

                                         αi ( s ) i                    π (s|e) − π (s|e0 )
                                                                  Z
                         UCi T (s)[1 +            τ (s)][1 +                               dν(e0 )] = µ.                      (36)
                                         pi ( s )                            π (s|e)

By contrast, the corresponding corresponding condition for a country outside the currency union is

                                                         π (s|e) − π (s|e0 )
                                                     Z
                                     UCi T (s)[1 +                           dν(e0 )] = µ.                                    (37)
                                                               π (s|e)

Condition (37) shows that even with flexible exchange rates, moral hazard endogenously limits in-
surance (risk sharing) possibilities. There is a meaningful tradeoff between insurance (risk sharing)
and incentives and providing incentives for the country’s government to exert the adequate level ef-
fort requires the government to have “skin in the game”. The private consumption of traded goods
must vary with the realization of government spending on traded goods. It must be high when-
ever the particular realization of government spending is more likely (as measured by the likelihood
        π (s|e)−π (s|e0 )
ration       π (s|e)
                          ) under the desired effort level than under alternative effort levels that the gov-
ernment is tempted to exert (as measured by the measure multiplier dν(e0 ) on the corresponding
incentive compatibility constraint). This is accomplished by reducing the level of transfers to the
country when government spending on traded goods is high.
    Condition (36) shows how the optimal provision of insurance (risk sharing) and incentives must
be modified when the country is in a currency union. The provision of incentives requires the pri-

                                                                  54
vate consumption of traded goods to vary with the realization of government consumption. Because
prices are sticky, this generates a non-zero pattern of labor wedges τ i (s). This in turn opens up a
wedge between the social and private marginal utility of income, which creates another force agains
the perfect equalization of consumption of traded goods across states. As a result, the optimal in-
surance insurance (risk sharing) arrangements are different for countries that belong to a currency
union than that for countries who have a flexible exchange rate.


B.4         Government Spending
We introduce government spending in the model. We characterize the joint optimal use of interna-
tional transfers and government spending. Our analysis underscores that both instruments should
be used in conjunction. Moreover, we show that our characterization of fiscal unions is robust to
the availability of government spending as an additional instrument. We also compare their relative
performance depending on a number of deep economic parameters by studying a few limit cases.


Introducing government spending. Following the literature, we focus on the case where govern-
ment spending is concentrated on non-traded goods, which we view as the most practically relevant
case.44 In each state s and country i, the government spends PNT i G i ( s ) to finance government
                                                                      NT
                  i
consumption of GNT (s) of non-traded goods. As is standard, we capture agents’ preferences of gov-
ernment consumption by including it in the utility function and write

                                                                       U i ( GNT
                                                                              i        i
                                                                                 (s), CNT (s), CTi (s), N i (s); s)

for the state-s utility function of country i agents. We assume that that preferences are weakly sep-
arable over government consumption on the one hand, and private consumption and labor on the
other hand. In addition, we continue to assume that preferences over consumption goods are weakly
separable from labor, and that the preference over consumption goods are homothetic.
    Apart from that, there are only minor differences with the setup of the main model. These differ-
ences involve the government budget constraint, the resource constraint for non-traded goods, and
the price setting conditions.45 Our implementability results in Propositions 1 and 2 can be extended
in a straightforward way.
   44 For
        example Beetsma and Jensen (2005) and Gali and Monacelli (2008) introduce government spending on domestic
goods in models where all goods are traded, with or without home bias in consumption. The natural equivalent in our
setup is to study government spending on non-traded goods. We have also analyzed government spending on traded
goods. The analysis is available upon request.
  45 The government budget constraint is now T i ( s ) + Pi G i ( s ) = τ i W i ( s ) N i ( s ) − τ i ( s ) D i ( s ) + T̂ i ( s ). The resource
                                                          NT NT               L                    D
constraint for non-traded goods is now CNTi ( s ) + G i ( s ) = Ai ( s ) N i ( s ). The price setting constraint is now Pi
                                                       NT                                                                                  NT =
                         Q(s) W i (s)            i ( s )+ G i ( s ) π ( s ) ds
                                         [     CNT                 ]
                   R
                       1+ τ i ( s ) A i ( s )               NT
(1 + τLi ) ε−ε 1           D
                       R Q(s)                 i ( s )+ G i ( s ) π ( s ) ds
                                                                                 .
                                     [    C   NT         NT    ]
                          1+ τ i ( s )
                                 D




                                                                                           55
Second-Best Planning problem. In order to write down the second-best Ramsey planning prob-
lem jointly characterizing international transfers and government spending, we modify the indirect
utility function. We define

                                                                                          i ( p; s )C + G i ( s )
                                                                                                                    !
                                                                                        α            T
               Ṽ i ( GNT
                       i
                          (s), CT , p; s) = U i             i
                                                           GNT (s), αi ( p; s)CT , CT ,                      NT
                                                                                                                  ;s .
                                                                                                    Ai ( s )
                        i ( s ), C i ( s ) and pi ( s ), ex post welfare in state s in country i is then given
In an equilibrium with GNT        T
by
                                        Ṽ i ( GNT
                                                i
                                                   (s), CTi (s), pi (s); s).

    The second-best planning problem is
                                                                                                    !
                                                                                     P (s)
                                                      Z Z
                                max                          Ṽ i    i
                                                                    GNT (s), CTi (s), Ti ; s            λi π (s) di ds
                      i ( s ),P ( s ),Pi ,C i ( s )
                     GNT       T       NT T
                                                                                      PNT

subject to                                             Z                     Z
                                                            CTi (s)di   =        ETi (s)di.

We can solve this planning problem recursively by defining

                                                                                      i ( p; s )C + G i ( s )
                                                                                                                !
                                                                                    α            T
                V i (CT , p; s) = max U i               i
                                                       GNT (s), αi ( p; s)CT , CT ,              i
                                                                                                      NT
                                                                                                              ;s ,       (38)
                                      i (s)
                                     GNT                                                        A (s)

and then solving                                                                          !
                                                                             PT (s)
                                                       Z Z
                                       max                    Vi     CTi (s), i ; s           λi π (s) di ds
                                        i ,C i ( s )
                                PT (s),PNT  T
                                                                              PNT
subject to                                             Z                     Z
                                                            CTi (s)di   =        ETi (s)di.


Constrained Pareto efficient allocations. With these notations, the analysis is identical to that of
the model without government spending. Indeed, the derivatives of the indirect utility function
V i (CT , p; s) are given by exactly the same formula as in Proposition 3, and as a result, Propositions
4-10 as well as Proposition 12 carry through without any modification.46 Hence our analysis of fiscal
unions is robust to the availability of government spending as an additional instrument.
     Of course, this does not mean that the resulting allocation is unchanged. Away from this case,
optimal government spending can reduce the deviations of the labor wedge τ i (s) from zero, but it
does not eliminate them.47 There are two informative ways to write the optimality condition for
government spending, both of which follow directly from the definition of V i (CT , p; s) in equation
  46 The exact conditions in Proposition 11 for the constrained efficiency of the complete markets equilibrium without
portfolio taxes are different in the presence of government spending.
  47 Formally, this is true except in the knife-edge cases where the optimal allocation with flexible prices can be imple-

mented with a fixed exchange rate.


                                                                        56
(38):
                                                                1
                                             UGi NT (s) = −           U i ( s ),                                     (39)
                                                              Ai ( s ) N
or
                                         UGi NT (s) = (1 − τ i (s))UCi NT (s) .                                      (40)

    To understand these formulas, it is best to analyze first the case when prices or exchange rates
are flexible. Optimal government spending is then characterized by equation (39) or equation (40)
with τ i (s) = 0. Both equations equalize the marginal benefit UGi NT (s) of government consump-
tion with its marginal cost, but express the marginal cost in two different (but equivalent) ways.
Equation (39) expresses the marginal cost − Ai1(s) UN  i ( s ) in terms of the marginal increase labor that

would be required to service the marginal increase in government consumption, while equation (40)
with τ i (s) = 0 expresses the marginal cost UCi NT (s) in terms of the marginal reduction in private
consumption that would be required to service the marginal increase in government consumption.
These are two equivalent ways of stating the Samuelson rule (see Samuelson 1954) for the optimal
provision of public goods.
    Depending on which of these formulations one prefers to focus on, rigid prices and fixed ex-
change rates either require no deviation from the Samuelson rule (equation (39)) or a deviation from
the Samuelson rule (equation (40)). The reason is that the social marginal cost of government spend-
ing is still given by − Ai1(s) UN
                                i ( s ) but not by U i                              i      i
                                                    CNT ( s ) and instead by (1 − τ ( s ))UCNT ( s ). This is
because the price of non-traded goods does not reflect the marginal cost of producing them. The
discrepancy is precisely given by the labor wedge. The government internalizes this wedge when it
decides its consumption of non-traded goods, but private agents do not. As a result, in recessions
when τ i (s) > 0, it is optimal to tilt the mix of government and private consumption of non-traded
goods in the direction of the former, and the opposite holds true in booms when τ i (s) < 0.48
    Having characterized the jointly optimal use of international transfers and government spending
and shown the robustness of our characterization of optimal international transfers to the availabil-
ity of government spending as an additional instrument, we now compare the relative performance
of government spending and international transfers in a few enlightening limit cases. We first treat
the case of the closed-economy limit. We show that international transfers achieve perfect macroe-
conomic stabilization, with no residual role for government spending. By contrast, in the perfectly
open economy limit, international transfers are not used for macroeconomic stabilization, but gov-
ernment spending is. We then treat the cases where the disutility of labor is linear or government
spending is purely wasteful. In both cases, we show that even though the optimum is away from
the first best, government spending is not useful for macroeconomic stabilization.
  48 Thisanalysis assumes that prices are entirely rigid. If there is some adjustment in prices, then increases in govern-
ment spending stimulate inflation. Given a fixed exchange rate, and other things equal, this leads to an appreciation
of the real exchange rate which depresses private spending on non-traded goods and counteracts the direct effect of
government spending on total spending on non-traded goods (see e.g. Farhi-Werning 2012). This lessens the macroeco-
nomic stabilization role of government spending. The same holds true for international transfers, as we emphasize in
Section 5.



                                                           57
Closed-economy limit. Consider first the closed-economy limit. This limit can be understood as
                                                                                    i   1− γ
follows. Suppose for simplicity that preferences are given by v( GNT  i ( s )) + C (s)           i
                                                                                      1−γ − φ ( N ( s )) where
                                                   η
                          η −1              η −1 η −1
                                               
                  1               1
  i               η i
C (s) = (1 − α) CNT (s)     η        i
                               + α CT ( s )
                                  η           η       . Then for any p, αi ( p; s) is decreasing in α. The
closed-economy limit is obtained in the limit by also scaling where α goes to zero and αi ( p; s) goes to
infinity as long as we also scale ETi (s) by (1−α α) so as to keep αi ( p; s) ETi (s) constant. In this limit, the
first-best level of welfare is achieved. This is because international transfers are extremely power-
ful in relatively closed economies. Indeed, we have already emphasized that the “dollar-for-dollar”
output multiplier of transfers is precisely given by the relative expenditure share of non-traded to
traded goods. And this multiplier goes to infinity in the closed-economy limit. As we approach the
closed-economy limit, vanishingly small departures (as a fraction of each country’s nominal income)
from the international transfers that support the first-best allocation are enough to perfectly stabilize
the economy and deliver τ i (s) = 0 for all i and s. There is no residual macroeconomic stabilization
role for government spending, which then simply follows the first-best Samuelson rule.


Perfectly-open economy limit. The relative usefulness of international transfers and government
spending is reversed in the limit where countries are perfectly open, which we capture by letting α
go to one. In this limit, international transfers are not used for macroeconomic stabilization, in the
sense that constrained efficient and privately optimal risk sharing coincide, so that optimal inter-
national transfers are only needed when markets are incomplete, in order to replicate the complete
markets allocation with privately optimal risk sharing. By contrast, government spending is used
for macroeconomic stabilization as characterized by the same optimality conditions (39) and (40).


Linear disutility of labor. Suppose now that the disutility from labor is linear. We maintain the
same parametrization of preferences and assume in addition that φ( N i (s)) = φN i (s) for some con-
stant φ > 0. In this case, the first-order condition for optimal government spending (39) becomes
      i ( s )) = φ . This formula, which pins down G i ( s ) as a function of Ai ( s ), holds both under
v0 ( GNT        Ai ( s )                                NT
rigid prices and fixed exchange rates, and under flexible prices or flexible exchange rates. Hence
there is a sense in which government spending is not used for macroeconomic stabilization, despite
the fact that macroeconomic stabilization is imperfect. The same is not true of international transfers.


Purely wasteful government spending. Another enlightening case is the case in which govern-
ment spending is purely wasteful, so that it does not enter preferences.49 In that case, formulas (39)
and (40) indicate that it is optimal not to use government spending, both with rigid prices and fixed
exchange rates and with flexible prices or flexible exchange rates. Hence, once again, there is a sense
in which government spending is not used for macroeconomic stabilization, despite the fact that
macroeconomic stabilization is imperfect. The same is not true of international transfers.
  49   Formally, this means that U i ( GNT
                                        i ( s ), C i ( s ), C i ( s ), N i ( s ); s ) is independent of G i ( s ).
                                                   NT        T                                            NT




                                                                         58
C     Online Appendix: Proofs and Details for Dynamic Model in
      Sections 4-5

C.1    Nonlinear Calvo Price Setting Equations
The equilibrium conditions for the Calvo price setting model can be expressed as follows

                                                       −1                                  e −1
                                               1 − δΠeH,t                            Ft
                                                                                 
                                                                             =                     ,
                                                     1−δ                             Kt


                                             ε 1 + τL
                                Kt =                   Yt Nt + δβΠeH,t+1 Kt+1 ,
                                                           φ
                                           ε − 1 A H,t
                                  Ft = Yt Ct−σ St−1 Qt + δβΠeH,t
                                                              −1
                                                                 +1 Ft+1 ,


together with an equation determining the evolution of price dispersion

                                                     ∆t = h(∆t−1 , Π H,t ),
                                                                   e
                                           1−δΠe−1
                                                        
                                                                 e −1
where h(∆, Π) =   δ∆Πe   + (1 − δ )          1− δ                       .


C.2    Decomposing the Planning Problem (22)
We can break down the planning problem into two parts. First, there is an aggregate planning
problem determining the average output gap and inflation ŷ∗t and πt∗
                                                   Z ∞
                                        1                               h                              i
                                    min                      e   −ρt
                                                                            απ (πt∗ )2    + (ŷ∗t )2       dt   (41)
                                        2           0

subject to (27).
    Second, there is a disaggregated planning problem determining deviations from the aggregates
for output gap, home inflation and consumption smoothing, ȳˆit , π̄ˆ iH,t and θ̄ˆti
                                  Z ∞Z 1
                              1
                                               e−ρt απ (π̄ˆ iH,t )2 + (ȳˆit )2 + αθ (θ̄ˆi )2 didt
                                                   h                                         i
                          min                                                                                   (42)
                              2    0       0

subject to (23), (24), (25), (26). Note that because the forcing variables in this linear quadratic problem
        R1
satisfy 0 s̃it di = 0, the aggregation constraint (26) is not binding. We can therefore drop it from
the planning problem. The resulting relaxed planning problem can be broken down into separate
component planning problems for each country i ∈ [0, 1]
                                       Z ∞
                                1                        h
                                                                    i    2      i 2       ˆ i 2
                                                                                                i
                            min                e   −ρt            ˆ           ˆ
                                                             απ (π̄ H,t ) + (ȳt ) + αθ (θ̄ ) dt                (43)
                                2      0




                                                                            59
subject to (23), (24) and (25).


C.3    Incomplete Markets and No Transfers in a Currency Union
Here we analyze the solution with incomplete markets and no transfers. This solution imposes
θ̄ˆi = 0 and coincides with the solution with complete markets and no interventions in financial
markets, a well-known property of the Cole-Obstfeld case, where the lack of complete markets is not
a constraint on private risk sharing.
                        R1           R1
     Using the fact that 0 ȳˆit di = 0 π̄ˆ iH,t di = 0, we are led to the following planning problem:
                               Z ∞Z 1
                           1                      h
                                                             i    2      i 2       ∗ 2      ∗ 2
                                                                                                i
                       min              e   −ρt            ˆ           ˆ
                                                      απ (π̄ H,t ) + (ȳt ) + απ (πt ) + (ŷt ) di dt
                           2   0    0

subject to

                                                       π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit ,
                                                             ȳˆ˙ it = −π̄ˆ iH,t − s̃˙ it ,

                                                                ȳˆ0i = −s̃0i ,

                                                         π̇t∗ = ρπt∗ − κy ŷ∗t ,

where the minimization is over the variables π̄ˆ iH,t , πt∗ , ȳˆit , ŷ∗t . Note that since θ̄ˆi = 0, the two aggre-
                   R1 i               R1 i
gation constraints   ȳˆ t di = 0 and
                       0                π̄ˆ H,t di = 0 are automatically verified.
                                             0
   The solution of the planning problem is then simply ŷ∗t = πt∗ = 0 for the aggregates. This
result is a restatement of the result in Benigno (2004) and Gali and Monacelli (2008) that optimal
monetary policy in a currency union ensures that the union average output gap and inflation are
zero in every period. Monetary policy can be chosen at the union level so that monetary conditions
are adapted to the average country. The disaggregated variables π̄ˆ iH,t and ȳˆit solve the following
system of differential equations,

                                                       π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit ,
                                                             ȳˆ˙ it = −π̄ˆ iH,t − s̃˙ it ,

with initial condition
                                                                ȳˆ0i = −s̃0i .

Proposition 18. The solution with incomplete markets and no interventions in financial markets ( NFA     ˆ¯ i =
                                                                                                            0
ˆθ̄ i = 0) coincides with the solution with complete markets and no interventions in financial markets. In both
cases, union-wide aggregates are zero
                                                  ŷ∗t = πt∗ = 0.




                                                                      60
C.4      Transfer Multipliers in a Currency Union
Before solving the normative problem it is useful to review the positive effects of transfers. The next
proposition characterizes the response of the economy to a marginal increase in transfers.
                                                 √
                                               ρ− ρ2 +4κy
Proposition 19 (Transfer Multipliers). Let ν =      2     . Transfer multipliers are given by

                                         ∂ȳˆit             1−α                    1
                                                    = eνt ρ         − (1 − eνt )ρ      ,
                                       ∂ NFA ˆ¯ i              α                  1+φ
                                                  0
                                        ∂π̄ˆ iH,t                  1−α          1
                                                                                  
                                                    = −νe ρ νt
                                                                         +ρ          ,
                                       ∂ NFA  ˆ¯ i                  α       1+φ
                                                  0
                                         ∂s̄ˆit                        1−α          1
                                                                                       
                                                    = −[1 − e ] ρνt
                                                                             +ρ           .
                                       ∂ NFA   ˆ¯ i                      α        1+φ
                                                  0

    The presence of the discount factor ρ in all these expressions is natural because what matters
is the annuity value ρ NFA   ˆ¯ i of the transfer. Note that the terms of trade gap equals accumulated
                   Rt i         0
inflation: s̄ˆt = − π̄ˆ H,s ds.
                           0
   Transfers have opposite effects on output in the short and long run. In the short run, when prices
are rigid, there is a Keynesian effect due to the fact that transfers stimulate the demand for home
              ∂ȳˆ0i
goods:           ˆ¯ i   = ρ 1−α α . In the long run, when prices adjust, the neoclassical wealth effect on labor
            ∂ NFA   0
                                           ∂ȳˆit
supply lowers output: limt→∞                 ˆ¯ i   = −ρ 1+1 φ . In the medium run, the speed of adjustment, from
                                         ∂ NFA  0
the Keynesian short-run response to the neoclassical long-run response, is controlled by the degree
of price flexibility κy , which affects ν.50
    Note that the determinants of the Keynesian and neoclassical wealth effects are very different.
The strength of the Keynesian effect hinges on the relative expenditure share of home goods 1−α α :
the more closed the economy, the larger the Keynesian effect. The strength of the neoclassical wealth
effect depends on the elasticity of labor supply φ: the more elastic labor supply, the larger the neo-
classical wealth effect.
    Positive transfers also increase home inflation. The long-run cumulated response in the price of
home produced goods equals ρ 1−α α + ρ 1+1 φ . The first term ρ 1−α α comes from the fact that transfers
increase the demand for home goods, due to home bias. The second term ρ 1+1 φ is due to a neoclassical
wealth effect that reduces labor supply, raising the wage. How fast this increase in the price of home
goods occurs depends positively on the flexibility of prices through its effect on ν.51
    The effects echo the celebrated Transfer Problem controversy of Keynes (1929) and Ohlin (1929).
With home bias, a transfer generates a boom when prices are sticky, and a real appreciation of the
terms of trade when prices are flexible. The neoclassical wealth effect associated with a transfer
comes into play when prices are flexible, and generates an output contraction and a further real
  50 Note that ν is decreasing in κy , with ν = 0 when prices are rigid (κy = 0), and ν = −∞ when prices are flexible
(κy = ∞).
  51 Recall that ν is decreasing in the degree of price flexibility κ .
                                                                     y



                                                               61
appreciation.


C.5     Proof of Proposition 14
In this case, κy = 0 and the constraint set boils down to ȳˆit = (1 − α)θ̄ˆi − s̃it , and we are therefore left
with the following component planning problem
                                                      Z ∞
                                                  1
                                                            e−ρt ((1 − α)θ̄ˆi − s̃it )2 + αθ (θ̄ˆi )2 dt.
                                                                h                                    i
                                          min
                                                  2   0

The result follows.


C.6     Proof of Proposition 19
We use the decomposition of the planning problem given in Appendix C.2. We focus on the compo-
nent planning problem for a country i. We first solve the behavior of an economy for a given transfer
θ̄ˆi . Then in Appendix C.7, we solve for the optimal θ̄ˆi .

                                                          π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − λαθ̄ˆi ,
                                                                ȳˆ˙ it = −π̄ˆ iH,t − s̃˙ it ,

                                                                ȳˆ0i = (1 − α)θ̄ˆi − s̃0i .

   Define E1 = [1, 0]0 and E2 = [0, 1]0 . Let Xti = [π̄ˆ iH,t , ȳˆit ]0 , Bti = [−λαθ̄ˆi , −s̃˙ it ]0 = −λαθ̄ˆi E1 − s̃˙ it E2 .
             "           #                √
                ρ −κ y                ρ− ρ2 +4κy
Define A =                 . Let ν =        2      < 0 be the (only) negative eigenvalue of A, and
               −1 0
Xν = [−ν, 1]0 and be an eigenvector associated with the negative eigenvalue of A. The solution is
given by
                                          Z ∞                                                                    Z ∞
               Xti   =   eνt αiν Xν   −           e A(t−s) Bsi ds    =    eνt αiν Xν   + λαθ̄ˆi A−1 E1 +                s̃˙ iu e A(t−u) E2 du,
                                              t                                                                    t

where                                                               Z ∞
                                                          X0i   +         e− As Bsi ds = αiν Xν ,
                                                                    0

                                                              E20 X0i = (1 − α)θ̄ˆi − s̃0i .

We find                                                                                            Z ∞
                                                                                   θ̄ˆi − s̃0i −
                                          h                                    i
                               αiν    =       (1 − α) − λαE20 A−1 E1                                     s̃˙ it E20 e− At E2 dt.
                                                                                                   0

Using E20 A−1 E1 = −κy−1 , and E10 A−1 E1 = 0, we can infer the path for output ȳˆit = E20 Xti and inflation
π̄ˆ iH,t = E10 Xti as follows:
                                                         Z ∞
                               ȳˆit = eνt αiν − αθ̄ˆi +
                                                λ
                                                             s̃˙ iu E20 e A(t−u) E2 du,
                                                κy        t



                                                                              62
                                                                               Z ∞
                                             π̄ˆ iH,t   =   −νeνt αiν      +           s̃˙ iu E10 e A(t−u) E2 du.
                                                                                   t
The results in Proposition 19 follow by specializing these expressions to the case s̃t = 0.


C.7     Derivation of the Optimum in Section 6.2
In Appendix C.6, we solved for the behavior of the disaggregated variables Xti = [π̄ˆ iH,t , ȳˆit ]0 for a
given θ̄ˆi . We now solve for the optimal θ̄ˆi . We apply the results of Appendix C.6 in the particular
case s̃it = s̃0i e−ψt . We get

                             Xti = eνt αiν Xν + λαθ̄ˆi A−1 E1 − ψe−ψt s̃0i ( A + ψI )−1 E2 ,

where
                                                                                   θ̄ˆi − s̃0i + ψs̃0i E20 ( A + ψI )−1 E2 ,
                                  h                                            i
                       αiν   =        (1 − α) − λαE20 A−1 E1
                                         " #        √
           0             0       ρ   − κ y        ρ− ρ2 +4κy
E1 = [1, 0] , E2 = [0, 1] , A =              ,ν=      2      < 0 is the negative eigenvalue of A, and
                                −1 0
Xν = [−ν, 1]0 is an eigenvector associated with the negative eigenvalue of A. This yields


                                                                                 ψκy s̃0i
                                         π̄ˆ iH,t = −αν νeνt −                             e−ψt ,
                                                                             (ρ + ψ)ψ − κy
                                                                       αλ ˆi    (ρ + ψ)ψs̃0i −ψt
                                                ȳˆit = αν eνt −          θ̄ −               e .
                                                                       κy      (ρ + ψ)ψ − κy

   We need to solve                                                    Z ∞
                                            1 αθ ˆi 2 1                          h                           i
                                 min            (θ̄ ) +                      e−ρt απ (π̄ˆ iH,t )2 + (ȳˆit )2 dt.
                                  θ̄ˆi      2 ρ         2              0

This can be rewritten as

                                                                             ψκy s̃0i              2αν νψκy s̃0i
                            Z ∞
            1 αθ ˆi 2 1
                                                                                                                             
                                                                                       2 −2ψt
      min       (θ̄ ) +           e   −ρt
                                                απ       α2ν ν2 e2νt   +                 e     +                 e−(ψ−ν)t
       θ̄ˆi 2 ρ         2    0                                           (ρ + ψ)ψ − κy           (ρ + ψ)ψ − κy
                                                                            (ρ + ψ)ψs̃0i 2 −2ψt
                                                  
                                                          αλ 2 ˆi 2
                                                                                                    − 2αν θ̄ˆi eνt
                                                                                                         αλ
                                             + α2ν e2νt +        (θ̄ ) +                   e
                                                          κy              (ρ + ψ)ψ − κy                   κy
                                               2αν (ρ + ψ)ψs̃0i −(ψ−ν)t     2αλ(ρ + ψ)ψs̃0i ˆi −ψt
                                                                                                      
                                             −                 e        +                      θ̄ e      dt.
                                               (ρ + ψ)ψ − κy               κy [(ρ + ψ)ψ − κy ]

Solving the integrals, we arrive at

                     αθ ˆi 2 (αλ)2 ˆi 2     α π ν2 + 1 i 2    (απ κ 2 + (ρ + ψ)2 )(ψs̃0i )2
               min (θ̄ ) +          (θ̄ ) +           (α ) +
                θ̄ˆi 2ρ       2ρκ 2         2(ρ − 2ν) ν      2(ρ + 2ψ)[(ρ + ψ)ψ − κy ]2
                          (απ νκy − ρ − ψ)ψs̃0i              αλs̃0i ψ
                                                                        θ̄ˆi −             αi θ̄ˆi .
                                                                                   αλ
                    +                             αiν +               2
                      (ρ + ψ − ν)[(ρ + ψ)ψ − κy ]       (ρ + ψ)ψκy − κy        ( ρ − ν )κ y ν


                                                                               63
The solution is
                h
                                       α π ν2 +1
                                                                  i
                                                                           κy s̃0i              αλψs̃0i          (απ νκy −ρ−ψ)ψs̃0i (1−α+ αλ
                                                                                                                                          κy )
                                   −     ρ−2ν (1 − α + κy )                              −                   −
                        αλ                             αλ
                    ( ρ − ν )κ y                                      ( ρ + ψ ) ψ −κ y       (ρ+ψ)ψκy −κy2          (ρ+ψ−ν)((ρ+ψ)ψ−κy )
       θ̄ˆi =                                                                                                                                    .
                                                  (αλ)2         ν2 +1                    αλ 2           2αλ
                                         αθ
                                         ρ    +    ρκy2
                                                          +   απ
                                                               ρ−2ν     (1 − α +         κy )   −   ( ρ − ν )κ y
                                                                                                                 (1 − α + αλ
                                                                                                                          κy )


C.8    Proof of Proposition 15
In the closed-economy limit, as α → 0, we have αθ = 0, and we see directly from Section C.7 that

                                               κy s̃0i   ρ − 2ν       (απ νκy − ρ − ψ)ψs̃0i
                               θ̄ˆi = −                −                                      .
                                          (ρ + ψ)ψ − κy απ ν2 + 1 (ρ + ψ − ν)[(ρ + ψ)ψ − κy ]


D     Online Appendix: Extensions of Dynamic Model in Sections
      4-5 for Section 6
In this appendix, we detail two extensions of the dynamic model by introducing hand-to-mouth
consumers and alternative macroeconomic instruments. This appendix is organized as follows. Sec-
tion D.1 outlines the extended model. Section D.2 derives the allocations given exogenous policies.
Section D.3 derives the loss function. Sections D.4-D.9 set up the planning problem as well as the so-
lution method for alternative macroeconomic instruments: international transfers, capital controls,
government spending, redistribution, deficits, and then all domestic fiscal policy instruments com-
bined. Section D.10 specializes the previous sections to the case of no hand-to-mouth consumers. We
first setup up the model allowing only for international transfers, government spending, and capital
controls in Sections D.4-D.6. We then generalize it to allow for redistribution and deficits in Sections
D.7-D.9.


D.1    Model
This is a model of fiscal unions with two types of agents: hand-to-mouth (HtM) agents of measure
χ ∈ [0, 1] and optimizers of measure 1 − χ. We assume throughout that countries are in a currency
union. From the get go, we study idiosyncratic productivity shocks in a given country i, which
will correspond to Home in the exposition of Sections 4-5.52 We abstract from idiosyncratic shocks
in other countries and from aggregate shocks. As a result, union-wide aggregates and policies are
constant at their steady state where outputs in all countries are equal to one.
 52 There   is no rest of the world (RoW) beyond the members of the fiscal union.




                                                                               64
D.1.1   Households

The two types of households in country i share the same preferences, given by
                      Z ∞
                                                                         1
                                                                                                
                            e   −ρt
                                          (1 − υ) ln(Cti,s ) −               i,s 1+φ
                                                                           (N )               i
                                                                                     + υ ln( Gt ) dt,                      (44)
                        0                                               1+φ t

where s ∈ {o, r } designates the agent type; o denotes optimizers and r HtM agents. As in the main
paper, Nti,s denotes labor supplied by agent s in country i, and the consumption basket is given by

                                                                         η −1                       η −1
                                                                                                             η −η 1
                                                         1                            1
                                 Cti,s    = (1 − α )     η     i,s
                                                             (CH,t )        η    +α   η     i,s
                                                                                          (CF,t )      η               ,


where                                                                                        e−e 1
                                                                  1
                                                         Z
                                              i,s                       i,s      e −1
                                             CH,t    =                (CH,t ( j)) e dj
                                                              0

is the basket of home goods consumed by agent s in country i, with j denoting an individual good
variety. Similarly,
                                         Z 1              γ−γ 1
                                                     γ −1
                                   i,s          i,s γ
                                  CF,t =      (Ck,t ) dk
                                                                  0

denotes the consumption index of imported goods consumed by agent s. We also have
                                                         Z       1
                                                                                            e−e 1
                                               i,s                      i,s      e −1
                                              Ck,t   =                (Ck,t ( j)) e dj               .
                                                              0


Throughout the paper, we focus exclusively on the Cole-Obstfeld calibration and subsequently set
η = γ = 1. As is standard, the parameter α indexes the degree of home bias in goods consumption.
As α → 0, the share of imported goods in domestic consumption vanishes. As α → 1, the share of
home goods vanishes. The two agent types differ with respect to their per-period budget constraints,
which we now describe.


D.1.2   Budget Constraints, Transfers, and NFA

In our analysis of transfers, country i will receive a transfer in every period from the remaining
members of the fiscal union after the realization of a productivity shock. We impose that each opti-
mizer and each HtM agent receive an equal share of this transfer in every period. To that end, the
government will tax optimizers and rebate the proceeds to the HtM agents accordingly.
   For optimizers, only the net present value of this transfer matters. We encode the net present
value of this transfer in the initial net foreign asset position of country i, NFA0i , which we will later
derive from the optimizers’ budget constraint explicitly.
   We start our discussion of transfers by considering the optimizers’ budget constraint. Each opti-




                                                                        65
mizer faces the per-period constraint of
                                           Z 1                            Z 1Z 1                                            Z 1
                                                  i        i,o
                                                 PH,t ( j)CH,t ( j)dj +             Ptk ( j)Ck,t
                                                                                             i
                                                                                                 ( j)dkdj +    i
                                                                                                              Di,t +1   +          i
                                                                                                                                  Dk,t +1 dk
                                            0                              0    0                                            0
                                                                                                                                         (45)
                                      Z 1
                                                     cap,i                            1               cap,i,o
 ≤ Wti Nti,o + (1 + iti −1 ) Di,t
                              i
                                  +                               i
                                            (1 + τt−1 )(1 + i∗ ) Dk,t dk +               Pi Zi + Pti Tt       + Pti Tti,o + Pti Tti
                                       0                                            1 − χ t H,t

In this expression, Dk,ti                                                         i
                          +1 is country i’s holdings of country k bonds, Di,t+1 is country i’s holdings
of country i bonds, Pti is the domestic consumer price index, Wti is the domestic wage, PH,t      i ( j ) is the

price of variety j of the home good in country i, Ptk ( j) is the price of variety j of the good of country
k. Besides labor income and income on bond holdings, the budget constraint of optimizers features
                                                           i
three additional sources of transfers. We denote by Pti ZH,t       i Y i − W i N i nominal domestic profits,
                                                               = PH,t  t      t t
         i is the price of the home good in country i. Note that optimizers receive all the profits in
where PH,t
the economy.
    We now turn to the policy instruments that show up in the budget constraint. Tti,o is the real trans-
fer each optimizer in country i receives from the domestic government. Tti denotes the transfer that
each optimizer receives from the fiscal union. Note that for convenience, we adopt the convention
that international transfers are paid to optimizers and then passed through to HtM consumers via
government taxes and transfers. We could equivalently have specified that international transfers are
paid to the government and then distributed to optimizers and HtM consumers. Finally iti −1 is the in-
terest rate in country i and i∗ in the rest of the currency union with β(1 + i∗ ) = 1. These can be differ-
                                                                             cap,i
ent because of capital controls in the form of taxes on capital inflows τt−1 in country i. We rebate the
                                                                          cap,i,o      R 1 cap,i           i dk,
proceeds from the capital controls lump sum to optimizers using Tt                  = − 0 τt−1 (1 + i∗ ) Dk,t
and from now on, we omit these flows from the government budget constraint.
    The HtM budget constraint given by

                                                    Pti Cti,r = Wti Nti,r + Pti Tti,r .                                                  (46)

   In our baseline model (we relax this later), the government must balance its budget in every
period t, yielding the following government budget constraint

                                            i
                                           PH,t Gti + χPti Tti,r + (1 − χ) Pti Tti,o = 0,

where Gti are real government purchases of domestic goods.
    We impose that the lump sum transfers to optimizers Tti,o and to hand-to-mouth agents Tti,r are
such that after these transfers: (i) each agent receives and equal share of domestic profits Pti ZH,t      i

in every period; (ii) each agent receives and equal share of the international transfer Pti Tti in every
period; (iii) each agent contributes equally towards the financing of domestic government spending
  i G i in every period.
PH,t  t
    For convenience, we introduce a separate notation, τti,o and τti,r , for the part of these transfers that


                                                                   66
ensures equal distribution of profits across agents as described in point (i) above:

                                                           Tti,r − τti,r = ZH,t
                                                                            i
                                                                                ,                                                         (47)

                                                      Tti,o − τti,o = −
                                                                                    χ
                                                                                       Zi .                                               (48)
                                                                                  1 − χ H,t
The government budget constraint can then equivalently be restated as

                                           i
                                          PH,t Gti + χPti τti,r + (1 − χ) Pti τti,o = 0.                                                  (49)

    We denote the net present value of international transfers Pti Tti discounted as the union interest
rate i∗ = β−1 − 1 in units of the initial domestic price index, P0i , which is the same thing as the price
index for imports in country i, PFi , in every period:53

                                           ∞                      ∞                ∞
                                                      Pti Tti             i i
                                                                       t Pt Tt
                                NFA0i =   ∑      βt
                                                       P0i
                                                              = ∑ Pi β         = ∑ βt (Sti )−(1−α) Tti .
                                          t =0                  t =0        F    t =0

Points (ii) and (iii) above imply that

                                                                 ∞
                                                 NFA0i =       ∑ βt [τti,r + (Sti )−α Gti ].                                              (50)
                                                               t =0

   In equilibrium, NFA0 is equal to the net present value of trade balances, as required by the current
account identity. Net exports are given by

                                                 NXti = PH,t
                                                         i
                                                             Yti − Pti Cti − PH,t
                                                                              i
                                                                                  Gti .                                                   (51)

Therefore, we have
                                   ∞                       ∞
                                         NX i
                                                                                                                                 
                    NFA0i   =   − ∑    βt i t
                                         PF
                                                  =−∑β               t
                                                                             (Sti )−1 Yti   − (Sti )−(1−α) Cti   − (Sti )−1 Gti       .   (52)
                                  t =0                    t =0


D.1.3      Firms

Our descriptions of firms here is identical to that in the body of the paper. Firms produce differenti-
ated goods with a linear technology given by

                                                           Yti ( j) = Ait Nti ( j),                                                       (53)

where Ait is the productivity in the home country. To offset the monopoly distortion, we introduce a
constant employment tax 1 + τ L so that the real marginal cost deflated by the home producer price
index is given by
                                                1 + τ L Wti
                                         MCti =              .                                  (54)
                                                   Ait PH,t
                                                         i

 53 In   the absence of transfers we simply have NFA0i = Tti = 0 and τti,r = τti,o = −(Sti )−α Gti .

                                                                             67
This employment tax is set cooperatively at a symmetric steady state with flexible prices. As we
show later, this implies that τ L = − 1e or e−e 1 (1 + τ L ) = 1.
   As in the main paper, we assume that the Law of One Price holds at all times and maintain
Producer Currency Pricing. Our price setting assumptions here are also analogous to those in the
paper, except that we now use continuous time. As a result, we can write the supply side equilibrium
conditions of the model as
                                                          e −1
                      1 − δ(ΠiH,t )e−1             Fti
                                               
                                         =
                           1−δ                     Kti
                                                 e 1 + τL i i φ
                                   Kti =                 Yt ( Nt ) + βδ(ΠiH,t+1 )e Kti +1
                                               e − 1 Ait
                                               Yti Qit
                                    Fti =              + βδ(ΠiH,t+1 )e Fti+1
                                               Cti Sti
                                                 i
                                                PH,t
                                 ΠiH,t =        i
                                                           .
                                               PH,t −1


D.1.4   Terms of trade, Exchange rates, and UIP

We briefly restate here our conventions about price indices and exchange rates from the body of the
paper.
   We can write the consumer price index (CPI) as

                                                                                                     1−1 η
                               Pti = (1 − α)( PH,t
                                               i
                                                   )1−η + α( PFi )1−η                                          ,      (55)


and the home producer price index (PPI) as

                                                    Z         1
                                                                                       1−1 e
                                      i
                                     PH,t      =                    i
                                                                   PH,t ( j)1−e dj               .
                                                           0


The import price index is given by

                                                    Z         1
                                                                                    1−1 γ
                                         PFi   =                   ( Pki )1−γ dk             ,
                                                           0

            R1              1
with Pki = 0 Pki ( j)1−e dj 1−e denoting country i’s PPI.
    Under the Law of One Price, we have PH,t  i     k where Pk is country k’s domestic PPI in terms
                                                = PH,t        H,t
                                                            1            1
                                                               k )1−γ dk 1−γ , is the world price index.
of country k’s currency. Therefore, PFi = P∗ , where P∗ = 0 ( PH
                                                          R
                                                                          PFi
As is standard, we define the terms of trade by Sti =                      i ,
                                                                         PH,t
                                                                                 which allows us to write the home CPI as

                                                                                         1−1 η
                                    Pti = PH,t
                                           i
                                               1 − α + α(Sti )1−η                                    .


                                                                    68
                                                                       Pk
The real exchange rate with country k is given by Qik,t =              Pti
                                                                                 where Pk is country k’s CPI. The effective
                                        P∗
real exchange rate is therefore Qit =   Pti
                                            .
   The UIP condition is

                                                             cap,i
                                        1 + iti = (1 + τt            )(1 + i∗ ).

We define the Pareto weights Θit by
                                                 Cti,o = Θit C ∗,o Qit .

The UIP condition implies a direct mapping between capital controls and these Pareto weights

                                                Θit+1                cap,i
                                                        = 1 + τt             .
                                                 Θit

From now on, we simply describe capital controls in terms of the Pareto weights Θit .


D.1.5   Steady State

We postulate a symmetric steady state such that all countries i ∈ [0, 1] within the monetary union
are symmetric so that Si = Θi = 1 and for simplicity set Ai = Ak = A∗ = 1 . The social planner sets
the labor tax τ L so that the steady state allocation is efficient. In particular, the centralized problem
to pin down the efficient steady state allocation can be written as

                                                              χ                 1 − χ i,o 1+φ
  max(1 − χ)(1 − υ) ln(Ci,o ) + χ(1 − υ) ln(Ci,r ) −             ( N i,r )1+φ −      (N )     + υ ln( Gi ), (56)
                                                             1+φ                1+φ

subject to technology and resource constraints

                                          Yi = N i
                                          Yi = Ci + Gi
                                          Ci = χCi,r + (1 − χ)Ci,o
                                         N i = χN i,r + (1 − χ) N i,o .

The first-order conditions with respect to Ci,o , Ci,r , N i,o and N i,r immediately imply that agents should
be symmetric. That is, the efficient steady state is characterized by Ci,o = Ci,r = Ci and N i,o = N i,r =
N i . The remaining first-order conditions can be rearranged so that

                                                (1 − υ) Gi = υCi
                                                               1−υ
                                                    ( N i )φ =     .
                                                                Ci




                                                          69
The first of these, together with the resource constraint, implies that

                                                          Gi                  Ci
                                                    υ=       ,     1−υ =         .                                     (57)
                                                          Yi                  Yi

The second, using the technology constraint, yields

                                                       N i = 1,        Y i = 1.                                        (58)

    It is straightforward to show, as in Gali-Monacelli (2008) for example, that the efficient steady
state can be decentralized with an employment tax that solves e−e 1 (1 + τ L ) = 1, which implies
τ L = − 1e .
           i
    Let ZH,t  denote profits of domestic firms, defined as

                                                   Pti ZH,t
                                                        i      i
                                                            = PH,t Yti − Wti Nti .

In steady state, we have

                        i                         1                                          1
                       ZH = ( Si )−α Y i −           Ci,o ( N i,o )φ N i = Y i − (1 − υ)Y i     = 0,                   (59)
                                                 1−υ                                        1−υ

where the second line follows by setting Si = 1 and N i,o = N i = 1.
   It follows from our discussion in the previous subsection that in steady state, when trade is bal-
anced and there are no transfers, we have

                                               τ i,r = τ i,o = −(Si )−α Gi = −υY i                                     (60)

which is consistent with the government budget constraint. This furthermore implies that

                                                               1
                                            T i,r = T i,o +      Zi = T i,o = −υY i .                                  (61)
                                                              1−χ H

D.1.6    Linearized Equilibrium

As in the baseline model of Sections(4)-(5) and for the same reasons, we move to continuous time.
   Notation. We begin by defining some useful notation. For all variables Xt , we drop the time
subscript to denote the steady state by X. For Xt ∈ { Tti,o , Tti,r , τti,o , τti,r , NFA0i , NXti }, we define xt =
Xt − X and x̃t = X̃t − X, where X̃t denotes the natural allocation.54 For all other variables, we define
xt = ln( Xt ) − ln( X ) and x̃t = ln( X̃t ) − ln( X ).
   Furthermore, it will be convenient to work with the allocation in gaps from the natural allocation.
To that end, we define for all variables x̂t = xt − x̃t . We will furthermore normalize our allocation
by writing it in gaps from union aggregates. For all country i variables, we let x̄ˆ ti = x̂ti − x̂t∗ , where
  54 We will abuse notation and let τ i,o
                                       and τti,r refer to both the level of rebates and the normalized deviation from steady
                                     t
state. Throughout, it will be obvious which of the two we refer to.


                                                                  70
       R1
x̂t∗ = 0 x̂ti di is the union aggregate of the log-linearized variable xti in gaps from the natural.55
     Finally since inflation under flexible prices is not well defined, we define π̂ i = π i and π̄ˆ i =
π i − π ∗ for both PPI and CPI inflation.

    Labor supply. We start with the households’ labor supply condition,

                                              Wti
                                       (1 − υ) i = Cti,o ( Nti,o )φ = Cti,r ( Nti,r )φ .                                 (62)
                                              Pt

Linearizing, we have
                                         wit − pit = ci,o   i,o  i,r   i,r
                                                      t + φnt = ct + φnt .                                               (63)

Therefore, we have

                                    (Natural)                              c̃i,o     i,o   i,r     i,r
                                                                             t + φ ñt = c̃t + φ ñt
                       (Gaps from natural)                                 ĉi,o     i,o   i,r     i,r
                                                                             t + φ n̂t = ĉt + φ n̂t
                         (Gaps from union)                                 c̄ˆi,o   ˆ i,o  ˆi,r   ˆ i,r
                                                                              t + φ n̄t = c̄t + φ n̄t .


Backus-Smith. We have

                                                     Cti,o = Θit Ct∗,o Qit ,                                             (64)

where Qit = (Sti )1−α .56 Linearizing, we have

                                                           ∗,o
                                              ci,o   i                    i
                                               t = θ t + c t + (1 − α ) s t .                                            (65)

Therefore, we have

                                    (Natural)                            c̃i,o   i              i
                                                                           t = θ̃t + (1 − α ) s̃t
                                                                                       ∗,o
                      (Gaps from natural)                                ĉi,o    i                   i
                                                                            t = θ̂t + ct + (1 − α ) ŝt
                        (Gaps from union)                                c̄ˆi,o  ˆi            ˆi
                                                                            t = θ̄t + (1 − α ) s̄t .


Aggregation. We have

                                                 cit = χci,r            i,o
                                                         t + (1 − χ ) c t                                                (66)

and
                                                nit = χni,r            i,o
                                                        t + (1 − χ ) n t .                                               (67)

Production. We have
  55 We
                                                                         R1
          note here that under idiosyncratic shocks, we will have x̃t∗ = 0 x̃ti di = 0 for all natural variables. That is, any
idiosyncratic shock to measure-0 country i will not affect the union’s natural allocation.
  56 C ∗,o =
              R 1 i,o
      t        0 Ct di denotes the union aggregate of optimizers’ consumption. For double-superscripts (country and
agent type), we write the country index (i or ∗) first, followed by the agent index (o or r).




                                                              71
                                                      Yti = Ait Nti .                                          (68)

Linearizing, we have
                                                      yit = ait + nit .                                        (69)

Therefore, we have

                                       (Natural)                                        ỹit = ait + ñit
                           (Gaps from natural)                                          ŷit = n̂it
                             (Gaps from union)                                          ȳˆit = n̄ˆ it .

HtM budget constraint. We have


                                             Pti Tti,r + Wti Nti,r = Pti Cti,r ,                               (70)

or
                                                   1
                                        Tti,r +       Cti,r ( Nti,r )1+φ = Cti,r ,                             (71)
                                                  1−υ
Linearizing, we have
                                     T i,r
                                        i
                                           + ti,r           i,r   i,r
                                              t + (1 + φ ) nt + υct + υ = 0,                                   (72)
                                     Y
            T i,r
and since   Yi
                    = −υ, we have
                                           ti,r           i,r   i,r
                                            t + (1 + φ ) nt + υct = 0.                                         (73)

Therefore, we have

                                 (Natural)                            t̃i,r            i,r     i,r
                                                                        t + (1 + φ ) ñt + υ c̃t = 0
                       (Gaps from natural)                            t̂i,r             i,r     i,r
                                                                         t + (1 + φ ) n̂t + υ ĉt = 0
                        (Gaps from union)                             t̄ˆi,r          ˆ i,r    ˆi,r
                                                                         t + (1 + φ ) n̄t + υ c̄t = 0.


Aggregate demand. We have

                                                                             Z 1 j j
                                                             Cti,o (Sti )α      Θt Ct
                              Yti = (1 − α)Cti (Sti )α + α                            dj + Gi .            t   (74)
                                                                  Θit         0     j,o
                                                                                   Ct

Linearizing, we have

                          1
                             yit = (1 − α) θti + cit + c∗t ,o − ci,o
                                                                                       υ
                                                                       + sit + αc∗t +    gi .                  (75)
                                                                     
                         1−υ                                     t
                                                                                      1−υ t




                                                            72
Therefore, we have

                                       1
                                          ỹit = s̃it + (1 − α) θ̃ti + c̃it − c̃i,o
                                                                                              υ
                 (Natural)                                                                       g̃i
                                                                                         
                                                                                           +
                                      1−υ                                            t
                                                                                             1−υ t
                                       1
                                          ŷit = ŝit + αc∗t + (1 − α) θ̂ti + ĉit + c∗t ,o − ĉi,o
                                                                                                               υ
      (Gaps from natural)                                                                                        ĝi
                                                                                                          
                                                                                                            +
                                      1−υ                                                          t
                                                                                                              1−υ t
                                       1
                                          ȳˆit = s̄ˆit + (1 − α) θ̄ˆti + c̄ˆit − c̄ˆi,o
                                                                                              υ
        (Gaps from union)                                                                        ḡˆ ti .
                                                                                         
                                                                                     t     +
                                      1−υ                                                    1−υ

NFA. Log-linearizing (52), we find

                                    Z ∞                                                                            
                       NFA0i   =−         e   −ρt
                                                        yit   − α(1 − υ)sit               − (1 − υ)cit     − υgti       dt,                             (76)
                                     0

From (76), we have
                                                          Z ∞                                                                             
                (Natural)            ˜ 0i
                                    NFA        =−                  e   −ρt
                                                                                 ỹit    − α(1 − υ)s̃it    − (1 − υ)c̃it      − υ g̃ti         dt = 0
                                                              0
                                                          Z ∞                                                                             
      (Gaps from natural)            ˆ 0i = −
                                    NFA                            e   −ρt
                                                                                 ŷit    − α(1 − υ)ŝit    − (1 − υ)ĉit      − υ ĝti         dt
                                                              0
                                                          Z ∞                                                                             
       (Gaps from union)             ˆ¯ i
                                    NFA        =−                  e   −ρt
                                                                                 ȳˆit   − α(1 − υ)s̄ˆit   − (1 − υ)c̄ˆit     − υ ḡˆ ti       dt.
                                        0
                                                              0


Transfer conversion. We have

                                                                                              1
                       τti,r = Tti,r − ZH,t
                                        i
                                            = Tti,r − Yti (Sti )−α +                            Ci,o ( Nti,o )φ Nti .                                   (77)
                                                                                             1−υ t

Linearizing, we have
                                 τti,r = ti,r   y i      i
                                                             c i,o      i,o
                                                                              n i
                                                                                    .                                                                   (78)
                                                                                  
                                          t   −   t − αs t −   t   − φn t   −   t

Therefore, we have

                         (Natural)                                τ̃ti,r = t̃i,r   i       i     i,o     i,o   i
                                                                             t − ỹt − α s̃t − c̃t − φ ñt − ñt
                                                                                                                                      

             (Gaps from natural)                                  τ̂ti,r = t̂i,r     ŷ i
                                                                                              ŝ i
                                                                                                     ĉ i,o
                                                                                                                n̂ i,o
                                                                                                                         n̂ i
                                                                                                                              
                                                                               t   −    t − α    t −    t   − φ    t   −    t

              (Gaps from union)                                   ˆτ̄ti,r = t̄ˆi,r    ˆ
                                                                                     ȳ i     ˆ
                                                                                              s̄ i    ˆ
                                                                                                     c̄ i,o     ˆ
                                                                                                                n̄ i,o   ˆ
                                                                                                                         n̄ i
                                                                                                                            t .
                                                                                                                              
                                                                               t   −    t − α    t −    t   − φ    t   −

Similar conditions hold for τti,o .
Government budget constraint. We have


                                        i
                                   0 = PH,t Gti + χPti τti,r + (1 − χ) Pti τti,o ,                                                                      (79)

which we can linearize as
                                      αυsit = χτti,r + (1 − χ)τti,o + υgti .                                                                            (80)


                                                                       73
Therefore, we have

                            (Natural)                       αυs̃it = χτ̃ti,r + (1 − χ)τ̃ti,o + υ g̃ti
                  (Gaps from natural)                       αυŝit = χτ̂ti,r + (1 − χ)τ̂ti,o + υ ĝti
                   (Gaps from union)                        αυs̄ˆit = χτ̄ˆti,r + (1 − χ)τ̄ˆti,o + υ ḡˆ ti .

Symmetric fiscal union transfers. We want to rebate the transfers received by optimizers from the

union to HtM agents so that each agent receives the same amount. This condition is given by
                                             Z ∞
                                 NFA0i =           e−ρt [τti,r + (Sti )−α Gti ]dt.                                   (81)
                                              0

Linearizing yields                          Z ∞
                                NFA0i   =         e−ρt [τti,r + υgti − υαsit ]dt.                                    (82)
                                             0
This implies
                                                                Z ∞
                         (Natural)                  ˜ 0i =
                                                   NFA                 e−ρt [τ̃ti,r + υ g̃ti − υαs̃it ]dt = 0
                                                                Z0 ∞
               (Gaps from natural)                  ˆ 0i
                                                   NFA      =          e−ρt [τ̂ti,r + υ ĝti − υαŝit ]dt = 0
                                                                Z0 ∞
                (Gaps from union)                   ˆ¯ i =
                                                   NFA                 e−ρt [τ̄ˆti,r + υ ḡˆ ti − υαs̄ˆit ]dt = 0.
                                                       0
                                                                 0

Supply side with flexible prices. Under the natural, the supply side simplifies to the single equation


                                        ỹit = c̃it + αs̃it + (1 + φ)ñit .                                          (83)

Supply side with sticky prices. Let λ = ρδ (ρ + ρδ ), where ρδ is the arrival rate of price changes.

Using the supply-side equilibrium conditions in continuous time, we can write the Phillips Curve as
                                                                                                      
                 (Gaps from natural)                      ˙   i          i            i      i
                                                         π̂ H,t = ρπ̂ H,t − λ φn̂t + ĉt + αŝt      i

                                                                                                      
                  (Gaps from union)                      π̄ˆ˙ H,t = ρπ̄ˆ H,t − λ φn̄ˆ t + c̄ˆt + αs̄ˆt .
                                                              i          i            i      i       i




D.2    Allocations Given Exogenous Policies
We begin this section by characterizing and solving for the natural allocation. We then summarize
the allocation with policy in gaps from the natural, which will be our exclusive focus for all sub-
sequent analysis. Furthermore, we derive the (IS) and (NKPC) equations, an initial condition with
which we can solve the dynamical system later on, as well as country i’s generalized budget con-
straint. Finally, we solve analytically the allocation under sticky prices but without policy, which we

                                                       74
will later use for several of our numerical exercises.


D.2.1   Natural Allocation

We define the natural as the allocation with flexible prices and with passive policy. As discussed
in the main text, we allow government spending and taxes to move with the technology shock to
ensure that the flexible price allocation is efficient. At the natural allocation, taxes are uniform across
agents and the government budget is balanced in every period. This implies g̃ti = ait and θ̃ti = θ̃ i
for all i. Furthermore, there are no fiscal union transfers so that NFA    ˜ 0i = 0. This implies that τ̃ i,r
                                                                                                         t
and τ̃ti,o merely denote tax rebates that are equally imposed on both agents to balance the per-period
government budget constraint. We note here again that under idiosyncratic shocks to any measure-0
country i, the union-wide natural allocation remains unaffected and x̃t∗ = 0 for all variables x̃t .
    The natural allocation is given by the system of equations

                                       ỹit = ait + ñit                                                (84)
                                        c̃it = χc̃i,r            i,o
                                                  t + (1 − χ ) c̃t                                      (85)
                                       ñit = χñi,r            i,o
                                                 t + (1 − χ ) ñt                                       (86)
                           c̃i,o     i,o   i,r     i,r
                             t + φ ñt = c̃t + φ ñt                                                    (87)
                                      c̃i,o
                                        t     = θ̃ti + (1 − α)s̃it                                      (88)
                                         0 = t̃i,r            i,r     i,r
                                               t + (1 + φ ) ñt + υ c̃t                                 (89)
                                1
                                   ỹit = s̃it + (1 − α) θ̃ti + c̃it − c̃i,o
                                                                                  υ
                                                                                     g̃ti               (90)
                                                                             
                                                                         t     +
                               1−υ                                               1−υ
                                     i       i     i                i
                                   ỹt = c̃t + αs̃t + (1 + φ)ñt                                        (91)

as well as the following conditions for transfers and the NFA

                        αυs̃it = χτ̃ti,r + (1 − χ)τ̃ti,o + υ g̃ti                                       (92)
                                                                                  
                           i,o    i,o        χ          i      i    i,o    i,o   i
                         τ̃t = t̃t +                  ỹ − αs̃t − c̃t − φñt − ñt                      (93)
                                          1−χ t
                                                                            
                            i,r   i,r         i         i   i,o        i,o i
                         τ̃t = t̃t − ỹt − αs̃t − c̃t − φñt − ñt                                      (94)
                                     Z ∞                                                  
                                             −ρt      i                 i        i       i
                             0=−           e        ỹt − α(1 − υ)s̃t − (1 − υ)c̃t − υ g̃t dt           (95)
                                       0
                                 Z ∞                                  
                                          −ρt     i,r      i         i
                             0=         e       τ̃t + υ g̃t − αυs̃t dt = 0.                             (96)
                                  0


   We highlight two important features of the natural allocation: First, for any level of steady state
government spending υ ∈ [0, 1], the natural allocation is χ-invariant and θ̃ i = 0. Second, for any
level of steady state government spending υ ∈ [0, 1] and for any share of hand-to-mouth agents
χ ∈ [0, 1], the natural allocation is symmetric, with ñi,r   i,o     i,r   i,o
                                                        t = ñt and c̃t = c̃t for all t.



                                                              75
     We will now solve the natural allocation in closed form. We use g̃ti = ait . Solving out for θ̃ti ,
ñit = ỹit − ait , c̃it = χc̃i,r            i,o       i,o   i              i
                              t + (1 − χ ) c̃t , and c̃t = θ̃t + (1 − α ) s̃t , we find


                                          ỹit − ait = χñi,r            i,o
                                                          t + (1 − χ ) ñt
                              φñi,o            i     i,r     i,r
                                 t + (1 − α ) s̃t = c̃t + φ ñt
                    αυs̃it + (1 + φ)ñi,r     i,r     i     i,o
                                      t + υ c̃t = s̃t + φ ñt − (1 − υ ) at
                                                                            i

                                          1
                                              ỹit = [1 − χ(1 − α)2 ]s̃it + χ(1 − α)c̃i,r
                                                                                                  υ i
                                                                                        t +         a
                                        1−υ                                                   1−υ t
                                     (1 + φ) ait = χc̃i,r                             i       i
                                                        t + [(1 − χ )(1 − α ) + α ] s̃t + φ ỹt .


From here, we can solve for c̃i,r     i,r
                              t and ñt , yielding

                                                                         (1 − α)(1 − χ) − (1 − υ)αφ i
            c̃i,r
                             φ                        υφ
              t =                       ỹit −                    ait +                            s̃t
                     1 − χ + (1 − υ ) φ        1 − χ + (1 − υ ) φ             1 − χ + (1 − υ ) φ
                         (1 − υ ) φ            (1 − υ)(1 − χ + φ) i         (1 − χ)(1 − υ) i
           ñi,r   =                    ỹit −                        at +                   s̃ .
             t
                     1 − χ + (1 − υ ) φ         1 − χ + (1 − υ ) φ         1 − χ + (1 − υ ) φ t

Plugging these into the aggregate demand relation, we can solve for the terms of trade and find that
s̃it = 1−1 υ ỹit − 1−υ υ ait . Using these to solve for the output gap, finally, we find

                                                             ỹit = ait ,                                  (97)

and similarly
                                                             s̃it = ait .                                  (98)

Solving the remainder of the allocation is straightforward using these two results. Finally, we note
here that

                                                       s̃˙ it = − ṗiH,t
                                                          = −ψe−ψt a0i .                                   (99)

We will make use of this result later on.


D.2.2   Allocation with Policy

We now present the allocation in terms of gaps from the natural. Recall that x̄ˆ ti = ln( Xti ) − ln( X̃ti ) for
all variables Xti , where X̃ti denotes the natural allocation.
    The linear model with policy is given by

                         c̄ˆi,o   ˆ i,o    ˆi,r
                            t + φ n̄t = c̄t + φ n̄t
                                                   ˆ i,r                                                  (100)
                                   c̄ˆi,o  ˆi            ˆi
                                      t = θ̄t + (1 − α ) s̄t                                              (101)
                                    c̄ˆit = χc̄ˆi,r           ˆi,o
                                                t + (1 − χ ) c̄t                                          (102)


                                                                 76
                                     n̄ˆ it = χn̄ˆ i,r          ˆ i,o
                                                   t + (1 − χ ) n̄t                                                  (103)
                                       ȳˆit = n̄ˆ it                                                                (104)
                                    t̄ˆi,r            ˆ i,r   ˆi,r
                                       t = −(1 + φ ) n̄t − υ c̄t                                                     (105)
                              1
                                   ȳˆit = s̄ˆit + (1 − α) θ̄ˆti + c̄ˆit − c̄ˆi,o
                                                                                          υ
                                                                                                ḡˆ i                (106)
                                                                                  
                                                                                     +
                             1−υ                                              t
                                                                                        1−υ t
                                τ̄ˆti,r = t̄ˆi,r      ˆ
                                                     ȳ i     ˆ
                                                              s̄ i    ˆ
                                                                     c̄ i,o      ˆ
                                                                                n̄ i,o   ˆ
                                                                                         n̄ i
                                                                                                                     (107)
                                                                                              
                                              t  −      t − α    t −    t   − φ    t   −    t

                                αυs̄ˆit = χτ̄ˆti,r + (1 − χ)τ̄ˆti,o + υ ḡˆ ti                                       (108)
                                          Z ∞
                                 ˆ¯ i =
                               NFA                e−ρt τ̄ˆti,r + υ ḡˆ ti − υαs̄ˆit dt
                                                                                  
                                                                                                                     (109)
                                     0
                                                 0
                                                     Z ∞
                                ˆ¯ i = −
                               NFA                      e−ρt ȳˆit − α(1 − υ)s̄ˆit − (1 − υ)c̄ˆit − υ ḡˆ ti dt
                                                                                                           
                                                                                                                     (110)
                                   0
                                                      0
                                                                                 
                                 π̄ˆ˙ iH,t          i              i    i       i
                                             = ρπ̄ˆ H,t − λ φn̄ˆ t + c̄ˆt + αs̄ˆt                                    (111)

                                     πti = π iH,t + αṡit                                                            (112)
                                    ċi,o
                                      t      = iti − πti − ρ.                                                        (113)

                                                 R1
Note that for all variables we have 0 x̃ti di = 0, so that x̄˜ ti = x̃ti . We used this simplification above.
    We furthermore need an initial value condition to close the system and pin down the solution of
this first-order linear system of ODEs. We will derive the initial condition below.
    Before doing so, it will be convenient to solve this system in terms of ȳˆit , τ̄ˆti,r , θ̄ˆti and ḡˆ ti . We start
by solving out for n̄ˆ it , c̄ˆit , and c̄ˆi,o
                                           t . This yields


         θ̄ˆti + (1 − α)s̄ˆit + φn̄ˆ i,o  ˆi,r   ˆ i,r
                                     t = c̄t + φ n̄t
                                     ȳˆit = χn̄ˆ i,r          ˆ i,o
                                                  t + (1 − χ ) n̄t
                                  t̄ˆi,r                ˆ i,r
                                     t = −(1 + φ ) n̄t − υ c̄t
                                                                   ˆi,r
                            1
                                 ȳˆit = (1 − α)(1 − χ)θ̄ˆti + χ(1 − α)c̄ˆi,r                2 ˆi      υ
                                                                          t + [1 − χ (1 − α ) ] s̄t +    ḡˆ i
                           1−υ                                                                        1−υ t
                              t̄ˆi,r     ˆ i,r ˆi    ˆi ˆi,o       ˆ i,o ˆ i
                                 t = τ̄t + ȳt − α s̄t − c̄t − φ n̄t − n̄t .


   Next, we solve out for t̄ˆi,r                                                       ˆ i,o
                              t using the last equation in the previous block, and for n̄t =
                                                                                                                   1 ˆi
                                                                                                                  1−χ ȳt   −
 χ ˆ i,r
1−χ n̄t . We are interested in the following two equations,


                                                           θ̄ˆti + (1 − α)s̄ˆit +ȳˆit = c̄ˆi,r         n̄ˆ i,r
                                                                           φ                          φ
                                                                                            t +
                                                                         1−χ                         1−χ t
                        τ̄ˆti,r − s̄ˆit − θ̄ˆti −                            )n̄ˆ i,r           ˆi,r
                                                   φ                    χφ
                                                      ȳˆit + (1 + φ +            t = − υ c̄t ,
                                                  1−χ                  1−χ

which we can now use to solve for c̄ˆi,r   ˆ i,r
                                     t and n̄t . In particular, this yields

                             1−χ
                                                                                                    
             n̄ˆ i,r                        (1 − υ )
                                                      φ
                                                         ˆ i         ˆ i                ˆ i    ˆ
                                                        ȳ + (1 − υ)θ̄t + [1 − υ(1 − α)]s̄t − τ̄ti,r
                                                                                                                     (114)
                 t =
                       1 − χ + (1 − υ ) φ            1−χ t


                                                                        77
and
                                        1
                                                                                                              
                      c̄ˆi,r   =                              ˆ i      i                           i       i,r
                                                      (1 − χ)θ̄t + φȳˆt + [(1 − α)(1 − χ) − αφ]s̄ˆt + φτ̄ˆt .          (115)
                         t
                                 1 − χ + (1 − υ ) φ
Finally, we use the linearized aggregate demand relation to solve for s̄ˆit . We find
                                                                −1 
                                          (1 − υ)φ + αυφ                 1         (1 − α)χφ
                                                                                                  
                                                                                                              υ
        s̄ˆit   = 1 − (1 − α ) χ                                             −                       ȳˆit −    ḡˆ i   (116)
                                         1 − χ + (1 − υ ) φ            1 − υ 1 − χ + (1 − υ ) φ              1−υ t
                                                   1 + φ − υφ              (1 − α)χφ
                                                                                                 
                 − (1 − α)(1 − χ)                                  ˆ i
                                                                  θ̄ −                   τ̄ˆ i,r
                                                1 − χ + (1 − υ ) φ t 1 − χ + (1 − υ ) φ t
                ≡νy ȳˆit + νg ḡˆ ti + νθ θ̄ˆti + ντ τ̄ˆti,r .                                                         (117)

Therefore, we can for the future introduce the following notation

                                                    c̄ˆi,r       ˆi       ˆi         ˆ i,r       ˆi                     (118)
                                                       t = ψy ȳt + ψθ θ̄t + ψτ τ̄t + ψg ḡt
                                                   n̄ˆ i,r = η ȳˆi + η ḡˆ i + η θ̄ˆi + η τ̄ˆ i,r
                                                    t            y t           g t        θ t            τ t            (119)
                                                     c̄ˆit =   ζ y ȳˆit          ˆ
                                                                           + ζ θ θ̄t + ζ τ τ̄ˆti,r
                                                                                    i
                                                                                                     + ζ g ḡˆ ti       (120)

where

                                                                              (1 − υ)φ + αυφ
                                                                                               
                                                    φ
                                      ψy =                      + 1−α−                            νy
                                             1 − χ + (1 − υ ) φ              1 − χ + (1 − υ ) φ
                                                   1−χ                        (1 − υ)φ + αυφ
                                                                                               
                                      ψθ =                      + 1−α−                            ν
                                             1 − χ + (1 − υ ) φ              1 − χ + (1 − υ ) φ θ
                                                                              (1 − υ)φ + αυφ
                                                                                               
                                                    φ
                                      ψτ =                      + 1−α−                            ντ
                                             1 − χ + (1 − υ ) φ              1 − χ + (1 − υ ) φ
                                                       (1 − υ)φ + αυφ
                                                                        
                                      ψg =     1−α−                        νg
                                                      1 − χ + (1 − υ ) φ



and

                                                   1−χ
                                                                                                  
                                                                            φ
                                     ηy =                         (1 − υ )      + [1 − υ(1 − α)]νy
                                             1 − χ + (1 − υ ) φ            1−χ
                                                   1−χ
                                     ηg =                       [1 − υ(1 − α)]νg
                                             1 − χ + (1 − υ ) φ
                                                   1−χ
                                                                                          
                                     ηθ =                         1 − υ + [1 − υ(1 − α)]νθ
                                             1 − χ + (1 − υ ) φ
                                                   1−χ
                                                                                        
                                     ητ =                         − 1 + [1 − υ(1 − α)]ντ ,
                                             1 − χ + (1 − υ ) φ

and

                                                  ζ y = χψy + (1 − χ)(1 − α)νy

                                                                                  78
                                           ζ g = χψg + (1 − χ)(1 − α)νg
                                           ζ τ = χψτ + (1 − χ)(1 − α)ντ
                                           ζ θ = χψθ + (1 − χ)[1 + (1 − α)νθ ].


D.2.3    IS equation

We start from the linearized aggregate demand equation and use slightly more convenient notation
to write
                                Λy ȳˆit = Λs s̄ˆit + Λ g ḡˆ ti + Λθ θ̄ˆti + Λτ τ̄ˆti,r , (121)

where

                                                     1           (1 − α)χφ
                                         Λy =             −
                                                   1 − υ 1 − χ + (1 − υ ) φ
                                                                   (1 − υ)φ + αυφ
                                         Λs      = 1 − (1 − α ) χ
                                                                  1 − χ + (1 − υ ) φ
                                                                        1 + φ − υφ
                                         Λθ      = (1 − α)(1 − χ)
                                                                    1 − χ + (1 − υ ) φ
                                                     υ
                                         Λg      =
                                                   1−υ
                                                       (1 − α)χφ
                                        Λτ       =                     ,
                                                   1 − χ + (1 − υ ) φ

                                                                      Λ                     Λ
and where we have the easy conversions: νy = Λys , νg = − Λgs ,νθ = − Λ                                       Λτ
                                                                                              Λs , and ντ = − Λs . Differenti-
                                                                                               θ


ating, we have
                                                                          ˙
                             Λy ȳˆ˙ it = Λs s̄ˆ˙ it + Λ g ḡˆ˙ ti + Λθ θ̄ˆti + Λτ τ̄ˆ˙ti,r ,

    To derive the (IS) equation, all that is left to do is to find an expression for s̄ˆ˙ it . From the definition
of the terms of trade, we can directly write

                                                         s̄ˆ˙ it = −(π̄ˆ iH,t + s̃˙ it ).                              (122)

Therefore, the fully general (IS) equation is given by

                                                                                            ˙
                                 Λy ȳˆ˙ it = −Λs (π̄ˆ iH,t + s̃˙ it ) + Λ g ḡˆ˙ ti + Λθ θ̄ˆti + Λτ τ̄ˆ˙ti,r .        (123)


D.2.4    NKPC

We start with the general Phillips Curve
                                                                                                         
                                       π̇ iH,t   =   ρπ iH,t   −λ       φnit   + cit   + αsit   −   ait       .        (124)




                                                                      79
Noting that
                                                                          φñit + c̃it + αs̃it − ait = 0                                            (125)

under the natural allocation, and taking deviations from union aggregates, we can write the NKPC
in gap notation as
                                 π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − λ φn̄ˆ it + c̄ˆit + αs̄ˆit ,        (126)
                                                                                   

Using expressions we derived earlier, we have

        π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − λφȳˆit − λ ζ y ȳˆit + ζ θ θ̄ˆti + ζ τ τ̄ˆti,r + ζ g ḡˆ ti − λα νy ȳˆit + νg ḡˆ ti + νθ θ̄ˆti + ντ τ̄ˆti,r ,
                                                                                                                                             


or, collecting terms,
                                                         π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − κθ θ̄ˆti − κτ τ̄ˆti,r − κ g ḡˆ ti ,                    (127)

where

                                                                           κy = λ(φ + ζ y + ανy )
                                                                           κ g = λ(ζ g + ανg )
                                                                           κτ = λ(ζ τ + αντ )
                                                                           κθ = λ(ζ θ + ανθ ).


D.2.5   Initial Condition

As for the (IS) equation, we start with the linearized aggregate demand relation. We have

                                                            Λy ȳˆ0i = Λs s̄ˆ0i + Λ g ḡˆ0i + Λθ θ̄ˆ0i + Λτ τ̄ˆ0i,r .                               (128)

We can obtain an initial condition for our dynamic system by noting that

                                                                              s0i = s̄ˆit + s̃0i = 0,                                               (129)

implying that s̄ˆit = −s̃0i . Using this, we can write

                                                           Λy ȳˆ0i = −Λs s̃0i + Λ g ḡˆ0i + Λθ θ̄ˆ0i + Λτ τ̄ˆ0i,r .                                (130)


D.2.6   Country-i Budget Constraint
                                                                                  ˆ¯ i , we can write
Finally, it remains to simplify the net foreign asset relations. Solving out for NFA 0
              Z ∞                                                                 Z ∞
                    e   −ρt
                                  τ̄ˆti,r   + υ ḡˆ ti   − υαs̄ˆit       dt = −          e−ρt ȳˆit − α(1 − υ)s̄ˆit − (1 − υ)c̄ˆit − υ ḡˆ ti dt.
                                                                                                                                          
               0                                                                    0




                                                                                          80
   We can simplify to get
              Z ∞                                                                         
         0=          e   −ρt
                                   ȳˆit   + τ̄ˆti,r
                                            − (1 − υ ) χ     + ψθ θ̄t + ψτ τ̄ˆt + ψg ḡˆ t − (1 − υ)(1 − χ)θ̄ˆti
                                                                   ˆ i        i,r
                                                                                    ψy ȳˆit
                                                                                          i
                0
                                                                                                         
                                                                        i          i       ˆ i        i,r
                                    − [α + (1 − υ)(1 − χ)(1 − α)] νy ȳˆt + νg ḡˆ t + νθ θ̄t + ντ τ̄ˆt      dt.


   Collecting terms, we can write
                                                          Z ∞                                                                  
                                                0=                 e   −ρt
                                                                                 Γy ȳˆit   + Γτ τ̄ˆti,r         ˆ i          i
                                                                                                           + Γθ θ̄t + Γ g ḡˆ t dt,   (131)
                                                            0


where

                    Γy = 1 − (1 − υ)χψy − [α + (1 − υ)(1 − χ)(1 − α)]νy
                    Γτ = 1 − (1 − υ)χψτ − [α + (1 − υ)(1 − χ)(1 − α)]ντ
                    Γθ = −(1 − υ)(1 − χ) − (1 − υ)χψθ − [α + (1 − υ)(1 − χ)(1 − α)]νθ
                    Γ g = −(1 − υ)χψg − [α + (1 − υ)(1 − χ)(1 − α)]νg .


D.2.7   Allocation with Sticky Prices

Finally, we will solve the allocation presented above under sticky prices but without optimal policy
intervention. In particular, we have NFA      ˆ¯ i = 0 since there are no international transfers. This implies
                                                 0
        i,r    i,o
that τ̄ˆt = τ̄ˆt = αυs̄ˆt .
                        i

    Furthermore, we set ḡˆ ti = 0 and θ̄ˆti = θ̄ˆi in the absence of government spending policy and capital
controls. Since we also have s̄ˆit = νy ȳˆit + ντ τ̄ˆti,r + νθ θ̄ˆi , we can write

                                                                  τ̄ˆti,r =             (νy ȳˆit + νθ θ̄ˆi )
                                                                                  αυ
                                                                               1 − αυντ
                                                                  τ̄ˆ˙ti,r              νy ȳˆ˙ it .
                                                                                  αυ
                                                                             =
                                                                               1 − αυντ

    This allocation will be important for our numerical exercises where we compare optimal policy
to this no-policy benchmark.

   NFA. The general country i budget constraint simplifies to
                           Z ∞                          
                    0=     e               −ρt       ˆ
                                                     Γy ȳˆit
                                                       i
                                               + Γθ θ̄ dt       + Γτ τ̄ˆti,r                                                          (132)
                        0
                       Z ∞                                                       
                                                                                 ν θ̄ˆi dt.
                                               αυ            i              αυ
                    0=     e −ρt
                                    Γy + Γτ           νy ȳˆ t + Γθ + Γτ                                                              (133)
                        0                   1 − αυντ                     1 − αυντ θ

One can easily verify that Γy + Γτ 1−αυαυντ νy = 0. The budget constraint then directly implies that
θ̄ˆi = 0 for the no-policy allocation.


                                                                                               81
Allocation. The simplified (IS) equation can then be written as


                                                                   ȳˆ˙ it = − G 0 (π̄ˆ iH,t + s̃˙ it ),                                            (134)

                   Λs
where G 0 =   Λy −Λτ 1−αυ
                               .     The (NKPC) becomes
                       αυντ νy



                                                                   π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κ̂y ȳˆit ,                                              (135)


                     αυντ νy . And finally, the initial condition can be written as
with κ̂y = κy + κτ 1−αυ

                                                                             ȳˆ0i = − Ḡ 0 s̃0i                                                    (136)

with Ḡ 0 = Λs +ΛαυΛ
                  y
                     τ
                       .
We can write the dynamical system describing the no-policy allocation as

                                                                        Ẋti = AXti + Bti ,                                                         (137)

where
                                                                                                                              π̄ˆ iH,0
                                                          !                                              !                                  !
                                      ρ   −κ̂y                                              0
                       A=                                      ,             Bti =                           ,    X0i =                         ,
                                     −G 0  0                                              − G 0 s̃˙ it                        − Ḡ 0 s̃0i

We will solve for π̄ˆ iH,0 to ensure the stability of this system. It is straightforward to verify that the
only negative eigenvalue of A is

                                                         1
                                                               q          
                                                      ν=          2
                                                             ρ − ρ + 4G κ̂y .
                                                                       0                                                                            (138)
                                                         2

The corresponding eigenvector is Xν = (− Gν0 , 1)0 .
   We know that the solution to this system is given by
                                                                              Z t                                    
                                               Xti   =e   At
                                                                   X0i   +           e   − As
                                                                                                    − G 0 s̃˙ it E2    ds ,                         (139)
                                                                                0


where E1 = (1, 0)0 and E2 = (0, 1)0 are projection matrices. We restrict attention to the parameter
subspace where A is nonsingular. Furthermore, we know that

                                                                        s̃˙ it = −ψa0i e−ψt ,                                                       (140)

where a0i is the initial technology shock. This implies
                                                              Z t                                  
                     Xti   =e   At
                                         X0i   + ψG 0 a0i                e   − As−ψs
                                                                                          E2 ds                                                     (141)
                                                                    0




                                                                                     82
                                                                       
                      =e   At
                                    X0i   + ψG 0 a0i ( A + ψI )−1 E2        − ψG 0 a0i e−ψt ( A + ψI )−1 E2 .   (142)




  Stability. For stability, we require the term in square brackets be spanned on the stable manifold,
which is satisfied if and only if there exists an αν ∈ C such that

                                            αν Xν = X0i + ψG 0 a0i ( A + ψI )−1 E2 .                            (143)

This condition implies the two stability equations

                                          ν
                                     −       αν = π̄ˆ iH,0 + ψG 0 a0i E10 ( A + ψI )−1 E2                       (144)
                                          G0
                                             αν = − Ḡ 0 s̃0i + ψG 0 a0i E20 ( A + ψI )−1 E2 ,                  (145)

from which we can solve explicitly for αν and π̄ˆ iH,0 . Note that we have

                                                                         κ̃y
                                                   E10 ( A + ψI )−1 E2 =
                                                                          ψ̂
                                                                         ρ+ψ
                                                   E20 ( A + ψI )−1 E2 =        ,
                                                                             ψ̂

where ψ̂ = (ρ + ψ)ψ − G 0 κ̂y . We can now rewrite the two stability conditions as

                                                  ν                        κ̂y
                                              −       αν = π̄ˆ iH,0 + ψG 0 a0i                                  (146)
                                                  G 0                       ψ̂
                                                                              ρ+ψ i
                                                      αν = − Ḡ 0 s̃0i + ψG 0     a .                           (147)
                                                                               ψ̂ 0

We can now characterize the closed-form solution of our dynamical system, which is given by

                                      Xti = αν eνt Xν − ψG 0 a0i e−ψt ( A + ψI )−1 E2 ,                         (148)

from which we can back out explicit solutions for inflation and output:

                                                              ν                0 κ̂ y −ψt i
                                             π̄ˆ iH,t = −       α   e νt
                                                                         − ψG        e a0                       (149)
                                                            G0
                                                                  ν
                                                                                  ψ̂
                                                                          ρ + ψ −ψt i
                                                  ȳˆit = αν eνt − ψG 0            e a0 .                       (150)
                                                                            ψ̂

    We note here that the no-policy benchmark allocation is χ-invariant. To gain some intuition for
this result, note that under Cole-Obstfeld and with profit redistribution the positive allocation is
symmetric, with c̄ˆi,o  ˆi,r                                         ˆ¯ i
                   t = c̄t , and trade is balanced in every period, NXt = 0. That is, HtM agents and
optimizers always consume the same amount and face the same budget constraint, in a sense, since


                                                                   83
there is no inter-temporal substitution.


D.3      Loss Function and Planning Problem
Before we can set up the planning problem for a currency union with hand-to-mouth agents, we
have to derive the loss function. Our loss function features three distinct policy instruments: ex-
post transfers, capital controls and government spending. It also leaves room for several derivative
policy instruments which we will discuss later. We follow the linear-quadratic approach discussed
in Benigno and Woodford (2012). We continue to assume that there are no aggregate shocks but in
this section, to derive the loss function, we need to temporarily allow for idiosyncratic shocks in all
countries.


D.3.1     Notation

Once again, we reiterate our notational conventions. For all Xti 6∈ { Tti,o , Tti,r , τti,o , τti,r , NFAit , NXti }, we
have xti = ln( Xti ) − ln( X i ), where X i is the steady state value of Xti ; furthermore, we define x̃ti =
                                                                         R1
ln( X̃ti ) − ln( X i ), x̂ti = ln( Xti ) − ln( X̃ti ) and x̄ˆ ti = x̂ti − 0 x̂ti di ≡ x̂ti − x̂t∗ . Our goal is to approximate
welfare in terms of x̄ˆ ti variables.
                                                     i
    By definition, we have Xti = X i e xt . Taylor expansions of the function xti 7→ Xti around xti = 0
yield:

        To 1st order: Xti ≈ X i + X i xti = X i (1 + xti ).

        To 2nd order: Xti ≈ X i + X i xti + 21 X i ( xti )2 = X i (1 + xti + 21 ( xti )2 ).

So for example, the second-order approximation of ln( Xti ) = ln( X i ) + xti around xti = 0 is exactly
                                                                  i
ln( X i ) + xti . Similarly, approximating ( Xti )φ = ( X i )φ eφxt around φxti = 0, we have

                                                 ( X i ) φ e0 ( X i ) φ e0                               φ2
                    ( Xti )φ ≈ ( X i )φ +                                  (φxti )2 = ( X i )φ 1 + φxti + ( xti )2 .   (151)
                                                                                                                  
                                                             +
                                                      1            2                                     2

D.3.2     Starting with Household Utility

We begin by taking as our welfare criterion the households’ utility function. In particular, we solve
a coordinated problem, with the social planner’s objective function of the form
                      Z ∞Z 1               
                                               χ(1 − υ) ln(Cti,r ) −    ( N i,r )1+φ
                                     −ρt                           χ
               U=                e                                                                                     (152)
                        0    0                                    1+φ t
                                                                             1 − χ i,o 1+φ
                                                                                                       
                                                                    i,o                             i
                                               + (1 − χ)(1 − υ) ln(Ct ) −           (N )   + υ ln( Gt ) didt.
                                                                             1+φ t




                                                                       84
Approximating the RHS to second order, we have
           Z ∞Z 1                       
    U=                        e   −ρt
                                            χ(1 − υ) ln(Ci,r ) + χ(1 − υ)ci,r                      i,o                    i,o
                                                                          t + (1 − χ )(1 − υ ) ln(C ) + (1 − χ )(1 − υ ) ct
              0       0
                                                                                     (1 + φ)2 i,r 2 
                                                   ( N i,r )1+φ 1 + (1 + φ)ni,r
                                                χ
                                            −                                 t    +         (nt )
                                              1+φ                                        2
                                              1 − χ i,o 1+φ                          (1 + φ)2 i,o 2 
                                                                                                                     
                                                                               i,o                          i      i
                                            −      (N )         1 + (1 + φ ) n t +           (nt ) + υ ln( G ) + υgt didt.
                                              1+φ                                        2

     Recall the steady state relations: Y i = 1, Ci,r = Ci,o = (1 − υ), Gi = υ, and ( N i,o )1+φ =
( N i,r )1+φ = 1. Hence, we have
                                   Z ∞Z 1
                                                                                              1
                                                              
                                                        −ρt
                  U=                                e             (1 − υ) ln(1 − υ) −            + υ ln(υ)
                                    0           0                                            1+φ
                                                                  + (1 − υ)[χci,r           i,o       i,r           i,o     i
                                                                              t + (1 − χ ) ct ] − [ χnt + (1 − χ ) nt ] + υgt
                                                                    χ(1 + φ) i,r 2 (1 − χ)(1 + φ) i,o 2
                                                                                                             
                                                                  −          (nt ) −                    (nt ) didt.
                                                                        2                       2

Let Zi ≡ (1 − υ) ln(1 − υ) −           + υ ln(υ). Also note that χci,r
                                                               1
                                                              1+ φ
                                                                                  i,o     i       i,r
                                                                    t + (1 − χ ) ct = ct and χnt + (1 −
                                                                                     R1 i    R1 i
χ)ni,o          i                                                                                  ˆ      ∗
       t = nt . Finally, we use the linearity of the integral operator, noting that 0 xt di ≡ 0 ( x̄t + x̂t +
x̃ti )di = x̂t∗ , to write
         Z ∞Z 1
                                                                                           χ(1 + φ) i,r 2 (1 − χ)(1 + φ) i,o 2
                                                                                                                              
                                            i
  U=                      e   −ρt
                                        Z       + (1 − υ)ĉ∗t        + υ ĝt∗    − nit   −         (nt ) −              (nt ) didt.   (153)
          0       0                                                                            2                2

D.3.3    Linear-Quadratic Framework

Having completed a second-order approximation of the social planner’s welfare criterion, we will
now try to express said metric in terms of the variables ȳˆit , π̄ˆ iH,t , τ̄ˆti,r , θ̄ˆti , and ḡˆ ti , where the latter three
represent the full set of policy instruments available to the planner. In this particular case, a proper
linear-quadratic approximation rests on the following two key steps:

    i. Approximate the A-D relation to second order to find an expression for (1 − υ)ĉ∗t + υ ĝt∗ .

   ii. Express n̂it in terms of inflation.

We start with (2): With Calvo-pricing, we have the distorted production function

                                                                            Z 1  Pi ( j )  −e
                                                                                   H,t
                                                                      Yti             i
                                                                                                  dj = Ait Nti .
                                                                             0       PH,t

Therefore, we can approximate nit = yit + zit − ait to second order, where

                                                         1        i ( j)
                                                                 PH,t
                                                                           −e 
                                                                                   e 1 i
                                                Z                                 Z
                          zit     = ln                             i
                                                                              dj ≈                    i
                                                                                       ( PH,t ( j) − PH,t )2 dj = απ (π iH,t )2 ,     (154)
                                                     0            PH,t             2 0

                                                                                            85
for απ = 2λ
          e
            and λ = ρδ (ρ + ρδ ). Note that this definition of απ differs slightly from that used in
the main body of the paper. We found this notation slightly more convenient for the analysis in the
appendix. Hence, we have
                                    nit = yit + απ (π iH,t )2 − ait .                          (155)

The technology term is invariant to policy and so we drop it. It would later naturally drop out as we
rewrite the loss in gaps from the natural allocation.
   Next, we tackle the more difficult step (1): Recall that the A-D relation can be written as

                                                                                                 Z 1 j j 
                                                                                    Θit Cti         Θt Ct
                                                               
                               Yti   −   Gti   =   Sti C ∗,o       (1 − α )                   +α          dj .
                                                                                    Cti,o           0   Ct
                                                                                                             j,o


The linear-quadratic procedure requires that we approximate all those constraints to second order
that we use to substitute out terms in the loss function. We start by approximating the LHS to second
order. We have

                                   1                               1
                    LHS ≈(1 + yit + (yit )2 ) − υ(1 + gti + ( gti )2 )
                                   2                               2
                                                   1                                    υ
                        =(1 − υ) + [ŷit + ỹit ] + [ŷit + ỹit ]2 − υ[ ĝti + g̃ti ] − [ ĝti + g̃ti ]2 .
                                                   2                                    2

Integrating (using linearity of the integral), noting that ỹ∗t = 0 and g̃ti = ait because we only consider
idiosyncratic shocks (and country i is of measure 0) and we defined the natural allocation without
policy intervention, respectively, we have

                                                        Yi                                                    υY i
                                                               Z 1                                                   Z 1
              LHS ≈ (1 − υ)Y         i
                                         + Y i ŷ∗t   +                [ŷit   + ỹit ]2 di   − υY i ĝt∗   −              [ ĝti + g̃ti ]2 di.   (156)
                                                        2          0                                           2      0

For the RHS, we have

                    Si C ∗,o Θi Ci                                             1 i
                                                                                                                  
                                          i     ∗,o     i      i       i,o            ∗,o       i     i      i,o 2
      RHS ≈(1 − α)                   1 + st + ct + θt + ct − ct + [st + ct + θt + ct − ct ]
                         Ci,o                                                  2
               Z 1 j j i ∗,o 
                     ΘCSC                                                       1 i
                                                                                                                     
                                            i     ∗,o     j       j      j,o            ∗,o       j     j      j,o 2
           +α                         1 + st + ct + θt + ct − ct + [st + ct + θt + ct − ct ] dj
                  0       C j,o                                                 2
                                                                             1 i
                                                                                                                
                                i       i     ∗,o     i     i       i,o             ∗,o       i     i     i,o 2
          =(1 − α)(1 − υ)Y 1 + st + ct + θt + ct − ct + [st + ct + θt + ct − ct ]
                                                                             2
                                                        Z 1
                                                      1
                                                                                                   
                            i        ∗     ∗      ∗             i       ∗,o      j  j       j,o 2
           + α ( 1 − υ )Y 1 + θ t + c t + s t +              [s + ct + θt + ct − ct ] dj .
                                                      2 0 t

   Putting these together, we can write

                                     1 1 i                    υ 1 i
                                                Z                                       Z
                          ŷ∗t − υ ĝt∗ + [ŷt + ỹit ]2 di −    [ ĝ + g̃ti ]2 di
                                     2 0                      2 0 t
                        =(1 − υ)c∗t + (1 − υ)s∗t + (1 − υ)θt∗


                                                                               86
                                      1−υ 1 i
                                                   Z
                                                                     ∗,o 2
                                    +           (θt + cit − ci,o
                                                              t + ct ) di
                                         2    0
                                      (1 − α)(1 − υ) 1
                                                       Z                                           
                                                                 i 2      i i    i      i,o     ∗,o
                                    +                         (st ) + 2st (θt + ct − ct + ct ) di
                                             2           0
                                      α (1 − υ ) 1 1
                                                Z Z                                             
                                                             i 2       i j     j    j,o     ∗,o
                                    +                      (st ) + 2st (θt + ct − ct + ct ) djdi.
                                           2     0   0

Re-writing,

              1 1 i 2            υ 1 i 2
                    Z                          Z
  ŷ∗t − υ ĝt∗ +   (yt ) di −       ( g ) di
              2 0                2 0 t
=(1 − υ)c∗t + (1 − υ)s∗t + (1 − υ)θt∗
    1−υ 1
           Z                                                                                                       
                   i 2       i 2    i,o 2     ∗,o 2        i i    i ∗,o   i i,o        i i,o      i ∗,o     i,o ∗,o
 +               (θt ) + (ct ) + (ct ) + (ct ) + 2θt ct + 2θt ct − 2θt ct − 2ct ct + 2ct ct − 2ct ct di
       2    0
                               (1 − α)(1 − υ) 1 i 2
                                               Z                             Z 1
                      ∗ ∗,o                                                                              ∗,o
 + (1 − α)(1 − υ)st ct +                           (st ) di + (1 − α)(1 − υ)      sit (θti + cit − ci,o
                                                                                                    t + ct ) di
                                      2          0                              0
    α (1 − υ ) 1 i 2
              Z                                   Z 1
 +                                        ∗   ∗
                  (st ) di + α(1 − υ)(θt + ct )       sit di.
         2      0                                  0

Note that by definition, we have for all union variables xt∗ = x̂t∗ + x̃t∗ = x̂t∗ because x̃t∗ = 0 (we
use idiosyncratic shocks and country i is of measure 0). Therefore, we also have ŝ∗t = s∗t = 0 and
θ̂t∗ = θt∗ = 0. Hence, we have

                                           1 1 i 2             υ 1 i 2
                                                       Z                       Z
                             ŷ∗t   − υ ĝt∗
                                       +          (yt ) di −      ( g ) di
                                           2 0                 2 0 t
                                            1 − υ ∗,o 2
                           =(1 − υ)ĉ∗t +          (ĉt ) − (1 − υ)(ĉ∗t ,o )2 + (1 − υ)ĉ∗t ĉ∗t ,o
                                              2
                               1−υ 1
                                       Z                                                                  
                                                 i 2       i 2    i,o 2       i i        i i,o       i i,o
                            +                 (θt ) + (ct ) + (ct ) + 2θt ct − 2θt ct − 2ct ct di
                                 2       0
                               1−υ 1 i 2
                                       Z                                Z 1
                            +              (st ) di + (1 − α)(1 − υ)         sit (θti + cit − ci,o
                                                                                               t ) di.
                                 2       0                                0

And so finally, we have

                                   1 1 i 2           υ 1 i 2
                                           Z                     Z
  (1 − υ)ĉ∗t   + υ ĝt∗   =ŷ∗t +      (yt ) di −        ( g ) di − (1 − υ)ĉ∗t ĉ∗t ,o                           (157)
                                   2 0               2 0 t
                                 1 − υ ∗,o 2 1 − υ 1
                                                        Z                                                        
                                                                 i 2      i 2         i,o 2       i i i i,o i i,o
                               +      (ĉt ) −                 (θt ) + (ct ) + (ct ) + 2θt ct − 2θt ct − 2ct ct di
                                   2                2    0
                                 1−υ 1 i 2
                                      Z                                Z 1
                               −           (st ) di − (1 − α)(1 − υ)        sit (θti + cit − ci,o
                                                                                              t ) di.
                                   2    0                               0

   Therefore, we can write the welfare criterion as
                                                           Z ∞                                          
                                                   U=            e   −ρt
                                                                               − απ (π iH,t )2   + Uti       dt,   (158)
                                                           0



                                                                                   87
         R1
where     0   ŷ∗t − yit di = 0 and thus drops out, and so

                                1 − υ ∗,o 2
                    Uti = Zi +          (ĉt ) − (1 − υ)ĉ∗t ĉ∗t ,o                                                              (159)
                                    2
                              1 i 2 υ i 2 1−υ i 2
                            + ( y t ) − ( gt ) −             (st ) − (1 − α)(1 − υ)sit (θti + cit − ci,o
                                                                                                     t )
                              2        2                2
                              1−υ
                                                                                              
                            −          (θti )2 + (cit )2 + (ci,o 2     i i    i i,o     i i,o
                                                             t ) + 2θt ct − 2θt ct − 2ct ct
                                2
                              χ(1 + φ) i,r 2 (1 − χ)(1 + φ) i,o 2
                            −             (nt ) −                     (nt ) .                                                     (160)
                                  2                           2

D.3.4    Gap Notation

We have now finished deriving a second-order approximation of the social planner’s welfare crite-
rion. We want to express this equation entirely in gap notation because we later want to write all
optimal policy problems in gap notation as well.
   To that end, we convert variables according to xti = x̄ˆ ti + x̂t∗ + x̃ti . After some algebra, we find

                                 1                        υ                           1−υ i 2
      Uti = Zi + Ẑt∗ + Z̃ti + (ȳˆit )2 + ȳˆit ỹit − ( ḡˆ ti )2 − υ ḡˆ ti g̃ti −          (s̄ˆt ) − (1 − υ)s̄ˆit s̃it
                                 2                        2                               2
            − (1 − α)(1 − υ)s̄ˆit [θ̄ˆti + θ̃ti + c̄ˆit + c̃it − c̄ˆi,o           i,o                         i ˆi     ˆi ˆi,o
                                                                        t − c̃t ] − (1 − α )(1 − υ ) s̃t [ θ̄t + c̄t − c̄t ]
               1 − υ ˆi 2
                      
            −           (θ̄t ) + 2θ̄ˆti θ̃ti + (c̄ˆit )2 + 2c̄ˆit c̃it + (c̄ˆi,o   2    ˆi,o i,o        ˆi ˆi   ˆi i       i ˆi
                                                                             t ) + 2c̄t c̃t + 2θ̄t c̄t + 2θ̄t c̃t + 2θ̃t c̄t
                 2
                                                                                                            
                              ˆ i ˆi,o       ˆ i i,o       i ˆi,o         i   i,o     i   i,o
                        − 2θ̄t c̄t − 2θ̄t c̃t − 2θ̃t c̄t − 2c̄ˆt c̄ˆt − 2c̄ˆt c̃t − 2c̃t c̄ˆt         i i,o


                  χ(1 + φ) i,r 2 χ(1 + φ) i,r i,r (1 − χ)(1 + φ) i,o 2 (1 − χ)(1 + φ) i,o i,o
              −           (n̄ˆ t ) −     n̄ˆ t ñt −            (n̄ˆ t ) −           n̄ˆ t ñt ,
                      2              2                  2                    2

where

       1             υ          1 − υ ∗ 2 χ(1 + φ) ∗,r 2 (1 − χ)(1 + φ) ∗,o 2
Ẑt∗ = (ŷ∗t )2 − ( ĝt∗ )2 −         (ĉt ) −                 (n̂t ) −                        (n̂t )
       2             2            2                      2                            2
       1                       1−υ i 2                                                                      1−υ i 2 1−υ i 2
                                     (s̃t ) − (1 − α)(1 − υ)s̃it [θ̃ti + ĉ∗t + c̃it − ĉ∗t ,o − c̃i,o
                    υ
 Z̃ti = (ỹit )2 − ( g̃ti )2 −                                                                       t ]−           (θ̃t ) −      (c̃t )
       2            2            2                                                                              2               2
          1 − υ i,o 2
       −           (c̃t ) − (1 − υ)θ̃ti (ĉ∗t + c̃it ) + (1 − υ)θ̃ti (ĉ∗t ,o + c̃i,o               i i,o     ∗ i,o       i ∗,o
                                                                                  t ) + (1 − υ )[ c̃t c̃t + ĉt c̃t + c̃t ĉt ]
               2
          χ(1 + φ) i,r 2 (1 − χ)(1 + φ) i,o 2
       −                (ñt ) −                        (ñt ) .
                 2                         2

       We also use gap notation for the inflation term in the loss function, noting that π iH,t = π̂ iH,t =
π̄ˆ iH,t + π̂ ∗H,t . As in the body of the paper, it is easy to verify that the social planner can fully stabilize
union-wide inflation so that π̂ ∗H,t = 0. Alternatively, we could have added terms in π̂ ∗H,t to the term
Ẑt∗ which will be entirely inconsequential for all subsequent analysis since the planning problem
can be disaggregated by country, as in the body of the paper, and we will focus exclusively on
idiosyncratic shocks in country i.


                                                                     88
D.3.5    Final Steps

What remains now is to use the first-order approximation of the equilibrium conditions to solve out
terms so that we can write the welfare criterion entirely as a function of ȳˆit , π̄ˆ iH,t , τ̄ˆti,r , θ̄ˆti , and ḡˆ ti . This
is consistent with the linear-quadratic approach.
    Drawing on our earlier derivations, we use the following substitutions:

                         n̄ˆ i,r     ˆi        ˆi       ˆi       ˆ i,r
                             t = ηy ȳt + η g ḡt + ηθ θ̄t + ητ τ̄t
                                      1
                         n̄ˆ i,o                                                        ηθ θ̄ˆti −     ητ τ̄ˆti,r
                                                  χ                   χ              χ              χ
                                                      ηy ȳˆit −        ηg ḡˆ ti −
                                                           
                             t =          −
                                  1−χ 1−χ                         1−χ               1−χ            1−χ
                          c̄ˆi,r     ˆi        ˆi        ˆ i,r       ˆi
                             t = ψy ȳt + ψθ θ̄t + ψτ τ̄t + ψg ḡt
                          c̄ˆi,o                 ˆi                         ˆi           ˆi                ˆ i,r
                             t = (1 − α ) νy ȳt + [1 + (1 − α ) νθ ] θ̄t + (1 − α ) νg ḡt + (1 − α ) ντ τ̄t
                             c̄ˆi = ζ ȳˆi + ζ θ̄ˆi + ζ τ̄ˆ i,r + ζ ḡˆ i .
                              t         y t          θ t          τ t             g t


    After a lot of algebra, the social planner’s welfare criterion can be written as
         Z ∞             Z 1
   U=          e   −ρt
                                  − απ (π̄ˆ iH,t )2 + Zi + Ẑt∗ + Z̃ti + αyy (ȳˆit )2 + αθθ (θ̄ˆti )2 + αττ (τ̄ˆti,r )2 + α gg ( ḡˆ ti )2                (161)
           0              0

                                  + αyθ ȳˆit θ̄ˆti + αyg ȳˆit ḡˆ ti + αyτ ȳˆit τ̄ˆti,r + α gθ ḡˆ ti θ̄ˆti + α gτ ḡˆ ti τ̄ˆti,r + ατθ τ̄ˆti,r θ̄ˆti
                                                                                            
                                     i ˆi            i ˆi              i ˆi           i ˆi
                                  + αy,t ȳt + α g,t ḡt + ατ,t τ̄t + αθ,t θ̄t didt,

where

       1 1−υ 2                                              1−υ 2 1−υ
αyy = −          νy − (1 − α)(1 − υ)νy (ζ y − (1 − α)νy ) −        ζ −           (1 − α)2 νy2
       2     2                                                 2 y           2
                                χ(1 + φ) 2 (1 − χ)(1 + φ)            1         χ
       + (1 − υ)(1 − α)νy ζ y −           ηy −                  (        −          ηy )2
                                    2                  2          1−χ 1−χ
         1−υ 2                                            1−υ 1−υ 2 1−υ
αθθ = −        νθ − (1 − α)(1 − υ)νθ (ζ θ − (1 − α)νθ ) −         −         ζ −           [(1 − α)νθ + 1]2
           2                                                 2         2 θ           2
                                                                         χ(1 + φ) 2 (1 − χ)(1 + φ)            χ
       − (1 − υ)(ζ θ − [1 + (1 − α)νθ ]) + (1 − υ)[1 + (1 − α)νθ ]ζ θ −              ηθ −                  (     ηθ )2
                                                                               2                   2         1−χ
         1−υ 2                                             1−υ 2 1−υ
αττ = −        ντ − (1 − α)(1 − υ)ντ (ζ τ − (1 − α)ντ ) −         ζτ −         (1 − α)2 ντ2
           2                                                 2            2
                                χ(1 + φ) 2 (1 − χ)(1 + φ)            χ
       + (1 − υ)(1 − α)ντ ζ τ −           ητ −                  (       ητ )2
                                    2                  2          1−χ
         υ 1−υ 2                                                1−υ 2 1−υ
α gg = − −          νg − (1 − α)(1 − υ)νg (ζ g − (1 − α)νg ) −         ζg −          (1 − α)2 νg2
         2      2                                                  2             2
                                χ(1 + φ) 2 (1 − χ)(1 + φ)            χ
       + (1 − υ)(1 − α)νg ζ g −           ηg −                  (       η g )2
                                    2                  2          1−χ


αyθ = − (1 − υ)νy νθ − (1 − α)(1 − υ) νy [ζ θ − (1 − α)νθ ] + νθ [ζ y − (1 − α)νy ]
                                                                                                                                           

        − (1 − υ)ζ y ζ θ − (1 − υ)(1 − α)νy [1 + (1 − α)νθ ] − (1 − υ)(ζ y − (1 − α)νy )

                                                                                        89
                                                                                             1   χ
         + (1 − υ)(1 − α)νy ζ θ + (1 − υ)[1 + (1 − α)νθ ]ζ y − χ(1 + φ)ηy ηθ − (1 + φ)χηθ (    −    ηy )
                                                                                            1−χ 1−χ
       = − (1 − υ)νy νg − (1 − α)(1 − υ) νy [ζ g − (1 − α)νg ] + νg [ζ y − (1 − α)νy ]
                                                                                       
αyg
         − (1 − υ)ζ y ζ g − (1 − υ)(1 − α)2 νy νg + (1 − υ)(1 − α)νy ζ g + (1 − υ)(1 − α)νg ζ y
                                             1        χ
         − χ(1 + φ)ηy ηg − (1 + φ)χηg (           −       ηy )
                                          1−χ 1−χ
       = − (1 − υ)νy ντ − (1 − α)(1 − υ) νy [ζ τ − (1 − α)ντ ] + ντ [ζ y − (1 − α)νy ]
                                                                                       
αyτ
         − (1 − υ)ζ y ζ τ − (1 − υ)(1 − α)2 νy ντ + (1 − υ)(1 − α)νy ζ τ + (1 − υ)(1 − α)ντ ζ y
                                             1        χ
         − χ(1 + φ)ηy ητ − (1 + φ)χητ (           −       ηy )
                                          1−χ 1−χ
       = − (1 − υ)νg νθ − (1 − α)(1 − υ) νg [ζ θ − (1 − α)νθ ] + νθ [ζ g − (1 − α)νg ]
                                                                                       
α gθ
         − (1 − υ)ζ g ζ θ − (1 − υ)(1 − α)νg [1 + (1 − α)νθ ] − (1 − υ)(ζ g − (1 − α)νg )
                                                                                          χ2
         + (1 − υ)[1 + (1 − α)νθ ]ζ g + (1 − υ)(1 − α)νg ζ θ − χ(1 + φ)ηg ηθ − (1 + φ)       η ηg
                                                                                         1−χ θ
       = − (1 − υ)νg ντ − (1 − α)(1 − υ) νg [ζ τ − (1 − α)ντ ] + ντ [ζ g − (1 − α)νg ]
                                                                                       
α gτ
         − (1 − υ)ζ g ζ τ − (1 − υ)(1 − α)2 νg ντ + (1 − υ)(1 − α)νg ζ τ + (1 − υ)(1 − α)ντ ζ g
                                           χ2
         − χ (1 + φ ) η g ητ − (1 + φ )       η g ητ
                                          1−χ
ατθ = − (1 − υ)ντ νθ − (1 − α)(1 − υ) ντ [ζ θ − (1 − α)νθ ] + νθ [ζ τ − (1 − α)ντ ]
                                                                                              

         − (1 − υ)ζ τ ζ θ − (1 − υ)(1 − α)ντ [1 + (1 − α)νθ ] − (1 − υ)(ζ τ − (1 − α)νg τ )
                                                                                                   χ2
         + (1 − υ)[1 + (1 − α)νθ ]ζ τ + (1 − υ)(1 − α)ντ ζ θ − χ(1 + φ)ητ ηθ − (1 + φ)                η ητ
                                                                                                  1−χ θ




                         αiy,t = ait − (1 − υ)νy ait − (1 − α)(1 − υ)[ζ y − (1 − α)νy ] ait
                         αig,t = − (1 − υ)νg ait − (1 − α)(1 − υ)[ζ g − (1 − α)νg ] ait − υait
                         αiτ,t = − (1 − υ)ντ ait − (1 − α)(1 − υ)[ζ τ − (1 − α)ντ ] ait
                         αiθ,t = − (1 − υ)νθ ait − (1 − α)(1 − υ)[ζ θ − (1 − α)νθ ] ait .

It turns out that we generally have αiy,t = αig,t = αiτ,t = αiθ,t = 0 for all t and i.


D.3.6     Loss Function

We will find it more convenient later on to work with the loss function instead of the welfare function.
The former is the negative of the latter. Moreover, as in the body of the paper, we will be interested in
the loss function in gaps from its natural counterpart. Note in (161) that for the loss function under
the natural allocation, all terms drop out except for Zi + Ẑt∗ + Z̃ti . Therefore, we have the following



                                                           90
loss function in gaps from the natural

         L = − (U − Ũ )                                                                                                 (162)
                 Z ∞Z 1        
             =            e−ρt απ (π̄ˆ iH,t )2 − αyy (ȳˆit )2 − αθθ (θ̄ˆti )2 − αττ (τ̄ˆti,r )2 − α gg ( ḡˆ ti )2
                 0    0
                                                                                                                    
                                      ˆ i ˆi      ˆ i ˆi       ˆ i ˆ i,r      ˆ i ˆi         ˆ i ˆ i,r     ˆ i,r ˆi
                            − αyθ ȳt θ̄t − αyg ȳt ḡt − αyτ ȳt τ̄t − α gθ ḡt θ̄t − α gτ ḡt τ̄t − ατθ τ̄t θ̄t didt
               Z ∞Z 1                             
             ≡        e −ρt           i      2 ˆ i
                              απ (π̄ˆ H,t ) − Ūt didt.
                 0    0


D.3.7   General Planning Problem

In summary, in this section we have derived all elements that comprise the general planning problem
for country i, featuring all three policy instruments. Assembling them now, we can write the fully
general country-i planning problem as follows:
                                                                    Z ∞                                           
                                                 min                        e   −ρt
                                                                                          απ (π̄ˆ iH,t )2      ˆ i
                                                                                                            − Ūt dt     (163)
                                          {θ̄ˆti , ḡˆ ti ,τ̄ˆti,r }t≥0 0


subject to

                                                                                                ˙
                                   Λy ȳˆ˙ it = −Λs (π̄ˆ iH,t + s̃˙ it ) + Λ g ḡˆ˙ ti + Λθ θ̄ˆti + Λτ τ̄ˆ˙ti,r
                                   π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − κθ θ̄ˆti − κτ τ̄ˆti,r − κ g ḡˆ ti
                                   Λy ȳˆ0i = −Λs s̃0i + Λ g ḡˆ0i + Λθ θ̄ˆ0i + Λτ τ̄ˆ0i,r
                                                Z ∞                                                       
                                          0=          e −ρt          i         i,r          ˆ i
                                                              Γy ȳˆ t + Γτ τ̄ˆt + Γθ θ̄t + Γ g ḡˆ t dt.i
                                                    0


    We note again that the coordinated union-wide planning problem coincides with the disaggre-
gated problem, where the social planner solves the above optimal control problem for each country
i ∈ [0, 1] separately. This follows from the analogous result derived in the main body of the paper. In
the remainder of this appendix, we will therefore only consider the disaggregated planning problem
of country i under an idiosyncratic productivity shock.
    The constraints in this planning problem are the relevant implementability conditions. All other
equilibrium conditions can be used to simply back out the equilibrium variables that are not featured
in the planning problem.


D.4     Optimal Transfers
We now consider the problem where the social planner only has access to ex-post transfers, as in
body of the paper. In particular, we have θ̄ˆti = θ̄ˆi for all t and ḡˆ ti = 0.




                                                                                  91
   Country i’s planning problem can then be written as
                                                    Z ∞                                                                  
                                       min                 e   −ρt
                                                                         απ (π̄ˆ iH,t )2   − Ūˆ ti θ̄ˆi =θ̄ˆi ,ḡˆi =0       dt,   (164)
                                   θ̄ˆi ,{τ̄ˆti,r }t≥0 0                                               t           t



subject to

                                                  ȳˆ˙ it = − D 0 (π̄ˆ iH,t + s̃˙ it ) + D ν̄ˆti
                                                  τ̄ˆ˙ti,r = ν̄ˆti
                                              π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − κθ θ̄ˆi − κτ τ̄ˆti,r

               Λs               Λτ
where D 0 =    Λy   and D =     Λy ,   and also subject to the intial condition

                                                 Λy ȳˆ0i = −Λs s̃0i + Λθ θ̄ˆi + Λτ τ̄ˆ0i,r                                         (165)

which will be used to ensure the stability of the dynamical system, and the budget constraint
                                                    Z ∞                                            
                                            0=              e   −ρt           ˆ i      ˆ i,r    ˆ i
                                                                          Γy ȳt + Γτ τ̄t + Γθ θ̄ dt                                (166)
                                                       0


which will be used to solve for θ̄ˆi . In particular, our strategy will be to solve the optimal allocation
and policy intervention as a function of θ̄ˆi analytically, and then numerically solve for the optimal θ̄ˆi
in a second stage.
    Also note that we have replaced τ̄ˆ˙ti,r in the (IS) equation with another variable. This is necessary
to bring the planning problem into the form of a standard optimal control problem. Finally, we will
integrate the initial condition and the budget constraint, an isoperimetric constraint in this case, into
the optimal control problem using Lagrange multipliers. In particular, let

   – xti = {π̄ˆ iH,t , ȳˆit , τ̄ˆti,r } denote the vector of state variables,

   – uit = {ν̄ˆti } denote the vector of control variables, and

   – µit = {µiπ,t , µiy,t , µiτ,t } denote the vector of costates.

Then we can summarize country i’s optimal control problem with its current-value Hamiltonian,
which is given by

                                                                       ˆi
                               H ( xti , uit , µit ) =απ (π iH,t )2 − Ū                                                            (167)
                                                                        t θ̄ˆi =θ̄ˆi , ḡˆ i =0
                                                                             t             t
                                                                                                 
                                                                  i         i,r
                                                      + λ Γy ȳˆt + Γτ τ̄ˆt + Γθ θ̄           ˆ i

                                                                                                                               
                                                           + ∆ Λy ȳˆ0i + Λs s̃0i − Λθ θ̄ˆi − Λτ τ̄ˆ0i,r
                                                                                               
                                                           + µy,t D ν̄ˆt − D (π̄ˆ H,t + s̃˙ t )
                                                              i        i    0     i         i



                                                                              92
                                                    + µiτ,t ν̄ˆti
                                                                                                 
                                                       i          i         i       ˆ i       i,r
                                                    + µπ,t ρπ̄ˆ H,t − κy ȳˆt − κθ θ̄ − κτ τ̄ˆt .


D.4.1    Optimality Conditions

Since we have transformed the planning problem into a standard optimal control problem, the opti-
mality conditions are given by
   [(1)]

   i. ∂u Hti = 0 (Optimality)

  ii. ρµix,t − µ̇ix,t = ∂ x Hti (Multiplier)

 iii. ẋti = ∂µx Hti (State equations)

  iv. µix,0 = ∂ x H0i (Initial conditions),

where we abuse notation slightly to let x and u stand in for each element of the respective vectors. ∂ x
denotes the partial derivative with respect to x. This yields the following nine first-order conditions:

   Optimality:
                                                          Dµiy,t + µiτ,t = 0.                             (168)

Multiplier:


                                     µ̇iπ,t = D 0 µiy,t − 2απ π̄ˆ iH,t                                    (169)
                           ρµiy,t − µ̇iy,t = λΓy − κy µiπ,t − 2αyy ȳˆit − αyθ θ̄ˆi − αyτ τ̄ˆti,r         (170)
                           ρµi − µ̇i = λΓ − κ µi − 2α τ̄ˆ i,r − α θ̄ˆi − α ȳˆi
                               τ,t     τ,t            τ        τ π,t            ττ t          τθ   yτ t   (171)

State:


                                             ȳˆ˙ it = − D 0 (π̄ˆ iH,t + s̃˙ it ) + D ν̄ˆti
                                           τ̄ˆ˙ti,r = ν̄ˆti
                                       π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − κθ θ̄ˆi − κτ τ̄ˆti,r

Initial conditions:


                                                           µiπ,0 = 0                                      (172)
                                                           µiy,0 = ∆Λy                                    (173)
                                                           µiτ,0 = −∆Λτ .                                 (174)


                                                                    93
We will now reduce the size of the above dynamical system by solving out for µiπ,t and µiτ,t . Using
equations (168), (170) and (171), we can write

    (κτ + Dκy )µiπ,t =(Γy D + Γτ )λ − (2αττ + Dαyτ )τ̄ˆti,r − (2Dαyy + αyτ )ȳˆit − (ατθ + Dαyθ )θ̄ˆi .                                (175)

Taking the derivative with respect to time and using (169), we have

                  (κτ + Dκy )( D 0 µiy,t − 2απ π̄ˆ iH,t ) + (2αττ + Dαyτ )τ̄ˆ˙ti,r + (2Dαyy + αyτ )ȳˆ˙ it = 0,

from which we can solve for the rate of change of transfers using the (IS) equation:

                                     (κτ + Dκy )( D 0 µiy,t − 2απ π̄ˆ iH,t ) − D 0 (2Dαyy + αyτ )(π̄ˆ iH,t + s̃˙ it )
                      τ̄ˆ˙ti,r = −                                                                                                     (176)
                                                           2αττ + Dαyτ + D (2Dαyy + αyτ )

Using the (IS) equation again, we have

                                                (κτ + Dκy )( D 0 µiy,t − 2απ π̄ˆ iH,t ) − D 0 (2Dαyy + αyτ )(π̄ˆ iH,t + s̃˙ it )
     ȳˆ˙ it = − D 0 (π̄ˆ iH,t + s̃˙ it ) − D                                                                                      .   (177)
                                                                      2αττ + Dαyτ + D (2Dαyy + αyτ )

Finally, using (170) and our solution for µiπ,t above, we find

                            κy Γτ − κτ Γy           2κy αττ − κτ αyτ         αyτ κy − 2κτ αyy        κy ατθ − κτ αyθ
     µ̇iy,t =ρµiy,t + λ                   − τ̄ˆti,r                  − ȳˆit                  − θ̄ˆi                 .                 (178)
                             κτ + Dκy                  κτ + Dκy                 κτ + Dκy                κτ + Dκy

    Therefore, we can write the reduced system of optimality conditions as

                                                µ̇iy,t = ρµiy,t + Kτ τ̄ˆti,r + Ky ȳˆit + Kθ θ̄ˆi + Kλ λ                               (179)
                                                      ȳˆ˙ it = Jµy µiy,t + Jπ π̄ˆ iH,t + Js s̃˙ it                                    (180)
                                                 τ̄ˆ˙ i,r = Hµ µi + Hπ π̄ˆ i + Hs s̃˙ i
                                                  t         y   y,t              H,t          t                                        (181)
                                            π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − κθ θ̄ˆi − κτ τ̄ˆti,r .                                  (182)


D.4.2    Solving the Dynamic System

In particular, the optimality conditions yield a system of linear ODEs which, letting Xti = {π̄ˆ iH,t , ȳˆit , τ̄ˆti,r , µiy,t },
we can express as
                                             Ẋti = AXti + Bti ,                                          (183)

where
                                                                                    −κθ θ̄ˆi                   π̄ˆ iH,0
                                                                                                                   
                          ρ −κ y −κ τ 0
                                                                                                              ȳˆ0 
                                                                                   i                        i 
                        Jπ  0    0   J                                            J̄t 
                                          
                                         y ,                                 i                          i
                     A=                                                           H̄ i  ,
                                                                             Bt =                            τ̄ˆ i,r  ,
                                                                                                        X0 = 
                                       µ   
                                                                                                                       
                       H
                        π   0    0   Hµy                                           t                     0 
                          0 Ky   Kτ    ρ                                               i
                                                                                     K̄t                          ∆Λy



                                                                            94
where J̄ti = Js s̃˙ it , H̄ti = Hs s̃˙ it , and K̄ti = Kθ θ̄ˆi + Kλ λ.
  The solution to this dynamical system is, as is well known, given by
                                                                                              Z t                  
                                                             Xti   =e       At
                                                                                     X0i   +         e− As Bsi ds       ,
                                                                                                0


which we can rewrite as
                                                            Z t                                                            
                               Xti   =e   At
                                                   X0i   +         e   − As                ˆ i      i        i        i
                                                                                     − κθ θ̄ E1 + J̄s E2 + H̄s E3 + K̄s E4 ds ,
                                                               0


where Ei is the 4 × 1 zero vector with a 1 in the ith position. We can write
                                                                    Z t                                                    Z t
                               Xti   =e   At
                                                   X0i   − κθ θ̄ˆi           e   − As
                                                                                        E1 ds + (Kθ θ̄ˆi + Kλ λ)
                                                                                               e− As E4 ds
                                                                        0                                                    0
                                                    Z t                      Z t                
                                                          − As−ψs                  − As−ψs
                                               + W2     e         E2 ds + W3     e         E3 ds ,
                                                             0                                           0


where W2 = −ψa0i Js , and W3 = −ψa0i Hs .
    Assuming that the economy is in the parameter subspace where A is nonsingular, we can use
            Rt                                Rt
the results 0 e− As ds = A−1 ( I − e− At ) and 0 e−( A+ψI )s ds = ( A + ψI )−1 ( I − e−( A+ψI )t ) to solve the
integral, so that
                           
           Xti   =e   At
                               X0i − κθ θ̄ˆi A−1 ( I − e− At ) E1 + (Kθ θ̄ˆi + Kλ λ) A−1 ( I − e− At ) E4
                                                                                                                                                           
                                                          −1                −( A+ψI )t                                      −1             −( A+ψI )t
                           + W2 ( A + ψI )                     (I − e                       ) E2 + W3 ( A + ψI )                  (I − e                ) E3 .

From this, we finally arrive at the solution
                                                                                                                                                           
           Xti   =e   At
                               X0i   − κθ θ̄ˆi A−1 E1 + (Kθ θ̄ˆi + Kλ λ) A−1 E4 + ( A + ψI )−1 W2 E2 + W3 E3                                                     (184)
                                                                                                             


                  + κθ θ̄ˆi A−1 E1 − (Kθ θ̄ˆi + Kλ λ) A−1 E4 − ( A + ψI )−1 e−ψt W2 E2 + W3 E3
                                                                                               


D.4.3   Stability

There is a unique solution if and only if A has two negative eigenvalues. For stability, we then need

                  X0i − κθ θ̄ˆi A−1 E1 + (Kθ θ̄ˆi + Kλ λ) A−1 E4 + ( A + ψI )−1 W2 E2 + W3 E3
                                                                                                                                                   


to be in the stable manifold, the subspace of the state space spanned by the eigenvectors associated
with the negative eigenvalues. Let Vj , j ∈ {1, 2}, be the eigenvector of A associated with the negative




                                                                                           95
eigenvalue λ j . Then there must be α j ∈ C, j ∈ {1, 2} such that

                          0 =α1 V1 + α2 V2 + X0i − κθ θ̄ˆi A−1 E1 + (Kθ θ̄ˆi + Kλ λ) A−1 E4                        (185)
                             + ( A + ψI )−1 W2 E2 + W3 E3 .
                                                               


In particular, to guarantee stability we need to solve for the vector Z = (α1 , α2 , λ, ∆, π̄ˆ iH,0 , ȳˆ0i , τ̄ˆ0i,r )0 ∈
C7 . Therefore, we need seven linearly independent conditions involving the desired variables. Equa-
tion (185) yields four of these conditions. To see this, left-multiply (185) by Ei0 for each i ∈ {1, 2, 3, 4}.
    The fifth stability condition will be the initial condition, Λy ȳˆ0i = −Λs s̃0i + Λτ τ̄ˆ0i,r + Λθ θ̄ˆi . The sixth
condition we obtain by writing

       (κτ + Dκy )µiπ,0 = 0                                                                                        (186)
                          = (Γy D + Γτ )λ − (2αττ + Dαyτ )τ̄ˆ0i,r − (2Dαyy + αyτ )ȳˆ0i − (ατθ + Dαyθ )θ̄ˆi .

   The seventh and final condition we obtain from country i’s budget constraint. In particular, we
have
                                 Z ∞                                     
                             0=      e −ρt          i         i,r     ˆ i
                                             Γy ȳˆ t + Γτ τ̄ˆt + Γθ θ̄ dt
                                           0
                                                     Z ∞
                                        Γ
                                       = θ θ̄ˆi +          e−ρt (Γy E2 + Γτ E3 )0 Xti dt.
                                         ρ           0

We can write

  Xti = e At − α1 V1 − α2 V2 + κθ θ̄ˆi A−1 E1 − (Kθ θ̄ˆi + Kλ λ) A−1 E4 − ( A + ψI )−1 e−ψt W2 E2 + W3 E3
                                                                                                         

      = −α eλ1 t V − α eλ2 t V + κ θ̄ˆi A−1 E − (K θ̄ˆi + K λ) A−1 E − ( A + ψI )−1 e−ψt W E + W E .
                                                                                                           
            1      1     2      2     θ          1          θ        λ          4                       2 2      3 3


Plugging this in and solving the integrals, we obtain our final stability condition

                        Γθ ˆi        α1                               α2
                   0=      θ̄ +           (Γy E2 + Γτ E3 )0 V1 +          (Γy E2 + Γτ E3 )0 V2                     (187)
                        ρ          λ1 − ρ                         λ2 − ρ
                            κ θ̄ˆi                             K θ̄ˆi + Kλ λ
                        + θ (Γy E2 + Γτ E3 )0 A−1 E1 − θ                     (Γy E2 + Γτ E3 )0 A−1 E4
                              ρ                                       ρ
                               1
                        −           (Γy E2 + Γτ E3 )0 ( A + ψI )−1 [W2 E2 + W3 E3 ].
                            ρ+ψ




                                                                96
    Putting everything together, we can write MZ = N, where

                                                                                                                                                 
                    E10 V1                  E10 V2                      Kλ E10 A−1 E4              0    1          0                      0
                    E20 V1                  E20 V2                      Kλ E20 A−1 E4              0    0          1                      0
                                                                                                                                                 
                                                                                                                                                 
                                                                                                                                                 
     
                   E30 V1                  E30 V2                      Kλ E30 A−1 E4              0    0          0                      1       
                                                                                                                                                  
   M=              E40 V1                  E40 V2                      Kλ E40 A−1 E4              Λy   0          0                      0
                                                                                                                                                 
                                                                                                                                                  
                                                                                                                                                 
     
                      0                       0                               0                   0    0         Λy                   −Λτ        
                                                                                                                                                  
                       0                       0                         Γτ + DΓy                  0    0   −(2αyy D + αyτ )       −(2αττ + Dαyτ )
                                                                                                                                                 
     
              (Γy E2 +Γτ E3 )0      (Γy E2 +Γτ E3 )0
                                                          − Kρλ (Γy E2 + Γτ E3 )0 A−1 E4
                                                                                                                                                 
                   λ1 − ρ      V1        λ2 − ρ      V2                                            0    0             0                   0


    and

                                                                                                                                                          
                                                                                  − E10 W
                                                                                  − E20 W
                                                                                                                                                          
                                                                                                                                                          
                                                                                                                                                          
      
                                                                                 − E30 W                                                                  
                                                                                                                                                           
    N=                                                                           − E40 W
                                                                                                                                                          
                                                                                                                                                           
                                                                              −Λs s̃0i + Λθ θ̄ˆi
                                                                                                                                                          
                                                                                                                                                          
                                                                                                                                                          
                                                                              (ατθ + Dαyθ )θ̄ˆi
                                                                                                                                                          
                                                                                                                                                          
                             κθ θ̄ˆi                                 Kθ θ̄ˆi                            (Γy E2 +Γτ E3 )0
              − Γρθ θ̄ˆi −
                                                                                                                                                          
                              ρ ( Γy E2   + Γτ E3 )0 A−1 E1 +         ρ ( Γy E2   + Γτ E3 )0 A−1 E4 +        ρ+ψ         ( A + ψI )−1 [W2 E2   + W3 E3 ]


   where W = −κθ θ̄ˆi A−1 E1 + Kθ θ̄ˆi A−1 E4 + ( A + ψI )−1 [W2 E2 + W3 E3 ]. Given these matrices, we
can compute the vector Z numerically by setting

                                                                           Z = M −1 N                                                                  (188)

over the parameter subspace on which M is invertible.


D.5      Optimal Capital Controls
We now consider the case where the social planner only has access to capital controls. That is, ḡˆ ti = 0
for all t and NFA0i = 0. The planner’s choice of capital controls will be encoded in a time-varying θ̄ˆti .
    This directly implies that NFA  ˆ¯ i = 0 in the absence of transfers. Furthermore, since we assume
                                       0
that the government does not engage in additional redistribution, we have τti,r = −(Sti )−α Gti . Sim-
ilarly, τti,r = τti,o because the government does not discriminate between different types of agents.
Hence, we have
                                                 τ̄ˆti,r = αυs̄ˆit .                                 (189)

Plugging in for s̄ˆit = νy ȳˆit + νg ḡˆ ti + ντ τ̄ˆti + νθ θ̄ˆti , with ḡˆ ti = 0, we find that

                                                          τ̄ˆti,r =             νy ȳˆit + νθ θ̄ˆti
                                                                          αυ
                                                                                                                                                       (190)
                                                                                                     
                                                                       1 − αυντ
                                                                                                  ˙
                                                          τ̄ˆ˙ti,r              νy ȳˆ˙ it + νθ θ̄ˆti .
                                                                          αυ
                                                                     =                                                                                 (191)
                                                                       1 − αυντ


                                                                                  97
      IS equation. This allows us to rewrite the general (IS) equation for this particular allocation as

                                                                                                     ˙
                                                                                                   Λτ θ̄ˆti ,
                                                                 αυνy
                     Λy ȳˆ˙ it = −Λs (π̄ˆ iH,t + s̃˙ it ) +            Λτ ȳˆ˙ it + Λθ +
                                                                                            αυνθ
                                                                                                                     (192)
                                                               1 − αυντ                   1 − αυντ

or, more conveniently,
                                                                                             ˙
                                                  ȳˆ˙ it = − G 0 (π̄ˆ iH,t + s̃˙ it ) + G θ̄ˆti ,                   (193)

where

                                                                   Λθ +        1−αυντ Λτ
                                                                                αυνθ
                                                        G=                      αυνy
                                                                   Λy −        1−αυντ Λτ
                                                                               Λs
                                                      G0 =                      αυνy      .
                                                                   Λy −        1−αυντ Λ τ


NKPC. Similarly, we can rewrite the Phillips Curve noting that we now have


                             π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − κθ θ̄ˆti −                κτ νy ȳˆit + νθ θ̄ˆti ,
                                                                                    αυ
                                                                                                                     (194)
                                                                                                                
                                                                                 1 − αυντ

or, more conveniently,
                                                  π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κ̂y ȳˆit − κ̂θ θ̄ˆti ,                    (195)

where

                                                                  αυ
                                                    κ̂y = κy +          κτ νy
                                                               1 − αυντ
                                                                  αυ
                                                    κ̂θ = κθ +          κτ νθ .
                                                               1 − αυντ

Initial condition. Following similar conversions relative to the general specification presented in

the last section, we find that
                                                         ȳˆ0i = − Ḡ 0 s̃0i + Ḡ θ̄ˆ0i ,                            (196)

for

                                                                 Λθ
                                                             Ḡ =
                                                                 Λy
                                                                 Λs + αυΛτ
                                                          Ḡ 0 =           .
                                                                     Λy

NFA. Finally, we record here the simplified country-i budget constraint when only capital controls

are used. We have                                      Z ∞                                     
                                                0=             e   −ρt            ˆ i       ˆ i
                                                                             Γ̂y ȳt + Γ̂θ θ̄t dt,                   (197)
                                                         0




                                                                         98
where

                                                               αυ
                                                 Γ̂y = Γy +          νy Γτ
                                                            1 − αυντ
                                                               αυ
                                                 Γ̂θ = Γθ +          ν Γτ .
                                                            1 − αυντ θ

We note at this point that Γ̂y = 0 over the entire parameter space. We will continue to carry the term
around in this section, but we want to highlight the important implication of this result: informally,
present-value capital controls must always average to zero over time. Formally, of course, we must
have                                   Z ∞                 Z ∞
                                   0=        −ρt   ˆ i
                                            e Γ̂θ θ̄t dt =     e−ρt θ̄ˆti dt.                     (198)
                                                     0                                 0

   Disaggregated control problem. We are now in a position to transform country-i’s disaggregated
planning problem to the form of a standard optimal control problem. In particular, the planning
problem is given by
                                      Z ∞
                                                                   
                              min                                       ˆi
                                                e−ρt απ (π̄ˆ iH,t )2 − Ū                                                   dt,   (199)
                                                                         t                    ḡˆ ti =0,τ̄ˆti,r =αυs̄ˆit
                             {θ̄ˆti }t≥0 0

subject to

                                                                                        ˙
                                             ȳˆ˙ it = − G 0 (π̄ˆ iH,t + s̃˙ it ) + G θ̄ˆti
                                       π̄ˆ˙ i = ρπ̄ˆ i − κ̂ ȳˆi − κ̂ θ̄ˆi
                                             H,t            H,t        y t                 θ t

                                             ȳˆ0i   =   − Ḡ 0 s̃0i + Ḡ θ̄ˆ0i
                                                         Z ∞                                     
                                               0=              e  −ρt
                                                                        Γ̂y ȳˆit             ˆ i
                                                                                       + Γ̂θ θ̄t dt.
                                                          0


As in the previous section for optimal transfers, the conversion from planning two optimal control
problem requires to important steps. First, we include the initial condition and the isoperimetric
budget constraint in the Hamiltonian using Lagrange multipliers. Second, we have to substitute out
                      ˙
the time derivative θ̄ˆti in the (IS) equation and replace it with placeholder ν̄ˆti . We record country i’s
disaggregated optimal control problem in the form of the following Hamiltonian:

                                                                        ˆi i
                              Hti ( xti , uit , µit ) =απ (π iH,t )2 − Ū t ḡˆ =0,τ̄ˆ i,r =αυs̄ˆi
                                                                                t   t          t


                                                       + λ Γ̂y ȳˆit + Γ̂θ θ̄ˆti
                                                                                                              
                                                             +∆         ȳˆ0i   + Ḡ 0 s̃0i   − Ḡ θ̄ˆ0i
                                                                                                                           
                                                             + µiy,t         G ν̄ˆti   −G      0
                                                                                                   (π̄ˆ iH,t   + s̃˙ it )

                                                             + µiθ,t ν̄ˆti



                                                                      99
                                                                                                       
                                                             + µiπ,t         ˆ i          ˆ i       ˆ i
                                                                           ρπ̄ H,t − κ̂y ȳt − κ̂θ θ̄t .


As before, xti describes the vector of state variables, uit the vector of control variables, and µit the
vector of costates.

   Loss function. Finally, to work with the above Hamiltonian we have to record the precise form
that the loss function takes when the planner can only use capital controls. It is straightforward to
verify that we have
                             ˆi i                                ˆi 2           ˆi 2         ˆ i ˆi
                            Ūt ḡˆ =0,τ̄ˆ i,r =αυs̄ˆi = α̂yy ( ȳt ) + α̂θθ ( θ̄t ) + α̂yθ ȳt θ̄t , (200)
                                    t     t            t

where

                                     αυ 2 2             αυ
                 α̂yy = αyy +               νy αττ +           νy αyτ
                                  1 − αυντ            1 − αυντ
                                     αυ 2 2             αυ
                 α̂θθ   = αθθ +             νθ αττ +           να
                                  1 − αυντ            1 − αυντ θ τθ
                                    αυ 2                   αυ                 αυ
                 α̂yθ   = 2αττ             νy ντ + αyθ +           νθ αyτ +          νy ατθ .
                                1 − αυντ                 1 − αυντ           1 − αυντ

D.5.1    Optimality Conditions

The Hamiltonian is associated with the following first-order conditions.

   Optimality:
                                                           Gµiy,t + µiτ,t = 0.                              (201)

Multiplier:


                                           µ̇iπ,t = G 0 µiy,t − 2απ π̄ˆ iH,t                                (202)
                                 ρµiy,t − µ̇iy,t = λΓ̂y − κ̂y µiπ,t − 2α̂yy ȳˆit − α̂yθ θ̄ˆti              (203)
                                 ρµi − µ̇i = λΓ̂ − κ̂ µi − 2α̂ θ̄ˆi − α̂ ȳˆi
                                    θ,t         θ,t            θ        θ π,t             θθ t       yθ t   (204)

State:


                                                    ȳˆ˙ it = − G 0 (π̄ˆ iH,t + s̃˙ it ) + G ν̄ˆti
                                                       ˙
                                                    θ̄ˆti = ν̄ˆti
                                              π̄ˆ˙ i = ρπ̄ˆ i − κ̂y ȳˆi − κ̂ θ̄ˆi
                                                 H,t            H,t             t        θ t


Initial conditions:


                                                            µiπ,0 = 0                                       (205)
                                                             µiy,0 = ∆                                      (206)

                                                                    100
                                                                        µiθ,0 = −∆ Ḡ.                                                         (207)

We will now reduce the size of the above dynamical system by solving out for µiπ,t and µiθ,t . Using
equations (201), (203) and (204), we can write

                          (κ̂θ + Gκ̂y )µiπ,t =(Γ̂y G + Γ̂θ )λ − (2α̂θθ + G α̂yθ )θ̄ˆti − (2G α̂yy + α̂yθ )ȳˆit .                              (208)

Taking the derivative with respect to time and using (202), we have

                                                                                     ˙
                      (κ̂θ + Gκ̂y )( G 0 µiy,t − 2απ π̄ˆ iH,t ) + (2α̂θθ + G α̂yθ )θ̄ˆti + (2G α̂yy + α̂yθ )ȳˆ˙ it = 0,

from which we can solve for optimal capital controls using the (IS) equation:

                                    (κ̂ + Gκ̂y )( G 0 µiy,t − 2απ π̄ˆ iH,t ) − G 0 (2G α̂yy + α̂yθ )(π̄ˆ iH,t + s̃˙ it )
                          ˆθ̄˙ i = − θ                                                                                                         (209)
                               t
                                                      2α̂θθ + G α̂yθ + G (2G α̂yy + α̂yθ )

Using the (IS) equation again, we have

                                                   (κ̂θ + Gκ̂y )( G 0 µiy,t − 2απ π̄ˆ iH,t ) − G 0 (2G α̂yy + α̂yθ )(π̄ˆ iH,t + s̃˙ it )
        ȳˆ˙ it = − G 0 (π̄ˆ iH,t + s̃˙ it ) − G                                                                                           .   (210)
                                                                        2α̂θθ + G α̂yθ + G (2G α̂yy + α̂yθ )

Finally, using (203) and our solution for µiπ,t above, we find

                                                     κ̂y Γ̂θ − κ̂θ Γ̂y         2κ̂y α̂θθ − κ̂θ α̂yθ         α̂yθ κ̂y − 2κ̂θ α̂yy
                          µ̇iy,t =ρµiy,t + λ                           − θ̄ˆti                      − ȳˆit                      .             (211)
                                                       κ̂θ + Gκ̂y                  κ̂θ + Gκ̂y                   κ̂θ + Gκ̂y

  Therefore, we can write the reduced system of optimality conditions just like in the case of opti-
mal transfers as the dynamical system

                                                          µ̇iy,t = ρµiy,t + K̂θ θ̄ˆti + K̂y ȳˆit + K̂λ λ                                      (212)
                                                             ȳˆ˙ it = Ĵµy µiy,t + Ĵπ π̄ˆ iH,t + Ĵs s̃˙ it                                  (213)
                                                                ˙
                                                             θ̄ˆti = Ĥµy µiy,t + Ĥπ π̄ˆ iH,t + Ĥs s̃˙ it                                    (214)
                                                       π̄ˆ˙ i = ρπ̄ˆ i − κ̂y ȳˆi − κ̂ θ̄ˆi
                                                          H,t          H,t           t       θ t                                               (215)

subject to the initial conditions µiy,0 = ∆, ȳˆ0i = − Ḡ 0 s̃0i + Ḡ θ̄ˆ0i .


D.5.2      Solving the Dynamic System

Viewing the system of optimality conditions as system of linear ODEs, letting Xti = {π̄ˆ iH,t , ȳˆit , θ̄ˆti , µiy,t },
we can write as
                                          Ẋti = AXti + Bti ,                                                   (216)



                                                                               101
where
                                                                                                                                    π̄ˆ iH,0
                                                                                                                                        
                             ρ −κ̂y −κ̂θ 0                                                              0
                                                                                                      ˆi 
                                                                                                                                   ȳˆ0 
                                                                                                                                   i 
                           Ĵπ  0   0    Ĵ                                                          J̄t 
                                               
                                              y ,                                               i                            i
                        A=                                                                           H̄ˆ i  ,
                                                                                                Bt =                              θ̄ˆi  ,
                                                                                                                             X0 = 
                                            µ   
                                                                                                                                            
                           Ĥ
                           π    0   0   Ĥµy                                                       t                          0 
                             0  K̂y K̂θ     ρ                                                          K̄ˆ ti                          ∆

where J̄ˆti = Ĵs s̃˙ it , H̄ˆ ti = Ĥs s̃˙ it , and K̄ˆ ti = K̂θ θ̄ˆti + K̂λ λ.
  The solution to this dynamical system is given by
                                                                                               Z t                  
                                                           Xti      =e      At
                                                                                     X0i   +          e− As Bsi ds       ,
                                                                                                 0


which we can rewrite as
                                                                       Z t                                                  
                                         Xti   =e    At
                                                              X0i   +            e   − As       ˆJ̄ i E + H̄ˆ i E + K̄ˆ i E ds ,
                                                                                                   s 2        s 3       s 4
                                                                            0


where Ei is the 4 × 1 zero vector with a 1 in the ith position. We rewrite the solution for Xti and get
                                                                            Z t
                                   Xti   =e     At
                                                         X0i + K̂λ λ                  e− As E4 ds
                                                                                 0
                                                                 Z t                                         Z t                       
                                                                            − As−ψs                                      − As−ψs
                                                     + W2               e                   E2 ds + W3               e             E3 ds ,
                                                                    0                                          0


where now W2 = −ψa0i Ĵs and W3 = −ψa0i Ĥs .
   Following the same steps as in the previous section for optimal transfers, we arrive at the follow-
ing final expression for the solution of the dynamical system of optimality conditions:
                                                                                                                                            
                                                                            −1                               −1
                                Xti   =e   At
                                                    X0i   + K̂λ λA               E4 + ( A + ψI )                   W2 E2 + W3 E3                 (217)
                                                                                                                                         


                                          − K̂λ λA−1 E4 − ( A + ψI )−1 e−ψt W2 E2 + W3 E3 .
                                                                                         


D.5.3      Stability

There is a unique solution to this system of linear ODEs if and only if A has two negative eigenvalues.
For stability, we require the term in square brackets above to be in the stable manifold. This gives
us four stability conditions, requiring that the term be spanned by the two 4 × 1 eigenvectors of A
associated with the negative eigenvalues. In particular, we have

                                0 =α1 V1 + α2 V2 + X0i − κθ θ̄ˆi A−1 E1 + (Kθ θ̄ˆi + Kλ λ) A−1 E4                                                (218)
                                   + ( A + ψI )−1 W2 E2 + W3 E3 ,
                                                                     


where, as before, Vi is associated with the negative eigenvalue of A λi , and α1 , α2 ∈ C. To guarantee
stability, we solve the vector Z = (α1 , α2 , λ, ∆, π̄ˆ iH,0 , ȳˆ0i , τ̄ˆ0i,r )0 ∈ C7 using seven linearly independent

                                                                                           102
equations that satisfy said stability criterion as well as the initial conditions of the dynamical system.
Equation (218) gives us four of these conditions if we left-multiply both sides by Ei0 for i ∈ {1, 2, 3, 4}.
    As before, the fifth stability condition will be the initial condition, ȳˆ0i + Ḡ 0 s̃0i − Ḡ θ̄ˆ0i = 0. Using the
initial conditions we obtained from the first-order conditions, we can write

                                      0 = (Γ̂y G + Γ̂θ )λ − (2α̂θθ + G α̂yθ )θ̄ˆ0i − (2G α̂yy + α̂yθ )ȳˆ0i .                                               (219)

   Finally, using the budget constraint, we have
                                                                   Z ∞                                       
                                                          0=             e   −ρt
                                                                                       Γ̂y ȳˆit          ˆ i
                                                                                                   + Γ̂θ θ̄t dt
                                                                   0
                                                                   Z ∞                       0
                                                               =         e−ρt Γ̂y E2 + Γ̂θ E3 Xti dt.
                                                                   0

Solving as before yields

                   α1                   0      α2                   0
         0=              Γ̂y E2 + Γ̂θ E3 V1 +         Γ̂y E2 + Γ̂θ E3 V2                                                                                    (220)
                 λ1 − ρ                       λ2 − ρ
                    K̂ λ                 0          1                    0
                 − λ Γ̂y E2 + Γ̂θ E3 A−1 E4 −              Γ̂y E2 + Γ̂θ E3 ( A + ψI )−1 (W2 E2 + W3 E3 ).
                      ρ                            ρ+ψ

   Putting everything together, we can write MZ = N, where

                                                                         K̂λ E10 A−1 E4
                                                                                                                                                            
                    E10 V1                   E10 V2                                                         0     1           0                    0
                    E20 V1                   E20 V2                      K̂λ E20 A−1 E4                     0     0           1                    0
                                                                                                                                                            
                                                                                                                                                            
      
                                                                         K̂λ E30 A−1 E4
                                                                                                                                                             
      
                   E30 V1                   E30 V2                                                         0     0           0                    1         
                                                                                                                                                             
    M=             E40 V1                   E40 V2                      K̂λ E40 A−1 E4                     1     0           0                    0
                                                                                                                                                            
                                                                                                                                                             
                                                                                                                                                            
      
                      0                        0                                0                          0     0           1                  − Ḡ        
                                                                                                                                                             
                       0                        0                          Γ̂θ + G Γ̂y                      0     0   −(2α̂yy G + α̂yθ )   −(2α̂θθ + G α̂yθ )
                                                                                                                                                            
      
              (Γ̂y E2 +Γ̂θ E3 )0       (Γ̂y E2 +Γ̂θ E3 )0
                                                                                                                                                            
                    λ1 − ρ       V1          λ2 − ρ       V2   − K̂ρλ (Γ̂y E2 + Γ̂θ E3 )0 A−1 E4            0     0           0                    0

Let W = ( A + ψI )−1 (W2 E2 + W3 E3 ), then

                                                                                                
                                                                      − E10 W
                                                                      − E20 W
                                                                                                
                                                                                                
                                                                                                
                                                                      − E30 W
                                                                                                
                                                                                                
                                         N=                              0
                                                                      − E4 W                     .
                                                                                                
                                           
                                                                                                 
                                                                      − Ḡ 0 s̃0i
                                                                                                
                                                                                                
                                                                                                
                                           
                                                                        0                       
                                                                                                 
                                              1                     0             − 1
                                             ρ+ψ ( Γ̂y E2 + Γ̂θ E3 ) ( A + ψI ) [W2 E2 + W3 E3 ]


Given these matrices, we can compute the vector Z numerically by setting




                                                                                       103
                                                                Z = M −1 N                                      (221)

over the parameter subspace on which M is invertible.


D.6       Optimal Government Spending
Finally, we consider optimal government spending. We set θ̄ˆti = θ̄ˆi for all t and NFA0i = 0. This again
implies NFAˆ¯ i = 0. Hence, τ i,r = −(Si )−α Gi = τ i,o because the government does not discriminate
              0              t            t     t          t
between agents in the way it sets taxes. Thus, we have τ̄ˆti,r = αυs̄ˆit − υ ḡˆ ti or, substituting in for the
terms of trade,
                                                                  1
                             τ̄ˆti,r =            νy ȳˆit + (νg − ) ḡˆ ti + νθ θ̄ˆi .
                                          αυ                                         
                                       1 − αυντ                   α

    NFA. We start by considering country i’s budget constraint and record an important result: For
all χ ∈ [0, 1] and υ ∈ [0, 1], we have θ̄ˆi = 0 under optimal government spending. Moreover, under
the Cole-Obstfeld calibration trade is balanced in every period and HtM agents and optimizers are
entirely symmetric.
Under optimal government spending, the budget constraint becomes
      Z ∞
                                                                                                1
                                                                                               
0=          e   −ρt
                           Γy +
                                   αυ
                                                ˆ i
                                         νy Γτ ȳt + Γθ +
                                                             αυ         ˆ i
                                                                  ν Γτ θ̄ + Γ g +
                                                                                     αυ
                                                                                           (νg − )Γτ ḡˆ ti dt,
      0                         1 − αυντ                  1 − αυντ θ              1 − αυντ      α

and we have

                                                           αυ
                                           Γ̂y = Γy +            νy Γτ = 0
                                                        1 − αυντ
                                                           αυ           1
                                           Γ̂ g = Γ g +          (νg − )Γτ = 0.
                                                        1 − αυντ        α

Therefore, we must have θ̄ˆi = 0. Since the term in square brackets is also equivalent to net exports,
Γ̂y ȳˆit + Γ̂ g ḡˆ ti + Γ̂θ θ̄ˆti = NX
                                       ˆ¯ i , we furthermore find that trade is balanced in every period. This implies
                                          t
that optimizers and HtM agents will have the same consumption profile, since the former do not
save or borrow to smooth their consumption over time.
       As a result, we can rewrite the expression for the rebate as follows:

                                                                                1 
                                           τ̄ˆti,r =
                                                          αυ
                                                                νy ȳˆit + (νg − ) ḡˆ ti .                     (222)
                                                       1 − αυντ                 α

And with that, we can now present the simplified dynamical system characterizing the allocation
under optimal government spending.

   IS equation. The (IS) equation becomes

                                                  ȳˆ˙ it = − G 0 (π̄ˆ iH,t + s̃˙ it ) + F ḡˆ˙ ti ,            (223)



                                                                       104
where
                                                                                  1
                                                     Λg +        1−αυντ Λτ ( νg − α )
                                                                   αυ
                                               F=                     αυνy
                                                                Λy − 1−αυν τ
                                                                             Λτ

NKPC. The Phillips Curve becomes


                                        π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κ̂y ȳˆit − κ̂θ θ̄ˆi − κ̂ g ḡˆ ti ,                            (224)

where
                                                                    αυ            1
                                          κ̂ g = κ g +                    κτ (νg − ).
                                                                 1 − αυντ         α
Initial condition. Finally, we can rewrite the initial condition as


                           Λy ȳˆ0i = −(Λs + αυΛτ )s̃0i + (Λ g − υΛτ ) ḡˆ0i + Λθ θ̄ˆi .                                        (225)

 Planning problem. Therefore, the planning problem for country i under optimal government

spending becomes
                                        Z ∞                                                                          
                              min              e   −ρt
                                                             απ (π̄ˆ iH,t )2   − Ūˆ ti   θ̄ˆti =0,τ̄ˆti,r =αυs̄ˆit
                                                                                                                          dt,   (226)
                             { ḡˆ ti }t≥0 0

subject to

                                      ȳˆ˙ it = − G 0 (π̄ˆ iH,t + s̃˙ it ) + F ḡˆ˙ ti
                                  π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κ̂y ȳˆit − κ̂ g ḡˆ ti
                                 Λy ȳˆ0i = −(Λs + αυΛτ )s̃0i + (Λ g − υΛτ ) ḡˆ0i

Control problem. Again, the conversion from planning to optimal control problem requires two

steps. First, we now only include the initial condition in the Hamiltonian using Lagrange multiplier
∆, since the isoperimetric budget constraint has dropped out. Second, we substitute out the time
derivative ḡˆ˙ ti in the (IS) equation and replace it with placeholder ν̄ˆti . The following Hamiltonian
emerges:

                                                                ˆi
                    Hti ( xti , uit , µit ) =απ (π̄ˆ iH,t )2 − Ūt θ̄ˆi =0,τ̄ˆ i,r =αυs̄ˆi
                                                                      t       t          t
                                                                                                
                                                           ˆ i                             i ˆ i
                                             + ∆ Λy ȳ0 + (Λs + αυΛτ )s̃0 − (Λ g − υΛτ ) ḡ0
                                                                                         
                                             + µy,t F ν̄ˆt − G (π̄ˆ H,t + s̃˙ t )
                                                  i           i    0     i           i


                                           + µig,t ν̄ˆti



                                                                     105
                                                                                                   
                                                 + µiπ,t                ˆ i          ˆ i        ˆ i
                                                                      ρπ̄ H,t − κ̂y ȳt − κ̂ g ḡt .


As before, xti describes the vector of state variables, uit the vector of control variables, and µit the
vector of costates.
Loss function. Finally, we want to express the simplified loss function under government spending

is characterized by
                                 ˆi
                                Ū                                = α̂yy (ȳˆit )2 + α̂ gg ( ḡˆ ti )2 + α̂yg ȳˆit ḡˆ ti ,   (227)
                                  t   θ̄ˆti =0,τ̄ˆti,r =αυs̄ˆit

where

                                 αυ 2         1           αυ           1
           α̂ gg = α gg +                (νg − )2 αττ +          (νg −     )α gτ
                              1 − αυντ         α        1 − αυντ       1−α
                                αυ 2          1             αυ         1           αυ
           α̂yg = 2αττ                 νy (νg − ) + αyg +          (νg − )αyτ +           νy α gτ
                            1 − αυντ           α          1 − αυντ      α        1 − αυντ

and the remaining coefficients are as before.


D.6.1    Optimality Conditions

The Hamiltonian yields the following first-order conditions.

   Optimality:
                                                                  Fµiy,t + µiτ,t = 0.                                          (228)

Multiplier:


                                                       µ̇iπ,t = G 0 µiy,t − 2απ π̄ˆ iH,t                                       (229)
                                       ρµiy,t − µ̇iy,t = −κ̂y µiπ,t − 2α̂yy ȳˆit − α̂yg ḡˆ ti                                (230)
                                       ρµig,t − µ̇ig,t = −κ̂ g µiπ,t − 2α̂ gg ḡˆ ti − α̂yg ȳˆit                              (231)

State:


                                                        ȳˆ˙ it = − G 0 (π̄ˆ iH,t + s̃˙ it ) + F ν̄ˆti
                                                        ḡˆ˙ ti = ν̄ˆti
                                                   π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κ̂y ȳˆit − κ̂ g ḡˆ ti

Initial Conditions:


                                                         µiπ,0 = 0                                                             (232)
                                                          µiy,0 = ∆Λy                                                          (233)


                                                                              106
                                                                µig,0 = −∆(Λ g − υΛτ ).                                                        (234)

We will now simplify the above dynamical system by solving out for µiπ,t and µiθ,t . Using equations
(228), (230) and (231), we can write

                                    (κ̂ g + Fκ̂y )µiπ,t = −(2α̂ gg + F α̂yg ) ḡˆ ti − (2F α̂yy + αyg )ȳˆit .                                 (235)

Taking the derivative with respect to time and using (229), we have

                      (κ̂ g + Fκ̂y )( G 0 µiy,t − 2απ π̄ˆ iH,t ) + (2α̂ gg + F α̂yg ) ḡˆ˙ ti + (2F α̂yy + α̂yg )ȳˆ˙ it = 0,

from which we can solve for optimal capital controls using the (IS) equation:

                                        (κ̂ g + Fκ̂y )( G 0 µiy,t − 2απ π̄ˆ iH,t ) − G 0 (2F α̂yy + α̂yg )(π̄ˆ iH,t + s̃˙ it )
                          ḡˆ˙ ti = −                                                                                                          (236)
                                                                2α̂ gg + F α̂yg + F (2F α̂yy + α̂yg )

Using the (IS) equation again, we have

                                                  (κ̂ g + Fκ̂y )( G 0 µiy,t − 2απ π̄ˆ iH,t ) − G 0 (2F α̂yy + α̂yg )(π̄ˆ iH,t + s̃˙ it )
        ȳˆ˙ it = − G 0 (π̄ˆ H,t + s̃˙ it ) − F                                                                                            .   (237)
                                                                        2α̂ gg + F α̂yg + F (2F α̂yy + α̂yg )

Finally, using (230) and our solution for µiπ,t above, we find

                                                                  2κ̂y α̂ gg − κ̂ g α̂yg         α̂yg κ̂y − 2κ̂ g α̂yy
                                        µ̇iy,t =ρµiy,t − ḡˆ ti                          − ȳˆit                       .                       (238)
                                                                      κ̂ g + Fκ̂y                    κ̂ g + Fκ̂y

    Therefore, we can write the reduced system of optimality conditions as

                                                          µ̇iy,t = ρµiy,t + K̃y ȳˆit + K̃ g ḡˆ ti                                            (239)
                                                             ȳˆ˙ it = J̃µy µiy,t + J̃π π̄ˆ iH,t + J̃s s̃˙ it                                  (240)
                                                                ˙
                                                             θ̄ˆti = H̃µy µiy,t + H̃π π̄ˆ iH,t + H̃s s̃˙ it                                    (241)
                                                       π̄ˆ˙ i = ρπ̄ˆ i − κ̃y ȳˆi − κ̃ g ḡˆ i
                                                          H,t           H,t            t          t                                            (242)

subject to the initial conditions µiy,0 = ∆Λy and Λy ȳˆ0i = −(Λs + αυΛτ )s̃0i + (Λ g − υΛτ ) ḡˆ0i .


D.6.2     Solving the Dynamic System

Let Xti = {π̄ˆ iH,t , ȳˆit , ḡˆ ti , µiy,t }. Then we have

                                                                     Ẋti = AXti + Bti ,                                                       (243)




                                                                               107
where
                                                                                                     π̄ˆ iH,0
                                                                                                         
                        ρ −κ̂y −κ̂θ 0                                              0
                                                                                 ˜i 
                                                                                                    ȳˆ0 
                                                                                                    i 
                      J̃π  0   0    J̃                                          J̄t 
                                          
                                         y ,                               i                  i
                   A=                                                           H̄˜ i  ,
                                                                           Bt =                    θ̄ˆi  ,
                                                                                              X0 = 
                                       µ   
                                                                                                             
                      H̃
                      π    0   0   H̃µy                                       t                0 
                        0  K̃y K̃θ     ρ                                          K̄˜ ti             ∆Λy

where J̄˜ti = J̃s s̃˙ it , H̄˜ ti = H̃s s̃˙ it , and K̄˜ ti = K̃λ λ.
   Therefore, following the same steps as in the previous two sections the solution of the dynamical
system of optimality conditions can be written as
                                                                                                      
                                                                      −1
                             Xti   =e   At
                                                 X0i   + ( A + ψI )        W2 E2 + W3 E3 + W4 E4                  (244)
                                                                                                   


                                    − ( A + ψI )−1 e−ψt W2 E2 + W3 E3 ,
                                                                     


where W2 = −ψa0i J̃s and W3 = −ψa0i H̃s .


D.6.3    Stability

As we argued in previous sections, there is a unique solution to this system of linear ODEs if and
only if A has two negative eigenvalues. For stability, we require the term in square brackets above
to be in the stable manifold. In other words, we require the term in square brackets to be spanned by
the two eigenvectors, V1 and V2 , of A that are associated with the two negative eigenvalues, which
we will call λ1 and λ2 . This gives us a system of four linearly independent equations

                        0 =α1 V1 + α2 V2 + X0i + ( A + ψI )−1 W2 E2 + W3 E3 + W4 E4 ,
                                                                                   


where α1 , α2 ∈ C.
    Unlike in the previous two sections, we now only have to solve for six variables which we sum-
marize in the vector Z = (α1 , α2 , ∆, π̄ˆ iH,0 , ȳˆ0i , τ̄ˆ0i,r )0 ∈ C6 . Equation (218) gives us four of these condi-
tions if we left-multiply both sides by Ei0 for i ∈ {1, 2, 3, 4}.
    The fifth stability condition will be the initial condition, Λy ȳˆ0i = −(Λs + αυΛτ )s̃0i + (Λ g − υΛτ ) ḡˆ0i .
The sixth and final stability condition we obtain from one of the initial conditions of the dynamical
system of optimality conditions,

                                    0 = −(2α̂ gg + F α̂yg ) ḡˆ0i − (2F α̂yy + αyg )ȳˆ0i .                       (245)




                                                                      108
   In matrix form, this system of linear equations can be written MZ = N, where
                                                                                                      
                         E0 V1    E10 V2 0                    1         0                  0
                        10
                        E2 V1    E20 V2 0                    0         1                  0
                                                                                                       
                                                                                                       
                                                                                                      
                        E0 V     E30 V2 0                    0         0                  1
                             1
                                                                                                       
                   M =  30
                                                                                                      
                        E4 V1    E40 V2 Λy                   0         0                  0
                                                                                                       
                                                                                                       
                                                                                                      
                        0
                                    0   0                    0       Λy            −(Λ g − υΛτ )     
                           0         0   0                    0 −(2α̂yy F + α̂yg ) −(2α̂ gg + F α̂yg )

and
                                         − E10 ( A + ψI )−1 (W2 E2
                                                                                            
                                                                            + W3 E3 )
                                       − E20 ( A + ψI )−1 (W2 E2           + W3 E3 )
                                                                                     
                                                                                     
                                       − E0 ( A + ψI )−1 (W E              + W3 E3 )
                                        3                    2 2
                               N=                                                     .
                                                                                      
                                       − E40 ( A + ψI )−1 (W2 E2           + W3 E3 )
                                       
                                                                                     
                                       
                                                             −(Λs + αυΛτ )s̃0i       
                                                                                      
                                                                    0

   Given these matrices, we can compute the vector Z numerically by setting

                                                              Z = M −1 N                                   (246)

over the parameter subspace on which M is invertible.


D.7    Optimal Redistribution
We can easily study redistribution as a distinct, fourth policy instrument in the present framework,
even though we have not explicitly discussed it until now.
   We have previously imposed that the government does not discriminate between agents when
funding its own outlays. To introduce redistribution as a distinct policy instrument, we remove this
constraint. In addition, we set NFA0i = 0, implying that country i does not receive international
transfers. Therefore, the only relevant constraint becomes

                                            χτ̄ˆti,r + (1 − χ)τ̄ˆti,o = αυs̄ˆit ,                          (247)

since government spending is not used, ḡˆ ti = 0. Finally, the social planner cannot use capital controls,
either, so that θ̄ˆti = θ̄ˆi for all t.
    Note that the only important difference between the characterization of optimal redistribution
and optimal transfers is country i’s budget constraint. In particular, we now have NFA0i = 0 so that
                                  Z ∞                                                           
                             0=         e   −ρt
                                                      ȳˆit   − (1 − υ)αs̄ˆit   − (1 − υ)c̄ˆit       dt,   (248)
                                   0




                                                                   109
where NX ˆ¯ i = ȳˆi − (1 − υ)αs̄ˆi − (1 − υ)c̄ˆi . We can rewrite the budget constraint using earlier results
            t       t             t             t
so that
        Z ∞                                                                                               
   0=         e −ρt                                     i                      ˆ i                       i,r
                       1 − α(1 − υ)νy − (1 − υ)ζ y ȳˆ t − (1 − υ)(ανθ + ζ θ )θ̄ − (1 − υ)(αντ + ζ τ )τ̄ˆt dt,
         0


or, more conveniently,
                                               Z ∞                                                          
                                      0=              e   −ρt
                                                                    Γ∗y ȳˆit   + Γ∗θ θ̄ˆi   + Γ∗τ τ̄ˆti,r       dt.       (249)
                                                 0


D.7.1   Optimal Control Problem

Exploiting the similarity between transfers and redistribution, we can simply adopt the same loss
function, IS equation, Phillips Curve and initial condition. The planning problem can therefore be
written as                          Z ∞                             
                              min       e −ρt        i 2   ˆ
                                                απ (π ) − Ū i
                                                                       dt,                   (250)
                                                                                H,t              t θ̄ˆi =θ̄ˆi , ḡˆ i =0
                              θ̄ˆi ,{τ̄ˆti,r }t≥0 0                                                   t             t


subject to

                                             ȳˆ˙ it = − D 0 (π̄ˆ iH,t + s̃˙ it ) + D ν̄ˆti
                                             τ̄ˆ˙ti,r = ν̄ˆti
                                         π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − κθ θ̄ˆi − κτ τ̄ˆti,r

where D 0 = Λ Λs
                 and D = Λ                                                    ˆi          i       ˆi      ˆ i,r
                            Λy , and also subject to the intial condition Λy ȳ0 = − Λs s̃0 + Λθ θ̄ + Λτ τ̄0 .
                             τ
               y
Instead of the budget constraint under transfers, however, we now use the budget constraint pre-
sented in (249). As before, the associated optimal control problem can be characterized via the Hamil-
tonian

                                                                   ˆi
                           H ( xti , uit , µit ) =απ (π iH,t )2 − Ū                                                       (251)
                                                                    t θ̄ˆi =θ̄ˆi , ḡˆ i =0
                                                                         t             t
                                                                                             
                                                          ∗ ˆi      ∗ ˆ i,r              ∗ ˆi
                                                  + λ Γy ȳt + Γτ τ̄t + Γθ θ̄
                                                                                                      
                                                               i          i
                                                  + ∆ Λy ȳˆ0 + Λs s̃0 − Λθ θ̄ − Λτ τ̄ˆ0   ˆ i     i,r

                                                                                                
                                                  + µy,t D ν̄ˆt − D (π̄ˆ H,t + s̃˙ t )
                                                      i          i     0      i                i


                                                      + µiτ,t ν̄ˆti
                                                                                                   
                                                         i          i         i       ˆ i       i,r
                                                      + µπ,t ρπ̄ˆ H,t − κy ȳˆt − κθ θ̄ − κτ τ̄ˆt ,


where xti , uit , and µit denote the vectors of state variables, control variables, and costates, respectively.
  Reducing the system of the first-order conditions associated with this control problem as before,



                                                                          110
we can summarize the optimal allocation using the dynamical system

                                                                              Ẋti = AXti + Bti ,                                                (252)

where Xti = {π̄ˆ iH,t , ȳˆit , τ̄ˆti,r , µiy,t } and

                                                                                                 −κθ θ̄ˆi                   π̄ˆ iH,0
                                                                                                                                
                              ρ −κ y −κ τ 0
                                                                                                                           ȳˆ0 
                                                                                                i                        i 
                            Jπ  0    0   J                                                     J̄t 
                                              
                         A=                 y 
                                                 ,                                       Bti = 
                                                                                                H̄ i  ,           X0i = 
                                                                                                                           τ̄ˆ i,r  ,
                                           µ   
                                                                                                                                    
                           H
                            π   0    0   Hµy                                                    t                     0 
                              0 Ky   Kτ    ρ                                                        i
                                                                                                  K̄t                           ∆Λy

and where J̄ti = Js s̃˙ it , H̄ti = Hs s̃˙ it , and K̄ti = Kθ θ̄ˆi + Kλ λ.
   The solution to this dynamical system is, as before, given by
                                                                                                                                         
                 Xti   =e     At
                                       X0i   − κθ θ̄ˆi A−1 E1 + (Kθ θ̄ˆi + Kλ λ) A−1 E4 + ( A + ψI )−1 W2 E2 + W3 E3                             (253)
                                                                                                                     


                           + κθ θ̄ˆi A−1 E1 − (Kθ θ̄ˆi + Kλ λ) A−1 E4 − ( A + ψI )−1 e−ψt W2 E2 + W3 E3
                                                                                                                                      


D.7.2      Stability

To guarantee the stability of this system, we want to solve for the vector Z = (α1 , α2 , λ, ∆, π̄ˆ iH,0 , ȳˆ0i , τ̄ˆ0i,r )0 ∈
C7 using a set of stability conditions. We use the same first six stability conditions as for optimal
transfers. The seventh stability condition, however, is now given by

                              Γ∗θ ˆi       α1                                 α2
                           0 = θ̄ +              (Γ∗y E2 + Γ∗τ E3 )0 V1 +         (Γ∗y E2 + Γ∗τ E3 )0 V2                                         (254)
                              ρ          λ1 − ρ                           λ2 − ρ
                                  κ θ̄ˆi                               K θ̄ˆi + Kλ λ ∗
                              + θ (Γ∗y E2 + Γ∗τ E3 )0 A−1 E1 − θ                    (Γy E2 + Γ∗τ E3 )0 A−1 E4
                                    ρ                                         ρ
                                     1
                              −           (Γ∗y E2 + Γ∗τ E3 )0 ( A + ψI )−1 [W2 E2 + W3 E3 ].
                                  ρ+ψ

     Putting everything together, we can write MZ = N, where

                                                                             Kλ E10 A−1 E4
                                                                                                                                                  
                     E10 V1                        E10 V2                                               0    1          0                  0
                     E20 V1                        E20 V2                    Kλ E20 A−1 E4              0    0          1                  0
                                                                                                                                                  
                                                                                                                                                  
                                                                             Kλ E30 A−1 E4
                                                                                                                                                  
      
                    E30 V1                        E30 V2                                               0    0          0                  1       
                                                                                                                                                   
    M=              E40 V1                        E40 V2                    Kλ E40 A−1 E4              Λy   0          0                  0
                                                                                                                                                  
                                                                                                                                                   
                                                                                                                                                  
      
                       0                             0                             0                   0    0         Λy               −Λτ        
                                                                                                                                                   
                        0                             0                       Γτ + DΓ∗y
                                                                               ∗                        0    0   −(2αyy D + αyτ )   −(2αττ + Dαyτ )
                                                                                                                                                  
      
               (Γ∗y E2 +Γ∗τ E3 )0            (Γ∗y E2 +Γ∗τ E3 )0
                                                                                                                                                  
                     λ1 − ρ       V1               λ2 − ρ       V2   − Kρλ (Γ∗y E2 + Γ∗τ E3 )0 A−1 E4   0    0          0                  0


     and



                                                                                       111
                                                                                                                                                          
                                                                       − E10 W
                                                                       − E20 W
                                                                                                                                                          
                                                                                                                                                          
                                                                                                                                                          
    
                                                                      − E30 W                                                                             
                                                                                                                                                           
  N=                                                                  − E40 W
                                                                                                                                                          
                                                                                                                                                           
                                                                    −Λs s̃0i + Λθ θ̄ˆi
                                                                                                                                                          
                                                                                                                                                          
                                                                                                                                                          
                                                                    (α + Dα )θ̄ˆi
                                                                                                                                                          
                                                                  τθ     yθ                                                                               
            Γ∗             κθ θ̄ˆi                       Kθ θ̄ˆi                                      (Γ∗y E2 +Γ∗τ E3 )0
           − ρθ θ̄ˆi
                                                                                                                                                          
                       −           ∗
                            ρ ( Γy E2   + Γτ E3 ) A E_1 + ρ (Γy E2 + Γτ E3 )0 A−1 E4
                                           ∗     0 − 1           ∗    ∗                        +            ρ+ψ          ( A + ψI )−1 [W2 E2   + W3 E3 ]

where W = −κθ θ̄ˆi A−1 E1 + Kθ θ̄ˆi A−1 E4 + ( A + ψI )−1 [W2 E2 + W3 E3 ]. Given these matrices, we can

compute the vector Z numerically by setting

                                                                Z = M −1 N                                                                             (255)

over the parameter subspace on which M is invertible.


D.8    Optimal Deficits
We now study a particular form of deficits in this economy. In particular, we allow the government
to accrue debt over time and rebate these funds to households. With the presence of HtM agents,
Ricardian equivalence breaks down and such a policy can be effective.
    Instead of the per-period government budget constraint, we now impose an isoperimetric con-
straint of the form           Z ∞                                          
                                    −ρt     ˆ i,r        ˆ i,o   ˆ i    ˆ i
                          0=      e       χτ̄t + (1 − χ)τ̄t + υ ḡt − αυs̄t dt.               (256)
                                                0

Implicitly, this constraint states that the government can now accumulate debt from one period to
the next. In this section, we assume that ḡˆ ti = 0 for all t because we want to narrow in on the question
of budget deficits, independent from the question of optimal government spending. We furthermore
assume that θ̄ˆti = θ̄ˆi , since the government cannot use capital controls, and NFA0i = 0, since we do
not want to consider cross-border transfers here.
    The second key assumption we make is that the government does not discriminate between
agents when rebating its deficit funds, which implies that τ̄ˆti,r = τ̄ˆti,o . Therefore, the inter-temporal
government budget constraint becomes
                                                          Z ∞                                 
                                                     0=         e   −ρt       ˆτ̄ti,r − αυs̄ˆit dt.                                                    (257)
                                                            0


   We now consider the problem where the social planner only has access to ex-post transfers, as in
body of the paper. In particular, we have θ̄ˆti = θ̄ˆi for all t and ḡˆ ti = 0.

   IS, NKPC and initial condition. The problem laid out above is almost identical to that of Section
4 with optimal fiscal union transfers. In fact, the only difference in the two planning problems
comes from the budget constraint and the now new isoperimetric government budget constraint. In
particular, it is easy to verify that we can adopt the same (IS) equation, (NKPC) and initial condition

                                                                          112
as we specified in Section 4. In particular, the (IS) equation is given by

                                                        ȳˆ˙ it = − D 0 (π̄ˆ iH,t + s̃˙ it ) + D τ̄ˆ˙ti,r .

The (NKPC) is given by
                                                 π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − κθ θ̄ˆi − κτ τ̄ˆti,r ,

and the initial condition is
                                                    Λy ȳˆ0i = −Λs s̃0i + Λθ θ̄ˆi + Λτ τ̄ˆ0i,r .

NFA. Finally, we rederive country i’s budget constraint. Recall that in the general derivation of

the NFA condition in Section 3, we assumed that the government budget constraint held period-by-
period. Under deficit spending, we have

   Wti Nti,o − Pti Cti,o + PH,t
                            i
                                Yti − Wti Nti + Pti τti,r = Wti Nti,o − Pti Cti,o + PH,t
                                                                                     i
                                                                                         Yti − Wti Nti + Pti Tti,r − Pti ZH,t
                                                                                                                          i

                                                                          = Wti Nti,o − Pti Cti,o + Pti Cti,r − Wti Nti,r
                                                                          = Pti (Cti,r − Cti,o ) − Wti ( Nti,r − Nti,o ).

Therefore, we have
                      Z ∞
                              1
                                                                    
                                         i,r     i,o       i,r   i,o
        NFA0i   =−     e        −ρt   i                  i
                                    Pt (Ct − Ct ) − Wt ( Nt − Nt ) dt
                    0        PFi
                   Z ∞
                                                              1
                                                                                                 
                         −ρt      i −(1−α)     i,r   i,o         i,r   i,r φ i −(1−α)    i,r  i,o
                =−     e       ( St )        (Ct − Ct ) −       C ( Nt ) (St )        ( Nt − Nt ) dt
                    0                                      1−υ t

since
                                                                                      i
                  Wti   Wti Pti                 i,r φ Pt PH,t
                                   1                    i        1
                                        i,r
                   i
                      =  i   i
                                =     Ct    ( Nt   )  i    i
                                                              =     Cti,r ( Nti,r )φ (Sti )−(1−α) .
                  PF    Pt PF     1−υ                PH,t PF    1−υ

Linearizing, we find
                                                   Z ∞                                                                
                               NFA0i        =−             e   −ρt
                                                                         (1 − υ)(ci,r
                                                                                  t       − ci,o     i,r
                                                                                             t ) − (nt        − ni,o
                                                                                                                 t )       dt.   (258)
                                                    0

                                       ˆ¯ i = 0,
Adopting gap notation and noting that NFA 0

                     Z ∞                                                                     
                0=         e   −ρt
                                         (1 − υ)(c̄ˆi,r
                                                    t     − c̄ˆi,o     ˆ i,r
                                                               t ) − ( n̄t        − n̄ˆ i,o
                                                                                        t )       dt
                     0
                     Z ∞
                                                                                1
                                                                                                            
                                         (1 − υ)(c̄ˆi,r   − θ̄ˆi − (1 − α)s̄ˆit ) − (n̄ˆ i,r            i,r
                                                                                           i      χ
                 =     e       −ρt
                                                                                        n̄ˆ +
                                                                                         t −        n̄ˆ ) dt
                    0
                                                    t
                                                                              1−χ t 1−χ t
                   Z ∞
                                                                                 1
                             
                       e −ρt
                               (1 − υ) ψy ȳˆit + (ψθ − 1)θ̄ˆi + ψτ τ̄ˆti,r +           ȳˆit
                                                                           
                 =
                    0                                                         1−χ
                                                                          1
                                                                                                             
                                             i      ˆ i       i,r
                   − (1 − α)(1 − υ) νy ȳˆt + νθ θ̄ + ντ τ̄ˆt −
                                                                                    i        ˆ i      i,r
                                                                              ηy ȳˆ t + ηθ θ̄ + ητ τ̄ˆt
                                                                                                           
                                                                                                               dt.
                                                                     1−χ

                                                                               113
To simplify notation, we write
                                              Z ∞                                                                   
                                     0=                    e   −ρt
                                                                         Γ∗∗ ˆi    + Γ∗∗ ˆi      + Γ∗∗ ˆ i,r                              (259)
                                                                          y ȳt       θ θ̄          τ τ̄t                dt.
                                                 0


Partial collinearity of NFA and GBC. Comparing the NFA condition with the isoperimetric gov-

ernment budget constraint, which we can write as
                                    Z ∞                                                                                
                             0=             e   −ρt
                                                           (1 − αυντ )τ̄ˆti,r           − αυνy ȳˆit                ˆ i
                                                                                                            − αυνθ θ̄ dt,                 (260)
                                     0


we note that we have
                                                               Γ∗∗
                                                                y                   Γ∗∗
                                                                             =       τ
                                                                                          ≡ ν.                                            (261)
                                                       −αυνy                     1 − αυντ
We can multiply (259) by 1/ν and subtract it from (260). This yields

                                                                                          Γ∗∗
                                                     Z ∞                                       
                                         0=                     e   −ρt               ˆ i
                                                                              − αυνθ θ̄ −  θ ˆi
                                                                                              θ̄ dt,
                                                       0                                   ν

which immediately implies that we must have θ̄ˆi = 0.
Planning problem. Country i’s planning problem can therefore be written as

                                                  Z ∞                                                                          
                                    min                        e   −ρt
                                                                             απ (π̄ˆ iH,t )2   − Ūˆ ti   θ̄ˆti =0, ḡˆ ti =0
                                                                                                                                    dt,   (262)
                               θ̄ˆi ,{τ̄ˆti,r }t≥0 0


subject to

                                                 ȳˆ˙ it = − D 0 (π̄ˆ iH,t + s̃˙ it ) + D τ̄ˆ˙ti,r
                                           π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − κτ τ̄ˆti,r
                                         Λy ȳˆ0i = −Λs s̃0i + Λτ τ̄ˆ0i,r
                                                    Z ∞                           
                                                          −ρt    ∗∗ ˆ i   ∗∗ ˆ i,r
                                               0=       e       Γy ȳt + Γτ τ̄t dt
                                                                   0

              Λs             Λτ
where D 0 =   Λy   and D =   Λy ,   and

                                ˆi
                               Ū                          = αyy (ȳˆit )2 + αττ (τ̄ˆti,r )2 + αyτ ȳˆit τ̄ˆti,r
                                 t   θ̄ˆti =0, ḡˆ ti =0


Control problem. To transform this planning problem into an optimal control problem that we can

work with we replace the time derivative τ̄ˆ˙ti,r in the (IS) equation by a placeholder, ν̄ˆti , and introduce
a new dynamic state equation. The Hamiltonian associated with this control problem can then be




                                                                                 114
written as

                                                                          ˆi
                                H ( xti , uit , µit ) =απ (π̄ˆ iH,t )2 − Ū                                            (263)
                                                                           t θ̄ˆi =0, ḡˆ i =0
                                                                                t         t
                                                                                                  
                                                                      i          i             i,r
                                                       + ∆ Λy ȳˆ0 + Λs s̃0 − Λτ τ̄ˆ0
                                                                                              
                                                        +λ        Γ∗∗ ˆi
                                                                   y ȳt        + Γ∗∗ ˆ i,r
                                                                                   τ τ̄t
                                                                                                                  
                                                        + µiy,t       D ν̄ˆti   −D    0
                                                                                          (π̄ˆ iH,t   + s̃˙ it )

                                                        + µiτ,t ν̄ˆti
                                                                                           
                                                           i          ˆ i    ˆ i      ˆ i,r
                                                        + µπ,t ρπ̄ H,t − κy ȳt − κτ τ̄t ,


where xti = {π̄ˆ iH,t , ȳˆit , τ̄ˆti,r } denotes the vector of state variables, uit = {ν̄ˆti } the vector of control
variables, and µit = {µiπ,t , µiy,t , µiτ,t } the vector of costates.


D.8.1    Optimality Conditions

The Hamiltonian yields the nine first-order conditions

   Optimality:
                                                      Dµiy,t + µiτ,t = 0.                                              (264)

Multiplier:


                                          µ̇iπ,t = D 0 µiy,t − 2απ π̄ˆ iH,t                                            (265)
                               ρµiy,t − µ̇iy,t = Γ∗∗         i           ˆi        ˆ i,r
                                                  y λ − κ y µπ,t − 2αyy ȳt − αyτ τ̄t                                  (266)
                               ρµiτ,t − µ̇iτ,t = Γ∗∗         i           ˆ i,r     ˆi
                                                  τ λ − κ τ µπ,t − 2αττ τ̄t − αyτ ȳt                                  (267)

State:


                                                ȳˆ˙ it = − D 0 (π̄ˆ iH,t + s̃˙ it ) + D ν̄ˆti
                                                τ̄ˆ˙ti,r = ν̄ˆti
                                            π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − κτ τ̄ˆti,r

Initial conditions:


                                                        µiπ,0 = 0
                                                         µiy,0 = ∆Λy



                                                                  115
                                                                    µiτ,0 = −∆Λτ .

We can now solve out for µiπ,t and µiτ,t to reduce the dimensionality of this dynamical system. Using
equations (264), (266) and (267), we can write

                   (κτ + Dκy )µiπ,t = (Γ∗∗     ∗∗                      ˆ i,r                ˆi
                                        y D + Γτ ) λ − (2αττ + Dαyτ ) τ̄t − (2Dαyy + αyτ ) ȳt .                                       (268)

Taking the derivative with respect to time and using (265), we have

                  (κτ + Dκy )( D 0 µiy,t − 2απ π̄ˆ iH,t ) + (2αττ + Dαyτ )τ̄ˆ˙ti,r + (2Dαyy + αyτ )ȳˆ˙ it = 0,

from which we can solve for the rate of change of transfers using the (IS) equation:

                                     (κτ + Dκy )( D 0 µiy,t − 2απ π̄ˆ iH,t ) − D 0 (2Dαyy + αyτ )(π̄ˆ iH,t + s̃˙ it )
                      τ̄ˆ˙ti,r = −                                                                                                     (269)
                                                            2αττ + Dαyτ + D (2Dαyy + αyτ )

Using the (IS) equation again, we have

                                                (κτ + Dκy )( D 0 µiy,t − 2απ π̄ˆ iH,t ) − D 0 (2Dαyy + αyτ )(π̄ˆ iH,t + s̃˙ it )
     ȳˆ˙ it = − D 0 (π̄ˆ iH,t + s̃˙ it ) − D                                                                                      .   (270)
                                                                        2αττ + Dαyτ + D (2Dαyy + αyτ )

Finally, using (266) and our solution for µiπ,t above, we find

                                                κy Γ∗∗      ∗∗
                                                    τ − κτ Γy                       2κy αττ − κτ αyτ         αyτ κy − 2κτ αyy
                    µ̇iy,t   =   ρµiy,t   +λ                            − τ̄ˆti,r                    − ȳˆit                  .        (271)
                                                   κτ + Dκy                            κτ + Dκy                 κτ + Dκy

Therefore, we can write the reduced system of optimality conditions as

                                                    µ̇iy,t = ρµiy,t + Kτ τ̄ˆti,r + Ky ȳˆit + Kλ λ                                     (272)
                                                          ȳˆ˙ it = Jµy µiy,t + Jπ π̄ˆ iH,t + Js s̃˙ it                                (273)
                                                     τ̄ˆ˙ i,r = Hµ µi + Hπ π̄ˆ i + Hs s̃˙ i
                                                      t             y    y,t             H,t         t                                 (274)
                                                   π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − κτ τ̄ˆti,r .                                     (275)


D.8.2    Solving the Dynamical System

We can thus express the dynamical system of first-order conditions as a system of linear ODEs,

                                                                   Ẋti = AXti + Bti                                                   (276)




                                                                               116
for Xti = {π̄ˆ iH,t , ȳˆit , τ̄ˆti,r , µiy,t }. We have

                                                                                                                         π̄ˆ iH,0
                                                                                                                             
                              ρ −κ y −κ τ 0                                                     0
                                                                                                                        ȳˆ0 
                                                                                              i                       i 
                            Jπ  0    0   J                                                   J̄t 
                                              
                                             y ,                                        i                         i
                         A=                                                                  H̄ i  ,
                                                                                        Bt =                           τ̄ˆ i,r  ,
                                                                                                                  X0 = 
                                           µ   
                                                                                                                                 
                           H
                            π   0    0   Hµy                                               t                       0 
                              0 Ky   Kτ    ρ                                                   K̄ti                               ∆Λy

and J̄ti = Js s̃˙ it , H̄ti = Hs s̃˙ it , and K̄ti = Kλ λ.
   Following the same steps as in Section 4, we can write the solution as
                                                        Z t                           Z t                              Z t                     
                 Xti   =e   At
                                     X0i   + Kλ λ              e   − As
                                                                          E4 ds + W2         e   − As−ψs
                                                                                                           E2 ds + W3         e   − As−ψs
                                                                                                                                            E3 ds ,
                                                          0                             0                                0


where W2 = −ψa0i Js and W3 = −ψa0i Hs . Assuming that the economy is in the parameter subspace
where A is nonsingular, we can solve out the integrals to arrive at
                                                                                                                                     
                                                                             −1                        −1
                                     Xti   =e   At
                                                         X0i   + Kλ λA            E4 + ( A + ψI )           W2 E2 + W3 E3                             (277)
                                                                                                                                  


                                             − Kλ λA−1 E4 − ( A + ψI )−1 e−ψt W2 E2 + W3 E3 .
                                                                                           


D.8.3      Stability

Our main departure from the solution in Section 4 is the following stability analysis. To guarantee
uniqueness, we still require

                                             X0i + Kλ λA−1 E4 + ( A + ψI )−1 W2 E2 + W3 E3
                                                                                                                        


to be in the stable manifold. Let Vj , j ∈ {1, 2}, denote the eigenvector of A associated with the
negative eigenvalue λ j . We can express this stability condition as

                          0 = α1 V1 + α2 V2 + X0i + Kλ λA−1 E4 + ( A + ψI )−1 W2 E2 + W3 E3 ,                                                         (278)
                                                                                           


for some α j ∈ C, j ∈ {1, 2}.
    Under deficit spending, however, we now have an extra parameter that we need to solve for.
That is, we now need to solve the vector Z = (α1 , α2 , λ, ∆, π̄ˆ iH,0 , ȳˆ0i , τ̄ˆ0i,r )0 ∈ C7 to satisfy the stability
requirement and initial conditions. Equation (278) yields four of the desired eight conditions. As
before, we left-multiply (278) by Ei0 for each i ∈ {1, 2, 3, 4}.
    The first initial condition we can use is Λy ȳˆ0i = −Λs s̃0i + Λτ τ̄ˆ0i,r . Another one we obtain by writing

                 (κτ + Dκy )µiπ,0 = 0 = (Γ∗∗     ∗∗                      ˆ i,r                ˆi
                                          y D + Γτ ) λ − (2αττ + Dαyτ ) τ̄0 − (2Dαyy + αyτ ) ȳ0 .                                                    (279)

     The remaining two conditions we obtain from the two constraints associated with λ1 and λ2 ,


                                                                                     117
respectively. Note that we can write

            Xti =e At − α1 V1 − α2 V2 − Kλ λA−1 E4 − ( A + ψI )−1 e−ψt W2 E2 + W3 E3
                                                                                    

                 = − α1 eλ1 t V1 − α2 eλ2 t V2 − Kλ λA−1 E4 − ( A + ψI )−1 e−ψt W2 E2 + W3 E3 .
                                                                                             


The budget constraint then becomes
                                              Z ∞                                       
                                        0=          e   −ρt
                                                                  Γ∗∗ ˆi
                                                                   y ȳt   + Γ∗∗ ˆ i,r
                                                                              τ τ̄t          dt
                                              0
                                              Z ∞
                                                                         0 i
                                          =         e−ρt (Γ∗∗      ∗∗
                                                           y E2 + Γτ E3 ) Xt dt,
                                              0

where we can plug in the solution for Xti and solve out the integrals to obtain

                              α1                               α2
                       0=           (Γ∗∗       ∗∗    0
                                      y E2 + Γτ E3 ) V1 +           (Γ∗∗ E2 + Γ∗∗    0
                                                                               τ E3 ) V2                         (280)
                            λ1 − ρ                           λ2 − ρ y
                               K λ                     0 −1
                            − λ (Γ∗∗            ∗∗
                                       y E2 + Γτ E3 ) A E4
                                 ρ
                                  1                                −1
                            −         (Γ∗∗ E2 + Γ∗∗     0
                                                  τ E3 ) ( A + ψI ) [W2 E2 + W3 E3 ].
                               ρ+ψ y

   Putting everything together, we can write MZ = N. Letting Ẽ = (Γ∗∗      ∗∗
                                                                    y E2 + Γτ E3 ) for ease of
notation, we have


                  E10 V1     E10 V2      Kλ E10 A−1 E4              0      1        0                0
                                                                                                            

                  E20 V1     E20 V2      Kλ E20 A−1 E4              0      0        1                0
                                                                                                            
                                                                                                            
                  E30 V1     E30 V2      Kλ E30 A−1 E4              0      0        0                1
                                                                                                            
                                                                                                            
                                                                                                            
         M=      E40 V1     E40 V2      Kλ E40 A−1 E4              Λy     0        0                0
                                                                                                            
                                                                                                             
                     0          0               0                   0      0       Λy             −Λτ
                                                                                                            
                                                                                                            
                                                                                                            
                     0          0        Γ∗∗
                                          τ + DΓy
                                                    ∗∗              0      0 −(2αyy D + αyτ ) −(2αττ + Dαyτ )
                                                                                                            
           
                  Ẽ0
                 λ1 −ρ V1
                             Ẽ0
                            λ2 −ρ V2    − Kρλ Ẽ0 A−1 E4            0      0                  0     0

   and



                                                      − E10 W
                                                                         

                                                      − E20 W
                                                                         
                                                                         
                                                         E 0W
                                                                         
                                        
                                                     −    3
                                                                          
                                                                          
                                      N=             − E40 W
                                                                         
                                                                          
                                                         Λ    s̃ i
                                                                         
                                        
                                                     −     s    0
                                                                          
                                                                          
                                                          0
                                                                         
                                                                         
                                           Ẽ 0         −1
                                          ρ+ψ ( A + ψI ) [W2 E2 + W3 E3 ]


                                                                    118
  where W = ( A + ψI )−1 [W2 E2 + W3 E3 ]. Given these matrices, we can compute the vector Z
numerically by setting
                                          Z = M −1 N                                    (281)

over the parameter subspace on which M is invertible.


D.9       Jointly Optimal Fiscal Policy
Finally, we consider optimal fiscal policy, allowing for both government spending and redistribution.
The allocation derived under jointly optimal government and deficit spending would be identical.
                                                                     ˆ¯ i = 0. We do not allow for capital
         In the absence of international transfers, we have NFA0i = NFA 0
                  ˆ     ˆ
controls, θ̄t = θ̄ , and impose the per-period government budget constraint, χτ̄ˆti,r + (1 − χ)τ̄ˆti,o +
                    i     i

υ ḡˆ ti − αυs̄ˆit = 0.
         Since the government’s budget is balanced in every period, the original external budget con-
straint for country i holds,
                               Z ∞                                                                                                    Z ∞
                         0=          e   ρt
                                                  ȳˆit   − α(1 − υ)s̄ˆit          − (1 − υ)c̄ˆit        − υ ḡˆ ti       dt ≡                          ˆ¯ i dt
                                                                                                                                                  e−ρt NX         (282)
                                                                                                                                                           t
                                 0                                                                                                      0


where as before s̄ˆit = νy ȳˆit + ντ τ̄ˆti,r + νθ θ̄ˆi + νg ḡˆ ti and c̄ˆit = ζ y ȳˆit + ζ g ḡˆ ti + ζ τ τ̄ˆti,r + ζ θ θ̄ˆi . We can simplify
to write the NFA condition as
                                            Z ∞                                                       
                                                  −ρt      ∗ ˆi       ∗ ˆi      ∗ ˆ i,r       ∗ ˆi
                                   0=           e         Γy ȳt + Γθ θ̄ + Γτ τ̄t + Γ g ḡt dt,                                             (283)
                                                            0


where

                                                           Γ∗y = 1 − α(1 − υ)νy − (1 − υ)ζ y
                                                           Γ∗θ = −α(1 − υ)ντ − (1 − υ)ζ τ
                                                           Γ∗τ = −α(1 − υ)νθ − (1 − υ)ζ θ
                                                           Γ∗g = −υ − α(1 − υ)νg − (1 − υ)ζ g .


    Planning problem. We can again adopt the (IS), (NKPC) and initial condition as they were spec-
ified in Section 4. Therefore, we can write country i’s disaggregated planning problem as
                                                                       Z ∞                                                             
                                                          min                  e   −ρt
                                                                                             απ (π̄ˆ iH,t )2   − Ūˆ ti   θ̄ˆti =θ̄ˆi
                                                                                                                                            dt,                   (284)
                                              θ̄ˆi ,{τ̄ˆti,r , ḡˆ ti }t≥0 0


subject to

                                               ȳˆ˙ it = − D 0 (π̄ˆ iH,t + s̃˙ it ) + D̄ ḡˆ˙ ti + D τ̄ˆ˙ti,r
                                         π̄ˆ˙ i = ρπ̄ˆ i − κy ȳˆi − κ θ̄ˆi − κτ τ̄ˆ i,r − κ g ḡˆ i
                                               H,t                 H,t               t          θ               t                   t


                                                                                             119
                                              Λy ȳˆ0i = −Λs s̃0i + Λθ θ̄ˆi + Λτ τ̄ˆ0i,r + Λ g ḡˆ0i
                                                         Z ∞                                             
                                                               −ρt    ∗ ˆi     ∗ ˆi       ∗ ˆ i,r    ∗ ˆi
                                                    0=       e       Γy ȳt + Γθ θ̄ + Γτ τ̄t + Γ g ḡt dt
                                                                0

                 Λs                   Λg                     Λτ
where D 0 =      Λy ,   D̄ =          Λy   and D =           Λy ,   and

                   ˆi
                  Ūt   θ̄ˆti =θ̄ˆi
                                       =αyy (ȳˆit )2 + αθθ (θ̄ˆi )2 + αττ (τ̄ˆti,r )2 + α gg ( ḡˆ ti )2
                                           + αyθ ȳˆit θ̄ˆi + αyg ȳˆit ḡˆ ti + αyτ ȳˆit τ̄ˆti,r + α gθ ḡˆ ti θ̄ˆi + α gτ ḡˆ ti τ̄ˆti,r + ατθ τ̄ˆti,r θ̄ˆi .

Control problem. As before, we incorporate the initial condition and the country budget constraint

into the objective function using Lagrange multipliers ∆ and λ, respectively. Furthermore, we re-
place the time derivatives ḡˆ˙ ti and τ̄ˆ˙ti,r in the (IS) equation with ω̄ˆ ti and ν̄ˆti , respectively, to recover the
standard optimal control problem structure. We add these equations as dynamic state equations.
We can now write down the Hamiltonian associated with this control problem. We have

                                                                                ˆi
                                      H ( xti , uit , µit ) =απ (π̄ˆ iH,t )2 − Ū                                                                                  (285)
                                                                                 t θ̄ˆi =θ̄ˆi
                                                                                      t
                                                                                                                      
                                                                            i          i             i       ˆ
                                                             + ∆ Λy ȳˆ0 + Λs s̃0 − Λ g ḡˆ0 − Λθ θ̄ − Λτ τ̄ˆ0 i   i,r

                                                                                                             
                                                                       ∗ ˆi      ∗ ˆi         ∗ ˆ i,r    ∗ ˆi
                                                             + λ Γy ȳt + Γ g ḡt + Γτ τ̄t + Γθ θ̄
                                                                                                                
                                                             + µy,t D ν̄ˆt + D̄ ω̄ˆ t − D (π̄ˆ H,t + s̃˙ t )
                                                                  i           i          i       0     i       i


                                                                + µiτ,t ν̄ˆti
                                                                + µig,t ω̄ˆ ti
                                                                                                                   
                                                                   i           ˆ i   ˆ i      ˆ i     ˆ i,r     ˆ i
                                                                + µπ,t ρπ̄ H,t − κy ȳt − κθ θ̄ − κτ τ̄t − κ g ḡt ,


where xti = {π̄ˆ iH,t , ȳˆit , τ̄ˆti,r , ḡˆ ti } denotes the vector of state variables, uit = {ν̄ˆti , ω̄ˆ ti } the vector of control
variables, and µit = {µiπ,t , µiy,t , µig,t , µiτ,t } the vector of costates.


D.9.1     Optimality Conditions

The first-order optimality conditions associated with this problem are given by

    Optimality:

                                                                            Dµiy,t + µiτ,t = 0                                                                     (286)
                                                                            D̄µiy,t + µig,t = 0                                                                    (287)

Multiplier:


                                                                                        120
                                     µ̇iπ,t = D 0 µiy,t − 2απ π̄ˆ iH,t                                                          (288)
                         ρµiy,t − µ̇iy,t = Γ∗y λ − κy µiπ,t − 2αyy ȳˆit − αyθ θ̄ˆi − αyg ḡˆ ti − αyτ τ̄ˆti,r                  (289)
                         ρµi − µ̇i = Γ∗ λ − κ µi − 2α τ̄ˆ i,r − α θ̄ˆi − α ȳˆi − α ḡˆ i
                           τ,t        τ,t            τ       τ π,t       ττ t                     τθ     yτ t        gτ t       (290)
                         ρµig,t   − µ̇ig,t   =     Γ g λ − κ g µπ,t − 2α gg ḡˆ ti
                                                     ∗          i
                                                                                          − αyg ḡˆ − α gθ θ̄ˆ − α gτ τ̄ˆti,r
                                                                                                   i          i
                                                                                                                                (291)

State:


                                              ȳˆ˙ it = − D 0 (π̄ˆ iH,t + s̃˙ it ) + D ν̄ˆti + D̄ ω̄ˆ ti
                                              τ̄ˆ˙ti,r = ν̄ˆti
                                              ḡˆ˙ ti,r = ω̄ˆ ti
                                          π̄ˆ˙ i = ρπ̄ˆ i
                                             H,t               H,t   − κy ȳˆit − κ g ḡˆ ti − κθ θ̄ˆi − κτ τ̄ˆti,r

Initial conditions:


                                                                     µiπ,0 = 0
                                                                      µiy,0 = ∆Λy
                                                                     µiτ,0 = −∆Λτ
                                                                      µig,0 = −∆Λ g .

We can conveniently reduce the dimensionality of this system of differential equations. Following
steps analogous to those in earlier sections, we can write

                                        1
                                                           
                  ḡˆ˙ ti = −                                (κτ + Dκy ) D 0 µiy,t
                          α gτ + Dαyg + D̄ (2αyy D + αyτ )
                                                                
                         − 2απ (κτ + Dκy ) + D (2αyy D + αyτ ) π̄ˆ iH,t − D 0 (2αyy D + αyτ )s̃˙ it
                                                0

                                                              
                         + D (2αyy D + αyτ ) + 2αττ + Dαyτ τ̄ˆ˙ti,r

                      ≡lµy µiy,t + lπ π̄ˆ iH,t + ls s̃˙ it + lτ τ̄ˆ˙ti,r .

   We then find that

                                                          1
         τ̄ˆ˙ti,r = −                                                                            ·
                      2αyy D D̄ + αyg D + α gτ + D̄αyτ + lτ (2αyy D̄2 + αyg D̄ + 2α gg + D̄αyg )
                                                                             
                                                    2
                      D (κ g + D̄κy ) + lµy (2αyy D̄ + αyg D̄ + 2α gg + D̄αyg ) µiy,t
                        0

                                                                                                    
                                  2
                    + lπ (2αyy D̄ + αyg D̄ + 2α gg + D̄αyg ) − 2απ (κ g + D̄κy ) − D (2αyy D̄ + αyg ) π̄ˆ iH,t
                                                                                      0




                                                                              121
                                                                            
               − D (2αyy D̄ + αyg ) + ls (2αyy D̄ + αyg D̄ + 2α gg + D̄αyg ) s̃˙ it
                        0                                        2


            ≡ Hµy µiy,t + Hπ π̄ˆ iH,t + Hs s̃˙ it

and

                            ḡˆ˙ ti =lµy µiy,t + lπ π̄ˆ iH,t + ls s̃˙ it + lτ ( Hµy µiy,t + Hπ π̄ˆ iH,t + Hs s̃˙ it ).

Using the (IS) equation, we have

               ȳˆ˙ it =( DHµy + D̄Lµy )µiy,t + ( DHπ + D̄Lπ − D 0 )π̄ˆ iH,t + ( DHs + D̄Ls + D 0 )s̃˙ it .

Finally, we can write

                                            κy Γ∗g − κ g Γ∗y      2αyy κ g − αyg κy           αyg κ g − 2α gg κy
                      µ̇iy,t =ρµiy,t + λ                        + ȳˆit              + ḡˆ ti
                                              κ g + D̄κy              κ g + D̄κy                 κ g + D̄κy
                                        αyτ κ g − α gτ κy        αyθ κ g − α gθ κy
                              + τ̄ˆti,r                   + θ̄ˆi                   .
                                          κ g + D̄κy               κ g + D̄κy

    Summarizing, we obtain the system

                                 π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κy ȳˆit − κ g ḡˆ ti − κθ θ̄ˆi − κτ τ̄ˆti,r                            (292)
                                         ȳˆ˙ it ≡ Jµy µiy,t + Jπ π̄ˆ iH,t + Js s̃˙ it                                           (293)
                                     τ̄ˆ˙ti,r = Hµy µiy,t + Hπ π̄ˆ iH,t + Hs s̃˙ it                                              (294)
                                     ḡˆ˙ ti ≡ Lµy µiy,t + Lπ π̄ˆ iH,t + Ls s̃˙ it                                               (295)
                                   µ̇iy,t ≡ ρµiy,t + Kλ λ + Ky ȳˆit + K g ḡˆ ti + Kτ τ̄ˆti,r + Kθ θ̄ˆi .                       (296)


D.9.2    A Targeting Rule for Government Spending

If we let Xti = {π̄ˆ iH,t , ȳˆit , τ̄ˆti,r , ḡˆ ti , µiy,t }, then the dynamical system of optimality conditions can be
written as
                                                                   Ẋti = AXti + Bti ,                               (297)

where
                   ρ −κ y −κ τ −κ g 0                                                  −κθ θ̄ˆi                     π̄ˆ iH,0
                                                                                                                        
                                                                                      i                          ˆi 
                 Jπ  0    0    0   Jµy                                              J̄t                        ȳ0 
                                        
                                                                                 i                            i
                                                                                                                   i,r 
                                                                                                                   τ̄ˆ0  ,
                                                                                           i 
              A=
                 Hπ  0    0    0   Hµy ,                                           H̄t  ,
                                                                                Bt =                        X0 = 
                                                                                             
                                                                                                                             
                                                                                      i                          ˆi 
                 Lπ  0    0    0   L µy                                             L̄t                        ḡ0 
                                        

                   0 Ky   Kτ   Kg    ρ                                                  K̄ti                        ∆Λy
and

                                                             J̄ti = Js s̃˙ it

                                                                         122
                                                          H̄ti = Hs s̃˙ it
                                                          L̄it = Ls s̃˙ it
                                                          K̄ti = Kθ θ̄ˆi + Kλ λ.

    The coefficient matrix A has one 0-eigenvalue. This implies that one of the differential equations
can be expressed as a function of the other variables in Xti . We will exploit this to derive an explicit
targeting rule for government spending using tools from linear algebra. We could also prove this
result directly starting from the system (292) - (296).
    If A has a 0-eigenvalue, then so does its transpose A0 . Hence, there exists a vector E such that
A0 E = 0, which gives us E0 A = 0. That is, E is the eigenvector associated with the 0-eigenvalue of
the transpose matrix A0 . We have

                                             E0 Ẋti = E0 AXti + E0 Bti = E0 Bti .

Integrating, we find
                                                                                 Z t
                                                E   0
                                                        Xti   =E   0
                                                                       X0i   +         E0 Bsi ds
                                                                                  0

It is easy to verify that E(1) = E(5) = 0. Therefore, we can write
                                                                                              Z t
                                    Eg ḡˆ ti = − Ey ȳˆit − Eτ τ̄ˆti,r + E0 X0i +                  E0 Bsi ds,   (298)
                                                                                               0

where Ey = E(2), Eτ = E(3) and Eg = E(4). Let

                                       W = − ψEy Js a0i − ψEτ Hs a0i − ψEg Ls a0i .

It then follows from (298) that government spending follows the policy targeting rule

                                    Ey i                Eτ                               W
                       ḡˆ ti = −      (ȳˆt − ȳˆ0i ) − (τ̄ˆti,r − τ̄ˆ0i,r ) + ḡˆ0i +     (1 − e−ψt ).         (299)
                                    Eg                  Eg                              ψEg

   So far, we have only shown that the targeting rule holds for some family of eigenvectors E. How-
ever, we can even solve for Ey , Eτ and Eg in closed form. Differentiating the targeting rule with
respect to time, we have
                                              Ey         Eτ ˙ i,r W −ψt
                                   ḡˆ˙ ti = − ȳˆ˙ it −   τ̄ˆ + e .                           (300)
                                              Eg         Eg t     Eg

Using the original system of equations (292) - (296) to substitute in for ȳˆ˙ it and τ̄ˆ˙ti,r yields, after some
algebra, the two equations

                                                Eg Lµy = − Ey Jµy − Eτ Hµy                                       (301)
                                                 Eg Lπ = − Ey Jπ − Eτ Hπ ,                                       (302)



                                                                        123
in the three unknowns Ey , Eτ and Eg . By construction, an uncountably large class of linearly depen-
dent eigenvectors E can give rise to the targeting rule (note that the coefficients in the policy rule are
ratios). Therefore, we can normalize Eg = 1, and solve for Ey and Eτ :

                                                             Hπ Lµy + Hµy Lπ
                                                      Ey = −                                                                          (303)
                                                             Hπ Jµy + Hµy Jπ
                                                           Jπ Hπ Lµy + Hµy Lπ
                                                      Eτ =                   Lπ
                                                                                .                                                     (304)
                                                           Hπ Hπ Jµy + Hµy − H
                                                                                               π



D.9.3    Solving the Dynamic System

We can use the targeting rule to simplify the dynamical system of optimality conditions. We have

                                                                                                                     W
        π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − κ̄˜ y ȳˆit − κ̄˜ τ τ̄ˆti,r − κθ θ̄ˆi − ( Ey ȳˆ0i + Eτ τ̄ˆ0i,r ) − κ g ḡˆ0i − κ g
                                                                       κg
                                                                                                                        (1 − e−ψt )   (305)
                                                                       Eg                                           ψEg
             tȳˆ˙ i ≡ Jµ µi + Jπ π̄ˆ i + J̄ i
                      y   y,t           H,t      t                                                                                    (306)
         τ̄ˆ˙ti,r = Hµy µiy,t + Hπ π̄ˆ iH,t + H̄ti                                                                                    (307)
                                                                Kg                                              W
         µ̇iy,t = ρµiy,t + K̄˜ y ȳˆit + K̄˜ τ τ̄ˆti,r + K̄ti +    ( Ey ȳˆ0i + Eτ τ̄ˆ0i,r ) + K g ḡˆ0i + K g     (1 − e−ψt ),       (308)
                                                                Eg                                             ψEg

where
                                                                                Ey
                                                              κ̄˜ y = κy − κ g
                                                                                Eg
                                                                                Eτ
                                                             κ̄˜ τ   = κτ − κ g
                                                                                Eg
                                                                                 Ey
                                                             K̄˜ y   = Ky − K g
                                                                                 Eg
                                                                                 Eτ
                                                             K̄˜ τ   = Kτ − K g .
                                                                                 Eg

   Next, we need to solve for ȳˆ0i and τ̄ˆ0i,r using the initial conditions

                                Λy ȳˆ0i = − Λs s̃0i + Λθ θ̄ˆi + Λτ τ̄ˆ0i,r + Λ g ḡˆ0i                                               (309)
                                     0 =λ(Γ∗g + D̄Γ∗y ) − (2α gg + D̄αyg ) ḡˆ0i − (2αyy D̄ + αyg )ȳˆ0i
                                        − (α + D̄α )τ̄ˆ i,r − (α + D̄α )θ̄ˆi .
                                                 gτ          yτ      0         gθ         yθ                                          (310)

Rearranging and solving the two equations in the two unknowns, we can write

                                                  τ̄ˆ0i,r ≡ Qλ λ + Q g ḡˆ0i + Qθ θ̄ˆi + Qs s̃0i                                      (311)
                                                     ȳˆi ≡ P λ + P ḡˆ i + P θ̄ˆi + P s̃i .
                                                      0     λ            g 0        θ      s 0                                        (312)




                                                                         124
Hence, we have solved for ȳˆ0i and τ̄ˆ0i,r as functions of the Lagrange multiplier λ, ḡˆ0i and θ̄ˆi . Recall that
in previous sections, we have solved for the optimal allocation as a function of θ̄ˆi . Now, even though
the path of government spending is tied down by the targeting rule, ḡˆ0i is a free parameter that the
social planner can choose optimally. Therefore, we will now go on to solve the optimal allocation as
a function of ( ḡˆ0i , θ̄ˆi ) and then numerically pin down these two free constants.
    The transformed dynamical system can now be written in terms of X̃ti = {π̄ˆ iH,t , ȳˆit , τ̄ˆti,r , µiy,t } as

                                                        X̃˙ ti = Ã X̃ti + B̃ti ,                            (313)

where
                                      ρ −κ̄˜ y −κ̄˜ τ 0                                     κti
                                                                                              
                                                                                           i
                                    Jπ  0      0     J                                    J̄t 
                                                          
                                                         y ,                         i
                              Ã =                                                        H̄ i  ,
                                                                                    B̃t = 
                                                       µ   
                                                                                                 
                                   H
                                    π   0      0     Hµy                                t
                                      0  ˜
                                        K̄y     ˜
                                               K̄τ     ρ                                    Kti
and
                                                          π̄ˆ iH,0
                                                                                 

                                            Pλ λ + Pg ḡˆ0i + Pθ θ̄ˆi + Ps s̃0i 
                                                                                 
                                       i                                          ,
                                     X̃0 = 
                                           
                                                                     ˆ
                                                         ˆ i           i
                                            Qλ λ + Q g ḡ0 + Qθ θ̄ + Qs s̃0 
                                                                                i 
                                                           ∆Λy
where

                                                     W
                          κti = − κθ θ̄ˆi − κ g
                                                                                 κg
                                                        (1 − e−ψt ) − λ ( Ey Pλ + Eτ Qλ )
                                                    ψEg                          Eg
                               − ḡˆ0i ( Ey Pg + Eτ Q g + Eg ) − θ̄ˆi ( Ey Pθ + Eτ Qθ )
                                         κg                                         κg
                                        Eg                                         Eg
                                       κ  g
                               − s̃0i ( Ey Ps + Eτ Qs )
                                       Eg
                                                                                 W −ψt
                             ≡ − κ̄˜ θ θ̄ˆi − κ̄˜ λ λ − κ̄˜ g ḡˆ0i − κ̄˜ + κ g      e
                                                                                ψEg

with
                                                     κg                          W
                                        κ̄˜ = s̃0i      ( Ey Ps + Eτ Qs ) + κ g     ,
                                                     Eg                         ψEg
and

                                        W                             Kg
                             Kti =K g      (1 − e−ψt ) + λ ( Ey Pλ + Eτ Qλ )
                                       ψEg                            Eg
                                         Kg                                   Kg
                                  + ḡˆ0i ( Ey Pg + Eτ Q g ) + θ̄ˆi ( Ey Pθ + Eτ Qθ )
                                         Eg                                   Eg
                                         Kg
                                  + s̃0i ( Ey Ps + Eτ Qs ) + Kλ λ + Kθ θ̄ˆi
                                         Eg
                                                                                 W −ψt
                                ≡K̄˜ λ λ + K̄˜ g ḡˆ0i + K̄˜ θ θ̄ˆi + K̄˜ − K g     e
                                                                                ψEg

                                                                 125
with
                                                                     Kg                          W
                                                          K̄˜ = s̃0i    ( Ey Ps + Eτ Qs ) + K g     .
                                                                     Eg                         ψEg

Therefore, we can write the forcing term vector as

                                                          −κ̄˜ θ θ̄ˆi − κ̄˜ λ λ − κ̄˜ g ḡˆ0i − κ̄˜ + κ g ψE
                                                                                                           W −ψt
                                                                                                               e
                                                                                                                
                                                                                                             g

                                                                                        J̄ i
                                                                                                                
                                                 B̃ti =                                   t                     .                                       (314)
                                                                                                                
                                                                                      H̄    i                   
                                                                                            t                   
                                                           ˜           ˜    ˆ i   ˜     ˆ  i    ˜
                                                          K̄λ λ + K̄ g ḡ0 + K̄θ θ̄ + K̄ − K g ψEg e       W −ψt



     The solution is then given by
                                                                                              Z t                    
                                                              X̃ti   =e   Ãt
                                                                                    X̃0i   +         e− Ãs B̃si ds       .                               (315)
                                                                                                 0


Using the same steps as in previous sections, we can manipulate this solution to obtain
                                                                                                                                                              
 Xti   =e   Ãt
                      X̃0i   − (κ̄˜ θ θ̄ˆi + κ̄˜ λ λ + κ̄˜ g ḡˆ0i + κ̄˜ ) Ã−1 E1 + (K̄˜ θ θ̄ˆi + K̄˜ λ λ + K̄˜ g ḡˆ0i + K̄˜ ) Ã−1 E4 + ( Ã + ψI )−1 Ēˆ

         + (κ̄˜ θ θ̄ˆi + κ̄˜ λ λ + κ̄˜ g ḡˆ0i + κ̄˜ ) Ã−1 E1 − (K̄˜ θ θ̄ˆi + K̄˜ λ λ + K̄˜ g ḡˆ0i + K̄˜ ) Ã−1 E4 − ( Ã + ψI )−1 e−ψt Ēˆ , (316)

where
                                                                               W            W
                                                    Ēˆ = W2 E2 + W3 E3 − K g     E4 + κ g     E1
                                                                              ψEg          ψEg
and W2 and W3 are defined as in previous sections.


D.9.4       Stability

As before, we require the term in square brackets to be spanned in the stable manifold to guarantee
the stability of the system. Ã again has two negative eigenvalues. Let Vj , j ∈ {1, 2} denote the
eigenvectors of A associated with these negative eigenvalues, which we denote λ1 and λ2 . The
spanning condition can then be written as

0 = α1 V1 + α2 V2 X̃0i − (κ̄˜ θ θ̄ˆi + κ̄˜ λ λ + κ̄˜ g ḡˆ0i + κ̄˜ ) Ã−1 E1 + (K̄˜ θ θ̄ˆi + K̄˜ λ λ + K̄˜ g ḡˆ0i + K̄˜ ) Ã−1 E4 + ( Ã + ψI )−1 Ēˆ
                                                                                                                                              (317)
for some α j ∈ C, j ∈ {1, 2}.
    The solution, including the above stability condition, is now given as a function of the free pa-
rameters ( ḡˆ0i , θ̄ˆi ) and Z = (α1 , α2 , λ, ∆, π̄ˆ iH,0 ). We can pin down the latter set of free parameters by im-
posing the stability condition as well as the country budget constraint. The stability condition yields
a system of four equations if we premultiply both sides by the projection matrices Ei , i ∈ {1, 2, 3, 4}.
Unlike in previous sections, we have already solved for and substituted in ȳˆ0i and τ̄ˆ0i,r using the two


                                                                                           126
initial conditions.
    We now substitute the target rule for government spending into the country budget constraint
             Z ∞                                                                          
        0=           e   −ρt
                                   Γ∗y ȳˆit   + Γ∗θ θ̄ˆi   + Γ∗τ τ̄ˆti,r   + Γ∗g ḡˆ ti       dt
              0
              ∗
             Γθ ˆi         Γ∗g   Γ∗g                                  W
        = θ̄ + ḡ0 +    ˆ i
                                     ( Ey ȳˆ0i + Eτ τ̄ˆ0i,r ) + Γ∗g
          ρ          ρ          ρEg                                  ρψEg
                                     ∗ Ey ˆ i
            Z ∞
                                                                 ∗ Eτ ˆ i,r     ∗ W −ψt
                                                                                         
                     −ρt      ∗                          ∗
         +         e        (Γy − Γ g )ȳt + (Γτ − Γ g )τ̄t − Γ g                     e      dt
               0                       Eg                          Eg            ψEg
         Γ∗         Γ∗g          Γ∗g
        = θ θ̄ˆi + ḡˆ0i +           Ey ( Pλ λ + Pg ḡˆ0i + Pθ θ̄ˆi + Ps s̃0i )
          ρ          ρ          ρEg
               Γ∗g                                 ˆ                        W             W
                                                                                                   Z ∞
         +                              i            i
                   Eτ ( Qλ λ + Q g ḡˆ0 + Qθ θ̄ + Qs s̃0 ) + Γ gi      ∗            ∗
                                                                                 − Γg            +     e−ρt Ē˜ 0 X̃ti dt
            ρEg                                                           ρψEg        (ρ + ψ)ψEg    0


where
                                                                            Ey                Eτ
                                                            Ē˜ = (Γ∗y − Γ∗g ) E2 + (Γ∗τ − Γ∗g ) E3 .
                                                                            Eg                Eg
We have
             Z ∞
                                                                                              1
                   e−ρt Ē˜ 0 X̃ti dt =                                          Ē V2 + (κ̄˜ θ θ̄ˆi + κ̄˜ λ λ + κ̄˜ g ḡˆ0i + κ̄˜ ) Ē˜ 0 Ã−1 E1
                                                     α1 ˜ 0               α2 ˜ 0
                                                          Ē V1 +
              0                                    λ1 − ρ              λ2 − ρ                 ρ
                                                      1                                                           1 ˜0
                                                   − (K̄˜ θ θ̄ˆi + K̄˜ λ λ + K̄˜ g ḡˆ0i + K̄˜ ) Ē˜ 0 Ã−1 E4 −          Ē ( Ã + ψI )−1 Ēˆ .
                                                      ρ                                                          ρ+ψ

Therefore, putting everything together and grouping terms, the country budget constraint becomes

                                    Γ∗g                                                                Γ∗g
                          ∗
                        i Γθ                                                         W
                                                                
                      ˆ
                  0 =θ̄        +         ( Ey Pθ + Eτ Qθ ) + Γ g            ∗
                                                                                               +λ           ( Ey Pλ + Eτ Qλ )                        (318)
                             ρ     ρEg                                        ρ ( ρ + ψ ) Eg          ρEg
                               ∗
                                Γg       Γ∗g                                        Γ∗g
                                                                        
                          ˆ i                                                    i
                      + ḡ0         +        ( Ey Pg + Eτ Q g ) + s̃0                   ( Ey Ps + Eτ Qs )
                                ρ       ρEg                                        ρEg
                                                                        1
                                                           Ē V2 + (κ̄˜ θ θ̄ˆi + κ̄˜ λ λ + κ̄˜ g ḡˆ0i + κ̄˜ ) Ē˜ 0 Ã−1 E1
                              α1 ˜ 0             α2 ˜ 0
                      +            Ē V1 +
                          λ1 − ρ              λ2 − ρ                    ρ
                          1                                                               1 ˜0
                      − (K̄˜ θ θ̄ˆi + K̄˜ λ λ + K̄˜ g ḡˆ0i + K̄˜ ) Ē˜ 0 Ã−1 E4 −            Ē ( Ã + ψI )−1 Ēˆ .
                          ρ                                                             ρ+ψ

  Together, the stability condition and the country budget constraint imply a system of equations
MZ = N, with


                                                                              −κ̄˜ λ E10 A−1 E1 + K̄˜ λ E10 A−1 E4
                                                                                                                                               
                           E10 V1                  E10 V2                                                                    0                1
                           E20 V1                  E20 V2                   Pλ − κ̄˜ λ E20 A−1 E1 + K̄˜ λ E20 A−1 E4         0                0
                                                                                                                                               
            
                                                                                                        ˜
                                                                            Qλ − κ̄˜ λ E3 A E1 + K̄λ E3 A E4
                                                                                                                                               
                           E30 V1                  E30 V2                                 0 − 1              0 − 1           0                0
          M=
            
                                                                                                                                                
                           E40 V1                  E40 V2                     −κ̄˜ λ E40 A−1 E1 + K̄˜ λ E40 A−1 E4           Λy               0
                                                                                                                                               
            
                                                                                                                K̄˜ λ ˜ 0 −1
                                                                    ∗
                                                                   Γg
                           Ē˜ 0                  Ē˜ 0                                       κ̄˜ λ ˜ 0 −1
                                                                                                                                               
                          λ1 −ρ V1               λ2 −ρ V2         ρEg ( Ey Pλ + Eτ Qλ ) + ρ Ē Ã E1 − ρ Ē Ã E4            0                0


                                                                                               127
and



                                                                                        ˜
                                                                                                                              
                                                                              − E10 W̄
           
                                                          − E20 W̄    ˜ − P ḡˆ i − P θ̄ˆi − P s̃i                             
                                                                             g 0         θ       s 0                          
                                                                    ˜ − Q ḡˆ i − Q θ̄ˆi − Q s̃i
                                                                                                                              
           
                                                        − E30 W̄            g 0           θ         s 0
                                                                                                                               
                                                                                                                               
           
                                                                              − E4 W̄ 0 ˜                                      
         N=                                                                                                                   ,
                                                                                                                              
                                   Γg∗                                                            Γg∗        Γg∗
            ˆi          Γ∗θ                                                         W
                                                                          ∗                   ˆ i
                               + ρEg ( Ey Pθ + Eτ Qθ ) − Γ g ρ(ρ+ψ)Eg − ḡ0 ρ + ρEg ( Ey Pg + Eτ Q g ) . . .
                                                                                                                            
           −θ̄
                                                                                                                               
                         ρ
                                             Γ∗g
                                                                                                                              
                                                                                    1 ˜ ˆi                      ˜
                                . . . − s̃0 ρEg ( Ey Ps + Eτ Qs ) − ρ (κ̄θ θ̄ + κ̄˜ g ḡˆ0 + κ̄˜ ) Ē Ã E1 . . .
                                          i                                                        i              0 − 1
                                                                                                                              
                                                                                                                              
                                  . . . + 1ρ (K̄˜ θ θ̄ˆi + K̄˜ g ḡˆ0i + K̄˜ ) Ē˜ 0 Ã−1 E4 + ρ+1 ψ Ē˜ 0 ( Ã + ψI )−1 Ēˆ
                                                                                                                              


       ˜ = −(κ̄˜ θ̄ˆi + κ̄˜ ḡˆ i + κ̄˜ ) Ã−1 E + (K̄˜ θ̄ˆi + K̄˜ ḡˆ i + K̄˜ ) Ã−1 E + ( Ã + ψI )−1 Ēˆ .
where W̄        θ          g 0                  1      θ          g 0                  4

Inverting M, which is non-singular in all of our calibrations, we can solve for Z numerically. Given Z,
we have the full solution of the optimal allocation as a function of the two remaining free parameters
( ḡˆ0i , θ̄ˆi ), over which we optimize numerically.


D.10      The Special Case χ = 0
We now provide a general formulation the allocation and planning problem without hand-to-mouth
agents as an important special case.
   We start by recording several important parameters. For χ = 0, we have Λy = 1−1 υ , Λτ = 0,
Λs = 1, Λ g = 1−υ υ and Λθ = 1 − α. Furthermore, we have ντ = 0, νy = 1−1 υ , νθ = −(1 − α),
νg = − 1−υ υ . And ζ y = 11−                                                         2
                           −υ , ζ g = −(1 − α ) 1−υ , ζ τ = 0, and ζ θ = 1 − (1 − α ) .
                             α                   υ



D.10.1    General Allocation for χ = 0

Give these parameters, we can write the (IS) equation for χ = 0 as

                                       1 ˙i                                                    ˙
                                                                              ḡˆ t + (1 − α)θ̄ˆti .
                                                                           υ ˙i
                                          ȳˆ t = −(π̄ˆ iH,t + s̃˙ it ) +                                                           (319)
                                      1−υ                                 1−υ
                                                                                                                1
   For the Phillips Curve, we record the following parameters: κy = λ(φ +                                      1− υ ),   κ g = −λ 1−υ υ ,
κτ = 0, and κθ = αλ. Therefore, we can write the (NKPC) as

                                                                    1
                                   π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − λ(φ +       )ȳˆit − αλθ̄ˆti + λ
                                                                                             υ
                                                                                               ḡˆ i                                (320)
                                                                   1−υ                      1−υ t

   The initial condition is the given by

                                             1
                                                                   ḡˆ i + (1 − α)θ̄ˆ0i .
                                                                 υ
                                                ȳˆ0i = −s̃0i +                                                                     (321)
                                            1−υ                 1−υ 0


                                                                   128
    Finally, for country i’s budget constraint, we note that for χ = 0, Γy = − 1αυ    −υ , Γτ = 1, Γθ =
                                                    2
1 − α − (1 − υ) − υ(1 − α)2 , and Γ g = υ + α 1υ−υ . We can then use the government budget constraint
to substitute in for τ̄ˆti,o , which yields that in the absence of transfers we have the following NFA
condition                                                  Z ∞
                                          0 = − α (1 − υ )     e−ρt θ̄ˆti dt.                      (322)
                                                                                    0


D.10.2   Loss Function and Planning Problem for χ = 0

For χ = 0, the loss function coefficients are as follows: αττ = α gτ = αyτ = ατθ = αyθ = α gθ = 0. This
leaves us with

                                                                        e
                                                              απ =
                                                                       2λ
                                                                          1 + (1 − υ ) φ
                                                              αyy =    −
                                                                            2(1 − υ )
                                                                              υ
                                                              α gg =   −
                                                                          2(1 − υ )
                                                                          1−υ
                                                                                 1 − (1 − α )2
                                                                                               
                                                              αθθ =    −
                                                                            2
                                                                          υ
                                                              αyg =           .
                                                                       1−υ

   Hence, the loss function can be written as
                          Z ∞Z 1
                                                                          1 + (1 − υ ) φ i 2 1 − υ
                                                  
                                                                                                               1 − (1 − α)2 (θ̄ˆti )2
                                                       e
                     L=                 e   −ρt
                                                         (π̄ˆ iH,t )2 +                      (ȳˆt ) +                                  (323)
                                                                                                                           
                          0       0                   2λ                        2(1 − υ )                    2
                                                                                                      
                                                                υ                     υ
                                                      +               ( ḡˆ ti )2 −       ȳˆit ḡˆ ti didt.
                                                         2(1 − υ )                  1−υ

where of course ait = e−ψt a0i is the initial productivity shock.


D.10.3   Planning Problem for Transfers when χ = 0

When the social planner can only use transfers, we have ḡˆ ti = 0 and θ̄ˆti = θ̄ˆi . Therefore, we can write
the planning problem as
                     Z ∞Z 1
                                                            1 + (1 − υ ) φ i 2 1 − υ
                                                                                                         
                                                 e     i 2                                       2
                                                                                                    ˆi 2
             min                  e   −ρt
                                                   (π̄ˆ ) +               (ȳˆt ) +   1 − (1 − α) (θ̄ ) didt,
              θ̄ˆi    0       0                 2λ H,t        2(1 − υ )             2

subject to

                                                   1 ˙i
                                                          ȳˆ = −(π̄ˆ iH,t + s̃˙ it )
                                                  1−υ t
                                                                                         1
                                                    π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − λ(φ +          )ȳˆi − αλθ̄ˆi
                                                                                        1−υ t



                                                                              129
                                                1
                                                  ȳˆi = −s̃0i + (1 − α)θ̄ˆi .
                                               1−υ 0

D.10.4   Planning Problem for Capital Controls when χ = 0

When the social planner can only use transfers, we have ḡˆ ti = 0 and τ̄ˆti,r = υαs̄ˆit . Therefore, we can
write the planning problem as
                   Z ∞Z 1
                                                       1 + (1 − υ ) φ i 2 1 − υ
                                                                                                 
                                  −ρt        e
                                                 ˆ i 2                 ˆ                   2 ˆi 2
             min              e                                      (ȳt ) +   1 − (1 − α) (θ̄t ) didt,
                                                                                            
                                               (π̄ ) +
          {θ̄ˆti }t≥0 0   0                 2λ H,t       2(1 − υ )            2

subject to

                                                1 ˙i                                                  ˙
                                                        ȳˆ t = −(π̄ˆ iH,t + s̃˙ it ) + (1 − α)θ̄ˆti
                                               1−υ
                                                                                          1
                                                  π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − λ(φ +                  )ȳˆi − αλθ̄ˆti
                                                                                       1−υ t
                                                1
                                                        ȳˆ0i = −s̃0i + (1 − α)θ̄ˆ0i
                                               1−υ                              Z ∞
                                                           0 = − α (1 − υ )            e−ρt θ̄ˆi dt.
                                                                                               t
                                                                                  0


D.10.5   Planning Problem for Government Spending when χ = 0

When the social planner can only use government spending, we have θ̄ˆti = 0 and τ̄ˆti,r = υαs̄ˆit . There-
fore, we can write the planning problem as
                   Z ∞Z 1
                                                        1 + (1 − υ ) φ i 2
                                                                                                              
                                             e     i 2                              υ         i 2   υ    i   i
          min                 e   −ρt
                                               (π̄ˆ ) +               (ȳˆt ) +          ( ḡˆ ) −    ȳˆ ḡˆ didt,
         {θ̄ˆti }t≥0 0    0                 2λ H,t        2(1 − υ )             2(1 − υ ) t        1−υ t t

subject to

                                             1 ˙i                                          υ ˙i
                                                     ȳˆ t = −(π̄ˆ iH,t + s̃˙ it ) +           ḡˆ
                                            1−υ                                           1−υ t
                                                                                           1
                                               π̄ˆ˙ iH,t = ρπ̄ˆ iH,t − λ(φ +
                                                                                                          υ
                                                                                              )ȳˆit + λ    ḡˆ i
                                                                                          1−υ            1−υ t
                                             1                           υ
                                                     ȳˆ0i = −s̃0i +              ḡˆ i .
                                            1−υ                        1−υ 0




                                                                            130
