                                NBER WORKING PAPER SERIES




                               OPTIMAL TAX PROGRESSIVITY:
                               AN ANALYTICAL FRAMEWORK

                                        Jonathan Heathcote
                                         Kjetil Storesletten
                                        Giovanni L. Violante

                                        Working Paper 19899
                                http://www.nber.org/papers/w19899


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     February 2014




Formerly titled “Redistributive Taxation in a Partial Insurance Economy”. The views expressed herein
are those of the authors and not necessarily those of the Federal Reserve Bank of Minneapolis or the
Federal Reserve System. The views expressed herein are those of the authors and do not necessarily
reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2014 by Jonathan Heathcote, Kjetil Storesletten, and Giovanni L. Violante. All rights reserved.
Short sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.
Optimal Tax Progressivity: An Analytical Framework
Jonathan Heathcote, Kjetil Storesletten, and Giovanni L. Violante
NBER Working Paper No. 19899
February 2014
JEL No. E20,H20,H40,J22,J24

                                              ABSTRACT

What shapes the optimal degree of progressivity of the tax and transfer system? On the one hand, a
progressive tax system can counteract inequality in initial conditions and substitute for imperfect private
insurance against idiosyncratic earnings risk. At the same time, progressivity reduces incentives to
work and to invest in skills, and aggravates the externality associated with valued public expenditures.
We develop a tractable equilibrium model that features all of these trade-offs. The analytical expressions
we derive for social welfare deliver a transparent understanding of how preferences, technology, and
market structure parameters influence the optimal degree of progressivity. A calibration for the U.S.
economy indicates that endogenous skill investment, flexible labor supply, and the externality linked
to valued government purchases play quantitatively similar roles in limiting desired progressivity.


Jonathan Heathcote                                   Giovanni L. Violante
Federal Reserve Bank of Minneapolis                  Department of Economics
Research Department                                  New York University
90 Hennepin Ave.                                     19 W. 4th Street
Minneapolis, MN 55401                                New York, NY 10012-1119
heathcote@minneapolisfed.org                         and NBER
                                                     glv2@nyu.edu
Kjetil Storesletten
Federal Reserve Bank of Minneapolis
Research Department
90 Hennepin Ave.
Minneapolis, MN 55401
kjetil.storesletten@gmail.com
1 Introduction
In deciding how progressive to make the tax and transfer system, governments face a difficult
trade-off. The classic argument in favor of progressivity is that private risk-sharing is incomplete.
Empirical estimates of the extent of pass-through from life-cycle earnings shocks into consump-
tion indicate limited private risk-sharing (e.g., Cochrane, 1991; Attanasio and Davis, 1996). Per-
haps more importantly, there are no private markets to hedge against poor “initial conditions” that
translate into low expected future earnings. A progressive tax system offers both social insurance
against labor market uncertainty (e.g., Eaton and Rosen, 1980; Varian, 1980) and redistribution
with respect to initial conditions.
   At the same time, governments are hesitant to push progressivity too far because of the asso-
ciated distortions to labor supply and skill investment. A tax schedule with increasing marginal
rates reduces both the returns to working more hours and the returns to acquiring human capital
(e.g., Heckman, Lochner and Taber, 1998; Guvenen, Kuruscu, and Ozkan, 2014). Moreover, if the
equilibrium skill premium responds to skill scarcity, a more progressive tax system, by depressing
skill investment, may create more inequality in pre-tax wages, thereby undermining the original
redistributive intent (e.g., Feldstein, 1973; Stiglitz, 1982).
   An additional factor impacting on the optimal degree of progressivity comes into play when the
government provides goods and services that are valued by households but cannot be purchased
privately. Individuals do not then internalize that, by working more hours or acquiring more skills,
the associated additional output allows the government to supply more public goods. This increases
the social cost of a progressive tax system.
   In this paper we develop an analytically tractable equilibrium model that features all of the
forces shaping the optimal degree of progressivity described above. The environment is an exten-
sion of the partial insurance framework developed in Heathcote, Storesletten and Violante (2014).
The economy is populated by a continuum of infinitely lived households that choose how much to
consume and how much to work, and which face idiosyncratic labor market shocks of two types.
Some shocks are privately insurable and do not transmit to consumption, whereas others remain
uninsurable in equilibrium and induce consumption volatility. Individuals are heterogeneous ex
ante with respect to two characteristics: learning ability and disutility of work effort. Those en-


                                                    1
dowed with higher learning ability invest more in skills prior to entering the labor market, and more
diligent individuals work and earn more at every skill level. An aggregate production technology
with imperfect substitutability across skill types determines the marginal product and equilibrium
price of each skill type. The resulting equilibrium income distribution features a Pareto tail whose
coefficient is exactly the elasticity of substitution across skill types in production.
   The government uses a nonlinear income tax and transfer system to provide social insurance
and to finance publicly provided goods and services. According to this tax system, net taxes as a
function of individual earnings y are given by the function T (y) = y −λy 1−τ , where the parameter
τ indexes the progressivity of the system (we discuss this class of tax and transfer systems in detail
in Section 2). In addition to τ , the planner also chooses λ, which determines net tax revenue and
thus the share of output g devoted to public goods.
   Because the model is tractable and parsimonious, we can derive a closed-form expression for
social welfare as a function of τ and g and the (six) structural parameters of the model describing
preferences, technology, and households’ access to private consumption insurance. Each term in
this welfare expression has an economic interpretation and embodies one of the channels shaping
the optimal progressivity trade-off discussed above. With this expression in hand, we ask what
degree of progressivity τ would be chosen by a benevolent planner.
   The planner’s desire to provide social insurance with respect to privately uninsurable idiosyn-
cratic productivity shocks calls for a positive value for τ and thus marginal tax rates that rise
with earnings. Similarly, initial heterogeneity in innate learning ability and preference for leisure
translates into consumption dispersion that a utilitarian planner would like to counteract via a pro-
gressive tax and transfer system. However, the planner understands that the more progressive taxes
are, the lower labor supply and skill investment will be, where the respective elasticities with re-
spect to τ are governed by the Frisch elasticity of labor supply and the degree of complementarity
between skill types in production. In addition, the presence of valued government expenditure
constitutes a force toward regressive taxation (τ < 0).
   After qualitatively inspecting these channels, we investigate their relative quantitative impacts
on optimal net progressivity. The model yields closed-form solutions for the cross-sectional (co-
)variances of wages, hours, and consumption. Exploiting the empirical counterparts of these mo-
ments from the Panel Study of Income Dynamics and the Consumer Expenditure Survey for 2000-

                                                   2
2006, we estimate the structural parameters determining the relative magnitude of the forces at
play and perform a quantitative analysis. Our findings indicate that a utilitarian government would
choose less progressivity than is currently embedded in the U.S. tax/transfer system.1 The opti-
mal value for τ ∗ is 0.062, which implies an average (income-weighted) marginal tax/transfer rate
of 24% compared with the current 31%. Switching to the optimal τ ∗ yields welfare gains on the
order of half a percent of lifetime consumption. Endogenous labor supply and endogenous skill
investment play quantitatively similar roles in limiting progressivity, and in the absence of either
one of these channels, optimal progressivity would be substantially higher.
       We consider a range of sensitivity analyses and extensions that further illuminate the economic
forces determining optimal progressivity. When we mute the desire for redistribution in the social
welfare objective function to isolate the insurance motive, the optimal tax/transfer system is close
to a flat tax set at 19% of income. The logic is that although progressivity does act as a substitute
for missing insurance against life-cycle productivity shocks, it also depresses labor supply and skill
investment, which are already inefficiently low in the presence of publicly provided goods. These
forces almost exactly offset each other and lead to a proportional tax. If government expenditures
are not valued by households, one of the key forces towards regressivity vanishes, and the optimal
degree of progressivity becomes similar to that in the actual U.S. system. Progressive consumption
taxation offers more efficient insurance with respect to lifetime productivity shocks than progres-
sive earnings taxation because consumption is independent of the insurable component of earnings
fluctuations that, ideally, the planner wants to leave undistorted. Finally, if existing cohorts cannot
modify their skill levels after labor market entry, the planner prefers more progressivity than in our
baseline (reversible investment) model, since the planner can then redistribute without reducing
skill investment in the short run.
       Our paper contributes to the Ramsey-style literature that investigates the determinants of opti-
mal progressivity in heterogeneous agents incomplete-markets economies. A closely related study
is Benabou (2002). Common to both models is the absence of trade in non-contingent bonds (an
assumption in Benabou’s model, an equilibrium outcome in ours), which helps deliver analytical
tractability. We also adopt the same specification for the tax/transfer function. Key elements that
   1
    By “current” system, we mean the one that was in place until the mid-2000s. Recent fiscal measures (e.g.,
extensions of UI benefits and the sunsetting of the Bush tax cuts) have increased progressivity further.


                                                     3
differentiate our framework are our multiskill production technology, the partial insurance struc-
ture, heterogeneity in the taste for work, and the presence of valued government-provided goods.
These elements allow us to make closer contact to micro-data and to analyze new forces shaping
optimal progressivity that turn out to be quantitatively important. Benabou also postulates a differ-
ent model for human capital investment, in which goods are an input, which allows him to explore
how education subsidies relax credit constraints.
   Other influential studies in the literature are Conesa and Krueger (2006) and ?. Our environ-
ment is richer than those papers along some dimensions (preference heterogeneity, valued gov-
ernment expenditures, policy effects on skill prices) and more stylized in others (notably, the fact
that wealth is in zero net supply). Relative to these papers, the key advantage of our framework is
that it is tractable, and thus the mechanics of how progressivity affects allocations and welfare are
transparent.
   Our normative analysis, in the spirit of Ramsey (1927), restricts the search for optimal pro-
gressivity within a given class of tax/transfer schemes. The Mirrlees (1971) approach to optimal
taxation is built on a different foundation. Rather than postulating an exogenously restricted set
of instruments, the goal is to characterize the fully optimal tax system in the context of an in-
formational friction that prevents the planner from directly observing individual productivity and
thus rules out productivity-type-specific lump-sum taxes. Classic examples of this approach, with
quantitative applications to the U.S. economy, are Saez (2001) and Diamond and Saez (2011).
   Although the Mirrlees approach allows more flexibility in the design of the tax system, the
problem of solving for constrained-efficient allocations becomes quite difficult outside simple
static environments. Researchers have only recently incorporated persistent labor productivity
shocks (Farhi and Werning, 2012; Golosov, Troshkin, and Tsyvinski, 2012; Gorry and Ober-
field, 2012), human capital accumulation (Stantcheva, 2013), and imperfect substitutability across
worker types (Rothschild and Scheuer, 2013). Our model embeds all of these ingredients, yet
remains tractable. The cost we pay is that we exogenously restrict the set of tax instruments avail-
able to the planner. However, we will argue that our parametric specification is sufficiently flexible
that the potential welfare gains from moving to a fully nonparametric tax schedule are likely to be
small.
   The rest of the paper is organized as follows. Section 2 presents our tax function and discusses

                                                  4
its properties. Section 3 describes the economic environment. Section 4 contains a characterization
of the equilibrium allocations in closed form. Section 5 solves analytically for social welfare as a
function of the fiscal policy chosen by the government (progressivity τ and public spending g) and
as a function of all other structural parameters of the model. Section 6 calibrates the model and
explores the quantitative implications of the theory for the optimal degree of progressivity. Sec-
tion 7 contains four extensions: a politico-economic analysis, progressive consumption taxation,
transitional dynamics, and the introduction of skill bias in the production technology. Section 8
concludes. All proofs are in the Appendix.


2 Tax function
We study the optimal degree of progressivity within the class of tax and transfer policies defined
by
                                                T (y) = y − λy 1−τ .                                                 (1)

This class has a long tradition in public finance, starting from Feldstein (1969). More recently, ?
and Benabou (2000, 2002) introduced this class of policies into dynamic macroeconomic models
with heterogeneous agents. The parameter τ determines the degree of progressivity of the tax
system and is the key object of interest in our analysis.
       We can see why τ is a natural index of progressivity in two ways. First, eq. (1) implies the fol-
lowing mapping between disposable (post-government) earnings ỹi and pre-government earnings
yi :
                                                     ỹi = λyi1−τ .                                                  (2)

Thus, (1 − τ ) measures the elasticity of post-tax to pre-tax income.2 Second, a tax scheme is
commonly labeled progressive (regressive) if the ratio of marginal to average tax rates is larger
(smaller) than one for every level of income yi . Within our class, we have

                                         T ′ (yi )    1 − λ (1 − τ ) yi−τ
                                                    =                     .                                          (3)
                                        T (yi ) /yi       1 − λyi−τ
   2
     ? refers to 1 − τ as the coefficient of residual income progression. As discussed in Benabou (2000), it has
been proven that the post-tax income distribution induced by one fiscal scheme Lorenz-dominates (i.e., displays less
inequality than) the one induced by an alternative scheme (for all pre-tax income distributions) if and only if the first
scheme’s progression coefficient (1 − τ ) is smaller everywhere . See, e.g., Kakwani (1977).


                                                           5
The case τ = 0 implies a ratio of one and yields a flat tax rate of 1 − λ. When τ > 0, the ratio in
eq. (3) is larger than one and the tax system is therefore progressive. Conversely, when τ < 0, the
tax system is regressive.
       Given τ , the second parameter, λ, shifts the tax function and determines the average level of
                                                                                   1
taxation in the economy. At the break-even income level y 0 = λ τ > 0, the average tax rate is
zero and the marginal tax rate is τ . If the system is progressive (regressive), then at every income
level below (above) y 0 , the average tax rate is negative and households obtain a net transfer from
the government. Thus, this function is best seen as a tax and transfer schedule, a property that has
implications for the empirical measurement of τ .
       Let g denote the fraction of output devoted to government expenditure. Assuming a balanced
budget, the average income-weighted marginal tax rate is then simply
                           Z           y 
                                         i
                             T ′ (yi )      di = 1 − (1 − τ ) (1 − g) .                                              (4)
                                        Y

From eq. (4) it is immediate that when g = 0, the average income-weighted marginal tax rate
is exactly τ .3 Holding fixed g, the average marginal rate is increasing in τ . Holding fixed τ ,
the average marginal rate is increasing in g, since increasing net tax revenue while maintaining
progressivity necessitates higher tax rates across the income distribution.

       Empirical fit: We now demonstrate that this functional form offers a remarkably good rep-
resentation of the actual tax/transfer scheme in the United States. We use data from the Panel
Study of Income Dynamics (PSID) for survey years 2000, 2002, 2004, and 2006. We restrict
attention to households aged 25-60 because we focus on labor income, and because we want to
abstract from the intergenerational dimension of redistribution between the working-age popula-
tion and retirees.4 Pre-government household income includes labor earnings, private transfers
                                      R
   3
       Budget balance requires gY = yi − λyi1−τ di. The income-weighted average marginal tax rate is then
              Z                                                Z
                                      yi 
                  1 − λ (1 − τ ) yi
                                  −τ
                                              di = 1 − (1 − τ ) λyi1−τ (1/Y ) di = 1 − (1 − τ ) (1 − g) .
                                         Y

   4
    The rest of the sample selection criteria are the same as in Heathcote, Perri, and Violante (2010). In particular, we
require a positive lower bound on annual hours worked (i.e., that either the head or the spouse works at least 260 hours
per year or one quarter part-time) because we will estimate eq. (2) in log form. The choice of the period 2000-2006
is motivated by the desire to use recent data while acknowledging that government transfers to U.S. households were
abnormally large during the Great Recession.



                                                           6
                                     10 10.5 11 11.5 12 12.5 13
                                                                                                                                              0.5


     Log of post−government income                                                                                                            0.4


                                                                                                                                              0.3


                                                                                                                                              0.2




                                                                                                                                  Tax Rate
                                                                                                                                              0.1

                                                                                                                                                                                     Average Tax Rate
                                                                                                                                               0
                                                                                                                                                                                     Marginal Tax Rate

                                                                                                                                             −0.1
                                     9.5




                                                                                                                                             −0.2
                                     9




                                                                                                                                             −0.3
                                     8.5




                                                                  8.5   9   9.5     10    10.5    11    11.5     12   12.5   13              −0.4
                                                                                                                                                    0.5   1   1.5    2    2.5    3       3.5     4       4.5          5
                                                                                  Log of pre−government income                                                      Household Income                              5
                                                                                                                                                                                                               x 10




    (a) Statistical fit on U.S. data (PSID 2000-2006)                                                                                               (b) Implied average and marginal tax


Figure 1: Representation of the actual U.S. tax/transfer system through our tax/transfer function.
The estimated value of τ U S is 0.151.

(transfers include alimony, child support, help from relatives, miscellaneous transfers, private re-
tirement income, annuities, and other retirement income), and income from interests, dividends,
and rents. Post-government income equals pre-government income minus federal and state income
taxes computed using the NBER’s TAXSIM program (Feenberg and Coutts, 1993), plus public
transfers (AFDC/TANF, SSI and other welfare receipts, social security benefits, unemployment
benefits, worker’s compensation, and veterans’ pensions).5
    We estimate τ U S by least squares using eq. (2) in log form. The point estimate is τ U S =
0.151 (S.E. = 0.003). The simple model fits the empirical relationship between pre- and post-
government earnings distributions remarkably well: R2 = 0.96. In Figure 1(a) we collapse our
13, 721 observations into 50 quantiles (each containing 2% of total observations).6 Figure 1(b)
plots the average and marginal tax rates implied by our tax/transfer scheme evaluated at τ U S (mean
income is normalized to 1).7 The implied income-weighted marginal tax rate is 0.33.
    5
      In some instances, asset income is taxed differently from labor earnings. Because we cannot split observed taxes
paid into taxes on earnings versus taxes on asset income, we estimate progressivity using total income as the tax
base and total taxes as the tax take. The presence of asset income has minimal impact on our empirical estimates
of progressivity, since asset income is very small in our sample. In part that is because we focus on households of
working age, and in part it reflects the facts that the PSID undersamples the very rich, and –even conditional being
interviewed– households grossly underreport asset income.
    6
      The coordinates of each circle in the figure are the mean of the corresponding quantile of the pre-government
income distribution (x axis), and the mean post-government income across the observations in that same quantile (y
axis).
    7
      Bakis, Kaymak, and Poschke (2013) combine CPS data with TAXSIM and obtain a value of τ US = 0.17 for
a longer period, 1979-2009. Guner, Kaygusuz, and Ventura (2012a) estimate this same function on a large cross-



                                                                                                                                  7
    The PSID data have three potential limitations for the purposes of estimating progressivity:
(i) the PSID undersamples the very rich, (ii) taxes are imputed through TAXSIM, and (iii) the
PSID covers only a subset of in-kind benefits. The Congressional Budget Office (CBO) publishes
tables reporting household income, federal taxes paid, and federal transfers received for various
quantiles of the entire distribution (including all the top earners) of before-tax income.8 The CBO
measures of taxes and transfers are more comprehensive than those reported in the PSID. Their
measure of taxes includes both employee- and employer-paid social insurance taxes, and their
measure of transfers includes the value of Food Stamps vouchers, school lunches, housing and
energy assistance, and benefits provided by Medicare and Medicaid. Moreover, the CBO adds to its
measure of pre-government income employer-paid health insurance premiums, and the employer’s
share of social security and payroll taxes.
    From the CBO tables we construct before and after government income for the first, second,
third, and fourth quintiles of the before-government income distribution, and for the 81st-90th
percentiles, the 91st-95th percentiles, the 96th-99th percentiles, and the top 1%. We used these
moments to estimate the progressivity parameter τ U S for the 2000-2006 period and obtained τ U S =
0.155 , which is nearly identical to our PSID estimate for the same years.9 Interestingly, the CBO
data show an increase in progressivity during the Great Recession, with τ averaging 0.185 over the
period 2008 − 2010. Since the PSID is the data source we use to estimate other model parameters
in Section 6, we will use the PSID-based estimate (τ U S = 0.151) in our baseline analysis.

    Discussion: One way to think about our exercise is as follows. We ask, within the tax system
class that is currently in place, how much more or less progressive should taxes be, and what
sectional data set from U.S. Internal Revenue Service (the “Public Use Tax File”). They estimate a smaller value for
progressivity because these data do not include any government transfers. The same caveat applies to the estimate in
Chen and Guo (2011).
    8
      The CBO analysis draws its information on income from two primary sources. The core data come from the
Statistics of Income (SOI), a nationally representative sample of individual income tax returns collected by the Internal
Revenue Service (IRS). The CBO supplements that information with data on transfers from the Annual Social and
Economic Supplement to the Census Bureau’s Current Population Survey (CPS).
    9
      The CBO reports statistics for households of all ages. To avoid conflating forced retirement saving and genuine
intragenerational redistribution in our estimate for tax progressivity, we excluded social insurance taxes and Social
Security and Medicare transfers from the CBO measures of taxes and transfers. If we do not exclude those items, we
obtain a higher estimate for progressivity, τ US = 0.232. The key reason is that the income before taxes and transfers of
retirees is low, but they receive large amounts of Social Security and Medicare transfers which makes the system look
more progressive. However, in our view this higher estimate exaggerates true progressivity because a large portion of
retirement transfers reflects taxes paid earlier in life and simply substitutes for private saving.



                                                           8
would the associated welfare gains be? Of course, although this functional form (eq. 1) offers a
good positive account of the U.S. tax system, it is potentially restrictive from a purely normative
perspective. Two key restrictions are implicit in T (yi ). First, it is either globally convex in income,
if τ > 0, or globally concave, if τ < 0. As a result, marginal tax rates are monotonic in income.
The same restriction applies to the average tax rate. Second, it does not allow for lump-sum
transfers in cash, since T (0) = 0.10
       Analyses of optimal tax design in the Mirrlees tradition often emphasize the importance of
allowing for lump-sum transfers. Heathcote and Tsujiyama (2013) consider the welfare gains of
moving from tax systems of the type described by eq. (1) to affine systems and to systems that do
not impose any parametric restrictions on the shape of the tax schedule. Their environment is a
stripped-down version of the model developed here. Under their baseline social welfare function,
Heathcote and Tsujiyama find that the welfare gains of moving from the tax system described
above with τ = 0.151 to the constrained-efficient and fully nonparametric Mirrlees system are
very small, on the order of 0.1 percent of consumption. The welfare gains of moving to the optimal
system in the affine class are typically negative, indicating that allowing for a lump-sum transfer
component in the tax system is less important than allowing for marginal tax rates to increase with
income.
       These findings suggest that restrictions implicit in the system described by eq. (1) may not be
particularly important from a normative standpoint. Moreover, as will become clear, an important
advantage of the functional form we use is that when we embed it in our structural equilibrium
model, the model remains tractable, and the trade-offs from increasing or reducing progressivity
are transparent. In addition, restricting attention to this functional form allows us to incorporate a
range of model features that turn out to be quantitatively important in shaping optimal progressiv-
ity, including skill investment choices, persistent life-cycle uninsurable shocks, and preference het-
erogeneity. Conducting a Mirrlees-style optimal taxation exercise in this rich environment would
be an extremely challenging numerical exercise.
  10
    Our model can capture (as part of the public good G) lump-sum transfers in the form of goods or services that are
imperfectly substitutable with private consumption (e.g., public education and health care).




                                                         9
3 Economic environment
We describe the economy in steady state and omit time subscripts.
Demographics: We adopt the Yaari “perpetual youth” structure. At every age a, an agent survives
into the next period with constant probability δ < 1, and a cohort of newborn agents of size (1 − δ)
enters the economy. We index agents by i ∈ [0, 1].

Life cycle: The life of every individual i starts with an initial investment in skills. After choosing
skill level si at age a = 0, the individual enters the labor market and starts facing random fluctu-
ations in her labor productivity zi . Every period she supplies hours of work hi ≥ 0 to the market
and consumes a private good ci and a publicly provided good G.11

Technology: Output Y is a constant elasticity of substitution aggregate of effective hours supplied
by the continuum of skill types s ∈ [0, ∞),
                                   Z ∞                        θ−1
                                                                 θ
                                                        θ−1
                             Y =         [N (s) · m (s)] θ ds       ,                                                 (5)
                                               0
where θ > 1 is the elasticity of substitution across skill types, N(s) denotes average effective
hours worked by skill type s, and m(s) is the density of individuals with skill level s. In this
baseline specification, all skill levels enter symmetrically in the production technology, and thus
any equilibrium differences in skill prices will reflect relative scarcity in the context of a model in
which different skill types are imperfect substitutes. In Section 7.4 we will consider an extension
where the technology features different relative weights on different skill types, which introduces
an additional (exogenous) driver for skill price differences.
       The rate of transformation between private and public consumption is one, and thus the aggre-
gate resource constraint for the economy is
                                                         Z       1
                                                   Y =               ci di + G.                                       (6)
                                                             0
Preferences: Preferences over private consumption, hours worked, publicly provided goods, and
skill investment effort for individual i are given by
                                                     X∞
                         Ui = vi (si ) + (1 − βδ) E0    (βδ)a ui (cia , hia , G),                                     (7)
                                                                       a=0
  11
     G has two possible interpretations. The first is that it is a pure public good, like national defense or the judicial
system. The second is that it is an excludable good produced by the government and distributed uniformly across
households, such as public health care or public transportation.

                                                                 10
where β < 1 is the pure discount factor, common to all individuals, and the expectation is taken
over future histories of idiosyncratic productivity shocks, whose process is described below. The
disutility of the initial skill investment si ≥ 0 takes the quadratic form

                                                             1 s2i
                                                vi (si ) = −       ,                                               (8)
                                                             κi 2µ

where κi ≥ 0 is a parameter, heterogeneous across individuals, which determines the utility cost
of acquiring skills. The larger is κi , the smaller is the cost, so one can think of κi as indexing
innate learning ability. We assume that κi ∼ Exp (η), an exponential distribution with parameter
η. The parameter µ is a scaling constant. As we demonstrate below, the combination of quadratic
skill investment costs and exponentially distributed ability yields Pareto right tails in the wage and
earnings distributions.
       The period utility function ui is specified as

                                                      exp [(1 + σ) ϕi ]
                     ui (cia , hia , G) = log cia −                     (hia )1+σ + χ log G,                       (9)
                                                           1+σ

where exp [(1 + σ) ϕi ] measures the disutility of work effort. The individual-specific parameter
                                           
ϕi is normally distributed: ϕi ∼ N v2ϕ , vϕ , where vϕ denotes the cross-sectional variance. We
assume that κi and ϕi are uncorrelated. The parameter σ > 0 determines aversion to hours fluctu-
ations. It is useful to define the tax-modified Frisch elasticity

                                                    1    1−τ
                                                       =     ,                                                   (10)
                                                    σ̂   σ+τ

which measures the after-tax elasticity of hours worked to a transitory wage shock.12 Finally,
χ ≥ 0 measures the taste for the publicly provided good G relative to private consumption.13

Labor productivity and earnings: Log individual labor efficiency zia is the sum of two orthogo-
nal components, αia and εia :
                                               log zia = αia + εia .                                             (11)
  12
      We abstract from the extensive margin of labor supply decisions, especially relevant for the second earner in the
household. See Guner, Kaygusuz, and Ventura (2012b) for a recent analysis of the effects of tax reforms on the joint
labor supply decisions of married households.
   13
      Note that the model is essentially unchanged if a fixed fraction of public expenditure is wasted, so that only a
fraction is delivered to consumers. Given logarithmic utility from G, this amounts to adding an irrelevant constant to
preferences.



                                                         11
The first component αia follows the unit root process αia = αi,a−1 + ωia , with i.i.d. innovation
                  
ωia ∼ N − v2ω , vω and with initial condition αi0 = 0, ∀i.14 The second component is an i.i.d.
                         
shock, εia ∼ N − v2ε , vε . This permanent-transitory error-component model for individual la-
bor productivity has a long tradition in labor economics (for a survey, see Meghir and Pistaferri,
2011).15 A law of large numbers (e.g., Uhlig, 1996) implies that individual-level shocks induce no
aggregate uncertainty in the economy as a whole.
       Individual earnings yia are, therefore, the product of three components:

                                     yia = p(si ) × exp(αia + εia ) × hia .                                          (12)
                                           | {z}    |    {z      } |{z}
                                            skill price   labor mkt. shocks    hours


The first component p (si ) is the equilibrium price for the type of labor supplied by an individual
with skills si ; the second component is individual stochastic labor efficiency; the third component
is the number of hours worked by the individual. Eq. (12) shows the determinants of individual
earnings: (i) skills accumulated before labor market entry, in turn reflecting innate idiosyncratic
learning ability κ; (ii) fortune in labor market outcomes determined by the realization of idiosyn-
cratic efficiency shocks; and (iii) work effort, reflecting, in part, innate idiosyncratic diligence
measured by (the inverse of) ϕ.
       Because idiosyncratic labor productivity is exogenous, the two channels via which taxation
will impact the equilibrium pre-tax earnings distribution are by changing skill investment choices,
and thus skill prices, and by changing labor supply decisions.

Financial assets: We adopt the partial-insurance structure developed in Heathcote et al. (2014)
and assume that there are only two types of financial assets in the economy. The first is a non-state-
contingent bond b with price q. The second is a full set of insurance claims against the ε shock.
Thus, by assumption the ε shocks are fully insurable, whereas the α shocks can potentially be
smoothed only by borrowing and lending via the risk-free bond. Let B (E) and Q (E) denote the
quantity and the price, respectively, of insurance claims purchased that pay one unit of consumption
  14
      Setting the dispersion in initial conditions αi0 to zero does not mean that there is no initial inequality in produc-
tivity. Recall that newborn agents enter the economy with heterogeneous skill levels si (also a fixed individual effect),
reflecting the dispersion in innate learning ability κi .
   15
      The empirical autocovariance function for individual wages displays a sharp decline at the first lag, indicating the
presence of a transitory component in wages. At the same time, within-cohort wage dispersion increases approximately
linearly with age, suggesting the presence of permanent shocks.


                                                           12
if and only if ε ∈ E ⊆ E. Our model nests several market structures. First, when vω = 0, the
economy displays full insurance. When vε = 0, it is a bond economy, as in Huggett (1993). In
general, when vω > 0 and vε > 0, ours is a partial insurance economy, i.e., an economy that offers
more insurance opportunities than a bond economy but less insurance than complete markets.16
In our framework, greater progressivity reduces the equilibrium demand for insurance, for two
reasons. First, public redistribution directly substitutes for private insurance. Second, progressivity
dampens the response of hours, and thus earnings, to insurable shocks, and hence reduces pre-tax
earnings inequality.17
       Finally, for convenience, we assume that there exist actuarially fair annuities against survival
risk. All assets in the economy are in zero net supply, and newborn agents start with zero initial
wealth. There are no intergenerational links in our model.18

Markets: The final consumption good, all types of labor services, and all financial assets are
traded in competitive markets. The publicly provided good G cannot be purchased privately. The
final good is the numeraire.

Government: The government runs the tax/transfer scheme described in Section 2 and provides
each household with an amount of goods or services equal to G. Without loss of generality, we
assume that government expenditures are a fraction g of aggregate output, i.e., G = gY . Since we
abstract from public debt, the government budget constraint holds period by period and reads as
                                  Z 1         Z 1
                                                             
                                g     yi di =     yi − λyi1−τ di.                            (13)
                                           0              0

The government chooses the pair (g, τ ), with λ being determined residually by eq. (13).
  16
     The complete markets assumption with respect to ε implies that it is straightforward to introduce a richer statistical
process for the ε shocks. For example, in Heathcote et al. (2014), we add a unit root component to the insurable
component of wages. As we show below, all that matters for the analysis of optimal taxation is the cross-sectional
variance of insurable wage risk, which can be estimated independently of the time-series process for ε. Therefore, to
simplify the exposition, in this paper we maintain the assumption that ε is i.i.d.
  17
     Note that because the extent of risk-sharing is exogenous in the model, making the tax system more progressive
does not affect the supply of private insurance. In contrast, public insurance can crowd out private insurance in
environments featuring moral hazard or limited commitment such as Chetty and Saez (2010) or Krueger and Perri
(2010).
  18
     Bakis et al. (2013) argue that private bequests provide a form of insurance against a bad draw of initial conditions
(κ, ϕ) , which diminishes the redistributive role of taxation and reduces optimal progressivity.




                                                              13
3.1 Agent’s problem

At age a = 0, the agent begins by choosing her skill level, given her idiosyncratic draw (κi , ϕi ).
Combining equations (7) and (8), it is immediate that the first-order necessary and sufficient con-
dition for the skill choice is
                                               X∞
                            1 s                          ∂ui (cia , hia , G)
                                 = (1 − βδ) E0     (βδ)a                     .                    (14)
                            κi µ               a=0
                                                                ∂s

Thus, the marginal disutility of skill investment for an individual with learning ability κi must
equal the discounted present value of expected benefits from the skill investment.
    The timing of the agent’s problem during her subsequent working life is as follows. At the
beginning of every period a, the innovation ωia to the random walk shock αia is realized. Then,
the insurance markets against the ε shocks open and the individual buys insurance claims B (·).
Finally, εia is realized and the individual chooses hours hia , receives wage payments, and chooses
consumption cia and bond holdings bi,a+1 for next period.
    Consider an individual who enters the period with bond holdings bia . Her budget constraint in
the middle of the period, when the insurance purchases are made, is
                                     Z
                                        Q (ε) B (ε) dε = bia ,                                    (15)
                                          E

and her budget constraint at the end of the period, after the realization of εia , is

                     cia + δqbi,a+1 = λ [p (si ) exp (αia + εia ) hia ]1−τ + B (εia ) ,           (16)

where the δ pre-multiplying the bond price reflects the return on the annuity for survivors.
    Given an initial skill choice, the problem for an agent is to choose sequences of consumption
and hours worked in order to maximize (7) subject to sequences of budget constraints of the form
(15)-(16), taking as given the wage process described in eq. (11). In addition, agents face limits on
borrowing that rule out Ponzi schemes and non negativity constraints on consumption and hours
worked.

3.1.1 A special case: the representative agent problem

It is useful to solve for a special case of the agent’s problem. When vϕ = vω = vε = 0 and
θ = ∞, there is no dispersion in the taste for leisure or in labor productivity. Since skill levels are

                                                    14
perfect substitutes in production, there is no skill investment either, so the economy collapses to a
representative agent model. The representative agent’s problem is static:
                                                               
                                               H 1+σ
                               max log C −            + χ log G                                    (17)
                                C,H            1+σ
                               s.t.

                                   C = λH 1−τ ,

and the production technology simplifies to Y = H, implying G = gH. Taking the fiscal variables
(λ, g, τ ) as given, the optimal choices for the representative agent are
                                             1
                             log H RA (τ ) =      log(1 − τ ),                                     (18)
                                           1+σ
                                                           1−τ
                        log C RA (g, τ ) = log λ (g, τ ) +     log(1 − τ ).                        (19)
                                                           1+σ
And substituting λ (g, τ ) from the government budget G = H − λH 1−τ into eq. (19) gives
                                                            1
                         log C RA (g, τ ) = log(1 − g) +       log(1 − τ ).
                                                           1+σ
   These allocations show that a more progressive tax system (a higher value for τ ) reduces labor
supply and therefore reduces equilibrium consumption. The intuition is that higher progressivity
raises the marginthe al tax rate faced by representative agent. In the limit, as τ → 1, H RA (τ ) → 0.
Note that, with logarithmic utility, the average level of taxation (λ) has no impact on labor supply,
which explains why hours worked (and output) are independent of the level of expenditures g.


4 Equilibrium
We now adopt a recursive formulation to define a stationary competitive equilibrium for our econ-
omy. The state vector for the beginning-of-the-period decision when insurance claims are pur-
chased is (ϕ, α, s, b). The individual state vector for the end-of-period consumption/saving and
                                        
labor supply decisions is ϕ, α, ε, s, B̄ , where B̄ = B(ε; ϕ, α, s, b). Finally, since initial wealth is
zero, the state vector for the skill accumulation decision at age a = 0 reduces to the pair of fixed
individual effects (κ, ϕ).
   Given (g, τ ), a stationary recursive competitive equilibrium for our economy is a tax pa-
                                                                                                       
rameter λ, asset prices Q (·) and q, skill prices p (s), decision rules s (κ, ϕ), c ϕ, α, ε, s, B̄ ,
                                   
h ϕ, α, ε, s, B̄ , b′ ϕ, α, ε, s, B̄ , and B (·; ϕ, α, s, b), and aggregate quantities N (s) such that

                                                  15
                                                                                                             
   1. Households solve the problem described in Section 3.1, and s (κ, ϕ), c ϕ, α, ε, s, B̄ , h ϕ, α, ε, s, B̄ ,
                       
      b′ ϕ, α, ε, s, B̄ , and B (·; ϕ, α, s, b) are the associated decision rules.

   2. Labor markets for each skill type clear and p (s) is the value of the marginal product from
         an additional unit of effective hours of skill type s :
                                                                            1θ
                                                                  Y
                                                p(s) =                             .
                                                              N(s) · m(s)

   3. Asset markets clear: q is such that the net demand for the bond is zero, and the prices Q (·)
         of insurance claims are actuarially fair.

   4. The government budget is balanced: λ satisfies eq. (13).

Proposition 1 [competitive equilibrium]. There exists a competitive equilibrium characterized
by no bond trading across individuals, i.e., b′ (ϕ, α, ε, s, B(ε; ϕ, α, s, 0)) = 0 for all (ϕ, α, ε, s).
The interest rate r ∗ ≡ − log q that supports this equilibrium satisfies
                                                                               vω
                                       ρ − r ∗ = (1 − τ ) [(1 − τ ) + 1]          ,                                  (20)
                                                                                2
where ρ ≡ − log β is the agents’ discount rate.

       The proof for Proposition 1 in the Appendix is based on a guess and verify strategy. We first
guess that the bond is not traded and solve for the equilibrium consumption allocation. Next, we
use the consumption allocation to construct the expected marginal rate of substitution and show
that it is independent of any individual state. Thus, at the interest rate that clears the bond market,
all agents are indifferent between borrowing and lending on the margin and are thus content to
maintain a zero bond position.19
       In equilibrium, the intertemporal dissaving motive (the left-hand side of equation 20) deter-
mined by the gap between ρ and r ∗ exactly equals the precautionary saving motive (the right-hand
side), which is increasing in the size of the uninsurable wage risk vω and decreasing in the progres-
sivity parameter τ . The logic is that as τ rises, the government provides more social insurance and
the private precautionary demand for savings falls.
  19
    As discussed in Heathcote et al. (2014) Section 2.3.2, this result is a generalization of the insight in Constantinides
and Duffie (1996). Here, we further generalize by endogenizing the wage through the skill investment decision and a
technology featuring imperfect substitutability across skill types.

                                                           16
       Proposition 1 has two implications that are instrumental for analytical tractability. First, indi-
vidual wealth is a redundant state variable: individuals start their life with zero wealth and remain
with zero wealth forever. All remaining individual states are exogenous variables.20 Second, there
is no self-insurance via noncontingent borrowing and lending against α shocks. In contrast, there
is perfect insurance, by assumption, against ε shocks. Thus, in equilibrium, there is a dichotomy
between one type of risk that is uninsured and another that is fully insured. We use the label “unin-
surable” to denote the α shock (and its innovations ω) and the label “insurable” to denote the ε
shock.
       The payoff from analytical tractability is illustrated by the next two propositions, which de-
scribe the equilibrium allocations and skill prices in closed form, and by Proposition 4 where
we derive an analytical solution for social welfare. In what follows, we make the dependence of
equilibrium allocations and prices on (g, τ ) explicit in preparation for our analysis of the optimal
taxation problem.

Proposition 2 [hours and consumption]. In equilibrium, the hours-worked allocation is given by

                                                               1       1
                     log h (ϕ, ε; τ ) = log H RA (τ ) − ϕ +      ε−           M (vε ; τ ) ,                   (21)
                                                               σ
                                                               b    σ
                                                                    b(1 − τ )
                                                                                                       (1−τ )(1−τ (1+b
                                                                                                                     σ )) vε
where H RA are hours worked by the “representative agent” in eq. (18) and M (vε ; τ ) =                        σ
                                                                                                               b          2
                                                                                                                             .
       The consumption allocation is given by
                                                
  log c (ϕ, α, s; g, τ ) = log C RA (g, τ ) ϑ(τ ) + (1 − τ ) [log p (s; τ ) + α − ϕ] + M (vε ; τ ) , (22)

where C RA is consumption of the “representative agent” in eq. (19) and ϑ(τ ) is a constant.

       With logarithmic utility and zero wealth, the income and substitution effects on labor supply
from differences in uninsurable shocks α and skill levels s exactly offset, and hours worked are
independent of (s, α). The hours allocation is composed of four terms. The first is hours of the
representative agent, which, as explained above, fall with progressivity. The second term captures
the fact that a higher idiosyncratic disutility of work leads an agent to choose lower hours. The
third term shows that the response of hours worked to an insurable shock ε (which has no income
  20
    The skill level is endogenous but fixed after age zero, and is hence pre-determined with respect to consumption
and labor supply decisions.



                                                       17
effect precisely because it is insurable) is mediated by the tax-modified Frisch elasticity 1/σ̂. Pro-
gressivity lowers this elasticity. The fourth term captures the welfare-improving effect of insurable
wage variation. As illustrated in Heathcote, Storesletten, and Violante (2008), larger dispersion of
insurable shocks allows agents to work more when they are more productive and take more leisure
when they are less productive, thereby raising average productivity, average leisure, and welfare.
Progressivity weakens this channel because it dampens the response of hours to insurable wage
shocks.
       The consumption allocation is additive in five separate components. The first component is
(rescaled) consumption of the representative agent, described in Section 3.1.1.21 Consumption is
increasing in the skill level s (because skill prices are increasing in skills) and in the uninsurable
component of wages α. Since hours worked are decreasing in the disutility of work ϕ, so are
earnings and consumption. The redistributive role of progressive taxation is evident from the fact
that a larger τ shrinks the pass-through to consumption from heterogeneity in initial conditions s
and ϕ and from ex post realizations of uninsurable wage shocks α. The final component captures
the fact that insurable variation in productivity has a positive level effect on average consumption
in addition to average leisure. Again, higher progressivity weakens this effect. Because of the
assumed separability between consumption and leisure in preferences, consumption is independent
of the insurable shock ε.

Proposition 3 [skill price and skill choice]. In equilibrium, skill prices are given by

                               log p (s; τ ) = π0 (τ ) + π1 (τ ) · s (κ; τ ) ,                        (23)
                       h                                  i                                    q
                   1
where π0 (τ ) = 2(θ−1)  log (1 − τ ) − log µη − log (θ) + (θ−1)    1
                                                                       log θ−1 θ                      η
                                                                                   , and π1 (τ ) = θµ(1−τ )
                                                                                                            .
       The skill investment allocation is given by
                                                                      r
                                                            ηµ (1 − τ )
                             s (κ; τ ) = µ (1 − τ ) π1 (τ ) · κ =       ·κ                                          (24)
                                                                θ
                                                                     q
                                                                          ηθ
and the equilibrium skill density m(s) is exponential with parameter µ(1−τ   )
                                                                               .

       This proposition has a number of important implications. First, the log of the equilibrium skill
price has a “Mincerian” shape, i.e., it is an affine function of s. The constant π0 (τ ) is the base
  21
     The rescaling constant ϑ(τ ) reflects the fact that the equilibrium balanced-budget function λ(g, τ ) is different in
the heterogeneous-agent and representative agent versions of the model. If we had specified (λ, τ ) as the fiscal policy
instruments, and g as the residual variable, this constant would drop out.

                                                           18
log-price of the lowest skill level (s = 0) and π1 (τ ) is the marginal return to skill. As is evident
from (24), a higher value for τ (more progressivity) depresses skill investment and compresses the
skill distribution toward zero. In the limit as τ → 1, s (κ) → 0 : there is no incentive to invest in
higher wage skills if all the excess returns will be taxed away. Because of imperfect substitution
in production, a rise in the relative scarcity of high skill types increases the marginal return π1 (τ )
and reduces the base price π0 (τ ). Thus, our model features a “Stiglitz effect” (Stiglitz, 1985):
progressivity increases the equilibrium marginal return to skill investment.
   With the solution for the skill price and the consumption allocation in hand, the expression
for the skill choice s is easy to understand. Substituting the period-utility specification in (9),
the consumption allocation in (22), and the skill price in (23) into the first-order condition (14),
expression (24) follows immediately. Note that, holding fixed the skill premium, π1 (τ ), the partial
equilibrium elasticity of skill investment with respect to (1 − τ ) is exactly unity. Taking into
account the equilibrium response of the skill premium, the general equilibrium elasticity of skill
investment with respect to (1 − τ ) is only one-half.
   The skill investment decision is independent of ϕ (and it would also be independent of α0 if
there was heterogeneity in initial labor productivity within skill types). The logic is that, with log
utility, the welfare gain from additional skill investment is proportional to the implied log change
in wages, which is independent of the level of wages or hours.

   Corollary 3.1 [distribution of skill prices]. The distribution of log skill premia π1 (τ ) · s(κ; τ )
is exponential with parameter θ. Thus, the variance of log skill prices is

                                                               1
                                       var (log p (s; τ )) =      .
                                                               θ2

The distribution of skill prices p(s; τ ) in levels is Pareto with scale (lower bound) parameter
exp(π0 (τ )) and Pareto parameter θ.

   Log skill premia are exponentially distributed because the log skill price is affine in skill s
(equation 23) and skills retain the exponential shape of the distribution of learning ability κ (equa-
tion 24). It is interesting that inequality in skill prices is independent of τ . The reason is that
progressivity sets in motion two offsetting forces. On the one hand, as discussed earlier, higher
progressivity increases the equilibrium skill premium π1 (τ ), which tends to raise inequality (the


                                                  19
Stiglitz effect on prices). On the other hand, higher progressivity compresses the distribution of
skills (the quantity effect). These two forces exactly cancel out and the variance of log skill prices
is independent of τ .
    Since the exponential of an exponentially distributed random variable is Pareto, the distribution
of skill prices in levels is Pareto with parameter θ. The other stochastic components of wages (and
hours worked) are lognormal. Because the Pareto component dominates at the top, the equilib-
rium distributions of wages and earnings have Pareto right tails, a robust feature of their empirical
counterparts (see, e.g., Atkinson, Piketty, and Saez, 2011).
    We now briefly discuss how taxation affects aggregate quantities in our model.

    Corollary 3.2 [aggregate quantities]. Average hours worked and average effective hours are
independent of skill type s and given by
                                                                                            
                                                        1     τ (1 + σ̂) 1                  vε
              H (τ ) = E [h (ϕ, ε; τ )] = (1 − τ )  · exp
                                                       1+σ                 −                     ,           (25)
                                                                  σ̂ 2       σ̂             2
                                                                         
                                                                     1
              N (τ ) = E [exp(α + ε)h (ϕ, ε; τ )] = H (τ ) · exp        vε .                                 (26)
                                                                     σ̂
    Output is given by

                   Y (τ ) = E [p (s; τ ) exp(α + ε)h (ϕ, ε; τ )] = E [p (s; τ )] N (τ ) ,                    (27)

                         θ
where E [p (s; τ )] =   θ−1
                              · exp (π0 (τ )).
    Aggregate labor productivity is
                                                                                  
                          Y (τ )   Y (τ ) N(τ )                               1
                                 =       ·      = E [p (s; τ )] · exp            vε .
                          H(τ )    N(τ ) H(τ )                                σ̂



    Note that progressivity affects aggregate output through two channels: τ affects the average
skill price (wage) via its impact on skill investment choices, and τ affects average hours worked.
                                                                                                  −1
From eq. (26) the elasticity of aggregate hours N(τ ) with respect to τ at τ = 0 is              1+σ
                                                                                                     .   From eq.
                                                            −1
(23) the elasticity of the average skill price π0 (τ ) is 2(θ−1) . We will return to these two elasticities in
Section 5.3 when characterizing the conditions under which the optimal tax system is progressive.
    Before turning to the characterization of the optimal degree of progressivity, we briefly discuss
the efficiency of the competitive equilibrium. The competitive equilibrium with τ = 0 is generally

                                                     20
not efficient in our environment for two reasons. The first is that there are no private markets
for insuring the ω shock. The second is that there is an externality in the individual labor supply
decision when the publicly provided good is valued: agents do not internalize that, by working
more hours, the quantity of public good will increase. Proposition 6 in Section 6.3 states that when
the economy features complete markets with respect to wage shocks (vω = 0) and does not feature
any public-good externality (χ = 0), the equilibrium with τ = 0 is efficient.


5 Welfare effects of tax reform
We imagine the economy starting out in a steady state corresponding to a policy pair (g−1, τ−1 ) and
consider permanent unanticipated policy changes at date 0 to a new policy (g, τ ). The presence of
skill investment in the model raises two related issues when contemplating tax reform. First, if past
investment decisions are irreversible, then the government is tempted to tax returns to skill because
such taxation is not distortionary ex post. This result is analogous to the temptation to tax initial
physical capital in the growth model. Second, if the distribution of skills adjusts slowly following
a change in the tax system, then even permanent policy changes will induce transitional dynamics.
In our benchmark analysis, we sidestep both of these issues by making the assumption that the
choice of skills is fully reversible at any point. This assumption implies that transition following
a tax reform is instantaneous: given a choice for the new pair (g, τ ), the economy immediately
converges to the steady-state distribution of skills associated with this policy.
   In Section 7.3 we generalize our characterization of optimal progressivity by making the polar
opposite assumption that skills are fully irreversible. In this alternative version of the model, there
are transitional dynamics between initial and final steady state, and the motive to tax the existing
stock of skills affects the optimal choice of progressivity.

5.1 Social welfare function

We will evaluate alternative policies using a social welfare function according to which the gov-
ernment puts equal weight on all agents within a given cohort. Given a law of large numbers, it
follows that the contribution to social welfare from any given cohort is remaining expected lifetime
utility for that cohort, where eq. (7) defines expected lifetime utility at age zero. The overlapping


                                                  21
generations structure of the model also requires us to take a stand on how the government weighs
cohorts that enter the economy at different dates. We assume that the planner discounts lifetime
utility of future generations at rate γ. Social welfare evaluated as of date 0 is then given by
                                                                ∞
                                                                X
                              W (g, τ ; τ−1 ) ≡ (1 − γ)Γ               γ j Uj,0 (g, τ ; τ−1 ) ,                       (28)
                                                                j=−∞


where Uj,0 (g, τ ; τ−1 ) is remaining expected lifetime utility (discounted back to date of birth) for the
                                                                                                  (γ−βδ)
cohort that entered the economy at date j as of date 0.22 The constant Γ =                        γ(1−βδ)
                                                                                                            pre-multiplying
the summation is a convenient normalization.23
       The next proposition expresses social welfare as an explicit function of the two policy instru-
ments (g, τ ) for the baseline model with fully reversible investment.

Proposition 4 [closed-form social welfare]. In the model with fully reversible investment, when
the social welfare function is given by eq. (28), social welfare from implementing policy (g, τ ) at
date 0 is

                                                                log(1 − τ )             1
          W(g, τ ; τ−1 ) = log(1 − g) + χ log g + (1 + χ)                       −                                     (29)
                                                              (1 + σ̂)(1 − τ ) (1 + σ̂)
                                                                                              
                                       log (1 − τ )         1            µ           −2θ (2θ−1)
                           +(1 + χ)                 +              log     (θ − 1) θ
                                        2 (θ − 1)      2 (θ − 1)         η
                              1             βδ (1 − γ) 1
                           − (1 − τ ) +                      (1 − τ−1 )
                             2θ             γ (1 − βδ) 2θ
                                                                
                                              1−τ              1−τ
                           − − log 1 −                    −
                                                θ                θ
                                       v ϕ
                           − (1 − τ )2
                                        2                                               
                                                                         −τ (1−τ )
                                           βδ vω              1 −  δ exp       2
                                                                                     vω
                           − (1 − τ )              − log                                
                                        γ − βδ 2                        1−δ
                                                     
                                       1         1 vε
                           +(1 + χ) vε − σ 2            .
                                       σ̂       σ̂ 2
  22
      Remaining lifetime utility is independent of the previous value for public good provision g−1 . It depends on the
lagged value for progressivity τ−1 because the difference between τ−1 and τ will determine (the cost of) net new
investment in skills for cohorts who entered the economy prior to date 0.
   23
      Following Calvo and Obstfeld (1988) we assume that the planner discounts each individual’s welfare back to their
birth dates using the agent’s discount factor β. This ensures that the planner’s objective function is time consistent.
Thus, the relative weight the planner places at a given date on the felicity of one agent who is s years older than another
is (β/γ)s .


                                                           22
       In order to obtain the expression in eq. (29), one has to first solve for the value λ (g, τ ) that
balances the government budget. Next, plugging the consumption, hours, and skill allocations
into (31) , one obtains the expression for social welfare as a function of primitive preference,
technology, and policy parameters in eq. (29).

Corollary 4.1: [independence from past choices] The welfare-maximizing pair (g, τ ) is indepen-
dent of τ−1 .

       In eq. (29) τ−1 appears in an additively separable term that does not involve any other policy
parameters. This result depends on the reversible skill investment assumption. Because the welfare
impact of alternative choices for (g, τ ) is independent of τ−1 , we henceforth denote social welfare
W(g, τ ) and omit the inconsequential terms involving τ−1 .

Corollary 4.2: [concavity of social welfare] Social welfare W(g, τ ) is globally concave in g and,
if σ ≥ 2, it is also globally concave in τ .

       As we show in the Appendix, aside from the term multiplying vε in the last row of (29),
the social welfare expression is globally concave in τ for any σ ≥ 0. The term involving vε is
also globally concave in τ if σ ≥ 2, a condition that is satisfied in the calibration.24 Establish-
ing concavity is useful since it means that a first-order approach can be useful in computing the
welfare-maximizing values for τ and g.

Corollary 4.3: [Samuelson condition] The welfare-maximizing value for g is given by

                                                             χ
                                                     g∗ =       .                                   (30)
                                                            1+χ

       Because g only appears in the first line of eq. (29), the optimal choice for public expenditures
in the economy can easily be derived by differentiating (29) with respect to g. In our economy, the
optimal fraction of output to devote to public expenditure is independent of how much inequality
there is in the economy and independent of how progressive the tax system is. It only depends
on households’ relative taste for the public good χ. We label this the “Samuelson condition”
because, as we show in Section 5.2.1, it is reminiscent of Samuelson’s (1954) dictum that, in a
representative agent model, a government choosing public spending should equate the marginal
  24
       See the Appendix for a more thorough interpretation of sufficient conditions.



                                                            23
rate of substitution between private and public consumption to the marginal rate of transformation
between the two goods, which is equal to one.

Corollary 4.4: [independence of policy instruments] The welfare-maximizing value for τ is
independent of g.

       The two policy parameters τ and g do not appear jointly in any one of the additively separable
terms in eq. (29). Thus, the welfare-maximizing choice for τ will always be independent of
the value for g and in particular independent of whether the choice for g is welfare maximizing.
However, the welfare-maximizing choice for τ will depend on the parameter χ that defines the
taste for publicly provided goods.

Corollary 4.5: [irrelevance of µ and η] The welfare-maximizing value for progressivity τ is
independent of the parameters µ and η.

       The welfare-maximizing value for progressivity τ is independent of the weight on the disutility
of skill investment µ and the exponential parameter in the distribution for skill investment costs η
since these two parameters only appear in an additively separable constant in the second line of the
social welfare expression (29). Thus, the only parameter that will matter in determining how skill
investment shapes optimal progressivity is θ, the elasticity of substitution between different skill
types in production.

Corollary 4.6 [γ = β case]. If the government discounts the lifetime utility of future cohorts at
rate γ = β, then social welfare W (g, τ ) is equal (up to an additive constant) to average period
utility in the cross section
                        ∞
                        X
 W (g, τ ) = (1 − δ)          δ j E [u (c (ϕ, αj , s(κ; τ ); g, τ ) , h (ϕ, ε; τ ) , G (g, τ ))] − E [v (s(κ; τ ), κ)] ,
                        j=0
                                                                                                                   (31)
where the first expectation is taken with respect to the equilibrium cross-sectional distribution of
(ϕ, αj , s, ε) and the second expectation with respect to the cross-sectional distribution of (s, κ).25

       Thus, when the planner values cohorts entering at successive dates at the same rate that agents
discount over time, the optimal policy (g, τ ) is simply the policy that maximizes average period
  25
    The uninsurable shock αj is indexed by age j because the conditional variance of the unit root process α depends
on age j.

                                                          24
utility. Note that this result hinges on skill investment being fully reversible.

5.2 Decomposition of the social welfare function

We now demonstrate that every term in (29) has an economic interpretation and captures one of
the forces that determine the optimal degree of progressivity. Because these terms are additively
separable in the expression for social welfare, the distinct roles of various economic forces are easy
to differentiate and quantify. For this decomposition we focus on the case γ = β.

5.2.1 Welfare of the representative agent

Substituting allocations (18) and (19) into the objective function of the representative agent prob-
lem of Section 3.1.1 (after solving for λ), one obtains welfare for the representative agent,
                                                                     log(1 − τ )       1
               W RA (g, τ ) = log(1 − g) + χ log g + (1 + χ)                       −         ,              (32)
                                                                   (1 + σ̂)(1 − τ ) (1 + σ̂)
which is precisely the first line of the social welfare expression in (29).
       What does this welfare expression imply for optimal policy? Differentiation of (32) with re-
spect to g yields the Samuelson condition, eq. (30). This value for g equates the marginal rate of
substitution between private and public consumption for the representative agent (which is equal
to χg/ (1 − g)) to the technological rate of transformation between the two goods (which is equal
to one).
       Differentiation of (32) with respect to τ yields

                                                  ∗
                                                 τRA = −χ.                                                  (33)

Eq. (33) states that a benevolent government in the representative agent economy would choose
regressive taxes, with the extent of regressivity proportional to the relative taste for the public good.
The logic is that because there are no private markets for the publicly produced good, there is an
externality. Each individual agent does not internalize that, by working more and producing more,
output will increase and the government will be able to provide more G. A regressive tax increases
labor supply, as is clear from the hours allocation (18), and entirely corrects this externality, a
result we restate in the following corollary.26
  26
    If there was a private market for G, and G was a nonrival nonexcludable good, then the welfare theorems would
apply and the first best could be implemented with λ = 1 and τ = 0.

                                                       25
Corollary 4.7 [efficiency in the RA model].                   If vϕ = vω = vε = 0 and θ = ∞ (i.e., in a
                                                       χ
representative agent economy), then g ∗ =             1+χ
                                                            and τ ∗ = −χ implement the first best.

       To gain some intuition, note that one could alternatively implement the first best with lump-
sum taxes that do not distort labor supply and finance the desired amount of G. Given τ = −χ,
the marginal tax rate at the equilibrium level of income Y is exactly equal to zero (just as it would
be with lump-sum taxes), whereas given g = χ/(1 + χ), the average tax rate is exactly sufficient
to finance the optimal level of expenditure. Thus, the system perfectly replicates a lump-sum tax.

5.2.2 Welfare from skill investment

The second, third, and fourth lines in eq. (29) are all related to the skill investment choice. To
begin with, from equations (23), (26), and (27), the term in square brackets in the second line is
the log of aggregate productivity (output per efficiency unit of labor) in the economy, also equal to
log E [p (s; τ )]:
                                                                                               
                           Y (τ )         log (1 − τ )       1                µ        −2θ (2θ−1)
                 log                    =              +           log          (θ − 1) θ           .          (34)
                           N(τ )           2 (θ − 1)     2 (θ − 1)            η
The pattern of skill investments determines aggregate productivity through the constant elasticity
of substitution (CES) technology: the more evenly distributed are skills, the higher is productivity.
Eq. (34) indicates that higher progressivity reduces productivity because it reduces skill investment
and thereby compresses the skill distribution toward zero. Note that, in terms of its impact on social
welfare, productivity is multiplied by (1 + χ) because the higher the desire for public good, the
more valuable is an additional unit of output.
       Skill investment is not costless. The third line of (29) is the contribution to welfare from skill
investment costs. The average skill investment cost for all the future cohorts and for the past
cohorts who readjust their skill level is
                                                                     1
                                             E [v (s(κ; τ ), κ)] =      (1 − τ ),                              (35)
                                                                     2θ
which is the first term on the third line.27 Skill investment costs are decreasing in τ because more
progressivity reduces skill acquisition. Combining (34) and (35) , it is easy to show that the pro-
  27
    If older cohortsh already have some skillsi at the time of the tax reform, they only need to pay net new invest-
                                2               2
ment costs of 2κ1i µ s (κi ; τ ) − s (κi ; τ−1 ) , which accounts for the second seperable term in τ−1 in the welfare
expression. See the Appendix for details.

                                                            26
                                                                      0.18



                                                                      0.16




                                Optimal degree of progressivity (τ)
                                                                      0.14



                                                                      0.12



                                                                       0.1



                                                                      0.08



                                                                      0.06



                                                                      0.04



                                                                      0.02



                                                                        0
                                                                             1   5               10             15             20   25
                                                                                     Elasticity of substitution in production (θ)




Figure 2: Optimal τ as a function of the elasticity of substitution across skill levels in production
(θ)

ductivity gain from skill investment net of education costs is maximized at τ = −1/ (θ − 1) < 0:
a regressive system invites larger skill investments and the stronger is complementarity in produc-
tion, the stronger is this force.
       The government also cares about how the choice for τ impacts consumption dispersion both
directly (via redistribution) and indirectly, via equilibrium skill prices and quantities. The welfare
cost of consumption dispersion across skill types is
                                                                          
                                                                  1−τ      1−τ
             welfare cost of skill price dispersion = − log 1 −         −        ,                                                       (36)
                                                                   θ        θ

or the term in the fourth line of (29).28 This cost is decreasing in τ because higher progressivity
reduces after-tax earnings and consumption dispersion.
       We have learned that offsetting forces determine the optimal level of progressivity with respect
to skill acquisition: more progressivity diminishes aggregate productivity, but it also decreases
consumption dispersion across skill types. Which force dominates? In Figure 2 we set χ = 0,
  28
     The skill-related component of consumption, p (s)1−τ , is Pareto distributed with parameter P = θ/(1 − τ ). If
consumption is Pareto distributed with Pareto parameter P , the expected value for consumption is P/(P − 1). Log
consumption is then exponentially distributed, with exponential parameter P . Let Fc denote the Pareto cumulative
distribution function (CDF) for consumption, and let Fz denote the Exponential CDF for z = log c. The welfare cost ̟
of consumption dispersion (assuming logarithmic preferences) can then be calculated as the percentage by which safe
consumption must be reduced to deliver the same expected utility as risky consumption: log ((1 −  ̟)P/(P − 1)) =
R                                                                                                 θ−(1−τ )
  log c dFc = 1/P . Now, since in our example P = θ/(1 − τ ) and ̟ is small, ̟ ≈ − 1−τ  θ  − log     θ      as in eq.
(36).

                                                                                                       27
σ = ∞, and vϕ = vω = vε = 0 to isolate the skill investment channel and show how τ ∗ varies
with θ. The figure reveals that the skill investment component of social welfare calls for progres-
sivity (τ ∗ > 0), a result we prove formally in Section 5.3. At the same time, the optimal degree of
progressivity is nonmonotone in θ. As θ → ∞, the economy converges to a representative agent
economy, so τ ∗ = 0. For lower values for θ, the utilitarian government chooses τ ∗ > 0 to reduce
the welfare loss from consumption dispersion. However, as θ → 1 and skill complementarity in-
creases in production, the distortion to aggregate productivity from progressivity becomes more
                                       1
important – because of the term     2(θ−1)
                                             log(1 − τ ) in (34) – and τ ∗ falls. At the same time, a regres-
sive tax scheme, which would raise productivity, would make consumption inequality explode: eq.
(36) shows that, as θ → 1, the term − log (θ − 1 + τ ) goes to −∞ as τ approaches zero. Overall,
these two forces balance out, and as θ → 1, τ ∗ → 0 – a flat tax system. Thus, the optimal degree
of progressivity is largest for intermediate values for θ.

5.2.3 Welfare from preference heterogeneity and uninsurable wage risk

The existence of heterogeneity in the preference for leisure, through variation in the parameter ϕ,
translates into dispersion in hours worked, earnings, and consumption. The fifth line of the social
welfare expression is the welfare contribution of this source of consumption dispersion:

                             welfare cost of varϕ (log c) = (1 − τ )2 vϕ .                              (37)

This term is the familiar Lucas representation of the welfare cost of consumption dispersion when
the underlying shocks are lognormal: one-half of the variance of log consumption times the coef-
ficient of risk aversion, which is equal to one in our model.
   Uninsurable shocks are another key source of consumption dispersion, and their contribution
to social welfare shows up in the sixth line of eq. (29):
                                                                                         
                                                                              −τ (1−τ )
                                                 βδ vω            1 − δ exp       2
                                                                                        vω
    welf. cost of varα (log c) = (1 − τ )                − log                                      (38)
                                              γ − βδ 2                    1−δ
                                      1
                                ≃       · varα (log c) when γ = β,
                                      2
where varα (log c) denotes within-skill group variance of log consumption in cross section. The
approximation in the second line of eq. (38) is extremely accurate for plausible parameter values, as

                                                       28
we show in the proof of Proposition 4 in the Appendix. As can be seen from (37) and (38), a higher
τ reduces consumption dispersion stemming from both preference heterogeneity and uninsurable
risk. Since consumption inequality lowers welfare, these two forces push the optimal τ towards
one, the value at which there would be zero consumption dispersion.

5.2.4 Welfare from insurable wage risk

The last two terms of the welfare expression are also easily interpretable. Note that
                                               
                                          N(τ )          1
                                    log             =       vε                                                       (39)
                                          H(τ )          σ̂
                                                          1
                                      varε (log h) =          vε .                                                   (40)
                                                         σ̂ 2

       The first term is the log productivity gain from insurable wage variation. As explained when
discussing the equilibrium allocations, more insurable wage dispersion is good news for welfare,
because individual hours worked become more positively correlated with individual productivity
and aggregate output increases. Hours dispersion is, however, costly in welfare terms because
of the convexity in the disutility of hours. This cost is captured by the last term in the welfare
expression, which is the cross-sectional variance of log hours due to insurable shocks multiplied
by σ, which measures the aversion to hours fluctuations.29
       The sum of these two terms (productivity gain net of the disutility costs of hours fluctuations)
is maximized at τ = 0 because hours respond efficiently to insurable shocks with τ = 0, whereas
τ 6= 0 induces misallocation in hours worked. Thus, larger insurable wage risk will push the
optimal τ toward zero.30

5.3 When should taxes be progressive?

By differentiating the expression for social welfare in eq. (29) with respect to τ , one can obtain a
necessary and sufficient parametric condition for the optimal tax system to be progressive.
  29
      As with the productivity gain from skill investment, the productivity gain from insurable risk is multiplied by
1 + χ, reflecting the additional value of an extra unit of output when agents value government expenditures.
   30
      This finding is different from the result in ? that the standard Mirrlees-style formulas for the optimal tax schedule
are unaffected by the presence of private insurance that does not generate moral hazard. The main reason for this
difference is that ? assume that the government can tax earnings net of private insurance payments whereas we
assume that taxes are levied on labor income only.



                                                           29
Proposition 5 [condition for progressivity]. The optimal value for τ is strictly positive if and only
if                                                                                       
                          1        1   1                                       1      1
                                     −         + (vϕ + vα ) > χ                    +            .                 (41)
                          2       θ−1 θ                                    2(θ − 1) 1 + σ
          The terms on the left-hand side of (41) are the marginal benefits from increasing progressivity
at τ = 0, and the ones on the right-hand side are the corresponding marginal costs.31 The first term
on the left-hand side is the gain from reducing consumption inequality across skill types net of the
productivity loss from reduced skill investment (minus its costs). The second term is the gain from
reducing consumption dispersion across agents with different preferences and labor productivity.
          The term in parentheses on the right-hand side is the (negative of the) elasticity of aggregate
output with respect to τ . The first component captures the loss in output associated with reduced
skill investment, and the second reflects the loss from reduced labor supply: recall the discussion of
Corollary 3.2. The welfare loss from lower output is proportional to χ, which captures the strength
of the public good externality. The logic is that χ captures the wedge between the social marginal
value of additional output and the private marginal value. Note that if χ = 0, then the optimal tax
system is always progressive.

5.4 Optimal marginal tax rate at the top

One focus of the Mirrlees approach to optimal taxation has been characterizing the optimal marginal
tax rate at the top of the income distribution. Assuming an unbounded Pareto right tail for exoge-
nous labor productivity (and assuming the social welfare function puts zero weight on agents far
in the tail), Saez (2001) shows that the marginal tax rate at the top converges to

                                                                 1
                                               t̄ =                           ,                                   (42)
                                                      1+   ζu   + ζ c (θ − 1)

where ζ u and ζ c are uncompensated and compensated labor supply elasticities.32 Thus, as Saez
and others have noted, the thicker is the right tail of the productivity distribution (i.e., the smaller
is the Pareto coefficient θ), the higher is the optimal marginal tax rate at the top.
     31
      This condition is independent of the insurable variance vε because the term in welfare involving this component
is maximized at τ = 0, so the marginal welfare effect from a change in τ is zero at τ = 0.
   32
      Given our utility function, as earnings increase, these elasticities converge to zero and 1/(1 + σ), respectively,
and thus the efficient top marginal tax rate – given exogenous wages – would converge to t̄ = 1+σσ+θ .




                                                                30
       Our model with χ = 0 and vϕ = vω = vε = 0 is a version of the Mirrlees environment,
but with one important difference: the Pareto distribution for labor productivity is endogenously
determined by skill investment, and its Pareto parameter is the elasticity of substitution across skill
types in production. As we showed in Section 5.2.2, the optimal choice for τ is nonmonotonic in
θ.33 In particular, there is a range of values for θ close to unity in which reducing θ (and increasing
inequality) lowers optimal progressivity, and thus marginal tax rates at high income levels, in sharp
contrast to the familiar Mirrlees result.34 Recall the logic for this result: the more complementary
are skill types, the larger are the productivity gains from a more even skill distribution. Thus, the
more costly are high tax rates at the top that discourage skill investment of high learning ability
(high κ) individuals. We conclude that whether the Pareto right tail in the earnings distribution
reflects exogenous luck or endogenous investments is quantitatively important for determining
optimal top marginal tax rates.


6 Quantitative implications of the theory
After describing the model parametrization, we explore the quantitative implications of the theory.
Next, we perform a robustness analysis with respect to (i) the weights used by the government in
its social welfare function and (ii) the assumption that government expenditures are valued.

6.1 Parametrization

Thanks to the closed-form solution for allocations, we can derive analytical expressions for the
cross-sectional moments of the joint equilibrium distribution of wages, hours, and consumption.
The explicit analytical links between structural parameters and equilibrium moments enable us
to prove identification of all parameters and to estimate the model given empirical counterparts
of these moments computed from commonly used micro-data on wages, hours worked, and con-
sumption.
       We begin by recognizing that in survey data, hours and consumption are measured with error,
  33
      Figure 2 is drawn for the case σ = ∞, but the nonmonotonicity result is more general and applies with elastic
labor supply.
   34
      Strictly speaking, for any τ > 0, marginal tax rates converge to one under our functional form for taxes as earnings
go to infinity. But from eq. (3), it is easy to show that marginal tax rates are strictly increasing in progressivity for any
y ∈ (exp(−1/(1 − τ )), ∞).


                                                            31
and hourly wages (computed as annual earnings divided by annual hours) inherit measurement
error from both variables. Let vµh , vµc , vµy denote the variances of reporting error in hours, con-
sumption, and earnings, respectively, and assume measurement error is classical. If we tack on
measurement error to log wages and the log allocations in (21) and (22), and compute cross-
sectional moments of their joint distribution, we obtain the following set of moment conditions:

                                                         1
                                   var (log w) =            + vα + vε + vµy + vµh                            (43)
                                                        θ2
                                                                1
                                   var (log h) =        vϕ + 2 vε + vµh
                                                               σ̂              
                                                                 2       1
                                    var (log c) =       (1 − τ ) vϕ + 2 + vα + vµc
                                                                        θ
                                                        1
                            cov (log h, log w) =           vε − vµh
                                                        σ̂
                             cov (log h, log c) =       (1 − τ ) vϕ
                                                                         
                                                                    1
                            cov (log w, log c) =        (1 − τ ) 2 + vα .
                                                                    θ

       These moments contain all the structural parameters of the model. The variance of the unin-
surable innovation vω is implied by vα , given a value for δ.35
       Based on our previous work (Heathcote et al., 2014), we set σ = 2.165, a value broadly
consistent with the microeconomic evidence on the Frisch elasticity (see, e.g., Keane, 2011). From
the same paper we set the variances of measurement error to vµh = 0.036, vµy = 0, and vµc =
0.040. In light of our evidence on the progressivity of the U.S. tax/transfer system described in
Section 2, we set τ = 0.151.
       It is easy to see that vϕ , vε , and (vα + 1/θ2 ) are overidentified by the set of moments in (43).
To separately identify the cross-sectional variance of uninsurable risk, vα , from the cross-sectional
variance of skill prices, 1/θ2 , we use the cross-sectional moments var 0 (log w), var 0 (log c) , and
cov 0 (log w, log c) at age j = 0, which reflect only variation in skills acquired before labor market
entry, since vα0 = 0. In Section 6.2.1 we pursue an alternative strategy for separating vα and θ.
       Our data are drawn from two surveys, the Panel Study of Income Dynamics (PSID) for years
  35
       The variance of α at age j is vαj = jvω so the cross-sectional uninsurable variance in the model is

                                                          X
                                                          ∞
                                                                             δ
                                           vα = (1 − δ)         δ a vαa =       vω .
                                                          a=0
                                                                            1−δ



                                                            32
                                             Table 1: Parametrization
                 τ US      χ       σ      vµh    vµy    vµc      vϕ         vε       vα          θ         vω
 Baseline       0.151    0.233   2.165   0.036    0    0.040    0.035     0.166     0.097      3.144     0.003
               (0.003)     –       –       –      –      –     (0.002)   (0.010)   (0.007)    (0.115)   (0.0003)

Alternative     0.151    0.233   2.165   0.036    0    0.040    0.021     0.139        0      2.000         0
               (0.003)     –       –       –      –      –     (0.002)   (0.010)   (0.0000)     –       (0.0000)

   Source: PSID and CEX, 2000-2006. See the main text for details. Bootstrapped standard errors based on
   500 replications in parentheses.


   2000, 2002, 2004, and 2006 and the Consumption Expenditure Survey (CEX) for years 2000–2006.
   We apply the same sample selection criteria outlined in Section 2. We first regress individual log
   wages, individual log hours, and household log consumption on year dummies, a quartic in age,
   and (for consumption) household composition dummies. We then use the residuals from these
   regressions to construct the empirical counterpart of the moments in (43) plus the three moments
   at age “zero” (an average of ages 25-29 in the data). The minimum distance procedure therefore
   uses nine moments to estimate four parameters (vϕ , vε , vα , θ). We set δ = 0.971 to match an
   expected working life of 35 years, the same age span considered in the micro-data. Given an
   estimate for vα , the innovation variance vω is pinned down. The estimated parameter values are
   summarized in Table 1, together with the other pre-determined parameter values.
           In the data, var (log w) = 0.43, var (log h) = 0.11, var (log c) = 0.18, and var 0 (log c) =
   0.15.36 The estimates in Table 1 imply that, net of measurement error, (i) the insurable component
   accounts for 40 percent of the variance of wages, the uninsurable component accounts for one-
   quarter, and the heterogeneity in skills for the residual one-third; (ii) cross-sectional dispersion
   in the disutility of work effort explains almost half of the hours variation, and insurable shocks
   explain almost one-quarter; (iii) one-fifth of consumption inequality is due to dispersion in the
   disutility of work, and the residual is accounted for equally by uninsurable wage risk and skill
   heterogeneity; (iv) the growth in the variance of log consumption over the life cycle (ages 25-60)
   is around 0.10. These findings are broadly in line with the results in Heathcote et al. (2014).
           To set the value for χ, the relative weight on the government-provided good in preferences, we
   take the view that the fraction of output devoted to publicly provided goods g is chosen efficiently.
      36
       The values of the other empirical moments used in the estimation are cov (log h, log w) = −0.09,
   cov (log h, log c) = 0.03, cov (log w, log c) = 0.15, var0 (log w) = 0.28, and cov 0 (log w, log c) = 0.10.


                                                          33
                                                                             Social Welfare Function                                                                                                                             Social Welfare Function
                                                      1                                                                                                                                          4

                                                                                                                                                                                                              (2) + Skill Inv.
                                                            Welfare Gain = 0.5%                                                                                                                                 τ = −0.062                                  (3) + Pref. Het.


       welfare change rel. to optimum (% of cons.)
                                                      0                                                                                                                                          2




                                                                                                                                                 welfare change rel. to optimum (% of cons.)
                                                                                                                                                                                                                                                               τ = −0.020

                                                                                                                                                                                                 0
                                                     −1


                                                                                                                                                                                               −2
                                                     −2
                                                                                                                                                                                                                                            (5) + Ins. Shocks
                                                                                                                                                                                                                                                τ* = 0.062
                                                                                                                                                                                               −4
                                                     −3

                                                                                                                                                                                               −6

                                                     −4                                                                                                                                                                                        (4) + Unins. Shocks
                                                                                                                                                                                               −8
                                                                                                                                                                                                                                                     τ = 0.073
                                                                         τ*= 0.062
                                                     −5                                                      US
                                                                                                        τ     = 0.151                                                                          −10


                                                     −6
                                                                                                                                                                                               −12

                                                                                                                                                                                                                           (1) Rep. Agent
                                                     −7
                                                                                                                                                                                               −14
                                                                                                                                                                                                                             τ = −0.233

                                                                                                                    Baseline Model
                                                     −8                                                                                                                                        −16
                                                     −0.3   −0.2      −0.1           0       0.1       0.2         0.3               0.4                                                             −0.4   −0.3       −0.2        −0.1          0         0.1        0.2      0.3   0.4
                                                                              Progressivity rate (τ)                                                                                                                              Progressivity rate (τ)



                                                             (a) Social Welfare Function                                                        (b) Decomposition of the Social Welfare Function

Figure 3: Social welfare as a function of τ and welfare gain relative to the current U.S. system (left
panel). Decomposition of social welfare into various components described in Section 5.2. The
optimal value for τ is 0.062.

In Section 7.1 we show that if g was the outcome of voting, the median voter would pick the
efficient level g ∗ , which provides a theoretical foundation for this calibration choice. Since, over
the period 2000-2006, g = G/Y = 0.189, we set χ = 0.233. Because the optimal τ is sensitive to
the choice for χ, Section 6.4 discusses alternative scenarios.

6.2 Results

Once the optimality condition g ∗ = −χ is substituted into (29) and values have been assigned to
all the structural parameters, one obtains social welfare W (τ ) as a function of τ only. Figure 3(a)
plots this function, assuming γ = β. The value of progressivity that maximizes social welfare is
τ ∗ = 0.062. The welfare gain from reducing progressivity from the current value of τ U S = 0.151
to τ ∗ is equivalent to 0.5 percent of lifetime consumption.
   How different are the actual and optimal schemes? Note that the ratio of the variance of log
disposable income to pre-government income is (1 − τ )2 . Moving to the optimal scheme would
increase this ratio from 0.72 to 0.88. The average income-weighted marginal tax rate would drop
from 31 to 24 percent. Section 6.5 compares the tax/transfer schedule under the two systems in
more detail.
   The right panel reconstructs W (τ ) by sequentially adding all of its components. The first


                                                                                                                                           34
component is welfare of the representative agent. As discussed, this is maximized at τ = −χ =
−0.233. Adding the skill investment component (productivity gain from skill investment net of
education costs minus the implied welfare loss from between-skill consumption inequality) pushes
toward a more progressive system, and the optimal τ moves to the right to −0.062. The concern for
additional consumption inequality induced by preference heterogeneity further raises the optimal τ
to −0.02. Uninsurable shocks are a stronger source of consumption dispersion, which is reflected
in the substantial upward jump in τ to 0.073 when this component is incorporated. Finally, adding
the productivity gain from insurable shocks pulls τ back toward zero to its final value of 0.062.
       Consumption dispersion generated by preference heterogeneity, skill dispersion, and uninsur-
able risk induces the government to choose a progressive scheme. If consumption inequality was
the government’s only concern, τ would be optimally set to one, and the tax/transfer scheme would
fully equate post-government income and consumption across households. Besides the desire to
provide public goods, which we analyze in Section 6.4, two forces limit progressivity in the model:
the distortion to skill investment and the distortion to labor supply.
       To measure the strength of these two channels, we compute the optimal τ (i) when σ = ∞
and labor supply is therefore inelastic and (ii) when skills are exogenous.37 In the case σ =
∞, the optimal τ is 0.217, whereas in the case of an exogenous skill distribution, the optimal
τ is 0.211. Therefore, the endogeneities of labor supply and skill investment play quantitatively
similar roles in limiting progressivity, and in the absence of either one of these channels, optimal
progressivity would be substantially higher. Note in particular that endogenous skill investment,
a margin ignored in much of the literature, is a very important factor restraining progressivity
in our model.38 Absent this margin, the welfare-maximizing policy would imply an increase in
progressivity relative to the current tax system, whereas once this margin is incorporated, reducing
progressivity is optimal.
  37
      This latter case is obtained by excluding from the welfare function the first two terms associated with the produc-
tivity gain from skill investment net of the education cost.
   38
      Two recent papers that do explicitly model the skill investment margin are Guvenen, Kuruscu, and Ozkan (2014)
and Krueger and Ludwig (2013).




                                                          35
6.2.1 Alternative calibration of θ and top marginal tax rates

A long-standing challenge in labor economics is understanding what fraction of wage dispersion
reflects differential endogenous skill or human capital investments, and what fraction reflects ex-
ogenous differences in productivity. In the context of our model, the variance of the former is 1/θ2
and the variance of the second is vα = δvω /(1 − δ). We now consider an alternative strategy for
calibrating θ (and thus vω ). Since the top end of the model distribution of income is approximately
Pareto with parameter θ, we have that

                                             E [p (s) |s > s̄]    θ
                                                               =     .                                              (44)
                                                   p (s̄)        θ−1

From our PSID sample, we estimate that the ratio in (44) is stable and around 2 for income thresh-
olds above $250,000, which implies a value of θ = 2.39 If we use this moment to calibrate θ,
instead of using consumption dispersion at labor market entry, and reestimate the other model pa-
rameters, we obtain the values in the second row of Table 1. Because the consumption dispersion
implied by skill investment is so large with θ = 2, the estimation sets the variance of the unin-
surable lifetime shocks vω to zero.40 The model still calls for positive preference heterogeneity
and insurable productivity dispersion to account for the cross-sectional inequality of hours in the
data. Under this alternative calibration, we obtain τ ∗ = 0.037. Optimal progressivity is lower than
in the baseline calibration, because a larger role for endogenous skills in generating wage disper-
sion implies a correspondingly smaller role for uninsurable life-cycle shocks, and thus reduces the
incentive to provide social insurance against those shocks.

6.3 Nonutilitarian welfare criteria

The utilitarian social welfare function in (31) embeds both the desire to insure households against
the privately uninsurable life-cycle shocks ω and to redistribute against income differentials due to
initial heterogeneity in preferences (ϕ) and learning ability (κ). We now consider some alternative
formulations for the social welfare function that retain the desire to insure against uninsurable
  39
      Since the benchmark of comparison for our normative results is τ US estimated on PSID data, we use PSID data
for this alternative estimate of θ. Tax return data on wage income tabulated by Piketty and Saez (2003, Table B3)
indicate a value for θ between 1.6 and 2.2 for the years 2000-2006, depending on the choice for the threshold s̄. Thus,
our estimate falls within this range.
   40
      As a result, under this calibration, the model cannot generate a rise in consumption inequality over the life cycle.


                                                           36
shocks, but switch off the desire to redistribute with respect to initial conditions. We first note
that when there is no need to raise revenue to finance public expenditure (χ = 0), and when all
life-cycle productivity shocks are insurable (vω = 0) the welfare theorems apply, and thus the
laissez-faire competitive equilibrium with λ = 1 and τ = 0 is efficient.

Proposition 6 [efficiency with χ = vω = τ = 0]. If χ = vω = 0, then competitive equilibrium
allocations with τ = 0 are efficient. The corresponding planner weights are
                                                            
                                               exp −ϕ + ηθ κ
                                    ζ(ϕ, κ) =                 .                                                     (45)
                                                  θ/(θ − 1)

       Proposition 6 describes the Pareto weights for the planner’s problem whose solution coincides
exactly with the competitive equilibrium with τ = 0. These planner weights, by construction,
do not incorporate any desire to redistribute with respect to income differentials reflecting fixed
heterogeneity in preferences or learning ability. The social welfare function corresponding to
these weights overweights agents with high ability and high diligence.41 Thus, the competitive
equilibrium with τ = 0 does not deliver the allocations that would be chosen by a utilitarian
planner with planner weights given by ζ(ϕ, κ) = 1.

       We label the planner with weights described by eq. (45) the “insurance-only” planner, because
the only motive for progressivity with such weights is insuring against ex post realizations of the
ω shock. Using similar logic, we also construct preference weights for a ϕ-neutral planner, who
is indifferent to consumption inequality originating from heterogeneity in the taste for leisure, and
for a κ-neutral planner who has no desire to respond to income inequality generated by the initial
heterogeneity in learning ability κ and the ensuing skill inequality.
       Evaluating equilibrium allocations given the weights in eq. (45), we can compute social welfare
under the insurance-only social welfare function.
  41
     Benabou (2002) uses an alternative approach to evaluate welfare gains while abstracting from purely redistributive
effects. Instead of aggregating utilities across individuals, his social welfare function aggregates consumption certainty
equivalents.




                                                           37
                          Table 2: Optimal progressivity under nonutilitarian welfare
                                       Utilitarian        κ-neutral        ϕ-neutral         Insurance-only
            Redist. wrt κ                  Y                 N                Y                    N
            Redist. wrt ϕ                  Y                 Y                N                    N
            Insurance wrt ω                Y                 Y                Y                    Y
                     τ∗                  0.062             0.003            0.035                -0.025
            Welf. gain (pct of c)         0.52              1.40             0.88                 1.98



Corollary 6.1 [nonutilitarian welfare]. Welfare for the insurance-only planner is

                               W ins (g, τ ) = W(g, τ )                                                               (46)
                                                              vϕ             vϕ
                                                     + (1 − τ )2 + 1 − τ2
                                                               2               2
                                                       1              1
                                                     − (1 − τ ) +           (1 − τ ).
                                                      2θ          2 (θ − 1)

       The second line adjusts the welfare component associated with preference heterogeneity which
appears in the utilitarian welfare function. The new term that replaces (37) penalizes deviations
from τ = 0. The third line corrects the welfare component associated with skill investment (pro-
ductivity gain, education cost, and consumption inequality).42 As special cases, the first two lines
in (46) give welfare for the ϕ-neutral planner, and the first and third lines give welfare for the
κ-neutral planner.
       Table 2 summarizes the results. We find that the insurance-only planner would set τ ∗ =
−0.025. Thus, concern for social insurance against life-cycle wage shocks offsets almost exactly
the desire for regressivity linked to public good provision. The ϕ-neutral planner would set pro-
gressivity to 0.035 and the κ-neutral planner to 0.003. Overall, these governments with limited
taste for redistribution choose tax systems that are nearly proportional. Under these alternative
welfare criteria, the welfare gains of switching from the current progressive system to the optimal
near-proportional system are much larger: the insurance-only criterion implies a gain of 2 percent
of lifetime consumption.
  42
       Also in this case, the term in τ−1 is separable, and hence we have omitted it. See the Appendix for details.




                                                            38
6.4 Alternative modeling of G

A theme of this paper is that there is an important interaction between the size of government ex-
penditure and the progressivity of the tax and transfer system: the more spending the government
wants to finance, the less progressive will be the optimal tax system. In a representative agent
version of the model, Section 5.2.1 showed that the externality associated with public good provi-
sion calls for a regressive tax system, with the degree of regressivity increasing in the taste for the
public good. In Section 5.3, we revisited the issue in the baseline heterogeneous agent model and
characterized the conditions under which this force toward regressivity dominates the utilitarian
planner’s desire for progressivity to reduce inequality. The key comparative static is that, hold-
ing fixed all other structural parameters and the choice of social welfare function, the optimal tax
and transfer system should be less progressive the more utility agents attach to publicly provided
goods.
    In contrast to this paper, most previous analyses of tax design abstract from the choice of public
good provision and simply assume that an exogenous level of expenditure must be financed. How-
ever, given the interaction we have highlighted between the size of government and the progres-
sivity of the tax and transfer system, one might expect the details of how expenditure is modeled
to have a quantitatively significant impact on the conclusions for tax design. We now illustrate that
this is in fact the case.
    In the baseline model, we assumed that (i) households derive some utility from government
expenditures (χ > 0) and that (ii) the government chooses the fraction of output g to be trans-
formed into the publicly provided good. We now set χ = 0 throughout – which implies that the
publicly provided good is not valued – and examine two alternative models for spending that are
popular in the existing literature on tax design. In the first alternative model, g is fixed exoge-
nously to g = g U S = 0.189. Thus, a fraction of output equal to government purchases’ share
in the baseline economy is wasted. In the second alternative, the level of expenditures is fixed to
G = GU S = g U S Y (τ U S ).
    Table 3 reports the optimal degree of progressivity in these two cases for the utilitarian and the
insurance-only planners. Comparing the baseline model with χ > 0 and g ∗ = χ/(1 + χ) with the
case χ = 0 and g = g U S = 0.189, we see that, absent the public good externality, the utilitarian


                                                  39
                      Table 3: Optimal progressivity under different scenarios for G
           Case                          Utilitarian                               Insurance-only
                                   G                                           G
                                   Y
                                         τ∗      T′  ∆W                        Y
                                                                                     τ∗      T′   ∆W
g ∗ endog. χ = 0.233             0.189 0.062 0.239 0.52%                     0.189 −0.025 0.169 1.98%
g exog.    χ=0                   0.189 0.182 0.337 0.06%                     0.189 0.089 0.261 0.22%
G exog.    χ=0                   0.179 0.069 0.236 0.48%                     0.171 −0.014 0.159 1.83%
Note: T ′ = 1 − (1 − τ )(1 − g) is the income-weighted average marginal tax rate. ∆W is the welfare
change in consumption equivalent units. G in the third row is fixed at the baseline absolute value, which is
equal to 18.9% of GDP in the economy with τ U S = 0.151.


planner desires substantially more progressivity – even more progressivity than is embedded in the
current system. Note that the optimal τ in this case (0.182) is exactly the same as the optimal τ
would be in an economy with χ = 0 and g = 0.43
       The second case (where the level of G is fixed) gives an optimal value for τ very similar to
the baseline model, and the logic is similar: the planner internalizes that less progressive taxation
encourages labor supply and makes it easier to finance public good provision. With a fixed amount
G spent on public goods, more output makes financing government purchases easier – which acts
as an incentive to limit progressivity.
       Thus, we have shown that a seemingly minor difference in how government spending is mod-
eled – fixed in level, versus fixed as a share of output – has a very large impact on optimal pro-
gressivity. The lesson we draw is that policy choices regarding the level of expenditure and the
distribution of the net tax burden are intimately interrelated and are best studied in models that
integrate the modeling of public good provision and tax design.

6.5 Taking stock

To visualize the differences between the actual and the optimal tax system, Figure 4 plots marginal
                                                            
and average tax rates in the current scheme τ U S = 0.151 , and in the optimal scheme under the
utilitarian and insurance-only criteria, for the baseline model where G is valued and for the model
where χ = 0 and g is exogenous.
  43
     This result is an application of Corollary 4.4, which stated that (holding fixed χ), the optimal τ is independent of
g. One way to understand the result is that when the tax planner has to devote a fixed slice of output to government
spending, the planner is effectively operating in an economy with lower total factor productivity (TFP). The optimal τ
is invariant to g for the same reason that the optimal τ is invariant to TFP.



                                                          40
                                                    G valued                                                             G non−valued
                                     0.5                                                                    0.5


                                     0.4                                                                    0.4




                Marginal tax rate




                                                                                       Marginal tax rate
                                     0.3                                                                    0.3


                                     0.2                                                                    0.2


                                     0.1                                                                    0.1
                                                          Actual US τUS = 0.151                                                Actual US τUS = 0.151

                                      0
                                                                      ∗
                                                          Utilitarian τ = 0.062                              0                 Utilitarian τ∗ = 0.182
                                                          Ins. Only τ∗ = −0.025                                                Ins. Only τ∗ = 0.089
                                    −0.1                                                                   −0.1
                                             1      2          3          4       5                                 1      2        3           4       5
                                           Income (1 = average income)                                            Income (1 = average income)

                                                    G valued                                                             G non−valued
                                     0.4                                                                    0.4

                                     0.3                                                                    0.3
                Average tax rate




                                                                                       Average tax rate
                                     0.2                                                                    0.2

                                     0.1                                                                    0.1

                                      0                                                                      0

                                    −0.1                Actual US τUS = 0.151                              −0.1                Actual US τUS = 0.151
                                                        Utilitarian τ∗ = 0.062                                                 Utilitarian τ∗ = 0.182
                                    −0.2
                                                        Ins. Only τ∗ = −0.025
                                                                                                           −0.2                Ins. Only τ∗ = 0.089

                                    −0.3                                                                   −0.3
                                             1      2          3          4       5                                 1      2        3           4       5
                                           Income (1 = average income)                                            Income (1 = average income)



Figure 4: Top-left and Bottom-left panels: marginal and average tax rates in the baseline model
with χ > 0 and G valued. Top-right and bottom-right panels: marginal and average tax rates in the
baseline model with χ = 0 and ḡ exogenous.

   When G is nonvalued, the differences between the actual scheme and the one preferred by the
utilitarian planner are minor, but when G is valued they are substantial. For example, at average
income, the marginal tax rate is 7 percentage points lower in the optimal scheme. The optimal
degree of progressivity for the insurance-only planner is always lower than in the data and, when
G is valued, the optimal tax scheme is close to proportional.


7 Extensions
This section contains four extensions: a politico-economic analysis and an analysis of a progressive
consumption tax in the baseline model, a model in which skill investments are irreversible, and a
version of the model with skill bias in the production technology.




                                                                                      41
7.1 Political-economic determination of progressivity

After our extensive characterization of optimality, it is natural to ask the following question: if
(g, τ ) were determined through a political-economic mechanism, how would the voting outcome
differ from the policy chosen by a utilitarian government? To maintain symmetry with our nor-
mative analysis, we restrict ourselves to voting once and for all and retain the assumption that
the human capital accumulation decision is reversible, so the transition to a new steady state is
immediate.44
       The challenge in analyzing a political-economic version of our model is twofold. First, voting
has two dimensions, (g, τ ). Second, there are multiple sources of heterogeneity across households
which potentially means that preferences over fiscal variables may not be single peaked. In what
follows, we show that (i) irrespective of the choice for τ , agents agree that g should be set equal to
χ/ (1 + χ); (ii) notwithstanding multidimensional heterogeneity, the attitude of individual agents
toward progressivity τ can be summarized by a single summary statistic, so voters are effectively
heterogeneous in only one dimension. As a consequence, the median voter theorem applies.
       We begin by proving that all agents agree on the optimal size of government.

Proposition 7 [agreement on G]. When voting over g, every agent chooses ĝ = g ∗ = χ/ (1 + χ),
independently of the choice for τ .

       To understand this result, note that the preferred value for g for agent i obeys the first-order
condition
                                                 1    ci  1
                                                χ =      · .                                                    (47)
                                                 g  1 − g ci
The left-hand side is the benefit from a marginal increase in the share of output devoted to publicly
provided goods, which, given separable preferences, is identical across agents. The right-hand
side is the cost associated with a marginal increase in g. Since ci can be expressed as ci (g, τ ) =
λ (g) c̄i (τ ) = (1 − g) Λ̄c̄i (τ ), where the terms Λ̄ and c̄i (τ ) are independent of g, the derivative of
individual consumption with respect to g is (minus) the first term on the right-hand side of (47).
The second term is the marginal utility of private consumption. The key to the result in Proposition
  44
    As explained previously, a time-varying τ would break the no-bond-trade result, and the wealth distribution would
become a relevant part of the state space.



                                                        42
7 is that the marginal cost of increasing g is the same for every individual. A low earnings agent has
a high marginal utility of private consumption, but also gains little additional consumption from
reducing average tax rates. The two effects exactly cancel out, and all agents agree on the optimal
choice for g.
       We now consider voting over τ and make an additional simplifying assumption: voting occurs
before the realization of the insurable shock ε. Since ε is i.i.d., its current value has little impact
on an agent’s preferred permanent degree of progressivity. The individual state vector relevant for
a voter is, therefore, (ϕ, α, κ).45 Expected lifetime utility for an agent with characteristics (a, ϕ, κ)
(ignoring, as usual, the separable term in τ−1 ) is given by
                                                                                    
                                               βδ vω                 βδ vω vϕ     1
   U (α, ϕ, κ; g, τ ) = W (g, τ ) − (1 − τ )          − (1 − τ ) −          −   +
                                             1 − βδ 2              γ − βδ 2   2   2θ
                                                      η 
                                  + (1 − τ ) α − ϕ + κ .                              (48)
                                                      2θ

Proposition 8 [median voter]. Under a majority rule voting system, the value for τ that would
emerge is the value that maximizes eq. (48) for the agent with the median value for the random
                               η
variable x = α − ϕ +           2θ
                                  κ.

       The median voter theorem applies in our economy because preferences are single peaked in
τ . This follows from our earlier result on the concavity of W (g, τ ) (Corollary 4.1). Concavity
in W (g, τ ) translates into concavity in U (α, ϕ, κ; g, τ ) since the additional terms in eq. (48)
are linear in τ . Note also that for the purposes of characterizing attitudes to progressivity, the
three-dimensional vector over (ϕ, α, κ) can be collapsed into the sufficient statistic x. Since x
is a linear combination of Normal (ϕ, α) and Exponential (κ) variables, it is an Exponentially-
Modified Gaussian (EMG) random variable.
       We find that the median voter – the agent with the median value for x – would choose τ med =
0.084. Relative to the utilitarian planner’s choice (τ ∗ = 0.062), this modestly higher degree of
progressivity translates into an increase in the average effective marginal tax rate of 1.8 percentage
points. To understand the difference between the two values, note first that in the limiting case
                                  
θ → ∞ and vω = 0, U xmed ; g, τ = W (g, τ ) and thus the median voter would choose exactly
the same degree of progressivity as the utilitarian planner. The logic for this result is that the id-
  45
       κ is a state because agents can reoptimize their choice for skills after the change in τ .

                                                              43
iosyncratic preference term appears in individual log consumption in the form −(1 − τ )ϕ (see eq.
22). Given a symmetric normal distribution for ϕ and utility that is logarithmic in consumption,
average utility is then equal to utility of the median ϕ agent. Similar logic would apply to fixed
heterogeneity in initial labor productivity α0 . Thus, the reason the median voter prefers a higher
value for τ has to do with the existence of permanent uninsurable shocks (vω > 0) and hetero-
geneity in skill prices (θ < ∞). With respect to the former, the median voter wants a higher τ as
insurance against future uninsurable shocks (the second term on the right-hand side of eq. 48).46
With respect to skill heterogeneity, the agent with median ability κ has less than average ability,
because κ is exponentially distributed. Thus, the median κ agent has more to gain from progressive
taxation and would choose a higher value for τ .
       We conclude by noting that the median voter prefers a lower value for τ than our empirical
estimate. However, this result is predicated on our baseline value for χ. One could use the median
voter model to identify how strong the preference for public goods must be so as to deliver τ =
τ U S = 0.151 as a political economy outcome. The answer is χ = 0.057. Thus, the model can
rationalize the observed level of progressivity if agents have a weaker preference for public goods
than we assumed in our baseline calibration.

7.2 Progressive consumption taxation

The comparison between income and consumption taxes has a long tradition in public finance and
macroeconomics. The main argument set forth by the literature in favor of consumption taxes is
productive efficiency. As explained by Nishiyama and Smetters (2007), a tax on consumption is
an income tax where saving is exempt and, as a result, it imposes a smaller distortion on capital
accumulation compared with an income tax. Correia (2010) shows that when a flat consumption tax
is augmented with a universal lump-sum transfer, productive efficiency can be improved without
any welfare loss in terms of higher inequality.
       Here, we put forth a novel argument in favor of progressive consumption taxes.47 We show that,
compared with progressive earnings taxation, progressive consumption taxation reduces distortions
  46                                  δ vω
      The median value for α is − 1−δ    2 . Note that when γ = β, the third term on the right-hand side of eq. (48)
therefore offsets the contribution to welfare from the term in α for the median voter.
   47
      Implementation in our model would follow McCaffery’s (2002) proposal of taxing income progressively with an
exemption for savings.


                                                        44
to the distribution of labor supply and allows stronger protection against life-cycle earnings shocks
that are privately uninsurable.
       In our model, with a consumption expenditure tax/transfer scheme, the budget constraint (16)
for household i of age a becomes
                                 1
                            λcia
                              1−τ
                                  + δqbi,a+1 = p (si ) exp (αia + εia ) hia + B (εia ) ,                                     (49)

where, as before, τ > 0 (τ < 0) denotes a progressive (regressive) scheme. Progressive consump-
tion taxation changes the hours allocation which now becomes
                                                                            1    1
                            log h (ϕ, ε; τ ) = log H RA (τ ) − ϕ +            ε − M (vε ; 0) .                               (50)
                                                                            σ    σ
Compared with (21), we note two differences. First, the pass-through from insurable shocks to
hours is undistorted by taxes and equal to the Frisch elasticity 1/σ, not the tax-modified elasticity
1/σ̂. Second, the productivity gain from insurable dispersion vε is unaffected by τ . The new
                                                     1 vε
productivity gain term M (vε ; 0) =                  σ 2
                                                            is obtained, as the notation suggests, by simply setting
τ = 0 in M (vε ; τ ).48 To understand these differences, recall that the consumption allocation is
independent of ε. Therefore, taxing consumption, instead of earnings, is a form of taxation that
specifically targets the uninsurable shocks (which pass through to consumption) without distorting
the response of hours worked to insurable shocks. In sum, progressive consumption taxation is
more efficient than progressive income taxation. The next proposition summarizes this result by
stating the form of the social welfare function.

Proposition 9 [welfare with progressive consumption tax]. Under a progressive consumption
tax/transfer system, social welfare is
                                                                                        
           cons                                              1 vε  1 vε              1  1
       W          (g, τ ; τ−1 ) = W (g, τ ; τ−1) − (1 + χ) σ 2 − σ 2      + (1 + χ) vε − vε .
                                                            σ 2   σ̂ 2               σ  σ̂
where W (g, τ ; τ−1 ) is defined in Proposition 4.

                                              1                  1
       The productivity gain term               v
                                              σ̂ ε
                                                     becomes       v
                                                                 σ ε
                                                                       and the welfare loss from hours fluctuation
−σ σ̂12 v2ε becomes −σ σ12 v2ε .
  48
       The consumption allocation is given by
       log c (ϕ, α, s; λ, τ ) = log C RA (λ, τ ) + (1 − τ ) M (vε ; 0) − (1 − τ ) ϕ + (1 − τ ) log p (s; τ ) + (1 − τ ) α,
                                       1
where log C RA (λ, τ ) = log λ +     (1+σ̂)   log(1 − τ ).

                                                                 45
                                            Progressivity versus Generational Weight
                                    0.3
                                                                            Fixed Investment
                                                                            Flexible Investment
                                   0.25



                                    0.2




                               τ
                                   0.15



                                    0.1



                                   0.05



                                     0
                                                        β
                                     0.94      0.95    0.96   0.97   0.98         0.99            1
                                                               γ


Figure 5: The figure shows how the optimal choice for τ varies with γ in the baseline flexible
(reversible) investment model and the alternative fixed (irreversible) investment model.

   The degree of consumption tax progressivity that maximizes W cons (g, τ ; τ−1) is 0.073. Be-
cause this tax system does not distort the distribution of labor supply across households, the planner
chooses a slightly higher value for τ than under the baseline earnings tax system, thereby provid-
ing better insurance against life-cycle earnings shocks. The welfare gain associated with switching
from the current earnings tax system to this progressive consumption tax system is 0.56 percent,
slightly larger than the baseline welfare gain (0.52 percent).

7.3 Progressivity when past skill investment is sunk

In our baseline model, we assumed fully reversible investment. This implied that (i) the optimal
choice for τ is independent of the pre-existing distribution of skills, and (ii) transition following any
tax reform is instantaneous. Although the assumption that skill investment is fully reversible lends
transparency to the analysis, it is extreme. We now consider the opposite extreme assumption,
namely that skill investment is chosen once and for all at age zero and can never be adjusted
thereafter. This introduces an additional force in the direction of more progressivity: by making the
tax system more progressive, the social planner can immediately reduce consumption inequality
in the economy without simultaneously distorting skill investments for agents who entered the
economy in the past.
   As in our baseline model, we consider an unanticipated once-and-for-all change in the tax
system, defined as permanent changes in the fiscal policy parameters at date 0 from (τ−1 , g−1 )
to (τ, g). With irreversible investment, transition is no longer instantaneous because, given an


                                                              46
unanticipated change in τ , output gradually evolves over time as the population share of agents
who make skill investments under the new tax regime rises.
   Our baseline model is tractable, because the distribution of skills is exponential. To maintain
tractability in the model with irreversible investment, we now introduce an additional assumption
on the production technology, namely, that production is segregated by cohort. Because each
cohort makes skill investments simultaneously, expecting a fixed future τ , the distribution of skills
within agents belonging to the same cohort is then always exponential, even though the aggregate
economy-wide distribution is not.
   It is straightforward to show that the optimal choice for g remains constant throughout the
transition and equal to χ/(1 + χ). Given a constant value for g and a constant (by assumption)
value for τ , the budget balancing value for λ is now time varying during transition.
   When we set γ = β = 0.9594, and assume that the initial steady state corresponds to our
estimated progressivity value, τ−1 = τ U S = 0.151, we find that the optimal new permanent choice
for τ is 0.137. This value is larger than the optimum in our baseline model with fully reversible in-
vestment (τ ∗ = 0.062). The intuition is that the utilitarian planner now uses progressive taxation to
tax away past sunk skill investments by high ability (high κ) individuals, a result that is analogous
to the desire to tax initial capital under the Ramsey approach to optimal taxation in the standard
growth model.
   Figure 5 shows how the optimal choice for τ varies with the planner’s intergenerational dis-
count factor, γ, for both the baseline flexible investment model and the alternative fixed investment
model. In both models, the more weight the planner puts on agents who entered the economy
in the past (i.e., the lower is γ), the larger is the optimal choice for τ . In the flexible investment
model, this reflects the contribution of the sixth line of eq. (29), which captures the incentive to
redistribute to offset wage dispersion due to permanent uninsurable productivity shocks. A lower
γ implies more relative weight on older agents who exhibit high idiosyncratic productivity disper-
sion and thus translates into a higher optimal τ . The optimal choice for τ is more sensitive to γ
in the fixed investment model because now another force comes into play: a smaller value for γ
means that the planner cares more about reducing consumption inequality among existing cohorts
(whose skill investments are sunk) and cares less about distorting skill investment for future co-
horts (whose investments will adjust). As γ → 1, the planner attaches so much weight to future

                                                  47
generations that the short-run gains from expropriating past skill investments become irrelevant,
so the optimal choices for τ in the models with reversible and irreversible investment converge. In
both cases, the expression for social welfare corresponds to expected lifetime utility for a newborn
agent in steady state, and the value for τ that maximizes expected lifetime utility for a newborn is
τ = 0.040.
   The baseline model with fully reversible investment and the alternative with irreversible in-
vestment are two extremes. A compromise between the two models would be one in which it is
impossible for agents to reduce past skill investments, but previous investments can be supple-
mented for free. In this hybrid model, the welfare effects of unanticipated progressivity reductions
would be identical to those in the flexible investment model, whereas the welfare effects of pro-
gressivity increases would be identical to those in the fixed investment model. It follows that, under
our baseline calibration with γ = β, the optimal choice for τ in this hybrid model would again
be τ = 0.062. The logic is that in the fixed investment model, leaving progressivity unchanged
is preferred to increasing progressivity (recall that the optimal choice in that model involves re-
ducing τ from 0.151 to 0.137), and thus in the hybrid model the planner will not want to increase
progressivity.

7.4 Skill bias in production

So far we have emphasized a theory in which all differences in skill prices are due to differences in
the relative scarcity of different skill types. However, the literature has also explored an alternative
source of wage dispersion due to skill differences, namely, bias in production in favor of certain
types of skills (e.g., Katz and Murphy, 1992). For example, the production technology may put
relatively high weight on high skilled workers. We now generalize our analysis to incorporate both
sources of skill price dispersion by extending the production function in (5) as follows:
                                Z                                    θ−1
                                                                        θ
                                                               θ−1
                           Y =       exp (̺s) · [N (s) · m (s)] θ ds       ,                       (51)

where the weight exp (̺s) captures the skill bias in production for skill level s. The technology in
(51) is, in essence, a multiskill version of the two-skill production function of Katz and Murphy
(1992). The skill bias must be bounded to ensure finite production, and we therefore make the
following assumption.

                                                  48
                         θ−1
                                 √
Assumption 1 ̺ <          θ
                             /       2.

       It is straightforward to verify that all the individual decision rules are the same as in the baseline
model, up to the fact that the return to skill is different. Therefore, Propositions 1 and 2 continue
to hold, where part 2 of the equilibrium definition in Section 4 is amended to
                                                                                  1θ
                                                                          Y
                                              p(s) = exp (̺s)                            ,                              (52)
                                                                       N · m(s)

where N is the effective hours supplied by every skill type (defined in Corollary 3.2).
       The following amended version of Proposition 3 summarizes how the skill prices and skill
choices are affected by the presence of skill bias in production.49
Proposition 10 [equilibrium prices with skill bias]. In equilibrium, the skill price is given by

                                          log p (s; τ ) = π0 (τ ) + π1 (τ ) · s (κ; τ ) ,                               (53)
                                                                       q     
                                                               ̺           ̺ 2          1
where the marginal return to skill is π1 (τ ) =                2
                                                                   +       2
                                                                                 +   θ(1−τ )
                                                                                             .   The equilibrium distribution
of log skill premia π1 (τ ) · s (κ; τ ) is exponential with parameter (1 − τ )−1 (π1 (τ ))−2 .

       As is clear from Proposition 10, the model with skill bias in production preserves the result
that in equilibrium, the price of skills is log-linear in s. This can be anticipated from the fact that
the logarithm of the marginal product of labor is now the skill bias ̺ plus the scarcity term from
before (see eq. 52). As before, the upper tail of the wage distribution is Pareto, the marginal return
to skill, π1 (τ ), is increasing in τ , and the base price π0 (τ ) is falling in τ .50 However, the sensitivity
of π1 and π0 to τ is smaller the larger is the exogenous skill bias ̺. The logic is that, in this model,
some of the price differences are due to ̺ and are therefore independent of the effect of τ on the
relative supply of different skill types.
       The variance of pre-tax log skill prices is now

                                          var (log p (s; τ )) = (1 − τ )2 (π1 (τ ))4 .                                  (54)
  49
      To simplify the algebra, we assume µ = η here. This assumption is innocuous for the purposes of computing the
optimal degree of progressivity since, as in the baseline model, there is no interaction between τ and either µ or η in
the expression for social welfare (recall Corollary 4.5).                                      !
                                                                     q               −1
   50                                      1      (θ−1)    1      ̺      ̺ 2       1
      The base skill price is π0 (τ ) = − θ−1 log    θ   (1−τ )   2 +    2   + θ(1−τ )      −̺ .




                                                                49
                                                            0.065




                                                             0.06


                                                                                                          (A) Optimal τ benchmark
                                                                                                          (B) Opt. τ education only




                                Optimal progressivity (τ)
                                                            0.055




                                                             0.05




                                                            0.045




                                                             0.04




                                                                    0   0.1   0.2     0.3         0.4        0.5           0.6        0.7
                                                                                    Skill bias rate (ρ)




Figure 6: The figure plots the optimal degree of progressivity (τ ) under all combinations of θ and
̺ > 0 consistent with a cross-sectional variance of skill prices of 0.1012.

It is straightforward to show that the variance is strictly falling (increasing) in τ whenever ̺ >
0 (̺ < 0). The logic is that when ̺ > 0, the quantity effect of more progressivity (the skill
distribution is more compressed toward zero) dominates the price effect (higher skill types are
relatively more scarce and command a higher wage premium). The model in Guvenen, Kuruscu,
and Ozkan (2014) has this property: they focus on the limiting case in which θ = ∞ and all skill
price inequality is driven by skill bias ̺ only, so that the price effect is entirely absent.
    The social welfare expression in the model with skill bias is unchanged relative to the baseline
model expression up to the skill-related terms in W (g, τ ; τ−1 ) (the second, third, and fourth lines
in equation 29). In the Appendix we provide exact expressions for how these terms depend on ̺.
    Note that all the model moments we used for estimation (in Section 6) are the same as before,
except for the variance of skill prices (54). The identification of the model parameters is therefore
the same, except for the estimate of θ. From eq. (54) it is clear that skill price dispersion can stem
from either a large complementarity between skills, i.e., a low θ, or a large skill bias in production,
i.e., a large ̺.
    The possible combinations of (̺, θ) that are consistent with the calibration in Section 6 can
therefore be derived by assuming the same variance of skill prices, i.e., var (log p (s; τ )) = 0.1012,
imposing τ U S = 0.151, and using the expression for the variance in eq. (54), which is a function
of ̺ and θ. Clearly, larger values of ̺ are associated with larger values of θ.




                                                                                      50
   Next, we compute and plot in Figure 7.4 the optimal τ for a range of possible values for ̺.
We construct two plots. The first, labeled “benchmark,” is the full model with all sources of
heterogeneity. The second, labeled “education only,” is a stripped-down version of the model in
which agents are heterogeneous only with respect to κ. In both cases, as we change ̺ we also
simultaneously adjust θ, so as to hold fixed the total variance of skill prices.
   This exercise yields a number of interesting insights. The first is that if skill acquisition ability
κ were the only source of heterogeneity, then the optimal τ would be steeply increasing in ̺.
The logic is that as skill price differentials become more exogenous and less sensitive to τ , the
utilitarian planner prefers more progressivity. Conversely, when general equilibrium effects are
important (̺ and θ are low), the planner chooses modest progressivity, understanding that a higher
value for τ would reduce skill investment and raise the skill premium, thereby undoing to some
extent the redistribution the planner desires.
   Second, in the full model that incorporates all the redistribution motives, the optimal value for τ
is (i) uniformly higher than in the “education-only” model and (ii) largely insensitive to ̺. From the
first observation we can infer that other sources of heterogeneity (preference heterogeneity, unin-
surable productivity shocks) incline the utilitarian planner toward strong progressivity, whereas
heterogeneity in skill acquisition ability inclines the planner toward more moderate progressivity
– because the planner understands that progressivity crowds out skill investment. Comparing the
optimal τ plots across the two models, we can infer that when ̺ is large, the planner is more con-
cerned about crowding out and thus chooses a value for τ in the full model that is close to the
optimal τ in the education-only model. Crowding out is a bigger concern when ̺ is large because
a higher value for τ directly reduces the private return to skill investment. Conversely, when ̺ is
low, crowding out is less of a concern, because as skill investment falls the skill premium rises,
and thus the decline in investment is mitigated.
   We conclude that under the benchmark calibration, the optimal value for τ is largely insensitive
to whether the variance in skill prices is primarily driven by relative scarcity (low θ and low ̺) or
by a high-skill-biased production technology (high θ and high ̺). The finding that the optimal τ
is robust to these alternative models of endogenous skill investment is reassuring, since separately
identifying θ and ̺ is a challenging task. However, it would be wrong to infer that one can neglect
the skill investment margin when thinking about how progressive taxes should be. Recall from

                                                   51
Section 6.2 that, when skills are exogenous, making taxes much more progressive is optimal.
Rather, the conclusion here is that two different textbook models of endogenous skill investment
deliver similar normative implications.


8 Conclusions
This paper has developed a tractable equilibrium framework to study the optimal degree of pro-
gressivity of the tax and transfer system. Our main result is an expression for social welfare as
a function of (i) policy parameters defining the degree of progressivity and the level of public
expenditure and (ii) structural parameters defining preferences, technology, and households’ ac-
cess to private insurance. These parameters regulate the relative strength of the economic forces
pushing for and against progressivity. A utilitarian planner wants a progressive tax system to
redistribute with respect to inequality in initial conditions and to offer social insurance against life-
cycle productivity shocks that households cannot smooth privately. At the same time, the planner
understands that higher progressivity translates into lower aggregate output by discouraging skill
investment and labor supply, and thereby exacerbates the externality associated with the provision
of public goods.
   We approached this problem by restricting attention to a particular class of tax/transfer func-
tions that fits the U.S. household-level cross-sectional relationship between disposable and gross
income remarkably well. In addition, the optimal policy in this class comes very close, in welfare
terms, to decentralizing the constrained-efficient Mirrlees allocations in a stripped-down version
of our framework without skill investment.
   The presence of skill investment in the model yields several interesting insights. First, tax
progressivity is not an effective way to compress inequality in pre-tax wages. Although higher
progressivity does reduce skill investment, and thereby compresses inequality in skills, it also has
an offsetting general equilibrium price effect: as high skill types become relatively more scarce, the
equilibrium pre-tax skill premium increases. Second, and relatedly, when the income distribution
is right skewed because of skill complementarity in production, a thicker Pareto tail does not
necessarily translate into higher optimal marginal tax rates at the top, in contrast to a well-known
result in the Mirrlees literature.


                                                   52
   When we parameterize the model and quantify the net impact of the various forces for and
against progressivity, we conclude that there would be welfare gains from making the U.S. tax
and transfer system less progressive. The associated gains do not exceed two percent of lifetime
consumption. This finding is robust to the degree of irreversibility of skill investment and to the
relative importance of technological skill bias versus skill complementarity in determining the
skill premium. However, there is a significant interaction between the level of spending and the
progressivity of the tax system: the more valued are public goods, and thus the more net revenue
must be collected, the less progressive should be taxes and transfers. If one takes the view that
government expenditures are not valued by households, then the current tax/transfer scheme is
appropriately progressive.
   We have also made some progress toward a positive theory of tax progressivity by investigating
the fiscal policy parameters that would emerge from a majority voting model. We found that
the median voter prefers higher progressivity than a utilitarian social planner, in part because the
median agent has below-average aptitude for skill investment. This result helps rationalize why
the current tax system appears overly progressive relative to the utilitarian optimum.
   Finally, we find that switching from a progressive earnings tax to a progressive consumption
tax would generate welfare gains, because this would be a way for the government to directly
compress dispersion in the uninsurable component of labor income shocks – which transmit to
consumption – without distorting responses to insurable shocks – which affect earnings but do not
pass through to consumption.


References
ATKINSON , A. B., T. P IKETTY,     AND   E. S AEZ (2011): “Top Incomes in the Long Run of History,”
  Journal of Economic Literature, 49(1), 3–71.

ATTANASIO , O.,   AND   S. J. DAVIS (1996): “Relative Wage Movements and the Distribution of
  Consumption,” Journal of Political Economy, 104(6), 1227–1262.

BAKIS , O., B. K AYMAK ,     AND   M. P OSCHKE (2012): “On the Optimality of Progressive Income
  Redistribution,” Working Paper.


                                                  53
B ENABOU , R. (2000): “Unequal Societies: Income Distribution and the Social Contract,” Ameri-
  can Economic Review, 90(1), 96–129.

         (2002): “Tax and Education Policy in a Heterogeneous-Agent Economy: What Levels of
  Redistribution Maximize Growth and Efficiency?,” Econometrica, 70(2), 481–517.

C ALVO , G. A.,      AND   M. O BSTFELD (1988): “Optimal Time-Consistent Fiscal Policy with Finite
  Lifetimes,” Econometrica, 56(2), 411–432.

C HEN , S.-H.,   AND    J.-T. G UO (2013): “Progressive Taxation and Macroeconomic (In) stability
  with Productive Government Spending,” Journal of Economic Dynamics and Control, 37(5),
  951–963.

C HETTY, R.,     AND   E. S AEZ (2010): “Optimal Taxation and Social Insurance with Endogenous
  Private Insurance,” American Economic Journal: Economic Policy, 2(2), 85–114.

C OCHRANE , J. H. (1991): “A Simple Test of Consumption Insurance,” Journal of Political Econ-
  omy, 99(5), 957–976.

C ONESA , J. C.,     AND    D. K RUEGER (2006): “On the Optimal Progressivity of the Income Tax
  Code,” Journal of Monetary Economics, 53(7), 1425–1450.

C ONSTANTINIDES , G. M.,          AND   D. D UFFIE (1996): “Asset Pricing with Heterogeneous Con-
  sumers,” Journal of Political Economy, 104(2), 219–240.

C ORREIA , I. (2010): “Consumption Taxes and Redistribution,” American Economic Review,
  100(4), 1673–1694.

D IAMOND , P.,    AND      E. S AEZ (2011): “The Case for a Progressive Tax: From Basic Research to
  Policy Recommendations,” Journal of Economic Perspectives, 25(4), 165–190.

E ATON , J.,   AND   H. S. ROSEN (1980): “Optimal Redistributive Taxation and Uncertainty,” Quar-
  terly Journal of Economics, 95(2), 357–364.

FARHI , E.,    AND   I. W ERNING (2013): “Insurance and Taxation over the Life Cycle,” Review of
  Economic Studies, 80(2), 596–635.

                                                   54
F EENBERG , D.,    AND   E. C OUTTS (1993): “An Introduction to the TAXSIM model,” Journal of
  Policy Analysis and Management, 12(1), 189–194.

F ELDSTEIN , M. S. (1969): “The Effects on Taxation on Risk Taking,” Journal of Political Econ-
  omy, 77(5), 755–764.

        (1973): “On the optimal progressivity of the income tax,” Journal of Public Economics,
  2(4), 357–376.

G OLOSOV, M., M. T ROSHKIN ,      AND   A. T SYVINSKI (2011): “Optimal Dynamic Taxes,” NBER
  Working Paper 17642.

G ORRY, A.,   AND   E. O BERFIELD (2012): “Optimal Taxation Over the Life Cycle,” Review of
  Economic Dynamics, 15(4), 551–572.

G UNER , N., R. K AYGUSUZ ,    AND   G. V ENTURA (2012a): “Income Taxation of U.S. Households:
  Facts and Parametric Estimates,” CEPR Discussion Paper.

        (2012b): “Taxation and Household Labour Supply,” Review of Economic Studies, 79(3),
  1113–1149.

G UVENEN , F., B. K URUSCU ,     AND   S. O ZKAN (forthcoming): “Taxation of Human Capital and
  Wage Inequality: A Cross-Country Analysis,” Review of Economic Studies.

H EATHCOTE , J., F. P ERRI ,   AND   G. L. V IOLANTE (2010): “Unequal We Stand: An Empirical
  Analysis of Economic Inequality in the United States, 1967-2006,” Review of Economic Dy-
  namics, 13(1), 15–51.

H EATHCOTE , J., K. S TORESLETTEN ,       AND   G. L. V IOLANTE (2008): “Insurance and Oppor-
  tunities: A Welfare Analysis of Labor Market Risk,” Journal of Monetary Economics, 55(3),
  501–525.

        (forthcoming): “Consumption and Labor Supply with Partial Insurance: An Analytical
  Framework,” American Economic Review.



                                                 55
H EATHCOTE , J.,   AND    H. T SUJIYAMA (2013): “Optimal Income Taxation: Mirrlees Meets Ram-
  sey,” Mimeo.

H ECKMAN , J., L. L OCHNER ,      AND   C. TABER (1998): “Explaining Rising Wage Inequality: Ex-
  plorations with a Dynamic General Equilibrium Model of Labor Earnings with Heterogeneous
  Agents,” Review of Economic Dynamics, 1(1), 1–58.

H UGGETT, M. (1993): “The Risk-Free Rate in Heterogeneous-Agent Incomplete-Insurance
  Economies,” Journal of Economic Dynamics and Control, 17(5-6), 953–969.

K AKWANI , N. C. (1977): “Measurement of Tax Progressivity: An International Comparison,”
  Economic Journal, 87(345), 71–80.

K ATZ , L. F.,   AND   K. M. M URPHY (1992): “Changes in Relative Wages, 1963-1987: Supply and
  Demand Factors,” Quarterly Journal of Economics, 107(1), 35–78.

K EANE , M. P. (2011): “Labor Supply and Taxes: A Survey,” Journal of Economic Literature,
  49(4), 961–1075.

K RUEGER , D.,    AND    A. L UDWIG (2013): “Optimal Progressive Labor Income Taxation and Edu-
  cation Subsidies When Education Decisions and Intergenerational Transfers Are Endogenous,”
  American Economic Review, 103(3), 496–501.

K RUEGER , D.,    AND   F. P ERRI (2010): “Public versus Private Risk Sharing,” Journal of Economic
  Theory, 146(3), 920–956.

M C C AFFERY, E. J. (2002): Fair not Flat: How to Make the Tax System Better and Simpler.
  Chicago: University of Chicago Press.

M EGHIR , C.,    AND    L. P ISTAFERRI (2010): “Earnings, Consumption and Lifecycle Choices,” in
  Handbook of Labor Economics, ed. by O. C. Ashenfelter, and D. E. Card, vol. 4B of Handbooks
  of Labor Economics. Elsevier.

M IRRLEES , J. A. (1971): “An Exploration in the Theory of Optimum Income Taxation,” Review
  of Economic Studies, 38(2), 175–208.


                                                  56
M USGRAVE , R. A. (1959): The Theory of Public Finance: A Study in Public Economy. New York:
  McGraw-Hill.

N ISHIYAMA , S.,   AND   K. S METTERS (2007): “Does Social Security Privatization Produce Effi-
  ciency Gains?,” Quarterly Journal of Economics, 122(4), 1677–1719.

P ERSSON , M. (1983): “The Distribution of Abilities and the Progressive Income Tax,” Journal of
  Public Economics, 22(1), 73–88.

P IKETTY, T.,   AND   E. S AEZ (2003): “Income Inequality in the United States, 1913-1998,” The
  Quarterly Journal of Economics, 118(1), 1–39.

R AMSEY, F. P. (1927): “A Contribution to the Theory of Taxation,” Economic Journal, 37(145),
  47–61.

ROTHSCHILD , C.,      AND   F. S CHEUER (2013): “Redistributive Taxation in the Roy Model,” The
  Quarterly Journal of Economics, 128(2), 623–668.

S AEZ , E. (2001): “Using Elasticities to Derive Optimal Income Tax Rates,” Review of Economic
  Studies, 68(1), 205–229.

S AMUELSON , P. A. (1954): “The Pure Theory of Public Expenditure,” Review of Economics and
  Statistics, 36(4), 387–389.

S TANTCHEVA , S. (2013): “Optimal Taxation and Human Capital Policies over the Life Cycle,”
  Mimeo.

S TIGLITZ , J. E. (1982): “Utilitarianism and Horizontal Equity : The Case for Random Taxation,”
  Journal of Public Economics, 18(1), 1–33.

        (1985): “Equilibrium Wage Distribution,” Economic Journal, 95(379), 595–618.

U HLIG , H. (1996): “A Law of Large Numbers for Large Economies,” Journal of Economic The-
  ory, 8(1), 41–50.

VARIAN , H. R. (1980): “Redistributive Taxation as Social Insurance,” Journal of Public Eco-
  nomics, 14(1), 49–68.

                                                57
                                        A PPENDIX
This Appendix proves all the results in the main body of the paper.


A.1     Proof of Proposition 1 [equilibrium]
To simplify the exposition, here we conjecture that the consumption allocation for an agent with state
(ϕ, α, ε, s) has the form

                         c (ϕ, α, s; g, τ ) = exp [c̄ (g, τ ) + (1 − τ ) α + f (ϕ, s; τ )] ,               (A1)

where c̄ (g, τ ) is a constant that does not depend on any individual state variables, and f is a function of
individual age-invariant states (ϕ, s). We now show that this class of allocations implies that agents do not
want to trade the bond. In the proof of the next proposition, we show that, absent bond trade, allocations do
indeed take this form, verifying the original conjecture.
     To prove the absence of bond trading, consider first the marginal rate of substitution for an agent between
state z = (α, ε) and z ′ = (α′ , ε′ ):

                                exp [c̄ (g, τ ) + (1 − τ ) α + f (ϕ, s; τ )]
                M RSz,z ′ = β                                                 = exp [− (1 − τ ) ω] .
                                exp [c̄ (g, τ ) + (1 − τ ) α′ + f (ϕ, s; τ )]

The expected marginal rate of substitution between states is
                                                              h                        vω i
             Ez ′ |z M RSz,z ′ = βE [exp (− (1 − τ ) ω)] = β exp (1 − τ ) [(1 − τ ) + 1]      ,
                                                                                          2
which is common across all agents. As a result, there are no gains from trading a non-state-contingent bond
across agents with different individual states (ϕ, α, ε, s). The bond price that supports this equilibrium is,
precisely                                     h                       vω i
                                    q = β exp (1 − τ ) [(1 − τ ) + 1]      ,
                                                                       2
as stated in Proposition 1 (in log terms).


A.2     Proof of Proposition 2 [hours and consumption]
We follow the proof in Heathcote, Storesletten, and Violante (2013). We first guess that there is no bond trade
in equilibrium. Given no bond trade across agents, the only securities that are traded are insurance claims
against ε shocks. Without loss of generality, we can therefore think of our economy as an island economy
where each island is populated by agents indexed by their fixed effects (ϕ, s) and their uninsurable wage
component α. On each island, there are complete markets with respect to ε, so the competitive equilibrium
allocation can be computed as the outcome of an island-specific social planner problem. Since agents on an
island are ex ante identical, the planner weights must be equal across agents. Moreover, since each island
transfers zero net financial wealth between periods (by assumption) and preferences are time separable, the
island-specific planner problem is static.
    The island planner’s problem, taking the aggregate fiscal variables (G, λ, τ ) and the skill price p(s) as
given, is                       Z                                                 
                                                exp [(1 + σ) ϕ]       1+σ
                        max         log c (ε) −                 h (ε)     + χ log G dFε
                     {c(ε),h(ε)} E                   1+σ


                                                        58
subject to the resource constraint
                      Z                Z
                          c(ε) dFε = λ   exp [(1 − τ ) (p(s) + α + ε)] h (ε)1−τ dFε .                     (A2)
                         E                E

    Taking first-order conditions and substituting in the resource constraint, one obtains
                                1                      1−τ     1−τ                    vε
               log h(ε) =            log(1 − τ ) − ϕ +     ε−         2
                                                                        (1 − 2τ − στ ) ,
                             (1 + σ)                   σ+τ    (σ + τ )                2

where the first term is hours worked by the representative agent and the last term is the constant M(vε ; τ )/(σ+
τ ). Similarly,

                         1−τ                                             (1 − τ ) [1 − 2τ − στ ] vε
       log c = log λ +       log(1 − τ ) + (1 − τ ) [log p(s) + α − ϕ] +                            .
                         1+σ                                                     (σ + τ )        2

    The consumption allocation (22) has the form in (A1), which confirms the no bond trade guess.
    In the proof of Proposition 4, we solve for λ as a function of (τ, g) and other structural parameters using
the government budget constraint.


A.3     Proof of Proposition 3 [skill price and skill choice]
Recall from eq. (14) in the main text that the optimality condition for skill investment is

                                       X      ∞
                      1s                      ∂u (c (ϕ, α, s; g, τ ) , h (ϕ, ε; τ ) , g)
                         = (1 − βδ) E0  (βδ)a                                            .                (A3)
                      κµ                                       ∂s
                                          a=0

The skill level s affects only the consumption allocation (not the hours allocation) and only through the price
p (s; τ ), which is fixed over time. Hence, (14) can be simplified as

                                        1s            ∂ log p (s; τ )
                                           = (1 − τ )                 .
                                        κµ                 ∂s
We now guess that the log-price function has the form

                                      log p (s; τ ) = π0 (τ ) + π1 (τ ) · s,                              (A4)

which implies that the skill allocation has the form

                                        s(κ; τ ) = (1 − τ ) µπ1 (τ ) · κ.                                 (A5)

    Since the exponential distribution is closed under scaling, skills inherit the exponential density shape
                                  η
from κ, with parameter ζ ≡ (1−τ )µπ 1 (τ )
                                           , i.e., m (s) = ζ exp (−ζs).
    We now turn to the production side of the economy. Effective hours worked N are independent of skill
type s (see Proposition 2). Aggregate output is therefore
                                          Z          ∞                                θ
                                                                        θ−1            θ−1
                                    Y =                   [N · m (s)]    θ    ds             .
                                                  0




                                                              59
   The (log of the) hourly skill price p (s) is the (log of the) marginal product of an extra effective hour
supplied by a worker with skill s, or
                                                       
                                                ∂Y          1         1
                   log p (s) = log                        = log Y − log [N · m (s)]                     (A6)
                                           ∂ [N · m(s)]     θ         θ
                                            
                                     1        Y      1         ζ
                               =       log         − log ζ + s.
                                     θ        N      θ         θ
                                                                                         ζ           1      η
     Equating coefficients across equations (A4) and (A6) implies π1 (τ ) =              θ       =   θ µ(1−τ )π1 (τ ) ,   which yields
         q
               η
π1 (τ ) = θµ(1−τ   ) and thus
                                          s                        s                !
                                                 ηθ                        ηθ
                                m (s) =                  exp −                     s .                                           (A7)
                                              (1 − τ ) µ                (1 − τ ) µ
Similarly, the base skill price is
                                                                                      
                                         1           Y          1              ηθ
                                π0 (τ ) = log                −    log                        .                                   (A8)
                                         θ           N         2θ           (1 − τ ) µ
    We derive a fully structural expression for π0 (τ ) below in the proof of Corollary 3.2.


A.4     Proof of Corollary 3.1 [distribution of skill prices]
From eq. (A5) and the expression for π1 (τ ), the skill premium for an agent with ability κ is
                                                                      η                       η
           π1 (τ ) · s(κ; τ ) = π1 (τ ) · (1 − τ ) µπ1 (τ ) · κ =             (1 − τ ) µ · κ = · κ,
                                                                  θµ (1 − τ )                 θ
and thus skill premia are exponentially distributed with parameter θ.
    The variance of log skill prices is
                                                                                   η 2 1
                  var (log p(s; τ )) = var (π0 (τ ) + π1 (τ ) · s(κ; τ )) =                . var(κ) =
                                                                        θ               θ2
   Since log skill premia are exponentially distributed, the distribution of skill prices in levels is Pareto.
The scale (lower bound) parameter is exp(π0 (τ )) and the Pareto parameter is θ.


A.5     Proof of Corollary 3.2 [aggregate quantities]
Aggregate hours and aggregate effective hours are given, respectively, by
                                 Z Z Z
                     H(τ ) =              h(ϕ, ε; τ ) dFϕ dFα dFε ,
                                          Z Z Z
                  N (s; τ ) = N (τ ) =              exp(α + ε)h(ϕ, ε; τ ) dFϕ dFα dFε .

    Using the expression for individual hours in Proposition 2 and integrating over the normal distributions
for ϕ, α, and ε gives
                                                                   
                                     1         τ (1 +  σ̂) − σ̂ v ε
                 H(τ ) = (1 − τ ) 1+σ exp
                                                     σ̂ 2       2
                                                                                         
                                     1         τ (1 + σ̂) + σ̂ vε                      1
                 N (τ ) = (1 − τ )  1+σ  exp                          = H (τ ) · exp      vε .
                                                     σ̂ 2       2                      σ̂

                                                             60
       Aggregate output is equal to aggregate labor earnings
                                  Z Z Z Z
                     Y (τ ) =                   p(s; τ ) exp(α + ε)h(ϕ, ε; τ ) dFs dFϕ dFα dFε                  (A9)
                                  Z
                             =       p (s; τ ) dFs · N (τ )
                                    θ
                              =        · exp (π0 (τ )) · N (τ ) ,
                                   θ−1
where the last line follows from the fact that skill prices are Pareto distributed with scale exp(π0 (τ )) and
Pareto parameter θ.
    Aggregate labor productivity is
                                                                                 
                            Y (τ )   Y (τ ) N (τ )                           1
                                   =        ·        = E [p (s; τ )] · exp      vε .
                            H(τ )    N (τ ) H(τ )                            σ̂

       Finally, one can solve for the base log skill price π0 (τ ). From the production function (eq. 5), we have
that
                                  Z       ∞                                        θ
                                                                     θ−1            θ−1
                          Y   =                [N · ζ exp (−ζs)]      θ    ds
                                       0
                                       s                               s                      !− θ−1
                                                                                                      θ

                                                  ηθ            θ−1                    ηθ
                              = N·                                                                         .   (A10)
                                               (1 − τ ) µ        θ                  (1 − τ ) µ

       Comparing this equation to eq. (A9) it is immediate that
                                                                                      
                            1                           η                   1           θ
              π0 (τ ) =             log (1 − τ ) − log       − log (θ) +         log
                        2 (θ − 1)                       µ                (θ − 1)       θ−1

which is the expression reported in Proposition 3.


A.6        Proof of Proposition 4 [closed-form social welfare]
We prove this proposition in two steps. First, we show how to derive a closed-form solution for the residual
fiscal variable λ. Second, we substitute the allocations into the social welfare function and show how to
obtain eq. (29).
                          R
    Step 1. If we let Ỹ = yi1−τ di, we have

                                                            (1 − g) Y
                                                       λ=             .                                        (A11)
                                                                Ỹ

To compute Ỹ , it is useful to aggregate by age group. Let Ỹ a denote average per capita disposable income
for agents of age a :
                                Z
                      Ỹ a
                           =       [y (s, ϕ, ε, α)]1−τ m (s) dsdFαa dFϕ dFε
                                Z
                           =       [h (ε) exp (p (s) + αa + ε)]1−τ m (s) dsdFαa dFϕ dFε .


                                                                61
Substituting in the hours allocation (21), the expression for the skill price (23), the density function m (s)
(A7), and integrating, we arrive at
                                                                      
                                       a                           vαa
                                     Ỹ = K × exp −τ (1 − τ )            ,
                                                                    2
where
                                                                                    
                               1   1−τ        (1 − τ ) (1 + σ
                                                            b) (1 − τ ) (1 + σ   b)        vε
        K = (1 − τ ) exp − M exp   1+σ                                              −1
                               σ
                               b                       σ
                                                       b                σ
                                                                        b                  2
                                                      Z
                              vϕ
            × exp −τ (1 − τ )      exp [(1 − τ )π0 (τ )] exp [(1 − τ ) π1 (τ )s] m (s) ds.
                               2
    Note that
                  Z       ∞
                               exp [(1 − τ ) π1 (τ )s] m (s) ds
                      0
                  Z       ∞                                   1 !                1                          1 !
                                                      η         2          ηθ        2                  ηθ        2
           =                   exp (1 − τ )                       s                      exp −                      s ds
                      0                           θµ(1 − τ )            µ(1 − τ )                    µ(1 − τ )
                           θ
           = −                     ,
                      (1 − τ ) − θ
and recall that
                                                                                                
                                       1                            η                 1           θ
           π0 (τ ) =                            log (1 − τ ) − log     − log (θ) +         log
                                   2 (θ − 1)                        µ              (θ − 1)       θ−1
                                   (1 − τ ) (1 − τ (1 + σb)) vε
                M =                                             .
                                               σ
                                               b              2
    Now sum across age groups to obtain
                                              ∞
                                              X                            ∞
                                                                           X                               
                                                                                            va
                          Ỹ     = (1 − δ)           a   a
                                               δ Ỹ = K × (1 − δ)          δ exp −τ (1 − τ ) α
                                                                                a

                                           a=0                         a=0
                                                                                             2
                                                                   0
                                                                      
                                        (1 − δ) exp −τ (1 − τ ) v2α
                                 = K×                              .                                                     (A12)
                                           1 − δ exp −τ (1−τ
                                                         2
                                                             )
                                                               v ω


    Substituting (A10) and (A12) into (A11) and simplifying, we arrive at a solution for the equilibrium
value of λ which, in logs, i:
                                                  
                            τ (1 − τ ) 1 + σ         vε      τ
 log λ = log(1 − g) +                        +2+σ       +        log (1 − τ )                      (A13)
                              σ+τ       σ+τ           2    1+σ
                         vϕ
            +τ (1 − τ )
                          2                                             
                                        v0                 −τ (1 − τ )
            − log (1 − δ) + τ (1 − τ ) α + log 1 − δ exp               vω
                                         2                     2
                                                                                              
               1 τ            1−τ       1 τ        µ     θ−1+τ              θ              θ−1+τ
            +          log            +       log      +           log            + log                .
               2θ−1             θ       2θ−1       η       θ−1            θ−1                  θ



                                                                  62
    Step 2. Substituting the equilibrium allocations into period utility at age a ≥ 0, we have
                                                                                                       
                           1−τ                                  1−τ                              θ     µ
u(ca , h, G) = log λ +           log (1 − τ ) − (1 − τ ) ϕ +              log(1 − τ ) + log
                           1+σ                               2 (θ − 1)                        (θ − 1)2 η
                                                             
                                     1+σ                 1+σ      (1 − τ )              η
                 +M − exp −                  M exp             ε             + (1 − τ )κ + χ log G + (1 − τ ) αa .
                                   σ
                                   b(1 − τ )               σ
                                                           b      (1 + σ)               θ

    The disutility cost from investing in education is

                                                1 s(κ; τ )2               η
                                v (s (κ)) = −               = − (1 − τ ) κ .                                  (A14)
                                                κ 2µ                      2θ
    Average cross-sectional utility (excluding skill investment costs) at age a, which we denote ūa , is
                                       Z Z Z Z
                             ūa =                 u(ca , h, G)dFκ dFε dFϕ dFαa
                                                   vαa
                                   = ū − (1 − τ )
                                                    2
                                                   avω
                                   = ū − (1 − τ )     ,
                                                     2
where
                                                                                                           
                 1−τ                         vϕ     1−τ                                            θ     µ
    ū = log λ +     log (1 − τ ) − (1 − τ )    +                       log(1 − τ ) + log
                 1+σ                          2   2 (θ − 1)                                     (θ − 1)2 η
                 1−τ    1−τ
            +M −     +        + χ log (gY ) ,
                 1+σ      θ
and where the derivation of the expression for ū exploits the facts that
                        Z                                      
                                     1+σ                  1+σ
                           exp −             M exp               ε dFε = 1,
                                   σ
                                   b(1 − τ )                 σ
                                                             b
                                                     Z
                                                                  η       1−τ
                                                        (1 − τ )κ dFκ =       .
                                                                  θ         θ
    Substituting in the expressions above for λ and Y (A13andA10) gives

                                                           log(1 − τ )          1
                 ū = log(1 − g) + χ log g + (1 + χ)                      −                                   (A15)
                                                         (1 + σ̂)(1 − τ ) (1 + σ̂)
                                                                                         
                                  log (1 − τ )         1            µ         −2θ (2θ−1)
                      +(1 + χ)                 +              log     (θ − 1)     θ
                                   2 (θ − 1)      2 (θ − 1)         η
                                                          
                                         1−τ              1−τ                   vϕ
                      − − log 1 −                    −              − (1 − τ )2
                                           θ                θ                    2
                                                      
                              1 − δ exp    −τ (1−τ )
                                                     vω                                  
                      + log 
                                               2
                                                           + (1 + χ) 1 vε − σ 1 vε .
                                        1−δ                               σ̂       σ̂ 2 2

    Average skill investment costs for agents born after the tax reform are
                                                         1−τ
                                                c̄Y =        ,
                                                          2θ

                                                      63
whereas average net costs for those born prior to the reform are
                                                     1−τ   1 − τ−1
                                             c̄o =       −
                                                      2θ     2θ
     Now we are in a position to add up across cohorts to compute social welfare defined as
                                                 ∞
                                        γ − βδ X j
            W0 (g, τ ; τ−1 ) = (1 − γ)             γ Uj,0 (g, τ ; τ−1 )
                                       γ(1 − βδ)
                                                          j=−∞
                                                      −1                          ∞
                                             γ − βδ X j                  γ − βδ X j
                              = (1 − γ)                  γ Uj + (1 − γ)             γ Uj ,
                                            γ(1 − βδ)                   γ(1 − βδ)
                                                          j=−∞                                  j=0

where the second line partitions the population into cohorts born before and after the tax reform.
   Starting with the agents born after the tax reform,
                             ∞                                        ∞                  ∞
                                                                                                             !
                 γ − βδ X j               γ − βδ X j                                     X
        (1 − γ)           γ Uj = (1 − γ)           γ                            (1 − βδ)   (βδ)a ūa − c̄Y
                γ(1 − βδ)                γ(1 − βδ)                                        a=0
                             j=0                                     j=0
                                                        ∞
                                                        X
                                              γ − βδ                         γ − βδ
                                        =                     (βδ)a ūa −             c̄Y .
                                                γ                           γ(1 − βδ)
                                                        a=0

Now
                                                                     vω
                                             ūa = ū − (1 − τ ) a      ,
                                                                      2
so

                                                                vω n                  o
                       ∞
                       X                        ū
                         (βδ)a ūa =                 − (1 − τ )     βδ + 2 (βδ)2 + ...
                       a=0
                                            (1 − βδ)             2
                                                ū      βδ              vω
                                    =               −        2
                                                               (1 − τ )
                                            (1 − βδ) (1 − βδ)            2

and thus
                              ∞
                  γ − βδ X j       γ − βδ          γ − βδ               vω    γ − βδ
         (1 − γ)           γ Uj =           ū −          2
                                                            βδ (1 − τ )    −           c̄Y .
                 γ(1 − βδ)        γ(1 − βδ)      γ(1 − βδ)               2   γ(1 − βδ)
                             j=0

     Now look at agents born before the reform (the youngest of which are age 1 at the time of reform):
                            −1
                 γ − βδ X j                     γ − βδ
      (1 − γ)                  γ Uj = (1 − γ)           ×
                γ(1 − βδ)                     γ(1 − βδ)
                          j=−∞
                                                                                        
                                      γ −1 (βδ)1 (1 − βδ) ū1 + (βδ)ū2 + (βδ)2 ū3 + ... − c̄o
                                              +γ −2 (βδ)2 {(1 − βδ) (ū2 + (βδ)ū3 + ...) − c̄o } + ....

Adding the pieces here involving ū and c̄o gives

                                                        βδ
                                        (1 − γ)                (ū − c̄o ) .
                                                     γ(1 − βδ)


                                                          64
    The term in vω is
              γ − βδ               vω 
     (1 − γ)           × − (1 − τ )      × (1 − βδ) ×
             γ(1 − βδ)               2
     (                                    2                                   )
         βδ                                 βδ                             
               1 + 2(βδ) + 3(βδ)2 + ... +           2 + 3(βδ) + 4(βδ)2 + ... + ...
         γ                                   γ
                                         (                 2                               )
             γ − βδ             vω       βδ     1         βδ         1           1
   = (1 − γ)        × − (1 − τ )      ×                 +                   +             + ...
               γ                  2        γ (1 − βδ)2       γ      1 − βδ (1 − βδ)2
                                                                             
                                                                             βδ      
             γ − βδ             vω              βδ
                                                                  1            γ
                                                   γ                                 .
   = (1 − γ)        × − (1 − τ )      ×                                +          
               γ                  2       (1 − βδ)(1 − βδ ) (1 − βδ)       1 − βδ    
                                                                  γ                         γ

    Now we can add together the contributions to social welfare from agents born before and after the
                                                                                      βδ (1−γ) 1
reform. The term in ū is simply ū. The terms in c̄Y and c̄0 simplify to give − 1−τ
                                                                                  2θ + γ (1−βδ) 2θ (1 − τ−1 ).
                       βδ
The term in vω is − γ−βδ   (1 − τ ) v2ω . Collecting all these terms gives the expression for social welfare in
Proposition 4.
   In particular, collecting the terms in vω , we obtain
                                                                                   
                                                                       −τ (1−τ )
                                         βδ vω             1 − δ exp       2     v ω
                        − (1 − τ )               − log                                .
                                      γ − βδ 2                      1−δ

                                                                          δ vω
    When γ = β, the first term in square brackets simplifies to (1 − τ ) 1−δ 2 . The second term can be
approximated as follows:
                                   
              1 − δ exp −τ (1−τ )
                                  vω                                   
        log 
                             2
                                       ≈ log 1 + δ τ (1 − τ ) vω ≈ τ (1 − τ ) δ vω .
                       1−δ                           1−δ             2                1−δ 2

Adding the two pieces, we have
                           δ vω                   δ vω                   δ vω              vα
                (1 − τ )           − τ (1 − τ )           = (1 − τ )2           = (1 − τ )2 ,
                         1−δ 2                  1−δ 2                 1−δ 2                 2
where the last equality reflects the fact that vα is the cross-sectional variance of the cumulated innovations
ω, and the δ in the numerator reflects our assumption that wage shocks start realizing at age a = 1. We use
this approximate result when we interpret the various components of social welfare in Section 5.2.


A.7     Proofs of Corollaries 4.1, 4.3, 4.4, 4.5
4.1: In eq. (29), the term in τ−1 is additively separable from all the others containing g and τ .
4.3: Differentiating eq. (29) with respect to g, the first-order condition is
                                                −1  χ
                                                   + = 0,
                                               1−g  g
which immediately gives the expression for g∗ in eq. (30).
4.4: Differentiating eq. (29) with respect to τ , the first-order condition has no terms involving g. Thus, the
optimal choice for τ is independent of g.
4.5: The parameters µ and η only appear in an additively separable constant in eq. (29). Thus, these
parameters do not appear in the first-order conditions defining the optimal choices for g and τ .

                                                      65
A.8     Proof of Corollary 4.2 [concavity]
Differentiating the expression for social welfare twice with respect to τ , it is straightforward to show that
each term except the last one involving insurable risk is strictly concave in τ . The term in insurable risk has
a second derivative equal to
                                                  σ − 2τ
                                      − (1 + χ)             (1 + σ)2 vε ,
                                                 (σ + τ )4
which is less than or equal to zero if σ ≥ 2. Thus, σ ≥ 2 is a (weak) sufficient condition for global concavity
of social welfare with respect to τ .
    It is straightforward to verify that the social welfare expression is concave in τ .


A.9     Proof of Corollary 4.6 [γ = β case]
                                                              1−δ
In eq. (28) when γ = β, the constant term Γ simplifies to 1−βδ    . Let E [u0 ] denote expected period utility
for newborn agents from consumption and leisure. The contribution to social welfare from newborn agents
is then
                             1−δ                      
                   (1 − β)         · 1 + β + β 2 + ... · (1 − βδ)E [u0 ] = (1 − δ) · E [u0 ] .
                            1 − βδ
                    2
                           
where 1 + β + β + ... reflects the weights the planner puts on current and future cohorts of age zero.
Note that (1 − δ) is the size of the population at age zero.
     Similarly, the age 1 component is given by
                       1−δ                             
            (1 − β)          · β −1 + 1 + β + β 2 + ... · (1 − βδ) · βδE [u1 ] = (1 − δ) δE [u1 ]
                      1 − βδ

where the term (1 − δ) δ is the size of the population at age 1. And so on.
    Now we need to compute how education costs factor into social welfare. Education costs for the new
and future cohorts are
                                                             2                  2
                           1−δ                 2
                                                            1s         1−δ       1s
                  (1 − β)          · 1 + β + β + ... · E            =         ·E       .
                          1 − βδ                             κ 2µ      1 − βδ     κ 2µ

    If education decisions are fully reversible, the net skill investment cost for an agent of type
                                                                                                    κ given
                                                                      1
a new progressivity value τ and a past progressivity value τ−1 is 2κµ     s(κ; τ )2 − s(κ; τ−1 )2 . Thus, the
contribution to social welfare from net skill investments from cohorts who entered the economy in the past
is

                                         ∞                                          
                                 1 − δ X βδ a              1          2            2
                                                                                     
                        (1 − β)        ·            E         s(κ; τ ) − s(κ; τ−1 )
                                1 − βδ a=1 β             2κµ
                                                                          
                                   δ         1 s(κ; τ )2        1 s(κ; τ−1 )2
                      = (1 − β)        · E                 −E                    .
                                1 − βδ       κ 2µ               κ      2µ

    Adding the two pieces gives
                                                                         
                                1 s(κ; τ )2     δ(1 − β)      1 s(κ; τ−1 )2
                            E                 −          ·E                   .
                                κ 2µ             1 − βδ       κ    2µ

    Adding up these various welfare components gives the expression for social welfare in eq. (31).

                                                      66
A.10 Proof of Corollary 4.7 [efficiency in the RA model]
The planner’s problem in the representative agent economy is
                                                                         
                                                      H 1+σ
                                      max log C −            + χ log (gY )                                     (A16)
                                      C,H,g           1+σ
                                      s.t.
                                Y   = H
                                C = (1 − g)Y,

where the first constraint is the production function and the second is the feasibility constraint. Substitut-
ing these two constraints into the objective and taking first-order conditions gives g∗ = χ/ (1 + χ) and
             1
log H ∗ = 1+σ   log (1 + χ). Comparing this first-best expression for hours with the competitive equilibrium
                                          1
allocation in eq. (18), log H RA (τ ) = 1+σ  log(1 − τ ), it is immediate that τ ∗ = −χ implements the first
best.


A.11 Proof of Proposition 5 [condition for progressivity]
Assume γ = β and approximate the sixth line of the social welfare expression (eq. 29) by −(1 − τ )2 v2α .
Then the derivative of the social welfare expression with respect to τ is

              ∂W(g, τ ; τ−1 )               (1 + χ)           1        1    (τ + χ)
                                 = −                     +          −    −
                  ∂τ                    2(θ − 1) (1 − τ ) θ − 1 + τ   2θ (σ + 1) (1 − τ )
                                                                 (1 + σ)2
                                     + (1 − τ ) (vϕ + vα ) − τ               vε (1 + χ) .
                                                                 (σ + τ )3

We want to sign this derivative at τ = 0 in order to ascertain whether a marginal increase in progressivity is
welfare improving:

                   ∂W(g, τ ; τ−1 )            1+χ       1    1   χ
                                   |τ =0 = −         +     −   −     + vϕ + vα .
                       ∂τ                    2(θ − 1) θ − 1 2θ σ + 1

It is immediate that this derivative is positive if and only if the condition in Proposition 5 is satisfied.


A.12 Proof of Proposition 6 [efficiency with χ = vω = τ = 0]
With χ = 0 there is no desire for the publicly provided good, and thus the absence of a private market for
this good is irrelevant. With vω = 0 the absence of private markets for insuring shocks to α is similarly
irrelevant: such shocks are simply assumed away.
     Recall that there are competitive markets for consumption, for the labor supply of each skill type, and
competitive insurance markets for shocks to ε. Thus, given χ = 0 and vω = 0 and absent government
intervention (i.e., with τ = 0 and λ = 1), the first welfare theorem applies and competitive equilibrium
allocations are Pareto efficient and correspond to the solution to a planner’s problem.
     We now derive the Pareto weights such that the solution to the planner’s problem corresponds to the
competitive equilibrium allocations.
     Given γ = β, social welfare is equal to average period utility in cross section (recall Corollary 4.6).
Moreover, absent uninsurable life-cycle shocks, expected period utility is independent of age. Thus the


                                                        67
planner chooses allocations c(ϕ, κ, ε), h(ϕ, κ, ε), and s(ϕ, κ, ε) to solve
         Z Z Z                                                                             
                                               exp [(1 + σ)ϕ]             1+σ   s(ϕ, κ, ε)2
   max           ζ(ϕ, κ, ε) log c(ϕ, κ, ε) −                   h(ϕ, κ, ε)     −               dFκ dFϕ dFε
                                                    1+σ                            2µκ
subject to
                          Z Z Z                                 Z     ∞                         θ
                                                                                  θ−1            θ−1
                                      c(ϕ, κ, ε)Fκ dFϕ dFε =               E(z)    θ    dz             ,
                                                                   0
where effective hours by skill type z is given by
                                  Z Z Z
                        E(z) =              h(ϕ, κ, ε) exp(ε)Is(ϕ,κ,ε)=z dFκ dFϕ dFε .

    The first-order condition with respect to consumption is
                                                     ζ(ϕ, κ, ε)
                                                                = µ,
                                                     c(ϕ, κ, ε)
where µ is the multiplier on the resource constraint.
   The competitive equilibrium consumption allocation is given by
                                                                                                           1 vε
               log c(ϕ, κ, ε) = log λ + π0 (τ = 0) + π1 (τ = 0) · s(κ; τ = 0) − ϕ +
                                                                                                           σ 2
                                                      η        1 vε
                                = log λ + π0 (τ = 0) + κ − ϕ +      .
                                                      θ        σ 2
    It follows immediately that the Pareto weights must take the form
                                                             η
                                           log ζ(ϕ, κ) =       κ − ϕ + ψ,
                                                             θ
where ψ is a constant.
   Now the average Pareto weight must equal one:
                                     Z Z
                                          ζ(ϕ, κ)dFϕ dFκ = 1

    Thus,
                    Z Z         η                                           Z              η 
                          exp         κ − ϕ + ψ dFϕ dFκ = exp(ψ)                    exp         κ dFκ
                                 θ                                                            θ
                                                                                 θ
                                                                = exp(ψ)
                                                                              (θ − 1)
                                                                = 1,
                                θ−1
    which implies exp(ψ) =       θ    and thus

                                                         η              θ
                                       log ζ(ϕ, κ) =       κ − ϕ − log     .
                                                         θ             θ−1
    Thus, we have shown that given the candidate Pareto weights, the planner’s consumption allocation
aligns with the competitive equilibrium allocation. We now verify that given the same Pareto weights, the
equilibrium allocation for skill investment corresponds to the skill investment rule preferred by the planner.

                                                           68
To simplify the analysis, we abstract from flexible labor supply and preference heterogeneity, so that agents
are heterogeneous only with respect to κ, and the planner’s skill investment rule must take the form s(κ).
Thus,
                                                 Z                θ
                                                            θ−1    θ−1
                                        Y =N·         fs (z) θ dz

where N is effective hours worked per capita and fs (z) is the density of skill type z.
   Let Fs denote the unknown CDF for skills. We know that

                                                               Fs (s(κ)) = Fκ (κ).

    By the chain rule
                                                           fs (s(κ))s′ (κ) = fκ (κ).
    So
                                 Z                                                   "Z                                             # θ−1
                                                                                                                                         θ
                                                                                                 ∞                       θ−1
                                                                        θ
                                         ∞            θ−1              θ−1                                fκ (s−1 (z))      θ
               Y    = N·                     fs (z)    θ    dz               = N·                                                dz
                                     0                                                       0            s′ (s−1 (z))
                                 "Z                                                  # θ−1
                                                                                        θ
                                          ∞                θ−1
                                               fκ (κ)              θ
                    = N·                                               s′ (κ)dκ              ,
                                      0        s′ (κ)

where the substitutions in the last line use κ = s−1 (z) and s′ (κ)dκ = dz and also exploit the fact that the
limits of integration do not change because s(0) = 0 and s(∞) = ∞.
    Thus, the planner’s problem can be formulated in Lagrangian form as follows:
                                          Z                        
                                                              s(κ)2
                     max              Λ =   ζ(κ) log c(κ) −           dFκ
            {c(κ),s(κ),s′ (κ),λ,ψ(κ)}                          2µκ
                                             (    Z                        θ     Z           )
                                                                                 ∞            θ−1               1   θ−1
                                                      +λ N ·                         fκ (κ)    θ     s′ (κ) θ dκ          −      c(κ)dFκ
                                                                             0
                                                           Z       ∞                        Z       κ                 
                                                                                                            ′
                                                      +                ψ(κ) s(κ) −                        s (x)dx + s(0) dκ,
                                                               0                                  0

where the first line is the objective, the second is the resource constraint, and the third is a set of constraints
linking skill investment levels and derivatives.
    We know that s(0) = 0. The first-order conditions for s(κ) and s′ (κ) are

                                                           s(κ)
                                                      −         ζ(κ)f (κ) + ψ(κ) = 0
                                                            µκ
                        Z       ∞                             1                          Z ∞
                 θ                             θ−1
                                                       ′
                                                               θ−1 1     θ−1 1
                                                                                ′    1−θ
             λN                      fκ (κ)     θ     s (κ) dκ     f (κ)
                                                                   θ      θ    s (κ)  θ  −     ψ(x)dx = 0,
                θ−1          0                                               θ              κ
which we can rewrite as
                                                                                                 Z      ∞
                             1    θ    1       θ−1 1      1−θ
                     λN 1− θ         Y θ fκ (κ) θ s′ (κ) θ                              =                   ψ(x)dx
                                 θ−1               θ                                                κ
                                                        1−θ                                    Z      ∞
                                        1      Y s′ (κ)    θ                                                s(x)
                                                                                        =                        ζ(x)fκ (x)dx.
                                      θ − 1 N fκ (κ)                                                κ        µx

                                                                             69
             Now the planner weights and competitive equilibrium skill investment rule with τ = 0 are
                                                                   η
                                                      log ζ(κ) =     κ − log (θ/(θ − 1))
                                                                   θ
                                                                        r
                                                                           ηµ
                                                                s(κ) =        κ.
                                                                            θ


             Substituting these into the first-order condition gives
                            q         1−θ                 q                                                  
                                 ηµ      θ
                                                      Z    ∞
                                                                    ηµ
                                                                                η                             
                  1 Y            θ                                  θ x
                                                 =                        exp   x − log (θ/(θ − 1)) η exp (−ηx) dx
                θ − 1 N fκ (κ)                         κ     µx               θ                                
                                                                   θ                  1 ( −1 )
                                         Y                 θ        θ−1                η 2 θ−1
                                                                          θ ( θ−1 )
                                                                           1  −1
                                                  =                        2                       ,
                                         N                θ−1                          µ
      which is exactly the expression for productivity per efficiency unit of labor supply in the text (eq. 34). Thus
      the planner’s first-order condition is satisfied at the competitive equilibrium allocation.


      A.13 Proof of Corollary 6.1 [nonutilitarian welfare]
      Given γ = β, the contribution to social welfare from a particular individual of age j can be written as
                                               "                                               η     #
                                                     ũ − (1 −
                                                              τ ) ϕ +
                                                                      (1 − τ ) α j
                                                                                  + (1 − τ ) θ κ
                 uj (ϕ, αj , κ, ε) = (1 − δ)δj                                                         ,
                                                    1−τ
                                                 − 1+σ   exp (1+σ)
                                                                 σ̂
                                                                             M
                                                                       ε − (1−τ )
                                                                                                   η
                                                                                     − (1 − τ ) κ 2θ

     where ũ collects all terms that are common across agents.51 In this expression, the terms − (1 − τ ) ϕ
     and (1 − τ ) αj capture the impact of preference heterogeneity and uninsurable productivity shocks on log
     consumption. The term (1 − τ )κ ηθ = (1 − τ )π1 (τ )s(κ; τ ) captures the impact of skill investment on log
     consumption. Disutility from hours worked is given by the next term, which varies with ε but is independent
     of ϕ. The final term is the disutility cost of gross skill investment and is equal to −s(κ; τ )2 /(κ2µ) (note that
     we again ignore the fact that net investment may be smaller      for agents who entered before date 0).
                                              θ−1                η 
         Given planner weights ξ (ϕ, κ) = θ exp −ϕ + θ κ , the contribution to social welfare from all agents
     of age j is (1 − δ)δj ũ plus
        Z Z Z Z                                                                                 
                                                      η          1         (1 + σ)          M
(1−δ)δj              ξ (ϕ, κ) (1−τ ) −ϕ + αj + κ −                   exp             ε−                  dFϕ dFκ dFαj dFε .
                                                     2θ       1+σ             σ̂          (1 − τ )
             We evaluate the integral piece by piece.
             The term in −ϕ is
                                                      Z Z Z    
                                       θ−1    j                     η 
                             (1 − δ)δ        (1 − τ )       exp −ϕ + κ (−ϕ) dFϕ dFκ dFαj
                                         θ                          θ
                                               Z
                                                                                      vϕ
                           = (1 − δ)δj (1 − τ ) exp (−ϕ) (−ϕ) dFϕ = (1 − δ)δj (1 − τ ) ,
                                                                                       2
        51
           For the sake of simplicity, we assume a degenerate skill distribution at zero at the date of reform, which allows us
      to ignore the last term in the expression for social welfare involving τ−1 (see eq. 31). Note that this assumption has
      no impact on the optimal choice for τ , given reversible skill investment.

                                                                           70
where the last equality uses a standard formula for Gaussian integrals.
   The term in αj is
                                Z Z Z       
                 θ−1                                 η                                   jvω
      (1 − δ)δj        (1 − τ )          exp −ϕ + κ αj dFϕ dFαj dFκ = −(1 − δ)δj (1 − τ )     .
                   θ                                 θ                                     2
    The term in κ is
                                                   Z Z     
                                     θ−1                          η  η
                             (1 − δ)δj    (1 − τ )     exp −ϕ + κ          κ dFϕ dFκ
                                       θ                          θ     2θ
                                                   Z    η  η
                                     θ−1
                         = (1 − δ)δj      (1 − τ ) exp      κ    κ (η exp(−ηκ)) dκ
                                       θ                  θ   2θ
                                     (1 − τ )
                         = (1 − δ)δj          .
                                     2(θ − 1)
                                         1−τ
    The term in ε is simply −(1 − δ)δj 1+σ   .
    Collecting terms, the contribution to social welfare from agents of age j is therefore
                                                                                        
                                                          1      jvω     vϕ         1
                 (1 − δ)δj ũ + (1 − δ)δj (1 − τ ) −           −      +      +             .
                                                      (1 + σ)     2       2     2(θ − 1)

    The corresponding expression for the utilitarian social planner was
                                                                                 
                                                             1      jvω   vϕ   1
                   (1 − δ)δj ũ + (1 − δ)δj (1 − τ ) −            −     −    +      .
                                                         (1 + σ)     2     2   2θ

    Thus,
                                                                                                  
                                                                                        1     1
                W ins (g, τ ; τ−1 ) = W(g, τ ; τ−1 ) + (1 − τ )vϕ + (1 − τ )                −          .
                                                                                    2(θ − 1) 2θ

A.14 Proof of Proposition 7 [agreement on G]
Expected utility for an individual with state (ϕ, α, κ, ε) can be written as


                                                                        X∞
                                            1 s (κ; τ )2
             U (ϕ, α, κ, ε; g, τ ) = −                   + (1 − βδ) E       (βδ)a [log c (ϕ, α, κ; g, τ )
                                            κ 2µ                        a=0
                                                                                                
                                            exp [(1 + σ) ϕ]
                                          −                  h (ϕ, ε; τ )1+σ + χ log (gY (τ )) ,            (A17)
                                                 1+σ

where we have made explicit the facts that in equilibrium, skill investment s, hours h, and aggregate output
Y are independent of g.
   Recall from eq. (22) that
                                                   1−τ
log c (ϕ, α, s∗ (κ; τ ) ; g, τ ) = log λ(g, τ )+       log(1−τ )+(1−τ ) [log p(s (κ; τ )) + α − ϕ]+M (vε ; τ ) ,
                                                   1+σ
where, from eq. (A13),
                                         log λ(g, τ ) = log(1 − g) + Λ(τ ).


                                                           71
    If the individual with state (ϕ, α, κ, ε) were able to dictate the choice for g, taking τ as given, his optimal
choice would satisfy the following first-order condition:

                                                    1 ∂c ∂λ   1
                                                            +χ = 0                                                  (A18)
                                                    c ∂λ g    g
or
                                                    1c λ     1
                                                −         + χ = 0,
                                                    cλ1−g    g
which implies the desired result
                                                            χ
                                                      g=       .
                                                           1+χ

A.15 Proof of Proposition 8 [median voter]
Substituting the allocations s (κ; τ ), h (ϕ, ε; τ ), and c (ϕ, α, s; g, τ ) into expected utility (A17) yields
                                                                                         h           ηi
                                     X∞
                    ηκ                                          log(1 − τ )
U    = − (1 − τ )      + (1 − βδ) E      (βδ)j log λ (g, τ ) +              + M + (1 − τ ) αj − ϕ + κ
                    2θ                                            (1 + σ̂)                            θ
                                     j=0
                                                                                            
            (1 − τ )                          θ     µ        (1 − τ )           1+σ         1+σ
         +             log(1 − τ ) + log          2
                                                         −            exp −             M+      ε
           2 (θ − 1)                       (θ − 1) η          1+σ             σ
                                                                              b(1 − τ )      σ
                                                                                             b
         +χ log G.

    Now, suppose that the choice of τ is made before observing ε. Then, the term in ε becomes − (1−τ )
                                                                                                 1+σ (see
the proof of Corollary 6.1). In addition,
                                      ∞
                                      X                                                    
                                                                                  βδ vω
                         (1 − βδ) E         (βδ)j (1 − τ ) αj = (1 − τ ) α −                    .
                                                                                1 − βδ 2
                                      j=0

      Thus,
Z                                                                                                                           
                                                   log(1 − τ )         (1 − τ )                                     θ     µ
     U (ϕ, α, κ, ε; g, τ ) dFε   = log λ (g, τ ) +              + M+                    log(1 − τ ) + log
                                                     (1 + σ̂)         2 (θ − 1)                                  (θ − 1)2 η
                                                               η   (1 − τ )
                                   − (1 − τ ) ϕ + (1 − τ ) κ −
                                                             2θ  1 + σ
                                                        βδ vω
                                   + (1 − τ ) α −                 + χ log G.
                                                      1 − βδ 2

      Recall that the baseline social welfare function is
                                                                                                               
                                       log(1 − τ )           (1 − τ )                                  θ     µ
       W(g, τ ) = log λ (g, τ ) +                  +M+                      log(1 − τ ) + log
                                         (1 + σ̂)           2 (θ − 1)                               (θ − 1)2 η
                                   vϕ (1 − τ ) (1 − τ )
                        − (1 − τ )    +           −
                                    2       2θ       (1 + σ)
                                               
                                       βδ vω
                        − (1 − τ )                 + χ log G.
                                     γ − βδ 2




                                                           72
    Therefore, we can express expected utility as
                                                                 vϕ (1 − τ )
                         U (ϕ, α, κ; g, τ ) = W(g, τ ) + (1 − τ ) −
                                                                 2       2θ     
                                                            βδ vω         βδ vω
                                              +(1 − τ )              −
                                                          γ − βδ 2      1 − βδ 2
                                                        h          κη i
                                              + (1 − τ ) α − ϕ +        .
                                                                    2θ
     Note that U (ϕ, α, κ; g, τ ) is strictly concave in τ , since W(g, τ ) is concave in τ and the additional terms
in U (ϕ, α, κ; g, τ ) are linear in τ .
     We need to determine the median voter. A useful property is that the three individual states (α, ϕ, κ)
enter as a linear combination. Let
                                                                  η
                                                 x = α − ϕ + κ.
                                                                  2θ
     The median voter is the agent with the median value for x. Since α and ϕ are normally distributed and κ
is exponentially distributed, the random variable x follows an Exponentially Modified Gaussian distribution.


A.16 Proof of Proposition 9 [welfare with progressive cons. tax]
To obtain the allocations when the government uses progressive consumption taxation, it suffices to follow
the steps in the proof of Proposition 2, with the only difference being that the island-level resource constraint
(A2) now becomes              Z                   Z
                                            1
                               λ      c(ε) 1−τ dFε =       exp (p(s) + α + ε) h (ε) dFε .                                (A19)
                                                       E
   With the allocations in hand, one can replicate all the steps of the proof of Proposition 4 to obtain the
new social welfare function.


A.17 Proof of Proposition 10 [equilibrium prices with skill bias]
We guess and will verify that equilibrium skill prices are still linear in s, i.e., p (s) = π0 + π1 s . As in
                                                         s = κη (1 − τ ) π1 and the cumulative distribution
Proposition 3, the optimal skill choice is then given by
                                                  1
for skills Fs (S) = Pr (s ≤ S) = 1−exp − (1−τ )π1 S . This is the CDF of an exponential distribution with
parameter ζ = 1/ [(1 − τ ) π1 ]. The density function is then given by fs (s) = ζ exp (−ζs). This allows us
to compute output per effective hour:
                      Z       ∞                                             θ                          −    θ
               Y                                              θ−1            θ−1            (θ − 1)            θ−1
                 =                 exp (̺s) · [ζ exp (−ζs)]    θ    ds             =ζ               ζ−̺              .
               N           0                                                                   θ

Below we verify that (θ−1)
                       θ ζ > ̺, so output is finite.
   Substituting the expressions for Y /N and m(s) into eq. (52) and taking logs yields
                                                        − θ !
                                 1          (θ − 1)          θ−1      1
               log p (s) = ̺s + log ζ                ζ−̺          − log [ζ exp (−ζs)] .
                                 θ             θ                      θ

    Substituting the expression for ζ gives
                                                                               
                               1          (θ − 1)  1             1     1
               log p (s) = −        log                    −̺ +                + ̺ s.
                             θ−1             θ (1 − τ ) π1       θ (1 − τ ) π1

                                                              73
    Note that the logarithm of the marginal product of skill type s is linear in s, confirming the guess that
p (s) is linear. Matching up coefficients, i.e., setting π1 = 1/ (θ (1 − τ ) π1 ) + ̺, implies52
                                                  s
                                            ̺         ̺ 2       1
                                    π1 =      +             +            ≥ 0.
                                            2          2      θ (1 − τ )
Note that Assumption 1 ensures that π1 is real.
   Using the solution for π1 and equating coefficients for the constant yields
                                                                          
                                       1          (θ − 1)       η
                             π0 = −         log                        −̺ ,
                                     θ−1             θ µ (1 − τ ) T

where                                             s
                                           ̺           ̺ 2           1
                                        T = +                  +              .
                                           2           2           θ (1 − τ )

     Note that the logarithm of the skill premium is π1 · s = η (1 − τ ) (π1 )2 κ. It follows that the equilibrium
distribution of log skill premia, π1 (τ ) · s, is exponential with parameter ζ = (1 − τ )−1 (π1 (τ ))−2 .
     Finally, we verify that ̺ < (θ−1)
                                    θ ζ. Given π1 we can characterize in terms of structural parameters the
condition under which
                                             θ−1        (θ − 1)      1
                                       ̺<           ζ=                    ,
                                                θ           θ (1 − τ ) T
Now note that the left-hand side is increasing in ̺ while the right-hand side is decreasing in ̺. So setting
the two sides equal defines an upper bound for ̺ satisfying the inequality. It is straightforward to verify that
this upper bound is given by
                                                 θ−1       1
                                            ̺¯ =        √       .
                                                   θ      1−τ
Since τ ≥ −1, it is clear that Assumtion 1 ensures that ̺ ≤ ̺¯.
    With skill bias in production (̺ 6= 0), the skill-related terms in the equally weighted social welfare
function W (g, τ ; τ−1 ) (second, third and fourth lines in eq. 29) become as follows (abstracting from the
term in τ−1 ):

                                                                                      
                                                           θ        (θ − 1)  1
                    − (1 + χ) log [(1 − τ ) T ] − (1 + χ)     log                   −̺
                                                          θ−1          θ (1 − τ ) T
                         h                   i
                    + log 1 − (1 − τ )2 T 2 + (1 − τ )2 T 2
                     1
                    − (1 − τ )2 T 2 .
                     2
    Note that in order for social welfare to be finite (i.e., larger than −∞) consumption dispersion must not
be too large. In particular, the term in the logarithm (in the second line) must be positive, which implies a
lower bound on τ given θ and ̺ :
                                                                                  1
                                   1 − (1 − τ )2 T 2 > 0 ⇒ τ > 1 −          1        .
                                                                            θ     +̺
 52
q Note that since s ≥ 0, we can rule out the second root, which is always negative: π1 = ̺/2 −
      2
 (̺/2) + 1/ (θ (1 − τ )) < 0.


                                                        74
Finally, consider the special case in which θ → ∞. Then T = ̺ and the terms above simplify to

                                                                           
                                                                  1
                     − (1 + χ) log [(1 − τ ) ̺] − (1 + χ) log            −̺
                                                              (1 − τ ) ̺
                          h                  i                1
                     + log 1 − (1 − τ )2 ̺2 + (1 − τ )2 ̺2 − (1 − τ )2 ̺2 .
                                                              2




                                              75
