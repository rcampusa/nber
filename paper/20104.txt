                              NBER WORKING PAPER SERIES




                    SHOCK ELASTICITIES AND IMPULSE RESPONSES

                                        Jaroslav Borovička
                                        Lars Peter Hansen
                                       José A. Scheinkman

                                       Working Paper 20104
                               http://www.nber.org/papers/w20104


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     May 2014




The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2014 by Jaroslav Borovička, Lars Peter Hansen, and José A. Scheinkman. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.
Shock Elasticities and Impulse Responses
Jaroslav Borovička, Lars Peter Hansen, and José A. Scheinkman
NBER Working Paper No. 20104
May 2014
JEL No. E0

                                            ABSTRACT

We construct shock elasticities that are pricing counterparts to impulse response functions. Recall
that impulse response functions measure the importance of next-period shocks for future values of
a time series. Shock elasticities measure the contributions to the price and to the expected future cash
flow from changes in the exposure to a shock in the next period. They are elasticities because their
measurements compute proportionate changes. We show a particularly close link between these objects
in environments with Brownian information structures.


Jaroslav Borovička                                 José A. Scheinkman
Department of Economics                            Department of Economics
New York University                                Columbia University
New York, NY 10012                                 New York, NY, 10027
jaroslav.borovicka@nyu.edu                         and NBER
                                                   joses@princeton.edu
Lars Peter Hansen
Department of Economics
The University of Chicago
1126 East 59th Street
Chicago, IL 60637
and NBER
lhansen@uchicago.edu
     There are several alternative ways in which one may approach the impulse prob-
     lem .... One way which I believe is particularly fruitful and promising is to study
     what would become of the solution of a determinate dynamic system if it were
     exposed to a stream of erratic shocks that constantly upsets the continuous evolu-
     tion, and by so doing introduces into the system the energy necessary to maintain
     the swings. Frisch (1933)


1    Introduction
Impulse response function characterize the impact of “a stream of erratic shocks” on dy-
namic economic models. They measure the consequences of alternative shocks on the future
variables within the dynamical system. These methods are routinely used in linear time
series analysis, and they can be generalized to nonlinear environments. See Gallant et al.
(1993), Koop et al. (1996), and Gourieroux and Jasiak (2005) for nonlinear extensions.
    Models of asset valuation assign prices to the “stream of erratic shocks” that Frisch ref-
erences. Macroeconomic shocks by their nature are not diversifiable, and as a consequence,
exposure to them requires compensation. The familiar impulse response methods have coun-
terparts in the study of valuation of stochastic cash flows within dynamic economic models.
Borovička et al. (2011), Hansen and Scheinkman (2012) and Hansen (2012) study dynamic
asset pricing through altering the cash-flow exposure to shocks. Changing this exposure
alters the riskiness of the cash flow and an economic model of the stochastic discount fac-
tor gives the implied compensation. Formally, these methods construct shock-exposure and
shock-price elasticities to characterize valuation as it depends on investment horizons. The
elasticities are responses obtained by conveniently normalizing the exposure changes and
studying the impact on the logarithms of the expected returns. These are the ingredients
to risk premia, and they have a “term structure” induced by the changes in the investment
horizons.
    As we will show, there is a close mathematical and conceptual link between what we call
shock elasticities and impulse response functions commonly used to characterize the behav-
ior of dynamical systems. In effect the shock-price elasticities are the pricing counterparts
to appropriately scaled impulse response functions. We connect these two concepts by in-
terpreting impulse response functions and shock elasticities as changes of measure for the
next-period shock.
   In addition to delineating this connection, we show how continuous-time formulations
with Brownian motion information structures provide additional simplicity obtained by
exploiting local normality building on the Haussmann–Clark–Ocone representation of a

                                              1
stochastic integral of responses to past shock depicted as Brownian increments.


2         Basic setup
Let X be a Markov diffusion in Rn :

                                          dXt = µ(Xt )dt + σ(Xt )dWt                                     (1)

with initial condition X0 = x. Here, µ(x) is an n-dimensional vector and σ(x) is an n × k
matrix for each vector x in Rn . In additon W is a k-dimensional Brownian motion. We use
this underlying Markov process to construct an additive functional Y via:
                                              Z       t                Z   t
                                  Yt = Y0 +               β(Xu )du +           α(Xu ) · dWu              (2)
                                                  0                    0


where β(x) is a scalar and α(x) is a k-dimensional vector.1 Thus Yt depends on the initial
conditions (X0 , Y0) = (x, y) and the innovations to the Brownian motion W between dates
zero and t. Let {Ft : t ≥ 0} be the (completed) filtration generated by the Brownian motion.
In what follows we will not explore the consequences of the initial condition Y0 = y, and we
will drop reference to y in our notation. The shock elasticities that we will formulate do not
depend on this initialization.
   When building models of economic time series, researchers typically work in logarithms.
We think of Y as such a model, which by design can capture arithmetic growth that is
stochastic in nature. Our interest in asset pricing will lead us to study exponentials of
                                            .
additive functionals. We call the process M = exp(Y ) a multiplicative functional and use it
to model levels of cash flows and stochastic discount factors.
   To construct an impulse response function, consider for the moment a discrete-time
counterpart indexed by the length of the time period τ and constructed using normally
distributed shocks:

                                 τ
                                Xt+τ − Xtτ = µ (Xtτ ) τ + σ (Xtτ ) ∆Wt+τ                                 (3)
                                   τ
                                 Yt+τ − Ytτ = β (Xtτ ) τ + α (Xtτ ) · ∆Wt+τ .

            .
where ∆Wt+τ = Wt+τ − Wt and t ∈ {0, τ, 2τ, . . .}. For convenience we may think of τ = 2−j
as a sequence of embedded refinements for a continuous-time approximation realized when j
becomes arbitrarily large. Whenever we use the time index t in a discrete-time model with
    1
        Notice that our definition of additive functional allows for processes of unbounded variation.



                                                               2
period length τ , we have in mind t ∈ {0, τ, 2τ, . . .}.


3         Impulse response functions in discrete time
An impulse response quantifies the impact of a shock, ∆Wτ = w, on future values of Yt . One
way to construct the impulse response function is to compute

                                Φ(t, x, w) = E [φ(Yt )|X0 = x, ∆Wτ = w]                                 (4)

for alternative functions φ of Yt and explore the consequences of changing a basic distribution
Q(w) to a “perturbed” distribution Qη (w). That is, we evaluate:
                            Z                               Z
                                            η
                                 Φ(t, x, w)Q (dw|x) −           Φ(t, x, w)Q(dw).                        (5)

The multiplicative functional M is one example of a function φ (·), and we will denote the
conditional expectation (4) for such a multiplicative functional as Φm .
   While the baseline distribution, Q, for the initial shock is normal with mean zero and
covariance matrix τ I, we may, for example, construct the perturbed distribution Qη to
explore implications of mean shifts. In this case Qη is a normal distribution with mean
η(x), which is very similar to the suggestion of Gallant et al. (1993). Changing η reveals the
sensitivity of the predicted response to changes in the different components of ∆Wτ .2
   Alternatively we may condition on ∆Wτ = η(x) and study the response
                                                    Z
                                  Φ(t, x, η(x)) −       Φ(t, x, w)Q(dw).                                (6)

This follows an approach proposed by Koop et al. (1996) and corresponds to measuring the
response of Φ to the new information contained in the realization η(x) of the shock ∆Wτ
and exploring changes in η(x). Mathematically, this calculation is equivalent to letting Qη
assign probability one to a single value w = η (x). That is, Qη (dw|x) = δ [w − η(x)] where
δ(·) is the Dirac delta function.
        The impulse response defined in (5) generally does not scale linearly with the magnitude
    2
    Gallant et al. (1993) consider an impulse to the state variable, say X0 , but we can construct an analog
using an impulse to the initial period shock. For a shock η, they construct

                                        Φ(t, x, w + η) − Φ(t, x, w),

and in much of their analysis, they form averages as in (5) except that they also integrate over the initial
state x.



                                                        3
of η(x), so the magnitude of the impulse matters. This leads us to construct a marginal
response. Consider a family of Qηr (dw|x) of distributions indexed by the scalar parameter r,
where Qηr is normal with mean rη(x). We construct a marginal response by differentiating
with respect to r:
                          Z                                           Z
                     d
                              Φ(t, x, w)Qηr (dw|x)         = η(x) ·       Φ(t, x, w)wQ(dw).                 (7)
                     dr                              r=0


which is linear in the direction η(x).
   With any of these approaches, by freely altering φ, we trace out distributional responses
of Yt to a change in the distribution of the shock ∆Wτ , which is consistent with suggestions
in Gourieroux and Jasiak (2005).3 Our interest lies in the continuous-time formulation. We
show that in this case, the three constructed responses (5)–(7) coincide.


4       Shock elasticities in discrete time
In understanding how economic models assign values to exposures to uncertainty, we con-
struct elasticities to changes in shock exposures. While modeling stochastic growth in terms
of logarithms of economic time series is common and convenient, our interest is in asset
valuation, and this leads us to an alternative but related formulation. Let G be a stochastic
growth process typically representing a cash flow to be priced and S a stochastic discount
factor process. We construct log G and log S in the same manner as our generic construc-
tion of the additive functional Y described previously in equation (2). The processes G and
S are referred to as multiplicative as they are exponentials of additive functionals. They
model stochastic compounding in growth and discounting in ways that are mathematically
convenient. They have a common mathematical structure as does their product.
   We consider both shock-exposure elasticities and shock-price elasticities. These measure
the consequences of changing the exposure to a shock on hypothetical asset payoffs and
prices over alternative investment horizons. As we will see, these shock elasticities resemble
closely impulse response functions, but they are different in substantively important ways.
    3
     Gourieroux and Jasiak (2005) propose a formula similar to (5) and suggest other impulses than mean
shifts, including changes in the volatility of the initial-period shock. See their formula in the middle of page
11, and the second last paragraph of their section 3.2.




                                                           4
4.1    Changing the exposure
First, we explore the impact of changing the risk exposure by letting Y = log G and intro-
ducing the random variable
                                                           
                                                  1       2
                           Hτ = exp η(X0 ) · ∆Wτ − |η(X0)| .                              (8)
                                                  2

This random variable has conditional mean one conditioned on X0 . Note that
                                                                 
                                                        1       2
                     Gt Hτ = exp log Gt + η(X0 ) · ∆Wτ − |η(X0)| .
                                                        2

We thus use Hτ to increase the exposure of the stochastic growth process G to the next-
period shock ∆Wτ in the direction η (x). The direction vector is normalized to satisfy
           
E |η (X0 )|2 = 1.
   Our interest lies in comparing expected cash flows for cash flow processes with different
exposures to risk. Motivated by the construction of elasticities, we focus on the proportional
impact of changing the exposure expressed in terms of the ratio

                                      E [Gt Hτ | X0 = x]
                                       E [Gt | X0 = x]

or expressed as the difference in logarithms

                        log E [Gt Hτ | X0 = x] − log E [Gt | X0 = x] .

   For a marginal counterpart of this expression, we localize the change in exposure by
considering a family of random variables parameterized by a ‘perturbation’ parameter r:
                                                                
                                                    1 2        2
                        Hτ (r) = exp rη(X0 ) · ∆Wτ − r |η(X0 )| .                         (9)
                                                    2

Following Borovička and Hansen (2013) we construct the derivative

                d                                                E [Gt ∆Wτ | X0 = x]
                   log E [Gt Hτ (r) | X0 = x]         = η(x) ·
                dr                              r=0                E [Gt | X0 = x]

that represents the proportional change in the expected cash flow to a marginal increase in
the exposure to the shock ∆Wτ in the direction η (x). This leads us to label this derivative
a shock-exposure elasticity for the cash flow process G. This elasticity depends both on the
maturity of the cash flow t as well as on the current state X0 = x.


                                                 5
4.1.1   A change of measure interpretation

The construction of the shock-exposure elasticity has a natural interpretation as a change of
measure that provides a close link to the impulse response functions that we delineated in
Section 3. Multiplication of the stochastic growth process G by the positive random variable
Hτ constructed in (8) prior to taking expectations is equivalent to changing the distribution
of ∆Wτ from a normal Q with mean zero and covariance τ I to a normal Qη with mean η(x)
and covariance τ I. As a consequence,
                              Z
   E [Gt Hτ |X0 = x] =            Φgh (t, x, w)Q(dw) =                                           (10)
                                                                         Z
                         = E [E [Gt | ∆Wτ ; X0 = x] Hτ |X0 = x] =            Φg (t, x, w)Qη (dw|x)

where the function Φg is defined as in (4) with φ(Yt ) = exp(Yt ) = Gt . The first row in
expression (10) uses the baseline Q distribution for ∆Wτ . On the other hand, in the second
row of (10) we use the perturbed distribution Qη distribution as a computational device to
alter the risk exposure of the process G.
   Expression (10) relates the shock-exposure elasticity to the nonlinear impulse response
functions. We compute shock elasticities by altering the exposure of the stochastic growth
process G to the shock ∆Wτ , or, equivalently, by changing the distribution of this shock.
   Since we are interested in computing the effects of a marginal change in exposure, we
use the family Hτ (r) from equation (9) to define a family of measures Qηr as in (7). The
shock-exposure elasticity can then be computed as
                         Z                                    R
                d                                               Φg (t, x, w)wQ(dw)
                   log       Φg (t, x, w)Qηr (dw|x)   = η(x) · R                   .             (11)
                dr                                               Φg (t, x, w)Q(dw)

4.1.2   A special case

Linear vector-autoregressions (VARs) are models (3) with parameters that satisfy

                                    µ (x) = µ̄x           σ (x) = σ̄
                                    β (x) = β̄ · x        α (x) = ᾱ

X is a linear vector-autoregression with autoregression coefficient µ̄τ + I and shock exposure
matrix σ̄. Let η(x) = η̄ where η̄ is a vector with norm one. The (the scalar product is not
a vector) impulse response function of Yt where t = jτ for the linear combination of shocks




                                                      6
chosen by the vector η̄ is given by

                        E [Yt | X0 = x, ∆Wτ = η̄] − E [Yt | X0 = x] = κ̄j · η̄.          (12)

where

                                        κ̄j+1 = κ̄j + τ β̄ ζ̄j
                                        ζ̄j+1 = (I + τ µ̄) ζ̄j

with initial conditions ζ̄1 = σ̄ and κ̄1 = ᾱ. Thus

                               ζ̄j = (I + τ µ̄)j−1 σ̄
                                               h               i ′
                               κ̄j = ᾱ + µ̄−1 (I + τ µ̄)j−1 − I σ̄ β̄

The first term, ᾱ · η̄, represents the “instantaneous” impact arising from the current shock,
while the second term captures the subsequent propagation of the shock through the dy-
namics of the model.
   Now consider the shock elasticity for the multiplicative functional G = exp(Y ). Using
the formula for the expectation of a lognormal random variable, we have
                                                                       
                               Φg (t, x, w)            1      2
                            R                   = exp − |κ̄j | + κ̄j · w .
                              Φg (t, x, v)Q(dv)        2

Using formula (11), we obtain the shock-exposure elasticity for G:
                        Z                                      
                              w        1      2               1 ′
                 η̄ ·       √     exp − |κ̄j | + κ̄j · w exp − w w = η̄ · κ̄j
                              2πn      2                      2

Thus for a linear model, our shock-exposure elasticity for G coincides with the linear im-
pulse response function for Y = log G, with the direction vector η̄ selecting a particular
combination of shocks in ∆Wτ .


4.2     Pricing the exposure
Given our interest in pricing we are led to the study of the sensitivity of expected returns
to shocks. We will utilize the family of cash flows Gt Hτ (r) indexed by the perturbation
parameter r and construct a local measure of this sensitivity as the pricing counterpart of
the shock-exposure elasticity (11).
   A stochastic discount factor S is a stochastic process that represents the valuation of


                                                   7
payoffs across states and time. Therefore, the value at time zero of a cash flow Gt Hτ (r) ma-
turing at time t (or cost of purchasing an asset with such a payoff) is E [St Gt Hτ (r) | X0 = x].
Since we assume that S and G are multiplicative functionals, so is their product SG.
   The logarithm of the expected return for the cash flow Gt Hτ (r) maturing at time t is

                      log E [Gt Hτ (r)|X0 = x] − log E [St Gt Hτ (r)|X0 = x] .
                         log expected payoff                           log cost

Since both components of the expected return are distorted by the same random variable
Hτ (r), we can write the (log) expected return on cash flow Gt Hτ (r) as
                         Z                                    Z
                   log       Φg (t, x, w)Qηr (dw|x)   − log       Φsg (t, x, w)Qηr (dw|x).

We localize the change in exposure by computing the derivative of this expression with
respect to r and evaluating this derivative at r = 0. This calculation yields the discrete-time
shock-price elasticity
                       R                            R
                         Φg (t, x, w)wQ(dw)           Φsg (t, x, w)wQ(dw)
                 η(x) · R                   − η(x) · R                    .                  (13)
                          Φg (t, x, w)Q(dw)            Φsg (t, x, w)Q(dw)

   The shock-price elasticity is the difference between a shock-exposure elasticity and a
shock-cost elasticity. Locally, the impulse response for both components of the shock-price
elasticity is given by the covariance of the impulse response Φ with the shock ∆Wτ . In
what follows we will show how a continuous-time formulation gives us an alternative way to
localize shock exposures in a convenient way.
    The shock-price elasticity for the one-period horizon has particularly simple representa-
tion and is given by:

                    η(x) · αg (x) − η(x) · [αg (x) + αs (x)] = η(x) · [−αs (x)]

In this formula the entries of −αs (x) give the vector of “prices” assigned to exposures of
each of the entries of ∆Wτ . These entries are often referred to as the (local) price of risk.
Our shock-price elasticity function captures the term structure of the price of risk, in the
same was as an impulse response function captures the dynamic adjustment of an economy
over time in response to a shock.
   In the special case of a log normal model discussed in Section 4.1.2, we can construct a
model of the stochastic discount factor S = exp(Y ). In this case, the linearity of the results
implies that the shock-price elasticity (13) will correspond to the impulse response function


                                                       8
for − log S.


5       Returning to continuous time
By taking continuous-time limits, we achieve some simplicity given the Brownian motion
information structure. In this section, we proceed informally to provide economic intuition.
A more formal treatment follows in Section 6.
    Given a Markov diffusion X such as (1), the Malliavin derivative D0 Xt allows us to
examine the contribution of a shock dW0 to the value of that diffusion at time t > 0. We
calculate the Malliavin derivative recursively by computing what is called the first variation
process associated to the diffusion.4 The first variation process for X is an n × n-dimensional
process Z x that solves a linear stochastic differential equation obtained by differentiating the
coefficients:                                   Xk                  
                                ∂                       ∂
                      dZtx   =             x
                                   µ(Xt ) Zt dt +           [σ (Xt )]·i Ztx dWi,t                         (14)
                               ∂x′                i=1
                                                       ∂x ′


where [σ (x)]·i is the i-th column of σ (x) and Wi is the i-th component of the Brownian
motion. The initial condition for the first variation process is Z0X = In . Further,

                                             D0 Xt = Ztx σ (x) ,

where X0 = x is the initial condition. This result is a reflection of the linearity of the
differential equation (14) and captures the scaling of the “initial response” of X to the shock
dW0 by the instantaneous volatility σ (x).
    The construction of the Malliavin derivative can be extended to the additive functional
Y . Since (X, Y ) form a Markov diffusion, and the coefficients in this Markov diffusion are
independent of Y , we obtain a 1 × n process Z y that satisfies:
                                                 Xk             
                                 ∂                       ∂
                       dZty   =             x
                                    β(Xt ) Zt dt +          α (Xt ) Ztx dWi,t
                                                           ′ i
                                                                                                          (15)
                                ∂x′                i=1
                                                        ∂x

with initial condition Z0y = 01×n . Consequently, the Malliavin derivative of Y is an 1 × n
vector given by
                                         D0 Yt = Zty σ (x) + α (x)′

where α (x) represents the initial contribution of the shock η(x) · dW0 to Yt and Zty σ (x) η(x)
    4
    See e.g. Property P2 on page 395 of Fournié et al. (1999). Fournié et al. (1999) assume that the diffusion
coefficients have bounded derivatives, which is not verified in this example. A precise justification would
require extending their theorem to our setup.


                                                       9
captures the propagation of the shock through the dynamics of the state vector X.
   When conditional mean coefficients (µ, β) are linear in state vector, and the exposure
coefficients (σ, α) on the Brownian increment are constant and the η vector is constant, the
Malliavin derivatives only depend on the date zero state and not on the Brownian increments
that follow. In this case the Malliavin derivative calculations will yield the continuous time
counterpart to the calculations in Section 4.1.2. More generally, the Malliavin derivatives
depend on the Brownian increments. We could compute the “average” responses using

                              Φy (t, x) = η(x) · E [D0 Yt | X0 = x]

for t ≥ 0 which still depends on the initial state x but not on the Brownian increments.
    We have featured η as a device for selecting which (conditional) linear combination of
increments to target for the response function Φy . In fact, Malliavin derivatives are typically
computed by introducing drift distortions for the Brownian increment vector dW0 . Thus an
equivalent interpretation of the role of η in computation of Φy is that of a date zero drift
distortion, the counterpart to the mean shift for a normally distributed random vector that
we used in our discrete-time constructions.
    Since we are interested in the process M = exp(Y ), averaging the random responses of
log M will not be of direct interest in our analysis of elasticities. This leads us to modify our
calculation of average responses.
    The Malliavin derivative of the function of a process Ut = φ(Yt ) is well defined provided
the function φ is sufficiently regular. In this case we may use a “chain-rule”,

                                           Du Ut = φ′ (Yt )Du Yt .

The function φ = exp is of particular interest to us since M = exp(Y ). For the shock
η(x) · dW0 ,
                                D0 Mt η(x) = exp(Yt )D0 Yt η(x)

gives the date t distributional response of Mt to the date zero shock η(x) · dW0 .
    Next we construct a nonlinear counterpart to a moving-average representation, which for a
continuous-time diffusion is the Haussmann–Clark–Ocone representation. The Haussmann–
Clark–Ocone representation uses Malliavin derivatives to produce a “moving-average” rep-
resentation of M with state-dependent coefficients and typically expressed as:
                                  Z    t
                           Mt =            E [Du Mt | Fu ] · dWu + E[Mt ].                  (16)
                                   0




                                                     10
Many of the random variables we consider depend on X0 = x along with the Brownian
motion W , including random variables on both sides of (16). We hold X0 = x fixed for the
calculation of the Malliavin derivatives, and rewrite equation (16) as:
                            Z       t
                     Mt =               E [Du Mt | Fu , X0 = x] · dWu + E[Mt | X0 = x].                 (17)
                                0


The notation E[ · | X0 = x] should remind readers that the computation of the expectation
over the function of the Brownian motion depends on the choice of initial conditions.
   This convenient result represents Mt as a response to shocks with “random coefficients”
E [Du Mt | Fu , X0 = x] that are adapted to Fu whereas in linear time series analysis these
coefficients are constant. With representation (17), a continuous-time analogue to the im-
pulse response functions computed in Section 3 measures the impact on φ(Yt ) of a “shock”
dW0 :
                            Φm (t, x) = η(x) · E [exp(Yt )D0 Yt | X0 = x] ,                             (18)

for t ≥ 0. The term D0 Yt can be computed using the recursive calculations outlined above.
The weighting by the nonstationary process M = exp(Y ) may be important, because M
grows or decays stochastically over time.
   Next we consider shock elasticities in continuous time. In this paper we build these
elasticities in a way that is consistent with those given in Borovička et al. (2011), but we
derive them in a more direct way.5 In Section 6 we will show that the elasticities of interest
can be expressed as
                                                     E [exp(Yt )D0 Yt | X0 = x]
                                ε(t, x) = η(x) ·                                                        (19)
                                                       E [exp(Yt ) | X0 = x)
where Y = log G in the case of an shock exposure elasticity and Y = log S + log G in the
case of a cost elasticity. The numerator is the same as the impulse response for exp(Yt )
given in (18). Consistent with our interest in elasticities, we divide by the conditional
expectation of exp(Yt ). In accordance with this representation, the elasticities we justify are
weighted averages of the impulse responses for Y weighted by exp(Y ). Asymptotic results
for t → ∞ can be obtained using a martingale decomposition of the multiplicative functional
M analyzed in Hansen and Scheinkman (2009).
       A shock price elasticity is given by the difference between an exposure elasticity and a
   5
    Borovička et al. (2011) consider responses over finite investment intervals and introduce a separate
parameter that localizes the risk exposure. Similarly, Borovička and Hansen (2013) use a discrete time
economic environment and again introduce a parameter that localizes the risk. Here we avoid introducing an
additional parameter by letting the continuous-time approximation localize the risk exposure over arbitrarily
short time intervals. In Section 8 we elaborate on the connection between calculation in this paper and our
previous work Borovička et al. (2011).



                                                         11
cost elasticity:

             E [Gt (D0 log Gt ) | X0 = x]          E [St Gt (D0 log St + D0 log Gt ) | X0 = x]
    η(x) ·                                − η(x) ·                                                   (20)
                   E [Gt | X0 = x]                             E [St Gt | X0 = x]

In a globally log-normal model D0 log Gt and D0 log St depend on t but are not random,
and the weighting by either Gt or by St Gt is of no consequence. Moreover, in this case
the shock price elasticities can be computed directly from the impulse response function
for − log S to the underlying shocks since the expression in (20) is equal to −D0 log St . The
resulting elasticities are the continuous time limits of the results from the log-normal example
introduced in Section 4.1.2.
   Instead of computing directly the Malliavin derivatives, there is a second approach that
sometimes gives a tractable alternative to computing the coefficients of the Haussmann–
Clark–Ocone representation for M. This approach starts by computing E [Mt | X0 = x] and
then differentiating with respect to the state:

                                                ∂
                                      σ (x)′      E [Mt | X0 = x] .
                                               ∂x

The premultiplication by σ (x)′ acts as a measure of the local response of X to a shock. As
in Borovička et al. (2011) expression (19) can be written as6
                                                                             
                                                      ′ ∂
                       ε(t, x) = η(x) · α (x) + σ (x)      log E [Mt | X0 = x] .                     (21)
                                                        ∂x

This result separates the ‘instantaneous’ effect of the change in exposure, α (x), from the
impact that propagates through the nonlinear dynamics of the model, expressed by the
second term in the bracket. In case of the shock-price elasticity, α (x) corresponds to the
local price of risk.


6       Formal construction of shock elasticities
To construct the elasticities that interest us, we “perturb” the cash flows in alternative ways.
Let N τ be                                       Z       τ ∧t
                                       Ntτ   =                  η(Xu ) · dWu .
                                                     0

We impose
                                                       
                                             E |η(X0 )|2 = 1
    6
    For example see the formulas (5) and (6) and the discussion in Section 4 provided in Borovička et al.
(2011).

                                                            12
when X is stationary and X0 is initialized at the stationary distribution. While the finite
second moment condition is a restriction, our choice of unity is made as a convenient normal-
ization. We impose this second moment restriction to insure that N τ has a finite variance
τ for t ≥ τ . We use the vector η to select alternative risk exposures. Let E(N τ ) denote the
stochastic exponential of N τ :
                                                           
                                                  1 τ τ
                  Htτ                 τ        τ
                        = Et (N ) = exp Nt − [N , N ]t =
                                                  2
                               Z τ ∧t                 Z                
                                                      1 τ ∧t         2
                        = exp          η(Xu ) · dWu −        |η(Xu )| du .
                                 0                    2 0

Our assumption that X is stationary with a finite second moment guarantees that the process
H τ as constructed is a local martingale. We will in fact assume that the stochastic exponen-
tials of the perturbations N τ are martingales. This normalization will be of no consequence
for our shock price elasticity calculations, but it is a natural scaling in any event.
    Form the perturbed payoff GH τ . This payoff changes the exposure of the payoff G by
altering the shock exposure of log Gt to be
                             Z    t                      Z   τ
                                      αg (Xu ) · dWu +           η(Xu ) · dWu
                              0                          0


for τ < t. This exposure change is small for small τ . Construct the logarithm of the expected
return:
              εp (τ, t, x) = log E [Gt Htτ |X0 = x] − log E [St Gt Htτ |X0 = x] .
                              log expected payoff             log cost
Note that
                              εp (τ, t, x) = εe (τ, t, x) − εc (τ, t, x)

where

                           εe (τ, t, x) = log E [Gt Htτ |X0 = x]
                           εc (τ, t, x) = log E [Gt St Htτ |X0 = x] .

We will calculate derivatives of εe and εc to compute a shock price elasticity. The first of
these derivatives is a shock exposure elasticity.
   We use H τ to change the exposure to uncertainty. Since H τ is a positive martingale with
a unit expectation, equivalently it can be used as a change in probability measure. Under
this interpretation, think of η(Xt ) as being a drift distortion of the Brownian motion W .



                                                   13
Then                                                 (
                                                                     ft 0 ≤ t ≤ τ
                                                         η(Xt )dt + dW
                                   dWt =
                                                                ft
                                                               dW         t>τ

where Wf is a Brownian motion under the change of measure. This gives an alternative
interpretation to our calculations and a formal link to Malliavin differentiation. Bismut
(1981) uses the change of measure to perform calculations typically associated with Malliavin
differentiation.
   It what follows we will shrink the interval τ to focus on the instantaneous change in
exposure, which we can think of equivalently as an instantaneous drift distortion in the
Brownian motion.


6.1     Haussmann–Clark–Ocone formula
To characterize the derivatives of interest, we apply the Haussmann–Clark–Ocone formula
(17) to M = G or M = SG and represent Mt as a stochastic integral against the underlying
Brownian motion. The vector of state dependent impulse response functions for Mt for the
date zero Brownian increment is E [D0 Mt |X0 = x] when viewed as a function of t. This
averages over the random impacts in the future but still depends on X0 = x.
   We will also use the following result that is a consequence of Proposition 5.6 in Øksendal
(1997):


                      Du E (Mt |Fτ , X0 = x) = E (Du Mt |Fτ , X0 = x) 1[0,τ ] (u).                      (22)


6.2     Computing shock elasticities
Fix X0 = x and τ ≤ t. The Haussmann–Clark–Ocone formula (17) implies that:
                                            Z t                                            
E [E(Mt |Fτ , X0 =    x)Htτ |X0              τ
                                   = x] = E Hτ   E (Du E(Mt |Fτ )|Fu , X0 = x) · dWu |X0 = x
                                                                 0
                                                         +E [Hττ E(E(Mt |Fτ )|X0 = x)|X0 = x] .

Hence, using equation (22),
                                        Z       τ                                       
  E   (Mt Htτ |X0   = x) = E       Hττ               E (Du Mt |Fu , X0 = x) · dWu |X0 = x + E (Mt |X0 = x)
                                             0




                                                               14
for t ≥ τ . Under the change of measure implied by H τ ,
                                         Z    τ                       
            E   (Mt Htτ |X0          e
                              = x) = E             Zu · η(Xu )du|X0 = x + E (Mt |X0 = x)
                                           0


      e is the expectation under the change in probability measure and
where E

                                   Zu = E (Du Mt |Fu , X0 = x) .

We compute the derivative with respect to τ at τ = 0 by evaluating:
        Z τ                                                Z τ                     
     1   τ                                                1e
lim E Hτ     E (Du Mt |Fu , X0 = x) · dWu |X0 = x = lim E         Zu · η(Xu )du|X0 = x
τ ↓0 τ     0                                         τ ↓0 τ    0
                                                   = Z0 · η(x)
                                                                     = E (D0 Mt |X0 = x) · η(x)
                                                                     = E [Mt (D0 log Mt ) |X0 = x] · η(x)

where the last line follows from the formula:

                                         D0 Mt = Mt D0 log Mt .

For globally log normal models D0 log Mt depends only on t and not on random outcomes,
but more generally D0 log Mt is random.
   Since our aim is to compute elasticities, the actual differentiation that interest us is the
derivative of the logarithm of the conditional expectation:
                                                                                
                                                   E [Mt (D0 log Mt ) |X0 = x]
                        εm (t, x) = η(x) ·                                           .
                                                         E [Mt |X0 = x]

Thus the elasticities are weighted averages of D0 log Mt weighted by Mt .

Remark 6.1. While our focus has been on shock elasticities and impulse response functions,
there is also a nice connection to a temporal dependence measure suggested by Wu (2005).
His predictive dependence measure is based on the expected consequences of changing shock
distributions through a coupling. His measure is constructed in discrete time, but the L2
version of the continuous-time analog for the stochastic formulation we use is
                                                   p
                                    ω(τ ) =            2E [|D0 log Mt |2 ].                           (23)

It is perhaps best to think of Wu (2005)’s analysis as directly applying to the X process. But


                                                         15
his aim is to use these measures to study when central limit approximations are appropriate.
In fact the additive functional log M will often obey a Central Limit Theorem and the finite
limiting behavior of ω(τ ) as τ → ∞ in (23) suggests that standard martingale approximation
methods are applicable.


7     Example: Persistent components in consumption dy-
      namics
We illustrate the construction of shock elasticities using an example featured in Borovička
et al. (2011). We outline two calculations. First, we utilize the construction of the Malliavin
derivative D0 Mt for the multiplicative functionals of interest using the recursive calculations
outlined in Section 5. Then we show how to compute the shock elasticities using semi-
analytical formulas for the conditional expectations of the multiplicative functional.
                                                                           
   We assume the date t state vector takes the form Xt′ = X1,t     ′
                                                                     , X2,t where X1,t is an
n-dimensional state vector and X2,t is a scalar. The dynamics of X in (1) are specified by

                                                                      √
                              µ (x) = µ̄(x − ι)           σ(x) =          x2 σ̄

where                                "               #            "         #
                                         µ̄11 µ̄12                    σ̄1
                              µ̄ =                         σ̄ =                 ,           (24)
                                          0 µ̄22                      σ̄2
µ̄11 and µ̄12 are n × n and n × 1 matrices, µ̄22 a scalar, and σ̄1 and σ̄2 are n × k and
1 × k matrices, respectively. In this model, X1,t represents predictable components in the
growth rate of the multiplicative functional, and X2,t captures the contribution of stochastic
volatility. The vector ι is specified to be the vector of means in a stationary distribution. We
set the mean of X2 to be one in our calculations. The parameters of the additive functional
Y in (2) are:
                                                                 √
                           β(x) = β̄0 + β̄1 · (x − ι)    α(x) = x2 ᾱ,                       (25)

In the illustrative economic models, the parameters (αc , βc ) governing the evolution of the
logarithm of consumption log C and (αs , βs ) governing the evolution of the logarithm of the
stochastic discount factor log S have the functional form of (α, β) specified for Y above. We
                                                      √
choose the shock selection vector η(x) to be η(x) = x2 η̄. The vector η̄ has unit norm, and
for instance can be a coordinate vector.




                                                     16
7.1     Construction of shock elasticities
The recursive construction of the Malliavin derivative applies formulas (14)–(15):

                                                   1
                             dZtx = µ̄Ztx dt + p        (σ̄dWt ) Z2,tx
                                                 2 X2,t
                                                    1
                             dZty = β̄1′ Ztx dt + p        x
                                                         Z2,t (ᾱ · dWt ) .
                                                  2 X2,t

                                                                           x
Recall that X2,t is the last entry of Xt . Accordingly, the row vector Z2,t  is the last row of
                                                                         y
the first variation matrix Ztx . The initial conditions are Z0x = I and Z0 = 0. The Malliavin
derivatives for each t ≥ 0 is the 1 × k vector:

                                                   √
                                        D0 Y t =       x2 (Zty σ̄ + ᾱ′ ) .

   In the state dynamics, the X2 process does not feedback onto the X1 process. The
stochastic differential equation for the X2 process can thus be solved without simultaneously
solving for the X1 process. It follows from this “triangular” structure that the first n elements
                 x
of the vectors Z2,t and Zty are zero. Consequently, the first n elements of the first variation
process Z y are deterministic functions of time. In contrast to a log-linear environment,
the last columns of processes Z x and Z y used to construct the Malliavin derivatives now
depend on the Brownian motion because of the role of the stochastic volatility in the state
dynamics. One strategy for computation is to simulate simultaneously (X, Y, Z x , Z y ) and to
approximate conditional expectations using Monte Carlo techniques.7
   For this parameterization the other approach mentioned in Section 5 is tractable because
we know the functional form for E [Mt | X0 = x] in formula (21). Results from Duffie and
Kan (1994) and Hansen (2012) show that under appropriate parametric restrictions

                         log E [Mt | X0 = x] = θ0 (t) + θ1 (t) · x1 + θ2 (t) x2                       (26)

where the coefficients θi (t) satisfy a set of ordinary differential equations given in Ap-
pendix A. Given this formula, we may directly compute the coefficients for the Haussman–
Clark–Ocone representation, and thus

                                                                                 √
                           ε (x, t) = η (x) · [σ̄1′ θ1 (t) + σ̄2′ θ2 (t) + ᾱ]       x2 .             (27)
   7
    For longer investment horizons, it would likely be beneficial to change probability measures using, for
instance, the martingale featured in Hansen and Scheinkman (2009). Such an approach could better center
the simulations. It could build on method for rare event simulation, which could be valuable here because
the M process grows or decays asymptotically at an exponential rate.



                                                        17
7.2     Comparing two example economies
We compare two specifications of investors’ preferences. The first specification (BL) endows
the representative investor with time-separable, constant relative risk aversion utility as in
Breeden (1979) and Lucas (1978). The stochastic discount factor for the investor is given by

               d log St = −δdt − γd log Ct = − [δ + γβc (Xt )] dt − γαc (Xt ) · dWt                (28)

where δ is the time-preference coefficient and γ is the risk aversion parameter. The stochas-
tic discount factor is thus a multiplicative functional with parameters βsBL (x) and αsBL (x)
specified in (25)
    The second model of investors’ preferences (EZ) is the recursive utility specification of
the Kreps and Porteus (1978) and Epstein and Zin (1989) type, analyzed in continuous time
by Duffie and Epstein (1992). These preferences allow the separation of risk aversion to
intratemporal bets from intertemporal elasticity of substitution (IES). We will focus on the
special case of unitary IES as this case allows us to derive semi-analytical solutions.8 In this
case,
             d log St = −δdt − d log Ct + d log Set = βsEZ (Xt ) dt + αsEZ (Xt ) · dWt     (29)

where Se is a multiplicative martingale satisfying

                          dSet p
                              = X2,t (1 − γ) (ᾱc + σ̄1′ v̄1 + σ̄2′ v̄2 ) · dWt
                           e
                          St

with coefficients v̄1 , v̄2 derived in Appendix A. This martingale is the additional contribution
coming from the continuation value for recursive utility. Equivalently, it can be interpreted
as a change of measure and can be motivated as a robustness adjustment for model mis-
specification as suggested by Anderson et al. (2003). Under plausible parameterizations, the
Brownian motion W has a negative drift under the change of measure, reflecting the risk
adjustment arising from recursive-utility or a concern for model misspecification.
    A similar specification of the consumption dynamics coupled with the recursive preference
structure was utilized by Bansal and Yaron (2004), Hansen et al. (2008) and others to
generate large and volatile prices of risk. We adopt the parameterization from Hansen
et al. (2007) used in Borovička et al. (2011) and summarized in the caption of Figure 1.
The stationary distribution for the process X2 is a gamma distribution, which allows us to
compute quartiles for shock elasticities (27) in a semi-analytical form.
   8
     Numerical calculations confirm that for this endowment economy, the shock elasticities are not very
sensitive to the choice of the IES parameter.



                                                   18
               Consumption exposure elasticity                             Consumption price elasticity
0.08                                                             0.4

0.06                                                             0.3

0.04                                                             0.2

0.02                                                             0.1                                  BL model
                                                                                                      EZ model
   0                                                              0
       0                  50             100         150               0        50              100              150

                   Growth-rate exposure elasticity                         Growth-rate price elasticity
0.08                                                             0.8

0.06                                                             0.6

0.04                                                             0.4

0.02                                                             0.2

   0                                                              0
       0                  50             100         150               0        50              100              150

              -3
       × 10         Volatility exposure elasticity                           Volatility price elasticity
   0                                                             0.2

-0.5                                                            0.15

  -1                                                             0.1

-1.5                                                            0.05

  -2                                                              0
       0                  50             100         150               0        50              100              150
                         maturity (quarters)                                   maturity (quarters)



Figure 1: Shock elasticities for the long-run risk model. Thick lines correspond to shock elas-
ticities conditional on X2,0 = 1, the shaded areas capture quartiles for the shock elasticities
under the stationary distribution of X2 . In the top right panel, the shock-price elasticities
for the BL and EZ models coincide. Parameters are calibrated to monthly frequency, and
the elasticities are annualized. The parameterization is β̄c,0 = 0.0015, β̄c,1 = 1, β̄c,2 = 0,
µ̄11 = −0.021, µ̄12 = µ̄21 = 0, µ̄22 = −0.013, ᾱc = [0.0078 0 0]′ , σ̄1 = [0 0.00034 0],
σ̄2 = [0 0 − 0.038], ι1 = 0, ι2 = 1, δ = 0.002, γ = 10.




                                                           19
   Figure 1 plots the shock-exposure elasticity functions for the consumption process C
and shock-price elasticity functions for the same process in the BL and EZ models.9 We
parameterize the vectors σ̄1 , σ̄2 and ᾱc as orthogonal, so that each component of the Brownian
motion W corresponds to an orthogonal shock to the processes X1 , X2 and C, respectively.
  The zero-horizon limits of the shock elasticity functions correspond to what is known as
infinitesimal exposures and infinitesimal prices of risk. The shock-exposure elasticities are
equal to zero at t = 0 except for the consumption exposure elasticity because shocks to the
growth rate and volatility processes impact the consumption process only indirectly, through
changes in the levels of the processes X1 and X2 . While a current shock to the processes X1
or X2 will have a persistent effect on these processes which will accumulate to a nontrivial
impact on the future values of the consumption process C, the infinitesimal contribution to
C is zero.
   The same logic applies to the shock-price elasticities for the BL model, since the stochastic
discount factor (28) for this model merely scales the consumption process by the negative
of the risk aversion, −γ, and the investor thus only fears risk embedded in the consumption
process that is contemporaneous with the maturity of the cash flow. On the other hand,
the EZ model leads to nonzero shock-price elasticities even at the zero horizon. When
an investor endowed with EZ preferences evaluates the risk embedded in the consumption
process, he also fears the impact of the current shock on the consumption process beyond her
investment horizon. The recursive nonseparable preference structure (29) of the EZ model,
explained in detail in Appendix A, leads to a compensation for risk over an infinitesimal
horizon induced by fluctuations in future consumption realizations. The growth-rate and
volatility shocks thus generate nonzero infinitesimal price elasticities through their impact
on future consumption levels.
   The consumption exposure elasticity measures the sensitivity of expected consumption
to a direct shock to the consumption process. The elasticity function is flat, reflecting the
fact that ᾱc · dWt is an iid growth shock to the consumption process. The shaded area
represents the quartiles of the stationary distribution of the elasticity function, and captures
the dependence of the magnitude of the response on the current volatility level x2 .
   On the other hand, the growth-rate exposure elasticity, which represents the shock to the
process X1 , builds up over time, as the perturbation of the persistent growth rate accumulates
in the level of the consumption process. For the volatility exposure elasticity, the negative
   9
     The shock-price elasticity for this parameterization of the consumption dynamics ceases to exist for long
investment horizons for risk aversion coefficients γ > γ̄ BL ∼ 20 in the BL model due to the non-existence
of the conditional expectation E[St Ct | X0 = x]. Similarly, the shock-price elasticity function does not exist
in the EZ model for γ > γ̄ EZ ∼ 24 due to the non-existence of the continuation value for the recursive
preference structure. For details, see Appendix A.



                                                      20
coefficient in σ̄2 implies that a positive shock reduces the volatility of the consumption proces
and, because of Jensen inequality, decreases the expected level of future consumption.
   The right column in Figure 1 displays the shock-price elasticity functions for the BL and
EZ models. As explained before, the shock-price elasticities for the BL model approximately
correspond to the shock-exposure elasticities for the consumption process scaled by the risk
aversion coefficient γ. Moreover, the consumption price elasticities coincide for the BL and
EZ models. Consequently, the differences in asset pricing implications of the two models
must arise from exposure to the growth-rate and volatility shocks, which have predictable
components. The nonseparability in the EZ preference specification is inconsequential for
iid growth rate shocks.
    The EZ model produces shock-price elasticity functions that are roughly flat and converge
to long-term limits that are lower than those for the BL model with the same value of the risk
aversion parameter. The flatness is caused by the fact that the martingale component (29)
in the EZ stochastic discount factor is the dominant source of its volatility. The long-horizon
shock elasticities in the two models coincide in the limit as the time preference coefficient δ
declines to zero. In the EZ model, the volatility of the stochastic discount factor depends on
the magnitude of the continuation values, and a decline in time discounting magnifies these
continuation values, so that shock-price elasticities increase.


8     Implications for changes over finite horizons
Our earlier work, Hansen (2012) and Hansen and Scheinkman (2012), took a different limit.
We considered “small” exposures over an entire interval. We investigate again this formula-
tion and study the relationship between these approaches.
    Consider                             Z             τ ∧t
                                   Ntτ   (r) = r              η(Xu ) · dWu
                                                   0

and the stochastic exponential:

                                         Htτ (r) = Et (N τ (r)) .

This is a generalization of the perturbation Htτ introduced in Section 6. The scalar r param-
eterizes the magnitude of the exposure. For t ≥ τ write heuristically,
                                              Z              τ                                        
                                                                                  dHuτ (r)
              E   (Mt Htτ   (r) | X0 = x) = E Mt                  Huτ   (r)                      | X0 = x .
                                                          0                       Huτ (r)



                                                       21
Apply Law of Iterated Expectations and first compute
                                τ
                                                                             
                      1       Mt Hu+v (r)           τ               τ
                 lim       E              | Xu Mu Hu (r) − E [Mt Hu (r) | Xu ] =                        (30)
                  v↓0 v       Mu Huτ (r)
                                                  = rεm (t − u, Xu )E [Mt | Fu ] Huτ (r) .

Thus                                            Z       τ                                         
             E   (Mt Htτ   (r) X0 = x) = rE Mt               εm (t −   u, Xu )Huτ   (r) du | X0 = x .   (31)
                                                     0

    Instead of localizing τ , Hansen and Scheinkman (2012) differentiate the logarithm of the
expression on the right-hand side with respect to r and evaluate the derivative at r = 0. This
results in:                       Rτ                           
                               E Mt 0 εm (t − u, Xu )du | X0 = x
                                        E [Mt | X0 = x]
consistent with the formula given in Borovička et al. (2011). The resulting shock price
elasticity is:
          Rτ                                     Rτ                             
        E Gt 0 εg (t − u, Xu )du | X0 = x    E St Gt 0 εs+g (t − u, Xu )du | X0 = x
                                           −                                         .
                E [Gt | X0 = x]                        E [St Gt | X0 = x]

Thus we have shown that the implied interval τ elasticity is constructed from weighted
averages of integrals of the continuous-time elasticities when we localize the risk over this
interval by making r small.


9      Conclusion
Impulse response functions are commonly used in economic dynamics. They measure the
impact of shocks on endogenously determined and exogenously specified processes in a dy-
namical system. We study continuous-time, nonlinear counterparts by building on the state-
dependent moving average representations implied by the Haussmann–Clark–Ocone formula.
   Structural models of macroeconomics typically include a stochastic discount factor pro-
cess used to representation asset valuation. In this paper we studied pricing counterparts to
impulse response functions. We call these counterparts shock elasticities. Exposure elastic-
ities measure how responsive future expected cash flows are to shocks and price elasticities
measure how responsive expected returns are to shocks. The shock elasticities reveal impli-
cations of stochastic equilibrium models for asset valuation. They inform us which shocks
command the largest shock prices at alternative investment horizons.
    By imposing a continuous-time Brownian information structure, we localize exposures


                                                     22
and establish connections between impulse response functions and shock elasticities. It is of
interest to explore information structures that accommodate a more general class of Lévy
processes. In previous work, Borovička et al. (2011), we have initiated this analysis for
special cases of jump processes. In defining elasticities we may need to adopt convenient
ways to normalize the quantity of risk other than using the standard deviation.




                                             23
Appendix
A     Derivations for the model with predictable consumption dy-
      namics

A.1    Model with persistent components in consumption dynamics
To derive the recursion for the parameters in the conditional expectation (26), guess a solution

                           E [Mt | X0 = x] = exp [θ0 (t) + θ1 (t) · x1 + θ2 (t)x2 ]

To derive equations of interest, differentiating the right-hand side with respect to time should agree
with the infinitesimal generator applied to the conditional expect ion on the left-hand side viewed
as a function of x. This relationship implies the following set of ordinary differential equations,
each with initial condition θi (0) = 0:

             d
                θ1 (t) = β̄1 + (µ̄11 )′ θ1 (t)                                                           (32)
             dt
             d                                                1                               2
                θ2 (t) = β̄2 + (µ̄12 )′ θ1 (t) + µ̄22 θ2 (t) + ᾱ′ + θ1 (t)′ σ̄1 + θ2 (t)σ̄2
             dt                                               2
             d                                                                                   
                θ0 (t) = β̄0 − (ι1 )′ β̄1 + (µ̄11 )′ θ1 (t) − ι2 β̄2 + (µ̄12 )′ θ1 (t) + µ̄22 θ2 (t) .
             dt

    For the case when X1 is scalar, we have

                                                       β̄1 µ̄11 t   
                                           θ1 (t) =        e      −1 .
                                                      µ̄11

Given the solution for θ1 (t), the ODE for θ2 (t) is a Riccati equation

                               d
                                  θ2 (t) = q0 (t) + q1 (t) θ2 (t) + q2 (t) [θ2 (t)]2
                               dt

for known parameter functions q0 , q1 and q2 . Substituting

                                                           1       d
                                         θ2 (t) = −                   u (t)
                                                      q2 (t) u (t) dt

yields a second-order linear differential equation

                                      d2                 d
                                0=       2
                                           u (t) + R1 (t) u (t) + R0 (t) u (t)                           (33)
                                      dt                 dt




                                                        24
with
                                                      
                      R1 (t) = −µ̄22 − ᾱ′ + θ1 (t) σ1 σ2′
                                                                          
                               1      2                    1 ′           2
                      R0 (t) =   |σ2 | β2 + µ̄12 θ1 (t) + ᾱ + θ1 (t) σ1
                               2                           2

While this equation does not have a closed form solution, the coefficients R1 (t) and R0 (t) converge
to constants R1∞ and R0∞ , respectively, as t → ∞, because θ1 (t) → −β̄1 /µ̄11 . We can therefore
characterize the asymptotic behavior of the differential equation (33). The characteristic equation
for the local behavior of this ODE as t → ∞ is

                                        0 = z 2 + R1∞ z + R0∞ .

The solution to the conditional expectation E [Mt | X0 = x] will then exist only if there is a real
solution to this equation.


A.2      Value function for recursive utility
We choose a convenient choice for representing continuous values. Similar to the discussion in
Schroder and Skiadas (1999), we use the counterpart to discounted expected logarithmic utility.

                                      dVt = µv,t dt + σv,t · dWt

The local evolution satisfies:

                                                           1−γ
                                 µv,t = δVt − δ log Ct −       |σv,t |2                         (34)
                                                            2

When γ = 1 this collapses to the discounted expected utility recursion.
   Let
                                         Vt = log Ct + v(Xt )

and guess that
                                     v (x) = v̄0 + v̄1 · x1 + v̄2 x2

We may compute µv,t by applying the infinitesimal generator to log C + v(X). In addition,

                                                              ∂
                                 σv,t = αc (Xt ) + σ (Xt )′      v (Xt ) .
                                                              ∂x




                                                   25
    Substituting into (34) leads to a set of algebraic equations
                                                                                               
                        δv̄0 = β̄c,0 − (ι1 )′ β̄c,1 + µ̄11 v̄1 − ι2 β̄c,2 + µ̄12 v̄1 + µ̄22 v̄2
                        δv̄1 = β̄c,1 + µ̄′11 v̄1
                                                                     1                                     2
                        δv̄2 = β̄c,2 + µ̄′12 v̄1 + µ̄22 v̄2 +          (1 − γ) ᾱc + σ̄1′ v̄1 + σ̄2′ v̄2
                                                                     2

which can be solved for the coefficients v̄i . The third equation is a quadratic equation for v̄2 that
has a real solution if and only if
                              h                                 ′ i2
                    D =        µ̄22 − δ + (1 − γ) ᾱc + σ̄1′ v̄1 σ̄2′ −
                                                                                        
                                               2         ′         1             ′     2
                              −2 (1 − γ) |σ̄2 | βc,2 + µ12 v̄1 + (1 − γ) ᾱc + σ̄1 v̄1     ≥ 0.
                                                                   2

In particular, the solution will typically not exist for large values of γ. If the solution exists, it is
given by                                                                              √
                                          − µ̄22 − δ + (1 − γ) (ᾱc + σ̄1′ v̄1 )′ σ̄2′ ± D
                                  v̄2 =                                                                            (35)
                                                              (1 − γ) |σ̄2′ |2
We choose the solution with the minus sign and justify the choice in the next subsection.


A.3     Stochastic discount factor
The stochastic discount factor has two components. One that is the intertemporal marginal rate
of substitution for discounted log utility and the other is a martingale constructed from the con-
tinuation value
                                          d log St = − log δ − d log Ct + d log Set

where Se is a martingale given by
                    p                                         ′    1                                       2
      d log Set =       X2,t (1 − γ) ᾱc + σ̄1′ v̄1 + σ̄2′ v̄2 dWt − X2,t (1 − γ)2 ᾱc + σ̄1′ v̄1 + σ̄2′ v̄2 dt.
                                                                    2

This martingale can be interpreted as a change of measure. The time-0 price of a payoff Gt maturing
at timet t satisfies                                      "                      −1          #
                                                    e exp (−δt)              Ct
                                  E [St Gt | F0 ] = E                                   Gt | F0 .
                                                                             C0

                                       e there exists a standard Brownian motion W
Under the change of measure induced by S,                                        f such that

                                                   p                                         
                                   ft = dWt −
                                  dW                   X2,t (1 − γ) ᾱc + σ̄1′ v̄1 + σ̄2′ v̄2 dt




                                                                26
Substituting this relationship for the law of motion of X2 in (24) yields
                                                           
                                                     µ̄22              p
                            dX2,t = µ
                                    e22       X2,t −            dt +                 ft
                                                                           X2,t σ̄2 dW
                                                     µ
                                                     e22

where the mean-reversion coefficient satisfies
                                                                              √
                       e22 = µ̄22 + (1 − γ) σ̄2 ᾱc + σ̄1′ v̄1 + σ̄2′ v̄2 = δ ± D
                       µ

Therefore, the solution for v̄2 in equation (35) with the minus sign leads to µ
                                                                              e22 < 0, which implies
stable dynamics for X2 . Hansen and Scheinkman (2009) provide a rigorous general justification of
this choice.




                                                     27
References
Anderson, Evan W., Lars Peter Hansen, and Thomas J. Sargent. 2003. A Quartet of Semi-
 groups for Model Specification, Robustness, Prices of Risk, and Model Detection. Journal
 of the European Economic Association 1 (1):68–123.

Bansal, Ravi and Amir Yaron. 2004. Risks for the Long Run: A Potential Resolution of
  Asset Pricing Puzzles. Journal of Finance 59 (4):1481–1509.

Bismut, Jean-Michel. 1981. Martingales, the Malliavin Calculus and Hypoellipticity un-
  der General Hörmander’s Conditions. Zeitschrift für Wahrscheinlichkeitstheorie und ver-
  wandte Gebiete 56:469–505.

Borovička, Jaroslav and Lars Peter Hansen. 2013. Examining Macroeconomic Models
  through the Lens of Asset Pricing. Forthcoming in Journal of Econometrics.

Borovička, Jaroslav, Lars Peter Hansen, Mark Hendricks, and José A. Scheinkman. 2011.
  Risk Price Dynamics. Journal of Financial Econometrics 9:3–65.

Breeden, Douglas T. 1979. An Intertemporal Asset Pricing Model with Stochastic Consump-
  tion and Investment Opportunities. Journal of Financial Economics 7 (3):265–296.

Duffie, Darrell and Larry G. Epstein. 1992. Stochastic Differential Utility. Econometrica
  60 (2):353–394.

Duffie, Darrell and Rui Kan. 1994. Multi-Factor Term Structure Models. Philosophical
  Transactions: Physical Sciences and Engineering 347 (1684):577–586.

Epstein, Larry G. and Stanley E. Zin. 1989. Substitution, Risk Aversion, and the Temporal
  Behavior of Consumption and Asset Returns: A Theoretical Framework. Econometrica
  57 (4):937–969.

Fournié, Eric, Jean-Michel Lasry, Jérôme Lebuchoux, and Pierre-Louis Lions. 1999. Applica-
  tions of Malliavin Calculus to Monte-Carlo Methods in Finance. Finance and Stochastics
  3 (4):391–412.

Frisch, Ragar. 1933. Propagation Problems and Impulse Problems in Dynamic Economics.
  In Economic Essays in Honour of Gustav Cassel, 171–205. Allen and Unwin.

Gallant, A. Ronald, Peter E. Rossi, and George Tauchen. 1993. Nonlinear Dynamic Struc-
  tures. Econometrica 61 (4):871–907.


                                             28
Gourieroux, Christian and Joann Jasiak. 2005. Nonlinear Innovations and Impulse Responses
 with Application to VaR Sensitivity. Annales d’Économie et de Statistique 78:1–31.

Hansen, Lars Peter. 2012. Dynamic Valuation Decomposition within Stochastic Economies.
  Econometrica 911-967 (3). Fisher-Schultz Lecture at the European Meetings of the Econo-
  metric Society.

Hansen, Lars Peter and José Scheinkman. 2009. Long-Term Risk: An Operator Approach.
  Econometrica 77:117–234.

Hansen, Lars Peter and José A. Scheinkman. 2012. Pricing Growth-Rate Risk. Finance and
  Stochastics 16:1–15.

Hansen, Lars Peter, John C. Heaton, Junghoon Lee, and Nikolai Roussanov. 2007. Intertem-
  poral Substitution and Risk Aversion. In Handbook of Econometrics, vol 6A, edited by
  James J. Heckman and Edward E. Leamer. Amsterdam: North-Holland.

Hansen, Lars Peter, John C. Heaton, and Nan Li. 2008. Consumption Strikes Back?: Mea-
  suring Long-Run Risk. Journal of Political Economy 116:260–302.

Koop, Gary, M. Hashem Pesaran, and Simon M. Potter. 1996. Impulse Response Analysis
  in Nonlinear Multivariate Models. Journal of Econometrics 74 (1):119–147.

Kreps, David M. and Evan L. Porteus. 1978. Temporal Resolution of Uncertainty and
  Dynamic Choice Theory. Econometrica 46 (1):185–200.

Lucas, Jr., Robert E. 1978. Asset Prices in an Exchange Economy. Econometrica 46 (6):1429–
  1445.

Øksendal, Bernt. 1997. An Introduction to Malliavin Calculus with Applications to Eco-
 nomics.

Schroder, Mark and Costis Skiadas. 1999. Optimal Consumption and Portfolio Selection
  with Stochastic Differential Utility. Journal of Economic Theory 89 (1):68–126.

Wu, Wei Biao. 2005. Nonlinear System Theory: Another Look at Dependence. Proceedings of
  the National Academy of Sciences of the United States of America 102 (40):14150–14154.




                                           29
