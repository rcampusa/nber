                                NBER WORKING PAPER SERIES




                                      UNIVERSAL GRAVITY

                                            Treb Allen
                                          Costas Arkolakis
                                          Yuta Takahashi

                                        Working Paper 20787
                                http://www.nber.org/papers/w20787


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    December 2014




We thank Andy Atkeson, David Atkin, Lorenzo Caliendo, Arnaud Costinot, Jonathan Dingel, Dave
Donaldson, Pablo Fajgelbaum, John Geanakoplos, Penny Goldberg, Sam Kortum, Xiangliang Li, Giovanni
Maggi, Kiminori Matsuyama, Ralph Ossa, Steve Redding, Andres Rodriguez-Clare, Chris Tonetti,
and numerous seminar and workshop participants for excellent comments and suggestions. A Matlab
toolkit which is the companion to this paper is available on Allen's website. All errors are our own.
The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2014 by Treb Allen, Costas Arkolakis, and Yuta Takahashi. All rights reserved. Short sections of
text, not to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Universal Gravity
Treb Allen, Costas Arkolakis, and Yuta Takahashi
NBER Working Paper No. 20787
December 2014
JEL No. F1

                                               ABSTRACT

What is the best way to reduce trade frictions when resources are scarce? To answer this question,
we develop a framework that nests previous general equilibrium gravity models and show that the
macro-economic implications of these various models depend crucially on two key model parameters,
which we term the “gravity constants.” Based only on the value of the gravity constants, we derive
sufficient conditions for the existence and uniqueness of the trade equilibrium and, given observed
trade flows, completely characterize all comparative statics for any change in bilateral trade frictions.
We then develop a methodology for estimating these gravity constants without needing to assume
a particular micro-foundation of the gravity trade model. Finally, we use these results to derive the
set of trade friction reductions that (to a first-order) maximize welfare gains given an arbitrary constraint.


Treb Allen                                            Yuta Takahashi
Department of Economics                               Department of Economics
Northwestern University                               Northwestern University
2001 Sheridan Road                                    2001 Sheridan Road
Evanston, IL 60208                                    Evanston, IL 60208-2600
and NBER                                              takahashi.econ@gmail.com
treb.allen@northwestern.edu

Costas Arkolakis
Department of Economics
Yale University, 28 Hillhouse Avenue
P.O. Box 208268
New Haven, CT 06520-8268
and NBER
costas.arkolakis@yale.edu




A Matlab toolkit is available at:
https://www.dropbox.com/sh/2u8nj5k9pi04tuw/AACHs26flosddz-9hMK_NFXEa?dl=0
A data appendix is available at:
http://www.nber.org/data-appendix/w20787
1       Introduction
What is the best way to reduce trade frictions when resources are scarce? This question is
of first-order importance to policy makers, but trade economists have made little progress
finding an answer. A primary difficulty is that the numerous and varied general equilibrium
forces at play in trade models imply that changing any particular bilateral trade friction will
affect not only those trading partners but also all other locations in the world. This makes it
difficult to predict the effect of any particular change in trade frictions, let alone determine
the optimal set of trade friction reductions. Adding to the difficulty is that while some work
has been done understanding general equilibrium forces in particular models, little is known
about the extent to which these forces differ across models. At a first glance, characterizing
the optimal set of bilateral trade friction reductions while accounting for general equilibrium
forces without relying on a particular model seems a daunting task.
    In this paper, we attempt this daunting task. To do so, we develop a framework that
nests previous gravity trade models in order to provide a “universal” characterization of
their general equilibrium forces.1 We show that the main theoretical properties and, given
observed trade flows, all comparative statics of gravity trade models depend solely on two key
model parameters that we call “gravity constants.” We then provide closed form expressions
for the complete set of (local) comparative statics and use these expressions to develop a
method of estimating the gravity constants without needing to choose a particular trade
model. Finally, we use the resulting estimates to derive the set of unilateral and multilateral
trade friction reductions that (to a first-order) maximize welfare gains given an arbitrary
constraint.
    The universal gravity framework we develop is based on four restrictions: (i) a “modern”
version of gravity, whereby bilateral trade flows depend on (endogenous) exporter and im-
porter shifters and (exogenous) bilateral trade frictions;2 (ii) aggregate output equals total
sales; (iii) trade is balanced; and (iv) (gross) income is a log-linear function of the exporting
and importing shifters (which practically translates to the condition that gross income is
proportional to labor income). The aforementioned gravity constants are simply the coeffi-
cients of this log-linear function. It turns out that these assumptions – which are ubiquitous
    1
     Examples of gravity models covered under our specification is perfect competition models such as An-
derson (1979), Anderson and Van Wincoop (2003), Eaton and Kortum (2002), Caliendo and Parro (2010)
monopolistic competition models such as Krugman (1980), Melitz (2003) as specified by Chaney (2008), Arko-
lakis, Demidova, Klenow, and Rodrı́guez-Clare (2008), Di Giovanni and Levchenko (2008), Dekle, Eaton,
and Kortum (2008), and the Bertrand competition model of Bernard, Eaton, Jensen, and Kortum (2003);
see Table 1 for details.
   2
     This version of the gravity model was first introduced by Eaton and Kortum (2002), Anderson and
Van Wincoop (2003), and Redding and Venables (2004). Baldwin and Taglioni (2006) and Head and Mayer
(2013) carefully discuss the econometric issues arising from the use of this specification.


                                                    2
throughout the trade literature – impose sufficient structure on aggregate trade flows to
completely characterize all general equilibrium interactions.
    We derive sufficient conditions for the existence and uniqueness of the equilibrium of the
model that depend solely on the gravity constants.Given the simple mapping of different
gravity models to gravity constants, these sufficient conditions are straightforward to check
and relax the sufficient conditions presented by Alvarez and Lucas (2007). This methodology
can also be extended to consider multiple sectors of production, as in Chor (2010), Costinot,
Donaldson, and Komunjer (2010), and Caliendo and Parro (2010) and economic geography
models with mobile factors of production as in Helpman (1998) and Allen and Arkolakis
(2014).
    When trade frictions are “quasi-symmetric” (as is assumed in much of the empirical
gravity literature, e.g. Eaton and Kortum (2002) and Waugh (2010)), we further show that
the unique way of satisfying trade balance is for trade flows to be bilaterally balanced. This
implies an equilibrium relationship between the exporting and importing shifters, a result
(implicitly) used by Anderson and Van Wincoop (2003), Allen and Arkolakis (2014) and
others to simplify the equilibrium system of equations for particular models. Given this
result, we show that quasi-symmetric trade costs extend the range of gravity constants for
which uniqueness can be ensured.
    Our second theoretical result is to show that there exist two “dual” interpretations of the
general equilibrium gravity model. In the first interpretation, a planner maximizes world
income subject to trade remaining balanced and an aggregate world resource constraint. In
the second interpretation, a planner maximizes a weighted average of world welfare subject
to only the aggregate world resource constraint, where welfare is assumed to be written as a
function of trade openness (as in the class of trade models considered by Arkolakis, Costinot,
and Rodrı́guez-Clare (2012)). Using these dual interpretations, we apply the envelope the-
orem to derive the elasticity of both world income and world welfare to any bilateral trade
costs, which can both be expressed solely as a function of observed trade flows and the
gravity constants. While the expression for world income is, to the best of our knowledge,
novel, the expression for world welfare has been derived previously for gravity models with
CES demand by Atkeson and Burstein (2010), Burstein and Cravino (2012), and Fan, Lai,
and Qi (2013); our derivation extends this result to any gravity trade model where welfare
can be expressed as a function of trade openness (which Arkolakis, Costinot, Donaldson,
and Rodrı́guez-Clare (2012) show holds for a large class of homothetic utility functions).
This latter results will prove useful for determining the welfare-maximizing trade friction
reductions.
    We then turn to the empirical properties of the model by asking what can be said using our


                                              3
framework given observed trade flows. We first characterize the extent to which model fun-
damentals can be recovered from the trade data. We show that trade models are intrinsically
under-identified: the same trade data can be perfectly matched by different combinations
of model fundamentals. Notably, the gravity constants cannot be identified from observed
trade flows alone. This result provides a general characterization of the non-identification
inherent to gravity models discussed for particular models by Waugh (2010), Eaton, Kortum,
Neiman, and Romalis (2011), Burstein and Vogel (2012), Ramondo, Rodrı́guez-Clare, and
Saborio-Rodriguez (2012) and Arkolakis, Ramondo, Rodrı́guez-Clare, and Yeaple (2013).
    To examine how changes in bilateral trade frictions affect equilibrium trade flows and
incomes we first derive an analytical expression for the (large) matrix of elasticities of all bi-
lateral trade flows to changes in all bilateral trade frictions. As with the aggregate elasticities,
this expression depends only on observed trade flows and the gravity constants, indicating
that apart from these two model parameters, all macro-economic implications – i.e. the
changes in trade flows, gross incomes, and, given the assumption above, welfare – for all
gravity models are the same. We then derive a system of equations that show how arbitrary
(possibly non-infinitesimal) changes to the trade friction matrix affect macro-economic vari-
ables; this expression also depends only on the gravity constants and observed trade flows.
While the non-infinitesimal results generalize those developed by Dekle, Eaton, and Kortum
(2008) and Arkolakis, Costinot, and Rodrı́guez-Clare (2012), the closed form solution for the
trade elasticities is, the the best of our knowledge, the first in the literature.
    We then turn to the question of welfare-maximizing trade friction reductions. Given
the closed form expressions of the comparative statics, we show how to calculate the set of
trade friction changes that maximize (to a first-order) the change in welfare for an arbitrary
constraint on the total change in trade frictions. In special cases, this expression also takes
a closed form: for example, the eigenvector corresponding to the largest eigenvalue of the
observed trade flow matrix is the set of trade friction reductions that maximizes the increase
in world welfare, countries are constrained to reduce their trade frictions non-discriminately,
and the costs of trade friction reductions are equal for all countries. While Ossa (2014) uses
a computational approach to calculate optimal tariffs, we offer the first closed form char-
acterization of the welfare-maximizing change in trade frictions in a many location general
equilibrium framework.
    More generally, the welfare-maximizing set of trade friction reductions will depend on the
value of the gravity constants, so we show how the general equilibrium gravity estimator can
be combined with the observed trade flows and an observed trade cost shock – in our case,
a number of countries joining the WTO between 1995 and 2005 – to estimate the gravity
constants without needing to specify a micro-economic foundation. Using the analytical ex-


                                                 4
pression for comparative statics we derive, we develop a new gravity estimator that explicitly
incorporates the general equilibrium effects that a change in the bilateral trade friction be-
tween any two countries has on all other bilateral trade flows. This estimator is in the spirit
of the structural estimation done by Anderson and Van Wincoop (2003); unlike Anderson
and Van Wincoop (2003), however, we derive a closed form solution for estimator, and show
that it can be interpreted as an ordinary least squares regression where the typical gravity
regressors have undergone a transformation to account for general equilibrium effects.
    Finally, we use our estimates of the gravity constants to determine the welfare-maximizing
unilateral and multilateral set of trade friction reductions. We assume for simplicity that
all trade frictions are equally costly to reduce, but emphasize that our methodology can be
applied for any arbitrary cost of reducing trade frictions. We find that countries like Cuba
and North Korea have the most to gain from unilaterally reducing their import frictions.
The welfare-maximizing multilateral trade friction reductions are concentrated amongst the
wealthiest countries, which causes the welfare in those countries to disproportionately in-
crease; indeed, the welfare of the poorest countries are actually falls slightly.
    Our work is related to a small but growing literature analyzing the structure of general
equilibrium models of trade. Notably, Arkolakis, Costinot, and Rodrı́guez-Clare (2012) derive
a closed form expression for changes in welfare as a function of changes in openness, allowing
for ex-post evaluations of the welfare effects of changes in trade frictions. In contrast, we
derive analytical expressions for all macroeconomic outcomes of interest using only the initial
level of trade flows, thereby allowing for ex-ante predictions of the change in welfare for
possible changes in trade frictions. Notice that in all the models we consider the elasticity
of trade does not vary with the level of trade (for models with variable elasticity see Novy
(2010), Head, Mayer, and Thoenig (2014),Melitz and Redding (2014), and Fajgelbaum and
Khandelwal (2013)). While we assume that the gravity constants are fixed in this paper,
our derivations show how changes to those gravity constants affect the general equilibrium
forces of the model.
    Our paper is also related to Costinot (2009), who examines the patterns of trade that hold
true across many models. His primary focus, however, is on the specialization of countries
in particular sectors, whereas we are concerned with the pattern of aggregate trade flows
in a gravity framework. More broadly, our paper shows that the macroeconomic conditions
inherent in gravity trade models impose sufficient structure so that its particular microeco-
nomic details do not pose a problem in its characterization. Given the difficulties arising in
guaranteeing the uniqueness of equilibrium and characterizing comparative statics in general
equilibrium models, this constitutes a significant benefit.3
  3
      See Kehoe (1985) and Shafer and Sonnenschein (1993) discussing issues arising from aggregation or the


                                                     5
    The paper is organized as follows. In the next section, we present the universal framework
and discuss how it nests existing general equilibrium gravity models. In Section 3, we present
the theoretical results for existence and uniqueness, as well as the dual interpretations of the
problem. In Section 4, we present the empirical results for identification and comparative
statics given observed trade flows. In Section 5, we apply these results study optimal trade
friction reductions. Section 6 concludes.


2      The universal gravity framework
Consider a world comprised of a set S ≡ {1, ..., N } of locations.4 Let Yi denote the gross
income of location i, Xij the total value of location j’s imports from location i, and Kij > 0
the associated bilateral trade frictions. In our universal gravity framework, the endogenous
outcomes of the model are summarized by the variables γi and δi , which capture the exporting
and importing “capacity” of each location, respectively. In the context of a particular micro-
founded model, these variables will map to a combination of endogenous model outcomes –
such as wages or the price index of a location – and model fundamental parameters – such
as productivities or labor endowments.
    We focus our attention on models satisfying several equilibrium conditions. These condi-
tions are sufficient to fully characterize the general equilibrium structure of the models yet
general enough to nest a number of seminal gravity trade models.
    Gravity. Our first condition restricts our attention to trade models which yield a gen-
eralized form of the gravity equation pioneered by Tinbergen (1962).

Condition 1. For any countries i ∈ S and j ∈ S, the value of aggregate bilateral trade flows
is given by Xij = Kij γi δj .

    The two endogenous variables have an explicit role in this equation as exporting and
importing shifters. The exogenous bilateral trade frictions capture the effects of bilateral
trade costs; they could be inverse functions of bilateral distance, various exporting barriers
faced by exporting countries, etc. Note that larger values of Kij indicate lower bilateral trade
frictions.
    Goods market clearing and trade balance. We proceed by defining two equilibrium
conditions that are standard assumptions for modern general equilibrium gravity models:
goods market clearing and trade balance. We say that goods markets clear if the output
consideration of production.
   4
     The choice of a finite number of locations is not necessary for the the results that follow, but it saves on
notation, avoids several thorny technical issues, and is consistent with the majority of the trade literature.



                                                       6
for all i ∈ S is equal to the value of the good sold to all destinations. This condition is
practically an accounting identity. Formally:
                                                       P
Condition 2. For any location i ∈ S, Yi =                   j∈S   Xij .

   Furthermore we assume that trade is balanced, i.e. that output for all i ∈ S is equal to
the amount spent on good purchased from all other destinations:
                                                       P
Condition 3. For any location i ∈ S, Yi =                   j∈S   Xji .

    While balanced trade is a standard equilibrium condition in general equilibrium gravity
models, it is important to note that trade is not balanced empirically. This empirical discrep-
ancy is an inherent limitation arising from the use of a static model to explain an empirical
phenomenon with dynamic aspects. However, given both its ubiquity in the literature and
the necessarily ad hoc nature of any alternative assumption (e.g. exogenous trade deficits),
balanced trade seems the natural assumption on which to focus. We relax this assumption in
the characterization of the empirical properties of the model in Section 4 when we introduce
exogenous deficits across countries, following Dekle, Eaton, and Kortum (2008).5
    Relationship between income and the shifters. Our last condition postulates a
log-linear parametric relationship between gross income and the exporting and importing
shifters:

Condition 4. For any location i ∈ S, Yi = Bi γiα δiβ , where we define α ∈ R and β ∈ R to be
the gravity constants and Bi > 0 is an (exogenous) location specific shifter.

    Condition C.4 regulates the extent to which income responds to changes in the two
endogenous shifters. The gravity constants determine the importance of the exporting and
importing shifters in determining a location’s income, which will prove crucial in determining
the general equilibrium forces of the system. In practice, C.4 is analogous to the standard
condition that the income in a location is proportional to the income earned by the factors
of production in that location (e.g. local labor). As a result, models in which income is not
proportional to returns to factors will not generally satisfy C.4: for example, by including
tariff revenue as an additive source of income, Ossa (2014) does not satisfy this condition.
   5
     In fact, total income may differ from total spending even in a static setup, e.g. if fixed exporting costs are
partially paid in labor of the exporting location (see e.g. Arkolakis (2010) and Di Giovanni and Levchenko
(2009)). Even in such cases, however, for the trade balance to hold it is sufficient that the income generated
from the fixed exporting cost in each bilateral trading relationship is a constant fraction of bilateral sales, as
pointed out by Arkolakis, Costinot, and Rodrı́guez-Clare (2012).




                                                        7
   Our final condition is a normalization. Note that the system of equations defined by
C.2-C.3 already implies Warlas’ law.6 As a result, we make the following assumption to pin
down the equilibrium level of trade flows.

Condition 5. World income equals to one:7
                                                 X
                                                      Yi = 1.                                             (1)
                                                  i


In what follows, for any given gravity constants α and β, income shifters {Bi } and bilateral
trade frictions {Kij }, we define a general equilibrium gravity model to be a set of export
shifters {γi } and import shifters {δi } that satisfy gravity, goods market clearing, trade bal-
ance, factor market clearing, and the normalization (1), i.e. a general equilibrium gravity
model is any trade model where conditions C.1-C.5 are satisfied.

    Example: the Armington model To make things concrete, we will provide a simple
example of a general equilibrium trade model. In the Armington (1969) model, first for-
mulated in general equilibrium by Anderson (1979), each location produces a differentiated
variety (which is sold at marginal cost) and consumers have constant elasticity of substi-
tution (CES) preferences with elasticity of substitution σ and where we denote by Pi the
Dixit-Stiglitz CES price index across all varieties. We assume that production combines
labor and an intermediate input in a Cobb-Douglas fashion, where the share of labor is
given by ζ ∈ (0, 1], and the intermediate input uses the same CES aggregator of goods from
all countries as the final consumption good. Thus, with productivity Ai , the unit cost of
production in location i is simply wiζ Pi1−ζ /Ai .
    In this model, the value of bilateral trade from i ∈ S to j ∈ S is:
                                                              !1−σ
                                                  wiζ Pi1−ζ
                                  Xij = τij1−σ                       Pjσ−1 Yj                             (2)
                                                      Ai

where wi is location’s i wage, Ai is the location’s productivity and the marginal production
        wi
cost is A i
            , τ ij is the iceberg cost of delivering i’s good in destination j, and Yi is again its
income. It is also straightforward to show that output is proportional to wage income and
is given by
                                              Yi = wi Li /ζ                                    (3)
    6
P ToPsee this note
                 P that P summing these two equations over all i 6= N and equating them we obtain
  i6=N   j Xij =   i6=N   j Xji . By the definition of gross world income being total trade across all markets
we obtain trade balance for the N th location which implies Warlas’ law.
    7
P This is a valid normalization as long as α 6= β. When α = β, a suitable alternative normalization is
  i∈S γi = 1. None of the following results, unless explicitly noted, depend on the normalization chosen.


                                                      8
where Li is the population in location i. According to the definition of gravity, C.1, we have
                                                     !1−σ
                                         wiζ Pi1−ζ
                                 γi ≡                        , δi ≡ Piσ−1 Yi ,
                                             Ai

which allows us to write C.4 as
                                              1      1−ζ      σ−1    ζ(σ−1)

                                    Yi = γi1−σζ δi1−σζ Aiσζ−1 Li σζ−1 ,

                                                  σ−1       ζ(σ−1)
                1         1−ζ
so that α ≡ 1−σζ   , β ≡ 1−σζ , and Bi = Aiσζ−1 Li σζ−1 . Note that if σ > 1 and σζ > 1, then
α, β< 0 and a higher productivity Ai will increase both the exporting ability and the income
of the location. At the same time increases in wages increase exports but decrease income.
    Table 1 lists a number of seminal trade models that fall into the universal gravity frame-
work and show how the micro-founded model fundamentals map to the gravity constants α
and β.8 There are several things to highlight from this table: first, while in some models the
elasticity of trade flows to the variable trade cost (often called the “trade elasticity”) maps
one-to-one to a gravity constant, in others it does not. Hence, the trade elasticity and the
gravity constants are distinct parameters in general equilibrium gravity models. Second, the
interpretation of the gravity constants depends on the particular model; as a result, different
micro-foundations for the gravity model may imply different preferred values for the gravity
constants. As we will see in the next two sections, this will prove important, as the gravity
constants determine the strength of the general equilibrium forces in the model.


3       Theoretical properties
We first consider the theoretical properties of the general equilibrium gravity framework.


3.1     Existence and Uniqueness
In this section, we provide sufficient conditions for establishing existence and uniqueness in a
general equilibrium gravity model. We start by formulating the equilibrium system implied
by our assumptions. Using C.2 and C.3 and substituting out Xij and Yi with the definitions
C.1 and C.4, respectively, yields:
    8
    While these models all feature constant elasticity demand, our results hold for all models that satisfy
the conditions below even if they depart from this assumption. See for example the class of homothetic
and non-homothetic demand functions considered by Arkolakis, Costinot, Donaldson, and Rodrı́guez-Clare
(2012).




                                                        9
                                                     X
                                    Bi γiα−1 δiβ =       Kij δj                             (4)
                                                     j


and
                                                     X
                                    Bi γiα δiβ−1 =       Kji γj                             (5)
                                                     j


and using C.4, C.5 becomes:
                                       X
                                             Bi γiα δiβ = 1.                                (6)
                                         i

Thus, given model fundamentals Bi , Kij and gravity constants α, β, equilibrium is defined
as γi and δi for all i ∈ S such that equations (4), (5) and (6) are satisfied. In the special
case where α = β = 1, it is immediately evident from equations (4) that (5) have a solution
                                     K        K
only if the matrices with elements Biji and Bjii both have a largest eigenvalue equal to one.
Since this will not generally be true, in what follows we exclude this case.
    To proceed, we define xi ≡ Bi γiα−1 δiβ and yi ≡ Bi γiα δiβ−1 . By reformulating the system
in terms of xi , yi (see Appendix A.1 for details), equations (4) and (5) take the form of a
standard system of non-linear equations. It turns out that this reformulation of the problem
provides a method of solving for the trade equilibrium system using functions that map a
compact space onto itself. This has two advantages over the standard formulation given
in equations (4) and (5): first, by restricting the potential solution space, it facilitates the
calculation of the equilibrium; second, it allows us to generalize results used in the study of
integral equations to prove the following theorem:

Theorem 1. Consider any general equilibrium gravity model. If α + β 6= 1, then:
  i) The model has a positive solution and all possible solutions are positive;
  ii) If α, β ≤ 0 or α, β ≥ 1, then the solution is unique.

Proof. See Appendix A.1.

    Note that condition (ii) of Theorem 1 provides sufficient conditions for uniqueness; for
certain parameter constellations (e.g. particular geographies of trade costs), equilibria may
be unique even if the conditions are not satisfied. In practice, however, we have found that
there exist multiple equilibrium for particular geographies when condition (ii) is violated.
    The methodology to prove Theorem 1 turns out to be quite general. In what follows, we
provide two useful extensions.


                                                10
Multiple sectors

Our approach also can be naturally
                              n       extended
                                       o       to the cases where there are multiple sectors.
Suppose there are a set s ∈ 1, ..., S̃ of sectors and that the bilateral trade flow between
location i and location j in sector s is

                                      Xijs = Kijs (γi ) δjs ,
                                                           


where Kijs can include sector-specific trade frictions or productivities. With multi-sector
gravity models, we implicitly assume that there are no frictions on labor markets so that the
wages in location i is equalized across sectors. That is why we can assume that the origin
effect, γi , is independent of the sector s. Condition C.4 becomes:
                                                                       !β
                                                                  θt
                                                     Y
                                Yi = Bi (γi )α           (δis )             .
                                                     s


The first two terms are the same as before, but the last term is slightly different from what
we have in a single-sector economy.
   The other two equilibrium conditions are:
                                          X
                                               s
                                              Xj,i = Bis Yi
                                          j
                                    XX
                                               s
                                              Xi,j = Yi .
                                      s   j


The first equation assumes that location i’s expenditure in each sector is a constant fraction of
its total income. The second equation is the extension of the good market clearing condition
we have in a single-sector case.
    It turns out that the conditions for uniqueness with multiple sectors are the same as with
a single sector, which we formalize in the following proposition:

Corollary 1. (1) There exists a solution to the multi-sector gravity model if α, β ≤ 0 or
α, β > 1. (2) That solution is unique if α, β ≤ 0 or α, β > 1.

Proof. See Online Appendix B.1.

     Note that unlike the single sector case, we cannot prove the existence of a solution when
it is not unique; this is due to the presence of cross-sectoral linkages.




                                                11
Economic geography

Our approach can also be naturally extended to allow for labor mobility as in economic
geography models. To do so, we slightly alter condition C.4 to allow for the gross income
in a location to depend additionally on an endogenous constant λ, which can be interpreted
as a monotonic transformation of welfare (which is equalized across locations in economic
geography models). The level of this endogenous constant is then determined by a labor
market clearing condition that can be written as a sum across locations of a log-linear
function of endogenous variables.

Condition 4’. For any location i ∈ S, Yi = λ1 Bi γiα δiβ , where λ > 0 is an endogenous
variable and all other variables are as above. Furthermore, we require that λc = i Ci γid δie
                                                                                  P

for some c, d, e ∈ R.
    It is straightforward to show that the economic geography model of Allen and Arkolakis
(2014) (which under certain parametric configurations is isomorphic to the economic geog-
raphy models of Helpman (1998), Redding (2014), and Bartelme (2014)) satisfies Condition
C.4’; see Online Appendix B.3 for details.
    Given this alternative condition, we modify part (ii) of Theorem 1 slightly to prove the
following Corollary:

Corollary 2. Consider any economic geography model that satisfies conditions C.1, C.2,
C.3, C.4’, and C.5. Then (i) there exists a solution as long as α + β 6= 1; and (ii) the
equilibrium is unique if α, β ≤ 0 or α, β > 1.

Proof. See Online Appendix B.2.

   We should note that Corollary 2 shows that the uniqueness condition presented in Allen
and Arkolakis (2014) holds for an arbitrary set of trade costs, i.e. the assumption in that
paper of symmetric trade costs is not necessary. Indeed, as we now show, assuming a
(generalized) form of trade cost symmetry has important implications for the equilibrium.


3.2    Quasi-symmetry
It turns out that we can extend the range in which uniqueness is guaranteed if we constrain
our analysis to a particular class of trade frictions which are the focus of a large empirical
literature on estimating gravity trade models. We call these trade frictions quasi-symmetric.

Definition 1. Quasi Symmetry: We say the trade frictions matrix K is quasi-symmetric if
there exists a symmetric N × N matrix K̃ and N × 1 vectors K A and K B such that for all


                                             12
i, j ∈ S we have:
                                Kij = K̃ij KiA KjB , where K̃ij = K̃ji

    Loosely speaking, quasi-symmetric trade frictions are those that are reducible to a sym-
metric component and exporter- and importer-specific components. While restrictive, it is
important to note that the vast majority of papers which estimate gravity equations assume
that trade frictions are quasi-symmetric; for example Eaton and Kortum (2002) and Waugh
(2010) assume that trade costs are composed by a symmetric component that depends on
bilateral distance and on a destination or origin fixed effect.
    When trade frictions are quasi-symmetric we can show that the system of equations (31)
and (32) can be dramatically simplified, and the uniqueness more sharply characterized.

Theorem 2. Consider any general equilibrium gravity model with quasi-symmetric trade
costs. Then:
    i) The balanced trade condition is equivalent to the origin and destination shifters being
equal up to scale, i.e.
                                       γi KiA = κδi KiB                                    (7)

for some κ > 0 that is part of the solution of the equilibrium.
    ii) If α + β ≤ 0 or α + β ≥ 2, the model has a unique positive solution.

Proof. See Appendix A.2.

   Part i) of the Theorem 2 is particularly useful since it allows to simplify the equilibrium
system into a single non-linear equation:
                                           X                    1−β         β
                          γiα+β−1 = κβ−1        e ij B −1 K A
                                                K     i    i           KiB        γj .               (8)
                                            j


In addition, because the exporter and importer shifters in gravity models will (generally)
be composites of exogenous and endogenous variables, by showing that the two shifters
are equal up to scale, Theorem 2 provides a more precise analytical characterization of the
equilibrium. We should note that the results of Theorem 2 have already been used in the
literature for particular models, albeit implicitly. The most prominent example is Anderson
and Van Wincoop (2003), who use the result to show the bilateral resistance is equal to
the price index.9 To our knowledge, Head and Mayer (2013) are the first to recognize the
importance of balanced trade and market clearing in generating the result for the Armington
model; however, Theorem 2 shows that the result applies more generally to any general
   9
    The result is also used in economic geography by Allen and Arkolakis (2014) to simplify a set on non-
linear integral equations into a single integral equation.

                                                   13
equilibrium gravity model with quasi-symmetrical trade costs and balanced trade. Note,
however, that part (i) of Theorem 2 also implies that for all i, j ∈ S, we have Xij = Xji , i.e.
trade flows are bilaterally balanced, which is typically rejected empirically.
    Figure 1 illustrates the range of α and β for which uniqueness of the model can be guar-
anteed. It should be noted that while most of the examination of existence and uniqueness of
trade equilibria has proceeded on a model-by-model case, the gross substitute methodology
used by Alvarez and Lucas (2007) has proven enormously helpful in establishing conditions
for existence and uniqueness. It can be shown (see Online Appendix B.4) that an application
of the gross-substitutes methodology works only when α ≤ 0 and β ≤ 0; hence, the tools
used in Theorems 1 and 2 extend the range of trade models for which uniqueness can be
proven, including, for example, the Armington model with intermediate inputs.
    Example: Armington model with quasi-symmetry Consider again an Armington
model with intermediate inputs, but now assume that trade costs are quasi-symmetric. From
part (i) of Theorem 2, we have γi = κδi , which implies:
                                                    1−σ
                                        wiδ Pi1−δ
                                   
                                                             KiA = κPiσ−1 wi Li KiB ,
                                           Ai

or equivalently:
                                                                                1
                                                                        B
                                             1+(σ−1)δ
                                                                          (1−σ)(2−δ)
                                            (1−σ)(2−δ)            1−σ Ki
                                Pi = w i                     κLi Ai                    .                      (9)
                                                                      KiA
Equation (9) provides some intuition for the uniqueness condition presented in Theorem 2:
when σ < 12 , it is straightforward to show that the elasticity of the price index with respect to
the wage is less than one. This implies that the wealth effect may dominate the substitution
effect, so that the excess demand function need not be downward sloping.
    In addition, combining equation (9) with equation (8), assuming δ = 1, and noting that
welfare Wi = wPii yields the following equation:

                                                                                        −(σ−1)σ̃
                                                 X                (σ−1)σ̃
                               κWiσσ̃ Lσ̃i =            Kij Ai              Aσσ̃ σ̃
                                                                             j Lj Wj                 ,       (10)
                                                    j

              σ−1 10
where σ̃ ≡    2σ−1
                   .    Equation (10) holds for both trade models (where labor is fixed) and
  10
    When there are only two countries (so that trade costs are necessarily quasi-symmetric), we can use
equation (10) to derive a single non-linear equation that yields the relative welfare in the two countries
                                       σσ̃                    (1−σ)σ̃                   σ̃
                                   W1                       W1                          W1
                         K22                   − K11                        + K21                  = K12 .
                                   W2                       W2                          W2
Comparative statics for welfare with respect to changes in Kij can be characterized using the implicit function
theorem in this case.


                                                                 14
economic geography models (where labor is mobile); in the former case, Li is treated as
exogenous parameter and Wi solved for; in the latter case Li is treated as endogenous and
Wi is assumed to be constant across locations. Hence, Theorem 2 highlights the fundamental
similarity between trade and economic geography models.


3.3     Two dual representations
In this section, we show that the solution of the general equilibrium gravity model can
be equivalently expressed as the solution to two distinct maximization problems: one for
world income and one for world welfare. These dual interpretations allow us to apply the
envelope theorem to derive expressions for the elasticity of world income and world welfare,
respectively, to any change in bilateral trade frictions.
    Consider first the problem of choosing the set of origin and destination shifters to max-
imize world income subject to trade remaining balanced and the aggregate feasibility con-
straint that world income can be equivalently calculated by summing over trade flows or
using condition C.4:
                                           XX
                                     max            Kij γi δj
                                            {γ},{δ}
                                                      i∈S j∈S
                   X                 X                            XX                      X
            s.t.       Kij γi δj =       Kji γj δi ∀i ∈ S and               Kij γi δj =         Bi γiα δiβ ,   (11)
                   j                 j                            i∈S j∈S                 i∈S

where we now choose as a numeraire that γ1 = 1 rather than choosing world income as a
numeraire (since maximizing the numeraire is not a well defined problem).
   Alternatively, consider the problem of maximizing a weighted average of world welfare
subject to only the aggregate feasibility constraint. Of course, in the absence of a micro-
foundation of the gravity trade model nothing can be directly said about the welfare of
the equilibrium (as we have not specified preferences). However, Arkolakis, Costinot, and
Rodrı́guez-Clare (2012) show that for a large class of trade models, the welfare of a location
can be written solely as an increasing function of its openness to trade and an exogenous
parameter, i.e. for all i ∈ S, welfare in location i, can be written as:11
                                                                          1/ρ
                                             −1/ρ
                               Wi = CiW λii           = CiW Bi γiα−1 δiβ−1      ,                              (12)

where CiW > 0 is an (exogenous) parameter and ρ > 0 is an exogenous scalar. If welfare
can be written as in equation (12), we can define world welfare as a weighted average of the

  11
    In addition to CES preferences, this includes a larger class of homothetic demand functions including
the symmetric translog demand function (see also Feenstra (2003b)) and the Kimball demand function (see
Kimball (1995)); see Arkolakis, Costinot, Donaldson, and Rodrı́guez-Clare (2012).


                                                         15
welfare in each location:
                              X                  X                                    1/ρ
                        W ≡           ωi W i =         ωi CiW       Bi γiα−1 δiβ−1            ,
                               i∈S               i∈S


where ωi > 0 are the weights placed on the welfare in each location. Then the following
world welfare maximization problem is well defined:

                                                  max W
                                                 {γ},{δ}

                                       XX                       X
                               s.t.              Kij γi δj =            Bi γiα δiβ .              (13)
                                       i∈S j∈S                  i∈S

It turns out that the solution to both the world income maximization problem (11) and the
world welfare maximization problem (13) is the solution to the general equilibrium gravity
model, which we prove in the following proposition:

Proposition 1. Consider any general equilibrium gravity model. If α + β > 2 or α + β < 0
(which by part (ii) of Theorem 2 guarantees uniqueness), then:
    (i) The solution of the general equilibrium gravity model is equivalent to the solution of
the world income maximization problem (11).
    (ii) If welfare can be expressed as in equation (12), then there exists a set of weights {ωi }
such that the solution of the general equilibrium trade model is equivalent to the solution of
the world welfare maximization problem (13).

Proof. See Appendix A.3.

    An advantage of the dual approach is that it allows us to apply the envelope theorem
to derive an expression for how any change in bilateral trade frictions affects world income
and world welfare. Using the world income maximization dual interpretation, the elasticity
of world income to Kij is:

                            ∂ ln Y W
                                                        
                                                     α+β   Xij
                                     = (κi − κj ) +            ,                                  (14)
                            ∂ ln Kij                α+β−2 YW

where κi is the Lagrange multiplier on the balanced trade constraint and can be shown to
be the solution to the following linear system:

                                   β−α         X Xij
                                        + κi =         κj .
                                  α+β−2        j∈S
                                                   Y i




                                                       16
When trade costs are quasi-symmetric, part (i) of Theorem 2 implies that Xij = Xji so that
expression (14) becomes even more straightforward:

                                      ∂ ln Y W   ∂ ln Y W
                                                           
                              1                                       α + β Xij
                                               +                 =              ,         (15)
                              2       ∂ ln Kij   ∂ ln Kji            α+β −2YW

i.e. a symmetric increase in any pair of Kij (i.e. a symmetric reduction of bilateral trade
frictions) increases world income by an amount proportional to the importance of those
bilateral trade flows, where the proportion is a function of the gravity constants.12
    Applying the envelope theorem to the world welfare maximization interpretation, the
elasticity of world welfare to Kij is even simpler:

                                               ∂ ln W     1 Xij
                                                        =       .                         (16)
                                               ∂ ln Kij   ρYW

This expression has been derived for gravity models with CES demand by Atkeson and
Burstein (2010), Burstein and Cravino (2012), and Fan, Lai, and Qi (2013); our derivation
extends this result to any gravity trade model where welfare can be expressed as in equation
(12). This expression will prove useful when examining the set of welfare-maximizing trade
frictions reductions in Section 5.


4       Empirical implications
Thus far, we have examined the theoretical properties of the general equilibrium gravity
framework. We now ask in what ways can the general equilibrium gravity framework be
used in conjunction with an observed set of bilateral trade flows. In particular, given any
set of observed trade flows {Xij } and gravity constants α and β, we show to what extent
model fundamentals such as bilateral trade frictions can be recovered and derive expressions
for how the model equilibrium will change with any change in the underlying bilateral trade
flows.
    Before proceeding to these results, however, we must address an issue familiar to trade
empiricists: in contrast to assumption C.3, trade data is usually not balanced. It is not obvi-
ous how one ought to address unbalanced trade (which we view as a dynamic phenomenon)
in the context of a static model. In what follows, we treat the trade deficits as exogenous,
                                                          P
as in Dekle, Eaton, and Kortum (2008). Define Ei ≡ j∈S Xji to be the expenditure in
                     P
location i ∈ S, Yi ≡ j∈S Xij to be the output in location i ∈ S and D̄i ≡ Ei − Yi to be the
 12                                                α+β
      Note that if α + β > 2 or α + β < 0, then   α+β−2   > 0.



                                                      17
(exogenous) trade deficit. In this case, equation (5) becomes:
                                                       X
                                  Bi γiα δiβ + D̄i =       Kji γj δi                        (17)
                                                       j


There are two disadvantages to allowing for exogenous deficits: first, the theoretical results
presented above (in particular, the uniqueness of the equilibrium) do not necessarily hold;
second, welfare cannot be expressed as in equation (12). Subject to these caveats, the
empirical results below hold with (exogenous) trade deficits.


4.1    Identification
We first examine the extent to which one can recover model parameters given observed trade
flows alone, which we summarize in the following proposition.

Proposition 2. Take as given any (possibly unbalanced) set of observed trade flows {Xij }.
Choose any gravity constants α and β, set of income shifters {Bi } and set of own trade
flow frictions {Kii }. Then there exists a unique set of {Kij }i6=j (and set of exogenous trade
         
deficits D̄i ) that, given the chosen parameters, yield equilibrium trade flows that equal to
the observed trade flows.

Proof. See Appendix A.4.

    Proposition 2 shows that general equilibrium gravity models are fundamentally under-
identified in two ways. First, there exists an inability to determine which model parameter
is responsible for the level of trade flows. In particular, the scale of the bilateral trade
frictions and the income shifters cannot be separately identified: intuitively, a larger value of
the income shifter can be counteracted with lower bilateral trade frictions without affecting
the equilibrium. Second, the observed trade flows can be rationalized by the model for
any chosen value of α and β (as long as α 6= β). That is, the gravity constants cannot
be identified using trade flow data alone. This result underpins why previous attempts to
estimate (transformations of) these gravity constants have relied on additional sources of
data such as prices (see e.g. Eaton and Kortum (2002), Simonovska and Waugh (2009),
and Waugh (2010)). As we show below in Section 5.2, however, the gravity constants can be
estimated without relying on a particular model if both trade flows and information regarding
trade frictions are observed.




                                                18
4.2     Comparative Statics
In this section, we consider how changes in model fundamentals affect trade flows and income.
We first consider infinitesimal changes and derive a closed form expression that yields the
elasticities of all exporter and importer shifters to all bilateral trade frictions. This expression
depends only on observed trade flows and the gravity constants. We then show the same
result holds for an arbitrary (non-infinitesimal) change to the trade friction matrix.

4.2.1    Local Comparative Statics

Consider a local change in any bilateral trade friction Kij ; how does this affect equilibrium
trade flows and incomes? It turns out it is possible to provide an analytical expression for the
elasticity of all exporter or importers shifters to all infinitesimal changes in bilateral trade
frictions.
    Define X to be the observed N × N trade flow matrix whose hi, jith element is Xij , Y
is the N × N diagonal income matrix whose ith diagonal element is Yi , and E is the N × N
diagonal income matrix whose ith diagonal element is Ei . Define the 2N × 2N matrix A as
follows:                                                        !
                                       (α − 1) Y βY − X
                               A≡                                 .
                                       αE − X T (β − 1) Y

Furthermore, define A+ to be the Moore-Penrose pseudo-inverse of A and A+      kl to be the
      th
hk, li element of A+ . The following proposition shows how all elasticities can be immedi-
ately determined from matrix A+ :

Proposition 3. Consider any general equilibrium gravity model yielding the matrix of equi-
librium trade, income and expenditure flows X, Y, E, respectively. Then:
    i) If A has rank 2N − 1, then:

       ∂ ln γl                                    ∂ ln δl
               = Xij × A+       +                                    +          +
                                                                                       
                        l,i + A N +l,j + c   and          = X ij × A N +l,i + A l,j + c   ,    (18)
      ∂ ln Kij                                   ∂ ln Kij

where c is a scalar that ensures the normalization C.5 holds.
    ii) If trade is balanced then A is rank 2N − 1 (1) when either α, β ≤ 0 or α, β > 1 or
|α| > 1 and β = 1 or |β| > 1 and α = 1; or (2) for all but a finite number of constellations
of (α, β) if trade costs are quasi-symmetric.

Proof. See Appendix A.5.

    We should note that the choice of the constant c (and hence the elasticities) will depend on
                                              1                   +      +              +        +
                                                       P                                          
the normalization chosen: given C.5, c = (α+β)Y W Xij    l Yl α Al,i + AN +l,j + β AN +l,i + Al,j ,


                                                 19
whereas the alternative normalization γ1 = 1 implies ∂∂lnlnKγ1ij = 0, so that c = Xij ×
(A1,i + AN +1,j ). We should also note that while the expression for the elasticities will hold
whenever A has rank 2N − 1, which apart from the sufficient conditions above can also be
checked directly given observed trade flows and a chosen set of gravity constants.
   Because all model outcomes (e.g. trade flows and location incomes) are functions of
the exporter and importer shifters, Proposition 3 provides a closed form solution for the
the complete set of model elasticities. In particular, it is straightforward to determine how
changing the trade costs from i to j affects trade flows between any other bilateral trade pair
k and l:13

        ∂ ln Xkl   ∂ ln γk   ∂ ln δl
                                     = Xij × A+      +         +         +
                                                                                 
                 =         +                  k,i + AN +k,j + AN +l,i + Al,j + 2c .                                       (19)
        ∂ ln Kij   ∂ ln Kij ∂ ln Kij

Similarly, Proposition 3 can be applied to determine how changing the trade costs from i to
j affects income in any location l:

    ∂ ln Yl     ∂ ln γl      ∂ ln δl
                                     = Xij × α A+         +               +         +
                                                                                           
            =α          +β                         l,i + AN +l,j + c + β AN +l,i + Al,j + c    .
   ∂ ln Kij    ∂ ln Kij     ∂ ln Kij
                                                                                             (20)
If trade flows are balanced and welfare can be written as in equation (12), then we can also
determine the elasticity of welfare in any location l to any change in trade costs from i to j:

        ∂ ln Wl          1
                           (α − 1) A+      +                     +         +
                                                                                  
                 = Xij ×            l,i + AN +l,j + c + (β − 1) AN +l,i + Al,j + c                                        (21)
        ∂ ln Kij         ρ

Hence, given observed trade flows and the gravity constants α and β (and ρ in the context
of welfare), all general equilibrium gravity models deliver identical predictions for all local
comparative statics. We use this powerful result in Section 5 to characterize the welfare-
maximizing set of trade friction reductions.

4.2.2     Global Comparative Statics

Now consider how an arbitrary change in the trade friction matrix K affects bilateral trade
flows. In what follows, we denote with a hat the ratio of the new to old value of the variable,
            new
i.e. x̂ ≡ xxold . The following proposition, which generalizes the results of Dekle, Eaton, and
Kortum (2008), provides an analytical expression relating the change in the exporter and
importer shifters to the change in trade frictions and the initial exporting and importing
shares:
  13                            ∂ ln Xkl           ∂ ln γk        ∂ ln δl
     If k = i and l = j, then   ∂ ln Kij   = 1+   ∂ ln Kij   +   ∂ ln Kij ,   where the addition of one accounts for the direct
effect on Kkl .


                                                                  20
Proposition 4. Consider any given set of observed trade flows X, gravity constants α and
β, and change in the trade friction
                                 n o matrix K̂. Then the percentage change in the exporter
and importer shifters, {γ̂i } and δ̂i , if it exists, will solve the following system of equations:


                              X  Xij                                 Yi   D̄i X
                                                                                       
                                                                                           Xji
                                                                                                 
            γ̂iα−1 δ̂iβ   =               K̂ ij δ̂ j and   γ̂iα δ̂iβ      +    =                     K̂ji γ̂j δ̂i .   (22)
                               j
                                   Yi                                  E i Ei    j∈S
                                                                                           Ei

Proof. See Appendix A.6.

    Note that equation (22) inherits the same mathematical structure as equations (4) and
(17). As a result, if trade is balanced (so that D̄i = 0 and Yi = Ei for all i ∈ S), then
part (i) of Theorem 1 proves that there will exist a solution to equation (22) and part (ii) of
Theorem 1 provides conditions for its uniqueness.
    As with the local comparative statics, equation (22) only depends on trade data and
parameters α and β; hence, for any given change in trade frictions, all the gravity trade
models with the same α and β must imply the same change in the exporter and importer
shifters γi and δi and hence trade flows and incomes. If welfare can be written as in equation
(12), the change in location and global welfare will also be the same.
    This proposition characterizes the comparative statics for a wide class of gravity trade
models. In the case where β = 0, it can be shown (see Online Appendix B.5) that the
comparative statics can be characterized using import shares alone. This special case (and
its welfare implications) is discussed in Proposition 2 of Arkolakis, Costinot, and Rodrı́guez-
Clare (2012).


5     Welfare maxizing trade friction changes
Armed with the theoretical results above, we finally turn to the question originally posed:
what is the set of changes in bilateral trade frictions that maximize welfare subject to an
arbitrary constraint?


5.1    The optimization problem
We first demonstrate how the local comparative static results from Proposition 3 can be used
to inform the choice of optimal trade policy, as well as estimate the potential welfare gains
from such a policy. As is well known, reducing trade frictions (e.g. increasing Kij ) increases
trade openness, thereby increasing welfare. In general, this implies trade policies that reduce
bilateral trade frictions are welfare enhancing. What is less understood, however, is how

                                                            21
to quantify the relative benefit of reducing various bilateral trade frictions. In particular,
we ask: how much should each bilateral trade friction be reduced in order to maximize the
increase in welfare when reducing trade frictions between a certain bilateral pair comes at
the expense of not being able to reduce trade frictions as much elsewhere? Having an answer
to this question seems necessary in order to understand how policy makers with limited
resources ought best allocate those resources.
    Before proceeding, we should note that because of the particular form of condition C.4,
our approach does not allow one to consider tariff revenue (as, e.g., in Ossa (2014)); in-
stead, our approach is best suited to the study of other trade policies such as infrastructure
development, non-tariff barriers, etc. that change trade frictions without directly affecting
income. Empirical evidence suggests these non-tariff trade costs comprise a significant por-
tion of trade policy restrictions (see e.g. Anderson and Van Wincoop (2004) and Looi Kee,
Nicita, and Olarreaga (2009)).
    Formally, consider a planner who seeks to choose a set of changes in trade frictions in order
to maximize a weighted average of the (first-order) change in welfare across all locations:
                                   XXX                ∂ ln Wl
                          max                    ωl            zij s.t. G (z) = 0,           (23)
                          {zij }
                                   l∈S i∈S j∈S
                                                      ∂ ln Kij

where ωl is the weight the planner places on the change in welfare in location l, zij is
the percentage change in the bilateral trade friction Kij , z is the N × N matrix whose
hi, ji element is zij and G (z) is a function which specifies the constraint under which the
                                              P P
planner operates. For example, G (z) = i∈S j∈S pij zij − B would reflect the fact that
the total expenditure on bilateral trade friction reductions has a budget of B (where the
price of a percentage increase in Kij is pij ). In general, G (·) captures whatever factors
prevent the planner from simply reducing trade frictions (increasing Kij ) as much as possible,
thereby making the problem economically interesting. Note that while our framework offers
no guidance on what form those constraints take, our procedure is equally valid for any
(differentiable) G (·).
     From equation (21), once the matrix A+ has been calculated from observed trade flows
and the gravity constants, the elasticity of welfare in any location l ∈ S with respect to
the change in trade costs between any two countries i ∈ S and j ∈ S, i.e. ∂∂ lnlnKWijl , can be
immediately determined from a linear combination of elements of the        n matrix. o We should
                                                                            ∂ ln Wl
note that while it is possible to calculate the set of welfare elasticities ∂ ln Kij   without the
                                                                                     i,j
use of equation (21), doing so would require changing each bilateral trade cost separately by
a small amount and recalculating the model equilibrium; since there are N 2 bilateral trade
costs, such a process would be onerous.

                                                        22
    Once the complete set of welfare elasticities is calculated equation (21), equation (23) is
simply a constrained optimization problem with the familiar first order necessary conditions
for all i ∈ S and j ∈ S:
                                      ∂ ln Wl       ∂G (z)
                                   ωl          =λ          .                              (24)
                                      ∂ ln Kij       ∂zij
The N 2 equations in equation (24) along with the constraint G (z) = 0 can then be jointly
solved to determine the welfare-maximizing trade cost changes z∗ and the Lagrange multiplier
λ.
    In what follows, we consider two special cases of equation (23): (1) a unilateral trade
policy governing import frictions; and (2) a multilateral trade policy where trade friction
reductions are non-discriminatory.

Welfare-maximizing unilateral trade friction reductions

Consider a particular location l ∈ S that only has the ability to reduce the trade frictions
from its importers. For simplicity, assume that G (z) ≡ 21 i∈S zil2 − 1, i.e. the cost of
                                                                 P

reducing (or increasing) location l’s import frictions is convex. Then equation (23) becomes:
                                                  X ∂ ln Wl              X
                                         max                    zil s.t.     zil2 = 1              (25)
                                        {zil }i∈S
                                                  i∈S
                                                      ∂ ln K il
                                                                         i∈S


The first order conditions (24) immediately imply that the welfare-maximizing unilateral
trade friction reductions {ziluni } are proportional to the welfare elasticities:

                                                              ∂ ln Wl
                                                   ziluni =            /λ,
                                                              ∂ ln Kij
                                    2  12
             P             ∂ ln Wl
where λ =        i∈S       ∂ ln Kij
                                                is the Lagrange multiplier, which captures how much the
elasticity of the change in welfare of a country to increasing the extent of trade friction
changes in the welfare-maximizing way: i.e. the “potential unilateral gains for trade.”

Welfare-maximizing multilateral “non-discriminatory” trade friction reductions

Consider now a planner who attempts to maximize a weighted average of the world-wide
increase in welfare subject to a “non-discrimination” constraint where a location must equally
reduce its trade frictions with all its exporting and importing partners. We assume that
the weights attached to each location are those so that the welfare maximization problem
corresponds to the competitive equilibrium (see part (ii) of Proposition 1). As in the previous


                                                              23
example, we assume for simplicity that the trade friction reduction costs are convex. Then
equation (23) becomes:
                                      X X ∂ ln W                    X
                              max                        zi zj s.t.     zi2 = 1.
                             {zi }i∈S
                                      i∈S j6=i
                                               ∂ ln K ij
                                                                    i∈S


(We exclude the i = j terms so that domestic trade costs remain unchanged). The first order
conditions (24) now imply that the welfare-maximizing multilateral trade friction reductions
{zi∗ } solve the following system of equations:

                                          X  ∂ ln W         ∂ ln W
                                                                       
                            2λzi∗     =                    +               zj∗ ⇐⇒
                                          j6=i
                                                   ∂ ln Kij ∂ ln Kji
                                          X
                              λ̃zi∗   =          (Xij + Xji ) zj∗ ,                                   (26)
                                          j6=i


where λ is the Lagrange multiplier, λ̃ ≡ 2ρ−1 λY W , and the second line relied on the re-
lationship between the world welfare elasticity and observed trade flows given in equation
                     X
(16) ∂∂lnlnKWij = ρ1 Y Wij . Equation (26) shows that the reduction in bilateral trade frictions which
maximizes world welfare is simply the eigenvector of the observed trade flows corresponding
to the largest eigenvalue (when the trade matrix is added to its transpose and has zeros along
the diagonal). Furthermore, that largest eigenvalue is proportional to the elasticity of world
welfare to increasing the extent of the trade friction reductions in a welfare-maximizing way.


5.2     Estimating the gravity constants
As Proposition 3 shows, given observed trade flows and a set of gravity constants, the welfare
elasticities can be calculated without specifying a particular micro-foundation of the gravity
model. While trade flows are easily observed, it is not obvious how to choose the correct
gravity constants, especially since Proposition 2 shows that observed trade flow data can be
rationalized for any set of gravity constants.
    One option would be to calibrate the gravity constants to values agreed upon by the lit-
erature. For example, in the context of an Armington trade model with intermediate inputs,
we could choose to match a trade elasticity of negative four (consistent with Simonovska
and Waugh (2009)) and a labor share in the production function of one-half (consistent with
Alvarez and Lucas (2007)) – hereafter the “AL” parameter constellation – yielding gravity
constants of α = − 23 , β = − 13 , and ρ = 2.14 Alternatively, we could choose to match Eaton
  14
    Alvarez and Lucas (2007) also report the results of their simulations for two alternative values of the
trade elasticity.


                                                           24
and Kortum (2002) – hereafter the “EK” parameter constellation – who find a trade elastic-
ity of 8.28 and a labor share of 0.21, yielding gravity constants of α = −1.05, β = −0.83,
and ρ = 1.73. We instead opt to estimate the gravity constants in order to best match the
observed general equilibrium forces present in the data.
    Given Proposition 2, we know that trade data alone is insufficient to estimate the gravity
constants; however, if both trade data and information about trade costs are observed, then
the gravity constants can be recovered. Suppose, for example, that (the change in) trade
costs is a function of a vector of observables T̂ij , i.e. ln K̂ij = T̂ij0 µ, where the prime denotes
a transpose. Then the gravity constants can be recovered in a two-stage estimation process.
First, one estimates the (log) change in exporter and importer shifters using the observed
(log) change in trade flows, ln X̂ijo :

                                ln X̂ijo = T̂ij0 µ + ln γ̂i + ln δ̂j + εij ,

where we interpret the residual εij as classical measurement error. Second, one estimates the
gravity constants by projecting the observed (log) change
                                                        n in income,
                                                              o       ln Ŷio , on the estimated
                                           
change in exporter and importer shifters ln γ̂iE and ln δ̂jE :

                                  ln Ŷio = α ln γ̂iE + β ln δ̂iE + νi .

While theoretically straightforward, this procedure is practically difficult, as the model pre-
dicts that the residual νi – unless it is pure measurement error – will be correlated with
both ln γ̂iE and ln δ̂iE . This omitted variable bias arises because any unobserved change in
the income shifter Bi (which causes the income of a location to be higher than observables
would imply) will enter the residual and increase both the location’s exports (through goods
market clearing) and imports (through balanced trade). As a result, estimates of α and β
will be biased upwards.
    An alternative procedure is to rely on the general equilibrium structure of the model.
By incorporating the general equilibrium effects within the estimator, there is no need for
a two stage estimation procedure. In particular, we use the structure of the model – which
incorporates both C.1 (corresponding to the first stage above) and C.4 (corresponding to the
second stage above) – to calculate the change in the exporter and importer shifters directly.
Formally, we can estimate the gravity constants α and β and the trade cost parameter µ by
minimize the squared errors of the observed change in trade costs and the predicted change




                                                    25
in trade costs:
                                     XX                                                                              2
       ∗   ∗    ∗
 (α , β , µ ) ≡ arg        min                     ln X̂ijo      −     T̂ij0 µ   − ln γ̂i T̂µ; α, β − ln δ̂j T̂µ; α, β         ,
                        α,β∈R,µ∈RS
                                        i    j
                                                                                        (27)
where we emphasize that the change in the origin and destination shifters will be deter-
mined in general equilibrium and depend on both the gravity constants and the trade cost
parameter.
    It turns out that equation (27) is best solved by first estimating the µ given a set of
gravity constants α and β and then solving for the α and β. Denote µ (α, β) as the trade
cost parameter which minimizes the squared error for a given α and β. Consider the following
first order approximations of the log change in the exporter and importer shifters:
                       X X ∂ ln γ                           X X ∂ ln δ
                                       i                                     j
               ln γ̂i T̂µ ≈               T̂kl0 µ and ln δ̂j T̂µ ≈               T̂kl0 µ.                                 (28)
                            k l
                                ∂ ln K kl
                                                                   k l
                                                                       ∂ ln K kl


By taking first order conditions and applying these first order approximations, we can derive
a straightforward closed form solution for µ (α, β) (once we turn the N × N matrices into
N 2 × 1 vectors).15 Let T̂ now denote the N 2 × S vector whose hi + j (N − 1)i row is the
1 × S vector T̂ij0 , D (α, β) is the N 2 × N 2 matrix whose hi + j (N − 1) , k + l (N − 1)i element
   ∂ ln Xij
is ∂ ln Kkl (which from Section 4.2 is a function only of the gravity constants and observed
trade flows), and ŷ denote the N 2 × 1 vector whose hi + j (N − 1)i row is ln X̂ijo . Then the
general equilibrium gravity estimator is:
                                                0              −1             0
                     µ (a, β) =        D (α, β) T̂     D (α, β) T̂        D (α, β) T̂ ŷ.                                 (29)

Equation (29) says that, to a first order, the general equilibrium estimator is the coefficient
one gets from of an ordinary squares regression of the observed hatted variables on a “general
equilibrium transformed” explanatory variable T̂ijGE :
                                                                         0
                                             ln X̂ijo   =        T̂ijGE          µ + εij ,

where:
                                                        X X ∂ ln X̂ij
                                            T̂ijGE ≡                                   T̂kl .
                                                         k         l
                                                                         ∂ ln K̂kl
  15
    In principal, the general equilibrium estimator could be calculated without applying a first-order ap-
proximation using an iterative procedure or through a non-linear least squares routine as in Anderson and
Van Wincoop (2003). However, the closed form solution greatly simplifies the estimation procedure. Fur-
thermore, Monte Carlo simulations suggest that the error arising from the first-order approximation used is
small.

                                                                  26
Intuitively, the general equilibrium transformed regressors capture the effect of the entire
set of explanatory variables on any particular observed bilateral trade flow.16 As a result,
µ (α, β) directly accounts for all (first-order) general equilibrium effects arising from the
network structure of trade flows.17
    We then find the gravity constants α and β which minimize the total squared error. From
equation (29) (and the fact that a projection matrix is idempotent), the estimation of the
gravity constants can be written as:
                                                                                                                     !
                                                                 0                  −1                   0
       (α∗ , β ∗ ) = arg min ŷ0       I − T̂        D (α, β) T̂          D (α, β) T̂            D (α, β) T̂             ŷ.   (30)
                           α,β∈R



We pursue a simple grid search method. Rather than searching directly across all (α, β)
space, we instead search across elasticities of substitution (σ) and labor shares (ζ), which
has the advantage of being easier to compare to existing estimates.


5.3        Data
We now describe the data we use to calculate the welfare-maximizing trade friction reductions
and estimate the gravity constants.
    Our trade data comes from the CEPII gravity data set of Head, Mayer, and Ries (2010).
This data set has several advantages: it covers bilateral trade flows between over two hundred
countries, allowing us to construct the nearly complete world trade network; it includes both
trade flow and GDP data, allowing us to measure own trade flows; and it is widely used,
allowing comparability with other empirical studies. We clean the data in three steps. First,
we construct own trade flows. To do so, we rely on the market clearing and balanced trade
conditions, which implies that own trade is simply the difference between observed income
and total exports or total imports, respectively.18 Second, to avoid inferring infinitely high
trade frictions between bilateral trade flows we replace any missing or zero bilateral trade
  16                                                                                        ∂ ln Xij
       One ought not be concerned that equation (19) provides elasticities for              ∂ ln Kij     whereas the elasticities
                                                                                           ∂ ln X̂ij
required for the general equilibrium estimator are the “hatted” elasticities               ∂ ln K̂kl
                                                                                                     ,   as it is straightforward
                                     new
                 ∂ ln X̂      ∂ ln Xij
to show that ∂ ln K̂ij =       ∂ ln Kkl ,
                                   i.e. the “hatted” elasticities are the same as the new elasticities. To see
                    kl
this, apply the comparative statics derivation in the proof of Proposition 3 to the global comparative static
system of equations in equation (22).
  17
     We show that our “general equilibrium” estimator of µ (α, β) can provide both efficiency improvements
and avoid certain problems of omitted variable bias when compared to the standard fixed effects estimator
of µ using Monte Carlo simulations in Online Appendix B.7.
  18
     If income exceeds total imports (exports), we define own trade flows as income less total exports (im-
ports); if income exceeds both total imports and exports, we define own trade flows as income less the average
of total imports and exports.



                                                             27
flows with a small positive value. Finally, we balance the trade flows; while this is not strictly
necessary, it guarantees that the equilibrium is unique, and as a result, the elasticities we
estimate are well-defined. To do so, we ignore the observed level of trade flows and instead
                                            Xij
treat the observed import shares λij ≡ P X       as the true data. We then find the unique set
                                            i ij
of incomes that are consistent with those import shares and balanced trade by solving the
following linear system of equations:
                                                           X
                                                 Yi =               λij Yj .
                                                           j


By the Perron-Frobenius theorem, there exists a unique (to-scale) set of Yi ;19 we pin down
                                        P
the scale with the normalization that i∈S Yi = 1. Given these equilibrium Yi , we then
define the balanced trade flows Xijb = λij Yj .20
    For the observables that change trade costs (i.e. T̂), we use WTO membership. The
WTO was founded on January 1, 1995, replacing the General Agreement on Tariffs and
Trade (GATT). Of the 201 countries in our trade data, 125 were original WTO members.
Between 1995 and 2005, an additional twenty-one countries joined the WTO.21 In what
follows, we assume that, apart from a common time trend ν, the only change in bilateral
frictions between 1995 and 2005 was a (common) reduction in trade costs (i.e. an increase
in K̂ij ) between new WTO members and all other WTO members:

                                                K̂ij = µT̂ij + ν,

where T̂ij is an indicator variable equal to one if either i or j is a new WTO member and
its trading partner is a new or existing WTO member. While this is admittedly a strong
assumption, note that by focusing on the change in trade flows rather than their level, we
allow for any effect of time-invariant variables (e.g. distance, common language, shared
border, etc.) on trade frictions.
  19
    The Perron-Frobenius
                  P         theorem guarantees that there exists a unique (to-scale) strictly positive vector
that solves Yi = κ j λij Yj for the largest value of κ > 0. Since import shares sum to one, it is straightforward
                                          P                        P
                                              Y                          Yi
to show that κ = 1 in this case: κ =   P Pi i          =   P            iP
                                                                                    = 1.
                                        i   j λij Yj           j   Yj     i   λij
  20
                                                                       P b      P              P Xji
     It is straightforward to see that these trade flows are balanced:  j Xji =  j λji Yi = Yi  j
                                                                                                  P       =
                                                                                                    j Xji
      P            P b
Yi = j λij Yj = j Xij .
  21
     The new members were Albania, Armenia, Bulgaria, China, Ecuador, Estonia, Georgia, Croatia, Jordan,
Kyrgyzstan, Cambodia, Lithuania, Moldova, Macedonia, Mongolia, Nepal, Oman, Panama, Saudi Arabia,
and Taiwan.




                                                           28
5.4    Results
We now report the estimated gravity constants, the estimated effects of joining the WTO,
and the welfare-maximizing trade policy implied by the observed trade flows and estimated
gravity constants.

Gravity Constants

Figure 2 presents the R-squared of the general equilibrium estimator on the gains from the
WTO across all values of the share of labor in the production function (ζ) and the elasticity
of substitution (σ) (which maps one-to-one to the gravity constants). As is evident, the
GE estimator maximizes the R-squared of the regression (or, equivalently, minimizes the
                                                                                                 1
squared error of equation (30)) when σ = 14.775 and ζ = 0.075. Recalling that α = 1−σζ
            1−ζ
and β = 1−ζσ      , this implies that the GE estimator most closely matches the data when α and
β are both large and negative; at the maximum R-squared, α = −30.2 and β = −27.9. From
Proposition 3, it can be shown that as as α and β approach negative infinity, the difference
between the direct effect of a trade cost shock and the indirect effect of a trade cost shock (i.e.
∂ ln Xij
∂ ln Kij
         − ∂∂ ln Xkl
              ln Kij
                     for some k 6= i and j 6= l) gets larger. Large negative gravity constants thus
imply that the general equilibrium effects are small relative to the direct effects of joining
the WTO.
     How does imposing the general equilibrium conditions affect the fit of the model? A
simple way of answering this question is to compare the fit of the GE estimator with a
traditional fixed effects estimator where the estimated exporter and importer shifters of each
country are not constrained to satisfy general equilibrium conditions. The R-squared of the
traditional fixed effects estimator is 0.1978, which is substantially larger than the 0.0234
of the general equilibrium estimator; however, a better fit is to be expected given that the
traditional fixed effects estimator includes 402 covariates compared to two covariates for the
general equilibrium estimator.

The effect of the WTO

Figure 3 depicts the estimated effect of WTO membership on bilateral trade frictions. At
the preferred estimates of the gravity constants, joining the WTO is associated with a 37
percent reduction in bilateral trade frictions (i.e. a 37 percent increase in Kij ). This result is
similar given alternative parameter constellations: WTO membership is estimated to reduce
bilateral trade frictions by 41 percent under either the EK parameter constellation or the
AL parameter constellation.



                                                29
    Figure 4 illustrates the average estimated change in welfare for new WTO members, ex-
isting WTO members, and non-members for all combinations of gravity constants given the
estimated coefficients reported in Figure 3 using the global comparative statics methodol-
ogy of Section 4.2.2. As with the effect of the WTO on trade frictions, the three gravity
constellations imply similar welfare effects: the maximum R-squared gravity constellation
implies that the welfare in countries joining the WTO increased on average by 18 percent,
compared to 13 percent and 12 percent increases with the EK and AL parameter constel-
lations, respectively. Existing WTO members also benefit, albeit to a much smaller extent,
with all three parameter constellations estimating roughly 1 percent increases in welfare.
Non-WTO members, however, are hurt by the resulting trade diversion of other countries
joining the WTO, although the welfare losses are less than half a percentage point under all
three parameter constellations.

Welfare-maximizing trade friction changes

Given the estimated gravity constants, we proceed to determine the welfare-maximizing
unilateral and bilateral trade friction reductions.22 As an example, Figure 5 depicts the
welfare-maximizing unilateral reduction in trade costs for the United States. The results are
intuitive: to maximize welfare in the U.S., it should concentrate its import friction reductions
on its major trading partners (e.g. Canada, Mexico, China, Brazil, and Western Europe), at
the expense of reducing its trade frictions only a small amount with less important trading
partners like African countries.
    How much does the U.S. (or any other country) benefit from reducing its import costs
unilaterally? Figure 6 depicts the Lagrange multiplier of the unilateral welfare maximization
problem (25) for each country, which recall can be interpreted as the “potential unilateral
gains for trade.” The potential benefits of unilateral trade friction reductions are the smallest
in countries with sizable domestic production relative to external trade such as the United
States, India, and Russia. The potential gains for smaller countries which engage in substan-
tial trade (e.g. Belgium) are larger. However, countries where political constraints results
to restricted trade – for example, North Korea, Burma, Somalia, Cuba, and Iraq – face the
largest potential gains from freer trade. Intuitively, these countries trade very little with a
number of large trading partners, which implies they have a large marginal utility of relaxing
those bilateral trade frictions.
    Figure 7 depicts the “non-discriminatory” reduction in trade frictions that maximizes the
  22
    The distribution of optimal trade friction changes are nearly identical when using either the AL or EK
constellation of gravity constants; see Online Appendix B.7.




                                                   30
increase in world welfare.23 Because the elasticity of world welfare to changes in bilateral
trade frictions is proportional to the level of trade flows, the welfare-maximizing multilateral
trade policy reduces trade frictions most for those countries with the largest trade flows, such
as the United States, China, and countries in Western Europe and least for countries like
those in Africa that trade less. Figure 8 illustrates the distribution of welfare effects of the
optimal multilateral trade policy across countries. There is substantial heterogeneity in the
welfare effects of the optimal policy: the countries that reduced their trade frictions most
benefit from the policy, while the majority of countries are actually made slightly worse off
from the resulting trade diversion. Of course, we emphasize that these quantitative results
depend on the given constraint G (·) where all changes to bilateral trade frictions are assumed
to be equally costly: the results would differ if there was heterogeneity across bilateral pairs
in the cost of trade friction reductions, although the methodology developed above could
still be applied.


6      Conclusion
In this paper, we first show that the general equilibrium forces in many gravity trade models
depend crucially on the value of two “gravity constants.” In particular, given observed trade
flows, these gravity constants are sufficient to determine all comparative statics of the model.
This result – along with a way of estimating the gravity constants themselves – allows us
to determine how any change in bilateral trade frictions will affect the model equilibrium
without needing to specify a particular underlying trade model. This paper hence contributes
to a growing literature emphasizing that the micro-economic foundations are not particularly
important for determining a trade model’s macro-economic implications.
    We use our results to analytically characterize the welfare-maximizing set of trade friction
reductions (to a first order) subject to an arbitrary constraint. Surprisingly, certain special
cases yield closed form solutions: for example, the welfare-maximizing non-discriminatory
multilateral trade policy is the eigenvector corresponding to the largest eigenvalue of the
observed trade flow matrix. In general, we view this as a necessary step toward determining
optimal trade policy in a many location general equilibrium model.
    By providing a universal framework for understanding the general equilibrium forces in
gravity trade models, we hope that this paper provides a step toward unifying the quan-
titative general equilibrium approach with the gravity regression analysis common in the
  23
    Since ∂∂lnlnKWij ∝ Xij > 0 from equation (16), the Perron-Frobenius theorem guarantees the vector of
trade friction changes that solve equation (26) will be strictly positive, i.e. it will be optimal for all countries
to reduce their trade frictions.



                                                        31
empirical trade literature. Toward this end, we have developed a toolkit that operationalizes
all the theoretical results presented in this paper, including the calculation of the equilib-
rium, identification, calculation of local and global comparative statics, and estimation.24 We
also hope the tools developed here can be extended to understand other general equilibrium
spatial systems, such as those governing the structure of cities.




 24
      The toolkit is available for download on Allen’s website.


                                                      32
References
Aliprantis, C. D., and K. Border (2006): Infinite Dimensional Analysis: A Hitchhiker’s
 Guide. Springer.

Allen, T., and C. Arkolakis (2014): “Trade and the Topography of the Spatial Econ-
 omy,” The Quarterly Journal of Economics.

Allen, T., C. Arkolakis, and X. Li (2014): “On the existence and uniqueness of trade
 equilibria,” mimeo, Northwestern and Yale Universities.

Alvarez, F., and R. E. Lucas (2007): “General Equilibrium Analysis of the Eaton-
 Kortum Model of International Trade,” Journal of Monetary Economics, 54(6), 1726–1768.

Anderson, J. E. (1979): “A Theoretical Foundation for the Gravity Equation,” American
 Economic Review, 69(1), 106–116.

Anderson, J. E., and E. Van Wincoop (2003): “Gravity with Gravitas: A Solution to
 the Border Puzzle,” American Economic Review, 93(1), 170–192.

        (2004): “Trade Costs,” Journal of Economic Literature, 42(3), 691–751.

Arkolakis, C. (2010): “Market Penetration Costs and the New Consumers Margin in
 International Trade,” Journal of Political Economy, 118(6), 1151–1199.

Arkolakis, C., A. Costinot, D. Donaldson, and A. Rodrı́guez-Clare (2012):
 “The Elusive Pro-Competitive Effects of Trade,” mimeo.

Arkolakis, C., A. Costinot, and A. Rodrı́guez-Clare (2012): “New Trade Models,
 Same Old Gains?,” American Economic Review, 102(1), 94–130.

Arkolakis, C., S. Demidova, P. J. Klenow, and A. Rodrı́guez-Clare (2008):
 “Endogenous Variety and the Gains from Trade,” American Economic Review, Papers and
 Proceedings, 98(4), 444–450.

Arkolakis, C., N. Ramondo, A. Rodrı́guez-Clare, and S. Yeaple (2013): “In-
 novation and production in the global economy,” Discussion paper, National Bureau of
 Economic Research.

Armington, P. S. (1969): “A Theory of Demand for Products Distinguished by Place of
 Production,” International Monetary Fund Staff Papers, 16, 159–178.



                                          33
Atkeson, A., and A. Burstein (2010): “Innovation, Firm Dynamics, and International
 Trade,” Journal of Political Economy, 118(3), 433–489.

Baldwin, R., and D. Taglioni (2006): “Gravity for dummies and dummies for gravity
 equations,” Discussion paper, National Bureau of Economic Research.

Bartelme, D. (2014): “Trade Costs and Economic Geography: Evidence from the US,”
 mimeo.

Bernard, A. B., J. Eaton, J. B. Jensen, and S. Kortum (2003): “Plants and Pro-
 ductivity in International Trade,” American Economic Review, 93(4), 1268–1290.

Burstein, A., and J. Cravino (2012): “Measured aggregate gains from international
 trade,” Discussion paper, National Bureau of Economic Research.

Burstein, A., and J. Vogel (2012): “International Trade, Technology, and the Skill
 Premium,” Manuscript, Columbia University and UCLA.

Caliendo, L., and F. Parro (2010): “Estimates of the Trade and Welfare Effects of
 NAFTA,” Manuscript, University of Chicago and Yale University.

Chaney, T. (2008): “Distorted Gravity: The Intensive and Extensive Margins of Interna-
 tional Trade,” American Economic Review, 98(4), 1707–1721.

Chor, D. (2010): “Unpacking Sources of Comparative Advantage: A Quantitative Ap-
 proach,” forth. Journal of International Economics.

Costinot, A. (2009): “An elementary theory of comparative advantage,” Econometrica,
 77(4), 1165–1192.

Costinot, A., D. Donaldson, and I. Komunjer (2010): “What Goods Do Countries
 Trade? A Quantitative Exploration of Ricardo’s Ideas,” Forthcoming, Review of Economic
 Studies.

Dekle, R., J. Eaton, and S. Kortum (2008): “Global Rebalancing with Gravity: Mea-
 suring the Burden of Adjustment,” IMF Staff Papers, 55(3), 511–540.

Di Giovanni, J., and A. A. Levchenko (2008): “Putting the Parts Together: Trade,
 Vertical Linkages, and Business Cycle Comovement,” forthcoming, American Economic
 Journal: Macroeconomics.

         (2009): “Firm Entry, Trade, and Welfare in Zipf’s World,” Manuscript, University
  of Michigan.

                                           34
Eaton, J., and S. Kortum (2002): “Technology, Geography and Trade,” Econometrica,
 70(5), 1741–1779.

Eaton, J., S. Kortum, and F. Kramarz (2011): “An Anatomy of International Trade:
 Evidence from French Firms,” Econometrica, 79(5), 1453–1498.

Eaton, J., S. Kortum, B. Neiman, and J. Romalis (2011): “Trade and the Global
 Recession,” NBER Working Paper, 16666.

Fajgelbaum, P. D., and A. K. Khandelwal (2013): “Measuring the unequal gains from
  trade,” Discussion paper, Working Paper.

Fan, H., E. Lai, and H. Qi (2013): “Global Gains from Reduction of Trade Costs,”
  Unpublished manuscript.

Feenstra, R. (2003a): Advanced International Trade. Princeton University Press, Prince-
 ton, New Jersey.

Feenstra, R. C. (2003b): “A Homothetic Utility Function for Monopolistic Competition
 Models, Without Constant Price Elasticity,” Economics Letters, 78(1), 79–86.

Harrigan, J. (1996): “Openness to Trade in Manufactures in the OECD,” Journal of
 international economics, 40(1), 23–39.

Head, K., and T. Mayer (2013): Gravity equations: Workhorse, toolkit, and cookbook.
 Centre for Economic Policy Research.

Head, K., T. Mayer, and J. Ries (2010): “The erosion of colonial trade linkages after
 independence,” Journal of International Economics, 81(1), 1–14.

Head, K., T. Mayer, and M. Thoenig (2014): “Welfare and Trade Without Pareto,” .

Helpman, E. (1998): “The Size of Regions,” Topics in Public Economics. Theoretical and
 Applied Analysis, pp. 33–54.

James, M. (1978): “The generalised inverse,” The Mathematical Gazette, pp. 109–114.

Karlin, S., and L. Nirenberg (1967): “On a theorem of P. Nowosad,” Journal of Math-
 ematical Analysis and Applications, 17(1), 61–67.

Kehoe, T. J. (1985): “Multiplicity of equilibria and comparative statics,” The Quarterly
 Journal of Economics, pp. 119–147.


                                          35
Kimball, M. S. (1995): “The Quantitative Analytics of the Basic Neomonetarist Model,”
 Journal of Money, Credit and Banking, pp. 1241–1277.

Krugman, P. (1980): “Scale Economies, Product Differentiation, and the Pattern of Trade,”
 American Economic Review, 70(5), 950–959.

Looi Kee, H., A. Nicita, and M. Olarreaga (2009): “Estimating Trade Restrictiveness
 Indices,” The Economic Journal, 119(534), 172–199.

Mas-Colell, A., M. D. Whinston, and J. R. Green (1995): Microeconomic Theory.
 Oxford University Press, Oxford, UK.

Melitz, M., and S. Redding (2014): “New Trade Models, New Welfare Implications,”
 Forthcoming, American Economic Review.

Melitz, M. J. (2003): “The Impact of Trade on Intra-Industry Reallocations and Aggregate
 Industry Productivity,” Econometrica, 71(6), 1695–1725.

Novy, D. (2010): “International Trade Without CES: Estimating Translog Gravity,” CEP
 Discussion paper, 1031.

Ossa, R. (2014): “Trade Wars and Trade Talks with Data,” American Economic Review,
 104(12), 4104–46.

Ramondo, N., A. Rodrı́guez-Clare, and M. Saborio-Rodriguez (2012): “Scale Ef-
 fects and Productivity Across Countries: Does Country Size Matter?,” mimeo, University
 of California, Berkeley.

Redding, S., and A. J. Venables (2004): “Economic geography and international in-
 equality,” Journal of international Economics, 62(1), 53–82.

Redding, S. J. (2014): “Goods Trade, Factor Mobility and Welfare,” mimeo.

Shafer, W., and H. F. Sonnenschein (1993): “Market demand and excess demand
  functions,” .

Simonovska, I., and M. Waugh (2009): “The Elasticity of Trade: Estimates and Evi-
  dence,” Manuscript, University of California, Davis and New York University.

Tinbergen, J. (1962): “Shaping the world economy; suggestions for an international eco-
  nomic policy,” .

Waugh, M. (2010): “International Trade and Income Differences,” forthcoming, American
 Economic Review.

                                           36
                                                                    Table 1: Mapping of trade models to Universal Gravity framework
                                                                                                Labor
                                                                                                Share
                                                                          Subs.    Hetero.                                         Trade    Integrability                                                                                            Condition    for   uniqueness    Condition for uniqueness
     Model                          Citation                                                    in Pro-   Additional Param.                                  Mapping to ρ      Mapping to α                       Mapping to β
                                                                          Elast.   Param.                                          Elast.   Restrictions                                                                                             (general)                        (quasi-symmetry)
                                                                                                duc-
                                                                                                tion

     Trade Models
                                    Armington    (1969);  Anderson
     Armington, intermediate in-                                                                                                                                                1                                  1−ζ                                                                     1
                                    (1979); Anderson and Van Win-         σ        N/A          ζ         N/A                      σ−1      N/A              (σ − 1) (1 − ζ)   1−σ                                1−σζ                               σ≥1                              σ≥   2
     puts
                                    coop (2003)
     Monopolistic       competi-
                                    Krugman (1980) (with intermedi-                                                                                                              1                                 1−ζ                                                                     1
     tion, homogeneous firms,                                             σ        N/A          ζ         N/A                      σ−1      N/A              (σ − 1) (1 − ζ)   1−σζ                               1−σζ                               σ≥1                              σ≥   2
                                    ates inputs)
     intermediate inputs
     Perfect competition, inter-    Eaton and Kortum (2002); Dekle,                θ                                                        θ > σ − 1, θ >                         1                                1−ζ                                                                    1
                                                                          σ                     ζ         N/A                      θ                         θ (1 − ζ)         1−(θ+1)ζ                           1−(θ+1)ζ                           θ>0                              σ≥   2
     mediate inputs                 Eaton, and Kortum (2008)                       (Frechet)                                                0
     Monopolistic       competi-    Melitz (2003); Eaton, Kortum, and
     tion, heterogeneous firms,     Kramarz (2011); Arkolakis, Demi-                                                                        θ > σ − 1, θ >
                                                                          σ        θ (Pareto)   1         N/A                      θ                         θ                 − 1θ                               0                                  θ>0                              θ>0
     exporting fixed costs in       dova, Klenow, and Rodrı́guez-Clare                                                                      0
     destination                    (2008); Chaney (2008)
     Monopolistic       competi-
     tion, heterogeneous firms,                                                                                                             θ > σ − 1, θ >                         σ−1                                                                                                σ ≥ 1 or σ ≤ 1 and 2 1−σ
                                                                                                                                                                                                                                                                                                            σ
                                                                                                                                                                                                                                                                                                               ≥
                                    Di Giovanni and Levchenko (2009)      σ        θ (Pareto)   1         N/A                      θ                         θ                 − θσ−σ+1                           0                                  σ≥1
     exporting fixed costs in                                                                                                               0                                                                                                                                         θ > 1−σ
                                                                                                                                                                                                                                                                                           σ
     origin
                                                                                                                                                                                                                                                     σ ≥ 1 or σ <                1    previous regions or σ < 1
     Monopolistic competition,
                                                                                                                                                                                                                                                     and (1 − σ) (1 − ζ)         >    and 2 (1 − σ) (1 − ζ)   >
     heterogeneous firms, flex-     Arkolakis (2010) (with intermediate                                   η : share of exporting            θ > σ − 1, θ >                                    (σ−1)                            (σ−1)(1−ζ)
                                                                          σ        θ (Pareto)   ζ                                  θ                         θ (1 − ζ)         − (θ+1)(σ−1)ζ−(σ−1)+(1−η)(θ−σ+1)   − (θ+1)(σ−1)ζ−(σ−1)+(1−η)(θ−σ+1)   (1 − σ) (1 − ζ)             +    (1 − σ) (1 − ζ)         +
     ible exporting fixed costs,    inputs)                                                               in foreign labor                  0
                                                                                                                                                                                                                                                     θ (σ − 1) ζ                 +    θ (σ − 1) ζ             +
     intermediate inputs
                                                                                                                                                                                                                                                     (1 − η) (θ − σ + 1) > 0          (1 − η) (θ − σ + 1) > 0


     Extensions




37
                                                                                                          η : sector spending
                                    Chor (2010); Costinot, Donaldson,              θ
     Multiple sectors                                                     σ                     1         share (assumed con-      θ        N/A              θ                 − 1θ                               0                                  θ>0                              θ>0
                                    and Komunjer (2010)                            (Frechet)
                                                                                                          stant across sectors)
                                    Caliendo and Parro (2010) (with                                       η : sector spending
     Multiple sectors with inter-                                                  θ                                                                                               1                                1−ζ
                                    symmetric IO structure and con-       σ                     ζ         share (assumed con-      θ        N/A              θ (1 − ζ)         1−(θ+1)ζ                           1−(θ+1)ζ                           θ>0                              θ>0
     mediate goods                                                                 (Frechet)
                                    stant σ)                                                              stant across sectors)
                                                                                                          a        :productivity
                                    Allen and Arkolakis (2014); Help-                                                                                                              1−b                                a+1                            (sufficient conditions) σ ≥ 1,   (sufficient conditions) σ ≥
     Economic geography models                                            σ        N/A          1         spillover; b: amenity    σ−1      N/A              σ−1               1+b(σ−1)+σa                        1+b(σ−1)+σa                                                         1
                                    man (1998); Redding (2014)                                                                                                                                                                                       a + b ≤ 0, a > −1, b < 1         2
                                                                                                                                                                                                                                                                                        , a + b ≤ 0, a > −1, b < 1
                                                                                                          spillover

     Notes: This table includes a (non-exhaustive) list of trade models that can be examined within the universal gravity framework.
                           Figure 1: Existence and Uniqueness




Notes: This figure shows the regions in (α, β) space for which the gravity equilibrium is
unique generally and in the special case when trade frictions are quasi-symmetric. Existence
can be guaranteed throughout the entire region with the exception of when α + β = 1 or
α = β = 1.




                                            38
                                                       Figure 2: Estimating the gravity constants
                                                                 R−squared of GE Regression
                                     15

                                               Maximum R−squared                                                         0.023




                                                                                                                         0.022


                                     10
     Elasticity of substitution: σ




                                                          Eaton and Kortum (2002)                                        0.021




                                                                                                                         0.02



                                      5                                             Alvarez and Lucas (2007)
                                                                                                                         0.019




                                                                                                                         0.018



                                      0
                                          0   0.1   0.2      0.3     0.4       0.5      0.6      0.7     0.8   0.9   1
                                                             Share of labor in production function: ζ

Notes: This figure shows the R-squared of the general equilibrium estimator for the effect of
joining the WTO on bilateral trade flows for all combinations of the elasticities of substitution
and the share of labor in the production function. The yellow star indicates where the R-
squared is maximized (at σ = 13.775 and ζ = 0.075), which corresponds to gravity constants
of α = −30.2 and β = −27.9. Also indicated are the parameter values used in Eaton and
Kortum (2002) (diamond) and the Alvarez and Lucas (2007) (circle).




                                                                                    39
                                          Figure 3: The effect of the WTO on bilateral trade frictions
                                                                     Effect of WTO on trade costs


                                     14    Maximum R−squared
                                           0.37


                                     12
     Elasticity of substitution: σ




                                     10
                                                       Eaton and Kortum (2002)
                                                       0.41

                                      8




                                      6
                                                                                     Alvarez and Lucas (2007)
                                                                                     0.41

                                      4




                                      2


                                          0.1    0.2       0.3        0.4         0.5       0.6        0.7      0.8   0.9   1
                                                                 Share of labor in production function: ζ

Notes: This figure shows the iso-contours of the estimated effect of the WTO on bilateral
trade frictions for all combinations of the elasticities of substitution and the share of labor in
the production function. The yellow star indicates where the R-squared is maximized; also
indicated are the estimated gains from the WTO using parameter values from Eaton and
Kortum (2002) (diamond) and Alvarez and Lucas (2007) (circle).




                                                                               40
                                                   Figure 4: The effect of the WTO on welfare
     Elasticity of substitution: σ                                        New WTO members
                                     14    Maximum R−squared
                                           0.181
                                     12
                                     10                Eaton and Kortum (2002)
                                      8                0.132
                                      6                                              Alvarez and Lucas (2007)
                                      4                                              0.123
                                      2
                                          0.1    0.2       0.3        0.4         0.5       0.6        0.7      0.8   0.9   1
                                                                 Share of labor in production function: ζ
                                                                        Existing WTO members
     Elasticity of substitution: σ




                                     14    Maximum R−squared
                                           0.0122
                                     12
                                     10                Eaton and Kortum (2002)
                                      8                0.00787
                                      6                                              Alvarez and Lucas (2007)
                                      4                                              0.00687
                                      2
                                          0.1    0.2       0.3        0.4         0.5       0.6        0.7      0.8   0.9   1
                                                                 Share of labor in production function: ζ
                                                                          Non WTO members
     Elasticity of substitution: σ




                                     14    Maximum R−squared
                                           −0.00046
                                     12
                                     10                Eaton and Kortum (2002)
                                      8                −0.0036
                                      6                                              Alvarez and Lucas (2007)
                                      4                                              −0.0048
                                      2
                                          0.1    0.2       0.3        0.4         0.5       0.6        0.7      0.8   0.9   1
                                                                 Share of labor in production function: ζ

Notes: This figure shows the iso-contours of the estimated effect of the WTO on welfare for
all combinations of the elasticities of substitution and the share of labor in the production
function. The yellow star indicates where the R-squared is maximized; also indicated are
the estimated gains from the WTO using parameter values from Eaton and Kortum (2002)
(diamond) and Alvarez and Lucas (2007) (circle). The top panel reports the average change
in welfare for all countries who joined the WTO between 1995 and 2005; the middle panel
reports the average change in welfare for all countries already in the WTO in 1995; and the
bottom panel reports the average change in welfare for all non-WTO members.




                                                                               41
                       Figure 5: Optimal unilateral trade friction reduction for the U.S.




       Optimal reduction in import frictions for U.S.
       (4.2e−02,.63]
       (1.2e−02,4.2e−02]
       (4.5e−03,1.2e−02]
       (1.4e−03,4.5e−03]
       (6.3e−04,1.4e−03]
       (2.4e−04,6.3e−04]
       (1.0e−04,2.4e−04]
       (1.2e−05,1.0e−04]
       (2.1e−06,1.2e−05]
       [−3.9e−06,2.1e−06]
       No data



Notes: This figure shows the set of unilateral reductions in import trade frictions for the
United States that maximize its change in welfare subject to the norm of the total reductions
remaining constant. Countries are sorted by deciles; red indicates a greater reduction in trade
frictions while blue indicates a smaller reduction in trade frictions.


            Figure 6: Potential welfare gains from unilateral trade friction reductions




       Value of optimal reduction in import frictions
       (9.7e−02,.26]
       (6.8e−02,9.7e−02]
       (5.3e−02,6.8e−02]
       (4.6e−02,5.3e−02]
       (3.9e−02,4.6e−02]
       (3.1e−02,3.9e−02]
       (2.4e−02,3.1e−02]
       (1.9e−02,2.4e−02]
       (1.5e−02,1.9e−02]
       [1.7e−03,1.5e−02]
       No data



Notes: This figure shows the elasticity of each country’s welfare to increasing the amount
of unilateral trade friction reductions in the optimal way (i.e. the Lagrange multiplier of
equation (25)). Countries are sorted by deciles; red indicates a greater potential welfare gain
while blue indicates a smaller potential welfare gain.




                                                        42
                              Figure 7: World optimal multilateral trade friction reduction




       World welfare maximizing
       reduction in trade frictions
       (6.8e−02,.46]
       (2.0e−02,6.8e−02]
       (6.3e−03,2.0e−02]
       (2.4e−03,6.3e−03]
       (1.2e−03,2.4e−03]
       (5.8e−04,1.2e−03]
       (3.3e−04,5.8e−04]
       (1.1e−04,3.3e−04]
       (2.5e−05,1.1e−04]
       [3.4e−13,2.5e−05]
       No data



Notes: This figure shows the set of non-discriminatory country reductions in trade frictions
that maximizes the world welfare (where the country Pareto weights are those imposed by the
competitive equilibrium). Countries are sorted by deciles; red indicates a greater reduction
in trade frictions while blue indicates a smaller reduction (or even increase) in trade frictions.



      Figure 8: Welfare gains from world optimal multilateral trade friction reduction




       Welfare gain from optimal world tariff
       (5.1e−03,6.1e−02]
       (1.5e−03,5.1e−03]
       (6.5e−04,1.5e−03]
       (1.2e−04,6.5e−04]
       (−6.7e−06,1.2e−04]
       (−8.6e−05,−6.7e−06]
       (−1.9e−04,−8.6e−05]
       (−2.8e−04,−1.9e−04]
       (−5.5e−04,−2.8e−04]
       [−2.9e−03,−5.5e−04]
       No data



Notes: This figure shows distribution of welfare gains from an optimal non-discriminatory
multilateral trade friction reduction. In particular, we report the welfare gain each country
would achieve if all countries in the world were to alter their trade frictions in order to maxi-
mize world welfare (where the country Pareto weights are those imposed by the competitive
equilibrium. Countries are sorted by deciles; red indicates a greater increase in welfare while
blue indicates a smaller increase in welfare.



                                                           43
A     Proofs
A.1     Proof of Theorem 1
We analyze a transformed system by defining xi ≡ Bi γiα−1 δiβ and yi ≡ Bi γiα δiβ−1 . Then it
                            α       1−α            1                                      1−β   β   1
can be shown that δi = xiβ+α−1 yiβ+α−1 Bi1−α−β and γi = xiβ+α−1 yiβ+α−1 Bi1−α−β so that for any
                                N ×N
set of {Bi } ∈ RN                                         2
                 ++ , {Kij } ∈ R++ , {α, β} ∈ {(α, β) ∈ R |α + β 6= 1}, the equilibrium of a
general equilibrium gravity model can be written using
                                       X                   1              α               1−α
                                xi =           Kij Bj1−α−β xjα+β−1 yjα+β−1 ,                            (31)
                                       j


and
                                       X                       1          1−β               β

                             yi =               Kji Bj1−α−β xjα+β−1 yjα+β−1 ,                           (32)
                                           j


and the world income is taken to be 1 as numeraire,
                                       X               1              α               β

                                 1=             Bi1−α−β xiβ+α−1 yiβ+α−1 .                               (33)
                                           i


The proof of Theorem 1 proceeds in four parts. In the first part, we consider a general
mathematical structure, for which the general equilibrium gravity model is a special case,
and show existence for the general mathematical structure. Namely we show that for any
positive F and H, and a, b, c, and d, there exits a solution to

                                                                 Fi,j xaj yjb
                                                       P
                                                            j
                                       xi = P                                                           (34)
                                                           i,j     Fi,j xaj yjb
                                                                 Hij xcj yjd
                                                       P
                                                            j
                                       yi = P                                     .                     (35)
                                                           i,j     Hij xcj yjd

Note that their structure is different from the general equilibrium trade model in two ways.
First, in the general equilibrium trade model, the denominators of the right-hand-side should
be 1. Second, the general equilibrium trade model should also satisfy (33). We take care of
these differences in the second part. We prove lemmas that will allow us to convert the
existence result of the general mathematical result to the existence of the particular case of
the gravity trade model. In the third and fourth parts, we use the system of the second
part to prove existence and uniqueness for the general equilibrium trade models, respectively.



                                                           44
A.1.1   Part 1 : the general case

We start with the result for the general mathematical system, stated as the following lemma.
For the proof, we use a version of Schauder’s fixed point theorem (FPT for short). The
original statement is found in Aliprantis and Border (2006).
Theorem 3. (Schauder’s FPT) Suppose that D ⊂ RN , where D is a convex and compact
set. If a continuous function f : D → D satisfies the condition that f (D) is a compact
subset of D, then there exists x ∈ D such that f (x) = x.
Lemma 1. Consider the system the equation (34) and (35). Then the system has a positive
solution x, y ∈ RS+ and all its possible solutions are positive.
Proof. To apply the Schauder’s FPT, we set up a subset D of R2S such that D satisfies the
conditions in Schauder’s FPT.
   Now consider the system (34)-(35). We define the set Γ as

        Γ ≡ (x, y) ∈ ∆ RS × ∆ RS ; mx ≤ xi ≤ Mx , my ≤ yi ≤ My
                              
                                                                          for all i ,

and the following constants

                                                Fi,j
                                      Mx ≡ max P
                                                  i Fi,j
                                            i,j

                                                Fi,j
                                      mx ≡ min P
                                                 i Fi,j
                                            i,j

                                                Hi,j
                                      My ≡ max P
                                                  i Hi,j
                                            i,j

                                                Hi,j
                                      my ≡ min P         .
                                                 i Hi,j
                                            i,j


Γ is convex and compact subset of R2S .
    We define the following operator for d = (x, y) ∈ Γ.

                              T d = T (x, y)
                                     = ((T x (x, y)) , (T y (x, y))) ,

where
                                                       a b
                                                   P
                                               j Fi,j xj yj
                               Tix (x, y) = P P           a b
                                             i   j Fi,j xj yj
                                                        c d
                                             P
                                 y             j Hi,j xj yj
                               Ti (x, y) =  P  P          c d
                                                              .
                                             i   j Hi,j xj yj


                                                 45
It is easy to show that

                          mx ≤ Tix (x, y) ≤ Mx , my ≤ Tix (x, y) ≤ My

so that the operator T is from Γ to Γ.
    To show that T is continuous, it suffices to show that Tix and Tiy are continuous for all i.
Since the range is compact, these functions are trivially continuous.
    Since Schauder’s FPT is applied for T, then there exists a solution to the system. Also
by construction, any fixed points satisfy for all i,

                                        0 < m x ≤ xi
                                        0 < my ≤ yi .




A.1.2    Part 2 : from the general mathematical system to GE trade model

Second, we prove a result that will allow us to map the general equilibrium gravity model
to the general mathematical system. This subsection consists of several lemmas. In Lemma
2, in the general equilibrium trade models, the double-sum terms in (34) and (35) should
coincide i.e.
                             XX                    XX
                                    Fi,j xaj yjb =    Hi,j xcj yjd .
                               i   j                   i    j

Next, in Lemma 3, we show that a simple transformation of (x, y) that solves equations (34)
and (35) also solves (31) and (32). To show the existence of the general equilibrium trade
model, we still need to show that the normalization equation (33) is satisfied. Lemma 4
takes care of this issue.
   The following lemma shows that the double-sum terms should coincide with each other.

Lemma 2. Suppose that (x, y) satisfies (34) and (35) with

                                   α                       1−α
                              a=       ,               b=
                                 1−α−β                    α+β−1
                                  1−β                       β
                              c=       ,               d=
                                 α+β−1                    α+β−1
                                          1                           1
                           Fi,j = Kij Bj1−α−β ,        Hi,j = Kji Bj1−α−β .




                                                  46
Then we have
                           X                1          α              1−α           X                      1           1−β           β

                                  Kij Bj1−α−β xjα+β−1 yjα+β−1 =                               Kji Bj1−α−β xjα+β−1 yjα+β−1 .
                           i,j                                                          i,j


Proof. Note that

                                                           X                        1              α           1−α
                                            x i = λx                  Kij Bj1−α−β xjα+β−1 yjα+β−1 ,
                                                                 j

where
                                                         X                      1              α           1−α
                                                λx =                 Kij Bj1−α−β xjα+β−1 yjα+β−1 .
                                                           i,j
                                          1−β        β                  1
Multiply both sides by xiβ+α−1 yiβ+α−1 Bi1−α−β , which yields:

        α            β         1                X                        1           α             1−α
                                                                                                                     1−β       β       1
                                                                                                                                             
      β+α−1        β+α−1     1−α−β                                      1−α−β       α+β−1          α+β−1               β+α−1   β+α−1   1−α−β
     xi       yi           Bi            = λx        Kij Bj                     xj              yj                  × xi     yi      Bi        .
                                                 j


Now sum over all i and rearrange to solve for λx :

X           α        β             1            XX                      1      α      1−α
                                                                                             1−β       β       1
                                                                                                                     
          β+α−1    β+α−1         1−α−β                                 1−α−β  α+β−1  α+β−1     β+α−1   β+α−1   1−α−β
     xi           yi       Bi            = λx                    Kij Bj      xj     yj      × xi     yi      Bi        ⇐⇒
 i                                               i       j
                                                                                                α              β             1
                                                                                P
                                                             xiβ+α−1 yiβ+α−1 Bi1−α−β     i
                                   λx =              1       α      1−α
                                                                            1−β            β       1
                                                                                                         
                                        P P         1−α−β  α+β−1   α+β−1           β+α−1   β+α−1   1−α−β
                                         i  j Kij Bj      xj      yj         × xi        yi      Bi
                                                                                                       α           β             1
                                                                   β+α−1
                                                                                    P
                                                               i xi      yiβ+α−1 Bi1−α−β
                                         =              1       α      1−α
                                                                                1−β            β       1
                                                                                                              .
                                           P P          1−α−β  α+β−1   α+β−1            β+α−1   β+α−1   1−α−β
                                            i   j Kij Bj      xj      yj          × xi        yi      Bi

Now let us consider the second equilibrium condition:
                                                             X                      1           1−β             β

                                            y i = λy                  Kji Bj1−α−β xjα+β−1 yjα+β−1
                                                                 j


where                                                                                         1−β          β
                                                         X                      1
                                                λy =                 Kji Bj1−α−β xjα+β−1 yjα+β−1 .
                                                           i,j




                                                                            47
                                     α          1−α            1
Multiply both sides by xiβ+α−1 yiβ+α−1 Bi1−α−β :
      α        1−α      1
                                   X        1      1−β    β
                                                                  α        1−α      1
                                                                                          
       β+α−1   β+α−1   1−α−β                1−α−β  α+β−1  α+β−1     β+α−1   β+α−1   1−α−β
y i × xi     yi      Bi        = λy   Kji Bj      xj     yj      × xi     yi      Bi        ⇐⇒
                                                      j
             α         β         1               X               1      1−β    β
                                                                                      α        1−α      1
                                                                                                              
           β+α−1     β+α−1     1−α−β                            1−α−β  α+β−1  α+β−1     β+α−1   β+α−1   1−α−β
          xi        yi        Bi         = λy             Kji Bj      xj     yj      × xi     yi      Bi
                                                      j


Now sum over all i and rearrange to solve for λy :

X       α         β         1             XX                     1      1−β    β
                                                                                      α        1−α      1
                                                                                                              
      β+α−1     β+α−1     1−α−β                                 1−α−β  α+β−1  α+β−1     β+α−1   β+α−1   1−α−β
     xi        yi        Bi        = λy                   Kji Bj      xj     yj      × xi     yi      Bi        ⇐⇒
 i                                         i      j
                                                                                    α           β            1
                                                          β+α−1
                                                                           P
                                                      i xi      yiβ+α−1 Bi1−α−β
                              λy =              1      1−β      β
                                                                       α             1−α      1
                                                                                                    
                                   P P         1−α−β  α+β−1   α+β−1           β+α−1   β+α−1   1−α−β
                                    i  j Kji Bj      xj      yj         × xi        yi      Bi
                                                                                        α           β            1
                                                             β+α−1
                                                                           P
                                                          i xi     yiβ+α−1 Bi1−α−β
                                   =           α         1−α      1
                                                                                  1      1−β     β
                                                                                                        .
                                     P P         β+α−1  β+α−1    1−α−β             1−α−β  α+β−1   α+β−1
                                      i   j Kij xj     yj      Bj           × Bi         xi     yi

Comparing the expressions for λx and λy , we immediately have λx = λy ≡ λ.

   The previous lemma tells that there exists (xi , yi ) satisfying the following set of the
equations.
                                                          X                1            α       1−α
                                     xi = λ                    Kij Bj1−α−β xjα+β−1 yjα+β−1                           (36)
                                                          j
                                                          X                1        1−β             β

                                     yi = λ                    Kji Bj1−α−β xjα+β−1 yjα+β−1 .                         (37)
                                                          j


In the general equilibrium trade models, (xi , yi ) should solve the same system with λ = 1.
The following lemma tells that a simple transformation of (xi , yi ) solves (31) and (32).

Lemma 3. There exits s such that (sxi , yi ) satisfying (31) and (32), i.e. satisfying (36) and
(37) with λ = 1.

Proof. Now take s as
                                                                                            !         1
                                                                                                1−      α
                                          X                     1        α       1−α                 α+β−1
                                                              1−α−β    α+β−1    α+β−1
                                   s=            Kij Bj               xj       yj                            .
                                          i,j




                                                                      48
To complete the proof of the lemma, we have to show that if (x, y) is a solution to

                                                       P                   1              α         1−α
                                                                      1−α−β
                                                              j Kij Bj      (xj ) α+β−1 yjα+β−1
                                   xi = P                                  1               α            1−α
                                                       1−α−β
                                             i,j Kij Bj      (xj ) α+β−1 yjα+β−1
                                                        1          1−β      β
                                            P         1−α−β
                                               K   B        (x  ) α+β−1 y α+β−1
                                             j   ji j         j          j
                                   yi     = P           1          1−β      β   ,
                                                      1−α−β               α+β−1
                                             j Kji Bj       (xj )       yj
                                                                  α+β−1




then (sx, y) is a solution to a general equilibrium trade model, and s is given by
                                                                                               !         1
                                                                                                   1−      α
                                          X                         1        α         1−α              α+β−1
                                                                  1−α−β    α+β−1      α+β−1
                                 s=                   Kij Bj              xj         yj                         .
                                               i,j


Namely (e
        x, ye) = (sx, y) solves
                                                       X                   1               α            1−α
                                  (e
                                   xi ) =                         Kij Bj1−α−β (e
                                                                               xj ) α+β−1 yejα+β−1
                                                              j
                                                       X                   1              1−β            β

                                    yei =                         Kji Bj1−α−β (e
                                                                               xj ) α+β−1 yejα+β−1 .
                                                              j


To prove this last point, note that
                                                          α
                                          s1− α+β−1                                  X                  1               α    1−α
         sxi = P                          1                        α       1−α            Kij Bj1−α−β (sxj ) α+β−1 yjα+β−1
                                        1−α−β                             α+β−1
                          i,j   Kij Bj                (xj ) α+β−1 yj                  j
                  |                                  {z                          }
                                                     =1
                  X                   1                            α       1−α
                                    1−α−β
              =            Kij Bj                    (sxj ) α+β−1 yjα+β−1 .
                      j


                                                                                                                    P         1           α      1−α
                                                                                                                            1−α−β
The equality holds by construction of s. Thus first equation that x
                                                                  ei =                                              j Kij Bj       xj ) α+β−1 yejα+β−1
                                                                                                                                  (e
is satisfied. To show the second equation, it suffices to show
                                        X                         1            1−β         β

                                                Kji Bj1−α−β (e
                                                             xj ) α+β−1 yejα+β−1 = 1.
                                         i,j




                                                                          49
This holds since25
            X             1                 1−β             β                 1−β    X                      1       1−β     β

                   Kji Bj1−α−β (sxj ) α+β−1 yjα+β−1 = t α+β−1                                   Kji Bj1−α−β xjα+β−1 yjα+β−1
             i,j                                                                        i,j
                                                                            P                     1             α     1−α
                                                                                  1−α−β
                                                                        i,j Kij Bj      xjα+β−1 yjα+β−1
                                                                     = P            1      1−β      β   = 1.
                                                                                  1−α−β   α+β−1   α+β−1
                                                                        i,j Kji Bj      xj      yj

The last equality holds from the previous lemma.

   Previous two lemmas imply that there exists (xi , yi ) satisfying equations (31) and (32).
The final touch is needed to ensure that there exists (xi , yi ) satisfying (31), (32), and 33.

Lemma 4. There exists (xi , yi ) satisfying (31) (32), and (33).

Proof. From Lemma 3, there       exists (xi , yi ) satisfying ((31)) and ((32)).
                              α−1
   Now consider (e
                 xi , yei ) = t 1−β xi , tyi , where

                                        "                                                            1−β
                                                                                                  #− α−β
                                            X         1                   α               β
                                                    1−α−β
                              t=                  Bi            (xi )   β+α−1   (yi )   β+α−1                   .
                                            i


It is easy to show
                                    1−α                 1−α     X                1                    α             1−α
                      ei = t− 1−β xi = t− 1−β
                      x                                               Kij Bj1−α−β (xj ) α+β−1 (yj ) α+β−1
                                                                 j
                                                    1                          α
                                                                             α+β−1
                              X                                      1−α                              1−α
                          =             Kij Bj    1−α−β
                                                                t− 1−β xj               (tyj ) α+β−1
                                j
                              X                     1                   α            1−α
                          =             Kij Bj1−α−β (e
                                                     xj ) α+β−1 (e
                                                                 yj ) α+β−1
                                j
                                X                       1               1−β                 β
                      yei = t            Kji Bj1−α−β (xj ) α+β−1 (yj ) α+β−1
                                    j
                              X                     1                 1−β               β
                          =             Kji Bj1−α−β (e
                                                     xj ) α+β−1 (e
                                                                 yj ) α+β−1 .
                                j


Thus (e
      xi , yei ) still solves (31) and (32).
  25
    If β = 1, then this last line is not true, since the equation for y is no longer dependent on x. In this case,
however, existence and uniqueness follows immediately from Theorem 1 of Karlin and Nirenberg (1967), as
the two integral equations can be treated as distinct from each other.




                                                                      50
                                                 α−1          
       The world income induced by (e
                                    xi , yei ) = t 1−β xi , tyi is

                 1                           α
                                           β+α−1                                           1                            α
                                                                                                                       β+α−1
        X                      α−1                             β              X                            α−1                          β
               1−α−β                                                                      1−α−β
              Bi           t   1−β   xi             (tyi )   β+α−1   =                  Bi             t   1−β   xi             (tyi ) β+α−1
          i                                                                        i
                                                                                  (α−β)   X                1              α             β
                                                                     = t           1−β           Bi1−α−β (xi ) β+α−1 (yi ) β+α−1 = 1.
                                                                                             i


The last equality holds by the construction of t.

A.1.3         Part 3: Existence for trade models

We next consider the existence of a strictly positive solution to the general equilibrium
gravity model defined by equations (31), (32), and 33.

Proof. It directly follows from Proposition 4.

A.1.4         Part 4: Uniqueness for trade models

We now consider the uniqueness of the general equilibrium gravity model. We prove unique-
ness by contradiction.

Proof. Suppose that there are two solutions (x, y) , (e
                                                      x, ye) satisfying ((31)), ((32)), and (33).
                                       26
Then there are no constants t such that

                                                                     x = te
                                                                          x.                                                                   (38)

Without loss of generality, we can assume that for all i,
                                                        X                 X
                                                                 Fi,j =                Hi,j = 1.
                                                             j                j


Also we can take (e
                  x, ye) = (1, 1) since
                                                                      X
                                                             1 =                  Fi,j 1a 1b
                                                                          j
                                                                      X
                                                             1 =                  Hi,j 1c 1d .
                                                                          j

  26
    Such t exists when (x, y) and (x0 , y 0 ) gives the same real variables and the only difference comes from
the price level.




                                                                          51
Define

                     mx ≡ min xi , Mx ≡ max xi , my ≡ min yi , My ≡ max yi .
                                   i                    i                      i                  i


From (38), mx (my ) is strictly less than Mx (My ) respectively.
    Given the relationship above between a, b, c and d and the gravity constants α and β, it
is easy to show that the following inequalities hold:

                                                   c < 0<a
                                                   b < 0 < d.

Given that we have that
                                                                       X
                                   max xi = Mx = max                        Fi,j xaj yjb ≤ Mxa mby
                                                                        j
                                                                       X
                                   max yi = My = max                        Hi,j xcj yjd ≤ mcx Myd
                                                                        j
                                                            X
                          mx = min xi = min                      Fi,j xaj yjb ≥ max Myb
                                                            j
                                                            X
                          my = min yi = min                      Hi,j xcj yjd ≥ Mxc mdy .
                                                            j


It is easy to show27
                                  1−a         b                        c         1−d
                              Mx            My                         Mx          My
                                                        < 1,                                   < 1.
                              mx            my                         mx          my
  27
       To obtain first equation, multiply first and third equation.

                                           Mx mbx Myb ≤ mx Mxa mby ,
                                                                   


which is equivalent to
                                                      1−a           b
                                                 Mx              My
                                                                            < 1.
                                                 mx              my
For second equation, multiply second and fourth equation.

                                            (My ) Mxc mdy ≤ mcx Myd my ,
                                                                   


which implies
                                                      c           1−d
                                                  Mx            My
                                                                            ≤1
                                                  mx            my




                                                              52
Since c = a − 1, and d = b + 1,
                             1−a         b                         a−1           −b
                        Mx             My                          Mx              My
                                                   < 1,                                        < 1.
                        mx             my                          mx              my

Therefore the following holds.
                                  1−a           b                      1−a         b
                              Mx            My                         Mx            My
                                                        <1<                                    ,
                              mx            my                         mx            my

which is a contradiction.


A.2     Proof of Theorem 2
                                                                                            P               P
Proof. Part i) This relation comes from conditions C.2 and C.3                                 i   Xi,j =   i   Xj,i , which,
given C.1, is equivalent to:

                   KiA γi          P e      A                     e i,j KjB δj
                                                                  K                    KjA γj
                                    j Ki,j Kj γj
                                                        X
                          =                        =                                  × B .
                   KiB δi                   B
                                   P e                                             
                                    j Ki,j Kj δj
                                                          j
                                                               P e
                                                                    K   i,j K B
                                                                                δ j
                                                                                       K j δj
                                                                j             j


It is easy to show that
                                                    KiA γi
                                                           = 1,
                                                    KiB δi
is a solution to the problem. From the Perron-Frobenius theorem, this solution is unique up
to scale. Therefore for some κ, we have

                                              γi KiA = κδi KiB .                                                        (39)

   Part ii) The relation (39) implies

                                                    γi       KB
                                            yi =       xi = κ iA xi .
                                                    δi       Ki

Substituting this expression into (31), we get
                                                                                     1−α
                                                                            KiB
                                                                   1
                                                                                  α+β−1          1
                               1−α    X
                  xi = κ      α+β−1       e i,j K A K B B 1−α−β
                                          K                                                 xjα+β−1 .                   (40)
                                                 i   j   j
                                      j
                                                                            KiA

Also, if we substitute the same expression into (32), we get the exact same expression.
Therefore one of the two equations is trivially satisfied. From Theorem 1 of Karlin and


                                                          53
                                                                                            1
Nirenberg (1967), the system has an unique solution if                                    α+β−1
                                                                                                  ≤ 1, which is equivalent to
the condition given in the statement of the theorem.


A.3      Proof of Proposition 1
A.3.1     Part (i): The trade equilibrium solves the world income maximization
          problem.

Proof. To show that the trade equilibrium maximizes the world income, we show that the
FONCs for the maximization problem coincide with the equilibrium conditions for the trade
model. Mathematically we show that any solutions to the world income maximization satisfy
the trade equilibrium conditions.
   The associated Lagrangian of the maximization problem is:
                                                                                      !                                                   !
     XX                      X          X                        X                             XX                      X
L:             Kij γi δj −         κi              Kij γi δj −            Kji γj δi       −λ             Kij γi δj −         Bi γiα δiβ         ⇐⇒
     i∈S j∈S                 i∈S           j                      j                            i∈S j∈S                 i∈S
                                                                                                                  !
                                   XX                         X              X                    X                        X
                 L : (1 − λ)                   Kij γi δj −            κi           Kij γi δj −        Kji γj δi       +λ         Bi γiα δiβ ,
                                   i∈S j∈S                     i∈S             j                  j                        i∈S


where {κi } are the Lagrange multipliers on the balanced trade constraint and λ is the La-
grange multiplier on the aggregate factor market clearing.
   First order conditions with respect to γi are:
                                           X                      X
                       (1 − λ − κi )                Kij γi δj +            Kij γi δj κj + αλBi γiα δiβ = 0                           (41)
                                               j                      j


     First order conditions with respect to δi are:
                                           X                      X
                       (1 − λ + κi )                Kji γj δi −            Kji γj δi κj + βλBi γiα δiβ = 0                           (42)
                                               j                      j


We first solve for the λ. Add the two FOC together and sum over all i ∈ S:
                 XX                        XX                                                               X
     2 (1 − λ)               Kij γi δj +                  (Kij γi δj − Kji γj δi ) κj + (α + β) λ                 Bi γiα δiβ = 0,
                  i    j                       i      j                                                      i


which implies
                                                                   2
                                                          λ=           .                                                             (43)
                                                                 2−α−β




                                                                     54
The FONCs for γi and δi become:
                                     X
                         α+β 2−α−β                   2−α−β X
        Bi γiα δiβ   =       +     κi    Kij γi δj −         Kij γi δj κj                                     (44)
                          2α   2α      j
                                                       2α  j
                                     X
                         α+β 2−α−β                   2−α−β X
        Bi γiα δiβ   =       −     κi    Kji γj δi +         Kji γj δi κj                                     (45)
                          2β   2β      j
                                                       2β  j


We now try to solve for the κ. Equating the two FOC yields:
                                                P         α                         β
                                                                                                 
                        β−α                         j        K γδ
                                                          α+β ji j i
                                                                                +      K γδ
                                                                                    α+β ij i j
                                                                                                     κj
                             + κi =                                    P                                  .   (46)
                       2−α−β                                               j   Kij γi δj

Substituting (46) back into the FOC for γi yields:
                                                                                   
                                  X               2 − α − β X Kji γj δi − Kij γi δj
                 Bi γiα δiβ   =       Kij γi δj +                                     κj                      (47)
                                  j
                                                    α+β     j
                                                                        2

Substituting (46) back into the FOC for δi yields:
                                                                                   
                                  X               2 − α − β X Kij γi δj − Kji γj δi
                 Bi γiα δiβ   =       Kji γj δi +                                     κj                      (48)
                                  j
                                                    α+β     j
                                                                        2

Note that equating the two FOC yields:
                                        X                          X
                                             Kji γj δi κj =            Kij γi δj κj ,
                                         j                         j


where the second to last line imposed balanced trade. Hence the first order conditions
become:
                                                              X
                                             Bi γiα δiβ =          Kij γi δj
                                                               j
                                                              X
                                             Bi γiα δiβ   =        Kji γj δi .
                                                               j


Therefore the solution to the problem is unique and coincides with the allocation of the
general equilibrium gravity model.




                                                              55
A.3.2    Part (ii) : The trade equilibrium solves the world welfare maximization
         problem.

Proof. With the assumption we made that the utility for country i is expressed in the fol-
lowing form
                                                      1/ρ
                             ui = Bi (γi )α−1 (δi )β−1      ,

the welfare maximization problem is to maximize the weighted sum of {ui }i subject to the
same constraints. To show that the competitive allocation is Pareto efficient, we show that
                                                                           
under a particular choice of (θi ) , the competitive allocation γiCE , δiCE i solves the planning
problem.
   Set the Pareto weights (ωi )i as follows.
                                                                  (α−1)/ρ                ρ(β−1)/ρ
                       X                        (Bk )1/ρ γkCE                    δkCE
             (ωi ) =                                                                            1/ρ          α        β   (ωk ) .
                                                                                                      (γiCE ) (δiCE )
                                                                                     P
                                        1/ρ          (α−1)/ρ           (β−1)/ρ           j (Bi )
                           k    (Bi )         (γiCE )          (δiCE )                      P
                                                                                                    Kj,i γjCE δiCE
                                                                                                j


From Karlin and Nirenberg (1967), we know there is a solution to the system.
   The associated Lagrangian is
                                                                                                                              !
                      X           1/ρ (α−1)/ρ (β−1)/ρ
                                                                       XX                                   X
             L=                ωi Bi γi      δi                −λ                     Kij γi δj −                Bi γiα δiβ       .
                       i                                                   i     j                           i


Taking the FONCs w.r.t. γi and δi , we get

                                              1/ρ (α−1)/ρ (β−1)/ρ
                                                                                X
                  ρ−1 (α − 1) ωi Bi γi                   δi            =λ                Kij γi δj − αλBi γiα δiβ
                                                                                  j
                                         1/ρ (α−1)/ρ (β−1)/ρ
                                                                                X
                  ρ−1 (β −        1) ωi Bi γi       δi                 =λ                Kji γj δi − λβBi γiα δiβ .
                                                                                  j


Adding the two equations, and solving for λ, we have

                                                                   1W
                                                           λ=         .
                                                                   ρY

Substitute this expression into the FONCs.
                                                                                            !
                               1/ρ (α−1)/ρ (β−1)/ρ
            α−1            ωi Bi γi         δi                         X                                X
                                                           YW −                Kij γi δj            +       Kij γi δj = Bi γiα δiβ
             α                            W                            j                                j
                                                                                            !
                             1/ρ (α−1)/ρ (β−1)/ρ
            β−1            ωi Bi γi       δi                           X                                X
                                                           YW −                Kji γj δi            +       Kji γj δi = Bi γiα δiβ .
             β                            W                            j                                j



                                                                  56
                                                                                               
From the construction of ωi , the bracket term is zero if we evaluate the system at γiCE , δiCE i .

                                                            CE
                                                                        α              β                                     !
                                                                                 δjCE
                                                    P
              CE (α−1)/ρ     CE (β−1)/ρ               j Bj γj
      1/ρ
                                                                                                           X
                                                                                                               Kij γiCE δjCE
                              
  ωi Bi     γi              δi                      1/ρ          (α−1)/ρ                 (β−1)/ρ
                                                                                                       −                           = 0.
                                                          (γiCE )                 (δiCE )
                                          P
                                              j ωi Bi                                                      j

                                                               
Then the second equation is solved at γiCE , δiCE                  i
                                                                       since
                                 X                                          α          β
                                      Kji γjCE δiCE = Bi γiCE                i
                                                                                 δiCE        .
                                  j




A.4       Proof of Proposition 2
Proof. We need to show that there exist a unique set of {Kij }i6=j such that observed trade
flows satisfy the model equilibrium conditions, i.e.:

                                               Kij γi δj = Xij                                                                 (49)
                                                            X
                                               Bi γiα δiβ =    Xij                                                             (50)
                                                                        j
                                                                       X
                                       Bi γiα δiβ   + D̄i =                  Xji ,                                             (51)
                                                                        j


where recall that {Xij } are observed and {Bi },{Kii }, α, and β are chosen.
                                                                                         − α−β β       1
                                                                                                    − α−β
                                                                                          Xii       Bi
                                                   P        P             P
    We proceed by construction. Choose D̄i ≡ j Xji − j Xij , Yi ≡ j Xij γi ≡ K             ii       Yi
       α−βα        1
                    α−β
        Xii     Bi                   X
δi ≡ K   ii     Yi
                         , and Kij ≡ γi δijj . We verify that these definitions satisfy equilibrium
conditions given observed trade flows. First, note that (49) is satisfied by the construction
of Kij .
    Second, note that:

                                         β
                                      − α−β       1
                                              − α−β !α                             α 
                                                                                    α−β                 1
                                                                                                       α−β !β
                                X  ii         Bi                             Xii                 Bi
            Bi γiα δiβ = Bi                                                                                      ⇐⇒
                                Kii           Yi                             Kii                 Yi
                              β−α
                 α β          Bi α−β
            Bi γi δi = Bi                 ⇐⇒
                              Yi
                         X
            Bi γiα δiβ =     Xij ,
                        j


so that equilibrium condition (50) is satisfied.


                                                          57
   Finally, note that:
                                                X             X            X              X
          Bi γiα δiβ + D̄i Bi γiα δiβ + D̄i =         Xij +        Xji −       Xij ⇐⇒ =       Xji ,
                                                  j            j           j              j


so that equilibrium condition (51) is satisfied.


A.5     Proof of Proposition 3
Part (i) We start by proving the first part with an application of the implicit function
theorem.

Proof. Some notation is necessary. Define yi ≡ ln γi , zi ≡ ln δi , kij ≡ ln Kij . Let ~y ≡ {yi }
and ~z ≡ {zi } both be N × 1 vectors and let ~x ≡                                   ~
                                                 {~y ;~z} be a 2N × 1 vector. Let k ≡ {kij } be
a N 2 × 1 vector. Now consider the function f ~x; ~k : R2N × RN → R2N given by:
                                                                     2




                   h                                                                             i
                                      α                 β     P
                   Bi (exp {yi }) (exp {zi }) − j exp {ki,j } (exp {yi }) (exp {zj })
                                                                                         i
                                                   ..
              
      f ~x; ~k =                                                                         .
                                                                                         
                                                    .
                 h                                                                     i
                   Bi (exp {yi })α (exp {zi })β − j exp {kj,i } (exp {yj }) (exp {zi })
                                                 P
                                                                                                      i


In the general equilibrium trade model, we have:
                                                         
                                                        ~
                                                  f ~x; k = 0.

Full differentiation of the function hence yields:

                                                f~x D~k ~x + f~k = 0,                                     (52)

where f~x is the 2N × 2N matrix:
                                                                               !
                                                    (α − 1) Y βY − X
                              f~x ~x; ~k =                                         ,
                                                      αY − X T (β − 1) Y

where Y is a N × N diagonal matrix whose ith diagonal is equal to Yi and X is the N × N
trade matrix.




                                                         58
    Similarly, f~k is a 2N × N 2 matrix that depends only on trade flows:
                                                                                                      
                                  X11 · · · X1N          0       ···    0      ···    0    ···     0
                                                                                     ..   ..      .. 
                           0
                                       ···       0     X21 · · · X2N          ···     .      .     . 
                           .            ..       ..     ..   ..   ..          ..
                           ..
                                                                                                       
                    
                                          .        .      .    .    .              . XN 1 · · ·   XN N 
           f~k ~x, ~k = −                                                                             
                          X11          ···       0     X21 · · ·  0           · · · XN 1 · · ·    0 
                                                                                                      
                                       ..        ..        ..      ..                    ..        .. 
                           0
                                          .       .     0       .   .         ···    0       .      . 
                                                                                                       
                            0           · · · X1N        0 · · · X2N           ···    0    ···    XN N

   If f~x was of full rank, we could immediately invert equation (52) (i.e. apply the implicit
function theorem) to immediately yield:

                                                D~k ~x = − (f~x )−1 f~k .

However, because Walras Law holds and we can without loss of generality apply a normal-
ization to {γi } and {δi }, we effectively have N − 1 equations and N − 1 unknowns. Hence,
there exists an infinite number of solutions to equation (52), each corresponding to a different
normalization. To find the solution that corresponds to our choice of world income as the
numeraire, note that from equation (1):
                                                          X
                                                                 Bl γlα δlβ = Y W =⇒
                                                             l
                                                                      
                            X                  ∂ ln γl     ∂ ln δl
                                   Yl       α          +β                   = 0.                           (53)
                              l
                                              ∂ ln Kij    ∂ ln Kij

We claim that if ∂∂lnlnKγijl = Xij × (Al,i + AN +l,j ) − c and ∂∂lnlnKδijl = Xij × (AN +l,i + Al,j ) − c,
                1
                      Xij l Yl (α (Al,i + AN +l,j ) + β (AN +l,i + Al,j )), then ∂∂lnlnKγijl and ∂∂lnlnKδijl
                             P
where c ≡ Y W (α+β)
solve equations (52) and (53). It is straightforward to see that our assumed solution ensures
equation (52) holds, as the generalized inverse is a means of choosing from one of the infinitely
many solutions; see James (1978). It remains to scale the set of elasticities appropriately
to ensure that our normalization holds as well. Given our definition of the scalar c, it is




                                                          59
straightforward to verify that equation (53) holds:
                                 P
           ∂ ln γl     ∂ ln δl        l Yl (α (Xij × (Al,i + AN +l,j ) − c) +
X
     Yl α          +β            =
 l
          ∂ ln Kij    ∂ ln Kij         +β (Xij × (AN +l,i + Al,j ) − c))
                                        P
                                   Xij l Yl (α (Xij × (Al,i + AN +l,j )) + β (Xij × (AN +l,i + Al,j )))
                                 =                                          P
                                                                −c (α + β) l Yl
                                            P
                                      X  ij   l Yl (α (Xij × (Al,i + AN +l,j )) + β (Xij × (AN +l,i   + Al,j ))) −
                                 =       1
                                                    P                                                               W
                                                X
                                     Y W (α+β) ij      l Yl (α (Al,i + AN +l,j ) + β (AN +l,i + Al,j )) (α + β) Y

                                    = 0,

i.e. equation (53) also holds. More generally, different choices of c correspond to different
normalizations. A particularly simple example is if we choose the normalization γ1 = 1.
Since this implies that ∂∂lnlnKγ1ij = 0, c = Xij × (A1,i + AN +1,j ). In this case, however, an
alternative procedure is even simpler: the elasticities for all i > 1 can be calculated directly
by inverting the (2N − 1) × (2N − 1) matrix generated by removing the first row and first
column of f~x .

   Part (ii). This part has several cases. Before formal proving the theorem, we introduce
two simple lemmas that help to simplify the main proof. The proof of the first lemma is in
Online Appendix B.6 and the proof of the second lemma can be found in Allen, Arkolakis,
and Li (2014).

Lemma 5. A and B are two matrices whose summation of the elements of every row,
P             P
  j aij , and   bij , are two constants ā and b̄. Then āb̄ is AB’s eigenvalue and it is also the
summation of each row in AB.

     and

Lemma 6. Suppose A is a N × N positive matrix and λ0 is its positive eigenvalue. Then
the rank of λ0 I − A is N − 1.

   Now we can proceed with the proof of the second part of the Proposition.
                                           !
                                 −1
                               Y       0
Proof. Part ii-1) Denote B =                 . Then
                                 0    Y−1
                               !                             !                               !
                  Y−1  0             (α − 1) Y βY − X                 (α − 1) I βI − C
       BA =                                                      =                               ,
                   0  Y−1            αY − XT (β − 1) Y                 αI − D (β − 1) I



                                                  60
where we define C ≡ Y−1 X, D ≡ Y−1 XT , and I to be the N × N identity matrix. It is
easy to verify that the row-summation of C and D are both constant and equal to 1 –i.e.
D→−e =→ −
        e where → −
                  e is the identity vector– when we have trade balance. Since Y is a diagonal
matrix, B is of full rank and the rank of BA is equal to the minimum of the ranks of B and
A i.e. the rank of A. Suppose α − 1 6= 0, implement the Gauss elimination on BA, to get
                                    !                                                  !
               (α − 1) I βI − C                (α − 1) I                βI − C
                                        =                   (α−1)(β−1)I−(αI−D)(βI−C)       .   (54)
                αI − D (β − 1) I                  0                   (α−1)


Denote E = (α − 1) (β − 1) I − (αI − D) (βI − C). We now prove the four individual mu-
tually excluding cases.
   Let α, β ≤ 0: We have

                       E = (1 − α) (1 − β) I − (−αI + D) (−βI + C)

The row summation −αI + D and −βI + C are both positive since 1 − α > 0 and 1 −
β > 0. According to Lemma 5, (1 − α) (1 − β) is the eigenvalue of the positive matrix
(−αI + D) (−βI + C). According to Lemma 6, the rank of E is N − 1. Thus, the rank of
A is 2N − 1.
    Let α, β > 1: The row summation of D is 1 < α. According to Theorem 3 in Allen,
Arkolakis, and Li (2014) αI − D is invertible and the inverse (αI − D)−1 is positive. As
(αI − D) →−e = (α − 1) →−
                        e , since the (αI − D)−1 →
                                                 −      1 →
                                                 e = (α−1) −e ,. Thus, (α − 1)−1 is the unique
positive eigenvalue of positive matrix (αI − D)−1 . Similarly, (β − 1)−1 is the unique positive
eigenvalue of positive matrix (βI − C)−1 . Notice that

                               E = (αI − D) [F − I] (βI − C) ,

where F = (α − 1) (αI − D)−1 (β − 1) (βI − C)−1 . F is a positive matrix and F→    −e =→ −
                                                                                         e
which means 1 is the eigenvalue of F. Thus, according to above Lemma 6, the rank of F − I
is N − 1. So again the rank of E is N − 1, so that the A is 2N − 1.
    Let |α| > 1 , β = 1 or α = 1, |β| > 1: Without loss of generality, we only consider the
case β = 1. Then implementing the Gaussian elimination on BA, equation 54, we get
                                                                !
                                   (α − 1) I          I−C
                                                 −(αI−D)(I−C)       ,
                                      0              (α−1)

where from lemma 6, the rank of I − C is N − 1. As the for any eigenvalue λ of D, it must
be that |λ| < α. αI − D is invertible which means (αI − D) (I − C) is of rank n − 1. Thus,


                                                 61
the rank of A is 2N − 1.
   Part ii-2) In this case there is a linear restriction as from the results of Theorem 2 we
have δi = κγi (we neglect the constants without loss of generality). Then the system becomes
                                                       X
                                 Bi γiα+β = κ1−β           Ki,j γi γj .

With normalization C.5 it can be shown that κ1−β = 1.
   Following the same notation as before full differentiation yields 52 where f~x is now N × N
matrix:
                                        
                                       ~
                               f~x ~x; k = (α + β − 1) Y − X,

and where Y is a N × N diagonal matrix whose ith diagonal is equal to Yi and X is the
N × N trade matrix.
   As before, if f~x was of full rank, we could immediately invert equation (52) (i.e. apply
the implicit function theorem) to obtain:

                                      D~k ~x = − (f~x )−1 f~k .

Therefore the derivative of γi w.r.t. Kk,l is
                            n                             o
                           − (f~x )−1 Xk,l + (f~x )−1 Xl,k
                                                    
                  ∂γi                     i,k          i,l
                                                                            k 6= l
                         =                                                           .
                 ∂Kk,l     − (f )−1           Xk,k                       k=l
                                 ~
                                 x     i,kN −k−1


   It is straightforward to show that the matrix f~x is of full rank whenever α + β ≤ 0 or
α + β > 2 and also that there are a finite number of α,β combinations that is not of full
rank. To see this note that the matrix is not of full rank if there exists a set of {zi } such
that:

                           ((α + β − 1) Y − X) z = 0 ⇐⇒
                                                     X
                                 zi Yi (α + β − 1) =   Xij zj ⇐⇒
                                                            j
                                                           X Xij
                                   zi (α + β − 1) =                    zj
                                                            j
                                                                  Yi

Consider the related mathematical problem:
                                         X Xij
                                zi λ =            zj s.t. kzk = 1.                        (55)
                                         j
                                             Yi

                                                  62
      X
Since Yiji > 0, by the Perron-Frobenius theorem, there exists a unique set of strictly positive
{zi } that solve this equation corresponding to the largest eigenvalue λ. It is immediate to
show that λ = 1 by summing up (55) and the corresponding zi = 1 for all i. Notice that, the
absolute of any eigenvalue has to be strictly smaller, i.e. |α + β − 1| < 1, or equivalently,
α + β ∈ (0, 2). But the original equation that we assumed had a solution has an eigenvalue
of α + β − 1. Thus, no solution is in the region |α + β − 1| > 1 ⇐⇒ α + β ≤ 0 or α + β > 2
and there exists a finite number of combinations of α, β so that there is no solution of the
equation all in the range α + β ∈ (0, 2) (when α + β = 2, then Perron-Frobenius guarantees
the existence of a solution so that we know the matrix in non-invertible, and f~x is of full
rank).


A.6       Proof of Proposition 4
Proof. We want to rewrite the equilibrium conditions in changes by defining (x̂i ) = x0i /xi .
Starting from (4) we have

                                                   X    K 0 γ 0δ0
                                  γ̂iα δ̂iβ    =       P ij i j     =⇒
                                                   j    j Kij γi δj
                                                   X
                                  γ̂iα δ̂iβ =          πij K̂ ij γ̂ i δ̂ j =⇒
                                                   j
                                                   X
                               γ̂iα−1 δ̂iβ =           πij K̂ ij δ̂ j
                                                   j

                 P
where πij = Xij / j Xij represents the exporting shares. Similarly we can rewrite the second
equilibrium condition, Equation (5), in changes as
                                               P 0 0 0
                                                j Kji γj δi
                                   γ̂iα δ̂iβ =P                   =⇒
                                                j Kji γj δi
                                               X
                                   γ̂iα δ̂iβ =    λij K̂ ji γ̂ j δ̂ i =⇒
                                                   j
                                                   X
                                γ̂iα δ̂iβ−1 =          λji K̂ ji γ̂ j
                                                   j

                  P
where λij = Xij / i Xij represents the import shares. This system of equations in changes
is the same as the system of equations in levels. As long as λij , πij are the same and α,β are
the same all the gravity models give the same changes in γi , δj for a given change in Kij .




                                                       63
