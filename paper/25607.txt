                                 NBER WORKING PAPER SERIES




      EQUILIBRIUM ALLOCATIONS UNDER ALTERNATIVE WAITLIST DESIGNS:
                 EVIDENCE FROM DECEASED DONOR KIDNEYS

                                            Nikhil Agarwal
                                              Itai Ashlagi
                                           Michael A. Rees
                                           Paulo J. Somaini
                                          Daniel C. Waldinger

                                         Working Paper 25607
                                 http://www.nber.org/papers/w25607


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                      February 2019




We are grateful to UNOS for facilitating access to the data. We thank Peter Arcidiacono, Lanier Benkard,
Ben Handel, Liran Einav, Jose Fernandez, Gautam Gowrisankaran, Jacob Leshno, Anna Mikusheva,
Michael Ostrovsky, Ariel Pakes, Parag Pathak, Peter Reiss, Andy Skrzypacz, Gabriel Weintraub, and
Mike Whinston for helpful discussions. Lingjun Xia provided outstanding research assistance. The
au-thors acknowledge support from the NSF (SES-1729090, SES-1254768), the NIH (R21-DK113626),
the Sloan Foundation (FG-2019-11484), and the MIT SHASS Dean’s Research Fund. The data reported
here have been supplied by UNOS as the contractor for the Organ Procurement and Transplantation
Network (OPTN). The interpretation and reporting of these data are the responsibility of the author(s)
and in no way should be seen as an official policy of or interpretation by the OPTN or the U.S. Government.
The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2019 by Nikhil Agarwal, Itai Ashlagi, Michael A. Rees, Paulo J. Somaini, and Daniel C. Waldinger.
All rights reserved. Short sections of text, not to exceed two paragraphs, may be quoted without explicit
permission provided that full credit, including © notice, is given to the source.
Equilibrium Allocations under Alternative Waitlist Designs: Evidence from Deceased Donor
Kidneys
Nikhil Agarwal, Itai Ashlagi, Michael A. Rees, Paulo J. Somaini, and Daniel C. Waldinger
NBER Working Paper No. 25607
February 2019, Revised in September 2020
JEL No. C51,D47,I10

                                         ABSTRACT

Waitlists are often used to ration scarce resources, but the trade-offs in designing these
mechanisms depend on agents preferences. We study equilibrium allocations under alternative
designs for the deceased donor kidney waitlist. We model the decision to accept an organ or wait
for a preferable one as an optimal stopping problem and estimate preferences using administrative
data from the New York City area. Our estimates show that while some kidney types are
desirable for all patients, there is substantial match-specific heterogeneity in values. We then
develop methods to evaluate alternative mechanisms, comparing their effects on patient welfare
to an equivalent change in donor supply. Past reforms to the kidney waitlist primarily resulted in
redistribution, with similar welfare and organ discard rates to the benchmark first come first
served mechanism. These mechanisms and other commonly studied theoretical benchmarks
remain far from optimal. We design a mechanism that increases patient welfare by the equivalent
of an 18.2 percent increase in donor supply.

Nikhil Agarwal                                  Paulo J. Somaini
Department of Economics, E52-460                Stanford Graduate School of Business
MIT                                             Knight Management Center
50 Memorial Drive                               655 Knight Way E372D
Cambridge, MA 02142                             Stanford, CA 94305
and NBER                                        and NBER
agarwaln@mit.edu                                soma@stanford.edu

Itai Ashlagi                                    Daniel C. Waldinger
Management Science and Engineering              NYU Department of Economics
Huang Engineering Center, 262                   19 West 4th Street
Stanford University                             Room 814
475 Via Ortega                                  New York, NY 10012
Stanford, CA 94305                              danielwaldinger@nyu.edu
iashlagi@stanford.edu

Michael A. Rees
University of Toledo
Department of Urology
3000 Arlington Avenue
Mail Stop 1091
Toledo, OH 43614A

Data appendix is available at http://www.nber.org/data-appendix/w2560
michael.rees2@utoledo.edu
                                                                                                  2

1       Introduction

A kidney transplant improves the quality and length of a patient’s life while saving hundreds
of thousands of dollars in dialysis costs (Wolfe et al., 1999; Irwin et al., 2012; Held et al.,
2016). Deceased donor kidneys are allocated using a waitlist instead of traditional price-
based market mechanisms. In 2018, fewer than one-fifth of the almost 100,000 patients on
the kidney waitlist received a transplant.1 At the same time, approximately one-fifth of
kidneys recovered from deceased donors were discarded. Given the value and scarcity of
these resources, it is essential to design mechanisms that are efficient, minimize waste, and
achieve equitable outcomes. Similar design goals are important in the allocation of other
deceased donor organs, public housing, long-term care, child care, and child adoption.
Previous research and policy guidance on waitlist design is based on restrictive assumptions
about agents’ preferences or behavior. The theoretical literature has found that even quali-
tative trade-offs are sensitive to whether objects are vertically or horizontally differentiated
(c.f. Su and Zenios, 2004; Bloch and Cantala, 2017; Leshno, 2017; Agarwal et al., 2018).
Absent clear recommendations from theory, many organ allocation agencies use simulations
to predict the effects of alternative allocation rules. The simulations, including those used
to design organ allocation rules, do not allow agents’ decisions to respond to changes in the
system.2
This paper empirically evaluates equilibrium allocations under waitlist mechanisms that se-
quentially assign objects to forward-looking agents. We make several methodological and
empirical contributions. First, we develop a method for estimating payoffs from various as-
signments and apply it to data from the deceased donor kidney waitlist in the New York
City area. This step is based on an optimal stopping problem faced by a patient when they
are offered a kidney. Second, we define a notion of steady state equilibrium that permits
computationally tractable counterfactual analysis of a broad class of mechanisms. Finally,
we use these techniques to compare alternative mechanisms in terms of efficiency, equity, and
organ waste while accounting for changes in agent behavior. We evaluate equilibrium assign-
ments under mechanisms used in practice, theoretical benchmarks, and welfare-maximizing
mechanisms.
Our empirical application uses rich administrative data on the deceased donor kidney allo-
    1
    Source: https://optn.transplant.hrsa.gov/data/view-data-reports/national-data/
    2
    For example, Kidney Pancreas Simulated Acceptance Module (KPSAM), used in the United States by
the Organ Procurement and Transplantation Network kidney allocation committee to evaluate proposed
mechanisms, assumes that acceptance decisions on the kidney waitlist do not depend on the mechanism.
Similar methods are used by the organ allocation agencies in the U.K., Scandinavia, and France.
                                                                                                        3

cation system between 2010 and 2013 from the New York Organ Donor Network (NYRT),
which serves the greater New York City area. The allocation mechanism offers each organ
to patients on the waitlist in decreasing order of priority points, which are determined by
a coarse set of patient and donor characteristics as well as the patient’s waiting time. An
offer can either be accepted or rejected. A patient who refuses an offer is not penalized and
remains on the waitlist. We refer to the decision-maker as the patient although surgeons
advise patients and often act on their behalf.3
The data suggest that although patients face extreme scarcity, they strategically wait for
offers of desirable organs. While 1,400 patients join the waitlist each year, fewer than 200
deceased donor kidneys are recovered in NYRT. These donors vary widely in quality; some are
accepted immediately while others are rejected by every patient and discarded. The chance
of being offered desirable organs increases with waiting time, giving patients an incentive
to reject offers and wait for a better kidney. Indeed, Agarwal et al. (2018) document that
patients who are less likely to receive offers in the future, and therefore have lower option
values of waiting, are more likely to accept an offer.
Motivated by these facts, we model an agent’s decision to accept an offer as an optimal
stopping problem. An agent accepts the current offer if the value of the object is higher
than the expected value of continuing to wait. The distribution of future offers depends on
the mechanism and the strategies of the other agents on the list. Our empirical strategy
combines acceptance probabilities with detailed knowledge of the mechanism to recover the
value of a transplant as a function of a rich set of patient and donor characteristics. The
technique adapts methods for inverting conditional choice probabilities (Hotz and Miller,
1993; Arcidiacono and Miller, 2011; Arcidiacono et al., 2016) to suit dynamic assignment
mechanisms.
The estimated payoffs show that while some organs are systematically more desirable than
others, there is substantial match-specific heterogeneity in values. For instance, organs from
younger donors are preferred by all patients, but younger patients place a higher value on
such organs. This and other sources of match-specific heterogeneity, such as immunological
similarity, create scope for re-designing the allocation mechanism to improve match quality
by incorporating detailed patient and donor characteristics into the priority system.
Next, we develop methods for computing equilibrium assignments under counterfactual mech-
anisms. This task requires us to solve two technical issues. First, we need to formulate a
tractable notion of equilibrium. Computing counterfactuals is challenging because it involves
   3
    Our data do not directly identify the decision maker. This approach is reasonable if each surgeon acts
in the best interest of each patient when they are offered an organ.
                                                                                               4

solving a dynamic game with many players. To make progress, we define a notion of a steady
state equilibrium in the spirit of previous approaches (e.g. Hopenhayn, 1992; Krusell and
Smith, 1998; Weintraub et al., 2008; Fershtman and Pakes, 2012) and develop an algorithm
for computing such an equilibrium. Second, we must ensure that assignments under coun-
terfactuals of interest are identified. In dynamic models, counterfactual results may not be
invariant to normalizing the payoff of a single action in all states because it restricts payoffs
across states (see Aguirregabiria and Suzuki, 2014; Kalouptsidi et al., 2020). We formally
show that normalizing the payoff from never receiving an assignment is appropriate for the
mechanism design counterfactuals we consider if the value of declining all offers remains fixed.
We argue that this assumption is reasonable in our context.
We then compare equilibrium assignments under alternative mechanisms, focusing on the
trade-off between allocative efficiency and organ waste. These objectives have been empha-
sized in the theoretical literature (see Su and Zenios, 2004; Bloch and Cantala, 2017) and in
policy discussions (see OPTN, 2011). To summarize a change in the mechanism’s expected
welfare effect on a given patient, we compute the equivalent change in deceased donor supply
(arrival rates) under the existing mechanism. We then aggregate these equivalent changes in
donor supply across patients as a summary of the welfare effects. This aggregation implicitly
makes interpersonal comparisons of utility across patients.
Previously used mechanisms and commonly studied theoretical benchmarks can yield either
high average welfare or low discards, but not both. Reforms in 2014 prioritized healthier
patients for the most desirable organs. We show that these changes primarily resulted in
redistribution from older patients to younger patients, with little improvement in average
patient welfare. In fact, both the pre- and post-2014 mechanisms yield welfare and organ
discard rates within 2.5 percent of the benchmark first come first served mechanism (FCFS)
studied in Bloch and Cantala (2017). FCFS induces agents to be selective because the
expected quality of offers increases as time passes. Last come first served (LCFS), which is
theoretically studied in Su and Zenios (2004), makes agents less selective because they expect
to receive lower-quality offers in the future if they decline an offer today. This mechanism
dramatically reduces organ discard rates (25 percent), but at the cost of lowering welfare by
50 percent due to poor match quality.
In contrast, we use our estimates to identify mechanisms that significantly increase patient
welfare and reduce discards. An approximation to the welfare-maximizing mechanism that
tailors offer rates based on agent and object characteristics increases the average patient’s
welfare by the equivalent of an 18.2 percent increase in donor supply. This mechanism also
reduces organ discard rates by more than 7 percent, and as a result, equilibrium queue lengths
                                                                                                                5

and waiting times are shorter than under the pre-2014 mechanism. A drawback is that some
patient types may be harmed. To address this concern, we design a mechanism that increases
welfare by an equivalent of 12.2 percent and reduces discards by 4.0 percent while ensuring
that no patient type is substantially worse off.
Simultaneously considering heterogeneity and dynamic incentives is crucial for identifying
these gains. The latter channel is ignored by the simulation models currently used by policy-
makers to predict the effects of various allocation systems (see SRTR, 2015). A comparison
that ignores dynamic incentives and holds choice probabilities fixed predicts much smaller
differences in match quality and discard rates between mechanisms, understating the ef-
fects of changing the mechanism. Moreover, a mechanism that naively prioritizes patients
based on predicted transplant value only marginally improves upon the pre-2014 mechanism,
increasing welfare and reducing discard rates by 3.5 and 0.2 percent respectively. Taken to-
gether, our results highlight our empirical methods’ ability to improve dynamic assignment
mechanisms.
Related Literature
Zenios (2004) surveys previous research on organ allocation mechanisms. Unlike our model,
the empirical research in this area assumes that acceptance decisions do not depend on the
mechanism. Most of the research within economics is on the much smaller living donor kidney
exchange market (see, for example, Roth et al., 2004, 2007; Agarwal et al., 2019).
The most closely related paper to ours is Zhang (2010), which also uses a dynamic model
to argue that observational learning best fits acceptance patterns on the deceased donor
kidney waitlist. The result is based on the fact that, conditional on a set of donor covariates
included in the model, patients lower on the list are more likely to refuse an organ if patients
higher on the list have refused it. Our approach abstracts away from learning but allows donor
characteristics observed by agents but not included in the model to capture this correlation in
acceptance behavior. We do this in accordance with our current institutional understanding
and to simplify counterfactual analysis.4
The methods in this paper contribute to a growing literature on the empirical analysis of
centralized assignment systems (see Agarwal and Somaini, 2020, for a survey). Existing
work has focused on static assignment mechanisms,5 where the theory is comparatively well-
   4
     Zhang (2010) uses data from 2002. The donor information available to patients was much more detailed
and standardized during our sample period (2010-2013), reducing the scope for observational learning. Both
observational learning and unobserved heterogeneity in organ quality result in correlated choices across agents.
We leave developing methods for incorporating observational learning into our framework for future work.
   5
     To our knowledge, the only exceptions are Waldinger (2020) and Reeling and Verdier (2020). The optimal
stopping rule we study differs from these models. It is most similar to Liu et al. (2019), which studies decisions
                                                                                                           6

developed and empirical evidence suggests that differences among well-coordinated systems
are small (Abdulkadiroglu et al., 2017). In contrast, theory suggests that the most desirable
dynamic offer system depends on the nature of preferences.
Overview
Section 2 describes the institutions and data, and presents descriptive evidence. Sections 3
and 4 model the optimal stopping problem faced by each agent and detail our estimation
methods. Section 5 describes our parameter estimates. Section 6 defines a steady-state equi-
librium, summarizes results on existence, and presents our approach to welfare comparisons.
Section 7 compares predicted outcomes under alternative mechanisms. Section 8 concludes.


2     Background, Data, and Descriptive Evidence

2.1    Basics of Kidney Transplantation

The two main treatments for kidney failure are dialysis and transplantation. Transplantation
is usually preferable, improving health outcomes while saving an estimated $270,000 or more
over the life of a transplanted patient (Wolfe et al., 1999; Irwin et al., 2012; Held et al., 2016;
USRDS, 2018). Medicare, which provides near-universal coverage for the disease, spent $35.4
billion treating kidney failure in 2016, accounting for 1 percent of the federal budget (Chapter
9, USRDS, 2018).
The primary constraints on transplant feasibility are blood- and tissue-type compatibility.
A patient’s immune system will attack an incompatible organ, resulting in graft failure.
Following transplantation, medications allow transplant physicians to limit new immune re-
sponses to foreign protein types, but pre-existing immune responses lead to immediate loss
of the transplanted organ if not avoided.6 For this reason, patients’ transplantation possibil-
ities differ based on their immune systems. Some patients react to most organs, even from
donors with the same blood type, giving them fewer transplantation options. A patient’s im-
mune sensitization is commonly measured by Calculated Panel Reactive Antibodies (CPRA),
in a ride-sharing platform.
    6
      The immune system tags foreign objects (antigens) with antigen-specific antibodies so that white blood
cells (leukocytes) and complement (a blood protein) can defend against them. Each donor has blood-type
antigens and specific types of human leukoctye antigen proteins that are relevant for kidney transplantation.
Some patients have pre-existing antibodies to a subset of these antigens. A transplant recipient’s immune
system will immediately attack the donor kidney and reject the organ if the recipient has a pre-existing
antibody to any one of the donor antigens, making the donor incompatible (Danovitch, 2009). Following
transplantation of a compatible kidney, the immune system will attack any donor antigen not present in the
patient if such an attack is not attenuated by immunosuppressive medications.
                                                                                            7

which is the percentage of donors in a representative sample with whom they are tissue-type
incompatible.
Transplant benefits vary considerably with patient and donor characteristics, even conditional
on biological compatibility. There are several factors, including donor age and gender, health
prior to death, circumstances of death, measures of kidney function, and kidney anatomy
that are considered important determinants of kidney quality. In some cases, the donor may
have an infectious disease that the patient is at risk of contracting if they proceed with the
transplant. Size and weight match, tissue-protein similarity between the patient and donor,
and many other factors influence specific organs’ medical benefits for specific patients. We
refer the reader to Danovitch (2009) for further details about kidney biology.


2.2   The Allocation of Deceased Donor Kidneys

The deceased donor kidney allocation process is regulated by U.S. federal law. It is designed
and administered by the Organ Procurement and Transplantation Network (OPTN), which
coordinates patient registration, organ recovery, and the allocation process using a system
called UNet.
A patient with kidney disease may register on the waitlist when their kidney function falls
below twenty percent. During registration, UNet collects detailed information about the
patient’s immunological profile, health conditions, and factors used to compute priority. Pa-
tients may also set criteria that automatically exclude offers from organs based on donor
characteristics such as age, health, and kidney function.
The assignment of a potential donor’s organs begins after brain death is declared or cardiac
death is imminent and necessary consent has been obtained. Detailed information about
the donor’s medical history and the organ’s condition is entered into UNet. This system
screens out patients known to be incompatible with or to have excluded the donor; calculates
the priority order for the remaining patients; transmits information about the donor to the
transplant centers; and records their responses. In order to maintain organ viability, many
potential recipients may be contacted at once. This process can take place while the donor
is on life-support, before the organs are extracted. If several patients accept the donor’s
organ(s), the highest-priority patient(s) will receive the transplant(s).
When contacted, a potential recipient is first asked to indicate initial interest if further
information about the organ is pending. Once a kidney has been recovered from the donor,
those interested receive any new information discovered in the interim and must make a final
decision without delay, usually within an hour. This decision, which is typically made in
                                                                                                         8

consultation with a transplant surgeon, commits the patient to accepting the organ pending
the results of blood tests conducted using samples from the donor and patient.
The pre- and post-2014 priority systems are designed with both equity and efficiency concerns
in mind. The priority system used in NYRT prior to 2014 first offers kidneys to patients with
a perfect tissue-type match, then to patients from the local area in which the organs were
recovered, then regionally, and finally nationally. Within each group, patients are prioritized
based on tissue type similarity, whether or not the patient is pediatric, patient CPRA, and
waiting time (see OPTN, 2014, for details). The new kidney allocation rules implemented
in 2014 give the healthiest patients highest priority for the most desirable donors, increase
priority for extremely hard-to-match (high-CPRA) patients, and reduce emphasis on waiting
time. Israni et al. (2014) discusses this system and the rationale for the changes. Neither
system uses past decisions to calculate priority and, unlike assignment systems for some other
organs (for example, livers), priority does not depend on patient urgency.


2.3    Data and Descriptive Evidence

This study uses data from the Organ Procurement and Transplantation Network (OPTN).
The OPTN data system includes data on all donors, wait-listed candidates, and transplant
recipients in the US, submitted by the members of the OPTN. The Health Resources and
Services Administration (HRSA), U.S. Department of Health and Human Services provides
oversight to the activities of the OPTN contractor.
The datasets we use are sourced from UNet and contain detailed patient and donor char-
acteristics, the offers made, and accept/reject decisions. Our replication archive describes
the data in greater detail. For tractability, we restrict attention to data on offers made to
patients registered in NYRT between January 1st, 2010 and December 31st, 2013.7 NYRT
has the most patients of any donor service area in the U.S. that used the standard allocation
rules prior to 2014.
We now describe our sample of patients and donors and document choice patterns. A striking
feature of the waitlist is that even though there is extreme scarcity, some donors are rejected
by many patients. Choices suggest that large differences in donor quality, combined with
substantial priority for waiting time, incentivize patients to reject low-quality donors and
wait for more attractive offers.
   7
    We end our sample in 2013 to rule out anticipatory effects and to avoid modeling transition dynamics as
agents ancitipate the new system introduced in December 2014.
                                                                                                                      9

Patients and Donors

                                                                           Patients, Paper
                                       Table I: Patient Characteristics

                                                                 Patient Stocks, Arrivals, and Departures
                                                                         Panel A: Patient Stocks
                                                            January 1, 2010                    January 1, 2013
                                                        Mean              S.D.             Mean              S.D.
Number of Patients                                               3901                               4508
Years on List                                            2.00             1.81              2.38             1.95
Years on Dialysis                                        3.24             3.63              3.24             3.63
Prior Transplant                                        14.8%            35.5%             14.0%            34.7%
Current Age                                              53.7             13.4              54.1             13.4
Calculated Panel Reactive Antibodies (CPRA)              9.8%            26.0%             14.4%            30.2%
Body Mass Index (BMI) at Arrival                         27.8              5.9              27.9              5.8
Total Serum Albumin                                       4.0              0.6               4.0              0.6
Diabetic Patient                                        39.5%            48.9%             40.0%            49.0%
On Dialysis at Arrival                                  76.2%            42.6%             69.7%            46.0%

                                                                 Panel B: Patient Arrivals and Departures
                                                        Year 2010         Year 2011       Year 2012      Year 2013
# Patients Arriving                                        1379              1523           1503            1317
# Patients Departing                                       1093              1221           1304            1199
# Patients Received Deceased Donor Transplant               456               489            580             424
# Patients Received Living Donor Transplant                 222               258            237             286
# Patients Died or Too Sick to Transplant                   230               254            301             297
# Patients Departed for Other Reason                        185               220            186             186
Notes: 9,623 patients were active on the NYRT waiting list at some time between January 1st, 2010 and December
31st, 2013. Panel A contains statistics for patients registered in NYRT on January 1st of each calendar year. Panel B
contains statistics for patients who joined the NYRT waiting list (arrivals) and who were removed from the waiting list
(departures) during each calendar year. Panel C classifies departures by reason. "Departed for Other Reason"
includes transfers to non-NYRT transplant centers and miscellaneous departure reasons. Patients who received
transplants at a non-NYRT center are included in the Received Deceased Donor Transplant and Received Live
Donor Transplant categories.


Table I describes our patient sample. A total of 9,623 patients were registered with NYRT
and actively waiting at some point between 2010 and 2013. Panel A shows the state of the
waitlist on January 1st of 2010 and 2013. Our dataset includes indicators of patient health
(e.g. body mass index, age, total serum albumin) and medical history (e.g. diabetes, years
on dialysis). The average waiting time of patients on the list is a little over two years and has
increased over time. The average CPRA is about 12 percent, which indicates there is more
than a one-in-ten chance that a patient is tissue-type incompatible with a randomly chosen
donor. This mean is driven by a subset of patients who are incompatible with most donors.
Patients in NYRT face extreme scarcity, which results in long waiting times and many patients
dying while waiting. Each year, fewer than 200 donors are recovered from the NYRT area
                                                                                                               10

(Table II, Panel A), while about 1400 patients join the NYRT waitlist (Table I, Panel B).
This scarcity results in the average transplanted patient waiting for over three years before
receiving a deceased donor. Patients who do not receive a transplant most often leave the
list because they either die or become “too sick to transplant” (Table I, Panel B). A smaller
number are fortunate enough to receive a living donor transplant, which is more likely for
younger patients and often occurs within the first year on the waitlist. Finally, some patients
leave for other or unknown reasons including a move outside the NYRT area.
                                    Table II: Donor Characteristics


                                                       All                          Any Kidney(s) Discarded
                                                                                   Yes                    No
                                               Mean          S.D.           Mean         S.D.      Mean         S.D.

                                               Panel A: Donors Recovered in NYRT, By Number of Organs Allocated
Number of Donors Per Year                            183.5                        44.75                  138.75
Median Number of Offers per Donor                    26.0                         479.0                   14.0
Number of Offers per Donor                     445.8      1442.6            1445.0     2620.9      123.5       346.1
Number of Kidneys Transplanted per Donor        1.52       0.80              0.35       0.48        1.90        0.43
Donor Age                                       43.8       18.0              56.0       14.2        39.9        17.3
Cause of Death -- Head Trauma                  25.2%      43.4%             11.7%      32.3%       29.5%       45.7%
Cause of Death -- Stroke                       43.9%      49.7%             60.9%      48.9%       38.4%       48.7%
Diabetic Donor                                 14.4%      35.2%             25.1%      43.5%       11.0%       31.3%
Hypertensive Donor                             38.6%      48.7%             60.9%      48.9%       31.4%       46.4%
Expanded Criteria Donor (ECD)                  31.1%      46.3%             58.1%      49.5%       22.3%       41.7%
Non-Heart Beating Donor (DCD)                  9.7%       29.6%             12.3%      32.9%       8.8%        28.4%
Donor Creatinine                                1.3         1.5              1.5        1.2         1.3         1.6

                                                       Panel B: All Donors, By Number of Organs Allocated
Number of Donors Per Year                             1410.5                        896                   514.5
Median Number of Offers per Donor                     726.0                        1183.5                 230.5
Number of Offers per Donor                      1620.7     2564.3           2180.6      2965.0      645.6      1105.6
Number of Kidneys Transplanted per Donor         0.72        0.89             0.20        0.40       1.61       0.78
Notes: Panel A consists of all deceased kidney donors (734) recovered in NYRT and offered to NYRT patients
between January 1st, 2010 and December 31st, 2013. Panel B includes all donors (5,642) offered to NYRT patients
during the same period, including donors recovered outside NYRT. Offers exclude cases in which the donor did not
meet the patient's pre-determined criteria for acceptable donors, or in which the patient was bypassed by the waitlist
system due to operational considerations that did not involve an active choice by the patient or her surgeon.

Despite this scarcity, some kidneys are refused by many patients. Table II shows that across
donors, the mean number of biologically compatible offers that meet the pre-set screening
criteria is over 400, but the median is much lower, at 26. This skewed distribution arises
because undesirable kidneys are rejected by many patients, while desirable kidneys are ac-
cepted after only a few offers. Over 20 percent of donors have at least one viable kidney
                                                                                                              11

discarded. Organs from these donors were refused by an average of almost 1,500 patients.
Our observable donor covariates correlate with number of offers and discards in expected
ways. Panel A of Table II summarizes certain organ characteristics by the allocation outcome
for kidneys recovered in NYRT. Donors whose kidney(s) was/were discarded have higher
creatinine levels (indicating lower kidney function) and are older, less likely to die of head
trauma, more likely to be diabetic or hypertensive, and more likely to have donated after
cardiac death.
NYRT patients are also offered donors from other parts of the country. Panel B shows that
a total of 1,410 donors were offered to patients registered with NYRT in the average year.
Because most of these donors are offered to NYRT patients after being refused by many
patients outside NYRT, these donors tend to have undesirable organs with many offers and
high discard rates.


Waitlist, Offers, and Acceptance Rates

A patient’s position on the list improves with waiting time, and the mean waiting time falls
moving down the list of patients offered a given donor. The average waiting time amongst
patients in the top five positions exceeds four years, while this average is approximately
3.5 years for patients in the one hundredth position. Nonetheless, the system is not well-
approximated by a first come first served queue: points and priorities depend strongly on
characteristics other than waiting time. We calculated the fraction of times that two patients
who are offered the same donor are ordered identically on the list for the next donor they are
both offered. This fraction is 81.5 percent (see Table E.IX in the online appendix). It would
be 100 percent in a first come first served system.
Because lower-quality kidneys are offered to a large number of potential recipients, patients
receive many offers and the mean acceptance rate is low. Table III describes patterns of offer
and acceptance rates.8 Panel A considers all feasible offers, including biologically compatible
offers that did not meet the patient’s pre-set criteria. A typical patient receives over 200
offers per year, but only 0.14 percent of offers are accepted. When interpreting these low
acceptance rates, it is important to remember that undesirable organs are offered to a very
large number of patients.
Offers from desirable donors are rare and much more likely to be accepted. Kidneys recovered
in NYRT are accepted five times more often than those recovered outside NYRT, and 10.8
   8
    We exclude offers that did not result in assignment due to logistical reasons such as surgeon unavailability,
OPO operational considerations, or special donor-specific considerations such as expedited organ placement
or directed donation.
                                                                                                                                       12
                                                                                                                       Offers, Paper
                              Table III: Rates of Receiving and Accepting Offers                                                            P


                                  Number of
                                                                               Offer & Acceptance Rates
                                   Patients
                                                          All Donors                 NYRT Donors            Perfect Tissue Type Match
                                               Annual Rate      % Accepted    Annual Rate % Accepted Annual Rate            % Accepted
                                                                             Panel A: All Offers
All                                  9623         213.2           0.14%            37.0            0.74%       0.095          10.8%
On Dialysis at Registration          6513         211.5           0.15%            38.6            0.77%       0.090          11.4%
Not on Dialysis at Registration      3110         216.6           0.12%            33.6            0.66%       0.103           9.8%
Age 0-49 at Registration             3921         211.8           0.16%            38.3            0.81%       0.087          14.7%
Age 50+ at Registration              5702         214.1           0.13%            36.1            0.68%       0.100           8.6%



                                               Panel B: Offers Within the First 10 Positions that Met Screening Criteria
All                                  9623           0.8           24.53%           0.8             25.81%      0.021          48.6%
On Dialysis at Registration          6513           0.8           24.70%           0.8             25.93%      0.017          48.5%
Not on Dialysis at Registration      3110           0.8           23.99%           0.8             25.40%      0.029          48.9%
Age 0-49 at Registration              3921           1.3        25.37%           1.3          26.23%            0.020           56.5%
Age 50+ at Registration               5702           0.5        23.34%           0.4          25.17%            0.022           42.7%
Notes: There were 2,713,172 offers made to NYRT patients between January 1st, 2010 and December 31st, 2013. Panel B restricts
to the first 10 NYRT patients in each donor's offer sequence. An offer Met Screening Criteria if the offer satisfied a patient's pre-
determined criteria for acceptable donors. “Annual Rate” columns report annual offer rates computed by patient and then averaged
across patients.



percent of perfect tissue-type match offers are accepted. Panels B further restricts to offers
to patients in the first ten positions that met the patients’ screening criteria. These offers
are likely more attractive since the organs have not been refused by many patents. The
typical patient can expect to receive less than one such offer each year and accepts one in
four. Older patients are less likely to receive one of these desirable offers, in part because
they are more likely to depart the waitlist before receiving a transplant. This fact puts them
at a disadvantage in a mechanism that prioritizes waiting time.
Taken together, these statistics suggest that the supply of desirable donors in NYRT is scarce
and it is necessary to wait for several years to gain priority to access these donors. This creates
a strong incentive for patients to wait.


Motivating Evidence for Waitlist Redesign

Table IV describes transplants that occur. Pediatric patients receive high priority and are
very likely to be transplanted, either with a deceased donor kidney or through a living
                                                                                    Page donor.
                                                                                         3
Transplant rates are lower among adults, and there is no signficant gradient in transplant
probability with age. Panel A describes deceased donors by age for transplanted patients.
Pediatric patients almost exclusively receive transplants from young donors. In contrast,
                                                                                                                               13

                          Table IV: Transplant Rates by Age and Dialysis Status
                                                                                                                                      paper
                                                       Patient Age                             On Dialysis at Registration             1
                                   0-17       18-34       35-49        50-64        65+             Yes             No                 1
    Patient Population            2.1%        11.0%       27.3%       41.5%       18.1%           67.8%           32.2%                1
    Transplanted Patients         4.6%         9.7%       26.7%       41.3%       17.6%           73.3%           26.7%                1
                                                                                                                                       1
                                                            Panel A: Donor Age and Quality                                             1
    Donor Age 0-17                25.6%       14.7%        7.5%        4.5%        4.7%            6.8%            8.7%                1
    Donor Age 18-35               72.2%       36.8%       26.3%       16.4%       12.5%           22.3%           24.6%                1
    Donor Age 35-49               2.2%        30.5%       34.2%       28.7%       16.6%           27.6%           25.2%                1
    Donor Age 50-64               0.0%        16.8%       29.9%       42.6%       53.4%           37.3%           34.6%                1
    Donor Age >= 65               0.0%         1.1%        2.1%        7.9%       12.8%            5.9%            6.9%                1
    Notes:
Notes:     Transplanted
       Percentages         patients
                   in the first      referrepresent
                                two rows    to thosethe
                                                     who  received
                                                        share        a deceased
                                                              in the patient      donorwith
                                                                             population transplant.
                                                                                            a specific characteristics. Percentages
in the in the second row restrict to patients that received a deceased donor transplant. Each column in Panel A describes the
share of transplanted patients within the group indicated in the column that received a transplant from a given donor type.



while there is some assortative matching by age among adults, many patients above age 65
receive kidneys from young and middle-aged donors.
The 2014 reforms were in part motivated by concerns that these observations reflect mis-
match, and that healthier (typically younger) patients should receive the organs predicted to
last longest (Israni et al., 2014). However, it may be optimal to match some younger donors
to older patients if there is considerable match-specific heterogeneity, or if other donor char-
acteristics strongly predict organ quality. Our structural model will allow us to quantify the
extent to which a welfare-maximizing mechanism should match donors and patients based
on age rather than other factors, taking heterogeneity and dynamic incentives into account.
Another patient characteristic that will be important for the improvements we identify is
whether the patient had already begun dialysis when they joined the waitlist. Some patients
with kidney disease who qualify for the waitlist still have marginal kidney function and
can avoid dialysis for some time. These patients are relatively healthy compared to patients
already on dialysis at registration. The last two columns of Table IV show that while patients
not yet on dialysis at registration represent 32 percent of our patient sample, they receive
only 27 percent of deceased donor transplants.


Evidence of Response to Dynamic Incentives

A central assumption in our framework is that agents are forward-looking and respond to
dynamic incentives. One implication of this assumption is that patients for whom the option
value of waiting is lower should be less selective. Agarwal et al. (2018) present descriptive
                                                                                                          14

evidence consistent with dynamic incentives using data from all areas of the United States and
find that highly sensitized patients who are immunologically compatible with fewer donors
– and who therefore expect to receive fewer offers in the future – are more likely than less
sensitized patients to accept similar offers. We replicated this research strategy in the NYRT
sample and found qualitatively similar patterns (see online appendix section C.2). We refer
the reader to their paper for a more detailed discussion of the empirical strategy and potential
confounds.


3     A Model of Decisions on a Waitlist

We use the following notation throughout the paper. Objects are indexed by j, agents by
i. Let xi denote the vector of observed characteristics of agent i; zj the observed character-
istics of object j that are included in the model; ηj a donor quality index constructed from
characteristics that are observed by agents but not included in the empirical specifications;9
and t indicates the amount of time the agent has been waiting on the list. The model does
not include unobserved agent heterogeneity. We discuss this restriction in section 4. Finally,
let cij = 1 if j is compatible with i, and 0 otherwise. Incompatibility can arise for biologi-
cal reasons in organ allocation but may arise due to other restrictions (e.g. legal) in other
contexts.
This section begins by defining a class of sequential assignment mechanisms, primitives gov-
erning agents’ decisions, and the agent arrival and departure processes. We then provide
assumptions on agents’ payoffs and beliefs which lead to a tractable optimal stopping prob-
lem from the agent’s perspective.


3.1     Mechanisms and Primitives

3.1.1   Mechanisms

We consider sequential assignment mechanisms that use a priority score. The mechanism
allocates each object as follows:

    • Step 1 (Ordering): The priority score sijt ≡ s (t; xi , zj ) is calculated for all agents on
      the waitlist. Ties in the score, if any, are broken using a known tie-breaking rule.
   9
     We include this term for two reasons. First, there are hundreds of donor characteristics in the dataset,
far too many to include in the empirical specifications. Second, surgeons have information about the organ
that are not included in the dataset.
                                                                                                             15

   • Step 2 (Offers): Each agent may decide to accept or reject the object, with acceptance
     denoted by aij = 1. The mechanism may solicit decisions from multiple agents simul-
     taneously but may not skip any agents in the priority order. No offers are made to
     agents known to be incompatible with the object.

   • Step 3 (Assignment): The objects are assigned to the agents with the highest qj prior-
     ities for whom aij = 1, where qj is the number of copies of the object available.

   • Step 4 (Arrivals and Departures): An agent is removed from the waitlist once an object
     has been assigned to them. Other agents may join or leave the list.

Within the set of offer-based waitlist mechanisms, the primary restriction in our formulation
is that an agent’s priority does not depend on either the other agents in the market or their
past actions. All deceased-donor organ allocation mechanisms and proposals considered
prior to the 2014 reform were offer mechanisms based on priority scores which shared these
properties.10 Our empirical exercises required us to develop computer code to calculate the
order in which any organ would be offered using administrative data on patient and donor
characteristics. We verified our code’s output using the observed sequence of offers.
A complication in our setting is that organs must be allocated within a certain time frame.
Several logistical constraints limit the number of offers that can be made. We treat the
maximum number of offers that can be made for each object as exogeneous because we do
not have data on the factors that determine this limit. Our qualitative conclusions are robust
to removing this limit.


3.1.2   Payoffs

There are three types of primitive payoffs in the model. The first is the expected net present
value to agent i of being assigned object j after waiting t periods, Γij (t). In our application,
Γij (t) captures a patient’s value of various kidney transplants. The second is the expected
net present value from departing without an assigment, Di (t). In our application, departures
occur due to living donor transplants, death, or transfers to other listing centers (see Table
I). The term Di (t) incorporates all of these reasons.11 Finally, agents receive an expected
  10
     Based on an examination of committee reports and public comments downloaded from
https://optn.transplant.hrsa.gov/members/committees/kidney-committee/.
  11
     We canP represent the value of a departure as a weighted average over the value of the various events, i.e.
Di (t) = k pik (t) Dik (t) where k denotes the type of depature (e.g. obtaining a live donor, death, etc.) and
pik (t) is the probability of each type of depature conditional on a departure occuring. The formulation only
requires that each source satisfy Assumption 1(iii) below.
                                                                                                      16

flow payoff while waiting on the list, di (t). In our application, di (t) is the flow payoff from
living without a functioning kidney.
Two implicit assumptions about the payoffs in our model are worth noting. First, we abstract
away from costs of considering an offer. These costs are likely small relative to the value of
transplants. Second, we assume that agents only value their own outcomes and not those
of others. This may be violated if surgeons value the outcomes of other patients, especially
those they are treating. NYRT has a total of 10 transplant hospitals staffed with many more
kidney transplant surgeons, limiting common agency problems that surgeons might face. We
assume that surgeons act in the best interest of each of their patients while the patient
considers an offer.
We make the following assumptions about these payoffs:
Assumption 1. (i) The expected net present value of an assignment is additively separable
in a payoff shock εijt :
                            Γij (t) ≡ Γ (t, xi , zj , ηj ) + εijt .                   (1)

(ii) The random variable εijt are independent and identically distributed (iid) with a known,
non-atomic distribution with cumulative distribution function (cdf) G.
(iii) The expected flow payoffs from waiting, di (t), and the expected payoff from departing
without an assignment, Di (t), are exogenous and depend only on (xi , t) .

The separability and independence restrictions on εijt imposed in Assumptions 1(i) and 1(ii)
are common in the dynamic discrete choice literature (see Rust, 1987, for example). They en-
able an estimation approach based on the inversion technique of Hotz and Miller (1993). Our
empirical specifications assume that G is the cdf of the standard normal, Φ. An important
restriction in Assumption 1 is that it excludes persistent agent-level unobserved heterogene-
ity. Instead, our specifications include a rich set of patient and donor characteristics. Section
4 discusses challenges with relaxing this assumption and the advantages of our approach.


3.1.3   Arrivals and Departures

Time is continuous. Objects and agents arrive at Poisson rates λ and γ, respectively. The
characteristics x of each arriving agent are iid. Similarly, each object’s characteristics (z, η)
are drawn iid from the cdf F upon arrival. We assume that each object must be assigned
before the next object is offered. The Poisson arrival process and continuous time together
imply that simultaneous arrivals are zero probability events.12 Agents may depart the list
  12
    The continuous time formulation is consistent with the real world and computationally convenient. A
discrete-time model would have to define a period length and specify how decisions are made when multiple
                                                                                                             17

due to or prior to assigment.
We make the following assumption on the arrival and departure processes:
Assumption 2. (i) Departures prior to assignment and arrivals are governed by independent
and exogenous Poisson processes.
(ii) The departure rate of agent i at time t is given by δi (t) ≡ δ (t; xi ). Further, each agent
has a terminal date Ti < ∞ at which departure occurs with probability 1.

In our application, we assume that patients die on or before their 100-th birthday. Ti therefore
corresponds to the waiting time for a patient on the day they turn 100 years of age.13
The primary economic restriction in our application is that departures prior to assignment
and arrivals do not depend on the design of the deceased donor kidney waitlist. Table I
shows that the most common reason for departure without a deceased donor transplant is
death or becoming “too sick to transplant.” It seems safe to assume that these events are not
responsive to the design of the waitlist. The second most common reason is receiving a living
donor transplant. Departures due to this reason are exogeneous if the design of the waitlist
does not affect the probability of finding a compatible living donor, and if patients always
prefer a living donor to staying on the deceased donor waitlist. These conditions are plausible
in our setting because living donors produce much better post-transplant outcomes.14
Similarly, we assume that agent arrivals do not depend on the design of the waitlist. During
our sample period, patients could register as soon as they started dialysis or their kidney func-
tion was sufficiently low (below a glomerular filteration rate of 20mL per minute). Therefore,
it is in a patient’s interest to join the waitlist as soon as possible.


3.2    Individual Agent’s Problem

Agents on the waitlist who receive an offer of an object must decide whether to accept it
or reject it and wait for future offers. This results in an optimal stopping problem from
the perspective of the agent (Pakes, 1986; Rust, 1987). This section starts by describing the
offers an agent can expect to receive, which allows us to set up the value function. Finally, we
introduce a normalization that simplifies the value function and is without loss of generality
for our counterfactual exercises.
offers arrive in one period. A time interval short enough so that only one offer can arrive at a time adds
notational and computational complexity without substantitive differences.
   13
      It is straightforward to allow for agents that could remain on the list forever, Ti = ∞, as long as the
value function for each patient approaches a constant.
   14
      Hart et al. (2017) compare chances of graft failure 10 years after transplantation for living and deceased
donor organs. This statistic for adults transplanted with a deceased donor kidney in 2005 is 52.8%, whereas
it is only 37.3% for those who received a kidney from a living donor.
                                                                                                             18

3.2.1   Offer Probabilities and Beliefs

To make an informed decision, an agent must form beliefs about the organs they can obtain
in the future if they decline the current offer. Let s∗j be the priority score of the pivotal agent
offered object j. Agent i is assigned a compatible object j if they accept it and their score
sijt is at least s∗j . Therefore, it is sufficient for an agent to form beliefs over the probability
distribution of s∗j . In the kidney allocation context, s∗j is the lowest priority score among the
transplanted patients if none of donor j’s kidneys are discarded. If at least one kidney is
discarded, then s∗j is the lowest priority score amongst the patients offered the kidney. The
score s∗j is random because it depends on the decisions of all agents offered object j, their
compatibility, and the maximum number of offers that can be made.
Beliefs about the distribution of s∗j depend on organ quality and the agent’s information
about the competitive environment. In principle, the agent’s information set could include
their previous offers and the other agents currently on the waitlist. However, there are several
reasons, discussed below, why beliefs are unlikely to be sensitive to such detailed information.
We therefore make the following assumption:

Assumption 3. Each agent i believes that the probability that an object with characteristics
(zj , ηj ) is compatible and will be available to her if it arrives when the agent has waited t
periods is
                        π (t; zj , ηj , xi ) = H (sijt ; zj , ηj ) × P ( cij = 1| zj , xi ) ,

where sijt = s (t; zj , xi ) and H (·; zj , ηj ) is the cdf of the cutoff s∗j given (zj , ηj ).

This assumption embeds three key restrictions. First, it assumes that beliefs are not sensitive
to short-term variation in the set of other agents currently on the waitlist. This concern is
limited because a surgeon cannot directly obtain information about patients they are not
treating, and NYRT has ten transplant hospitals and many surgeons. Second, it abstracts
away from inference about the likelihood of future offers based on past offers. The set
and order of patients on the waitlist varies significantly across donors due to patient-donor
specific compatibility and prioritiy, limiting the ability to predict future offers based on recent
experience. Furthermore, our data do not indicate that recent offers are predictive of future
cutoffs,15 or that a patient’s recent offer history predicts acceptance.16 Third, it assumes
  15
     We cannot reject zero autocorrelation in priority score cutoffs s∗j across organs ordered by the date on
which they arrived, even within donor subgroups. One would not expect this to be the case if the offers a
patient observed contained information about the likelihood of receiving future offers. See Table E.VIII.
  16
     We tested whether, controlling for characteristics of both the patient and the current offer, recent offers
predict acceptance behavior. Our estimates are precise and suggest that recent offer rates are not predictive
                                                                                                                         19

that the probability an organ is compatible depends only on observables and is independent
of the cutoff. This restriction is appropriate in our context because surgeons list the blood
and tissue types that are known to be incompatible with the patient.
Assumption 3 is a reasonable approximation if beliefs are based on average offer probabilities
observed by a surgeon over a long period of time. This simplification is similar in spirit to
other equilibrium concepts that condition on steady state or long-run quantities in order to
make the analysis of dynamic games tractable (Hopenhayn, 1992; Krusell and Smith, 1998;
Weintraub et al., 2008; Fershtman and Pakes, 2012). The assumption eases analysis relative
to more general forms of beliefs because it avoids conditioning on the sequence of observed
offers in the past.17 Despite this simplification, our state space continues to be quite rich
because it contains all characteristics that influence payoffs, priorities, or compatibility.


3.2.2    Value functions

We assume that agents make optimal accept/reject decisions by comparing the net present
value of an object to the value of waiting. Agent i decides to remain on the list instead of
accepting object j if the payoff from an assignment Γij (t) is less than the value of continuing to
wait conditional on the agent’s type xi and current waiting time t, denoted Vi (t) ≡ V (t; xi ).
The Hamilton-Jacobi-Bellman differential equation defining the value of waiting at time t is:
                                                         Z             Z
 (ρ + δi (t)) Vi (t) = di (t) + δi (t) Di (t) + λ        max {0, Γij (t) − Vi (t)} dGdF + V̇i (t) ,
                                                             πij (t)
                                                                                                    (2)
where ρ is the discount rate, the inner integral computes the expectation over the idiosyncratic
payoff shocks εijt in equation (1), and, with a slight abuse of notation, πij (t) = π (t; xi , zj , ηj )
defined in Assumption 3.
This expression can be derived by considering an agent’s value of waiting at time t for an
infinitesimal duration ∆t. If no object arrives, the agent incurs flow payoffs from dialysis
di (t) ∆t and may depart exogenously with probability δi (t) ∆t, receiving payoff Di (t). An
object arrives with probability λ∆t, its characteristics drawn from the cdf F . The integral
calculates the expected increment in the agent’s value function due to each arrival. Specif-
ically, the agent receives an offer for this object with probability πij (t) and accepts it if
Γij (t) > Vi (t), yielding an incremental value of max {0, Γij (t) − Vi (t)} dG. In the limit as
                                                  R


of current acceptance behavior. This result is robust to various measures of recent offer rates and versions
that only consider offer rates from desirable donors. See Table E.VII.
   17
      Formally, beliefs would be conditioned on a richer information                        set, denoted Fi,t , by replacing
H (sijt ; zj , ηj ) with H (sijt ; Fi,t , zj , ηj ) = P s∗j < sijt Fi,t , zj , ηj . In our setting, agents only know the past
                                                                                 

offers that they have received.
                                                                                                             20

∆t → 0, the probability that both departures and object arrivals occur within the interval
∆t tends to zero, yielding the differential equation above.18
Due to the option value of potential future offers, a patient may refuse an offer that they
would accept if the alternative were never receiving a transplant. Moreover, certain marginal
organs may be refused by all patients on the list and discarded even though some patients
would benefit from the transplanted organ relative to no assignment.


3.2.3      Normalization and Simplifying the Value Function

A typical dataset from a sequential assigment mechanism only contains information about
accept/reject decisions. As is well understood, data on actions alone do not identify all
primitives of a dynamic discrete choice model, and the payoff from one action must be
normalized in each state (Magnac and Thesmar, 2002). However, Aguirregabiria and Suzuki
(2014) and Kalouptsidi et al. (2020) point out that such normalizations may affect certain
counterfactual analyses because they arbitrarily restrict payoffs from specific actions across
states. If this is the case, the counterfactuals are not identified. This fact poses a potentially
serious barrier to answering questions that depend on primitives that are not identified from
choice data.
Fortunately, our model admits a valid normalization such that counterfactuals involving
changes in the mechanism are identified. Consider the inclusive value of an agent who
declines every waitlist offer, Oi (t).19 Such an agent receives the flow payoff of waiting and
the value of departure when it occurs. The value at time t is defined by the differential
equation
                        (ρ + δi (t)) Oi (t) = di (t) + δi (t) Di (t) + Ȯi (t)

and the terminal condition Oi (Ti ) = Di (Ti ) . Assumptions 1(iii) and 2(i) together imply that
  18
       The discretized version of the equation defining the value of waiting at time t is:
                                                             Z       Z
                      1
         Vi (t) =            di (t) ∆t + δi (t) ∆tDi (t) + λ∆t πij (t) max {Vi (t + ∆t) , Γij (t)} dGdF
                   1 + ρ∆t
                + (1 − (δi (t) + λi (t)) ∆t) Vi (t + ∆t) + o (∆t)] ,
                    R
where λi (t) = λ πij (t) dF is the rate at which agent i expects to receive an offer at time t. The leading
fraction represents discounting due to time preferences. The first three terms inside the brackets are described
in the text. The remainder term includes the payoff in the event that multiple donors or objects arrive, or
that a donor arrives and the patient departs, within ∆t. These events have probability of order o (∆t).
Therefore, the remainder is of order o (∆t) as long as all expected payoffs are bounded. Taking the limit as
∆t → 0 under mild continuity conditions yields the differential equation above.
   19
      It is the inclusive value of choosing the outside option defined as no assignment through the deceased
donor waitlist, including the possibility of receiving a living donor transplant.
                                                                                                                 21

Oi (t) does not depend on the mechanism. As we now show, it suffices to measure Vi (t) and
Γij (t) relative to Oi (t) in order to analyze optimal decisions and changes in welfare induced
by offer probabilities under current and alternative mechanisms:

Proposition 1. Let Vi (t) be the solution to equation (2) with boundary condition Vi (Ti ) =
Oi (Ti ) . Suppose Assumptions 1 – 3 hold. Then (i) Ṽi (t) = Vi (t) − Oi (t) solves
                                            Z                 Z
                                                                  max 0, Γ̃ij (t) − Ṽi (t) dGdF + Ṽ˙i (t)
                                                                       n                                 o
             (ρ + δi (t)) Ṽ i (t) = λ              πij (t)

with boundary condition Ṽi (Ti ) = 0, where Γ̃ij (t) = Γij (t) − Oi (t), and (ii) for any two
functions π and π 0 , Vi (t; π)−Vi (t; π 0 ) = Ṽi (t; π)−Ṽi (t; π 0 ) where the parameter π is introduced
in the notation for clarity.

See Appendix A.1 for the proof. This result shows that optimal decisions and several coun-
terfactual quantities are invariant to Oi (t). Part (i) states that the value of waiting relative
to either declining every waitlist offer or accepting any given offer does not depend on the
function Oi (t). Therefore, models with different functions Oi (t) yield the same optimal deci-
sions and are observationally equivalent. Part (ii) states that different functions Oi (t) yield
the same differences in the value function between any two offer probabilities and therefore
under any two mechanisms that produce these offers.
We therefore normalize Oi (t) to zero at all t ∈ [0, Ti ]. The rest of the paper interprets Γij (t)
and Vi (t) as values relative to declining every waitlist offer. This normalization implies that
di (t) + δi (t) Di (t) = 0 for all t and that Di (Ti ) = 0. Hence, a benefit is that we no longer
need to estimate the payoffs from remaining on the list or departing without an assignment
because equation (2) reduces to
                                            Z                 Z
             (ρ + δi (t)) Vi (t) = λ                πij (t)       max {0, Γij (t) − Vi (t)} dGdF + V̇i (t) .     (3)

It will be useful to re-write this differential equation as
                       Z   Ti
        V (t; xi ) =            exp (−ρ (τ − t)) p (τ |t; xi )
                       t
                  Z                            Z                                                            
                   λ        π (τ ; xi , z, η)        max {0, Γ (τ, xi , z, η) + εijt − V (τ ; xi )} dGdF dτ,     (4)

where                                                                 Z    τ                        
                                                                                    0            0
                                       p (τ |t; xi ) ≡ exp −                    δ (τ ; xi ) dτ
                                                                        t

is the probability that agent i does not exogenously depart before τ conditional on being
                                                                                                          22

on the list at t. We have explicitly reintroduced agent and object characteristics into the
notation because this equation will form the basis of our empirical strategy. This expression
uses the boundary condition limt→Ti V (t; xi ) = Di (Ti ) = Oi (Ti ) = 0 because the probability
of receiving an offer after t vanishes as t → Ti . A similar result holds for an alternative model
that considers the limit case with Ti = ∞.


4     Estimation

The key primitives needed to predict equilibrium allocations and welfare under alternative
mechanisms are the transplant values, Γ (t, x, z, η). The challenge for estimation is that
acceptance decisions in our data depend on both the value of the offered organ and the value
of continuing to wait. This section begins by representing the value function and the payoff
from assignment in terms of Conditional Choice Probabilities (CCPs) and then describes the
estimation approach, presents the empirical specification, and discusses alternative methods.


4.1    A CCP Representation

We develop a CCP representation which will allow us to estimate our model without solving
the integral equation that defines the value function (equation 4). Let Pijt = P (t, xi , zj , ηj )
be the conditional probability that agent i refuses an offer of kidney j given (t, xi , zj , ηj ). We
will estimate the function P (·) in the next section. The CCP approach is based on two key
relationships:

Proposition 2. Suppose Assumptions 1– 3 hold. Then (i) the conditional choice probabilities
are given by
                         Pijt = G (V (t; xi ) − Γ (t, xi , zj , ηj )) ,                 (5)

and (ii) there exists a known function ψ such that
                                    Z
                      ψ (Pijt ) =       max {0, Γ (t, xi , zj , ηj ) − V (t; xi ) + εijt } dG,           (6)

where Pijt = P (t, xi , zj , ηj ) ∈ (0, 1) .

Part (i) follows from Pijt = P ( V (t; xi ) > Γ (t, xi , zj , ηj ) + εijt | t, xi , zj , ηj ) and G being the
CDF of εijt . Equation (5) is analogous to the well-known result that CCPs are a known
function of differences between choice-specific conditional value functions. Part (ii) follows
from substituting V (t; xi ) − Γ (t, xi , zj , ηj ) = G−1 (Pijt ) from equation (5) into equation (6),
                                                                                                                      23

which yields the function ψ (·). The result, a special case of proposition 1 in Hotz and
Miller (1993), shows that the incremental value of an offer, defined as the difference between
the value of continuing to wait and the expected value from the optimal choice, is a known
function of CCPs. Since our application assumes that G = Φ, the cdf of the standard normal,
we obtain the simple closed-form expression ψ (P ) = Φ0 (Φ−1 (P )) − (1 − P ) Φ−1 (P ) .
These two equations can be used to re-write the primitive of interest, Γ (t, xi , zj , ηj ), by
substituting part (ii) into the integral equation for V (t; xi ) (equation 4):
                         Z      Ti                                      Z                               
          V (t; xi ) =               exp (−ρ (τ − t)) p (τ |t; xi ) λ        π (τ ; xi , z, η) ψ (Pijτ ) dF dτ.      (7)
                            t


Using this expression in conjuction with part (i), we obtain:
                                             Z    Ti                                Z                                
                         −1
Γ (t, xi , zj , ηj ) = −G        (Pijt ) +             exp (−ρ (τ − t)) p (τ |t; xi ) λ   π (τ ; xi , z, η) ψ (Pijτ ) dF dτ.
                                              t
                                                                                                                     (8)

The next subsection shows how to estimate the primitives of interest, Γ (·) and the distribu-
tion of ηj , using the expressions above.


4.2    Estimation Procedure

We estimate the model in four steps. First, we estimate p (τ |t; xi ) and λ using observed
patient departures and donor arrivals, respectively. Second, we estimate conditional choice
probabilities from patient accept/reject decisions. Third, we estimate the integral in equation
(7) using the empirical distribution of donor types and cutoff scores to estimate F and π.
In the final step, we recover transplant values Γ (t, x, z, η) by solving for each patient’s value
function at each date using equation (8).
As is well known, time preferences are not identified from observed choices alone in dynamic
discrete choice models (Magnac and Thesmar, 2002). We therefore set the discount rate ρ to
a fixed value of 5 percent per year. Our results are robust to using an annual discount rate
of 10 percent. This robustness in part arises because agents also devalue future offers due
to exogenous departures. Since we estimate the departure rate δi (t; x) to be 16 percent per
year for the average patient, this term dominates ρ in our value function (see equation 3).
                                                                                                           24

Step 1: Estimating Rates of Patient Departure and Donor Arrival

Our dataset contains information on how long each patient is on the waitlist and whether
departure occurred due to a transplant. Time on the list is a censored measure of the
departure time without a deceased donor transplant if the patient is either transplanted with
a deceased donor or still on the list at the end of the sample period. Despite censoring,
these durations can be used to estimate departure rates independently of payoffs because
Assumption 2 implies that, conditional on patient characteristics, departure from the list
prior to assignment is exogenous.
We use maximum likelihood to estimate a censored Gompertz proportional hazards model
in which the rate of departure takes the form

                                      δ (t; xi ) = δ1 exp (δ2 t) exp (xi β) ,                             (9)

where δ1 exp (δ2 t) is the baseline hazard function and xi are observed patient covariates. This
parametric form yields a simple expression for the survival function p (τ |t; xi ) ≡ exp (− tτ δ (τ 0 ; xi ) dτ 0 ),
                                                                                           R

which eases computation of equation (7). It turns out that the estimates from this model
model yield a survival curve similar to those from the semi-parametric Cox proportional
hazards model.
Since donor arrivals are exogeneous, we estimate λ as the empirical mean arrival rate, which
is the maximum likelihood estimator for a Poisson process.

Step 2: Estimating the CCPs, P (t, xi , zj , ηj )

Because the state space is multi-dimensional and includes continuous variables, a frequency
estimator for the CCPs is infeasible. We therefore model the accept/reject decision using a
flexible basis and a link function (see Arcidiacono and Ellickson, 2011).
                                                                                            
Assume that Γ (·) is additively separable in ηj and that ηj ∼ N 0, ση2 , with a variance to
be estimated. Then, equation (5) implies that the CCPs are a function of the difference
∆ (xi , zj , t) − ηj ≡ V (t; xi ) − Γ (xi , zj , ηj , t). We estimate the CCPs using a flexible basis for
∆ (·) and the probit link function. Specifically, we set

                                  P (t, xi , zj , ηj ) = Φ (χ (xi , zj , t) θ − ηj ) ,

where χ (·) is a flexible set of functions with interactions between its arguments, θ is an
unknown parameter to be estimated, and ∆ (·) = χ (·) θ.20 Our specification of χ (·) includes
  20
       This formulation is an example of an arbitrary link function L−1 that need not equal the inverse CDF of
                                                                                                                          25

dummies in xi and zj for categorical variables, piecewise linear splines for their continuous
elements and for t, and interactions among several categorical variables and splines.
Standard arguments imply the identification of these parameters. The parameter θ is iden-
tified by the relationship between the covariates and the probability of acceptance. The
variance, ση2 , of the donor-specific unobservable is identified because many donors have two
offered kidneys. If ση2 is large, then conditional on the observables xi , zj , and t, early accep-
tance of a donor’s first kidney predicts that the second acceptance should soon follow. In
constrast, if ση2 is small, then the position of the first acceptance should have little informa-
tion about the second. The intuition is similar for the identification of measurement error
models (see Kotlarski’s theorem in Rao, 1992; Hu and Schennach, 2008).
We estimate the parameters (θ, ση ) using a Gibbs’ sampler (McCulloch and Rossi, 1994;
Gelman et al., 2014), which is asymptotically equivalent to a maximum likelihood estimator
(see van der Vaart, 2000, Theorem 10.1 (Bernstein-von-Mises)).21 This procedure is more
computationally tractable than maximum likelihood for models with unobserved heterogene-
ity because computing the likelihood function given data on decisions and the observables
(xi , zj , t) requires integrating over the distribution of ηj . The Gibbs’ sampler uses data aug-
mentation and Markov-Chain Monte Carlo sampling for this task.


Step 3: Estimating V (t; xi ) using Offer Arrivals and CCPs

Next, we use equation (7) to calculate V (xi ; t) by numerically integrating the incremental
value generated by offers that a patient can expect to receive in the future. This step requires
us to integrate over future points in time, τ , and future donor types (z, η). We have estimated
the terms λ and p (τ |t; xi ) in Step 1 and have set ρ as discussed earlier.
The only remaining term in equation (7) is the expected value from the arrival of a donor at
time τ :
                                                      Z
                                 W (xi , τ ; θ0 ) =       π (τ ; xi , zj , ηj ) ψ (Pijτ ) dF.

Estimating this value is challenging because we observe at most one offer at time τ , and only
for patients who are on the list. Moreover, whether an offer is made to patient i depends on
εijt , Φ−1 . In the general case, V (t; xi ) − Γ (xi , zj , ηj , t) = G−1 (L (χ (xi , zj , t) θ − ηj )), where the argument of
G−1 (·) equals P (t, xi , zj , ηj ). The remaining estimation steps can proceed exactly as described below, but
with minor modifications to the expressions. We set L−1 = G−1 to simplify computation.
   21
      We obtain draws of the parameters θ and ση from a sequence of conditionalposterior distributions using
a Markov chain given dispersed priors and an initial set of parameters θ0 , ση0 . The invariant distribution
of the Markov chain is the posterior given the prior and the data. Details on the implementation, including
burn-in procedures and convergence diagnostics, are in Appendix A.2.
                                                                                                               26

the arriving donor’s type, the patient’s priority score, and other patients’ decisions. Instead of
estimating this high-dimensional object using offers received by similar patients, we directly
use the properties of the mechanism and Assumption 3 to make progress.
Recall that agent i receives an offer for object j if their known priority score sijτ is at least
s∗j . Knowledge of the mechanism allows us to calculate sijτ . Therefore, it is sufficient to
characterize the joint distribution of the characteristics of the arriving donors (zj , ηj ) and
their cutoff scores s∗j . Formally, Assumption 3 implies that we can rewrite πij (t) to obtain
                                Z Z                            n            o                  
           W (xi , τ ; θ0 ) =         P (cij = 1|zj , xi ) 1 sijτ ≥ s∗j ψ (Pijτ ) dH s∗j ; z, ηj dF
                                 h                         n            o                 i
                          ≡ E P (cij = 1|zj , xi ) 1 sijτ ≥ s∗j ψ (Pijτ ) xi , τ .

We estimate this expectation using the observed cutoffs and characteristics of all donors in
our data because their distributions are time-invariant. Specifically, we estimate W (xi , τ ; θ0 )
using a sample analog that replaces P (cij = 1|zj , xi ) and ψ (Pijτ ) with estimated quantities:

                                                J
                                           1X                  n          o      
                       Ŵ xi , τ ; θ̂ =            P̂ (cij = 1) 1 sijτ ≥ s∗j ψ P̂ijτ ,                      (10)
                                             J j=1

where j indexes a donor in our sample. The first term, P̂ (cij = 1), is an estimate of
P (cij = 1|zj , xi ) constructed using information on donor proteins and patient immune system
                                                                                                        
characteristics.22 The third term replaces ψ (Pijτ ) with the estimate P̂ijτ = Φ χ (xi , zj , τ ) θ̂ + ηj ,
where θ̂ is the estimated parameter and ηj is a draw from its distribution. Because the dis-
tribution of s∗j and ηj are dependent, we draw from the conditional distribution of ηj given
the observed accept/reject decisions of all patients offered donor j.23
Therefore, our estimate V̂ (t; xi ) is obtained by numerically integrating
                                                                                     
                                     exp (−ρ (τ − t)) p̂ (τ |t; xi ) Ŵ xi , τ ; θ̂

over the range τ ∈ [t, Ti ]. Details on this procedure , including the number of points used, are
  22
      We estimate P (cij = 1|zj , xi ) using the data on instances where a kidney was accepted but the transplant
did not occur because the final crossmatch was positive.
      Formally, for each j, we need to draw from a random variable with expectation E 1 sijτ ≥ s∗j ψ (Pijτ ) .
  23
                                                                                                              

For simplicity of exposition, we have dropped the term P (cij = 1|zj , xi ) and explicit conditioning on
                   Ij denote all offers and accept/reject
(xi , zj , τ ). Let                                           decisions for kidney j. By the law of iterated ex-
pectations, E 1 sijτ ≥ s∗j ψ (Pijτ ) = E E [ ψ (Pijτ )| Ij ] 1 sijτ ≥ s∗j       because s∗j is measurable with re-
                                                                            

spect to Ij and sijt is a function of (xi , zj , τ ). Therefore, the random variable 1 sijτ ≥ s∗j ψ (Pijt ), where
                                                                                       
                                       
ψ (Pijτ ) = ψ G χ (xi , zj , τ ) θ̂ + ηj     and ηj is drawn from the conditional distribution given Ij , has the
desired expectation.
                                                                                                           27
                                                                 
provided in Appendix A.2. Substituting Ŵ xi , t; θ̂ for W (xi , t; θ0 ) is appropriate because
               √
the former is a J-consistent estimator of the latter for each (xi , t) under standard regularity
conditions assuming that the dependence of future offers on current arrivals diminishes with
the time horizon of the future offer.24


Step 4: Estimating Γ

Once V̂ (t; xi ) has been estimated, we recover Γ (·) using equation (8):
                                                                                                  
               Γ̂ (t, xi , zj , ηj ) = V̂ (t; xi ) − G−1 P̂ijt = V̂ (t; xi ) − χ (xi , zj , t) θ̂ − ηj .

This quantity can be calculated for any value of (t, xi , zj , ηj ) using the estimate θ̂.


Discussion

It is worth discussing two decisions made in service of our goal of finding mechanisms that
better target offers based on observable characteristics. First, our estimation approach is
based on CCP methods instead of a full solution/nested fixed point approach (Miller, 1984;
Wolpin, 1984; Pakes, 1986; Rust, 1987). The main advantage of a CCP approach is that
it can accomodate rich observed heterogeneity while maintaining computational tractabil-
ity. A full-solution approach would directly parametrize the object of interest Γ (·) in terms
of parameters θΓ and compute the likelihood of accepting an offer using the implied value
function. Although maximizing this likelihood yields an efficient estimator for θΓ , it is bur-
densome when the state space is large because the value function must be computed for many
values of θΓ . Indeed, our state space includes the compatibility and priority score for each pa-
tient and donor using all the variables that enter the assignment mechanism. Even after the
simplification afforded by Assumption 3, our preferred specification includes approximately
80 variables, many of which are continuous.
Second, our model abstracts away from patient-level unobserved heterogeneity. An extension
that incorporates it would introduce three complications. First, both the departure rates δi (t)
and choice probabilities would ideally depend on unobserved heterogeneity and would need
to be jointly estimated. Second, we would need to solve the initial conditions problem for
the agents already on the waitlist at the begining of the sample. Finally, estimating dynamic
models with both rich observed and unobserved heterogeneity is demanding of the data. We
believe that abstracting away from patient unobserved heterogeneity still yields useful results
  24
       Formal conditions and a proof are presented in section F.1 in the online appendix..
                                                                                                28

because our dataset contains a rich set of patient characteristics. However, this restriction
could bias our results if patients differ in ways not captured by the rich patient covariates
in our data. For this reason we explored a simple specification in which a limited form of
unobserved heterogeneity was included in the choice model only. This specification, presented
in online appendix section C, yields qualitatively similar counterfactual results.


5     Parameter Estimates

Our estimated models include a rich set of patient and donor observed characteristics. The
baseline characteristics, linear splines, and interactions were chosen by surveying the medical
literature. Specifically, we use covariate and spline specifications from KPSAM, which was
used by the kidney allocation committee to predict the outcomes of various allocation systems.
We also include any covariates that were part of the survival models for kidney transplant
patients used in Wolfe et al. (2008).


5.1   Estimated CCPs and Departure Rates

Conditional Choice Probabilities: We estimated three specifications for the conditional
choice probability of accepting an offer. The first specification includes all of these baseline
variables but not donor unobserved heterogeneity η or the state variable time t. The second
specification adds donor unobserved heterogeneity, and the third specification adds waiting
time interacted with a variety of characteristics. Table V presents select parameter estimates
(see table A.III in the online appendix for the full specification).
The estimated coefficients are intuitive and robust in the last two specifications. Including
donor unobserved heterogeneity influences the coefficients, especially those on donor charac-
teristics, as can occur in a non-linear model. In all specifications, offers from donors older than
50 years of age are less likely to be accepted than offers from 35- to 50-year-old donors. We
also estimate significant patient-level and match-specific heterogeneity in acceptance rates.
A perfect tissue type match is very likely to be accepted, much more so than a young donor.
Regional and national offers are far less likely to be accepted. Adult patients of different ages
are equally likely to accept a middle-aged donor, but older patients are more likely to accept
a donor who is over 50 years old. This pattern is consistent with the idea that it is more
important for younger patients to obtain kidneys that are likely to function for a long time.
Including donor unobserved heterogeneity and flexible waiting time controls significantly
improves model fit. Specifications with donor unobserved heterogeneity best match the level
                                                                                                                            29

           Table V: Conditional Choice Probability of Acceptance (select coefficients)

                                                     Base Specification       Unobserved Heterog.         Waiting Time + UH
                                                            (1)                       (2)                         (3)
 Calculated Panel Reactive Antibody (CPRA)            0.60        (0.05)       0.68       (0.06)           0.58       (0.09)
 Donor Age < 18                                       0.27        (0.10)       -0.09      (0.19)          -0.04       (0.20)
 Donor Age 18-35                                      0.59        (0.12)       -0.06      (0.19)           0.02       (0.19)
 Donor Age 50+                                       -0.83        (0.16)       -0.77      (0.21)          -0.87       (0.22)
 Expanded Criteria Donor (ECD)                       -0.14        (0.02)       -0.53      (0.08)          -0.53       (0.10)
 Donation from Cardiac Death (DCD)                   -0.10        (0.02)       -0.51      (0.06)          -0.50       (0.09)
 Perfect Tissue Type Match                            2.33        (0.31)       2.92       (0.43)           2.89       (0.44)
 Regional Offer                                      -1.38        (0.06)       -2.90      (0.19)          -2.92       (0.19)
 National Offer                                      -1.54        (0.04)       -3.05      (0.12)          -3.11       (0.11)
 Patient on Dialysis at Registration                 -0.02        (0.02)       -0.10      (0.02)          -0.09       (0.02)
 Log Waiting Time (years)                                                                                  0.09       (0.06)
 Log Waiting Time x 1{Over 1 Year}                                                                        -0.15       (0.07)
 Log Waiting Time x 1{Over 2 Years}                                                                       -0.13       (0.12)
 Log Waiting Time x 1{Over 3 Years}                                                                        0.30       (0.11)
 Patient Age x 1{Donor Age < 18}                     -0.01        (0.00)        0.00         (0.00)        0.00       (0.00)
 Patient Age x 1{Donor Age 18-35}                    -0.02        (0.00)        0.00         (0.01)        0.00       (0.01)
 Patient Age x 1{Donor Age 50+}                       0.02        (0.00)        0.02         (0.01)        0.02       (0.01)

 Donor Unobservable Std. Dev.                                                   1.02         (0.03)       1.04         (0.04)
 Idiosyncratic Shock Std. Dev.                       1.00                       1.00                      1.00

 Acceptance Rate                                             0.140%                     0.140%                    0.140%
 Number of Offers                                           2713043                    2713043                   2713043

Notes: Select parameter estimates for the conditional probability of accepting an offer. All variables except patient age, CPRA,
and waiting time are indicators. For each specification, we simulate 200,000 draws from the Markov chain generated by the
Gibbs’ Sampler, burn-in the first half of the chain, and keep every tenth draw. The point estimate is the sample mean and the
standard error estimate is the standard deviation of these remaining draws.



of and sharp decline in the average acceptance rate as the offer number increases (see Figure
1.a). Since undesirable organs are more likely to be offered to patients further down the list,
specifications without donor unobserved heterogeneity over-predict the number of organs that
are accepted in the early positions. Similarly, a flexible spline in waiting time best fits the
average acceptance rates by years waited (see Figure 1.b).
Finally, we assessed whether our specification is overfit by comparing the relative mean-
squared error (RMSE) in our estimation sample and the first six months of 2014. As ex-
pected, the in-sample RMSE falls but the out-of-sample RMSE increases if the model is
made richer (see table A.IV in the online appendix for details). This pattern suggests that
our specification finds a good in-sample fit without overfitting.
Departure Rates: We estimated patient departure models under different parametric as-
                                                                                                       30

                                         Figure 1: Model Fit
                    (a) By Position                                (b) By Waiting Time




sumptions on the baseline hazard. These models include all patient-specific variables included
in the CCP model.25 Table A.II in the online appendix presents these estimates. They reveal
significant and robust heterogeneity in patient departure rates. For example, departure rates
are higher for diabetic patients and for older adults. Patients with blood type A are also
more likely to depart, potentially due to better chances of receiving a living donor transplant.
Across specifications, we estimate an increasing baseline hazard of departure, consistent with
patients becoming less healthy over time. The Gompertz hazard model results in a survival
curve very similar to the Cox proportional hazards model.
For the reasons detailed above, we feel comfortable with the fit of the CCPs in the third
model and the Gompertz hazard model. All results that follow use estimates from these
specifications.


5.2    Estimated Value of Organ Offers

A common challenge when conducting welfare analysis in environments without money is
the lack of a transferable numeraire good. We therefore introduce an interpretable measure
for comparing values across agents in terms of an equivalent change in object arrival rates
(supply) and use these units to describe our estimates. Our counterfactual results on patient
welfare will also use these units.
Sequential assignment mechanisms can re-assign offers from some agents to others. Motivated
  25
    The hazard model includes CPRA as a linear term, but omits a dummy for CPRA> 0.8. Because
priority is discontinuous in CPRA at 0.8, acceptance behavior can be discontinuous at this point. However,
departures without a transplant should not be discontinuous.
                                                                                                  31

by this fact, consider the proportional increase in a patient’s expected value of a one-time
offer of object j at the time of registration:

                                 max {0, Γ (0, xi , zj , ηj ) + εij − V (0; xi , λ)} dG
                             R
                    EVij ≡                                                              ,
                                                    V (0; xi , λ)

where the dependence of V on the object arrival rate λ is re-introduced for clarity.
Instead of a one-time offer, the same change in value can be generated by an increase in the
object arrival rate λ. Specifically, define λij such that V (0; xi , λij ) − V (0; xi , λ) equals the
numerator of the expression above. We can rewrite EVij as

                                     V (0; xi , λij ) − V (0; xi , λ)   λij − λ
                          EVij =                                      ≈         ,
                                              V (0; xi , λ)                λ

where the approximation follows because V (t; xi , λ) is approximately linear in λ (see equation
4). This approximation is appropriate for small changes in λ, so that offer probabilities and
acceptance decisions do not change substantially.
Therefore, the value of a one-time offer as measured by EVij is equivalent to the value of
an alternative policy that is able to marginally increase the supply of objects. Aggregating
this measure yields a notion of social welfare in which the planner equally values the effect
of a change in donor supply on all patients. This quantity is similar in spirit to Equivalent
Variation at the time of registration. Note that by definition, EVij is invariant to the scale
of utility units across agents.
Figure 2 describes our preferred estimates in these units. The plot shows how the value of
an organ offer varies across specific patient and donor characteristics, holding all remaining
characteristics fixed.
While all patients prefer younger donors, younger patients and patients not on dialysis at
registration place a relatively higher value on younger donors. In contrast, older patients
place a high value on offers from both young and old donors. These patterns are consistent
with the differential life expectancy effects by age and health status of receiving a transplant
from a higher-quality organ. Furthermore, because older patients receive fewer offers in the
first ten positions (see table III), each additional offer represents a greater equivalent increase
in donor supply.
Tissue type similarity is also valuable. Organs with no DR tissue protein mismatch are
equivalent to a larger increase in overall donor supply than those with mismatches. The
former are less likely to induce an adverse immune response post-transplant, and therefore
increase the expected life-years afforded by the transplant.
                                                                                                                                                                          32

                                                                         Figure 2: Value of an Organ Offer

                                         6
                                             5.37
  Equiv. Increase in Donor Supply (%)


                                                                       Donor Age 18 to 34                  Donor Age 35 to 49                 Donor Age > 49
                                         5

                                         4          3.84
                                                                                                                                                     3.48
                                                                                      3.18                                      3.17
                                         3                                                                 2.80

                                                                                             2.05                                      2.07                 2.20
                                                           1.91 1.77                                              1.79
                                         2
                                                                        1.03
                                         1                                                          0.53                                      0.58                 0.57
                                                                                                                         0.45
                                                                               0.14
                                         0
                                              70-Year-Old        40-Year-Old          0 Patient-Donor 2 Patient-Donor             Patient               Patient
                                                Patient            Patient             DR Mismatch     DR Mismatch               On Dialysis,         Off Dialysis,
                                                                                                                                  Age > 50             Age > 50
Notes: Patient and donor characteristics other than those explicitly varied are set to median values from the NYRT sample.
Value functions are computed at registration.



6                                       Steady State Equilibria and Welfare Comparisons

6.1                                     Equilibrium Concept

We now define an equilibrium concept for counterfactual analysis. Our concept describes
a large pool of agents waiting for offers from an allocation mechanism that uses a scoring
rule which does not depend on an agent’s past decisions. The endogenous objects are the
equilibrium offer probabilities, the composition of agents on the waitlist, and optimal decision
rules with their associated value functions.
Agents have types x ∈ X , and objects have types z ∈ ζ, where we henceforth include the
unobserved donor characteristic η in z for notational simplicity. In what follows, we treat X
and ζ as finite sets. To simplify notation, albeit with a slight abuse, we replace subscripts
that index individuals i and objects j with their types x and z, respectively. For instance,
we write the value function as Vx (t) instead of V (t; xi ) and the scoring rule as sxz (t) instead
of s (t; xi , zj ) . The notation for other quantities such as π, Γ, and δ is adapted analogously.
Agents follow type-symmetric accept/reject strategies, σx : R × R+ → {0, 1}, indexed by
x ∈ X . The first domain element is the payoff of being assigned a particular object, Γ,
and the second element is time waited, t ∈ R+ . We exclude strategies that depend on richer
information because beliefs are restricted to satisfy Assumption 3.
                                                                                                        33

We model the queue composition using a single steady state. Specifically, the queue compo-
sition is described by a probability density function, m, defined on the set X × [0, T ], where
T is the maximum wait time. This density governs the distribution of agent types and their
wait times. We write mx (t) to denote the density evaluated at (x, t). The queue length is
denoted by N .

Definition 1. A steady state equilibrium consists of an accept/reject strategy σ ∗ , beliefs
π ∗ , a queue size N ∗ , and a probability measure m∗ such that the following conditions hold:

      1. Optimality: For each agent of type x ∈ X and an offer with net present value Γ,

                                        σx∗ (Γ, t) = 1 {Γ ≥ Vx (t; π ∗ )} ,

         where Vx (t; π ∗ ) is the net present value to type x of declining the object and following
         the strategy σx∗ after t given π ∗ .

      2. Consistent beliefs: For each (t, x, z) , the beliefs π ∗ (t; x, z) are consistent with equilib-
         rium offer probabilities. In particular, for mechanisms that use the scoring rule s,

                                    ∗
                                   πxz (t) = Hz∗ (sxz (t)) × P ( c = 1| x, z) ,

         where Hz∗ (s) is the probability that the object is available only to agents above the
         score s if N ∗ agents are drawn iid from m∗ , and they follow strategy σ ∗ .26

      3. Steady state detailed balance condition: For each x ∈ X , m∗x (t) and N ∗ satisfy

                                                                              γx
                                 ṁx (t) = −mx (t) κx (t) and mx (0) =           ,
                                                                              N∗

         where γx is the arrival rate of type x agents, κx (t) is the equilibrium departure rate of
         a type x agent at waiting time t, and m∗ is a density: x∈X 0T mx (τ ) dτ = 1.
                                                                   P     R



The first condition states that each agent makes optimal decisions at each point in time given
their beliefs. The value of declining an offer is given by the Hamilton-Jacobi-Bellman equation
defined in Section 3.2. The second condition imposes that agents have correct beliefs about
offer probabilities, which are determined by the steady state distribution of cutoff scores Hz∗
that arises when agents use strategies σ ∗ and N ∗ agents are drawn from a distribution with
  We do not restrict the queue length N ∗ to be an integer and draw the (N ∗ + 1)-st agent with probability
  26

N − bN ∗ c.
  ∗
                                                                                                   34

density m∗ . The final condition determines the distribution of waiting agents’ characteristics.
The left-hand side is the derivative of the density of type x agents who have waited t years,
and the right-hand side is the rate at which such an agent departs multiplied by the density
of the type. Departures occur for both exogenous reasons and because agents are removed
from the list once they are assigned; that is, κx (t) is the sum of δx (t) and the rate at which
an agent of type x is assigned at time t given the strategy σ ∗ and the offer probabilities π ∗ .
This equilibrium concept abstracts away from transitional dynamics in the size and compo-
sition of the queue. An alternative approach would be to assume that the queue length and
composition follow a Markov process. However, this process is high-dimensional and would
make the counterfactual exercises computationally intractable. We expect that our equilib-
rium concept will be a good approximation to the behavior of such a system. For example,
part 3 sets N ∗ to be the expected queue length. A law of large numbers can be used to show
that, in a long queue, the stationary distribution of the queue length concentrates mass on
N ∗ (see section F.2 in the online appendix).
We compute steady state equilibria using an algorithm that iterates between computing the
value function, optimal decisions, and the steady state waitlist composition. A detailed
description of the procedure is provided in section B.1 of the online appendix. To keep the
computational burden manageable, the results we present below are based on a type space
given by a random sample of 300 patients and 500 donors drawn from our dataset and a
discrete grid for time. Our results are not sensitive to varying these parameters.
We prove the existence of a steady state equilibrium for sequential assignment mechanisms
that use a priority score in Theorem 1 of online appendix section D. The challenge in showing
existence arises because the strategies, beliefs, and the queue composition are functions of
time, which is a continuous variable. We use the Brower-Schauder-Tychonoff fixed point
theorem for general Banach spaces to prove existence. The primary assumptions are technical
regularity conditions imposing bounds and Lipschitz continuity on primitive objects. The
main substantive condition is that the set of scores used in the mechanism is finite. Our
results do not rule out multiplicity of equilibria. However, we did not find multiple equilibria
for the mechanisms and the main specification described below.27
  27
    We checked for multiplicity by varying starting values, damping the updates in each iteration, and
switching the sequence in which value functions and queue composition are updated.
                                                                                                            35

6.2      Welfare Comparisons

Given a mechanism M and a donor arrival rate λ, the steady state value of assignments
to an agent of type x is:
                                                 Z T
                                    γx M
                        V̄xM   (λ) = Vx (0; λ) +     N ∗ m∗x (τ ) VxM (τ ; λ) dτ.                         (11)
                                    ρ             0


The first term represents the discounted value of all type x agents that arrive on the waitlist.
The second term represents the value of all agents on the waitlist in steady state. Their sum
equals the value of a social planner who considers the net present value of payoffs generated
by assignments to type x agents for a system in steady state.28
Let M0 be the baseline mechanism used during our sample period and λ0 be the baseline
donor arrival rate. For any mechanism M, let the equivalent donor arrival rate for type x
                                                                  0
agents, λx (M), be the solution to the equation V̄xM (λ0 ) = V̄xM (λx (M)) . As discussed in
Section 5.2, we can express a change in the value function for type x as an equivalent change
in the donor arrival rate:
                                                          0
                                  V̄ M (λ0 ) − V̄xM (λ0 )   λx (M) − λ0
                         EVx (M) = x         0
                                                          ≈             .
                                        V̄xM (λ0 )               λ0

This type-specific measure describes the welfare effects for each patient in terms of an al-
ternative policy that keeps the mechanism fixed but is able to increase (or decrease) organ
donation rates. Averaging EVx (M) across patients equally values an equivalent change in
donor arrival rates for different patient types. Our results will also report effects on key
subgroups so that the reader may consider alternative aggregates.


7        Evaluating Design Trade-Offs

The U.S. government charged the OPTN Kidney Transplantation Committee with reforming
the system used prior to 2014. The stated goals were to find mechanisms that provided
equitable outcomes for patients, efficiently allocated available organs, and minimized organ
waste. Motivated by these goals, this section begins by comparing previously used mecha-
nisms to benchmark mechanisms, before moving to optimal mechanisms and discussing the
    28
    Because this measure considers assignments in steady state, it ignores the payoffs to agents during the
transition following a change in the mechanism. Analyzing this process requires modeling agent expectations
and decisions during the transition, a task that is beyond the scope of this paper. The bias due to abstracting
away from transition dynamics is small if the adjustment to the new steady state is quick.
                                                                                                          36

sources of gains we identify. Consistent with our sample definition, the results below change
the mechanism for all donors offered to patients in NYRT.29
The qualitative results described below are robust to four variations: first, to introducing a
limited form of patient unobserved heterogeneity; second, to changing the annual discount
factor to 10 percent; third, to varying the sample and number of patient and donor types; and
fourth, to removing the limit on the number of offers that can be made (see online appendix
section C). The last exercise suggests that being able to offer organs to more patients does
not obviate the improvements we identify below.


7.1    The 2014 Reform vs Benchmark Mechanisms

This section compares the mechanisms used prior to 2014 to the re-designed mechanism and
two benchmarks from the theoretical literature.

   • Post-2014: The kidney allocation mechanism adopted in December 2014 awards
     greater priority to very high CPRA patients and prioritizes healthier patients for higher
     quality donors. Since high CPRA patients have few transplant opportunities, increas-
     ing their priority could yield more equitable outcomes. The second change offers high-
     quality kidneys to patients likely to benefit from them most.

   • First Come, First Served (FCFS): This mechanism offers objects to agents in
     the order they joined the waitlist. In addition to being transparent and procedurally
     fair, FCFS has attractive efficiency properties: Bloch and Cantala (2017) show that it
     maximizes agent welfare when values for an object are drawn i.i.d. across agents. This
     result is driven by the fact that FCFS incentivizes agents to be selective and only accept
     objects with high match-specific values. We approximate FCFS by finely discretizing
     time on a grid t0 , t1 , . . . , tL and set sxz (t) = l if t ∈ [tl−1 , tl ).

   • Last Come, First Served (LCFS): This mechanism offers objects to agents in
     reverse order of joining the waitlist. It provides strong incentives to accept an offer
     because agents are demoted if other agents arrive in the future. Lower selectivity can
     reduce discards if the number of offers that can be made is limited. Moreover, LCFS
     maximizes welfare if objects are vertically differentiated in quality and preferences are
     homogeneous because social welfare depends only on the fraction of objects allocated
  29
     Evaluating a nationwide change is burdensome due to the patchwork of variants on points used in
approximately half the states. To simplify this task, we keep the system used to prioritize patients from the
rest of the United States fixed to the pre-2014 system. We also assume that acceptance decisions by patients
from the rest of the US, which govern offers for non-local donors to patients in NYRT, remains fixed.
                                                                                                                                                            37

       (Su and Zenios, 2004). We approximate LCFS by finely discretizing time on a grid
       t0 , t1 , . . . , tL and set sxz (t) = L − l if t ∈ [tl−1 , tl ).

Our analysis shows that these theoretical and practical recommendations can either increase
welfare or reduce organ discard rates, but not both (Figure 3). Both the pre- and post-2014
mechanisms are very similar to FCFS in terms of average patient welfare and organ discard
rates. Although not reported, our results indicate that the 2014 reforms primarily resulted
in redistribution towards younger and more highly sensitized patients. Unlike these three
mechanisms, LCFS substantially reduces organ discard rates at the cost of lower welfare.30

                              Figure 3: Welfare and Organ Utilization under Alternative Mechanisms



                                                          33%                                          Optimal Assignment
            Equiv. Increase in Donor Arrival Rate




                                                          22%                        Optimal Offer Rates
                                                                                     Approximately Optimal Priorities
                                                          11%               Approx. Opt. Pareto Improving Priorities
                                                                      Greedy Priorities
                                                                      Pre-2014 Priorities
                                                           0%
                                                    -5%          0%         5%              10%        15%             20%           25%              30%
                                                          -11%           Post-2014 Priorities

                                                          -22%


                                                          -33%          First Come First Served


                                                          -44%
                                                                                                                             Last Come First Served

                                                          -55%
                                                                                   Reduction in Fraction Discarded



Notes: Results are reported relative to pre-2014 priorities and based on each mechanism’s steady state equilibrium. The
reduction in fraction discarded is defined as the change in the number of kidneys rejected by all NYRT patients to whom the
organ was offered.



The welfare effects of these mechanisms are consistent with predicted effects on the waitlist
and the types of donors transplanted. Table VI, Panel A shows that waiting times, queue
lengths, and the quality of the average transplanted donor are similar across the first three
  30
    This measure ignores transplantation’s potential effects on healthcare costs that are not internalized by
patients and doctors. A social planner who places weight on these costs may further favor mechanisms that
reduce discards.
                                                                                                                                         38

mechanisms. In contrast, LCFS dramatically decreases discard rates and shortens the steady
state queue length from 5,113 to 2,961. Lower discard rates come at a significant welfare cost
because patients accept organs that are poorly matched to them and of low quality (i.e. from
donors who are older and less likely to have died from head trauma). Indeed, decomposing
the overall welfare changes into the portion predictable using our observable characteristics
and the match-specific unobservable characteristics in our model shows that the primary
differences are driven by observables.31

                                    Table VI: Outcomes in Various Mechanisms
                                                            Waitlist                   Transplanted Donors              EVx Decomp.
                                                                                                                                       ΔVx(0)
                                         EVx     Queue    Reduction in Years on               Head     Hyper-
                                                                                     Age                            Obs.      Unobs.    > -5%
                                                 Length   Discard Rate Waitlist              Trauma    tensive
                                         (1)      (2)         (3)         (4)         (5)       (6)      (7)            (8)     (9)     (10)

                                                             Panel A: Steady State Equilibrium, Benchmark Mechanisms
Pre-2014 Priorities                       --     5113.2        --        2.73        44.9     16.3%    47.1%            --      --       --
Post-2014 Priorities                    -0.8%    5042.5      0.5%        2.70        44.8     16.1%    47.1%        0.3%       -1.1%   97.0%
First Come First Served                 1.5%     5274.4      -2.1%       2.78        44.9     16.5%    47.2%        0.2%       1.3%    91.0%
Last Come First Served                 -50.6%    2961.4     24.8%        3.73        47.3     14.8%    51.6%       -43.7%      -6.8%    6.3%
                                                               Panel B: Steady State Equilibrium, Alternative Systems
Optimal Offer Rates                    21.4%     4576.2      7.2%        2.55        45.5     15.7%    48.4%       21.6%       -0.3%   68.0%
Approximately Optimal Priorities       18.2%     4555.0      7.2%        2.56        45.5     15.7%    48.4%       20.7%       -2.5%   67.3%
Approx. Opt. Pareto Improving Priorities 12.2%   4738.8      4.0%        2.62        45.3     15.9%    47.7%       16.2%       -4.0%   98.0%
Greedy Priorities                       3.8%     5079.9      0.2%        2.78        44.7     16.3%    47.0%        8.9%       -5.1%   79.7%
Optimal Assignment                     34.3%     3990.5     13.6%        2.38        45.5     15.6%    48.3%            --      --     94.0%
                                                              Panel C: Predictions Assuming no Equilibrium Response
Pre-2014 Priorities                       --     5791.2        --        3.39        43.8     17.2%    44.6%            --      --       --
Post-2014 Priorities                      --     5753.6      0.0%        3.37        43.8     17.2%    44.7%            --      --       --
First Come First Served                   --     5853.7      -0.1%       3.33        43.7     17.3%    44.5%            --      --       --
Last Come First Served                    --     5668.6      2.7%        5.99        44.1     16.6%    45.3%            --      --       --
Greedy Priorities                         --     5718.5      1.0%        3.55        43.9     17.0%    44.9%            --      --       --



Notes: In Panels A and B, Columns (1), (3), and (8)--(10) are reported relative to the steady state equilibrium under Pre-
2014 Priorities. In Panel C, Reduction in Discard Rate is reported relative to outcomes under Pre-2014 Priorities assuming no
equilibrium response. EVx is defined as EVx (M) in the main text. Column (10) reports the fraction of patient types whose
continuation values at registration fall by less than 5 percent relative to Pre-2014 priorities.


These empirical results are driven by the externality imposed by an agent’s decision to reject
an offer. When agents decline an object, they allow others to receive an assignment earlier,
generating a positive externality. However, by refusing an object and remaining on the list,
they also generate a negative externality as they take away future offers. Which externality
  31
    The observable component includes the portion of welfare effects due to changes in total number of
transplants, quality of the average transplanted organ, and the observable component of match-specific value.
The unobservable part includes the change due to the term εijt .
                                                                                                        39

dominates depends on preferences and the mechanism. When preferences are highly hetero-
geneous, the positive externality from being more selective dominates because agents accept
only high-value offers while allowing other agents to receive an average-value offer sooner.
Therefore, FCFS performs better than LCFS (Bloch and Cantala, 2017). This comparison is
reversed when all agents value each object identically because selective agents pass on only
lower-quality objects. Our empirical results indicate that horizontal preference heterogene-
ity is sufficiently strong that the positive externality from rejecting an offer outweighs the
negative externality due to possible organ waste.
It is worth noting two details. First, our computed steady state queue length for the pre-2014
mechanism is 5,113, which is a little longer than the queue length of 4,508 on January 1, 2013
(Table I, panel A). This similarity is remarkable because this moment is not targeted by the
CCP approach but nevertheless matches equilibrium computations from our model. It also
suggests our sample is close to a steady state.32 Second, while our baseline results change
the priority rules for NYRT patients for all donors, we also computed a version in which
the change only affected donors recovered in NYRT. The quantitative magnitudes under this
alternative are attenuated but directionally similar, with the largest changes for LCFS.


7.2    Optimal Mechanisms

This section designs mechanisms that aim to improve welfare subject to varying constraints.
We first consider mechanisms that can choose whom to offer a kidney based on the char-
acteristics observed in our data. However, the mechanism cannot dictate assignments or
condition offers on past actions. Then, in the spirit of searching for a Pareto improvement,
we constrain the mechanism to not make any type of patient significantly worse off than they
were under the pre-2014 mechanism.
                                                                                              P   V̄xπ (λ0 )
   • Optimal Offer Rates: We solve for offer rates πxz (t) that maximize                      x V̄ M0 (λ ) ,
                                                                                                  x        0

       where, with a slight abuse of notation, V̄xπ (λ0 ) is the equilibrium steady state value for
       type x under offer rates π. The offer rates are subject to feasibility constraints: the
       steady state assignment rates implied by offer and acceptance rates must not exceed
       object arrival rates. For each donor type z,

                        XZ       T
                                     N mx (t) πxz (t) P (Γxzt + ε > Vx (t) |x, z) dt ≤ qz .
                         x   0

  32
    A slightly longer steady state queue should be expected as the NYRT kidney waiting list was growing
during our sample period. However, panel B in Table I shows that the growth rate was declining.
                                                                                            40

     The left-hand side is the expected number of objects assigned, and the right-hand side
     is the number of objects available, where we have ignored the limit on the number of
     offers that can be made. Our calculations incorporate this limit (see online appendix
     section B.2). Because this constraint is placed only on expected quantities, the offer
     rates may not be implementable. The solution provides an upper bound on welfare
     under any offer mechanism that does not condition on past behavior.

  • Approximately Optimal Priorities: We can use the solution to the problem above
    to implement similar equilibrium offer rates with a scoring rule. Specifically, we set
    sxz (t) to the values of πxz (t) that solve the problem above. The Kidney Transplantation
    Committee exclusively focused on mechanisms that use priority rules because they are
    transparent and simple to describe. We compute an equilibrium for these priorities
    using the algorithm outlined in online appendix section B.1.

  • Approximately Optimal Pareto Improving Priorites: We design a priority sys-
    tem that aims to increase average patient welfare without significantly hurting any
    patient type. We first solve for optimal offer rates as before but add a constraint that
    no agent type is worse off than under pre-2014 priorities at registration. We then solve
    for the equilibrium allocation setting sxz (t) equal to the solutions πxz (t) to this mod-
    ified problem. While this mechanism may not yield a strict Pareto improvement, we
    expect fewer agents will be significantly worse off under these priorities.

We find that previously used mechanisms and both FCFS and LCFS are far from optimal;
priorities designed using estimated preferences as inputs can substantially increase welfare
while also reducing discard rates. Patient welfare under the approximately optimal priorities
mechanism increases by 18.2 percent, and the discard rate falls by 7.2 percent (Table VI).
Because patients are transplanted at higher rates, they spend less time waiting, and the queue
length falls below 4,600. This mechanism achieves most of the gains possible under any offer
mechanism: optimal offer rates performs only marginally better, increasing patient welfare
by 21.4 percent. While average gains are large, one drawback of approximately optimal
priorities is that it makes some patients significantly worse off: nearly one-third of patient
types are more than 5 percent worse off at registration than they were under the pre-2014
mechanism.
A significant fraction of these gains can be achieved while respecting stringent distributional
constraints. The approximately optimal Pareto-improving priorities mechanism increases
welfare by 12.2 percent and reduces discards by 4.0 percent. Recall that because this mecha-
nism approximates the optimal Pareto improving offer rates with a scoring rule, the constraint
                                                                                             41

that no type should be worse off may not be exactly satisfied. Fortunately, 98 percent of
patients are no more than 5 percent worse off at registration under our approximation than
they were under pre-2014 priorities.
The mechanisms studied above are finely-tuned functions of patient and donor character-
istics, which may reduce transparency and robustness to changes in the environment. To
assess whether our results depend on very detailed priority scores, we coarsened the prior-
ities into 20 and 50 equally sized bins. This change affected welfare and discard rates by
less than five and one percentage points respectively. While the coarsened priorities also
depend on all characteristics in the model, this result points to the promise of finding less
finely-tuned mechanisms that can produce large gains. An analysis that formalizes criteria
such as transparency and simplicity and incorporates them into the design problem is left for
future research.
Finally, the baseline and our alternative mechanisms open the possibility that agents may
try to game the system by manipulating some characteristics. Addressing this issue requires
analyzing the potential for manipulation and the availability of substitute observables. While
this topic is beyond the scope of this paper, we note that all patient and donor characteristics
we use to determine priority were used in either the pre-2014 mechanism, the post-2014
mechanism, or in a proposal considered by the Kidney Transplantation Committee.


7.3     Incentives, Potential Improvements, and Sources of Gains

7.3.1    Importance of Incentives

We now show two ways in which explicitly considering incentives in a waitlist offer mechanism
is quantitatively important for finding the improvements described above. First, a naive
mechanism that offers organs in order of predicted transplant value yields much smaller
improvements. Consider the following mechanism:

  • Greedy Priorities: Patients are prioritized in order of predicted transplant value,
    measured in donor supply units. Specifically, sxz (t) is set equal to EVxz (t). The UK
    deceased donor kidney allocation system now heavily prioritizes predicted transplant
    benefits (Watson et al., 2020).

This mechanism only marginally improves patient welfare and discard rates relative to the
pre-2014 mechanism (Figure 3). The contrast with approximately optimal priorities empha-
sizes the value of explicitly considering behavioral responses: incorporating rich preference
heterogeneity alone is not sufficient.
                                                                                            42

Second, empirical approaches that ignore incentives mute the differences in predicted equilib-
rium allocations across mechanisms. Panel C in Table VI shows that predicted discard rates,
queue lengths, and donor characteristics are similar across the priority mechanisms considered
above when acceptance probabilities do not adjust to the new equilibrium. This finding sug-
gests that the KPSAM module (see SRTR, 2015) used to advise the Kidney Transplantation
Committee on allocation reform should be modified to incorporate incentives.


7.3.2    Comparison with Maximum Possible Gains

While the mechanisms described above improve both welfare and organ discards, it is unclear
whether they achieve most of the possible gains. In particular, we have only considered
indirect mechanisms that do not condition offers on past decisions. To analyze the potential
scope for further improvements, we calculate an upper bound on possible gains if organs can
be assigned by fiat under full information about preferences and rational expectations (but
no foresight) about object arrival and agent departure processes:

  • Optimal Assignments: We maximize steady state average welfare by choosing an
    assignment rule a (ε; x, z, t) ∈ {0, 1} that depends on the agent and object types,
    time waited, and the preference shocks ε for all agents currently waiting. A feasibility
    constraint ensures that the assignment rate does not exceed the object arrival rate for
    any type z:             Z
                            X        T
                                         N mx (t) P (c = 1, a = 1|x, z, t) dt ≤ qz .
                             x   0

        The term P (c = 1, a = 1|x, z, t) is the probability that a type z object is compatible
        with and assigned to a randomly chosen type x agent who has waited for time t. In
        addition, we require that the waitlist be in steady state (Definition 1, part 3). A
        detailed description is provided in section B.2.1 of the online appendix.

The solution to this problem suggests that approximately optimal priorities achieves over half
of the possible gains from redesigning the organ allocation system. Optimal assignments yield
welfare that is higher than the pre-2014 outcome by an equivalent of a 34.3 percent increase
in donor supply (Table VI). At the same time, discard rates for patients in NYRT would
decrease by 13.6 percent. However, not all patients are better off even in this benchmark case.
Moreover, the optimal assignments benchmark may be far from achievable by a mechanism
because it assumes full information and the ability to dictate assignments.
                                                                                                                                              43

7.3.3      Sources of Welfare Gains

The gains under approximately optimal priorities arise from offering organs to patients with
high match-specific values for those organs. These patients are also more likely to accept
the offers, reducing discard rates if the limit on the number of possible offers binds and
increasing welfare if match quality is not sacrificed. We illustrate this intuition by describing
assignments by patient age and dialysis status at the time of registration. As we discussed
in section 5, off-dialysis patients not only value each offer more but also are more likely to
accept an offer. Similarly, older patients receive a higher value from each offer.

                                             Table VII: Sources of Welfare Gains

                                               Welfare Change         EVx Decomp.         Transplants by Donor Type        Young NYRT Offer

                                               ΔVx(0)    EVx                               Young      Old      Non-           Prob.   Years
                                                                      Obs.    Unobs.
                                                                                           NYRT      NYRT      NYRT            (%)    Waited

                                                                Panel A: Patients not on Dialysis at Registration, Age 0-49
  Pre-2014 Priorities (Baseline)                 --        --          --        --         28.4      28.2      53.1           4.7     1.61
  Greedy Priorities                            -0.7%    -1.2%        0.4%      -1.6%        13.1      30.3      62.4           2.6     6.50
  Approximately Optimal Priorities             9.8%      4.0%        1.5%      2.5%         12.1      30.0      78.6           4.9     3.50
  Approx. Opt. Pareto Improving Priorities     4.6%      2.3%        2.2%      0.1%         15.8      36.8      63.5           3.6     2.66
                                                                Panel B: Patients not on Dialysis at Registration, Age 50+
  Pre-2014 Priorities (Baseline)                 --        --          --        --         6.7       38.6      66.5           1.1     7.26
  Greedy Priorities                            19.9%    17.7%        38.0%    -20.3%        22.5      42.5      51.1           2.5     6.64
  Approximately Optimal Priorities            105.9%    72.7%        89.2%    -16.5%        33.9      75.8      86.3           4.9     2.63
  Approx. Opt. Pareto Improving Priorities     69.1%    49.9%        68.0%    -18.1%        23.7      54.5      75.6           4.3     2.85
                                                                 Panel C: Patients on Dialysis at Registration, Age 0-49
  Pre-2014 Priorities (Baseline)                 --        --          --        --         18.2      51.4      94.7           1.7     6.84
  Greedy Priorities                            -1.9%    -2.6%        -3.7%     1.1%         13.2      45.2     104.7           1.6     6.50
  Approximately Optimal Priorities             -5.9%    -7.1%       -10.4%     3.3%         4.0       33.2     126.0           0.5     6.49
  Approx. Opt. Pareto Improving Priorities     -0.5%    -2.5%        -3.5%     1.0%         14.8      41.6     113.3           1.5     6.63
                                                                  Panel D: Patients on Dialysis at Registration, Age 50+
  Pre-2014 Priorities (Baseline)                 --        --          --        --         13.4      84.0     148.9           1.1     6.88
  Greedy Priorities                            2.1%      1.5%        2.5%      -1.0%        17.6      82.0     152.2           1.7     6.69
  Approximately Optimal Priorities             14.9%     7.4%        7.2%      0.2%         13.8      78.7     195.0           1.9     3.59
  Approx. Opt. Pareto Improving Priorities     7.3%      3.0%        3.5%      -0.5%        12.0      79.6     177.2           0.9     4.43

  Notes: Transplants by Donor Type is an annual rate. Prob. (%) is the probability that a patient receives an offer from a donor in the
  relevant
Notes:     group conditional
        Transplants          on theType
                      by Donor      donorisbeing offered rate.
                                            an annual    to some patients.
                                                               Prob.   (%)Years
                                                                           is theWaited  is the mean
                                                                                    probability   thatyears a patient
                                                                                                        a patient      waited an
                                                                                                                    receives  across
                                                                                                                                 offeroffers
                                                                                                                                        from a
  from that donor group. An Old NYRT Donor is over age 35, an Expanded Criteria Donor, or had a cardiac death.
young NYRT donor if the donor is offered to any NYRT patients. Years Waited is the mean years a patient waited across offers
received from young NYRT donors. An Old NYRT Donor is over age 35, an Expanded Criteria Donor, or had a cardiac death.


Approximately optimal priorities increases transplant rates for older patients and reallocates
desirable donors from patients on dialysis to patients off dialysis at registration (Table VII).
For example, transplants from young NYRT donors to older off-dialysis patients rise more
than four-fold compared to the baseline mechanism (Panel B). Meanwhile, older on-dialysis
                                                                                             44

patients (Panel C) receive fewer kidneys each year from young healthy donors. The distri-
butional constraints on the approximately optimal Pareto improving priorities result in less
stark but similar patterns.


8   Conclusion

Empirical approaches to evaluating dynamic assignment mechanisms are particularly impor-
tant because theory has not yet provided clear guidance on their optimal design. This paper
provides a new equilibrium empirical framework for analyzing dynamic assignment systems
that explicitly incorporates dynamic incentives and applies that framework to deceased donor
kidney allocation. Organ allocation system reforms have been assisted by simulation models
that do not allow accept/reject decisions to depend on agents’ incentives.
We find that deceased donor kidney allocation mechanisms can be significantly improved.
Previously used mechanisms and theoretical benchmarks can only reduce organ discards at
the cost of substantially lowering patient welfare. In contrast, using estimated transplant
values, we design mechanisms that both reduce discards and increase patient welfare. More-
over, these goals can be achieved while avoiding significant harm to any type of patient.
Considering incentives is essential for designing systems that realize these large gains and for
accurately predicting outcomes under alternative mechanisms. These findings also point to
empirical work’s potential to improve dynamic assignment mechanisms in other contexts.
We make several simplifying assumptions that motivate future research. First, we assume
that agent beliefs condition on a limited set of variables and we analyze steady state equilib-
ria. Second, we do not allow for patient-level unobserved heterogeneity. Third, we assume
that patient and object arrival rates are exogenous, an assumption that may be particularly
important to relax in other applications. Finally, while we primarily focus on organ waste and
patient welfare as outcomes, clinical outcomes such as life-years gained from transplantation
and graft failure rates are likely important to policy makers.



References
Abdulkadiroglu, Atila, Nikhil Agarwal, and Parag A. Pathak, “The Welfare Ef-
 fects of Coordinated School Assignment: Evidence from the NYC High School Match,”
 American Economic Review, 2017, 107 (12), 3635–89.
Agarwal, Nikhil and Paulo Somaini, “Revealed Preference Analysis of School Choice
 Models,” Annual Review of Economics, 2020, 12, 471–501.
                                                                                      45

  , Itai Ashlagi, Eduardo Azevedo, Clayton Featherstone, and Omer Karaduman,
  “Market Failure in Kidney Exchange,” American Economic Review, 2019, 109 (11), 4026–
  70.

  , , Paulo Somaini, and Daniel Waldinger, “Dynamic Incentives in Waitlist Mech-
  anisms,” American Economic Association: Papers and Proceedings, 2018, 108, 341–47.

Aguirregabiria, Victor and Junichi Suzuki, “Identification and counterfactuals in dy-
 namic models of market entry and exit,” Quantitative Marketing and Economics, sep 2014,
 12 (3), 267–304.

Arcidiacono, Peter and Paul B. Ellickson, “Practical Methods for Estimation of Dy-
 namic Discrete Choice Models,” Annual Review of Economics, 2011, 3 (363-394).

  and Robert A. Miller, “Conditional Choice Probability Estimation of Dynamic Discrete
  Choice Models With Unobserved Heterogeneity,” Econometrica, 2011, 79 (6), 1823–1867.

  , Patrick Bayer, Jason R. Blevins, and Paul B. Ellickson, “Estimation of Dynamic
  Discrete Choice Models in Continuous Time with an Application to Retail Competition,”
  The Review of Economic Studies, jul 2016, 83 (3), 889–931.

Bloch, Francis and David Cantala, “Dynamic Assignment of Objects to Queuing
  Agents,” American Economic Journal: Microeconomics, feb 2017, 9 (1), 88–122.

Danovitch, Gabriel M, Handbook of kidney transplantation, Lippincott Williams &
 Wilkins, 2009.

Fershtman, Chaim and Ariel Pakes, “Dynamic Games With Asymmetric Information:
  A Framework for Empirical Work,” Quarterly Journal of Economics, 2012, pp. 1611–1661.

Gelman, Andrew, John B Carlin, Hal S Stern, and Donald B Rubin, Bayesian data
 analysis, third ed., Chapman & Hall/CRC Boca Raton, FL, USA, 2014.

Hart, A., J. M. Smith, M. A. Skeans, S. K. Gustafson, D. E. Stewart, W. S.
 Cherikh, J. L. Wainright, A. Kucheryavaya, M. Woodbury, J. J. Snyder, B. L.
 Kasiske, and A. K. Israni, “OPTN/SRTR 2015 Annual Data Report: Kidney,” Amer-
 ican Journal of Transplantation, jan 2017, 17 (S1), 21–116.

Held, Philip J, F McCormick, A Ojo, and John P Roberts, “A cost-benefit analysis of
 government compensation of kidney donors,” American Journal of Transplantation, 2016,
 16 (3), 877–885.

Hopenhayn, Hugo A., “Entry, Exit, and firm Dynamics in Long Run Equilibrium,” Econo-
 metrica, sep 1992, 60 (5), 1127.

Hotz, V J and R A Miller, “Conditional choice probabilities and the estimation of dynamic
 models,” The Review of Economic Studies, 1993, 60 (3), 497–529.
                                                                                         46

Hu, Yingyao and Susanne M. Schennach, “Instrumental Variable Treatment of Non-
 classical Measurement Error Models,” Econometrica, 2008, 76 (1), 195–216.

Irwin, F D, A F Bonagura, S W Crawford, and M Foote, “Kidney paired donation:
  a payer perspective,” American Journal of Transplantation, 2012, 12 (6), 1388–1391.

Israni, A. K., N. Salkowski, S. Gustafson, J. J. Snyder, J. J. Friedewald,
  R. N. Formica, X. Wang, E. Shteyn, W. Cherikh, D. Stewart, C. J. Samana,
  A. Chung, A. Hart, and B. L. Kasiske, “New National Allocation Policy for Deceased
  Donor Kidneys in the United States and Possible Effect on Patient Outcomes,” Journal of
  the American Society of Nephrology, aug 2014, 25 (8), 1842–1848.

Kalouptsidi, Myrto, Paul T Scott, and Eduardo Souza-Rodrigues, “Identification
 of Counterfactuals in Dynamic Discrete Choice Models,” Quantitative Economics, forth-
 coming, 2020, (21527).

Krusell, Per and Anthony A Jr. Smith, “Income and Wealth Heterogeneity in the
 Macroeconomy,” Journal of Political Economy, 1998, 106 (5), 867–896.

Leshno, Jacob, “Dynamic Matching in Overloaded Waiting Lists,” 2017.

Liu, Tracy Xiao, Chenyu Yang, and Zhixi Wan, “The Efficiency of A Dynamic Decen-
  tralized Two-sided Matching Market,” 2019.

Magnac, Thierry and David Thesmar, “Identifying Dynamic Discrete Decision Pro-
 cesses,” Econometrica, mar 2002, 70 (2), 801–816.

McCulloch, Robert and Peter E Rossi, “An exact likelihood analysis of the multinomial
 probit model,” Journal of Econometrics, 1994, 64 (1-2), 207–240.

Miller, Robert A., “Job Matching and Occupational Choice,” 1984.

of Transplant Recipients SRTR, Scientific Registry, “Kidney-Pancreas Simulated Al-
  location Model,” Technical Report 2015.

OPTN, Organ Procurement Transplantation Network, “Concepts for Kidney Allo-
 cation,” Technical Report 2011.

  , “Organ Procurement and Transplantation Network Policies,” Technical Report 2014.

Pakes, Ariel, “Patents as Options: Some Estimates of the Value of Holding European
 Patent Stocks,” Econometrica, jul 1986, 54 (4), 755.

Rao, Prakasa B. L. S., Identifiability in Stochastic Models: Characterization of Probability
 Distributions, New Delhi, India: Academic Press, Inc., 1992.

Reeling, Carlson J and Valentin Verdier, “Welfare effects of dynamic matching: An
 empirical analysis,” 2020.
                                                                                            47

Roth, Alvin E., Tayfun Sonmez, and M. Utku Ünver, “Kidney Exchange,” The
 Quarterly Journal of Economics, 2004, 119 (2), 457 – 488.

Roth, Alvin E, Tayfun Sönmez, and M. Utku Ünver, “Efficient Kidney Exchange:
 Coincidence of Wants in Markets with Compatibility-Based Preferences,” American Eco-
 nomic Review, jun 2007, 97 (3), 828–851.

Rust, J, “Optimal Replacement of GMC Bus Engines: An Empirical Model of Harold
 Zurcher,” Econometrica, 1987, 55 (5), 999–1033.

Su, Xuanming and Stefanos Zenios, “Patient Choice in Kidney Allocation: The Role of
  the Queueing Discipline,” Manufacturing & Service Operations Management, oct 2004, 6
  (4), 280–301.

USRDS, United States Renal Data System, 2018 USRDS annual data report: Epi-
 demiology of kidney disease in the United States, National Institutes of Health, National
 Institute of Diabetes and Digestive and Kidney Diseases, Bethesda, MD, 2018.

van der Vaart, A. W., Asymptotic Statistics, Cambridge University Press, 2000.

Waldinger, Daniel, “Targeting In-Kind Transfers Through Market Design: A Revealed
 Preference Analysis of Public Housing Allocation,” 2020.

Watson, Christopher J E, Rachel J Johnson, and Lisa Mumford, “Overview of the
 Evolution of the UK Kidney Allocation Schemes,” Current Transplantation Reports, 2020,
 7, 140–144.

Weintraub, Gabriel, C. Lanier Benkard, and Ben van Roy, “Markov Perfect Industry
 Dynamics With Many Firms,” Econometrica, 2008, 76 (6), 1375–1411.

Wolfe, R. A., K. P. McCullough, D. E. Schaubel, J. D. Kalbfleisch, S. Murray,
 M. D. Stegall, and A. B. Leichtman, “Calculating Life Years from Transplant (LYFT):
 Methods for Kidney and Kidney-Pancreas Candidates,” American Journal of Transplan-
 tation, apr 2008, 8 (4p2), 997–1011.

Wolfe, R.A., V.B. Ashby, E.L. Milford, A.O. Ojo, R.E. Ettenger, and Others,
 “Comparison of mortality in all patients on dialysis, patients on dialysis awaiting transplan-
 tation, and recipients of a first cadaveric transplant.,” New England Journal of Medicine,
 1999, 341 (23), 1725–1730.

Wolpin, Kenneth I., “An Estimable Dynamic Stochastic Model of Fertility and Child
 Mortality,” 1984.

Zenios, S A, Models for Kidney Allocation, operations ed., Vol. 70, International Series in
  Operations Research & Management Science, 2004.

Zhang, J, “The sound of silence: Observational learning in the US kidney market,” Mar-
 keting Science, 2010, 29 (2), 315–335.
                                                                                                                   48

                                                           Appendix


A      Estimation

A.1     Proof of Proposition 1

Substituting Vi (t) = Ṽi (t) + Oi (t) and Γij (t) = Γ̃ij (t) + Oi (t) into equation (2):
                                        
      (ρ + δi (t)) Ṽi (t) + Oi (t)
                                         Z             Z
                                                           max {0, Γij (t) − Vi (t)} dGdF + Ṽ˙ i (t) + Ȯi (t)
                                                                                                              
      = di (t) + δi (t) Di (t) + λ           πij (t)
                                     Z             Z
                                                       max 0, Γ̃ij (t) − Ṽi (t) dGdF + Ṽ˙ i (t) ,
                                                             n                   o
      = (ρ + δi (t)) Oi (t) + λ          πij (t)

where the second equality follows from the differential equation that defines Oi (t) and Γij (t)−
Vi (t) = Γ̃ij (t) − Ṽi (t). Since the first term on the right-hand side cancels with the terms
that include Oi (t) on the left-hand side, Ṽi (t) satisfies the necessary differential equation.
The boundary condition Vi (Ti ) = Oi (Ti ) is equivalent to the condition that Ṽi (Ti ) = 0.
Next, we show that Vi (t; π) − Vi (t; π 0 ) = Ṽi (t; π) − Ṽi (t; π 0 ). Equation (2) implies that
                               Z             Z
                      0
Vi (t; π) − Vi (t; π ) = λ         πij (t)       max {0, Γij (t) − Vi (t; π)} dGdF
                               Z             Z                                                                    
                          −λ       πij (t)       max {0, Γij (t) − Vi (t; π 0 )} dGdF + V̇i (t; π) − V̇i (t; π 0 ) .

                          = Ṽi (t; π) − Ṽi (t; π 0 ) ,

where the second equality follows from the differential equation satisfied by Ṽi (·) and because
Ṽi (·) − Γ̃ij (·) = Vi (·) − Γij (·) .


A.2     Details on the Estimator

Gibbs’ Sampler

Define yijt = V (xi , t) − Γ(xi , zj , t) − ηj − ijt = χ(xi , zj , t)θ − ηj − ijt and aijt = 1{yijt < 0}.
The sampler is initialized at any value θ0 , ση0 and guesses for ηj0 and yijt         0
                                                                                         corresponding to
                                   0
observed decisions such that yijt       ≥ 0 if and only if agent i rejected object j in period t. The
                                                                                                                          49

sampler then iterates through the sequence

                                                             s+1 s s
                                                            yijt |θ , ηj ; aijt
                                                            ηjs+1 |yjs+1 , θs , σηs
                                                            θs+1 |y s+1 , η s+1
                                                            σηs+1 |η s+1 ,                                           (12)

where conditioning on the priors and the observables is implicit, y s and η s are vectors with
components yijts
                 and ηjs , and yjs+1 is a vector that stacks yijt
                                                              s+1
                                                                  across all i,t. The first two steps
involve data augmentation to simplify sampling the model parameters. The prior distribution
                                                                              
on ση is an inverse-Gamma distribution, and the prior for θ is N θ̄, Σθ . With these priors,
the first step samples from a truncated normal, the second and third steps sample from a
normal distribution, and the final step samples from an inverse-Gamma.


Computing the Value Function

Given t, for each patient i, the value of continuing is given by equation (7). Using equation
(10), the sample analog of the value of continuing is
                                             Z   Ti                                             
                              V̂ i (t) = λ            exp (−ρ (τ − t)) p (τ |t; xi ) Ŵ xi , τ ; θ̂ dτ.
                                             t


We numerically approximate this integral. First, we re-write V̂ i (t) as follows:

                     Ti                                              J
                 Z
                                                                  1X                 n                      o      
  V̂ i (t) = λ            exp (−ρ (τ − t)) p (τ |t; xi )                1 {cij = 1} 1 s (τ ; xi , zj ) > s∗j ψ P̂ijτ dτ
                 t                                                J j=1
                J
             1X                Z Ti                                 n                      o      
          =λ       1 {cij = 1}      exp (−ρ (τ − t)) p (τ |t; xi ) 1 s (τ ; xi , zj ) > s∗j ψ P̂ijτ dτ
             J j=1              t

                J
             1X                Z Ti                                        
          =λ       1 {cij = 1}        exp (−ρ (τ − t)) p (τ |t; xi ) ψ P̂ijτ dτ,
             J j=1              τ ijt

                          n                                   o
where τ ijt = inf τ > t : s (τ ; xi , zj ) > s∗j , with τ ijt = Ti if s (τ ; xi , zj ) < s∗j for all τ ≤ Ti .
For each i and j, we approximate the integral above using B = 40 equally spaced points
          b                                                                                   
qb =                                                              b
                  for b = 1, . . . , B on the unit interval. Let τijt = F −1 qb ; ρ, τ ijt , Ti , where
     B+1 
F ·; ρ, τ ijt , Ti is the cumulative distribution function of an exponential random variable
with parameter ρ that is truncated between τ ijt and Ti . We approximate the value function
                                                                                         50

as
                                   J                 B
                              λ1X                 1 X    
                                                           b
                                                                               
                  V̂i (t) =           1 {cij = 1}       p τijt |t; xi ψ P̂ijτijt
                                                                             b     .
                              ρ J j=1             B b=1
This procedure ensures that there are B points of evaluation for each possible donor and
patient-time pair. The numerical performance is superior to an alternative that approximates
the integral in equation (7) as a sum over a fixed set of draws because some patient, donor,
                                                                  h       i
time combinations may have a very small window of availability, τ ijt , Ti .
