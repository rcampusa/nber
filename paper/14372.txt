                                NBER WORKING PAPER SERIES




             COUNTRY PORTFOLIOS IN OPEN ECONOMY MACRO MODELS

                                        Michael B. Devereux
                                         Alan Sutherland

                                        Working Paper 14372
                                http://www.nber.org/papers/w14372


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     October 2008




We are grateful to Philip Lane, Klaus Adam, Pierpaolo Benigno, Gianluca Benigno, Martin Bodenstein,
Charles Engel, Berthold Herrendorf, Andrea Civelli, Fabrizio Perri, Robert Kollmann, Giancarlo Corsetti,
Morten Ravn, Makoto Saito, Alessandro Rebucci, Martin Evans and Viktoria Hnatkovska for comments
on an earlier draft of this paper. This research is supported by the ESRC World Economy and Finance
Programme, award number 156-25-0027. Devereux also thanks SSHRC, the Bank of Canada, and
the Royal Bank of Canada for financial support. The views in this paper are those of the authors alone,
and do not represent those of the Bank of Canada or those of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2008 by Michael B. Devereux and Alan Sutherland. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
Country Portfolios in Open Economy Macro Models
Michael B. Devereux and Alan Sutherland
NBER Working Paper No. 14372
October 2008
JEL No. F3,F41

                                             ABSTRACT

This paper develops a simple approximation method for computing equilibrium portfolios in dynamic
general equilibrium open economy macro models. The method is widely applicable, simple to implement,
and gives analytical solutions for equilibrium portfolio positions in any combination or types of asset.
It can be used in models with any number of assets, whether markets are complete or incomplete,
and can be applied to stochastic dynamic general equilibrium models of any dimension, so long as
the model is amenable to a solution using standard approximation methods. We first illustrate the approach
using a simple two-asset endowment economy model, and then show how the results extend to the
case of any number of assets and general economic structure.


Michael B. Devereux
Department of Economics
University of British Columbia
997-1873 East Mall
Vancouver, B.C.
CANADA V6T 1Z1
and NBER
mbdevereux@gmail.com

Alan Sutherland
Department of Economics
University of St. Andrews
St. Andrews, Fife KY16 9AL
UK
ajs10@st-and.ac.uk
1         Introduction
This paper develops a simple and tractable approach to computing equilibrium financial
asset portfolios in open economy dynamic stochastic general equilibrium (DSGE) models.
To a large extent, existing open economy macroeconomic models ignore portfolio compo-
sition, analyzing financial linkages between countries in terms of net foreign assets, with
no distinction made between assets and liabilities. But recent research has highlighted
the presence of large cross-country gross asset and liability positions, with considerable
heterogeneity among countries in the composition of portfolios among diﬀerent classes
of assets. Lane and Milesi-Ferretti (2001, 2006) document the rapid growth of country
portfolio holdings, particularly in the last decade. They show that even large countries
such as the UK hold gross assets and liabilities that are multiples of GDP.
        The growth in international financial portfolios raises a number of important questions
for open economy macroeconomics. What are the determinants of the size and composi-
tion of gross portfolio positions? Can standard theories account for the observed structure
of portfolio holdings? Moreover, the large size of gross positions makes it likely that the
portfolio composition itself aﬀects macroeconomic outcomes. With gross positions as large
or larger than GDP, unanticipated changes in exchange rates or asset prices can generate
changes in next external wealth (‘valuation eﬀects’) that are the same order of magnitude
as annual current accounts.1 This raises questions about how portfolio composition may
aﬀect the international business cycle and international transmission of shocks. Finally,
by generating significant wealth re-distributions in response to fluctuations in exchange
rates and asset prices, international portfolio composition may have significant implica-
tions for economic policy. How should monetary and fiscal policies be designed in an
environment of endogenous portfolio choice?
        While these questions are obviously of interest to open economy macroeconomists and
policymakers, current theoretical models and solution methods cannot answer them in
any very systematic way. This is because the standard approaches to solving general
equilibrium models make it diﬃcult to incorporate portfolio choice. The usual method of
analysis in DSGE models is to take a linear approximation around a non-stochastic steady
    1
        Lane and Milesi-Ferretti (2001) emphasize the quantitative importance of valuation eﬀects on external
assets and liabilities. See also subsequent work by Ghironi et al. (2005), Gourinchas and Rey (2005),
and Tille (2003, 2004).



                                                       1
state. But optimal portfolios are not uniquely defined in a non-stochastic steady state,
so there is no natural point around which to approximate. Moreover, portfolios are also
not defined in a first-order approximation to a DSGE model, since such an approximation
satisfies certainty equivalence, so that all assets are perfect substitutes. As a result, the
analysis of portfolio choice in DSGE models appears to be intractable in all but the most
restricted of cases.2
       In this paper we develop and analyze an approximation method which overcomes these
problems. Our method can be applied to any standard open economy model with any
number of assets, any number of state variables, and complete or incomplete markets,
so long as the model is amenable to solution using conventional approximation proce-
dures for DSGE models. We find a general formula for asset holdings which can be very
easily incorporated into the standard solution approach. The technique is simple to im-
plement and can be used to derive either analytical results (for suﬃciently small models)
or numerical results for larger models.
       A key feature of our approach is to recognize that, at the level of approximation
usually followed in open economy macroeconomics, one only requires a solution for the
‘steady-state’ portfolio holdings. The steady state portfolio is defined as the constant (or
‘zero-order’) term in a Taylor series approximation of the true equilibrium portfolio func-
tion. Higher-order aspects of portfolio behaviour are not relevant for first-order accurate
macro dynamics. Equivalently, time variation in portfolios is irrelevant for all questions
regarding the first-order responses of macroeconomic variables like consumption, output,
real exchange rates, etc. Therefore, the solution we derive exhausts all the macroeconomic
implications of portfolio choice at this level of approximation.
   2
       If there are enough financial assets to allow perfect risk sharing (so that international financial markets
are eﬀectively complete) the problem becomes somewhat easier. In this case, it is possible to identify an
equilibrium macroeconomic allocation independent of financial structure, and then, given this allocation,
one can derive the implied portfolio which supports the equilibrium. Engel and Matsumoto (2005)
and Kollmann (2006) represent examples of such an approach. However, when markets are incomplete
(in the sense that there are not suﬃcient assets to allow perfect risk sharing) optimal portfolios and
macroeconomic equilibrium must be derived simultaneously. This makes the problem considerably more
diﬃcult. Given the lack of empirical support for international risk sharing (see, for instance, Obstfeld
and Rogoﬀ, 2000), models with incomplete markets are likely to be of particular interest. Heathcote
and Perri (2004) provide one example of an incomplete markets model in which it is possible to derive
explicit expressions for equilibrium portfolios. Their model is, however, only tractable for a specific menu
of assets and for specific functional forms for preferences and technology.


                                                         2
       How do we obtain the zero-order component of the equilibrium portfolio? This is
done by combining a second-order approximation of the portfolio selection equation with
a first-order approximation to the remaining parts of the model. Of course, these two
approximations will be interdependent; the endogenous portfolio weights will depend on
the variance-covariance matrix of excess returns produced by the general equilibrium
model, but that in turn will depend on the portfolio positions themselves. The key
innovation of our approach is to show that this simultaneous system can be solved to give
a simple closed-form analytical solution for the equilibrium portfolio.
       While our solution procedure is novel, its mathematical foundations are already es-
tablished in the literature, in particular in the work of Samuelson (1970), and in diﬀerent
form by Judd (1998) and Judd and Guu (2001). Samuelson shows how a mean-variance
approximation of a portfolio selection problem is suﬃcient to identify the optimal portfolio
in a near-non-stochastic world. Judd and Guu (2001) show how the same equilibrium can
be identified by using a combination of a Bifurcation theorem and the Implicit Function
Theorem. Our solution approach relies on first-order and second-order approximations of
the model, rather than the Implicit Function and Bifurcation Theorems, but the underly-
ing theory described by Judd and Guu (2001) is applicable to our equilibrium solution. In
particular, the steady-state portfolio derived using our technique corresponds to a bifur-
cation point in the set of non-stochastic equilibria. The main contribution of this paper
is to show how this solution can easily be derived in standard DSGE models. We note
in addition, that there is nothing about the approximation method that restricts its use
to open economy models. It can be applied to any heterogeneous agent DSGE model,
whether in a closed or open economy context.3
       As we have already stated, the steady-state portfolio is all that is needed in order
to analyze the first-order properties of a general equilibrium model. But for many pur-
poses, it may be necessary to analyze the dynamics of portfolio holdings themselves. In
addition, in order to do welfare analysis, it is usually necessary to analyze a second-order
approximation of a model. At the level of second-order approximation, time variation
in portfolios becomes relevant for macroeconomic dynamics. But these features can be
obtained by an extension of our method to higher-order approximations of the model. In
particular, the state-contingent, or first-order aspects of the equilibrium portfolio, can be
   3
       Samuelson (1970) and Judd and Guu (2001) did not develop their results in open economy (or general
equilibrium) contexts.


                                                     3
obtained by combining a third-order approximation of the portfolio selection equations,
with a second-order approximation to the rest of the model. The current paper focuses
on the derivation of steady-state portfolios because this represents a distinct and valu-
able first-step in the analysis of portfolio choice in open-economy DSGE models. In a
final section however, we discuss briefly the extension of the method to higher orders. A
companion paper, Devereux and Sutherland (2007), shows how higher-order solutions to
portfolios also have an analytical representation.
      In the related literature a number of approaches have been developed for analysing
portfolio choice in incomplete-markets general equilibrium models. In a recent paper,
Tille and Van Wincoop (2007) show how the zero and higher-order components of port-
folio behaviour in an open economy model can be obtained numerically via an iterative
algorithm. Their approach delivers a numerical solution for steady-state portfolios in man-
ner analogous to the analytical solutions derived in this paper. Judd et al (2002) develop
a numerical algorithm based on ‘spline collocation’ and Evans and Hnatkovska (2005)
present a numerical approach that relies on a combination of perturbation and continuous-
time approximation techniques.4 The methods developed by Judd et al and Evans and
Hnatkovska are very complex compared to our approach and they represent a significant
departure from standard DSGE solution methods. Devereux and Saito (2005) use a con-
tinuous time framework which allows some analytical solutions to be derived, but their
approach can not handle general international macroeconomic models with diminishing-
returns technology or sticky nominal goods prices.5
      This paper proceeds as follows. The next section sets out a two-asset portfolio choice
problem within a simple two-country endowment model and shows how our method can
be applied in this context. Section 3 develops a more general n-asset portfolio problem
within a generic two country DSGE model and shows how the method can be generalised
to accommodate a wide class of models. In this section also, we extend the basic example
model of Section 2 to allow for more shocks and a wider class of assets. Section 4 briefly
outlines how the method can be extended to derive a solution for the first-order component
  4
      Evans and Hnatkovska (2005) develop an approach similar to that of Campbell and Viceira (2005),
who present a comprehensive analysis of optimal portfolio allocation for a single agent.
  5
    More recently, a number of papers have started to use the method developed in the current paper
to solve for optimal portfolio holdings in DSGE models. See in particular Coeurdacier, Kollmann and
Martin (2008), and Coeurdacier (2008).



                                                  4
of the equilibrium portfolio. Section 5 concludes the paper.


2         Example: A Simple Two-Asset Endowment Model

2.1         The Model
We first illustrate how the solution procedure works in a simple two-country example with
only two internationally traded assets, where agents consume an identical consumption
good, and income takes the form of an exogenous endowment of the consumption good.
        Agents in the home country have a utility function of the form
                                                    X
                                                    ∞
                                          Ut = Et          θτ u(Cτ )                                 (1)
                                                    τ =t

where C is consumption and u(C) = (C 1−ρ )/(1 − ρ). θτ is the discount factor, which is
determined as follows
                                       θτ +1 = θτ β(CAτ ), θ0 = 1

where CA is aggregate home consumption and 0 < β(CA ) < 1, β 0 (CA ) ≤ 0. If β(CA )
is a constant (i.e. β 0 (CA ) = 0) then the discount factor is exogenous. It is well known
that, in this case, incompleteness of financial markets implies a unit root in the first-order
approximated model. Although our solution approach works perfectly well in this case,
there may be occasions where it is useful to eliminate the unit root. This can be achieved
by allowing β 0 (CA ) < 0. Endogenising the discount factor in this way has no impact on
the applicability of our solution approach.6 In what follows we assume

                                             β(CA ) = ωCA−η

where 0 ≤ η < ρ and 0 < ω C̄A−η < 1 where C̄A is the steady state value of consumption.
        The budget constraint for home agents is given by

                             α1,t + α2,t = α1,t−1 r1,t + α2,t−1 r2,t + Yt − Ct                       (2)
    6
        Following Schmitt Grohe and Uribe (2003), θτ is assumed to be taken as exogenous by individual
decision makers. The impact of consumption on the discount factor is therefore not internalized. Our
solution approach can be easily modified to deal with the alternative case where θτ depends on individual
consumption, and the eﬀect of consumption plans on θτ is internalised (see Devereux and Sutherland
2008).

                                                     5
where Y is the endowment received by home agents, α1,t−1 and α2,t−1 are the real holdings
of the two assets (purchased at the end of period t − 1 for holding into period t) and r1,t
and r2,t are gross real returns. It is assumed that the vector of available assets is exogenous
and predefined. The stochastic process determining endowments and the nature of the
assets and the properties of their returns are specified below.
    Define Wt = α1,t +α2,t to be the total net claims of home agents on the foreign country
at the end of period t (i.e. the net foreign assets of home agents). The budget constraint
can then be re-written as

                             Wt = α1,t−1 rx,t + r2,t Wt−1 + Yt − Ct                        (3)

where
                                          rx,t = r1,t − r2,t

Here asset 2 is used as a numeraire and rx,t measures the "excess return" on asset 1.
    At the end of each period agents select the portfolio of assets to hold into the following
period. Thus, for instance, at the end of period t home agents select α1,t to hold into
period t + 1. The first-order condition for the choice of α1,t can be written in the following
form
                            Et [u0 (Ct+1 )r1,t+1 ] = Et [u0 (Ct+1 )r2,t+1 ]                (4)

    Foreign agents face a similar portfolio allocation problem with a budget constraint
given by
                            Wt∗ = α∗1,t−1 rx,t + r2,t Wt−1
                                                        ∗
                                                           + Yt∗ − Ct∗                     (5)

where an asterisk indicates foreign variables. In equilibrium it follows that Wt∗ = −Wt .
Foreign agents have preferences similar to (1) so the first-order condition for foreign agents’
choice of α∗1,t is
                            £                ¤    £                 ¤
                          Et u0 (Ct+1
                                  ∗
                                      )r1,t+1 = Et u0 (Ct+1
                                                        ∗
                                                            )r2,t+1                        (6)

    Assets are assumed to be in zero net supply, so market clearing in asset markets implies

                       α1,t−1 + α∗1,t−1 = 0,            α2,t−1 + α∗2,t−1 = 0

    To simplify notation, in what follows we will drop the subscript from α1,t and simply
refer to αt . It should be understood, therefore, that α1,t = −α∗1,t = αt , α2,t = Wt − αt and
α∗2,t = Wt∗ + αt .


                                                  6
       Endowments are the sum of two components, so that

                                Yt = YK,t + YL,t ,            Yt∗ = YK,t
                                                                     ∗      ∗
                                                                         + YL,t                            (7)

                ∗                                            ∗
where YK,t and YK,t represent ‘capital income’ and YL,t and YL,t ‘labour income’. The
endowments are determined by the following simple stochastic processes

                        log YK,t = log ȲK + εK,t ,            log YL,t = log ȲL + εL,t

                             ∗
                        log YK,t = log ȲK + ε∗K,t ,                ∗
                                                               log YL,t = log ȲL + ε∗L,t

where εK,t , εL,t , ε∗K,t and ε∗L,t are zero-mean i.i.d. shocks symmetrically distributed over
the interval [− , ] with V ar[εK ] = V ar[ε∗K ] = σ 2K , V ar[εL ] = V ar[ε∗L ] = σ 2L . We assume
Cov[εK , ε∗K ] = Cov[εL , ε∗L ] = 0 and Cov[εK , εL ] = Cov[ε∗K , ε∗L ] = σ KL .
       The two assets are assumed to be one-period equity claims on the home and foreign
capital income.7 The real payoﬀ to a unit of the home equity in period t is defined to be
YK,t and the real price of a unit of home equity is denoted ZE,t−1 . Thus the gross real
rate of return on home equity is

                                              r1,t = YK,t /ZE,t−1                                          (8)

Likewise the gross real return on foreign equity is

                                                      ∗     ∗
                                              r2,t = YK,t /ZE,t−1                                          (9)

       ∗
where ZE,t−1 is the price of the foreign equity.
       The first-order conditions for home and foreign consumption are
                                   £ −ρ        ¤                        £ ∗−ρ        ¤
                        Ctη−ρ = ωEt Ct+1 r2,t+1 ,           Ct∗η−ρ = ωEt Ct+1 r2,t+1                      (10)

where the distinction between individual and aggregate consumption has been dropped
because, in equilibrium, C = CA and C ∗ = CA∗ . Finally, equilibrium consumption plans
satisfy the resource constraint
                                             Ct + Ct∗ = Yt + Yt∗                                          (11)
   7
       Notice that we are assuming that, by default, all capital in a country is owned by the residents of that
country. This allows us to treat equity claims to capital income as inside assets, i.e. assets in zero net
supply. This is purely an accounting convention. Our solution method works equally in the alternative
approach, where capital is not included in the definition of Y and Y ∗ and equity is treated as an outside
asset which is in positive net supply. The present approach makes our derivations easier however.

                                                        7
2.2        Zero-order and first-order components
Despite the extreme simplicity of this model, it is only in special cases that an exact
solution can be found, e.g. when there is no labour income (in which case trade in equi-
ties supports the perfect risk-sharing equilibrium).8 Furthermore, the optimal portfolio
can not be obtained using first-order approximation techniques, so standard linearisation
approaches to DSGE models can not provide even an approximate solution to the general
case. Our method, nevertheless, does yield an approximate solution to the general case.
Before describing the method, it is useful to show why standard solution techniques do
not work for this model, and to demonstrate how our method oﬀers a way around the
problems.
       First, we define some terms relating to the true and approximate portfolio solutions.
Notice that agents make their portfolio decisions at the end of each period and are free
to re-arrange their portfolios each period. In a recursive equilibrium, therefore, the equi-
librium asset allocation will be some function of the state of the system in each period -
which is summarised by the state variables. We therefore postulate that the true portfolio
(i.e. the equilibrium portfolio in the non-approximated model) is a function of state vari-
ables. In the model defined above there is only one state variable, W - so we postulate
αt = α(Wt ).9
       Now consider a first-order Taylor-series expansion of α(Wt ) around the point W = W̄

                                    α(Wt ) ' α(W̄ ) + α0 (W̄ )(Wt − W̄ )

This approximation contains two terms: α(W̄ ), which is the zero-order component (i.e. α
at the point of approximation) and α0 (W̄ )(Wt − W̄ ), which is the first-order component
(assuming (Wt − W̄ ) is evaluated up to first-order accuracy). Notice that, by definition,
the zero-order component of α is non-time varying. The approximate dynamics of the
portfolio are captured by the first-order component.
   8
       If there is no labour income then equities can be used to trade all income risk. It is easy to show that
the equilibrium portfolio is for home and foreign agents to hold portfolios equally split between home and
foreign equity. This implies perfect consumption risk sharing. This is a useful benchmark for comparison
with the solution yielded by our method.
   9
     Optimal portfolio allocation will of course depend on the properties of asset returns generated by the
model. In equilibrium, however, the stochastic properties of asset returns will also be a function of state
variables, so the impact of asset returns on portfolio allocation is implicit in the function α(Wt ).



                                                        8
   When analysing a DSGE model up to first-order accuracy the standard solution ap-
proach is to use the non-stochastic steady-state of the model as the approximation point,
(i.e. the zero-order component of each variable) and to use a first-order approximation
of the model’s equations to solve for the first-order component of each variable. Neither
of these steps can be used in the above model. It is very simple to see why. In the
non-stochastic equilibrium equations (4) and (6) imply

                                        r1,t+1 = r2,t+1

i.e. both assets pay the same rate of return. This implies that, for given W , all portfolio
allocations pay the same return, so any value for α is consistent with equilibrium. Thus
the non-stochastic steady state does not tie down a unique portfolio allocation.
   A similar problem arises in a first-order approximation of the model. First-order
approximation of equations (4) and (6) imply

                                    Et [r1,t+1 ] = Et [r2,t+1 ]

i.e. both assets have the same expected rate of return. Again, any value of α is consistent
with equilibrium.
   So neither the non-stochastic steady state nor a first-order approximation of the model
provide enough equations to tie down the zero or first-order components of α. The basic
problem is easy to understand in economic terms. Assets in this model are only distin-
guishable in terms of their risk characteristics and neither the non-stochastic steady state
nor a first-order approximation capture the diﬀerent risk characteristics of assets. In the
case of the non-stochastic steady state there is, by definition, no risk, while in a first-order
approximation there is certainty equivalence.
   This statement of the problem immediately suggests a solution. It is clear that the
risk characteristics of assets only show up in the second-moments of model variables, and
it is only by considering higher-order approximations of the model that the eﬀects of
second-moments can be captured. This fundamental insight has existed in the literature
for many years. It was formalised by Samuelson (1970), who established that, in order
to derive the zero-order component of the portfolio, it is necessary to approximate the
portfolio problem up to the second order. Our solution approach follows this principle. We
show that a second-order approximation of the portfolio optimality conditions provides
a condition which makes it possible to tie down the zero-order component of α. The

                                                9
second-order approximation captures the impact of the portfolio choices on the correlation
between portfolio returns and the marginal utility of consumption. It therefore captures
diﬀerences between assets in their ability to hedge consumption risk and thus ties down
an optimal portfolio allocation. In this paper we show in detail how to use second-
order approximations of the portfolio optimality conditions to solve for the zero-order
component of α.10
       Having established this starting point, it is relatively straightforward to extend the
procedure to higher-order components on α. Samuelson (1970) in fact states a general
principle that, in order to derive the Nth-order component of the portfolio, it is necessary
to approximate the portfolio problem up to order N + 2. In Section 4 we briefly outline
how, by following this principle, the solution for the first-order component of α can be
derived from third-order approximations of the portfolio optimality conditions. The full
details of the solution procedure for the first-order component are given in a companion
paper, Devereux and Sutherland (2007).
       While Samuelson (1970) was the first to show how solutions for the zero and higher-
order components of the portfolio may be derived, more recently Judd and Guu (2001)
have demonstrated an alternative solution approach which sheds further light on the na-
ture of the zero-order portfolio. They show how the problem of portfolio indeterminacy in
the non-stochastic steady state can be overcome by using a Bifurcation theorem in con-
junction with the Implicit Function Theorem. Their approach shows that the zero-order
portfolio is a bifurcation point in the set of non-stochastic equilibria. Like Samuelson
(1970), our solution approach relies on second-order approximations of the model to iden-
tify the zero-order component, but the underlying theory described by Judd and Guu
(2001) is also applicable to our equilibrium solution. In particular, the zero-order portfo-
lio derived using our technique corresponds to the solution that emerges from the Judd
and Guu approach. Our solution can therefore be rationalised in the same way, i.e. it is
a bifurcation point in the set of non-stochastic equilibria.11
  10
       Note that Samuelson approached the problem by approximating the agent’s utility function, while
we take approximations of agents’ first-order conditions. It is possible to show that the two approaches
produce identical results for the zero order component of the portfolio.
  11
     As already explained, in a non-stochastic world all portfolio allocations are equivalent and can be
regarded as valid equilibria. A stochastic world on the other hand (assuming independent asset returns
and suitable regularity conditions on preferences) has a unique equilibrium portfolio allocation. If one
considers the limit of a sequence of stochastic worlds, with diminishing noise, the equilibrium portfolio


                                                   10
    The general underlying principles of the solution we derive are thus well established.
The main contribution of this paper is to provide a solution approach which can easily
be applied to DSGE models.12 We now demonstrate this by solving for the zero-order
component of α in the simple two-asset endowment model described above.


2.3      Solving for the zero-order portfolio
In what follows, a bar over a variable indicates its value at the approximation point (i.e.
the zero-order component) and a hat indicates the log-deviation from the approximation
point (except in the case of α̂, Ŵ and r̂x , which are defined below). Notice that the
non-stochastic steady state, while failing to tie down α, still provides solutions for output,
consumption and rates of return. We therefore use the non-stochastic steady state of the
model as the approximation point for all variables except α. For simplicity, we assume
that the two countries are identical so that the non-stochastic steady state implies W̄ = 0.
It follows from equations (4) and (6) that r̄1 = r̄2 = 1/β̄ (where β̄ = β(C̄) = ω C̄ −η ) and
thus r̄x = 0. Equations (3) and (5) therefore imply that Ȳ = Ȳ ∗ = C̄ = C̄ ∗ . Since W̄ = 0,
it also follows that ᾱ2 = −ᾱ1 = −ᾱ∗2 = ᾱ∗1 = −ᾱ.13
    As argued above, solving for the zero-order component of α requires a second-order
expansion of the portfolio problem. So we start by taking a second-order approximation
of the home-country portfolio first-order condition, (4), to yield
                    ∙                                              ¸
                              1 2                                      ¡ ¢
                 Et r̂x,t+1 + (r̂1,t+1 − r̂2,t+1 ) − ρĈt+1 r̂x,t+1 = O 3
                                           2
                                                                                                    (12)
                              2

where r̂x,t+1 = r̂1,t+1 − r̂2,t+1 and O ( 3 ) is a residual which contains all terms of order
higher than two. Applying a similar procedure to the foreign first-order condition, (6),
yields                 ∙                                               ¸
                                 1 2                                       ¡ ¢
                     Et r̂x,t+1 + (r̂1,t+1 − r̂2,t+1 ) − ρĈt+1 r̂x,t+1 = O 3
                                               2            ∗
                                                                                                    (13)
                                 2
tends towards a limit which correspond to one of the many equilibria in the non-stochastic world. This
limiting portfolio is the bifurcation point described by Judd and Guu (2001), i.e. it is the point in the
set of non-stochastic equilibria which intersects with the sequence of stochastic equilibria.
  12
     Note that both Samuelson (1970) and Judd and Guu (2001) demonstrate their results using static
partial equilibrium models of portfolio allocation.
  13
     The assumption of symmetry is purely for convenience of exposition. The solution method can easily
be adapted to deal with asymmetries across the home and foreign countries.



                                                   11
These expression can now be combined to show that, in equilibrium, the following equa-
tions must hold                  h                       i       ¡ ¢
                               Et (Ĉt+1 − Ĉt+1 )r̂x,t+1 = 0 + O 3
                                             ∗
                                                                                           (14)
and
                         1 £ 2           2
                                               ¤    1 h            ∗
                                                                               i   ¡ ¢
        Et [r̂x,t+1 ] = − Et r̂1,t+1 − r̂2,t+1   + ρ Et (Ĉt+1 + Ĉt+1 )r̂x,t+1 + O 3  (15)
                         2                          2
These two equations express the portfolio optimality conditions in a form which is partic-
ularly convenient for deriving equilibrium portfolio holdings and excess returns. Equation
(14) provides an equation which must be satisfied by equilibrium portfolio holdings. Equa-
tion (15) shows the corresponding set of equilibrium expected excess returns.
     We will now show that equation (14) provides a suﬃcient condition to tie down the
zero-order component of α. In order to do this we first state two important properties of
the approximated model.

       Property 1 In order to evaluate the left hand side of equation (14) it is suﬃcient to
       derive expressions for the first-order accurate behaviour of consumption and excess
       returns. This is because the only terms that appear in equation (14) are products,
       and second-order accurate solutions for products can be obtained from first-order
       accurate solutions for individual variables.

       Property 2 The only aspect of the portfolio decision that aﬀects the first-order
       accurate behaviour of consumption and excess returns is ᾱ, i.e. the zero-order
       component of the α. The first-order component, i.e. the deviation of α from the
       approximation point, does not aﬀect the first-order behaviour of consumption and
       excess returns. To see why this is true notice that portfolio decisions only enter
       the model via the portfolio excess return, i.e. via the term αt−1 rx,t in the budget
       constraints. A first-order expansion of this term is ᾱr̂x,t + r̄x α̂t−1 . But r̄x = 0 so
       only ᾱr̂x,t remains.

     It is now straightforward to show that equation (14) provides a condition which ties
down ᾱ. Property 2 tells us that it is possible to evaluate the first-order behaviour of
          ∗
   h − Ĉt+1 ) and r̂x,t+1
(Ĉt+1                    i conditional on a given value of ᾱ. Property 1 tells us that
              ∗
Et (Ĉt+1 − Ĉt+1 )r̂x,t+1 can therefore also be evaluated conditional on a given value of ᾱ.
                                                                     h                       i
                                                                                 ∗
Equation (14) tells us that a solution for ᾱ is one which implies Et (Ĉt+1 − Ĉt+1 )r̂x,t+1 =
0.

                                                12
       In order to derive this solution for ᾱ it is first necessary to solve for the first-order
                                 ∗
accurate behaviour of (Ĉt+1 − Ĉt+1 ) and r̂x,t+1 conditional on a given value of ᾱ. The
first-order accurate behaviour of r̂x,t+1 is particularly simple in this model. First-order
approximations of (8) and (9) imply

                                                  ∗                  ∗
                                                                                  ¡ 2¢
                            r̂x,t+1 = ŶK,t+1 − ŶK,t+1 − (ẐE,t − ẐE,t )+O

where O ( 2 ) is a residual which contains all terms of order higher than one, so

                                                          ∗                    ∗
                                                                                         ¡ 2¢
                    Et [r̂x,t+1 ] = Et [ŶK,t+1 ] − Et [ŶK,t+1 ] − (ẐE,t − ẐE,t )+O

Notice that (15) implies that, up to a first-order approximation, Et [r̂x,t+1 ] = 0 so

                                        ∗                             ∗
                                                                                  ¡ 2¢
                             (ẐE,t − ẐE,t ) = Et [ŶK,t+1 ] − Et [ŶK,t+1 ]+O

and thus, since YK and YK∗ are i.i.d., r̂x,t+1 is given by14

                                                           ∗
                                                                        ¡ 2¢
                                     r̂x,t+1 = ŶK,t+1 − ŶK,t+1 +O                                 (16)

                                                        ∗
       The first-order accurate solution for (Ĉt+1 − Ĉt+1 ) is also straightforward to derive. A
first-order approximation of the home and foreign budget constraints implies
                                       1                                     ¡ ¢
                             Ŵt+1 =      Ŵt + Ŷt+1 − Ĉt+1 + α̃r̂x,t+1 + O 2                     (17)
                                       β̄
                                      1         ∗      ∗
                                                                          ¡ ¢
                            −Ŵt+1 = − Ŵt + Ŷt+1 − Ĉt+1 − α̃r̂x,t+1 + O 2                        (18)
                                      β̄
where Ŵt = (Wt − W̄ )/C̄ and α̃ = ᾱ/(β̄ Ȳ ). Combining (17) and (18) with (16) and an
appropriate transversality condition implies
                 X
                 ∞
                        i                                   2
                                            ∗                                    ∗
                       β̄ Et+1 (Ĉt+1+i − Ĉt+1+i ) =          Ŵt + (Ŷt+1 − Ŷt+1 )
                 i=0
                                                            β̄
                                                                             ∗
                                                                                           ¡ 2¢
                                                            +2α̃(ŶK,t+1 − ŶK,t+1 )+O              (19)

                                                                    ∗
where use has been made of the fact that Et+1 [Ŷt+1+i ] = Et+1 [Ŷt+1+i ] = Et+1 [ŶK,t+1+i ] =
        ∗
Et+1 [ŶK,t+1+i ] = 0 for all i > 0.
  14
       Notice from this derivation that, in this model, rx is completely independent of α. This makes the
application of our solution process particularly simple. In the next section we will show that our method
can easily be applied to more general models where the behaviour of rx may be directly or indirectly
influenced by α.

                                                       13
     The first-order conditions for consumption, equations (10), imply

                                  ∗                     ∗
                                                                   ¡ 2¢
                Et+1 [Ĉt+1+i − Ĉt+1+i ] = ς(Ĉt+1 − Ĉt+1 )+O           for all i > 0   (20)

                                  ∗
where ς = (ρ − η)/ρ so (Ĉt+1 − Ĉt+1 ) is given by

                            ∗         2(1 − β̄ς)                            ∗
                  Ĉt+1 − Ĉt+1 =                Ŵt + (1 − β̄ς)(Ŷt+1 − Ŷt+1 )
                                          β̄
                                                                 ∗
                                                                              ¡ ¢
                                      +2(1 − β̄ς)α̃(ŶK,t+1 − ŶK,t+1 )+O 2               (21)

                                                                                   ∗
     Equations (16) and (21) show the first-order accurate behaviour of (Ĉt+1 − Ĉt+1 ) and
r̂x,t+1 conditional on a given value of ᾱ. Combining these expression yields
                                      h                       i
                                                   ∗
                                   Et (Ĉt+1 − Ĉt+1 )r̂x,t+1 =
                 h³                                         ´                    i  ¡ ¢
                              ∗                      ∗                    ∗
      (1 − β̄ς)Et (Ŷt+1 − Ŷt+1 ) + 2α̃(ŶK,t+1 − ŶK,t+1 ) (ŶK,t+1 − ŶK,t+1 ) +O 3    (22)

It follows from (14) and (22) that the solution for α̃ is
                                               ∗                   ∗
                             1 Et [(Ŷt+1 − Ŷt+1 )(ŶK,t+1 − ŶK,t+1 )]
                      α̃ = −                                             +O( )            (23)
                             2                           ∗
                                       Et [(ŶK,t+1 − ŶK,t+1 )2 ]
or
                                  δ + (1 − δ)σ KL /σ 2K
                              α̃ = −                    +O( )                       (24)
                                           2
where δ = ȲK /(ȲK + ȲL ) = ȲK /Ȳ . Notice that the residual in this expression is a
first-order term. The solution for ᾱ is given by ᾱ = α̃β̄ Ȳ .
     To provide an economic interpretation of our solution it is helpful to re-express (24) in
terms of the proportion of home equity held by home residents. The total value of home
equity is β̄ ȲK , so the proportion held by home residents is given by

                               β̄ ȲK + ᾱ   1 − (1 − δ)σKL /δσ 2K
                                           =                                              (25)
                                   β̄ ȲK              2

The most obvious benchmark against which to compare (25) is the case where there is
no labour income, i.e. where δ = 1 and σ 2L = 0. In this case there is a known exact
solution to the model where home and foreign agents hold a balanced portfolio of home
and foreign equities. From (25), our solution yields exactly this outcome. i.e. home agents
hold exactly half of home equity (and by implication half of foreign equity). Then, we can
check from (21) that the equilibrium portfolio yields full consumption risk sharing. More

                                                14
generally, in cases where this is labour income risk, i.e. 0 < δ < 1 and σ2L > 0, there is no
exact solution to the model, but our zero-order solution provides an approximate solution.
Equation (25) shows that if σKL = 0 (i.e. labour and capital income are uncorrelated)
agents continue to hold a balanced portfolio of home and foreign equity, but equation (21)
shows that full consumption risk sharing is not achieved in this case. The equilibrium
portfolio deviates from an equal balance of home and foreign equity when there is some
correlation between capital and labour income. For instance, when there is a negative
correlation, i.e. σ KL < 0, there will be home bias in equity holdings (i.e. home agents will
hold more then half of home equity and foreign agents will hold more than half of foreign
equity).15
      Before showing how the solution procedure can be applied to a more general model,
we use (24) to address a number of potentially puzzling issues. First, notice that despite
the presence of time subscripts, all the terms in (23), including the conditional second-
moments, are constant. So our solution for ᾱ is non-time-varying (which is consistent
with our definition of the zero-order component). At first sight it may seem contradictory
that portfolio allocations are non-time varying while net wealth, in the form of Ŵt , is time
varying. But this is to confuse orders of approximation. ᾱ is the zero-order component
of the portfolio, and should be compared to the zero-order component of net wealth, W̄ ,
which, like ᾱ, is non-time varying. Ŵt on the other hand, is the first-order component
of net wealth, and this should be compared to the first-order component of portfolios,
α̂t . Both Ŵt and α̂t are time varying. But by Property 2 it is possible to solve for the
dynamics of Ŵ without having to know the behaviour of α̂. As explained above, having
solved for ᾱ it is possible to solve for α̂t by analysing a third-order approximation of the
portfolio problem. This is discussed below in Section 4.
      A more general implication of Property 2, which is worth emphasising, is that it is
not necessary to solve for the first-order behaviour of α̂ in order to solve for the first-
order behaviour of other variables in the model. It is therefore possible to analyse the
implications of the above model for the first-order behaviour of all variables other than α
without having to solve for α̂.
      The logic presented above implies that the zero-order component of the portfolio, ᾱ, is
analogous to the zero-order component of the other variables in the model. At first sight
this may also seem contradictory, since the zero-order components of other variables are
 15
      Conversely, when σ KL > 0, we have a bias against home assets, as in Baxter and Jermann (1997).


                                                  15
derived from the non-stochastic steady state, while our solution for ᾱ is derived from an
explicitly stochastic analysis. The way to resolve this apparent contradiction is to interpret
ᾱ as the equilibrium for portfolio holdings in a world with an arbitrarily small amount of
stochastic noise, i.e. the equilibrium in a ‘near-non-stochastic’ world. If one considers the
limit of a sequence of stochastic worlds, with diminishing noise, the equilibrium portfolio
tends towards a limit which correspond to one of the many portfolio equilibria in the
non-stochastic world. This limiting portfolio is a bifurcation point described by Judd and
Guu (2001), i.e. it is the point in the set of non-stochastic equilibria which intersects
with the sequence of stochastic equilibria. Our solution for ᾱ corresponds to the portfolio
allocation at this bifurcation point.16


3        Generalising to an n-Asset Model

3.1        A general framework
We now show how the solution method can be extended to a much more general model
with many assets. The model is general enough to encompass the range of structures
that are used in the recent open economy macro literature. However, only those parts
of the model directly necessary for understanding the portfolio selection problem need
to be explicitly described. Other components of the model, such as the labour supply
decisions of households and the production and pricing decisions of firms, are not directly
relevant to the portfolio allocation problem, so these parts of the model are suppressed.
The solution approach is consistent with a wide range of specifications for labour supply,
pricing and production. Thus, the non-portfolio parts of the model may be characterised
by endogenous or exogenous employment, sticky or flexible prices and wages, local cur-
  16
       Suppose that the covariance matrix of the innovations is given by Σ = ζΣ0 where ζ > 0 is a scalar
and Σ0 is a valid covariance matrix. Notice that the solution for α̃ given in (24) is independent of ζ. So
the value of α̃ given by (24) (and therefore the value of ᾱ) is equivalent to the value that would arise in
the case of an arbitrarily small, but non-zero, value of ζ - i.e. the value of α̃ that would arise in a world
which is arbitrarily close to a non-stochastic world. Furthermore, notice that as      tends to zero (which
is equivalent to ζ tending to zero) the size of the residual in (24) tends to zero. So, as the amount of
noise tends to zero, the value of α̃ becomes arbitrarily close to the true value of portfolio holdings in the
non-approximated model. Our solution for ᾱ can therefore be thought of as the true portfolio equilibrium
in a world which is arbitrarily close to the non-stochastic equilibrium.



                                                     16
rency pricing or producer currency pricing, perfect competition or imperfect competition,
etc.17
       We continue to assume that the world consists of two countries. The home country is
assumed to produce a good (or a diﬀerentiated bundle of goods) with aggregate quantity
denoted YH (which can be endogenous) and aggregate price PH . Similarly the foreign
country produces quantity YF of the foreign good (or bundle of goods) at price PF∗ . In
what follows foreign currency prices are denoted with an asterisk.
       Agents in the home country now have a utility function of the form
                                                 X
                                                 ∞
                                      Ut = Et           θτ [u(Cτ ) + v(.)]                                (26)
                                                 τ =t

where C is an aggregator of the home and foreign good consumption, and u(.) is a twice
continuously diﬀerentiable and concave period utility function. The function v(.) captures
those parts of the preference function which are not relevant for the portfolio problem.18
The aggregate consumer price index for home agents is denoted P . θt is again the discount
factor, which may be endogenous in the way previously described.
       There are n assets and a vector of n returns (for holdings of assets from period t − 1
to t) given by rt0 = [ r1,t r2,t ... rn,t ]. Asset payoﬀs and asset prices are measured
in terms of the aggregate consumption good of the home economy (i.e. in units of C).
Returns are defined to be the sum of the payoﬀ of the asset and capital gains relative to
the asset price. As before, it is assumed that the vector of available assets is exogenous
and predefined.
       The budget constraint for home agents is given by
                                   X             X
                                        αi,t =          ri,t αi,t−1 + Yt − Ct                             (27)

where [α1,t−1 , α2,t−1 ...αn,t−1 ] are the holdings of the n assets purchased at the end of period
t − 1 for holding into period t. Y is the total disposable income of home agents expressed
  17
       Our method can therefore easily be applied to the sticky-price models commonly employed in the
open economy macro literature, e.g. as developed in Obstfeld and Rogoﬀ (1995), Devereux and Engel
(2003), Corsetti and Pesenti (2005) and Benigno and Benigno (2003).
  18
     For these other aspects of the preference function to be irrelevant for portfolio selection it is necessary
to assume utility is additively separable in u(C) and v(.). Extensions to cases of non-additive separability
(e.g. habit persistence in consumption) are straightforward, as will become more clear below. Using (26)
allows us to illustrate the method with minimal notation.


                                                         17
in terms of the home consumption good. Thus, Y may be given by YH PH /P + T where
T is a fiscal transfer (or tax if negative).
   Using the definition of net wealth (net foreign assets)
                                                       X
                                                Wt =           αi,t                                            (28)
                                                           i

the budget constraint may be re-written in the form

                                  Wt = α0t−1 rx,t + rn,t Wt−1 + Yt − Ct                                        (29)

where                                    h                                         i
                               α0t−1 =       α1,t−1 α2,t−1 ... αn−1,t−1

and
           h                                                          i       h                                i
   0
  rx,t =       (r1,t − rn,t ) (r2,t − rn,t ) ... (rn−1,t − rn,t )         =       rx,1,t rx,2,t ... rx,n−1,t

Here the nth asset is used as a numeraire and rx,t measures the "excess returns" on the
other n − 1 assets.
   There are n − 1 first-order conditions for the choice of the elements of αt which can
be written in the following form

                                Et [u0 (Ct+1 )r1,t+1 ] = Et [u0 (Ct+1 )rn,t+1 ]
                                Et [u0 (Ct+1 )r2,t+1 ] = Et [u0 (Ct+1 )rn,t+1 ]
                                                                                                               (30)
                                                       :
                              Et [u0 (Ct+1 )rn−1,t+1 ] = Et [u0 (Ct+1 )rn,t+1 ]

   Foreign-country agents face a similar portfolio allocation problem with a budget con-
straint given by
                            1 ∗     1 £ ∗0                ∗
                                                             ¤
                               Wt =    αt−1 rx,t + rn,t Wt−1   + Yt∗ − Ct∗                                     (31)
                            Qt      Qt
where Qt = Pt∗ St /Pt is the real exchange rate. The real exchange rate enters this budget
constraint because Y ∗ and C ∗ are measured in terms of the foreign aggregate consumption
good (which may diﬀer from the home consumption good) while asset holdings and rates
of return are defined in terms of the home consumption good.




                                                       18
       Foreign agents are assumed to have preferences similar to (26) so the first-order con-
ditions for foreign-country agents’ choice of α∗t are
                        £                       ¤      £ −1 0 ∗              ¤
                     Et Q−1t+1 u0
                                  (C ∗
                                    t+1 )r1,t+1   = Et  Qt+1 u (Ct+1 )rn,t+1
                        £                       ¤      £ −1 0 ∗              ¤
                     Et Q−1t+1 u0
                                  (C ∗
                                        )r
                                    t+1 2,t+1     = Et  Qt+1 u (Ct+1 )rn,t+1
                                                                                                    (32)
                                                     :
                          £                        ¤      £ −1 0 ∗              ¤
                        Et Q−1
                            t+1 u0
                                   (C ∗
                                     t+1 )rn−1,t+1   = Et  Qt+1 u (Ct+1 )rn,t+1


       The two sets of first-order conditions, (30) and (32), and the market clearing condition
αt = −α∗t , provide 3(n−1) equations which determine the elements of αt , α∗t and Et [rx,t+1 ].
       Clearly, in any particular general equilibrium model, there will be a set of first-order
conditions relating to intertemporal choice of consumption, labour supply, etc., for the
home and foreign consumers, and a set of first-order conditions for price setting and
factor demands for home and foreign producers. Taken as a whole, and combined with
an appropriate set of equilibrium conditions for goods and factor markets, this full set
of equations will define the general equilibrium of the model. As already explained, the
details of these non-portfolio parts of the model are not necessary for the exposition of
the solution method, so they are not shown explicitly. In what follows these omitted
equations are simply referred to as the "non-portfolio equations" of the model.
       The non-portfolio equations of the model will normally include some exogenous forcing
variables. In the typical macroeconomic model these take the form of AR1 processes which
are driven by zero-mean i.i.d. innovations. We assume that there are m such disturbances,
summarised in a vector, x, which is determined by the following process

                                            xt = Nxt−1 + εt                                         (33)

where ε is a vector of zero-mean i.i.d. innovations with covariance matrix Σ. It is assumed
that the innovations are symmetrically distributed over the interval [− , ].19


3.2        A general expression for the zero-order portfolio
Again we use the non-stochastic steady state of the model as the approximation point
for non-portfolio variables. And again, for convenience of exposition, we assume that
  19
       Clearly there must be a link between Σ and . The value of   places an upper bound on the elements
of Σ. So an experiment which involves considering the eﬀects of reducing     implicitly involves reducing
the magnitude of the elements of Σ.

                                                    19
the home and foreign countries are identical so that W̄ = 0, Ȳ = Ȳ ∗ = C̄ = C̄ ∗ and
r̄1 = r̄2 ... = r̄n = 1/β̄ where β̄ = β(C̄) = ωC̄ −η . Note again that this implies r̄x = 0.
    As before we proceed by taking second-order approximations of the home and foreign
portfolio first-order conditions. For the home country this yields
          h                                                                           i
       Et (r̂1,t+1 − r̂n,t+1 ) + 12 (r̂1,t+1
                                       2         2
                                             − r̂n,t+1 ) − ρĈt+1 (r̂1,t+1 − r̂n,t+1 ) = O ( 3 )
          h                                                                           i
       Et (r̂2,t+1 − r̂n,t+1 ) + 12 (r̂2,t+1
                                       2         2
                                             − r̂n,t+1 ) − ρĈt+1 (r̂2,t+1 − r̂n,t+1 ) = O ( 3 )
                                                                                                     (34)
                                                     :
     h                                                                                  i
   Et (r̂n−1,t+1 − r̂n,t+1 ) + 12 (r̂n−1,t+1
                                     2           2
                                             − r̂n,t+1 ) − ρĈt+1 (r̂n−1,t+1 − r̂n,t+1 ) = O ( 3 )

where ρ ≡ −u00 (C̄)C̄/u0 (C̄) (i.e. the coeﬃcient of relative risk aversion). Re-writing (34)
in vector form yields
                                  ∙                                  ¸
                                            1 2                          ¡ ¢
                                Et r̂x,t+1 + r̂x,t+1 − ρĈt+1 r̂x,t+1 = O 3                          (35)
                                            2
where                       h                                                                 i
                  20              2         2       2         2           2           2
                r̂x,t+1 ≡       r̂1,t+1 − r̂n,t+1 r̂2,t+1 − r̂n,t+1 ... r̂n−1,t+1 − r̂n,t+1

Applying a similar procedure to the foreign first-order conditions yields
                 ∙                                                 ¸
                          1 2                                              ¡ ¢
              Et r̂x,t+1 + r̂x,t+1 − ρĈt+1 r̂x,t+1 − Q̂t+1 r̂x,t+1 = 0 + O 3
                                        ∗
                                                                                                     (36)
                          2

    The home and foreign optimality conditions, (35) and (36), can be combined to show
that, in equilibrium, the following conditions must hold
                        h                                 i       ¡ ¢
                                    ∗
                      Et (Ĉt+1 − Ĉt+1 − Q̂t+1 /ρ)r̂x,t+1 = 0 + O 3                                 (37)

and
                      1 £ ¤      1 h                                  i   ¡ ¢
          E [r̂x ] = − E r̂x2 + ρ Et (Ĉt+1 + Ĉt+1
                                                ∗
                                                    + Q̂t+1 /ρ)r̂x,t+1 + O 3    (38)
                      2          2
These equations are equivalent to (14) and (15) in the example from before. There we
showed that equation (14) provided a suﬃcient condition to tie down the zero-order com-
ponent of the portfolio allocation. We now show that equation (37) provides a suﬃcient
condition to tie down the zero-order component of the portfolio in the general model.
    Properties 1 and 2 played a central role in deriving the solution to the example above.
These properties also hold for the general model, and remain central in the derivation
of the solution. Clearly, Property 1 applies in the general model. The left hand side

                                                         20
of equation (37) consists entirely of products of variables and can thus be evaluated to
second-order accuracy using first-order accurate expressions for Ĉ − Ĉ ∗ − Q̂/ρ and r̂x .
Likewise, Property 2 holds in the general model. Again, the portfolio allocation enters
only via the excess portfolio return, α0 rx . And, just as in the simple model, r̄x = 0, so the
first-order approximation of the excess portfolio return is ᾱr̂x . Thus only the zero-order
component of α enters the first-order approximated model.
    The general outline of the solution strategy is the same as that described for the simple
model. First we solve for the first-order accurate behaviour of Ĉ − Ĉ ∗ − Q̂/ρ and r̂x in
terms of ᾱ. Then we solve for the ᾱ that ensures (37) is satisfied.
    But now things are somewhat more complicated because the behaviour of Ĉ − Ĉ ∗ − Q̂/ρ
and r̂x is determined by a potentially complex set of first-order dynamic equations. Indeed,
at first sight, the general model may seem too complex to be solved explicitly, and it may
appear that a numerical approach is necessary to solve for the ᾱ. We show, however, that
it is possible to derive a closed-form analytical solution for ᾱ in the general model. In
fact, we derive a formula for ᾱ which is applicable to any model with the same general
features as the one described above.
    To see why it is possible to obtain a closed-form solution, it is necessary to state a
further important property of the approximated model.

      Property 3 To a first-order approximation, the portfolio excess return, ᾱr̂x,t+1 , is a
      zero mean i.i.d. random variable. This follows from equation (38), which shows that
      the equilibrium expected excess return contains only second-order terms. So, up to
      a first order approximation, Et−1 [r̂x,t+1 ] is zero, i.e. there is no predictable element
      in r̂x,t+1 . The first-order approximation of the portfolio excess return, ᾱr̂x,t+1 , is
      therefore a linear function of the i.i.d. innovations, εt+1 , and must therefore itself
      be an i.i.d. random variable.

    Property 3 greatly simplifies the solution process because it implies that ᾱ aﬀects the
first-order behaviour of the economy in a very simple way. In particular, ᾱ does not aﬀect
the eigenvalues of the first-order system. Thus, in any given period (e.g. period t) the
dynamic properties of the expected path of the economy from period t + 1 onwards are
independent of ᾱ. The period t behaviour of the economy is aﬀected by ᾱ only through its
eﬀect on the size and sign of the i.i.d. innovations to wealth that arise from the portfolio
excess return, ᾱr̂x,t .

                                              21
       The only potential complication is that r̂x,t may itself depend on period t innovations
to wealth (and therefore ᾱ). This complication is, however, easily overcome by breaking
the solution process for Ĉ − Ĉ ∗ − Q̂/ρ and r̂x into two stages. In the first stage we
treat the portfolio excess return, ᾱr̂x , as an exogenous i.i.d. random variable, and solve
the first-order model to yield an expression for r̂x in terms of exogenous innovations to
wealth and the other exogenous innovations to the model. In the second stage we use
this expression to solve out for the behaviour of Ĉ − Ĉ ∗ − Q̂/ρ and r̂x in terms of ε (i.e.
the true exogenous innovations of the model). This provides the expressions required to
evaluate (37) and thus to solve for ᾱ.20
       A full description of the derivation of the solution is given in the Appendix. Here we
simply state the resulting expression for equilibrium portfolios. To do this, first note that
a first-order approximation of the home budget constraint is given by
                                       1                                  ¡ ¢
                               Ŵt =      Ŵt−1 + Ŷt − Ĉt + α̃0 r̂xt + O 2                        (39)
                                       β̄

where Ŵt = (Wt − W̄ )/Ȳ and α̃ = ᾱ/(β̄ Ȳ ). The budget constraint can now be written
in the form
                                         1                             ¡ ¢
                                 Ŵt =      Ŵt−1 + Ŷt − Ĉt + ξ t + O 2                           (40)
                                         β̄
where α̃0 r̂xt has been replaced by ξ t . We temporarily treat ξ as an exogenous i.i.d. vari-
able21 .
       Equation (40) can be combined with first-order approximations of all the other non-
portfolio equations of the model and solved using any standard linear rational expectations
solution procedure to yield a state-space solution for all endogenous variables in terms of
the state variables of the model and εt+1 and ξ t+1 . It is then possible to write the following
  20
       Notice from equation (15) that, in the example, rx does not depend on ᾱ, so this two-step process
was not necessary.
  21
     We note that this step is necessary so as to deliver the analytical expression for the equilibrium
portfolio (43) below. If we wished to simply obtain a numerical solution for α̃, we could substitute the
numerical solution to the linearized model into (35) for an arbitrary initial assumption for α̃, and then
iterate to find the equilibrium α̃ which satisfies (35) as an equality. See Tille and Van Wincoop (2007).
The appeal of using the approach is that one may use formula (43) as an addition on to any model solved
(analytically or numerically) by first order approximation. By using (43), the researcher avoids the need
to do any higher order approximation - thus, the procedure is quite useful also in numerical analysis of
DSGE economies.



                                                     22
                                                                             ∗
expressions for the first-order accurate behaviour of r̂xt+1 , and Ĉt+1 − Ĉt+1 − Q̂t+1 /ρ
                                                                            ¡ 2¢
                                    r̂xt+1 = R1 ξ t+1 + R2 εt+1 + O                                          (41)
                                                                              "           #
                           ∗                                                       xt              ¡ 2¢
                 Ĉt+1 − Ĉt+1 − Q̂t+1 /ρ = D1 ξ t+1 + D2 εt+1 + D3                           +O             (42)
                                                                                   st+1
where R1 , R2 , D1 , D2 and D3 are coeﬃcient matrices extracted from the first-order state-
space solution of the model and x and s are respectively vectors of the exogenous and
endogenous state variables of the model.22
       The Appendix shows that a solution for α̃ is
                                                                   −1
                            α̃ = [R2 ΣD20 R10 − D1 R2 ΣR20 ]            R2 ΣD20 + O ( )                      (43)

where Σ is the covariance matrix of ε. Notice that the residual in this expression is a
first-order term. The solution for ᾱ is simply given by ᾱ = α̃β̄ Ȳ .23
       It should be emphasised that applying the procedure to any given model requires only
that the user apply (43), which needs only information from the first-order approximation
of the model in order to construct the D and R matrices (which will obviously depend
on the particulars of the model under study). So long as the model satisfies the general
properties described above, the other details of the model, such as production, labour
supply, and price setting can be varied without aﬀecting the implementation. The deriva-
tions used to obtain (43) (as presented in the Appendix) do not need to be repeated. In
summary, the solution for equilibrium α̃ has three steps:

 1. Solve the non-portfolio equations of the model with the budget constraint in the form
         of (40) to yield a state space solution.
  22
       Notice that, as follows from Property 3, r̂xt+1 does not depend on the values of the state variables.
  23
       Note that a much simpler version of (43) arises in the case where there are suﬃcient assets to replicate
the complete markets equilibrium. In general in this case there must be at most n − 1 independent shocks
and n independent assets. R2 Σ is therefore a square invertible matrix and the expression for α̃ can be
                                         −1
simplified to α̃ = [D20 R10 − D1 R20 ]        D20 + O ( ) .In this case, with complete markets, optimal portfolios
do not depend on the variance-covariance matrix of shocks, as shown, for instance, in Coeurdacier (2008)
and Kollmann (2006). Note also that (43) is not necessarily the only solution which satisfies (37) when
there are more than two assets, i.e. n > 2. However, as the Appendix shows, the solution in (43) has
an obvious claim to be the first focus of analysis since this solution always exists and it corresponds to
the unique solution in the two-asset case. We leave the further analysis of multiple equilibria to future
research.

                                                            23
 2. Extract the appropriate rows from this solution to form R1 , D1 , R2 and D2 .

 3. Calculate α̃ using (43).


3.3    Extending the example model
We illustrate the use of the general solution procedure by applying it to a modified and
extended version of our earlier example model. In this modified model we introduce more
general shock processes and allow for a wider range of assets to be traded between home
and foreign households. Assume that total endowments are given by AR1 processes of
the form
                        Ŷt = ψŶt−1 + εY,t ,        Ŷt∗ = ψŶt−1
                                                                ∗
                                                                   + εY ∗ ,t                 (44)

where 0 ≤ ψ < 1 and a hat indicates log deviations from the non-stochastic steady state.
We drop the distinction between capital and labour income endowments but extend the
model to allow for AR1 fiscal policy shocks of the form

                       Ĝt = ψĜt−1 + εG,t ,         Ĝ∗t = ψĜ∗t−1 + εG∗ ,t                 (45)

where G and G∗ are home and foreign government purchases of the consumption good. In
(44) and (45) εY,t , εG,t , ε∗Y,t and ε∗G,t are zero-mean i.i.d. shocks which are symmetrically
distributed over the interval [− , ] with V ar[εY ] = V ar[ε∗Y ] = σ 2Y , V ar[εG ] = V ar[ε∗G ] =
σ 2G . We assume Cov[εY , ε∗Y ] = Cov[εG , ε∗G ] = 0, Corr[εY , εG ] = Corr[ε∗Y , ε∗G ] = υ. We
assume Ḡ = Ḡ∗ and Ȳ = Ȳ ∗ and define g = Ḡ/Ȳ = Ḡ∗ /Ȳ ∗ to be the steady state share
of government spending in output.
   The resource constraint is now

                                Ct + Ct∗ + Gt + G∗t = Yt + Yt∗

   The utility function for home households takes the form of (1) with U(C) = log C.
Government spending does not yield utility. Government spending is assumed to be
financed via lump-sum taxes.
   In order to tie down nominal goods prices we introduce quantity theory equations of
the form
                         Mt /Pt = Ct + Gt            Mt∗ /Pt∗ = Ct∗ + G∗t



                                                24
where M and M ∗ are home and foreign money supplies. These equations may be inter-
preted as simplified cash-in-advance constraints. We assume money supplies follow AR1
process of the form

                      M̂t = ψM̂t−1 + εM,t ,            M̂t∗ = ψM̂t−1
                                                                 ∗
                                                                     + εM ∗ ,t

where εM,t and ε∗M,t are zero-mean i.i.d. shocks which are symmetrically distributed over
the interval [− , ] with V ar[εM ] = V ar[ε∗M ] = σ 2M . Monetary shocks are assumed to be
uncorrelated with endowment and government spending shocks.
   Consider two alternative menus of assets. In the first case assume that only equity
shares in the two endowment streams, Y and Y ∗ can be traded between the two economies.
We refer to this as the EQ economy. In the second case we assume that both equity shares
and nominal bonds denominated in the currencies of the two countries can be traded. We
refer to this as the EB economy.
   The budget constraint for home agents is given by
                        X          X
                            αi,t =   ri,t αi,t−1 + Yt − Ct − Gt                          (46)

where [α1,t−1 , α2,t−1 ...αn,t−1 ] are asset holdings and n is the number of assets. In the EQ
economy n = 2 and in the EB economy n = 4.
   Equities issued in period t are assumed to represent a claim on endowments in period
t + 1. The real rates of return on equities are therefore given by
                                                                    ∗
                       rE,t+1 = Yt+1 /ZE,t            rE ∗ ,t+1 = Yt+1 /ZE ∗ ,t

where ZE,t and ZE ∗ ,t are the prices of home and foreign equities in period t. Nominal
bonds issued in period t are claims on a unit of currency in period t + 1. The real rates
of return on nominal bonds are therefore given by
                                                                      ∗
                   rB,t+1 = 1/(Pt+1 ZB,t )            rB∗ ,t+1 = 1/(Pt+1 ZB∗ ,t )

where ZB,t and ZB∗ ,t are the prices of home and foreign nominal bonds in period t.
   The first-order conditions for home and foreign consumption imply
                            £ −1           ¤                     £ ∗−1           ¤
                 Ctη−1 = ωEt Ct+1 rE ∗ ,t+1 ,        Ct∗η−1 = ωEt Ct+1 rE ∗ ,t+1         (47)

The first-order conditions for portfolio allocation in the EQ economy are
            £ −1       ¤      £ −1          ¤      £ ∗−1       ¤    £ ∗−1          ¤
         Et Ct+1 rE,t+1 = Et Ct+1  rE ∗ ,t+1 , Et Ct+1   rE,t+1 = Et Ct+1 rE∗ ,t+1       (48)

                                                25
                               EQ-Economy                               EB-Economy

                                                           (1−β̄ψ)(1−gυσ G /σY )σ 2M +g 2 β̄(1−υ2 )(1−ψ−η)σ2G
        Home Equities            − 1−gυσ G /σ Y
                                    2(1−β̄ψ)
                                                       −     2(1−β̄ψ)[(1−β̄ψ)σ2M +g 2 β̄(1−υ 2 )(1−ψ−η)σ 2G ]


                                                                      β̄(1−υ 2 )(1−ψ−η)g 2 σ 2G
    Home Nominal Bonds                 −                   2(1−β̄ψ)[(1−β̄ψ)σ 2M +g 2 β̄(1−υ2 )(1−ψ−η)σ2G ]



                  (Note: β̄ = ω C̄ −η = ω C̄ ∗−η , by assumption 0 < β̄ < 1.)


                 Table 1: Steady state asset holdings of home households

while in the EB economy the corresponding conditions are
        £ −1         ¤    £ −1           ¤           £ ∗−1        ¤    £ ∗−1           ¤
     Et Ct+1 rE,t+1 = Et Ct+1  rE ∗ ,t+1          Et Ct+1  rE,t+1 = Et Ct+1  rE ∗ ,t+1
        £ −1         ¤    £ −1           ¤           £ ∗−1        ¤    £ ∗−1           ¤
     Et Ct+1 rB,t+1 = Et Ct+1  rE ∗ ,t+1          Et Ct+1  rB,t+1 = Et Ct+1  rE ∗ ,t+1                          (49)
       £ −1          ¤    £ −1            ¤         £ ∗−1         ¤    £ ∗−1           ¤
     Et Ct+1 rB∗ ,t+1 = Et Ct+1 rE ∗ ,t+1         Et Ct+1 rB∗ ,t+1 = Et Ct+1 rE ∗ ,t+1

                                                                                        ∗
   The above model can be solved to yield first-order accurate solutions for (Ĉt+1 − Ĉt+1 )
and r̂x,t+1 conditional on ξ t . These solutions yield expressions for the coeﬃcient matrices
D1 , D2 , R1 and R2 which, together with the expression for Σ from this example, can
be substituted into equation (43) to yield expressions for steady state asset holdings.
The solutions for asset holdings are reported in Table 1. The details of the first-order
approximated model and the resulting expression for D1 , D2 , R1 and R2 are reported in
the Appendix.

3.3.1   The EQ economy

The first column in Table 1 reports the value of α̃E , the holdings by home households of
home country equities in the EQ economy. In a symmetric equilibrium home holdings of
foreign equities, α̃E ∗ , are simply given by α̃E ∗ = −α̃E .
   Notice the similarity between the expression for α̃E and the solution for equity holdings
in our previous example model (see equation (24)). Clearly, fiscal policy shocks in this
model play a very similar role to labour income shocks in the previous model, so the
implications for equity holdings are very similar. The main diﬀerence between the two
cases is the term (1 − β̄ψ) in the denominator of the expression in Table 1. This reflects


                                                  26
the fact that shocks in the modified model are persistent (with AR1 coeﬃcient ψ) so
holdings of one-period equity must be larger than in the i.i.d. case to oﬀset the impact
of current shocks on the discounted value of the future endowment streams.
       Notice from Table 1 that monetary shocks are irrelevant for equity holdings in the EQ
economy. Real equity returns, and thus the hedging properties of equities, are independent
of nominal magnitudes, so the optimal equity portfolio is independent of monetary shocks.
       It is possible to use the solutions for asset holdings to judge the implications of portfolio
holdings for consumption risk sharing. This can be done by considering the behaviour of
consumption diﬀerences, C − C ∗ . Table 2 reports the impact eﬀects of shocks on C − C ∗
for the EQ and EB economics.24 It is immediately clear that, in general, risk sharing is
not perfect in the EQ economy. Both government spending and endowment shocks aﬀect
C − C ∗ . However, a number of special cases can be identified where perfect risk sharing
is achieved. For instance, if there are no government spending shocks (either g = 0 or
σ G = 0) then the expressions in Table 2 show that the C − C ∗ will be independent of
all shocks. Alternatively, if government spending and endowment shocks are perfectly
correlated (υ = 1, or υ = −1) then again the expressions in Table 2 show that C − C ∗
will be independent of all shocks (to see this, just add the first and second cells of the
EQ-Economy column in Table 1).
       In all the special cases just listed, trade in equities is suﬃcient to eliminate consump-
tion risk. Note however, that this result only applies to the symmetric version of the
model considered here, and even in the symmetric case it only applies to consumption
risk measured at the first-order level. Full replication of the complete markets equilibrium
(in the g = 0, σ G = 0, υ = 1, or υ = −1 cases) in an asymmetric version of the model,
or at higher orders of approximation, can only be achieved with the addition of a third
asset (which may be a non-contingent bond). This ensures that there are at least as many
independent excess returns as independent shocks.

3.3.2       The EB economy

Now consider the case where both equities and nominal bonds can be traded. Table 1
reports the equilibrium home-country holdings of home equity, α̃E , and home nominal
bonds, α̃B . Symmetry implies α̃E∗ = −α̃E and α̃B∗ = −α̃B .
  24
       The model is entirely symmetric, so it is suﬃcient to report the impact eﬀect of shock diﬀerentials,
i.e. (εY,t − εY ∗ ,t ) , (εG,t − εG∗ ,t ) and.(εM,t − εM ∗ ,t ) .

                                                               27
             Shocks              EQ-Economy                                EB-Economy


          Endowment              [1−β̄(1−η)]gυσ G /σ Y               [1−β̄(1−η)](1−β̄ψ)gυσ2M σG /σ Y
                                    2(1−β̄ψ)(1−g)                                       2
                                                              (1−g)[(1−β̄ψ)2 σ2M +g 2 β̄ (1−υ2 )(1−ψ−η)2 σ 2G ]
          (εY,t − εY ∗ ,t )


         Gov spending                [1−β̄(1−η)]g                          [1−β̄(1−η)](1−β̄ψ)σ 2M
                                  − 2(1− β̄ψ)(1−g)
                                                          − (1−g)[(1−β̄ψ)2 σ2          2 β̄ 2 (1−υ 2 )(1−ψ−η)2 σ 2 ]
         (εG,t − εG∗ ,t )                                                       M +g                             G




         Money supply                                                [1−β̄(1−η)]β̄(1−υ 2 )(1−ψ−η)g 2 σ 2G
                                          0               − (1−g)[(1−β̄ψ)2 σ2          2 β̄ 2 (1−υ 2 )(1−ψ−η)2 σ 2 ]
         (εM,t − εM ∗ ,t )                                                      M +g                             G




                              Table 2: Impact eﬀects of shocks on C-C*

   The first point to note from these expressions is that monetary shocks now have an
impact on equilibrium portfolio holdings. This is because monetary shocks have an impact
on the real returns on nominal bonds and thus aﬀect their hedging properties.
   The implications of monetary shocks are illustrated more clearly in Table 2, which
shows how all shocks aﬀect C − C ∗ in the EB economy. It is immediately obvious that,
in general, risk sharing is not perfect in the EB economy. This is despite the addition of
two new assets compared to the EQ economy. Nominal bonds provide an extra means
for hedging government spending and endowment shocks. But their eﬃcacy as hedging
instruments is partly undermined by monetary shocks.
   Table 2 shows, however, that there are a number of special cases where perfect risk
sharing can be achieved in the EB economy. The first case obviously arises when there
are no monetary shocks (σ M = 0). In this case nominal bonds oﬀer a good hedge for
government spending shocks, while equities provide a good hedge for endowment shocks.
Other special cases are similar to those identified for the EQ economy (i.e. the absence
of government spending shocks or perfect correlation between government spending and
endowment shocks). These special cases arise even when there are monetary shocks.
   Note again that, in all these special cases, perfect risk sharing is only achieved in the
symmetric version of the model considered here, and even in the symmetric case it is only
achieved when consumption risk measured at the first-order level. Full replication of the


                                                         28
complete markets equilibrium (in the σ M = 0, g = 0, σ G = 0, υ = 1, or υ = −1 cases)
requires the addition of a fifth asset (which again may be a non-contingent bond). This
ensures that there are at least as many independent excess returns as independent shocks.


4     Solving for the First-Order Portfolio
The analysis presented above shows how a second-order approximation of the portfolio
optimality condition provides a suﬃcient condition to tie down the zero-order component
of the portfolio, ᾱ. We have shown that, from Property 2, the solution for ᾱ is all
that is required to derive first-order accurate solutions for all other variables of a model.
Thus, if the objective is to analyse the impulse responses of variables such as output or
consumption (or indeed any variable other than α), or if one is primarily interested in
the business cycle properties of a model, then there is no need to go any further than
obtaining a solution for ᾱ. It is likely however that the first-order dynamic behaviour of
α will also prove to be an interesting topic of research in its own right. For instance,
we might like to analyze the separate movement in diﬀerent types of assets and gross
portfolio positions following macro shocks. In addition, to conduct welfare analysis, we
would generally need to evaluate the model up to a second-order approximation, which
would require incorporating the dynamic properties of α. We therefore now briefly outline
how the solution approach can be extended to solve for the first-order component of α.
    The general principles that underlie an extension of the procedure are simply stated. In
line with Samuelson (1970) it is necessary to approximate the portfolio problem up to the
third order. In the context of the simple model this involves a third-order approximation
of the portfolio optimality condition, as follows
               "                               2
                                                                          #
                                ∗
                 −ρ(Ĉt+1 − Ĉt+1 )r̂x,t+1 + ρ2 (Ĉt+1
                                                    2        ∗2
                                                       − Ĉt+1   )r̂x,t+1       ¡ ¢
            Et            ρ             ∗      2         2
                                                                            =0+O 4         (50)
                        − 2 (Ĉt+1 − Ĉt+1 )(r̂1,t+1 − r̂2,t+1 )

    It is now possible to show, using modified versions of Properties 1 and 2, that (50)
provides a suﬃcient condition to tie down the first-order component of α.
    A modified version of Property 1 states that the expression on the left hand side of
(50) can be evaluated up to third-order accuracy using first and second-order accurate
expressions for Ĉ − Ĉ ∗ , r̂1 , r̂1 and r̂x . Thus it is, at most, necessary to evaluate these
variables up to second order.

                                              29
       A modified version of Property 2 states that only the zero and first-order components
of α enter a second-order approximation of the model. This is simple to show by taking
a second-order approximation of the portfolio excess return, α1,t−1 rx,t , as follows
                                               1     2       2
                                                                                    ¡ ¢
                        ᾱr̂x,t + r̄x α̂1,t−1 + ᾱ(r̂1,t − r̂2,t ) + α̂t−1 r̂x,t + O 3                 (51)
                                               2
where α̂t = (αt − ᾱ). As before r̄x = 0, so only the zero and first-order components of α
are necessary to evaluate (51).
       The general solution strategy can now be described. First, postulate that, up to first-
order accuracy, α̂t is a linear function of the state variables of the model. Thus postulate
α̂t−1 = γ 0 zt where z is the vector of state variables and γ is a vector of coeﬃcients which are
to be determined. The modified version of Property 2 shows that it possible to evaluate
the first and second-order behaviour of Ĉ − Ĉ ∗ , r̂1 , r̂2 and r̂x conditional on a value for
γ, and hence, from the modified version of Property 1, it is possible to evaluate the left
hand side of (50) conditional on γ. The equilibrium γ is the one which ensures (50) is
satisfied.25
       The details of the solution procedure for γ are presented in Devereux and Sutherland
(2007), where we derive a closed-form solution which is applicable to a wide class of
models.


5        Conclusion
Portfolio structure has become a central issue in open economy macroeconomics and inter-
national finance. Despite this, existing models and solution methods are not well-suited
to analyzing portfolio choice in policy-relevant general equilibrium environments. This
paper develops a simple approximation method for portfolio choice problems in dynamic
general equilibrium models. Our approach is extremely easy to implement and can be
used in any of the existing models that rely on first-order approximation methods. If the
researcher is primarily interested in the implications of portfolio choice for the first-order
properties of macro variables (such as GDP, consumption, or the real exchange rate), ei-
ther through impulse response analysis or by computing second moments so as to describe
  25
       Note that the conditional third moments in (50) are time varying and depend on state variables.
The fact that (50) must be satisfied for all values of state variables and in all time periods provides just
enough equations to tie down all the elements of γ.


                                                      30
volatility and comovement, then the solution method outlined here allows a full answer to
these questions. Since the overwhelming majority of the research in international finance
and macroeconomics is carried out at the level of first-order approximation, the method
is widely applicable. It can be used to study many empirical questions in the interface
between international finance and macroeconomics. Moreover, the method allows us to
study the macroeconomic determinants of optimal steady-state portfolio holdings for any
asset or combination of assets, whether markets are complete or incomplete.
   We note that, although the motivation and applications discussed in the paper pertain
to open economy macro models, there is nothing inherent in the solution approach which
restricts the application to open economies. The method applies to portfolio choice in any
heterogeneous agent models dynamic general equilibrium models. This is true for both
the zero-order portfolio solution, as well as the first-order solution for portfolio dynamics.
Taken in combination, the methods described here oﬀer a tractable approach to incor-
porating financial structure into a wide class of stochastic dynamic general equilibrium
models.


Appendix 1: Solving the n-asset model
In this Appendix, we show how to derive (43) in the text. The first-order approximation
of the model can be summarised in a matrix equation of the form
                     "            #      "    #
                        st+1               st                     ¡ ¢
                  A1                = A2        + A3 xt + Bξ t + O 2                     (52)
                       Et [ct+1 ]          ct
where s is the vector of predetermined variables, c is the vector of jump variables, x is
defined in (33) and B is a column vector with unity in the row corresponding to (40) and
zero in all other rows. The state-space solution to (52) can be derived using any standard
solution method for linear rational expectations models. It can be written as follows

                            st+1 = F1 xt + F2 st + F3 ξ t + O ( 2 )
                                                                                         (53)
                            ct = P1 xt + P2 st + P3 ξ t + O ( 2 )

   By extracting the appropriate rows from (53) it is possible to write the following
expression for the first-order accurate relationship between excess returns, r̂xt+1 , and εt+1
and ξ t+1
                                                               ¡ 2¢
                             r̂xt+1 = R1 ξ t+1 + R2 εt+1 + O                             (54)

                                              31
where the matrices R1 and R2 are formed from the appropriate rows of (53). Equation (54)
shows how first-order accurate realised excess returns depend on exogenous i.i.d. shocks,
εt+1 and ξ t+1 . In particular, it shows how r̂xt+1 depends on i.i.d. shocks to wealth. This
completes the first stage in solving for the first-order behaviour of Ĉ − Ĉ ∗ − Q̂/ρ and r̂x .
   Now we impose the condition that, rather than being exogenous, the innovations to
wealth, ξ t+1 , are endogenously determined by excess portfolio returns via the relationship

                                        ξ t+1 = α̃0 r̂xt+1                                 (55)

where the vector of portfolio allocations, α̃, is yet to be determined. This equation,
together with (54), can be solved to yield expressions for ξ t+1 and r̂xt+1 in terms of the
exogenous innovations as follows
                                        ξ t+1 = H̃εt+1                                     (56)
                                                             ¡ 2¢
                                   r̂xt+1 = R̃εt+1 + O                                     (57)

where
                                α̃0 R2
                         H̃ =            ,    R̃ = R1 H̃ + R2                      (58)
                              1 − α̃0 R1
   Equation (57), which shows how realised excess returns depend on the exogenous i.i.d.
innovations of the model, provides one of the relationships necessary to evaluate the left-
                                                                                 ∗
hand side of (37). The other relationship required is the link between Ĉt+1 − Ĉt+1 − Q̂t+1 /ρ
and the vector of exogenous innovations, εt+1 . This relationship can derived in a similar
way to (57). First extract the appropriate rows from (53) to yield the following
                                                               "      #
                      ∗                                           xt      ¡ ¢
            Ĉt+1 − Ĉt+1 − Q̂t+1 /ρ = D1 ξ t+1 + D2 εt+1 + D3          +O 2               (59)
                                                                 st+1

where the matrices D1 , D2 and D3 are formed from the appropriate rows of (53). After
substituting for ξ t+1 using (56) this implies
                                                               "           #
                            ∗                                       xt              ¡ 2¢
                  Ĉt+1 − Ĉt+1 − Q̂t+1 /ρ = D̃εt+1 + D3                       +O          (60)
                                                                    st+1

where
                                       D̃ = D1 H̃ + D2                                     (61)

   Equations (57) and (60) show the first-order accurate behaviour of r̂xt+1 and Ĉt+1 −
  ∗
Ĉt+1 − Q̂t+1 /ρ and they can be used to evaluate the second-order accurate behaviour of

                                               32
the left hand side of equation (37), as follows
                      h                                i            ¡ ¢
                                 ∗
                   Et (Ĉt+1 − Ĉt+1 − Q̂t+1 /ρ)r̂x,t+1 = R̃ΣD̃0 + O 3                                    (62)

where Σ is the covariance matrix of ε.26 The equilibrium value of α̃ satisfies the following
equation
                                                   R̃ΣD̃0 = 0                                             (63)

This matrix equation defines (n − 1) equations in the (n − 1) elements of α̃.
       To solve for α̃ first substitute for R̃ and D̃ in (63) and expand to yield
                                                                                         ¡ 3¢
                    R1 H̃ΣH̃ 0 D10 + R2 ΣH̃ 0 D10 + R1 H̃ΣD20 + R2 ΣD20 = 0 + O                           (64)

Substituting for H̃ and H̃ 0 and multiplying by (1 − α̃0 R1 )2 yields

                  R1 α̃0 R2 ΣR20 α̃D10 + R2 ΣR20 α̃D10 (1 − α̃0 R1 )
                                                                                           ¡ 3¢
                      + R1 α̃0 R2 ΣD20 (1 − α̃0 R1 ) + R2 ΣD20 (1 − α̃0 R1 )2 = 0 + O                     (65)

Note that α̃0 R1 , (1 − α̃0 R1 ) and D1 are all scalars. It therefore follows that α̃0 R1 = R10 α̃
and D10 = D1 . Using these facts (65) simplifies to
                                                                                    ¡ 3¢
                         Λ [D1 R2 ΣR20 α̃ − R2 ΣD20 R10 α̃ + R2 ΣD20 ] = 0 + O                            (66)

where Λ = R1 α̃0 + I(1 − R10 α̃) and I is the identity matrix. In the case where there are
two assets (n = 2) R1 and α̃ are scalars and Λ is equal to unity. In this case equation
(66) can be solved to yield the following expression for the equilibrium α̃

                                                                −1
                             α̃ = [R2 ΣD20 R10 − D1 R2 ΣR20 ]        R2 ΣD20 + O ( )                      (67)

This is also a solution in the case where n > 2. However, while the solution given in
(67) is unique in the n = 2 case, other solutions for α̃ may exist if n > 2. It is a well-
established result that multiple equilibria may exist when markets are incomplete, so it
is not surprising that (66) may have multiple solutions. However, the solution given in
(67) has an obvious claim to be the first focus of analysis, since it always exists and it
corresponds to the unique solution in the two-asset case. Equation (67) is reported as
equation (43) in the main text.
  26
       Notice D3 does not appear in this expression because, by assumption, Et (εt+1 xt ) = Et (εt+1 st+1 ) = 0.


                                                       33
Appendix 2: Solving the example model
Here we present the details for the derivation of the example in Section 3. In order to
derive the solution for α̃ it is necessary to solve for the first-order accurate behaviour of
           ∗
(Ĉt+1 − Ĉt+1 ) and r̂x,t+1 conditional on ξ t . This solution yields the coeﬃcient matrices
D1 , D2 , R1 and R2 .
    First-order approximation of the consumption optimality conditions, the resource con-
straint and the quantity theory equations imply

                                       ∗                         ∗
                                                                                     ¡ 2¢
                       Et+1 [Ĉt+1 − Ĉt+1 ] = (1 − η)(Ĉt+1 − Ĉt+1 )+O                                       (68)
                                                                            ¡ ¢
                  (1 − g)Ĉt + (1 − g)Ĉt∗ + g Ĝt + g Ĝ∗t = Ŷt + Ŷt∗ + O 2             (69)
                                    ¡ ¢                                                ¡ ¢
  M̂t − P̂t = (1 − g)Ĉt + gĜt + O 2             M̂t∗ − P̂t∗ = (1 − g)Ĉt∗ + gĜ∗t + O 2 (70)

    A first-order approximation of the budget constraint for home agents is given by
                              1                                                 ¡ ¢
                      Ŵt =      Ŵt−1 + Ŷt − (1 − g)Ĉt − g Ĝt + α̃0 r̂xt + O 2                             (71)
                              β̄
where α̃ = ᾱ/(β Ȳ ) and ᾱ0 = [ᾱE ] and r̂x0 = [(r̂E − r̂E ∗ )] for the EQ economy and
ᾱ0 = [ᾱB , ᾱB∗ , ᾱE ] and r̂x0 = [(r̂E − r̂E ∗ ), (r̂B − r̂E∗ ), (r̂B∗ − r̂E ∗ )] for the EB economy. The
budget constraint can now be written in the form
                               1                                            ¡ ¢
                       Ŵt =      Ŵt−1 + Ŷt − (1 − g)Ĉt − g Ĝt + ξ t + O 2                                 (72)
                               β̄
where ξ t is treated as an exogenous i.i.d. random variable.
    First-order approximations for asset returns satisfy
                                              ¡ 2¢                          ∗
                                                                                                ¡ 2¢
             r̂E,t+1 = Ŷt+1 − ẐE,t + O                    r̂E ∗ ,t+1 = Ŷt+1 − ẐE ∗ ,t + O
                                              ¡ 2¢                          ∗
                                                                                                  ¡ 2¢
           r̂B,t+1 = −P̂t+1 − ẐB,t + O                     r̂B∗ ,t+1 = −P̂t+1 − ẐB∗ ,t + O

while asset prices are given by
                                              ¡ 2¢                            ∗
                                                                                                            ¡ 2¢
    ẐE,t = Et [Ŷt+1 ] − Et [r̂E,t+1 ] + O                 ẐE ∗ ,t = Et [Ŷt+1 ] − Et [r̂E ∗ ,t+1 ] + O
                                              ¡ 2¢                            ∗
                                                                                                              ¡ 2¢
  ẐB,t = −Et [P̂t+1 ] − Et [r̂B,t+1 ] + O                  ẐB∗ ,t = −Et [P̂t+1 ] − Et [r̂B∗ ,t+1 ] + O

Note also that, up to a first-order approximation, the following holds

                        Et [r̂E,t+1 ] = Et [r̂E ∗ ,t+1 ] = Et [r̂B,t+1 ] = Et [r̂B∗ ,t+1 ]

                                                       34
   The above equations can be solved to yield expressions for the first-order behaviour
              ∗                                               ∗
of (Ĉt+1 − Ĉt+1 ) and r̂x,t+1 . The solution for (Ĉt+1 − Ĉt+1 ) implies that, for both the EQ
and EB economies, D1 and D2 are given by
            ∙                  ¸       h                                                i
              2[1 − β̄(1 − η)]            ∆       ∆      ∆g                ∆g
       D1 =                      , D2 = (1−g) − (1−g) − (1−g)             (1−g)
                                                                                  0 0
                   1−g
where ∆ = [1 − β̄(1 − η)]/(1 − β̄ψ). The solution for r̂x,t+1 implies that R1 and R2 for EQ
economy are given by
                                              h                      i
                          R1 = [0] ,   R2 =       1 −1 0 0 0 0

while for EB economy R1 and R2 are given by
           ⎡                 ⎤         ⎡                                                    ⎤
                    0                       1 −1  0   0 0  0
           ⎢                 ⎥         ⎢                                                    ⎥
     R1 = ⎢                  ⎥         ⎢
           ⎣ 1 − β(1 − η) ⎦ , R2 = ⎣ 1 − Θ Θ − 1 gΘ −gΘ −1 0
                                                                                            ⎥
                                                                                            ⎦
             −[1 − β(1 − η)]               Θ  −Θ −gΘ gΘ 0 −1

where Θ = (1/2)β̄(1 − ψ − η)/(1 − β̄ψ).


References
 [1] Baxter, M and U Jermann (1997) “The International Diversification Puzzle is Worse
     than you Think” American Economic Review, 87, 170-180.

 [2] Benigno, G and P Benigno (2003) “Price Stability in Open Economies” Review of
     Economics Studies, 70, 743-764.

 [3] Campbell, J and L Viceira (2002) Strategic Asset Allocation Oxford, Oxford Univer-
     sity Press.

 [4] Corsetti, G and P Pesenti (2005) “International Dimensions of Optimal Monetary
     Policy” Journal of Monetary Economics, 52, 281-305.

 [5] Coeurdacier, N (2008) “Do trade costs in goods market lead to home bias in equi-
     ties?”, unpublished manuscript, London Business School.

 [6] Coeurdacier, N, R Kollmann and P Martin (2008) “International Portfolios, Capi-
     tal Accumulation and Foreign Assets Dynamics”, unpublished manuscript, London
     Business School.

                                               35
 [7] Devereux, M and C Engel (2003) “Monetary Policy in an Open Economy Revisited:
    Price Setting and Exchange Rate Flexibility” Review of Economic Studies, 70,765-
    783.

 [8] Devereux, M and M Saito (2005) “A Portfolio Theory of International Capital Flows”
    unpublished manuscript, UBC.

 [9] Devereux, M and A Sutherland (2007) “Country Portfolio Dynamics” CEPR Discus-
    sion Paper No 6208.

[10] Devereux, M and A Sutherland (2008) “A Portfolio Model of Capital Flows to Emerg-
    ing Markets” forthcoming in the Journal of Development Economics.

[11] Engel, C and A Matsumoto (2005) “Portfolio Choice in a Monetary Open-Economy
    DSGE Model” unpublished manuscript, University of Wisconsin and IMF.

[12] Evans, M and V Hnatkovska (2005) “International Capital Flows, Returns and World
    Financial Integration” NBER Working Paper 11701.

[13] Ghironi, F, J Lee and A Rebucci (2005) “The Valuation Channel of External Ad-
    justment” unpublished manuscript, Boston College.

[14] Gourinchas, P and H Rey (2005) “International Financial Adjustment” NBER Work-
    ing Paper no. 11155.

[15] Heathcote, J and F Perri (2004) “The International Diversification Puzzle is Not as
    Bad as You Think” unpublished manuscript, Georgetown University and New York
    University.

[16] Judd, K L (1998) Numerical Methods in Economics Cambridge: MIT Press.

[17] Judd, K L and S-M Guu (2001) “Asymptotic Methods for Asset Market Equilibrium
    Analysis” Economic Theory, 18, 127-157.

[18] Judd, K L, F Kubler and K Schmedders (2002) “A Solution Method for Incom-
    plete Asset Markets with Heterogeneous Agents” unpublished manuscript, Stanford
    University.



                                          36
[19] Kollmann, R (2006) “International Portfolio Equilibrium and the Current Account”
    unpublished manuscript, University of Paris XII.

[20] Lane, P, and G M Milesi-Ferretti (2001) “The External Wealth of Nations: Measures
    of Foreign Assets and Liabilities for Industrial and Developing Countries” Journal of
    International Economics 55, 263-94.

[21] Lane, P, and G M Milesi-Ferretti (2006) “The External Wealth of Nations Mark II”
    IMF Working Paper no 06-69.

[22] Obstfeld, M and K Rogoﬀ (1995) “Exchange Dynamics Redux” Journal of Political
    Economy, 103, 624-660.

[23] Obstfeld, M and K Rogoﬀ (2000) “The Six Major Puzzles in International Macroe-
    conomics: Is there a Common Cause” NBER Macroeconomics Annual, 15, 339-390.

[24] Samuelson, P A (1970) “The Fundamental Approximation Theorem of Portfolio
    Analysis in terms of Means, Variances and Higher Moments” Review of Economic
    Studies, 37, 537-542.

[25] Schmitt-Grohe, S. and M. Uribe (2003) “Closing Small Open Economy Models”,
    Journal of International Economics, 59, 137-59.

[26] Tille, C (2003) “The Impact of Exchange Rate Movements on U.S. Foreign Debt”
    Current Issues in Economics and Finance 9, 1-7.

[27] Tille, C (2004) “Financial Integration and the Wealth Eﬀect of Exchange Rate Fluc-
    tuations” unpublished manuscript, Federal Reserve Bank of New York.

[28] Tille, C and E van Wincoop (2007) “International Capital Flows”, NBER Working
    Paper No 12856.




                                          37
