                               NBER WORKING PAPER SERIES




     BEHAVIORAL MACROECONOMICS VIA SPARSE DYNAMIC PROGRAMMING

                                           Xavier Gabaix

                                       Working Paper 21848
                               http://www.nber.org/papers/w21848


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     January 2016




I thank David Laibson for a great many enlightening conversations about behavioral economics. For
useful comments I also thank Adrien Auclert, Robert Barro, John Campbell, Emmanuel Farhi, Mark
Gertler, David Hirshleifer, Bentley MacLeod, Matteo Maggiori, Jonathan Parker, Michael Rockinger,
Thomas Sargent, Josh Schwarzstein, Andrei Shleifer, Bruno Strulovici, Richard Thaler, Jessica Wachter,
Michael Woodford, seminar participants at various seminars and conferences, and my discussants:
Andrew Abel, Nick Barberis, Harrison Hong, Jennifer La'O, Ali Lazrak, Ricardo Reis, Alp Simsek,
Alexis Toda. I thank Wu Di, Chenxi Wang and Jerome Williams for very good research assistance.
I am grateful to the Dauphine-CAM foundation, the Institute for New Economic Thinking, and the
NSF (SES-1325181) for financial support. The views expressed herein are those of the author and
do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2016 by Xavier Gabaix. All rights reserved. Short sections of text, not to exceed two paragraphs,
may be quoted without explicit permission provided that full credit, including © notice, is given to
the source.
Behavioral Macroeconomics Via Sparse Dynamic Programming
Xavier Gabaix
NBER Working Paper No. 21848
January 2016
JEL No. D03,E03,E21,E6,G02,G11

                                             ABSTRACT

This paper proposes a tractable way to model boundedly rational dynamic programming. The agent
uses an endogenously simplified, or "sparse," model of the world and the consequences of his actions
and acts according to a behavioral Bellman equation. The framework yields a behavioral version of
some of the canonical models in macroeconomics and finance. In the life-cycle model, the agent initially
does not pay much attention to retirement and undersaves; late in life, he progressively saves more,
generating realistic dynamics. In the consumption-savings model, the consumer decides to pay little
or no attention to the interest rate and more attention to his income. Ricardian equivalence and the
Lucas critique partially fail because the consumer may not pay full attention to taxes and policy changes.
In a Merton-style dynamic portfolio choice problem, the agent endogenously pays limited or no attention
to the varying equity premium and hedging demand terms. Finally, in the neoclassical growth model,
agents act on a simplified model of the macroeconomy; in equilibrium, fluctuations are larger and
more persistent.


Xavier Gabaix
New York University
Finance Department
Stern School of Business
44 West 4th Street, 9th floor
New York, NY 10012
and NBER
xgabaix@stern.nyu.edu




A online appendix is available at http://www.nber.org/data-appendix/w21848
1     Introduction
In economics, we build a simplified model of the world — we select “important” dimensions of the
world, and know that the model is not literally the true world. However, we assume that agents in
our model are not like us: that they comprehend the full complexity of their world. This asymmetry
is of course a bit odd. In contrast, in the present paper, agents behave like us economists: they
build a simplified model of the (model) world they live in, and use it to act.
    This paper shows a tractable way to model such behavioral agents, in a fairly general class of
dynamic problems. Those agents tend to be more realistic than rational agents, and their bounded
rationality has important policy consequences.
    I show how the framework applies to some of the canonical models in macro-finance, in partial
and general equilibrium: consumption-saving problems, the baseline neoclassical growth model (the
Cass-Koopmans model), general linear-quadratic problems, and dynamic investment in risky assets
(Merton’s problem). The upshot is that we have a portable, fairly general structure that applies
to some core machines of macroeconomics and allows to see where bounded rationality (BR) is
important in those situations.
    One of the persistent criticisms of traditional economics is the unrealism of the infinitely forward-
looking agent who computes the whole equilibrium in her own head. This lack of realism has
long been suspected to be the cause of some counterfactual predictions that we will review below.
Behavioral economics aims to provide an alternative. The greatest successes of behavioral economics
in the literature so far change the agents’ tastes (e.g. prospect theory or hyperbolic discounting)
or their beliefs (e.g. overconfidence), while keeping the assumption of rationality. When tackling
the rationality assumption, there is much less agreement, and the modelling of bounded rationally
is much more piecemeal, diﬀerent from one situation to the next.
    This paper proposes a compromise that keeps much of the generality of the rational approach
and injects some of the wisdom of the behavioral approach, mostly inattention and simplification.
It does so by proposing a way to insert some bounded rationality into a large class of problems, the
“recursive” contexts, i.e. with dynamic programming around a dynamic steady state.
    To illustrate these ideas, let us consider a canonical consumption-savings problem. The agent
maximizes utility from consumption, subject to a budget constraint, with a stochastic interest rate
and stochastic income. In the rational model, the agent solves a complex DP problem with three
state variables (wealth, income and the interest rate). This is a complex problem that requires a
computer to solve.
    How will a boundedly rational agent behave? I assume that the agent starts with a much simpler
model, where the interest rate and income are constant — this is the agent’s “default” model. Only
one state variable remains, his wealth. He knows what to do then (consume a certain fraction of
his wealth, and permanent income), but what will he do in a more complex environment, with
stochastic interest rate and stochastic income? In the sparse version, he considers parsimonious


                                                   2
enrichments to the value function, as in a Taylor expansion. He asks, for each component, whether
it will matter enough for his decision. If a given feature (say, the interest rate) is small enough
compared to some threshold (taken to be a fraction of standard deviation of consumption), then he
drops the feature or partially attenuates it. The result is a consumption policy that pays partial
attention to income and possibly no attention at all to the interest rate. This seems realistic.1
    The result is a sparse version of the traditional permanent-income model. We see that it is
often simpler than the traditional model. Indeed, the agent typically ends up using a rule which is
simpler (e.g., not paying attention to the interest rate).
    I also present a behavioral version of a large class of models and work out, in detail, a BR version
of most canonical of them, the neoclassical growth model of Cass-Koopmans. In this version, agents
pay of lot of attention to their own variables, less to aggregate variables. One upshot is that with
BR, macroeconomic fluctuations are larger and more persistent. I illustrate this proposition, and
qualify it, as it appears to hold for most reasonable values of the parameters, but can be overturned
for extreme values. To understand the simple idea, imagine first an economy with only one state
variable, capital. It starts with a steady state amount of capital. Then, there is a positive shock to
the endowment of capital. In a rational economy, agents would consume a certain fraction of it, say
6%, every period. That will lead the capital stock to revert quickly to its mean. However, in a an
economy with sparse agents, investors will not pay full attention to the additional capital. They
will consume less of it than a rational agent would. Hence, capital will be depleted more slowly and
will mean-revert more slowly. The shock has more persistent eﬀects. Given that shocks are more
persistent, past shocks accumulate more. Mechanically, this leads to larger average deviations of
capital from its trend. As a consequence, the interest rate and GDP also have larger, and more
persistent, deviations from trend.
    The model allows us to express those ideas in simple, quantitative ways. It also allows us to
explore them in rich environments.
    Here are some conclusions for individual decision-making in macroeconomic contexts:2

   1. Agents react more to near, rather than future, shocks. For instance, the (finitely lived)
      consumer has a higher marginal propensity to consume for current and near payments, rather
      than distant payments.

   2. The Euler equation fails (under the objective model of the world). However, it holds under
      the agent’s subjective, sparse model.

   3. Agents start saving “too late” for retirement, and expenditure falls in the years before retire-
      ment (as the agent scrambles to save more for retirement).
  1
     In the language of Kahneman (2011, Chapter 8), the agent “substitutes” a complex problem by a simpler one —
decision-making in a simplified world.
   2
     The rest of the paper will give references about those stylized facts.



                                                       3
   4. Agents accumulate a too small buﬀer of savings, as they are (partially) inattentive to the risk
      of income fluctuations.

   5. Agents do not react much or at all to the interest rate, at least when small purchases are
      concerned. However, they tolerate a non-smooth consumption profiles. Note that in the
      rational model, the first fact would require a low IES (intertemporal elasticity of substitution),
      while the second fact would require a high IES.

   6. The agent doesn’t need to the whole actual macro equilibrium in his head before acting; he just
      uses a simplified model of the world, leading to simple policies, e.g. partially forward-looking
      consumption functions.

   7. When choosing their portfolio, agents pay less attention to the hedging demand motive.

       Here are some conclusions for aggregate macroeconomics:

   8. Fiscal policy is more powerful because Ricardian equivalence partly fails. If the government
      gives a dollar today and takes it back later (plus interest), consumption today increases —
      though it should not react in the simplest rational model.3

   9. The Lucas critique has less, or zero, bite. When policy changes are small and temporary,
      sparse agents’ policy functions do not change, or change little.

 10. GDP fluctuations are amplified and more persistent in the most basic DSGE model (compared
     to the rational benchmark).

 11. This perspective revives the “old Keynesian” agent. The agent here looks like a hybrid between
     a neoclassical agent and an old Keynesian agent4 , in the sense that he’s myopic and adopts
     simple decision rules. However, unlike the truly old Keynesian agent, those decision rules are
     microfounded–as policies that are optimal under a simplified model of the world. Unlike
     the neoclassical and New Keynesian agent, this sparse agent is partially myopic and does not
     react to all things.

    Those substantive conclusions are, I hope, of some interest. Still, the main contribution of this
paper is its methodology. It develops a procedure that allows an economist to continuously transform
a rational agent into a boundedly rational one. This leads to further substantive conclusions about
the impact of bounded rationality on economic life, such as the ones above.
    This paper is indebted to a series of ideas in behavioral modelling in micro and macro contexts.
This literature will be discussed in Section 8, after the model is clear to the reader. The rest of the
   3
     In Gabaix (2015), I also find that monetary policy, especially forward guidance, is less powerful. I do so in
writing a behavioral version of the New Keynesian model, applying the techniques of the present paper.
   4
     The canonical New Keynesian agent is basically the neoclassical agent, in a wolrd of sticky prices. He’s fully
rational.

                                                        4
paper is as follows. Section 2 gives an elementary, but substantive, example — a behavioral version
the life cycle model. Section 3 presents the general procedure. Then, we apply it to a variety of
canonical examples. Section 4 presents basic partial-equilibrium building blocks with behavioral
agents: the basic consumption-savings problem, including variants such as the failure of Ricardian
equivalence. Section 5 works out the baseline neoclassical growth model. Section 6 develops other
models. Section 7 proposes discusses variants, and frequently asked questions. Section 8 contains
the literature review. Section 9 concludes. The appendix and online appendix contain further proofs
and extensions.
   Notations. I will use superscript  for the traditional or rational model,  for the default model,
sometimes  for the sparse or behavioral model. I will call  ¯  := (  )=1 the component-wise
product.


2       Behavioral Life-Cycle Model: A Gentle Introduction
As a simple introduction, I give a behavioral version of the most basic life-cycle model (Modigliani
and Brumberg (1954)).5 The agent works for the first  periods of his life, then retires, and dies at
period  . His utility is
                                             X
                                              −1
                                                   ( ) 
                                                   =0

The interest rate and the subjective discount rate are both 0. He receives income  = ̄ when
working ( ∈ [0 )), and  = ̄ + b when retired ( ∈ [  )). Here b  0 captures the income loss
during retirement. Income corresponds to the dotted line in Figure 1. Financial wealth  evolves
as +1 =  +  −  , and the terminal condition is  = 0.
                                                                                            P −1
    Let us first analyze a rational agent. At time 0, his resources are Ω0 := 0 +  =0           =
0 +  ̄ + , where
                                              := ( − ) b
                                                                                        P −1
is the total income loss due to retirement. His consumption problem is max( )0≤ =0      ( ) s.t.
P −1                   0      00                                                                  Ω0
   =0  = Ω0 , with   0   0. So he consumes a constant amount at all periods:  =  =
0 +
  
      + ̄. In particular:
                                                 0 + 
                                           0 =         + ̄.
                                                   
    The same reasoning holds starting at a date  ≤ . Then, there are only  − periods remaining,
so the policy becomes:
                                                  + 
                                             =        + ̄                                          (1)
                                                   −
That policy guarantees a constant consumption  = 0 over his lifetime.
    5
    It is a bit unusual to start a framework with an example, but this example will useful to illustrate modelling
choices.


                                                         5
                                      Consumption                                                    Wealth
                                                                               250
                100


                                                                               200
                95

                                                                               150




                                                                          wt
           ct



                90
                                                                               100
                             Fully Rational
                85           Moderately Behavioral
                             Very Behavioral
                                                                               50


                80                                                              0

                        10       20           30     40   50       60                    10    20      30      40      50    60
                                               t                                                        t

Figure 1: Consumption and wealth of behavioral life-cycle agents. Notes. Income is plotted in the
dotted line — it is also the very behavioral agent’s consumption. The agent starts life at time 0,
receives income ̄ = 100 while working (until period 40), and receives ̄ + ̂ = 80 in retirement
(period 40 to 60). The solid line represents a fully rational agent (i.e. ̄ = 0), the dashed line
a moderately behavioral agent (0  ̄  ̄∗ , for a finite ̄∗ = |̂|), and the dotted line a very
behavioral agent (̄ ≥ ̄∗ ), who just consumes current income. The moderately behavioral agent
does not save for retirement at first, but starts saving before retirement. The right panel plots the
wealth accumulated by the agent.

   There is a dynamic programming formulation that will be useful in the behavioral model. At
time , the remaining lifetime utility is ( − )  ( ). So, the value function is (for  ≤ )
                                                                    µ                ¶
                                                                 + 
                                        (   ) = ( − )         + ̄                                          (2)
                                                                  −

where superscript  denotes the rational agent. This rational agent (1) satisfies the Bellman equa-
tion:6  = arg max  (    ), where we define:

                                  (    ) :=  () +   ( + ̄ −    + 1)                              (3)

   Let us now consider the behavioral agent. I want to capture the idea that he does not fully
perceive income loss associated with retirement. The systematic procedure will be justified and
explained in the body of this paper, but here I just show how it applies in this case. The behavioral
agent will consumes:
                                     = arg max  (     )                              (4)
                                                          

where  ∈ [0 1] denotes an (endogenous) attention to future retirement. If  = 1, the agent is
   6
     Here I use the basic sparse max of Definition 3.4, where the agent uses a simplified model of his own future actions.
If the agent has a “sophisticated” understanding of this future actions (as in    ¡ the
                                                                                     ¢ iterated procedure developed in
Definition 3.8, the decision would be the same to the first order, i.e. up to  2 terms (see Section 3.5).

                                                               6
fully rational. However, if  = 0, the agent doesn’t see retirement at all: he behaves as if there
was no income loss from retirement in the future. The general model allows for partial attention
 . Given  , the solution of (4) is:7

                                                               +  
                                                       =              + ̄                                                              (5)
                                                                −

    In the full model developed soon, attention  will come from the costs and benefits of attention,
and will be expressed as follows. Calling  ( ) = +  −
                                                              
                                                                  + ̄, we define  =  (0) = −
                                                                                                   
                                                                                                      + ̄, the
“default” policy that corresponds to no attention to retirement; 0 (0) =  − the marginal impact of
                  
                         ¡               ¢ ¡       1
                                                       ¢ 00 ¡  ¢
attention; and   =      0  = 1 +  −−1    the curvature of the objective function.
The general procedure will give the attention at time  to the income loss during retirement:
                                                               Ã                  !
                                                                      0
                                                                   −  (0)2
                                                    = A                                                                                 (6)
                                                                       

for an attention function A with values in [0 1] and a cost of cognition  discussed soon. A little
more calculation gives the value of attention as follows.

Proposition 2.1 (Lifecycle model, behavioral version) In the behavioral life-cycle model, the opti-
mal consumption policy is, before retirement (  ),

                                                               +  
                                                       =              + ̄.
                                                                −
                                  µ                       ¶
                                           −00 ( )                                                         
with an attention  = A               ( −−1)( −)
                                                           , and after retirement ( ≥ ),  =                −
                                                                                                                     + ̄ + ̂. Hence,
when   0, consumption weakly falls over time, and discretely falls at retirement. After retirement,
consumption is constant.
                                                                                           ³         ´
                                                                                                 1
   I next present a numerical illustration. I use the attention function A () = max 1 − ||       0
                                                                ¯ ¡ ¢¯
from (15). I assume the following scaling of the cost:  = ̄2 ¯00  ¯ with  =  + ̄. This is                −
largely for convenience, and it corresponds to a constant cost when utility is linear-quadratic. This
simplifies the expressions without changing the economics much. Then (using continuous time to
                                                                          ¯    ¯
make expressions neat), the agent thinks about retirement as soon as ¯  − ¯ ≥ ̄, i.e. at a time
          ¡       ¡        ¢¢
 = max 0 min   + ̄ . Solving for wealth, the value of consumption is (when  ∈ (0 );
                                                                          ³                         ´
  7                                                                            +̄− +                        +̄− + 
      Proof: the first order condition of (4) is: 0 ( ) =  = 0              −−1        + ̄ , i.e.  =        −−1        + ̄, i.e.
        + 
 =      −     + ̄.




                                                                   7
Section 14 in the appendix describes the whole solution, including in discrete time):
                                          ⎧
                                          ⎪
                                          ⎪ 0
                                                                     for   
                                          ⎨  + ̄
                                          ⎪
                                            0           2
                                    =        + ̄ + 2̄ ( − ) for  ≤   
                                          ⎪
                                          ⎪
                                            
                                          ⎪
                                          ⎩  + ̄ + ̂
                                             −
                                                                   for  ≥ 

              ¡      ¢        2
where  = 1 −  0 − ̄ ( − )2 .
    Figure 1 plots the resulting consumption and wealth (0 = 0, ̄ = 100) for diﬀerent levels of the
cost of rationality . The solid line represents a fully rational agent (i.e. ̄ = 0): he fully smooths
consumption. The dotted line shows a very behavioral agent, who simply consumes current income
(̄ ≥ ̄∗ := ||
               −
                  = |̂|). The dashed line shows a moderately boundedly rational agent (0  ̄  ̄∗ ).
At first, he does not save for retirement, but he does start saving at some point before retirement.
At retirement, his consumption drops as he fully realizes that his income has fallen. This illustrates
the smooth, partial myopia of this agent.
    This paper is mostly theoretical, but it is worth asking the following question.
    Is it indeed the case that people tend to save “too late” for retirement? The issue is still contro-
versial, but let us consider three salient facts.

   1. Expenditure declines after the age of 45 (Aguiar and Hurst 2013, Figure 1, for expenditures
      without housing services) — much like the behavioral agent of Figure 1.

   2. There is a fall in expenditure when income predictably falls, again like in Figure 1:

        (a) at retirement (Bernheim, Skinner and Weinberg 2001).8
        (b) at the (predictable) expiration of unemployment benefits (Ganong and Noel 2015).

   3. People say that they plan for retirement late in their working life, or not at all. For in-
      stance, 23% of the 18-29 year old say that have “figured out how much they need to save for
      retirement”, while 51% of the 45-59 year old say they have done so (Lusardi 2011).9

   Facts 1-3 arise naturally from the behavior as described in Figure 1. For Fact 3, if agents indeed
have a  too large, they don’t plan for retirement at all, even right before it.
   Facts 1-3 are each inconsistent with the plainest rational model.
   8
     In addition, Bernheim, Skinner and Weinberg (2001, Fig. 4) find that the drop is more pronounced for individuals
with low wealth. This is what the present model predicts: controlling for lifetime incomes, agents with higher bounded
rationality (higher ) accumulate fewer assets and have a bigger drop in consumption at retirement. See also Kueng
(2015).
   9
     More indirectly, a whole literature on retirement plans supports the notion of inert decision-making for retirement.
For instance, Beshears et al. (2015) find that the potency of framing and defaults is reduced as people approach
retirement, consistent with the notion they think more carefully about retirement as they are near it.



                                                             8
   Facts 1-2a can be made consistent with an enriched rational model. Fact 1 can be explained
by introducing credit constraints and income risk (Gourinchas and Parker 2002). Facts 1 and 2a
can be explained by observing that retired consumers buy more eﬃciently or buy fewer non-work
goods (Aguiar and Hurst 2013). Fact 2b is harder to reconcile with fully forward-looking models,
though qualitatively consistent with Figure 1. Fact 3 is not consistent with a rational model, but
one could dismiss it by stating that agents’ reports of what they think about are meaningless — a
point of view I do not share. 10
   Though these facts are not dispositive, they form, I submit, reasonable presumptive evidence for
the idea that people are not fully far-sighted, even for retirement savings. The present framework
could help write enriched empirical models allowing for both traditional factors and myopia, where
the above-mentioned evidence could be systematically assessed.
   This example illustrates the behavior and mechanics of the sparse agent. I now move on to a
systematic formulation of that agent, which applies to much more general problems.


3      General Framework
3.1     The Sparse Max for Static Problems: Quick Review
To think about bounded rationality, the tractable dynamic framework laid out here is possible
because it rests on a tractable static framework I laid out in previous work (Gabaix (2014)). I
review it in this subsection. There, the core is a sparse max or smax operator, which is a generalized,
behavioral version of the traditional max operator of maximization under constraints.
    Let us review the sparse max when there is no budget constraint. The agent faces a maximization
problem which is, in its rational version, max  ( ), where  is an action and  a state variable.11
There is an attention vector, , and an attention-dependent extension of the utility function,
 (  ). For instance, we will typically take

                                       (  ) :=  ( 1 1     )                                  (7)

to be the perceived utility function when the consumer is partially inattentive to  . When  = 1,
the agent fully perceives dimension ; when  = 0 , the agent is fully inattentive to it. Attention
generates an action,  ( ) := arg max  (  ). There is a default attention vector  , taken
                                                                       ¡        ¢                 
to be 0 in most applications, and a default action  := arg max     . I call  =       
                                                                                                      ,
  10
     Note that a simple hyperbolic agent (Laibson 1997, O’Donoghue and Rabin 2001) would not behave this way.
That agent has full foresight of future income flows, and sees equally perfectly pre- and post-retirement income. For
                                                 ++( −−1)̄
instance, the policy of the log agent is  = 1+( −−1) . However, with uncertainty and credit constraints, the
hyperbolic agent can look closer to the one with the above behavior (Harris and Laibson 2001), though with much
complexity and not because of limited foresight about future income.
  11
     This utility may be a value function, as in (3).



                                                         9
                      ¡      ¢
evaluated at ( ) =    , the normative impact on the action of a change in attention. Hence,
         −1
 = −   . When (7) holds,  =  ( )|=(11)=0  .
   There is a nonnegative parameter , which is a cognition cost — formally, a taste for sparsity.
When  = 0, the agent is the traditional agent.12 The  are viewed by the agent as being drawn
from a distribution with standard deviation  .

Definition 3.1 (Sparse max operator, without a budget constraint) The sparse max, smax;|  (  ),
is defined by the following procedure.
    Step 1: Choose the attention vector ∗ :
                                                  X1                     ¡        ¢
                            ∗ = arg min           [ Λ (1 −  )2 +   −  ]                                  (8)
                                        ∈[01]
                                                  
                                                     2

with the cost-of-inattention factors Λ := −E [   ], 0  0.
   Step 2: Choose the action
                                       = arg max  (  ∗ )                                                      (9)
                                                          

and set the resulting utility to be  =  (  ). In the expressions above, derivatives are evaluated
                                  ¡        ¢
at  =  and  = arg max     .

   In other terms, the agent solves for the optimal ∗ that trades oﬀ a proxy for the utility losses
(the first term in the right-hand side of equation (8)) and a psychological penalty for deviations
from a sparse model (the second term on the right-hand side of equation (8)).13 Then, the agent
maximizes over the action , as if ∗ were the true model. The problem is solved by backward
induction.
   This leads to define the attention function:14
                                                      1
                                  A () := arg min { || (1 − )2 +  ()}
                                              ∈[01] 2


This represents the optimal attention to a variable with variance ||, normalizing other factors to
1. Figure 2 plots typical shapes.
   Then, the value of attention to dimension  is given by the key relation:

                                           ∗ = A (−E [   ] )                                          (10)

This formula gives a simple “plug and play” solution for the (potentially very complex) attention
problem: to allocate attention to dimension , just use (10). There is no need to come back (except
  12
      This is true unless the matrix Λ of Definition 3.1 is singular — in that case, the iterated sparse max of Definition
15.1 helps.                                   P                                              £           ¤
   13
      In Gabaix (2014), I sum over all terms  (1 −  ) Λ (1 −  ), with Λ := −E    . Here, I stream-
line the procedure, and let the agent consider only the diagonal terms. This is inessential, but is simpler.
   14
      Also, if there are more than one optimum ’s, we take the largest one.


                                                           10
for generalizations) to the background problem (8). The following Lemma derives a typical case.

Lemma 3.2 (Basic simple case for static smax) In the case  (  ) =  ( 1 1     ), the
smax operator yields:
                                          ¡                 ¢
                                 ∗ = A −2                                           (11)

and
                                    = arg max  ( ∗1 1   ∗  )
                                               
                     −1
with  = 
                = −    ·  . In the expressions above, derivatives are evaluated at  = 0 and
 = arg max  ( 0).

    The intuition is that the  ’s are truncated. If | | is small enough, so that  shouldn’t matter
much anyway, then ∗ = 0, and the agent doesn’t pay attention to  (if  = 0).
    This leads to the defining the truncation function, with  the coeﬃcient on the state variable 
in a linear policy function:                              µ 2¶
                                                              
                                            ( ) := A                                            (12)
                                                             2
     It is the coeﬃcient , times the attention to the coeﬃcient, divided by the scaled cognition cost
.
     The following lemma gives a more explicit version of the action.

Lemma 3.3 If the rational action is:
                                                       X             ¡     ¢
                                    () =  +              +  kk2
                                                        


then the sparse action is
                                          X µ  ¶          ¡     ¢
                               
                               () =  +
                                                   +  kk2                                   (13)
                                          
                                                   

with  := ( | |)12 .

   When attention is chosen after seeing  (“ex post”), we use the same expressions, with  := | |.
For instance, the ex-post action becomes:
                                                X                         ¡     ¢
                                () =  +            (    ) +  kk2                     (14)
                                                   


    In the “ex ante” procedure, the slope is chosen before seeing  . Hence, the policy is still linear
in  , which makes that procedure useful in macro. In the “ex post” procedure, the truncation is
chosen after seeing the  , and the policy is non-linear in  .


                                                        11
A0 (σ 2 )                                      A1 (σ 2 )                                  A2 (σ 2 )

 1                                               1                                         1




                                     σ2                                             σ2                                         σ2
     0    1   2   3    4   5    6                    0   1   2      3   4   5   6              0   1    2   3   4   5   6
Figure 2: Three attention functions A0  A1  A2 , corresponding to fixed cost, linear cost and quadratic
cost respectively. We see that A0 and A1 induce sparsity — i.e. a range where attention is exactly
0. A1 and A2 induce a continuous reaction function. A1 alone induces sparsity and continuity.


   Attention and Truncation Functions. Here are some good truncation functions. In Gabaix
(2014), I study attention functions A ( 2 ) corresponding to  () =  10 . For instance, for the
values  = 0 1 2, we have:
                                                         µ         ¶
                    ¡ ¢                          ¡ 2¢         1                            ¡ ¢           2
                  A0  2 = 12 ≥2             A1  = max 1 − 2  0                     A2  2 =                       (15)
                                                                                                      2 + 2

       The truncation functions  ( ) is then (using (12)):15
                                                                 µ         ¶
                                                                     2                                    3
              0 ( ) =  · 12 ≥22         1 ( ) =  max 1 − 2  0              2 ( ) =                   (16)
                                                                                                       2 + 2

       Figure 2 plots the attention functions, and Figure 3 the corresponding truncation functions.


3.2         Dynamic Programming: A Motivating Example
To motivate the general structure, let us start with a basic example, the consumption-savings
                                P
problem. The agent has utility E ∞       1−
                                   =0      (1 − ). Wealth  , and the state variables evolve
as:

                                          +1 = (1 +  + b ) ( −  ) +  + b                                   (17)
                                           b+1 =  b + +1                                                       (18)
                                           b+1 =  b + +1                                                       (19)
                                                                                           ¡ ¢         ³          ´
  15                                                                                                         1
     Another useful cost function is 1 () = − ln (1 − ), which generates A1  2 = max 1 − ||              0 , and
1 ( ) =  () max (|| − ||  0). The subscript 1 denotes that it often arises when doing an 1 regularization,
as in the sparsity literature in statistics (Tibshirani 1996, Candès and Tao 2006).




                                                                 12
              τ0 (b, κ)                                  τ1 (b, κ)                                 τ2 (b, κ)
               4                                          4                                         4
               3                                          3                                         3
               2                                          2                                         2
               1                                          1                                         1
                                      b                                              b                                     b
−4 −3 −2 −1           1   2   3   4       −4 −3 −2 −1             1      2   3   4       −4 −3 −2 −1       1   2   3   4
          −1                                        −1                                             −1
             −2                                         −2                                        −2
             −3                                         −3                                        −3
             −4                                         −4                                        −4

Figure 3: Three truncation functions. Because it gives sparsity and continuity, the 1 function is
recommended.


That is, wealth at  + 1 is savings at ,  −  , invested at rate  =  + b , plus current income,
 =  + b . Here, b and b are deviations of the interest rate and income from their means,
respectively, and follow AR(1) processes, where +1 and +1 are disturbances with mean zero and
no correlation across periods. For simplicity, assume here that  = 1, where  := 1 + .
   This is a complex problem, with 3 state variables

                                                := (  ̂  ̂ )

This is also a metaphor for a more complex model, which could have 30 or 300 state variables.16
What will the agent do at time 0?
    One thing I wish to capture is “the agent may not want to think about the interest rate”. The
reader can introspect: when most people plan their vacation, do they think “now interest rates are
high, so it’s a makes good sense to spend little this summer, and more next summer; this way we’ll
respect our Euler equation, and will make sure that our consumption growth is high, in congruence
with the current high interest rate?” Most people, and the reader, I imagine, do not do that (by
the way, econometric evidence confirms that they don’t, see e.g. Hall 1988). Non-economists would
find that depiction of them ludicrous. Accordingly, the sparse agent will be allowed not to think
about the interest rate – though he will think about it, say when buying a house, or when interest
rates are very volatile.
    Second, “the agent may wish to imagine simplified dynamics for the process”, e.g. he may
replace the dynamics of this income, for instance, by a simpler process, e.g. imagine it will be
roughly constant — without paying attention to the detailed stochasticity of the income process.
    Before showing the equations, I propose an intuitive picture of what the agent’s world view is. I
  16
    This paper could for instance help model simplified decision-marking in networks, where the state state has a
very high dimensional (Caballero and Simsek 2013, Bigio and La’O 2015).



                                                        13
posit that the agent knows what to do in a simpler, default model. That is, he assumes that future
interest rate and income will be constant. Then, the optimal consumption is

                                                              + 
                                                 ( ) =                                                   (20)
                                                               
                                         
                                             ¡  + ¢1−
and the value function is   ( ) = (1−)     
                                                           . Then, the agent decides whether to enrich his
very model where everything is constant. He asks “is it worth thinking about the interest rate?”
To do so, he contemplates a one-variable enrichment, with the interest rate, and sees whether it’s
worth it. If it isn’t, he settles for a model where the interest rate is constant. If it is, he enriches
his model, with a non-constant interest rates.
    Here is how I propose to capture those ideas. I posit that the agent contemplates a “simplifiable
meta-model”. In our example, this is a transition function  (    ), whose components are (with
 = (        )):17

           +1 =   (    ) := (1 + ̄ +  ̂ ) ( −  ) + ̄ +  ̂                           (21)
           b+1 =   (    ) :=  () b +  +1 ,     () :=   + (1 −  )         (22)
                                                                                        ¡        ¢
           b+1 =   (    ) :=  () b +  +1 ,     () :=   + 1 −             (23)

    For instance, when  = 0, the agent doesn’t pay attention to the interest rate, while if  = 1,
he will pay attention to 1. Likewise,  represents the agent’s attention to future income shocks:
if   1 the agent pays little attention to future income streams — he is myopic towards them.
Parameter  in (23) represents the attention to noise: when  = 0, the agent doesn’t pay
attention to the stochasticity of the income–which will lead the agent to accumulate a too small
buﬀer of savings and be vulnerable to shocks.18 Parameter  represents the attention to the
fine structure of the income process: when  = 0, agent replaces the true autocorrelation  by
another one,  , e.g. if    and   1, the agent will think that income shocks are more
persistent than they are.
    Here
                                        ¡                               ¢
                                    :=           

is the subjective parametrization of the world, and  = (1 1 1 1 1 1) is the objective parametriza-
tion. Instead of thinking that the transition function is +1 =  (    ), the agent will decide to
imagine that it is +1 =  (    ).
  17
     This is related to the “perceived law of motion” of the literature on learning (Evans and Honkapohja 2001).
There are important diﬀerences: the concept of a simplified model also holds in static contexts, without learning;
the procedure is not about learning, but rather about the simplification of a known (but complex) already-learned
model; and in dynamic programming the sparse agent needs to have a model of his own future actions.
  18
     Section 12.3 of the online appendix develops this. See Lusardi, Schneider and Tufano (2011) for evidence of
an insuﬃcient buﬀer stock of saving. If agents underperceive the risks to income, that motivates policy of extra
assistance, e.g. extra unemployment benefits.



                                                          14
   So far, we have described a structure. The next section defines the sparse max. In particular,
what does it mean to “use a simplified model”, what’s the agent’s anticipation of his future actions,
so we have a well-defined notion of dynamic programming? Next, how will attention be allocated?
Then, we will study consequences of this behavior for classic macro questions.


3.3        Sparse Dynamic Programming: Basic Definition
The state  , the action  and the i.i.d. innovation +1 are vectors. There are  periods, where 
could be infinite.
   The rational problem. The agent’s rational problem is:

                                             X
                                              −1
                                  max                  (   ) s.t. +1 =   (    +1 )      (24)
                                ( )0≤
                                             =0


and a terminal condition  ∈ F  for a given set F  .19
     The rational version of the dynamic programming (DP) problem is a series of value functions
  
 satisfying the Bellman equation:
                                                           £                           ¤
                                () = max{ ( ) + E  +1 (  (  +1 )) }                   (25)
                                               


for  = 0   − 1, and with   () = 0. A policy is then a function  (). Actually, one can drop
the index  in the explicit formulation of (25), if state vector includes the calendar date , e.g. if we
can write  = (  ) and  depends on that calendar date component. This way, the traditional
Bellman equation can be simply written without explicit  superscript:

                                   () = max{ ( ) + E [  (  (  +1 ))]}                     (26)
                                                   


   The sparse max version. In the smax version, we are given attention-augmented utility and
transition functions  (  ) and   (  +1  ) — in a way that will be illustrated later.20
   We are also given a “default proxy value function”,   (). Typically, it is just the rational value
function (  =   ), i.e. the function assuming that the agent will behave rationally afterwards — in
the simplified model contemplated by the agent (this will be very clear in the 3-period example of
Proposition 4.1).21 We could also have   to be the objective value function (where the agent has
  19
       With infinite horizon, the transversality condition is typically lim sup →∞  ∈ F  .
  20
       One can take  ( ; ) =  (  ¯  ) and for the -th component of vector  
                                                                    ¡            ¢
                                              (   ) =     ¯  
                                                                   ¡ ¢
where  ∈ Rdim  +
                     
                        denotes the attention to factors; generally  = 1: when predicting the future values of
variables  , full attention is paid to its initial value.
  21
     It could also be some approximation of the objective value function–much like in chess, people and computers
use something akin to proxy value functions, that encode distant behavior. See Gabaix, Laibson, Moloche and


                                                                   15
rational expectations about his own boundedly rational behavior — something I derive in Section
3.4). But, the two diﬀer only by second order terms (see Proposition 3.11), so this assumption
makes materially little diﬀerence. Since it is simpler, and (I will argue) more realistic, I recommend
taking   =   .
    The agent’s action is as follows.22

Definition 3.4 (Action in sparse dynamic programming) The action of the basic sparse max be-
havioral agent is:

                        (   ) = arg smax { (  ) + E [  (  (  +1  ))]}                         (27)
                                          ;|


   Hence, the agent maximizes his perceived flow utility function, and his perceived continuity
value function. The degree of sophistication in those perceptions is controlled by vector . When
the cost of rationality  is 0 (and  = (1 1)), and   =   , the agent is just the rational agent.


3.4      More Advanced Notion: Iterated Dynamic Sparse Max
The rest of this section examines advanced notions, so the reader is encouraged to skip it in the
first reading.
    Given the decision function  () :=  (   ) from Definition 3.4, the agent obtains an objective
value function   (), which satisfies:

                                 () =  ( ()  ) + E [  (  ( ()   +1 ))]                             (28)

Does this equation admit a well-defined solution   ? This is not problematic with a finite-horizon
(it is calculated by backwards induction). With an infinite horizon, we adapt the machinery of
Bellman operators.

Definition 3.5 (Bellman operator with sparse action) Given a policy  (   ) from Definition 3.4,
the Bellman operator T (   ) is defined by:

                       T (   ) () :=  ( (   )   ) + E [ ( ( (   )   ))]                     (29)

    Given this, (28) can be written as:

                                                      = T (     )                                               (30)
Weinberg (2006) for an algorithm using an early version of this idea of proxy value function.
  22
     If there are domain conditions for  (   ), we just add them to the definition of  (   ), as in the static smax
with budget constraints (Gabaix 2014).




                                                             16
This operator T (   ) has the usual good properties, recorded in the following lemma.23

                                                                   
Lemma 3.6 (Monotone contraction) The operator T (          °  ) is a monotone
                                                                               ³    −contraction
                                                                                    ´°      °     as°a
                                                             °                     °      °       °
function of  . More explicitly: for any functions  ̃ (i) °T (  ) − T ̃   ° ≤  ° − ̃ ° ;
                                                          ³        ´                  ∞              ∞
(ii) if  () ≤ e () for all , then T (   ) () ≤ T e    () for all .

       This implies that a solution to (30) exists.

Lemma 3.7 (Existence of a value function) Given Lemma 3.6, there is a unique solution   of the
fixed point relation:
                                        = T (     ) 

The objective value function is the a unique fixed point   of the equation   = T (     ).

   Hence so far, given an original proxy value   , we defined a policy  (   ), which generates a
new value function   . We can iterate the process. This generates the “−iterated” smax action.

Definition 3.8 (Action in sparse dynamic programming, −iterated) The basic (0−iterated) dy-
namic smax action is the action  (   ) from Definition 3.4. The −iterated dynamic smax action
    ¡        ¢                                                                        ¡               ¢
is    () , where  (0) =   , and for   1,  () is characterized by  () = T  ()   (−1) .

    In some sense, the basic sparse max agent is naive about his future actions, while the −iterated
agent is more sophisticated. In practice, we will just take the basic action of Definition 3.4 in most
problems of interest: this captures the essence of the economics, while keeping the model quite easy
to use. Working through examples below will suggest that the higher-iterations are quite demanding
in rationality.
    With a finite horizon when  ≥  − 1, the −iterated value  () satisfies:

                            () = smax { (  ) + E (  (  +1  ))}                                (31)
                                     ;|


That is, we obtain the agent’s full value function. This is the same formulation as in the rational
version, but with a smax rather than a max operator. In that formulation, the BR agent is very
sophisticated (perhaps too much so) about his own future behavior: he sees how much he will see
how much he will see (etc. — iterated  times) future inattention.
   With finite horizon, the definition gives a construction of the value function by backward in-
duction: starting from   = 0, we successively calculate   −1 ,...,  0 (note that the time  is inside
vector ).24
  23
     It is tempting to define  = T (  ), but the operator  7→ T (  ) does not (prima facie at least) satisfy the
good properties of Lemma 3.6. Only  7→ T (   ) does.
  24
     I contemplated taking (31) as a starting point for dynamic programming, but it proved psychologically too
complicated, and mathematically hard to handle, due to the unusual fixed point in  .



                                                          17
3.5     Some Tools for Sparse Dynamic Programming
This subsection presents tools to compute BR dynamic programming. The reader is invited to skim
it, read the main examples shown later, and then come back to it with those examples in mind.
The results are proven for finite-horizon problems. I conjecture that they hold for infinite-horizon
problems under some reasonable assumptions.25

    Taylor expansion of policy and value functions. We decompose the vector of state vari-
ables into:  = ( ), where  is a vector of variables that are fully taken into account in the
default model (including possibly calendar time), while  is a vector of variables not taken into
account in the default model. To capture this, I assume throughout the paper that  (   )
and  (   ) are independent of  when  = 0. I also assume throughout the paper that
  (   ) = 0 when  = 0, so small ’s at  generate small ’s at  + 1.
    I will frequently assume the following “local autonomy of the disturbance” condition:
                                                               ¡          ¢
                                   (  ) = 0 at ( ) =  ()  0                                   (32)

where  is derivative with respect to  of the law of motion of . This says that when  = 0,
a small change in action  doesn’t aﬀect it directly, i.e.  is locally independent of the agent’s
actions. This is for instance the case for macroeconomic disturbances, e.g. if +1 =   + +1 , as
we postulated for some variables above (e.g. (18)).
    For simplicity, I assume that the functions are infinitely diﬀerentiable, and so is the attention
function (the online appendix weakens those conditions in Section 16.1; the exposition is then
heavier).
    The main tools are the following.

Proposition 3.9 (Obtaining the sparse policy from the rational policy, to the first order). Assume
the local autonomy condition (32), and that  (   ) =  (   ¯ ) and  (   ) =
 (   ¯ ). Consider the first order expansion of the optimal rational policy for small ,
                                                       X                 ¡     ¢
                                ( ) =  () +          ()  +  kk2
                                                        


Then, the sparse policy is, with ex-ante attention allocation:
                                             X µ          
                                                             ¶
                                                                     ¡     ¢
                                       
                           ( ) =  () +     ()        +  kk2                                   (33)
                                             
                                                          
  25
    See Harris and Laibson (2001, 2013) for a related analysis showing the diﬃculty of the mathematics of infinite
horizon dynamic programming when the agents misoptimize. Fortunately, those diﬃculties dissolve with a finite
horizon. Still, extending the analysis here to an infinite horizon seems like an interesting, diﬃcult problem.




                                                       18
and with ex-post attention allocation:
                                                   X                          ¡     ¢
                             ( ) =  () +        ( ()    ) +  kk2                        (34)
                                                   


    This proposition will be quite useful. To derive policies, first we can simply do a Taylor expansion
of the rational policy around the default model, and then truncate term by term.
    The following proposition indicates that to calculate the leading terms of the sparse policy, one
can do a simple Taylor expansion around the default model,   (). One does not need to calculate
explicitly the full rational policy   ( ).

Proposition 3.10 (Simple procedure to calculate the rational or sparse policy, to the first order)
Assume the local autonomy condition (32). To calculate the policies  ( ) and  ( ) up to
second order terms, one can simply do a Taylor expansion around the default model with value
function   () (which gives  and  ), following the procedure outlined in Section 10.1. In
particular, one does not need to fully solve the rational model.

       I now present some basic facts that are helpful in thinking about those policy functions.

Proposition 3.11 For small , we have:  ( ) =   ( ) + R ( ), where the residual
              ¡    ¢
R ( ) =  kk2 for  close to 0. In other words, the sparse value function and the rational
value functions diﬀer only by second order terms in .

       This basically generalizes the envelope theorem.26 It implies that, at  = 0 :

                           =              
                                          =           =               
                                                                            =                        (35)

                   
Typically  6=  , however.
   We have the following Lemma.27

Lemma 3.12 (Close policies give very close value functions) Suppose a policy  ( ) such that
                                                                    ¡    ¢
 ( ) =  () +  (kk). Then,   ( | (·)) =   ( ) +  kk2 .

   This means that if the policy is approximately correct, up to first order terms, then the value
function is approximated by the correct optimal policy, up to second order terms. This is again the
envelope theorem.

Lemma 3.13 (Close proxy value functions give close policies) Consider two proxy value func-
                                                      ¡    ¢
tions      such that,   ( ) =   ( ) +  kk2 , and assume (32). Then,  (    ) =
                0                          0

  ¡          0¢     ¡     ¢
     +  kk2 .
  26
 ³ The ´intuition is that as  is small, and the action is close to the optimum, we get only second order losses
      2
 kk from misoptimization.
 27
    Here   ( | (·)) is the policy induced by , closely along the lines of Lemma 3.7.

                                                       19
    This lemma means that to know the optimal policy up to second order terms, we just need to
have a proxy value function that is accurate up to second order terms. This is intuitive, but the
proof reveals that condition (32) is required.
    The above two lemmas imply that sophistication vs naiveté lead to the same policies, up to
second order terms. Given also the naive / basic action ( = 0) is simpler, this is another reason
for modeling agents with the basic policy.28

Proposition 3.14 (Sophistication vs Naiveté makes only a second order diﬀerence in actions)
Consider the −iterated agent of Definition 3.8. Suppose that the level 0 agent used a proxy
                                                        ¡    ¢
value function   such that   ( ) =   ( ) +  kk2 . Then, the actions at higher lev-
                                                                                     ¡        ¢
els of sophistication  ≥ 0 diﬀer only by second order terms from the naive action:    () =
  ¡       ¢      ¡    ¢
   (0) +  kk2 .

   For instance, in the life-cycle model of Section 2, I assumed basic ( = 0) agents, who project
them selves are rational. If I had assumed partially (low   0) or fully sophisticated agents
( ≥  − 1), who keenly understand their future bounded rationality, Proposition 3.14 says that
the consumption would have been the same, up to  (2 ) terms.


4       Intertemporal Consumption: Behavioral Version
I now work out a few explicit examples, starting from very simple ones to build the intuition.


4.1     The life-cycle problem revisited
4.1.1    Detailed analysis with three periods

Here I revisit the life-cycle model of Section 2, in more detail. I take a 3-period version ( = 2,
                     P
 = 3).29 Utility is 2=0  ( ), and there is no discounting ( =  = 1). The agent starts with an
endowment 0 , has no regular income (̄ = 0) and receives  at time 2;  is known at time 0, but
the agent “may not think about it”. For instance,  could represent a negative income shock, such
as a tax to pay, or a decrease in income as retirement. Calling  the wealth at the beginning of
period , the budget constraints at times  = 0 1 2 are: 1 = 0 − 0 , 2 = 1 − 1 , 0 = 2 +  − 2 .
   How much attention will the agent pay to time-2 payment ? First, let us observe that a rational
agent smooths consumption: lifetime resources are 0 +  (initial wealth 0 and time-2 payment
  28
      Hyperbolic discounting naïve and sophisticated agents often act quite diﬀerently (Laibson 1997, O’Donoghue and
Rabin 2001).
           ³ However,´   in simple consumption-savings problems, the discrepancy between the two types’ consumption
                   2
is still  (1 − ) , where  is the hyperbolicity parameter, so quite modest if  is close to 1.
   29
      Section 10.3 gives more complements for the  period model.




                                                        20
), and they should be consumed equally in the three periods:

                                                    0 + 
                                             =          for  = 0 1 2
                                                      3
The corresponding dynamic policy (expressed with  rather than 0 ) is:

                                      0 +                  1 + 
                              0 =                 1 =              2 = 2 + 
                                        3                      2
e.g. at time 1, the life-time remaining resources (1 + ) should be divided equally among the two
remaining periods.
    I first state the behavioral policy, then derive it. The derivation is instructive.30

Proposition 4.1 Take the 3-period life-cycle problem. The BR policy is
                                   0 + 0        1 + 1 
                            0 =                    1 =       2 = 2 + 
                                       3                2
                                        ¡ 1 00 ¡ 0 ¢ 2 ¢           ¡ 1 00 ¡ 1 ¢ 2 ¢
where the attention values are 0 = A 6    3  and 1 = A 2         2  . If || is not too
large, they satisfy 0 ≤ 1 ≤ 1, i.e. the agent reacts more to near variables than distant variables.

   Derivation of Proposition 4.1 We apply the smax procedure of Definition 3.4, using back-
ward induction.
   At time 2, the agent consumes all his disposable wealth:

                                              2 (2  ) =  (2 + )

       At time 1, the agent’s problem is:

                  smax 2 (1   1 ) with 1 (1   1 ) :=  (1 ) +  2 (1 − 1  1 ) 
                   1 ;1


The FOC 11 = 0 reads: 0 (1 ) = 2 (1 − 1  1 ) = 0 (1 − 1 + 1 ), so 1 = 1 − 1 + 1 ,
and
                                                  1 + 1 
                                           1 =                                                     (36)
                                                      2
The agent pays partial attention 1 to the time-2 income .
                                                                  2
                                                                                            ¡ ¢
   To calculate attention 1 , we apply (11). Noting that        (  1 )|1 =0 = 200 1 , where
                                                                      ¡       ¡ ¢      ¡ ¢¢
 = 21 is the optimal consumption with 1 = 0, we have 1 = A 1 200 1  2 , so
                                                      µ          ¶
                                                   1 00 ³ 1 ´ 2
                                           1 = A                                                       (37)
                                                  2      2
  30
                              £ ¤
    I use the notation 2 = E 2 to indicate the prospective magnitude of ; with ex post attention, we simplify
have 2 = 2 


                                                             21
       At time 0, the agent does smax0 ;  0 (0   0 ), with

                               0 (0  0   0 ) :=  (0 ) +  1 (0 − 0  0 )                           (38)

where I use Definition 3.4, with   =   , the value function where the agent projects that he will
be rational in the future:31                            µ         ¶
                                       1                +
                                      ( ) = 2                                                       (40)
                                                              2
                                                                        ¡            ¢
   The FOC is 00 = 0 with, i.e. 0 (0 ) = 1 (0 − 0  0 ) = 0 0 −02+0  , i.e. 0 = 0 −02+0 
and
                                                   0 + 0 
                                            0 =                                                          (41)
                                                       3
   To determine attention 0 , we again use (11); we calculate:

                       0
                               ¡ ¢     1            ¡ ¢ 1 ¡ ¢ 3 ¡ ¢
                       = 00  + |=0     = 00  + 00  = 00 
                                                            2       2
              ¡ 0                  ¢   ¡         ¡ ¢     ¡ ¢¢
so that 0 = A 1   (0 0 ) = A 1 32 00   3 , i.e.
                                                      µ          ¶
                                                   1 00 ³ 0 ´ 2
                                           0 = A                                                              (42)
                                                  6      3

       The consumptions are:
                                                                                     µ            ¶
              0 0                            0 ³ 1 0 ´                      0       0 + 1
0 (0  ) =   +              1 (0  ) =   +    −          2 (0  ) =    + 1−            
              3  3                             3    2   6                        3           2
                                                                                                (43)
                                                            ¯ ¡ ¢¯ 1 ¯ 00 ¡  ¢¯
    Comparing (37) and (42), we see that 0 ≤ 1 iﬀ 6  3 ≤ 2 ¯ 21 ¯. When  = 0, this
                                                          1 ¯ 00 0 ¯

is automatically verified, as 30 = 21 . Hence, we have 0 ≤ 1 iﬀ  is not too large.32
    ¤

4.1.2      A few features of a sparse agent

This example and the life-cycle model of Section 2 illustrates a few general features.
   Sparse agents are globally patient like rational agents, but still myopic to a variety of small future
  31
     In terms of the iterated sparse max of Definition 3.8, this is the value function under procedure with  = 0
iteration, t. If we used the procedure with  = 1−iteration, the agent uses the objective value function, which is:
                                             µ                 ¶    µ                       ¶
                                               1 + 1 (1 )         1 + (2 − 1 (1 )) 
                             1 (1  ) =                      +                                              (39)
                                                     2                         2

As¡ per¢ the envelope theorem, the two value functions diﬀer only by second order terms:  1 (1  ) =  1 ( ) +
 2 .
  32
     If  was very large and positive, we could have the following eﬀect: the agent realizes at time 1 that he’s actually
quite wealthy, so pays less attention. This eﬀect needs a very large , so is not operative in most situations.



                                                           22
shocks. Indeed, agents here invest their wealth  very patiently, exactly like rational agents: they
fully smooth it over the horizon. At the same time, they tend to be myopic about future small
shocks (the time-2 shock ). In other terms, in the present model, agents are only partially myopic
(e.g. don’t react to a scheduled increase in taxes). This behavior cannot be captured with a model
simply assuming a low discount factor .
    The Euler equation fails. The Euler equation holds under the BR-perceived consumption, but
not under the actual consumption. For instance, at time 1, if 1 = 0, then the agent expects to
                         ¡       ¢                                    ¡              ¢
consume (1  2 ) = 21  21 , but actually consumes (1  2 ) = 21  21 +  . The traditional Euler
equation basically only holds if agents are exactly rational (Hall 1978), so it is a fragile way to
model agents. In contrast, sparse consumption functions are a more robust way of modelling them.
    The first and second welfare theorems fail. This 3-period example features a simple economy,
“production” being the linear storage technology allowing to transfer the good 1-for-1 across periods.
Here, we do not have a Pareto-optimum, as the agent fails to maximize.33 Likewise, if the first welfare
theorem fails, typically the second welfare theorem fails. However, some optimum tax policy can
generally restore eﬃciency.
    Agents react more to “near” shocks than to “distant” shocks (in math, 0 ≤ 1 ). The main
reason is that, normatively, the shock  should impact 0 as 3 ( 0 ( 
                                                                           0 )
                                                                                 = 13 ), while it should impact
1 as 2 ( 1 (
               
                 1 )
                       = 12 ). Hence, attention to the last period shock  is lower at earlier dates ( = 0)
than at late dates ( = 1).
    This example suggests a few interesting variants. I discuss some of them in Section 7.1.


4.2     Consumption-savings with infinite horizon
Here I propose a version of the permanent income consumption problem of Section 3.2.

    Formalism. We have  the state vector of disturbances, which follows a process: +1 =
    ¡       ¢
   +1 . The interest rate and income deviations from their means are a linear function of
  

that state vector: ̂ =  ·   ̂ =  ·  for some vectors    . The perceived law of motion for
wealth is kept throughout as (21). However, the perceived law of motion for  can be very general,
e.g. +1 =  ()  +  () +1 for some parametrizations of the matrix and stochasticity.
    As a concrete example, let us review the basic example with the full formalism (which the reader
is encouraged to skip at first). The state vector is:34

                                           = (  ̂  ̂         )                             (44)
  33
     In Gabaix (2014, Proposition 8) the first welfare theorem (in a static economy) does hold if agents have the same
misperceptions: the reason is that in that setup, the agent is assumed to fully perceive consumptions (a defensible
assumption in a static context) — whereas in the present model he doesn’t. For instance, at time 1 the fully naïve
agent projects that 1 = 2 = 21 , whereas in fact 2 = 21 + .
  34
     If        are correctly perceived, then we can just take  = (  ̂  ̂ ).



                                                             23
Here   parametrizes the stochasticity of income, which may be set to zero in a simplified model.
The simplifiable meta-model is: b+1 =   (    +1  ), where the components are: for wealth,
(21):
                 +1 =   (    +1  ) := (1 + ̄ +  ̂ ) ( −  ) + ̄ +  ̂ 

for the interest rate and income, using the notation  a shorthand for  or ,
                                                  ¡                     ¢
                b+1 =   (    +1  ) :=   + (1 −  )  
                                                                         b + (  ) 
                                                                                         +1
                                                                                



for parameters  =        ,

                                +1 =   (    +1  ) :=   + (1 −  )  

       For instance, if  = 0, the agent projects income to have 0 stochasticity in the future.

     Results. I start with a simple lemma describing the rational policy, using Taylor expansions.35
                                                                        ¡    ¢
To signify “up to second order term”, I use the notation  kk2 , where kk2 := E [̂2 ] ̄ 2 +
E [̂2 ] ̄2 (the constants ̄ ̄ are just here to keep valid units). Recall that  := 1 + ̄.

Lemma 4.2 (Traditional rational consumption function) In the rational policy, the optimal con-
sumption is:  =  + ̂ , with  =  +̄ and
                                                "                        #
                                                 X  ( ) ̂ +  ̂      ¡    ¢
                                       ̂ = E             −+1
                                                                           +  kk2                                        (45)
                                                   ≥
                                                        
                                               ̄
                                               
                                                    ( − ̄) −                 ̄
                                  ( ) :=                               :=                                           (46)
                                                                                  
       The associated value function is

                            1                      ¡     ¢
               (   ) =    (  +  ) +  kk2                                                                    (47)
                            
                             ̄              ̄ X ̂                                         X      −̄
                                                                                                       
                                                                                                          ̂ +  ̂
                        := + (1 − ) E [                ]                := ̄ + E [                             ]
                                             ≥  −+2                                     ≥
                                                                                                         −+1

   Consumption reacts to future interest rates and income changes, according to the usual income
and substitutions eﬀects (multiplied by ).36
   The behavioral policy is then as follows.
  35
      In independent work, Auclert (2015) contains a similar Taylor expansion for the rational case, with more general
assets.
   36
      The term  is the MPC, and contains substitutions and income eﬀects from wealth before receiving the innovation
in income,  −̄. The term  contains the baseline income ̄, expected value of future income ̂ , and and substitution
eﬀects interest rates associated with the income stream of ̄ per period. There is no income eﬀect for ̄, as no interest
rate was going to accrue to ̄.

                                                               24
Proposition 4.3 (Sparse consumption function) In the behavioral model,  =  + ̂ , with  =
 +̄
  
        and                      "                              #
                                  X  ( )  ̂ +   ̂       ¡   2¢
                      ̂ = E                                  +   kk                   (48)
                                    ≥
                                              −+1

where E is the expectation taken with respect to the agent’s beliefs under the subjective model.

   The policy of the behavioral agent is the policy of a rational agent, under a subjective model,
and with partial inattention to income and interest rate.
   Now, I record the important case of AR(1) processes.

Lemma 4.4 In the AR(1) model (18)-(19), the rational policy is:
                                                                                            ¡     ¢
                                  (  b  b ) =  ( ) +  ( ) b +  b +  kk2                         (49)
                                                      ( )                      
                                        ( ) :=                      :=                                            (50)
                                                      −                        − 

and the value function as in (47) with

                            ̄           ̄ ̂                                  −̄ ̂         ̂
                     =       + (1 − ) 2                           = ̄ +             + 
                                         −                                     −        − 

Proposition 4.5 Under the AR(1) model, the behavioral policy is:
                                                                                              ¡     ¢
                                  (  b  b ) =  ( ) +  ( ) b +  b +  kk2                       (51)

                     ( )                   
with  ( ) =    − ()
                                 and  =     − ()
                                                        .
                                                              ´³    2  ( )2 | |
                                                                   
    Endogenizing attention, we have  = A                     , for  =  and  =  as in (11).37
                                                                       
                                                                         
                                                                               


This shows shows a “feature-by-feature” truncation. It is useful because it embodies in a compact
way the policy of a sparse agent in quite a complicated world. Note that the agent can solve this
problem without solving the 3-dimensional (and potentially 21-dimensional, say, if there are 20
state variables besides wealth) problem. Only local expansions and truncations are necessary.38
Attention to the interest will become higher if the interest rate is very volatile ( high, e.g. as in
hyperinflations).39
  37
      Call  () =  () +   ((1 + ̄ + ̂ ) ( − ) + ̄ + ̂ ). I use the well-known fact that in the limit of small time
intervals,  =  . See e.g. Section 13.1.
   38
      Note here that the active decision is that of consumption, not savings. For most variables (except current
income), it does not matter: the impact of interest rates, future taxes, future income shocks etc. are the same whether
a sparse agent uses the consumption frame or saving frame. See Section 12.7 for a discussion: the consumption frame
is arguably better, as it yields great utility when   , income shocks are less than extremely persistent.
   39
      Likewise, in the model, a wealthy rentier, with much financial wealth but little labor or state income, will
endogenously pay more attention to the interest rate, as it is more important for her consumption (and will bemoan
at low interest rates, which lead her to cut on consumption).


                                                                   25
Figure 4: This figure shows the attention to the interest rate ( ) and to income ( ) as a function
of the cost of thinking, ̄.


    Numerical illustration Numerical illustration. To get a feel for the eﬀects, consider a cali-
bration with (using annual units):  = 1, ̄ = 5%,  = 2 ,  = 1,  = 08%,  = 02,  = 095,
 = 07: as income shocks (roughly corresponding to “carrier risk”) are persistent, they are impor-
                                                                                              ¯ ¡ ¢¯
tant to the consumer’s welfare.40 I use the 1 truncation function. I parametrize  = ̄2 ¯00  ¯,
as in Section 2 (see also Section 10.2.2).
    Figure 4 shows the attention to the interest rate and income. At  = 0, the agent is fully
rational, attention is 1. For higher ̄, attention drops, more so for the interest rate. For ̄ above
0.02, the agent stops thinking about the interest rate. Because the interest rate makes him change
his consumption by less than 2% on average, it’s optimal for him not to think about the interest
rate. Still, he thinks a lot about his income. Attention to current income falls when ̄ ' 01, i.e.
then the agent truncates features that make him change his consumption by less than 10%. Note
that this “source-specific” selective attention could not be rationalized by just a fixed adjustment
cost to consumption, which aﬀect all causes of consumption change equally.
    The same reasoning holds in every period. The above describes a practical way to do sparse
dynamic programming. In some cases, this is simpler than the rational way (as the agent does not
need to solve for the equilibrium), and it may also be more sensible.
    This section has developed the sparsely behavioral version of a basic machine of macroeconomics:
the consumption function of an agent in a world of dynamic interest rates and income shocks. This
is useful, because from this machine can be used in a host of situations. I turn to two such situations
before turning its use in general equilibrium (Section 5).
 40
      This numerical example is a rough AR(1) rendition of the “permanent-transitory models” in the literature.




                                                         26
4.3       Application: Ricardian Equivalence
Intuitively, a sparse agent will violate Ricardian equivalence as he is partially myopic. To see more
precisely, I keep interest rates constant, and call ̂ the transfers from the government to the agent at
time . To see this, call − the financial wealth at the beginning of the period (before government
transfers) and specialize Proposition 4.3, setting ̂ := ̂ +1 . We obtain the consumption:
                                                                   X               ̂
                                        ̂ =  (− + ̂ ) +                                     (52)
                                                                    
                                                                                   −

   Suppose that the government gives ̂ to the agent at , and −̂ in  periods. A rational
consumer would not change consumption, as the present value is unchanged (Barro 1974). However,
a BR consumer increases consumption by ̄ (1 −  ) ̂: the positive shock increases it by ̄ ̂, and
the negative shock decreases is by ̄  ̂.

Proposition 4.6 (Failure of Ricardian equivalence) A behavioral consumer increases consumption
at  by ̄ (1 −  ) ̂. This way, Ricardian equivalence does not hold, unless attention is full. The
further away the increase in taxes (keeping their present value constant), the lower the reaction.

    Section 12.6 develops in details the dynamics of attention to future taxes: in particular, how
attention becomes higher close to the tax hike.


4.4       Application: Lucas Critique
With sparse agents, the Lucas (1976) critique stops applying — or at least applies less. Lucas’ critique
is that if the parameters of the world (e.g. tax) change, people’s reactions functions will change.
However, with sparse agents, this is it not true: when changes are small, agents choose keep their
default “policy functions”. For instance, suppose that there is a small, temporary consumption tax
T , in the permanent income model above, so that the perceived law of motion for wealth becomes:

                  +1 =   (    ) := (1 + ̄ +  ̂ ) ( − (1 + T T )  ) + ̄ +  ̂

If the tax is small, agent will pay 0 attention to it (T = 0), and their policy function will not
change. The aggregate outcome will change, because agents will be poorer — but the policy function
will not change.


5       Neoclassical Growth Model: A Behavioral Version
I now move on to general equilibrium, and study a behavioral version of the baseline neoclassical
growth model, the Cass-Koopmans model.41
 41
      For simplicity, I remove here the “growth” part, but it is straightforward to add.

                                                           27
Figure 5: This Figure shows the traditional approach to the neoclassical growth model. The agent
is supposed to find the unique saddle path leading to non-explosive dynamics. Arguably, this is
psychologically quite absurd. The present paper proposes a more behavioral approach. Source:
Acemoglu (2009).


5.1     Setup
                               P          1−
                                        
The utility function is still E ∞                                      1
                                  =0  1− , and we again call  =  . The aggregate capital stock
follows:
                               +1 = f (  ) + (1 − )  −  + +1                      (53)

where +1 are mean-zero shocks. This way, there is just one state variable in the economy, the
capital stock. In the most basic neoclassical model, +1 is always 0, and  is fixed.42 I define
 () := f ( ) − , which is output net of the capital depreciation at the fixed labor supply,
so that +1 =  () +  −  + +1 .
    This is a textbook example, which introduces generations of students to macroeconomics (Blanchard-
Fischer (1989, Chapter 2), Acemoglu (2009, Chapter 8), Romer (2012, Chapter 2)). In that tra-
dition, we have infinitely-rational forward looking agents that calculate the whole macroeconomic
equilibrium in their heads. They are supposed to use the dynamics:

                                ̇  1
                                    = ( 0 ( ) − )        ̇ =  ( ) − 
                                   

and given 0 , find the unique 0 that leads to a non-explosive path (the saddle path, see Figure
5). The psychology of that is arguably quite alien to any human’s intuition. Still, it’s on that
strange core model that much of dynamic macroeconomics rests. Hence, it is useful to develop an
alternative to that model, something I now do.
  42
    I keep the noise +1 because it makes the model a true DSGE model, and because it yields a scale for typical
business-cycle fluctuations that it useful to determine attention.


                                                       28
   Let us first review the mechanics of convergence. If there were no shocks, the economy
would be at the steady state, with capital stock  ∗ . I use the hat notation for deviations from the
           b  =  −  ∗ . The law of motion for capital (53) is, in linearized form:
mean, e.g. 

                                                           b − 
                                            b +1 = (1 + )     b + +1                                              (54)

where  is the steady state interest rate, 1 +  =  0 (∗ ).
   As there is one state variable, the linear policy function of the agent (rational or not) is:

                                                              b
                                                         b =                                                         (55)

for some constant  to be determined.
                                       b +1 = (1 +  − ) 
    Plugging this into (54) we obtain:                    b  + +1 , i.e.

                                                                b  + +1
                                                 b +1 = (1 − )                                                       (56)

where  is the speed of mean-reversion:
                                                          =  − .                                                     (57)

When agents are more reactive to shocks (when  is higher), the economy mean-reverts faster to
the steady state ( is higher).
   Squaring equation (56), we obtain:        b +1 = (1 − )2  b  + 2 . As in the steady state,
                                 2
b +1 = 
               b  , 
                        b =    
                                      , i.e., in the limit of small time intervals:
                             1−(1−)2

                                                              
                                                         = √                                                          (58)
                                                               2

When shocks mean-revert more slowly (lower ), the average deviation of the stock price from trend
is higher (shocks “pile up” more).

    The steady state. Rational agent. The rational agent has a value function  ( ), which
satisfies:
                      () = max{ () + E [ ( +  () −  + e)]}                   (59)
                                             

The steady state is at  = ∗ ,  = ∗ with:43

                                                        (1 + ̄) = 1                                                   (60)

which determines ∗ , the gross interest rate 1 + ̄ =  0 (∗ ) and consumption is ∗ =  (∗ ).
   Behavioral agent.
 43
      The traditional proof is by taking the derivative w.r.t.  in (59), so  0 (∗ ) =  (1 +  0 (∗ ))  0 (∗ ).



                                                              29
    I consider here the decentralized approach. In a population with mass 1 and aggregate capital
stock  , I consider an individual represent agent, who has his own wealth  , under control. In
equilibrium  =  . But when deciding on his own consumption, and agent is an infinitesimal
price taker, and takes the macro variables ( ) as unaﬀected by his own actions.
    Suppose that the agent has a consumption rule that’s consistent with a steady state growth, i.e.
 = ̄ + , where the MPC is  = 1−. By the analytics above (equation (20)), this is the optimal
policy in the steady state.44 Then, wealth evolves as +1 = (1 + ̄) ( + ̄ −  ) = (1 + ̄) (1 − )  .
So, at a steady state, ̄ adjusts so that 1 = (1 + ̄) (1 − ) = (1 + ̄) . This gives the same condition
(60), hence the same steady state as in the rational case.
    The behavioral agent here inherits the same steady state as the neoclassical agent, with  (1 + ̄) =
1 at the steady state. Only the dynamics around the steady state are diﬀerent. I now turn to them.
For simplicity, I use the notation  for the steady state interest rate ̄.


5.2        Convergence: Boundedly Rational Version
The agent’s wealth evolves as:
                                             +1 = (1 +  ) ( +  −  )

where  =  ( )−  0 ( ) is labor income, and  =  0 ( ) is the interest rate. Taylor expansions
around the steady state yield:

                                                       b
                                     b =  00 ( ∗ )                              b
                                                              b = − ∗  00 ( ∗ )                         (61)

   Rather than positing that the agent correctly sees a whole saddle path, Ih positithat in the agent’s
model, capital evolves with a subjective speed of mean-reversion  : E     b +1 = (1 −  )  b. I
again parametrize it as:
                                      = (1 −  )  +  

where  is the true speed of mean-reversion (which will be determined as an endogenous outcome)
and  is a default value — perhaps coming from some empirical experience, saying for instance that
“business cycles” have a half-life of a few years.
   For simplicity, I posit that the agent pays the same attention  to all macro variables.45
Lemma 4.4 reads here (using the continuous time notation):

                                                                ∗ − ∗ 
                                      = b
                                     b      +            b
                                                            
                                                             +             b
                                                    +            + 
  44
       Here wealth is taken at the beginning of the period, before receiving labor income.
  45
       It is easy to generalize to the case where people’s attention to income and the interest rate diﬀer.




                                                             30
and using (61) and (63) we obtain:

                                        − ∗  00 ( ∗ ) + (∗ − ∗ )  00 ( ∗ )
                              = b
                             b      +                                                 b
                                                                                      
                                                           + 

i.e., as ∗ =  ∗ ,
                                                             
                                               = b
                                              b      +             b
                                                                                                         (62)
                                                            + 
with
                                               := −∗  00 (∗ ) ≥ 0                                      (63)

   Hence, in the aggregate b = b  with  =  +                
                                                                      ,     and using (57) we obtain the actual
                                                                 + 
speed of mean-reversion of the economy:

                                                              
                                                   =                                                    (64)
                                                             + 

  Rational agent. The rational agent has a correct model ( = ,  = 1). So the speed of
mean-reversion is  =  ; (64) gives
                                              
                                       =                                            (65)
                                            + 
                            √
                      −+ 2 +4
whose solution is  =        2
                                  .

   Behavioral agent. Let us now endogenize  and  . Given (62), ̂          
                                                                               | =0
                                                                                        = 0: at the
default model, he doesn’t react to , the speed of mean reversion of aggregate variables, given he’s
not even thinking about aggregate variables (here, just capital). This means (using equation (11))
that  = 0: the optimal refinement in thinking about the speed of mean reversion is 0. Hence,
 =  , the projected speed of mean-reversion ( ) is the default one ( ).46 Given (64), this
implies that the actual speed of mean-reversion is:

                                                                           
                                           =  0 ,           0 :=                                      (66)
                                                                         + 

   Note that in the rational expectations case  = , which remains a useful benchmark. The
next Proposition studies the more general case, in which  ≥ min (  ).

Proposition 5.1 (Fluctuations are larger and more persistent with sparse agents) Suppose that
 ≥ min (  ) and   0. Then    : in the sparse economy, GDP fluctuations have slower
mean-reversion and higher variance than in the rational economy.

  Consumption is less volatile in the sparse than in the rational economy, if  ≥ , which seems
empirically valid.
  46
       With the iterated sparse max of Definition 15.1 of the online appendix, we can have   0.

                                                           31
                                                                                    ¡          ¢
   To get a quantitative expression for , I use the attention function A1 () = max 1 − 1  0 from
(15).
                                                                                        0                    
Proposition 5.2 The speed of mean-reversion of the economy is:  =                     1+ 
                                                                                               with 0 :=   +
                                                                                                                 ,
                                                                                           0
 := |2|2 . It is lower (and aggregate fluctuations are larger) when agents’ bounded rationality 
             
is stronger.

    There are two conclusions from this analysis.
    First, bounded rationality generates more volatile and persistent fluctuations.
    Second, and more importantly, we have a structure that gives an alternative to the rational
general equilibrium model. In addition, the worldview of the agent is arguably more sensible. In
the behavioral model, the agent pays only partial attention to aggregate state variables and has a
simplified understanding of their dynamics: this is, arguably, how most people orient themselves,
without a full, structural of model of the causes of aggregate dynamics (which no one knows anyway,
including economists). For instance, they say “healthy business cycles typical mean-revert in about
4 years” (which corresponds here to taking  = 14 ), and they forecast based on that benchmark.
People can act with that simplified understanding.
    Of course, this does not say that the model does make better predictions — though the generation
of higher volatility of GDP is intriguing. It does mean that we have a modelling structure that
could be promising in future quantitative work.


5.3     Generalization: Recursive Competitive Equilibrium with Behav-
        ioral Agents
Here I define the behavioral extension of the Prescott-Mehra (1980) recursive competitive equilib-
rium — which is a formalization of the intuitive concept of dynamic equilibrium. It formalizes what
we did in Section 5.2. It is more of methodological interest. It shows the “template” of dynamic
equilibrium with behavioral in other contexts. The key issue is that the agents’ behavior aﬀect
aggregate future outcomes, but agents may have only a simplified understanding of that.
    We are given a steady state capital ̄, a default law of motion  0 =  (), with  () =
        ¡        ¢
̄ +   − ̄ . A given  gives perceived laws of motions for private wealth 0 =   (   )
and for the aggregate variables  0 =  ( ).47 In turn they generate a default value function
   ¡                            ¢
    |   (· )   (· ) , which is the rational value function under those laws of motion.
The proxy value function chosen is then:   =   or, depending on the context, a second-order
approximation of it.48
  47
     The present paper oﬀers a systematic way in which agents simplify the moments they use to think about general
equilibrium. This could be useful to systematize procedures such as the one in Krusell and Smith (1998). See also
Barberis, Shleifer and Vishny (1998) and Hong, Stein and Yu (2007) for an early analyses of financial equilibrium
when agents use a simplified model.                                           ³¯       ¯2 ´
  48
     I.e.,   ( | (· )   (· )) =   ( | (· )   (· )) +  ¯ − ̄ ¯ .


                                                       32
    In the context of the Cass-Koopmans above the definition is as follows. This template can be
generalized quite easily to more state variables, several types, flexible labor supply etc. This mostly
just takes more space (see Ljungqvist and Sargent, Chapter 12).

Definition 5.3 (Behavioral recursive competitive equilibrium) A behavioral recursive competitive
equilibrium is

   1. A set of prices  ()   (), and perceived prices  ( )   ( ) with  := (  2   0   ),
      with:
                                       ¡ ¢¡          ¢        £               ¡ ¢¡        ¢¤
                  ( ) = ̄ +  0 ̄  − ̄ +  2  () − ̄ − 0 ̄  − ̄                   (67)

       and the same for  ( ).

   2. A set of policies: consumption  ( ) and firms’s factor demand:  ()   ()

   3. A perceived law of motion for private capital: 0 =   (   )
                                                          ¡                   ¢
                          (   ) := (1 +  ( ))  −  +  ( ) ̄ +  +1


   4. An actual law of motion for the aggregate capital:  0 =  ()

   5. A perceived law of motion for aggregate capital:  0 =  ( ) =  0  ()+(1 −  0 )  ()
       such that

   6. The agent chooses consumption sparsely and optimally:
                                               ¡                                                   ¢
             (  ) = arg smax{ () +     (   )   ( ) |   (· )   (· ) }
                                  ;

               ¡                            ¢
      where     |   (· )   (· ) is the rational value function associated with the perceived
      law of motions   and .
                                                           ¡        ¢
   7. Firms maximize profit:    ∈ arg max  {f    −  ()  −  ()  }

   8. Markets clear:  () = ,  () = ̄
                                                                              ¡     ¢
   9. The actual law of motion is consistent with individual choice:  () = f  ̄ − ( )+ .

  To interpret (67), consider the case where the agent doesn’t pay attention to nonlinear terms
( 2 = 0),49 doesn’t pay attention to stochastic noise in the future ( = 0) and uses a simplified,
AR(1) view of aggregate dynamics ( 0 = 0). Then, his model of the world is exactly as in Section
  49
    Here  2 is the attention to non-linear terms. If  2 = 0, the agent simply linearizes the impact of the state
variable on the interest rate. When using the plain sparse max (as opposed to the iterated sparse max of Definition
15.1), the algorithm will select  2 = 0, i.e. remove the nonlinear terms.


                                                        33
                                 ¡                            ¢
5.2. His proxy value function     |   (· )   (· ) is the proxy value function under that
simplified model, where everything is an AR(1). The value function was already calculated in
Lemma 4.4, using  =  = 1 − .


6       Behavioral Version of a Few Other Models
To make sure that the model is widely applicable, I developed a behavioral version of a few other
important machines of dynamic economics. I summarize them here, while the online appendix has
the specifics. I start with the Merton problem, which illustrates a case where risk matters for the
agent’s decision.


6.1       Merton Portfolio Choice Model
A core
     h model is dynamic ifinance is the Merton (1971) portfolio choice problem.50 The agent’s utility
       1
          R ∞ − 1−
is: E 1−  0
                , and his wealth  evolves according to:

                                   = (− +  )  +   (  +  )

where  is the allocation to equities. The equity premium  =  +     b has a variable part 
                                                                                                b , which
follows
                                     = −Φb
                                   b          −  1 + 0 2

where the return is ̃ = ( +  )  + 1 . The parameter  ≥ 0 indicates that equity returns
mean-revert: good returns today lead to lower returns tomorrow. That will create a hedging demand
term. I again call  = 1 the intertemporal elasticity of substitution.
   So, in theory, the agent should take into account both the variable equity premium    b and also
the “hedging demand,” the demand due to the fact that equity returns mean-revert.

Proposition 6.1 (Behavioral dynamic portfolio choice) The fraction of wealth allocated to equities
is, with ∗ :=  2 :
                                        µ       ¶     µ          ¶
                                          b
                                                       
                             = ∗ +         +          
                                          2           2
while consumption is:  =   with
                                   µ                                ¶
                                                ∗                         ¡                     ¢
                        = ∗ +  (1 − )             b  
                                                     ∗                +  (1 − ) ∗   
                                              ∗ + Φ
 50
      Section 12.1 of the online appendix studies a more general Merton’s problem with many assets and factors.




                                                         34
where  is the hedging demand term

                                                                1
                                         = − (1 − ) ∗            2 
                                                             ∗ + Φ

    Proposition 6.1 describes the action of a sparse agent. When  = 0 we recover the fully rational
agent, as in Barberis (2000), Campbell and Viceira (2002) and Wachter (2010), with the notoriously
sophisticated hedging demand term  . When   0 increases, portfolio choice becomes insensitive
to the change in the equity premium,  b , and the agent thinks less about the mean-reversion of asset,
the  terms. In addition, the agent is here allowed to be “schizophrenic:” he pays attention to
diﬀerent things as a consumer than as an investor.51 For instance, suppose that the price-earnings
ratio of equities is very high and expected equity returns are very low; then, the agent will decrease
her exposure to equities (  ∗ ), but not reduce her consumption ( = ∗ ). The online appendix
(Section 12.1) develops the Merton portfolio choice model in much greater generality, with many
assets and factors.


6.2     Other models
    Linear quadratic models Many economic problems can be conveniently expressed as linear-
quadratic (LQ) models (Ljungqvist and Sargent 2012). Section 12.2 derives how to systematically
derive a BR version of those models. The models are very tractable (there is no matrix Ricatti
equation to solve). Hence, the model oﬀers a way to quite generally have behavioral version of
linear-quadratic problems.

    Precautionary savings The consumer may save more when the future is uncertain, a phe-
nomenon known as “precautionary savings” (e.g. Carroll 1997). However, a BR consumer may not
think much or at all about the stochasticity of his income and under-accumulate a buﬀer of savings.
This is developed in Section 12.3.

    Real Investment Model In macro-style investment models, the firm optimizes on invest-
ment, with adjustment costs. A behavioral version of this problem is in Section 12.4. The firm uses
a simplified model of future profits, which can lead it astray (see Greenwood and Hanson (2015)).

    The Becker-Murphy model of rational addiction The Becker-Murphy (1988) model of
rational addiction is a peak of the use of rationality in economics. Section 12.5 gives a behavioral
version of it. Qualitative evidence in favor of the model (the fact that future increase in prices
lower consumption today) are also consistent with this BR version - it shows that agent are at
  51
    To do that, formally, I use the variant of sparse max specified in Gabaix (2014, Section XV.D of the online
appendix), which specifies a diﬀerent attention for each type of action (formally, for each coordinate of the action
vector).


                                                        35
least partially rational (as in the present model), not that they are fully rational (as assumed by
Becker-Murphy). This distinction is important: if people are BR enough, they’d be better oﬀ under
a high tax, or a ban, of the addictive substance — while the optimal tax is 0 in the Becker-Murphy
model.52


7        Discussion
7.1       Model Enrichments
Here I discuss diﬀerent potential enrichments of the model; the online appendix (Section 15) dis-
cusses more. I discuss them at first in the context of the 3-period model of Section 4.1.

   What happens if the agent takes into account the future costs of thinking? One
could imagine that the agent will take into consideration the future costs of thinking in this decision,
and in the value function. Of course, this becomes a very sophisticated agent then — far from a
BR agent. However, for completeness, I explore this direction in the online appendix, Section 15.3.
The consequences are very minor.53 This is why I don’t incorporate this feature in the basic model.

   More sophisticated behavioral agents We can illustrate the degrees of sophistication of
Definition 3.8 in the 3-period model of Section 4.1. In the basic smax ( = 0), the time-1 value
                                     ¡     ¢
function is  =1(=0) (1  ) = 2 12+ . With one iteration, the time-1 value function is:
                            µ                       ¶ µ                              ¶
    =1(=1)                1 + ∗1 (1  2 )      1 + (2 − ∗1 (1  2 ))                            ¡ ¢
               (1  ) =                          +                                =  =1(=0) (1  )+ 2 
                                      2                            2

which gives the agent a more sophisticated understanding of his future actions.
    The value functions using  = 1 or  = 0 are the same, up to second order terms, and so are
all consumptions. In addition, ∗0 is the same under both models. Hence, as in Proposition 3.14,
the naive / sophisticated diﬀerence changes only second order terms. This is why I have selected
the naive case ( = 0 iterations) as the baseline case. It is simpler, more plausible cognitively, and
yields the same result as the sophisticated case, up to second order terms.54

    Enriched models of attention. Suppose that  is very negative, and the agent doesn’t see
it at first (still 0 +   0, so the agent can avoid starvation). Will the agent detect the starvation
    52
     This analysis is in the spirit of Gruber and Kőszegi (2001), who study a hyperbolic discounting addict, rather
than a boundedly rational one in the sense of this paper.
  53
     First, the basic smax agent does not change his action at all. What changes is on the the −iterated agent with
 ≥ 1. Second, in accordance with Section 3.5, this change makes only a second order change in the action.
  54
     Why not model iterated expectations, such as the agent’s perception at time 0 of his perception at time 2 of
his perception at time 5? The short answer is that this leads to a combinatorial explosion of the complexity of the
model. See Section 15.7.1.


                                                         36
that menaces him? Section 15.1 of the online appendix gives a simple fix, in which the attention at
time 1 becomes:               µ 2       ½¯ ³ ´¯         ¯ ³         ´¯¾¶
                        ∗               ¯ 00 1 ¯ 1 ¯ 00 1          ¯
                     1 = A         max ¯         ¯  ¯        + ¯
                                2              2             2
for some   1. In the second term of the max, the agent takes into account the extra income .
One could imagine other variants as well, which are discussed in Section 15 of the online appendix.


7.2     Frequently Asked Questions
    How do markets clear? They clear as usual: prices adjust so that supply equals demand.55
We need at least one agent, in each market, to pay some attention to the price. For instance,
in the Cass-Koopmans model of Section 5, firms pay attention to the interest rate (in their loan
demand), even though consumers might potentially not pay attention to the interest rate (in their
loan supply). So,  =  0 ( ) survives, but the Euler equation doesn’t.

   Does the model only generate underreaction? The model most directly gives under-
reaction, but can indirectly generate overreaction.56 Suppose that an analyst sees a company 
with a surge in profits. She’ll increase her estimate of its value. However, suppose that she forgets
that the competitors of company  will try to imitate it, this way eroding ’s future profit (see
Hanson and Greenwood 2015). The analyst overreacts to the surge in profits because she neglected
the competition’s response. More generally neglecting mitigating factors (i.e., negatively correlated
additional eﬀects) leads to overreaction. Likewise, a consumer overreacts to an income shock if she
underpays attention to the fact than that shock is very transitory.

    What about other types of dynamic problems, with discrete actions? To have a
viable path to bounded rationality, or artificial intelligence, we need environments with enough
structure.57 Here, I rely a particular structure: “smooth” environments, where actions and variables
are continuous, functions are smooth, and the world lives close to a well-understood steady state.
This means that this theory — in its present form — does not have much to say about discrete
environments with essentially no structure, like the traveling-salesman problem.58 Fortunately,
worlds with smooth structure are very relevant in economics, especially macro-finance, and the
present framework allows us to make progress on those.
  55
     See Gabaix (2014, Section IV) for a systematic analysis in static contexts.
  56
     See also Hirshleifer, Lim and Teoh (2009).
  57
     There is no known good general-purpose algorithm for worlds with no structure and high dimensionality. There
may not be any, if  6=   . Also, one will never be able to calculate the cognitive cost of the “rational limit” while
problem  6=?   is open; most experts think it is likely to remain open for decades.
  58
     One could imagine that some variant could be helpful, e.g. by smoothing or doing a convex relation of discrete
problems.




                                                          37
    What happens with developed financial markets? For instance, in the life-cycle problem
of Section 2, what would happen if the  was securitized (so that not just bonds, but also claims
on  can be traded)? Here are some short remarks — I plan to oﬀer a serious treatment of sparse
finance in a future paper. First, all basic arbitrages are excluded: as  is deterministic, if  is not
priced at its fair value, there’s an infinite payoﬀ from trading it: so, agent will pay attention to that
arbitrage, and  will be traded at its fair value, . Second, even though the agent as an investor
may fully take  into account, as a consumer he might not fully take it into account.59

    Can’t one explain anything with bounded rationality? Let us observe that traditional
economics models, when free, can “explain almost anything”. For instance, the Arrow-Debreu
model has a great many degrees of freedom. However, there are two disciplines (besides intuition,
a soft form of empirical knowledge): hard empirical constraints on the parameters (e.g. on the
production functions) and constraints on the number of free parameters that can be tuned around
an agreed-upon baseline model.
    I adopt the same attitude here. Take the life-cycle model of Figure 1. There is one free parameter
(̄) to fit a whole lifetime: the model is parsimonious. Next, the model is tightly constrained in its
prediction: it can only gives shapes similar to the ones in the Figure 1: first consumption is flat,
then declines before retirement, drops at retirement, and is flat thereafter.
    This said, there are many extensions that one can think about to enrich the sparse agent (e.g.
varying defaults, persistence in attention, heterogeneity in rationality etc.). It means that it’s a
framework with intriguing features worth exploring. But to keep the parsimony, I think it is useful
to coalesce around a very simple default structure. Here I reported a minimalist one with I found
useful across a range of problems.

    Isn’t there much arbitrariness in terms of the “default”, and what can non-attended
to? The Bayesian counterpart of the “default” is the “prior.”60 There is no good theory of the
“prior,” but researchers still move on with “reasonable” priors. Likewise, in information economics
researchers posit what is known to the agent and what information requires a mental cost.
    The situation with sparsity and its default is very similar. I use “reasonable” default and try to
make “reasonable” assumptions about what is perfectly perceived (e.g. time ) and is not (income
after retirement).
    An open question for much of economics is a way to systematize such “intuitively reasonable”
choices. In the meantime, despite the fact that the model needs inputs, the model produces a good
amount of value added, e.g. in Figure 1.
  59
    See Proposition 6.1 and its discussion.
  60
    The default is a deterministic point estimate (which is useful to model bounded rationality), the prior is a
probabilistic distribution.




                                                      38
   As there is one way to be rational, and many ways to be boundedly in rational
theory, how do we know how to proceed? It is true that there are many ways to deviate
from pure rationality, but some are much more important than others (perhaps they are on a power
law, like so many things). Here, I focus of one feature: people use a simplify their picture of the
world. There are others (e.g. loss aversion, hyperbolic discounting) and together they constitute a
useful account of major deviations from pure rationality.

    This agent is quite sophisticated — almost Bayesian. How do we account for big
mistakes then? We can try to account for big mistakes and miscalibrations in at least two ways.
First, agents don’t have good priors (“hyperparameters” in hierarchical Bayes models) on which
information is useful. For instance, they (ex post faultily) don’t think that thinking about future
retirement will help them much, that “it’s just too hard”. 61 Second, they could have a high cost
of cognition in some domains: in the “proportional thinking” specification of Section 10.2.2, agent
eliminate considerations that matter for less than 5% of the decision (̄ = 5% then). A medium-run
research goal is to measure more systematically attention and costs of cognition, informed by models
such as the present one.62
    Furthermore, sparse agents display only intermediate sophistication. This paper diﬀers from
models that demand Bayesian updating, with optimal use of information (and agents pay optimal
costs to acquire it, e.g. as in Veldkamp 2010). Behavioral agents like my sparse agents do not do
Bayesian updating.63 For instance, if they see their income go up, Bayesian agents should infer
“probably, the interest rate is high” (as income and interest rates tend to have positive correlation),
but sparse agents don’t do that inference.

    Are those agents easier or more complex to use than rational agents? Historically,
behaviorally agents have often been more diﬃcult to use (for the economist deriving their actions)
than rational agents. However, sparse agents are often easier to use. For instance, they don’t need
to solve the full equilibrium in their head — they use a sensible consumption rule (e.g. (51)), which
may not be exactly optimum in their context, but does guide them through life. Also, they may
use a reduced number of variables (e.g. their decision depends on two variables rather than 20).
Hence, they are easier to use.
  61
     Farhi-Gabaix (2015, Section 6.1) discusses models with suboptimal allocation of attention.
  62
     See Chetty, Looney and Kroft (2009), Brown, Hossain and Morgan (2010), Allcott and Taubinsky (forth.),
Taubinsky and Rees-Jones (2015) for recent progress.
  63
     It would be interesting to formalize systematically a form of “lazy pseudo-Bayesian updating”, but I diﬀer that
to future research.




                                                        39
8      Literature Review
This paper builds on two strands of the literature: on a relatively recent strand of basic behavioral
modelling and on an older set of ideas tailored to specific macroeconomic contexts.
    One key diﬀerence here is that the model is quite systematic. It applies, in a unified manner,
to a wide class of models. This generality is possible because I build on earlier work (Gabaix 2014)
that developed a quite systematic way to think about boundedly rational optimization in static
contexts. There, I proposed a “sparse max”, a behavioral, less than fully rational and attentive
version of the traditional max operator. That paper was concerned with static cases, while here I
explore dynamic ones. That paper allows to give a behavioral formulation of some basic chapters of
the microeconomic textbooks (consumer theory, equilibrium theory, Arrow-Debreu). The present
paper gives a behavioral version of basic chapters of the macroeconomics textbook. A related
paper, Farhi and Gabaix (2015) proposes a behavioral version of textbook taxation theory. Hence,
we have a more unified view of bounded rationality in micro and macro, whereas other papers, while
insightful, are more piecemeal.
    The “micro” sparse max relies on a strand of paper thinking about basic behavioral modelling, in
particular inattention, salience. See, for instance, Bordalo, Gennaioli and Shleifer (2013), Chetty,
Looney and Kroft (2009), Gabaix and Laibson (2006), Kőszegi and Szeidl (2013), Schwartzstein
(2014) and Woodford (2012).
    The “macro” dimension of the sparse max relates to papers which oﬀer a variety of devices to
model some form of bounded rationality and are tailored to macro contexts (see Veldkamp (2011)
and Woodford (2013) for reviews). To examine the pros and cons of models, I use the following
criteria in Table 1:

    1. Do the models also apply to bounded rationality in static contexts? If the goal (which is mine,
       at least) is to have a quite unified way of talking about bounded rationality in both static
       (e.g., doing static consumer theory with  goods) and dynamic contexts, this is a desirable
       property.

    2. Can the model keep a representative agent? This is very desirable, as most clean theory keeps
       the representative agent (or at most a small number of types of agents).

    3. Do we keep deterministic actions, or do actions have to be random?

    4. Do we have source-dependent inattention?

    5. Is the model Bayesian? Most economists would think it’s a good feature. As the goal is to
       explore bounded rationality, I submit that it is worthwhile to entertain non-Bayesian models.

    6. Can the model handle a tractable behavioral version of a general textbook static problems,
                                                 P
       like max1   (1    ) s.t.     = ? A tractable dynamic model handling general


                                                   40
                                   Table 1: Diﬀerent Models of Myopia


                                 BR in         Rep.        Determ. Source           Bayesian Textbook
                                 static        agent       actions dependent                 micro
                                 contexts      allowed             attention
       Rule-of-thumb             No            No          Yes     Yes              No           No
       Hyperbolics               No            Yes         Yes     No               Yes          No
       Credit constraints        No            No          Yes     No               Yes          No
       Imperfectly updated info. No            No          Yes     Yes              Yes          No
       Noisy info.               Yes           No          No      Yes              Yes          No
       Entropy penalty           Yes           No          No      No               Yes          No
       BGS salience              Yes           Yes         Yes     Yes              No           No
       Sparsity                  Yes           Yes         Yes     Yes              No           Yes


         problems such as (24) should a fortiori be able to work in static context. Only the sparse
         max is — so far — able to do that. Other approaches might do that, but now they appear too
         complicated to do so.

     Rule-of-thumb consumers. Campbell and Mankiw (1989) assume that a fraction  are “rule-
of-thumb” consumers who just consume their current income,  = ̄ + ̂ . Those agents could
be interpreted as “super-sparse,” and pay attention to no other variables, while perceiving in-
come shocks as being fully persistent.64 In a sense, this research vastly generalizes the Campbell-
Mankiw agents, which have proved a useful benchmark. Hence, aggregate consumption is ̂ =
                  P
̂ + (1 − ) ̄  ≥+1 1− ̂ , and we do obtain the higher MPC for current income than for dis-
counted future income.
     Hyperbolic consumers. Laibson (1997) models hyperbolic consumers (fully rational or fully
naive), and O’Donoghue and Rabin (2001) model partially naive consumers. There are some key
diﬀerences. One is that a hyperbolic consumer is still a wealth-maximizer, so his consumption
function depends only on the present value of future income, without a higher marginal propensity
to consume out of current rather than future income (Barro 1999) — unless they are credit constrained
(then hyperbolicity amplifies the eﬀect of credit constraints). Another is that sparse agents have
source-dependent myopia, unlike (the most common) hyperbolic consumers.
     Credit constrained consumers. Those consumers are rational, but credit constrained now or in
the near future. As a result, their MPC out of current income is higher than out of future income. A
big diﬀerence with sparse agents is that again sparse agents have source-dependent myopia. Hsieh
(2003) provides evidence for source-dependent myopia: his consumers consume “regularly arriving”
government transfers (from the Alaskan oil fund) rationally (see however Kueng 2015), but react in
a myopic way (high MPC) to other transitory income shocks.
  64
    Actually, the “fully” persistent part is not necessary. It is enough that the agent’s consumption is an aﬃne
function of their current income (and perhaps wealth), to the exemption of forward-looking variables.


                                                      41
     Imperfectly updated information. Agents update their information set every now and then, e.g.
when hitting a threshold, at fixed or random time intervals (Caballero 1995, Gabaix and Laibson
2001, Mankiw and Reis 2002, Reis 2006, Abel, Eberly and Panageas 2013) or in other imperfect
ways (Sargent 1993, Furster, Hébert and Laibson 2012, Schwarzstein 2014). This captures a real
phenomenon, but does not apply to the most basic setup, e.g. static ones. Those models are also
very complex in rich environments.
     Other behavioral models of salience. Bordalo, Gennaioli and Shleifer (BGS, 2013) are pursuing
an influential research program modeling the impact of “salience” in a vast number of settings (see
also Kőszegi and Szeidl (2011)). In a rough sense, their salience transforms initial variables 
into salience-adjusted variables   , with a salience function diﬀerent determining the  (which
can be greater than 1) in a way diﬀerent from the sparsity setup, but related to it (also, sparsity
concentrates on continuous actions, BGS on discrete choices). Modulo this change, and the current
proposal should apply to BGS’ setup, making it dynamic.
     Entropy penalty. In the Sims (2003) approach to inattention, the penalty is an entropy penalty,
which results in parsimonious (but very complex to solve, see Matejka and Sims (2010)) models,
which do not allow for source-dependent inattention. Other papers (Maćkowiak and Wiederholt
(forth.), Woodford (2012)) deviate from this doctrine by accepting source-dependent inattention.
Even though there are many diﬀerences of details, there is a common spirit. In noisy-signal theory
actions are stochastic: the same problems lead to stochastic actions by agents. As a result, we
lose the representative agent in the noisy-signals models. It can be recovered by taking linear
approximations. In contrast, in sparsity theory actions are deterministic, which is one factor making
this model easier to analyze. In addition, and relatedly, the sparsity model applies well to basic
micro (Gabaix 2014), which is so far too diﬃcult for noisy-signal models.
     Near rational approach. The “near rational” approach says that agents will lose at most  utils:
it is often useful (Akerlof and Yellen 1985, Chetty 2012, Kueng 2015, Parker 2015), but it does not
oﬀer a precise model of which actions people will take. The statistics used by the sparsity model
are those of the near rational approach (utility losses as in (10)), but sparsity makes a definite
prediction about agents’ actions.
     The Hansen-Sargent (2007) robustness framework generates distorted subjective beliefs; they
exhibit a sophisticated form of risk aversion and pessimism, but not myopia and simplification per
se.


9    Conclusion
I presented a practical way to do boundedly rational dynamic programming. It is portable and
tractable and sheds light on a number of puzzles reviewed in the introduction. Given that it is easy
to use and sensible, this model may be useful to study other issues in macroeconomics and finance.



                                                 42
10         Appendix: Complements
10.1        Tools to Expand a Simple Model Into a More Complex one
   Calculating the marginal impact of a new variable:  ,  Here I develop the method
to derive the Taylor expansion of a richer model, when starting from a simpler one. The methods
are entirely paper and pencil. They draw from the techniques surveyed by Judd (1998, Chapter
14), who has a more computer-based perspective.
   The state variables evolve according to:

                                     0 =   (  ) , 0 =   (  )

where the 0 denote next-period variables. Also,  is stable around 0:   ( 0 ) = 0.
   Consider the fully rational model:

                        ( ) = max  (  ) + E  (  (  )    (  ))                   (68)
                                      

                                                                            0
       We start with a simpler model, where  is always 0:  ≡ 0,   = 0, i.e.
                                                              ³ 0           ´
                               () = max  ( 0 ) + E    ( 0 )
                                            


We use the notation, for a function ( ),

                                            =   + ( )   ()                                     (69)

which is the total derivative with respect to , e.g. the full impact of a change in , including the
impact it has on a change in the action .65

       Bellman method

Lemma 10.1 The impact of a change  on the value function and its derivative is, respectively:

                                   + 0 0  (  )
                            =                                                                              (70)
                                        1 − 
                                    +  [ ( 0 ) 0 0 (0  0)] + 00 
                                                                                      
                            =                                                                            (71)
                                                     1 −   0
                                               ¡          ¢
where all derivatives are evaluated at ( ) =  ()  0 .
  65
    The notations are a bit awkward when variables are multidimensional, and can be made clearer by using tensors.
To keep things elementary, I don’t explicitly use tensors here.




                                                        43
   Proof The proof yields the general method of calculation. We shut down uncertainty and
diﬀerentiate the rational Bellman equation (68), first with respect to the new variable  (using the
envelope theorem):
                                 ( ) =  + 0 0  + 00 

which yields the announced expression for  . Then we take the total derivative w.r.t. :

                    ( ) =   +  [0 0  (  )] +  0 0 0  0 + 00  

so
                                           +  [ ( 0 ) 0 0 (0  0)] + 00  
                          ( 0) =                                                             
                                                          1 −   0
¤

Lemma 10.2 Assume the local autonomy condition (32),  = 0, and consider some value function
 ( ). Then, the impact of a change  on the optimal action is (around  = 0):

                                                       = −Ψ−1
                                                              Ψ                                                    (72)

with Ψ ( ) =  + 0 0  , and

 Ψ =  +  0 0 0  + 0 0 
                                        
                                                     Ψ =  +  0 0 0  +  0 0 0  + 0 0 
                                                                                                                 
                                                                                                                     (73)
                      ¡         ¢
evaluated at ( ) =  ()  0 . They depend only on the transition functions and the derivatives
of the simpler baseline value function   (0 ).

         Proof The FOC for  is Ψ ( ) = 0 with
                                                                     0            0
                                          Ψ ( ) =  + 0 0  + 00 

                                                                                                           0
The rest follows by the implicit function theorem: terms in  drop out because  = 0 around
the default action. ¤
    When the local autonomy condition (32) doesn’t hold, a term  appears. Then, the situation
is more complex, and requires solving for a fixed point, in the form of a matrix Ricatti equation.

    Feynman-Kac method In some cases, it is useful to do the same via a Feynman-Kac type
of approach.66 Here we view  as exogenous, i.e. assume +1 =   ( ). Calling  the initial
    66
         I call it “Feynman-Kac” because this approach deals particularly well with stochastic problems.




                                                             44
condition for wealth, the Lagrangian is:

                X
                ∞                               X
                                                ∞
                         
          =              (     ) +            (− +   (−1  −1  −1 )) + 0 (−0 + )
                 =0                            =1


where  =  ( ) are the Lagrange multipliers. At the optimum, the agent solves  () =
max(  )≥0 . This implies that  =  = 0. The envelope theorem gives:
                                             £                                               ¤
                               =  =    (     ) + +1
                                                                     
                                                                         +1 (    )

so that, using the total derivative notation (69),

                               h ¡                    ¢                           ¡                   ¢       i
       0 =                     ( ) | =0 +  (+1 ) +1      ( ) | =0
                      0 |=0

or in short
                                                 X
                                                 ∞
                                                                 £                    ¤
                                      0 =                   + +1  +1
                                                                               +1 
                                                                                                                     (74)
                                                 =0
                                                             0
   Application. In the consumption problem with  = 1, let us derive again at the impact of a
one-time change of interest rate ̂ from Lemma 4.2. Under the default model  = 0 and  = 0 .
                                            ¡        ¢−
   
So  0
        = 1,  = 0,  ( ) = 0 ( ) =  +     , and given  +1 = (1 +  ) ( −  ) + ̄,

                                                              + ̄    − ̄   −
                                  +1   =  −  =  −          =         =
                                                                                

using the notation − :=  − ̄ for the beginning of period wealth. Using (74) gives:
                                 " µ            ¶− − #           "µ            ¶−     #
                                      +1 +            1         +1 + 
               0   =                         = +2                    −
                                                                      
                                µ                          ¶
                             1      ̄ −−1 +1 −     −     1 −−1 ³       ̄ −      ´
                        = +2 − +1               +     = +2 0     − 0 + 0
                                                                       

as under the default model  = 0 . As time-0 consumption satisfies 0 = 0 , we have  ̂ 0 =
̂ 0 , and
                                       ¡                ¢
          ̂           1
                             −−1
                         +2 0
                                        − ̄ 0− + 0             1 ³ ̄ −       ´    1 ³                 ´
 ̂ 0 =  0 =                                               =            − 0   =        (0 − ̄) − 0 
                                 −−−1
                                       0
                                                                   +2  0            +2 

which gives again Lemma 4.2 (the income part being easy as always).




                                                                   45
10.2      Extension: Proportional Thinking and Scale-Free 
Here are some notes for a practical use of the model.

10.2.1     Using the model without 

First, one could imagine directly measuring . For instance, take the basic life-cycle model of
Section 2. Suppose we had data on retirement saving, one could measure the  of say high-
educated people vs less educated people, at diﬀerent points in time . That would be interesting.
This way, we could back out the correct attention function, or see its determinants over time — a
useful research enterprise.
     Second, suppose that we keep  as a more basic parameter, and measure  it — for one given type
of decision. For instance, in the life-cycle model, one could study just one variable, consumption,
fitting a  for it, say over a lifetime.
     One important diﬃculty is that  is not “scale-free” — it depends on the units of utility. To
remedy that problem, I discussed earlier a “scale-free ” (Gabaix 2014), which I state and generalize
here.

10.2.2     Scale-free  and Proportional Thinking

    Scale-free parametrization with a one-dimensional action Suppose first that there is
just a one-dimensional action. The following formulation is easy to microfoundation, and proves
sensible and convenient:67
                                       ¡ ¢2 ¯ ¡ ¡          ¢¢¯
                                  = ̄ ¯    ¯                                  (75)

where ̄ is a unitless parameter, which might portable from one situation to the next (Rabin (2013)
advocates such portability of parameters). Here  is the “natural” or “typical scale” of the action.
In music,  means the “natural” pitch of a note, so perhaps it’s a mnemonic symbol for the “natural
scale” of variable).
    What is a natural scale? In many cases, this is reasonably clear. If the action is a purchase
 in dollar of good , then  =  . If the action is a transform  ( ) of that purchase, then
      ¯ ¡ ¢¯
 = ¯ 0  ¯  . As a result, if we consider log consumption, the natural scale is  = 1.68
  67
     Section 15.5 provides a microfoundation,
                                    √              which I outline here. Mental eﬀort creates trembling in the action,
                                            P
with a standard deviation  = 2̄ (   ( ))12 proportional to the typical scale of the action (as in much of
psychophysics, e.g.Pin the Weber-Fechner law), and increasing in mental activity . The resulting utility losses are
then −1       2
       2   =       ( ) with the value of  in (75).
  68
     In addition, if  is presented as belong to a natural range  ∈ [ ] (as in many lab experiments): then we can
take  = 12 (| + | + | − |), which reflects the absolute value of the midpoint, and the width of the range. In other
                                          12
contexts, we can take  =  ( ()) .




                                                           46
      Formulation (75) implies that attention to dimension  is:69
                                                        Ã £ ¤!
                                                         E 2
                                                = A
                                                           (̄ )2

In turns, we obtain a rule (with A = A1 ): “Keep only dimensions of reality that matter for more
than ̄ of the typical scale  of the decision”.
    For instance, a reasonable parameter might be ̄ = 5%. People then eliminate all considerations
that matter for less than 5% of the decision, whether it is for a small decision (e.g., buying at the
supermarket) or a big decision (e.g., buying a car).
    Some evidence consistent with that is presented by Samuelson and Zeckhauser (1988), who
show similar percentage price dispersion between cheap and expensive goods, and by Tversky and
Kahneman (1981): people consider a $5 discount more worthy of an extra shopping trip if it is for a
$15 calculator than for a $125 jacket. Bordalo, Gennaioli and Shleifer (2013) and Bushong, Rabin
and Schwartzstein (2015) have emphasized the importance of this proportional thinking.
    I conjecture that this feature is a good benchmark which would be interesting to evaluate
empirically (I do not claim it will work perfectly, but I conjecture that it will hold more likely than
the polar opposite prediction that people would be 100 times more precise for a good that costs 100
times more).

    Scale-free parametrization with many actions. We can generalize the idea above to many
actions. To do that, formally, I use a variant of sparse max, which specifies a diﬀerent attention for
each type of action (formally, for each coordinate of the action vector).70

Definition 10.3 (Sparse max: scale-free with action-specific attention). When it is scale-free, with
action-specific attention, the sparse max smax
                                              ;|  (  ) is defined as¡follows.
                                                                                   ¢
    Step 1: For each dimension  of the action, the attention vector  =  =1 is given by:

                                              X 1 ¡ ¢2             ¡      ¢2
                         ∗ = arg min          [  (1 −  )2 + ̄  ( )]               (76)
                                    ∈[01]
                                              
                                                 2

Step 2: The −th dimension of the action (∗ ) is the optimal under the model  , given the other
dimensions of actions (∗− ) .
                                                        ¡¡         ¢       ¢
                                      ∗ ∈ arg max        ∗−                         (77)
                                                  

 69
      I use ∗ = A (−E [   ] ), from (10).
 70
      See Gabaix (2014, Section XV.D of the online appendix)




                                                        47
       Practically, Definition 10.3 yields an explicit formula for attention:
                                                      ⎛ h¡ ¢2 i ⎞
                                                        E 
                                                
                                                = A ⎝             ⎠                                         (78)
                                                         (̄ )2

and a first order condition for action is, for each :71
                                                     ¡          ¢
                                                   ∗    = 0                                          (79)

   In conclusion: based on the psychological evidence on proportional thinking, it seems plausible
that the above formulation will calibrate reasonable well, with one scale-free parameter ̄, which I
conjecture to be around ̄ = 5% — if people omit factors that matter by less than 5%.
   For concreteness, here is an example. Suppose that there are two actions, 1 , 2 , and:
                                                                Ã                    !2
                                                    1X                 X
                                                       2
                                                                    
                                        ( ) = −             −          
                                                    2 =1               


where   0 is a scale,  is a vector. Then, the attention-augmented utility function is  (  ) =
    P       ¡      P            ¢2
− 12 2=1   −     . The basic sparse max yields:
                                     µ                    ¶    Ã 2              !
                                                        1       1 X ¡  ¢2 2
                                = A −E [   ]     =A          
                                                                =1
             P
and  =           
                    .   In contrast, the scaled sparse max of Definition 10.3 gives:
                                       µ                        ¶    Ã ¡ ¢2           !
                                          £                 ¤ 1         
                                                                               2
                                                                                  1
                                 = A −E           =A            2
                                                                       ( ) ̄2
                                                                           


          P
and  =     for  = 1 2. Here, the attention is independent of  : for action , the agent
makes sure to include all considerations  that makes him change his decision by more than ̄ times
the typical scale  .


10.3        Complements: Life-cycle model with  periods
Here are some more precisions to see how the intuitive procedure of Section 2 is an outcome of the
general formalism. The action is consumption  and the state vector is

                                                     = (   )
  71
    If several actions are possible (which is not a generic situation) then for instance we take one closest to the
default action by some metric.


                                                           48
Note that ∗ := ( − ) b is the objective value, so 0 = (0  ∗  0). But it is useful to consider  a
variable.
     The objective laws of motion are expressed in   (  )72 . So, the rational agent at time  solves
 = arg max  (  ), with  defined in (3):  (  ) :=  () +   ( + ̄ −    + 1).
     For the behavioral agent, the attention-augmented law of motion is   (  ) :=   (   )
before retirement (for   ): only  is misperceived. After retirement, I assume correct perception,
  (  ) :=   ( ).73 The proxy value function is   =   (equation (2)). Then, Definition 3.4
gives:
                          = arg smax  (   ) with  (   ) :=  (    )           (80)

    When we apply the sparse max of Definition 3.1. Step 1 gives the value of  in (6). Step 2
gives the value of  in (6).


11         Appendix: Proofs
The online appendix contains most proofs.

                                                                                                                 P
    Proof of Lemma 3.3 The rational reaction function satisfies:  () =  +                                        +  ()
                        ¡    ¢
for a function  () =  kk2 . So,  =  and:
                                               µ                     ¶      µ           ¶
                                                                               
                                      ∗   =  1                       =  1
                                                        ·                · 
                                                                                           ¡    ¢
   We shall use the notation  () :=  ((∗  )=1 ), which also satisfies  () =  kk2 . The
sparse reaction function is:

               () = arg max  ( ∗1 1   ∗  ) =  (∗1 1   ∗  )
                            
                            X                                              X           µ            ¶
                                   ∗               ∗                                        
                     = +          +  ((  )=1 ) =  +               1              +  ()
                                                                             
                                                                                             · 
                            X µ  ¶                                X µ  ¶                        ¡     ¢
                        
                     = +                   +  () =  + 
                                                                                        +  kk2 
                              
                                                                     
                                                                                      

    Proof of Proposition 4.3 Suppose first that the problem is deterministic. Given attention
   , the agent’s problem is identical to the rational agent’s problem, in a world in which the
  72
       Formally,
                                                  
                       (  ) =  + ̄ +        1≥ −  ,       (  ) = ,     (  ) =  + 1
                                                 −
  73
     Formally, there is an element of arbitriness: one could conceive a partial misperception of time , or misperception
income after retirement. A medium-run open question is a way to endogenize such “intuitively reasonable” choices.
Still, the model produces a lot of reasonable behavior “on its own”, e.g. in Figure 1.


                                                               49
true interest rate is ̄ +  ̂ , and true income is ̄ +  ̂ , and the transition function is the one
                                                          ¡             ¢
perceived by the agent. Hence, calling 0 0  (̂  ̂ ) ≥0 the rational consumption given flows
   ¡                     ¢     ³                           ´
0 0  (̂  ̂ ) ≥0 = 0 0  ( ̂   ̂ ) ≥0 . Using the Taylor expansion in Lemma 4.2 gives the
result. When the problem is stochastic, as in the proof of Lemma 4.2, we take the certain equivalent
at each period.

                                                                       
   Proof of Proposition 5.1 If  ≥  , we have 0 = +                     
                                                                   ≤ + =  , hence  =  0 
                                                                       
0 ≤  . If  ≥  then 0 = +   ≤ + , so that  =  0  0 ≤ + , and  ( + )  . Given

that  =  ( +  ), that implies    .                   ³ ´
   By (58)    implies that fluctuations in capital  ̂ are more volatile in the sparse
economy. Given  =  ( ) +  , we have ̂ = ( 0 (∗ ) + ) ̂ . So the same properties holds for
GDP fluctuations ̂ as capital ̂ , as the two are proportional.
   For consumption have ̂ = ( + ) ̂ , so  = ( + )  = ( + ) √2      
                                                                                     from (58). The latter
function is increasing in  for  ≥ . Hence,  is higher in the sparse economy ( ≤  ≤  ).
Next, ˆ = ̂ − ̂ = ( 0 (∗ ) +  − ( + )) ̂ = ( − ) ̂ , so ˆ = | − |  = | − | √2
                                                                                                       
                                                                                                          a
                                                              
U-shaped function of  with minimum at  = . So, if  ≤ , investment is more volatile in the
sparse economy.

    Proof of Proposition 5.2 In continuous-time limit, the second derivative of the value nor-
malized function  () := [ ()  +  ( +  − (1 +  )   +1 ) −  (   )]  is  =  ,
this is a quite general phenomenon. Applying (10) with  = 0 , we obtain:
                               µ          ¶        µ              ¶        µ ¶
                      | | 20 
                                  2
                                                 | | 20 2          20                       2
                = A                         =A                      =A       ,          :=
                                                   2                                        | | 2
                                                       ³                 ´
               2       2                                                          0
using (58),      =   2
                           .   Using  = 0  = 0 max 1 −       20
                                                                      0  , so  =   1+ 
                                                                                             
                                                                                         0




References
Abel, Andrew, Janice C. Eberly, and Stavros Panageas, “Optimal Inattention to the Stock Market
with Information Costs and Transactions Costs,” Econometrica, 81 (2013), 1455—1481.
    Acemoglu, Daron, Introduction to Modern Economic Growth (Princeton, NJ: Princeton Univer-
sity Press, 2008).
    Akerlof, George, and Janet Yellen, “Can Small Deviations from Rationality Make Significant
Diﬀerences in Economic Equilibria?” American Economic Review, 75 (1985), 708-720.
    Allcott, Hunt, and Dmitry Taubinsky, “Evaluating Behaviorally-Motivated Policy: Experimen-
tal Evidence from the Lightbulb Market,” American Economic Review (forthcoming).



                                                          50
    Alvarez, Fernando, Luigi Guiso and Francesco Lippi, “Durable Consumption and Asset Manage-
ment with Transaction and Observation Cost,” American Economic Review, 102 (2012), 2859-96.
    Auclert, Adrien, “Monetary Policy and the Redistribution Channel,” Working Paper, 2015.
    Baker, Malcolm, Stefan Nagel and Jeﬀrey Wurgler, “The Eﬀect of Dividends on Consumption,”
Brookings Papers on Economic Activity, 38 (2007), 231-292.
    Barberis, Nicholas, “Investing for the Long Run when Returns are Predictable,” Journal of
Finance 55 (2000), 225-264.
    Barberis, Nicholas, Andrei Shleifer, and Robert Vishny, “A model of Investor Sentiment” Journal
of Financial Economics 49 (1998), 307-343.
    Barro, Robert, “Are Government Bonds Net Wealth?” Journal of Political Economy, 82 (1974),
1095-1117.
    Becker, Gary S., and Kevin M. Murphy, “A Theory of Rational Addiction,” Journal of Political
Economy, 94 (1988), 675-700.
    Beshears, John , James Choi, David Laibson, Brigitte C. Madrian, and Sean Wang, “Who is
Easier to Nudge?” Working Paper, 2015.
    Bernheim, B. Douglas, Jonathan Skinner, and Steven Weinberg, “What Accounts for the Vari-
ation in Retirement Wealth among US Households?” American Economic Review, 91 (2001),
832-857.
    Bigio, Saki and Jennifer La’O, “Financial Frictions in Production Networks,” Working Paper,
Columbia Business School, 2015.
    Blanchard, Olivier and Stanley Fischer, Lectures on Macroeconomics (Cambridge, MA: MIT
Press, 1989).
    Bordalo, Pedro, Nicola Gennaioli and Andrei Shleifer, “Salience and Consumer Choice,” Journal
of Political Economy, 121 (2013), 803-843.
    Brown, Jennifer, Tanjim Hossain, and John Morgan, “Shrouded Attributes and Information
Suppression: Evidence from the Field.” Quarterly Journal of Economics 125 (2010), 859-876.
    Bushong, Benjamin, Matthew Rabin, Joshua Schwartzstein, “A Model of Relative Thinking,”
Working Paper, 2015.
    Caballero, Ricardo, “Near-Rationality, Heterogeneity, and Aggregate Consumption,” Journal of
Money, Credit and Banking 27 (1995), 29—48.
    Caballero, Ricardo, and Emmanuel Farhi, “The Safety Trap,” Working Paper, 2015.
    Campbell, John Y., and N. Gregory Mankiw, “Consumption, Income, and Interest Rates: Rein-
terpreting the Time Series Evidence,” NBER Macroeconomics Annual (1989), 185-216.
    Campbell, John and Luis Viceira, Strategic Asset Allocation (Oxford, UK: Oxford University
Press, 2002).
    Candès, Emmanuel, and Terence Tao, “Near-Optimal Signal Recovery from Random Projec-
tions: Universal Encoding Strategies?” IEEE Transactions on Information Theory, 52 (2006), 5406-
5425.


                                                51
   Carroll, Christopher, “Buﬀer-Stock Saving and the Life Cycle/Permanent Income Hypothesis,
” Quarterly Journal of Economics, 112 (1997), 1-55.
   Chetty, Raj, “Bounds on Elasticities with Optimization Frictions: A Synthesis of Micro and
Macro Evidence on Labor Supply,” Econometrica, 80 (2012), 969—1018.
   Chetty, Raj, Adam Looney, and Kory Kroft, “Salience and Taxation: Theory and Evidence,”
American Economic Review 99 (2009), 1145-1177.
   Cochrane, John, “The Sensitivity of Tests of the Intertemporal Allocation of Consumption to
Near-Rational Alternatives,” American Economic Review, 79 (1989), 319-337.
   Croce, Mariano, Martin Lettau, and Sydney C. Ludvigson, “Investor Information, Long-run
Risk, and the Term Structure of Equity,” Review of Financial Studies, 28 (2015), 706-742.
   Evans, George, and Seppo Honkapohja, Learning and Expectations in Macroeconomics (Prince-
ton, NJ: Princeton University Press, 2001).
   Farhi, Emmanuel and Xavier Gabaix, “Optimal Taxation with Behavioral Agents,” NBER
Working Paper 21524, 2015.
   Fuster, Andreas, Benjamin Hébert and David Laibson, “Natural Expectations, Macroeconomic
Dynamics, and Asset Pricing,” NBER Macroeconomics Annual, 26 (2012), 1- 48.
   Gabaix, Xavier, “A Sparsity-Based Model of Bounded Rationality,” Quarterly Journal of Eco-
nomics, 129 (2014), 1661-1710.
   Gabaix, Xavier, “A Behavioral New Keynesian Model” Working Paper, 2015.
   Gabaix, Xavier, and David Laibson, “The 6 Bias and the Equity Premium Puzzle,” NBER
Macroeconomics Annual, 16 (2002), 257—312.
   Gabaix, Xavier, and David Laibson, “Shrouded Attributes, Consumer Myopia, and Information
Suppression in Competitive Markets,” Quarterly Journal of Economics, 121 (2006), 505—40.
   Gabaix, Xavier, David Laibson, Guillermo Moloche and Stephen Weinberg, “Costly Information
Acquisition: Experimental Analysis of a Boundedly Rational Model,” American Economic Review,
96 (2006), 1043—1068.
   Ganong Peter and Pascal Noel, “How Does Unemployment Aﬀect Consumer Spending?” Work-
ing paper, Harvard, 2015
   Gourinchas, Pierre-Olivier and Jonathan A. Parker, “Consumption Over The Life Cycle,” Econo-
metrica, 70 (2002), 47-89.
   Greenwood, Robin, and Samuel G. Hanson, “Waves in Ship Prices and Investment,” Quarterly
Journal of Economics 130(2015), 55-109.
   Hall, Robert, E., “Stochastic Implications of the Life Cycle–Permanent Income Hypothesis:
Theory and Evidence,” Journal of Political Economy, 86 (1978), 971-987.
   Harris, Christopher, and David Laibson, “Hyperbolic Discounting and Consumption,” Proceed-
ings of the 8th World Congress of the Econometric Society, 2001.
   Harris Christopher, and David Laibson, “Instantaneous Gratification,” Quarterly Journal of
Economics, 128 (2013), 205-248.


                                              52
    Hirshleifer, David, Sonya Lim and Siew Teoh, “Driven to Distraction: Extraneous Events and
Underreaction to Earnings News,” Journal of Finance, 64 (2009), 2289-2325.
    Hong, Harrison, Jeremy C. Stein, and Jialin Yu, “Simple Forecasts and Paradigm Shifts,” The
Journal of Finance, 62.3 (2007), 1207-1242.
    Hsieh, Chang-Tai, “Do Consumers React to Anticipated Income Changes? Evidence from the
Alaska Permanent Fund,” American Economic Review, 93 (2003), 397-405.
    Johnson, David S., Jonathan A. Parker, and Nicholas S. Souleles, “Household Expenditure and
the Income Tax Rebates of 2001,” American Economic Review, 96 (2006), 1589-1610.
    Judd, Kenneth, Numerical Methods in Economics (Cambridge, MA: MIT Press, 1998).
    Kahneman, Daniel, Thinking, Fast and Slow (New York, NY: Farrar, Straus and Giroux, 2011).
    Kőszegi, Botond, and Adam Szeidl, “A Model of Focusing in Economic Choice,” Quarterly
Journal of Economics, 128 (2013), 53—104.
    Krusell, Per and Anthony Smith, “Rules of Thumb in Macroeconomic Equilibrium: A Quanti-
tative Analysis,” Journal of Economic Dynamics and Control 20 (1996), 527-558.
    Krusell, Per and Anthony Smith, “Income and Wealth Heterogeneity in the Macroeconomy,”
Journal of Political Economy, 106 (1998), 867-896.
    Kueng, Lorenz, “Explaining Consumption Excess Sensitivity with Near-Rationality: Evidence
from Large Predetermined Payments,” NBER Working Paper 21772, 2015.
    Laibson, David, “Golden Eggs and Hyperbolic Discounting,” Quarterly Journal of Economics,
112 (1997), 443-477.
    Ljungqvist, Lars and Thomas Sargent, Recursive Macroeconomic Theory (Cambridge, MA: MIT
Press, 2012).
    Lucas, Robert E, “Econometric Policy Evaluation: A Critique,” Carnegie-Rochester Conference
Series on Public Policy, 1 (1976), 19-46.
    Lusardi, Annamaria, “Americans’ Financial Capability,” NBER Working Paper 17103, 2011.
    Lusardi, Annamaria, Daniel Schneider, and Peter Tufano, “Financially Fragile Households: Ev-
idence and Implications,” Brookings Papers on Economic Activity, (2011), 83-134.
    Maćkowiak, Bartosz and Mirko Wiederholt, “Business Cycle Dynamics Under Rational Inatten-
tion,” Review of Economic Studies, forthcoming.
    Mankiw, N. Gregory and Ricardo Reis, “Sticky Information Versus Sticky Prices: A Proposal
To Replace The New Keynesian Phillips Curve,” Quarterly Journal of Economics, 117 (2002),
1295-1328.
    Matejka, Filip and Christopher Sims, “Discrete Actions in Information-Constrained Tracking
Problems,” Working Paper, Princeton University, 2010.
    Merton, Robert, “Optimum Consumption and Portfolio Rules in a Continuous-Time Model,”
Journal of Economic Theory, 3 (1971), 373-413.
    Modigliani, Franco, and Richard H. Brumberg, “Utility Analysis and the Consumption Function:
an Interpretation of Cross-Section Data,” in Kenneth K. Kurihara, ed., Post-Keynesian Economics


                                              53
(New Brunswick, NJ.: Rutgers Univeresity Press, 1954), 388—436.
    Mullainathan, Sendhil, Joshua Schwartzstein, and Andrei Shleifer, “Coarse Thinking and Per-
suasion,” Quarterly Journal of Economics, 123 (2008), 577—619.
    O’Donoghue, Ted, and Matthew Rabin, “Choice and Procrastination,” Quarterly Journal of
Economics, 116 (2001), 121-160.
    Pagel, Michaela, “Expectations-Based Reference-Dependent Life-Cycle Consumption,” Working
Paper, Columbia, 2014.
    Parker, Jonathan, “Why Don’t Households Smooth Consumption? Evidence from a 25 Million
Dollar Experiment,” Working Paper, MIT, 2015.
    Prescott, Edward, and Rajnish Mehra, “Recursive Competitive Equilibrium: The Case of Ho-
mogeneous Households,” Econometrica, 48.6 (1980), 1365-79.
    Rabin, Matthew, “Incorporating Limited Rationality into Economics,” Journal of Economic
Literature, 51(2013), 528-43.
    Reis, Ricardo, “Inattentive Consumers,” Journal of Monetary Economics, 53 (2006), 1761-1800.
    Romer, David, Advanced Macroeconomics, (New York, NY: McGraw-Hill, 2012).
    Samuelson, W. and Richard Zeckhauser, “Status Quo Bias in Decision Making,” Journal of Risk
and Uncertainty, 1 (1998), 7—59.
    Sargent, Thomas J, Bounded Rationality in Macroeconomics, (Oxford, UK: Oxford University
Press, 1993).
    Schwarzstein, Joshua, “Selective Attention and Learning,” Journal of the European Economic
Association, 12 (2014), 1423-1452.
    Sims, Christopher, “Implications of Rational Inattention,” Journal of Monetary Economics, 50
(2003), 665—690.
    Simsek, Alp and Ricardo Caballero, “Fire Sales in a Model of Complexity,” Journal of Finance,
68.6 (2013), 2549-2587.
    Thaler, Richard H, “Mental Accounting and Consumer Choice,” Marketing Science, 4 (1985),
199-214.
    Tibshirani, Robert, “Regression Shrinkage and Selection via the Lasso,” Journal of the Royal
Statistical Society B, 58 (1996), 267—288.
    Tversky, Amos, and Daniel Kahneman, “The Framing of Decisions and the Psychology of
Choice,” Science, 211.4481 (1981), 453-458.
    Veldkamp, Laura, Information Choice in Macroeconomics and Finance (Princeton: Princeton
University Press, 2011).
    Wachter, Jessica, “Asset Allocation,” Annual Review of Financial Economics 2 (2010), 175-206.
    Woodford, Michael, “Inattentive Valuation and Reference-Dependent Choice,” Working Paper,
Columbia, 2012.
    Woodford, Michael, “Macroeconomic Analysis Without the Rational Expectations Hypothesis,”
Annual Review of Economics, 5 (2013), 303—46.


                                               54
