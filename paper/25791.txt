                               NBER WORKING PAPER SERIES




    PREDICTING HIGH-RISK OPIOID PRESCRIPTIONS BEFORE THEY ARE GIVEN

                                        Justine S. Hastings
                                          Mark Howison
                                          Sarah E. Inman

                                       Working Paper 25791
                               http://www.nber.org/papers/w25791


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                            April 2019, Revised August 2019




We thank Miraj Shah for contributions to the project; Tom Coderre, Brandon Marshall, Susan Athey,
and participants at the NBER conference on Machine Learning in Healthcare for helpful comments;
and the Office of the Governor of Rhode Island and the Rhode Island Executive Office of Health and
Human Services for supporting this research. We thank the Smith Richardson Foundation and the
Laura and John Arnold Foundation for financial support. The views expressed herein are those of the
authors and do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2019 by Justine S. Hastings, Mark Howison, and Sarah E. Inman. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
Predicting High-Risk Opioid Prescriptions Before they are Given
Justine S. Hastings, Mark Howison, and Sarah E. Inman
NBER Working Paper No. 25791
April 2019, Revised August 2019
JEL No. D61,I1,I12,I18,Z18

                                         ABSTRACT

Misuse of prescription opioids is a leading cause of premature death in the United States. We use
new state government administrative data and machine learning methods to examine whether the
risk of future opioid dependence, abuse, or poisoning can be predicted in advance of an initial
opioid prescription. Our models accurately predict these outcomes and identify particular prior
non-opioid prescriptions, medical history, incarceration, and demographics as strong predictors.
Using our model estimates, we simulate a hypothetical policy which restricts new opioid
prescriptions to only those with low predicted risk. The policy’s potential benefits likely
outweigh costs across demographic subgroups, even for lenient definitions of “high risk.” Our
findings suggest new avenues for prevention using state administrative data, which could aid
providers in making better, data-informed decisions when weighing the medical benefits of
opioid therapy against the risks.

Justine S. Hastings                             Sarah E. Inman
Brown University                                Columbia University
Department of Economics                         School of International and Public Affairs
64 Waterman Street                              420 West 118th Street
Providence, RI 02912                            New York, NY 10027
and NBER                                        sei2112@columbia.edu
justine_hastings@brown.edu

Mark Howison
Research Improving People's Lives
1 Park Row, Suite 401
Providence, RI 02903
mhowison@ripl.org




A data appendix is available at http://www.nber.org/data-appendix/w25791
1 Introduction

   Prescription opioids rank among the highest in terms of potential for dependence, abuse, and poisoning.
In 2016, more Americans under the age of 50 died from drug overdoses than from car crashes or gun
violence, a trend driven by increases in opioid overdoses (1). However, opioids may also be an important
therapy for those who suffer from chronic pain. The majority of those prescribed opioids do not experience
adverse outcomes; a survey of studies of opioid use found that rates of misuse, abuse, and addiction averaged
between 8 percent and 12 percent (2). This rate is, however, higher than an early (and widely cited) claim
that less than 1 percent of hospitalized patients receiving narcotics developed an addiction (3).

   Moreover, many of those suffering from adverse outcomes were introduced to opioids through a
legitimate opioid prescription. One study of six years of medical and pharmacy claims found that 79.9
percent of opioid abusers had a prescription prior to their first abuse diagnosis (4). Of the opioid abusers
who did not themselves have a prior prescription, 50.8 percent had a family member with a prior
prescription.
    Given the risks and long-term consequences of adverse outcomes following legitimate opioid
prescriptions, many providers now report a lack of confidence in managing their patients’ chronic pain
through opioid therapy (5). Providers could benefit from better information on the risks of initiating a
patient on opioid therapy, especially when that patient has never received an opioid prescription before.
    Prior studies have identified risk factors for opioid abuse and dependence through descriptive analysis
and statistical modeling of both medical claims and electronic health records (6–10), and two studies have
also evaluated the predictive performance of such models (11, 12). However, these studies focus on
individuals already receiving opioid therapy and describe prescription patterns which are indicative of
dependency and misuse within this subpopulation. Previous research has not yet developed a predictive
model that is applicable to the larger population of potential recipients of opioid therapy.
    In this study, we use novel integrated administrative data to estimate models of adverse opioid-related
outcomes for Medicaid enrollees in Rhode Island and conduct policy simulations of restricting opioid
prescriptions to only those with low predicted risk. By some estimates, the opioid epidemic created $5.5
billion in additional health care costs to the Medicaid program nationally in 2013 (13). Estimating our
model on state administrative data provides an avenue for state policymakers to predict the risk associated
with prescribing opioids to any potential Medicaid enrollee, which could be used to inform providers’
                                                      2
treatment decisions.

       We use de-identified administrative records from the State of Rhode Island housed in a secure data
enclave (14, 15). Personally identifiable information has been removed and replaced with anonymous
identifiers so that researchers with approved access can join and analyze records associated with the same
individual while preserving anonymity. Because this study does not involve data that is both identifiable
and private, Brown University’s Institutional Review Board does not classify it as research with human
subjects. The database includes Medicaid records from 2005 to 2017, and data on major social benefit and
insurance programs, employment, incarceration, and criminal history. We construct a panel data set of
70,153 individuals who received an opioid prescription in the Medicaid pharmacy claims between 2006 and
2012, out of 400,024 distinct Medicaid enrollees in this period. Further details are in Appendix Section 2
and Table S4.

       We define an adverse opioid-related outcome as receiving a diagnosis of opioid dependence, abuse, or
poisoning 1, or receiving treatment for an opioid use disorder in the five years following initial prescription.
Figure S3 shows the cumulative frequency of adverse outcomes from the time of initial prescription, which
peaks at 6.0 percent by year five.

      We construct variables from observations in the twelve months prior to when an individual receives an
opioid prescription. These include 71 variables for demographics, incarceration, citations, arrests, car
crashes, wages, unemployment rates, household composition, and payments received from social benefit
and insurance programs.
      We construct 489 variables from Medicaid claims and enrollment records, for a total of 560 variables, as
follows. First, we observe 8,494 distinct diagnosis codes and 6,507 distinct procedure codes in the Medicaid
claims data. We use natural language processing topic modeling techniques to consolidate the codes into
200 topics, based on the codes’ text descriptions and frequency. The topic models reduce the dimensionality
of the diagnosis and procedure codes and model their co-occurrence. For example, the ten most frequent
words in topic number 195 are “movements thoracic back accidents overexertion strenuous ligament neck
site lumbar.” The variable for topic number 195 measures how strongly this combination of diagnoses and
procedures for accidental back and neck injury is represented in each individuals’ medical history. Details


1
    This includes both opioid and heroin poisoning. See Appendix Section 2.2 for details.



                                                                 3
on the topic modeling implementation appear in Appendix Section 3.1.

    Second, the pharmacy claims data include 39,805 distinct drug product codes. We use existing
pharmacological classifications to consolidate these into prior prescriptions indicators for 262 drug
categories.

    We estimate predictive models using machine learning algorithms which search over variables and
functions of those variables to maximize out-of-sample predictive fit. These algorithms vary in complexity
and interpretability (16), so we fit three kinds of models: a regularized regression, an ensemble, and a neural
network. The complexity of regularized regressions is limited to functions of variables the researcher
specifies in advance. However, each variable’s contribution to prediction is easily interpreted. At the other
extreme, neural networks can adaptively model complex non-linearities and interactions between variables,
potentially delivering a higher predictive fit, but with greatly reduced interpretability (17).

    For the regularized regression, we use a LASSO which searches over a large number of variables to
identify the subset yielding highest out-of-sample predictive fit. The model is easily interpretable through
a post-LASSO regression on the selected variables. However, the large set of variables we construct may
include highly correlated pairs of variables, and a single LASSO could arbitrarily select one variable from
such a pair. Therefore, we use a bootstrapped LASSO (BOLASSO) which retains the variables that are
consistently selected among 100 bootstrap replicates (18). For the ensemble model, we average the pre-
dictions across these 100 bootstrap replicates. For the neural network, we use a recurrent neural network
which can explicitly model the time dependence of the variables (19). Appendix Section 4 contains details
on model implementation.

    We use the model predictions to describe the potential costs and benefits of a hypothetical policy that
identifies high-risk individuals before their initial prescription, prevents those prescriptions, and (we assume)
also prevents their adverse outcomes. Such a hypothetical policy is supported by recent findings that
predictive screening tools for opioid use disorder help primary care providers improve clinical outcomes
(20), and by advice that clinicians consider patient risk before initiating opioid therapy (21). It also has
similarities to the Centers for Disease Control’s Patient Review and Restriction Program for limiting opioid
prescriptions (22).

    To simulate policy impact, we define a predicted risk threshold above which the policy would restrict
opioid prescriptions. The costs and benefits then depend on how accurately our model classifies individuals

                                                       4
at this threshold. We define two costs: CA denotes the cost to an individual and to society of an adverse

outcome, and CH denotes the hassle cost an individual experience from receiving an alternative therapy to

opioid therapy. Assuming the policy will prevent adverse outcomes, it will save the cost CA − CH for each

True Positive (TP ) who is predicted as high-risk and would have had an adverse outcome. False Positives

(FP ) accrue CH because they are incorrectly classified as high-risk and prevented from obtaining an opioid
prescription. The policy misses the potential savings of CA for the false negatives, those who are incorrectly
classified as low-risk but have an adverse outcome. However, there is no net change since these costs would
accrue in the absence or presence of the policy. Finally, the true negatives are predicted as low-risk, do not
have an adverse outcome, and accrue neither cost.

   The net benefit of the hypothetical policy is, therefore, TP (CA − CH ) − FP · CH . It is positive when

TP/(FP + TP ) > CH /CA. This captures the tradeoff between model accuracy (the True Positive Rate)

and the “cost ratio” CH /CA. If the hassle cost CH is low relative to the adverse outcome cost CA, then it
will be beneficial to intervene with more individuals by setting a lower risk threshold and accepting a lower
degree of classification accuracy. We use this framework to illustrate hypothetical policy tradeoffs and to
measure fairness across marginalized subpopulations.



2 Results

2.1 Predictive performance

    A common metric for assessing the performance of a machine learning model is the area under the
receiver- operating characteristic curve (AUC). The AUC measures the probability that, given two randomly
chosen individuals with different outcomes, the model will correctly assign a higher risk to the individual
with the adverse outcome. A perfect classifier has an AUC of 1, and a classifier that chooses at random has
an AUC of 0.5.
        Our models achieve AUCs of 0.754 (95% C.I. 0.740 - 0.771) for the BOLASSO, 0.781 (95% C.I.
0.7690.795) for the LASSO ensemble, and 0.793 (95% C.I. 0.780 – 0.808) for the neural network. The
gains to the neural network are small and not significantly different from the LASSO ensemble; the loss in
interpretability does not deliver gains in predictive power.
        Figure 1 shows the distribution of true outcomes by predicted risk decile for each model. Within


                                                     5
the top three risk deciles, the fraction of true outcomes predicted by all of the models is greater than the
base rate of outcomes among the entire population, which is 0.06.

2.1 Interpreting model results

    Figure 2 shows the distribution of odds ratios from the post-BOLASSO regression for the 89 variables
which the BOLASSO model selected as the strongest, consistent predictors from the full set of 560 variables
across the 100 bootstrap replicates. BOLASSO helps to identify consistent covariates, avoiding arbitrary
choices among highly correlated pairs. While the coefficients on the selected variables do not necessarily
have a causal interpretation, they pick up factors which are strong predictors among observables. For
example, observed claims for routine preventative health may themselves lower risk through increased or
more frequent interactions with medical professionals, or they may proxy for attention to personal health or
responsibility which is the true unobserved underlying factor that reduces risk. In a predictive model, our
primary goal is to understand the observables that predict risk so we can design more effective policy.
Understanding these predictors can, however, also point us in the direction of potential causal relationships
and underlying mechanisms for further study.

    Overall, the variables with the largest odds ratios were release from prison (1.929), and prior
prescriptions for antipsychotics (1.317), centrally-acting muscle relaxants (1.296), benzodiazepines
(1.213), and opiate agonists (1.196). Individuals who were released from prison in the prior year are
estimated as 92.9 percent more likely to have an adverse outcome if given an initial prescription, all else equal.
The coefficient on opioid agonists indicates that prior prescriptions from drugs such as cough syrups and
mild painkillers with small dosages of an opioid ingredient (see Table S5) are positive risk factors, even
though these drugs are not considered strong enough for chronic opioid therapy.

    Variables with the smallest odds ratios (indicating decreased risk) were enrollment in Medicaid with a
payer code for the Rhode Island Pharmaceutical Assistance to the Elderly program (0.008 – indicating an
almost complete reduction in risk), the categorically-needy Medicaid eligibility criterion (0.136), Hispanic
race (0.245), missing race (0.305), and missing marital status (0.350). Because we use modal race and
marital status across all administrative sources, these missing indicators are likely proxies for individuals
who are enrolled only in Medicaid and not in other state services where race and marital status are reported.
    The majority of variables (72) are derived from Medicaid records. Of these, four are derived from
Medicaid enrollment characteristics (such as eligibility criteria), one is total pharmacy payments, and four

                                                       6
are for prior prescriptions. The remainder of the Medicaid predictors are diagnosis/procedure topics. Some

of the significant themes among the selected topics include: injuries and pain (+); mental health (+); HIV (+);
cardiovascular health (+); contraceptives (-); tobacco and alcohol use (+); cancer (-); routine examinations
(-); and mammograms (-).


2.2 Cost ratio

    Figure 3 shows the break-even cost ratio CH /CA at which the hypothetical policy is cost neutral across
cumulative risk deciles using predictive risk from the neural network model. In the top risk decile, the
break-even ratio is 0.233: it is net beneficial to recommend against opioid prescriptions for individuals in
the top decile if the CH is less than 23.3 percent of CA. It is net beneficial to intervene with the entire

population if CH is less than 6.0 percent of CA.

    The existing literature provides guidance on reasonable estimates for CH and CA. In 2015, 33,091
people died from drug overdoses involving opioids (23), and 2,375,000 individuals over the age of 12 had an
opioid use disorder (24). The U.S. Department of Transportation’s Value of a Statistical Life is $10.1 million.
Florence et al. (13) estimate the aggregate annual societal cost of an opioid use disorder to be $61,297
(including additional cost of health care, substance abuse treatment, lost productivity, and criminal justice
activities). Weiss and Rao (25) estimate a 50 percent recovery probability after one year of medication-
assisted treatment. Using these statistics, with the simplifying assumption that once an individual receives
a prescription, they either overdose resulting in death, become dependent but successfully recover after one
year of treatment, or continue to be dependent for ten years, we estimate a ballpark present discounted value

of $450,000 for CA.
    Hassle costs are more difficult to quantify. They may include lost productivity due to chronic pain after
receiving an alternative therapy. The economic cost of pain in the United States is conservatively estimated
at $560 to $635 billion (2010 dollars), with a value of lost productivity from $299 to $335 billion (26).
Treating pain compassionately is a moral imperative for physicians, who must balance protecting those
experiencing chronic pain with the significant risk of harm that opioids can cause individuals, their families,
and their communities (27).
    However, recent research suggests that opioid therapy may not be more effective at pain relief than non-
opioid therapy in both the short- and long-term. A randomized trial comparing opioid therapy to non-


                                                      7
opioid therapy for acute short-term pain found similar levels of pain relief between the two treatments (28).
Observational studies of restricting opioid therapy and offering non-opioid therapy over longer periods of
time also show no advantage for opioid treatment in terms of pain relief, with some patients on higher-
potency opioids reporting more psychological impairment than those on lower-potency opioids (29, 30).

    This suggests that the CH is likely lower than $104,850 (23.3 percent of $450,000), meaning that a low
risk threshold that maximizes true positives at the cost of increased false positives could be optimal. These
findings support a belief among some within the medical community that the risks of opioid prescription
outweigh the benefits in many cases of prescription outside of cancer or palliative care (31). A benefit of
structuring our cost-benefit analysis in terms of the cost ratio is that a risk threshold can easily be reevaluated
as better data on these costs become available.


2.3 Fairness

    In addition to evaluating the costs and benefits of the hypothetical policy, our model can help
policymakers examine measures of “fairness” – the extent to which the benefits versus costs of a policy
accrue disproportionately to marginalized groups. The model’s false discovery rate (FDR) provides such a
measure. It is defined as the fraction of false positives among all individuals who are predicted to have an
adverse outcome. Figure 4 shows the FDR in the highest risk quintile by race, incarceration history, and
disability status.
    While members of minority groups (African-American, Hispanic) have a higher point estimate for FDR
in the highest risk quintile of our model, the variance in the estimates is high and the difference is not
significant. The previously incarcerated have a significantly lower FDR, and there is no significant difference
by disability status. Therefore, we do not find evidence of unfairness using the FDR.



3 Discussion

    Prevention and treatment policies can be complementary approaches to opioid use disorders. Treatment
can help the many individuals already suffering from adverse outcomes, while prevention can stem the
growth of new cases of opioid dependence, abuse, or poisoning.
    The proven standard treatment for opioid use disorder is medication-assisted treatment (MAT) (32–
34). However, it faces two significant hurdles. First, MAT is not widely available to those with opioid use
                                                        8
disorders; only 36 percent of substance abuse treatment facilities offering one of three different kinds of
medication treatment (35). Second, even when those suffering from opioid use disorders can be connected
to treatment, the costs associated with treatment are high and recovery from an opioid use disorder is
challenging. The probability of recovery after a year of MAT is estimated at 50 percent (25).

    Prevention strategies can help prevent further cases of opioid use disorder. Current strategies are
primarily designed around reducing the quantity or potency of opioid prescriptions to curb misuse and
prevent poisoning among those with existing opioid use disorders. 2 These strategies are especially
complementary to a treatment approach. A recent study suggests that limiting opioid availability for those
with an existing disorder may increase the use of illicit drugs such as heroin. 3

    The most widespread approach to preventing misuse by those with a disorder has been the deployment
of state-level prescription drug monitoring programs (PDMPs). These electronic data systems present data
on the prescription history of controlled drugs to providers, and are now in use in almost every state (34).
They have been shown to reduce prescription rates of opioids and increase provider comfort in prescribing
opioids, as providers can be reassured that they are not enabling risky opioid-related behaviors such as
doctor shopping or overlapping prescriptions (38, 39).

    These strategies are reactive rather than proactive; they target individuals who have already begun
opioid treatment and have likely developed dependency based on risky prescription behavior. Our models
complement these policies by providing an opportunity to predict high-risk prescriptions among the larger
population of potential patients who have yet to be given an initial opioid prescription.

    Our models and hypothetical policy aim to prevent dependency before it occurs. This is complementary
to existing efforts and could make use of the infrastructure already in place, such as the PDMPs. For
example, a PDMP could implement our modeling approach to show providers a risk categorization for all
patients (e.g. a red, yellow, or green indicator for predicted risk). This could increase information available
to providers, expand the population covered by the PDMP, and help providers consider the benefits and risks
of initiating opioid therapy with a new patient.


2
  For example, a major health insurer’s effort to reduce extended-release oxycodone prescription by requiring prior authorization,
which led to an increase in the rate of short-acting opioid prescriptions and no overall change in the total morphine milligram
equivalents prescribed (36).
3
  Abuse-deterrent reformulations of prescription opioids were developed to make it more difficult to crush or dissolve pills to
release the drug more quickly. Unfortunately, recent evidence suggests that the introduction of abuse-deterrent prescription opioids
into the market caused opioid abusers to substitute away from prescription opioids to heroin, with differential increases in fatal
heroin poisonings (37).

                                                                9
    A limitation of our study is that it is restricted to the population of Medicaid enrollees. Expanding the
study to a data source such as an all-payers claims database would improve representativeness by including
Medicare enrollees and the privately insured. However, a strength of restricting our study to the Medicaid
population is our ability to securely join claims data to additional administrative records, which could be
challenging with an all-payers claim database.
    Our definition of adverse outcomes is limited by the accuracy of diagnosis codes in the Medicaid records.
In particular, prior studies have found that opioid-related diagnoses can be underreported because of their
potential stigma (40, 41). To address this limitation, we added an adverse outcome based on procedure codes
for the treatment of opioid use disorder, which could indicate an adverse outcome even in the absence of a
diagnosis.

    Including treatment as an indicator of adverse outcomes is also a limitation. As noted in prior work,
receiving treatment for an opioid use disorder is a positive outcome conditional on already having a disorder
(41, 42). However, the goal of this study is to suggest opportunities for prevention by examining whether
individuals at a high risk of developing an adverse outcome can be identified with confidence before they
are given a prescription using administrative data. This complements important research being done on
successfully treating opioid use disorders after they have occurred (43).



4 Conclusion

    The opioid epidemic is a complex public health challenge for which prevention and treatment are
complementary approaches. Our results demonstrate the feasibility of a new approach to prevention based
on intervening with high-risk initial prescriptions through predictive modeling. Our data-driven, machine-
learning approach to modeling adverse outcome risk provides new insights into the benefits, costs, and fair-
ness of policies limiting opioid prescriptions. Intervening at the earliest stage, before an individual receives
an initial opioid prescription, has the potential to prevent future treatment costs and recovery challenges and,
ultimately, the life-long consequences of opioid use disorders.




                                                      10
Acknowledgments
We thank the Smith Richardson Foundation and the Laura and John Arnold Foundation for financial support.
We thank Miraj Shah for contributions to the project; Susan Athey, Tom Coderre, Brandon Marshall, and
participants at the NBER conference on Machine Learning in Healthcare for helpful comments; and the
Office of the Governor of Rhode Island and the Rhode Island Executive Office of Health and Human Services
for supporting research to improve fact-based policymaking.
   Data are available through individual data sharing agreements with each of the following Rhode Island
agencies and municipal police departments: RI Department of Corrections, RI Department of Labor and
Training, RI Executive Office of Health and Human Services, RI State Police, Central Falls Police De-
partment, Cranston Police Department, Cumberland Police Department, Middletown Police Department,
Narragansett Police Department, Providence Police Department, Warwick Police Department, Woonsocket
Police Department.
        AHFS® Pharmacologic/Therapeutic Classification© used with permission. © 2017, the American
Society of Health-System Pharmacists, Inc. (ASHP). The Data is a part of the AHFS Drug Information®;
ASHP is not responsible for the accuracy of transpositions from the original context.




                                                    11
     References
 [1] Kaplan S (2017) C.D.C. Reports a Record Jump in Drug Overdose Deaths Last Year. The New York Times (Nov. 3, 2017).

 [2] Vowles KE, et al. (2015) Rates of opioid misuse, abuse, and addiction in chronic pain: a systematic review and data synthesis.
     Pain 156(4):569–576.

 [3] Porter J, Jick H (1980) Addiction rare in patients treated with narcotics. New England Journal of Medicine 302(2):123.

 [4] Shei A, et al. (2015) Sources of prescription opioids among diagnosed opioid abusers. Current Medical Research and Opinion
     31(4):779–784.

 [5] Pearson A, Moman R, Moeschler S, Eldrige J, Hooten WM (2017) Provider confidence in opioid prescribing and chronic pain
     management: results of the Opioid Therapy Provider Survey. Journal of Pain Research 10:1395–1400.

 [6] White AG, Birnbaum HG, Schiller M, Tang J, Katz NP (2009) Analytic models to identify patients at risk for prescription opioid
     abuse. American Journal of Managed Care 15(12):897–906.

 [7] Sullivan MD, et al. (2010) Risks for possible and probable opioid misuse among recipients of chronic opioid therapy in
     commercial and medicaid insurance plans: The TROUP Study. Pain 150(2):332–339.

 [8] Palmer RE, et al. (2015) The prevalence of problem opioid use in patients receiving chronic opioid therapy: computer-assisted
     review of electronic health record clinical notes. Pain 156(7):1208–1214.

 [9] Yang Z, et al. (2015) Defining Risk of Prescription Opioid Overdose: Pharmacy Shopping and Overlapping Prescriptions Among
     Long-Term Opioid Users in Medicaid. Journal of Pain 16(5):445–453.
[10] Brat GA, et al. (2018) Postsurgical prescriptions for opioid naive patients and association with overdose and misuse: retro-
     spective cohort study. BMJ 360:j5790.

[11] Dufour R, et al. (2014) Understanding predictors of opioid abuse: predictive model development and validation. American
     Journal of Pharmacy Benefits 6(5):208–216.

[12] Hylan TR, et al. (2015) Automated Prediction of Risk for Problem Opioid Use in a Primary Care Setting. Journal of Pain
     16(4):380–387.

[13] Florence CS, Zhou C, Luo F, Xu L (2016) The economic burden of prescription opioid overdose, abuse, and dependence in the
     United States, 2013. Medical Care 54(10):901–906.

[14] Hastings JS, Howison M, Lawless T, Ucles J, White P (2019) Unlocking Data to Improve Public Policy. OSF Preprints 28krq.
     Preprint, posted March 15, 2019.

[15] Hastings J (2019) Fact-Based Policy: How Do State and Local Governments Accomplish It? The Hamilton Project (Brookings
     Institution) Policy Proposal 2019-01.

[16] Hastie T, Tibshirani R, Friedman J (2009) The Elements of Statistical Learning. (Springer-Verlag, New York), second edition.

[17] LeCun Y, Bengio Y, Hinton G (2015) Deep learning. Nature 521(7553):436–444.

[18] Bach FR (2008) Bolasso: Model Consistent Lasso Estimation Through the Bootstrap in Proceedings of the 25th International
     Conference on Machine Learning, ICML ’08. (ACM, New York, NY, USA), pp. 33–40.

[19] Hochreiter S, Schmidhuber J (1997) Long Short-Term Memory. Neural Computation 9(8):1735–1780.

[20] Lee C, Sharma M, Kantorovich S, Brenton A (2018) A Predictive Algorithm to Detect Opioid Use Disorder: What Is the Utility
     in a Primary Care Setting? Health Services Research and Managerial Epidemiology 5:1–8.

[21] Agarin T, Trescot A, Agarin A, Lesanics D, Decastro C (2015) Reducing Opioid Analgesic Deaths in America: What Health
     Providers Can Do. Pain Physician 18(3):E307–E322.

[22] Centers for Disease Control and Prevention (2013) Patient Review & Restriction Programs: Lessons learned from state Medicaid
     programs, Technical Report CS240524.


                                                                     12
[23] National Institute on Drug Abuse (2017) National Overdose Deaths from Select Prescription and Illicit Drugs.
     https://www.drugabuse.gov/sites/default/files/overdose data 1999-2015.xls (Accessed March 25, 2019).

[24] Center for Behavioral Health Statistics and Quality (2017) 2016 National Survey on Drug Use and Health: Detailed Ta- bles.
     https://www.samhsa.gov/data/sites/default/files/NSDUH-DetTabs-2016/NSDUH-DetTabs-2016.pdf (Accessed March 25, 2019).

[25] Weiss RD, Rao V (2017) The Prescription Opioid Addiction Treatment Study: What have we learned. Drug & Alcohol
     Dependence 173:S48–S54.

[26] Gaskin DJ, Richard P (2012) The Economic Costs of Pain in the United States. The Journal of Pain 13(8):715–724.

[27] Califf RM, Woodcock J, Ostroff S (2016) A Proactive Response to Prescription Opioid Abuse. New England Journal of
     Medicine 374(15):1480–1485.

[28] Chang AK, Bijur PE, Esses D, Barnaby DP, Baer J (2017) Effect of a Single Dose of Oral Opioid and Nonopioid Analgesics on
     Acute Extremity Pain in the Emergency Department: A Randomized Clinical Trial. JAMA 318(17):1661–1667.

[29] Shimoni Z, Varon D, Froom P (2018) Minimal Use of Opioids for Pain Relief in an Internal Medicine Department. Southern
     Medical Journal 111:288–292.

[30] Elsesser K, Cegla T (2017) Long-term treatment in chronic noncancer pain: Results of an observational study comparing opioid
     and nonopioid therapy. Scandinavian Journal of Pain 17(1):87–98.

[31] Chou R, et al. (2009) Clinical Guidelines for the Use of Chronic Opioid Therapy in Chronic Noncancer Pain. The Journal of Pain
     10(2):113–130.e22.

[32] Barry CL (2017) Fentanyl and the Evolving Opioid Epidemic: What Strategies Should Policy Makers Consider? Psychiatric
     Services 69(1):100–103.

[33] Mohlman MK, Tanzman B, Finison K, Pinette M, Jones C (2016) Impact of Medication-Assisted Treatment for Opioid Addiction
     on Medicaid Expenditures and Health Services Utilization Rates in Vermont. Journal of Substance Abuse Treatment 67:9–14.

[34] Volkow ND, McLellan AT (2016) Opioid Abuse in Chronic Pain — Misconceptions and Mitigation Strategies. New England
     Journal of Medicine 374(13):1253–1263.

[35] Mojtabai R, Mauro C, Wall MM, Barry CL, Olfson M (2019) Medication Treatment For Opioid Use Disorders In Substance Use
     Treatment Facilities. Health Affairs 38(1):14–23.

[36] Barnett ML, et al. (2018) A Health Plan’s Formulary Led To Reduced Use Of Extended-Release Opioids But Did Not Lower Overall
     Opioid Use. Health Affairs 37(9):1509–1516.

[37] Alpert A, Powell D, Pacula RL (2017) Supply-Side Drug Policy in the Presence of Substitutes: Evidence from the Introduction of
     Abuse-Deterrent Opioids, (National Bureau of Economic Research), Working Paper 23031.

[38] Lin DH, et al. (2017) Physician attitudes and experiences with Maryland’s prescription drug monitoring program (PDMP).
     Addiction 112(2):311–319.

[39] Wen H, Schackman BR, Aden B, Bao Y (2017) States With Prescription Drug Monitoring Mandates Saw A Reduction In Opioids
     Prescribed To Medicaid Enrollees. Health Affairs 36(4):733–741.

[40] Carrell DS, et al. (2015) Using natural language processing to identify problem usage of prescription opioids. International Journal
     of Medical Informatics 84(12):1057–1064.

[41] Barocas JA, et al. (2018) Estimated Prevalence of Opioid Use Disorder in Massachusetts, 2011–2015: A Capture–Recapture
     Analysis. American Journal of Public Health 108(12):1675–1681.

[42] Hadland SE, et al. (2018) Receipt of Timely Addiction Treatment and Association of Early Medication Treatment With Retention
     in Care Among Youths With Opioid Use Disorder. JAMA Pediatrics 172(11):1029–1037.

[43] Green TC, et al. (2018) Postincarceration Fatal Overdoses After Implementing Medications for Addiction Treatment in a Statewide
     Correctional System. JAMA Psychiatry 75(4):405–407.



                                                                     13
              Figure 1: The fraction of true outcomes by risk decile in the test sample.
                   0                       0.1                               0.2                               0.3


              1



              2



              3



              4
Risk Decile




              5



              6



              7



              8



              9                                                   Neural Network
                                                                  BOLASSO Regresion Ensemble
              10
                                                                  Post-BOLASSO Regression
    Note: The vertical black line indicates the base rate of outcomes among the entire population, which is 0.06.




                                                         14
                         Figure 2: Odds ratios from the post-BOLASSO regression.
                    2
                                                      Released from a corrections facility


                  1.75
 Increased Risk




                   1.5



                                                      Prior prescription for Atypical Antipychotics
                  1.25
                                                      Rhode Island monthly unemployment rate
Odds Ratio




                                                      Size of household

                    1
                                                          Medicaid claims and enrollment
                                                          Social benefit and insurance programs
                  0.75
                                                          Employment
 Decreased Risk




                                                          Incarceration and criminal justice
                   0.5                                    Demographics


                                                      Ethnicity is Hispanic
                  0.25



                                                      Enrolled in the RI Pharmaceutical Assistance to the
                    0
                                                      Elderly Program

                                 Note: The full regression output is available in Table S6.




                                                            15
                                 Figure 3: The break-even cost ratio by cumulative risk decile.
                           0.3




                          0.25
  Break-even Cost Ratio




                           0.2




                          0.15




                           0.1




                          0.05




                            0
                                    1      2      3      4      5      6        7         8         9         10

                                                      Cumulative Risk Decile
Note: The break-even cost ratio is the point at which the hypothetical policy becomes cost neutral. If the hassle cost
 is less than this ratio times the adverse outcome cost, than the policy will be net beneficial. Lower hassle costs are
required to make the policy net beneficial among lower risk scores. Error bars indicate the 95% confidence interval
                                        calculated from 100 bootstrap replicates.




                                                               16
                               Figure 4: The false discovery rate for the highest risk quintile.

                         1.0


                         0.9


                         0.8
  False Discovery Rate




                         0.7


                         0.6


                         0.5


                         0.4


                         0.3


                         0.2


                         0.1


                         0.0
                                  African-American



                                                           Hispanic




                                                                                   Yes




                                                                                                  Yes
                                                                      White




                                                                                             No




                                                                                                           No


                                                     Race/Ethnicity                Incarcerated     Disabled
Note: The false discovery rate is defined as the fraction of false positives among all individuals who are predicted to
 have an adverse outcome, which is the population that the hypothetical policy would affect. Error bars indicate the
                         95% confidence interval calculated from 100 bootstrap replicates.




                                                                              17
Appendix
1 Experimental Design
Our objective was to define a panel of Rhode Island Medicaid recipients who received an initial opioid
prescription under Medicaid coverage; define adverse outcomes of opioid dependence, abuse, or poisoning;
and model and assess the accuracy of predictions of adverse outcomes using information known only prior
to the initial prescription. Data were split into randomly-sampled training, validation, and testing sets using
the ratio 50:25:25 at the beginning of the study. We report the results of model predictions on the testing
set, which was withheld from analysis prior to the preparation of the manuscript.

Data are from the period 2005-2017, and include Rhode Island administrative records from the Department
of Human Services (DHS), Department of Labor and Training (DLT), Department of Corrections (DOC),
Medicaid program (under the Executive Office of Health and Human Services), and police agencies
(including the Rhode Island State Police and eight municipal police departments).

Although our data span the years 2005 to 2017, we construct a panel of individuals with initial prescriptions
between 2006 and 2012 to allow for the construction of variables a year before the initial prescription and
to define outcomes up to five years after the initial prescription.

2 Panel and Outcome Definitions
2.1 Opioid Prescriptions

To define our panel, we first establish which pharmacy claims correspond to opioid prescriptions. The
primary identifier for the dispensed drug is a standardized 11-digit National Drug Code (NDC) from the
U.S. Food and Drug Administration’s NDC Directory.1 This directory is only available as a current
snapshot, and because our claims data start in 2005, there are many unmapped NDCs to the current
directory. Out of approximately 14.8 million pharmacy claims between 2006 and 2012, only 66.8 percent
join to the current directory. Therefore, we construct a historical NDC directory using a data mining
framework that downloads and collates all available Internet Archive snapshots of the FDA’s NDC website
since 2000.2 This historical directory also includes full ingredient lists for each NDC, standardized to
milligrams. Using this improved directory, 88.1 percent of pharmacy claims between 2006 and 2012 map
to an NDC entry.

We define an opioid prescription as any claim for a drug containing an opioid ingredient at or above the
recommended starting dose when initiating opioid therapy for chronic pain management, as established in
Washington State’s 2015 prescribing guideline and further cited in the Centers for Disease Control’s 2016
prescribing guideline.3,4 Table S1 lists these ingredients and the minimum amounts we use to define an
opioid drug. Of the 4,359 drugs containing one of these ingredients, 4,175 meet the minimum threshold
amount and appear in 3.9 percent of claims.

Additionally, we define a recovery prescription as any NDC containing one of four ingredients commonly
used in medication-assisted treatment of an opioid use disorder, which identifies 412 such drugs that appear
in 0.5 percent of claims. These prescriptions may indicate that an individual has a preexisting opioid use
disorder.

2.2 Outcomes




                                                      18
For each individual in our panel, we examine all of the Medicaid claims following their initial opioid
prescription to construct indicator variables for four types of adverse outcomes: opioid dependence, opioid
abuse, prescription-opioid poisoning and heroin poisoning. We include heroin poisoning as an outcome
given the increasing use of heroin among those who abuse opioids, and the high proportion (greater than
80 percent) of joint heroin-prescription-opioid users who abused opioids prior to using heroin.5

We determine these outcomes from the claim’s International Classification of Diseases (ICD) diagnosis
codes, which are used by medical professionals to classify a patient’s health conditions following an
encounter. Because our data span the transition from the ICD-9 to ICD-10 classification, we include
diagnosis codes from both. Table S2 lists the exact codes used to indicate each of these four diagnosis-
related outcomes.

Not everyone with an opioid use disorder receives a diagnosis code. Though it is unknown precisely what
fraction of opioid use disorders go undiagnosed, Carrell et al. found that diagnosis codes were missing for
as many as a quarter of patients for whom their providers were aware of opioid abuse.6 Similarly, a study
by Barocas et al. estimated that only 44% of individuals with opioid use disorder were identified as such in
claims and administrative records.7 To address the challenges with diagnoses codes, we define a fifth
treatment outcome using procedure codes related to the treatment of opioid use disorder, and more generally
for drug rehabilitation and detoxification (Table S2). Finally, we define a sixth “any" outcome as the union
of any of the diagnoses or treatment outcomes, to capture as broad a population of individual with opioid
use disorder as possible. Data and measurement limitations notwithstanding, our model demonstrates that
administrative data can be combined to form an accurate prediction of these outcomes, suggesting a feasible
path forward for utilizing data to inform prescription risk. Figure S3 shows the accumulating fraction of
adverse outcomes over the five-year period following initial prescription.

2.3 Final Panel

Out of 400,024 distinct Medicaid enrollees between 2006 and 2012, our panel initially contains 74,213
individuals who received at least one opioid prescription in that period. We exclude 511 individuals who
received a recovery prescription before their initial opioid prescription, since this indicates they may have
been seeking treatment for an opioid use disorder. We exclude 3,549 individuals with an adverse outcome
prior to their initial opioid prescription, since we assume they were already receiving opioids from another
source, such as through private insurance before enrolling in Medicaid. Our final panel includes 70,153
individuals. Table S4 shows the incidence of adverse outcomes among these individuals by baseline
characteristics.

3 Variable Construction
We construct variables that summarize information known in the 12 months prior to the individual’s initial
prescription.

Using the demographics from the integrated RI 360 database,8 we construct variables for (modal) age, sex,
race, marital status, body mass index, and median income and fraction below the federal poverty line in the
home Census block group. Using DHS data, we construct variables for household size and new births in
the household, and monthly payments for the Supplemental Nutrition Assistance Program (SNAP), the
Temporary Assistance for Needy Families (TANF), the General Public Assistance (GPA), the Child Care
Assistance Program (CCAP), and State Supplemental Payment portions of Supplemental Security Income
benefits. Using DLT data, we construct indicators for sector of work derived from the first two digits of
industry codes assigned according to the North American Industry Classification System (NAICS); monthly
payments for Temporary Disability Insurance (TDI) and Unemployment Insurance (UI); and quarterly




                                                     19
wage history, including average quarterly wages and variance, the number of employers and the number of
hours worked (for hourly employees); the monthly unemployment rate in Rhode Island; and the annual
national unemployment rate for two-digit NAICS industries that the individual has worked in. Using DOC
data, we construct indicators for charges, seven categories of sentencing, and commitments and releases
from prison. Using police data, we construct variables for arrests; the number of car crashes involved and
injured in; and the number of and total fines for citations.

The largest set of variables comes from the Medicaid data. These include indicators for enrollment
eligibility categories, plan type, and payer codes; number of claims and total bill and payment amounts for
all claims and for Emergency Department claims; indicators for prescriptions in 262 drug categories from
the AHFS Pharmacologic/Therapeutic Classification;9 and topic models summarizing the concatenated text
descriptions for all of the individual’s ICD-9 diagnosis codes and HCPCS procedure codes.

3.1 Topic Modeling

We construct the topic models using a technique called non-negative matrix factorization (NMF), which is
commonly used in text analysis to discover latent topic structure in documents.10 In this application, we
treat each individual’s concatenated text descriptions of diagnosis and procedure codes as a document to
learn the latent topic structure across individuals’ health histories. Our topic models summarize 70,153
documents comprised of 16,367 distinct words from the code descriptions, after removing 173
uninformative words using a stopword list. The total corpus consists of over 20.5 million words.

NMF works by factorizing the non-negative 𝑑𝑑 × 𝑡𝑡 matrix of the documents’ word frequencies into non-
negative matrices 𝑑𝑑 × 𝑡𝑡 and 𝑡𝑡 × 𝑤𝑤, where d is the number of documents, w is the number of distinct words,
and t is the number of topics. We apply a term frequency-inverse document frequency (TF-IDF)
transformation to the 𝑑𝑑 × 𝑡𝑡 matrix to reweight the word frequencies by their overall frequencies in the entire
corpus, which is common practice when implementing NMF. The 𝑑𝑑 × 𝑡𝑡 matrix represents the weighting of
topics for each document, and the 𝑡𝑡 × 𝑤𝑤 matrix represents the weighting of words for each topic. We
summarize each topic using the 10 words with the greatest frequency in the 𝑡𝑡 × 𝑤𝑤 matrix.

Because the number of topics t is not known a priori, we tune this parameter by finding the t with the best
out-of-sample area under the operating-receiver characteristic curve (AUC) in a logistic regression that
includes only the topic model variables. We use only the training set for this tuning, and further subdivide
it in half into topic training and topic validation sets. The tuning achieves AUCs on the topic validation set
of 0.660 for 10 topics, 0.674 for 20 topics, 0.703 for 50 topics, 0.714 for 100 topics, 0.716 for 200 topics,
and 0.696 for 500 topics. Therefore, we select the model with 200 topics as the final variables.

3.2 Low-Dosage Opioids

Within the prescription drug categories, there is a category for opiate agonists. By construction of our panel,
no individuals should have previously received an opioid prescription. However, the opiate agonist category
includes 152 drugs that were not identified in the 4,175 opioid drugs from our historical NDC directory,
and which are listed in Table S5. These drugs either contain an opioid ingredient at a lower amount than
the minimum thresholds defined by the Washington State prescribing guidelines, or contain an ingredient
not identified in those guidelines (e.g., “opium”). Therefore, the opiate agonist variable indicates that the
individual received a drug that was not likely for initiating opioid therapy, but nonetheless contains a small
amount of an opioid ingredient. Most of these drugs are over-the-counter cough syrups or painkillers
combined with small amounts of an opioid ingredient. Of the 152, there are eight that are not present in the
historical NDC directory, possibly because they were on the market for a short enough time that they do
not occur in any of the available historical snapshots of the NDC directory.




                                                      20
3.3 Tensors

For our neural network models, we construct tensors of monthly values for a given variable for each of the
individuals in our panel in the 12 months prior to the individual’s initial prescription. Missing values are
imputed using mean values from the training population.

The DHS tensor includes 13 variables for demographics (age and indicators for sex, race, and Spanish or
Portuguese as a primary language) and monthly payments for the Supplemental Nutrition Assistance
Program (SNAP), the Temporary Assistance for Needy Families (TANF), the General Public Assistance
(GPA), the Child Care Assistance Program (CCAP), and State Supplemental Payment portions of
Supplemental Security Income benefits.

The DLT tensor includes 31 variables for indicators for sector of work derived from the first two digits of
industry codes assigned according to the North American Industry Classification System (NAICS); monthly
payments for Temporary Disability Insurance (TDI) and Unemployment Insurance (UI); and quarterly
wage history, including wage amount, the number of employers and the number of hours worked (for hourly
employees).

The DOC tensor includes 16 variables for demographics (age and indicators for sex, race, Spanish as a
primary language), and indicators for charges, seven categories of sentencing, and commitments and
releases from prison.

The Medicaid tensor includes 683 variables for demographics (age and indicators for sex, race, and Spanish
or Portuguese as a primary language); indicators for eligibility categories, plan type, and payer codes at
each month of enrollment; number of claims and total bill and payment amounts for all claims and for
Emergency Department claims; the number of prescriptions in each of 265 categories from the AHFS
Pharmacologic/Therapeutic Classification; and indicators for ICD-9 diagnosis codes and HCPCS procedure
codes for all codes that are correlated >0.02 with any adverse outcome in the training population.

The police tensor includes 42 variables for demographics (age and indicators for sex and officer-observed
race); indicators for all arrests, DUI arrests, and domestic-offense arrests; the number of car crashes
involved and injured in; the number of and total fines for citations; and the spatio-temporal intensity of calls
for service in the individual’s home Census block group for 29 categories of calls.

Finally, we construct an integrated tensor including all of the 785 variables from the DHS, DLT, DOC,
Medicaid, and police tensors. The dimension of this integrated tensor are 70,153 individuals x 12 months x
785 variables.

4 Models
We estimate a range of predictive models using modern machine learning algorithms, which vary in both
their complexity and interpretability. For example, a class of models called “regularized regression models”
estimate standard linear models, but search over many potential explanatory variables, potentially more
explanatory variables than available data observations, to maximize out-of-sample predictive fit and
minimize over-fitting. Like ordinary least squares or logistic models, the model results are easy to interpret,
but the complexity is limited to functions of variables the researcher specifies in advance. At the other
extreme are artificial neural network models where the algorithm searches over non-linear transformations
of layers of local linear regressions. The increased complexity allows the algorithm to search for arbitrary
non-linearities and interactions between variables, but at a cost of greatly reducing the interpretability of




                                                      21
the model (e.g., it is difficult to simply measure which variables contribute most to predictive fit).

4.1 Regularized Regression

For our regularized regression, we use an algorithm called Bootstrap Least Absolute Shrinkage and
Selection Operator (BOLASSO).11 This algorithm is a generalization of the popular LASSO algorithm
which is able to consistently identify a model even when predictors are highly correlated. The BOLASSO
selects the predictors with non-zero coefficients that appear in at least 90% of bootstrapped LASSO models.

Following convention, we use BOLASSO to select the variables from among 560 variables which are
persistently the strongest predictors of future adverse opioid outcomes, and we present results from a
second-stage logistic regression of an indicator for future adverse outcomes on these selected variables, to
describe the predictive power of each variable. Exhibit A6 lists the variables selected by the BOLASSO as
occurring with a non-zero coefficient in more than 90 of the 100 LASSO bootstrap replicates, along with
the regression results from the second-stage logistic regression. In addition to the second-stage logistic
regression, we also construct a regression ensemble model that averages the predictions of all 100 bootstrap
replicates in the BOLASSO.

We fit each LASSO bootstrap replicate on the training set using a regularized logistic regression
implementation called the gamma LASSO, which was developed specifically to address the challenges of
modeling sparse, high-dimensional data.12 Since a predictive model fits idiosyncratic noise through
increased complexity in the model’s structure, machine learning techniques commonly penalize complexity
in the models they produce through a process called regularization. We tune the regularization parameters
for the gamma LASSO model through a parameter search over gamma values in [0, 1, 10] and a path of
100 lambda values, and we select the model with the best area under the receiver-operating characteristic
curve (AUC) on the validation set. Regularization helps prevent overfitting to the training data and thus
improves out-of-sample fit. We are primarily interested in out-of-sample performance since our goal is to
use the model to inform successful policy interventions, which require making predictions on new
observations.13

4.2 Neural Networks

We train a neural network model for each tensor using the Python package Keras,14 which provides an
interface to the TensorFlow library.15 Specifically, we train a recurrent neural network (RNN), since RNNs
have the ability to model temporal patterns in the input data. We input our training data into a two-layer
network of 10x10 Long Short-Term Memory (LSTM)16 units with the tanh activation function. We input
the last LSTM layer into a dense layer that applies a sigmoid activation function to the weighted sum of the
10 inputs in order to produce a single predicted probability of adverse outcome. We employ regularization
prior to each layer in the form of a dropout factor of 0.25, which causes a random deactivation of units
within the layer during training with a fixed probability of 0.25.17

The neural networks are optimized to minimize the binary cross-entropy, also known as log-loss, on the
training data. We use the Adam18 optimization algorithm, training with a batch size of 16. We tune the
model on the validation set by allowing the neural network to train for as many epochs as needed until the
area under the receiver-operating curve (AUC) from predictions on the validation set does not improve by
0.001. Table S7 shows the AUC from predictions on the testing set for each data source and each individual
outcome.




                                                      22
Notes
1
  U.S. Food & Drug Administration. National Drug Code Directory [Internet; cited 2019 Feb 19]; Available from:
https://www.fda.gov/Drugs/InformationOnDrugs/ucm142438.htm
2
 Research Improving People’s Lives. Assembling a Historical National Drug Code Directory from the Internet
Archive [Internet; cited 2019 Feb 19]; Available from: https://github.com/ripl-org/historical-ndc
3
  Agency Medical Directors’ Group. Interagency Guideline on Prescribing Opioids for Pain. Olympia, WA: 2015
[cited 2019 Feb 19]. Available from:
http://www.agencymeddirectors.wa.gov/Files/2015AMDG□pioidGuideline.pdf
4
 Dowell D, Haegerich TM, Chou R. CDC Guideline for Prescribing Opioids for Chronic Pain — United States,
2016. MMWR Recomm Rep [Internet]. 2016 [cited 2019 Feb 19];65. Available from:
https://www.cdc.gov/mmwr/volumes/65/rr/rr6501e1.htm
5
  Jones CM. Heroin use and heroin use risk behaviors among nonmedical users of prescription opioid pain
relievers – United States, 2002–2004 and 2008–2010. Drug Alcohol Depend. 2013 Sep;132(1–2):95–100.
6
  Carrell DS, Cronkite D, Palmer RE, Saunders K, Gross DE, Masters ET, et al. Using natural language processing
to identify problem usage of prescription opioids. Int J Med Inform. 2015 Dec;84(12):1057–64.
7
 Barocas JA, White LF, Wang J, Walley AY, LaRochelle MR, Bernson D, et al. Estimated Prevalence of Opioid
Use Disorder in Massachusetts, 2011–2015: A Capture–Recapture Analysis. Am J Public Health. 2018 Oct
25;108(12):1675–81.
8
 Hastings JS, Howison M, Lawless T, Ucles J, White P. Unlocking Data to Improve Public Policy.
Communication of the ACM. Forthcoming.
9
  AHFS® Pharmacologic/Therapeutic Classification© used with permission. © 2017, the American Society of
Health-System Pharmacists, Inc. (ASHP). The Data is a part of the AHFS Drug Information®; ASHP is not
responsible for the accuracy of transpositions from the original context.
 Févotte C, Idier J. Algorithms for Nonnegative Matrix Factorization with the β-Divergence. Neural
10

Computation. 2011 Jun 14;23(9):2421–56.
11
   Bach FR. Bolasso: Model Consistent Lasso Estimation Through the Bootstrap. In: Proceedings of the 25th
International Conference on Machine Learning [Internet]. New York, NY, USA: ACM; 2008 [cited 2018 Feb 19].
p. 33–40. (ICML 08). Available from: http://doi.acm.org/10.1145/1390156.1390161
12
  Taddy M. One-step estimator paths for concave regularization. arXiv:13085623 [Internet]. 2016 May 1 [cited
2019 Feb 27]; Available from: http://arxiv. org/abs/1308.5623
13
 Kleinberg J, Ludwig J, Mullainathan S, Obermeyer Z. Prediction Policy Problems. Am Econ Rev. 2015
May;105(5):491–5.
14
  Chollet F, et al. Keras: The Python Deep Learning library [Internet; cited 2019 Feb 27]; Available from:
https://keras.io/
15
  Abadi M, Barham P, Chen J, Chen Z, Davis A, Dean J, et al. TensorFlow: A System for Large-Scale Machine
Learning. In: 12th USENIX Symposium on Operating Systems Design and Implementation (OSDI 16). 2016 [cited
2019 Feb 19] p. 265–83. Available from: https://www.usenix.org/conference/ osdi16/technical-
sessions/presentation/abadi
16
     Hochreiter S, Schmidhuber J. Long Short-Term Memory. Neural Computation. 1997 Nov 1;9(8):1735–80.
17
 Srivastava N, Hinton G, Krizhevsky A, Sutskever I, Salakhutdinov R. Dropout: A Simple Way to Prevent Neural
Networks from Overfitting. J Mach Learn Res. 2014 Jun 14;15:1929–58.
18
  Kingma DP, Ba J. Adam: A Method for Stochastic Optimization. arXiv:14126980 [Internet]. 2014 Dec 22 [cited
2019 Feb 19]; Available from: http://arxiv. org/abs/1412.6980




                                                       23
Table S1. Minimum amounts of ingredients in a drug to classify it as an opioid prescription or a
                                 recovery prescription.
                          Opioid Ingredient                    Minimum Amount (mg)
                          Codeine                                     30.0
                          Fentanyl                                   0.0125
                          Hydrocodone                                  5.0
                          Hydromorphone                                2.0
                          Meperidine*                                  0.0
                          Morphine                                    10.0
                          Oxycodone                                    5.0
                          Oxymorphone                                  5.0
                          Tapentadol                                  50.0
                          Tramadol                                    50.0

                          Recovery Ingredient°                 Minimum Amount (mg)
                          Buprenorphine                                0.0
                          Methadone                                    0.0
                          Naloxone                                     0.0
                          Naltrexone                                   0.0

* Meperidine has no recommended starting dose for treatment of chronic pain because of its risk for complications
in older adults; therefore, we consider any amount as evidence that the drug is an opioid.
° We consider any amount of a recovery ingredient as evidence that the drug may have been used to treat a prior
opioid use disorder.




                                                        24
Table S2. Diagnosis and procedure codes used to indicate adverse outcomes when occurring in
                       any claim after the initial opioid prescription.
Outcome          Code     Description
Opioid          304.0     Opioid type dependence
Dependence      304.7     Combinations of opioid type drug with any other drug dependence
                F11.2*    Opioid dependence
Opioid Abuse    305.0     Nondependent opioid
                F11.1*    Opioid abuse
Prescription-   965.00    Poisoning by opium (alkaloids), unspecified
Opioid          965.02    Poisoning by methadone
Poisoning       965.09    Poisoning by other opiates and related narcotics
                970.1     Poisoning by opiate antagonists
                E850.1    Accidental poisoning by methadone
                E850.2    Accidental poisoning by other opiates and related narcotics
                E935.1    Methadone causing adverse effects in therapeutic use
                E935.2    Other opiates and related narcotics causing adverse effects in therapeutic use
                E940.1    Opiate antagonists causing adverse effects in therapeutic use
                T400*     Poisoning by, adverse effect of and underdosing of opium
                T402*     Poisoning by, adverse effect of and underdosing of other opioids
                T403*     Poisoning by, adverse effect of and underdosing of methadone
Heroin          965.01    Poisoning by heroin
Poisoning       E850.0    Accidental poisoning by heroin
                E935.0    Heroin causing adverse effects in therapeutic use
                T401*     Poisoning by and adverse effects of heroin
Treatment       J2310°    Naloxone HCI Injection, per 1 mg
                J2315°    Naltrexone injection, depot form, 1mg
                J0592°    Buprenorphine HCL injection, 0.1mg
                X0305°    Methadone detoxification – outpatient
                X0321°    Methadone maintenance, assessment and evaluation, counseling, treatment and
                          review, and lab testing
                 H0020°   Alcohol and or drug services; methadone administration and or service
                 J1230°   Injection, methadone, up to 10mg
                 83840°   Methadone
                 946°     Alcohol and drug rehabilitation and counseling
                 9464°    Drug rehabilitation
                 9465°    Drug detoxification
                 9466°    Drug rehabilitation and detoxification combined
                 9467°    Alcohol and drug rehabilitation combined
                 9468°    Alcohol and drug detoxification
                 9469°    Combined alcohol and drug rehabilitation and detoxification

* ICD-10 diagnosis code
° HCPCS procedure code




                                               25
Figure S3. Cumulative frequency of adverse outcomes over time since initial opioid
                                 prescription.
                              7
                                      Any adverse outcome
                                      Heroin poisoning
                              6       Opioid abuse
                                      Opioid dependence
                                      Prescription-opioid poisoning
                              5
Percent of adverse outcomes




                                      Treatment


                              4



                              3



                              2



                              1



                              0
                                  0               1                   2               3      4   5
                                                                  Years since prescription




                                                                          26
                       Table S4. Descriptive statistics for the final panel.
Variable                                     Value                          N   Outcome
Age                                          <18                         8501    2.39%
                                             18-45                      43238    6.79%
                                             45-60                      11802    8.11%
                                             61+                         6531    1.32%
                                             NA                            81    4.94%
Race/Ethnicity                               White                      40937    8.14%
                                             Black                       7392    4.33%
                                             Hispanic                    7634    2.06%
                                             Other                       4765    2.22%
                                             NA                          9425    2.83%
Sex                                          Female                     47739    5.14%
                                             Male                       22379    7.73%
                                             NA                            35    2.86%
Marital status                               Married                    11975    4.82%
                                             Not married                39052    7.94%
                                             NA                         19126    2.65%
Body mass index                              Underweight (<18.5)         1139    9.31%
                                             Normal (18.5-25)           20073    7.65%
                                             Overweight (25-30)         15737    6.12%
                                             Obese (>30)                12590    5.21%
                                             NA                         20614    4.48%
Blockgroup fraction of residents below       At least 16.4%             11652    5.36%
FPL                                          Otherwise                  16565    6.46%
                                             NA                         41936    5.94%
Average quarterly wages in previous year     <$2500                     14624    7.18%
                                             $2500-$7500                14316    4.52%
                                             $7500-$15000                1477    4.47%
                                             >$15000                       65    3.08%
                                             $0 or NA                   39671    6.10%
Received SNAP in previous year               Yes                        39678    7.64%
                                             No                         30475    3.78%
Received SSI in previous year                Yes                         1204    8.80%
                                             No                         68949    5.91%
Received UI in previous year                 Yes                         6220    6.62%
                                             No                         63933    5.90%
Received TDI in previous year                Yes                         5538    6.86%
                                             No                         64645    5.89%
Children in DHS household in previous        0 or NA                     4263    2.67%
year                                         1                          16006    9.52%
                                             2+                         49884    5.11%




                                                27
Table S5. Low-dosage prescription opioids identified by the AHFS Pharmacologic/Therapeutic
                        Classification category for opiate agonists.
 NDC Code      Opioid Ingredients                     Other Ingredients
 00037-2403    codeine phosphate (16mg)               aspirin (325mg)
                                                      carisoprodol (200mg)
 00054-0243    codeine sulfate (15mg)
 00054-0386    hydromorphone hydrochloride (1mg)
 00093-0050    codeine phosphate (15mg)               acetaminophen (300mg)
 00121-0504    codeine phosphate (12mg)               aceteminophen (120mg)
 00121-0775    codeine phosphate (10mg)               guaifenesin (100mg)
 00121-1775    codeine phosphate (16mg)               guaifenesin (100mg)
 00185-0749    codeine phosphate (16mg)               aspirin (325mg)
                                                      carisoprodol (200mg)
 00378-6117    oxycodone hydrochloride (4.8355mg)     aspirin (325mg)
 00378-7103    oxycodone hydrochloride (2.5mg)        acetaminophen (325mg)
 00378-8088    tramadol hydrochloride (37.5mg)        acetaminophen (325mg)
 00406-0483    codeine phosphate (15mg)               acetaminophen (300mg)
 00482-0440    codeine phosphate (10mg)               guaifenesin (300mg)
 00482-0441*
 00574-7040    opium (30-60mg)                        atropa belladonna (16.2mg)
               opium, powdered (60mg)                 belladonna extract (16.2mg)
 00574-7045    opium (30-60mg)                        atropa belladonna (0.81%ww) atropa belladonna (16.2mg)
               opium, powdered (1.5%ww)               belladonna (0.8-0.81%ww)
 00574-7110    morphine sulfate (5mg)
 00591-0617*
 00591-0820    oxycodone hydrochloride (4.5mg)        aspirin (325mg)
               ocycodone terephthalate (0.38-0.4mg)
 00591-3551    oxycodone hydrochloride (4.8355mg)     aspirin (325mg)
 00603-1020    codeine phosphate (12mg)               acetaminophen (120mg)
 00603-1075    codeine phosphate (10mg)               alcohol, dehydrated (3.68-3.7%ww)
                                                      guaifenesin (100mg)
 00603-1078    codeine phosphate (10mg)               alcohol, dehydrated (1.9%ww) guaifenesin (100mg)
                                                      pseudoephedrine hydrochloride (30mg)
 00603-1329    codeine phosphate (10mg)               guaifenesin (100mg)
 00603-1520    codeine phosphate (10mg)               chlorpheniramine maleate (2mg)
                                                      pseudoephedrine hydrochloride (30mg)
 00603-1585    codeine phosphate (10mg)               promethazine hydrochloride (6.25-6.3mg)
 00603-1588    codeine phosphate (10mg)               phenylephrine hydrochloride (5mg)
                                                      promethazine hydrochloride (6.25)
 00603-2337    codeine phosphate (15mg)               acetaminophen (300mg)
 00603-4978    oxycodone hydrochloride (2.5mg)        acetaminophen (325mg)
 00603-9013    codeine phosphate (12mg)               acetaminophen (120mg)
 00641-1130*
 10135-0519*
 13107-0058    codeine phosphate (15mg)               acetaminophen (300mg)
 16571-0301    codeine phosphate (10mg)               guaifenesin (100mg)
                                                      pseudoephedrine hydrochloride (30mg)
 16571-0302    codeine phosphate (10mg)               guaifenesin (100mg)
 46672-0561    codeine phosphate (12mg)               acetaminophen (120mg)
 49884-0946    tramadol hydrochloride (37.5mg)        acetaminophen (325mg)
 50383-0079    codeine phosphate (12mg)               acetaminophen (120mg)
 50383-0087    codeine phosphate (10mg)               guaifenesin (100mg)
 50383-0804    codeine phosphate (10mg)               promethazine hydrochloride (6.25mg)
 50383-0805    codeine phosphate (10mg)               phenylephrine hydrochloride (5mg)
                                                      promethazine hydrochloride (6.25mg)
 53489-0159    codeine phosphate (15mg)               acetaminophen (300mg)
 53746-0617    tramadol hydrochloride (37.5mg)        acetaminophen (325mg)
 57664-0185    codeine phosphate (10mg)               promethazine hydrochloride (6.25mg)
 57664-0537    tramadol hydrochloride (37.5mg)        acetaminophen(325mg)
 57963-0103    codeine phosphate(10mg)                guaifenesin(100mg)
 58177-0449*
 58177-0620*




                                                       28
 58177-0621*
 58657-0500         codeine phosphate(10mg)                     guaifenesin(100mg)
 60432-0245         codeine phosphate(12mg)                     acetaminophen(120mg)
 60432-0606         codeine phosphate(10mg)                     promethazine hydrochloride (6.25mg)
 60505-2644         tramadol hydrochloride (37.5mg)             acetaminophen(325mg)
 60505-7010         fentanyl (12ug)
 60951-0310         oxycodone hydrochloride (4.8355mg)          aspirin (325mg)
 60951-0701         oxycodone hydrochloride (2.5mg)             acetaminophen(325mg)
 63481-0121         oxycodone hydrochloride (4.8355mg)          aspirin (325mg)
 63481-0627         oxycodone hydrochloride (2.5mg)             acetaminophen(325mg)
 65162-0617         tramadol hydrochloride (37.5mg)             acetaminophen(325mg)
 65162-0694         codeine phosphate(10mg)                     phenylephrine hydrochloride (5mg)
                                                                promethazine hydrochloride (6.25mg)
 66594-0333         codeine phosphate(9mg)                      pyrilamine maleate (8.33mg)
 66689-0024*
 68308-0840         oxycodone hydrochloride (2.5mg)             acetaminophen(325mg)
 68308-0845         oxycodone hydrochloride (4.8355mg)          aspirin (325mg)
 68382-0334         tramadol hydrochloride (37.5mg)             acetaminophen(325mg)
 69543-0252         codeine phosphate(10mg)                     guaifenesin(100mg)
 69543-0253         codeine phosphate(10mg)                     guaifenesin(100mg)
                                                                pseudoephedrine hydrochloride (30mg)
 76439-0252         codeine phosphate(10mg)                     guaifenesin(100mg)
 76439-0253         codeine phosphate(10mg)                     guaifenesin(100mg)
                                                                pseudoephedrine hydrochloride (30mg)

* NDC code exists in AHFS Pharmacologic/Therapeutic Classification but does not exist in NDC directory




                                                                  29
                 Table S6. Regression output for the post-BOLASSO logistic regression
                                                                                  Odds                         Bootstrap
Variables                                                                                 95% C.I.   p-value
                                                                                  Ratio                        Frequency
Released from a corrections facility                                              1.929   (1.585 -   0.000       100%
                                                                                           2.349)
Prior prescription for Atypical Antipychotics                                     1.317   (1.114 -   0.001       97%
                                                                                           1.556)
Prior prescription for Centrally Acting Skeletal Muscle Relaxants                 1.296   (1.128 -   0.000       100%
                                                                                           1.488)
Prior prescription for Benzodiazepines                                            1.213   (1.065 -   0.004       100%
                                                                                           1.383)
Prior prescription for Opiate Agonists                                            1.196   (1.048 -   0.008       100%
                                                                                           1.365)
Rhode Island monthly unemployment rate                                            1.194   (1.134 -   0.000       100%
                                                                                           1.257)
Size of household                                                                 1.146   (1.085 -   0.000       100%
                                                                                           1.210)
Topic 124 (fluid combinations opioid body ph specimen breath ethanol              1.144   (1.111 -   0.000       100%
single screen)                                                                             1.178)
Topic 128 (compulsive disorders examination diagnostic history status             1.104   (1.066 -   0.000       97%
psychiatric com interview disposition)                                                     1.142)
Total Medicaid pharmacy payments                                                  1.088   (1.047 -   0.000       100%
                                                                                           1.131)
Topic 60 (bls service statue ground mile mileage transport support                1.080   (1.042 -   0.000       97%
emergency life)                                                                            1.119)
Topic 24 (injection specify drug intramuscular infusion push intravenous          1.075   (1.037 -   0.000       100%
diagnostic prophylactic therapeutic substance)                                             1.114)
Topic 42 (acute quantification function delta cirrhosis viral chronic liver       1.072   (1.037 -   0.000       100%
hepatic coma)                                                                              1.108)
Topic 101 (symptoms oblique sacral pain referable canal back lumbosacral          1.069   (1.031 -   0.000       100%
sciatica lumbar)                                                                           1.108)
Topic 82 (fractured periapical broken jaws sinus disorder dental caries teeth     1.067   (1.035 -   0.000       100%
structures)                                                                                1.101)
Topic 34 (limb splint metacarpal static injury phalanges phalanx minimum          1.064   (1.025 -   0.001       93%
finger fingers)                                                                            1.104)
Topic 166 (region spondylosis cervical spinal lumbosacral degeneration            1.063   (1.026 -   0.001       98%
displacement myelopathy intervertebral disc)                                               1.102)
Topic 112 (household member able render incontinence care personal                1.062   (1.025 -   0.001       95%
combined ad homemaker)                                                                     1.099)
Topic 154 (back hands struck accidents accidentally striking eyes injury fall     1.061   (1.022 -   0.002       99%
wall)                                                                                      1.102)
Topic 195 (movements thoracic back accidents overexertion strenuous               1.061   (1.020 -   0.003       95%
ligament neck site lumbar)                                                                 1.104)
Topic 17 (periumbilic amylase erect decubitus constipation abdomen                1.061   (1.018 -   0.005       97%
generalized epigastric site pain)                                                          1.105)
Topic 90 (using cardiovascular maximal submaximal bicycle treadmill stress        1.061   (1.017 -   0.006       92%
exercise study myocardial)                                                                 1.106)
Topic 70 (multiplex diagnosticsamplification amplification isolation purified     1.056   (1.008 -   0.021       96%
highly nuclear acid nucleic diagnostics)                                                   1.107)
Topic 49 (absolute count quantification cd non cells disease virus human          1.053   (1.017 -   0.003       92%
immunodeficiency)                                                                          1.089)
Topic 175 (cyst scoliosis spinal therapy morbid canal physical back obesity       1.050   (1.016 -   0.004       100%
cervicalgia)                                                                               1.086)
Topic 46 (sensitivity antibiotic definitive kit commercial isolate quantitative   1.042   (0.997 -   0.067       92%
urine identification bacterial)                                                            1.089)
Topic 197 (physician vitamin infliximab abdomen infusion small large site         1.038   (1.007 -   0.018       92%
intestine enteritis)                                                                       1.001)
Topic 187 (generalized therapeutic intensive greater smoking cessation            1.037   (1.001 -   0.044       95%
oppositional defiant tobacco disorder)                                                     1.073)
Total Unemployment Insurance payments                                             1.036   (0.997 -   0.074       93%
                                                                                           1.077)




                                                                30
Topic 151 (nonobstetric stenosis enthesopathy minimum pelvic pain joint           1.035   (0.997 -   0.075   93%
hip pelvic region)                                                                         1.074)
Topic 182 (systemic erythrocyte sedimentation cpk kinase ck creatine lupus        1.032   (0.999 -   0.061   93%
erythematosus myositis)                                                                    1.067)
Topic 6 (caries viral asthmaunspecified infection evaluation management           1.025   (0.981 -   0.272   93%
visit key emergency comp)                                                                  1.072)
Number of police citations                                                        1.025   (0.992 -   0.139   97%
                                                                                           1.058)
Topic 74 (nonpsychotic obstruction allergy crisis tobacco airway                  1.023   (0.986 -   0.230   92%
radiological insomnia disorder depressive)                                                 1.062)
Topic 18 (radiological less sinuses paranasal frontal anteroposterior lateral     1.022   (0.974 -   0.370   98%
minimum examination views)                                                                 1.072)
Number of opioid prescriptions in household                                       1.010   (1.000 -   0.048   100%
                                                                                           1.020)
Topic 62 (skills visit physical therapeutic intervention individual assessment    0.999   (0.959 -   0.957   95%
health therapy counseling)                                                                 1.041)
Topic 93 (tachycardia abnormal ekg palpitations tracing routine                   0.996   (0.951 -   0.883   94%
interpretation report leads electrocardiogram)                                             1.045)
Topic 126 (mtt mh psychosis treatment disorganized rn program chronic             0.996   (0.958 -   0.845   92%
assertive paranoid)                                                                        1.036)
Topic 10 (mental single disorder depressive episode recurrent major               0.995   (0.956 -   0.803   95%
affective behavior severe)                                                                 1.036)
Topic 92 (followed stem canal spinal material brain contrast imaging proton       0.987   (0.943 -   0.561   93%
resonance)                                                                                 1.033)
Topic 16 (schedule vaccine viral prophylactic inoculation vaccination             0.984   (0.916 -   0.652   92%
subcutaneous intradermal administration percutaneous)                                      1.056)
Topic 57 (shl problems disorder treatment group processing auditory voice         0.978   (0.915 -   0.524   95%
language speech)                                                                           1.046)
Topic 119 (scan swelling follow st compression responses maneuvers duplex         0.975   (0.928 -   0.318   96%
extremity veins)                                                                           1.025)
Topic 54 (face injury soft cervical eyes swelling lump mass scalp head)           0.974   (0.929 -   0.283   94%
                                                                                           1.022)
Topic 125 (gait mileage statute ground mile emergency non chair wheel van)        0.973   (0.930 -   0.238   99%
                                                                                           1.018)
Topic 179 (emergency functions special ed encounter oppositional defiant          0.971   (0.912 -   0.373   98%
transportation trip rehabilitation)                                                        1.035)
Topic 4 (sealant evaluation periodic oral child adult application included        0.971   (0.898 -   0.460   96%
topical fluoride)                                                                          1.050)
Topic 180 (conductive speech sensorineural recognition impedance                  0.970   (0.910 -   0.351   98%
tympanometry audiometry threshold testing loss)                                            1.034)
Topic 194 (hypometropia refractive eyes treatment evaluation continuation         0.969   (0.915 -   0.270   95%
examination prog diagnostics initiation)                                                   1.025)
Average quarterly wages                                                           0.968   (0.919 -   0.223   100%
                                                                                           1.020)
Topic 29 (low colposcopy gladnular lgsil lesion squamous intraepithelial          0.968   (0.918 -   0.228   93%
dysplasia smear papanicolaou)                                                              1.021)
Topic 3 (microalbumin hemoglobin strip manifestations juvenile glycated           0.967   (0.917 -   0.219   98%
complication mellitus ii uncontrolled)                                                     1.020)
Topic 106 (rn minimum mental social evaluation periodic oral bitewings            0.965   (0.902 -   0.306   93%
films prophylaxis)                                                                         1.033)
Topic 144 (pleurisy rubella mumps bcg examination test screening skin             0.965   (0.908 -   0.249   91%
intradermal pulmionary)                                                                    1.025)
Topic 192 (heterophile conjunctivitis strep bacterial culture source definitive   0.964   (0.913 -   0.187   99%
bronchitis tonsillitus acute)                                                              1.018)
Topic 155 (specimen nursing home laboratory necessary medical connection          0.960   (0.897 -   0.243   100%
way allowance drawn)                                                                       1.028)
Average quarterly hours worked                                                    0.958   (0.880 -   0.326   99%
                                                                                           1.044)
Topic 137 (phalanges metatarsil cellulitis pain valgus hallux toe minimum         0.955   (0.908 -   0.075   93%
limb toes)                                                                                 1.005)
Topic 7 (therapy modality physical activities provider procedure strength         0.953   (0.905 -   0.065   100%
develop exercises areas)                                                                   1.003)




                                                                 31
Topic 1 (complicating complications current premature classifiable labor        0.952     (0.898 -     0.097         96%
mother threatened pregnancy complication)                                                  1.009)
Topic 9 (cholesterol lipoprotein ldl creatine hyperglyceridemia cpk kinase ck   0.950     (0.897 -     0.080         92%
measurement hypercholesterolemia)                                                          1.006)
Topic 28 (technique infectious acid nucleic rna gonorrhoeae trachomatis         0.940     (0.897 -     0.072         93%
chlamydia dna probe)                                                                       1.005)
Topic 72 (vaccination inoculation injection intramuscular jet above dosage      0.948     (0.889 -     0.099         99%
split vaccine influenza)                                                                   1.010)
Topic 145 (excludes mental palsy lung infantile bronchus special problem        0.945     (0.866 -     0.205         99%
functions care)                                                                            1.031)
Topic 132 (blood secondary folic cyanocobalamin capacity binding ferritin       0.945     (0.891 -     0.059         99%
vitamin deficiency iron)                                                                   1.002)
Topic 97 (acute spontaneous otalgia serous nonsuppurative infective rupture     0.942     (0.883 -     0.073         94%
supparative eardrum media)                                                                 1.006)
Topic 53 (bone breast liver radiation chemotherapy female secondary             0.941     (0.889 -     0.033         100%
bronchus lung malignant)                                                                   0.995)
Topic 21 (alpha estriol fetoprotein single organisms screening dose post        0.938     (0.876 -     0.063         96%
glucose pregnant)                                                                          1.003)
Topic 84 (aklaline phosphatase serum alt alanine sgpt ast sgot aspartate        0.931     (0.878 -     0.016         100%
amino)                                                                                     0.987)
Topic 66 (full marrow infusion myeloid chemotherapy myeloma lymphoid            0.930     (0.870 -     0.032         100%
leukemia achieved having)                                                                  0.994)
Topic 38 (product palsy infantile disposable incontinence procedures            0.927     (0.845 -     0.110         100%
temporary mhrh offline disabilities)                                                       1.017)
Topic 141 (diseases precription transmitted sexually measures                   0.927     (0.869 -     0.020         99%
contraceptives management general contraceptive advise)                                    0.988)
Topic 36 (community cedarrs incontinence assertive adult monthly program        0.924     (0.836 -     0.121         100%
dd mr intellectual)                                                                        1.021)
Topic 14 (detection interpretation digitization physician bilateral further     0.910     (0.846 -     0.012         100%
aided computer mammogram screening)                                                        0.980)
Sex is male                                                                     0.861     (0.778 -     0.004         100%
                                                                                           0.954)
Topic 11 (examination myopia routine gynecological coinsurance deductible       0.859     (0.800 -     0.000         99%
office visits copay share)                                                                 0.922)
Body mass index                                                                 0.851     (0.806 -     0.000         100%
                                                                                           0.899)
Age                                                                             0.704     (0.650 -     0.000         99%
                                                                                           0.761)
Primary language is Spanish                                                     0.450     (0.347 -     0.000         100%
                                                                                           0.585)
Race is African American                                                        0.400     (0.337 -     0.000         100%
                                                                                           0.474)
Enrolled in Medicaid managed care                                               0.386     (0.341 -     0.000         100%
                                                                                           0.437)
Race is Asian, Native American, or other                                        0.374     (0.276 -     0.000         100%
                                                                                           0.507)
Married is missing                                                              0.350     (0.300 -     0.000         100%
                                                                                           0.407)
Race is missing                                                                 0.305     (0.250 -     0.000         100%
                                                                                           0.372)
Ethnicity is Hispanic                                                           0.245     (0.190 -     0.000         100%
                                                                                           0.318)
Eligible for Medicaid as categorically needy                                    0.136     (0.123 -     0.000         100%
                                                                                           0.150)
Enrolled in RI Pharmaceutical Assistance to the Elderly                         0.008     (0.001 -     0.000         100%
                                                                                           0.061)

Note: This is a logistic regression of variables selected by BOLASSO as occurring with a non-zero coefficient in more than 90%
                                                   of LASSO bootstrap replicates.




                                                               32
           Table S7. Area under the receiver-operating characteristic curve (AUC) of neural network
                models using different subsets of administrative data and outcome definitions.
                                                                                          Heroin
             Any Poisoning     Dependence        Abuse            Prescription-Opioid     Poisoning       Treatment
             0.695             0.705             0.692            0.665                   0.554           0.728
DHS          (0.684-0.712)     (0.686-0.728)     (0.662-0.720)    (0.623-0.709)           (0.442-0.646)   (0.709-0.749)
             0.563             0.548             0.513            0.486                   0.431           0.535
DLT          (0.545-0.579)     (0.527-0.569)     (0.479-0.549)    (0.434-0.532)           (0.363-0.522)   (0.518-0.558)
             0.694             0.718             0.716            0.626                   0.766           0.724
DOC          (0.678-0.712)     (0.700-0.738)     (0.687-0.753)    (0.584-0.673)           (0.628-0.896)   (0.697-0.748)
             0.763             0.771             0.741            0.675                   0.697           0.772
Medicaid     (0.750-0.779)     (0.753-0.787)     (0.702-0.764)    (0.632-0.720)           (0.560-0.831)   (0.757-0.792)
             0.637             0.643              0.622           0.598                   0.478           0.656
Police       (0.619-0.651)     (0.616-0.662)     (0.595-0.660)    (0.554-0.642)           (0.364-0.607)   (0.632-0.679)
             0.793             0.801             0.773            0.707                   0.708           0.810
Integrated   (0.780-0.808)     (0.780-0.818)     (0.736-0.807)    (0.659-0.748)           (0.566-0.837)   (0.795-0.829)
                      Note: Confidence intervals are calculated from 100 bootstrap replicates.




                                                            33
