                                NBER WORKING PAPER SERIES




             A NEW METHOD FOR ESTIMATING TEACHER VALUE-ADDED

                                           Michael Gilraine
                                             Jiaying Gu
                                           Robert McMillan

                                        Working Paper 27094
                                http://www.nber.org/papers/w27094


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      May 2020




We would like to thank Roger Koenker for helpful discussions, and Joe Altonji, Raj Chetty, Michael
Dinerstein, John Friedman, Chris Taber, Sergio Urzua and seminar participants at the NBER Summer
Institute, Yale University, the University of Maryland, Western, the Banff International Research Station
workshop, and the Jacobs Center CCWD workshop for additional comments. Guan Yi Lin and Hammad
Shaikh provided excellent research assistance. Financial support from SSHRC and the University
of Toronto Mississauga is gratefully acknowledged. The views expressed herein are those of the authors
and do not necessarily reflect the views of the National Bureau of Economic Research.¸¸

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2020 by Michael Gilraine, Jiaying Gu, and Robert McMillan. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
A New Method for Estimating Teacher Value-Added
Michael Gilraine, Jiaying Gu, and Robert McMillan
NBER Working Paper No. 27094
May 2020
JEL No. C14,H75,I21,J24,J45

                                         ABSTRACT

This paper proposes a new methodology for estimating teacher value-added. Rather than
imposing a normality assumption on unobserved teacher quality (as in the standard empirical
Bayes approach), our nonparametric estimator permits the underlying distribution to be estimated
directly and in a computationally feasible way. The resulting estimates fit the unobserved
distribution very well regardless of the form it takes, as we show in Monte Carlo simulations.
Implementing the nonparametric approach in practice using two separate large-scale
administrative data sets, we find the estimated teacher value-added distributions depart from
normality and differ from each other. To draw out the policy implications of our method, we first
consider a widely-discussed policy to release teachers at the bottom of the value-added
distribution, comparing predicted test score gains under our nonparametric approach with those
using parametric empirical Bayes. Here the parametric method predicts similar policy gains in
one data set while overestimating those in the other by a substantial margin. We also show the
predicted gains from teacher retention policies can be underestimated significantly based on the
parametric method. In general, the results highlight the benefit of our nonparametric empirical
Bayes approach, given that the unobserved distribution of value-added is likely to be context-
specific.


Michael Gilraine                              Robert McMillan
New York University                           University of Toronto
Department of Economics                       Department of Economics
19 West 4th Street                            150 St. George Street
New York, NY 10012                            Toronto, ON M5S 3G7
mike.gilraine@nyu.edu                         CANADA
                                              and NBER
Jiaying Gu                                    mcmillan@chass.utoronto.ca
Department of Economics
University of Toronto
150 St. George Street
Toronto, ON M5S 3G7
Canada
jiaying.gu@utoronto.ca
1         Introduction

Measuring the impact of teachers on student achievement has been a longstanding preoccu-
pation in applied research ­ naturally so, given the vital role that teachers play in education
production. As observable characteristics tend to do a poor job when predicting teacher
performance,1 researchers have proposed influential fixed effects methods as a means to cap-
ture a teacher's overall quality, taking advantage of large-scale matched student-teacher data
sets that are increasingly accessible ­ see pioneering studies by Rockoff (2004) and Rivkin,
Hanushek, and Kain (2005). In turn, fixed effects methods have prompted the develop-
ment of teacher value-added (`VA') estimators for measuring the impact of teachers that are
both transparent and easy to implement.2 Given the appeal of such estimators, teacher VA
estimates now feature ever more widely in the policy sphere, particularly in consequential
teacher retention, promotion and pay decisions. Indeed, by the end of 2017, fully thirty
nine states required VA measures to be incorporated into teacher evaluation scores (as one
indicator of this phenomenon).
        The use of VA methods in high-stakes decision making raises important challenges. Not
least, such methods need to be able to recover teacher quality on the basis of relatively few
teacher-year observations, particularly so for teachers new to the profession. The standard
approach to this issue involves using empirical Bayes methods to reduce measurement error
in VA estimates, `shrinking' less reliable estimates back toward the mean (Kane and Staiger,
2008; Kane et al., 2008; Jacob and Lefgren, 2008; Harris and Sass, 2014; Chetty et al.,
2014a,b). In order to apply these methods, papers estimating teacher VA have typically
used the parametric empirical Bayes (`PEB') estimator, first proposed by James and Stein
(1961). This is attractive given its analytic convenience and also because it is the feasible
version of the optimal Bayes rule for estimating teacher quality when unobserved quality is
normally distributed.3

    1
    For instance, Kane, Rockoff, and Staiger (2008) show that among teachers with identical experience and
certification status, there are large and persistent differences in teacher effectiveness.
  2
    See Koedel, Mihaly, and Rockoff (2015) for a recent review.
  3
    To be precise, it is the feasible version of the parametric Bayes estimator ­ the optimal Bayes rule under


                                                      1
    In practice, unobserved teacher quality may not follow a normal distribution. Given this
possibility, we do not have a clear sense of how the resulting VA estimates might be affected
by departures from normality, nor of the implications that such departures could have for
policies based on VA estimates. The analysis in this paper seeks to shed light on both these
relevant issues.
    The central contribution of our paper is to set out a feasible new methodology for estimat-
ing teacher VA ­ one that does not impose any parametric assumptions on the unobserved
heterogeneity in teacher quality. Following a standard setup in which residualized test scores
equal underlying teacher quality (the heterogeneous teacher VA of interest) plus noise, we
show first that the teacher quality distribution can be identified nonparametrically ­ see
Theorem 1 below.4 Next, we derive the nonparametric Bayes estimator for teacher VA (see
Theorem 2), drawing on a path-breaking 1956 paper in statistics by Herbert Robbins.5 This
nonparametric estimator is optimal in the sense of minimizing the mean squared error of indi-
vidual teacher quality estimates regardless of the true underlying distribution of unobserved
teacher quality.
    In terms of shrinkage, both the parametric and nonparametric Bayes estimators can
be written as functions of teacher fixed effects. Whereas the standard parametric Bayes
estimator shrinks the teacher fixed effect linearly, our nonparametric Bayes estimator features
a non-linear shrinkage rule, allowing the amount of shrinkage applied to each teacher fixed
effect to be non-monotonic. This estimator is infeasible, however, given it involves the
unknown teacher VA distribution, denoted F . We obtain a feasible version by applying a
two-step approach, described in Section 3.6 Doing so yields the nonparametric empirical

quadratic error loss in the case where unobserved teacher quality follows a normal distribution.
   4
     In Appendix A, we provide a general deconvolution proof of nonparametric identification in the case of
teacher VA. In the main analysis, for tractability, we make the assumption that the noise component in the
residualized test score model is independent of underlying teacher quality and has a known distribution, as-
sumed to be normal with a common variance. To assume that unobserved teacher quality in this formulation
also follows a normal distribution involves an over-parameterization.
   5
     In the words of Efron (2003), "There seems to be a good chance that Robbins was 50 years ahead of his
time and that a statistical theory of the 1950s will shine in the 21st century." (See page 377.)
   6
     In essence, we first estimate the teacher VA distribution F , using nonparametric maximum likelihood, to
get F ^ , and second, plug this into the first equation in Theorem 2 (the theorem defining the nonparametric
Bayes estimator).


                                                     2
Bayes (`NPEB') estimator used in the main analysis.
      Implementing the Robbins nonparametric Bayes approach in large-scale empirical ap-
plications has only recently become viable, following important computational advances by
Koenker and Mizera (2014).7 We leverage those advances in the current study, showing first
that the NPEB approach performs very well in Monte Carlo simulations in an environment
that mimics typical administrative data sets closely, being responsive to the true underlying
VA distribution. This contrasts with the standard PEB approach, which becomes less reliable
when departures from normality are more pronounced, as the simulations demonstrate.
      Next we apply the methodology using observational data, estimating teacher VA in two
separate large-scale administrative data sets. One covers the entire state of North Carolina
and the other, the Los Angeles Unified School District (LAUSD) ­ the second largest school
district in the United States. The estimated teacher VA distributions differ both from the
normal distribution assumed in the prior literature and from each other. In North Carolina,
the estimated distribution has a relatively similar shape to the normal, although with fatter
tails;8 in the LAUSD, our estimated teacher distribution is skewed, with a much thinner left
than right tail. In each instance, the deviations from normality are statistically significant,
as indicated by a new diagnostic test we develop (see Appendix E).
      Given the deviations from normality in both settings, we then evaluate the policy rele-
vance of our methodology. To the extent that the normality assumption is misplaced, our
approach will improve the prediction of the total gains of a particular policy (relative to the
standard PEB method); such gains could then be weighed by decision-makers against total
costs in trying to determine optimal policy. First we consider the total gains of a widely dis-
cussed proposal to release teachers. The literature has focused on teachers in the bottom five
percent of the estimated teacher value-added distribution, as outlined by Hanushek (2009,
2011) and evaluated in Chetty et al. (2014b).9 Accordingly, we compare the predicted test

  7
     Other applications in economics include analyses of earnings dynamics ­ see Gu and Koenker (2017b),
for instance.
   8
     This finding aligns with Goldhaber and Startz (2017) who find that the distribution of teachers in North
Carolina is not Gaussian, but the differences from the normal distribution tend to be small.
   9
     Because empirical Bayes seeks to minimize prediction error, we focus on the out-of-sample predictions of


                                                     3
score gains of students using our method with an approach that imposes normality on the
underlying teacher quality distribution, supposing the bottom five percent of teachers (based
on estimated VA after three years of observation) are released and replaced by teachers of
average quality.
    In North Carolina, we find only minor differences between the two approaches: the
PEB method overstates test score gains of the policy by around five percent relative to our
methodology. In contrast, the skewness of the distribution of teacher value-added in the
LAUSD leads to large differences in the estimated policy benefit, with PEB overstating test
score gains of the policy by over a quarter.
    More broadly, we are able to simulate the aggregate test score effects of policies that
release any given percentage of teachers from the bottom of the VA distributions under the
two approaches. We also include classroom fixed effects, and repeat the estimation and the
policy analyses on that basis. Doing so reduces the variance in the VA estimates, as one
would expect, and lowers the extent to which PEB overstates the test score gains of teacher
release policies. Still, using LAUSD data, PEB overstates the gains by 16 percent under
the benchmark `5 percent cutoff' policy. When we consider `teacher retention' policies, in
contrast, we show that PEB can underestimate policy gains, the underestimation becoming
more severe in North Carolina when including classroom fixed effects.
    At a general level, our analysis underscores the plausible notion that the true underlying
distribution of teachers is likely to be context-specific, and so estimated policy gains when
invoking normality may well differ substantially from the true policy gains in some settings.
Here, our data-driven methodology offers policymakers a flexible means to understand the
benefits of implementing the same reform in different environments. Further, given the
computational feasibility of our approach, analytical convenience need no longer weigh on
the side of assuming normality. This opens up new possibilities for empirical research, not

policies that are relevant to understanding how many teachers to release. Given empirical Bayes does not
seek to minimize teacher ranking errors, it is less useful for studying teacher rankings ­ that is, deciding
whom to release. Indeed, we will find that the choice of estimators ­ whether fixed effect, parametric, or
nonparametric empirical Bayes ­ has little appreciable impact on teacher rankings in either our simulations
(see Tables F.1(a)-F.1(c)) or empirical applications (see Section 6.1).


                                                     4
least as the nonparametric empirical Bayes methodology is applicable in a variety of other
contexts where parametric empirical Bayes methods have already been used.
      The rest of the paper is organized as follows: The next section presents the methodology,
Section 3 then sets out the computationally feasible estimator we use, and Section 4 conducts
simulations comparing our methodology with the standard PEB approach in the literature.
We then apply it in practice: Section 5 introduces the data, Section 6 describes the estimates
of teacher VA using the two administrative data sets, and Section 7 presents the policy
analysis. Section 8 concludes, considering the broader applicability of the approach.



2       Methodology

This section presents our methodology for estimating teacher value-added with reference to
existing approaches in the literature.


2.1      Student Achievement and the Contribution of Teachers

      We consider a standard model of student achievement in which education inputs (includ-
ing the contribution of teachers) are additive in their effects. The achievement of a student
i taught by teacher j in year t is written as:


                              y
                              ~ijt = Xijt  + j +      ijt ,   i = 1, 2, . . . , njt ,                   (2.1)


where y
      ~ijt is the student's observed test score (to be contrasted with yijt below, purged of co-
variates), and Xijt are observed characteristics of the student (demographics, past academic
performance, and family background) and the teacher (including her experience). Our pa-
rameter of interest, j , is the time-invariant teacher's contribution, or simply VA. We assume
that teachers are each assigned to one class per year (with j 's class size in year t being njt )
and that conditional on Xijt , the assignment is as good as random;10 the error term                    ijt   is
 10
   Rothstein (2017) and Chetty et al. (2017) discuss the validity of this assumption in the context of teacher
value-added models. Our contribution to the value-added literature focuses on the empirical Bayes procedure,


                                                      5
assumed to be iid normal with variance  2 .11
    The standard approach to estimating teacher VA starts from a regression that purges
the effects of observed covariates from y
                                        ~ijt . This leaves a noisy measure of the teacher's
contribution, denoted


                                                  yijt = j +       ijt   .                                    (2.2)


From here, several different estimators are available in order to estimate VA.


2.2     The Fixed Effect Estimator

    Given (2.2), we can construct the maximum likelihood estimator (sometimes referred to
as the fixed effect estimator) for the unobserved j . We will denote this by


                             yj =          hjt yjt /       hjt =         njt yjt /        njt ,               (2.3)
                                       t               t           t                 t


                1    njt
where yjt =    njt   i=1   yijt is the teacher-year specific sample average for teacher j in year t.
Taking a weighted average of {yjt } across all the classes taught by teacher j over time, using
weights hjt  njt / 2 , gives the teacher fixed effect (`FE') for that teacher in (2.3). Together
with the assumption that         ijt   follows a normal distribution, model (2.2) then implies that
the teacher FE has the following distribution:


                                            yj  N (j ,  2 /              njt ).                               (2.4)
                                                                   t


Given the expression for the variance, if the total sample                           t   njt   in the denominator,
then fixed effect yj converges to the true teacher VA, j , in probability, and so is a consistent
estimator for the desired object. In practice, however, the VA literature does not use the
fixed effect estimator, primarily because of finite sample considerations. These imply that
rather than gauging bias in value-added measures due to potential non-random assignment.
  11
     This normality assumption is made to simplify the following discussion. It is not necessary. In Appendix
A, we present a general framework demonstrating the nonparametric identification of the error distribution.


                                                            6
the fixed effect estimator is a noisy estimator, especially for teachers beginning their careers.
Shrinkage estimators (considered next) account for this feature.12



2.3      The Parametric Empirical Bayes Estimator

      The current state-of-art estimator for VA ­ the parametric empirical Bayes (`PEB') es-
timator introduced first by Kane and Staiger (2008) and further developed by Chetty et al.
(2014a) ­ responds to the finite-sample considerations just referred to. It does so by lever-
aging the insight that if the teacher effect follows a normal distribution, then it is possible
to modify poor-quality estimates for some teachers based on observations for other teachers.
      The PEB estimator is the feasible version of the parametric Bayes (`PB') estimator, which
                                       1                            J
is the minimizer of the Bayes risk, E[ J                            j =1 (j   - j )2 ], given (2.4) as well as the parametric
assumption that the VA for all teachers is an independent and identically distributed draw
                                                       2
from a normal distribution with mean zero and variance   . The latter estimator takes the
following form:
                                                                         2
                                                PB                      
                                                j  = yj             2 + 2/
                                                                                              .                         (2.5)
                                                                                    t   njt

      Several remarks about the parametric Bayes estimator in (2.5) are due:

                    2
   1. When j  N (0,   ), the posterior distribution of j conditional on observing
        the teacher's performance yj also follows a normal distribution, given by j |yj 
                   2             2 2 /          njt
        N (yj 2 +2/            , 2+ 2 /
                                           t
                                                     ),   where the posterior mean of j given the FE yj is
                       t njt                   t njt

        the best linear predictor of j .

                                                 2
   2. The `shrinkage' factor,             2 + 2 /
                                                              njt
                                                                     is always smaller than 1, which implies that the
                                                          t

                                   PB
        parametric Bayes estimator j  shrinks the fixed effect estimator yj towards zero.
        Given this, the direction of shrinkage only depends on the sign of yj (not its magnitude).


 12
    They can be assessed by their distance from the true VA quantity, j , using a common distance measure
­ the so-called L2 loss. This is denoted L(^, )  1 J (      ^      2        ^
                                                  J    j =1 j - j ) , where j is some estimator of true VA,
j .


                                                                         7
   3. The shrinkage factor is the same for all teachers with a given total sample size nj 

          t   njt (summing across all classrooms in all relevant time periods): the bigger the
        total sample size, the closer the shrinkage factor is to 1.

   4. There is built-in symmetry in the Bayes estimator in the sense that, for individual
        teachers who have the same total sample size nj , the amount of shrinkage imposed
        on yj only depends on its absolute value. Thus teachers with both very large yj (for
        example, teachers in the right tail, who have large positive fixed effects) and with small
        yj (e.g., left-tail teachers) are shrunk towards zero by the same magnitude as long as
        their overall sample sizes and absolute magnitudes are the same.

                    PB                                                     2
   5. The estimator j  is infeasible since it involves unknown parameters (  ,  2 ). The em-
                                                                                ^    2
                               PB                                P EB
        pirical counterpart to j  , the PEB estimator defined as j    = yj ^ 2 +^
                                                                                 2 /nj
                                                                                       , replaces
                                                                                  

        these unknown parameters with their consistent estimates, either through maximum
        likelihood or method of moments.


      These observations serve to highlight two key features of the PEB estimator. First, by
                            P EB
construction, the estimator j    is linear in yj ; hence it scales the fixed effect estimator in
the same symmetric fashion towards zero for all teachers who have the same overall sample
size nj . Second, for teachers who have very large nj relative to  2 , the PEB estimator is
almost the same as the fixed effect yj . This confirms the intuition from above that if nj
is large, the fixed effect will provide an accurate estimator for the true value-added, so the
shrinkage estimator j leaves it relatively unmodified. In contrast, teachers with a smaller
total sample size (new teachers, for example) receive greater shrinkage towards zero.
      The PEB estimator has a simple linear form and is easy to compute, which helps to
account for its popularity in the literature. Crucially, however, it relies on the parametric
assumption that true teacher VA, j , follows a normal distribution. If this assumption is
misplaced, the quality of the shrinkage estimator may deteriorate,13 perhaps significantly,

 13
   See Bonhomme and Weidner (2019) for a discussion of the robustness properties of the EB estimator
when the normality is locally misspecified.


                                                 8
and it raises the further possibility that one might be able to find an alternative estimator
that has a smaller Bayes risk.


2.4        The Nonparametric Bayes Estimator

     Next we show that, for model (2.2), the distribution of teacher VA is nonparametrically
identified (Theorem 1 below). This result implies that the data contain enough information
about the distribution of the true VA measure, and the normality assumption applied to
unobserved teacher quality involves an over-parameterization. In the theorem, we continue
to assume a normally distributed error, although doing so is not necessary (as we show in
Appendix A, drawing on Kotlarski (1967)). Imposing normality will, however, be convenient
for estimation purposes. We then introduce the nonparametric Bayes (`NPB') estimator for
teacher VA (see Theorem 2). This estimator involves the unknown VA distribution, which
we replace by an empirical counterpart (see Section 3), referring to that as the nonparametric
empirical Bayes (`NPEB') estimator.

Theorem 1 Consider the model yijt = j +                  ijt ,   with   ijt   iid N (0,  2 ). If j is independent
of   ijt   for all i and t, and j follows some probability distribution F , then F is nonparamet-
rically identified.

Proof. Under the assumption that j and                   ijt     are independent random variables for all i
and t, we have for any s  R,

                                                                (y -)2
                                                          1   -
                            yijt (s) =   eisy                e 22 dF ()dy
                                                         2 2
                                                               2
                                                       1   - z
                                    =    eisz             e 22 dz              eis dF ()
                                                      2 2
                                           2 s2 /2
                                    = e-              (s) ,


where X (·)
     is the characteristic function of random variable X and i denotes the imaginary unit
(as distinct from the student index i). Since we observe yijt , the characteristic function

                                                         9
 (t) is identified from the data for all s  R. Given the one-to-one mapping from the
characteristic function to the distribution function of a random variable, the distribution F
is nonparametrically identified.
   Next, we present the nonparametric Bayes estimator, using teacher fixed effects (yj ) and
the model (2.4) as inputs:

Theorem 2 Given the model yj = j + j , with j being independent from j , j  F and
j  N (0,  2 /nj ), then the estimator of j that minimizes the Bayes risk under L2 loss, ~j ,
takes the form
                                 NP B          j (yj - )dF ()
                                 j    =                       ,                           (2.6)
                                               j (yj - )dF ()

with j (·) being the density function of the normal distribution with mean zero and variance
 2 /nj . The estimator can be further simplified to


                               NP B              2 
                               j    = yj +            log gj (y )|y=yj ,                  (2.7)
                                                 nj y

with gj (·) being the marginal density of yj .

Proof. The first part of proof follows from the fact that the minimizer of the Bayes risk
under L2 loss is the posterior mean of j conditional on yj . For the second part, since


                                   gj (y ) =     j (y - )dF (),


then straightforward calculations show that

              2                          ( - yj )j (yj - )dF ()
                   log gj (y )|y=yj =                           = E[|yj ] - yj .
              nj y                          j (yj - )dF ()

Therefore,
                         NP B                           2 
                         j    = E[|yj ] = yj +               log gj (y )|y=yj .
                                                        nj y




                                                   10
Theorem 2 presents two expressions for the nonparametric Bayes estimator. The expression
in (2.7) is known in the literature as "Tweedie's formula" (see Efron (2011)). Several remarks
about it are due, compared with the parametric Bayes estimator in (2.5):


   1. The parametric Bayes estimator is a special case of the nonparametric Bayes estima-
         tor.14

   2. Tweedie's formula retains the feature that if  2 /nj is very small, then the nonpara-
                          NP B
         metric estimator j    will not deviate much from the fixed effect estimator yj .

   3. In general, for any distribution F other than the normal distribution, the quantity
         
         y
             log gj (y )|y=yj in Theorem 2 introduces a non-linearity into the shrinkage rule with
         respect to yj .

   4. Unlike the parametric Bayes formula, Tweedie's formula does not automatically `shrink'
         the fixed effect estimator towards zero. Inspection of the formula shows that the fixed
         effect and the adjustment factor are additively separable, and the adjustment factor
         can be positive or negative. The direction and magnitude of the shrinkage depend on
         the distribution of latent teacher quality and also the magnitude of the fixed effect
         estimate yj , and hence is likely to be context-specific. (An illustrative example is
         provided below to give intuition.)


      Given these observations, it is worth highlighting an important contrast: unlike the PEB
estimator, individuals with higher variances will not necessarily shrink the most towards
zero under Tweedie's formula. This feature turns out to be empirically relevant. Suppose
a new teacher j who has a small total sample size nj relative to  2 happens to have a high
yj ­ for example, a teacher who performs very promisingly in her early years in the school
system. Under the parametric shrinkage rule, this teacher will be heavily discounted in that
her VA measure will shrink significantly towards zero. This is simply because the normal

 14                                2
      Specifically, when F = N (0,   ), we have gj (·) becoming the density function of a normal distribution with
                       2                                                  y                                 2
mean zero and variance   +  2 /nj and thus      y
                                                                                       NP B
                                                    log gj (y )|y=yj = - 2 +j2 /nj and j      PB
                                                                                            = j  = yj 2 +2 /n .
                                                                                                             j
                                                                                                         



                                                        11
distribution, which dictates that there must be a thin tail, deems it unlikely for this teacher
to have a high VA j ; instead, the large yj arises purely by chance due to the associated high
variance. In contrast, under the nonparametric shrinkage rule, depending on the features of
the distribution of true value-added, her VA estimate may remain very close to her estimated
fixed effect, yj , and conceivably be even higher.15

Example: We now provide an example to illustrate the ways in which shrinkage may operate
under the nonparametric Bayes estimator as compared with the PEB estimator, depending
on the underlying distribution of teacher VA. Specifically, we consider the Bayes estimator
under two different assumptions about the true teacher VA distribution. In the first case,
assume j  N (0, 0.05).16 Here, we draw on the fact that the nonparametric Bayes and
parametric Bayes estimators will coincide. In the second case, suppose the true teacher VA
has distribution F , which takes the following form:


                        F = 0.98N (0, 1 ) + 0.01N (-1, 2 ) + 0.01N (1, 3 ) .                         (2.8)


This mixed normal distribution has the built-in feature that at both tails, there is a small
probability mass concentrated around the values -1 and 1, while the majority of the proba-
bility mass follows a normal distribution centered at zero; as such, this will help to highlight
the operation of nonlinear shrinkage. Here, we calibrate the above parameters (1 , 2 , 3 )
such that F has the same mean and variance as in the first case. In both, we set  2 = 0.25,
which is roughly the same as in the North Carolina mathematics score data.
      Figure 1 compares the amount of shrinkage for the parametric and nonparametric Bayes
estimators, respectively. It does so for a hypothetical teacher j with total sample size nj = 20
with a fixed effect estimate, yj , in the range of [-2, 2]. As noted, the parametric Bayes

 15
     A similar thought experiment can be conducted for a teacher who shows very poor observed performance
(that is, who has a large negative yj ) and has a relatively small total sample size. Under the parametric
shrinkage rule, this teacher would be regarded as more similar to the mean quality teacher, while the
nonparametric rule does not adjust in a mechanical way, but allows for a range of possibilities that are
informed by the data.
  16
     Looking ahead, this will roughly coincide with the parametric empirical Bayes estimates obtained using
the North Carolina data on mathematics scores.


                                                    12
estimator shrinks estimates linearly and symmetrically toward zero, with the direction of
the shrinkage depending only on the sign of y and not its magnitude. In contrast, the
nonparametric Bayes estimator (in equation (2.7)) is a nonlinear function of y and the
direction of shrinkage depends not only on the sign of y but also its magnitude.
    The figure makes clear that differences in the amount of shrinkage between the two
estimators are especially pronounced at the mass points of 1 and -1. On one hand, the
parametric Bayes estimator does not account for the presence of these mass points (as they
are assumed away by normality) and so shrinks them towards zero. The NPB, on the other
hand, adapts to the true underlying distribution ­ we discuss why below ­ and pulls fixed
effects nearby to these two mass points, accounting for the non-negligible probability that
the true quality of some teachers may take values of these mass points.
                                      NP B
    The nonparametric Bayes estimator j    , specified in equation (2.6), is infeasible in
practice since it involves the unknown quantity  2 and the distribution F . We develop a
feasible version of the nonparametric estimator next.



3     A Feasible Nonparametric Bayes Estimator

This section sets out the feasible version of the nonparametric Bayes estimator, which we
refer to as the nonparametric empirical Bayes (or NPEB) estimator, the primary focus for
the remainder of the analysis.
    By way of overview, we take an approach that shares the same spirit as the parametric
empirical Bayes method. For the unknown parameter  2 , we use its maximum likelihood
estimator (see Appendix D), while we estimate the distribution F directly from the data
(instead of assuming it belongs to a parametric distribution family). This then yields the
NPEB estimator (see equation (3.2) below).




                                             13
3.1      Nonparametric Maximum Likelihood Estimation of the Dis-

         tribution F

      Our approach to recovering the teacher VA distribution F is based on methods proposed
in Jiang and Zhang (2009), Koenker and Mizera (2014) and Gu and Koenker (2017b). Those
papers set out a general framework for estimating unobserved heterogeneity in cross-sectional
and longitudinal data settings without imposing any parametric assumptions on the unob-
served heterogeneity, drawing on the seminal contribution by Robbins (1956), referenced
above. As the methodology fits many contemporary `Big Data' applications, the revival
in the use of nonparametric empirical Bayes methods for large-scale inference is natural,17
reflected in several recent applications in statistics and economics.18 The teacher VA applica-
tion fits into this general framework well, as teacher quality can be thought of as unobserved
heterogeneity in a model of test scores that accounts for test score variation unexplained
after controlling for all observed heterogeneity through covariates Xijt .
      We denote the distribution of j in a general way as F , rather than assuming j 
      2
N (0,   ). The distribution F is not observed by the researcher, but can be estimated non-
parametrically from the data via the following optimization:

                                               J
                            ^  argmax
                            F                       log    j (yj - )dF ()                             (3.1)
                                    F F
                                             j =1



where j is a normal density with mean zero and variance  2 /nj , as in (2.4), and the space
                                                                  ^ is the nonparametric
F is the set of all probability distributions on R. The resulting F
maximum likelihood estimator (hereafter `NPMLE') for F .
      Kiefer and Wolfowitz (1956) established consistency of the NPMLE for the mixing dis-
tribution F . A viable computational strategy for the estimator was not available until the

 17
     See Efron (2010) for a survey. A recent simulation comparison across different machine learning methods
is provided in Abadie and Kasy (2019), highlighting the advantages of the nonparametric empirical Bayes
method for high-dimensional settings.
  18
     These include predicting baseball batting averages (Gu and Koenker, 2017a), studying earning dynamics
(Gu and Koenker, 2017b), analyzing treatment effect heterogeneity (Gu and Shen, 2017), and estimating
the impact of neighborhood effects on intergenerational mobility (Abadie and Kasy, 2019).


                                                      14
appearance of the EM algorithm by Laird (1978), and the EM algorithm has remained the
standard approach for its computation ever since.19 However, EM has notoriously slow con-
vergence in nonparametric EB applications, especially with large data sets, and this fact has
inhibited the widespread implementation of the NPMLE.
      Koenker and Mizera (2014) recently proposed an alternative computational method for
the NPMLE that circumvents these issues. They show that for a broad class of mixture prob-
lems, the Kiefer-Wolfowitz estimator can be formulated as a convex optimization problem
and solved efficiently by modern interior point methods. Quicker, more accurate computa-
tion of the NPMLE in turn opens up a much wider range of applications of the method for
models with heterogeneity.20 Here, the large-scale data involved in teacher VA estimation
make it likely to benefit from the scalability of the new computational method.
      The difficulty in estimating equation (3.1), as pointed out in Koenker and Mizera (2014),
is that F is an infinite dimensional object and so there is an infinite number of constraints.
To make computation feasible and maintain the convexity of the problem, they propose
a finite-dimensional convex approximation. Formally, let M be a positive integer and let
FM be the class of probability distribution functions supported on M grid points given by
minj {yj } < 1 < 2 < · · · < M < maxj {yj }. The NPMLE is then defined to be the
                                                                     ^ thus takes the
maximizer of equation (3.1), replacing F by FM . The resulting NPMLE F
form of a discrete distribution.21 Note that the size of the grid M is not a tuning parameter.
When M is reasonably large, increasing it further does not improve the likelihood; Dicker
and Zhao (2016) show that taking M to be roughly the square-root of the sample size renders
a good approximation.




 19
     Heckman and Singer (1984) constitutes an influential econometric application.
 20
     Models with unobserved heterogeneity beyond the normal mixture are discussed in Koenker and Gu
(2017).
  21
     For the data sets we apply this method to, the sample size is around 35,000 for the North Carolina data
and 11,000 for the LAUSD data, and in both cases, we take M = 5000.


                                                    15
3.2      The Plug-in Nonparametric Empirical Bayes Estimator for

         VA
                     ^ , we can construct the NPEB VA estimator as:
      With the NPMLE F

                                                    j (yj - )dF^ ()
                                     N P EB
                                     j      =                       .                                       (3.2)
                                                              ^ ()
                                                    j (yj - )dF

The estimator defined in equation (3.2) is the feasible version of the posterior mean defined
in equation (2.6) in Theorem 2. Once we obtain the NPMLE for F based on (3.1), evaluating
                                             ^ already takes a discrete form (as noted).
(3.2) only involves matrix operations, since F
      We focus on constructing a feasible version of the NPB estimator based on (2.6) directly,
rather than its equivalent reformulation (2.7) in Theorem 2, for two reasons. First, equa-
                                                           NP B
tion (2.7) suggests that the nonparametric Bayes estimator j    does not depend on the
teacher quality distribution F directly, but rather on the marginal density of the fixed effect
estimator. Therefore, in principle we could focus on constructing a feasible estimator for
the marginal density. In practice, this becomes challenging when individual teachers have
heterogeneous variances.22
      Second, kernel-based estimators for the marginal density do not incorporate the model
information that the fixed effect estimator is induced by an underlying normal mixture
model; hence the resulting shrinkage estimator may lose some important properties of the
NPB estimator, such as monotonicity with respect to yj for fixed variances.23 In contrast,
both the construction of the NPMLE of F and the NPEB in (3.2) make use of the mixture
model structure, and so automatically satisfy the monotonicity property.24

 22
     Brown and Greenshtein (2009) proposes a kernel method to estimate the marginal density of yj directly
when variances of yj are all the same ­ when all teachers have the same associated sample sizes, for example.
When variances are homogeneous, the kernel estimator for the marginal density is easy to construct since
we have J independent and identically distributed observations (y1 , . . . , yJ ) from this marginal density. Yet
when individual teachers have heterogeneous variances, it is difficult to apply these methods to construct
(2.7), given the observations (y1 , . . . , yJ ) are no longer identically distributed.
  23
     See Koenker and Mizera (2014) for a monotonized version of the Brown and Greenshtein (2009) estimator.
  24
     We can motivate the proposed estimator (3.2) on the grounds that it makes use of both the information
from the data (to learn about F ) and from the model (using the normal mixture structure). Saha and
                                                                                  N P EB
Guntuboyina (forthcoming) recently showed that the NPEB estimator j                      constructed via the NPMLE


                                                       16
                                 N P EB
    The newly proposed estimator j      has the potential to improve on the linear PEB
estimator (in the sense of having a smaller average squared error) when the underlying
distribution F cannot be approximated well by the normal distribution. The magnitude of
this change can be evaluated through simulations, where the distribution F used to generate
the data is known. We conduct such illustrative simulations next.



4     Simulations

In this section, we use simulations to compare the performance of three estimators: the
fixed effects estimator, the PEB estimator, and our NPEB estimator. We do so relative to
a benchmark ­ infeasible in practice ­ in which the researcher knows the true underlying
teacher quality distribution, and can therefore use the optimal Bayes rule.
    We consider the performance of these candidate estimators on the basis of their mean
squared error under three candidate distributions ­ normal, mixed normal, and chi-squared.
Simulated data are generated using equation (2.2) for 10,000 individual teachers with                  ijt   
N (0, 0.25), set to mimic what we estimate using data later. For comparison, we consider both
a homogeneous class size case where every teacher has a class size of 20, and a heterogeneous
class size case where class size is drawn randomly from the set {20, 40} with equal probability.

The Teacher Quality Distribution is Normal: Table 1(a) displays the simulation re-
sults when teacher quality is normally distributed according to F  N (0, 0.05). Here, the
normality assumption already built into the EB estimator is correct, and so it performs
identically to the infeasible estimator where the distribution is known. We see that the PEB
estimator improves on the mean squared error of the fixed effects estimator substantially.
At the same time, it only outperforms our NPEB estimator by a very small margin: mean
squared error is less than one percent higher under NPEB ­ striking given the NPEB does

                                                             P EB
of F performs similarly to the infeasible NPB estimator j         defined in (2.6). The proposed estimator
achieves this satisfactory approximation to the infeasible estimator, despite of the well-known fact that the
NPMLE of F has a slow convergence rate (Fan, 1991), because the nonparametric Bayes rule is a smooth
functional of F , which can be estimated at a much better rate than the distribution F itself.


                                                     17
not make any parametric assumption about the distribution F .

The Teacher Quality Distribution is Non-Normal: Tables 1(b) and 1(c) show simula-
tion results when teacher quality is not normally distributed. Specifically, in Table 1(b), true
teacher quality follows the mixed normal distribution F  0.98N (0, 0.03)+0.01N (-1, 0.03)+
0.01N (1, 0.03), as in equation (2.8), while in Table 1(c), true teacher quality follows F  2
                                                                                            1.
                                                                                               25


      Here, it is clear that our NPEB estimator outperforms both the PEB estimator and the
fixed effects estimator substantially in terms of mean squared error. Even more noteworthy
is the fact that our NPEB estimator achieves a mean squared error very close to that of the
infeasible estimator (which assumes the true distribution is known): our NPEB estimator
has mean squared error less than one percent higher than the infeasible estimator for both
distributions considered. In contrast, the mean squared errors of the PEB and fixed effect
estimator are 15-60 percent higher. Of note, the PEB estimator performs worse as the
underlying distribution deviates further from normality; thus its efficacy is particularly poor
for the chi-squared distribution, as shown in Table 1(c).
      In sum, as these simulations indicate, our proposed approach has an appealing versa-
tility in that it can adapt to any distribution. Despite being a nonparametric method, it
performs similarly to the PEB estimator when the true distribution is normal. When the
true distribution is not normal, our approach is able to outperform the PEB estimator by a
substantial margin, performing almost as if the true distribution were known. Given there
is no a priori reason to believe that teacher quality follows some specific distribution, the
simulation evidence we have presented buttresses the view that our method can adapt to,
and help recover, any underlying distribution of teacher quality. Next, we take the method
to observational data.




 25
   For comparability, the mixed normal distribution has the same mean and variance as the normal distri-
bution in Table 1(a).


                                                  18
5       Data

Our data are drawn from two administrative data sets, each providing detailed information
about students and teachers, including enrollment history, test scores and teacher assign-
ments. The data from both sources cover similar time periods, grades, and demographic
information, although there are important differences. For that reason, we discuss each data
source separately; a more detailed description is provided in Appendix B.

North Carolina: Our first administrative data set covers all public school students in
North Carolina for third through fifth grade ­ specifically, third grade from 1996-97 to 2008-
09 and for fourth and fifth grades from 1996-97 to 2010-11.26 These data cover around 1.85
million students with 4.5 million student-year observations. We also have detailed demo-
graphic information including parental education (1996-97 through 2005-06), economically
disadvantaged status (1998-99 through 2010-11), ethnicity, gender, limited English status,
disability status, academically gifted status, and an indicator for grade repetition.
      We make several restrictions to construct the sample used for estimating teacher VA,
following Clotfelter et al. (2006) and subsequent research using North Carolina data. Specif-
ically, we require that all students are matched to a teacher, and that students have a valid
lagged test score in the relevant subject. After the sample restrictions, our final sample con-
sists of approximately 2.7 million student-year observations, covering 1.4 million students
and 35,000 teachers.
      Table 2 provides summary statistics for the main variables used in calculating VA. Col-
umn (1) reports these for the entire North Carolina sample, and column (2) for the VA
analysis data set. While the sample restrictions eliminate approximately forty percent of the
observations, we see only minor differences between the two samples, with the VA sample
showing slightly higher performance levels and being drawn from moderately higher socioe-
conomic backgrounds on average.

 26
    Our analysis is restricted to students in those grades since our data set records the test proctor, and the
test proctor is typically the teacher who taught the students throughout the year in these grades. Data for
third grade ceases after 2008-09 because the third grade pretest was discontinued after that year.


                                                      19
Los Angeles Unified School District: Our second data source comes from the Los
Angeles Unified School District (LAUSD). The data set spans third grade from 2003-04
to 2012-13 and fourth and fifth grade from 2003-04 to 2012-13 and 2015-16 to 2016-17.27
It covers roughly 800,000 students with 1.7 million student-year observations. Detailed
demographic data include economically disadvantaged status, ethnicity, gender, age, limited
English status, and a grade repetition indicator, and parental education (missing for thirty
percent of sample).
      Similar to the North Carolina data set, we make several sample restrictions, dropping
students who cannot be matched to a classroom teacher, and students who do not have a
valid lagged test score in the relevant subject. Our VA sample for LA consists of 1.3 million
student-year observations, covering roughly 660,000 students and 11,000 teachers.
      Columns (3) and (4) of Table 2 provides summary statistics for the LAUSD data. Column
(3) reports these for the entire sample, while column (4) does so for the VA analysis data
set. Similar to the North Carolina case, we find that our VA sample is moderately positively
selected, with student test scores being about 0.06 standard deviations higher than the full
sample.

      Comparing the two administrative data sets, clear differences in samples become appar-
ent. While North Carolina has a majority-white student body with a large black minority,
the LAUSD is majority-Hispanic. The LAUSD sample is also drawn from students with
significantly more disadvantaged backgrounds, with students being almost twice as likely
to be free or reduced price lunch-eligible and nearly three times as likely to come from a
household where parents are high school dropouts. These differences may attract particular
teachers, potentially giving rise to a different underlying distribution of teachers in these two
settings.



 27
    Third grade data are missing for 2013-14 and 2014-15 due to a change in the statewide testing regime
that occurred in 2013-14, which resulted in no test score data that year and also eliminated the second grade
test thereafter. As lagged test scores are required when computing value-added, we drop academic years
2013-14 and 2014-15 from the dataset as well as third grade after 2012-13.


                                                     20
6      Results

This section reports estimates of teacher VA using our proposed NPEB methodology, along-
side those using the PEB approach. We describe results for North Carolina and the LAUSD
separately, highlighting differences in the estimated teacher quality distributions. Then we
discuss how these differences will be relevant for the policy analysis in Section 7, and also
compare the out-of-sample performance of our NPEB estimator relative to the PEB estima-
tor.


6.1    VA Estimates

North Carolina: Figure 2(a) displays a boxplot of teacher fixed effects for teachers who
appear once, twice, three times or more than three times, respectively, in our North Carolina
data set. This shows that teachers appearing for more periods ­ typically, more experienced
teachers ­ exhibit less dispersion as the fixed effect for these teachers is estimated with a
larger effective sample size than teachers appearing less frequently. At the same time, the
average fixed effect is similar, regardless of how often teachers appear in the data (conditional
on teacher experience). Bayesian shrinkage is then applied to these fixed effects, serving to
shrink fixed effect estimates for teachers with small sample sizes back towards the mean. The
boxplot in Figure 2(c) shows the magnitude of shrinkage applied by our NPEB estimator.
As expected, only small amounts of shrinkage arise for teachers with more than three years
of data, while teachers who appear less frequently and thus have smaller effective sample
sizes are shrunk towards zero in a more pronounced way.
    The estimated teacher VA distribution used for our NPEB (estimated using equation
(3.1)) is shown in Figure 3(a). At first glance, it appears to be approximately normal,
although policymakers are particularly interested in the tails of the distribution. Given that
focus, Figure 3(b) takes the cube root of the distribution in order to enhance the tails.
Having done so, we can see that the teacher quality distribution exhibits a fat right tail
relative to the Gaussian distribution. In light of this, one might anticipate that applying our


                                               21
NPEB methodology in North Carolina would mostly agree with the PEB method (which
assumes normality), except for the right tail.
      Next, we compare our estimator with the PEB estimator. To do so, we start by estimating
the distribution of teacher VA under the normality assumption using maximum likelihood.28
Based on mathematics scores from all North Carolina school districts, we find that teacher
VA is distributed N (0, 0.047), implying a standard deviation of 0.217, and that ^ 2 = 0.248.
Figure 4(a) then compares the VA estimates obtained from the PEB and NPEB estimators
for representative teachers with a class size of twenty students but who may have different
fixed effect estimates (shown on the horizontal axis). In accord with expectations, teacher VA
is nearly identical across the two methods for teachers with fixed effect estimates below 95th
percentile of its distribution (indicated by the vertical dashed line to the right) of the figure.
There is some disagreement between the two methodologies in the right tail, with the NPEB
estimator not shrinking teachers who have a fixed effect in the far right tail as markedly as
the PEB estimator. This can be seen with the NPEB estimates (shown by the curved line)
being substantially above those estimated using the PEB methodology (the dashed upward-
sloping straight line) and closer to the 45 degree line. Intuitively, this misalignment occurs
because our nonparametric methodology finds a distribution with a fatter right tail than
the normal distribution assumed under the parametric method, and so the NPEB estimator
shrinks teachers less aggressively if they have noticeably large fixed effect estimates.

LAUSD: Figures 2(b) and 2(d) present information for LAUSD ­ boxplots of teacher fixed
effects and the magnitude of shrinkage that our NPEB estimator applies according to how
often teachers appear in the data. These figures are similar to those for North Carolina,
although the LAUSD exhibits a higher variance in teacher fixed effects, which leads to
higher dispersion in VA in the district.
      Our estimated teacher VA distribution using NPEB is shown in Figure 3(c). It is more
dispersed and skewed than the corresponding distribution for North Carolina. Enhancing

 28
    This is the Chetty et al. (2014a) no-drift estimator. Maximum likelihood is used as it is the most efficient
estimator: results are similar if we use method of moments instead.


                                                      22
the tails in Figure 3(d) draws attention to other compelling differences: the VA distribution
has a much thinner left than right tail. Our NPEB methodology should therefore mostly
agree with the PEB method, except in the two tails.
   Using parametric EB, we find teacher VA is distributed as N (0, 0.0977), implying a
standard deviation of 0.3126, and that ^ 2 = 0.2596, which is considerably higher than the
variance we found in North Carolina. Comparing the VA estimates obtained from the two
empirical Bayes estimators, again for representative teachers with a fixed class size of twenty
students, Figure 4(b) indicates that teacher VA is very similar for teachers with their fixed
effect estimates in the 5-95th percentile of its distribution, but deviates in both tails, and
especially in the left tail. Our nonparametric method shrinks them far more strongly back
toward the mean when the fixed effect estimates take a value below the 5th quantile while
shrinking them less aggressively when the fixed effect estimates take a value above the 95th
quantile, in order to adapt to the skewness of the distribution.

Implications for Policy: These differences in the tails of the VA distribution relative
to a normal distribution can drive large differences in policy calculations between the two
empirical Bayes methodologies. On the one hand, the normality assumption is particularly
misspecified in the right tail for North Carolina. Given the set of teachers affected by
interventions targeting high-VA teachers, we expect that the gains from such policies ­ e.g.,
retention bonuses ­ will be understated in the PEB methodology since it shrinks high-VA
teachers back towards the mean too strongly.
   On the other hand, the normality assumption is misspecified in the left tail for the
LAUSD, which is important for policies targeting low-VA teachers, such as teacher release
policies. Here, the PEB methodology is likely to overstate the benefit of such policies since
it does not shrink these low-VA teachers sufficiently back toward the mean.

Teacher Rankings: A natural question arises whether the choice of estimator influences the
ranking of teachers. Consider misclassification rates of teachers in the bottom five percent




                                              23
in terms of both Type I and Type II errors.29 With homogeneous class sizes, the PEB and
NPEB estimators are both monotone functions of teacher fixed effects (Guarino et al., 2015;
Bitler et al., 2019), guaranteeing that teacher rankings (and thus misclassification rates)
are identical across the fixed effect estimator and PEB and NPEB estimators. Once we
allow class size to be different, however, the EB and NPEB estimators are no longer order-
preserving with respect to teacher fixed effects, raising the possibility that misclassification
rates may differ depending on the estimator used, in turn making it unclear which estimator
should (in principle) be used to determine whom to replace.30
      In practice, we find that the choice of empirical Bayes method has little appreciable
impact on teacher rankings. In both data sets, a very small fraction of teachers ranked
in the bottom five percent of the teacher quality distribution under PEB is not ranked in
the bottom five percent according to NPEB. (The exact numbers of teachers ranked in the
bottom five percent under PEB but not under NPEB for our two datasets are: 34 out of
1753 for North Carolina and 33 out of 554 for the LAUSD, respectively.) This is in line with
our simulation results, which reveal nearly identical misclassification rates across the three
estimators ­ see Tables F.1(a)-F.1(c).


6.2      Out-of-Sample Predictions

      Given our estimates of VA described above, we now evaluate the performance of our
NPEB estimator relative to the fixed effect and PEB estimators. A natural way of evaluating
the estimators is on the basis of their ability to predict future outcomes. For instance, suppose
that school boards or policymakers observe a teacher's past performance and wish to predict
future outcomes for that teacher. We can measure the performance of this prediction via
                                      ^j,t+1 )2 , where yj,t+1 is the true outcome of teacher j in
the squared error distance, (yj,t+1 - y
period t + 1 and y
                 ^j,t+1 is its predictor, utilizing all past information relating to her teaching
 29
     In this context, a Type I error occurs when a teacher is ranked below 5% while her true quality ranking
is above 5%; conversely, a Type II error occurs when a teacher is ranked above 5% when her true quality is
below 5%.
  30
     For instance, Mehta (2019) finds that policymakers should not use the empirical Bayes correction under
certain systematic relationships between teacher quality and class size.


                                                    24
performance, starting when the teacher first appeared in the sample up until the t-th period.
      This prediction exercise faces one inherent difficulty in that the class sizes of teachers
in period t + 1 differ. Thus, even if we had a perfect estimator for a teacher's quality j ,
since yi,t+1  N (j ,  2 /nj,t+1 ), the larger the class size, the less variability there would be in
outcomes the following year, given by yj,t+1 , making teacher quality easier to predict for the
corresponding teacher. To account for this, we use the following two measures of prediction
accuracy proposed in Brown (2008): normalized mean squared error (NMSE) and total mean
squared error (TMSE). NMSE is given by:

                                          1
                            N M SE =                                    ^j,t+1 )2 ,
                                                       nj,t+1 (yj,t+1 - y                            (6.1)
                                          K     j I


where I is the set of teachers whose performance is being predicted and K is the size of that
set. The NMSE is the usual sum of squared errors with an adjustment term nj,t+1 (where
the adjustment term serves to scale back the contribution of teachers with large classes sizes,
who have higher precision by construction, by the size of their class, nj,t+1 ). Alternatively,
TMSE is given by:

                                       1                                       2
                           T M SE =                             ^j,t+1 )2 -
                                                      (yj,t+1 - y                      .             (6.2)
                                       K       j I
                                                                              nj,t+1

                                      2
Without the adjustment term         nj,t+1
                                           ,   the quantity is just the usual sum of squared errors;
the adjustment term is introduced to account for the effect of different class sizes on the
variance.
      Tables 3(a) and 3(b) report NMSE and TMSE using the North Carolina and LAUSD
data for three different estimators: NPEB, parametric EB, and fixed effects. Each row in
the table represents the number of prior years of teacher j 's performance used to make the
prediction.31 The empirical Bayes methods (reported in the first two columns) substantially
outperform the fixed effects method when only a few years of prior data are used, the extra
 31
  To predict the performance of teacher j using t years of data, we restrict the sample to include teachers
who appear t +1 times.


                                                         25
gain being substantial when information about a teacher is scarce. As more and more years
of data become available, the gain from using empirical Bayes diminishes in comparison with
the fixed effect estimator.
      Comparing the two empirical Bayes estimators, the NPEB outperforms the PEB esti-
mator under both prediction accuracy measures, except when only using one prior year of
information with the LAUSD data set. When 2-5 years of data are used, the prediction per-
formance of the NPEB estimator surpasses that of the PEB by the greatest margin. With
many years of data, the NPEB continues to outperform the parametric EB, although both
methods begin approaching the performance of the fixed effect estimator, given teacher-
specific sample sizes have become large enough such that estimates are no longer shrunken
materially. Of note, teacher tenure decisions are often made in practice during the time
window when our nonparametric methodology outperforms that of the PEB by the greatest
margin (namely using 2-5 years of data per teacher).32



7       Policy Analysis

This section performs policy calculations for policies that target the bottom and top of
the teacher quality distributions, respectively. We pay particular attention to differences in
policy calculations found using our nonparametric method relative to those using the PEB
methodology. (Standard errors for our policy calculations are bootstrapped ­ see Appendix
C for details.)


7.1      Policy Experiment I: Lay-off Policies

      One policy recommendation that has gained considerable traction focuses on replacing
poor-quality teachers with mean-quality teachers. The specific proposal made by Hanushek
(2009, 2011) and further explored by Chetty et al. (2014b) involves releasing teachers in the


 32
    Among the five most populous states, for instance, Texas, Pennsylvania and Florida award teacher tenure
after three years, while California and New York award tenure after two and four years, respectively.


                                                    26
bottom 5% of the estimated VA distribution, replacing them with those who are of average
quality. Here, we calculate the policy gains from (more generally) replacing the bottom
q % of teachers, although we pay particular attention to the `bottom 5%' cutoff, given its
prominence both in the literature and policy debate.
      Under parametric EB, the policy gain of replacing the bottom q % of teachers is calculated
based on the assumption that teacher VA is normally distributed. Since teachers are assumed
                         2
to be drawn from   N (0,   ), replacement teachers who are at the mean of the distribution
are those with  = 0. In addition, since a one-unit increase in  (meaning VA) leads to a one
SD test score gain, the marginal gain in test scores from such a policy, denoted as M R(q ),
is:


                                 M R(q )  -E[ |  < -1 (q )] ,                              (7.1)


                           2
where  is the cdf of N (0,   ) and q is the cutoff percentage. Further, under the assumption
             2
that   N (0,   ), it is straightforward to show that

                                                 -1 (q )
                                                 -
                                                         ()d
                                 M R (q ) = -      - 1
                                                   (q )
                                                                  ,                        (7.2)
                                                  -
                                                         ()d

                               2
with () being the pdf of N (0,   ). Similarly, the total gain in test scores for a policy that
deselects the bottom q % of teachers, denoted T R(q ), is:


                                  T R(q )  E[1{  -1 (q )}] ,                               (7.3)


where 1{  -1 (q )} takes the value one if the teacher's quality is greater than the cutoff
value -1 (q ) and zero otherwise. Again, under the assumption that   N (0, 2
                                                                             ), this can
be written:

                                                 +
                                   T R(q ) =              ()d .                            (7.4)
                                                -1 (q )




                                                 27
   The normality assumption embedded in the PEB estimator is likely misspecified, however,
given the distributions we estimated nonparametrically in Section 6. Based on our estimated
distributions, replacement teachers remain mean zero (i.e.,  = 0) since VA is always centered.
The marginal and total test score gains from a policy laying off the bottom q percent of
teachers with our estimated distribution are instead given by:

                                               F -1 (q )
                                               -
                                                         f ()d
                               M R (q ) = -     F -1 (q )
                                                                   ,                     (7.5)
                                                -
                                                          f ()d
                                              +
                                T R (q ) =               f ()d ,                         (7.6)
                                             F -1 (q )


where F () and f () are the true cumulative probability distribution and density functions
of unobserved teacher VA, respectively.
   The distribution F is identified from the data (appealing to Theorem 1), so we can
evaluate the policy under two distributions of VA: (i) the normal distribution with a standard
deviation estimated from the data, and (ii) the distribution F estimated using the same data
set. To begin, we assume that the policymaker can observe true teacher VA, an assumption
we relax below.
   Figure 5 compares the policy gains under the PEB methodology (where it is assumed
             2
that   N (0,   )) with those found using our NPEB method (where   F ). For North
Carolina, the PEB methodology overestimates policy gains, although not substantially. The
picture is very different for LAUSD, however, with the PEB methodology overestimating the
policy gains considerably (see the bottom two panels).
   Table 4(a) quantifies these differences by reporting test score gains under the PEB
methodology and our NPEB methodology respectively for a policy that releases the bot-
tom q % of teachers for both North Carolina and the LAUSD. The bolded row indicates
our benchmark policy that releases bottom-ventile (i.e., bottom-5 percent) VA teachers.
Columns (1) and (2) indicate that the PEB method overstates the policy gains by about five
percent relative to our NPEB method in North Carolina and so the normality assumption



                                                28
appears reasonably well-founded in that context for policies targeting the left tail. In con-
trast, the PEB method overstates the policy gains by twenty-four percent in the LAUSD.
While the differences in test score gains comparing the PEB and NPEB methods are highly
statistically significant in both cases, the normality assumption is clearly far more misplaced
in the LAUSD data, highlighting the benefit of using the flexible method we propose. The
method adapts to the underlying distribution, which is unknown a priori.

Accounting for the Fact that VA is Estimated: The above policy analysis is based on
the presumption that we know true teacher VA and thus can distinguish teachers accurately
based on their quality. In reality, teacher VA is estimated. To account for this, we replace
the test score gains in equations (7.2) and (7.5) with their sample analogs.33 These sample
analogs are calculated via Monte Carlo simulation, assuming that we estimate both ^^ and

^
F ^ using three years of data for each teacher and assuming teachers all have class sizes of

twenty.
                                                                               2
      Under the PEB methodology, first we sample 40000 observations from N (0,   ). Sec-
ond, for each sample observation, we generate the noisy data yj = j +                       j   assuming

 j     N (0,  2 /(k · n)), where n represents yearly class sizes (set at 20) and k represents
the number of years of data for each teacher (set at 3). Third, we use the PEB estimator to
                        P EB
obtain an estimated VA, j    , and calculate             1             P EB
                                                                   j 1{j    >^ -1 (q )} as an estimator
                                                       40000   j               ^

for T R(q ), the sample analog of equation (7.4). By the law of large numbers, this produces
a consistent estimator for T R(q ). Analogously, we sample VA from the distribution F , use
                                       N P EB
the NPEB method to obtain an estimator j      , and calculate T R(q ) in a similar fashion.
      Results based on these simulations are presented in Figure F.1. The policy gains fall
when using estimated rather than true VA since some teachers with true VA below the
fifth percentile are retained. The decrease in test score gains is relatively modest, however,

 33
      For example, the marginal and total test score gains under   F (equation (7.5)) become:

                                      M R(q ) = -EF [|  ^ -1 (q )] ,
                                                      ^<F ^

                                       T R(q ) = EF [1{ ^ -1 (q )}] ,
                                                       ^F ^

      ^
where F ^ is the empirical CDF for the estimated ^.


                                                      29
and is similar for both the PEB and NPEB methodologies. This is unsurprising since the
methodologies do not substantially affect the ranking of teachers (as discussed in Section
6.1) and so using estimated rather than true VA should affect them in a similar manner.
   Table 4(b) reports these policy gains when true teacher VA is unobserved. Results are
very similar to the case when VA is observed by the policymaker: the PEB method overstates
the policy gains by seven percent in North Carolina and by fully twenty-seven percent in the
LAUSD data.


7.2    Policy Experiment II: Retention Policies

   Next we consider policies that focus on high-VA teachers in the right tail of the dis-
tribution. Specifically, we examine policies that seek to retain these high-quality teachers,
who might otherwise leave the profession. We assume that if a high-quality teacher is not
retained, she is replaced with an average quality teacher (with a VA of zero). The total test
score gains from a policy that retains teachers whose VA is greater than or equal to the 1 - q
percentile of the quality distribution are given by:

                                              F -1 (1-q )
                               T R (q ) = -                 f ()d .                      (7.7)
                                              -


(Computational details are analogous to those for the `teacher release' policy above.)
   Tables 5(a) and 5(b) compare the policy gains for North Carolina and the LAUSD when
true teacher quality is observable and unobservable (respectively) to the policymaker. Anal-
ogously, Figure F.2 plots these gains. Here, at the far right tail of the distribution (i.e.,
the top three percent of teachers), the PEB methodology underestimates the policy gains
of targeting high-VA teachers by about five percent in North Carolina when true teacher
VA is unobserved (see columns (3) and (4)). Intuitively, this underestimation comes from
the fact that North Carolina's teacher VA distribution features a fat right tail and so the
PEB method `believes' there are fewer right-tail teachers than there actually are. As we
move away from the extreme right tail of the distribution (to around the fifth percentile),


                                               30
the tail becomes thinner and so the PEB methodology begins to overestimate the policy
gains of targeting high VA teachers. A similar story holds in the LAUSD data, although the
underestimation of the PEB estimator in the far right tail is less pronounced.


7.3      Extensions

      With our data structure, according to which each teacher teaches one class of students
each year ­ a feature common in many education data sets ­ our methodology can be
extended to allow for either class-level shocks or drift in teacher quality. We note, however,
that our data structure does not allow us to account for both simultaneously.34 We focus
on extending our model to allow for class-level shocks rather than drift since the amount of
drift in both our data sets appears limited, consistent with prior research using these data
sets.35 That is, classroom shocks are quantitatively more important in our data.

Class-level Shocks: These are common shocks affecting everyone in a given classroom.
The proverbial example involves a dog barking outside the classroom window on test day,
lowering the test scores of all students in that class. Because teachers are unable to control
the dog barking in this example, these class-level shocks should not be attributed to the
teacher. Accounting for them acts to reduce dispersion in teacher VA estimates, as they
subsume some of the class-year variation that was previously attributed to teachers. Since
the variance of VA estimates falls once these shocks are incorporated, the policy gains from
targeting the tails of the teacher VA distribution are likely to decrease as teachers in the
tails are pulled closer to the mean. Our results below are consistent with this pattern.
      Given that classrooms in our data are identified by unique teacher-year pairs, we rewrite




 34
     To include both class-level shocks and drift, one would need data in which teachers taught multiple
classrooms in each year, as in Chetty et al. (2014a). Those authors are able to allow for class-level shocks
and drift for middle school teachers, observed to teach multiple classes each year.
  35
     The small amount of drift (relative to Chetty et al. (2014a)) has been noted by Bacher-Hicks et al. (2014)
for the LAUSD data and by Rothstein (2017) for the North Carolina data.


                                                      31
our model given by equation (2.2) as:


                               yijt = j + jt +          ijt ,    i = 1, 2, . . . , njt ,               (7.8)


where yijt is student i's residual test score, j is teacher j 's VA, and jt represent the class-
level shocks, which are independent of the student-level shocks,                           ijt .

                                                                    2
   Assuming classroom shocks are distributed normally with variance   , it follows that the
                                                                                                         2
                                                                                 2
teacher-year specific sample mean can be modeled as yjt = j + jt where jt  N (0,   +njt
                                                                                        ).
The teacher-specific fixed effect estimator yj is then constructed as before (see equation (2.3)),
                                                    2     -1
                                  2  
except the weights hjt now become   +n jt
                                                                . The NPEB estimator, parallel to the result
in Theorem 2, can be expressed as follows:

                                                                   2
Theorem 3 Given the model yjt = j + jt , with j  F , and jt  N (0,   +  2 /njt ), the
fixed effect estimator for j takes the form


                                       yj =             hjt yjt /       hjt
                                                t                   t


                         -1
           2       2
with hjt =   +     njt
                              , and the estimator of j that minimizes the Bayes risk under L2
loss takes the form


                      NP B                    2          2       -1 -1   
                      j    = yj +               +                          log gj (y )|y=yj ,
                                        t
                                                         njt             y


where gj (·) is the marginal density of yj .


Proof. The proof is very similar to that of Theorem 2 and follows from the fact that the
fixed effects {yj } take the form yj = j + j , and j  N (0, (                        t   hjt )-1 ).
   The above theorem assumes a normal distribution for both the classroom and student-
                             2
level shocks (i.e, jt  N (0,   ) and          ijt    N (0,  2 )). Once again, we show that this is
not necessary in Appendix A.2, although it is imposed for estimation purposes, with the



                                                         32
           2
parameters   and  2 being estimated using maximum likelihood (as described in Appendix
D.2).

Results: We incorporate classroom shocks in our estimation of the distribution of teacher
quality. As expected, the addition of classroom shocks reduces the variance of our estimated
distribution, with this reduction being more pronounced in the LAUSD data relative to the
NC data. The reduction in variance is also larger when using the PEB methodology relative
to our nonparametric method.
   Revisiting the policy evaluation, Figure F.3 displays the policy gains from releasing the
bottom q percent of teachers according to VA under both our nonparametric method and
the PEB methodology when teacher quality is observed, then unobserved, respectively. As
in the case without classroom shocks, the PEB methodology only overestimates policy gains
by a small margin in North Carolina, but substantially overestimates them in the LAUSD.
Relative to the model without classroom shocks, however, the overestimation in both data
sets is reduced. This occurs since the addition of classroom shocks reduces the variance in
the PEB methodology by more than in the NPEB methodology, and the q percent of teachers
being released under a low-variance distribution will tend to be of higher quality relative to
a high variance distribution.
   Tables F.2(a) and F.2(b) report the estimated policy gains (along with their standard
errors) when true teacher VA is observed and unobserved to the policymaker, respectively.
When teacher VA is unobserved by the policymaker, the PEB method does not overestimate
policy gains in North Carolina under our benchmark policy that releases bottom-ventile
teachers (made bold in Table F.2(b)). In the LAUSD, however, policy gains are still overes-
timated by over sixteen percent.
   Similarly, Tables F.3(a) and F.3(b) report the policy gains for teacher retention under the
classroom shocks model. Specifically, the PEB method underestimates policy gains (as for
the case without classroom shocks), with the degree of underestimation being higher than in
the model without classroom shocks (as the decreased variance in the PEB relative to NPEB



                                             33
methodology exacerbates the underestimation). Here, the PEB methodology underestimates
the policy gains of retention policies targeting top-ventile teachers by around 15-20 percent
(with this underestimation being more pronounced in the North Carolina data).



8     Conclusion

In this paper, we have proposed a new approach to estimating teacher VA that relaxes
the normality assumption embedded in the popular parametric Empirical Bayes method.
Our nonparametric Empirical Bayes approach is appealing in that it allows the underlying
distribution of teacher quality to be estimated directly, and in a computationally feasible
way using large data sets.
    We applied the methodology to two separate administrative data sets in education, show-
ing that the estimated teacher VA distributions differed from each other and departed from
normality. We then explored the implications of these departures from normality in a range
of policy evaluations, showing that the benefits of teacher lay-off policies may be overstated
to a large degree (at least, in one of the two settings) and that the benefits of retention
policies may be overstated (in the other setting).
    The nonparametric approach to estimation has broader applicability to other areas of
education research, where the underlying heterogeneity of students, teachers and schools is
intrinsic. For example, looking beyond the current application, our methodology is well-
suited to capturing dynamic policy-driven changes in underlying teacher quality distribu-
tions. Here, suppose that policymakers implemented a policy releasing teachers in the bot-
tom of the teacher VA distribution every year. Under such a policy, the left tail of the
teacher quality distribution would necessarily become truncated. When imposing a normal-
ity assumption in this case, `fitting the data' would then require lowering the VA of teachers
near the truncation point to `create' a left tail, thereby underestimating the VA of teachers
at the bottom of the distribution, in turn likely overestimating the gains of continuing the
policy. Given that our method estimates such changes in the underlying teacher quality


                                             34
distributions flexibly, it should provide sharper predictions regarding the continuing policy
gains associated with implementing such dynamic reforms.
   Our analysis has served to underline the notion that analytical convenience need no
longer weigh on the side of assuming normality when applying empirical Bayes methods.
The NPEB approach is relevant in a variety of other settings where parametric empirical
Bayes methods have been used. These include, to date, the estimation of non-cognitive
teacher effects (Jackson, 2018; Petek and Pope, 2018), school quality (Angrist et al., 2017;
Bruhn, 2020), neighborhood effects (Chetty and Hendren, 2018), discrimination (Goncalves
and Mello, 2018), physician effects (Fletcher et al., 2014), and hospital effects (Chandra
et al., 2016; Hull, 2020). As large-scale panel data sets become more widely available in
various fields, so the range of feasible applications using the nonparametric empirical Bayes
approach is likely to increase. To that end, we have written, and are making available, code
that will allow researchers to implement the NPEB method in other contexts.




                                             35
References

Abadie, Alberto and Maximilian Kasy (2019), "Choosing among regularized estimators in
  empirical economics: The risk of machine learning." Review of Economics and Statistics,
  101, 743­762.

Angrist, Joshua D., Peter D. Hull, Parag A. Pathak, and Christopher R. Walters (2017),
  "Leveraging lotteries for school value-added: Testing and estimation." Quarterly Journal
  of Economics, 132, 871­919.

Bacher-Hicks, Andrew, Thomas J. Kane, and Douglas O. Staiger (2014), "Validating teacher
  effect estimates using changes in teacher assignments in Los Angeles." Working Paper
  20657, National Bureau of Economic Research, URL http://www.nber.org/papers/
  w20657.

Bitler, Marianne, Sean Corcoran, Thurston Domina, and Emily Penner (2019), "Teacher
  effects on student achievement and height: A cautionary tale." Working Paper 26480,
  National Bureau of Economic Research, URL http://www.nber.org/papers/w26480.

Bonhomme, St´
            ephane and Martin Weidner (2019), "Posterior average effects." Working Pa-
  per CWP43/19, Centre for Microdata Methods and Practice, URL https://www.cemmap.
  ac.uk/publication/id/14366.

Brown, Lawrence D. (2008), "In-season prediction of batting averages: A field test of em-
  pirical Bayes and Bayes methodologies." Annals of Applied Statistics, 2, 113­152.

Brown, Lawrence D. and Eitan Greenshtein (2009), "Nonparametric empirical Bayes and
  compound decision approaches to estimation of a high-dimensional vector of normal
  means." Annals of Statistics, 37, 1685­1704.

Bruhn, Jesse (2020), "The consequences of sorting for understanding school quality." URL
  http://www.jessebruhn.com/research. Unpublished.



                                            36
Chandra, Amitabh, Amy Finkelstein, Adam Sacarny, and Chad Syverson (2016), "Health
  care exceptionalism? Performance and allocation in the US health care sector." American
  Economic Review, 106, 2110­44.

Chetty, Raj, John N. Friedman, and Jonah E. Rockoff (2014a), "Measuring the impacts of
  teachers I: Evaluating bias in teacher value-added estimates." American Economic Review,
  104, 2593­2632.

Chetty, Raj, John N. Friedman, and Jonah E. Rockoff (2014b), "Measuring the impacts of
  teachers II: Teacher value-added and student outcomes in adulthood." American Economic
  Review, 104, 2633­79.

Chetty, Raj, John N. Friedman, and Jonah E. Rockoff (2017), "Measuring the impacts of
  teachers: Reply." American Economic Review, 107, 1685­1717.

Chetty, Raj and Nathaniel Hendren (2018), "The impacts of neighborhoods on intergener-
  ational mobility II: County-level estimates." Quarterly Journal of Economics, 133, 1163­
  1228.

Clotfelter, Charles T., Helen F. Ladd, and Jacob L. Vigdor (2006), "Teacher-student match-
  ing and the assessment of teacher effectiveness." Journal of Human Resources, 41, 778­
  820.

Dicker, Lee H. and Sihai D. Zhao (2016), "High-dimensional classification via nonparametric
  empirical Bayes and maximum likelihood inference." Biometrika, 103, 21­34.

Efron, Bradley (2003), "Robbins, empirical Bayes and microarrays." Annals of Statistics, 31,
  366­378.

Efron, Bradley (2010), Large-scale Inference: Empirical Bayes methods for estimation, test-
  ing, and prediction. Cambridge University Press, Cambridge, UK.

Efron, Bradley (2011), "Tweedie's formula and selection bias." Journal of American Statis-
  tical Association, 106, 1602­1614.

                                            37
Evdokimov, Kirill and Halbert White (2012), "Some extensions of a lemma of Kotlarski."
  Econometric Theory, 28, 925­932.

Fan, Jianqing (1991), "On the optimal rates of convergence for nonparametric deconvolution
  problems." Annals of Statistics, 19, 1257­1272.

Fletcher, Jason M., Leora I. Horwitz, and Elizabeth Bradley (2014), "Estimating the value
  added of attending physicians on patient outcomes." Working Paper 20534, National Bu-
  reau of Economic Research, URL http://www.nber.org/papers/w20534.

Goldhaber, Dan and Richard Startz (2017), "On the distribution of worker productivity:
  The case of teacher effectiveness and student achievement." Statistics and Public Policy,
  4, 1­12.

Goncalves, Felipe and Steven Mello (2018), "A few bad apples?        Racial bias in polic-
  ing." URL https://static1.squarespace.com/static/58d9a8d71e5b6c72dc2a90f1/
  t/5cfe39c1db1f980001595d4d/1560164805693/GoncalvesMello.pdf. Unpublished.

Gu, Jiaying and Roger Koenker (2017a), "Empirical Bayesball remixed: Empirical Bayes
  methods for longitudinal data." Journal of Applied Econometrics, 32, 575­599.

Gu, Jiaying and Roger Koenker (2017b), "Unobserved heterogeneity in income dynamics:
  An empirical Bayes perspective." Journal of Business & Economic Statistics, 35, 1­16.

Gu, Jiaying, Roger Koenker, and Stanislav Volgushev (2018), "Testing for homogeneity in
  mixture models." Econometric Theory, 34, 850 ­ 895.

Gu, Jiaying and Shu Shen (2017), "Oracle and adaptive false discovery rate controlling
  methods for one-sided testing: Theory and application in treatment effect evaluation."
  Econometrics Journal, 21, 11­35.

Guarino, Cassandra M., Michelle Maxfield, Mark D. Reckase, Paul N. Thompson, and Jef-
  frey M. Wooldridge (2015), "An evaluation of empirical Bayes's estimation of value-added


                                            38
  teacher performance measures." Journal of Educational and Behavioral Statistics, 40, 190­
  222.

Hanushek, Eric A. (2009), "Teacher deselection." In Creating a New Teaching Profession
  (Dan Goldhaber and Jane Hannaway, eds.), 165­180, Urban Institute Press, Washington,
  DC.

Hanushek, Eric A. (2011), "The economic value of higher teacher quality." Economics of
  Education Review, 30, 466­479.

Harris, Douglas N. and Tim R. Sass (2014), "Skills, productivity and the evaluation of
  teacher performance." Economics of Education Review, 40, 183­204.

Heckman, James and Burton Singer (1984), "A method for minimizing the impact of distribu-
  tional assumptions in econometric models for duration data." Econometrica, 52, 271­320.

Hull,    Peter (2020),   "Estimating hospital quality with quasi-experimental data."
  URL                https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%
  2Fs%2Fhb54rrz3vte8gij%2FRAM_012020.pdf%3Fraw%3D1&sa=D&sntz=1&usg=
  AFQjCNE-ap7RlsV8PsFpJ64ekwD2HmqIjQ. Unpublished.

Jackson, C. Kirabo (2018), "What do test scores miss? The importance of teacher effects on
  non-test score outcomes." Journal of Political Economy, 126, 2072­2107.

Jacob, Brian A. and Lars Lefgren (2008), "Can principals identify effective teachers? Evi-
  dence on subjective performance evaluation in education." Journal of Labor Economics,
  26, 101­136.

James, W. and Charles Stein (1961), "Estimation with quadratic loss." In Proceedings of
  the Fourth Berkeley Symposium on Mathematical Statistics and Probability, Volume 1:
  Contributions to the Theory of Statistics, 361­379, University of California Press, Berkeley,
  Calif.



                                              39
Jiang, Wenhua and Cun-Hui Zhang (2009), "General maximum likelihood empirical Bayes
  estimation of normal means." Annals of Statistics, 37, 1647­1684.

Kane, Thomas J., Jonah E. Rockoff, and Douglas O. Staiger (2008), "What does certifica-
  tion tell us about teacher effectiveness? Evidence from New York City." Economics of
  Education Review, 27, 615­631.

Kane, Thomas J. and Douglas O. Staiger (2008), "Estimating teacher impacts on student
  achievement: An experimental evaluation." Working Paper 14607, National Bureau of
  Economic Research, URL http://www.nber.org/papers/w14607.

Kiefer, Jack and Jacob Wolfowitz (1956), "Consistency of the maximum likelihood estima-
  tor in the presence of infinitely many incidental parameters." Annals of Mathematical
  Statistics, 27, 887­906.

Koedel, Cory, Kata Mihaly, and Jonah E. Rockoff (2015), "Value-added modeling: A review."
  Economics of Education Review, 47, 180­195.

Koenker, Roger and Jiaying Gu (2017), "Rebayes: An R package for empirical Bayes mixture
  methods." Journal of Statistical Software, 82, 1­26.

Koenker, Roger and Ivan Mizera (2014), "Convex optimization, shape constraints, compound
  decisions, and empirical Bayes rules." Journal of the American Statistical Association, 109,
  674­685.

Kotlarski, Ignacy (1967), "On characterizing the gamma and the normal distribution." Pa-
  cific Journal of Mathematics, 20, 69­76.

Laird, Nan (1978), "Nonparametric maximum likelihood estimation of a mixing distribu-
  tion." Journal of the American Statistical Association, 73, 805­811.

Laird, Nan M. and Thomas A. Louis (1987), "Empirical Bayes confidence intervals based on
  bootstrap samples." Journal of American Statistical Association, 82, 805­811.


                                             40
Li, Tong and Quang Vuong (1998), "Nonparametric estimation of the measurement error
  model using multiple indicators." Journal of Multivariate Analysis, 65, 139­165.

McLachlan, G.J. (1987), "On bootstrapping likelihood ratio test statistics for the number of
  components in a normal mixture." Journal of the Royal Statistical Society, Series C, 36,
  318­324.

Mehta, Nirav (2019), "Measuring quality for use in incentive schemes: The case of "shrink-
  age" estimators." Quantitative Economics, 10, 1537­1577.

Petek, Nathan and Nolan Pope (2018), "The multidimensional impact of teachers on stu-
  dents." URL http://www.econweb.umd.edu/~pope/Nolan_Pope_JMP.pdf. Unpublished.

Rao, B.L.S.P. (1992), Identifiability in Stochastic Models: Charaterization of Probability
  Distributions. Academic Press, United Kindom.

Rivkin, Steven G., Eric A. Hanushek, and John F. Kain (2005), "Teachers, schools, and
  academic achievement." Econometrica, 73, 417­458.

Robbins, Herbert (1956), "An empirical Bayes approach to statistics." In Proceedings of the
  Third Berkeley Symposium on Mathematical Statistics and Probability, volume I, Univer-
  sity of California Press, Berkeley.

Rockoff, Jonah E. (2004), "The impact of individual teachers on student achievement: Evi-
  dence from panel data." American Economic Review, 94, 247­252.

Rothstein, Jesse (2017), "Measuring the impacts of teachers: Comment." American Eco-
  nomic Review, 107, 1656­84.

Saha, Sujayam and Adityanand Guntuboyina (forthcoming), "On the nonparametric max-
  imum likelihood estimator for Gaussian location mixture densities with application to
  Gaussian denoising." Annals of Statistics.




                                               41
  Figure 1: Example of Shrinkage under Parametric and Nonparametric Empirical Bayes
                                      Estimators


                               0.4


                                           Parametric Bayes
                                           Nonparametric Bayes
                               0.2
         Amount of Shrinkage

                               0.0
                               -0.2
                               -0.4




                                      -2             -1                0                   1                     2
                                                                              a
                                                            Teacher Fixed Effect

Notes: This figure plots the amount of Bayesian `shrinkage' as a function of the fixed effect estimates for the PB and NPEB
                                                                                          2
                                                                                       
estimators respectively. The shrinkage rule for the PB estimator is given by       2 + 2 /
                                                                                   
                                                                                                    from equation (2.5); for the NPB
                                                                                            t njt
estimator, it is given by the second term in equation (2.7). It does so for the mixed normal distribution specified in equation
(2.8), given by j  0.98N (0, 0.03) + 0.01N (-1, 0.03) + 0.01N (1, 0.03). The total class size for each teacher is set at twenty
and  2 is set at 0.25. Fixed effects take values in the range [-2, 2]. The horizontal dashed line represents no shrinkage being
applied, while the vertical dashed lines represent the mass points in the distribution at -1 and +1.




                                                                  42
                          Figure 2: Boxplots of Fixed Effects and Shrinkage under Nonparametric Empirical Bayes

                                                                                  Fixed Effect Boxplots
                                                     (a) North Carolina                                                                          (b) LAUSD
                                          1.5




                                                 q                                                                                                                        q
                                                                                                                                                                          q
                                                                                                                                             q                            q
                                                 q                                   q
                                                                                                                                             q
                                                                                                                                             q
                                                                                                                                             q                            q
                                                                                                                                                                          q
                                                                                                                                                                          q




                                                                                                                                      1.0
                                                                                                                                                   q                      q
                                                                                                                                                                          q
                                                           q                                                                                 q                            q
                                                 q                                                                                                                        q
                                                                                                                                                                          q
                                                                                                                                                                          q
                                          1.0




                                                 q         q                         q                                                       q     q                q     q
                                                 q                                                                                           q     q
                                                                                                                                                   q                      q
                                                           q                                                                                 q                            q
                                                                                                                                                                          q
                                                 q
                                                 q                                                                                                 q                q     q
                                                                                                                                                                          q
                                                 q                                   q                                                       q
                                                                                                                                             q     q
                                                                                                                                                   q                q
                                                                                                                                                                    q     q
                                                                                                                                                                          q
                                                 q
                                                 q         q                         q                                                       q     q                q     q
                                                 q
                                                 q                                   q                                                             q                      q
                                                                                                                                                                          q
                                                           q
                                                           q                q
                                                                            q        q
                                                                                     q                                                                                    q
                                                 q
                                                 q         q                q
                                                                            q        q
                                                 q
                                                 q         q
                                                           q                q        q
                                                                                     q
                                                 q
                                                 q         q
                                                           q                q
                                                                            q        q
                                                                                     q




                                                                                                                                      0.5
                                                 q         q
                                                           q
                                                           q                q        q
                                                                                     q
                                                                                     q
                                                                            q
         Fixed Effect Estimates




                                                                                                   Fixed Effect Estimates
                                                           q
                                                           q                q
                                                                            q        q
                                                                                     q
                                                           q
                                                           q                q        q
                                          0.5




                                                           q                q
                                                                            q        q
                                                                                     q
                                                                            q        q
                                                                                     q
                                                                                     q




                                                                                                                                      0.0
                                          0.0




                                                                                                                                      -0.5
                                          -0.5




                                                                                     q
                                                                                     q
                                                                            q        q
                                                                                     q
                                                                            q
                                                                            q        q
                                                                                     q
                                                                            q        q
                                                                                     q
                                                           q
                                                           q                q
                                                           q
                                                           q                q
                                                                            q        q                                                                                    q
                                                                                                                                                                          q
                                                                                                                                                                          q
                                                           q                q        q
                                                                                     q                                                                                    q
                                                 q         q
                                                           q                q
                                                 q         q
                                                           q                                                                                       q
                                                                                                                                                   q                      q
                                                 q
                                                 q         q                                                                                                        q
                                                 q         q
                                                           q                                                                                                        q
                                                 q
                                                 q




                                                                                                                                      -1.0
                                                           q                                                                                 q
                                          -1.0




                                                 q
                                                 q
                                                 q
                                                 q
                                                                                                                                             q

                                                 q                                                                                           q



                                                 1         2                3        >3                                                      1     2                3     >3

                                                          Teacher Years in Data                                                                   Teacher Years in Data




                                                 Nonparametric Empirical Bayes (NPEB) Shrinkage Boxplots
                                                     (c) North Carolina                                                                          (d) LAUSD
                                                 q                                                                                           q
                                                                                                                                             q
                                          0.3




                                                 q
                                                 q                                                                                           q
                                                 q                                                                                           q
                                                 q                                                                                           q
                                                 q                                                                                           q
Nonparametric Empirical Bayes Shrinkage




                                                                                                                                             q
                                                                                            Nonparametric Empirical Bayes Shrinkage

                                                                                                                                      0.2




                                                 q
                                                 q
                                                 q                                                                                           q
                                                                                                                                             q
                                                 q
                                                 q                                                                                           q
                                                 q                                                                                           q
                                                                                                                                             q
                                                 q
                                                 q                                                                                           q
                                                 q                                                                                           q
                                                                                                                                             q
                                          0.2




                                                                                                                                             q
                                                                                                                                             q
                                                                                                                                             q
                                                                                                                                             q


                                                           q                                                                                       q
                                                           q
                                                           q
                                                                                                                                      0.1




                                                           q                                                                                       q                q
                                                           q
                                                           q                                                                                       q
                                                           q
                                                           q                                                                                       q
                                          0.1




                                                           q                                                                                       q
                                                                                                                                                                    q
                                                                                                                                                                    q
                                                                            q
                                                                            q                                                                      q
                                                                            q                                                                      q                q
                                                                            q
                                                                            q                                                                                       q
                                                                            q        q                                                                              q
                                                                                                                                                                    q
                                                                                     q
                                                                                     q                                                                                    q
                                                                                                                                                                          q
                                                                                     q
                                                                                     q                                                                                    q
                                                                                     q
                                                                                     q                                                                                    q
                                                                                                                                                                          q
                                                                                                                                                                          q
                                                                                     q                                                                                    q
                                                                                                                                                                          q
                                                                                                                                                                          q
                                                                                                                                                                          q
                                          0.0




                                                                                                                                      0.0




                                                                                     q
                                                                                     q                                                                                    q
                                                                                                                                                                          q
                                                                                                                                                                          q
                                                                                     q
                                                                                     q                                                                                    q
                                                                                                                                                                          q
                                                                                     q
                                                                                     q                                                                                    q
                                                                                     q
                                                                            q        q
                                                                                     q
                                                                            q
                                                                            q
                                          -0.1




                                                                                                                                                                          q
                                                           q                                                                                       q
                                                           q
                                                           q
                                                                                                                                      -0.1
                                          -0.2




                                                 q
                                                 q
                                                 q                                                                                           q
                                                 q
                                                 q                                                                                           q
                                                 q
                                                 q                                                                                           q
                                                                                                                                             q
                                                 q                                                                                           q
                                                                                                                                      -0.2




                                                 q                                                                                           q



                                                 1         2                3        >3                                                      1     2                3     >3

                                                          Teacher Years in Data                                                                   Teacher Years in Data



Notes: Figures 2(a) and 2(b) give the raw fixed effect estimates by the number of times a teacher appears in the data.
Specifically, each panel displays a boxplot of fixed effect estimates for teachers who appear once, twice, three times or more
than three times in our North Carolina and LAUSD datasets, respectively. Figures 2(c) and 2(d) then show boxplots of the
amount of shrinkage applied by our NPEB estimator to teachers who appear once, twice, three times or more than three times
in our North Carolina and LAUSD datasets, respectively. (Boxplots use the box to indicate the interquartile range between the
first and third quartile and use whiskers to indicate the first (respectively, third) quartile minus (plus) the interquartile range
multiplied by 1.5. Outliers beyond this range are shown with dots.)



                                                                                           43
                                                         Figure 3: Estimated Teacher Quality Distributions using Nonparametric Empirical Bayes

                                                                                                                                     North Carolina
                                                                       (a) Estimated VA Distribution                                                                                                                              (b) Cube Root of Estimated VA Distribution
                                                         0.12




                                                                                                                                                                                                                            0.5
                                                         0.10




                                                                                                                                                                                                                   ^ 1/3)
                                                                                                                                                  Cube Root of NPMLE Density of Teacher Value -Added Distribution (F

                                                                                                                                                                                                                            0.4
NPMLE Density of Teacher Value -Added Distribution (F)
                                                    ^

                                                         0.08




                                                                                                                                                                                                                            0.3
                                                         0.06




                                                                                                                                                                                                                            0.2
                                                         0.04




                                                                                                                                                                                                                            0.1
                                                         0.02
                                                         0.00




                                                                                                                                                                                                                            0.0




                                                                -1.0       -0.5     0.0                            0.5         1.0         1.5                                                                                       -1.0    -0.5            0.0                  0.5         1.0         1.5
                                                                                          Teacher Value-Added ()                                                                                                                                      Teacher Value-Added ()


                                                                                                                                           LAUSD
                                                                       (c) Estimated VA Distribution                                                                                                                              (d) Cube Root of Estimated VA Distribution
                                                                                                                                                                                                                            0.4
                                                         0.08




                                                                                                                                                 Cube Root of NPMLE Density of Teacher Value -Added Distribution (F1/3)
                                                                                                                                                                                                                  ^
NPMLE Density of Teacher Value -Added Distribution (F)
                                                    ^




                                                                                                                                                                cubic root NPMLE of the density of 

                                                                                                                                                                                                                            0.3
                                                         0.06




                                                                                                                                                                                                                            0.2
                                                         0.04
                                                         0.02




                                                                                                                                                                                                                            0.1
                                                         0.00




                                                                                                                                                                                                                            0.0




                                                                -1.0         -0.5         0.0                            0.5         1.0                                                                                             -1.0      -0.5                0.0                  0.5         1.0
                                                                                                                                                                                                                                                         Teacher Value-Added ()
                                                                                    Teacher Value-Added ()

                                                                                            ^ , for North Carolina and the LAUSD,
   Notes: Figures 3(a) and 3(c) display the estimated distribution of teacher quality (VA), F
   respectively. These distributions are estimated nonparametrically using equation (3.1). In order to better see tail behavior,
   Figures 3(b) and 3(d) take a cube root of the estimated VA distribution to boost the tails of the distribution for North Carolina
   and the LAUSD, respectively.
                                                                                                                                                 44
                                                  Figure 4: Empirical Bayes `Shrinkage' for Fixed Class Size
                                                                      (class size = 20)
                                                                             (a) North Carolina




                                           1.5
                                                          Parametric EB
                                                          Nonparametric EB
                                                          45 degree
                                           1.0
              Empirical Bayes Estimate

                                           0.5
                                           0.0
                                           -0.5
                                           -1.0
                                           -1.5




                                                   -1.5      -1.0       -0.5          0.0             0.5   1.0   1.5

                                                                              Fixed Effect Estimate

                                                                                (b) LAUSD
                                           1.5




                                                          Parametric EB
                                                          Nonparametric EB
                                                          45 degree
                                           1.0
                Empirical Bayes Estimate

                                           0.5
                                           0.0
                                           -0.5
                                           -1.0
                                           -1.5




                                                   -1.5      -1.0       -0.5          0.0             0.5   1.0   1.5

                                                                              Fixed Effect Estimate

Notes: Figures 4(a) and 4(b) show fixed effect estimates relative to the Bayes estimates for both the parametric (PEB) and
nonparametric empirical Bayes (NPEB) methodologies. The dotted line represents the 45 degree line and indicates where the
fixed effect and empirical Bayes estimates agree. Since the amount of Bayes `shrinkage' applied depends on the total number
of students taught by the teacher, we display the rule for a representative teacher who has taught a total class size of twenty
students. The vertical dashed lines represent the 5th and 95th percentiles of teacher VA estimates according to the fixed effect
estimates to delineate the tails of the value-added distribution.
                                                                                    45
                                  Figure 5: Test Scores Gains from Replacing the Bottom q Percentile of Teachers
                                                                                 North Carolina
                                      (a) Marginal Test Score Gain                                                                     (b) Total Test Score Gains




                                                                                                                         0.06
                                                                            Parametric EB                                           Parametric EB
                                                                            Nonparametric EB                                        Nonparametric EB
                            0.7




                                                                                                                         0.05
Marginal Test Score Gains

                            0.6




                                                                                                                         0.04
                                                                                                Total Test Score Gains

                                                                                                                         0.03
                            0.5




                                                                                                                         0.02
                            0.4




                                                                                                                         0.01
                            0.3




                                                                                                                         0.00




                                  0           5                     10                   15                                     0                  5                    10      15

                                             Percent of Teachers Released                                                                        Percent of Teachers Released
                                                                                         LAUSD
                                      (c) Marginal Test Score Gain                                                                     (d) Total Test Score Gains
                                                                            Parametric EB                                           Parametric EB
                                                                            Nonparametric EB                                        Nonparametric EB
                            1.0




                                                                                                                         0.08
                            0.9




                                                                                                                         0.06
Marginal Test Score Gains




                                                                                                Total Test Score Gains
                            0.8
                            0.7




                                                                                                                         0.04
                            0.6




                                                                                                                         0.02
                            0.5
                            0.4




                                                                                                                         0.00




                                  0           5                     10                   15                                     0                  5                    10      15

                                             Percent of Teachers Released                                                                        Percent of Teachers Released

Notes: Figures 5(a) and 5(b) show the marginal and total test score gains of a policy that releases the bottom q % of teachers
in North Carolina, while figures 5(c) and 5(d) do the same for the LAUSD. The dotted lines indicate the policy gains expected
under the PEB methodology assuming that   N (0,          2 ), where  2 is estimated from the data. The solid lines denote the
                                                                     
policy gains expected under our NPEB methodology where we allow   F , with F being estimated directly from the data
using equation (3.1). Policy gains reported here assume that policymakers observe true underlying value-added; Figure F.1
presents the estimated gains if value-added is estimated rather than observed.

                                                                                               46
                           Table 1(a): Simulation ­ True Distribution is Normal
                              Homogeneous Class Sizes                                   Heterogeneous Class Sizes
                                 (Class Size of 20)                                        (Class Size 20-40)
                         Infeasible NPEB PEB                     FE                 Infeasible NPEB PEB                     FE
 Mean Squared
                           10.81        10.87      10.81       12.50                  11.03        11.07      11.03       12.84
    Error


                      Table 1(b): Simulation ­ True Distribution is Mixed Normal
                              Homogeneous Class Sizes                                   Heterogeneous Class Sizes
                                 (Class Size of 20)                                        (Class Size 20-40)
                         Infeasible NPEB PEB                     FE                 Infeasible NPEB PEB                     FE
 Mean Squared
                           9.08          9.14      10.82       12.51                  7.14          7.18       8.29        9.36
    Error


                        Table 1(c): Simulation ­ True Distribution is Chi-Squared
                              Homogeneous Class Sizes                                   Heterogeneous Class Sizes
                                 (Class Size of 20)                                        (Class Size 20-40)
                         Infeasible NPEB PEB                     FE                 Infeasible NPEB PEB                     FE
 Mean Squared
                           7.44          7.45      10.82       12.51                  5.79          5.79       8.30        9.37
    Error
Notes: The panels in this table report simulation results comparing (across the columns) the performance of the three candidate
estimators against an infeasible benchmark on the basis of mean squared error. The infeasible benchmark is the optimal estimator
when the true distribution is known to the econometrician (although unknown in practice). The three candidate estimators
are: the nonparametric empirical Bayes (NPEB) estimator, which estimates the underlying distribution nonparametrically; the
parametric empirical Bayes (PEB) estimator, which assumes that the underlying distribution is normal; and the fixed effect
(FE) estimator, which applies no empirical Bayes shrinkage. In Table 1(a), teacher VA is normally distributed with mean zero
and variance 0.05 (i.e., F  N (0, 0.05)). In Table 1(b), true teacher quality follows F  0.98N (0, 0.03) + 0.01N (-1, 0.03) +
0.01N (1, 0.03) (as in the example given by equation (2.8)). The normal and mixed normal distributions have the same mean
and variance for comparability. In Table 1(c), teacher value-added follows F  2      1 . The simulations average results from 500
repetitions with 10,000 individual teachers setting  2 = 0.25. Results are reported on the left side of each panel ((a)-(c)) for
homogeneous class sizes (where every teacher has a class size of twenty) and on the right side, for heterogeneous class sizes (where
class sizes are drawn randomly from the set {20, 40} with equal probability).




                                                               47
                                 Table 2: Summary Statistics

                                               North Carolina                         LAUSD
                                             Full        Value-Added          Full        Value-Added
                                            Sample1        Sample            Sample2        Sample
                                              (1)              (2)             (3)              (4)

 Mean of Student Characteristics
 Math Score ( )                              0.00             0.05             0.00            0.07
 Reading Score ( )                           0.00             0.03             0.00            0.06
 Lagged Math Score ( )                       0.01             0.03             0.03            0.08
 Lagged Reading Score ( )                    0.01             0.03             0.03            0.07
 % White                                     57.8             60.1             9.3              9.1
 % Black                                     28.8             27.9             9.9              8.6
 % Hispanic                                   7.4              6.5             74.0            75.5
 % Asian                                      2.0              1.9             4.3              4.4
 % Free or Reduced Price Lunch3              46.3             44.6             77.9            78.2
 % English Learners                           4.3              3.5             28.0            28.9
 % Repeating Grade                            1.5              1.5             1.5              0.4
                         4
 Parental Education:
 % High School Dropout                       11.5             10.6             34.5            34.4
 % High School Graduate                      47.31            47.0             27.6            27.8
 % College Graduate                          25.4             25.9             20.1            20.0
                         5
 Teacher Experience:
 0-2 Years of Experience                     18.6             18.8             4.9              4.8
 3-5 Years of Experience                     15.3             15.6             10.5            10.3
 # of Students                            1,847,615        1,386,555        810,753          664,044
 # of Teachers                              76,503           35,053          15,267           11,078
                6
 Observations                             4,457,812        2,680,027       1,707,459        1,280,569
 (student-year)
Notes:
 1 North Carolina data coverage: grades 4-5 from 1996-97 through 2010-11 and grade 3 from 1996-97

   through 2009-10. The difference in sample sizes between columns (1) and (2) is because we drop 1.37
   million student-year observations who we cannot match to their classroom teacher (see Appendix B for
   more detail).
 2 Los Angeles Unified School District (LAUSD) data coverage: grades 4-5 from 2003-04 through 2012-13

   and 2015-16 through 2016-17 school years and third grade from 2003-04 through 2012-13.
 3 For North Carolina this variable is missing for school years 1996-97 through 1997-98.
 4 The omitted category is `Some College,' and `College Graduate' also incorporates those with graduate

   school degrees. For North Carolina, parental education data are missing after the 2005-06 school year,
   while thirty percent of observations in the LAUSD are missing parental education data or have parental
   education recorded as "Decline to Answer."
 5 The omitted category is `Greater than 5 Years of Experience.' For the full sample, teacher experience

   data are missing for about twenty and fifteen percent of observations for North Carolina and LAUSD,
   respectively.
 6 Data are missing for some observations. For North Carolina (full sample), test scores are missing for

   three percent of observations, lagged test scores for twelve percent, with most other other demographic
   variables missing for about one percent of observations. For the LAUSD (full sample), lagged test scores
   are missing for about six percent of observations with data coverage for all other variables near one
   hundred percent.                                  48
Table 3(a): Predicted Performance of Nonparametric Empirical Bayes (NPEB), Parametric
             Empirical Bayes (PEB) and Fixed Effects ­ North Carolina Data
                                      NMSE                                                       TMSE
 # of Prior                            PEB             Fixed                                      PEB             Fixed
                      NPEB                                                       NPEB
 Years Used                                            Effects                                                    Effects
 t=1                  1.0096           1.0098          1.2236                    0.0378          0.0378           0.0486
 t=2                  0.8613           0.8715          0.9397                    0.0304          0.0309           0.0343
 t=3                  0.7784           0.7872          0.8229                    0.0261          0.0265           0.0283
 t=4                  0.7704           0.7767          0.7998                    0.0259          0.0262           0.0273
 t=5                  0.7651           0.7708          0.7857                    0.0257          0.0260           0.0267
 t=6                  0.7532           0.7573          0.7687                    0.0250          0.0252           0.0258
 t=7                  0.7255           0.7294          0.7372                    0.0240          0.0242           0.0245
 t=8                  0.7123           0.7161          0.7240                    0.0236          0.0238           0.0242


Table 3(b): Predicted Performance of Nonparametric Empirical Bayes (NPEB), Parametric
                Empirical Bayes (PEB) and Fixed Effects ­ LAUSD Data
                                      NMSE                                                       TMSE
 # of Prior                            PEB             Fixed                                      PEB             Fixed
                      NPEB                                                       NPEB
 Years Used                                            Effects                                                    Effects
 t=1                  1.6205           1.6180          1.7975                    0.0631          0.0630           0.0714
 t=2                  1.4030           1.4084          1.4634                    0.0526          0.0529           0.0554
 t=3                  1.3865           1.3902          1.4138                    0.0510          0.0512           0.0523
 t=4                  1.3929           1.3970          1.4138                    0.0513          0.0514           0.0522
 t=5                  1.3852           1.3869          1.3978                    0.0505          0.0506           0.0511
 t=6                  1.4984           1.4999          1.5066                    0.0538          0.0538           0.0541
 t=7                  1.5209           1.5221          1.5306                    0.0539          0.0539           0.0543
 t=8                  1.4249           1.4254          1.4331                    0.0496          0.0496           0.0499
Notes: Smaller values indicate better prediction performance, with NMSE (see equation (6.1)) and TMSE (equation (6.2))
representing normalized mean squared error and total mean squared error, respectively. Tables 3(a) and 3(b) report out-of-
sample prediction errors in the North Carolina and LAUSD datasets for three different estimators: nonparametric empirical
Bayes (NPEB), parametric empirical Bayes (PEB) and fixed effects. To deal with the variation in class size that teachers face
across years, we use NMSE and TMSE as proposed by Brown (2008). The prediction performance is calculated by calculating
the squared error distance (plus an adjustment term for class size) between the true outcome of teacher j in period t +1 and
the outcome predicted for teacher j utilizing all past information relating to her teaching performance from period t minus the
number of prior years used up until the t-th period. For each row, we subset the data so that each teacher is observed for at
least t +1 periods.




                                                             49
         Table 4(a): Test Scores Gains from Releasing Bottom q % of Teachers
                                  True VA Observed
                    North Carolina Data                         LAUSD Data
 % Teachers     Test Gain        Test Gain              Test Gain        Test Gain
  Released       under F       under Normal              under F       under Normal
    (q )          (NPEB)            (EB)                  (NPEB)            (EB)
                    (1)              (2)                    (3)              (4)
     1            0.0058           0.0058                 0.0066           0.0083
                 (0.0001)         (0.0000)               (0.0002)         (0.0001)
        3                 0.0142                   0.0147                            0.0171                  0.0213
                         (0.0002)                 (0.0001)                          (0.0003)                (0.0002)
        5                0.0212                   0.0224                            0.0261                  0.0323
                         (0.0002)                 (0.0001)                          (0.0004)                (0.0002)
        7                 0.0272                   0.0291                            0.0342                  0.0420
                         (0.0003)                 (0.0001)                          (0.0004)                (0.0003)
        9                 0.0326                   0.0352                            0.0415                  0.0508
                         (0.0003)                 (0.0002)                          (0.0005)                (0.0004)

         Table 4(b): Test Scores Gains from Releasing Bottom q % of Teachers
                                 True VA Unobserved
                    North Carolina Data                         LAUSD Data
 % Teachers     Test Gain        Test Gain              Test Gain        Test Gain
  Released       under F       under Normal              under F       under Normal
    (q )          (NPEB)            (EB)                  (NPEB)            (EB)
                    (1)              (2)                    (3)              (4)
     1            0.0056           0.0059                 0.0064           0.0086
                 (0.0001)         (0.0001)               (0.0001)         (0.0001)
        3                 0.0137                   0.0145                            0.0166                  0.0213
                         (0.0003)                 (0.0002)                          (0.0003)                (0.0002)
        5                0.0203                   0.0219                            0.0254                  0.0322
                         (0.0003)                 (0.0003)                          (0.0003)                (0.0003)
        7                 0.0261                   0.0284                            0.0332                  0.0417
                         (0.0004)                 (0.0004)                          (0.0004)                (0.0004)
        9                 0.0312                   0.0342                            0.0405                  0.0503
                         (0.0005)                 (0.0005)                          (0.0005)                (0.0005)
Notes: Table 4(a) displays the estimated gains in mathematics scores in terms of student-level standard deviations of a policy
that releases the bottom q % of teachers and replaces them with mean quality teachers when true teacher quality is observed
by the policymaker. Reported policy gains are those also plotted in Figure 5. `Test score gain under F ' reports the test
score gain of the policy when teacher quality is distributed according the distribution F ­ nonparametrically estimated using
equation (3.1) ­ and applying the NPEB estimator to calculate value-added. `Test score gain under normal' reports the test
score gain when teacher quality is normally distributed and the PEB estimator is used to calculate teacher value-added. Table
4(b) repeats the exercise when the true teacher quality is unobserved to the policymaker and so teacher releases are based on
estimated (rather than true) value-added. These gains are the same as those in Figure F.1 and are calculated via Monte Carlo
simulation with 40,000 observations under the assumption that we estimate       ^ ^ and F
                                                                                         ^^ using three years of data for each
teacher and assuming teachers all have class sizes of twenty. The bolded line indicates the widely-analyzed release bottom five
percent teachers policy. Standard errors are calculated using bootstrap as described in Appendix C.
                                                             50
     Table 5(a): Test Scores Gains of Policy Retaining Top 1 - q Percentile Teachers
                                   True VA Observed
                     North Carolina Data                         LAUSD Data
 % Teachers      Test Gain        Test Gain              Test Gain          Test Gain
  Retained        under F       under Normal              under F         under Normal
   (1 - q )        (NPEB)            (EB)                  (NPEB)              (EB)
                     (1)              (2)                    (3)                (4)
      1            0.0061           0.0058                 0.0084             0.0083
                  (0.0001)         (0.0000)               (0.0002)           (0.0001)
        3                 0.0147                   0.0148                            0.0206                  0.0213
                         (0.0002)                 (0.0001)                          (0.0003)                (0.0002)
        5                 0.0219                   0.0224                            0.0307                  0.0323
                         (0.0002)                 (0.0001)                          (0.0005)                (0.0002)
        7                 0.0281                   0.0291                            0.0394                  0.0420
                         (0.0003)                 (0.0001)                          (0.0005)                (0.0003)
        9                 0.0335                   0.0352                            0.0473                  0.0508
                         (0.0003)                 (0.0002)                          (0.0006)                (0.0004)

     Table 5(b): Test Scores Gains of Policy Retaining Top 1 - q Percentile Teachers
                             True Value-Added Unobserved
                     North Carolina Data                         LAUSD Data
 % Teachers      Test Gain        Test Gain              Test Gain          Test Gain
  Retained        under F       under Normal              under F         under Normal
   (1 - q )        (NPEB)            (EB)                  (NPEB)              (EB)
                     (1)              (2)                    (3)                (4)
      1            0.0060           0.0052                 0.0084             0.0076
                  (0.0001)         (0.0001)               (0.0002)           (0.0001)
        3                 0.0143                   0.0137                            0.0204                  0.0202
                         (0.0003)                 (0.0002)                          (0.0004)                (0.0002)
        5                 0.0212                   0.0210                            0.0302                  0.0309
                         (0.0003)                 (0.0003)                          (0.0005)                (0.0003)
        7                 0.0271                   0.0274                            0.0388                  0.0404
                         (0.0004)                 (0.0004)                          (0.0005)                (0.0004)
        9                 0.0324                   0.0333                            0.0465                  0.0490
                         (0.0005)                 (0.0005)                          (0.0006)                (0.0004)
Notes: Tables 5(a) displays the estimated gains in mathematics scores in terms of student level standard deviations of a policy
that retains the top q % of teachers rather than having them leave teaching and be replace by a mean quality teacher when
true teacher quality is observed by the policymaker. `Test score gain under F ' reports the test score gain of the policy when
teacher quality is distributed according the distribution F ­ nonparametrically estimated using equation (3.1) ­ and applying
the NPEB estimator to calculate value-added. `Test score gain under normal' reports the test score gain when teacher quality
is normally distributed and the PEB estimator is used to calculate teacher value-added. Table 5(b) repeats the exercise when
the true teacher quality is unobserved to the policymaker and so teacher retentions are based on estimated (rather than true)
value-added. These gains are calculated via Monte Carlo simulation with 40,000 observations under the assumption that we
estimate  ^^ and F
                   ^^ using three years of data for each teacher and assuming teachers all have class sizes of twenty. Reported
policy gains in both tables are identical to those shown in Figure F.2. Standard errors are calculated using bootstrap as
described in Appendix C.
                                                             51
A      General Deconvolution Proof with Panel Data

This appendix sets out the general deconvolution proof for the teacher VA model, first
without, then with, classroom shocks.


A.1     Teacher VA model without classroom shocks

Assumption 1 Y1 =  +              1   and Y2 =  +           2   where Y1 and Y2 are random variables with
joint pdf f (·, ·),  is a random variable with pdf g (·), and               1   and    2    are random variables
from the same pdf h(·) with mean zero.

Assumption 2 ,         1,   and   2   are mutually independent.

Assumption 3 The characteristic functions  (·) and  (·) of  and                                   are nonvanishing
everywhere.

Lemma 1 (Kotlarski (1967)) Under Assumption 1-3, the pdf 's of  and                                   are uniquely
determined by the joint distribution of (Y1 , Y2 ). In particular, let  (u, v ) be the characteristic
function of the random vector (Y1 , Y2 ),  (t) the characteristic function of , and  (t) the
characteristic function of , then

                                                        t
                                                      (0, v )/u
                                       (t) = exp                 dv
                                                   0    (0, v )
                                              (t, 0)    (0, t)
                                       (t) =         =         .
                                              (t)       (t)

Proof. Using equation (2.64) in Rao (1992), we have

                                                   t
                                                                 (u, v )
                    log  (t) = iE[]t +                   log                                dv.
                                               0       u      (u, 0) (0, v )          u=0




                                                        52
where i is the imaginary root. Using the fact that

                                                  (u, v )
                                         log
                                       u      (u, 0) (0, v ) u=0
                                          (0, v )/u  (0, 0)/u
                                       =             -
                                           (0, v )         (0, 0)

             (0,0)/u
and that     (0,0)
                        = iE(Y1 ), we have

                                             t                                            t
                                                  (0, v )/u                                    (0, v )/u
             log  (t) = iE[]t +                             dv - iE(Y1 )t =                              dv,
                                         0        (0, v )                             0        (0, v )

where the second equality holds because                  1   has mean zero under Assumption 1.
    Additionally, under Assumptions 1- 3, we have


                                        (u, v ) =  (u + v ) (u) (v ).


Let u = 0, then  (v ) =  (0, v )/ (v ); and letting v = 0, then  (v ) =  (u, 0)/ (u).
    We note that Assumption 1 can be relaxed further to allow                                  1   and   2   to have differ-
ent pdf's. (Recently, a relaxation of Assumption 3 is discussed in Evdokimov and White
(2012).) Li and Vuong (1998) proposed a nonparametric plug-in estimator for  (t) and
 (t) through the nonparametric estimator for  (·, ·), based on J independent observations
{(y1j , y2j )}j =1,...,J of (Y1 , Y2 ), defined as

                                                         J
                                    ^(u, v ) = 1
                                                               exp(iuy1j + ivy2j )
                                               J        j =1


where, again, i is the imaginary unit. We then apply the inverse Fourier transform on  (t)
and  (t), yielding the density functions of  and .

Corollary 4 Consider the general repeated measurement model,


                         Yjs = j +      js ,       j = 1, 2, . . . , J and s = 1, 2, . . . , nj ,



                                                               53
where  is a random variable with pdf g (·) and the                             s    (with s = 1, 2, . . . , nj ) are random vari-
ables from the same pdf h(·) with mean zero. If nj  2,  and                                      s   are mutually independent,
and the characteristic functions  (·) and  (·) are nonvanishing everywhere, then the pdf 's
of  and         are nonparametrically identified.

    The above corollary applies for the teacher value-added model without classroom shocks,
with j indexing teachers and nj being the total number of students taught by teacher j . We
can naturally construct the nonparametric estimator for  (·, ·) as

                                            J
                            ^(u, v ) = 1
                            
                                                          1
                                                                                     exp(iuyjs1 + ivyjs2 ).
                                       J          nj (nj - 1) 1s
                                           j =1                           1 =s2 nj




A.2          Teacher VA model with classroom shocks

    The above reasoning can be extended to the case where we allow for classroom shocks.
To that end, we make three further assumptions:

Assumption 4 Y11 =  + 1 +                       11 ,   Y21 =  + 1 +          21 ,   Y12 =  + 2 +      12 ,   and Y22 =  + 2 +   22

where Y11 , Y21 , Y12 , and Y22 are random variables with joint pdf f (·, ·, ·, ·),  is a random
variable with pdf g (·), 1 and 2 are random variables from the same pdf q (·) with mean zero
and   11 ,    12 ,   21 ,   and   22   are random variables from the same pdf h(·) with mean zero.

Assumption 5 , 1 , 2 ,                   11 ,   12 ,    21 ,   and   22   are mutually independent.

Assumption 6 The characteristic functions  (·),  (·) and  (·) of ,  and                                               are nonva-
nishing everywhere.

Lemma 2 Under Assumptions 4 - 6, the pdf 's of ,  and                                        are uniquely determined by the
joint distribution (Y11 , Y12 , Y21 , Y22 ).

Proof. We use Lemma 1 three times. First, denote Z1 =  + 1 and Z2 =  + 2 . Lemma
1 implies that the joint distribution (Y11 , Y21 ) uniquely determines the pdf of Z1 and                                    and



                                                                     54
the joint distribution (Y12 , Y22 ) uniquely determines the pdf of Z2 and . Now letting the
characteristic function of (Y11 , Y12 ) be denoted as Y11 Y12 (t1 , t2 ), we have


                      Y11 Y12 (t1 , t2 ) = E[exp[i(t1 (Z1 +   11 )     + t2 (Z2 +    12 ))]]


                                       = Z1 Z2 (t1 , t2 ) (t1 ) (t2 ),


where Z1 Z2 (·, ·) is the characteristic function of the random vector (Z1 , Z2 ). The second
equality holds under Assumption 4.
   Since we have already identified the characteristic function  , the characteristic function
of (Z1 , Z2 ) is therefore identified. Now apply Lemma 1 again on


                                               Z1 =  + 1

                                               Z2 =  + 2


to identify the densities of  and .
   Lemma 2 applies to the more general teacher value-added model with classroom shocks:


                                          yijt = j + jt +      ijt ,




where i now indexes students, j indexes teachers and t indexes the academic year. With
E [jt ] = 0 and E [   ijt ]   = 0 and assuming that , jt , and             ijt   are mutually independent of
each other, the pdf's of , , and         are nonparametrically identified.




                                                    55
B       Construction of the Teacher Value-Added Sample

      This appendix describes the construction of the final sample of students and teachers
used for teacher VA estimation in both of our administrative data sets. Sample selection
follows prior work (for instance, Chetty et al. (2014a,b)), the main requirements for inclusion
in the sample being that the student has a valid score in a given subject both in the current
and prior period, and can be matched to a teacher in that subject.


B.1       North Carolina

      For North Carolina, we follow Clotfelter et al. (2006) and subsequent research using
North Carolina data to construct our sample. We start with the entire enrollment history
of students in North Carolina for grades 4-5 over the 1996-97 through 2010-11 school years
and grade 3 over the 1996-97 through 2009-10 school years.36 These data cover roughly 1.85
million students with 4.5 million student-year observations.
      For demographics, we have information about parental education (six education groups,
1996-97 through 2005-06 only), economically disadvantaged status (1998-99 through 2010-
11 only), ethnicity (six ethnic groups), gender, limited English status, disability status,
academically gifted status and grade repetition. Besides the missing data in some years for
parental education and economically disadvantaged status our demographic data cover over
99 percent of all student-year observations. Whenever demographic information is missing,
we create a missing indicator for that variable.
      We then make several sample restrictions. First, we drop the 1.37 million student-year
observations we identify as having an invalid teacher. This is by far our biggest sample
restriction and comes from the fact that we assign teachers to students based on the person
recorded as proctoring the student's exam. To ensure the teacher proctoring the exam
is the same as the classroom teacher, we confirm that the proctor is teaching a primary
 36
   Our analysis is restricted to students in third through fifth grade since our data records the test proctor
and the teacher recorded as the test proctor is typically the teacher who taught the students throughout the
year in these grades. Data for grade 3 stops after 2008-09 because the grade 3 pretest was discontinued after
that year. Grade 3 students in 2005-06 are also omitted due to a lack of the pre-test in the administrative
data for that year.


                                                     56
grade mathematics and English class. If the teacher is not, we drop the observations as we
are no longer confident of matching classes to teachers correctly. Second, we drop charter
school classrooms and special education classrooms, leading to a loss of an additional 70,000
student-year observations. Third, we drop 16,000 observations where we lack data on teacher
experience. Fourth, we exclude 380,000 observations that lack a valid current or lagged test
score in that subject, with half of this loss coming from a lack of third grade mathematics
pretest data in 2005-06 and third grade English pretest data in 2007-08 due to a statewide
test update.37 Fifth, we only include classes with more than seven but fewer than forty
students with valid current and lagged test scores in that subject, creating a loss of 10,000
observations.38 Our final sample consists of roughly 2.7 million student-year observations,
covering 1.4 million students and 35,000 teachers.


B.2       Los Angeles Unified School District (LAUSD)

      For the LAUSD, we start with the entire enrollment history of students in the district
for grades 4-5 over the 2003-04 through 2012-13 and 2015-16 through 2016-17 school years
and third grade from 2003-04 through 2012-13. These data cover roughly 800,000 students
with 1.7 million student-year observations.
      For demographics, we have information about parental education (five education groups),
economically disadvantaged status, ethnicity (seven ethnic groups), gender, limited English
status, age, and an indicator for skipping or repeating a grade. Demographic coverage is ap-
proximately one hundred percent for all demographic variables with the exception of parental
education, which is missing for twenty-nine percent of the sample. Whenever parental edu-
cation is missing, we create a missing indicator for that variable.
      We then make several sample restrictions. First, we drop 100,000 student-year observa-
tions that cannot be matched to a teacher. Second, we drop 180,000 observations where we
lack data on teacher experience. The data we drop here are over-represented in early years

 37
   The third grade pretest is a test given to students at the start of third grade.
 38
   As the last two restrictions are subject-specific, our sample for English value-added has 50,000 fewer
student-year observations.


                                                   57
since we only have teacher experience data from 2007-08 onwards.39 Third, we only include
classes with more than seven but fewer than forty students with valid current and lagged test
scores in that subject, losing 11,000 observations. Fourth, we exclude 70,000 observations
that lack a valid current or lagged test score in that subject.40 Our final sample is roughly
1.3 million student-year observations, covering roughly 660,000 million students and 11,000
teachers.

Constructing Value-Added: With both samples in hand, we construct VA estimates for
each teacher by running the following regression:


                                                                       ¯ c(i,g,t) + vj +
                  yigt = f1g (yi,t-1 ) + f2 (ej (i,g,t) ) + 1 Xigt + 2 X                   igt   .


      We follow Chetty et al. (2014a,b) and parametrize the control function for lagged test
scores f1g (yi,t-1 ) with a cubic polynomial in prior-year scores in mathematics and English
and interact these cubics with the student's grade level. When prior test scores in the other
subject are missing, we set the other subject prior score to zero and include an indicator
for missing data in the other subject interacted with the controls for prior own-subject test
scores.
      We parametrize the control function for teacher experience f2 (ej (i,g,t) ) using dummies for
years of experience from 0 to 5, with the omitted group being teachers with 6 or more years
of experience. The student-level control vector Xigt consists of the respective demographic
                                                          ¯ c(i,g,t) includes (i) class size, (ii)
variables in each dataset. The class-level control vector X
cubics in class and school-grade means of prior-year test scores in mathematics and English
each interacted with grade, (iii) class and school-year means of all the individual covariates,
Xigt , and (iv) grade and year dummies.

 39
    We assume teacher experience for teachers before 2007-08 is given by their experience in 2007-08 minus
the number of years until 2007-08, but we cannot get teacher experience data for any teacher who left before
2007-08. We lose approximately 30% of observations in 2003-04, 25% in 2004-05, 17% in 2005-06, 10% in
2006-07. Every year thereafter we continue to lose about 3-5% of observations due missing values for teacher
experience.
 40
    As the last two restrictions are subject-specific, our sample for English VA has 4,000 fewer student-year
observations.


                                                      58
C      Bootstrapping the Standard Errors

    This appendix discusses the bootstrapped standard errors generated for the policy eval-
uations. The uncertainty of the policy analysis, test score gains under teacher release or
retaining policy, stems from the fact that the distribution of the teacher quality ­ either
nonparametrically identified from the data or under the parametric assumption of Gaussian
­ requires estimation using the data. We apply the bootstrap method in Laird and Louis
(1987) to construct standard errors for these policy evaluation estimates.
    For policy estimates under general distribution F , the following steps describe the boot-
strap procedure: (1) Draw a new independent sample of teacher quality of the same size as
                                      ^ and generate a bootstrap sample of the fixed effect
the original sample from distribution F
            (b)
estimates yj for j = 1, 2, . . . , n based on model (2.4); (2) Estimate the nonparametric MLE
   ^ (b) based on the bootstrap sample y (b) and calculate the marginal and total test score
of F
               ^ (b) . Repeat these steps for B = 800 times and calculate the standard error
gains based on F
based on these bootstrap estimates of policy outcomes.
    If the teacher quality is assumed to be unobserved and thus the cutoff for the bottom or
top q percentile of quality needs to be found from the empirical quantiles of the estimates
                                                            ^ (b) conduct step (3): take an
of the teacher value added, for each bootstrap distribution F
                                                                      ^ (b) and generate data
independent sample of teacher quality of size 40000 from distribution F
based on model (2.4) with total class size equal to sixty. Construct the NPEB estimator of
the value added and apply the policy of releasing or retaining based on empirical quantiles
of the NPEB estimates of the teacher VA.
    If we assume the quality distribution is normal, the following steps are taken to construct
the bootstrap standard errors: (1) Draw a new independent sample of teacher quality of
                                                 2          2
the same size as the original sample from N (0, ^  ) where ^  is the maximum likelihood
estimator of variance of the normal distribution based on the respective dataset from North
                                                                                            (b)
Carolina and the LAUSD. Then generate a bootstrap sample of the fixed effect estimates yj
                                        2(b)
based on model (2.4); (2) Estimate ^           using the maximum likelihood estimator applied
                               (b)
to the bootstrapped sample yj and calculate the marginal and total test score gains based


                                                 59
          2(b)
on N (0, ^ ). If teacher quality is assumed to be unobserved, conduct step (3): take an
                                                                2(b)
independent sample of teacher quality of size 40000 from N (0, ^ ) and generate data based
on model (2.4) with total class size equals to sixty. Construct the EB estimator of the value
added and apply the policy of releasing or retaining teachers based on empirical quantiles of
the EB estimates of teacher VA.




                                             60
D      Maximum Likelihood Estimation of Variance Pa-

       rameters

D.1      Without Classroom Shocks

Our model without classroom shocks is specified as:


                                            yijt = j +       ijt   ,


with i indexing students, j indexing teachers and t indexing the years for which teachers
appear in the sample. We assume that            ijt   iid N (0,  2 ) and   ijt   is independent of j . We
have i = 1, 2, . . . , njt , j = 1, . . . , J and t = 1, . . . , Tj (i.e., an unbalanced panel of teachers).
                                                        1
Denote the teacher-year fixed effect yjt =             njt   i   yijt . The estimator commonly used in
the literature is the following method of moment estimator proposed by Kane and Staiger
                                                     2
(2008) under the additional assumption that j  N (0,   ). In particular, they propose the
following method of moment estimator for the variance parameters:


                                           2
                                          ^  = cov(yjt , yjt-1 )

                                           ^ 2 = V (yijt ) - 
                                                             ^2




This is also the estimator used by Chetty et al. (2014a) for teacher VA without drift. The
main shortcoming of the method of moment estimator for the variance parameters is that
it requires all individual teachers to have shown up in the sample for at least 2 years;
otherwise, they will be dropped from the covariance calculation. For North Carolina data,
teachers who only appear for one year consist of around 30% of the whole sample. This
                                                       2
induces a sample selection issue for the estimation of   . We therefore propose the following
maximum likelihood estimators for the variance parameters.
    Maintaining a general distribution F for , denote the vector yjt = (y1jt , y2jt , . . . , ynjt jt ) ,
the likelihood of observing residual test outcome yjt for teacher j in period t can be written



                                                      61
as

                      1        njt
     L(yjt ) =                       exp -            (yijt - yjt + yjt - j )2 /2 2 dF (j )
                     2 2                         i
                   1     njt                                                                       (yjt - j )2
            =                        exp -            (yijt - yjt )2 /2 2 exp -                                dF (j )
                  2 2                            i
                                                                                                     2 2 /njt
             1           1           njt -1                                                         1             (yjt - j )2
            =                                 exp(-        (yijt - yjt )2 /2 2                              exp -             dF (j )
              njt       2 2                            i
                                                                                                   2 2 /njt         2 2 /njt
                           2                     2
             L1 (yjt |yjt ,  )        L2 (yjt | , j )dF (j )


                                                              2
When F is assumed to be the normal distribution with variance   , then the second com-
ponent involving the integral becomes

                                                                            2
                                                     1                     yjt
        L2 (yjt | 2 , j )dF (j ) =                            exp -                    ~ 2 (yjt | 2 , 
                                                                                    := L              2
                                                                                                        )
                                                   2   2            2(  2 +  2 /n )
                                                2 ( +  /njt )                    jt



Therefore, under the normality assumption, the maximum likelihood estimator for ( 2 , 2
                                                                                        )
can be obtained by maximizing                                                      ~ 2 (yjt | 2 , 
                                                                L1 (yjt |yjt ,  2 )L              2
                                                                                                    ) numerically. Unlike the
                                                       j    t

method of moment estimator, here all individuals, including those only have one period of
data, are accounted for.
      When F is a general distribution not indexing by any parameters, we can obtain an
estimator for  2 through
                                                                j   t           - yjt )2
                                                                             i (yijt
                                                ^2 =
                                                                                         .
                                                                    j    t (njt - 1)



D.2        With Classroom Shocks

Our model with classroom shocks is specified as:


                                                       yijt = j + jt +                   ijt   ,


with i indexing students, j indexing teachers and t indexing years for which teachers appear
                                        2
in the sample. We assume that jt  N (0,   ) and                                        ijt    N (0,  2 ) and mutual independence
between j , jt and          ijt .     We again have i = 1, 2, . . . , njt , j = 1, . . . , J and t = 1, . . . , Tj (i.e.,



                                                                        62
an unbalanced panel of teachers).
   The corresponding method of moment estimator proposed by Kane and Staiger (2008) is


                                          ^ (yijt - yjt )
                                     ^2 = V
                                     
                                      2
                                     ^  = cov(yjt , yjt-1 )

                                     ^2  ^ (yijt ) - 
                                        =V           ^2 - ^2




Again, the method of moment estimator excludes individual teachers who appear for only
one period in the sample. As an alternative, we propose the following maximum likelihood
estimator for the variance parameters.

Parametric EB: Under PEB, the VA of teacher j is assumed to be distributed according
            2
to j  N (0,   ). Denoting the vector yjt = (y1jt , . . . , ynjt jt ) , the likelihood of yjt can be
written as

                                                 1
         L(yjt ) =    (2 )-njt /2 |det|-1/2 exp(- (yjt - j ) -1 (yjt - j ))dF (j ) ,
                                                 2

where  =  2 I + 2
                  1njt 1njt with I being an identity matrix of dimension njt × njt and 1n is
a vector of 1's with length n. Some algebra shows that


                                 det = njt 2
                                             +  2 ( 2 )njt -1 ,


and

                                                  2
                                     1           
                             -1 =      I -                1n 1 .
                                     2     ( 2 + njt 2
                                                       ) 2 jt njt




                                                63
                                        1
     Now, defining yjt :=              njt       i   yijt gives us


                        (yjt - j ) -1 (yjt - j )
                                                                            2
                             1                                                                                             2
                         =                 (yijt - j )2 -                   2
                                                                                                      (yijt - j )
                             2         i
                                                                      ( 2 +   njt ) 2            i
                                                                                                2
                             1                                                                                                  2
                         =                 (yijt - yjt + yjt - j )2 -                     2
                                                                                                                yjt - j
                             2                                                                      2 2
                                       i                                                 (njt
                                                                                                +    ) njt
                             1                                                 1
                         =                 (yijt - yjt )2 +              2
                                                                                       (yjt - j )2 ,
                             2         i                                       +   2
                                                                                   
                                                                       njt


and then the likelihood of observing the vector yjt for teacher j at period t (conditional on
j ) becomes

                                                                        - yjt )2
                                                                   i (yijt            (yjt - j )2
L(yjt |j ) = (2 )-njt /2 |det|-1/2 exp -                                 2
                                                                                 exp - 2
                                                                       2              2( njt + 2)

                        njt -1
                                                                   i (yijt- yjt )2        2            1/2          1                         (yjt - j )2
              = (2 )-     2      |det|-1/2 exp -                                              + 2
                                                                                                                                     exp -        2
                                                                         2 2              njt                      2
                                                                                                                2 ( njt + 2)                 2( njt + 2)


                        njt -1
                                  -1            njt -1
                                                                             i (yijt- yjt )2           1                            (yjt - j )2
              = (2 )-     2      njt 2 ( 2 )-     2      exp -                                                     exp -              2
                                                                                                                                                    .
                                                                                   2 2                 2
                                                                                                2 ( njt + 2)                        2( njt + 2)




                              2                              2
     Note that yjt |j  N (j ,   +                            njt
                                                                 )   and so the second piece of the likelihood is of itself
a proper likelihood for yjt conditional on j and the first piece of the likelihood does not
               2               2                    2   2                                                         2
depend on j or   . If j  N (0,   ), then yjt  N (0,   +   +                                                       njt
                                                                                                                      ).       Then the marginal
likelihood of all the data (unconditional on j ) becomes

                                                                                                                                               2
                        njt -1
                                  -1            njt -1
                                                                         i (yijt - yjt )2                  1                                  yjt
L=              (2 )-     2      njt 2 ( 2 )-     2      exp -                                                             exp -                        2
                                                                                2 2                                2                   2(2 + 2 +
                                                                                                                                                        njt )
                                                                                                2 (2 + 2 +
      j   t                                                                                                        njt )                     


                                           2   2
     The maximum likelihood estimator for (  ,   ,  2 ) can be solved by maximizing L nu-
merically.

NPEB: Under NPEB, we have that j  F . We start by estimating  2 from the first piece
of the likelihood over (j, t), that is

                                                                         njt - 1                      i (yijt - yjt )2
                           ^ 2 = argmax
                                                                     -           log  2 -                              ,
                                           2             j     t
                                                                            2                                2 2


                                                                                64
which leads to
                                                           j      t              - yjt )2
                                                                              i (yijt
                                               ^2 =
                                                                                          .
                                                                  j       t (njt - 1)

                    2                                     2                                                  2
    Now to estimate   , consider the model yjt |j  N (j ,   +                                                njt
                                                                                                                 ).   The likelihood for the
vector (yj 1 , . . . , yjTj ) can be written as

                                                    Tj
                                                                      1                                  1       (yjt - j )2
             L(yj 1 , . . . , yjTj |j ) =                                                   exp -                             2
                                                                                                                                    .
                                                   t=1     2 (2
                                                                +               2
                                                                                    )                    2   t    2
                                                                                                                    +
                                                                                njt                                           njt



             2            2
Letting jt =   +          njt
                              ,   define
                                                                                yjt
                                                                              t jt
                                                           yj =                  1      .
                                                                              t jt

                                               1
We then have yj |j  N (j ,                   1       ) and the likelihood of L(yj 1 , . . . , yjTj |j ) factorizes into
                                           t jt



    Tj
                  1                    1           (yjt - yj )2                     1            1                1                         1
                              exp -                                       2           1                      exp - (yj - j )2                    ,
          2 (2+       2                2               jt                                            1            2                         jt
                      njt )                                                                  2
    t=1                                    t                                        t jt               1                                t
                                                                                                     t jt




                                                                                  2
    where the second piece forms the density of yj conditional on j . We estimate   by
maximizing the following likelihood

                        Tj
                                      1                                   1             (yjt - yj )2                      1
                                                         exp -                                 ^2
                                                                                               
                                                                                                              2               1     .
              j        t=1        2 (2
                                           +   ^2
                                               
                                                   )                      2     t        2
                                                                                           +                          t   2+ ^2
                                               njt                                             njt                          njt



                                      2
There is no closed-form solution for ^  , but numerical estimates can be easily obtained.




                                                                      65
E        Specification Test for Normality

    We propose the following specification test for normality. Suppose the data are generated
from the model
                                      y j = j + j ,    j = 1, 2, . . . , n ,

                     2             2
with     j     N (0, j ) and where j is known. We are interested in testing the hypothesis that
         2
j  N (0,   ). One natural diagnostic test is the likelihood ratio test, with the test statistic
given by
                                                               2
                                    Ln = 2 sup n (F ) - sup n (  ) ,
                                              F F                2
                                                                 

where F is the set of probability measures on the domain of ,                        n (F )   is the likelihood
                                                              2
of the sample {v            ¯n } with   F , and
               ¯1 , . . . , v                              n ( )       is the likelihood of the sample with
        2
  N (0,   ). To obtain a critical value for the test based on Ln , we use the parametric
bootstrap, drawing on McLachlan (1987) and Gu et al. (2018). This involves the following
steps:

                2                                   2
    1. Compute ^  as the maximizer of            n ( ).


                                                (b)        (b)        2
    2. For b = 1, . . . , B , generate data 1 , . . . , n from N (0, ^  ).

                                               (b)         2     (b)
    3. For b = 1, . . . , B , generate data yj from N (j , j ) for j = 1, 2, . . . , n.

    4. For b = 1, . . . , B , denote by Ln,b the test statistic Ln computed from the sample
             (b)     (b)
         y1 , . . . , yn . Compute the  -quantile qn, of Ln,1 , . . . , Ln,B .

                                                                                     ^) -
The likelihood ratio test statistic computed from the data takes the form Ln = 2( n (F
    
 n (^
      2
        )          ^ is the NPMLE defined in the main text and 
             where F                                           2
                                                                 is the maximum likelihood
                                             2
estimator under the assumption that j  N (0,   ). Details are given in Appendix D in the
paper. We reject the null hypothesis of a normal distribution for the teacher quality  at
level  when Ln exceeds the bootstrap-based critical value qn,1- .
    We report the size and power performance of the proposed parametric bootstrap test in
Table E.1 below with the following data generating process: Fix the sample size at n = 1000,


                                                      66
and for a grid values of h  {0, 0.4, 0.6, 0.8, 1}, sample individual j 's from the following
three-component normal distribution:


                      0.025N (-h, h ) + 0.95N (0, h ) + 0.025N (h, h )


with h = 0.1 - 0.05h2 . The design of h is such that the variance of  is always 0.1; this is
roughly the variance of the teacher effects in the LAUSD data. When h = 0, the latent effect
j follows a normal distribution, and the bootstrap test should reject with probability equal
to nominal size. As the magnitude of h increases, we deviate from the normal distribution,
and the parametric bootstrap test should be able to detect this deviation from the null
hypothesis of normality and reject with a higher probability. Conditional on j , the data
                                                                    2
yj is generated from a normal distribution with mean j and variance j , where the j 's
are generated from a random sample of size 1000 from the inverse gamma distribution with
parameters (6, 0.05), in order to capture teacher heterogeneity. These parameters are chosen
                            2
so that the distribution of j mimics those for the individual variances in the LAUSD data.
   Results in Table E.1 are based on bootstrap sample size B = 500 and 500 simulation
repetitions. Table E.1 shows that the parametric bootstrap test controls size well for h = 0,
and that the power increases quickly as h increases.

                       Table E.1: Size and Power Performance of the
                         Parametric Bootstrap Test for Normality
                                          = 10%              = 5%             = 1%
                        h=0               0.116             0.058             0.01
                        h = 0.4           0.148             0.082            0.028
                        h = 0.6            0.57             0.442            0.234
                        h = 0.8              1                1               0.99
                        h=1                  1                1                 1
                     Notes:  measures the nominal sizes fixed at 10, 5, 1% and we re-
                     port the proportion of rejection out of 500 simulation repetitions for
                     different values of h and  .



   We apply the parametric bootstrap likelihood ratio test of normality for both NC and
LAUSD data. For the NC data, the likelihood ratio test statistic Ln is 1326.3 with the


                                                      67
corresponding bootstrap critical values at (1 -  )  {90%, 95%, 99%} being respectively
{58.45, 61.67, 70.4}, which implies that the normality hypothesis is significantly rejected at
1% level. For LAUSD data, the likelihood ratio test statistics Ln is 667.5 and the correspond-
ing bootstrap critical values at   {90%, 95%, 99%} being respectively {73.8, 78.1, 90.1} and
hence we also reject the null hypothesis of normality at 1% level.
   Other tests for normality is also possible. For instance, if  indeed follows a normal
                   2
distribution N (0,   ), then the logrithm of its characteristic function takes the form


                                    log  (t) = -t2 /2
                                                      ,


                                                                                  2
which implies that the first-order derivative with respect to t is of the form -t/  which is
a linear function of t. Since the distribution of  is identified (as established in Theorem
1), we can construct a consistent estimator for  (t) and inspect linearity of the derivative
of its logarithm transformation. Another specification test is also proposed in Bonhomme
and Weidner (2019). We leave to future research a power comparison involving different
specification tests.




                                              68
F                                 Appendix Figures and Tables
         Figure F.1: Gains from Replacing Bottom q Percentile of Teachers when VA is Estimated
                                           North Carolina
                                      (a) Marginal Test Score Gain                                                                        (b) Total Test Score Gains




                                                                                                                          0.05
                                                        Parametric EB                                                                Parametric EB
                                                        Parametric EB (Quality Unobserved)                                           Parametric EB (Quality Unobserved)
                                                        Nonparametric EB                                                             Nonparametric EB
                            0.7




                                                        Nonparametric EB (Quality Unobserved)                                        Nonparametric EB (Quality Unobserved)




                                                                                                                          0.04
Marginal Test Score Gains

                            0.6




                                                                                                 Total Test Score Gains

                                                                                                                          0.03
                            0.5




                                                                                                                          0.02
                            0.4




                                                                                                                          0.01
                            0.3




                                                                                                                          0.00




                                  0           5                     10                    15                                     0                    5                      10    15

                                             Percent of Teachers Released                                                                           Percent of Teachers Released
                                                                                         LAUSD
                                      (c) Marginal Test Score Gain                                                                        (d) Total Test Score Gains
                                                        Parametric EB                                                                Parametric EB
                                                        Parametric EB (Quality Unobserved)                                           Parametric EB (Quality Unobserved)
                            1.0




                                                        Nonparametric EB                                                             Nonparametric EB
                                                        Nonparametric EB (Quality Unobserved)                                        Nonparametric EB (Quality Unobserved)
                                                                                                                          0.06
                            0.9
Marginal Test Score Gains




                                                                                                 Total Test Score Gains
                            0.8




                                                                                                                          0.04
                            0.7
                            0.6




                                                                                                                          0.02
                            0.5
                            0.4




                                                                                                                          0.00




                                  0           5                     10                    15                                     0                    5                      10    15

                                             Percent of Teachers Released                                                                           Percent of Teachers Released
Notes: Figures F.1(a) and F.1(b) show the marginal and total test score gains of a policy that releases the bottom q % of
teachers in North Carolina, while Figures F.1(c) and F.1(d) do the same for the LAUSD. The solid lines indicate the policy
gains expected under the PEB and NPEB methodology when true teacher VA is observed and are identical to those presented
in Figure 5. The dashed lines represent the policy gains when VA is estimated. These gains are calculated via Monte Carlo
simulation with 40,000 observations under the assumption that we estimate       ^^ and F
                                                                                         ^^ using three years of data for each
teacher and assuming teachers all have class sizes of twenty. Details of the simulation are provided in Section 7.1. Results in
the figures are the same as those reported in Tables 4(a) and 4(b).



                                                                                                69
  Figure F.2: Test Scores Gains from Retaining Top 1 - q Percentile Teachers when VA is
                                       Estimated
                                                                             (a) North Carolina
                                                                                        Parametric EB
                                                                                        Parametric EB (Quality Unobserved)
                                               95                                       Nonparametric EB
                                                                                        Nonparametric EB (Quality Unobserved)
             Percentage of Teachers Retained

                                               90
                                               85
                                               080
                                               75




                                                     0.01      0.02            0.03           0.04            0.05       0.06

                                                                              Total Test Score Gains

                                                                                (b) LAUSD
                                                                                        Parametric EB
                                                                                        Parametric EB (Quality Unobserved)
                                                                                        Nonparametric EB
                                                                                        Nonparametric EB (Quality Unobserved)
                                               95
             Percentage of Teachers Retained

                                               90
                                               085
                                               80




                                                     0.01   0.02      0.03       0.04       0.05       0.06      0.07    0.08

                                                                              Total Test Score Gains
Notes: Figures F.2(a) and F.2(b) display the total test score gains from retaining teachers above the 1 - q th percentile of the
value-added distribution in North Carolina and the LAUSD, respectively. The solid lines indicate the policy gains expected
under the PEB and NPEB methodology when true teacher VA is observed. The dashed lines represent the policy gains when
VA is estimated. These gains are calculated via Monte Carlo simulation with 40,000 observations under the assumption that
we estimate  ^ ^ and F
                      ^^ using three years of data for each teacher and assuming teachers all have class sizes of twenty. Details
of the simulation are provided in Section 7.2. Results in the figures are identical to those reported in Tables 5(a) and 5(b).

                                                                                      70
      Figure F.3: Classroom Shocks Model: Test Scores Gains from Replacing Bottom q
                        Percentile of Teachers when VA is Estimated
                                                                        (a) North Carolina




                                             0.04
                                                        Parametric EB
                                                        Parametric EB (Quality Unobserved)
                                                        Nonparametric EB
                                                        Nonparametric EB (Quality Unobserved)

                                             0.03
                    Total Test Score Gains

                                             0.02
                                             0.01
                                             0.00




                                                    0                    5                      10    15

                                                                       Percent of Teachers Released

                                                                             (b) LAUSD
                                             0.06




                                                        Parametric EB
                                                        Parametric EB (Quality Unobserved)
                                                        Nonparametric EB
                                             0.05




                                                        Nonparametric EB (Quality Unobserved)
                                             0.04
                    Total Test Score Gains

                                             0.03
                                             0.02
                                             0.01
                                             0.00




                                                    0                    5                      10    15

                                                      Percent of Teachers Released
Notes: Figures F.3(a) and F.3(b) show the total test score gains under the classroom shocks model presented in equation (7.8)
of a policy that releases the bottom q % of teachers in North Carolina and LAUSD, respectively. The solid lines indicate the
policy gains expected under the PEB and NPEB methodology when true teacher value-added is observed. The dashed lines
represent the policy gains when value-added is estimated. These gains are calculated via Monte Carlo simulation with 40,000
observations under the assumption that we estimate     ^ ^ and F
                                                                ^^ using three years of data for each teacher and assuming teachers
all have class sizes of twenty. Details of the simulation are provided in Section 7.1. Results in the figures are identical to those
reported in Tables F.2(a) and F.2(b).                            71
                           Table F.1(a): Simulation (True Distribution is Normal)
                            Homogeneous Class Sizes                   Heterogeneous Class Sizes
                             (Total Class Size of 20)                  (Total Class Size 20-40)
                         Infeasible NPEB PEB                     FE                 Infeasible NPEB PEB                       FE
 Mean Squared
                  10.81   10.87 10.81 12.50             11.03   11.07 11.03                                                  12.84
     Error
 Teacher ranked in bottom (top) 5% when true VA above (below) 5% (Type I error)
 (Type I error=Type II error by definition)
 Bottom 5%                 152.5        152.5       152.5      152.5                  153.5        153.6       153.5         153.9
 Top 5%                    152.6        152.6       152.6      152.6                  153.6        153.5       153.6         154.1

                      Table F.1(b): Simulation (True Distribution is Mixed Normal)
                           Homogeneous Class Sizes                   Heterogeneous Class Sizes
                            (Total Class Size of 20)                  (Total Class Size 20-40)
                         Infeasible NPEB PEB                     FE                 Infeasible NPEB PEB                       FE
 Mean Squared
                   9.08    9.14   10.82 12.51           7.14    7.18    8.29                                                  9.36
     Error
 Teacher ranked in bottom (top) 5% when true VA above (below) 5% (Type I error)
 (Type I error=Type II error by definition)
 Bottom 5%                 126.9        126.9       126.9      126.9                  111.8        111.9       111.7         113.7
 Top 5%                    126.0        126.0       126.0      126.0                  111.4        111.5       112.0         114.0

                        Table F.1(c): Simulation (True Distribution is Chi-Squared)
                            Homogeneous Class Sizes                   Heterogeneous Class Sizes
                             (Total Class Size of 20)                  (Total Class Size 20-40)
                         Infeasible NPEB PEB                     FE                 Infeasible NPEB PEB                       FE
 Mean Squared
                   7.44    7.45   10.82 12.51           5.79    5.79    8.30                                                  9.37
     Error
 Teacher ranked in bottom (top) 5% when true VA above (below) 5% (Type I error)
 (Type I error=Type II error by definition)
 Bottom 5%                 431.3        431.3       431.3      431.3                  425.5        425.6       427.5         428.6
 Top 5%                    66.4          66.4       66.4        66.4                  56.8         56.9         57.4         57.0
Notes: This table adds type I and type II error rates to Tables 1(a), 1(b) and 1(c); given this mean squared error is the same as in
those tables. The table uses simulation to compare the performance of four estimators when the distribution of teacher value-added
follows a normal, mixed normal and a chi-squared distribution, respectively. Specifically, Table 1(a) has teacher value-added being
normally distributed with mean zero and variance 0.05 (i.e., F  N (0, 0.08)), while Table 1(b) has true teacher quality following
F  0.98N (0, 0.03) + 0.01N (-1, 0.03) + 0.01N (1, 0.03) (as in the example given by equation (2.8)). The normal and mixed normal
distributions have the same mean and variance to create a suitable comparison. Teacher value-added follows F  2             1 in Table
1(c). The infeasible estimator is the optimal estimator given that the true distribution is known to the econometrician (which is
infeasible as it is unknown in practice), the nonparametric emiprical Bayes (NPEB) estimator which nonparametrically estimates
the underlying distribution, the parametric empirical Bayes (PEB) estimator which assumes that the underlying distribution is
normal, and the fixed effect (FE) estimator which applies no empirical Bayes shrinkage. The simulation averages results from 500
repetitions with 10,000 individual teachers setting  2 = 0.025. Results are reported for homogeneous class sizes where every teacher
has a class size of twenty students and heterogeneous class sizes where class sizes of teachers are a random draw from the set {20, 40}
with equal probability. Note that teacher rankings are identical for the three methods under homogeneous class sizes. Only Type
I error (teacher ranked in bottom (top) 5% when true VA above (below) 5%) is reported as it is identical to that of Type II error
(teacher ranked above (below) 5% when true VA below (above) 5%).

                                                               72
Table F.2(a): Classroom Shocks Model: Test Scores Gains of Policy Releasing Bottom q %
                         Teachers (True Value-Added Observed)
                     North Carolina Data                        LAUSD Data
 % Teachers      Test Gain        Test Gain             Test Gain         Test Gain
  Released        under F       under Normal             under F       under Normal
     (q )          (NPEB)           (PEB)                 (NPEB)            (PEB)
                     (1)              (2)                   (3)               (4)
      1            0.0049           0.0046                0.0058            0.0066
                  (0.0001)         (0.0000)              (0.0002)          (0.0001)
        3                  0.0121                   0.0117                            0.0149                   0.0168
                          (0.0002)                 (0.0001)                          (0.0004)                 (0.0001)
        5                 0.0179                   0.0177                            0.0225                   0.0256
                          (0.0003)                 (0.0001)                          (0.0005)                 (0.0002)
        7                  0.0230                   0.0230                            0.0297                   0.0332
                          (0.0004)                 (0.0001)                          (0.0006)                 (0.0003)
        9                  0.0275                   0.0279                            0.0365                   0.0402
                          (0.0004)                 (0.0001)                          (0.0006)                 (0.0003)
Table F.2(b): Classroom Shocks Model: Test Scores Gains of Policy Releasing Bottom q %
                         Teachers (True Value-Added Unobserved)
                     North Carolina Data                        LAUSD Data
 % Teachers      Test Gain         Test Gain            Test Gain         Test Gain
  Released        under F        under Normal            under F       under Normal
     (q )          (NPEB)            (PEB)                (NPEB)            (PEB)
                     (1)               (2)                  (3)               (4)
      1            0.0044            0.0042               0.0048            0.0063
                  (0.0003)          (0.0001)             (0.0001)          (0.0001)
        3                  0.0105                   0.0104                            0.0129                   0.0154
                          (0.0004)                 (0.0002)                          (0.0003)                 (0.0002)
        5                 0.0155                   0.0155                            0.0200                   0.0231
                          (0.0005)                 (0.0003)                          (0.0004)                 (0.0003)
        7                  0.0199                   0.0201                            0.0263                   0.0300
                          (0.0006)                 (0.0004)                          (0.0004)                 (0.0004)
        9                  0.0239                   0.0242                            0.0323                   0.0361
                          (0.0007)                 (0.0004)                          (0.0005)                 (0.0004)
Notes: Table F.2(a) and displays the estimated gains using our model that includes classroom shocks (see equation (7.8))
in mathematics scores in terms of student level standard deviations of a policy that releases the bottom q % of teachers and
replaces them with mean quality teachers when true teacher quality is observed by the policymaker. `Test score gain under F '
reports the test score gain of the policy when teacher quality is distributed according the distribution F ­ nonparametrically
estimated using equation (3.1) ­ and applying the NPEB estimator to calculate value-added. `Test score gain under normal'
reports the test score gain when teacher quality is normally distributed and the PEB estimator is used to calculate teacher
value-added. Table F.2(b) repeats the exercise when the true teacher quality is unobserved to the policymaker and so teacher
releases are based on estimated (rather than true) value-added. These gains are calculated via Monte Carlo simulation
with 40,000 observations under the assumption that we estimate        ^ ^ and F
                                                                               ^^ using three years of data for each teacher and
assuming teachers all have class sizes of twenty. The bolded line indicates the widely-analyzed release bottom five percent
teachers policy. Reported policy gains for both tables are identical to those shown in Figure F.3. Standard errors are calculated
using a bootstrap (as described in Appendix C).
                                                              73
Table F.3(a): Classroom Shocks Model ­ Test Scores Gains of Policy Retaining `Top 1 - q
                         Percentile' Teachers (True VA Observed)
                     North Carolina Data                          LAUSD Data
 % Teachers      Test Gain          Test Gain             Test Gain       Test Gain
  Retained        under F        under Normal              under F      under Normal
   (1 - q )        (NPEB)             (PEB)                 (NPEB)          (PEB)
                     (1)                (2)                   (3)             (4)
      1            0.0056             0.0046                0.0079          0.0066
                  (0.0001)           (0.0000)              (0.0002)        (0.0001)
         3                 0.0134                    0.0117                             0.0193                    0.0168
                          (0.0002)                  (0.0001)                           (0.0004)                  (0.0001)
         5                 0.0199                    0.0177                             0.0286                    0.0256
                          (0.0003)                  (0.0001)                           (0.0005)                  (0.0002)
         7                 0.0254                    0.0230                             0.0368                    0.0332
                          (0.0003)                  (0.0001)                           (0.0006)                  (0.0003)
         9                 0.0303                    0.0279                             0.0442                    0.0402
                          (0.0004)                  (0.0001)                           (0.0007)                  (0.0003)
Table F.3(b): Classroom Shocks Model ­ Test Scores Gains of Policy Retaining `Top 1 - q
                        Percentile' Teachers (True VA Unobserved)
                     North Carolina Data                          LAUSD Data
 % Teachers      Test Gain          Test Gain             Test Gain       Test Gain
  Retained        under F         under Normal             under F      under Normal
   (1 - q )        (NPEB)             (PEB)                 (NPEB)          (PEB)
                     (1)                (2)                   (3)             (4)
      1            0.0053             0.0036                0.0074          0.0054
                  (0.0003)           (0.0001)              (0.0003)        (0.0001)
         3                 0.0123                    0.0097                             0.0179                    0.0145
                          (0.0004)                  (0.0002)                           (0.0004)                  (0.0002)
         5                 0.0178                    0.0149                             0.0265                    0.0221
                          (0.0005)                  (0.0003)                           (0.0005)                  (0.0003)
         7                 0.0227                    0.0195                             0.0340                    0.0291
                          (0.0006)                  (0.0004)                           (0.0006)                  (0.0004)
         9                 0.0268                    0.0237                             0.0407                    0.0353
                          (0.0007)                  (0.0004)                           (0.0007)                  (0.0004)
Notes: Table F.3(a) displays the estimated test score gains (in student-level SDs) of a policy that retains the top q % of teachers,
rather than having them leave teaching and be replace by a mean quality teacher, when true teacher quality is observed by
the policymaker. It uses a variant of our model that includes classroom shocks (see equation (7.8)) in mathematics scores.
The columns headed `Test Score Gain under F ' report the policy gain when teacher quality is distributed according the
distribution F , estimated nonparametrically using equation (3.1) and applying the NPEB estimator to calculate value-added.
The columns headed `Test Score Gain under Normal' report the policy gain when teacher quality is normally distributed and
the PEB estimator is used to calculate teacher value-added. Table F.3(b) repeats the exercise when the true teacher quality
is unobserved to the policymaker and so teacher retention is based on estimated (rather than true) value-added. These gains
are calculated via Monte Carlo simulation with 40,000 observations under the assumption that we estimate          ^^ and F
                                                                                                                           ^^ using
three years of data for each teacher and assuming class sizes of twenty. Standard errors are calculated using a bootstrap (as
described in Appendix C).
                                                                74
