                              NBER WORKING PAPER SERIES




              SIZE, TRADE, TECHNOLOGY AND THE DIVISION OF LABOR

                                          Nuno Limão
                                           Yang Xu

                                      Working Paper 28969
                              http://www.nber.org/papers/w28969


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     June 2021




I thank Kerem Cosar, Allan Drazen, Eunhee Lee, Felipe Saffie, David Riker and participants at
the 2018 Lisbon Theory Conference and 2021 WAITS and AEA Conferences. The views
expressed herein are those of the authors and do not necessarily reflect the views of the National
Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2021 by Nuno Limão and Yang Xu. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including ©
notice, is given to the source.
Size, Trade, Technology and the Division of Labor
Nuno Limão and Yang Xu
NBER Working Paper No. 28969
June 2021
JEL No. F1,F4,L11,O24,O25,O51

                                           ABSTRACT

We model the implications of the classical ideas that larger markets allow for a finer division of
labor and this division feeds back into larger market size. Market size affects specialization due to
firm-level increasing returns to scale arising from fixed costs of adopting intermediate-intensive
technologies. The impacts are magnified in general equilibrium by an endogenous multiplier--
due to input-output linkages in a roundabout structure--and a selection effect due to
heterogeneous fundamental productivity and entry costs.

Market size expansions imply (i) larger real income gains than under fixed specialization; (ii) an
increase in the aggregate variable cost share for intermediates and a decrease for labor; (iii)
increased concentration;(iv) increased average productivity for survivors; and (v) an increase in
the intermediate trade share. We derive similar results for intermediate productivity
improvements. The effects in (ii)-(v) are absent in a similar model with exogenous specialization.

In a calibration to U.S. manufacturing in 1987-2007 we isolate trade and intermediate
productivity shocks, quantify their effects. Trade cost reductions increased effective market size
by 7 log points (lp) and generated (i) a real income gain 1.4 times higher than under exogenous
specialization; (ii) increases in the intermediate share in production and trade of 2 lp and a
reduction in the labor share of value added of similar magnitude. Two counterfactuals highlight
the importance of industrial and trade policy. First, a tax that induces firms to specialize increases
real income; so the initial equilibrium is inefficient. Second, an increase in trade costs of 16 lp--
similar to the recent trade war--reduces market size and real income substantially: almost half
way to trade autarky.


Nuno Limão
Department of Economics
University of Maryland
3105 Tydings Hall
College Park, MD 20742
and NBER
limao@econ.umd.edu

Yang Xu
SOE & WISE, Xiamen University
xuya0005@e.ntu.edu.sg


An appendix is available at http://www.nber.org/data-appendix/w28969
1    Introduction
         "(...) the division of labour depends upon the extent of the market, but the extent of the
      market also depends upon the division of labour. In this circumstance lies the possibility of
      economic progress." Young (1928, p.539)

    In "Increasing Returns and Economic Progress" Allyn Young builds on the core idea in Smith (1776)
that labor specialization is limited by the size of the market by emphasizing a feedback effect. Young
argues that labor specialization reduces production costs mainly due to a roundabout production structure
where the sources of increasing returns go beyond the individual firm and require "industrial operations
be seen as an interrelated whole" (p. 539). We formalize this idea using a model with input-output
linkages where heterogeneous firms can increase their specialization by adopting intermediate intensive
technologies thus reducing their own product's cost and those of other firms using it as an input. We
show that increases in market size and intermediate productivity lead to higher aggregate income and firm
concentration, and changes in factor shares in production consistent with recent evidence. International
trade is a key determinant of market size and thus of these outcomes, as our reduced form evidence and
subsequent quantification for U.S. manufacturing in 1987-2007 illustrates.
    We model specialization as a form of directed technical change (Acemoglu, 2002): firms can invest
in technologies with different intermediate-labor intensity. Firms initially draw a technology with con-
stant returns to labor and heterogeneous productivity to manufacture a variety sold under monopolistic
competition. After learning their productivity firms can invest in more specialized technologies that use
intermediate inputs sourced from others, which implies a lower share of labor in their production. This is
isomorphic to a setting where firms concentrate labor on tasks where it is most productive and outsource
the rest. A firm specializes if the productivity advantage of using intermediates, henceforth the specia-
lization premium, is sufficiently high relative to the adoption cost. We assume fixed costs of adoption
so the model predicts that larger firms are more specialized and thus have lower labor share, which is
consistent with the data (Autor et al., 2020).
    The feedback mechanism that amplifies market size and technology shocks is the endogenous speci-
alization premium and multiplier. This premium is common across firms and decreasing in the effective
relative price of intermediates. An increase in market size lowers the relative price of intermediates and
this effect is amplified due to the input-output linkages. The resulting aggregate input-output multiplier is
central in other models but constant. We show this multiplier is determined by the aggregate cost share of
intermediates and thus exogenous and independent of market size in models where firms use a common
intermediate technology. In contrast, our model features an endogenous multiplier that is increasing in
market size because of new adoption and sales re-allocation towards more specialized firms due to entry
selection.
    We derive a condition for a unique equilibrium and analytical comparative statics in a single sector
economy with free entry. In equilibrium the initially most productive firms become more specialized;
and increases in market size (via changes in labor endowment or trade liberalization) imply (i) larger

                                                     1
real income gains relative to fixed specialization; (ii) an increase in the aggregate variable cost share
for intermediates and a decrease for labor; (iii) increased firm selection; (iv) increased concentration in
the profit and sales distributions; (v) increased average productivity (TFPQ) over surviving firms and
(vi) an increase in the intermediate trade share. A similar model with exogenous specialization does
not generate any of the effects in (ii)-(vi), and is thus unable to explain recent increases in intermediate
shares described above nor increases in concentration (Bajgar et al., 2019). Firms do not internalize the
aggregate benefits of specialization so the market equilibrium is generally inefficient, which raises the
value of policies that promote specialization--either directly (e.g. adoption incentives) or by expanding
market size (e.g. trade policy).
     We provide a calibration to U.S. manufacturing in 1987-2007 to unpack different shocks and mecha-
nisms as well as perform counterfactual policy changes. In section 2 we provide motivating evidence that
guides the calibration. We document an increase in the intermediate share in costs of almost 5 percen-
tage points, which is highly correlated with trade openness and the relative labor/intermediate price. The
intermediate/labor intensity within industries is increasing in market size--consistent with the modelled
economies of scale in specialization.
     The calibration yields a reduction in the marginal trade cost and an improvement in intermediate
productivity; these changes allow us to match key targeted moments exactly, e.g. the increases in inter-
mediate intensity and relative labor/intermediate price, and generate outcomes consistent with untargeted
moments of the data, e.g. changes in real value added/worker and sales distribution. The improved
intermediate productivity is equivalent to a lower marginal cost of using intermediates (both domestic
and imported), hence it has a direct effect on the specialization premium and accounts for a substantial
fraction of its increase.1
     We then isolate and quantify the impact of trade costs. The marginal cost reduction in 1987-2007
implies an effective market size increase of over 7 log points (lp) and thus has significant effects including:
(i) real income gains larger than under no specialization (4.6 times) or fixed specialization (1.4 times);
(ii) an increase in the intermediate share in production and trade of 2 lp and a reduction in the labor share
of value added of similar magnitude; and (iii) substantial increases in the fraction of firms specializing.
     We conduct two counterfactual experiments to highlight the importance of industrial and trade policy.
First, an industrial policy (e.g. a tax/subsidy) that induces all firms to specialize would increase real
income; so the initial equilibrium is inefficient. That income increase is significant if the policy were
implemented in 1987 but negligible in 2007 since by the latter period trade and technical change had
induced sufficient specialization. Second, the impact in the 2007 economy of an increase in trade costs
of 16 lp--similar to the recent trade war--reduces market size and real income substantially: almost half
way to trade autarky.
     We discuss related literature in section 1.1 and then present motivation evidence on changes in ag-
gregate production specialization and imported intermediates in section 2. In sections 3, 4 and 5 we
   1
    We can interpret this as a reduction in the marginal cost of outsourcing, which is central in models such as Grossman and
Rossi-Hansberg (2008), and a source of production fragmentation towards domestic and foreign sources (Fort, 2016).


                                                             2
respectively develop the framework, characterize the equilibrium and derive size and technology compa-
rative statics in a closed economy. In section 6 we extend the results to an open economy and use it as
the basis for the quantification in section 7.


1.1     Related Literature
Our focus on intermediate adoption as a source of firm specialization, and the role of trade in spurring
it, is motivated by several facts. First, intermediates are a large fraction of international trade (Johnson
and Noguera, 2012, 2016); central to understanding its growth (Yi, 2003, 2010; Hummels et al., 2001);
and imported intermediates increase firm productivity (Amiti and Konings, 2007; Halpern et al., 2015)
and lower costs (De Loecker et al., 2016). Second, imported intermediates are negatively correlated with
the labor share in value added in U.S. manufacturing (Elsby et al., 2013).2 This labor share decline is
present in other countries and its potential causes include a substitution towards capital (Karabarbounis
and Neiman, 2014) or increasing profits due to higher concentration (Barkai, 2020; Autor et al., 2020).
The labor share declines may also be caused by our specialization channel, which entails increases in the
intermediate cost share in manufacturing that we document in section 2.
     A growing literature on endogenous production networks provides interesting predictions about firm-
level sourcing. Some of this research assumes a constant expenditure share of intermediates (e.g. Antras
et al., 2017; Fieler et al., 2018; Oberfield, 2018) and thus can't explain increases in specialization. Other
work is numerically consistent with specialization but not amenable to analytical solutions (e.g. Acemo-
glu and Azar, 2020; Tintelnot et al., 2018). By using a roundabout structure and adoption decisions we
provide a tractable framework that does not draw specific insights for networks but instead focuses on
general equilibrium effects of market size and the implications for other outcomes such as documented
increases in concentration in sales and declines in labor share (Autor et al., 2020).
     There are three pervasive features of modern industries: productivity heterogeneity, input-output
linkages and technical change. We show the interaction of all three is important in understanding the
effect of globalization on the gains from trade and productivity; moreover we bridge models that study
them separately. If the market is small enough then firms use only labor and the equilibrium in our mo-
del is similar to Melitz (2003). If the market is large enough then all firms adopt the most specialized
technology in equilibrium, which has the constant intermediate share typically assumed in models with
linkages (Ethier, 1982; Krugman and Venables, 1995; Eaton and Kortum, 2002). Income gains from
international trade are larger in models with intermediate linkages (Costinot and Rodr´   iguez-Clare, 2014;
Caliendo and Parro, 2015); these gains are further magnified with multiple stages of production (Melitz
and Redding, 2014) or endogenous choice of imported inputs (Ramanarayanan, 2020); and there is evi-
dence that imported intermediates lower consumer prices (Blaum et al., 2018). The gains from trade due
to intermediates are also larger in our model and magnified by endogenous adoption of both domestic
    2
      They are also negatively correlated with relative demand for production labor in U.S. manufacturing in 1972-1990 (Feen-
stra and Hanson, 1999).



                                                             3
and imported intermediates so trade affects outsourcing not just offshoring.3 Trade liberalization indu-
ces some firms to improve productivity (Lileeva and Trefler, 2010; Bustos, 2011; Bloom et al., 2015).
In our model, liberalization increases labor productivity for the most productive firms but can lower it
for the least productive (due to downgrading from competition)--so it is consistent with the increased
productivity dispersion found in Berlingieri et al. (2017). Aggregate productivity (both labor and TFPQ)
increases with liberalization due to selection and re-allocation effects.
    Finally, our work relates to the literature on the implications of market size and scale economies for
development emphasized by Young (1928). Rosenstein-Rodan (1943) argues that adopting increasing
returns technologies may require coordinated investments across sectors in underdeveloped economies.
Murphy et al. (1989) formalize this idea and show pecuniary externalities can create multiple Pareto
ranked equilibria. Our model also features pecuniary externalities--via the love-of-variety production
(Ethier, 1982)--and endogenous specialization can generate multiple equilibria with real income incre-
asing in specialization. This potential under-adoption inefficiency implies a role for coordinating inves-
tments across firms within a sector. The calibration has a unique equilibrium; however it still reflects
under-adoption that is significant in 1987 but negligible by 2007--by the latter period trade and technical
change had induced sufficient specialization.


2       Motivation Evidence
We present evidence of increases in production specialization in manufacturing and its relationship with
market size and trade. We focus on U.S. data for 1987-2007 here and provide related data for 67 countries
in 1997-2007 in Appendix A.


2.1     Aggregate Facts
We use the NBER-CES industry aggregation of U.S. firm based measures of sales, input costs and prices
covering 459 SIC-4 industries from 1987 to 2007.
   A key summary statistic is the average intermediate share, ¯ m , which is defined as the sales weighted
average of intermediate cost shares across firms (indexed by ) in industry m:
                                                 m m
                                              m
                                                  Y    Im
                                            ¯ 
                                                     =    .
                                                Ym     Cm
        m
Sales, Y  , are proportional to variable costs in our model so we construct  ¯ m as the industry intermediate
expenditure, I m , relative to all variable costs, C m (the sum of non-energy materials (I m ), energy, labor
                                                                           m
                                                                         C97
and investment. We use the industry cost share in 1997 (        ¯ = m C97    ¯ m ) to aggregate so variation
                                                                             
over time reflects within industry changes, not composition. In Figure 1 we see an increase of almost 5
    3
    Kee and Tang (2016) find globalization lowered Chinese materials prices and increased domestic sourcing by Chinese
firms.



                                                          4
                            .76




                                                                                                              .4
                            .74




                                                                                                              .3
                                                                                                              .2
                            .72




                                                                                                              .1
                            .7




                                                                                                              0
                                                                                          correlation= 0.90




                                                                                                              -.1
                            .68




                                  1985       1990                 1995      2000                2005

                                         Intermediate Share t (LHS)       Specialization Premium t-2 (RHS)




                  Figure 1: Intermediate cost share and specialization premium: 1987­2007

percentage points in   ¯ --half since China's WTO entry.4
    In the model, firm adoption of intermediate-intensive technologies increases ¯ ; one of its determinants
                                                   m    m
is the relative price of labor to intermediates, wt /Pt . In Figure 1 we examine if this correlation is
                                                                                      m /P m
                                                                                     wt
present by constructing a change in relative costs relative to 1987, Stm  ln wm            t
                                                                                            m , and its cost
                                                                                      87 /P87
                               C m
weighted average, S  ¯t  m 97 Stm . Unanticipated shocks to the premium that induce firms to invest at
                               C97
t - n can take time to be reflected in increased intermediate intensity thus in Figure 1 we plot S  ¯t-2 , and
find it has a correlation of 0.9 with ¯t. 5
    The annual growth trend of Stm between 1987 and 2007 is 2.5 lp; our subsequent calibration accounts
for it in terms of increased productivity and trade cost reductions. Here we show this premium and the in-
termediate share are strongly correlated with imports. We measure import penetration in industry m by its
                                                        Importsm
import value relative to domestic absorption: m   t  domm
                                                               t
                                                                  , where domm      m         m         m
                                                                             t Salest -Exportst +Importst
                                                             t
                                                                     m
and its aggregate counterpart at fixed weights is   ¯ t  m dom97 m . In the left panel of Figure 2 we see
                                                                 dom97 t
                                    ¯
a 10 percentage point increase in t between 1990 and 2007 (we start in 1990 due to industry data avai-
lability). The increase occurred in a period with several liberalization episodes. NAFTA was signed in
1993 and the WTO was established in 1995, and both lead to substantial reductions in both U.S. applied
barriers including tariffs and uncertainty (e.g. after China's WTO accession). The correlation of import
penetration,  ¯ t , is over 0.9 with respect to both the premium, S¯t , and intermediate share,  m
                                                                                                ¯t , which
suggests imports affected the incentive to adopt.
   4
      This measure assumes that existing capital captures fixed costs, which explains why the intermediate and labor shares are
higher than when total costs are used. The calibration considers alternative measures of investment and capital use in variable
costs.
    5                                ¯t-1 and 0.77 for S
      It is slightly lower if we use S                 ¯t . Figure 1 raises the question of whether the relationship is mechanical
or simply reflects a simple CES production--where relative input shares are proportional to their relative prices. If so then the
correlation should be similarly large for other periods. However, we find it is much lower, only 0.1, between year 1967 and
                                                      m
1987. Below we also find differential impacts of St     on relative industry shares consistent with our model.


                                                                      5
                    Intermediate Share and Import Consumption Share: 1990-2007                                                       Intermediate Share and Export Production Share: 1990-2007




            .75




                                                                                                                             .75
                                                                                                                   .3




                                                                                                                                                                                                               .2
            .74




                                                                                                                             .74




                                                                                                                                                                                                               .18
                                                                                                                   .25
            .73




                                                                                                                             .73
            .72




                                                                                                                             .72




                                                                                                                                                                                                               .16
                                                                                                                   .2
            .71




                                                                                                                             .71




                                                                                                                                                                                                               .14
            .7




                                                                                                                             .7
                                                                                              correlation= 0.92                                                                            correlation= 0.91




                                                                                                                   .15
                  1989     1992         1995                          1998       2001         2004          2007                   1989    1992         1995           1998   2001        2004          2007

                            Intermediate Share (LHS)                            Import Consumption Share (RHS)                              Intermediate Share (LHS)          Export Production Share (RHS)




          Figure 2: Import consumption share, export production share, and intermediate cost share

    These trade agreements also reduced foreign barriers, which along with other trade cost reductions
increased the effective market size for U.S. producers. This is reflected in the increased export share of
production shown in the right panel of Figure 2.6 There were increases in the wake of NAFTA and the
WTO, followed by a stagnant share, and new increases after China's WTO accession. The correlation
between this export intensity and the intermediate share is over 0.9.
                                                     .2        .1
                                           Labor share changes
                                         -.1         0
                                                     -.2




                                                                     correlation=-0.93

                                                                    -.2                 -.1                 0             .1                                 .2                .3
                                                                                                      Intermediate share changes




                                  Figure 3: Intermediate and labor cost shares: 1987­2007 change

    The model has one type of labor so we aggregate production and non-production pay to compute
                                                                     m
total labor expenditures and denote their share in industry cost by ¯w . The corresponding aggregate
  6                                                                   Exportsm                                                                                                        Salesm Exportsm
      This measure is calculated as                                   Salesm
                                                                             t
                                                                                  for each industry and the corresponding aggregate is m Sales97
                                                                                                                                              97                                             Salesm
                                                                                                                                                                                                    t
                                                                                                                                                                                                      .
                                                                             t                                                                                                                      t




                                                                                                                         6
                       m
share, ¯ w = m C C
                    ¯wm
                        , fell from 0.23 in 1987 to 0.16 in 2007. The correlation between the labor and
intermediate share, ¯ w and    ¯ , is -0.97, which is consistent with the model's focus on the substitution
between these inputs.7


2.2     Industry Panel Evidence
Disaggregated industry data provides additional evidence for the model's mechanisms and implications.
First, changes in shares are also strongly negatively correlated within industries: the correlation is -0.93.8
The relation is shown in Figure 3 where the change in the intermediate share, ¯   m , the x-axis, is positive
for most industries and most where     ¯ m increased also experienced declines in    m 9
                                                                                    ¯w . Importantly, there
                                                    m
is considerable variation in the magnitude of ¯     across industries that we can exploit. There is also
considerable variation within the specialization premium; the standard deviation of Stm over time is 0.13
for the typical industry (it ranges from 0.03 to .73).
                                                                                                          ¯m
                                                                                                          
     In Table 1 we examine the impact of two potential determinants of these relative cost shares, ln      t
                                                                                                          ¯m
                                                                                                               ,
                                                                                                           w,t
conditional on industry and time effects. We focus on the specialization premium and market size (me-
asured by the value of shipments). We lag each of these to allow for time to build and also instrument
each to minimize endogeneity concerns.10 The first column shows that specialization increases with the
premium, S  0, but only significantly so in concentrated industries, S > 0. Moreover, specialization
is increasing in market size, Y > 0.
                   m
                 ¯t
            ln     m
                       = (S + S × Concm ) Stm                 m       m
                                            -1 + (Y + Y × Conc ) ln Yt-1 + at,m + utm
                 ¯ w,t

    This evidence rejects simple production structures and provides some support for the mechanisms in
the model. First, the findings reject a standard production model (Cobb-Douglas or CES) where relative
intermediate/labor shares are common across firms in an industry because in those cases the relative indu-
stry share would be independent of market size. The specialization bias from size suggests a composition
effect: large firms are more specialized and their sales share is increasing in market size. This channel is
present in our model and magnified by endogenous specialization. Table 1 is also consistent with endoge-
nous specialization in specific industries. If all firms in an industry are too small to specialize then there
is a negligible effect of the specialization premium provided production is Cobb-Douglas (as we will
   7
      In the model the labor share of variable costs is 1 - ¯ m so the two have a correlation of -1, but that need not be true in the
data for two reasons. First, there are other inputs included in costs, such as energy and investment, so that      ¯ and  ¯ w do not
add up to unity, therefore    ¯ can in principle have any correlation with  ¯ w . Second, in the model labor is also used for fixed
costs and to the extent that in practice they do use labor (in addition to investment expenditures) then they are reflected in   ¯w .
This attenuates the correlation of   ¯ and  ¯ w because the model predicts that adoption of intermediate technology increases the
usage of fixed cost labor.
    8
      We find a similar relationship with labor cost in value-added but with a lower correlation of -0.38.
    9                     m
      Industries where   ¯w  increased were fewer and smaller on average as illustrated by the smaller circles (proportional to the
             m
weights, C97 /C97 ).
   10
      Specifically, let M2 denote a SIC-2 sector so for each m  M2 we construct an instrument for xm based on the average of
x in that period over all m  M2 \m. The first stage has high explanatory power and the instruments are not weak according
to alternative F-statistics.


                                                                 7
        Table 1: Annual intermediate/labor cost shares (log): 1987-2007, SIC-4 manufacturing
                                              IV                       IV                      IV
 ln(Wage/Interm. Price) (lag)                0.004                    0.083                   0.057
                                            [0.059]                  [0.050]                 [0.050]
 ln(Wage/Interm. Price) (lag)                0.296                                            0.247
 × Top 20 share '87                         [0.052]                                          [0.058]
 ln(Size) (lag)                                                       0.128                   0.124
                                                                     [0.028]                 [0.029]
 ln(Size) (lag)                                                                               0.254
 × Top 20 share '87                                                                          [0.071]
 Observations                                9,389                    9,389                   9,389

         Notes: Robust standard errors in brakets, clustered at SIC-2 by year: the lowest level of variation of instruments.
         All specifications include year and SIC 4-digit fixed effects.
         IV: Two-stage least square instrumenting specialization (or size) in SIC 4 by the value in the other industries of
         specialization (or size) sharing the same SIC-2 (and the respective interactions with the Top 20 variable when
         included).
         Source: NBER CES Manufacturing database sic 1987 version and US Census of Manufacturing.
         Intermediate cost share = Non-energyTotal
                                              material expenditure
                                                   costs           , Total costs = Intermediate + Energy + Investment +
                              Wage
         Labor pay. ln Intermediates price calculated by SIC 4 and normalized by its respective 1987 value. Size: va-
         lue of shipments. Top 20 Share 1987: Sales share of largest 20 firms in each SIC 4, demeaned.



assume). In industries with high concentration it is more likely that at least some firms are sufficiently
large to respond to increases in the premium (and/or market size) and specialize.11 The specialization
premium elasticity is 0.07 higher for an industry with concentration 1 sd higher than the mean. In the
calibration we find a similar relationship even though it is not targeted.


3        Environment and Firm Decisions
We model consumer preferences and firm technology in the absence of adoption similarly to Melitz
(2003) and show how endogenous specialization affects aggregate welfare, the labor share in production,
profit and sales concentrations. We also show that endogenous specialization magnifies the importance
of economies of scale and generates a feedback effect between productivity and size.
    We develop the key results in a simple version of the model with a single industry in a closed economy.
We then show that size increases are mostly isomorphic to trade cost reductions.
    11
      Here we use the share of sales by top 20 but the result is robust to alternative concentration measures such as the HHI50.
It also holds for industries with relatively higher average sales per firm.




                                                                 8
3.1     Preferences and Technology
There are L consumers with identical preferences over the set of differentiated varieties    with
constant elasticity of substitution  > 1. This yields the standard demand functions

                                                q ( ) = EP -1 p( )- ,                                                   (1)

where p( ) is the variety price, E is consumer expenditure on all varieties, derived below, and P the
associated price index given by

                                                                        1/(1- )
                                          P =            p( )1- d                  .                                    (2)
                                                     


    After paying a sunk cost each firm obtains a blueprint for a single variety  identified by a core pro-
ductivity  drawn from a distribution G(). Conditional on , the firm chooses between production
technologies by paying fi units of labor to access a CRS process with non-labor input cost shares
i  {0, ..., n }; where 1 - n > 0 is the minimum labor variable cost share constraint. We capture the
gains from specialized inputs by modelling the non-labor inputs as a CES bundle of intermediates pro-
duced by other firms, similar to Ethier (1982). We assume a common CES aggregator in production and
consumption so they have the same price index, P . The unit cost functions for alternative technologies
are:                                               
                                       w1-i P i
                              ci () =                 , i = 0, . . . , n  1;                           (3)
                                                
where w is the wage rate and, when intermediates are adopted, we allow for a fixed productivity change
parameter, , so P/ is the effective unit price of intermediates.12 , 13
    The degree of firm specialization is defined by the share i it chooses, which depends in part on the
following specialization premium.

Definition 1. (Specialization Premium)
    The premium, sI , from a technology with more specialized inputs I  i+I - i > 0 is

                                                                           I
                                                    ci ()           w
                                             sI            =                   .                                        (4)
                                                   ci+I ()         P/
                                                                                                        w
    The specialization premium is increasing in the relative effective cost of labor to intermediates, P/ ,
and independent of firm core productivity. Moreover, a firm only adopts a more specialized technology
if sI > 1, or equivalently if wages are sufficiently high, w > P/. This condition is independent of the
degree of specialization.
                                                      1-i   i                                 i
  12                                                  w    P                                 
      More precisely, the cost function is ci () =  (1           and we assume i =
                                                       -i )1-i i i
                                                                                                     . Under this specifica-
                                                                                        (1-i )1-i i i
                                                    i
tion i is first increasing than decreasing in i .
   13
      Alternatively, the inverse of  can be interpreted as the impediments to specialization in an iceberg fashion, such as
communication costs between firms emphasized by Becker and Murphy (1992).


                                                             9
   Our framework is isomorphic to one where the firm pays fi and uses a fraction of labor to produce
inputs in house using a linear technology and the remaining fraction, 1 - , to assemble it. In appendix
B, we map this reduced form cost structure to one with a two-stage production process, where firms can
pay fi to replace some of their first stage input production with outsourced inputs. Doing so reallocates
workers towards the more productive inputs while lowering the overall labor share.


3.2    Entry and Technology Decisions
The operating profit for firm  using technology i is defined by i () = [pi () - ci ()] qi (). This
firm faces the isoelastic demand in (1) from consumers and in a model without intermediates the profit
maximizing price under monopolistic competition is given by the constant markup over marginal cost,
            
p
~i () = -     c (). This is also the optimal price charged to firms in our setting because the input
             1 i
aggregator is CES with elasticity  . Therefore the aggregate demand faced by firm  is

                                         ~i () = XP -1 [pi ()]- ,
                                         q                                                                  (5)

where X is the total expenditure of consumers and firms, which is taken as given by the firm and derived
below. Replacing p~ and q
                        ~ in i we obtain the maximized operating profit for any i

                                        ~i () = ~ XP -1 [ci ()]1-                                           (6)

               1        -
where   ~  -     1  -1
                         . We define the equilibrium profit as a function of firm productivity after it
chooses its technology, where the firm pays fi > 0 to produce using technology i, or zero if it decides
not to enter.
                                  ~ ()  argi max {0, 
                                                       ~i () - wfi }                                (7)

Assumption 1. (Technology)

   1. There is a continuum of firms with heterogeneous core productivity drawn from G () with support
      [l , );

   2. Specialization technology has constant share increments: i+1  i+1 - i =  thus sI = (s1 )I
      and increasing costs: fi+1 /fi = f^ > 1.14



    The equilibrium is characterized by entry and adoption thresholds, so for partial specialization we re-
quire heterogeneous firms; the continuum and unbounded productivity assumptions are made to simplify
the analysis. The share and cost assumptions are used to show that specialization increases with core
productivity.
  14
    A more general fixed cost formulation is increasing cost differences: fi+1  fi+1 - fi > 0 and fi+1  fi . Our
                                            ^ > 1.
formulation is a special case as fi+1 /fi = f


                                                      10
   The solution to the production and entry decisions using technology i is characterized by the zero
profit cutoff productivity derived from setting ~i (¯i,e ) = wfi , which is

                                                    wfi                   -1
                                   (¯i,e )-1 =          · P 1- · ws-
                                                                   1
                                                                     i
                                                                               .                           (8)
                                                    ~X

All else equal entry is easier, and so the cutoff lower, if fixed costs can be spread over a larger market
(the first term), competitor prices are higher (the second) and marginal costs are lower (the third). If
entrants use only labor then i = 0 and the third term reflects only the wage, but if there is adoption then
the marginal cost relative to the labor technology is reduced by the specialization factor s- i
                                                                                            1 , which is the
only difference in the cutoff relative to a standard model without adoption.
    A firm that is indifferent between technologies i + 1 and i, has productivity      ¯i+1 defined by the
equality between the operating profit increase of two adjacent technologies and the differential adoption
cost, ~ i+1 ( ¯i+1 ) = wfi+1 , which yields:

                                          (¯i+1 )-1 = Si-1
                                                        +1 · (¯i,e )-1 .                                   (9)

The expression is proportional to the entry cutoff expression if the entrant adopted i by a factor represen-
ting the relative gain in profits relative to fixed costs from switching technologies:
                                                             -1
                                           ~i+1 /~i - 1   s1    -1
                                  Si+1                  =          = S1
                                            fi+1 /fi          f^

   Under the second part of technology assumption 1, Si+1 is the same for all i and thus the relative
cutoff across any two technologies is simply (¯i+1 /¯i )-1 = 1 + f
                                                                 ^ /s-1 . Therefore we can write the
                                                                     1
adoption cutoff for any technology i + I as
                                             -1                            I -1
                                   ¯i+I              -1        ^ /s-1
                                                  = S1  ·    1+f   1               .                      (10)
                                   ¯i,e

Solving for the cutoff i + I we obtain the function I                     ^, I for I  1.
                                                              ¯i,e , s1 , f
   In Proposition 1 we characterize how firm specialization depends on the premium, fixed costs and
productivity. We say that specialization is increasing in productivity if     ¯i+1 > ¯i for all i and adopt the
convention that an indifferent firm adopts the higher technology.




                                                        11
Proposition 1. (Heterogeneous specialization)
   Under technology assumption 1, specialization:

    1. occurs iff there is a premium: s1 > 1;

    2. is increasing in productivity, , iff s  -1     ^ and heterogeneous across firms for (s1 )-1 
                                                  < 1+f
                                             1
               ^);
       (1, 1 + f

                                          ^.
    3. is common at n =  iff (s1 )-1  1 + f


    The proof is in Appendix C.1. Part 1 shows it is necessary for s1 > 1, so specialization lowers mar-
ginal costs enough to offset the fixed costs, otherwise no firms specialize; the condition is also sufficient
for specialization because of the existence of sufficiently high productivity firms. Part 2 shows the con-
dition for sorting, ¯i+1 >  ¯i , namely that the operating profit growth is no higher than that of fixed costs,
              -1
S1 < 1  s1 - 1 < f       ^ . Moreover, when S1 < 1 we obtain       ¯i+1 >  ¯i,e so the marginal producer does
not choose the most specialized technology and thus there is heterogeneity in adoption. Part 3 shows that
if S1 > 1 then all firms gain from any incremental specialization and thus adopt the maximum possible.
    The proposition illustrates how the specialization premium spans three types of equilibria: no specia-
lization (S1  0), full specialization as in models where all firms must use a fixed share of intermediates
(S1  1) and partial specialization in the intermediate range, the novel range that we focus on.


4     General Equilibrium
We aggregate the consumer and firm decisions and solve for the general equilibrium in a closed economy.
We use the wage as the numeraire, w = 1, and define the equilibrium as follows.

Definition 2. (General Equilibrium)

    1. Consumers choose the quantity of each variety and labor supply to maximize their utility subject
       to their budget constraint taking prices as given.

    2. Firms with productivity  choose a production technology i to maximize profits taking aggregate
       prices (P ), expenditure (X ), costs (fi ), and the specialization premium (si ) as given.

    3. Goods and labor markets clear.

    4. There is free entry by ex-ante identical potential producers to obtain a blueprint at cost fE .




                                                      12
4.1     Endogenous Specialization Mechanisms and Number of Firms
Endogenous specialization features two novel mechanisms absent from standard models (e.g. Melitz,
2003, or variants without endogenous input adoption). First, an endogenous multiplier effect: an incre-
ase in market size generates adoption, which further reduces input prices via intermediates and amplifies
the initial shock. Second, a selection effect: the marginal entrant depends on market size and thus
economic scale impacts the equilibrium distribution of firm performance (size, labor demand, etc). We
derive the multiplier as a function of productivity thresholds and the specialization premium, and then
use free entry to pin down the entry threshold. After that we characterize the equilibria as a function
of the specialization premium and price index. Subsequently we show that both effects amplify the im-
pacts of economic scale on real income and generate novel predictions about the interaction of size and
technology.

4.1.1   Aggregate Expenditure and Multiplier

We aggregate consumer and firm decisions to derive total expenditure, X , and the associated endogenous
multiplier due to intermediate linkages.
   Consumers do not value leisure and so supply their unit of labor at any wage. Thus aggregate labor
income is L, as is consumer expenditure, E , because there are no aggregate profits under free entry.
   A fraction i of a firm's variable costs is spent on intermediates, which under CES and monopolistic
competition is simply a fraction - 
                                    1
                                      i of its sales. Thus total expenditure is

                                               n                                       -1
                                  -1                                     -1
                            X =L+                   i Yi = L · 1 -          ¯               ,             (11)
                                              i=0
                                                                         
                                                                       Multiplier: a
                                                                                   ¯


where we used E = L and Yi represents aggregate sales of all firms using the ith technology. The
second equality uses the market clearing condition X = Y  n           i=0 Yi . The multiplier, henceforth a
                                                                                                          ¯,
is unity without specialization and larger otherwise. In standard models with intermediate linkages the
technology is fixed and so is the multiplier. A contribution of this paper is deriving how this endogenous
multiplier depends on the aggregate intermediate cost share and its determinants
                                                      n
                                                                Yi
                                               ¯
                                                            i      .                                      (12)
                                                      i=0
                                                                Y

    Below we provide an analytical solution for this share. For now we note that the CES structure
implies that Yi /Y is a function of the relative price index for each group of firms and thus depends on
the cost functions and cutoff vector, {  ¯ie }. Moreover, the technology assumptions allow us to write
those relative prices as a function of the specialization premium si 1 , and all cutoffs as a function of the
entry one,  ¯i,e . Thus we denote the solution as a function of two endogenous variables, s1 and     ¯i,e , and


                                                      13
underlying parameters.
                                                                                          -1
                                                                             -e ^i
                                                                n         si
                                                                           1    ^
                          ~
                                  ^, I, 
                           ¯ s1 , f     ¯i,e , G =                   i                       -1 .               (13)
                                                                         n         -e ^i
                                                             i=0
                                                                         i=0    si
                                                                                 1    ^


   In the next proposition we derive this expression. Here we note two points. First, conditional on the
endogenous variables, it is independent of two parameters: size, L, and technology . Second, it depends
                            -1
on  ¯i,e via the terms 
                       ^i
                        ^
                               , which measure the average productivity of firms   [   ¯i , ¯i+1 ] relative to
all active firms and would represent their sales share in the absence of specialization. Thus the average
intensity is a premium weighted average of the underlying sales share in a model without adoption. Thus
we can also decompose the impacts of s by holding the cutoffs constant ("the intensive margin elasticity")
and the effect via changes in them (extensive).

Proposition 2. (Heterogeneous specialization, multiplier and intermediate share)
   The average intermediate cost share in (13) and the associated multiplier a   ¯ are increasing in the
specialization premium if and only if there is heterogeneous specialization. Moreover, the share elasticity
can be decomposed as

                                 n                          n                        n
              d ln ~   -1                              1                                    ln Yi d ln ¯j
                     =                 i (i - ¯ )2 +                i (i - ¯)                               .   (14)
              d ln s   ¯         i=e
                                                       ¯   i= e                   j =e
                                                                                            ln ¯j d ln s
                                 intensive 0                               extensive 0


    The proof is in appendix C.2, here we provide intuition. From (14) we see that under homogeneous
specialization i =   ¯ for all i so there is no impact of s. The intensive impact is positive because more
specialized firms are more exposed to changes in the premium; the intensive elasticity is also higher
when there is more heterogeneity in specialization, as measured by the sales share weighted coefficient
of variation of i . The extensive margin elasticity is also positive because technology upgrading of more
specialized firms outweighs potential downgrading by those less specialized. We note that the latter result
accounts for changes in selection, and thus requires us to derive the impact of s on   ¯i,e , which we do in
the next section.
    The change in s1 can be driven by technology, e.g. , or a parameter affecting P , e.g. size, L. If
increases in  (or L) increase s1 (as we later derive) then the proposition above also shows that they
increase the intermediate share and thus the multiplier because they only depend on these parameters via
the premium.

4.1.2   Selection under Free Entry

The ex-ante identical potential firms obtain their core productivity by paying fE units of labor. Thus
under free entry the ex-ante period profit from this blueprint--the expectation of ~ () in (7) over the


                                                           14
productivity distribution G must equal that cost:
                                                   
                                                       ~ ()dG() = fE .                                      (15)
                                                  ¯e


    In the following proposition we show (15) can be rewritten similarly to models without adoption by
using the cutoffs in (8) and (9), and defining Fi as fi for i > e and fe otherwise:

                                   n                         -1
                                                       
                                        Fi                        - 1 dG() = fE .                           (16)
                                  i=e        ¯i        ¯i

    In an equilibrium with homogeneous specialization we have n = e and obtain a standard expression
where the marginal production cutoff,      ¯e , is determined by fE /fe and G. This includes models without
intermediates (e.g. Melitz, 2003) --captured endogenously in our model when s < 1-- and those with
an exogenous common share of intermediates for all firms-- when s is sufficiently large in our model
(Proposition 1). In those two special cases of our model with homogeneous specialization, selection is
independent of market size and this independence extends to any outcomes determined only by fixed costs
and the survival probability, 1 - G (  ¯e ), e.g. average operating profits, firm size and their distributions.
    Under heterogeneous specialization, we still use (15) to solve for       ¯e . Replacing the cutoffs    ¯I =
                ^, I from (10) in (16) we see that the equilibrium 
    ¯i,e , s1 , f                                                     ¯e depends on the determinants of      ¯I ,
fixed costs, and G; thus we denote the resulting function by

                                                  ¯e  e (s1 , f ,I, G) .
                                                                                                            (17)

The following proposition shows how this cutoff depends on the specialization premium, s1 . Moreo-
ver, conditional on s1 , selection depends on fixed costs (f = {f  ^, fE , fe } for adoption, operation, and
entry, respectively), technology upgrades available (I ), the underlying productivity distribution (G), and
 (omitted).

Proposition 3. (Heterogeneous specialization and selection)
   The entry cutoff ¯e in (17) is increasing in the specialization premium if and only if there is heteroge-
neous specialization. Moreover,
                                          d ln ¯e    ¯ - e
                                                     
                                                  =           0.                                        (18)
                                          d ln s1       
    We prove this in appendix C.3. Holding         ¯e constant, an increase in s1 lowers all adoption cutoffs
and increases ex-ante expected profit above the entry cost. This induces additional entry and eventually
a lower probability of survival due to higher competition that re-establishes the equality in (16). The
elasticity of selection in (18) is zero if all firms adopt the same technology such that ¯ = e .
    The change in s1 can be driven by technology, e.g. , or a parameter affecting P , e.g. size, L. If
increases in  (or L) increase s1 (as we later derive) then this proposition also shows that they increase
selection because    ¯e only depends on these parameters via the premium. This also further clarifies that

                                                            15
the selection effect due to size in our model is only present under endogenous specialization.

4.1.3   Number of Firms

Using free entry and the fact that aggregate operating profits equal a fraction of total expenditure, X/ ,
we can express the mass of entering firms as

                                               X        L·a¯
                                      M=           ¯ =       ¯ ,                                              (19)
                                              fE + F    fE + F

where we recall a¯ is the multiplier and F¯   fi() dG() is the average expenditure of entering firms
                                                 ¯e
on fixed production costs. The second equality uses (11) and shows how the multiplier affects M , which
will be an important channel for the impact of size and trade on welfare.
    Under homogeneous specialization we obtain a standard expression for M : log linear in size L and
independent of the specialization premium. In such a setting,     ¯ is fixed and F   ¯ is determined by the entrant
production cost fe,i required for ¯ and  ¯e , where the latter is independent of size as described before. So,
in models without endogenous specialization M is determined by (L, fE , fe,i ), and this is also the case
in our model if s1 is outside the heterogeneous specialization range (in which case the entrant uses either
i = 0 or n). This implies that without heterogeneous specialization there is no amplification of market
size on the mass of entrant or surviving firms even in the presence of intermediate linkages.
    With heterogeneous specialization, size can affect M via changes in s1 . We denote the mass as a
function of the premium and entry cutoffs by M      ~  M L,         ¯ (s1 ,        ¯ (s1 , 
                                                                            ¯e ) , F       ¯e ) . An increase in s1
increases  ¯ and thus M . Increases in s1 also affect F     ¯ : holding     ¯e fixed, it increases F  ¯ because of
increased adoption but this increase is partially offset by selection since higher s1 reduces the fraction of
entrants that produce.
    The labor market will also clear and we can verify it yields the same condition for the mass of firms.
For completeness we describe the labor income-expenditure equality showing its allocation here

                                          -1              ¯ + fE .
                                    L=       (1 - ¯ )X +M F                                                   (20)
                                          
                                              variable labor


The first component is labor expenditure on variable costs; since intermediates account for ¯ -
                                                                                                1
                                                                                                  X and
the process is constant returns, labor accounts for the remaining. The second represents the total fixed
cost payments in production M F  ¯ and entry costs given by M fE . Using the goods market condition (11)
we obtain (19).




                                                           16
4.2     Equilibrium Specialization and Price
4.2.1   Characterization

The price index, P , determines real income and specialization, via s1 . Thus we write all variables in
terms of these aggregates, show conditions for existence and uniqueness of the equilibrium and derive
comparative statics.
    To obtain the relationship between P and s1 we substitute the goods market clearing condition (11)
into the production entry expression (8), and obtain:
                                              1
                                        fe    -1                    1
                          ~ ( s1 ) =
                          P                           a (s1 )]- -1 · [
                                                   · [¯               ¯e (s1 )]-1 ·(s1 )-e ,             (21)
                                        ~L
                                                       multiplier        selection


which reflects how s1 affects P via the endogenous multiplier, selection and the entrant technology. If
                                                                                                ¯ ) that
we then substitute the definition s1  P      we obtain the equilibrium P as the fixed point(s) (P
satisfy (21).
                                       1

                     ¯ 1-e        fe  - 1                 1
                                                  ¯ - -1 ·             ¯ -1 ·-e
                   (P )     =             · a
                                            ¯ s1 P             ¯e s1 P                             (22)
                                 ~L
                                                      multiplier                selection

In our model under heterogeneous specialization the marginal entrant optimally chooses the minimum
level of specialization (shown in Lemma C.4 in the appendix), so e = 0 . If we take 0 to be zero so
fe = f0 then we can immediately see that the equilibrium price in our model under heterogeneous spe-
                                                                                   1
cialization is lower than in a model without specialization (where P ¯0 = f0 -1       ¯- 1
                                                                                       0 ) and the difference
                                                                              ~L
across models is captured by the multiplier and selection terms in (22).
    To provide some insight, we analyze the equilibrium by using P   ~ (s1 ) and the specialization schedule,
Ps (s1 ), obtained from the definition 1 of the specialization premium:

                                                                    -1
                                              Ps (s1 ) = s1  .                                           (23)

    In Figure 4 we plot the log of this and expression (21) against ln s1 . Their intersection, E , represents
the equilibrium and we depict a case when it is unique in the heterogeneous specialization range,
                                   1
                                   -1
defined by s : s1            ^
                      1, 1 + f          .
    Proposition 4 establishes the existence of a unique equilibrium and characterizes it in terms of spe-
cialization, ¯ , and heterogeneity, depending on the size of the economy and the productivity of inter-
mediates, indexed by Li and i , respectively. The characterization is qualitatively similar using either
x = {L, } so we refer to a change in either L or  as a change in x and use x  [x0 , xn ] to denote either
L  [L0 , Ln ] at a given i or vice versa.

Proposition 4. (Equilibrium)

   1. In an economy x = {L, } with size L and intermediates productivity , there is an equilibrium

                                                         17
                                                    heterogeneous specialization




                                 Figure 4: Existence and uniqueness of equilibrium

      with ¯ (x)  [0 , n ];

   2. The equilibrium is unique and has homogenous specialization given by

       (a) ¯ = 0 if x < x0 ;
       (b) ¯ = n if x > xn .

   3. There exist equilibria with heterogeneous specialization and ¯ j (x)  (0 , n ) for some x 
      [x0 , xn ].
           d ln P~
   4. If   d ln s1
                     > -1
                        
                          for all s1 then ¯ is unique and non-decreasing in x.

    We provide the proof in Appendix C.4. The existence in part 1 follows from continuity of Ps and of
 ~
P in s1 coupled with the facts that Ps  (0, ) and it is steeper than P   ~ (s1 ) at least for s1 / s, i.e. at
the extremes. Thus, P   ~ must cross Ps at least once from below as illustrated in Figure 4, which occurs
whenever it is flatter, what we refer to as the stability condition

                                                 ~ (s1 )
                                            d ln P         d ln Ps   1
                                                         >         =- .                                 (24)
                                              d ln s1      d ln s1   

Figure 4 assumes this holds for all s1 . This need not be the case for the full range but does hold at least
when s1   / s. To see this note from (21) that P  ~ depends on s1 via the entrant technology choice, the
multiplier and selection effect. But for s1   / s the last two effects are absent (since either none or all
                   ~ (s1 )
              d ln P
specialize) so d ln s1 = -e, the number of adoption steps of the marginal producer, which is at most n.


                                                         18
                 Figure 5: Critical intermediates technology for heterogeneous specialization

If the minimum technology is 0 = 0 then ln P       ~ (s1 ) is initially flat, as in Figure 4, and when all adopt, it
is -n = - n > - 1     
                        since we assume n < 1 (labor is necessary).
     Part 2a shows that in an economy that is sufficiently small or unproductive all firms use the minimum
intermediate share, 0 . Part 2b establishes that in large/productive economies all firms adopt the maxi-
mum, n . It also establishes the critical x at which this occurs. In Figure 5 we illustrate the critical values
for . Note that increases in  shift only ln Ps and do so proportionally without affecting the slope. Thus
starting at E we can find a lower    ~0 such that it just supports the minimum heterogeneous specialization
equilibrium defined by P   ~ (1) = Ps (1, ~0 ) in the figure, thus any further reductions in  do not affect      ¯.
In this case  ~0 = 0 . A similar argument applies to part 2b and in Figure 5 we see             ~n = n . The same
logic applies to increases in L; these shift P ~ down without affecting the slope. We can find critical values
of L to support equilibria along Ps with different s1 .
     Part 4 uses the insights above to show that when (24) holds globally the model explains how increases
in x monotonically increase specialization. In Figure 5 we see this as  increases. We can also illustrate
it for market size, e.g. in Figure 6 we start at EL, and an increase in L shifts P        ~ down to EL , , further
increases eventually imply maximum adoption. A simple corollary is that our model subsumes as special
cases the standard Melitz model (x < x0 and 0 = 0) and a version of it with fixed share of intermediates
(x > xn ). Given part 4, which assumes (24) holds globally, it is clear that in those conditions there exist
heterogeneous specialization equilibria, as stated in part 3.15
  15
    Heterogeneous specialization equilibria also exist if (24) does not hold globally; in that case there are multiple equilibria.
We can show at least one is stable and non-decreasing in x.




                                                               19
                                 Figure 6: Specialization under unique equilibrium

5        Qualitative Implications
We provide additional qualitative implications of the model. First, we show there is a potential for
inefficiency of the market equilibrium in small/unproductive economies due to under-adoption. Second,
we derive equilibrium elasticities of various model outcomes with respect to x = {L, }. Furthermore,
we decompose those elasticities into the novel endogenous specialization terms consisting of selection
and multiplier effects.
    While a government may not literally be able to increase the number of workers or technology within
its borders, it may increase the relevant market size via trade with others. In section 6 we show that the
size increases have identical impacts to trade liberalization for nearly all outcomes.


5.1      Market Inefficiency
The market equilibrium may not be efficient if some firms remain unspecialized. The resulting possibility
of efficiency-enhancing policies stands in contrast to Melitz (2003), which Dhingra and Morrow (2019)
show is socially optimal.16 Our model yields the Melitz (2003) market equilibrium if the minimum spe-
cialization possible is 0 = 0 and the economy is sufficiently small/unproductive (part 2a of proposition
4). If that is the unique equilibrium then it is also socially efficient under the Dhingra-Morrow planner,
    16
     The equilibrium coincides with the solution of a planner that maximizes consumer utility (since there are no aggregate
profits) subject to the labor resource constraint and linear technology by choosing the mass of entrants, the minimum producti-
vity firm, and a production quantity function that is continuously differentiable in productivity, {M,    ¯e , q ()} respectively.
They show this occurs in the one sector economy with CES (similar to our framework) because the quantity-variety trade off
exactly offset: firms produce less than the optimal quantity given their monopoly power but this is offset by the extra entry of
monopolistic firms that ignore their impact on the profits of competitors.


                                                               20
which restricts the technology to use only labor. If firms can choose different technologies and use in-
termediates then the planner problem would still involve maximizing utility subject to the resource and
technology constraints. However, now the choice variables should also include the thresholds for adop-
tion and quantity functions for firms in each group. This would allow the planner to replicate any market
equilibrium in our model.
    Instead of a full planner solution we simply ask if a government can improve on some market equi-
librium, in which case we will say the latter is inefficient. This is the case even if the government has
a single instrument at its disposal: a tax on fixed costs of operating with any technology other than the
most specialized. Moreover, we restrict this tax to be prohibitive so that in equilibrium all firms adopt the
most specialized technology. Any improvement from this prohibitive tax rate on the market equilibrium
provides a lower bound relative to an optimal tax rate (or planner solution).




                     Figure 7: Inefficiency of heterogeneous specialization equilibrium

    Utility is increasing in real wages, 1/P , and a prohibitive tax rate generates no revenue. Therefore we
need only determine when P is lower under the specialization tax. This requires deriving the equilibrium
       ¯ spec , which is equal to what we obtain in an economy where only the most specialized technology
price, P
is available. In Appendix C.5 we show that P        ~ spec (s1 ) is loglinear in s1 as depicted in Figure 7 and the
equilibrium is at its intersection with Ps (s1 )--the latter is still defined by (23) as in the full model. Note
that the price schedules P ~ spec (s1 ) and P
                                            ~ (s1 ) coincide if s1  smax and the equilibrium price is the same
if x > xn . The reason is simple: in the full model with a unique equilibrium and large economy all
firms adopt the most specialized technology so removing the option of adopting other technologies is
irrelevant. If x < xn and the heterogeneous specialization equilibrium is at E then the equilibrium with
a single technology is E spec , with lower prices and thus higher utility. In Appendix C.5 we show that
there is always some x close enough to xn such that P          ~ spec lies below P~ since the latter is steeper when

                                                        21
s1 increases to smax --the effect of the premium has an additional impact on P in that case from the firms
adopting.
    Alternatively, there are economies sufficiently small or unproductive where forcing adoption is not
efficient so P¯ spec > P
                       ¯ .17 However, as long as the price schedules intersect left of s1 = 1 (as depicted in
Figure 7) then a market equilibrium such as EL without specialization is inefficient.
    In the quantitative section we show the equilibrium reflects this inefficiency and that it is not simply
due to the input-output linkage but rather the endogenous specialization. Moreover, we find it is stronger
in the initial period when there is less specialization.


5.2     Size and Technology Elasticities
We derive the impacts of economic size and technology on aggregate and firm outcomes. Moreover, we
contrast them with alternative models with a fixed specialization premium. To do so we start with an
equilibrium outcome function o (x, s (x)) and decompose the impact of a parameter x (e.g. L or ) as
follows
                               d ln o(x,s1 (x))
                                    d ln x
                                                  d ln o
                                                = d      |
                                                    ln x s1
                                                                 ln o
                                                            + ddln s1
                                                                      ·d  ln s1
                                                                         d ln x
                                       x
                                                      ¯x          s d ln s1                     (25)
                                       o        =      o    +     o · d ln x
                                                           fixed s1        endogenous s1

The overall elasticity of outcome o, denoted by x    o , reflects the direct elasticity holding s fixed, denoted
by ¯o and the novel endogenous response in the model, s
     x
                                                                 o , from selection and multiplier effects. We
will show how ¯x   o can also be interpreted as the elasticity in certain standard models with homogeneous
specialization where either no firm adopts or all do so but at a common level          ¯ , which will be a conve-
nient form to compare the additional impacts of endogenous specialization. We focus on locally stable
               d ln s
equilibria, so d ln x
                      > 0, as shown in the proof of proposition 5.

5.2.1    Income Gains

The elasticities x
                 W of aggregate real income are simply the inverse of those for the price index (since
W  1/P given no aggregate profits) and we focus on size and technology shocks: x = {L, }.

Proposition 5. (Real income elasticities)
    Real income W = 1/P increases with economic size (L) and intermediates technology () around
stable equilibria and the respective elasticities are

                                         s -1                                               s -1
                      L
                      W   = ¯L
                             W (1 -      W)     >0 ;        W   = ¯W +
                                                                              s
                                                                              W    (1 -     W)     > 0.                  (26)

In an equilibrium with heterogeneous specialization (x  (x0 , xn ) so s1  s) the specialization premium
  17                                                                                                                    ~ spec
    Graphically this would occur if the equilibrium s1 under endogenous specialization were left of the intersection of P
    ~
and P .




                                                             22
elasticity reflects multiplier and selection effects.

                                  s            ¯       d ln ¯
                                  W   (¯
                                       ) =                    +    ¯     ¯.                             (27)
                                             -¯ ( - 1) d ln s1 Selection
                                                     Multiplier


Thus, these income elasticities exceed those of alternative models with homogeneous specialization fixed
at any level e   ¯

              L
              W |s1 s   = [( - 1) (1 -       s
                                             W    ))]-1 > [( - 1) (1 - e ) |e 
                                                 (¯                           ¯]
                                                                                 -1
                                                                                    =   L
                                                                                        W |e ,
                                                                                             ¯s¯        (28)


                   W |s1 s
                   
                             = (1 -    s
                                       W    ))-1 - 1 > [(1 - e ) |e 
                                           (¯                       ¯]
                                                                      -1
                                                                         -1=       W |e ,
                                                                                   
                                                                                        ¯s¯.            (29)

   We derive the expressions in Appendix C.6, here we provide the insight for L, which extends to .




                               Figure 8: Effects of an increase in economic size

    Consider an initial economy with L < L0 such that, according to proposition 4 there is no specializa-
tion. We can see directly that increases in L shift (21) down by ¯L
                                                                  W = 1/ ( - 1) (if 0 = 0) and thus raise
real income. That elasticity is constant until L = L0 , the equilibrium point 0 in Figure 8, where some
firms are indifferent about adopting. Further increases in L continue to shift the price schedule down
by ¯LW and increases welfare from point 0 to 2 if s was fixed (and thus     ¯ = 0) but is magnified in our
                                                                                                  -1
model as s falls to the final equilibrium at point 3. The magnification is captured by (1 -  sW ) , which
captures both a selection and a multiplier effect as shown by the expression for  sW . The elasticity is also
larger when compared to an alternative model where all firms use the same intermediate technology with
a share no higher than  ¯ , the average in our model. In the quantitative section we show how to construct


                                                          23
this alternative fixed premium economy such that it has the same initial price index as our model. The
elasticity of welfare with respect to size in this fixed premium economy is obtained by using (22) directly
holding s fixed and is equal to ¯L W |e =
                                                                                      L
                                         ¯ (s) . We can see that this is smaller than W |s1 s for any e      ¯,
when that economy uses exactly      ¯ then the difference between them is due to the multiplier effect. This
                                                                                                  d ln ¯
holds whenever  s      )  
                    W (¯      ¯ , which requires average specialization to be increasing in s, d   ln s1
                                                                                                          0, as
shown in proposition 2.

5.2.2   Aggregate Cost Shares and Labor Productivity

We first derive the elasticity of alternative aggregate variable cost shares with respect to size and techno-
logy. In addition to the intermediate share   ¯ we also examine the variable labor cost share in production,
lsc = 1 -  ¯ . The model implies that the correlation between these cost shares is -1, which is consistent
with what we find in the U.S. manufacturing between 1987­2007. We also consider an alternative labor
share common in the literature, that in value added, lsv , which for variable cost is defined as
                                                -1
                                                
                                                   (1 -  ¯ )Y          ( - 1)(1 - ¯)
                                     lsv =            -1        =                      .                             (30)
                                               Y -       ¯Y          1 + ( - 1)(1 - ¯)

The numerator is the aggregate labor share in variable costs. The denominator represents the gross value-
added, calculated as total sales minus intermediates expenditure.18
   Using the decomposition in (25) we write the size elasticities for these outcomes as
                                                                                                 L
             L       d ln ¯      L       L           ¯          L        L           ¯
                                                                                                 ¯
                                                                                                 
             ¯
                 =           ·   W   ;   lsc   =-        ·      ¯    ;   lsv   =-       ·                  .         (31)
                     d ln s1                        1- ¯                            1- ¯ 1 + ( - 1)(1 - ¯)

Size affects variable production cost shares only via the endogenous specialization premium elasticity,
 s                          L
 o . To see this note that ¯o = 0 since conditional on  ¯ all shares are independent of L and the same is
true for ¯ conditional on s1 (from ~ in (13) and ¯e in (17)). We summarize these results below and derive
them in Appendix C.7:

Proposition 6. (Aggregate variable cost share elasticities) The elasticities of aggregate variable cost
shares with respect to size are given by (31); non-zero iff there is heterogeneous specialization and
positive for intermediates, L                                  L
                            ¯ > 0, negative for both labor, lsc < 0, and for labor value added in
                            
production, L lsv < 0.


      The intermediate share elasticity L  ¯ depends only on the effect of size on s1 , which is positive in a
                                           
stable equilibrium (proposition 5) and the effect of specialization premium on intermediate cost share,
 d ln ¯
d ln s1
        > 0 iff there is heterogeneous specialization (proposition 2). The labor results follow directly since
they can be written as functions of   ¯ , so their elasticity is inversely proportional to L
                                                                                           ¯ as shown in (31).
                                                                                           
  18
     This is the measure Karabarbounis and Neiman (2014) employ to document the global decline in labor share; whereas
they emphasize substitution towards capital, our explanation relies on adoption of less labor intensive technologies and a
re-allocation of production towards the more productive less labor intensive firms.


                                                                24
    The same points and proposition apply to the technology parameter , the only difference is that we
                d ln s1   d ln s1
replace  LW = d ln L with d ln  in (31).
    The model also generates novel predictions for two measures of worker productivity. Similarly to
the cost shares we focus on workers used in assembly, i.e. the variable component, and denote their
aggregate quantity by Lv . We then define aggregate real productivity per variable worker in terms of
output, ¯Q  Y /P Lv , and real value-added: ¯V A  Y 1 - -   
                                                              1
                                                                ¯ /P Lv .

Proposition 7. (Aggregate variable labor productivity) The elasticities of aggregate variable worker
productivity with respect to size are

                                L            L       L                L          L        L
                                ¯Q   =       W   -   lsc   >0 ;       ¯V A
                                                                             =   W   -    lsv   > 0.                        (32)

These are positive and exceed those of alternative models with homogeneous specialization fixed at any
level e    ¯.

    This is a corollary of propositions 5 and 6, and we derive them in Appendix C.8. First, both real
output and value added increase as the price index falls and thus reflect LW , which we show is positive
in proposition 5 and larger in our model under heterogeneous specialization. Second, Y /Lv is inversely
proportional to the share lsc , and ¯V A = 1/P lsv so there is an additional effect as those shares fall as
shown in proposition 6.

5.2.3   Selection and Firm Entry

We show that size increases selection into production and thus lowers the fraction of entrants that actu-
ally produce. Moreover, there are productivity distributions such that the size effect from endogenous
specialization increases the mass of entrants but is dominated by the selection effect, which results in a
reduction of active firms (and thus variety).
    We define selection into production as the fraction of firms that invested to enter and remain active,
Ma /M = 1 - G(     ¯e ), and summarize the effect of size in the following proposition.

Proposition 8. (Selection, entrants, and producer mass)

   1. The size elasticities for selection, entrants, and active firms are respectively

            L           s           L        L               s       d ln s1     L                 s       s           L
            Ma /M   =   Ma /M   ·   W    ;   M   =1+         M   ·           ;   Ma   =1+          M   +   Ma /M   ·   W;   (33)
                                                                     d ln L

   2. The size elasticity components from specialization for selection and entrants are respectively

                                   ¯e g (¯e ) ¯ - e                                      d ln ¯    F¯ d ln F  ¯
                    s                                                 s
                    Ma /M   =-                      ;                 M      a - 1)
                                                                          = (¯                  -     ¯ d ln s1 ;           (34)
                                 1 - G(   ¯e )                                           d ln s1 fE + F



                                                                 25
   3. Larger economies have more selection into production if and only if there is heterogeneous speci-
      alization: L
                 Ma /M < 0 iff s  s;


   4. There are distributions gk (·) s.t. size increases the mass of firms via specialization, s
                                                                                               M > 0, and
      simultaneously reduces active firms, s        s
                                              M + Ma /M < 0, for an economy with sufficiently large L and
      n .

    We prove this in Appendix C.9. Holding s1 constant, the mass of entrants and active firms is directly
proportional to size--the effect in standard models. The novel elasticity components due to specialization
are in (34). The mass of active firms falls relative to entrants, so selection increases if there is heteroge-
neous specialization, otherwise there is no effect since     ¯ = e . The specialization increases the mass of
                                        d ln ¯
entrants due to the multiplier effect, d ln s1
                                               >0, but that may be partly offset if the increased premium also
                                                                                ¯
                                                                           d ln F
increases the average production fixed cost over all entrants, i.e. if d    ln s1
                                                                                  > 0. In part 4 we show that
the mass of entrants unambiguously increases with size due to specialization under certain productivity
distributions, namely any gk () with constant elasticity in , e.g. if G is Pareto. Under these distribu-
                       ¯
                  d ln F
tions we obtain d  ln s1
                         = 0: some firms incur increased fixed cost expenditures to upgrade, however this
is offset by the reduction in the fraction of producers (and thus lower production fixed costs per entrant).
For such distributions we can also show that for economies that are sufficiently large, the selection effect
offsets the mass effect and so s           s
                                  M + Ma /M < 0, which implies that specialization can simultaneously
increase overall entry and reduce active firms. This existence result is present in our quantification so it
is useful to understand how it arises in the theory.
    We obtain similar results if we focus on technology improvements, .19
    In sum, endogenous specialization introduces a novel set of predictions for the impacts of size and
technology that are absent in standard models.



5.3       Profit, Sales and Productivity Distributions
The model has implications for the role of size on profits net of fixed costs and sales distributions. We
show these distributions are invariant with respect to size in standard models without changes in speci-
alization. However, in our model increases in size generate a mean preserving spread in profits, and so
higher concentration. The same is true for sales under the most standard type of productivity distribution,
Pareto. We conclude by discussing the size effects on alternative measures of productivity.

5.3.1      Profit

Profits net of production costs are given by ~ (, L) in (7) and the free entry condition in (15) implies its
mean is constant across any equilibria with the same entry cost, fE . Thus we can focus on measuring its
concentration.
  19
       Simply adjust (33) to use   d ln s1
                                   d ln      instead of   d ln s1
                                                          d ln L    and remove the direct effect since ¯     
                                                                                                        M = ¯Ma = 0.


                                                                          26
       We characterize the distributional impacts of size shocks using the profit CDF:

                                   (x, L)  Pr (~
                                                (, L)  x) ; x  [0, );                                       (35)

and the profit cumulative share among all entrants of firms with productivity at least ¯:
                                                     
                                                     ¯
                                                          ~ (, L)dG()
                                        ¯ L) 
                                       (,                                 .                                 (36)
                                                    min
                                                          ~ (, L)dG ()

We say that after a change in size from L to L profit concentration increases if either  (x, L) second-
order stochastic dominates (SSD)  (x, L ) or  (, ¯ L)   (,   ¯ L ) for all ¯ (with some inequality).

Proposition 9. (Profit distribution) An increase in size implies an increase in profit concentration iff it
changes specialization. The resulting profit distribution is a mean-preserving spread of the original with
higher cumulative shares for all ¯.

    We provide a formal proof in Appendix C.10. A change in specialization is necessary after the shock
because otherwise technology is unchanged and so is selection (shown in section 4.1.2). Thus, if the
economy remains either unspecialized or fully specialized then the marginal entrant and           ~ (·) are the
same and so are (·) and (·). What if the increase in size were large enough to move the economy
from no specialization to full specialization? This special case illustrates the basic intuition: the shock
increases selection so      ~ (, L )    ~ (, L) for    ; but the expected profit is still fE (due to free
entry) so    ~ (, L )      ~ (, L) above some  . Since     ~ (·) is continuous and the only difference across
firms (within each equilibrium) is their productivity we can show the intersection  is unique and the
new   ~ (·) intersects the original only once from below as depicted in the left panel of Figure 9. In sum, a
smaller share of entrants produces, and the ones that adopt have sales and operating profit rise faster in
 than non-adopters. This implies a higher share of cumulative profits,  (,        ¯ L )   (,   ¯ L), and also
that the original distribution  (x, L) SSD  (x, L ). Since the mean profits are equal across equilibria
the two conditions are equivalent in this setting.20
    A similar intuition applies to a shock under heterogeneous specialization. The shock leads to se-
lection and we show      ~ (, L ) is continuous and crosses ~ (, L) once from below and thus implies higher
concentration. The right panel of Figure 9 illustrates a case with two specialization technologies and the
proof extends it to arbitrary number of technologies. A key part of the insight is that initially the most
productive firms already have the technology most intensive in intermediates and thus benefit the most
from reductions in their price, P .
  20
   Atkinson (1970) shows that  (x, L ) being a mean-preserving spread of  (x, L) is equivalent to  (x, L) Lorenz-
                                            ¯ L)   (,
dominating, which in our setting requires  (,       ¯ L ) for any ¯.




                                                       27
                            Homogeneous specialization                        Heterogeneous specialization




                                   Figure 9: Size and profit distributions (L > L)

5.3.2     Sales

We establish the analogue of proposition C.10 for firm sales. To isolate the effect of size on concentration
we provide a sufficient condition that implies constant average sales per entrant, Y /M . Using (19) we
have Y /M =  fE + F     ¯ where F ¯   fi() dG() so average sales are constant if the change in size
                                         e
        ¯
leaves F unchanged, which holds in the following two cases. First, if there is no change in specialization
and thus no changes in selection or adoption, in which case the full sales distribution remains unchanged.
Second, if there is a change in specialization but the change in entry fixed costs (selection) are exactly
offset by the change in upgrading costs. In part 4 of proposition 8 we provide the following sufficient
productivity condition for constant mean sales under heterogeneous specialization:
                                                                                              
                  d ( ¯)                                              d ln                    ¯
                                                                                                  z-1 dG()
                         = 0 for all ¯ > min and z  [1,  ];  (,
                                                              ¯ z)  -                                           .           (37)
                   d ¯                                                                          d ln ¯

The condition is satisfied by the untruncated Pareto where  = k - (z - 1).21
    Similarly to profit, we define the sales cumulative share among all entrants of firms with productivity
at least ¯ as:
                                                            
                                                           ¯
                                                                 y
                                                                 ~(, L)dG()
                                             ¯ L) 
                                            (,                                       .                                      (38)
                                                           min
                                                                 y
                                                                 ~(, L)dG ()
                                                                                              ¯ L) 
       Sales concentration increases if either the original distribution SSD the new one or  (,
  21
     Recall that firm sales are proportional to -1 so we can interpret  (,    ¯  ) > 0 as the elasticity of cumulative sales with
respect to ¯ (of firms with productivity above  ¯ that share a given technology). These elasticities weight the impacts of changes
in cutoffs as s1 increases. Melitz and Redding (2015) define  (z =  - 1) as the "hazard function for the distribution of log
fim size in a market" and show that it determines if the partial trade elasticity is constant and is thus important in determining
the gains from trade.



                                                               28
 (,¯ L ) for all ¯ (with some inequality).
    The shares of operating profits are also given by (38) so the proposition below applies to these as
well. Operating profits differ from overall profits due to endogenous fixed costs so we need to extend the
results in Proposition 9 to account for this.

Proposition 10. (Sales distribution)
   An increase in size implies an increase in sales concentration iff it changes specialization and dd
                                                                                                      (
                                                                                                       ¯
                                                                                                        ¯)
                                                                                                           =
0. The resulting sales distribution is a mean-preserving spread of the original with higher cumulative
shares for all ¯.

    We provide the proof in Appendix C.11. If i = e for all i and a shock to L does not change
specialization then the sales distribution remains unchanged. With homogeneous specialization F       ¯ is
constant and so are mean sales; moreover the cumulative shares are also unchanged:  (,           ¯ L) =
    -1                -1
  ¯
     dG()/          ¯e
                        dG() and         ¯e is unchanged as shown in section 4.1.2. This share expres-
sion also shows that if the shock changes specialization from none to full then the increased selection
leads to higher  (, ¯ L) if dd
                              (
                               ¯
                                ¯)
                                   = 0. A similar insight applies when we move from no specialization to
some or within heterogeneous specialization equilibria. The proposition applies to the Pareto distribution
used in the calibration.22

5.3.3        Productivity

We focus on a baseline firm measure of TFPQ given by the inverse of unit cost net of inputs, which is
simply the fundamental productivity parameter23 :

                                                                                  -1
                                                                     ci
                                                  Ci-1                                 = .                                      (39)
                                                              w 1- i (P/)i
We focus on surviving firms and define µ(·) as the survivor density of TFPQ: µ (, L) =
g () / 1 - G ¯L
              e    for     ¯L
                            e and zero otherwise, where ¯L
                                                         e is the production cutoff under L.


Proposition 11. (Survivor TFPQ distribution)
   An increase in size changes the TFPQ distribution iff it changes specialization and then implies
µ (, L ) FOSD µ (, L).

    Changes in specialization are necessary because otherwise there is no selection, as previously dis-
cussed. Large enough shocks from no specialization to full specialization will generate selection and
thus a higher mean productivity of surviving firms. Selection is also the only channel operating under
heterogeneous specialization since L only affects µ (, L) via ¯e .
     22          d ( ¯)
          When    d ¯     > 0 there are competing effects, thus we can't show the size shock leads to higher cumulative shares for all
¯.
     23
    The result applies to "true" quantity TFP, which requires a measure of the effective intermediate price index. In practice,
we measure aggregate expenditure in intermediates, which implies that shocks increasing variety would typically have an
additional impact on measured productivity.


                                                                     29
    In appendix C.12 we discuss how alternative weighted averages of TFPQ are affected by size due to
selection and re-allocation.


6        International Trade
We allow for international trade between symmetric countries and show the size comparative statics are
isomorphic to moving from autarky to free trade; or to partial trade liberalization. This extends the
applicability of the theoretical results in an important direction because trade policy is a simple lever
that a government can use to change the effective market size. Moreover, the extension provides a direct
connection between trade costs and specialization, which we highlight in the motivation facts and explore
to calibrate the model.
    We also provide two additional insights about the effect of liberalization. With endogenous speciali-
zation we show that liberalization generates (i) higher income gains and (ii) increases the share of trade
in intermediates (in contrast to standard models where it is constant). These occur only for economies
with size or intermediates technology in the heterogeneous specialization range, and thus imply different
impacts of trade liberalization across countries (or industries) and over time.


6.1      Market Size Equivalence
We show size and trade shocks have nearly isomorphic results in the absence of fixed export costs for
most outcomes.

6.1.1     Free Trade Areas

We first illustrate the basic equivalence between liberalization and market size with a simple example.
Consider an initial equilibrium where EL, in Figure 6 represents a closed economy of size L. In a fully
integrated economy of size N × L the new equilibrium can be represented by EL , , which results from
shifting P~ down as the result of increasing size by a factor N ; this is also the equilibrium if we only allow
for free trade in goods between N symmetric countries.24
    In this setting (and without fixed exporting costs), an advalorem export cost factor   1 enters
 ~
P similarly to L, as we show explicitly below. So an identical reduction in  between N symmetric
countries from infinity (autarky) to  = 1 (free trade) can also be represented by Figure 6. If we interpret
N as a measure of a continuum of countries then we can derive elasticities with respect to : the fraction
of countries with free trade. The income elasticity with respect to  is equal to L    W given in proposition 5.
    24
     Free trade and identical preferences imply a firm sets the same price across markets but faces higher aggregate expen-
diture, N X , and competition (lower P ) relative to autarky. Firms in each country with a given productivity make the same
specialization decisions. Similar prices, technologies, and size imply that in the free trade equilibrium, which replicates the
fully integrated economy outcome, the income-expenditure constraints hold for individual countries.




                                                             30
Moreover, the effects of  are similar to those of L in propositions 6, 7, 9, and 10; since in them L works
only through the price index and specialization.25
    In proposition 5 we show that size expansions have larger income effects for countries in the en-
dogenous specialization range relative to those below it. Combining this and the isomorphism implies
that expansions of free trade areas can have heterogeneous and threshold effects, which are larger if the
expansion of the area is sufficiently large (or between countries with sufficiently advanced intermediate
technology ). This provides one possible rationale for mega-regional deals.

6.1.2    Trade Liberalization

The liberalization-size isomorphism described above extends to partially integrated economies: those
                                                                                                ~  L × l ,
with iceberg export costs,   1. In this setting the price index is still given by (22) but with L
where l is the trade market size factor, which we derive below as

                                             l  1 + (N - 1)  1-  1.                                                       (40)

This factor is increasing in the number of trading partners and decreasing in export costs and spans the
two special cases in the previous section: free trade case,  = 1, and l = N , and autarky,  =  and
l = 1.
   To derive l , note that total operating profits from domestic and foreign sales are now

                       ~i () = ~ XP -1 [ci ()]1- + ~ (N - 1) X  (P  )-1 [ ci ()]1-                                        (41)
                              =~ [l X ] P -1 [ci ()]1- ,

where the export profit in the first line reflects the N - 1 additional markets where sales incur an extra
marginal cost. The second equality reflects the symmetry, which implies identical aggregate expenditures,
X = X  , at home (no asterisk) and each foreign market, (asterisk). In the absence of fixed export costs all
firms export, so all firms have the same profit expression. Moreover, the profit expression is identical to
what we had under autarky except that it reflects "effective expenditure" X   ~  l X . Thus the expressions
for productivity thresholds are unchanged but now use X     ~.
    The expression for each country's total expenditure is still the first equality in (11); total sales of a
given country's firms, Y , must equal world expenditure on them. In a symmetric equilibrium this implies
we still obtain Y = X and (11) holds: X = La      ¯ . The free entry expression does not reflect expenditure
so it remains unchanged.
                                                                                            ~ so in (22) we use
    In sum, the only difference in the price index is that the entry cutoff in (8) reflects X
~  L × l , implying that P has the same elasticity with respect to L and l . The following proposition
L
summarizes the equivalence between increases in L and trade liberalization--i.e., increases in l due to
  25                                                                                                                      L
  The main difference is that L has a direct effect on the mass of each country's firms, reflected in the first term of   M   =
       d ln s1
1+ s
   M · d ln L , whereas  does not.



                                                             31
a reduction in  or an increase in N .

Proposition 12. (Impacts of trade liberalization)
                                                            ~ = L × l , and has the same impacts as
    A trade liberalization increases effective market size, L
                                                                 l
increased size in propositions 5-11; except that l     L                L
                                                 M = M - 1 and Ma = Ma - 1.


    The proof is straightforward. First, the trade liberalization parameters,  or N , only affect s via P ,
which we already showed has equal elasticity for both L and l . Second, with one exception, the effects of
size increases in propositions 5-11 work through the specialization elasticities and don't depend directly
on L or l (or its determinants); so s      d ln s      s d ln s
                                       o · d ln l = o · d ln L implies these shocks have similar impacts. The
                                                                                                    
exception is the mass of firms, which depends directly on a country's L but not on l , hence l            L
                                                                                                    M = M - 1,
with a similar modification for active firms.
    We summarize some of the key results from proposition 12 here. Under endogenous specialization,
trade liberalization implies (i) larger real income gains than alternative models with homogeneous spe-
cialization (proposition 5); (ii) an increase in the aggregate variable cost share for intermediates and a
decrease for labor (proposition 6); (iii) increased selection (proposition 8); (iv) increased concentration in
profit (proposition 9) and sales (proposition 10) and (v) a FOSD of surviving firm productivity distribu-
tions (proposition 11). All effects in (ii), (iii), (iv), (v) are absent in similar trade models with exogenous
specialization and no fixed costs of exporting.


6.2    Intermediate Trade Share
Estimation and calibration often makes use of trade shares and costs. Thus we note two results related to
these. First, using proposition 12 and (40) we can obtain elasticities in terms of  , e.g. for real income
we obtain
                                    l   d ln l                             
                              W =   W ·        = LW · [- ( - 1) (1 - 1/l )] .                          (42)
                                        d ln 
Second, the trade share of intermediates increases with trade liberalization. Since the consumption and
intermediates bundle are the same, the intermediate share of total trade, v , is simply the intermediate
share of expenditures:
                                          [( - 1)/ ]  ¯Y    -1
                                     v=                   =        ¯.                                  (43)
                                                Y             
                                                           
The elasticity of this share with respect to l is simply l
                                                         ¯ , which is positive under endogenous specializa-
tion as shown in proposition 12--so trade liberalization increases v . Therefore, reductions in export costs,
 , common to final and intermediates can explain increases in v only under endogenous specialization.


7     Quantitative Implications
We have three objectives in the following simple calibration to U.S. manufacturing in 1987-2007. First,
to assess if the model is consistent with first order changes in the data untargeted in the calibration.

                                                      32
Second, to illustrate the relative importance of the selection and specialization mechanisms, and the
extent of market inefficiency. Third, to quantify the effects of large shocks, such as moving from the
2007 equilibrium to autarky or free trade on real income, intermediate trade, firm technology, and profit
concentration and contrast to alternative models.


7.1     Calibration: Assumptions and Identification
We focus on a symmetric setting where the U.S. accounts for one fourth of world income (N = 4)
and use it to calibrate the parameters in Table 2. We assume three potential intermediate technologies
                                                                                                         k
(i = 0, /2, ) so  = /2. Productivity follows a Pareto: G() = 1 - min                     
                                                                                               , and technology
parameters are constant as are all fixed costs, f .
    The baseline elasticity of substitution is  = 5 and we test robustness to it in Appendix D.5.26 The
following parameters are common to other models of heterogeneous firms and so we use external standard
values (L) and normalizations (min , f0 , fE ) listed in Table 2.27
    The most productive firms fully specialize in our model so their sales distribution is Pareto and thus
we choose its parameter k/ ( - 1) = 1.42, which is consistent with sales distribution evidence. The
results are similar if we calibrate this ratio while solving the model, as we show in Appendix D.5.28
    The calibration of variable export costs t is also standard: it directly matches average firm exports as
a share of sales, (N - 1)t1- / 1 + (N - 1)t1- , which we observe in the data in 1987 and 2007.
    The remaining four parameters, , f     ^, 0 , and T , are internally calibrated when solving for the equi-
libria. We sketch the data moments and two-loop algorithm here and provide details in Appendix D.1.
The inner loop uses initial guesses for f ^, , and the specialization premia, s1,t . Using these along with t ,
the pre-assigned parameters and the expression in (13) we choose the unobserved maximum intensities
t to match the observed average share in each period (      ¯ t=0,T =0.699, 0.743).29
    The free entry condition is used to calculate the entry cutoff,   ¯e,t , and the zero cutoff profit condition
yields Pt . From the specialization schedule (23), we obtain t , and calculate the model-implied changes
                                  w 30
in relative factor prices  ln P      . If maximum intensity is constant and equal to the initial guess,
                         w
t=0,T = , and  ln P = 0.383 (the change in relative intermediates costs to labor in the data) then
we go to the outer loop, otherwise we iterate over alternative f   ^ and s1,t .
    The outer loop computes the top firms' sales share in the initial equilibrium and stops if it is equal to
the one in the data in 1987 (0.645); otherwise it continues to iterate over .31
  26
      Melitz and Redding (2015) use a value of 4 and Costinot and Rodr´  iguez-Clare (2014) use a value of 6.
  27
      Our model is not neutral with respect to economic size but our calibration strategy allows us to find the "effective size"
of the economy, which is a function of fE , min , f0 , and .
   28
      For example, Kondo et al. (2018) estimate it to be 1.49 for US manufacturing in 1982 and 1.75 in 1992 using establishment
data and around 1.15 using firms.
   29
      We use non-energy material expenditure as a share of all costs: materials, labor and investment. In the appendix we
examine robustness to alternative capital expenditure measures.
   30                                                w       ln s
      From the specialization schedule (23),  ln P       = 0 1,t -  ln t .
   31
      We measure the sales share as the fraction of total manufacturing sales done by the top 20 firms in each industry (equiva-
lently an industry sales weighted measure of top 20 firm shares).


                                                              33
                                                                 Table 2: Calibration Parameters
     Parameter                                                   Value                                              Source/data moment
                                                                                                                           Internal
     Variable export cost                              0 = 2.28, T = 1.98                       Export intensity: 0.10, 0.163 (CM)
      Maximum intermediate cost share                       = 0.746                              Average intermediate cost shares:   ¯ t=0,T = 0.699, 0.743
      Adoption fixed cost factor                            ^
                                                           f = 11.37                             Initial sales share of top 20V largest firms: 0.645 (CM)
                                                                           
      TFP parameter                                   0 = 0.209, T = 0.229                        Log growth in relative factor price: 0.383 (NBER-CES)
                                                                                                                           External
     Number of Countries                                        N =4                            Average US share of world income: 1/4
     Potential Intermediate Technologies                                                        N/A




34
                                                             i = 0, /2, 
     Elasticity of substitution                                 =5
                                                                                                  k
     Productivity dispersion                                   k = 5.67                           -1
                                                                                                       = 1.42 in Melitz and Redding (2015)
     Minimum productivity *                                    min = 1                          ""
     Fixed cost of entry and production *                    fE = f0 = 1                        ""
     Labor *                                                    L = L0                          Initial Manufacturing employment: 17,718 (CM)

         CM: Census of Manufacturing data for 1987 and 2007 (export intensity) and 1987 (sales share and employment). NBER CES database data moments are
         computed as three-year geometric averages in both the initial (1987­1989) and final period (2005­2007). * Normalizations, which affect the magnitude of
          but not other calibrated parameters or outcomes.
7.2       Equilibrium, Parameters and External Validity
We illustrate the calibrated equilibria, discuss the resulting parameters and provide some external validity.




                                         Figure 10: Calibrated equilibria

    Figure 10 shows the calibrated equilibrium in the initial, E0 , and final period, ET . The shift in the
specialization and price schedules reflect the  and  shocks respectively. Each equilibrium is unique for
the respective set of parameters and entails heterogeneous specialization. The change in specialization
premium is 17.6 lp.
    The model is exactly identified and replicates all the targeted data moments listed in the third column
of Table 2. Thus we briefly discuss external validity by comparing (i) the internally calibrated parameters
to other estimates and (ii) model predictions to key untargeted data moments.

7.2.1      Trade growth

The calibration implies a variable export cost factor in 2007 that is about 14 log points lower than 1987.
This seems reasonable given the bilateral and multilateral liberalization in that 20-year period and the
reductions in transport and information costs.
    Given some stark simplifications of the model we ask if it can still explain key untargeted aggregate
trade growth statistics. Specifically, the model assumes all firms export and countries are symmetric.
This implies the growth of firm export intensity is common across firms and so equal to the aggregate
growth of (i) exports to sales ratio (all firms export) and (ii) import penetration (country symmetry). The
average of these two untargeted aggregate growth rates in the data is 2.6 log points/annum--very close
to the 2.4 export intensity growth using the targeted firm level moments.32
  32
       The aggregate growth rates employ NBER-CES data combined with the import and export data from the motivation


                                                         35
7.2.2    Input shares and adoption

The calibrated model implies a change in the aggregate labor share of variable cost of -4.4 percentage
points over the full period, which is similar to the corresponding untargeted change in the data: -4.0.33
    The calibration replicates the average intermediate shares for the initial and final period,   ¯ t=0,T ; it
implies a maximum intensity of 0.746, which as we would expect is above each of these targeted averages
but also above the similarly computed    ¯ t for any other year in between. It also allows us to compute the
fraction of adopters of each technology, n = 0, 1, 2. We obtain an increase from 0.24 to 0.77 in the share
of adopters that prefer at least an intensity of 0.37 (and thus adopt either n = 1, 2) and thus a decline in
the share of firms preferring an intermediate intensity below that. Each upgrade requires a fixed cost 11.4
times higher than the production (or entry) cost.34

7.2.3    Productivity Growth

The calibration yields an intermediate productivity improvement of  ln  = 9 lp. There is no direct data
counterpart so we assess its reasonableness indirectly by comparing its implications (jointly with the rest
of the parameters) for alternative measures of productivity which it affects. In section 5.2.2 we defined
value added TFP as   ¯V A  Y 1 - -    
                                        1
                                          ¯ /P Lv . In the model we show  ln     ¯V A =  ln (w/P lsv ) =
        w           ( -1)(1-¯)
 ln P      - ln 1+(    -1)(1-¯)
                                = 45.8 lp, about 2.3 lp /annum from 1987 to 2007. In the data we compute
it as real value added per production-worker hour and its change over the period is 3.65 lp/annum.35 So
the model explains almost 2/3 of this untargeted moment. One reason the calibration can match this is
that it generates a large enough change in the specialization premium, about 18 lp, when we allow for
trade and  shocks, with the latter accounting for a large fraction of that growth.36

7.2.4    Sales Distribution Change

The calibration targets the share of top 20 firm sales in 1987 but not its change relative to 2007. In Table
3 we show that the model-implied change accounts for over two thirds of the data when we consider
section from year 1990 to 2007, hence the comparison of average yearly growth rates. These growth rates are computed
within industry and aggregated with fixed weights, which is similar to how the intermediate shares are computed.
   33
      We target the intermediate share in the data but not the labor share. While reductions in the latter mirror any intermediate
share increase in the model, that is not necessarily the case in the data where total costs also reflect energy and investment.
   34
      Without firm level data it is hard to determine how reasonable these fractions and associated upgrading cost is, but we
note a couple of relevant features. The calibration restricts the available technologies and uses aggregate data so it cannot
capture the true maximum intensity available to firms, but it can provide a lower bound on the fraction of firms that prefer an
intensity of at least 0.746, which is 0.07 in the initial equilibrium and 0.61 in the final one. These firms are the largest ones
and thus generate sales weighted shares close to the maximum. We compare these adopter shares with a proxy: the untargeted
intermediate shares in each,   ¯ t . If an industry average share exceeds 0.746 then there are firms with optimal intensity above
that level, which is the case in about 0.22 of all 4-digit industries in late 1980s and 0.33 in mid 2000s.
   35
      Calculated as the log change in each industry between the initial and final periods and weighted by the year 1997 industry
total costs and divided by 20.
   36
      The premium would have increased by almost 15 lp in a counterfactual with only the 9 lp shock to .




                                                               36
changes in the top 20 share and almost all data changes for the top 50 share.37

              Table 3: Changes in sales share: untargeted data vs. calibrated model (pp)
 Moments (Change share, pp)         Data            Model ( and  shock)               Model ( shock)
 Top 8V firms                        3.98                    1.82                         0.66
 Top 20V firms                       3.45                    2.38                         0.87
 Top 50V firms                       2.95                    3.12                         1.14

        Notes: Comparison of untargeted changes in alternative sales concentration ratios in the data (1987-2007) with
        the model-implied changes due to the calibrated trade and productivity shocks. The V denotes the number of
        industries of US manufacturing industries with more than 100 firms used in the calculation. The aggregation of
        the concentration ratios across industries in each year t uses each industry's sales share. For the model-implied
        change, we compute the productivity cutoff that matches the fraction of firms corresponding to the top firm
        sales share in year 1987, and see how much changes in the sales share are generated at the same cutoff in the
        final equilibrium.




7.2.5    Model Versus Data Regressions: Specialization and Concentration
                                                                                        m
In Table 1 we found specialization increases with an industry's relative input price wt   /Ptm , significantly
so for more concentrated industries. To examine if the model can generate this finding we must bridge
from the calibrated model to the multiple industries in the regression. The model could be extended
to incorporate multiple industries; if we allowed linkages only within industries (and Cobb-Douglas
aggregation across them on the consumption side) then we could calibrate similarly to the single industry
approach. Doing so could exactly replicate the intermediate shares, specialization premia and top sales
share by industry in the data and thus the empirical relationship in Table 1. Therefore we follow an
alternative approach. We start from the aggregate calibration, apply an exogenous shock to generate
variation in the initial conditions and then apply a trade shock to it. We then use the model-generated
outcomes to run the regression similar to Table 1.
    We describe the basic approach here (for details see Appendix D.3). We take 500 draws of shocks
(approximately the number of industries in the regression) from a lognormal to apply to the calibrated
adoption cost, f^, and generate new economies that vary only in this dimension and thus in initial sales
concentration. We re-calculate the initial equilibrium variables, denoted x~m
                                                                            0 . We then draw a trade shock
(from a lognormal consistent with the mean and standard deviation in the data) and apply to each initial
equilibrium. We compute the resulting final period outcomes holding all other parameters fixed. Finally,
we compute the change in outcomes, t x    ~m , and run a version of specification in column 1 of Table 1 in
changes using the 500 model draws. We report the average OLS coefficients over 100 repetitions of this
  37
     That fraction is smaller when we consider the top 8, suggesting superstar firms may be specializing even more (the model
could capture this by allowing more than 3 intermediate intensities).




                                                              37
procedure, all of which are significant at the 1% level.

                           m                                                   m
                           t                                     m           wt
                  t ln     m
                                   = 0.40 + 1.67 × Conc              t ln            + 0.015 + t utm                   (44)
                           w,t                                               Ptm

    We find a positive differential elasticity for industries with higher initial concentration. This is also
the case in the data where the differential elasticity is 0.067 for industries with concentration 1 standard
deviation above the mean in the data. The analogous differential using the model is 0.13 (the standard
                   m
deviation of Conc is 0.08). In Appendix D.3 we argue that the data estimate is attenuated by measure-
ment error of the concentration variable (top 20 share) relative to its model counterpart (share of sales by
a fixed percentile of firms).


7.3     Equilibrium Trade Effects and Role of Endogenous Specialization
We now focus on the reduction in trade cost between 1987 and 2007 and examine its impacts on the initial
equilibrium of the calibrated economy while holding intermediate technology () fixed. The objectives
are to illustrate the quantitative relevance of the model in studying trade shocks and contrast it with
alternative models with fixed or no specialization.

7.3.1    Income, Cost Shares and Productivity


                   Table 4: Changes in real income, cost shares, and productivity (lp)
                                  Real          Intermediate       Labor VA            Labor VA
 Model                        income (W )         share (¯)        share (lsv )    productivity (¯V A )
 Endogenous Specialization        8.34               1.96             -2.16               10.5
 Fixed Specialization             6.03                 0                0                 6.03
 No Specialization                1.81               N.A.             N.A.                1.81

        Notes: Changes in log points for each outcome from the calibrated 14 lp trade cost reduction starting at the
        initial equilibrium while fixing productivity (). Source: Authors' calculations



     The first row of Table 4 shows the effects of the 14 lp decrease in trade costs. It increases real income
by over 8 lp. The aggregate intermediate share in variable cost increases by close to 2 lp; this is also the
growth in the share of trade in intermediates (see (43)).
     The share of labor in variable cost, lsc , mirrors that of the intermediate share, so it falls by 1.96 lp ,
whereas the labor share in value added, lsv , falls by 2.16. As we show in proposition 6, the growth in real
productivity per variable production worker is given by the difference of real productivity (or income in
first column) and that of the respective labor share (lsv in the third), which yields the 10.5 increase in
labor VA productivity.


                                                            38
    The model provides a simple decomposition of the gains from liberalization. Using the equilibrium
price expression in (21) that determines real income changes, we obtain

                                                        ~
                                                     ln L                  ln a
                                                                              ¯
                                  ln W =                              +         +  ln ¯e
                                                    -1                    -1
                                                                                           Selection   .                      (45)
                                                 No Specialization        Multiplier
                                   8.34 =             1.81            +    0.63        +     5.9

     Using the relationship in proposition 12 the 14 lp decrease in  is equivalent to a size increase of
 ln L  ~ = 7.3 lp. The no specialization component divides it by  - 1. This yields a modest income
increase of 1.81 lp, which is common to a variety of trade models.38 The endogenous multiplier effect
adds 0.63 lp and the selection effect is about 3.3 times larger than the basic no specialization effect.
Overall, the income effect is 4.6 times higher with endogenous specialization than without any.
     Existing models with fixed intermediate technology are also known to generate larger trade impacts.
However, this is not all that our model captures. Using (22) we obtain a gain under fixed specialization
                     1  ln L~
of  ln W F S = 1-     e  - 1
                              = 6.0, so it is about 3.3 times larger than without specialization--reflecting
                              1
the fixed input multiplier 1-  e
                                  evaluated at the initial ¯ in the data. The endogenous specialization gain
is still almost 1.4 times higher than what we obtain in a comparable fixed specialization calibration.39
     In addition to the quantitative importance of endogenous specialization, the table also highlights the
fact that similar models without that feature can't explain any changes in input shares, and thus, any
changes to labor productivity reflect only overall productivity.

7.3.2    Selection, Entry and Adoption

The following table confirms and quantifies two of the insights in proposition 8. First, there is a selection
effect with a 33 lp reduction in the fraction of active firms. Second, there is an increase in entry, as
predicted under Pareto. Moreover, in this calibration the selection is sufficiently large that the mass of
active firms falls. The fraction of active firms adopting either of the intermediate technologies increases,
more so for the higher specialization.
    As noted in the qualitative implications a similar change in trade costs has zero effect on all the
outcomes in this table if there is no change in specialization and thus in the fixed and no specialization
models.
  38
      Specifically any other model that falls in the Arkolakis et al. (2012) class where trade elasticity and trade share growth are
sufficient statistics to compute trade gains, these are captured by  - 1 and  ln L    ~ respectively in our setting without export
selection and no specialization.
   39
      In Appendix D.4 we show how we can calibrate this fixed specialization model to yield the same initial equilibrium
welfare and all other endogenous variables while having all firms with the same intermediate intensity e =         ¯ as in our model
but different TFP technology i .




                                                                     39
                                                         Table 5: Changes in selection, entry, and adoption (lp)
 Selection                                                 Entry                    Active                     Adoption intermediate:
 (Ma /M )                                                   (M )                     (Ma )                       low; high (1 ; 2 )
 -33.4                                                       2.54                    -30.8                           13.3; 39.2

        Notes: Changes in log points for each outcome due to the calibrated 14 lp trade cost reduction applied to the
        initial equilibrium holding fixed productivity (). The adoption measure i is the fraction of firms adopting
        each intermediate intensity. Source: Authors' calculations.



7.3.3    Profits and Sales

Finally, we examine the calibration impact of trade costs on profit and sales distributions derived in
propositions 9 and 10. Figure 11 shows the Lorenz curves. The dashed curves represent the equilibrium
with lower trade costs and are below those of the initial equilibrium. Thus, we confirm that the increase
in market size causes a MPS of sales and profits under a Pareto. Recall from the theory that this shock
has no effect on distributions if there is no change in specialization.

                                                                             Figure 11: Sales and profit Lorenz

                                                                Sales Lorenz                                                                         Profit Lorenz
                                           1                                                                                   1
                                                        initial trade cost                                                                  initial trade cost
                                          0.9           final trade cost                                                      0.9           final trade cost


                                          0.8                                                                                 0.8

                                          0.7                                                                                 0.7
                 cumulative sales share




                                                                                                    cumulative profit share




                                          0.6                                                                                 0.6

                                          0.5                                                                                 0.5

                                          0.4                                                                                 0.4

                                          0.3                                                                                 0.3

                                          0.2                                                                                 0.2

                                          0.1                                                                                 0.1

                                           0                                                                                   0
                                                0      0.2        0.4         0.6   0.8    1                                        0      0.2        0.4        0.6   0.8     1
                                                    cumulative productivity distribution                                                cumulative productivity distribution


        Notes: Productivity distributions are truncated pareto with minimum productivity set to the initial level of the
        entry cutoff. Source: Authors' calculations.




                                                                                               40
7.4     Robustness
We check the robustness of our calibrated parameters and quantitative implications by carrying out three
alternative calibrations. First, we lower the elasticity of substitution from  = 5 to 4. Second, instead of
pre-assigning the Pareto shape parameter, k , we calibrate it by utilizing an additional moment: top 4 firms
sales share. Lastly, we use capital expenditures from the EU KLEMS database to measure intermediates
cost share. The conclusion is that the basic quantitative implications of the baseline calibration are robust
to those alternative specifications, and we provide them in detail in Appendix D.5.

        Table 6: Robustness: changes in real income due to observed trade cost reduction (lp)
                              Baseline      =4        Calibrated k       Alternative capital measure
 Endogenous Specialization     8.34         11.18          8.37                      6.97
 Fixed Specialization          6.03          8.04          6.03                      5.72
 No Specialization             1.81          2.41          1.81                      1.81

        Notes: Changes (in log points) for real income due to the observed trade cost reduction shock from the initial
        equilibrium of the calibrated economy across different calibrations. The first column uses the baseline, the
        second changes  = 5 to 4, the third uses the top 4 firm sales share in 1987 to calibrate k , the last uses an
        alternative capital measure from the EU KLEMS database to compute intermediate share. Source: Authors'
        calculations



    In Table 6 we show the real income gains from the 14 lp reduction in trade cost across those alternative
specifications. First, a lower elasticity of substitution at 4 magnifies income gains by 33%, as the variety
effects are larger; and that magnification is similar for different specialization scenarios. Second, when
k is calibrated, we obtain results similar to the baseline. Last, using an alternative capital measure yields
smaller income gains under specialization because the measured intermediates cost share is           ¯ t=0,T =
[0.683, 0.715], which is slightly lower than the baseline in terms of both the level and the relative increase
between the two periods.


7.5     Policy Experiments
We now examine counterfactual policy changes with potentially large effects on market size and effi-
ciency.

7.5.1    Trade Taxes and Market Size

Since 2007 there has been increased trade protectionism, most recently characterized by Trump's trade
war. In Table 7 we illustrate its implications for real income and intermediates if it applied to all U.S.
partners and they retaliated symmetrically. We also compare it to going to autarky; which provides a
benchmark number for gains from trade commonly used in the literature.



                                                             41
               Table 7: Real income and intermediates share under trade war and autarky
                                                       Trade war                        Autarky
 Policy scenario
                                                    ( ln  =16 lp)                     ( ln  = )
              ~
 Market size (L)                                          -8.02                          -17.8
 Intermediate share (¯)                                   -0.46                          -1.28
 Real income: End. specialization (W )                    -8.40                          -18.8
                                    ns
 Real income: No specialization (W )                      -2.00                          -4.45


    Autarky entails a market size reduction of about 18 lp, which lowers the intermediate share by 1.3
lp. It reduces real income by almost 19 lp--over 4 times the amount it would in a setting without
specialization.
    For comparison with the rest of the quantification we model the trade war as a symmetric trade cost
increase of 16 lp.40 This magnitude reflects the increase in the U.S. average tariff rate factor on Chinese
imports from about 1.03 to 1.21 between early 2018 and the end of 2019.41 The implied market size
reduction is almost half that of autarky and therefore so is the income reduction under no specialization.
Under endogenous specialization the intermediate share falls by 0.5 lp and real income by 8 lp.

7.5.2    Specialization Taxes and Market Inefficiency

In the qualitative section we note that a market inefficiency caused by a specialization externality is
possible. We now show it is present in the initial calibrated equilibrium and can be eliminated by a
simple government policy that yields a large income gain if specialization is as low as in 1987.
    We consider a proportional tax on the operational cost of the less specialized technologies,

                           f0 = (1 + tax)f0 ,         f1 = (1 + tax)f0 (fa ) ,        f2 = f0 (fa )2 ,

which increases the incentive to adopt the most specialized one.
    A particularly simple policy is a prohibitive tax rate. This policy ensures that all firms optimally fully
specialize and thus no tax revenues are collected.42 We compute the required rate for this behavior in the
1987 equilibrium to be 118%. Since the policy is not optimally chosen there is no a priori reason that it
must increase real income as shown in section 5.1. However, we find that it does generate a 5.2 lp gain--
indicating a sizeable specialization externality. This differs from the standard input-output externality,
which is captured in the fixed specialization framework. In fact, in the latter case the calibration shows
that a similar prohibitive tax generates a 3.1 lp income loss.43 This divergence in outcomes further high-
  40
      We abstract from the fact that the tariff has revenue and its elasticity is slightly different from a pure export cost.
  41
      This also uses the fact that US tariffs are applied to the cost at the border so the growth in the overall trade cost factor is
ln 1.21
   1.03 , independent of the initial value of other costs.
   42
      To determine the optimal rate we can distribute any tax revenue (T R) to consumers so the goods' market clearing condi-
tion would become X = 1L       +T R
                             -  -1 ¯
                                     .
                               
  43
   Under fixed specialization all three technologies have the same intermediates share but different unit costs, so we imple-
ment the tax on the fixed operational costs of two technologies with higher unit costs as in the baseline. See Appendix D.4 for


                                                                42
lights the importance of understanding endogenous specialization and the role for government policies to
minimize the associated market inefficiencies.
    We perform a similar experiment starting in 2007 and find it has a negligible income impact, 0.5 lp.
This suggests that trade and productivity improvements induced sufficient specialization to eliminate the
under-adoption inefficiency.


8     Conclusion
We provide a tractable framework to analyze the implications of the classical ideas that larger markets
allow for a finer division of labor and this division feeds back into larger market size. By focusing on the
adoption of intermediates by firms with heterogeneous productivity we capture key features of modern
economies and provide new insights on the impacts of market size and technology on the structure of
production, firm concentration and income gains. International trade is a key determinant of size and
thus of these outcomes, as the quantification illustrates.
    Market size affects specialization due to firm-level increasing returns to scale arising from adopting
intermediate-intensive technologies. The impacts are magnified in general equilibrium by an endogenous
multiplier and a selection effect. We show analytically that increases in market size or a trade liberaliza-
tion imply (i) larger real income gains than alternative models with fixed specialization; (ii) an increase in
the aggregate variable cost share for intermediates and a decrease for labor; (iii) increased firm selection;
(iv) increased concentration in the profit and sales distributions; (v) a FOSD shift of TFPQ for surviving
firms and (vi) an increase in the intermediate trade share. The effects in (ii)-(vi) are absent in similar
models with exogenous specialization.
    In the calibration we illustrate key analytical results; quantify the importance of trade and technology
shocks in the U.S. in 1987-2007 and the role of selection and multiplier effects; we also examine counter-
factual policy changes. The calibration yields reductions in trade costs and improvement in intermediate
productivity in this period that allow us to match key targeted moments, and is consistent with untargeted
moments of the data. A substantial fraction of the increase in specialization premium is due to the exoge-
nous intermediate productivity. But the trade cost reduction still corresponds to an effective market size
increase of over 7 lp and thus has significant effects including: (i) real income gains larger than without
specialization (4.6 times) or fixed specialization (1.4 times); (ii) an increase in the intermediate share in
production and trade of 2 lp and a reduction in the labor share of value added of similar magnitude--none
of which possible in alternative models; (iii) substantial increases in the fraction of firms specializing and
selection into production.
    Two counterfactual experiments highlight the importance of trade and industrial policy. First, a tax
that induces firms to specialize would increase real income; so the initial equilibrium is inefficient. Se-
cond, the impact in the 2007 economy of an increase in trade costs of 16 lp--similar to the recent trade
the parameterization of the fixed specialization model.



                                                          43
war--reduces market size and real income substantially: almost half way to trade autarky.
    The model nests the special cases of no specialization or homogeneous specialization technology; it
also shows that increases in size or technology can explain how an economy can develop by endogenous
specialization. Future research can extend this simple framework along interesting directions, e.g. adding
capital owners to study redistribution; allowing variable markups so increases in concentration become a
source of increasing market power; modelling multiple sectors and export selection to better match the
data.




                                                   44
References
Acemoglu, D. (2002). Directed technical change. Review of Economic Studies, 69(4):781­809.

Acemoglu, D. and Azar, P. D. (2020). Endogenous production networks. Econometrica, 88(1):33­82.

Amiti, M. and Konings, J. (2007). Trade liberalization, intermediate inputs, and productivity: Evidence
 from Indonesia. American Economic Review, 97(5):1611­1638.

Antras, P., Fort, T. C., and Tintelnot, F. (2017). The margins of global sourcing: Theory and evidence
  from US firms. American Economic Review, 107(9):2514­2564.

Arkolakis, C., Costinot, A., and Rodr´
                                     iguez-Clare, A. (2012). New trade models, same old gains? Ame-
  rican Economic Review, 102(1):94­130.

Atkinson, A. B. (1970). On the measurement of inequality. Journal of Economic Theory, 2(3):244­263.

Autor, D., Dorn, D., Katz, L. F., Patterson, C., and Van Reenen, J. (2020). The fall of the labor share and
  the rise of superstar firms. Quarterly Journal of Economics, 135(2):645­709.

Bajgar, M., Berlingieri, G., Calligaris, S., Criscuolo, C., and Timmis, J. (2019). Industry concentration
  in Europe and North America. OECD Productivity Working Papers.

Barkai, S. (2020). Declining labor and capital shares. Journal of Finance, 75(5):2421­2463.

Becker, G. S. and Murphy, K. M. (1992). The division of labor, coordination costs, and knowledge.
  Quarterly Journal of Economics, 107(4):1137­1160.

Berlingieri, G., Blanchenay, P., and Criscuolo, C. (2017). The great divergence(s). (39).

Bernard, A. B., Jensen, J. B., and Lawrence, R. Z. (1995). Exporters, jobs, and wages in US manufactu-
  ring: 1976-1987. Brookings Papers on Economic Activity. Microeconomics, 1995:67­119.

Blaum, J., Lelarge, C., and Peters, M. (2018). The gains from input trade with heterogeneous importers.
  American Economic Journal: Macroeconomics, 10(4):77­127.

Bloom, N., Draca, M., and Van Reenen, J. (2015). Trade Induced Technical Change? The Impact of
  Chinese Imports on Innovation, IT and Productivity. The Review of Economic Studies, 83(1):87­117.

Bustos, P. (2011). Trade liberalization, exports, and technology upgrading: Evidence on the impact of
  MERCOSUR on Argentinian firms. American Economic Review, 101(1):304­340.

Caliendo, L. and Parro, F. (2015). Estimates of the trade and welfare effects of NAFTA. Review of
  Economic Studies, 82(1):1­44.



                                                    45
Costinot, A. and Rodr´iguez-Clare, A. (2014). Trade theory with numbers: Quantifying the consequences
  of globalization. In Handbook of International Economics, volume 4, pages 197­261. Elsevier.

De Loecker, J., Goldberg, P. K., Khandelwal, A. K., and Pavcnik, N. (2016). Prices, markups, and trade
  reform. Econometrica, 84(2):445­510.

Dhingra, S. and Morrow, J. (2019). Monopolistic competition and optimum product diversity under firm
  heterogeneity. Journal of Political Economy, 127(1):196­232.

Eaton, J. and Kortum, S. (2002). Technology, geography, and trade. Econometrica, 70(5):1741­1779.

Elsby, M. W., Hobijn, B., and S
                              ¸ ahin, A. (2013). The decline of the US labor share. Brookings Papers on
  Economic Activity, 2013(2):1­63.

Ethier, W. J. (1982). National and international returns to scale in the modern theory of international
  trade. American Economic Review, 72(3):389­405.

Feenstra, R. C. and Hanson, G. H. (1999). The impact of outsourcing and high-technology capital on
  wages: estimates for the United States, 1979­1990. Quarterly Journal of Economics, 114(3):907­940.

Fieler, A. C., Eslava, M., and Xu, D. Y. (2018). Trade, quality upgrading, and input linkages: Theory and
  evidence from Colombia. American Economic Review, 108(1):109­146.

Fort, T. C. (2016). Technology and Production Fragmentation: Domestic versus Foreign Sourcing. The
  Review of Economic Studies, 84(2):650­687.

Grossman, G. M. and Rossi-Hansberg, E. (2008). Trading tasks: A simple theory of offshoring. American
  Economic Review, 98(5):1978­97.

Halpern, L., Koren, M., and Szeidl, A. (2015). Imported inputs and productivity. American Economic
  Review, 105(12):3660­3703.

Hummels, D., Ishii, J., and Yi, K.-M. (2001). The nature and growth of vertical specialization in world
  trade. Journal of international Economics, 54(1):75­96.

Johnson, R. C. and Noguera, G. (2012). Accounting for intermediates: Production sharing and trade in
  value added. Journal of International Economics, 86(2):224­236.

Johnson, R. C. and Noguera, G. (2016). A portrait of trade in value added over four decades. Review of
  Economics and Statistics, forthcoming.

Karabarbounis, L. and Neiman, B. (2014). The global decline of the labor share. Quarterly Journal of
  Economics, 129(1):61­103.



                                                   46
Kee, H. L. and Tang, H. (2016). Domestic value added in exports: Theory and firm evidence from china.
  American Economic Review, 106(6):1402­36.

Kondo, I. O., Lewis, L. T., and Stella, A. (2018). On the US firm and establishment size distributions.
  Mimeo.

Krugman, P. and Venables, A. J. (1995). Globalization and the Inequality of Nations*. The Quarterly
  Journal of Economics, 110(4):857­880.

Lileeva, A. and Trefler, D. (2010). Improved access to foreign markets raises plant-level productivity...
  for some plants. Quarterly Journal of Economics, 125(3):1051­1099.

Melitz, M. J. (2003). The impact of trade on intra-industry reallocations and aggregate industry producti-
 vity. Econometrica, 71(6):1695­1725.

Melitz, M. J. and Redding, S. J. (2014). Missing gains from trade?          American Economic Review,
 104(5):317­21.

Melitz, M. J. and Redding, S. J. (2015). New trade models, new welfare implications. American Econo-
 mic Review, 105(3):1105­1146.

Murphy, K. M., Shleifer, A., and Vishny, R. W. (1989). Industrialization and the big push. Journal of
 political Economy, 97(5):1003­1026.

Oberfield, E. (2018). A theory of input-output architecture. Econometrica, 86(2):559­589.

Ramanarayanan, A. (2020). Imported inputs and the gains from trade. Journal of International Econo-
  mics, 122:103260.

Rosenstein-Rodan, P. N. (1943). Problems of industrialisation of eastern and south-eastern europe. Eco-
  nomic Journal, 53(210/211):202­211.

Smith, A. (1776). An Inquiry into the Nature and Causes of the Wealth of Nations, volume 1. Strahan
  and Cadell, London, UK.

Tintelnot, F., Kikkawa, A. K., Mogstad, M., and Dhyne, E. (2018). Trade and domestic production
  networks. NBER Working Paper No. 25120.

Yi, K.-M. (2003). Can vertical specialization explain the growth of world trade? Journal of Political
  Economy, 111(1):52­102.

Yi, K.-M. (2010). Can multistage production explain the home bias in trade?          American Economic
  Review, 100(1):364­393.

Young, A. A. (1928). Increasing returns and economic progress. Economic Journal, 38(152):527­542.

                                                   47
A      Cross Country Evidence on Production Specialization: 1997-
       2007
In the following, we use data from the Global Trade Analysis Project (GTAP) to provide some evidence
on production specialization between 1997 and 2007. We define production specialization in a country c
as any increase in the intermediates' share in production costs, i.e. c > 0.44 We denote the aggregate
change over a set of countries as

                                          =             [wc,07 c,07 - wc,97 c,97 ] ,                                   (A.1)
                                                   c

where the wc,t represent production cost shares used to weight across countries. For the 67 countries
available in the GTAP data we obtain an increase of 6.3 percentage points between 1997-2007 using ma-
nufacturing industries. We then decompose it into within and between country specialization as follows

                        =            ¯c [c,07 - c,97 ] +
                                     w                               ¯ c [wc,07 - wc,97 ] = 3.7 + 2.6,
                                                                     
                                 c                              c

                                          within                         between

where w ¯c = (wc,07 + wc,97 ) /2, ¯ c = (c,07 + c97 ) /2 denote the average weights. The within change
accounts for nearly 60% and the remaining reflects production re-allocation towards countries with higher
intermediate shares. The simple average of c across countries is only 0.4 percentage points. Thus
larger countries had larger increases in the intermediate share--suggesting a positive correlation between
size and production specialization. International trade is one channel in our model that expands market
size and access to inputs leading to increased specialization. Increases in specialization in this data are
                                                                                               m
strongly correlated with imported intermediates. To see this we run a panel regression of c      (the share
change within country and each of the 9 GTAP manufacturing industries, indexed by m) on mm           c (the
change of the imported fraction of intermediates at the same level) and obtain:
                                           m
                                           c = 0.49 · mm
                                                       c + ac + am .
                                                       (0.04)


This evidence rejects a constant intermediate share production function, and suggests that share is incre-
asing as imported intermediates are adopted.45


B      Two Stage Production
Our framework can be interpreted as a reduced form representation of alternative models of firm speci-
alization. Here we provide one where increases in market size or trade integration induce within firm
specialization in the sense of shifting its workers towards production of inputs (intermediates or tasks)
in which they are more productive. The production has two stages. In the first stage, labor produces
firm-specific inputs with the following technology

                                                    xt = zt lt ; t  0                                                  (B.1)
  44
      Intermediates share is defined as expenditure on intermediates over total production cost, which in GTAP includes pro-
duction costs on labor, capital, land, and intermediates.
   45
      To address the concern that some of the correlation is mechanical we also instrument mm    i with changes in tariffs and
find a similar result.


                                                                48
where zt is the productivity of each of the lt units of labor and, 0 denotes the set of n firm-specific inputs
that an unspecialized firm must produce. In the second stage, the unspecialized firm produces the final
good by aggregating labor and all n inputs with a constant returns to scale production:

                                         y () = l1-nd          (xt )d ,                                 (B.2)
                                                          t0

where nd  1. Firms are homogeneous in the production of first stage intermediates, but have heteroge-
neous assembly productivity in the second stage, captured by . We continue to assume a single type of
worker with wage w. Normalizing the units of the inputs such that t0 (zt )d = 1 we see that the unit
cost of production for the unspecialized firm is w/, as in the baseline model. Now allow a fixed cost of
f0 (fa )rd units of labor to replace r  n of the firm-specific inputs with the market bundle. This bundle
is similar to the baseline model: a CES aggregate of stage two goods in the economy with price equal to
P . Denoting the set of intermediates the firm remains specialized in by r , we can write the unit cost of
the firm as
                                            w1-rd P rd
                                  cr () =              , r = {0, . . . , n}                         (B.3)
                                           tr (zt )d
Thus the unit cost structure is the same as in the baseline model with the following interpretations. The
cost share of intermediates in the baseline model, r , is interpreted as the cost share of first stage inputs
no longer performed internally, rd. The "productivity boost" parameter r = tr (zt )d , captures the
productivity change from re-allocating workers in the first stage. We now summarize this and show how
firms re-allocate labor focusing on the case where firms can choose a single arbitrary r. Without loss of
generality we re-index inputs to be increasing in productivity, z1 < ... < zn .
Proposition B.1. The baseline model is equivalent to a production process where firms can adopt a
technology allowing them to outsource some first stage inputs. Firms that are sufficiently productive in
assembly,      ¯, specialize in inputs t  r = {t  0 |t > r} resulting in
    1. a re-allocation of labor away from the r least productive inputs and increase in productivity:
                 d              d
         tr (zt ) >     t0 (zt ) ;

    2. a cost share reduction of labor in production equal to rd;
                                                                    d     w rd
    3. a specialization premium: sr  c0 ()/cr () =          tr (zt )      P
                                                                                 .


C      Proof of Propositions
C.1     Proof of proposition 1
    1. Under costly specialization fI > f0 so firms specialize iff

                                   ~I > ~0  cI < c0  sI > 1  s1 > 1,

       where the first equivalence uses the definition of profits, the second one the definition of sI , and
       the third the constant increments assumption, which implies that sI = (s1 )I for any I  1.
    2. Using (10) we have that ¯i+1 > ¯i for all i iff
           fi+1           -1                     fi+1           fi+1 - fi             ^+ 1
                · s-
                   1
                     1
                               > 1  (s1 )-1 <          (s1 )-1            + 1  s1
                                                                                  -1
                                                                                     <f
            fi                                    fi               fi

                                                     49
      If s1 > 1 then at least some firms specialize (part 1), so for heterogeneous specialization we
      further require that the marginal producer to have lower profits under the most specialized available
      technology, n, relative to whatever other technology i < n the entrant choses. The condition is the
      same as that for sorting:

                                  ~n (¯i,e ) - ~i (  ¯i,e ) < w (fn - fi )                                  (C.1)
                                         ~ n (¯i,e )            fn            wfi
                                                      -1<           -1
                                         ~i ( ¯i,e )             fi        ~ i (¯i,e )
                                              ~n (   ¯i,e )   fn
                                                            <
                                              ~i (   ¯i,e )   fi
                                                       1-
                                        cn (¯i,e )                     fn           fi+1
                                                               <              ...
                                        ci (¯i,e )                    fn-1           fi
                                                                              n-i
                                             (sn-i )-1 < 1 + f
                                                             ^
                                               -1      n-i
                                            s1
                                                               <1
                                            1+f  ^

      The second line divides both sides by     ~i (¯i,e ) and re-arranges the terms, the third uses the marginal
      entry condition, wfi = ~ i (¯i,e ), the fourth uses the profit expressions, the fifth uses the definition of
      sI and the technology assumption for fi , the last one uses the constant share increment assumption
      and re-arranges. solving for s1 yields the condition in the proposition.

   3. From part 2 we see the entrant is indifferent or prefers n to any i iff the inequality is reversed in
      equation (C.1) and thus iff s  -1
                                         1+f    ^ where under equality we use the convention that n is
                                   1
      adopted.

C.2    Proof of Proposition 2
C.2.1 ~ in (13)
                                                  Yi
To obtain ~ we first derive an expression for     Y
                                                       and replace in ¯ at expression (12). The aggregate sales
of technology i firms is
                                               ¯i+1
                                  Yi = M               ~i ()dG()
                                             ¯i
                                                           ¯i+1
                                                                    ~i ()
                                     = M ~e (¯e )                            dG()
                                                          ¯i        ~e (¯e )
                                                     ¯i+1                    1-
                                                                  ci ()
                                     = M fe                                       dG()
                                                  ¯i             ce ( ¯e )
                                                          i+1¯
where the first line uses the definition Yi  M          ¯i
                                                              yi ()dG() and yi =        ~i under monopolistic
competition and CES. The second multiplies and divides by marginal entrant's profit. The third uses the
entry cutoff in (8) for ~e (¯e ) and the profit expression in (6), which implies that relative operating profits
                                                                                                                
depend only on relative unit costs. We then use the definition of unit cost in (3), definition s1 = w/ P
                                                                                                       
                                                                                                                   ,



                                                          50
and the technology assumption that i - e =  (i - e) to obtain
                                                                   ¯i+1                    -1
                                                                            (i-e)   
                                         Yi = M fe                        s1                    dG().                            (C.2)
                                                               ¯i                   ¯e
                                   n
Replacing this and Y =             i=0   Yi in (12), and cancelling common terms we have

                                                 n             (i-e)( -1)   ¯i+1  -1
                                                              s1           ¯i
                                                                                   dG()
                                       ¯=             i      n    (i-e)( -1)    ¯i+1  -1
                                                                                               ,
                                               i=0           i=0 s1            ¯i
                                                                               
                                                                                         dG( )
                                                                                          n      ¯i+1                            ^i
We then divide both the numerator and denominator by                                      i=0   i
                                                                                                ¯
                                                                                                        -1 dG (), and defining   ^
                                                                                                                                 
                                                                                                                                      
                                                                     1
   ¯i+1                      n          ¯i+1                         -1
  ¯i
          -1 dG () /         i=0       i
                                       ¯
                                               -1 dG ()                   we obtain (13).

          d ¯
C.2.2     ds1
                > 0 iff s1  s
   1. Necessity. If s1    / s there is homogeneous specialization (Proposition 1) and thus e = i for all i
      and thus ¯ = e . If s      -1
                                     1+f  ^ then e = n (Proposition 1) and is already at the maximum
                               1
      and can't increase with s1 . If s1 < 1 there is no adoption. Alternatively, we see from (14), derived
                  d ln  ~
      below, that d ln s1
                          = 0 if i = e for all i.

   2. Sufficiency. We show that both the intensive and extensive margin impacts in (14), derived below,
      are positive.

C.2.3     Deriving Multiplier Effect in (14)
We define the elasticity components in terms of each of the margins as follows:
                                                                                n
                                         d ln ¯     ln ¯                               ln ¯ d ln  ¯i
                                                 =                         +                         .                           (C.3)
                                         d ln s1    ln s1            ¯ie       i= e
                                                                                       ln ¯i d ln s1
                                                              intensive                  extensive

First, we express the intermediate cost share as
                                   n                   n                                                n
                        ¯
                                         i i =               i [e + (i - e) ] = e +                           (i - e)i ,         (C.4)
                                i= e                  i= e                                             i= e

                                                     n
where for the last equality we use                   i=e   i = 1. Using (C.2), we re-express i as

                                          Yi                   Yi (¯e )-1 /(M Fe )                             ~i
                                                                                                               Y
                            i             n           =                                                                   ,
                                          r =e   Yr           n
                                                              r=e Yr ( ¯e )-1 /(M Fe )                         n
                                                                                                               r=e
                                                                                                                     ~r
                                                                                                                     Y
                       -1                                   ¯i+1
where Y~i  Yi (  ¯e )
                M Fe
                            = (s1 )(i-e)(-1)               ¯i
                                                                   -1 dG(). Using expression (C.4), we can simplify the
multiplier effect to
                                                                     n                          ~i
                                                 d ln ¯    1                               d ln Y
                                                         =                i (i - ¯)                ,                             (C.5)
                                                 d ln s1   ¯        i=e
                                                                                           d ln s1


                                                                          51
and we provide the details in the online appendix. We further decompose the effects on sales into the
intensive and extensive margins:

                                           ~i       ~i                      n         ~i d ln 
                                      d ln Y     ln Y                              ln Y       ¯j
                                              =                       +
                                      d ln s1    ln s1                     j =e
                                                                                   ln ¯j d ln s1
                                                                ¯ie
                                                                                  n        ~i d ln 
                                                                                        ln Y       ¯j
                                                  = ( - 1)(i - e) +                                   .
                                                                                j =e
                                                                                        ln ¯j d ln s1

Substituting the above expression into (C.5) and further simplifying the multiplier effect we obtain (14)
in the last equality:
                                           n                            n                        n         ~i d ln 
                  d ln ¯    -1                             1
                                                           2                                            ln Y       ¯j
                          =                    i (i - ¯) +                    i (i - ¯)                                  ,
                  d ln s1   ¯           i=e
                                                           ¯           i= e                     j =e
                                                                                                        ln ¯j d ln s1

and we provide the details of the derivation in the online appendix.

C.2.4    Positive Intensive Margin in (14):
        n
 -1
 ¯      i=e   i (i - ¯ )2 > 0 from inspection since  > 1.

C.2.5    Positive Extensive Margin in (14):
             ~i from (C.2) to simplify the extensive margin as
We use sales Y
                    n                  n           ~i d ln 
                                                ln Y       ¯j
                         (i - ¯ ) i
                  i= e                j =e
                                                ln ¯j d ln s1
                                (e -       ¯ ) ( ¯e ) g ( ¯e ) d ln ¯e
              =-          n                          ¯i+1  -1
                          i=e (s1 )
                                   (i - e)(  - 1)
                                                    ¯i
                                                          dG() d ln s1
                         n
                          (i-1 - ¯ ) (s1 )(i-e-1)(-1) - (i -       ¯ ) (s1 )(i-e)(-1)               d ln ¯i
                  +                n                        ¯i+1  -1                  (¯i ) g (¯i )         ,
                    i=e+1          i=e (s1 )
                                            (i - e)(  - 1)
                                                           ¯i
                                                           
                                                                 dG()                               d ln s1

and we provide the details of derivation in the online appendix. Observe that the first term is positive as
e <  ¯ and   ln ¯e
            ln s1
                   > 0. The second term can be expressed as
              n
                         (s1 )(i-e-1)(-1) (   ¯i ) g (¯i )                                 d ln ¯i
                         n                 ¯i+1  -1        (i-1 - ¯ ) - (i - ¯ ) (s1 )(-1)
            i=e+1        i=e (s1 )
                                   ( - 1)
                                          ¯i
                                          
                                                dG()                                       d ln s1
              n
                          (s1 )(i-e-1)(-1) (   ¯i ) g (¯i )                           ¯
                                                                                             ¯           d ln ¯i
        =                n                 ¯i+1  -1                   i-1-              - i-   (s1 )(-1)
            i=e+1        i=e (s1 )
                                   ( - 1)
                                          ¯i
                                          
                                                dG()                                                     d ln s1
              n
                          (s1 )(i-e-1)(-1) (   ¯i ) g (¯i )           ¯
                                                                               ¯                                        d ln ¯i
        =                n                 ¯i+1  -1                     -i+1 -   - i (s1 )(-1)                      -
            i=e+1        i=e (s1 )
                                   ( - 1)
                                          ¯i
                                          
                                                dG()                                                                    d ln s1




                                                                      52
Next, we show that for each i  e + 1,
                                   ¯        ¯                               d ln ¯i
                                     -i+1 -   - i (s1 )-1               -              > 0.                           (C.6)
                                                                            d ln s1

Using the expression for productivity thresholds, the effect of premium on cutoff is

                         d ln ¯i       (s1 )-1                   ¯ - e
                                                                 
                                 =-        -1
                                                 - (i - e - 1) +       ,              i  e + 1,
                         d ln s1    ( s1 )    -1                   

showing that d   ln ¯i
               d ln s1
                        is decreasing in i and d ln ¯n
                                               d ln s1
                                                       < 0. Thus, there exists some b  [e, n - 1] such that
d ln ¯b         d ln  ¯b+1
d ln s1
        > 0 and d ln s1 < 0. This implies that

                                              d ln ¯i   > 0 if i  b
                                                                        .                                             (C.7)
                                              d ln s1   < 0 if i  b + 1

We derive in the online appendix that the definition of b implies the following two expressions:
                                                             ¯
                                   d ln ¯b             -1    
                                                               -b+1
                                           > 0  (s1 )     >    ¯     ;
                                   d ln s1                     
                                                                 -b
                                d ln  ¯b+1        ¯                    ¯
                                           <0         - b - 1 (s1 )-1 < - b.
                                 d ln s1                               
                                                                                             ln ¯i
last, we divide into two cases to show that (C.6) holds. Case 1: If i  b, then               ln s1
                                                                                                     > 0. Moreover,
                                                                                        ¯
              ¯        ¯               ¯
                                                ¯
                                                                                            -i+1
                -i+1 -   - i (s1 )-1 <   -i+1 -   -i                                    
                                                                                            ¯              = 0,
                                                                                            
                                                                                              -i
                                                                      ¯           ¯
                                                                        -b+1        -i+1
where the inequality uses      ¯
                               
                                   -i     ¯
                                          
                                          
                                              - b > 0 and (s1 )-1 >   
                                                                        ¯
                                                                          -b
                                                                                  
                                                                                    ¯
                                                                                    
                                                                                      -i
                                                                                            for i  b. Thus,
                                                                                    


                                   ¯        ¯                               d ln ¯i
                                     -i+1 -   - i (s1 )-1              -              > 0.
                                                                            d ln s1
                                                   <0                        <0

                                ln ¯i                                                                  ¯
Case 2: If i  b + 1, then       ln s1
                                        < 0. We divide this scenario into two subcases: (a) If         
                                                                                                           - i < 0, then

                   ¯        ¯                 ¯
                     -i+1 -   - i (s1 )-1 = -   -i                          (s1 )-1 - 1 + 1 > 0
                                              
                         ¯
as s1 > 1. (b) Else if   
                             - i  0, then
                                                                                        ¯
              ¯        ¯               ¯
                                                ¯
                                                                                            -i+1
                -i+1 -   - i (s1 )-1 >   -i+1 -   -i                                    
                                                                                            ¯              = 0,
                                                                                            
                                                                                              -i




                                                          53
                                                                    ¯              ¯
                                                                      -b             -i+1
where the inequality uses        ¯
                                 
                                     - i  0 and (s1 )-1 <         ¯
                                                                    -
                                                                    
                                                                      b-1
                                                                                   
                                                                                     ¯
                                                                                       -i
                                                                                              for i  b + 1. Thus,
                                                                                     


                                     ¯        ¯                                           d ln ¯i
                                       -i+1 -   - i (s1 )-1                         -                 >0
                                                                                          d ln s1
                                                    >0                                     >0

for both subcases.

C.3      Proof of Proposition 3
C.3.1    Derivation of ¯e in (17)
Recall that ~ () =    ~i () - fi for   e so we rewrite each of these terms in (15) starting with the
average profits in each i technology.
                             ¯i+1                                     ¯i+1
                                                                             ~i ()
                                     ~i ()dG() = ~e (¯e )                              dG()                                  (C.8)
                            ¯i                                    ¯i         ~ e (¯e )
                                                               ¯i+1                 1-
                                                                        ci ()
                                                   = fe                                    dG()
                                                           ¯i          ce ( ¯e )
                                                            ¯i+1                        -1
                                                                        (i-e)
                                                   = fe                  s                    dG()
                                                           ¯i          ¯e 1
                                                                       
                                                                                   ¯i+1              -1
                                                                                            
                                                   = fe (s1 )(i-e)(-1)                                    dG()
                                                                               ¯i           ¯e

The first line multiplies and divides by marginal entrant's profit. The second uses the entry cutoff in (8) for
~e (¯e ), the profit expression in (6), which implies relative operating profits depend only on relative unit
                                                                                                 
costs. The third uses the definition of unit cost in (3), of s1 = w/ P 
                                                                            and the technology assumption
that i - e =  (i - e). The last line factors out s1 . Second, using part 2 of technology assumption
1, f  i+1
          =f^ for all i, we have fi = fe (1 + f^)i-e . Thus, replacing this expression for fi and substitute
     fi
expression (C.8) in (15) we obtain
              e+I                         ¯i+1            -1                    ¯i+1
                                                                                            ^)i-e dG() = fE /fe
                     (s1 )(i-e)(-1)                            dG() -                  (1 + f                                (C.9)
              i= e                       ¯i        ¯e                         ¯i


Further replacing  ¯i>e  ¯i>e (     ^, s1 ) in the above expression we obtain the implicit solution for the
                               ¯e , f
entry cutoff in (17).

                     d¯e
C.3.2    Proof of    ds1
                           > 0 iff s1  s
   1. Necessity. If s1 / s there is homogeneous specialization (proposition 1) and thus e = i for all i.
                                                          -1
                                                                                       fE
        Expression (C.9) reduces to           ¯e    ¯e
                                                                - 1 dG() =             fe
                                                                                          ,   which is independent of s1 .

   2. Sufficiency. We can apply the implicit function theorem to (C.9) along with the equilibrium adop-
      tion cutoffs to establish d ¯e
                                ds1
                                     > 0 for s1  s. We take an alternative approach below: to derive and
      differentiate the equivalent expression, (16).

                                                                 54
                                                               d ln ¯e
C.3.3   Derivation of (16) and elasticity                      d ln s1
                                                                         in (18)
We proceed in three steps:

   1. Rewrite free entry in (15) as a function of ¯i to obtain (16);

   2. Take the derivative of (16) with respect to ¯i .
                                                                                                                            d ln ¯e
   3. Use the solutions for ¯i and their change in terms of s1 and ¯e , then simplify to obtain                             d ln s1
                                                                                                                                    .

To derive (16), we first rewrite the aggregate fixed cost component in (15). Defining Fi+1  fi+1 - fi ,and
the operating cost for non-adopters as Fe = fe we have
                       n         ¯i+1                         n      ¯i+1
                                                                             i                     n      
                                          fi dG() =                                Fr dG() =                  Fi dG(),            (C.10)
                    i= e        ¯i
                                                             i= e   ¯i      r=e                   i= e   ¯i
                                                                                                         

                                                       i
where the first equality uses fi =                     r=e   Fr and n = e + I . Using the expression for relative cutoffs, in
the online appendix we show that
                                                 -1
                                          ¯i                -1             -1                            Fi
                                                       = s1    -1               ( s-1 (i-e-1)( -1)
                                                                                   1 )                        .                   (C.11)
                                          ¯e                                                             Fe

Replacing this in the average profit component derived in (C.8) for i > e and simplifying we obtain the
first equality below
                           n                                ¯i+1            -1
                                                                    
                  fe            (s1 )(i-e)(-1)                                   dG()                                             (C.12)
                        i= e                            ¯i          ¯e
                           ¯e+1                  -1                                  n         ¯i+1             -1
                                                               s1 -1                                     
                =fe                                    dG() + -1          Fi                                         dG()
                           ¯e             ¯e                 s1 - 1 i=e+1                    ¯i
                                                                                                         ¯i
                    n                                  -1
                                               
                =          Fi                               dG()
                    i=e              ¯i        ¯i

The second equality requires additional algebra (provided in the online appendix). It relies on rewriting
the expressions so that we compute the average incremental profits if all firms above a certain ¯i upgrade
                                                       -1
                                          
to the next technology, Fi   ¯i   ¯i
                                         dG(). Subtracting (C.10) from (C.12) and equating to fE we
have the version of free entry in (16). Then we differentiate (16) with respect to each ¯i and obtain
                                                n                            -1
                                                       Fi            
                                                                                   dG() d¯i = 0,                                  (C.13)
                                               i= e
                                                       ¯i     ¯i     ¯i




                                                                           55
where we use the Leibniz integral rule for each technology i to obtain
                                                 -1
                                      
                    d Fi                              - 1 dG()
                            ¯i        ¯i
                                       -1                                                     -1
                                 ¯i                       -1                            
                  =Fi -                     - 1 g (¯i ) -                                          dG() d¯i
                                 ¯i                       ¯i                ¯i
                                                                                        ¯i
                                                        -1
                         -1                      
                  = - Fi                                     dG() d¯i .
                         ¯i           ¯i         ¯i

                                                  -1
                                           ¯i
After that, we obtain d¯i by using         ¯e
                                                       in (C.11):

              ¯i       ¯i
      d¯i =      d¯e +    ds1                                                                                                 (C.14)
              ¯e       s1
                                                            1
                                                                                              -1
              -1
                          1                           Fi    -1                             s
          = s1   -1      1-
                              (s- 1 (i-e-1)
                                1 )                              d¯e - ¯e s-
                                                                           1
                                                                             1              1
                                                                                           -1     + (i - e - 1) ds1 .
                                                      Fe                                s1     -1

Substituting d¯i into (C.13), and after some algebraic manipulation (provided in the online appendix),
we obtain
                                                                               -1
                                 n                        (i-e)( -1)  ¯i+1 
                    d ln ¯e      i=e+1 F e ( i - e)(s 1 )            ¯i
                                                                           ¯e
                                                                           
                                                                                  dG()
                            =                                       -1
                                                                                       .       (C.15)
                    d ln s1                    n                
                                               i=e Fi      ¯i   ¯i
                                                                        dG()

Finally, to obtain the elasticity in (18) we use the expression for aggregate sales of technology i firms, Yi ,
derived in (C.2). Substituting it into (C.15) we can further simplify the selection effect to
                                                  n                              n
                              d ln ¯e             i=e+1 (i - e)Yi       1        i= e    (i - e)Yi
                                      =               n               =                 n
                              d ln s1                 i=e Yi                            i= e Yi
                                            ¯ - e
                                            
                                       =          ,
                                              
                                                                                                          n
                                                                                                                   i Yi
where the last equality uses technology assumption 1: i - e = (i - e) , and ¯                             i=e
                                                                                                              Y
                                                                                                                          .

C.4    Proof of Proposition 4
   1. Existence requires Ps (s1 ) = P  ~ (s1 ) for some s1 and follows from (i) the continuity of Ps (guaran-
                                      ~
      teed by its definition) and of P (s1 ) over all s1 (proved in lemma C.4) (ii) Ps  (0, ) and steeper
      than P~ (s1 ) at both extremes of s1 i.e. for s1 / s, which implies some s        ~ (~
                                                                                 ~ s.t. P  s, x) = Ps (~
                                                                                                       s, x). If
                                           min                 max
      there are multiple s ~ then define s~ = min s    ~ and s
                                                             ~     = max s~ and note that the slope condition
      below implies that
                                            ~ (s, x) < Ps (s, x)
                                            P                                      ~min ,
                                                                            if s < s                                          (C.16)
                                            ~ (s, x) > Ps (s, x)
                                            P                                      ~max .
                                                                            if s > s                                          (C.17)




                                                                 56
     We prove it by deriving the relationship between the slopes:

                                        d ln Ps   1   n  d ln P~ ( s1 / s)
                                                =- <-                                                              (C.18)
                                        d ln s1               d ln s1
     where the first equality uses (23), the second uses n < 1. The third relies on the results in
     lemma C.4 (below) showing that in the range of s1 with homogenous specialization there is no
                                                                                            ~ (s1 1)
     selection or endogenous multiplier effect of s1 . Thus, using (21) we obtain d lndPln      s1
                                                                                                      = -e, the
     marginal producer's technology. Lemma C.4 (below) shows this is equal to the minimum available
                                                                                   ~ 1
     technology share unless there is full specialization in which case it is d ln P (sd / s & s1 >1)
                                                                                         ln s1
                                                                                                       = -n =
                                                          ~ (s1 1)
                                                     d ln P
     - n . If the minimum share is zero then             d ln s1
                                                                     = 0, as depicted in Figure 4.

2.    (a) The argument is similar for either parameter x. An equilibrium with ¯ = 0 exists if there is
          some x such that
                                         P~ (s1 , x) = Ps (s1 , x) , s1  1.                    (C.19)
          If it exists then it must be unique since in part 1 expression (C.18) we have shown that Ps
          is steeper in that range than P ~ , which implies stability, defined as starting from any other
          s1 in that range of x and returning to the same equilibrium. If s1  1 then         ¯ = 0 , and
           ¯e (s1 ) =   ¯e is independent of s1 , L, and  (it depends only on fixed costs, productivity
                                                                                              -1
                                                                                        
          distribution, and  from the free entry condition fe                 ¯e        ¯e
                                                                                                   - 1 dG() = fE ). Thus,
          we obtain a critical x
                               ~0 (L or ) below which an equilibrium exists.
                                          1                              1
                                 fe       -1       -1                    -1
                                                                                                       -1
                                                1-    ¯ (s1 )                 (se
                                                                                1 ¯e (s1 ))-1 = s1 
                                 ~L                
                                                   1                           1
                                           fe      -1       -1                 -1
                                                                                                       -1
                                                         1-    0                       (se
                                                                                         1 ¯e )-1 = s1 
                                           ~L               
                                                    1                           1
                                           fe       -1       -1                 -1
                                                                                                      e- 1
                                                          1-    0                      (¯e )-1 = s1      

                                           ~L                
                                                    1                              1
                                           fe       -1    -1       -1
                                                       1-     0       ( ¯e )-1  1
                                           ~L               
                                                ~ 0  fe 1 -  - 1 0 (
                                                L                      ¯e )1-  L
                                                     ~       

          where we use s1  1 and e - 1     
                                             < e - n = e - n < 0. A similar definition can be obtained
                           1                 1                                                   ~ (s1 s)
          for ~0  fe -1 1 - -1 0 -1 (
                     ~L              
                                                 ¯e )-1 and so we denote either by x~0 . If d lndPln s1
                                                                                                          > -1 
          then the critical value in 2(a) is x0 = x~0 since at s1 = 1 we have P ~ (1, x
                                                                                      ~0 )  Ps (1, x    ~0 ) and
          the continuity along with this slope condition implies that
                                               ~ (s1 , x
                                               P       ~0 ) > Ps (s1 , x
                                                                       ~0 ) , s1 > 1.                              (C.20)
                             ~ (s1 s)
                        d ln P
          However, if       d ln s1
                                         -1
                                          
                                            then there may exist other equilibria with ¯ > 0 and s1 >1
          such that
                                               ~ (s1 , x
                                               P       ~ 0 ) = Ps ( s 1 , x
                                                                          ~0 ) , s1 > 1.


                                                          57
        We can then lower either x untill we satisfy expression (C.20) with equality and we denote
        the value of either x as x        ^0 . Such x
                                                    ^0 exists because (i) Decreases in L leave Ps schedule
                                                                         ~ (s1 ,L)
        unchanged but shift P         ~ schedule up proportionally (  ln P          = 1-   1
                                                                                               since neither  ¯ (s1 )
                                                                         ln L                
        nor  ¯e (s1 ) depends on L except via s) (ii) Decreases in  leave P           ~ schedule unchanged but
                                                         ln Ps
        shift Ps schedule down proportionally (  ln  = 1) The above implies that x                 ^0 still satisfies
        P~ (s1 , x                  ^0 ) with s1  1. Thus, we have x0 = min {x
                 ^ 0 ) = P s ( s1 , x                                                   ~ 0 }.
                                                                                   ^0 , x
    (b) The argument is similar to 2(a) but the critical values are now defined by
                                      1                              1
                                fe    -1        -1                   -1
                                                                                                          -1
                                             1-    ¯ ( s1 )               ( se
                                                                             1 ¯e (s1 ))-1 = s1 
                                ~L              
                                               1                           1
                                      fn       -1        -1                -1
                                                                                                          -1
                                                      1-    n                   ( sn
                                                                                   1 ¯n )-1 = s1 
                                      ~L                 
                                                1                             1
                                       fn       -1           -1               -1
                                                                                                     n- 1
                                                          1-    n                  (¯n )-1 = s1         

                                       ~L                    
                                                1                             1                                    n-1/
                                       fn       -1           -1               -1
                                                                                          -1      ^                  -1
                                                          1-    n                  (¯n )        1+f
                                       ~L                    
                                                                                        1-n
                      ~ n  fn                 -1
                                                    ¯n )1- 1 + f
                                                                                          
                      L                1-        n (           ^                                L,
                           ~                  
                                                                                         -1
                                                                                   
        where ¯n is from the free entry condition fn                    ¯n         ¯n
                                                                                              - 1 dG() = fE , while the
                                                1
                                                -1
                                ^
        inequality uses s1  1 + f                    under full specialization and n - 1 < n - n = n - n = 0.
                                                                                       
                                                                                                          1-n
                                                     1                     1                               ( -1)
        Similarly, we obtain ~n 
                                             
                                             fn
                                             ~L
                                                     -1
                                                           1-    -1
                                                                 
                                                                    n      -1
                                                                                (¯n )-1 1 + f
                                                                                            ^                      and so we denote
                                 ~ (s1 s)
                  ~n . If
        either by x         d ln P
                                            > -1 then the critical value in 2(b) is xn = x        ~ (s1 , x
                                                                                         ~n since P       ~n ) 
                                d ln s1        
                                                   1
                                                   -1
        Ps (s1 , x                  ^
                 ~n ) when s1 = 1 + f                     and the continuity along with this slope condition implies
                                                                                                 1
                                                                                                 -1
                                                                   ^
             ~ schedule remains below Ps schedule for all s1 < 1 + f
        that P                                                                                        .

                                                                                                1
                                                                                                -1
                                      ~ (s1 , x
                                      P       ~n ) < Ps (s1 , x               ^
                                                              ~n ) , s1 < 1 + f                       .                      (C.21)

                            ~
                           (s1 s)
        However, if d lndPln s1
                                   -1
                                    
                                      then there may exist other equilibria with ¯ < n . Suppose that
        is the case, so we have some s1 such that
                                                                                                1
                                                                                                -1
                                      ~ (s1 , x
                                      P       ~ n ) = P s ( s1 , x               ^
                                                                 ~n ) , s1 < 1 + f                    .

        Following similar reasoning as in part 2(a), we can then increase either x until we satisfy
        (C.21) with equality and we let x
                                        ^n denote the value of either x that does so. Thus, we have
        xn = max {x      ~ n }.
                    ^n , x

3. Start with an economy where x = x
                                   ~n as defined in 2(b) so we have an equilibrium with ¯ = n ,


                                                             58
                           1                                1
                           -1                               -1
               ^                . If as s-    ^
      s
      ~1 = 1 + f                         1  1+f                      we have

                  ~ (x,s1 )
             d ln P
       (a)      d ln s1
                        > (<) - 1
                                  then a decrease (increase) in x generates an equilibrium with s1  s by
                      ~ schedule up (down) or Ps schedule down (up).
             shifting P
                  ~ (x,s1 )
       (b)   d ln P
                       = -1                                                                ~ and Ps
                                         ~n there are multiple equilibria with s1  s since P
                             then at x = x
                d ln s1     
             overlap over some range

      A similar argument applies if we start at x = x        ~0 , where now the slope is evaluated at s+1  1:
             ~ (x,s1 )
        d ln P
      if d ln s1 > (<) - 1          
                                     , then an increase (decrease) in x yields a heterogeneous specialization
      equilibrium. To show the range where it exists is x  [x0 , xn ] we first define the two endpoints.
      Let x0 be the point such that there is a unique no specialization equilibrium for x  x0 , and xn
      be the point such that there is a unique full specialization equilibrium for x  xn . The knife edge
                         ~ (x,s1 )
      cases with d ln   P
                       d ln s1
                                   = -1
                                         at x = x~n are in this range. To see that there exists a heterogeneous
                                                       ~ (x,s1 )
                                                  d ln P                              ~ (x,s1 )
                                                                                 d ln P
      specialization equilibrium under               d ln s1
                                                                     < -1
                                                                        
                                                                          : If      d ln s1
                                                                                                  < -1
                                                                                                     
                                                                                                       at s+
                                                                                                           1  1 then from 2(a)
                                                                                                                      ~ (x,s1 )
                                                                                                                 d ln P
      there is some other equilibrium with s > 1 for x  [x0 , x
                                                              ~0 ). On the other hand if                            d ln s1
                                                                                                                                  < -1
                                                                                                                                     
                                 1                                                                                       1
                                 -1                                                                                      -1
      at s-    ^                                                                                  ^
          1  1+f                      then from 2(b) there is some other equilibrium with s < 1 + f                           for x 
                                       ~
       xn , xn ]. Finally if d ln
      (~                          P (x,s1 )
                                d ln s1
                                            > -1
                                               
                                                 at both limits then a heterogeneous specialization equilibrium
      exists for some x  (x0 , xn )
                                              d ln P~
   4. In part 1 we have shown that            d ln s1
                                                        > -1
                                                           
                                                             for s1 / s and in 2(a) and 2(b) that ¯ is independent
                                              d ln P             ~
      of x and thus non-decreasing in it. If d ln s1
                                                     > -1
                                                             for s1  s then from part 2 we have x0 = x    ~0
      and xn = x ~n and the equilibrium starting at either value is unique. We now show that is also the
      case for values in between. Suppose we start at x~n , then reductions in x reduce s
                                                                                        ~1 (part 3) and thus
                                                                                      ~
                                                                                 d ln P
      ¯ locally, we can apply same argument at new equilibrium as long as d ln s1         > -1 
                                                                                                 and thus  ¯
                                                                                                            s
                                                                                                            ~1
      continues to fall until x
                              ~0 .

The price schedule is continuous for all s1  (0, ).
Proof. We show first that the price schedule is continuous under homogenous specialization: s1 / s. We
can express the price schedule as

                                        -1 1/(1- )
                   
                    Lf
                         ~
                          e
                            1 -   -1
                                  
                                      e             · ( se
                                                         1 ¯e (s1 ))-1 if s1  (0, 1)
        P~ (s1 ) =                                                                       1
                                  -1    -1 1/(1- )                  -1                ^  -1
                    L f
                         ~
                            1 -   
                                                   · (s n
                                                          
                                                        1 e¯ (s 1 ))   if s 1     1 + f     ,
                          n



The derivative with respect to specialization premium is

                                       -e - d ln  ¯e (s1 )
                                   
                          ~                                  if s1  (0, 1)
                     d ln P (s1 )              d ln s1
                                                                                 1
                                 =                                           ^ -1 , 
                       d ln s1      -n - d ln      ¯e (s1 )
                                                d ln s1
                                                             if s 1      1 + f
                                   
                          ~ (s1 )  -e if s1  (0, 1)
                     d ln P                                           1
                                 =                                 ^  -1       ,
                       d ln s1      -n if s1                1+f          ,


                                                                      59
where the last step observes that under both no specialization and full specialization there are no selection
effect so that d ln  ¯e (s1 )            ~ (s1 ) is continuous under homogeneous specialization. Under hete-
                              = 0. Thus, P
                  d ln s1
                                                              1
                                                              -1
rogeneous specialization s1                             ^
                                                 1, 1 + f           , differentiate the price index expression with respect to
s1 we have
                                                                                 1
                                   ~ (s1 )
                              d ln P          d ln                    -1         -1            d ln  ¯e (s1 )
                                           =                       1-    ¯            -e-
                                d ln s1      d ln s1                                              d ln s1
                                   ~ (s1 )            -1
                              d ln P            1     
                                                         ¯ d ln 
                                                                  ¯      ¯ - e
                                                                         
                                           = -          -1           -e-
                                d ln s1        -11-        ¯ d ln s1       
                                   ~ (s1 )
                              d ln P               ¯       d ln ¯    ¯
                                           = -                     - ,                                                 (C.22)
                                d ln s1         - ( - 1)¯ d ln s1    

where the second step uses d ln      ¯e (s1 )
                                  d ln s1
                                              = ¯ - e
                                                  
                                                      . Because the intermediate cost share is increasing in
                           d ln ¯
specialization premium, d ln s1 > 0, the price schedule is decreasing in s1 and continuous over s1  s.
Last, the price schedule is continuous at s1 = 1 (from no specialization to heterogeneous specialization)
                               1
                               -1
and s1 =               ^
                     1+f            (from heterogeneous specialization to full specialization). The intuition is that
when      s+
           1      1, all firms use the least specialized technology as no firms have incentive to adopt, so it
                                                                                                          1

collapses to the no specialization equilibrium. Conversely, when           1+f    ^ -1 , all firms adopt the
                                                                                      s-
                                                                                       1
most specialized technology so that it becomes the full specialization equilibrium. To prove this it is
sufficient to show that both ¯ (s1 ) and ¯e (s1 ) are continuous at those points.
                                                                      1

Continuity of    ¯ (s1 ) at s1 = 1 and s1 = 1 + f ^  -1
First note that lims-1 1
                           ¯ (s1 ) = e and lim +        1
                                                    ^) -1
                                                          ¯ (s1 ) = . Under heterogeneous specialization,
                                                          
                                              s1 (1+f


                                                   -1                             i-e-1
                                          ¯i                   ^
                                                               f       1+f ^
                                                        =                                  ,   i > e.
                                          ¯e              (s1 )-1 - 1 (s1 )-1

                         ¯i
Therefore, lims+  1 1   ¯e
                             =  so that no firms adopt more specialized technology. This implies that
                                                                                                       n
lims+
    1 1
         i (s1 ) = 0 for i > e and lims+   1 1
                                                  e (s1 ) = 1 so that lims+  1 1
                                                                                  ¯ (s1 ) = lims+
                                                                                                1 1    i=e i (s1 )i =
e . Thus, lims+1 1
                      ¯ (s1 ) = lims- 1 1
                                          ¯ (s1 ) = e so that 
                                                                 ¯ (s1 ) is continuous at s1 = 1.
                                  ¯i
Similarly, lim -              1
                          ^) -1   ¯e
                                      = 1 so that all firms adopt the most specialized technology. This
                s1 (1+f
implies that lim -               1    (s ) = 0 for i < n and lim -
                              ^) -1 i 1
                                                                                             1  (s ) = 1 so that
                                                                                          ^) -1 n 1
                    s1 (1+f                                                     s1 (1+f
                                                       n
lim -      ^
              1    ¯ (s1 ) = lim -           ^
                                                 1
                                                       i=e i (s1 )i = n .          Thus, lim -           1
                                                                                                     ^) -1
                                                                                                            ¯ ( s1 ) =
   s1 (1+f )  - 1                    s1 (1+f )   - 1                                           s1 (1+f
                                                                                                1
                                                                                                -1
lim                   1    ¯ (s1 ) = n so that                                   ^
                                               ¯ (s1 ) is continuous at s1 = 1 + f                   .
     s+    ^
      1 (1+f )
                      -1
                                                                       1
                                                                       -1
Continuity of                                 ^
              ¯e (s1 ) at s1 = 1 and s1 = 1 + f                             .
                                     d ln  ¯e (s1 )
First note that lims-
                    1 1                 d ln s1
                                                      = 0 and under heterogeneous specialization, we have shown that
d ln  ¯e (s1 )       ¯ (s1 )-e
                     
   d ln s1
                 =        
                               .    Applying the continuity of ¯ (s1 ) we get differentiability of ¯e (s1 ) at s1 = 1,



                                                                      60
                                                                                                                1
                                                                                                                -1
therefore, ¯e (s1 ) is continuous at s1 = 1. For the continuity of                      ^
                                                                   ¯e (s1 ) at s1 = 1 + f                            we use the
                                                                      1
                                                                      -1
free entry condition. First note that for s+        ^
                                           1  1+f        the free entry condition is the full specializa-
tion case
                                                 -1
                                             
                                  fn                - 1 dG() = fE ,
                                       ¯n    ¯n
                        1
                        -1
and for s-    ^
         1  1+f              the free entry condition is the heterogeneous specialization case

                                  n                            -1
                                                       
                                       Fi                           - 1 dG() = fE .
                                 i=e         ¯i        ¯i

We have shown that lim                 1    ¯i = ¯n for i < n. Therefore, taking the limit of the free entry
                         s-    ^ -1
                          1 (1+f )
condition we have
                                            n                          -1
                                                                
                              lim                 Fi                        - 1 dG() = fE
                         s-
                                       1
                               ^  - 1 i= e             ¯i       ¯i
                          1 (1+f )

                                                               -1                n
                                                       
                                                                    - 1 dG()           F i = fE
                                            ¯n         ¯n                        i=e
                                                                       -1
                                                               
                                                  fn                        - 1 dG() = fE ,
                                                       ¯n      ¯n
                                                                       1                                1
                                                                       -1                               -1
so the two free entry conditions with s-                      ^             and s+          ^
                                       1                    1+f                  1        1+f                are the same and
                                                                                              1
                                                                                              -1
therefore yield the same ¯n , indicating that                              ^
                                              ¯n is continuous at s1 = 1 + f                       .

In an equilibrium with heterogeneous specialization the marginal producer uses the least intermediate
intensive technology available, i0 .
                                                                                ^). The marginal
Proof. From proposition 1 we have heterogeneous specialization iff s-1  (1, 1 + f
producer has productivity threshold given by
                                                        wfi                      -1
                                      (¯i,e )-1 =           · P 1- · ws-
                                                                       1
                                                                         i
                                                        ~X
suppose that the producer is just indifferent between technology i and i - 1. This implies a full speciali-
zation equilibrium because
                                                         -1                     -1
           (¯i,e )-1 = (¯i-1,e )-1  fi s-
                                        1
                                          i
                                                              = fi-1 s-
                                                                      1
                                                                        i- 1
                                                                                      (s1 )-1 = 1 + f
                                                                                                    ^ .

We can continue applying this argument until we reach i = i0 + 1 to derive that under heterogeneous
specialization e = i0 .




                                                              61
C.5    Inefficiency
We provide details on how Figure 7 is constructed. We first show that at s1 = smax the price schedule is
steeper at the left limit. Second, we derive the price schedule when only the most specialized technology
is available. In the proof of Lemma C.4 we show that the price schedule and aggregate intermediate share
(¯ ) are continuous at s1 = smax , and the slope of the price schedule is
                              ~ (s1 )
                         d ln P                 - -(¯
                                                          d ln  ¯
                                                                  -    ¯
                                                                             if s1  (1, smax )
                                                     -1)¯ d ln s1      
                                      =
                           d ln s1              -n                           if s1 > smax .

Therefore,
                        ~ ( s1 )
                   d ln P                     d ln ¯                                                 ~ (s1 )
                                                                                                d ln P
             lim                 =-                                          -    < -n = lim                 ,
               -
         s1 smax     d ln s1         - ( - 1) d ln s1             s1 =s-
                                                                       max
                                                                                        s1 s+
                                                                                            max   d ln s1

where the inequality uses the fact that the multiplier effect is positive under heterogeneous specialization
 d ln ¯
d ln s1
        > 0, and by definition   n . Thus, the slope of price schedule is steeper left of smax for some s1 .
Next we derive the price schedule when there is only the most specialized technology available and show
that it coincides with the one under endogeneous specialization with s1 > smax . Specifically, we express
the equilibrium of this single-technology economy in terms of the specialization premium defined in our
model. Note that all firms in this single-technology economy have the following unit cost function:

                                                         w1- P    P
                                               c() =            =   ,                                            (C.23)
                                                                  
with fixed cost fn and wage normalized to w = 1. The price schedule can be derived from the zero profit
condition for entrants (¯spec )
                                                              1

                                      spec   P        fn      -1
                                     ¯     =                     ,                              (C.24)
                                             P     ~ Y spec
                          -1  -1
where Y spec = L 1 -      
                                   = La
                                      ¯ is total sales. Thus, the price schedule is
                                                                                  1

                                        ~ spec 1-             1         fn        -1
                                    (P          )     =                                 .                        (C.25)
                                                          ¯spec 
                                                                       ~ La
                                                                          ¯

                                                     1                 /n
Using the definition of specialization premium, s1   P                       , (C.25) becomes
                                                                                   1

                                        spec                 1          fn         -1
                                    P          ( s1 ) =                                 ,                        (C.26)
                                                        (s1 )n ¯spec   ~ La
                                                                          ¯

which is the same as the price schedule with full specialization, as shown in the proof of Lemma C.4.
      ~ spec (s1 ) coincides with P
Thus, P                           ~ (s1 ) as illustrated in Figure 7.


C.6    Proof of Proposition 5
To obtain (26) we first totally differentiate the equilibrium price expression (22) and noting that within an
heterogeneous equilibrium range the marginal entrant always adopts the minimum technology, e = 0 ,



                                                             62
we have
                        ¯
                   d ln P      1         d                           -1
                                                                                             -1
          (1 - 0 )        = -       +         ln a    ¯
                                                 ¯ s1 P               -1
                                                                            + ln       ¯
                                                                                 ¯e s1 P                     (C.27)
                   d ln L      - 1 d ln L
                        ¯
                   d ln P
                 -        = [( - 1) (1 - 0 )]-1
                   d ln L
                     L                    ¯L
                                           W
                     W

                                                  d                    1                         d ln s1
                             + (1 - 0 )-1              ln a
                                                          ¯ s1 P
                                                               ¯       -1
                                                                            + ln       ¯
                                                                                 ¯e s1 P     ·           ,
                                               d ln s1                                           d ln L
                                                              s
                                                              W


where we use the chain rule and the results that  ¯e in (17) and ~ in (13) do not depend directly on L. Using
                                                ¯                                            ¯
the definition of s1 we obtain d ln s1
                               d ln L
                                       = - d ln P
                                           d ln L
                                                   ; replacing above  and solving for - d ln P
                                                                                        d ln L
                                                                                               = d ln W
                                                                                                  d ln L
                                                                                                         yields
                     L
the expression for W in (26). Applying a similar approach for 
                                ¯
                           d ln P            d                          1
               (1 - 0 )           = -0 -           ln a
                                                      ¯ s1 P ¯          -1
                                                                             + ln       ¯
                                                                                  ¯e s1 P
                           d ln           d ln 
                                ¯
                           d ln P     0            d ln s1
                         -        =       + s  W ·         ,
                           d ln     1 - 0           d ln 
                            
                            W
                                          ¯W


where we use the chain rule and the results that ~e in (17) and ~ in (13) do not depend directly on .
                                                          ¯
Using the definition of s1 we obtain d ln  =  1 - d ln  ; replacing above and solving for 
                                     d ln s1         d ln P
                                                                                             W yields
the expression in (26).
Selection and multiplier decomposition in (27)
Using the definition of s
                        W in (C.27) and the assumption that the minimum is 0 = 0

                                      1 d ln a
                                             ¯ s1 P  ¯     d ln ¯e s1 P ¯
                                s
                                W   =                    +
                                      -1     d ln s1            d ln s1
                                         ¯        d ln ¯   ¯
                                    =                    +
                                      -¯ ( - 1) d ln s1    

and multiplying by  we obtain (27). The second line uses the multiplier definition a  ¯ =
       -1          -1
 1-       ¯ ( s1 )    and the expression for selection effect in (18) with e = 0 = 0.
Positive elasticities
We have L                  L                 s
           W > 0 since ¯W > 0 and 1 -  W > 0 where the latter holds as


                                     s                   ¯     d ln ¯
                                1-   W   =1-¯-                                   >0
                                                     -¯ ( - 1) d ln s1
                                                             ¯    d ln  ¯
from the stability condition, which is equivalent to     -¯ ( -1) d ln s1
                                                                            < (1 - ¯ ) by simplifying (24). We
      
have  W  > 0 since   ¯W + s                  s
                             W > 0 and 1 -  W > 0 under stability.
Comparing elasticities in (28) and (29)
The elasticity in an alternative model where firms must use a common technology            ¯ e is obtained by
                                                       L                                  -1
diferentiating (22), holding s1 fixed. So for L it is W |     ¯ 1 = [( - 1) (1 - 
                                                          ¯ e ,s                    ¯ e )] . Comparing to
 L
   |
 W s1 s and  using the result that  e = 0
                                          and setting the latter to 0 we have the inequality    in (28), which


                                                      63
is satisfied if  sW (¯
                     ) >    ¯ e . Since  s
                                         W (¯)      ¯ the inequality holds for any fixed intermediate share
model where     ¯e    ¯ . The result also applies to . Thus the welfare elasticity is higher and if we fix
¯e =   ¯ the difference is due to the multiplier effect.

C.7      Proof of Proposition 6
                                                                                 d ln s
To derive (31) we use (25) to write the size elasticities as L     L       s
                                                             o = ¯o + o · d ln L and note that ¯o = 0
                                                                                                        L

since conditional on ¯ all shares are independent of L and the same is true for         ¯ conditional on s1
                                        s     d ln ¯       s    ln(1- ¯ ) d ln ¯         ¯ d ln    ¯
(from  ~ in (13) and ¯e in (17)). Also,  ¯  d ln s1 and lsc =     ln ¯ d ln s1
                                                                                    = - 1- ¯ d ln s1
                                                                                                     and slsv =
      ( -1)(1-¯)
 ln( 1+(-1)(1-   )
              ¯ ) d ln   ¯    ¯          1        d ln  ¯
        ln ¯
                         = - 1-
                   d ln s1      ¯
                                  · 1+(-1)(1 -¯ ) d ln s1
                                                          . Rewriting the latter two as functions of L ¯ we obtain
                                               d ln  ¯
(31). Under homogeneous specialization d         ln s1
                                                         = 0 (proposition 2) thus so are all elasticities given in
(31). Otherwise d ln s1 > 0. In a stable equilibrium d
                  d ln ¯                                     ln s1
                                                            d ln L
                                                                    0, with strict inequality under heterogeneous
                                     L             L      L
specialization (proposition 4),so     ¯ > 0 and lsc , lsv < 0.



C.8      Proof of Proposition 7
By definition, the variable labor productivity in terms of output is
                                               Y                 Y            1
                                     ¯Q 
                                                    = -1                 = -1
                                              P Lv     P  (1 -      ¯ )Y  P  (1 - ¯)
                                 d ln ¯Q      d ln W       d ln lsc
                                            =         -
                                  d ln L      d ln L       d ln L
                                     L
                                     ¯Q     = LW  -  L
                                                     lsc ,

where Lv is variable labor in production and the first line uses the fact that wage is normalized so that Lv
equals variable labor cost. Similarly, the variable labor productivity in terms of value-added is

                                              Y 1 - -  
                                                        1
                                                          ¯
                                                                 Y 1 - -
                                                                         1
                                                                           ¯     1
                                    ¯V A 
                                                              =  -1           =
                                                   P Lv          P  (1 - ¯ )Y   P lsv
                             d ln ¯V A        d ln W    d ln lsv
                                            =         -
                              d ln L          d ln L    d ln L
                                     L         L     L
                                     ¯V A   = W - lsv .




C.9      Proof of Proposition 8
                                                 Ma
In parts 1­3, selection into production,         M
                                                    ,   depends on L only via s (via ¯e as shown in proposition 3),
hence ¯LMa /M = 0. We obtain


                    s            d ln [1 - G(  ¯e )]      ¯e g (¯e ) d ln  ¯e      ¯e g (¯e ) ¯ - e
                    Ma /M    =                       =-                       =-                    ,
                                       d ln s1          1 - G(   ¯e ) d ln s1    1 - G(   ¯e ) 

where the first equality differentiates and second equality uses proposition 3. Under homogeneous speci-
alization then ¯ = e , otherwise s   Ma /M < 0 since ¯ > e . Moreover, in a stable equilibrium d ln s1
                                                                                               d ln L
                                                                                                       0
                                                                                 s
iff under heterogeneous specialization (0 otherwise), so we need only show Ma /M < 0 for part 3. For


                                                              64
parts 1 and 2, using (19) we have ¯L
                                   M = 1, same as under the fixed premium. To obtain
                                                                                                      s
                                                                                                      M   note that other
effects occur through a      ¯
                       ¯ and F

                                                ln M d ln a¯     ln M d ln F¯
                                       s
                                       M     =                +     ¯ d ln s1
                                                ln a
                                                   ¯ d ln s1     ln F
                                                ln a
                                                   ¯ d ln ¯      F¯ d ln F  ¯
                                             =               -      ¯ d ln s1 ,
                                                ln ¯ d ln s1 fE + F
                                      ln a
                                         ¯
using expression for a¯ we have       ln ¯
                                           =(¯a - 1), so we obtain s
                                                                   M in (34). Using Ma  [1 - G(     ¯e )] M we
        L          L       L
obtain Ma = Ma /M + M .
Part 4: Existence of g (·) s.t. s  M > 0
                       d ln ¯
From proposition 2, d   ln s1
                                 > 0 iff under heterogeneous specialization and in that case a  ¯ > 1. Thus,
 s                               ¯
                            d ln F
 M > 0 for any g (·) s.t. d ln s1  0. We show existence using a special but useful case. Under any gk (·)
      (¯i ) gk (¯i )   ~ ( ) for any                           ~ ( ) > 0 we have d ln F ¯
s.t.   -1 dGk ()
                     =K                    ¯i > 0,   1 and K                      d ln s1
                                                                                          = 0 and thus s M > 0
         ¯i
under heterogeneous specialization.
Proof. See the online appendix.
                                                                                                      k
   An example of such gk (·) is the unbounded Pareto with G() = 1 - min        
                                                                                    . In this case
 (¯i ) gk (¯i )   ~ ( ) = k - ( - 1), which represents the sales distribution dispersion parameter.
   -1
      
                = K
              dGk ()
 ¯i
                                             d       ¯ g (
                                                          ¯)         d ~
More generally, the result requires         d    
                                                     -1 dG()
                                                                =   d
                                                                       K   ( ) = 0 for all , which we can solve for
                                                 ¯

g (·) and show it requires ln gk () = - K~ ( ) +  ln . Note also that since the condition above can
                                                                            ¯z gk (      ~ (z ), so it
be applied to all   1, the result can be applied to other moments, e.g. if   z -1
                                                                                   ¯i )
                                                                                        =K       dGk ()
                                                                                         ¯i

can be applied to z = 1 and in the case of Pareto K~ (1) = k . Next we show that there exist g (·) satisfying
                              s             s     s
lemma C.9 that implies that M > 0 and M + Ma /M < 0 for an economy with sufficiently large L and
n From (33) and (34) we see that the active firm elasticity due to specialization is simply s          s
                                                                                                M + Ma /M .
                                   s                                                 s        s
In lemma C.9 we show that          M |gk   > 0, so for existence we show when        M   +    Ma /M   |gk < 0

                       s       s                       d ln ¯    ~ (1)   ¯ - e
                       M   +   Ma /M   |gk = (¯
                                              a - 1)           -K
                                                       d ln s1              
                                                                -1
                                                        1-         ¯ (1 -   ¯)  ~ (1) ¯ - e
                                                a - 1)
                                             < (¯                              -K
                                                                   ¯                    
                                                                     ~ (1) (¯      1
                                             = (1 -  ¯ ) ( - 1) - K          - e )
                                                                                   
where second line uses stability condition and simplifies. Thus, a sufficient condition for an equilibrium
with heterogeneous specialization (where e = 0 = 0) is

                                   1- ¯  ~ (1)
                                         K             1
                                               ¯
                                    ¯    -1        ~ (1) / ( - 1)
                                                 1+K
             1                                                   1
Since 1+K~ (1)/( -1) < 1 we know it is possible to have n > 1+K
                                                              ~ ( )/( -1) and in that case there is some
                                                                                1
large enough economy with heterogeneous specialization such that     ¯  [ 1+K~ ( )/( -1) , n ). If gk (·) is




                                                           65
            ~ (1) = k , and the sufficient condition is n  1/2 since k/ ( - 1) > 1 for a finite first
Pareto then K
moment of sales distribution.

C.10     Proof of Proposition 9
C.10.1    Necessity of Change in Specialization
If there is no change in specialization such that e = 0 (or e = n) before and after the shock then (16)
implies that e is unchanged. Moreover, homogeneous specialization implies relative profits across any
two firms depend only on their fundamental productivity, so relative profits and the distribution (·) of
~ (·) remains unchanged.


C.10.2    Sufficiency of Change in Specialization for Increase in Concentration
~ (, L) is a continuous increasing function of  and there is some x s.t. 
                                                                          ~ ( , L) = x =     ~ ( , L ) with
                                                                                   
~ (, L)  
            ~ (, L ) for  >  and      ~ (, L)    ~ (, L ) otherwise. Moreover,  is unique iff there is a
change in specialization, otherwise  ~ (, L) =  ~ (, L ) for all . Continuity is straightforward given the
continuum of productivities and the optimal choice of technology that maximizes     ~ (·). The size increase
implies selection:  ¯e >   ¯e and thus some  >      ¯e such that ~ (, L)    ~ (, L ) for    , together
with continuity ensures at least one intersection from below. The free entry condition implies that there
is some  such that       ~ (, L)     ~ (, L ) for    . If there is no change in specialization then
 =  and they are not unique since the profit distribution remains unchanged as shown in C.10.1. If
there is a change in specialization we show that  =  at a unique point. This is simple to illustrate
if the economy switches from no specialization to full specialization as shown in Figure 9. The proof for
heterogeneous specialization is provided in the online appendix. In the following we use lemma C.10.2
to show the sufficiency

   1. Increase in concentration with respect to (·) under L > L:  (,
                                                                   ¯ L)   (,
                                                                           ¯ L ) for any ¯
      (strictly for some ).

                                                     ¯ L ) =  (,
       Proof. Trivially, the cumulative shares are  (,           ¯ L ) = 1 for ¯  [0,  ¯L
                                                                                        e ] where ¯L
                                                                                                   e is
                                                                                             
       the lowest entry threshold, which occurs under L. Using lemma C.10.2 there is some  such that
       ~ (, L )  
                   ~ (, L) for all    with inequality above  when the latter is unique. Thus,
                                                         
                            ¯
                            
                                ~ (, L ) dG()            ¯
                                                              ~ (, L) dG()
                                                              
               (,
                ¯ L)=                                >                         =  (,
                                                                                   ¯ L) for all ¯  
                                         fE                       fE

       Using lemma 9 ~ (, L )  ~ (, L) for all  <  with strict inequality for   (¯L   
                                                                                  e ,  ). Thus

                                           ¯                            ¯
                                          0
                                               ~ (, L ) dG()           0
                                                                            ~ (, L) dG()
                    ¯ L)=1-
                   (,                                        >1-                         =  (,
                                                                                             ¯ L)
                                                   fE                          fE
                        
       for all ¯  (¯L
                    e ,  ), where the first equality uses the free entry condition:

                                     ¯                         
                                         ~ (, L ) dG() +          ~ (, L ) dG() = fE .
                                 0                            ¯




                                                         66
   2. Increase in concentration with respect to (·):  (x, L) SSD  (x, L ).

       Proof. Free entry in (15) implies equal mean profits, thus we show that  (x, L ) is a MPS of
        (x, L), which implies SSD. A sufficient condition is that  (x, L) intersects  (x, L ) only once
       from below. Thus, we use lemma C.10.2 to show that there exists a x such that  (x  x , L) 
        (x  x , L ) and  (x  x , L)   (x  x , L ). Under lemma C.10.2 we can invert           ~ (, L) to
       obtain

                              (x, L) = Pr       ~ -1 (x, L) = G ~ -1 (x, L)
                                      G   ~ -1 (x, L ) = Pr     ~ -1 (x, L )
                                     =  (x, L ) if x  x ,

       where the inequality in the second line is from evaluating the constant productivity distribution,
       G (), and noting there is a higher proportion of firms under L with profits below a given level
       implied by x  x (from lemma C.10.2). A similar argument implies that  (x, L)   (x, L ) if
       x  x . A continuous G(·) implies that (·) is also continuous, and a unique x implies a unique
       intersection:  (x , L) =  (x , L ). Thus,  (x, L ) is a MPS of  (x, L). If there is no change in
       specialization then ~ -1 (x, L) = ~ -1 (x, L ) for all x and so  (x, L) =  (x, L ).

C.11     Proof of Proposition 10
                                                                           ¯ is constant and so are mean
Necessity of change in specialization. If specialization is unchanged then F
sales, Y /M =  fE + F    ¯ . Moreover, the cumulative shares are also unchanged for any    ¯:  (,¯ L) =
    -1               -1
 ¯
     dG()/         ¯e
                       dG() since        ¯e is unchanged as shown in section 4.1.2. Thus we require a
change in specialization Conditions for  (, ¯ L )   (,  ¯ L)
                                   
                                   ¯
                                      [~
                                        (, L ) + f (, L )] dG()
                    (,
                     ¯ L)=                                                                            (C.28)
                                 min
                                       [~
                                         (, L ) + f (, L )] dG ()
                                                       ¯ (,
                                 ¯
                                     ~ (, L )dG() + F     ¯ L)
                             =                ¯ (L )
                                        fE + F
                                                     ¯ (,
                                 ¯
                                   ~ (, L)dG() + F      ¯ L)
                             >               ¯ (L )
                                        fE + F
                                                     ¯ (,      ¯ (,    ¯ (,
                                 ¯
                                   ~ (, L)dG() + F      ¯ L) + F  ¯ L)-F  ¯ L)
                             =                  ¯ (L) + F ¯ (L ) - F¯ (L)
                                          fE + F
                                                    ¯ (,         ¯ (L ) - F
                                                                          ¯ (L)
                                 ¯
                                   ~ (, L)dG() + F      ¯ L) + F
                             >               ¯ (L) + F ¯ (L ) - F¯ (L)
                                        fE + F
                                                    ¯ (,
                                 ¯
                                   ~ (, L)dG() + F      ¯ L)
                             =                 ¯ (L)
                                          fE + F
                             =  (,
                                 ¯ L)

The first line uses the definition of  in (38) and the relation of sales and profits y
                                                                                     ~()/ =   ~ ()+f (, L ).
The second line uses the free entry condition and definition of integrals of f (, L ). The inequality in the
third line reflects the higher cumulative profits shown in proposition 9 for all       ¯>¯L
                                                                                          e . The fourth line




                                                     67
adds and subtracts similar terms. The inequality in line 5 is from
                              ¯F
                              F ¯ (,    ¯ (,
                                   ¯ L)-F  ¯ L) - F        ¯ (L) > 0,
                                                  ¯ (L ) - F                                                             (C.29)
                                    d ( ¯)
which holds for all ¯>¯L
                       e if          d
                                      = 0, as we prove in the online appendix. Line 6 holds with equality
                                       ¯
if d ( ¯)
          = 0 since in that case F¯ (L ) = F¯ (L). Moreover, if two distributions have the same mean and
    d ¯
 (, ¯ L )   (,   ¯ L) for all  ¯ (with some inequality) then the new distribution is Lorenz-dominated by
the original, which is equivalent to it being a mean-preserving spread (Atkinson, 1970); The last line in
(C.28) uses the same results for sales and profits in the first two lines.

C.12        Alternative Productivity Measures
How are alternative weighted averages of TFPQ affected by size? We can weigh by relative quantities as
done in Melitz (2003) to define a harmonic mean of firm TFPQ. Doing so yields46

                                             n                                       1/( -1)
                                                        ¯i+1
                                 ~ -1 =
                                 C                 i            -1
                                                                     µ (, L) d                  .                        (C.30)
                                             i=e       ¯i


If i = 1 we obtain the expression in Melitz (2003). More generally, we have an adoption weight
increasing in i defined by
                                                    -
                                            (P/)i
                                     i                 ,
                                              c ~
                                              ~/C
which measures the relative unit cost of intermediates and labor in a segment i (recall w = 1) relative to
the average unit costs in the economy (c ~/C~ is an index of input costs gross of productivity terms since it
aggregates all unit cost and divides by an aggregate index of the productivity terms). Under homogeneous
specialization i = 1 and L works only via selection so again a change in specialization is necessary.
Moreover, a large enough increases in L from no specialization to full specialization equilibria implies
an increase in C ~ -1 . Together with the fact that (C.30) is continuous in L implies that it increases TFP
average over some heterogeneous specialization range. Finally, we can consider a sales share average:
   n        ¯i+1
   i=e i   ¯i
                 µ (, L) d. This changes iff specialization changes (otherwise i is unchanged). The
measure increases with a shock to size that moves from no specialization to full specialization, because
of selection, thus a large enough increase in size eventually increases it. Moreover, under heterogeneous
specialization this measure is monotonically increasing in size whenever the sales cumulative shares
behave as in proposition 10, e.g. in case G is Pareto.


D        Quantification
D.1       Measurement of Data Moments
Moments from NBER CES database, sic classification
    · Intermediates cost share: measured as
                                                           matcost - energy
                                                 ¯=                                                                       (D.1)
                                                       matcost + payroll + invest
                             ¯i+1                                                   1-   ¯i+1                  1/(1- )
                         n           q (c)                        n           
  46
                     ~
       Specifically, c   i=e ¯i
                                  ci q  c) µ (, L) d
                                       (~              so c
                                                          ~=      i=e   ((P/) i )        ¯i
                                                                                         
                                                                                                -1 µ (, L) d


                                                               68
      at the industry level from NBERCES sic data. We then aggregate to the whole US manufacturing
      using year 1997 industry total cost as fixed weights. The reason we do not use yearly variable
      weights is that our framework captures within-industry adoption so we want to tease out effects
      from between-industry reallocations.

   · Log relative factor price: measured as

                                         w           payroll/employment
                                    ln       = ln                               ,
                                         P           material price index

      at the industry level, and we measure wage rate as payroll/employment. We then aggregate to the
      whole US manufacturing using year 1997 industry total cost as fixed weights.

As our calibration procedure captures long-run change, we take the geometric average of the above
moments between year 1987 and 1989 as the initial period, and the geometric average of the year 2005
to 2007 as the final period, in order to smooth out data fluctuations. This gives us ¯ 0 = 0.699, ¯T =
                                                                 w
0.743, and log relative factor growth during the period as  ln P = 0.383. Moments from Census of
Manufacturing: year 1987 and 2007

   · Trade targets: this is the same as the literature
                                                              value of exports
                                  Export intenstity =                              .
                                                          total sales of exporters

      From Census data, we have Intenstity0 = 10.0% and IntenstityT = 16.3%. Year 1987 Census
      moments come from Bernard et al. (1995).

   · Sales share targets: we use the census data on sales share of top 20 firms in each naics industry
     to compute the sales share of top 20V largest firms at the aggregate US manufacturing in year
     1987 using industry sales as weights, where V is the number of naics industries with more than
     100 firms. The value is 64.5%. The implicit assumption here is that the top 20 sales firm in each
     industry still remains top 20V firms in the aggregate. We can interpret the measure as some sort of
     the industry average. Furthermore, with data on number of firms in each industry, we can calculate
     the fraction of those 20V firms relative to whole manufacturing, 20V = 2.27%.

Capital expenditure adjustment from EU KLEMS database: In one of the sensitivity analysis we use
capital expenditure data obtained from the EU KLEMS to replace the "invest" variable when calculating
intermediates share as in (D.1). We measure capital expenditure from the dataset as the sum of computing
equipment, communications equipment, computer software and databases, transport equipment, other
machinery and equipment, and total non-residential investment. Then we compute the ratio of these
capital expenditure relative to the gross value added at the sector level, and match the 2-digit sector code
in EU KLEMS to our 2-digit sic data. Finally, multiply the capital-value added ratio with the value added
in the NBER-CES data yields an alternative capital expenditure. After this adjustment, the intermediates
cost share is ¯ t=0,T = [0.683, 0.715].

D.2    Calibration Procedure
In the following we discuss in detail the steps to calibrate the endogenous specialization framework to
the US manufacturing between the initial and final periods. The first step is to solve for the variable trade


                                                     69
                                                                                                       1-
                                                                                               (N -1)(t )
cost 0 and T by using data on export intensity. The model implies that Intenstityt = 1+(         N -1)(t )1-
so we can invert the expression to get  by using the trade targets directly. We calibrate the rest of the
model parameters while solving the equilibria for both periods. The calibration procedure consists of
two loops. In the outer loop, we guess the maximum intensity  so that the resulting sales share of top
20V firms matches the data moments, 64.5%. In the inner loop, we calibrate the technology and trade
cost parameters by matching the intermediates cost share in both periods, and the log relative factor price
growth during the period. Specifically, by assuming the equilibrium is of the heterogeneous specialization
type, we start with a guess for the specialization premium for both periods, s1,0 and s1,T , as well as the
         ^. First, given the value of specialization premium, the relative adoption cost, and variable trade
value of f
                                                                                                          -k
                                                                                                     ¯1
cost, and the preassigned parameters, we calculate the fractions of two types of adopters, 1 =       ¯0
                -k
            ¯2
and 2 =     ¯0
                  , which we know are functions of specialization premium and adoption cost only from
expressions of relative cutoffs. Second, given fractions of adopters and the initial guess, we calculate the
implied value of maximum intermediates intensity t in both periods using data on intermediates cost
share:
                                                      1
                            F1 1,t + 2F2 2,t + (s1,t ) -1 -1 (F1 1,t + F2 2,t ) t
                       ¯t =                                                          ,                (D.2)
                                          F0 + F1 1,t + F2 2,t                   2
where F0 = f0 = 1, F1 = f   ^F0 , and F2 = f ^(1 + f
                                                   ^)F0 . Third, given the fractions of adopters, we use the
free entry condition to calculate the entry cutoff ¯0 :

                             ( - 1)k
                                   min
                                       (¯0 )-k (F0 + F1 1 + F2 2 ) = fE .                             (D.3)
                              k-+1
Fourth, we use the goods market clearing condition to calculate total expenditure X , and then use the en-
try cutoff expression to calculate the price index. Finally, we use the definition of specialization premium
to calculate the value of intermediates technology t for both periods.
                                                           2
                                              t = (s1,t )  Pt .                                       (D.4)

Fifth, we calculate the model-implied change in log relative factor price:
                                          w   m        ln s1,t
                                    ln            =            -  ln t .                              (D.5)
                                          P             0
We also calculate the model-implied sales share of top 20V firms in the initial period, 20V,0 . In the inner
loop, if the model-implied maximum intermediates intensity equals the initial guess and the changes in
relative factor price equal the observed change
                                                       w   m           w   data
                             0 = T = ,          ln             =  ln              ,                   (D.6)
                                                       P               P

we retrieve the values of technology parameters, 0 , T , and f  ^, and go to the outer loop. If not, we go
back to the first step with a new guess. In the outer loop, if the model-implied sales share of top 20V
firms equal the observed sales share, we get the maximum intermediates intensity . If not, we go back
with a new guess of  and start the inner loop again.




                                                      70
D.3      Model Versus Data Regressions: Specialization and Concentration
We provide details for the validation exercise in section 7.2.5. To obtain variation in initial sales con-
centration, we shock the cost of adoption, f ^, in the initial equilibrium while holding all other parameters
constant. We draw lognormal shocks such that the mean of ln f        ^V reflects the aggregate calibrated value
                                              47
(ln (11.3)) and its standard deviation is 0.1. We compute the model sales share of the percentile x of
operating firms in the model,  x, f  ^V . We employ x = 2.27% since in the initial calibration this ensures

the model accounts for the (aggregated) top 20 firm sales share in the data (i.e. data =  (2.27%, 11.3)).
If we observed the full sales distribution then we could compute the share using the same percentile for
each industry in the data. What we observe is a proxy with some measurement error: the top 20 sales
given by data (20/NV ) =  x, f      ^V + eV , which suggests the elasticity using the data will be attenuated

relative to the one using the model. We then take the new initial equilibrium for a given f   ^V and apply a
log normal trade cost shock: t ln  ~N (-0.14, 0.23). The shock distribution reflects the aggregate mean
decrease in the calibration and its standard deviation reflects industry variation in observed changes in
trade costs.48 In the data, the correlation between the log trade cost shock and initial top 20 firms sales
share is only 0.04 so we assume the two distributions of shocks are independent. After applying the
trade shock we compute the log change in intermediate cost share and relative factor price (our measure
of specialization premium in the empirical exercise). We take 500 draws to approximately match the
number of industries in the data and use the model generated data to run a regression similar to Table 1
but in changes instead of a panel. As noted section 7.2.5 the differential elasticity using the empirical
estimation is similar to but smaller than the model's, possibly due to the attenuation error mentioned
above. We find some support for this attenuation by re-computing shares in the model to try to capture
the different percentiles in the data. Specifically we use percentiles xm = x  um where ln uV is normally
distributed with mean zero and consider alternative standard deviations. The elasticity differentials for
the model is 0.10 when the standard deviation is 1/4 and 0.04 when it is 2/3.49

D.4      Fixed Specialization Economy
Several propositions contrast elasticities to those in a fixed specialization model. Here we formalize one
such alternative that satisfies an additional requirement: it has the same initial equilibrium outcomes as
our model except firms have homogeneous intermediate intensity.

Definition D.1. The fixed specialization model is identical to the one with endogenous specialization
except its unit cost is:
                                    FP       w1- P 
                                   ci () =            ; i = 0, 1...n                            (D.7)
                                              HT i
where  is a common intermediate cost share, T i  1 is the productivity advantage of a firm that
optimally pays fi and H > 0 adjusts the size of the economy.
  47
      The small variation in f^V allows us to remain close to the original calibration; it also generates smaller variation in top-20
sales share than in the data but we can account for this by comparing the impact of a standard deviation in that share in the
data vs. the model.
   48
      Specifically, we first compute the initial and final trade share as the geometric avarage of import penetration and export
                                                                                                                           1-
                                                                                                                           i,t
sales share for 1990­1992 and 2005­2007, respectively. Then we use the mapping in the model that trade share is             1-
                                                                                                                          1+i,t
                                                                                                                                  to
get the changes in trade cost, i,t , and compute the standard deviation of the log change.
   49
      Higher standard deviations induce more error and attenuation. We chose values lower than the observed sd( ln 20/NV )
in the data, which is about unity for the industries used.


                                                                71
    Under the simplest case with n = 1, this framework is equivalent to Bustos (2011), in that it allows
firms to pay a fixed cost to improve TFP, extended so firms can use a constant share of intermediate
inputs. The following parameterization yields the same initial equilibrium as the endogenous premium
framework.
                                                                       
                                                   P0
Proposition D.1. If  =   ¯ 0 , T = s0 , and H = w   0
                                                        then the fixed and endogenous specialization
models have the same initial equilibrium, including productivity thresholds, cost shares, outputs, and
welfare.
Proof. The two models have the same average intermediates cost share as  =        ¯ 0 , implying that they
have the same initial sales Y0 from the labor market clearing condition (11). Because T = s0 and the
fixed costs for all types of technology and are the same, the two models have the same relative cutoffs
 ¯i
¯e
    from expression (10). These arguments imply that the entry cutoffs are the same from the free entry
condition (16), hence all productivity cutoffs are the same. Finally, utilizing the expression for entry
cutoff under fixed specialization premium, the scale parameter H ensures that the fixed specialization
premium model to have the same price index P0 because
                                                                                     1
                                                  1- 
                                            H -1 w0 P0       w 0 f0                  -1
                                ¯F
                                   P
                                 0 (0)    =                                               =¯0 (0)
                                                 P0    ~ Y0 (1 +  1- )
                                                       

from the zero profit cutoff condition, where ¯F P
                                              0 (0) is the initial domestic productivity threshold of the
fixed specialization model.
       According to proposition D.1, we parameterize the fixed premium framework as  = ¯ 0 = 0.699,
                                            
                              P0
T = s0 = 1.508, and H = w      0
                                  = 0.155 so that it has the same initial equilibrium as our baseline
endogenous specialization framework.

D.5        Robustness
In the following, we illustrate in detail whether our basic quantitative implications are sensitive to alter-
native values of  , k , and measured intermediates cost share,     ¯ . First, we lower the values of elasticity
                                                                                                 k
of substitution from  = 5 to 4. We keep the sales pareto shape parameter the same ( -              1
                                                                                                      = 1.42), so
k = 4.25. Other parameters and moments are the same as the baseline, and we recalibrate the model. The
second column of Table D.1 shows the key parameters under this scenario. Compared to the baseline,
we have smaller values of fixed cost of adoption and intermediates technology, and larger values of max-
imum intensity. However, the calibrated technology shock still increases about 9 lp (ln 0        .121
                                                                                                0.111
                                                                                                      ). From the
last row of Table D.1 we see that the calibrated final equilibrium is less specialized than in the baseline,
as only 34% of firms fully specialize compared to 61% in the baseline. However, the increase in specia-
lization premium is similar compared to the baseline (ln 11..518
                                                                 versus ln 1.268
                                                                                 ). For the income effects from
observed trade cost reductions (Table 6) and moving to autarky (Table D.2), we observe that these effects
are larger under a smaller elasticity of substitution. In column 3, instead of pre-assigning the shape pa-
                                k
rameter according to a fixed -    1
                                    ratio, we calibrate it by adding in the moment for the sales share of top
          50
4V firms. The calibrated shape parameter is k = 6.26, which is larger than the baseline. The fixed cost
  50
       Those firms account for 37.4% of total firms and consist of 0.5% of total firms.


                                                                72
                         Table D.1: Robustness: parameters and equilibrium variables
                                                                                                           Alternative
 Specification              Baseline                    =4                     Calibrated k
                                                                                                         capital measure
 Parameters:
                         0.746                         0.753                      0.746                        0.717
 f^                      11.37                         10.48                      15.60                        13.89
 k                        5.67                          4.25                       6.26                         5.67
 [0 , T ]           [0.209, 0.229]                 [0.111, 0.121]             [0.268, 0.294]               [0.236, 0.265]
 Equilibrium variables:
 [s1,0 , s1,T ]       [1.51, 1.80]                   [1.68, 2.00]               [1.62, 1.94]                [1.59, 1.90]
 [1,0 , 1,T ] (%)     [17.2, 16.2]                   [16.7, 22.6]               [16.4, 17.3]                [18.1, 15.2]
 [2,0 , 2,T ] (%)      [7.0, 61.1]                    [6.7, 34.0]                [5.7, 58.5]                 [7.6, 65.8]

      Notes: Parameters and equilibrium variables across different specifications of calibration. The first column uses
      the baseline, the second changes  = 5 to 4, the third uses the top 4 firm sales share in 1987 to calibrate k , the
      last uses an alternative capital measure from the EU KLEMS database to compute intermediate share. Source:
      Authors' calculations



             Table D.2: Robustness: changes in real income from moving to autarky (lp)
                             Baseline     =4           Calibrated k    Alternative capital measure
 Endogenous Specialization     -18.8       -26.2          -18.8                   -16.3
 Fixed Specialization          -17.3       -23.1          -17.3                   -15.6
 No Specialization             -4.45       -5.93          -4.45                   -4.45

      Notes: Changes (in log points) for real income by moving the end equilibrium of the calibrated economy to
      autarky across different specifications of calibration. The first column uses the baseline, the second changes
       = 5 to 4, the third uses the top 4 firm sales share in 1987 to calibrate k , the last uses an alternative capital
      measure from the EU KLEMS database to compute intermediate share. Source: Authors' calculations



of adoption and intermediates technology are also larger. Again, the increase in intermediates technology
is still around 9 lp. From the last row of Table D.1, the calibrated equilibria are similar in terms of the
fraction of specializers and the increase in the specialization premium. Lastly, from Table 6 and Table
D.2, the income effects are virtually unchanged compared to the baseline. In the last exercise, we use
another measure for intermediates cost share by incorporating capital expenditures from the EU KLEMS
database. The adjusted share is    ¯ t=0,T = [0.683, 0.715], which is slightly lower than the baseline in
terms of both the level and the relative increase between the two periods. From the last column of Table
D.1, we see that the maximum intermediates intensity is lower, with slightly higher fixed cost of adop-
tion and intermediates technology than the baseline. The last row shows that the calibrated equilibria
are similar to the baseline in terms of both the fractions of specializers and the increase in specialization
premium. Finally, the income effects are significantly smaller than the baseline for two reasons. First,
the intermediates cost share are smaller in values so it generates smaller input-output amplifications. Se-
cond, the observed changes in that share are smaller, so the same trade shock generates less increase in

                                                             73
specialization compared to the baseline.




                                           74
