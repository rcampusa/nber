                              NBER WORKING PAPER SERIES




      AT WHAT LEVEL SHOULD ONE CLUSTER STANDARD ERRORS IN PAIRED
     EXPERIMENTS, AND IN STRATIFIED EXPERIMENTS WITH SMALL STRATA?

                                    Clément de Chaisemartin
                                     Jaime Ramirez-Cuellar

                                      Working Paper 27609
                              http://www.nber.org/papers/w27609


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     July 2020




We are very grateful to Antoine Deeb, Jake Kohlhepp, Heather Royer, Dick Startz, Doug
Steigerwald, Gonzalo Vasquez-Bare, members of the econometrics and labor groups at UCSB,
participants of the Advances in Field Experiments Conference 2019, California Econometrics
Conference 2019, LAMES 2019, and LACAE 2019 for their helpful comments. The views
expressed herein are those of the authors and do not necessarily reflect the views of the National
Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2020 by Clément de Chaisemartin and Jaime Ramirez-Cuellar. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.
At What Level Should One Cluster Standard Errors in Paired Experiments, and in Stratified
Experiments with Small Strata?
Clément de Chaisemartin and Jaime Ramirez-Cuellar
NBER Working Paper No. 27609
July 2020
JEL No. C01,C21

                                            ABSTRACT

In paired experiments, units are matched into pairs, and one unit of each pair is randomly
assigned to treatment. To estimate the treatment effect, researchers often regress their outcome on
a treatment indicator and pair fixed effects, clustering standard errors at the unit-of-randomization
level. We show that the variance estimator in this regression may be severely downward biased:
under constant treatment effect, its expectation equals 1/2 of the true variance. Instead, we show
that researchers should cluster their standard errors at the pair level. Using simulations, we show
that those results extend to stratified experiments with few units per strata.


Clément de Chaisemartin
Department of Economics
University of California at Santa Barbara
Santa Barbara, CA 93106
and NBER
clementdechaisemartin@ucsb.edu

Jaime Ramirez-Cuellar
University of California at Santa Barbara
Santa Barbara, CA 93106
jramirezcuellar@ucsb.edu
1    Introduction

In randomized experiments, the units included in the randomization, e.g. villages, are often matched
into pairs, and then one unit of each pair is randomly assigned to treatment. Alternatively, units
may be grouped into small strata of, say, less than ten units, and then a fixed number of units gets
treated in each stratum. Paired experiments or stratified experiments with a small number of units
per strata are commonly used in economics. The American Economic Journal: Applied Economics
published 50 randomized field experiments from 2014 to 2018. Of those, four used a paired design,
and seven used a stratified design with 10 units or less per strata. Indeed, grouping units into
pairs or small strata reduces the variance of the treatment effect estimator, if the variables on
which the units are grouped predict the outcome (Athey and Imbens, 2017). In our survey, we
also found that to estimate the treatment effect, researchers usually regress their outcome on a
treatment indicator and pair or strata fixed effects, and cluster their variance estimator at the
unit-of-randomization level, namely, at the village level in our example. In this paper, we assess
whether this inference method is appropriate. We do so assuming that the units participating in
the experiment are a convenience sample (Abadie et al., 2020) rather than an i.i.d. sample drawn
from a super population, so the only source of randomness is the assignment to the treatment. Our
survey shows that this set-up is applicable to a majority of paired- and small-strata experiments
conducted in economics, where experimental units are rarely drawn from a larger population.
    We start by considering paired designs. The treatments of the two villages in the same pair
are perfectly negatively correlated: if village A is treated, then village B must be untreated, and
conversely. The pair-clustered variance estimator accounts for that correlation. Accordingly, it is
unbiased for the variance of the treatment effect estimator when the effect does not vary across
pairs, and conservative otherwise. On the other hand, the village-clustered variance estimator does
not account for that correlation and may be biased. The direction of the bias crucially depends
on whether pair fixed effects are included in the regression. When fixed effects are included, as
is often the case in practice, we show that if all villages have the same number of villagers, the
village-clustered variance estimator is exactly equal to a half of the pair-clustered one. Then, if the
treatment effect does not vary across pairs, when the number of pairs goes to infinity the t-statistic
using village-clustered standard errors converges to a N (0, 2) distribution. Accordingly, comparing
that t-statistic to, e.g., 1.96, the critical value one would use in a 5% level test, actually yields a
16.5% type 1 error rate. In Section E of the Web Appendix, we show that this result is not very



                                                  2
sensitive to the assumption that all villages have the same number of villagers.
   When pair fixed effects are not included in the regression, which is less often the case in practice,
there is no longer a fixed relationship between the village- and pair-clustered variance estimators.
However, we show that the expectation of the difference between the former and the latter is
proportional to the difference between the between-pair and within-pair covariance of the two
potential outcomes. Both covariances should typically be positive, and one may also expect their
difference to be positive. For instance, in the extreme case where the two units in the same pair have
equal potential outcomes, the second covariance is equal to 0, and the village-clustered variance
estimator without fixed effects is too conservative.
   We apply our results to revisit the paired randomized experiments we found in our survey. 372
regressions in those papers have pair fixed effects. Using standard errors clustered at the unit-of-
randomization level, the authors found a 5%-level significant treatment effect in 162 regressions.
Using standard errors clustered at the pair level, we find a significant effect in 109 regressions. 54 re-
gressions do not have pair fixed effects. Using standard errors clustered at the unit-of-randomization
level, the authors found a 5%-level significant treatment effect in 31 regressions. Using standard
errors clustered at the pair level, we find a significant effect in 36 regressions.
   With heterogeneous treatment effects across pairs, the pair-clustered variance estimator is con-
servative. To increase power, one may want to use a less conservative estimator. We study two
alternatives: the pair-of-pairs variance estimator proposed by Abadie and Imbens (2008), and a
variance estimator proposed by Bai et al. (2019). The properties of these two estimators have not
been studied yet in the finite-population set-up we consider. We show that as the pair-clustered
variance estimator, those two estimators are conservative. They are less conservative than the
pair-clustered estimator when the treatment effect is less heterogeneous within than across pairs
of pairs, and more conservative otherwise. We estimate the three estimators in the regressions we
consider in our empirical application, and find that they are on average equivalent, so it does not
seem one can expect large power gains from using those estimators. Moreover, simulations based
on the data from the paired experiment conducted by Cr´
                                                      epon et al. (2015) show that t-tests using
those two estimators have a drawback relative to the t-test using the pair-clustered estimator. They
are approximately normally distributed only if the sample has more than a couple hundred pairs,
a condition met in only one of the paired experiments in our survey. On the other hand, the t-test
based on the pair-clustered estimator is approximately normally distributed with as few as 20 pairs.
   Finally, we consider stratified experiments with a small number of units per strata. Using


                                                    3
simulations, we show that our results for paired designs extend to that case. There as well, the
treatments of units in the same stratum are negatively correlated, so this correlation should be
accounted for. Our simulations show that t-tests based on strata-clustered standard errors have
correct size, irrespective of whether strata fixed effects are included in the regression. On the other
hand, t-tests based on randomization-unit-clustered standard errors do not have correct size. They
tend to be liberal when strata fixed effects are included, conservative otherwise. When strata fixed
effects are included, the liberality of those t-tests decreases with the number of randomization units
per strata: the larger a stratum, the less correlated its units' treatments. With 5 units per strata,
a 5% level t-test is rejected 8.0% of the time, and with 10 units per strata, it is rejected 6.6% of
the time. With more than 10 units per strata, size distortions become smaller. This is why we use
this 10 units per strata threshold in our survey, though we acknowledge it is somewhat arbitrary.
    Our paper is related to several other papers that have considered paired experiments. Our
results may seem to contradict those in Bruhn and McKenzie (2009). Using simulations, they show
that in paired experiments with only one observation per randomization unit (e.g. one villager per
village), t-tests based on fixed effects regressions with no clustering have correct size. This is due to
the fact that in the one-observation-per-randomization-unit case, the fixed effects regression has half
as many regressors as observations. Consequently, the degrees-of-freedom correction embedded in
most statistical software amounts to multiplying the unclustered variance estimator by two, which
then makes it equivalent to the pair-clustered variance estimator. Therefore, the issue we highlight
does not apply to the one-observation-per-randomization-unit case. However, in our survey of
paired and small-strata experiments, only one paper has one observation per randomization unit.
Random assignment is clustered in all the other papers,1 and the median number of observations
per unit of randomization is large (99 for paired experiments, 26 for small-strata experiments).
With clustered assignment, the degree-of-freedom adjusted standard error clustered at the unit of
randomization is no longer equivalent to the pair-clustered one.
    Athey and Imbens (2017) and Bai et al. (2019) have also shown that when pair fixed effects are
not included in the regression, standard errors clustered at the unit-of-randomization level tend to
be conservative. We show that when pair fixed effects are included, these standard errors actually
become very liberal.
    Imai et al. (2009) have also proposed an estimator of the treatment-effect estimator's variance
  1
    This is in line with Muralidharan and Niehaus (2017), who find that assignment is clustered in 62% of the RCTs
published in top 5 journals in 2001-2016.




                                                        4
in paired experiments, and have shown it is unbiased if the treatment effect is constant across pairs,
and conservative in general. With respect to this paper, our contribution is to show that when the
number of observations is the same in all villages, the pair-clustered variance estimator is equal to
their estimator, up to a degrees-of-freedom correction. Thus, we justify the use of the pair-clustered
variance estimator. Moreover, we present large sample results for t-tests based on pair-clustered
variance estimators, while their paper focuses on finite-sample results.
        Finally, two of the variance estimators we study were proposed by Abadie and Imbens (2008)
and Bai et al. (2019). Assuming that units participating in the experiment are an i.i.d. sample
drawn from a super population, both papers have shown that once properly normalized, their
proposed estimator is consistent for the asymptotic variance of the treatment effect estimator. Our
paper is the first to show that those estimators are actually conservative in a finite-population
set-up, and it is also the first to compare them to the pair-clustered variance estimator in a wide
range of empirical applications.
        The paper is organized as follows. Section 2 presents our survey of paired and small-strata
experiments in economics. Section 3 introduces the setup and the notation. Section 4 presents our
main results, for paired designs. Section 5 presents our simulation study. Section 6 presents our
empirical applications. In Section B of the Web Appendix, we use simulations to show that our
results for paired designs extend to stratified experiments with small strata.


2        Paired and small-strata experiments in economics

We searched the 2014-2018 issues of the American Economic Journal: Applied Economics (AEJ
Applied) for paired randomized experiments or stratified experiments with ten or less randomization
units per strata. 50 field experiments papers were published over that period. Three relied on a
paired randomization for all of their analysis, while one relied on a paired randomization for part of
its analysis.2 21 papers mentioned that the randomization was stratified (though not paired). For
18 of those papers, we could compute the average number of randomization units per strata, either
by reading the paper or by opening the paper's data set. For the remaining three papers, either the
data set was not available online, or it did not include the stratification variable. Among those 18
papers, seven have 10 or less randomization units per strata. Overall, at least 22% of the 50 field
    2
    Beuermann et al. (2015) use a paired design to estimate the spillover effects of the intervention they consider.
Their estimation of the direct effects of that intervention relies on another type of randomization. We only include
their spillover analysis in our survey and in our replication.



                                                         5
experiments published by the AEJ Applied over that period are paired or stratified experiments
with ten or less randomization units per strata.
    To increase our sample of paired experiments, we searched the AEA's registry website for
randomized controlled trials (https://www.socialscienceregistry.org). We looked at all com-
pleted projects, whose randomization method included the prefix "pair" and that had either a
working or a published paper. Thus, we found five more paired experiments.
    In total we found 16 papers. The list is in Table 5 in the Web Appendix. 14 are published,
two are not. In one of them, the regression is at the level of the randomization unit. For example,
researchers randomly assigned some firms to the treatment or to the control, and then their regres-
sions are at the firm level. In 15 of them, the regression is at a more disaggregated level than the
randomization unit. For instance, researchers randomly assigned some schools to the treatment or
to the control, and then their regressions are at the student level.
    Across the nine paired experiments, the median number of pairs is 28, and the median number
of observations per unit of randomization is 99. To estimate the treatment effect, five articles
include pair fixed effects in all of their regressions, three articles include pair fixed effects in some
but not all of their regressions, and one article does not include pair fixed effects in any regression.
To conduct inference, eight articles out of nine cluster standard errors at the randomization-unit
level, and one article does not cluster standard errors. None clusters standard errors at the pair
level.
    Across the seven small-strata experiments, the median number of units per strata is 7, the
median number of strata is 48, and the median number of observations per unit of randomization is
26. To estimate the treatment effect, six articles include strata fixed effects in all their regressions,
and one article does not include strata fixed effects in any regression. To conduct inference, all
articles cluster standard errors at the randomization-unit level.
    In the following sections, we focus on paired experiments. However, in Section B of the Web
Appendix, we use simulations to show that the main results we derive for paired experiments extend
to small-strata experiments.


3    Setup and variance estimators

We consider a population of 2P randomization units. Unlike Abadie and Imbens (2008) or Bai et al.
(2019), we do not assume that the randomization units are an i.i.d. sample drawn from a super



                                                   6
population. Instead, that population is fixed, and its characteristics are not random. This modelling
framework is similar to that in Neyman (1923) or Abadie et al. (2020). Our survey suggests it is
applicable to a majority of paired- and small-strata experiments conducted in economics. The
randomization units are drawn from a larger population in only one of the nine paired experiments
we found.3 In all the other paired experiments, and in all the stratified experiments, the sample
is a convenience sample, consisting of volunteers to receive the treatment, or of units located in
areas where the RCT implementing partner operates, or of units located in areas where conducting
the research was easier.4 When the randomization units are an i.i.d. sample drawn from a super
population, our results still hold, conditional on the sample drawn.
    The 2P units are matched into P pairs. Pairs are created by grouping together units with the
closest value of some baseline variables predicting the outcome. In our fixed-population framework,
pairing is not random, as it depends on fixed units' characteristics. The pairs are indexed by
p  {1, . . . , P }, and the two randomization units in pair p are indexed by g  {1, 2}. Unit g in
pair p has ngp observations, so that pair p has np = n1p + n2p observations, and the population has
       P
n=     p=1 np   observations.
    Treatment is assigned as follows. For all p  {1, . . . , P } and g  {1, 2}, let Wgp be an indicator
variable equal to 1 if unit g in pair p is treated, and to 0 otherwise. We assume that the treatments
satisfy the following conditions.

Assumption 1 (Paired assignment).

   1. For all p, W1p + W2p = 1.

                       1
   2. P(Wgp = 1) =     2   for all g and p.

   3. For all p = p , (W1p , W2p )  (W1p , W2p ).

    Point 1 requires that in each pair, one of the two randomization units gets treated. Point 2
requires that the two units have the same probability of being treated. Finally, Point 3 requires
that the treatments be independent across pairs.
    Let yigp (1) and yigp (0) represent the potential outcomes of observation i in randomization
unit g and pair p with and without the treatment, respectively. We follow the randomization
   3
     This is in line with Muralidharan and Niehaus (2017), who show that in only 31% of the RCTs published in top
5 journals between 2001 and 2016, the randomization units are drawn from a larger population.
   4
     For instance, Glewwe et al. (2016) conducted their study in rural counties of the Gansu Chinese province that
were located close to the provincial capital, which eased monitoring by Gansu's Center for Disease Control.



                                                        7
inference literature (see Abadie et al., 2020) and assume that potential outcomes are fixed.5 Let
igp = yigp (1) - yigp (0) be the treatment effect of that observation. The observed outcome is
Yigp = yigp (1)Wgp + yigp (0)(1 - Wgp ). We focus on the average treatment effect

                                                       P   2   ngp
                                              1
                                            =                        (yigp (1) - yigp (0)).
                                              n
                                                      p=1 g =1 i=1


       We consider two estimators of  . Let Tp = n1p W1p +n2p W2p and Cp = n1p (1-W1p )+n2p (1-W2p )
                                                                                                      P                      P
be the number of treated and untreated observations in pair p. Let T =                                p=1 Tp      and C =    p=1 Cp

be the total number of treated and untreated observations. The first estimator  is the OLS
estimator from the regression of the observed outcome Yigp on a constant and Wgp :


                      Yigp =  +  Wgp + igp                  i = 1, 2, . . . , ngp ; g = 1, 2; p = 1, . . . , P.                    (1)


 is the well-known difference-in-means estimator:

                                        P   2   ngp                      P   2   ngp
                                                      Yigp Wgp                         Yigp (1 - Wgp )
                             =                                 -                                       .
                                                         T                                    C
                                       p=1 g =1 i=1                   p=1 g =1 i=1


The second estimator is the pair-fixed-effects estimator, f e , obtained from the regression of the
observed outcome Yigp on Wgp and a set of pair fixed effects (ig1 , . . . , igP ):

                                   P
           Yigp = f e Wgp +             p igp + uigp ,           i  {1, . . . , ngp }; g  {1, 2}; p  {1, . . . , P }.              (2)
                                  p=1


It follows from, e.g., Equation (3.3.7) in Angrist and Pischke (2008) and a few lines of algebra that

                                                                                                                            -1
           P         2           ngp
                                       Yigp
                                                               ngp
                                                                     Yigp                                    n- 1   -1
                                                                                                              1p + n2p
 f e =          p          Wgp              - (1 - Wgp )                  ,        where       p =                               -1 .
                                       ngp                           ngp                                   P
          p=1       g =1         i=1                           i=1                                         p =1    n- 1   -1
                                                                                                                    1p + n2p


       We study the variance estimators of  and f e arising from Regressions (1) and (2) above,
when the regression is clustered at the pair or at the randomization-unit level.6 Lemma 3.1 below
                                                                                                           2       ngp
gives simple expressions of those four variance estimators. Let SETp =                                     g =1    i=1 Wgp igp    and
   5
     In a previous version of the paper, we allowed potential outcomes to be stochastic. For instance, in Cr´
                                                                                                            epon et al.
(2015), a villager's income may be affected by stochastic events like weather shocks. Having stochastic potential
outcomes does not change our main results, see de Chaisemartin and Ramirez-Cuellar (2020).
   6
     The clustered-variance estimators we study are those proposed in Liang and Zeger (1986).



                                                                     8
               2        ngp
SEUp =         g =1     i=1 (1 - Wgp )igp      respectively be the sum of the residuals igp for the treated and
                                                                                          2          ngp
untreated observations in pair p. Similarly, let SETp,f e =                               g =1       i=1 Wgp uigp   and SEUp,f e =
  2        ngp
  g =1     i=1 (1 - Wgp )uigp      respectively be the sum of the residuals uigp for the treated and untreated
observations in pair p.

Lemma 3.1 (Clustered variance estimators for  and f e ).
                                                                                                               SETp          SEUp   2
                                                                                                         P
  1. The pair-clustered variance estimator (PCVE) of  is Vpair ( ) =                                     p=1    T        -    C         .

                                                                                                                                    SETp2       SEUp2
                                                                                                                             P
  2. The randomization-unit-clustered variance estimator (UCVE) of  is Vunit ( ) =                                           p=1     T2
                                                                                                                                            +    C2
                                                                                                                                                        .
                                                                                                 2
                                                       P                         1         1
  3. The PCVE of f e is Vpair (f e ) =                     2    2
                                                       p=1 p SETp,f e           n1p   +   n2p        .

                                                       P                         1         1
  4. The UCVE of f e is Vunit (f e ) =                     2    2
                                                       p=1 p SETp,f e           n2
                                                                                      +   n2
                                                                                                     .
                                                                                 1p        2p


Proof. See Appendix D.

      We also study two other estimators of V ( ). Those estimators have been proposed in the one-
observation-per-randomization unit special case, but it is straightforward to extend them to the
case where all randomization units have the same number of observations, as stated below:7

                                                      n
Assumption 2. For all p, n1p = n2p =                 2P .

                              1
      Let p =         g [Wgp ngp     i Yigp   - (1 - Wgp ) n1
                                                            gp       i Yigp ]   denote the treatment-effect estimator in
pair p. The first alternative estimator we consider is a slightly modified version of the pairs-of-pairs
variance estimator (POPVE) proposed by Abadie and Imbens (2008). We only define it when the
number of pairs P is even, but in our application in Section 6 we propose a simple method to
extend it to cases where the number of pairs is odd. Let xg,p denote the value of a predictor of the
                                                                                                          x1,p +x2,p
outcome in pair p's unit g . Pairs are ordered according to their value of                                     2     ,   the two pairs
with the lowest value are matched together, the next two pairs are matched together, and so on
                              P
and so forth. Let R =         2.   For any r  {1, ..., R} and for any p  {1, 2}, let pr denote the treatment
effect estimator in pair p of pair of pairs r. Then, the POPVE is defined as

                                                                 R
                                                            1
                                               Vpop ( ) =              (1r - 2r )2 .
                                                            P2
                                                                 r=1


xg,p , the variable used to match pairs into pairs of pairs, could be the average value of the outcome
at baseline in pair p's unit g . Or it could be the covariate used to form the pairs, when only one
  7
      Extending those variance estimators when Assumption 2 fails is left for future work.


                                                                 9
covariate is used. In our application in Section 6, we use the baseline outcome to match pairs
into pairs of pair, because the covariates used to match units into pairs are unavailable in most
of the data sets of the papers we revisit. Based on Lemma 4.1, we will argue below that the
baseline outcome should often be a good choice to match pairs into pairs of pairs. The variable one
uses to form pairs of pairs should be pre-specified and not a function of the treatment assignment.
Otherwise, researchers could try to find the variable minimizing the POPVE, which would obviously
lead to incorrect inference.

   There are two differences between Vpop ( ) and the variance estimator proposed in Equation
(3) in Abadie and Imbens (2008). First, we match pairs with respect to a single covariate, while
Abadie and Imbens (2008) consider matching with respect to a potentially multidimensional vector
of covariates. This difference is not of essence: we could easily allow pairs to be matched on several
covariates. We focus on the unidimensional case as that is the one we use in our application, where
the matching is done based on the baseline outcome. Second, the estimator in Abadie and Imbens
(2008) matches pairs with replacement, while Vpop ( ) matches pairs without replacement. If after
                                             x1,p +x2,p
ordering pairs according to their value of        2     ,   pair 2 is closer to pair 3 than pair 4, pair 2 will
be matched both to pairs 1 and 3 in Abadie and Imbens (2008), while Vpop ( ) will match pair 1 to
pair 2, and pair 3 to pair 4. Matching without replacement makes the finite-sample properties of
Vpop ( ) easier to analyze, but should not change its large-sample properties.

   The second alternative variance estimator we consider is that proposed by Bai et al. (2019) in
their Equation (20) (BRSVE). Again, we define this estimator when the number of pairs P is even.
With our notation, their estimator is

                                         P                       R
                                     1         2     1      2                    2
                          Vbrs ( ) = 2         p   -                   1r 2r +       .
                                    P                2      P2                   P
                                         p=1                     r=1


Bai et al. (2019) propose another variance estimator in their Equation (27). That estimator is less
amenable to simple comparisons with the UCVE, PCVE, and POPVE, so we do not analyze its
properties. However, we compute it in our applications, and find that it is typically similar to the
POPVE and BRSVE.




                                                     10
4        Main results

In this section, we present our main findings, that are derived under Assumption 2. Then, the
number of treated and untreated observations are equal: T = C = n/2, so

                            P         2            ngp                               ngp            P
                                 2                                                                        p
                       =                     Wgp              Yigp - (1 - Wgp )            Yigp =           .
                                 n                                                                        P
                           p=1       g =1          i=1                               i=1            p=1


 is the average of the treatment-effect estimators in each pair. Then, by Point 3 of Assumption 1,

                                                                  P
                                                 V( ) =                V(p )/P 2 .                                  (3)
                                                                 p=1


        Finally, under Assumption 2, one can show that the difference-in-means and the fixed-effects
estimators are equal:  = f e ,8 and that both are unbiased estimators of the ATE.


4.1       Finite-sample results

In this section, we consider the finite-sample properties of the six variance estimators we study. Let
     1
·r = 2 (1r + 2r ) denote the average treatment effect in pair of pairs r.

Lemma 4.1. If Assumptions 1 and 2 hold and P is even,9

                                               P                                         1      P
    1. Vpair ( ) = Vpair (f e ), and E        P -1 Vpair ( )           = V( ) +      P (P -1)   p=1 (p    -  )2 .

                                 1          R
    2. E Vpop ( ) = V( ) +       P2         r=1 (1r   - 2r )2 .

    3. Vbrs ( ) = 1             1
                  2 Vpair ( ) + 2 Vpop ( )

            1   R           1                        1           R
    4. If   R   r=1   p=1,2 2 (pr    - ·r )2       R -1          r=1 (·r   -  )2 ,

                                  P
          (a) E Vpop ( )  E      P -1 Vpair ( )           ,
                                  P
           (b) E Vpop ( )  E     P -1 Vbrs ( )        ,
                                  P
           (c) E Vbrs ( )  E     P -1 Vpair ( )       .

Proof. See Appendix A.
    8
     For this result to hold, we can relax Assumption 2 as long as the two randomization units in a pair have the
same number of observations.
   9
     Point 1 of the lemma holds even if P is uneven.




                                                                   11
   Point 1 shows that the PCVEs without and with pair fixed effects are equal, and that after a
degrees-of-freedom correction, they are conservative estimators of the variance of  . This second
statement follows from Proposition 1 in Imai et al. (2009), once noted that the PCVE without pair
fixed effects is equal to the sample variance of the pair-level-treatment-effect estimators p . The
PCVEs are unbiased if the treatment effect is constant across pairs.
   Point 2 shows that the POPVE is conservative in general, and unbiased if the treatment effect
is constant within pairs-of-pairs. The less treatment effect heterogeneity within pairs of pairs, the
less conservative the POPVE. An important practical consequence of Point 2 is that the variable
used to form pairs of pairs should be a good predictor of pairs' treatment effect. The baseline value
of the outcome may often be a good predictor of pairs' treatment effect. For instance, treatments
sometimes produce a stronger effect on units with the lowest baseline outcome, thus leading to a
catch-up mechanism (see for instance Glewwe et al., 2016). Point 2 of Lemma 4.1 is related to
Theorem 1 in Abadie and Imbens (2008), though there are a few differences. Abadie and Imbens
(2008) assume that the experimental units are drawn from a super population, and show that
once properly normalized, their estimator is consistent for the normalized variance of  conditional
on the covariates used for pairing. The fact that the POPVE is conservative in Lemma 4.1 and
consistent in their Theorem 1 comes from the fact we do not assume that the experimental units
are an i.i.d. sample from a super population. In our setting, P Vpop ( ) remains conservative even
when the number of units and pairs goes to infinity, as shown in Theorem 4.4 below.
   Point 3 shows that the BRSVE is equal to the average of the PCVE and POPCVE. Then,
                                       P
it follows from Points 1 and 2 that   P -1 Vbrs ( )   is conservative. Point 3 is related to Lemma 6.4
and Theorem 3.3 in Bai et al. (2019), where the authors show that P Vbrs ( ) is consistent for the
normalized variance of  . Here as well, the fact that P Vbrs ( ) is conservative in Lemma 4.1 and
consistent in Bai et al. (2019) comes from the fact we do not assume that the experimental units
are an i.i.d. sample drawn from a super population.
   Finally, Point 4 shows that if the treatment effect varies less within than across pairs of pairs,
the POPVE is less conservative than the degrees-of-freedom-adjusted PCVE and BRSVE, and the
BRSVE is less conservative than the degrees-of-freedom-adjusted PCVE. A sufficient condition to
                                                                                  1   R
have that the treatment effect varies less within than across pairs of pairs is   R   r=1 (1r   -  )(2r -
 )  0, meaning that the covariance between the treatment effects of the two pairs in the same
pair of pairs is positive. In Section 6, we compare the three variance estimators in a number of
empirical applications.


                                                      12
         Overall, Lemma 4.1 shows that four of the variance estimators we consider are conservative.
In the fixed population framework of Neyman (1923) and Abadie et al. (2020) we adopt here, it
is common to have conservative variance estimators when the treatment effect is heterogeneous.
For instance, Abadie et al. (2020) show that in randomized experiments where n1 units out of n
are assigned to the treatment, the standard heteroskedasticity-robust variance estimator is also
conservative if the treatment effect is heterogeneous, so having a conservative variance estimator is
not specific to our paper.

         Contrary to the four estimators in Lemma 4.1, the UCVE with fixed effects may be very liberal.



Lemma 4.2. If Assumption 2 holds, then Vpair ( ) = 2Vunit (f e ).

Proof. See Appendix D.

         Lemmas 4.1 and 4.2 imply that the UCVE with pair fixed effects may be downward biased:
under constant treatment effects, its expectation is equal to a half of the true variance of  . Then,
using that estimator may severely distort inference on  . In Section E of the Web Appendix, we
show that Lemma 4.2 still approximately holds when Assumption 2 fails, unless randomization
units in the same pair have very heterogeneous numbers of observations. Specifically, Lemma E.1
shows that Vunit (f e )/Vpair (f e ) is included between 1/2 and 5/9 as long as n1p /n2p is included
between 0.5 and 2 for all p, meaning that in each pair the first randomization unit has between half
and twice as many observations as the second one. This condition should hold in most applications.
         Intuitively, the UCVE is biased because it does not account for the perfect negative correlation
of the treatments of the two units in the same pair, a correlation accounted for by the PCVE.10
However, the direction of the bias depends on whether fixed effects are included in the regression.
Indeed, the next lemma shows that without fixed effects, the UCVE will often be upward biased,
and more upward biased than the PCVE without fixed effects. For all d  {0, 1}, let y p (d) 
1
2        g   y gp (d), and y (d)    p y p (d)/P .


    10
    In matching studies, Abadie and Spiess (2016) highlight a different but related phenomenon: matching on
covariates leads to a correlation between the matched units' outcomes, which has to be accounted for, for instance
by clustering.




                                                       13
Lemma 4.3. If Assumptions 1 and 2 hold, then

              P                                  2         1
        E        Vunit ( ) - Vpair ( )       =                          y p (0) - y (0)    y p (1) - y (1)
            P -1                                 P       P -1       p

                                                 1                1
                                             -                      y (0) - y p (0)       y gp (1) - y p (1)   .
                                                 P   p        g
                                                                  2 gp

Proof. See Appendix D.

   Lemma 4.3 shows that the expectation of the difference between the UCVE and PCVE in
regressions without fixed effects is proportional to the difference between the between-pair and
within-pair covariance of the two potential outcomes. In most applications, both terms should be
positive, as the two potential outcomes should be positively correlated. One may also expect their
difference to be positive, as units in the same pair should have more similar potential outcomes than
units in different pairs. For instance, in the extreme case where units in the same pair have equal
potential outcomes, the second term is equal to 0. Then, the expectation of the difference between
the UCVE and PCVE is positive, and it follows from Point 1 of Lemma 4.1 that the UCVE is
upward biased. Contrary to the PCVEs, POPVE, and BRSVE, the UCVE in regressions without
fixed effects is biased even when the treatment effect is homogeneous across pairs.
   The clustered-variance estimators we study are those proposed in Liang and Zeger (1986). Typ-
ically, statistical softwares report degrees-of-freedom (DOF) adjusted versions of those estimators:
the Liang and Zeger estimator is multiplied by n/(n - K ), where n is the sample size and K the
number of regressors (see (StataCorp, 2017)).11 In general, this DOF adjustment does not change
the estimator very much. An exception is when the regression has pair fixed effects, and when each
randomization unit has only one observation. Then, n/(n - K ) = 2P/(P - 1): the regression has
2P observations and P + 1 regressors. This fact and Lemma 4.2 imply that in this special case,
the unclustered DOF adjusted variance estimator is almost equal to the PCVE. Then, Theorem
4.4 below implies that if the treatment effect is constant across pairs, t-tests using the unclustered
DOF adjusted variance estimator have nominal size, as found by Bruhn and McKenzie (2009). On
the other hand, the DOF-adjusted PCVE is too large, and becomes conservative. Outside of the
one-observation-per-randomization-unit special case, the DOF adjustment does not matter much,
especially when randomization units have a large number of observations. In our survey of paired
  11
     In Stata, this degrees-of-freedom adjustment is implemented when one uses the regress command with pair
indicators, not when one uses the xtregress command (see Cameron and Miller (2015)).



                                                         14
experiments above, the median number of observations per randomization unit is equal to 99.


4.2     Large sample results

Let

        2                    P V( )
        pair = lim
                 P + P V( ) + 1           2
                              P  p (p -  )

        2                          P V( )
        pop = lim                      1
                 P +  P V( ) +         Pr (1r - 2r )
                                                      2

         2                                     P V( )
         brs   = lim                1                      1
                 P + P V( ) +                          2                             -  )2
                                   2P     r (1r - 2r ) + 2P                 p (p
                 1                                        1                  1
      cov,P    =     (y p (0) - y (0))(y p (1) - y (1)) -                              y gp (0) - y p (0)   y gp (1) - y p (1)
                 P p                                      P             p
                                                                             2   g

        2                                  P V( )
        unit = lim                    1                       ,
                P + P V( )        +                 2
                                      P    p (p -  ) + 2cov,P


where Assumption 3 below ensures the limits in the previous display exist.

Assumption 3.

                                            2+
  1. For every d, g and p, y gp (d)               M < +, for some M ,                        > 0.

                             1              1                       1
  2. When P  +,              P        p p , P    p (p   -  )2 ,     P       r (1r    - 2r )2 , and cov,P converge towards
                                                           1
        finite limits, and P V( ) and P V( ) +             P        p (p    -  )2 + 2cov,P converge towards strictly
        positive finite limits.

                         P                       2+
                         p=1 E[|p
  3. As P  ,                          - p |2+ ]/SP   0 for some                                  2  P 2 V( ).
                                                                                     > 0, where SP

      Point 1 of Assumption 3 guarantees that we can apply the strong law of large numbers (SLLN)
                                          2 )+ . Point 2 ensures that P V ( ) and P V
in Lemma 1 in Liu (1988) to the sequence (p  p=1                                      unit ( ) do

not converge towards 0. Point 3 guarantees that we can apply the Lyapunov central limit theorem
to (p )+ 
       p=1 . Then,


Theorem 4.4. (t-stats' asymptotic behavior) Under Assumptions 1, 2 and 3,

                                                                        d
  1. ( -  )/        Vpair ( ) = (f e -  )/ Vpair (f e ) - N (0, pair
                                                                2 ).  2
                                                                     pair  1, and if p =  for
                 2
        every p, pair = 1.

                                 d
  2. ( -  )/        Vpop ( ) - N (0, pop
                                     2 ).  2  1, and if  = 
                                          pop           1r
                                                                            2
                                                           2r for every r , pop = 1.




                                                               15
                          d
  3. ( -  )/      Vbrs ( ) - N (0, brs
                                   2 ).  2  1, and if  =  for every p,  2 = 1.
                                        brs           p                brs

                                  d
  4. (f e -  )/    Vunit (f e ) - N (0, 2pair
                                         2 ).


                              d
  5. ( -  )/      Vunit ( ) - N (0, unit
                                    2 ).


         2     2  2                                          1    R
  6. (a) pair  brs pop if and only if 0  limP +              R    r=1 (1r   -  )(2r -  ).
           2
       (b) unit  2
                 pair if and only if cov,P converges towards a positive limit.

Proof. See Appendix D.
   Point 1 (resp. 2, 3) shows that when the number of pairs grows, the t-statistic of the difference-
in-means or fixed-effects estimator using the PCVEs (resp. POPVE, BRSVE) converges to a normal
distribution with a mean equal to 0 and a variance lower than 1 in general, but equal to 1 when
the treatment effect is homogenous across pairs. Therefore, those t-tests are conservative. Point 6a
shows that whenever there is a positive correlation between the treatment effects of the two pairs in
the same pair of pair, the t-test using the POPVE is less conservative than that using the BRSVE,
which is itself less conservative than that using the PCVE.

   Point 4 shows that the t-statistic of the fixed-effects estimator using the UCVE converges to a
normal distribution with a mean equal to 0 and a variance twice as large as that of the t-statistic
using the PCVE. Therefore, comparing that t-statistic to critical values of a standard normal could
lead to a test with a size larger than its nominal size. For instance, if  = 0 and the treatment effect
is homogenous across pairs, comparing f e / Vunit (f e ) to 1.96 would lead the analyst to reject
the null hypothesis that  = 0 16.5% of the times. With heterogeneous treatment effects across
pairs, the t-tests using the PCVEs, POPVE, and BRSVE may be conservative, while that using
the UCVE with fixed effects may be exact. However, in practice, we do not know if the treatment
effect is constant or heterogeneous, and it is common to require that a test control size uniformly
across all possible data generating processes. The t-tests making use of the PCVEs, BRSVE, and
POPVE satisfy that property, unlike the t-test making use of the UCVE with fixed effects.

   Finally, Point 5 shows that in general the t-statistic of the difference-in-means estimator using
the UCVE converges towards a normal distribution with a mean equal to 0 and a variance that
differs from 1. As shown in Point 6b, the asymptotic variance of this t-statistic is lower than that
of the t-statistic using the PCVE whenever the difference between the between- and within-pairs
covariance between the two potential outcomes is positive. Then, that t-statistic is conservative,


                                                  16
and it is more conservative than that using the PCVE. Point 5 is related to Theorem 3.1 in Bai et al.
(2019), who show that when ngp = 1, the t-test in Point 5 is conservative. The asymptotic variance
we obtain is different from theirs, because our two results are derived under different assumptions.
For instance, we assume a fixed population, while Bai et al. (2019) assume that the experimental
units are an i.i.d. sample drawn from an infinite superpopulation, and that asymptotically the
expectation of the potential outcomes of two units in the same pair become equal.


5    Simulations using real data

To assess if in practice, the size of the t-tests we consider is close to that predicted by Theorem
4.4, we performed Monte-Carlo simulations using a real data set. We use the data from the
microfinance experiment in Cr´
                             epon et al. (2015). The authors matched 162 Moroccan villages into
81 pairs, and in each pair, they randomly assigned one village to a microfinance treatment. They
sampled households from each village and measured their outcomes such as their credit access and
income. In the paper, the authors report the effect of the microfinance intervention on 82 outcome
variables.
    For each outcome variable, we construct potential outcomes under the assumption of no effects,
i.e., yigpk (0) = yigpk (1) = Yigpk , where Yigpk is the value of outcome k for household i in village g and
                                                                j      j       j                 j       j
pair p. We then simulate 1000 vectors of treatment assignments Wk = ((W11,k , W21,k ), . . . , (W1P,k , W2P,k )),

assigning one of the two villages to treatment in each pair. Then, we regress Yigpk on the simulated
           j
treatment Wgp,k . We estimate regressions with and without pair-fixed effects, clustering standard
errors at the pair level and at the village (unit-of-randomization) level. Thus, we obtain four t-
statistics, and four 5% level t-tests. The estimated size of each t-test is just the percentage of times
the test is rejected across the 82,000 regressions (82 outcomes × 1000 simulations). Because the
data is generated under the hypothesis of no treatment effect, these t-tests should be rejected 5%
of the time.
    Table 1 shows the estimated sizes of the four t-tests. The sizes of the t-tests using pair-clustered
standard errors are close to 5%, irrespective of whether pair fixed effects are included in the re-
gression. On the other hand, when standard errors are clustered at the village level and pair fixed
effects are included, the size of the t-test is 17%, very close to the 16.5% level predicted by point 4
of Theorem 4.4. Finally, the size of the t-test with village-clustered standard errors without fixed
effects is equal to 1.3%. In this application, this t-test is very conservative.



                                                    17
   The fourth column of the table shows that we obtain similar results if we use a random sample of
20 of the 81 pairs. With less than 20 pairs, standard errors clustered at the pair level become liberal.
One may then have to use randomization inference tests. Similarly, in a small-strata experiment
with too few strata to cluster at that level, one could use randomization inference, or the variance
estimator proposed in Section 9.5.1 of Imbens and Rubin (2015), provided each stratum has at
least two treated and two control units.
                              Table 1: Fraction of times t-test is rejected

                                                                   5% level t-test size
               Clustering level     Pair Fixed Effects
                                                              With 81 pairs With 20 pairs
               Pair                           Yes                0.0505           0.0581
               Pair                           No                 0.0521           0.0595
               Village                        Yes                0.1719           0.1851
               Village                        No                 0.0132           0.0204
                 Table 1 reports the empirical size of four 5% level t-tests in Cr´epon et al. (2015).
                 For each of the 82 outcomes in the paper, we randomly drew 1000 simulated
                 treatment assignments, following the paired assignment used by the authors,
                 and regressed the outcome on the simulated treatment. The four t-tests are
                 computed, respectively, without and with fixed effects in the regression, and
                 clustering standard errors at the village or at the pair level. The size of each test
                 is the percent of times it is rejected across the 82,000 regressions (82 outcomes ×
                 1000 replications). Column 3 (resp. 4) shows the results using the original sample
                 of 81 pairs (resp. a smaller sample of 20 randomly selected pairs).


   For 26 of the 82 regressions in (Cr´
                                      epon et al., 2015), the baseline outcome is available in the
authors' data set, so for those outcomes we can simulate the POPVE and BRSVE as well. Those
estimators are defined under Assumption 2, which does not hold. Therefore in those simulations,
we aggregate the data at the village level. We use two samples of 80 and 20 randomly selected pairs
out of the original 81 pairs, so as to have an even number of pairs. For each outcome, we simulate
3,000 vectors of treatment assignments, assigning one of the two villages to treatment in each pair.
Then, we compute  , Vpair ( ), Vpop ( ), and Vbrs ( ), and the three corresponding 5% level t-tests.
The estimated size of each t-test is shown in Table 2 below. As above, the t-test using the PCVE has
close to nominal size with as few as 20 pairs. On the other hand, the t-tests using the POPVE and
BRSVE have greater than nominal size, even with 80 pairs. Accordingly, we run simulations again,
duplicating the random sample of 80 pairs twice to have 160 pairs. The t-test using the BRSVE now
has close to nominal size, but the t-test using the POPVE still has greater than nominal size. With
a sample of 320 pairs obtained by duplicating the random sample of 80 pairs four times, all tests
have close to nominal size. With 20 and 80 pairs, we find in our simulations that the correlation
between Vpop ( ) and | | is much weaker than that between Vpair ( ) and | |. This explains why the

                                                       18
t-test using Vpop ( ) is liberal, despite the fact Vpop ( ) is unbiased: when | | is large, Vpop ( ) is less
likely to be large than Vpair ( ), so the POPVE t-test is more liberal. With 160 and 320 pairs, this
phenomenon becomes less pronounced. Overall, the asymptotic approximations in Points 2 and 3
of Theorem 4.4 seem to hold only with a large number of pairs, contrary to that in Point 1. In
our survey of paired experiments, only one paper has more than 160 pairs, so it seems that t-tests
based on the POPVE and BRSVE can only be used in a minority of paired experiments.

       Table 2: Simulations with data aggregated at village-level to compute Vpop and Vbrs

                                                          5% level t-test size
      Variance estimator
                               With 20 pairs        With 80 pairs With 160 pairs             With 320 pairs
      Vpair ( )                   0.0591               0.0515           0.0500                  0.0510
      Vpop ( )                    0.1307               0.0834           0.0638                  0.0568
      Vbrs ( )                    0.0826               0.0623           0.0551                  0.0531
        Table 1 reports the empirical size of three 5% level t-tests in Cr´ epon et al. (2015), aggregating the
        data at the village level. For each of the 26 outcomes in the paper for which the baseline outcome is
        available, we randomly drew 3,000 simulated treatment assignments, following the paired assignment
        used by the authors, and computed the treatment effect estimator  , the variance estimators Vpair ( ),
        Vpop ( ), and Vbrs ( ), and the three corresponding t-tests. The size of each test is the percent of times
        it is rejected across the 78,000 regressions (26 outcomes × 3,000 replications). Column 2 (resp. 3,
        4, 5) shows the results using a random sample of 20 pairs (resp. a random sample of 80 pairs, the
        same random sample of 80 pairs duplicated twice, the same random sample of 80 pairs duplicated four
        times).




6    Application

In this section, we revisit the paired randomized experiments we found in our survey. The data
used in four of those papers is publicly available. Therein, the authors estimated the effect of
the treatment in 294 regressions, clustering standard errors at the unit-of-randomization level. In
Panel A of Table 3, we re-estimate those regressions, clustering standard errors at the pair level, and
including the same controls as the authors. In the 240 regressions with fixed effects, the average
ratio of the UCVE and PCVE is equal to 0.548. Those ratios are not all exactly equal to 1/2
because Assumption 2 is not always satisfied, but they all are quite close to 1/2, as predicted by
Lemma E.1 in the Web Appendix. The authors originally found that the treatment has a 5%-
level significant effect in 110 regressions. Using pair-clustered standard errors, we find significant
effects in 74 regressions. In the 54 regressions without fixed effects, the UCVE is on average 1.18
times larger than the PCVE. The authors originally found 31 significant effects, whereas we find
36 significant significant effects using PCVE.


                                                         19
   Of the remaining five papers, one used standard errors assuming homoskedastic errors. This
is not an inference method we consider so we do not include it in our replication. Three papers
estimated 132 regressions with fixed effects, clustering standard errors at the unit-of-randomization
level. For those regressions, we multiply the UCVE by the average ratio of the PCVE and UCVE
found in Panel A of Table 3 to predict the value of the PCVE. Panel B of Table 3 shows that while
the authors originally found a 5%-level significant effect in 52 regressions, we find significant effects
in 35 regressions using our predicted PCVE. The last paper only estimated regressions without pair
fixed effects. As the ratio of the PCVE and UCVE can vary a lot across applications, we do not
try to predict the PCVE in that paper.

      Table 3: Using unit- or pair-level clustered variance estimators in paired experiments

                                                              Number of          Number of
                                    Unit-level divided
                                                              5%-level           5%-level
                                    by pair-level                                                    Number of
                                                              significant        significant
                                    clustered variance                                               Regressions
                                                              effects with       effects with
                                    estimators
                                                              UCVE               PCVE
  Panel A: Articles with publicly available data
   with pair fixed effects             0.548                        110                 74                240
   without pair fixed effects          1.184                         31                 36                 54
  Panel B: Articles without publicly available data
   with pair fixed effects                                           52                 35                132
    The table shows the effect of using pair- rather than unit-level clustered standard errors in seven of the paired
    randomized experiments we found in our survey. In Panel A, we consider four papers whose data is available
    online, and re-estimate their regressions clustering standard errors at the pair level. Column 1 shows the ratio
    of the unit- and pair-level clustered variance estimators, separately for regressions without and with pair fixed
    effects. Column 2 (resp. 3) shows the number of 5%-level significant effects using unit- (resp. pair-) clustered
    standard errors. In Panel B, we consider three other papers whose data is not available online, and use the
    average ratio of the unit- and pair- clustered variance estimators found in Panel A to predict the value of the
    pair-clustered estimator in the regressions with fixed effects estimated by those papers. Column 2 (resp. 3)
    shows the number of 5%-level significant effects using unit- (resp. predicted pair-) clustered standard errors.


   For 152 of the 294 regressions in Panel A of Table 3, the baseline outcome is available in the
authors' data set, so we can estimate the POPVE and BRSVE as well. Those estimators are
defined under Assumption 2, which does not hold in all those regressions. Therefore, we compute
the POPVE and BRSVE after aggregating the data at the unit-of-randomization level. When the
number of pairs is odd, we compute the POPVE twice, first excluding the pair with the lowest value
of the baseline outcome, then excluding the pair with the highest value of the baseline outcome, and
we finally take the average of the two estimators. We do the same for the BRSVE when the number
of pairs is odd. We also recompute the PCVE without pair fixed effects with the aggregated data,
using the exact same sample as that used to compute the POPVE and BRSVE. Across those 152


                                                         20
regressions, the POPVE divided by the PCVE is on average equal to 1.003. The BRSVE divided
by the PCVE is on average equal to 1.002.12 Overall, it does not seem one can expect large power
gains from using the POPVE and BRSVE.


7     Conclusion

Researchers conducting paired or small-strata experiments often use pair- or strata-fixed-effects
regressions and cluster standard errors at the unit-of-randomization level to make inference about
the average treatment effect. We show that the corresponding t-test can overreject the null of no
effect. Instead, we recommend using standard errors clustered at the pair or strata level.




  12
     The second variance estimator proposed by Bai et al. (2019) in their Equation (27) is also on average higher than
the PCVE.


                                                         21
References

Abadie, A., Athey, S., Imbens, G. W. and Wooldridge, J. (2017), When should you adjust standard
  errors for clustering?, Technical report, National Bureau of Economic Research.

Abadie, A., Athey, S., Imbens, G. W. and Wooldridge, J. M. (2020), `Sampling-based versus design-
  based uncertainty in regression analysis', Econometrica 88(1), 265­296.
  URL: https://onlinelibrary.wiley.com/doi/abs/10.3982/ECTA12675

Abadie, A. and Imbens, G. W. (2008), `Estimation of the conditional variance in paired experi-
  ments', Annales d'Economie et de Statistique pp. 175­187.

Abadie, A. and Spiess, J. (2016), Robust post-matching inference, in `Unpublished Paper). MIT
  and Harvard University. Retrieved from https://editorialexpress. com/cgi-bin/conference/down
  load. cgi'.

Ambler, K., Aycinena, D. and Yang, D. (2015), `Channeling remittances to education: a field
  experiment among migrants from el salvador', American Economic Journal: Applied Economics
  7(2), 207­32.

Angelucci, M., Karlan, D. and Zinman, J. (2015), `Microcredit impacts: Evidence from a random-
  ized microcredit program placement experiment by compartamos banco', American Economic
  Journal: Applied Economics 7(1), 151­82.

Angrist, J. D. and Pischke, J. S. (2008), Mostly Harmless Econometrics: An Empiricist's Compan-
  ion, Princeton University Press.

Ashraf, N., Karlan, D. and Yin, W. (2006), `Deposit collectors', Advances in Economic Analysis &
  Policy 5(2).

Athey, S. and Imbens, G. W. (2017), Chapter 3 - the econometrics of randomized experiments,
  in A. V. Banerjee and E. Duflo, eds, `Handbook of Field Experiments', Vol. 1 of Handbook of
  Economic Field Experiments, North-Holland, pp. 73 ­ 140.

Attanasio, O., Augsburg, B., De Haas, R., Fitzsimons, E. and Harmgart, H. (2015), `The impacts
  of microfinance: Evidence from joint-liability lending in mongolia', American Economic Journal:
  Applied Economics 7(1), 90­122.



                                               22
Bai, Y., Romano, J. P. and Shaikh, A. (2019), Inference in experiments with matched pairs, Tech-
  nical Report 2019-63, University of Chicago, Becker Friedman Institute for Economics Working
  Paper.

Banerjee, A., Duflo, E., Glennerster, R. and Kinnan, C. (2015), `The miracle of microfinance? evi-
  dence from a randomized evaluation', American Economic Journal: Applied Economics 7(1), 22­
  53.

Banerji, R., Berry, J. and Shotland, M. (2017), `The impact of maternal literacy and participa-
  tion programs: Evidence from a randomized evaluation in india', American Economic Journal:
  Applied Economics 9(4), 303­37.

Beuermann, D. W., Cristia, J., Cueto, S., Malamud, O. and Cruz-Aguayo, Y. (2015), `One lap-
  top per child at home: Short-term impacts from a randomized experiment in peru', American
  Economic Journal: Applied Economics 7(2), 53­80.

Bj¨
  orkman Nyqvist, M., de Walque, D. and Svensson, J. (2017), `Experimental evidence on the long-
  run impact of community-based monitoring', American Economic Journal: Applied Economics
  9(1), 33­69.

Bruhn, M., Le~
             ao, L. d. S., Legovini, A., Marchetti, R. and Zia, B. (2016), `The impact of high
  school financial education: Evidence from a large-scale evaluation in brazil', American Economic
  Journal: Applied Economics 8(4), 256­95.

Bruhn, M. and McKenzie, D. (2009), `In pursuit of balance: Randomization in practice in devel-
  opment field experiments', American Economic Journal: Applied Economics 1(4), 200­232.

Cameron, A. C. and Miller, D. L. (2015), `A practitioner's guide to cluster-robust inference', Journal
  of Human Resources 50(2), 317­372.

Cr´
  epon, B., Devoto, F., Duflo, E. and Parient´
                                             e, W. (2015), `Estimating the impact of microcredit on
  those who take it up: Evidence from a randomized experiment in morocco', American Economic
  Journal: Applied Economics 7(1), 123­50.

de Chaisemartin, C. and Ramirez-Cuellar, J. (2020), `At what level should one cluster standard
  errors in paired experiments, and in stratified experiments with small strata?', arXiv preprint
  arXiv:1906.00288v4 .


                                                 23
Fryer Jr, R. G. (2017), Management and student achievement: Evidence from a randomized field
  experiment, Technical report, National Bureau of Economic Research.

Fryer Jr, R. G., Devi, T. and Holden, R. T. (2016), Vertical versus horizontal incentives in education:
  Evidence from randomized trials, Technical report, National Bureau of Economic Research.

Glewwe, P., Park, A. and Zhao, M. (2016), `A better vision for development: Eyeglasses and
  academic performance in rural primary schools in china', Journal of Development Economics
  122, 170­182.

Imai, K., King, G. and Nall, C. (2009), `The essential role of pair matching in cluster-randomized
  experiments, with application to the mexican universal health insurance evaluation', Statistical
  Science 24(1), 29­53.

Imbens, G. W. and Rubin, D. B. (2015), Causal inference in statistics, social, and biomedical
  sciences, Cambridge University Press.

Lafortune, J., Riutort, J. and Tessada, J. (2018), `Role models or individual consulting: The
  impact of personalizing micro-entrepreneurship training', American Economic Journal: Applied
  Economics 10(4), 222­45.

Liang, K.-Y. and Zeger, S. L. (1986), `Longitudinal data analysis using generalized linear models',
  Biometrika 73(1), 13­22.

Liu, R. Y. (1988), `Bootstrap procedures under some non-iid models', The Annals of Statistics
  16(4), 1696­1708.

Muralidharan, K. and Niehaus, P. (2017), `Experimentation at scale', Journal of Economic Per-
  spectives 31(4), 103­24.

Neyman, J. (1923), `Sur les applications de la th´
                                                 eorie des probabilit´
                                                                     es aux experiences agricoles:
  Essai des principes', Roczniki Nauk Rolniczych 10, 1­51.

Panagopoulos, C. and Green, D. P. (2008), `Field experiments testing the impact of radio adver-
  tisements on electoral competition', American Journal of Political Science 52(1), 156­168.

Somville, V. and Vandewalle, L. (2018), `Saving by default: Evidence from a field experiment in
  rural india', American Economic Journal: Applied Economics 10(3), 39­66.

StataCorp, L. (2017), Stata User's Guide, 15 edn, College Station, Texas.

                                                  24
A       Main text proofs

Proof of Lemma 4.1

Point 1

Proof of Vpair ( ) = Vpair (f e )


    It follows from Equations (1) and (2) that

                                                                              P
                               +  Wgp + igp = f e Wgp +                           p igp + uigp .
                                                                          p=1


Rearranging and using the fact that under Assumption 2  = f e , one obtains that for every p:


                                                 igp = p -  + uigp .                                                          (4)


Then,

                                P
                          1
              Vpair ( ) = 2           (SETp - SEUp )2
                         T
                                p=1
                                                                          2
                            1
                          = 2                    (2Wgp - 1)igp
                           T     p       g   i
                                                                                          2
                            1
                          = 2                    (2Wgp - 1)(p -  + uigp )
                           T     p       g   i
                                                                                                                  2
                            1
                          = 2                    (2Wgp - 1)uigp + (p - )                             (2Wgp - 1)
                           T     p       g                                                g
                                             i                                                   i
                                                                 2
                            4
                          = 2                        Wgp uigp        .                                                        (5)
                           T     p       g   i


The first equality follows from Point 1 of Lemma 3.1 and Assumption 2. The third equality follows
from Equation (4). The fifth follows from the following two facts. First,                                g   i (2Wgp   - 1)uigp =
2   g    i Wgp uigp   -   g   i uigp   = 2       g     i Wgp uigp ,      since       g   i uigp      = 0 by definition of uigp .
Second, (p - )        g   i (2Wgp - 1)   = (p - )           g        i Wgp    -     g    i (1   - Wgp ) = (p - )[Tp - Cp ] =
0, where the last equality comes from the fact that n1p = n2p by Assumption 2.




                                                                25
   Similarly,

                                              P                               P                                2
                                       4                2             4
                        Vpair (f e ) = 2             SETp,f e       = 2                             Wgp uigp       ,                        (6)
                                      T                              T                  g
                                             p=1                          p=1                   i


where the first equality follows from Point 3 of Lemma 3.1 and Assumption 2. Combining Equations
(5) and (6) yields Vpair ( ) = Vpair (f e ).

                  P                                      1          P
   Proof of E    P -1 Vpair ( )         = V( ) +     P (P -1)       p=1 (p    -  )2


   Under Assumption 2, T = C = n/2, so

                 P                               2
                           SETp SEUp
   Vpair ( ) =                 -
                            T    C
                 p=1
                       P
               4
             = 2             (SETp - SEUp )2
              n
                       p=1
                       P                                                          2
               4
             = 2                        (Wgp igp - (1 - Wgp )igp )
              n                g
                       p=1          i
                       P                                        2
               4
             = 2                        (2Wgp - 1)igp
              n                g
                       p=1          i
                       P                                                                2
               4
             = 2                   (2Wgp - 1)            (Yigp -  Wgp - )
              n                g
                       p=1                           i
                       P                                                                              2
               4                                                         np   np
             = 2                   (2Wgp - 1)                Yigp -  Wgp    -
              n                g
                                                                         2    2
                       p=1                               i
                       P                                                                                                                2
               4                                                 np                            np
             = 2                   (2Wgp - 1)            Yigp -               (2Wgp - Wgp ) -                              (2Wgp - 1)
              n                g
                                                                 2        g
                                                                                               2                       g
                       p=1                           i
                       P                                                                    2
               4                                                 np
             = 2                   (2Wgp - 1)            Yigp -                   Wgp
              n                g
                                                                 2        g
                       p=1                           i
                       P                                                  2
               4                                                 np
             = 2                   (2Wgp - 1)            Yigp - 
              n                g
                                                                 2
                       p=1                           i
                       P
                 4                np   np    2
             =                p      -
                 n2               2    2
                       p=1
                        P
               1
             = 2             (p -  )2 .                                                                                                     (7)
              P
                       p=1



                                                                    26
The third equality comes from the definition of SETp and SEUp . The fifth equality follows from
the Equation (1). The sixth equality follows from n1p = n2p = np /2, which is a consequence of
Assumption 2. The eighth equality comes from the fact that                         g (2Wgp - 1)   = 0, which follows from
Point 1 of Assumption 1. The ninth equality follows from Point 1 of Assumption 1. The tenth
equality follows from     g (2Wgp         - 1)     i Yigp   =     g   Wgp   i Yigp   -   g (1   - Wgp )   i Yigp   = np p /2.
The eleventh equality follows from Assumption 2.
   Now, consider Equation (7). Adding and subtracting  and p  E[p ],

                               P
                         1
          Vpair ( ) =                  ((p - p ) - ( -  ) + (p -  ))2
                         P2
                              p=1
                               P
                       1
                     = 2               (p - p )2 + ( -  )2 + (p -  )2 - 2(p - p )( -  )
                      P
                              p=1

                                                                     +2(p - p )(p -  ) - 2( -  )(p -  )] .


Taking the expected value, and given that E[ ] =  and E[p ] = p ,

                               P
                      1
       E[Vpair ( )] = 2                V(p ) + V( ) + (p -  )2 - 2Cov( , p )
                     P
                              p=1
                               P
                       1                       2
                     = 2                 1-         V(p ) + V( ) + (p -  )2
                      P                        P
                              p=1
                                                        P                   P
                             2                  1                    1
                     =    1-             V( ) + 2             V( ) + 2            (p -  )2
                             P                 P                    P
                                                        p=1                 p=1
                                                        P
                                   1               1
                     =    1-             V( ) +               (p -  )2 .
                                   P               P2
                                                        p=1


The second equality follows from the fact that by Point 3 of Assumption 1 and Assumption 2,
                                1                1
Cov(p ,  ) = Cov p ,          p P p        =     P V(p ).     The third equality comes from Equation (3). This
proves the result.




                                                                27
Point 2

                                               R
                                     1
                      Vpop ( ) =                   (1r - 2r )2 ,
                                     P2
                                           r=1
                                            R
                                     1              2    2
                                =                  (1r + 2r - 21r 2r ).
                                     P2
                                           r=1


Taking expected value,

                                               R
                                     1               2    2
                   E[Vpop ( )] =                   E(1r + 2r - 21r 2r ),
                                     P2
                                           r=1
                                            R
                                     1                                2    2
                                =                  (V(1r ) + V(2r ) + 1r + 2r - 21r 2r ),
                                     P2
                                           r=1
                                            P                            R
                                  1                        1
                                = 2                V(p ) + 2                   (1r - 2r )2 ,
                                 P                        P
                                           p=1                           r=1
                                                          R
                                                   1
                                = V( ) +                        (1r - 2r )2 .                             (8)
                                                   P2
                                                          r=1


The second equality follows from properties of the variance and that E[1r ] = 1r and E[2r ] = 2r .
The third equality follows from P = 2R. The fourth equality follows from Equation (3).


Point 3


                                1              2      1       2                        2
                   Vbrs ( ) =                  p -                        1r 2r +          .
                                P2     p
                                                      2       P2     r
                                                                                       P
                                 1                                  1
                           =                   (p -  )2 +                           2
                                                                                   (1    2
                                                                                     r + 2r - 21r 2r ).
                                2P 2       p
                                                                   2P 2        r
                            1           1
                           = Vpair ( ) + Vpop ( ).
                            2           2




                                                                28
Point 4


                                                                      P
                                            E[Vpop ( )]  E               Vpair ( ) ,
                                                                    P -1
                                                   R                                  P
                                                                         2
                                  (2R - 1)               (1r - 2r )  2R                    (p -  )2 ,
                                                   r=1                               p=1
                         R                                             R
                               2    2                                         2           2  2           2
           (2R - 1)           (1r + 2r - 21r 2r )  2R                        [1r - 21r  +  + 2r - 22r  +  ],
                        r=1                                           r=1
                                 R                              R
                   0                  (1r - 2r )2 + 2R                [21r 2r - 2(1r + 2r ) + 2 2 ],
                                r=1                             r=1
                                            R                                R
                                                            2
                               0                (1r - 2r ) + 4R                  (1r -  )(2r -  ).
                                         r=1                               r=1


The second inequality follows from Points 1 and 2 of this lemma. Let ·r = 1
                                                                          2 (1r + 2r ). Then,


                                                                      P
                                            E[Vpop ( )]  E               Vpair ( ) ,
                                                                    P -1
                    R                                       R
            0                    2(pr - ·r )2 + 4R               (1r - ·r + ·r -  )(2r - ·r + ·r -  ),
                   r=1 p=1,2                               r=1
                          R                                      R
                                       1
                  0                      (pr - ·r )2 + R               [(1r - ·r )(2r - ·r ) + (·r -  )2 ],
                                       2
                         r=1 p=1,2                               r=1
                                                                                                               
                        R                                       R
                                      1                                              1
              0                         (pr - ·r )2 + R               -                (pr - ·r )2 + (·r -  )2  ,
                                      2                                              2
                        r=1 p=1,2                           r=1              p=1,2
                                        R                                                 R
                               1                   1               1
                                                     (pr - ·r )2                              (·r -  )2 .
                               R                   2              R-1
                                       r=1 p=1,2                                       r=1


This proves inequality a).
              1   R                1           2           1          R           2
   Then, if   R   r=1        p=1,2 2 (pr + ·r )           R-1         r=1 (·r -  ) ,       it follows from Point 3 of the lemma
and the previous display that

                                    1               1    P
                        E Vpop ( )  E Vpop ( ) + E          Vpair ( )
                                    2               2  P -1
                                    1     P             1     P
                                    E        Vpop ( ) + E          Vpair ( )
                                    2  P -1             2   P -1
                                        P
                                   =E       Vbrs ( ) ,
                                      P -1



                                                                 29
which proves inequality b).
                   1     R            1                       1    R
   Similarly, if   R     r=1    p=1,2 2 (pr     + ·r )2     R -1   r=1 (·r   -  )2 , it follows from Point 3 of the
lemma and the previous display that

                                     1              1      P
                         E Vbrs ( )  E Vpop ( ) + E           Vpair ( )
                                     2              2    P -1
                                     1     P               1     P
                                     E        Vpair ( ) + E           Vpair ( )
                                     2  P -1               2   P -1
                                         P
                                    =E       Vpair ( ) ,
                                       P -1

which proves inequality c).
   QED.


Proof of Lemma 4.2

It follows from Lemma 3.1 that

                                                    P                                  2
                                                         2    2        1   1
                                  Vpair (f e ) =         p SETp,f e      +
                                                                      n1p n2p
                                                   p=1


and

                                                    P
                                                         2    2        1    1
                                 Vunit (f e ) =          p SETp,f e       + 2           .
                                                   p=1
                                                                      n2
                                                                       1p  n 2p


Under Assumption 2, n1p = n2p = np /2, for all p. Then,

                                         P                            2          P     2 SET 2
                                              2    2        2   2                      p    p,f e
                       Vpair (f e ) =         p SETp,f e      +           = 16                        .
                                                            np np                           n2
                                                                                             p
                                        p=1                                      p=1


Similarly,

                                         P                                       P   2 SET 2
                                               2    2        4    4                  p    p,f e
                        Vunit (f e ) =         p SETp,f e     2
                                                                + 2       =8                      .
                                                             np np                          n2
                                                                                             p
                                         p=1                                   p=1


   QED.




                                                            30
Proof of Lemma 4.3

Let Y gp       i Yigp /ngp ,   Yp (1)          g   Wgp Y gp , Yp (0)             g (1   - Wgp )Y gp , and Y (d)               p Yp (d)/P ,

d = 0, 1.

                                                                             1
                          E[Yp (1)] = E                  Wgp y gp (1) =                 y gp (1) = y p (1).                               (9)
                                                    g
                                                                             2    g


The second equality follows from Points 2 of Assumption 1. Similarly,


                                                        E[Yp (0)] = E[y p (0)]                                                           (10)

                                          E[Y (d)] = y (d),              for d  {0, 1}.                                                  (11)


Then, one has

                          8
Vunit ( ) - Vpair ( ) =              SETp SEUp
                          n2    p

                          8
                      =                       Wgp            (yigp (1) - Y (1))                (1 - Wgp )         (yigp (0) - Y (0))
                          n2    p         g                                                g
                                                        i                                                     i

                          8          n2
                                      p                           yigp (1)                                            yigp (0)
                      =                             Wgp                    - Y (1)                 (1 - Wgp )                  - Y (0)
                          n2    p
                                     4         g
                                                                    ngp                        g
                                                                                                                        ngp
                                                              i                                                   i
                        2                          2
                      = 2            Yp (1)Yp (0) - Y (1)Y (0)                                                                           (12)
                       P         p
                                                   P

The first equality follows from Points 1 and 2 of Lemma 3.1 and Assumption 2. The second equality
follows from the definitions of SETp , SEUp , and igp . The third equality follows from Point 1 of
Assumption 1, and Assumption 2. The fourth equality follows from Assumption 2 and some algebra.
Taking the expectation of (12),


E Vunit ( ) - Vpair ( )
    2                                         2                                                       2
=            Cov(Yp (1), Yp (0)) +                      (y p (1) - y (1))(y p (0) - y (0)) -            Cov(Y (1), Y (0))
    P2   p
                                              P2    p
                                                                                                      P

    2                                         2                                                       2           1                  1
=            Cov(Yp (1), Yp (0)) +                      (y p (1) - y (1))(y p (0) - y (0)) -            Cov                Yp (1),            Yp (0)
    P2   p
                                              P2    p
                                                                                                      P           P    p
                                                                                                                                     P    p
    2(P - 1)                                            2
=                   Cov(Yp (1), Yp (0)) +                         (y p (1) - y (1))(y p (0) - y (0)).
       P3      p
                                                        P2    p




                                                                    31
                                                           2                              2
The first equality follows from adding and substracting    P   E[Y (1)] E[Y (0)] and      P2       p E[Yp (1)] E[Yp (0)],
and from Equations (9), (10) and (11). The third equality follows from Point 3 of Assumption 1.
Therefore,

   P                            2                                     2
      E Vunit ( ) - Vpair ( ) = 2        Cov(Yp (1), Yp (0)) +                     (y p (0) - y (0))(y p (1) - y (1)).
 P -1                          P     p
                                                                  P (P - 1)    p

                                                                                                                   (13)

Finally,


    Cov Yp (1), Yp (0) = E[Yp (1)Yp (0)] - E[Yp (1)] E[Yp (0)]

                             1                   1                     1                       1
                        =      y 1p (1)y 2p (0) + y 2p (1)y 1p (0) -           y gp (1)                 y gp (0)
                             2                   2                     2   g
                                                                                               2    g
                          1                  1                  1                 1
                        = y 1p (1)y 2p (0) + y 2p (1)y 1p (0) - y 1p (1)y 1p (0) - y 2p (1)y 2p (0)
                          4                  4                  4                 4
                          1
                        =    y (1) - y 2p (1) y 2p (0) - y 1p (0)
                          4 1p
                            1
                        =-         y gp (0) - y p (0) y gp (1) - y p (1)                                           (14)
                            2 g


The second equality follows from Points 1 and 2 of Assumption 1, and Equations (9) and (10). The
third, fourth, and fifth equalities follow after some algebra. The result follows plugging Equation
(14) into (13).
   QED.




                                                   32
                            For Online Publication

B      Extension: stratified experiments with few units per strata

In this section, we perform Monte-Carlo simulations to assess how our results in section 4 extend to
stratified experiments where the number of units per strata is larger than two, but still fairly small.
Three main findings emerge. First, t-tests using stratum-clustered standard errors have nominal
size. Second, t-tests using standard errors clustered at the unit of randomization level are liberal in
regressions with strata fixed effects, but become less liberal as the number of randomization units
per strata increases. With 5 units per strata, the empirical size of a 5% level test with UCVE and
fixed effects is around 7.8%, while with 10 units per strata it is around 6.6%. Finally, t-tests using
standard errors clustered at the unit of randomization level are typically conservative in regressions
without strata fixed effects.
     We draw the potential and observed outcomes from the following data generating process
(DGP),


    Yigp = Wgp yigp (1) + (1 - Wgp )yigp (0) + p ,    i = 1, . . . , ngp ; g = 1, . . . , G; p = 1, . . . , P,   (15)


where yigp (1) and yigp (0) are independent and both follow a N (0, 1) distribution, {p }p  iid N (0, 2 ),
                                                               
and (yigp (1), yigp (0))  p . We either let  = 0 or  = 0.1.  = 0 corresponds to a model
                                                  
with no stratum common shock, while  = 0.1 corresponds to a model with a shock. We
draw potential outcomes once and keep them fixed, so yigp (1), yigp (0) and p do not vary across
simulations.
     Each stratum has G randomization units. We vary G from two to ten. If G is even, then half
of the units are randomly assigned to the control and the remaining to the treatment. If G is odd,
then (G + 1)/2 units are randomly assigned to the control. We also set ngp = 5 or ngp = 100, and
we let P = 100.
     For each simulation, treatment is randomly assigned to G/2 or (G - 1)/2 units per stratum. We
compute t-tests based on unit- and stratum-clustered standard errors in regressions of the outcome
on the treatment with and without strata fixed effects. We perform 10,000 simulations for each
DGP. Table 4 presents the size of the t-tests in each DGP.
     t-tests using stratum-clustered standard errors achieve 5% size for all values of the number



                                                     33
of units per strata, G. In contrast, t-tests based on unit-clustered standard errors in regressions
with fixed effects overreject the true null of no treatment effect. These results are in line with
Points 1 and 2 of Theorem 4.4, which covered the special case where G = 2. t-tests based on unit-
clustered standard errors in regressions with fixed effects overreject less as the number of units per
strata increases from two (column 2) to ten (column 10). Interestingly, it seems that unit-clustered
                                                G-1
standard errors are approximately equal to       G    times the stratum-clustered standard errors. If
G = 2, the ratio of those two standard errors is exactly equal to     (2 - 1)/2 =    1/2 as shown in
Lemma 4.1, but this relationship seems to still hold in expectation for larger values of G.
   In Panel A, t-tests based on unit-clustered standard errors in regressions without fixed effects
have the right size. When  = 0, there is no between and within strata heterogeneity in y gp (0),
so it follows from Point 5 of Theorem 4.4 that in the special case where G = 2, t-tests based on
unit-clustered standard errors in regressions without fixed effects have correct size. Our simulations
suggest that this result still holds when G > 2. However, in Panel B, t-tests using unit-clustered
standard errors in regressions without fixed effects are conservative, because there is now between
strata heterogeneity in y gp (0).
   We obtain similar results with five observations per unit of randomization (Panels C and D).
The only change is that the DOF correction in regressions with fixed effects makes the stratum-
clustered variance estimator slightly conservative and the unit-cluster variance estimator slightly
less liberal than in Panels A and B.




                                                 34
            Table 4: Size of t-test in simulated stratified experiments with small strata

                                                                   Number of units per strata
                                      2          3           4        5       6         7                  8          9          10

Panel A. iid standard normal potential outcomes and                  ngp = 100
UCVE without FE                  0.0342 0.0470 0.0491                0.0511 0.0492          0.0472      0.0532     0.0476      0.0525
UCVE with FE                     0.1633 0.1121 0.0907                0.0797 0.0724          0.0667      0.0703     0.0619      0.0663
SCVE without FE                  0.0516 0.0504 0.0534                0.0517 0.0514          0.0506      0.0548     0.0513      0.0567
SCVE with FE                     0.0510 0.0502 0.0533                0.0516 0.0511          0.0502      0.0547     0.0512      0.0566
s.e.unit (f e )/s.e.strat (f e ) 0.7053 0.8164 0.8703                0.8996 0.9181          0.9320      0.9405     0.9487      0.9559


Panel B. Stratum-level shock affecting potential outcomes and                   ngp = 100
UCVE without FE                  0.0000 0.0000 0.0000 0.0000                    0.0000 0.0000           0.0000     0.0000      0.0000
UCVE with FE                     0.1683 0.1096 0.0901 0.0841                    0.0730 0.0683           0.0702     0.0633      0.0629
SCVE without FE                  0.0538 0.0520 0.0540 0.0560                    0.0522 0.0513           0.0546     0.0533      0.0532
SCVE with FE                     0.0529 0.0516 0.0535 0.0558                    0.0520 0.0512           0.0545     0.0533      0.0532
s.e.unit (f e )/s.e.strat (f e ) 0.7053 0.8166 0.8722 0.8980                    0.9178 0.9309           0.9409     0.9487      0.9549

Panel C. iid standard normal potential outcomes and                  ngp = 5
UCVE without FE                  0.0696 0.0505 0.0518                0.0486     0.0487      0.0514      0.0523     0.0550      0.0534
UCVE with FE                     0.1496 0.1019 0.0807                0.0722     0.0697      0.0648      0.0635     0.0631      0.0653
SCVE without FE                  0.0560 0.0522 0.0514                0.0509     0.0531      0.0511      0.0530     0.0545      0.0553
SCVE with FE                     0.0425 0.0448 0.0462                0.0475     0.0488      0.0483      0.0503     0.0517      0.0520
s.e.unit (f e )/s.e.strat (f e ) 0.7053 0.8166 0.8697                0.8977     0.9183      0.9308      0.9403     0.9494      0.9546

Panel D. Stratum-level shock affecting potential outcomes and                   ngp = 5
UCVE without FE                  0.0296 0.0152 0.0173 0.0140                    0.0191      0.0167      0.0199     0.0248      0.0219
UCVE with FE                     0.1422 0.1032 0.0830 0.0752                    0.0680      0.0669      0.0603     0.0632      0.0611
SCVE without FE                  0.0507 0.0544 0.0523 0.0542                    0.0517      0.0542      0.0504     0.0530      0.0517
SCVE with FE                     0.0408 0.0473 0.0479 0.0499                    0.0478      0.0512      0.0480     0.0505      0.0489
s.e.unit (f e )/s.e.strat (f e ) 0.7053 0.8168 0.8692 0.9008                    0.9183      0.9324      0.9415     0.9481      0.9555

  The table shows the size of t-tests based on unit- and stratum-clustered standard errors in regressions with and without
  stratum fixed effects. Across simulations, we vary the number of randomization units per strata from two to ten (G =
  2, . . . , 10); we vary the number of observations per randomization unit to either ngp = 5 or ngp= 100; and we set the
  number of strata to P = 100. For each value of G, we simulated 10,000 samples from the following data generating
  processes: independent and identically distributed (iid) standard normal potential outcomes in Panel A, and a model with
  an additive stratum-level shock affecting both potential outcomes in Panel B. UCVE and SCVE stand for unit- and stratum-
  clustered variance estimators, respectively. FE stands for strata fixed effects. s.e.unit (f e )/s.e.strat (f e ) is the average across
  simulations of the ratio of standard errors clustering at the unit and stratum levels in regressions with stratum fixed effects.




                                                           35
C   Articles in our survey of paired or small strata experiments

        Table 5: Paired experiments and stratified experiments with small strata

                  Reference                                    Search source
                  Paired Experiments
                      Ashraf et al. (2006)                     AEA registry
                      Panagopoulos and Green (2008)            AEA registry
                      Banerjee et al. (2015)                   AEJ: Applied
                      Cr´
                        epon et al. (2015)                     AEJ: Applied
                      Beuermann et al. (2015)1                 AEJ: Applied
                      Fryer Jr et al. (2016)                   AEA registry
                      Glewwe et al. (2016)                     AEA registry
                      Bruhn et al. (2016)                      AEJ: Applied
                      Fryer Jr (2017)                          AEA registry
                  Small-strata experiments
                      Attanasio et al. (2015)                  AEJ: Applied
                      Angelucci et al. (2015)                  AEJ: Applied
                      Ambler et al. (2015)                     AEJ: Applied
                      Bj¨
                        orkman Nyqvist et al. (2017)           AEJ: Applied
                      Banerji et al. (2017)                    AEJ: Applied
                      Lafortune et al. (2018)                  AEJ: Applied
                      Somville and Vandewalle (2018)           AEJ: Applied
                    The table presents economics papers that have conducted
                    paired experiments or stratified experiments with ten or less
                    units per strata. We searched the AEJ: Applied Economics
                    for papers published in 2014-2018 and using the words "ran-
                    dom" and "experiment" in the abstract, title, keywords, or
                    main text. Four of those papers had conducted a paired ran-
                    domized experiment and seven had conducted a stratified ex-
                    periment with ten units or less per stratum. We also searched
                    the AEA's registry website for randomized controlled tri-
                    als (https://www.socialscienceregistry.org). We looked
                    at all completed projects, whose randomization method in-
                    cluded the prefix "pair" and that had either a working or a
                    published paper. Thus, we found five more papers that had
                    conducted a paired randomized experiment.




                                               36
D        Online appendix proofs

Proof of Lemma 3.1

Point 1

First, we introduce the formulas for the PCVE and UCVE in a general linear regression. Let                                              igp

be the residual from the regression of Yigp on a K -vector of covariates X igp , and X the (n × K )
matrix whose rows are X igp . The PCVE of the OLS estimator,  , is defined as follows (Liang and
Zeger (1986), Abadie et al. (2017))

                                                                                                             
                                         P            2   ngp                        2   ngp
            Vpair ( ) = (X X )-1                                    igp X igp                  igp X igp          (X X )-1 .       (16)
                                         p=1         g =1 i=1                     g =1 i=1



The UCVE of the OLS estimator,  , is defined as follows
                                                                                                              
                                                 P    2       ngp                    ngp
              Vunit ( ) = (X X )-1                                   igp X igp               igp X igp         (X X )-1 .          (17)
                                             p=1 g =1         i=1                    i=1


                                                                                                                   1
       Subtract from Equation (1) the average outcome in the population Y                                          n   p   g   i Yigp   =
                               1                                             1
 +  W gp + , where W           n     p       g       i Wgp ,    and          n   p       g     i igp       = 0 by construction. Then,


                                         Yigp - Y =  (Wgp - W ) + igp .                                                            (18)


Apply Equation (16) to the residuals and covariates of the regression defined by Equation (18).13
Then,

                                                                                                   2
                                                          p         g (Wgp   - W)        i igp
                                   Vpair ( ) =                                                 2       .                           (19)
                                                                                      2
                                                                p     g   i (Wgp - W )

  13
    The clustered variance estimator using the residuals from the demeaned formula is equivalent to the clustered
variance estimator including an intercept as in Equation (1) (Cameron and Miller, 2015).




                                                                     37
The numerator of Vpair ( ) equals

                                                               2
                                                                                                                                         2
                                  (Wgp - W )       igp                 =            (1 - W )SETp - W SEUp
                  p       g                    i                               p
                                                                                                                             2
                                                                                     C       T
                                                                       =               SETp - SEUp                               .           (20)
                                                                               p
                                                                                     n       n

The first equality follows from the definition of SETp and SEUp . The second equality follows from
the definition of T and C .
The denominator of Vpair ( ) equals

                                                           2                                                             2
                                                     2                                                       2
                                        (Wgp - W )             =                        (Wgp - W ) ngp
                      p       g     i                                       p       g
                                                                                                                                     2
                                                                                            2                        2
                                                               = (1 - W )                            Tp + W                  Cp
                                                                                                p                        p
                                                                                                     2
                                                                           C2     T2
                                                               =              T +    C
                                                                           n2     n2
                                                                                    2
                                                                           CT
                                                               =                        .                                                    (21)
                                                                            n

The first equality follows from (Wgp - W ) being constant across units. The second equality follows
from the definition of Tp and Cp . The third equality follows from the definition of T and C .
Then, combining Equations (19), (20) and (21),

                                                                       C        T      2
                                                               p       n SETp - n SEUp
                                        Vpair ( ) =
                                                                           CT 2
                                                                            n
                                                                       SETp SEUp 2
                                                   =                                -                    .
                                                           p
                                                                           T                    C

   Point 2
   Apply Equation (17) to the residuals and covariates of the regression defined by Equation (18).
Then,

                                                                                                             2
                                                       p           g    (Wgp - W )                   i igp
                                    Vunit ( ) =                                                          2       .                           (22)
                                                               p        g          i (Wgp -         W )2




                                                                       38
The numerator of Vunit ( ) equals

                                                           2                                                  2
                                                                                              2
                              (Wgp - W )             igp       =               (Wgp - W )               igp
                   p     g                   i                        p    g                        i
                                                                                                        2
                                                               =           (1 - W )2 SETp
                                                                                        2        2
                                                                                          + W SEUp
                                                                      p
                                                                           C2     2   T2    2
                                                               =              SET p +    SEUp .                                   (23)
                                                                      p
                                                                           n2         n2

The second equality follows from the defintion of SETp and SEUp . The third equality follows from
the definition of T and C . Then, combining Equations (21), (22) and (23),

                                                               C2    2             T2    2
                                                           p   n2
                                                                  SETp         +   n2
                                                                                      SEUp
                                    Vunit ( ) =
                                                                          CT 2
                                                                           n
                                                               SETp2   SEUp2
                                                 =                   +       .
                                                       p
                                                                T2      C2

Point 3

First, consider Equation (2) and, for each pair p, take averages across units to obtain the following


                                             Y p = f e W p + p + up ,                                                             (24)

               1       2      ngp                      1       2          ngp             1       2                   Tp
where Y p =   np       g =1   i=1 Yigp ,   Wp =       np       g =1       i=1 Wgp    =   np       g =1 Wgp ngp    =   np .   Substract
Equation (24) from Equation (2) to remove the fixed effect p (note that igp = 0 for all p = p)


                                   Yigp - Y p = f e (Wgp - W p ) + uigp - up .                                                    (25)


Given that {uijp } is an OLS residual, then it is orthogonal to any regressor by construction. In
particular, {uijp } is orthogonal to the pair-p fixed effect indicator {igp },

                                                 P     2 njp
                                                                   uijp igp = 0.
                                             p =1 g =1 i=1




                                                                 39
By the definition of igp , igp = 1 if unit i belongs to pair p, and igp = 0 if unit i does not belong
to pair p, so that the above equation reduces to

                                                  2     ngp
                                                              uigp = 0,                                       (26)
                                                g =1 i=1


which implies that for all p the within-pair residual average is zero

                                                         2     ngp
                                                   1
                                           up =                      uigp = 0.
                                                   np
                                                        g =1 i=1


Equation (25) then becomes a regression with one covariate and the same residuals as in Equation
(2):


                                     Yigp - Y p = f e (Wgp - W p ) + uigp .                                   (27)


    Now, apply Equation (16) to obtain the PCVE of f e , which simplifies given that there's only
one regressor Wgp - W p ,14 to

                                                                     ngp                        2
                                             P           2
                                             p=1         g =1        i=1 uigp (Wgp   - W p)
                          Vpair (f e ) =                                                    2                 (28)
                                                  P           2       ngp
                                                  p=1         g =1    i=1 (Wgp   - W p )2
  14
     The clustered variance estimator using the residuals from the deviations-from-means formula (Equation (27)) is
equivalent to the clustered variance estimator including the full set of pair dummies as in Equation (2) (Cameron
and Miller, 2015).




                                                              40
The denominator of Vpair (f e ) equals

                                                                   2                                                  2
                                                             2                                            2
                                         (Wgp - W p )                  =                  (Wgp - W p ) ngp
                           p     g   i                                        p      g
                                                                                                                          2
                                                                                                    2          2
                                                                       =            [Tp (1 - W p ) +      Cp W p ]
                                                                              p
                                                                                         2      2                 2
                                                                                        Cp     Tp
                                                                       =              Tp 2 + Cp 2
                                                                              p
                                                                                        np     np
                                                                                                2
                                                                                     Tp Cp
                                                                       =
                                                                              p
                                                                                      np
                                                                                                    2
                                                                                      n1p n2p
                                                                       =
                                                                              p
                                                                                     n1p + n2p
                                                                                                          2
                                                                       =            (n-
                                                                                      1p
                                                                                        1
                                                                                            +   n- 1 -1
                                                                                                 2p )         .                           (29)
                                                                              p


The second and third equalities follow from the definitions of Tp and Cp . The numerator of
Vpair (f e ) is equal to

                                                        2                                                         2
            P        2   ngp                                       P          2                     ngp
                               uigp (Wgp - W p ) =                                  (Wgp - W p )          uigp 
           p=1      g =1 i=1                                     p=1         g =1                   i=1
                                                                   P
                                                                                                                                      2
                                                            =              -W p (SETp,f e + SEUp,f e ) + SETp,f e
                                                                 p=1
                                                                   P
                                                            =           (SETp,f e )2 ,                                                    (30)
                                                                 p=1


                                          2        ngp
where SETp,f e + SEUp,f e =               g =1     i=1 uigp      = 0 from Equation (26). Therefore, combining Equa-
tions (28), (29) and (30),

                                               P      2                              P                                        2
                                               p=1 SETp,f e                               2    2               1   1
                 Vpair (f e ) =                                                =          p SETp,f e             +                .       (31)
                                                                       -1 2                                   n1p n2p
                                         P
                                         p=1     n-
                                                  1p
                                                    1
                                                        +   n-
                                                             2p
                                                               1                    p=1




                                                                        41
Point 4

Consider the deviations-from-means formula of the fixed effects regression from Equation (27)


                                    Yigp - Y p = f e (Wgp - W p ) + uigp .

Apply the definition of the UCVE from Equation (17), which simplifies given that there's only one
regressor Wgp - W p , to

                                            P            2             ngp                           2
                                            p=1          g =1          i=1 uigp (Wgp   - W p)
                        Vunit (f e ) =                                                           2       .             (32)
                                                 P          2           ngp
                                                 p=1        g =1        i=1 (Wgp    - Wp   )2


The numerator of Vunit (f e ) equals

            P   2     ngp                        2        P        2                       ngp               2
                                                                                       2
                            uigp (Wgp - W p )        =                 (Wgp - W p )              uigp
           p=1 g =1   i=1                                p=1 g =1                          i=1
                                                          P
                                                                                                         2
                                                     =             (1 - W p )2 SETp,f
                                                                                  2              2
                                                                                      e + W p SEUp,f e
                                                         p=1
                                                          P                        2    2
                                                                   2
                                                                                  Cp   Tp
                                                     =          SETp,f e             +
                                                                                  n2
                                                                                   p   n2
                                                                                        p
                                                         p=1
                                                          P      2T 2
                                                                Cp   p    2              1    1
                                                     =             2
                                                                       SETp,f e           2
                                                                                            + 2
                                                                 np                     Tp   Cp
                                                         p=1
                                                          P
                                                                                                          1   1
                                                     =          (n- 1   -1 -2   2
                                                                  1p + n2p ) SETp,f e                     2 + 2    .   (33)
                                                         p=1
                                                                                                         n1p n2p


The second equality follows from the definitions of SETp,f e and SEUp,f e . The third equality follows
from Equation (26), i.e., SETp,f e + SEUp,f e =                                                         2          2
                                                                   g     i uigp   = 0, for all p, so SETp,f e = SEUp,f e ,

and the definitions of Tp and Cp .
   Then, combining Equations (29), (32) and (33),

                                                 P
                                                       2    2                1   1
                                Vunit (f e ) =         p SETp,f e            2 + 2          .                          (34)
                                                 p=1
                                                                            n1p n2p


   QED.


Proof of Theorem 4.4


                                                              42
We start by proving a few auxiliary results that will be useful in the proof of Theorem 4.4. Note
that, for all p,

             1/(2+ )                                  2+     1/(2+ )
 E |p |2+              =E       Yp (1) - Yp (0)

                                            2+        1/(2+ )                              2+    1/(2+ )
                            E    Yp (1)                             + E        Yp (0)
                                                                1/(2+          )                                                 1/(2+      )
                                                           2+                                                               2+
                       = E                Wgp y gp (1)                             + E               (1 - Wgp )y gp (0)          
                                      g                                                          g

                                                        2+           1/(2+ )                                           2+        1/(2+ )
                                 E Wgp y gp (1)                                +           E (1 - Wgp )y gp (0)
                           g                                                           g
                                                        2+          1/(2+ )                                       2+    1/(2+ )
                       =         E[Wgp ] y gp (1)                              +           E[1 - Wgp ] y gp (0)
                           g                                                       g
                                                        1/(2+ )                                        1/(2+ )
                                 1               2+                                1            2+
                       =           y (1)                              +              y (0)
                           g
                                 2 gp                                      g
                                                                                   2 gp
                                          1/(2+ )
                                1
                       4          M                 < +.                                                                                   (35)
                                2

The first equality follows from the denifition of p . The first inequality follows from Minkowski's
inequality. The third line follows from the definitions of Yp (1) and Yp (0). The fourth line follows
from Minkowski's inequality. The fifth line follows from Wgp being a binary variable. The sixth
line follows from Point 2 of Assumption 1. The seventh line follows from Point 1 of Assumption 3.
    Using a similar reasoning, one can show that

                                                                2+
                                               E      Yp (d)               M1 < +.                                                         (36)


for all d and p and for some M1 > 0.
    By Equation (35), E [|p |] is bounded uniformly in p, and by Point 3 of Assumption 1, (p )+ 
                                                                                              p=1

is an independent sequence of random variables, so that

                           1               P       1                                   1
                   =                  p -
                                         lim                         E[p ] = lim                     p = lim                               (37)
                           P     p
                                               P + P
                                                                p
                                                                                   P + P
                                                                                                p
                                                                                                           P +



by the SLLN in Lemma 1 in Liu (1988), the fact that almost sure convergence implies convergence
in probability, and Point 2 of Assumption 3.




                                                                      43
Point 1

Note that by Point 3 of Assumption 1,  -  =  - E[ ] =                       p (p - E[p ])/P             is a sum of independent
random variables (p - E[p ])P
                            p=1 with mean zero and with a finite variance by Equation (35). As
  P                    2+
  p=1 E[|p   - p |2+ /SP  ]  0 for some       > 0 (by Point 3 of Assumption 3), then, by Lyapunov's
                                                                                   d             2 =
central limit theorem, ( -  )/(SP /P ) =               p (p   - p )/SP - N (0, 1) as P  , where SP
  P
  p=1 V(p )   = P 2 V( ). Therefore,

                                                                  d
                                        ( -  )/        V( ) - N (0, 1).                                                   (38)


Then,

                                                      P      2              P
                                                            p                      V(p )
                        P Vpair ( ) - P V( ) =                 - 2 -
                                                            P                       P
                                                      p=1                  p=1
                                                      P                     P
                                                            p2                     E[p
                                                                                     2 ] - E[ ]2
                                                                                             p
                                             =                 - 2 -
                                                            P                            P
                                                      p=1                  p=1
                                                      P                                       P
                                                            2
                                                            p    -E[p
                                                                    2]
                                                                                       2
                                                                                                   p2
                                             =                              - +                                           (39)
                                                                  P                                P
                                                      p=1                                    p=1
                                                                       P
                                                  P1
                                             - lim                          (p -  )2                                      (40)
                                              P + P
                                                                      p=1


   The first equality follows from Equations (3) and (7). The third equality follows from E[p ] = p .
Let's consider each of the terms in Equation (39). As P  , by Lemma 1 in Liu (1988),
      2 -E[ 2 ]
  P   p    p       P
  p=1    P        - 0, by Equation (35), Point 3 of Assumption 1, and the fact almost sure con-
                                                                           P
vergence implies convergence in probability. Then,  2 -                                    lim  2 by Equation (37) and the
                                                                                   P +
continuous mapping theorem (CMT). Equation (40) follows from these facts, and from Point 2 of
Assumption 3.
   Given Equation (40), Point 2 of Assumption 3, the Slutsky Lemma and the CMT, as P  ,

                             -               -                P V( )           d    2
                                        =                                   - N (0, pair ).                               (41)
                            Vpair ( )       V( )            P Vpair ( )


Finally, by Lemma 4.1, Vpair ( ) = Vpair (f e ), and by Assumption 2,  = f e .




                                                            44
Point 2

                                                    R                                               P
                                              1          2             2                    1
               P Vpop ( ) - P V( ) =                    [1r - 21r 2r + 2r ] -                           V(p )
                                              P                                             P
                                                  r=1                                           p=1
                                                    P                R                          P
                                              1         2       2                       1              2     2
                                          =             p -               1r 2r -                   [E(p ) - p ]
                                              P                 P                       P
                                                  p=1               r=1                     p=1
                                              P     2 - E[ 2 ]              R                           R
                                                    p     p      1                                  1          2    2
                                          =                    -                 1r 2r +                      (1r + 2r )
                                                       P         R                                  P
                                              p=1                          r=1                          r=1
                                                            R
                                          P       1
                                          -
                                           lim                   (1r - 2r )2                                                  (42)
                                              P + P
                                                           r=1


The second equality follows from the properties of the variance. As P  , by Lemma 1 in
                     2 -E[ 2 ]
                 P   p    p       P
Liu (1988),      p=1    P        - 0. Likewise, as R = P/2  , by Lemma 1 in Liu (1988),
  R                   R                   P
  r=1 1r 2r /R -      r=1 1r 2r /R    - 0, because E[|1r 2r |1+                  /2 ]   is uniformly bounded in r by Equa-
tion (35) and the Cauchy-Schwarz inequality, (1r 2r )+
                                                     r=1 is a sequence of independent random

variables by Point 3 of Assumption 1, and E(1r 2r ) = E(1r ) E(2r ) = 1r 2r . Finally, the conver-
gence arrow follows from Point 2 of Assumption 3 and some algebra.

   The result follows from Equations (38) and (42) and a reasoning similar to that used to prove
Equation (41).


Point 3


                                   1                      1
              P Vbsr ( ) - P V( ) = P (Vpair ( ) - V( )) + P (Vpop ( ) - V( ))
                                   2                      2
                                                            P                                            R
                                      P 1       1                          12      1
                                      -
                                            lim                  (p -  ) +     lim                            (1r - 2r )2 .
                                        2 P + P                            2 P + P
                                                           p=1                                          r=1


The first equality follows from Point 3 of Lemma 4.1. The convergence arrow follows from Equations
(40) and (42). The result follows from the previous display, Equation (38), and a reasoning similar
to that used to prove Equation (41).


Point 4

By Lemma 4.2, Vpair ( ) = 2Vunit (f e ), so given Point 1 of this theorem, the result follows.




                                                                45
Point 5



    P Vunit ( ) - P Vpair ( )
          2                             1                 1
    =             Yp (1)Yp (0) - 2               Yp (1)             Yp (0)
          P   p
                                        P   p
                                                          P    p

      P                  1
    - 2 lim                         E[Yp (1)Yp (0)] - E[Y (1)] E[Y (0)]
              P +        P     p
                   1                                                           1
    = 2 lim                        y p (0) - y (0)    y p (1) - y (1) -                (y gp (0) - y p (0))(y gp (1) - y p (1)) . (43)
          P + P                                                                2
                        p                                                          g


The first equality follows from Equation (12).                               The convergence arrow follows from the fact
                       1+ /2
E    Yp (1)Yp (0)                  is bounded uniformly in p by Equation (36) and the Cauchy-Schwarz in-
                                                 1+ /2
equality, from the fact E               Yp (d)             is also bounded uniformly in p, from Point 3 of Assumption
1, from the SLLN in Lemma 1 in Liu (1988), from the CMT, and from Point 2 of Assumption 3.
The last equality follows from the same steps as those used to prove Lemma 4.3. The result follows
from Equations (43), (40), and (38), and a reasoning similar to that used to prove Equation (41).


Point 6a


                                                                   2     2
                                                                   pair  pop ,
                                                     R                                       P
                                           1                                       1
                                     lim                   (1r - 2r )2  lim                       (p -  )2 ,
                                       P + R                                   P + R
                                                     r=1                                    p=1
                               R                                                   R
                      1             2    2                                1               2    2                   2
               lim                 (1r + 2r - 21r 2r )  lim                              [1r + 2r - 2(1r + 2r ) + 2 ],
                  P + R                                               P + R
                             r=1                                                   r=1
                                                              R
                                                    1
                                      0  lim                        [21r 2r - 2(1r + 2r ) + 2 2 ],
                                                P + R
                                                              r=1
                                                                        R
                                                          1
                                             0  lim                          (1r -  )(2r -  ),
                                                      P + R
                                                                       r=1

      2
Then, pair  2  2  2
            bsr           2
                pop pair  pop .

     Point 6b is straightforward so we do not prove it.




                                                                        46
E      Results when randomization units do not all have the same
       number of observations.

In this subsection, we extend Lemma 4.2 without requiring Assumption 2.

Lemma E.1 (Ratio of the UCVE and PCVE with fixed effects and when Assumption 2 fails).
                                                                                                     n1p     2         n2p   2
                                                                                1
Vunit (f e )/Vpair (f e ) =          p mp p ,     where, for all p,             2    mp =            np          +     np         1, p  0 and
                                                                       1
    p p   = 1. Therefore, Vunit (f e )/Vpair (f e )                    2, 1     .

Proof of Lemma E.1
     Take the ratio between Vunit (f e ) and Vpair (f e ) from Equations (31) and (34),

                                                       P   2    2                    1         1
                               Vunit (f e )            p=1 p SETp,f e               n2
                                                                                     1p
                                                                                          +   n2
                                                                                               2p
                                              =                      P
                               Vpair (f e )
                                                                              2
                                                                           SETp,f
                                                                     p=1          e
                                                                                     -1 2
                                                               P
                                                               p=1   (n- 1  -1
                                                                       1p +n2p )

                                                       P     -1
                                                       p=1 (n1p      + n- 1 -2  2
                                                                        2p ) SETp,f e
                                                                                                       1
                                                                                                      n2
                                                                                                            +     1
                                                                                                                 n2
                                                                                                       1p         2p
                                              =                               P      2
                                                                              p=1 SETp,f e
                                                   P
                                              =         mp p ,
                                                  p=1


                      2
                   SETp,f
where p =         P
                          e
                           2        0 and mp = (n- 1   -1 -2
                                                 1p + n2p )
                                                                                           1
                                                                                          n2
                                                                                                +    1
                                                                                                    n2
                                                                                                            . The second equality follows
                  p=1   SETp,f e                                                           1p        2p
                                                       P
from the definition of p . Clearly,                    p=1 p   = 1.
Now,

                                                                 1                   1    1
                                              mp =                          2           + 2
                                                          1           1             n2
                                                                                     1p  n 2p
                                                         n1p   +     n2p
                                                               1                          1
                                                  =                    2    +                   2
                                                               n1p                  n2p
                                                         1+    n2p                  n1p   +1
                                                         n2      2
                                                           2p + n1p
                                                  =
                                                        (n1p + n2p )2
                                                                   2                  2
                                                         n1p                  n2p
                                                  =                    +                  .
                                                         np                   np

                           1
     Let's show that       2    mp  1 for all p. Given that n2     2               2
                                                             1p + n2p  (n1p + n2p ) , then mp  1. Now,
                                                                                                 1
given that (n1p - n2p )2 = n2                2             2      2               2
                            1p - 2n1p n2p + n2p  0, then 2n1p + 2n2p  (n1p + n2p ) , so that mp  2 .




                                                                       47
Then, the ratio of Vunit (f e ) to Vpair (f e ) is in [1/2, 1] since mp  [1/2, 1] for all p, and   p p   = 1.
QED.
   Lemma E.1 shows that Vunit (f e )/Vpair (f e ) is a weighted average across pairs of the sum of
squared randomization-unit shares within pairs. Accordingly, this ratio is bounded between a half
and one. Figure 1 plots this ratio when n1p /n2p is constant across pairs. Vunit (f e )/Vpair (f e ) is
very close to 1/2 when n1p /n2p is included between 0.5 and 2, meaning that the first randomization
unit has between half and twice as many observations as the second one. For instance, if in every
pair, one randomization unit has twice as many observations as the other, then the ratio of the two
variances is equal to 5/9. Moreover, the fact that Vunit (f e )/Vpair (f e ) is a weighted average across
pairs implies that even if there is a pair with randomization units that are highly unbalanced,
this ratio will still be close to 1/2 if other pairs are balanced. Overall, Lemma E.1 shows that
Lemma 4.2 still approximately holds when randomization units in each pair have different numbers
of observations, unless they have an extremely unbalanced number of observations.

Figure 1: Ratio of Randomization-Unit-Clustered and Pair-Clustered Variance Estimator in Re-
gressions with Paired Fixed Effects

                                    1


                                   0.9


                                   0.8
                    Vunit (f e )
                    Vpair (f e )




                                   0.7


                                   0.6


                                   0.5
                                         0   0.5   1      1.5       2       2.5       3
                                                        n1p /n2p




                                                       48
