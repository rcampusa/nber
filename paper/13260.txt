                                NBER WORKING PAPER SERIES




  INCOMPLETE MARKETS, HETEROGENEITY AND MACROECONOMIC DYNAMICS

                                            Bruce Preston
                                            Mauro Roca

                                        Working Paper 13260
                                http://www.nber.org/papers/w13260


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      July 2007




The authors thank seminar participants at the Australian National University, Columbia University,
CREI-Universitat Pompeu Fabra, Duke University, Federal Reserve Bank of Atlanta, Federal Reserve
Board of Governors, Indiana University, the New York Federal Reserve Bank Workshop on Monetary
Policy, the North American Summer Meeting of the Econometric Society, Ohio State University and
the San Francisco Federal Reserve Bank for comments and Stefania Albanesi, George-Marios Angeletos,
Jesus Fernandez-Villaverde, Marc Giannoni, Wouter den Haan, Jinill Kim, John Leahy, Albert Marcet,
Tony Smith and Mike Woodford for comments and useful discussions. The usual caveat applies. Financial
support from the PER Student-Faculty Summer Grant is gratefully acknowledged. The views expressed
herein are those of the author(s) and do not necessarily reflect the views of the National Bureau of
Economic Research.

© 2007 by Bruce Preston and Mauro Roca. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
Incomplete Markets, Heterogeneity and Macroeconomic Dynamics
Bruce Preston and Mauro Roca
NBER Working Paper No. 13260
July 2007
JEL No. C6,D52,E21,E32

                                             ABSTRACT

This paper solves a real business cycle model with heterogeneous agents and uninsurable income risk
using perturbation methods. A second order accurate characterization of agent's optimal decision rules
is given, which renders the implications of aggregation for macroeconomic dynamics transparent.
The role of cross-sectional holdings of capital in determining equilibrium dynamics can be directly
assessed. Analysis discloses that an individual's optimal saving decisions are almost linear in their
own capital stock giving rise to permanent income consumption behavior. This provides an explanation
for the approximate aggregation properties of this model documented by Krusell and Smith (1998):
the distribution of capital does not affect aggregate dynamics. While the variance-covariance properties
of endogenous variables are almost entirely determined by first order dynamics, the second order dynamics,
which capture properties of the wealth distribution, are nonetheless important for an individual's mean
consumption and saving decisions and therefore the mean equilibrium capital stock. Policy evaluation
exercises therefore need to take account of these higher order terms.

Bruce Preston
Department of Economics
Columbia University
420 West 118th Street
New York, NY 10027
and NBER
bp2121@columbia.edu

Mauro Roca
Department of Economics
Columbia University
1022 International Affairs Building
420 West 118th Street
New York, NY 10027
mfr2004@columbia.edu
1     Introduction
This paper proposes a new approach to solving macroeconomic models with heterogeneous
agents and incomplete markets. The study of such models is important for several reasons.
First, the representative agent construct holds under stringent conditions unlikely to hold in
reality. Second, heterogeneous agent models are of interest in their own right; potentially
explain a range of economic phenomena; and address issues that are impossible to analyze in
a representative agent framework. More generally, we observe important heterogeneity, but
little is understood about its consequences. Of particular import is the extent to which het-
erogeneous agents are diversely a¤ected by macroeconomic ‡uctuations. How should macro-
economic stabilization policies be designed when agents are di¤erentially a¤ected by policy?
    A key obstacle to the analysis of such questions has been the availability of tractable
solution methods. For instance, a stochastic growth model with heterogeneous agents, ag-
gregate technology shocks and partially insurable labor income risk engenders a time varying
distribution of capital holdings across agents. For agents to solve their optimization problem,
knowledge of the stochastic properties of this wealth distribution is required to forecast future
prices, as these prices depend on the aggregate capital stock. Solving such models is di¢ cult.
    This paper makes two contributions: one methodological and one substantive.             The
methodological contribution is to delineate a new approach to solving a stochastic growth
model with heterogenous agents and incomplete markets based on perturbation methods.
Building on the representative agent based analyses of Judd (1998), Jin and Judd (2002),
Kim, Kim, Schaumburg, and Sims (2003) and Schmitt-Grohe and Uribe (2004), a second
order accurate solution to the model is developed. The approach can be readily extended to
higher order approximations. The analysis makes clear that the approach applies to a broad
class of alternative models which permit the analysis of a number of questions of interest such
as optimal policy design in the presence of agent heterogeneity.
    The use of perturbation methods requires confronting a number of conceptual issues. First,
the set of relevant state variables that appear in a second order approximation must be deter-
mined. In heterogeneous agent models, aggregation constraints, relating individual decisions
to aggregate conditions, induce new aggregate state variables that increase the dimensional-

                                               1
ity of the model. Second, aggregation also imposes constraints on the relationships between
elasticities in individuals’optimal decisions and those characterizing aggregate dynamics. We
show how each of these complications can be handled.
   The analysis demonstrates that perturbation methods have several appealing features in
application to heterogeneous agent models. The approach permits an analytic characteri-
zation of the evolution of the wealth distribution that is accurate up to the order of the
approximation. This in turn permits a characterization of optimal decisions to the same or-
der. Hence the elasticities of individual saving and consumption decisions in response to any
state variable are determined. Because aggregation proceeds directly from these individual
decision rules, the role of heterogeneity and the distribution of capital holdings in determining
aggregate dynamics can be clearly and directly assessed.
   As our methodology is analytic and based on standard methods for solving linear and
quadratic systems of equations, solutions are generated in fractions of a second in contrast to
existing numerical methods based on value function iteration. The analysis is not constrained
in the manner in which uncertainty can be speci…ed. While numerical procedures typically
require uncertainty to be speci…ed as a low-dimension discrete-state Markov process, per-
turbation methods readily handle continuously distributed random variables. Similarly, the
analysis is not constrained by the number of state variables present in the model. This fact,
and the speed of the solution method, opens the way for econometric estimation of heteroge-
nous agent models. Indeed, this class of model can be estimated using methods developed by
Fernandez-Villaverde and Rubio-Ramirez (2006). As such, the framework provides a tractable
laboratory for the study of optimal policy design in the presence of heterogeneity, as well as
the quanti…cation of the welfare costs associated with various sources of risk with imperfect
insurance markets.
   The substantive contribution of the paper is to give greater understanding of the role
of heterogeneity in determining aggregate dynamics in a simple real business cycle model.
In the benchmark calibration, optimal saving decisions are shown to be virtually linear in
an individual’s own holdings of the capital stock. There is very little curvature in optimal
decisions due to second order characteristics of the cross-sectional distribution of capital held


                                               2
by agents. Agents are shown to be e¤ectively permanent income consumers: they consume the
returns on their capital holdings and keep the principle intact. In consequence the marginal
propensities to save across individuals are almost equal and the model, therefore, displays
the approximate aggregation property noted by Krusell and Smith (1998): the evolution of
aggregate variables is largely determined by aggregate capital — the distribution of capital
across individuals and therefore heterogeneity matters little for macroeconomic dynamics.
   Notwithstanding this …nding, we show that incomplete markets and heterogeneity do
matter for understanding macroeconomic outcomes in this simple economy. The existence of
borrowing constraints a¤ect …rst order dynamics of the model economy, and these dynamics
almost entirely determine the variance-covariance properties of all endogenous model vari-
ables. While it is not surprising that second order terms — terms that capture the evolving
second order moments of the wealth distribution — are less important for aggregate vari-
ation than …rst order terms, evidence is adduced showing that these terms do matter for
the determination of individual mean consumption and savings in equilibrium. These mean
e¤ects operate through two channels: …rst, the presence of risk leads to a constant adjust-
ment in optimal decision rules, analogous to standard precautionary savings e¤ects; second,
the interaction of uncertainty and the non-linear mapping of states into decisions in a sec-
ond order approximation, leads to Jensen inequality type e¤ects on average consumption and
savings. Indeed, the latter can be signi…cantly larger than the former, depressing aggregate
consumption by a fraction as large as 2 percent of steady state consumption on average in
the simulations considered. This combined with signi…cant observed variation in ex post indi-
vidual consumption pro…les, and therefore welfare, underscores the importance of incomplete
markets and heterogeneity for macroeconomics.
   The present analysis is most closely related to Krusell and Smith (1998). They present a
novel solution algorithm for this class of problem using value function iteration-based meth-
ods. Because the wealth distribution is a high dimensional object, value function iteration
methods must resort to solving an approximation to the true problem. To reduce the di-
mension of the state space, Krusell and Smith restrict the information set agents utilize in
forecasting future prices. Analysis proceeds by conjecturing a boundedly rational law of mo-


                                             3
tion for aggregate capital. Speci…cally, tomorrow’s aggregate capital is assumed to be only a
function of today’s aggregate capital stock, and therefore depends only on the mean of the
wealth distribution. Conditional on this conjectured aggregate capital accumulation equation,
agents behave optimally. A central conclusion of their paper is that the model satis…es what
they call approximate aggregation: aggregate dynamics do not depend on characteristics of
the wealth distribution other than its mean (as would be the case under complete markets
and the representative agent construct). The analysis presented here also …nds approximate
aggregation but our results are not implied by their …ndings. Perturbation methods represent
a distinct solution method, approximating the model along a di¤erent dimension to solution
procedures based on value function iteration.
    Most importantly, the approach developed here remains valid even if the conditions for
approximate aggregation do not obtain. As noted by Krusell and Smith (2006) on page 2,
when discussing their solution algorithm based on value function iteration: “The key insight
to solving the model with consumer heterogeneity using numerical methods is ‘approximate
aggregation’in wealth”. Furthermore, by including all state variables relevant to a second or-
der approximation of the equilibrium dynamics, the perturbation approach permits a greater
role for heterogeneity ex ante than does their algorithm which only permits the e¤ects of
heterogeneity on aggregate dynamics to be felt through the coe¢ cients on the restricted law
of motion for aggregate capital. The present analysis gives an analytical characterization of
the problem, providing additional insight to the conditions required for approximate aggre-
gation. Hence, the results presented here adduce new evidence on the importance or not
of heterogeneity that originates from imperfect labor markets in explaining macroeconomic
dynamics. Of course, while the Krusell and Smith algorithm may not provide an accurate
characterization of aggregate dynamics when approximate aggregate fails to obtain, it does
have the advantage of providing a global solution to the model, in contrast to perturbation
methods which are necessarily a local characterization in the neighborhood of the model’s
steady state.1 Nonetheless, the decisions determined by the perturbation approach are shown
   1
     Though as shown by Swanson, Anderson, and Levin (2005), taking successively higher order approxi-
mations can, under suitable smoothness conditions satis…ed by most macroeconomic models, deliver globally
accurate characterizations of optimal decisions in the limit. Moreover, global methods involve various approx-



                                                      4
to induce smaller Euler equation errors than do value function iteration based solution meth-
ods.
    Following Krusell and Smith (1998), our analysis continues to build on earlier work on
heterogeneous agent models by Bewley (1977, 1980), Huggett (1993) and Aiyagari (1994).
More recently Gourinchas (2000) analyzes an overlapping generations model which discloses
the property of approximate aggregation as does Khan and Thomas (2005) in a model of …rm
investment dynamics with nonconvex costs of adjustment. Young (2005) further explores the
robustness of the approximate aggregation result. Midrigan (2006) exploits this methodology
in a study of …rm pricing behavior. Further applications on the welfare costs of business cycles
in heterogenous agent models include Storesletten, Telmer, and Yaron (2001) and Krusell and
Smith (2002). Of particular relevance to the present study is Kim, Kim, and Kollmann
(2005). They analyze a Huggett-type economy with perturbation methods though make an
approximation analogous to Krusell and Smith by characterizing the equilibrium price only
to the …rst order. Remaining decisions are then approximated to the second order given this
restriction. The contribution of our paper is to show how to obtain a complete second order
approximation. More recently, Reiter (2006) proposed a solution algorithm based on a mix
of projection and perturbation methods and Algan, Allais, and Den Haan (2006) pursues an
approach that utilizes a parametric characterization of the cross-sectional wealth distribution.
    Finally, using projection methods, Gaspar and Judd (1997) solve for the consumption
function that satis…es the household’s Euler equation in two classes of heterogeneous agent
models with …nite number of households. Both models include only aggregate shocks, and
agents, in contrast to the present analysis, are ex ante heterogenous: one model having agents
with di¤erent preferences and the second with di¤erent initial wealth holdings. Our analysis
advances this research by adopting a new solution method – perturbation methods – and
by providing a complete second order characterization of a stochastic growth model with a
continuum of households that are ex ante homogeneous but ex post heterogeneous, aggregate
and idiosyncratic shocks, and incomplete markets.
imations which similarly introduce errors. The di¤erence between global and local methods lies in where in
the model space solution error is tolerated. Perturbation methods value accuracy highly, local to some point
of interest –but this does not imply the model to be globally invalid.



                                                     5
      The paper proceeds as follows. The next section lays out the benchmark heterogeneous
agent model. Section 3 deals with several conceptual issues relating to obtaining a second
order accurate characterization of the model solution. Section 4 discusses some calibration
exercises and highlights implications of heterogeneity and incomplete markets for macroeco-
nomic dynamics. Section 5 gives further discussion of the conditions required for approximate
aggregation and properties of solutions based on perturbation methods and value function it-
eration. The …nal section o¤ers some concluding remarks.


2       The Model
This section describes a stochastic growth model, incorporating heterogenous agents that face
partially uninsurable income risk. There are a continuum of agents with unit measure indexed
by i 2 [0; 1]. Each household i seeks to maximize

                                             P
                                             1
                                                     T t
                                       Et                        u (ci;T )                             (1)
                                             T =t

for
                                                   c1i;t                1
                                       u (ci;t ) =
                                                      1
where      > 0 is the inverse intertemporal elasticity of substitution, 0 <               < 1 the discount
rate and ci;t household i’s consumption of the economy’s only available good. Maximization
is subject to the ‡ow budget constraint for capital

                                 ai;t+1 = (1             ) ai;t + yi;t          ci;t

where 0 <      < 1 is the depreciation rate, ai;t denotes individual i0 s holdings of the capital
stock and yi;t the income of individual i to be de…ned below.
      Agents face partially insurable labor market income risk. Each agent is endowed with one
unit of time. This endowment is transformed into labor input according to li;t = ei;t l where
ei;t is an idiosyncratic employment shock satisfying

                               ei;t+1 = (1          e)       e   +   e ei;t   + "ei;t+1                (2)



                                                         6
where 0 <          e   < 1;   e   > 0 and "ei;t+1 a bounded i.i.d. disturbance with mean and variance
        2 2
(0;     e ).   Subsequent sections will make clear a particular advantage of perturbation methods:
stochastic components of the model need not be restricted to low dimensional discrete state
Markov processes. However, perturbation methods can handle discrete state processes as
demonstrated in Roca (2006). l > 0 is a normalizing constant.
       Given single economy-wide markets for labor and capital, wage and rental rates are deter-
mined by the aggregate production function and the aggregate quantities of the two inputs.
The latter are de…ned by
                                                               R1
                                                   kt               ai;t di                                         (3)
                                                                0
                                                               R1
                                                    lt              li;t di =      el                               (4)
                                                               0

where the …nal equality follows from the law of large numbers and implies that aggregate
employment is equal to the mean of individual employment outcomes. Aggregate output is
produced according to a Cobb-Douglas production technology zt kt lt1                               taking as inputs the
aggregate capital stock and labor supply. zt is an aggregate technology shock, common to all
households, and assumed to satisfy

                                           zt+1 = (1           z)       z   +   z zt   + "zt+1                      (5)

where 0 <          z   < 1;   z   > 0 and "zt+1 a bounded i.i.d. disturbance with mean and variance
        2
(0;     z ).   These aggregate inputs imply market interest and wage rates equal to

                                                                                         1
                                         r (kt ; lt ; zt ) =            zt (kt =lt )

                                        w (kt ; lt ; zt ) = (1                  ) zt (kt =lt ) :

Household i’s income is then determined as

                                      yi;t = r (kt ; lt ; zt ) ai;t + w (kt ; lt ; zt ) ei;t l:

       To solve the optimization problem agents must forecast future prices. Under the main-
tained assumptions flt ; zt g are governed by exogenously given stochastic processes. Therefore,
   2
    The analysis will later allow employment status to depend on the aggregate state. However, for simplicity
of notation this correlation is presently ignored.

                                                                    7
to forecast future wage and rental rates, agents require knowledge of the stochastic process
describing the evolution of the aggregate capital stock. However, the stochastic properties of
the aggregate capital stock depend on the distribution of capital holdings in the population.
Denote this distribution by                  t   and associated law of motion

                                                             t+1   = H( t ; zt ):                                                 (6)

   Asset markets are incomplete with capital representing the only asset by which resources
can be transferred over time. It is for this reason that employment risks are partially insurable.
To ensure satisfaction of intertemporal budget constraints, capital holdings are restricted by
a borrowing limit b               0, ensuring the repayment of loans and the absence of Ponzi schemes.
To impose the restriction, de…ne the interior function

                                                                               1
                                                        I (ai;t+1 ) =                                                             (7)
                                                                        (ai;t+1 + b)2

which has the property that as individual asset holdings approach the borrowing constraint b
the interior function approaches in…nity. The model is then written as the following dynamic
programming problem:

        v (ai;t ; ei;t ;    t ; zt )   = max [u (ci;t ) + Et v (ai;t+1 ; ei;t+1 ;                t+1 ; zt+1 )   + I (ai;t+1 )]    (8)
                                         ci;t ;ai;t+1


where    > 0 (discussed in detail below) subject to

                           ai;t+1 = (1           ) ai;t + r (kt ; lt ; zt ) ai;t + w (kt ; lt ; zt ) ei;t l     ci;t              (9)

and relations (2), (3), (4), (5) and (6). For later use, the …rst order conditions for optimality
are given by

                  uc (ci;t ) = Et [uc (ci;t+1 ) (r (kt+1 ; lt+1 ; zt+1 ) + 1                      )      Ia (ai;t+1 )]           (10)

combined with relations (2), (3), (4), (5), (6) and (9). This class of problem is di¢ cult to
solve because the law of motion for the wealth distribution is unknown and in principle an
in…nite dimensional object.



                                                                        8
2.1       Commentary

Our introduction of the interior function (7) in the optimization problem follows a long litera-
ture in the linear programming and non-linear optimization …elds of applied mathematics on
interior methods for optimization problems subject to inequality constraints — see Forsgren,
Gill, and Wright (2002) for a review and detailed references therein. Typical analyses of this
class of model follow Aiyagari (1994) and restrict capital holdings with a borrowing constraint

                                     ai;t+1 + b > 0; 8 i 2 [0; 1] :                                  (11)

The idea adopted here is to replace the problem of maximizing an objective function subject
to this inequality constraint with an unconstrained maximization problem. This is achieved
by de…ning a composite function that re‡ects the properties of the unconstrained objective
function and the constraint (11). Introducing the interior function with penalty parameter             >
0 modi…es the Bellman equation so that it has the property that for small              the maximization
problem satis…es the constraint ai;t+1 + b > 0. When ai;t+1 approaches b the interior function
tends to dominate the value function v (ai;t ; ei;t ;    t ; zt )   leading to large negative values. The
composite function therefore penalizes consumption-savings decisions that lead to an asset
position near the borrowing limit.3
       Interior functions are similar in spirit to penalty functions that appear in various litera-
tures. In related work Kim, Kim, and Kollmann (2005) directly introduce a penalty term in
the utility function to enforce the same kind of borrowing constraint. Rotemberg and Wood-
ford (1999) in an analysis of monetary policy concerned with the implications of the lower
bound on nominal interest rates impose a penalty function on the central bank’s objective to
ensure that nominal interest rates are always non-negative.
       An alternative approach is to introduce quadratic costs to adjusting capital holdings of
the form       (ai;t + b) 2 . As asset holdings approach the borrowing limit b the cost tends to
   3
    Forsgren, Gill, and Wright (2002) provide theorems for static problems under which the maximand of
the composite function converge to the maximand of the original problem as ! 0. Moreover, bounds can
be determined on the magnitude of the error in the maximand obtained from the modi…ed problem with
small : We shall not develop the theory of interior methods further since we intend to take a second order
approximation to this modi…ed problem. Furthermore, in our simulation studies, we make sure that the
penalty is su¢ ciently large to ensure agents do not violate the borrowing constraint.


                                                    9
in…nity. The interpretation is that individuals that are close to their borrowing limit, therefore
representing “bad credit risks”, must expend greater resources to secure loans. Hence in
equilibrium agents will never choose a sequence of fci;t ; ai;t g pairs that lead to (11) holding
with equality. This approach is similar to small open economy macroeconomic models which
adopted debt sensitive interest rate premia to ensure stationarity of foreign debt holdings in
equilibrium — see Benigno (2001), Kollmann (2002) and Schmitt-Grohe and Uribe (2003).
This approach gives similar results to those we report for the interior method.


3     Perturbation Methods
This section describes the perturbation approach. Such methods seek to approximate the
model solution to an arbitrary degree of accuracy in the neighborhood of some point of
interest in the model space. This point is typically taken to be the model’s steady state which
is discussed further below
    Several conceptual issues must be confronted. The aggregation conditions (3) and (4) im-
pose signi…cant structure on our model solution — structure that is not present in analogous
representative agent models. The implications are two-fold: …rst, aggregation constraints
induce additional state variables relevant to an individual’s decision problem; second, aggre-
gation induces a relationship between the elasticities relevant to individual decisions and those
elasticities describing aggregate dynamics. The following sections deal with each of these is-
sues in turn. Perturbation methods are …rst described for a representative agent version of the
model both to introduce notation and the basic solution method. The intricacies introduced
by the presence of heterogenous agents and associated aggregation conditions for the solution
are then delineated.

3.1    The Representative Agent Model

For ease of exposition, consider a representative agent version of the model described in
Section 2. This will facilitate introduction of notation and the basics of the perturbation
approach in obtaining a second order accurate characterization of the model. Our notation
follows Schmitt-Grohe and Uribe (2004) though the analysis is otherwise identical to Judd

                                               10
(1998), Jin and Judd (2002) and Kim, Kim, Schaumburg, and Sims (2003).
    To generate a representative agent model, assume that there are no idiosyncratic labor
employment shocks and that each household inelastically supplies a unit of labor. Hence all
agents will be identical ex ante and ex post so that ai;t = kt for all i in equilibrium. The
equilibrium for this model is determined by the optimality conditions

                                                                                                   2
               uc (ct ) =     Et [uc (ci;t+1 ) (r (kt+1 ; lt+1 ; zt+1 ) + 1             )] +
                                                                                               (kt+1 + b)3
                 kt+1 = (1          ) kt + r (kt ; lt ; zt ) kt + w (kt ; lt ; zt ) l     ct

and relation (5). These conditions can then be summarized by
                                      2                                                                            3
                                        c     ci;t+1 (r (kt+1 ; lt+1 ; zt+1 ) + 1     ) (k 2 +b)3
                                      6 t                                                    t+1                   7
                                      6                                                                            7
   Et F (ct+1 ; ct ; xt+1 ; xt ) = Et 6 kt+1 (1     ) kt r (kt ; lt ; zt ) kt w (kt ; lt ; zt ) l + ct             7
                                      4                                                                            5
                                                 zt+1 (1          z) z        z zt "zt+1
                               = 0                                                                                  (12)

where                                                   2        3
                                                            kt
                                                 xt = 4          5:
                                                            zt
    The solution to this model is of the form

                                          ct = g (xt ; )

                                       xt+1 = h (xt ; ) +                "t+1                                       (13)

for unknown functions g and h with dimension (1                         1) and (2              1) respectively.     > 0
scales the degree of uncertainty in "t+1 , itself a (2                1) vector, and              is a (2    2) selection
matrix, designating how primitive shocks enter the state equations. This solution represents
a generalization of the standard state-space representation of a linear rational expectations
model. The …rst relation gives the policy function for the endogenous decision variables while
the second describes the evolution of the model’s state variables. In contrast to the linear
case, the solution is here given by an arbitrary non-linear mapping from current state variables
to the optimal allocations for consumption and future states. Perturbation methods seek to


                                                         11
approximate the functions g and h in the neighborhood of the model’s steady state (c; x),
de…ned by the relations c = g (x; 0) and x = h (x; 0).
   The second order approximation of the functions g and h around the steady state (xt ; ) =
(x; 0) yields

                                   P
           g (x; ) = g (x; 0) +        gxm (x; 0) (xm      xm ) + g (x; 0)
                                   m
                          1P
                        +      gx x (x; 0) (xm xm ) (xn xn )
                          2 m;n m n
                          1P                           1P
                        +      gxm (x; 0) (xm xm ) +       g xm (x; 0) (xm         xm )
                          2 m                          2 m
                          1
                        + g (x; 0) 2                                                          (14)
                          2

and

                                   P
         h (x; )j = h (x; 0)j +        hxm (x; 0)j (xm       xm ) + h (x; 0)j
                                   m
                         1P
                       +      hx x (x; 0)j (xm xm ) (xn xn )
                         2 m;n n m
                         1P                            1P
                       +      hxm (x; 0)j (xm xm ) +       h xm (x; 0)j (xm         xm )
                         2 m                           2 m
                         1
                       + h (x; 0)j 2                                                          (15)
                         2

where j; m; n = 1; 2: Here j indexes the law of motion of the predetermined variable under
consideration — either the capital stock or the technology shock — and therefore selects a
particular element of the vector of non-linear functions given by h (x; ) in (13). m and n
index the same two state variables in the construction of the approximation. For instance,
h1x1 x2 gives the cross partial derivative with respect to k and z for the non-linear law of motion
for k.
   The unknowns in these Taylor expansions are given by the set of …rst order derivatives

                                          gxm ; g ; hjxm ; hj ;                               (16)

and the second order derivatives

                       gxn xm ; gxm ; g   xm ;   g ; hjxn xm ; hjxm ; hj xm ; hj              (17)

                                                    12
for j; m; n = 1; 2. Hence there are 9 unknown …rst order terms and 17 second order terms.
These unknown coe¢ cients can be solved for by taking the corresponding …rst and second
derivatives of (12) with respect to x and      and evaluating the resulting expression at the
steady state (xt ; ) = (x; 0).
   Consider the …rst order terms. Taking derivatives of (12) with respect to x and      yields

                                 Fxm = 0 and F = 0 for m = 1; 2:

The …rst set of conditions provide 6 quadratic equations in the 6 unknowns gxm and hjxm . The
solution of these coe¢ cients follows immediately from standard methods, such as a Schur de-
composition or eigenvalue decomposition problem, and are analogous to solving for a unique
determinate equilibrium in linear rational expectations models. The second restriction pro-
vides three equations in the three unknowns g and hj for j = 1; 2.
   The second order coe¢ cients can similarly be determined by computing the second order
derivatives of F to give

                             Fxjm xk = 0;   F j = 0;    Fxjm = 0

for j = 1; 2; 3 and m; n = 1; 2. This gives 17 linear equations in the 17 unknowns. The
terms g    and hj    provide corrections to the mean of each variable due to the presence of
uncertainty. In a …rst order approximation certainty equivalence holds and uncertainty does
not a¤ect the elasticities of optimal decision rules. The elasticities on second order terms are
similarly una¤ected. The e¤ects of uncertainty on the model solution are fully captured by
constant adjustments to the mean of each variable. We will prove a similar result for the
heterogenous agent model.
   Having determined the unknowns (16) and (17), relations (14) and (15) completely char-
acterize a second-order accurate solution to the model. In particular, (15), once substituted
into (13), provides a law of motion for the aggregate capital stock. This stochastic process
determines the time series distribution of aggregate capital used to forecast future prices.




                                               13
3.2     Heterogeneous Agent Model

Our task is to determine the probability distribution characterizing the stochastic evolution
of the aggregate capital stock that is accurate to the second order. In contrast to the repre-
sentative agent model, this computation is complicated by the presence of heterogeneity in
capital holdings across households. Indeed, individual consumption and saving decisions, and
therefore the aggregate capital stock, can now depend on an additional set of state variables
relevant to describing the evolving distribution of wealth in the economy.

3.2.1    The Steady State

Following Kydland and Prescott (1982), and as often done in the modern macroeconomics
literature, an approximation to the model is sought in the neighborhood of the model’s de-
terministic steady state. The steady state is characterized by a situation in which there are
no aggregate shocks and no idiosyncractic shocks. In the absence of idiosyncractic shocks all
agents are both ex ante and ex post identical. We assume that capital is equally distributed
across agents in this steady state. It follows that in the deterministic steady state the wealth
distribution is degenerate: all agents hold the same quantity of the aggregate capital stock.
Hence the cross-sectional distribution has unit probability mass on this aggregate quantity of
capital. For example, the cross sectional variance of capital holdings is equal to zero in this
steady state, as is the cross sectional covariance between capital holdings and employment
status. These two moments of the wealth distribution are revealed to be central to our second
order approximation developed in the sequel. What the second order approximation does, is
approximate the wealth distribution in the neighborhood of this degenerate wealth distribu-
tion. It does not seek to approximate the dynamics around some ergodic wealth distribution
that might obtain with idiosyncractic shocks but no aggregate shocks as in the analyses of
Huggett (1993) and Aiyagari (1994).4
   4
    An alternative approach would be to approximate around a nondegenerate distribution implied by the
model without technology shocks. We do not pursue it here, though acknowledge such an exercise to be of
interest and might possibly give di¤erent results. Reiter (2006) presents an analysis in this spirit, though makes
use of projection methods to characterize the ergodic wealth distribution in the presence of just idiosyncratic
shocks. The e¤ects of aggreagate shocks are then determined by linear perturbation.




                                                       14
3.2.2        State Variables De…ned

To understand the set of possible state variables relevant to the evolution of the aggregate
capital stock, consider the set of state variables relevant to individual i’s decision problem
at the …rst order. They are: fai;t ; ei;t ; zt g. Noting that optimal decisions will be linear
in these state variables in our approximation, the aggregation constraint (3) then delivers a
fourth state variable in the aggregate capital stock, kt . Hence we look for an equilibrium
solution to the model in which decisions are linear functions, at the …rst order, of the terms
fai;t ; ei;t ; zt ; kt g. Because individual decisions are linear in these four state variables, it is
immediate that the aggregate capital stock at the …rst order can only depend on fkt ; zt g once
the properties of (3) are applied. The sequel will discuss further the relation between the
coe¢ cients in the individual decision rules and the aggregate capital accumulation equation.
   Which second order terms are relevant to the household’s saving decision? In principle,
decisions could depend on all pair-wise combinations of fai;t ; ei;t ; zt ; kt g appearing in a
second order polynomial of these …rst-order state variables. Hence the set of second order
terms in deviations from steady state values are

             (ai;t   a) (ei;t        e) ; (ai;t       a) kt               k ; (ai;t             a) (zt           z) ; (ai;t       a)2 ; (ei;t     e)2 ;
                                                                                                2
             (ei;t   e) kt       k ; (ei;t           e) (zt           z) ; kt              k        ; kt          k (zt       z) ; (zt        z)2 :       (18)

Again, because the dynamic equation describing individual saving decisions is linear in these
state variables, and because individual decisions must satisfy the aggregation constraint, the
aggregate capital stock can only depend on the following six objects at the second order:
                                R1                                                 R1                                             2
                                     (ai;t     a) (ei;t           e) di;                (ai;t       a)2 di;          kt       k       ;
                                0                                                  0
                                                                                                    R1
                                 kt          k (zt        z) ;        (zt           z)2 ;                (ei;t     e)2 di
                                                                                                    0

on noting that
        R1                                                            2       R1
             (ai;t   a) kt           k di =           kt          k       ;        (ai;t        a) (zt           z) di = kt           k (zt     z) ;
        0                                                                     0
        R1                                           R1
             (ei;t   e) kt           k di =               (ei;t       e) (zt             z) di = 0:
         0                                           0


                                                                               15
The …rst …ve terms represent the aggregate second order state variables while the …nal term is
a constant, representing a correction to the mean aggregate capital stock due to the presence
of idiosyncratic risk.
                                                          n                     o
   Hence, in addition to the second order polynomial terms k^t2 ; k^t z^t ; z^t2 (introducing the
notation that for any variable x, x^t = (xt                 x) gives the deviation from steady state), two
new state variables are induced from aggregation:

                             R1                                      R1
                         t        (ai;t    a)2 di and        t            (ai;t     a) (ei;t   e) di:                   (19)
                             0                                       0

The former represents the cross-sectional variance of capital holdings while the latter gives
the cross-sectional covariance between asset holdings and employment status. The dynamics
of these two state variables will be central to characterizing the evolution of the wealth
distribution. By construction these variables take a value of zero in the deterministic steady
state. Our second order approximation characterizes the dynamics of these state variables in
the neighborhood of a degenerate wealth distribution.
   Because the aggregate capital stock can depend on these variables, it follows that in equi-
librium individual household decisions must similarly depend on these second order objects.
Hence, the set of primitive objects relevant to individual household decisions are given by

                                          fai;t ; ei;t ; zt ; kt ;        t;      tg :                                  (20)

Optimal decision rules to a second order will then depend on a second order polynomial in
these state variables. There will be no cross-product terms involving                               t   and   t   since these
are inherently second order objects implying all such terms are third order or higher and
therefore irrelevant to our second order approximation. Since decisions are linear in these
state variables, aggregation then ensures that the aggregate capital stock depends only on the
aggregate quantities
                                      n                                     o
                                             ^    ^ 2 ^           2 ^     ^
                                       z^t ; kt ; kt ; kt z^t ; z^t ; t ; t :

   The model characterized in Section 2 can now be reformulated. Because (20) completely
characterizes the primitive state variables relevant to household decisions to the second order,



                                                           16
rewrite the model as

                                                                                                                  3
           uc (ci;t ) =     Et [uc (ci;t+1 ) (r (kt+1 ; lt+1 ; zt+1 ) + 1                     )] + 2 (ai;t + b)       (21)

              ai;t+1 = (1        ) at + r (kt ; lt ; zt ) ai;t + w (kt ; lt ; zt ) lei;t            ci;t              (22)

the exogenous processes

                                ei;t+1 = (1            e)       e    +   e ei;t   + "ei;t+1

                                 zt+1 = (1             z)       z    +   z zt   + "zt+1

and the laws of motion of the endogenously determined aggregate state variables

                                                                R1
                   kt+1 = hk (kt ; zt ;     t;    t;   )             ai;t+1 di                                        (23)
                                                                0
                                                                R1
                    t+1   = h (kt ; zt ;     t;   t;   )             (ai;t+1         a)2 di                           (24)
                                                                 0
                                                                R1
                    t+1   = h (kt ; zt ;     t;   t;   )             (ai;t+1         a) (ei;t+1      e) di:           (25)
                                                                 0

   Stacking these relations then permits the model to be written as

                                       Et F (ct+1 ; ct ; xt+1 ; xt ) = 0

rede…ning the state vector as xt = fai;t ; ei;t ; zt ; kt ;                     t;     t g.    The solution to this model
again takes the form

                                         ct = g (xt ; )

                                      xt+1 = h (xt ; ) +                        "t+1                                  (26)

where h (xt ; ) is now a (6      1) vector corresponding to the states xt . Hence, relative to the
original problem, the reformulated problem has exchanged the true law of motion for the
wealth distribution (6) with an approximate law of motion embodied in the dynamics of the
…nal three relations described in (23) - (25). Worth underscoring is that the modi…ed problem
nonetheless provides a second-order accurate characterization of (6) given the arguments
presented above.


                                                           17
3.3    Further Restrictions From Aggregation

So far we have discussed how heterogeneity and aggregation interact to determine the set of
state variables relevant to the dynamics and stochastic properties of the aggregate capital
stock. However, aggregation also imposes restrictions on the equilibrium coe¢ cients that can
obtain in the individual and aggregate capital accumulation equations.
   Under the reformulated model, the equilibrium laws of motion for individual capital hold-
ings in a second order approximation have the general form
                                           P
         h (x; )a = h (x; 0)a +                  haxm (x; 0) (xm       xm ) + ha (x; 0)
                                            m
                              1P a
                            +      h      (x; 0) (xm xm ) (xn xn )
                              2 n;m xn xm
                              1P a                           1P a
                            +      hxm (x; 0) (xm xm ) +        h    (x; 0) (xm                xm )
                              2 m                            2 m xm
                              1
                            + ha (x; 0) 2 + ha (x; 0)          + ha (x; 0)
                              2
where x = fai;t ; ei;t ; zt ; kt g and adopting the notation established in the discussion of the
representative agent model. The expansion is taken around the model’s steady state (x; 0)
with no aggregate or idiosyncratic uncertainty (i.e.                      = 0). Note that because f    t;     tg

capture second order variation, these variables only appear in the …nal two terms. Similarly,
aggregate capital satis…es
                                           P
         h (x; )k = h (x; 0)k +                  hkxm (x; 0) (xm       x) + hk (x; 0)
                                            m
                              1P k
                            +      h      (x; 0) (xm xm ) (xn xn )
                              2 n;m xn xm
                              1P k                           1P k
                            +      hxm (x; 0) (xm xm ) +        h    (x; 0) (xm                xm )
                              2 m                            2 m xm
                              1
                            + hk (x; 0) 2 + hk (x; 0)          + hk (x; 0)                      :
                              2
   Aggregation then requires
                             R1                 R1
                                  ai;t+1 di =        h (xt ; )a di = h (xt ; )k = kt+1 :                    (27)
                             0                  0

                       R1                                      R1
Using the facts that        (ai;t     a) di = kt          k and (ei;t       e)di = 0 relation (27) imposes the
                       0                                           0


                                                             18
following restrictions on the model solution. The …rst order coe¢ cients must satisfy

                               hka = hke = 0, hkz = haz and hkk = haa + hak :                         (28)

The second order coe¢ cients are similarly shown to satisfy

         hkkk = haak + hakk ; hkzz = hazz ; hkkz = haaz + hazk ; hk = ha + haae ; hk = ha + haaa      (29)

and
                                                       Z1
                           hk = ha + haee                   (ei;t    e)2 di = ha + haee      2
                                                                                             e:       (30)
                                                        0
The latter restriction represents the correction to the mean capital stock. It comprises two
components: one due to the aggregation of idiosyncratic risk and one due to aggregate risk
given by ha . All remaining coe¢ cients on second order terms are equal to zero.
   The two equations (24) and (25) similarly impose structure on the coe¢ cients of the second
order approximation. The appendix shows that the following coe¢ cient restrictions must be
satis…ed:

      h = (haa )2 ; h = 2hae haa ; hkk = hak (haa + hak ); hzz = (haz )2 ; hzk = 2haz (haa + hak )    (31)

will all other coe¢ cients equal to zero. The aggregation of individual speci…c risk also intro-
duces a correction to the mean equal to
                                                       Z1
                                h        =   (haa )2        (ei;t    e)2 di = (haa )2   2
                                                                                        e:            (32)
                                                       0

Finally, the law of motion for           t   provides the restriction
                                                                        a
                                                            h =      e ha                             (33)

with all other coe¢ cients equal to zero. Again, there is a correction to the mean from the
aggregation of individual speci…c risk equal to
                                                       Z1
                                 h       =    hae e         (ei;t    e)2 di = hae     2
                                                                                    e e:              (34)
                                                        0

Note that the dynamics for           t   and       t   depend only on the …rst order coe¢ cients appearing
in the individual and aggregate capital equations and so introduce no new unknowns to be
determined.

                                                                19
3.4      The Solution

Given the reformulated problem and the restrictions imposed by aggregation on the permis-
sible elasticities in the individual and aggregate laws of motion for capital, the solution can
proceed as for the representative agent case. Analogous to the analyses of Jin and Judd (2002)
and Kim, Kim, Schaumburg, and Sims (2003) and theorem 1 of Schmitt-Grohe and Uribe
(2004) for representative agent models, we prove the following result for heterogenous agent
models.

Theorem 1 All elasticities in the second order approximation to (26) — comprising the laws
of motion (21) - (25) and the two exogenous disturbance processes — are independent of
uncertainty. That is

                               g (x; 0) = h (x; 0) = gx (x; 0) = hx (x; 0) = 0

for all x 2 fai;t ; ei;t ; zt ; kt ;   t;   tg :


    The proof is in the appendix which also outlines in detail the solution method and the full
set of restrictions that are required to solve for the unknown coe¢ cients characterizing the
second order approximation. It shows that in a second order approximation, the laws of motion
for the cross sectional variance of asset holdings (24) and the cross sectional covariance between
asset holdings and employment status (25) depend only on the …rst order elasticities implied by
the dynamics of (21), (22) and (23). To solve for the remaining elasticities, relations (21) and
(22) provide 36 restrictions in 54 unknowns. The remaining 18 restrictions are determined by
the aggregation constraints implied by (23) and given in (28) - (30). An immediate implication
of theorem 1 is that the direct impact of uncertainty on optimal decisions is re‡ected in
the model solution via the constants g             and hj   — terms which represent the impact of
risk on mean decisions. For instance, g            represents the correction to an individual’s mean
consumption relative to steady state due solely to the presence of uncertainty. It therefore
represents precautionary savings. Note that the …nding g (x; 0) = h (x; 0) = 0 is the usual
certainty equivalence result associated with …rst order approximations and linear-quadratic
models.
    Perturbation methods present several advantages in solving this class of problem. First,
the solution technique analytically determines individual decision rules which are optimal to

                                                     20
the second order. As such, the implications of aggregation can easily be analyzed, with the role
of various state variables in determining the evolution of the aggregate capital stock quickly
identi…ed. This permits a careful examination of which moments of the wealth distribution
are important for aggregate dynamics. Second, there are considerable practical advantages.
Because the solution is based on standard analytical methods for solving quadratic and linear
systems of equations, the model can be solved in fractions of a second in contrast to value
function iteration-based methods. Similarly, because the approach can handle high dimen-
sion state spaces, ‡exible speci…cation of the exogenous disturbance processes can be handled.
Third, the approach is robust. Numerical methods used to solve Bellman equation problems
through value function iteration are often sensitive to the precise details of various approxima-
tions used in the procedure. For instance, small variations in the grid choice characterizing
the state space can a¤ect whether the procedure leads to convergence. There are no such
concerns with perturbation methods


4      Results
The following section delineates some properties of the model solution. While fully analytic
solutions could be presented, it is more convenient to exploit a calibration study of the model.
Our benchmark calibration is discussed in detail, highlighting some of the qualitative prop-
erties of the model solution. The dependency of optimal decisions on the evolving wealth
distribution is discussed and the implications for aggregation and aggregate dynamics made
transparent. The quantitative predictions of the model are then explored for a number of
calibrations.

4.1     The Calibration and Steady State

The time period is one quarter. The intertemporal discount factor          is set equal to 0:98 and
the depreciation rate to 0:025. The relative risk aversion parameter        equals 2 and the share
of capital       is 0:36. The normalizing constant l is set equal to 0.32 so that agents work a
third of their available hours in steady state. The aggregate technology shock is speci…ed by

 z   = 1,   z   = 0:75 and   z   = 0:0132 to correspond to the two state Markov process adopted by

                                                    21
Krusell and Smith (1998). The law of motion for individual’s employment status is modi…ed
to
                        ei;t+1 = (1       e)   e   +   e ei;t   +   ze (zt+1   z) + "ei;t+1

to allow for labor market conditions to depend on the aggregate state. This does not a¤ect the
solution method in any way, though does a¤ect the determined elasticities on zt in the optimal
decision rules. The individual’s employment status is speci…ed as                      e   = 0:93,   e   = 0:70; and
 e   = 0:05. Initially we take   ze   = 0 so that an individual’s employment status is not correlated
with the aggregate state. This facilitates comparison to a representative agent version of the
model, isolating implications of incomplete markets and heterogeneity. We later choose                         ze   to
give an average unemployment rate of 7 percent, with 4 percent and 10 percent unemployment
rate on average when there is positive and negative one standard deviation shock to technology
leaving the remaining parametric assumptions unchanged.
     The analysis assumes agents are constrained to hold positive quantities of the capital
stock (so that the borrowing limit is b = 0). The parameter                    governing the sensitivity to the
borrowing constraint in the modi…ed utility function is set equal to 0:05. This ensures that no
agent violates the borrowing constraint. There are no restrictions implied by theory that give
guidance on the magnitude of this parameter. It clearly depends on the nature of risks and
agents’attitudes towards such risk and can only be checked ex post in simulations. Of course
this is no di¤erent to other choices a modeler faces in solving such models using alternative
methods. Indeed, when using value function iteration the choice of grid characterizing the
state space can lead to non-convergence of the solution algorithm. As a robustness exercise,
we check that our results are similar for a range of values for                    though we note here that it
has implications for the properties of the cross-sectional wealth distribution. The steady state
is chosen to be the non-stochastic solution of the model in which all agents own the same
amount of capital, so that ai = k for all i.




                                                        22
4.2    Optimal Decision Rules

Optimal saving decisions imply the following second order accurate law of motion for individ-
ual capital holdings:

              a
              ^i;t+1 = 0:0003 + 0:9993^
                                      ai;t + 0:6288^
                                                   ei;t + 0:8574^
                                                                zt           0:0278k^t

                                a2i;t + 0:0006^
                         +0:0002^             ai;t e^i;t + 0:0458^
                                                                 ai;t z^t         ai;t k^t
                                                                            0:0031^

                                e2i;t
                         +0:0006^        0:6465^                ei;t k^t
                                               ei;t z^t + 0:0300^

                                zt2
                         +0:0036^              zt k^t + 0:0025k^t2
                                         0:0010^                      0:0009 ^ t   0:00005 ^ t       (35)

with all variables interpreted as deviations from steady state. The consumption allocation
rule is not presented to conserve space.
   Several points are worthy of note. First, the optimal decision rule depends on all state
variables at the …rst and second order. Hence, optimal consumption and saving decisions
depend on all variables relevant to the evolution of the wealth distribution — no elasticities
are analytically found to be zero. While the coe¢ cients on some second order terms are quite
small, with the coe¢ cient on ^ t being zero to the third decimal point, this does not necessarily
imply they are irrelevant as will be made clear in the next subsection. Second, the constant
in the decision rule arises due to the e¤ects of precautionary saving. In the presence of risk,
both aggregate and idiosyncratic, agents tend to hold more capital.
   Third, this decision rule implicitly determines an individual’s marginal propensity to save.
In general this marginal propensity to save will vary across individuals according to their
speci…c history of employment shocks and asset accumulation decisions. For the allocation of
capital to matter in this economy is must be the case that marginal propensities to save di¤er
across individuals so that di¤erent allocations of wealth engender di¤ering consumption and
savings decisions in the aggregate, a point to which we shall return.
   Applying the aggregation constraint (3) determines the aggregate capital accumulation
equation as

          k^t+1 = 0:0003 + 0:8573^
                                 zt + 0:9714k^t + 0:0036^           zt k^t
                                                        zt2 + 0:0449^                   0:0006k^t2

                        0:0007 ^ t + 0:0006 ^ t :                                                    (36)

                                                    23
The law of motion for aggregate capital inherits many of the properties of the individual laws
of motion but only depends on aggregate states. Importantly, there are …ve second order
terms relevant to the evolution of the aggregate capital stock
                                      n                                 o
                                       k^t2 ; k^t z^t ; z^t2 ; ^ t ; ^ t :
                                           n            o
The coe¢ cients on the state variables         ^ t ; ^ t have negative and positive coe¢ cients respec-

tively. To understand why there is a negative coe¢ cient on the variance of cross-sectional
capital holdings, consider an increase in this variance holding total capital …xed. As the vari-
ance rises more capital is being held by individuals with a lower marginal propensity to save.
Because this reallocation of capital results in higher aggregate consumption and lower saving
aggregate capital must fall in the next period. The positive coe¢ cient on the covariance of
cross-sectional capital holdings with employment status re‡ects the fact that a higher posi-
tive correlation implies individuals with lower capital holdings also have worse employment
outcomes. This risk leads individuals to save more, resulting in higher aggregate capital.
      To further understand the implications of heterogeneity for aggregate dynamics, consider
the associated quasi-representative agent model derived under the assumption of no idiosyn-
cratic employment shocks, though maintaining the assumption that agents face a borrowing
constraint.5 The aggregate capital dynamics are given by

             k^t+1 = 0:0001 + 0:8573^
                                    zt + 0:9714k^t + 0:0033^           zt k^t
                                                           zt2 + 0:0446^           0:0005k^t2       (37)

and depends on the same set of aggregate state variables, with the exception of the cross
sectional variance of capital holdings and covariance between capital holdings and employment
status. Comparison with the heterogeneous agent case yields several important insights. First,
precautionary savings e¤ects, which lead to higher capital accumulation and are captured in
the constant of the equilibrium laws of motion, while small, are some three times larger in the
heterogeneous agent model than in the representative agent case. While the magnitudes are
in large part a product of features of this speci…c model and the calibration (to be discussed in
the sequel), in general the presence of partially insurable idiosyncractic risks leads to greater
  5
    The true underlying representative agent models does not require a borrowing constraint determined by
the natural debt limit as in Aiyagari (1994) –the usual No-Ponzi condition su¢ ces.

                                                      24
accumulation of capital. Note also that the theory of section 2 showed that this correction is
determined by the relation
                                      hk = ha + haee    2
                                                        e:


   Second, heterogeneity does not a¤ect the model solution at the …rst order: all elasticities on
…rst order dynamics are identical across the representative and heterogeneous agent models
— compare (36) and (37). To understand this, note that i) the …rst order elasticities are
determined independently of the second order properties of the model (though these second
order properties depend on the …rst order elasticities) and ii) a …rst order approximation to
the heterogeneous agent model is equivalent to only keeping track of the mean of the wealth
distribution and therefore aggregate capital. For these two reasons, at the …rst order, the
distribution of wealth across agents is irrelevant to dynamics.
   Third, and related, to see the e¤ects of heterogeneity on dynamics, we must look to the
                                         n           o
                                                ^ k^2 are broadly of the same magnitude,
second order terms. The coe¢ cients on z^2 ; z^k;
though the …rst and third coe¢ cients are respectively 25 and 50 percent larger in the hetero-
geneous agent model. And of course, the cross sectional properties of the wealth distribution
are also relevant to dynamics in this case. In this sense heterogeneity matters qualitatively
though further work must be done to establish the quantitative implications of these terms.

4.3    Further Model Properties

To interpret the magnitudes of the reported coe¢ cients and their implications for macro-
economic dynamics, Table 1 reports model implied statistics for aggregate consumption, the
cross-sectional holdings of capital and welfare. For both the representative and heteroge-
neous agent models a …rst and second order approximate solution are given. In each case,
the statistics are generated using the same simulated path for technology shocks. For the
heterogeneous agent model we simulate 2000 sequences of idiosyncratic shocks of length 5000.
The …rst 1000 observations are dropped to remove the e¤ects of initial conditions.
   Only by considering a second order approximation of the model can the e¤ects of risk on
optimal decisions be assessed. This precautionary savings e¤ect is captured in the constant of
the optimal decision rule. As mentioned, in the heterogeneous agent model the precautionary


                                              25
                                Table 1: Aggregate Statistics

                                         Baseline Calibration            Risky Economy
     Agents                        Representative    Heterogeneous       Heterogeneous
     Order of Approximation        First   Second    First    Second     First   Second

     S.S. Consumption              0.782    0.782     0.782     0.782     0.782    0.782
     Prec. Savings (% of s.s)      0.000    0.011     0.000     0.039     0.000    0.039

     Aggregate Consumption:
     Mean (% of s.s.)              0.000    -0.060    0.000    -1.154     0.000    -1.937
     Standard Deviation            0.010     0.010    0.009     0.010     0.016    0.017
     First Order Serial Corr.      0.986     0.986    0.986     0.986     0.993    0.993

     Capital Distribution:
     Mean Variance                                              8.767              12.826
     Std. Dev. of Variance                                      0.816              1.297

     Welfare:
     Mean                         -14.375 -14.371 -14.558 -14.920 -13.139 -14.001
     Standard Deviation                            4.279   4.379   4.626   5.228



savings e¤ect is 300 percent larger re‡ecting the presence of idiosyncractic risk in this model.
However, under the present calibration there is little precautionary saving measured as a
fraction of steady state consumption.
   Analysis of the variance and …rst order serial correlation of aggregate consumption makes
clear that these properties are largely determined by …rst order dynamics. Indeed, for the
representative agent model, the standard deviations and serial correlation are identical at the
third decimal place under both a …rst and second order approximation, while in the hetero-
geneous agent model the standard deviation shows a small discrepancy at the third decimal
point for the standard deviation. Hence, aggregate dynamics appear to be mainly determined
by …rst order model properties. Moving to a second order approximation, which introduces
terms relevant to describing the evolving properties (aside from the mean) of the wealth
distribution, adds little to our quantitative predictions concerning aggregate consumption
dynamics. Hence under this calibration Krusell and Smith (1998) approximate aggregation


                                              26
emerges once more: it seems that keeping track of the mean of the wealth distribution induces
quantitatively small errors in predicting aggregate dynamics.
   However, this does not imply incomplete markets are irrelevant, since borrowing con-
straints do a¤ect …rst order dynamics. Several further caveats should also be underscored.
Even though aggregate dynamics appear to be little a¤ected by second order variation, het-
erogeneity is nonetheless relevant to the model solution. Average aggregate consumption is
lower in the heterogeneous agent model in a second order approximation when compared to
the representative agent model. That consumption is depressed on average in the presence of
greater risk suggests welfare ought to be lower. Computing average ex post welfare measures
– assigning each household an equal weight in the social objective function and computing
the present discounted value of utility implied by the determined consumption allocations –
supports this conjecture: conditional on given path of technology the representative agent
model gives a present discounted utility of -14.56; in contrast, the heterogeneous agent model
yields -14.92. The standard deviation of these ex post welfare measures are 4.279 and 4.379
respectively. Hence, not only is welfare lower on average across agents in the incomplete
markets model, but perhaps more importantly, there is signi…cant variation in the welfare of
individual agents when faced with incomplete markets and idiosyncractic risk. The relevance
of this observation for policy design is immediate.
   To make this point more starkly, consider the …nal two columns which report identical
statistics for a risky version of the economy. Here the idiosyncractic employment process is
speci…ed according to the parameterization        e   = 0:75 and   e   = 0:05 and   ze   = 0:45: It is
therefore more persistent than the benchmark case and also allows for employment status to
be correlated with the aggregate state. Note that given the evidence provided by Storesletten,
Telmer, and Yaron (2004) one could easily rationalize an income process with signi…cantly
greater persistence in the idiosyncratic shock.
   The key insight emerging from this calibration is that more risky economies lead to impor-
tant welfare consequences. Indeed, the variance in ex post welfare outcomes rises signi…cantly.
For the benchmark calibration the standard deviation was 4.379 while in the risky economy




                                              27
it is 5.228.6 Hence risk has non-trivial consequences when contemplating welfare costs of
business cycles. Moreover, it seems clear that in more general modeling frameworks such
heterogeneity will have important implications for policy design.
       It is also clear that in order to conduct policy evaluation exercises using model consistent
welfare measures requires a second order approximation to the complete model. A recent
macroeconomics literature has highlighted that a linear-quadratic approximation to the true
non-linear policy problem may not accurately rank alternative policies in terms of their im-
plications for welfare — see Kim and Kim (2003), Kim, Kim, Schaumburg, and Sims (2003)
and Woodford (2003) for discussions.
       Finally, a property of the present model is that agents make a single decision: how much
to save or consume. The only friction in the model is the incompleteness of …nancial markets.
Consistently with Krusell and Smith (2006), it is our conjecture that in more general models
in which agents face several economic decisions in the presence of a range of frictions, …rst
order dynamics may be signi…cantly a¤ected.

4.4       Marginal Propensities to Save

Given the above discussion, it is clear that the capital accumulation equation of household i
is almost linear in their own holdings of capital. There is very little curvature in the decision
rule at the second order, with the exception of the elasticity on the a
                                                                      ^i;t z^t term, which takes
a coe¢ cient of 0:0722, though even this term represents relatively small variation. But this
does not necessarily mean that the marginal propensity to save is close to unity. To see this,
write the law of motion (35) as

   a
   ^i;t+1 =     t   +    i;t   + 0:9986^            a2i;t + 0:0013^
                                       ai;t + 0:0003^             ai;t e^i;t + 0:0463^
                                                                                     ai;t z^t         ai;t k^t
                                                                                                0:0033^          (38)

where      t   and      i;t    collect aggregate and individual speci…c terms respectively that do not
depend on individual wealth holdings. Note that                     t   necessarily depends on the terms ^ t and
^ t.
   6
    It might seem puzzling that the avarage welfare is higher in the risky economy in the …rst order approxi-
mation. This is because having employment status depend on the aggregate state through zt implicity changes
the process for aggregate technology and therefore aggregate dynamics.



                                                             28
      Now if all agents are permanent income consumers then this function will be a ray out of
the origin with slope approximately equal to one. Of course, given that perturbation methods
account for variation in many dimensions we cannot plot ai;t+1 against ai;t in two dimensions
without making speci…c assumptions about the values of all other state variables, undermining
the utility of the approach. Perhaps more useful is to note the slope of the function (38) with
respect to current wealth holdings is

                    @ai;t+1
                            = 0:9986 + 0:0006^
                                             ai;t + 0:0013^
                                                          ei;t + 0:0463^
                                                                       zt    0:0033k^t :
                     @ai;t

It depends on a constant that is close to unity, the individual’s capital holdings and employ-
ment status, and also the aggregate state variables zt and kt . Hence changes in future wealth
given changes in current wealth vary across individuals according to di¤erences in asset hold-
ings and employment status. However, the e¤ects of these four …rst order state variables are
small. For instance, the typical variation in z^t is of the order 0.02 making the term 0:0463^
                                                                                             zt
relevant only at the third decimal point. As this is true of all terms, the slope under this base-
line calibration is essentially given by the constant 0:9986. But this does not mean that the
marginal propensity to save is equal to unity. The marginal propensity is determined by both
the slope and location of the schedule (35). The location di¤ers across individuals according
to di¤erences in the stochastic constant       i;t :   As individuals experience di¤erent employment
histories    i;t   will vary across agents giving rise to variations in the marginal propensity to
save. Furthermore, the location of the schedule depends on the wealth distribution through
 t.

      Analysis of the benchmark calibration indicates that there is limited variation in      i;t .   As
it is in deviations from steady state it takes values approximately equal to zero. In this case,
agents behave very much like permanent income consumers, having a marginal propensity to
save equal to unity. Agents consume the return on capital holdings each period but leave the
principle intact. Despite facing idiosyncractic income uncertainty, having access to capital
markets provides households with adequate self insurance. It is this feature of agents decision
rules that gives rise to approximate aggregation.




                                                       29
5     Approximate Aggregation
Krusell and Smith (1998) provide a novel and clever solution to the model of section 2. Noting
that the law of motion for the wealth distribution is in principle an in…nite dimensional object,
they propose solving a simpli…ed version of the model. Agents, rather than forecasting future
prices using the true distribution describing the evolution of aggregate capital, instead use a
boundedly rational law of motion of the form

                                     kt+1 =         g;0   +   g;1 kt

                                     kt+1 =         b;0   +   b;1 kt                        (39)

which describes the evolution in good times and bad times respectively. This assumption
serves to dramatically reduce the state space of the model so that value function iteration-
based methods can be used to solve agents’dynamic programming problem. They …nd that
the model displays an approximate aggregation property — future prices can be well forecasted
using only the mean capital stock. Because most agents in the economy behave like permanent
income consumers their saving decisions are almost linear in their own capital holdings. On
aggregating, tomorrow’s aggregate capital stock is then only a function of today’s aggregate
capital stock (the mean of the cross-sectional distribution of capital holdings). No other
characteristics of this distribution are present.
    Despite this cleverness, value function iteration methods still su¤er the curse of dimen-
sionality as the size of the state space increases and can therefore handle only low dimension
state space models. As a result, their analysis only reports laws of motion for the aggregate
capital stock that depend on the past aggregate capital and its square. As shown above, in
a second order accurate approximation to the model, the aggregate capital stock depends on
some 5 second order moments of the wealth distribution. The use of boundedly rational laws
of motion for the aggregate capital stock omits signi…cant information relevant to forecasting
future prices, and may engender rather di¤erent equilibrium dynamics to the true model.
    While the previous section provides evidence that variance-covariance properties may not
be much in‡uenced by second order terms, two points are worth noting. First, it does not
mean heterogeneity itself is unimportant. The model solution certainly depends on the higher

                                               30
order characteristics of the wealth distribution and welfare may critically depend on such
terms. Second, the …nding of approximate aggregation is only a quantitative result for a
particular model under a particular calibration. What is appealing about the perturbation
approach is that it ex ante permits a greater role for heterogeneity to matter for aggregate
dynamics. Because the Krusell and Smith algorithm imposes a particular law of motion for
aggregate capital that depends only on past capital many higher order terms relevant to the
wealth distribution are excluded. This restriction on the model solution directly limits the
manner in which heterogeneity can be relevant to aggregate dynamics. Indeed, the e¤ects of
heterogeneity on aggregate capital dynamics can only be felt through di¤erent coe¢ cients on
the law of motion for aggregate capital (see equation (39) above). In contrast, the solution
method delineated here allows an additional set of state variables to exert their in‡uences on
the dynamics of the aggregate capital stock. Hence, heterogeneity, in addition to in‡uencing
aggregate capital through the mean and the previous period’s aggregate capital as in Krusell
and Smith, will also a¤ect dynamics according to the dynamics of the variance of aggregate
capital, the cross sectional variance of individual capital holdings and the cross sectional
covariance of individual asset holdings with employment status.
       Perhaps most importantly, the perturbation approach does not rely on approximate aggre-
gation holding or not to give an accurate second order characterization of aggregate dynamics.
As discussed by Krusell and Smith (2006), because the value function iteration based solu-
tion method relies on the conjecture of a restricted law of motion for aggregate capital that
depends only on past aggregate capital, it will in general only be valid if approximate aggre-
gation holds and the distribution of wealth is irrelevant to dynamics. But since the solution
method is a quantitative result, without theoretical foundation, it will typically be di¢ cult
to verify in general settings whether this is true or not given that i) we do not know the
true solution to the model and ii) value function iteration methods can only consider state
spaces of limited dimension.7 While approximate aggregation has been found to hold in a
   7
    Krusell and Smith (1998) consider more general laws of motion that include an additional moment over
and above the mean capital stock, such as the volatility of aggregate capital or some measure of dispersion
of capital holdings in the population. However, to our knowledge they have not considered a law of motion
based on all moments relevant to the second order approximation discussed here.




                                                    31
number of model settings, such as the stochastic growth model presented here, this need not
be a property of other classes of models with incomplete markets and heterogeneous agents
— see Gourinchas (2000), and Krueger and Kubler (2004) for examples where approximate
aggregation is weak.

5.1    Further Insights on Approximate Aggregation

To give additional insight as to what lies behind the …nding of approximate aggregation,
consider solving the model ignoring the borrowing constraint (11). The following result is
easy to verify.
Theorem 2 If the borrowing constraint is ignored, so that = 0, then there exists a so-
lution to the individual’s Euler equation that has a unit root in each individual i’s capital
accumulation equation so that haa = 1.

   This result only demonstrates that there exists a solution of this form to the household’s
Euler equation. It does not, however, ensure satisfaction of the intertemporal budget con-
straint. The intuition for this result is as follows. The steady state of the model is consistent
with the permanent income hypothesis. At this point, and in the absence of uncertainty, in-
dividuals consume precisely their permanent income. Hence agents’optimal saving decisions
are linear in their own capital holdings. On introducing uncertainty, local to this “permanent
income point” agents continue to exhibit permanent income type behavior. Note also that
one can verify that haaa ; haaz ; haae ; ha and ha are equal to zero in this case. So what is perhaps
surprising is that there is little second order curvature.
   To reconcile the results with the optimal capital accumulation equation given by (35)
consider the implications of reintroducing the borrowing constraint. This restricts the extent
of private agents’ indebtedness. Indeed, agents must have non-negative capital holdings.
This gives rise to a stronger precautionary motive leading to higher average capital holdings.
However, by continuity; the fact that most agents hold a quantity of capital signi…cantly
above zero; and the absence of signi…cant second order curvature, the optimal accumulation
equation for individual capital implies small coe¢ cients for haaa ; haaz ; haae ; ha and ha in the
adopted calibration, consistent with the discussion of marginal propensities to save in section
4.4.

                                                 32
   This result underscores that in this model incomplete markets seem to matter little. Given
an in…nite horizon, transitory shocks and limited risk aversion, agents can engage e¤ective self
insurance using the economy’s only asset: capital. For this reason, the borrowing constraint
will only a¤ect a small number of agents who happened to be subject to an highly unlucky
sequence of employment shocks. Only in this case does the borrowing constraint become rele-
vant, consistent with departures from permanent income behavior and therefore approximate
aggregation.

5.2    Solution Accuracy and Evaluation

Having discussed the characteristics of the optimal decision rules, the analysis now turns to
a …nal exercise to evaluate the accuracy of the perturbation solution. Following Judd (1992)
and Krueger and Kubler (2004), we compute the Euler equations errors implied by each of
the solution methods so as to gauge the accuracy of the solution. That is, given the computed
consumption allocations implied both by perturbation methods and the Krusell and Smith
algorithm, we compute the errors that are implied by the true model’s Euler equation given
by (21) and (10) respectively.
   Given optimal decisions we compute the Euler equation errors according to

                                  u0   1
                                           (st+1 jst ) r~ (st+1 ) u0 c^st+1 (st+1 )
                     e st = 1                                                         :
                                                       c^st (st )

Here s denotes the set of possible states (our discrete state approximation to the laws of
motion for technology and individual employment status is discussed below). The history to
time t is denoted st .   (st+1 jst ) gives the transition density of the markov process describing
the evolution of the states and

                         r~ st+1 = r kt+1 st+1 ; zt+1 st+1           +1         :

Finally c^st (st ) denotes the optimal decisions computed under the assumed calibration.
   Because the error measure is unit free it permits comparison across the models solved by
value function iteration and the perturbation approach. The models di¤er in each case due
to the introduction of the penalty function in the perturbation approach. Note also that the


                                                33
perturbation approach adopts continuously distributed disturbances which implies construct-
ing the above measure would be computationally burdensome. We therefore parameterize the
exogenous disturbances processes

                        ei;t+1 = (1       e)   e    +   e ei;t   +   ze   (zt   z)   + "ei;t+1

                         zt+1 = (1        z)    z   +   z zt   + "zt+1

so as to imply the same discrete four state markov process used in Krusell and Smith (1998) to
describe the evolution of the technology and employment status processes. This then requires
integrating out only four states in computing the Euler equation errors. In particular, as a
benchmark, we assume that the technology shock and employment status are uncorrelated
and that     e   = 0:5 and   e   = 0:05 and    ze   = 0:45. The technology process is as speci…ed in
section 4.
      Table 2 reports the Euler equation errors for the perturbation and value function iteration
based approaches when solved subject to the above speci…ed exogenous disturbances. Both
root mean square errors and the mean absolute deviations are reported. It is immediate
that the perturbation approach leads to smaller errors under both criteria. Indeed they are
typically an order of magnitude smaller than those for the value function iteration procedure.
For instance, under the perturbation approach the mean Euler equation error under the RMSE
criterion is 0.0005 as compared with 0.0016 using value function iteration based methods.
Hence perturbation methods yield an error which is on average a third of the value function
iteration based approach. Consistent with this, the maximum errors are a …fth as large and
the minimal errors two …fths as large. This suggests the perturbation approach to be an
e¤ective solution method for models with incomplete markets and heterogeneous agents.8
Even though it is a local approximation method, globally the induced errors are not that
large.9
  8
     Note that the comparison between our method and that of Krusell and Smith is e¤ectively between two
di¤erent models. The interior function introduced in the perturbation approach to impose the borrowing
constraint changes the economic interpretation of the model — indeed the constraint will bind and e¤ect
agent behavior not only at zero assets. The numbers are jointly present to demonstrate that perturbation
methods appear to give a decent characterization of optimal decisions.
   9
     In principle solution methods based on value function function could be more accurate by appropriate
choice of grid space etc. However, for a given penalty parameter in our interior method approach, pertur-
bation methods can give a globally accurate characterization — see Swanson, Anderson, and Levin (2005).

                                                        34
                        Table 2: Euler Equation Errors (RMSE)

                                  Mean     Standard Deviation Maximun Minimun

       Perturbation               0.0005          0.0002           0.0009     0.0002

       Value Function Iteration 0.0016            0.0007           0.0054     0.0005



6     Conclusion
This paper solves a real business cycle model with heterogenous agents. Private agents face
partially insurable labor income risk and aggregate technology shocks. Solving such models is
di¢ cult as the equilibrium depends on the wealth distribution. This paper proposes solving
such models using perturbation methods. We show how to construct an equilibrium which
characterizes optimal behavior to the second order.
    Like Krusell and Smith (1998), we …nd the model displays an approximate aggregation
property. For the benchmark model and the same calibration as that paper, the aggregate
capital stock exhibits little dependency on properties of the cross-sectional distribution of
capital holdings. This …nding is a direct implication of there being little curvature in the
optimal saving decisions of individual households. Indeed, saving is close to being linear in
own holdings of the capital stock. However, this paper contributes to our understanding by
providing analytical foundations for approximate aggregation.
    Despite the similarity in results, it is worth noting the following. First, our approach
provides independent evidence that heterogeneity exerts small quantitative e¤ects on aggre-
gate dynamics in the benchmark model considered by Krusell and Smith (1998). Moreover,
it presents a distinct solution method that approximates the model solution on a di¤erent
dimension. Second, the similarity in …ndings may well not hold for alternative calibrations or
alternative models.
    Third, the framework has considerable tractability and one that can be applied to a
broad class of problems in economics. Because the approach relies on analytical methods
for solving systems of linear and quadratic equations, solving the model takes seconds rather


                                             35
than minutes or hours in the case of value function iteration. This permits confronting such
models with data using likelihood based methods. While it comes at the cost of not providing
a global solution (albeit one that introduces approximations to the model along di¤erent
dimensions) we perceive the trade-o¤ to be favorable. Indeed, the induced Euler equations
errors reveal the perturbation approach to be as accurate in a global sense as a solution based
on value function iteration. Furthermore, the approach remains valid even in models for which
approximate aggregation does not obtain.




                                              36
A       Appendix
A.1      Proof of Theorem 1

The proof of theorem 1 will serve two purposes. One is to establish the desired result. The
second is to exposit the solution method for a heterogenous agents model with incomplete
markets. A second order approximation to the following system is required:
                 2                                                                                                                       3
      2      3
                 6 Et [uc (ci;t+1 ) (r (kt+1 ; lt+1 ; zt+1 ) + 1         )] + (a 2 +b)3 uc (ci;t )                                       7
           c                                                                      i;t+1
         F       6                                                                                                                       7
      6      7 6      (1    ) at + r (kt ; lt ; zt ) ai;t + w (kt ; lt ; zt ) lei;t ci;t ai;t+1                                          7
      6 a 7 6                                                                                                                            7
      6 F 7 6                                    R1                                                                                      7
      6      7 6                                    ai;t+1 di kt+1                                                                       7
      6 k 7 6                                                                                                                            7
 F =6 F 7=6                                       0                                                                                      7=0
      6      7 6                            R1                                                                                           7
      6      7 6                                                                                                                         7
      6 F 7 6                                  (ai;t+1 a)2 di            t+1                                                             7
      4      5 6                                                                                                                         7
                 6                           0                                                                                           7
         F       4                  R1                                                                                                   5
                                       (ai;t+1 a) (ei;t+1 e) di                  t+1
                                                  0

where the desired solution has the general form

    ct = g (ai;t ; ei;t ; kt ; zt ;         t;    t;      );     ai;t+1 = ha (ai;t ; ei;t ; kt ; zt ;                t;        t;   )

 kt+1 = hk (kt ; zt ;         t;   t;   );       t+1   = h (kt ; zt ;        t;         t;        );     t+1   = h (kt ; zt ;       t;       t;    )

and for the purposes of exposition the penalty terms are ignored to simplify the notation
somewhat. The presented numerical results of course incorporate these terms. Following
Schmitt-Grohe and Uribe (2004), di¤erentiate the …rst two rows of F to obtain:
                                                                                  4
      Fac =     ucc ga haa (r + 1       )        ucc ga        6 (a + b)              haa
                                                                                                                     4
      Fkc =     ucc ga hak + gk hkk (r + 1                ) + uc rk hkk                ucc gk           6 (a + b)        hak
                                                                                                                                         4
      Fzc =     ucc ga haz + gk hkz + gz          z    (r + 1          ) + uc rk hkz +                   z      ucc gz 6 (a + b)             haz
                                                                              4
      Fec =     ucc ge   e   (r + 1     )        ucc ge        6 (a + b)              hae                                                         (40)

and

                                        Faa = (r + 1                    )    haa             ga

                                        Fea = w                 ge     hae

                                        Fka = rk ai;t + wk ei;t                       gk          hak

                                        Fza = rz ai;t + wz ei;t                       gz          haz                                             (41)

                                                                  37
which must all equal zero. To solve for the 12 …rst order coe¢ cients

                                     ga ; ge ; gk ; gz ; haa ; hae ; hak ; haz ; hka ; hke ; hkk ; hkz                              (42)

12 restrictions are required. The above gives 8 in the 12 unknowns. The …nal four come from
derivatives of the aggregation constraint F k . Recall

                                                                                       R1
                                      kt+1 = hk (kt ; zt ;              t;    t)   =        ai;t+1 di:                              (43)
                                                                                        0

A …rst order expansion of the …nal term provides:

          R1             : R1 a
               ai;t+1 di =    ha (ai;t                    a) + hae (ei;t       e) + hak kt           k + haz (zt            z) di
          0                     0
                        = (haa + hak ) kt                    k + haz (zt           z)

                           R1
using (43), a = k and           ei;t di = e. Similarly the second term must satisfy the approximation
                           0

                                                                   :
                                hk (kt ; zt ;        t;      t)    = hkk kt        k + hkz (zt            z)

implying the restrictions

                                      hka = hke = 0; hkk = haa + hak ; hkz = haz :

Together with the eight restrictions given by (40) and (41) the 12 …rst order unknown coef-
…cients (42) can be determined. Note that all other coe¢ cients are known, determined by
household preferences or the …rm’s production function.
   There are three other …rst order coe¢ cients to determine: g ; ha and hk . Two restrictions
come from the constraints

                  Fa =           g         ha
                                                                                                                     4
                  Fc =          ucc g (r + 1                  )      ucc g + uc rk hk              6 (a + b)             ha :

The third constraint comes from the aggregation restriction. Because

                                                              R1
                    hk (kt ; zt ;     t;        t;    )=           ha (ai;t ; ei;t ; kt ; zt ;       t;        t;   ) di
                                                              0



                                                                       38
it is immediate that
                                             ha = hk :

providing three equations in three unknowns. As the system is linear and homogeneous, if
there is a unique solution it must be the case that

                                       g = ha = hk = 0:

This established the …rst part of theorem 1: at the …rst order, uncertainty does not a¤ect any
of the …rst order elasticities. This is the usual certainty equivalence result.
   Solving for the second order terms proceeds in much the same way: exploit the second
order cross partial derivatives of F c and F a with respect to pairs of fa; e; k; zg and the
derivatives with respect to f ;      g. This provides 36 restrictions in 54 unknowns. The
remaining 18 restrictions again come from the aggregation constraint (43). To give a ‡avor
of the calculations, note that the second order partials Fija can be directly computed. For
example

                                     a
                                    Faa =       haaa          gaa
                                      a
                                     Fae =      haae      gae
                                     a
                                    Fak = rk           haak         gak
                                     a
                                    Faz = rz           haaz         gaz

must all equal zero. The remaining 12 cross partials are easily computed and generate re-
strictions that depend on the 16 unknown gij0 s and 16 unknown ha0
                                                                ij s. The derivatives with

respect to f ;    g provide two additional restrictions:

                                       Fa =       g           ha

                                      Fa =        g           ha :                       (44)

   Turning to the second order terms relating to F c 16 restrictions are again obtained from
the cross partials in the variables fa; e; k; zg : As the algebra is somewhat tedious, and
because these computations are not central to the conceptual heart of the solution method,


                                                39
not all coe¢ cients are presented. For example, and for simplicity ignoring terms in the penalty
function,

          c
         Faa =        (uccc (ga haa )2 + ucc [gaa haa + ga haaa ]) (r + 1      )     uccc ga2 haa   ucc gaa
          c
         Fae =        (uccc ga haa (ga hae + ge e ) + ucc (gae e haa + gaa he haa + ga haae )) (r + 1         )

                      uccc ga (ga hae + ge "e )   ucc (gaa hae + gae e )

give 2 of the 16 cross partials which are again a function only of the 16 unknown gij0 s, 16
unknown ha0                   k0
         ij s and 16 unknown hij s. The derivatives with respect to f ;                                g provide two
additional restrictions:

                Fc =           ucc ga ha + gk hk + g h + g h            (r + 1         ) + uc rk hk
                                  6      a
                                       4h     ucc g
                               (b + a
                                    ^)
                Fc =           ucc ga ha + gk hk + g h + g h                (r + 1      ) + uc rk hk
                                  6      a
                                       4h     ucc g                                                               (45)
                               (b + a
                                    ^)

Relations (44) and (45) provide 4 constraints but introduce 10 more unknowns written as

                                   g ; g ; ha ; hk ; ha ; hk ; h ; h ; h ; h :

   To proceed, suppose that the …nal 4 terms h ; h ; h ; h                      are in fact known (we will show
below that they are completely determined by the …rst order coe¢ cients already determined.
Then the above determine 36 restrictions in 54 unknowns. The …nal 18 restrictions follow
from aggregation constraint (43). A second order expansion gives

  R1             :    R1
       ai;t+1 di = a + [haa a       ^ + hak k^ + haz z^ + ha ^ + ha ^
                            ^ + hae a
   0                       0
                     1
                   + [haaa a
                           ^ + haae a            ^k^ + haaz a
                                      ^e^ + haak a          ^z^ + haea e^a^ + haee e^2 + haek e^k^ + haez e^z^
                     2
                         ^a + ha k^
                   +haka k^        ^        a ^2       a ^
                                                            z + haza z^a^ + haze e^z^ + hazk z^k^ + hazz z^2 ]]di
                                ke e + hkk k + hkz k^
                                                            ha
                 = a + (haa + hak ) k^ + haz z^ + ha + aa               t        + (haae + ha ) t
                                                              2
                     1                                                                                         R1
                   + (haak + haka + hakk ) k^2 + (haaz + haza + hakz + hazk ) k^       ^z + ha z^2 + ha e^2 di:
                                                                                                zz          ee
                     2                                                                                          0



                                                         40
Similarly, a second order expansion of
                                      k^                                       1 h k ^2                               i
   hk (kt ; zt ;   t;
                                             k
                                               ^ + hk ^ + hk ^ +
                           t ) = k + hk k + hz z                                  hkk k + hkzk z^k^ + hkkz k^
                                                                                                           ^z + hk z^2 :
                                                                                                                 zz
                                                                               2
Ignoring the …rst order terms already discuss, matching coe¢ cients then gives the 18 required
restrictions
                                                               haaa
                                                     hk      =      + ha
                                                                2
                                                     hk      = haae + ha

                                                     hkkk = 2haak + hakk

                                                     hkkz = haaz + hakz

                                                     hkkz = hkzk

                                                     hkzz = hazz :

The remaining coe¢ cients satisfy

          hkaa = hkae = hkak = hkaz = hkea = hkee = hkek = hkke = hkez = hkka = hkza = hkze = 0:

Finally note that aggregation induces a further correction to the mean capital stock since
                                                                      R1
                                                     k = a + haee          e^2 di
                                                                       0

where the latter is a constant by the law of large numbers.
   Two tasks remain. One is to determine h ; h ; h ; h                               . The second concerns accounting
for uncertainty and solving for the second order partials involving                               . Take these in turn.
Recall that
                                                      R1
                                         t+1     =         (ai;t+1    a)2 di
                                                       0
                                                      R1
                                         t+1     =         (ai;t+1    a) (ei;t+1     e) di:
                                                       0

A second order approximation to these two expressions is easily shown to provide
                                        R1
                        ^ t+1 = ha
                                 e           e^2 di + (haa )2 ^ t + 2haa hae ^ t + 2haa hak + (hak )2 k^t
                                        0

                                  +2haz (haa + hak ) z^t k^t + (haz )2 z^t2
                                       R1
                        ^ t+1   = hae e e^2i;t di + haa e ^ t :
                                             0


                                                                 41
Hence all coe¢ cients depends on either known model primitives or …rst order coe¢ cients
already determined. The solution therefore satis…es

                       h = (haa )2 ; h = 2haa hae ; h = 0; h = haa e :

   Finally, consider solving for the second order partials in . Note that the following are
true

                     Fa    =     g           ha

                     Fc    =    ucc g        (r + 1        )        ucc g        + uc rk hk :

Finally note from the aggregation constraint that the following restriction must hold
                                                               R1
                                     hk = ha + haee                 e^2i;t di:
                                                               0

Hence there are three equations in the unknowns g ; ha and hk which can be readily
solved.
   The twelve cross partials (with the remaining 12 given by symmetry and again ignoring
terms in the penalty function for simplicity) are given by

                      F ak =     g   k       ha k

                      F az =     g   z       ha z

                      F aa =     g   a       ha a

                      F ae =     g   e       ha e

                      F ck =    ucc g    k   (r + 1        )        ucc g   k    + ucc rk hk k

                      F cz =    ucc g z (r + 1             )        ucc g   z    + ucc rk hk z

                      F ca =    ucc g    a   (r + 1        )        ucc g   a    + ucc rk hk a

                      F ce =    ucc g e (r + 1             )        ucc g   e    + ucc rk hk e

                      F kk = ha k        hk k

                      F kz = ha z        hk z

                      F ka = ha a        hk a

                      F ke = ha e        hk e :

                                                      42
Once more this is a system of 12 equations in 12 unknowns that is linear and homogeneous.
It follows that if there is a unique solution then it must have all these terms equal to zero.
This therefore completes the solution of the model and also establishes the proof of theorem
1.




                                             43
References
Aiyagari, R. (1994): “Uninsured Idiosyncratic Risk and Aggregate Saving,”Quarterly Jour-
  nal of Economics, 109, 659–684.

Algan, Y., O. Allais, and W. J. Den Haan (2006): “Solving Heterogeneous-Agent
  Models with Parameterized Cross-Sectional Disctributions,”unpublished.

Benigno, P. (2001): “Price Stability with Imperfect Financial Integration,” unpublished,
  New York University.

Bewley, T. F. (1977): “The Permanent Income Hypothesis: A Theoretical Formulation,”
  Journal of Economic Theory, 16(2), 252–292.

         (1980): “The Optimum Quantity of Money,” pp. 169–210. Minneapolis: Federal
  Reserve Bank of Minneapolis.

Fernandez-Villaverde, J., and J. F. Rubio-Ramirez (2006): “Estimating Macroeco-
  nomic Modesl: A Likelihood Approach,”University of Pennsylvannia and Duke University.

Forsgren, A., P. E. Gill, and M. H. Wright (2002): “Interior Methods for Nonlinear
  Optimization,”SIAM Review, 44(4), 525–507.

Gaspar, J., and K. L. Judd (1997): “Solving Large-Scale Rational Expectations Models,”
  Macroeconomic Dynamics, 1, 45–75.

Gourinchas, P.-O. (2000): “Precautionary Savings, Life-cycle and Macroeconomics,” un-
  published, University of California Berkeley.

Huggett, M. (1993): “The Risk Free Rate in Heterogeneous Agent, Incomplete Insurance
  Economies,”Journal of Economic Dynamics and Control, 17, 953–969.

Jin, H., and K. Judd (2002): “Perturbation Methods for General Dynamic Stochastic
  Models,”unpublished, Stanford University.




                                             44
Judd, K. L. (1992): “Projection Methods for Solving Aggregate Growth Models,” Journal
  of Economic Theory, 58, 410–452.

        (1998): Numerical Methods in Economics. Cambridge, MA, M.I.T. Press.

Khan, A., and J. K. Thomas (2005): “Idiosyncractic Shocks and the Role of Nonconvexities
  in Plant and Aggregate Investment Dynamics,” unpublished manuscript, University of
  Minnesota.

Kim, J., S. H. Kim, and R. Kollmann (2005): “Applying perturbation methods to in-
  complete markets models with exogenous borrowing constraints,”unpublished manuscript,
  Federal Reserve Board.

Kim, J., S. H. Kim, E. Schaumburg, and C. Sims (2003): “Calculating and Using Second
  Order Accurate Solution of Discrete Time Dynamics Equilibrium Models,” unpublished
  manuscript, Princeton University.

Kollmann, R. (2002): “Monetary Policy Rules in the Open Economy: E¤ects on Welfare
  and Business Cylces,”Journal of Monetary Economics, 49, 989–1015.

Krueger, D., and F. Kubler (2004): “Computing Equilibrium in OLG Models with
  Stochastic Production,”Journal of Economic Dynamics and Control, 28, 1411–1436.

Krusell, P., and A. Smith (1998): “Income and Wealth Heterogeneity in the Macroecon-
  omy,”Journal of Political Economy, 106, 867–896.

        (2002): “Revisiting the Welfare E¤ects of Eliminating Business Cycles,”unpublished,
  Yale University.

        (2006): “Quantitative Macroeconomic Models with Heterogeneous Agents,”unpub-
  lished, Yale University.

Kydland, F. E., and E. C. Prescott (1982): “Time to Build and Aggregate Fluctua-
  tions,”Econometrica, 50(6), 1345–1370.



                                            45
Midrigan, V. (2006): “Menu Costs, Mult-Product Firms, and Aggregate Fluctuations,”
  unpublished, Ohio State University.

Reiter, M. (2006): “Solving Heterogeneous-Agent Models by Projection and Perturbation
  Methods,”unpublished, Universitat Pompeu Fabra.

Roca, M. (2006): “Search in the Labor Market under Imperfectly Insurable Income Risk,”
  unpublished, Columbia University.

Rotemberg, J., and M. Woodford (1999): “Interest-Rate Rules and an Estimated Sticky-
  Price Model,” in Monetary Policy Rules, ed. by J. Taylor. University of Chicago Press,
  Chicago.

Schmitt-Grohe, S., and M. Uribe (2003): “Closing Small Open Economy Models,”Jour-
  nal of International Economics, 61, 163–195.

        (2004): “Solving dynamic general equilibrium models using a second-rder approxi-
  mation to the policy function,”Journal of Economic Dynamics and Control, 28, 755–775.

Storesletten, K., C. Telmer, and A. Yaron (2001): “The Welfare Costs of Busi-
  ness Cycles Revisted: Finite Lives and Cyclical Variation in Idiosyncratic Risk,”European
  Economic Review, 45, 1311–1339.

        (2004): “Cyclical Dynamics in Idiosyncratic Labor Market Risk,”Journal of Political
  Economy, 112, 695–717.

Swanson, E., G. Anderson, and A. Levin (2005): “Higher-Order Perturbation SOlutions
  to Dynamic Discrete-Time Rational Expectations Models,” unpuslished, Federal Reserve
  Bank of San Francisco.

Woodford, M. (2003): Interest and Prices: Foundations of a Theory of Monetary Policy.
  Princeton University Press.

Young, E. R. (2005): “Approximate Aggregation,”unpublished, University of Virginia.



                                            46
