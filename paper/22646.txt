                              NBER WORKING PAPER SERIES




NONLINEAR TAX INCIDENCE AND OPTIMAL TAXATION IN GENERAL EQUILIBRIUM

                                        Dominik Sachs
                                        Aleh Tsyvinski
                                        Nicolas Werquin

                                      Working Paper 22646
                              http://www.nber.org/papers/w22646


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                   September 2016




We thank Laurence Ales, Costas Arkolakis, Andy Atkeson, Austan Goolsbee, James Hines,
Michael Peters, Stefanie Stantcheva and Gianluca Violante for helpful comments and
suggestions, and especially Florian Scheuer and Philip Ushchev for detailed and insightful
discussions. The views expressed herein are those of the authors and do not necessarily reflect the
views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2016 by Dominik Sachs, Aleh Tsyvinski, and Nicolas Werquin. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.
Nonlinear Tax Incidence and Optimal Taxation in General Equilibrium
Dominik Sachs, Aleh Tsyvinski, and Nicolas Werquin
NBER Working Paper No. 22646
September 2016
JEL No. E62,H21,H22

                                         ABSTRACT

We study the incidence and the optimal design of nonlinear income taxes in a Mirrleesian
economy with a continuum of endogenous wages. We characterize analytically the incidence of
any tax reform by showing that one can mathematically formalize this problem as an integral
equation. For a CES production function, we show theoretically and numerically that the general
equilibrium forces raise the revenue gains from increasing the progressivity of the U.S. tax
schedule. This result is reinforced in the case of a Translog technology where closer skill types
are stronger substitutes. We then characterize the optimum tax schedule, and derive a simple
closed-form expression for the top tax rate. The U-shape of optimal marginal tax rates is more
pronounced than in partial equilibrium. The joint analysis of tax incidence and optimal taxation
reveals that the economic insights obtained for the optimum may be reversed when considering
reforms of a suboptimal tax code.


Dominik Sachs                                         Nicolas Werquin
European University Institute                         Toulouse School of Economics
Department of Economics                               21 allee de Brienne
Via della Piazzuola 43                                31000 Toulouse
I-50133 Firenze                                       nwerquin@gmail.com
dominik.sachs@outlook.com

Aleh Tsyvinski
Department of Economics
Yale University
Box 208268
New Haven, CT 06520-8268
and NBER
a.tsyvinski@yale.edu
Introduction
In this paper we study the incidence and the optimal design of nonlinear income taxes
in a general equilibrium Mirrlees (1971) economy. There is an aggregate production
function with a continuum of labor inputs and imperfect substitutability between
skills. Hence the wage, or marginal product, of each skill type is endogenous.
    We connect two classical strands of the public finance literature that have so far
been somewhat disconnected: the tax incidence literature (Harberger, 1962; Kotlikoff
and Summers, 1987; Fullerton and Metcalf, 2002), and the literature on optimal
nonlinear income taxation (Mirrlees, 1971; Stiglitz, 1982; Diamond, 1998; Saez, 2001).
The objective of the tax incidence analysis (in our context with one sector and a
continuum of labor inputs) is to characterize the first-order effects of locally reforming
any given, potentially suboptimal, tax system on the distribution of individual wages,
labor supplies, and utilities, as well as on government revenue and social welfare. A
characterization of optimal taxes is then obtained by imposing that no such tax
reform has a positive impact on social welfare. We show in particular that the very
forces that drive the shape of the optimum tax schedule may lead to reverse policy
recommendations when the aim is to a reform suboptimal tax schedule, e.g., the
current US tax code.
    We start by focusing on the incidence of general tax reforms. We extend the
existing literature by considering arbitrarily nonlinear taxes and a continuum of en-
dogenous wages. In partial equilibrium, the effects of a tax change on the labor supply
of a given agent can be straightforwardly derived as a function of the elasticity of la-
bor supply of that agent (Saez, 2001). The key difficulty in general equilibrium is
that this direct partial equilibrium effect impacts the wage, and thus the labor supply,
of every other individual. This in turn feeds back into the wage distribution, which
further affects labor supply decisions, and so on. Solving for the fixed point in the
labor supply adjustment of each agent is the key step in the analysis of tax incidence
and the primary technical challenge of our paper.
    We first show that this a priori complex problem of deriving the effects of tax
reforms on individual labor supply can be mathematically formalized as solving an
integral equation. The mathematical tools of the theory of integral equations allow
us to derive an analytical solution to this problem for a general production function,
which furthermore has a clear economic meaning. Specifically, this solution can be
represented a series; its first term is the partial equilibrium impact of the reform,

                                            1
and each of its subsequent terms captures a successive round of cross-wage feedback
effects in general equilibrium.
    We proceed to the analysis of the two most commonly used production functions
in the literature, CES and Translog.1 In the CES case, we show that the solution to
the integral equation takes a particularly simple closed form as a function of the labor
supply elasticities, the income distribution, and the elasticity of substitution between
skills in production, which is new to general equilibrium setting. In the Translog
case, which allows for a general pattern of elasticities of substitution, we specify a
functional form that formalizes the idea that workers with closer productivities are
more substitutable. For this “distance-dependent” specification, we analytically derive
an arbitrarily close approximation of the solution to the integral equation, and hence
of the incidence of tax reforms. In particular, the second order approximation implies
that the general equilibrium effects on agents’ labor supplies can be summarized by
a simple affine function of the cross-wage elasticity with a single “average” type.
    We then focus on a particularly interesting baseline tax system, the “constant rate
of progressivity” tax schedule, that closely approximates the current U.S. tax code
(Heathcote, Storesletten, and Violante, 2014). We show two theoretical results for a
CES technology. First, the general equilibrium effects of any local (linear or nonlinear)
tax reform on aggregate revenue are equal to zero if the baseline tax schedule is linear.
Second, and more generally, if the baseline tax system is strictly progressive (as in
the U.S.), our incidence formula shows that the revenue gains of raising the marginal
tax rates on low incomes are lower than in partial equilibrium, and higher for high
incomes. In other words, starting from the U.S. tax code, the general equilibrium
forces raise the revenue gains from increasing the progressivity of the tax schedule.
    At first sight this result may seem to be at odds with the familiar insight of Stiglitz
(1982) in the two-income model, which we generalize to a continuum of incomes in
our section on optimal taxation. Indeed, those results say that the optimal tax rates
should be lower at the top, and higher at the bottom, of the income distribution, rel-
ative to the partial equilibrium benchmark. That is, the optimal tax schedule should
be more regressive when the general equilibrium forces are taken into account. The
reason for this difference is that we consider here reforms of the current (potentially
suboptimal) U.S. tax code, with low marginal tax rates at the bottom. Instead, the
results about the optimum tax schedule use as a benchmark the optimal partial equi-
   1
     See Bucci and Ushchev (2014) for a careful study of various production functions with a con-
tinuum of inputs and constant or variable elasticities of substitution.

                                               2
librium tax schedule, which features high marginal tax rates at the bottom (Diamond,
1998; Saez, 2001). Our insight is therefore that results about the optimum tax sched-
ule may actually be reversed when considering reforms of a suboptimal tax schedule.
This “trickle up result” for government revenue underlines the importance of our tax
reform approach, and leads us to conclude that one should be cautious, in practice,
when applying the results of the general equilibrium optimal tax theory.
    Our second set of results concerns the derivation of optimal taxes in the general
equilibrium setting. For a general production function, we provide two complementary
proofs of the optimal tax formula. The first uses a mechanism design approach as
in Mirrlees (1971) (or Stiglitz (1982) in general equilibrium). The second approach
is based on variational arguments in the spirit of Saez (2001), and is an application
of our tax incidence analysis discussed above. The key step that allows us to reduce
the complexity of the optimal taxation problem consists of equating to zero the social
welfare effects of a specific combination of tax reforms, namely, a perturbation of the
marginal tax rate at a given income level with a counteracting reform that cancels out
the induced general equilibrium effects on labor supply. While this analysis of course
delivers the same formula as the mechanism design approach, it provides distinct
economic insights about the key economic forces underlying the design of optimal
taxes.
    We then focus on the case of the CES production function, and extend two of the
most influential results from the Mirrleesian literature to our framework with endoge-
nous wages. The first is the optimal top tax rate formula of Saez (2001). We derive a
particularly simple closed-form generalization of this result in terms of one additional
sufficient statistic, namely, the (finite) elasticity of substitution between skills. Using
the values of this parameter estimated in the empirical literature immediately leads
to clear policy recommendations for the optimal tax rate on high incomes in the pres-
ence of “trickle-down” effects on wages. The second key result is the familiar U-shaped
pattern of optimal marginal tax rates first obtained by Diamond (1998). We show
that the general equilibrium forces not only confirm this pattern, but make it even
more pronounced, with a stronger dip in the bulk of the income distribution. This
has an interesting and unexpected implication: where marginal tax rates are increas-
ing (resp., decreasing) in the partial equilibrium model, they now increase (resp.,
decrease) faster, implying a more progressive (resp., regressive) pattern of optimal
tax rates above (resp., below) a certain income level. This qualifies the regressivity
implication of the two-type analysis of Stiglitz (1982), already described above, and

                                            3
highlights the importance of studying these forces within the workhorse model of
taxation.
    Our final set of results is a quantitative analysis of both the tax incidence and the
optimal taxes in the general equilibrium setting. We first calibrate our model to the
U.S. tax code.2 To meaningfully compare the general equilibrium optimal taxes to
the partial equilibrium optimum, we further construct a policy-relevant benchmark.
Specifically, we compare our policy recommendations to those one would obtain by
applying the analysis of Diamond (1998), calibrating the model to the same income
distribution, and making the same assumptions about the utility function. The sim-
ulations of optimal policies confirm our theoretical insights for the CES production
function and show their quantitative significance. Moreover, when the production
function is Translog and the elasticity of substitution is distance-dependent, we show
that our key results, both on tax incidence and optimal taxation, are not only con-
firmed but reinforced: the revenue gains from raising the progressivity of the U.S. tax
code, and the U-shaped pattern of optimal marginal tax rates, are more pronounced
than in the CES case. We finally compute, for a Rawlsian social planner, the wel-
fare gains from setting taxes optimally, relative to the partial equilibrium optimum
benchmark. These gains are quantitatively significant. Both for CES and Translog
production functions, with reasonable values of the elasticities of substitution, they
are up to 3.5% gains in consumption equivalent.

Related Literature. This paper is related to the literature on tax incidence (see,
e.g., Harberger (1962) and Shoven and Whalley (1984) for the seminal papers, Hines
(2009) for emphasizing the importance of general equilibrium in taxation, and Kot-
likoff and Summers (1987) and Fullerton and Metcalf (2002)) for comprehensive sur-
veys. Our paper extends this framework to an economy with a continuum of (labor)
inputs with arbitrary nonlinear tax schedules. Thus, we study tax incidence in the
workhorse model of optimal nonlinear labor income taxation of (Mirrlees, 1971; Dia-
mond, 1998), thereby contributing to the unification of the two major strands in the
taxation literature (tax incidence and optimal taxation).
    The optimal taxation problem in general equilibrium with arbitrary nonlinear tax
instruments has originally been studied by Stiglitz (1982) in a model with two types.

   2
     The calibration is based on Heathcote, Storesletten, and Violante (2014) who show that a two-
parameter tax function with contrant rate of progressivity can well approximate the U.S. tax code.
See also Guner, Kaygusuz, and Ventura (2014) and Antras, de Gortari, and Itskhoki (2016).

                                                4
The key result of Stiglitz (1982) is that at the optimum tax system, general equilib-
rium forces lead to a more regressive tax schedule. In the recent optimal taxation
literature, there are two strands that relate to our work. First, a series of important
contributions by Scheuer (2014); Rothschild and Scheuer (2013, 2014); Scheuer and
Werning (2015), Chen and Rothschild (2015), Ales, Kurnaz, and Sleet (2015) and
Ales and Sleet (2016) form the modern analysis of optimal nonlinear taxes in gen-
eral equilibrium. Specifically, Rothschild and Scheuer (2013, 2014) generalize Stiglitz
(1982) to a setting with N sectors and a continuum of (infinitely substitutable) skills
in each sector, leading to a multidimensional screening problem. Ales, Kurnaz, and
Sleet (2015) and Ales and Sleet (2016) microfound the production function by incor-
porating an assignment model into the Mirrlees framework and study the implications
of technological change and CEO-firm matching for optimal taxation. Our model is
simpler than those of Rothschild and Scheuer (2013, 2014) and Ales, Kurnaz, and
Sleet (2015). In particular, different types earn different wages (there is no overlap in
the wage distributions of different types, as opposed to the framework of Rothschild
and Scheuer (2013, 2014)), and the production function is exogenous (in contrast to
Ales, Kurnaz, and Sleet (2015)). Our simpler setting, on the other hand, allows us to
get a sharper characterization of the effects of taxes on individual and aggregate wel-
fare, and to directly compare our results to the (Mirrlees, 1971) benchmark. Finally,
our setting is distinct from those of Scheuer and Werning (2015, 2016), whose mod-
eling of the technology is such that the general equilibrium effects cancel out at the
optimum tax schedule, so that the formula of Mirrlees (1971) extends to more general
production functions. We discuss in detail the difference between our framework and
theirs in Section 3.2 below.
    The second strand in the literature characterizes optimal government policy, within
restricted classes of nonlinear tax schedules, in general equilibrium extensions of the
continuous-type Mirrleesian framework. Heathcote, Storesletten, and Violante (2014)
study optimal tax progressivity in a model with tax schedules of the CRP form in
general equilibrium.3 Itskhoki (2008) and Antras, de Gortari, and Itskhoki (2016)
characterize the impact of distortionary redistribution of the gains from trade in an
open economy using a linear or CRP tax schedule, allowing for imperfect substi-
tutability between the tasks performed by different agents. Their production func-
tions are CES with a continuum of skills or tasks, as in several parts of our paper.
   3
     See also Heathcote and Tsujiyama (2016) for a detailed analysis of the performance of various
restricted functional forms to approximate the fully optimal taxes.

                                                5
Moreover, one of our key theoretical results, as well as our quantitiative analysis, use
the CRP schedule as an approximation of the current U.S. tax system. On the one
hand, our model is simpler than their framework as we abstract from idiosyncratic
risk and take skills as given, and we study a static and closed economy. On the other
hand, for most of our theoretical analysis we do not restrict ourselves to a particular
functional form for taxes. Our papers share, however, one important goal: to derive
simple closed form expressions for the effects of tax reforms in general equilibrium
Mirrleesian environments.
    Our study of tax incidence is based on a variational, or “tax reform” approach,
originally pioneered by Piketty (1997) and Saez (2001), and extended to several other
contexts by, e.g., Kleven, Kreiner, and Saez (2009) (for the case of multidimensional
screening), and Golosov, Tsyvinski, and Werquin (2014) (for dynamic stochastic mod-
els). In this paper we extend this approach to the general equilibrium framework with
endogenous wages. Our resulting optimal tax formula coincides with the characteriza-
tion we also obtain using the traditional mechanism design approach, which is similar
to those derived by Rothschild and Scheuer (2013, 2014) and Ales, Kurnaz, and Sleet
(2015). However, using the variational approach uncovers different fundamental eco-
nomic forces and provides an alternative, arguably clearer, economic intuition for the
characterization of the optimum.4
    Our paper revisits the key policy-relevant insights obtained in the partial equilib-
rium model by Diamond (1998) and Saez (2001), namely the closed-form formula for
the optimal top tax rate and the U-shape of optimal marginal tax rates. Our gen-
eralization of the optimal top tax rate to the case of endogenous wages is related to
Piketty, Saez, and Stantcheva (2014). They extend the Saez (2001) top tax formula
to a setting with a compensation bargaining channel using a variational approach,
and show that it increases optimal top taxes as bargaining is a zero sum game. More
generally, Rothschild and Scheuer (2016) study optimal taxation in the presence of
rent-seeking. In this paper we abstract from such considerations and assume that in-
dividuals are paid their marginal productivity. Finally, our quantitative analysis is in
the spirit of those of Feldstein (1973) and Allen (1982), who specified the production
function to simple functional forms, but focused on the case of linear taxes.

   4
     Rothstein (2010) studies the desirability of EITC-type tax reforms in a model with heterogenous
labor inputs and nonlinear taxation. He only considers own-wage effects, however, and no cross-
wage effects. Further he treats intensive margin labor supply responses as occurring along linearized
budget constraints.

                                                 6
    This paper is organized as follows. Section 1 describes our framework and defines
the key structural elasticity variables. In Section 2 we analyze the tax incidence
problem with a continuum of wages and nonlinear income taxes. In Section 3 we
derive optimal taxes in general equilibrium. Finally, we present quantitative results
in Section 4. The proofs of all the formulas and results of this paper are gathered in
Appendix B. Appendix C contains additional details and robustness checks for our
numerical simulations.


1       Environment
1.1     Equilibrium
Individuals have preferences over consumption c and labor supply l given by U (c, l) =
u (c − v (l)),5 where u and v are twice continuously differentiable and satisfy u0 , v 0 > 0,
u00 ≤ 0, v 00 > 0. There is a continuum of types (productivities) θ ∈ Θ = θ, θ̄ ⊂ R+ ,
                                                                              

distributed according to the p.d.f. fθ (·) and c.d.f. Fθ (·). Each type is composed of a
mass 1 of identical agents.
    An individual of type θ earns a wage w(θ), that she takes as given. She chooses
her labor supply l(θ) and earns taxable income y(θ) = w(θ)l(θ). Her consumption is
equal to y (θ) − T (y (θ)), where T : R+ → R is the income tax schedule imposed by
the government, which is twice continuously differentiable. The optimal labor supply
choice l (θ) is the solution to the first-order condition of the utility-maximization
problem:
                           v 0 (l (θ)) = [1 − T 0 (w (θ) l (θ))] w (θ) .                  (1)

We denote by U (θ) the indirect utility and by L (θ) ≡ l (θ) fθ (θ) the total amount of
labor supplied by individuals of type θ.
   There is a continuum of mass 1 of identical firms that produce output using the
labor of all types θ. We represent the continuum of labor inputs L = {L (θ)}θ∈Θ
as a finite, non-negative Borel measure on the compact metric space (Θ, B (Θ)).6
    5
      Note that U implies no income effects on labor supply. This simplifying assumption is commonly
made in the optimal taxation literature. See, e.g., Diamond (1998).
    6
      Thus, for any Borelian set B ∈ B (Θ) (e.g., an interval in Θ), L (B) is the total amount of
labor supplied by individuals with productivity θ ∈ B. Denote by M the space of such measures
L . This construction follows Hart (1979) and Fradera (1986); see also Parenti, Thisse, and Ushchev
(2014) and Scheuer and Werning (2016).

                                                 7
We then define the production function as F (L ) = F {L (θ)}θ∈Θ and write the
                                                                     

representative firm’s profit-maximization problem given the wage schedule {w (θ)}θ∈Θ
as                                       ˆ                
                          max F (L ) −       w (θ) L (θ) dθ .
                                  L                  Θ

We assume that the production function F has constant returns to scale. In equilib-
rium, firms earn no profits and the wage w (θ) is equal to the marginal productivity
                                                  ∂
                                                      F {L (θ0 )}θ0 ∈Θ . Formally, w (θ)
                                                                      
of type-θ labor. Heuristically, we have w (θ) = ∂L(θ)
is equal to the Gateaux derivative of the production function when the labor effort
schedule L is perturbed in the direction of the Dirac measure at θ, δθ :

                                          1
                              w (θ) = lim   {F (L + µδθ ) − F (L )} .                 (2)
                                      µ→0 µ


It follows from definition (2) that the wage w (θ) can be represented as a functional
ω : Θ × R+ × M → R+ that has three arguments: the individual’s type θ ∈ Θ, her
labor supply L (θ) ∈ R+ , and the measure L ∈ M that describes all agents’ labor
effort:
                                w (θ) = ω (θ, L (θ) , L ) .                       (3)

We make the following assumption throughout the paper:7

Assumption 1. The wage and earnings functions θ 7→ w (θ) and θ 7→ y (θ) are
continuously differentiable and strictly increasing.

    We can then define the densities of wages and incomes, respectively, as fw (w(θ)) =
(w0 (θ))−1 fθ (θ) and fy (y(θ)) = (y 0 (θ))−1 fθ (θ), with corresponding c.d.f. Fw (·) and
Fy (·).


1.2       Social welfare
The government’s objective is weighted utilitarian. The schedule of Pareto weights
is represented by the p.d.f. f˜θ (·). If f˜θ (θ) = fθ (θ) for all θ ∈ Θ, the planner is
utilitarian. Social welfare is then defined by:
                     ˆ
               G ≡      u [w (θ) l (θ) − T (w (θ) l (θ)) − v (l (θ))] f˜θ (θ) dθ.   (4)
                          Θ


   7
       We verify numerically that this assumption is satisfied.

                                                   8
Denote by λ the marginal value of public funds.8 We define the social marginal welfare
weight (see, e.g., Saez and Stantcheva (2016)) associated with individuals of type θ
as
                                   u0 [c (θ) − v (l (θ))] f˜θ (θ)
                          gθ (θ) =                                .                (5)
                                             λfθ (θ)
We finally denote by f˜y (y (θ)) = (y 0 (θ))−1 f˜θ (θ) and gy (y (θ)) = gθ (θ) the corre-
sponding schedules of Pareto weights and marginal social welfare weights on incomes.


1.3     Elasticity concepts
Partial equilibrium labor supply elasticities. Consider an individual with type
θ, income y = y (θ), and marginal tax rate τ (θ) = T 0 (y (θ)). We first define the
labor supply elasticity with respect to the net-of-tax rate along the linearized budget
constraint, keeping the wage constant, as:9,10

                                          ∂ ln l (θ)                   v 0 (l (θ))
                     εl,1−τ (θ) =                               =                      .            (6)
                                      ∂ ln (1 − τ (θ))   w(θ)       l (θ) v 00 (l (θ))

    Second, we define the elasticity along the nonlinear budget constraint as the to-
tal labor supply response to a perturbation of the net-of-tax rate, keeping wages
constant.11 This elasticity accounts for the fact that if the baseline tax schedule is
nonlinear, a change in individual labor supply induces a change in the marginal tax
rate, and hence a further labor supply adjustment. Solving for this fixed point, we
obtain:
                                             1 − T 0 (y (θ))
              ε̃l,1−τ (θ) =                                                   εl,1−τ (θ) .          (7)
                              1 − T 0 (y (θ)) + εl,1−τ (θ) y (θ) T 00 (y (θ))

   Finally, we define the labor supply elasticity with respect to an exogenous per-
turbation in the wage along the nonlinear budget constraint, still ignoring the in-
duced general equilibrium effects. A change in the wage rate affects the wedge
   8
      At this stage, we do not take a stand on how the marginal value of public funds λ is determined.
It can be defined exogenously as the social value of marginally increasing government revenue to
fund a public good, or endogenously by imposing that all the perturbations of the tax system that
we consider are revenue neutral, e.g., by redistributing lump-sum any excess revenue.
    9
      See, e.g. Saez (2001), Golosov, Tsyvinski, and Werquin (2014). Note that Assumption 1 allows
us to write interchangeably εl,1−τ (θ) or εl,1−τ (y (θ)) depending on the context, and similarly for all
the elasticities that we define.
   10
      The formulas of this section are derived in Appendix B.2.1.
   11
      See, e.g., Jacquet and Lehmann (2016), Scheuer and Werning (2016).

                                                     9
(1 − τ (θ)) w (θ) directly as in the case of an exogenous perturbation in the net-of-tax
rate, and indirectly through its effect on the marginal tax rate τ (θ) = T 0 (w (θ) l (θ)).
Therefore
                                1 − T 0 (y (θ)) − y (θ) T 00 (y (θ))
              ε̃l,w (θ) =                                                   εl,1−τ (θ) .         (8)
                            1 − T 0 (y (θ)) + εl,1−τ (θ) y (θ) T 00 (y (θ))

Wage elasticities. We now define the elasticity of the wage of type θ, w (θ), with
respect to the labor supply of type θ0 , L (θ0 ). Heuristically, γ (θ, θ0 ) = ∂∂ ln       ln w(θ)
                                                                                            L(θ0 )
                                                                                                   =
L (θ ) Fθ,θ0 /Fθ . Formally, γ (θ, θ ) is defined as the Gateaux derivative of the func-
    0    00        0                     0

tional ω (θ, L (θ) , L ) when L = {L (x)}x∈Θ is perturbed in the Dirac direction δθ0 .
Note that the function θ 7→ γ (θ, θ0 ) generally “jumps” when θ = θ0 , i.e., when we con-
sider the impact of the labor supply of type-θ0 agents on their own wage.12 We thus
define the cross-wage elasticity, for θ 6= θ0 , as γ̄ (θ, θ0 ) = γ (θ, θ0 ), and the own-wage
elasticity γ̄¯ (θ0 , θ0 ) as the difference between γ (θ0 , θ0 ) and limθ→θ0 γ̄ (θ, θ0 ).

Definition 1. Define the cross-wage elasticity as

                                    1
       γ̄ (θ, θ0 ) = L (θ0 ) × lim    {ln ω (θ, L (θ) , L + µδθ0 ) − ln ω (θ, L (θ) , L )} ,     (9)
                                µ→0 µ


and the own-wage elasticity as

                                                  ∂ ln ω (θ, L (θ) , L )
                                   γ̄¯ (θ, θ) =                          .                      (10)
                                                        ∂ ln L (θ)

The wage elasticity γ (θ, θ0 ), for any (θ, θ0 ) ∈ Θ2 , is then given by

                               γ (θ, θ0 ) = γ̄ (θ, θ0 ) + γ̄¯ (θ0 , θ0 ) δθ0 (θ) .              (11)

We assume throughout that the function θ 7→ γ̄ (θ, θ0 ) is continuously differentiable.

General equilibrium labor supply elasticities. If wages are endogenous, the
partial equilibrium elasticities (6) to (8) do not fully capture the labor supply response
to a tax change. At a first step and for notational simplicity, we now introduce an
elasticity concept that takes into account the endogeneity of the wage w(θ) to its own

  12
      This is because the labor supply L (θ0 ) appears only through L in the arguments of
ω (θ, L (θ) , L ) if θ0 6= θ, while it also appears directly as the second argument of the functional
if θ0 = θ. See Section 1.4 for examples.

                                                      10
labor supply L(θ), keeping everyone else’s labor supply fixed:

                                   ε̃l,1−τ (θ)                                 ε̃l,w (θ)
            Ẽl,1−τ (θ) =                            , and Ẽl,w (θ) =                          .   (12)
                            1 − γ̄¯ (θ, θ) ε̃l,w (θ)                   1 − γ̄¯ (θ, θ) ε̃l,w (θ)

Intuitively, a percentage increase in the labor supply of type-θ individuals by ε̃l,1−τ (θ),
triggered by an increase in their net-of-tax rate, lowers their own wage by γ̄¯ (θ, θ),
which in turn decreases their labor supply by γ̄¯ (θ, θ) ε̃l,w (θ). Solving for this fixed
point yields the expression for Ẽl,1−τ (θ) in (12).


1.4       Examples
In order to illustrate the wage and elasticity concepts introduced so far, we now
analyze the two most common production functions used in the literature, namely
CES and Translog.13

Example 1. (CES technology.) The production function has constant elasticity
of substitution (CES) if
                                                   ˆ                              1/ρ
                            F {L (θ)}θ∈Θ =                                 ρ
                                              
                                                             a (θ) (L (θ)) dθ             ,         (13)
                                                        Θ


for some constant ρ ∈ (−∞, 1]. The wage schedule is given by
                                                        ˆ                            ρ1 −1
                                                  ρ−1                          ρ
                      w (θ) = a (θ) (L (θ))                      a (x) (L (x)) dx              ,    (14)
                                                             Θ


which highlights its dependence on the three variables θ ∈ Θ, L (θ) ∈ R+ , and
L = {L (θ0 )}θ0 ∈Θ ∈ M. The cross- and own-wage elasticities are given by

                                             a (θ0 ) L (θ0 )ρ
                 γ̄ (θ, θ0 ) = (1 − ρ) ´                    ρ    , and γ̄¯ (θ, θ) = ρ − 1.          (15)
                                           Θ
                                             a (x)   L (x)    dx

Note that γ̄¯ (θ, θ) < 0 is constant. Moreover, γ̄ (θ, θ0 ) > 0 does not depend on θ,
implying that a change in the labor supply of type θ0 has the same effect (in percentage
                                                                                     0 )) −1
                                                                       h                  i
terms) on the wage of every type θ 6= θ0 . Denoting by σ (θ, θ0 ) = − ∂∂ ln(w(θ)/w(θ
                                                                          ln(L(θ)/L(θ0 ))
the elasticity of substitution between any two labor inputs, we have σ (θ, θ0 ) = 1−ρ
                                                                                   1
                                                                                         ≡σ

  13
       The formulas of this section are proved in Appendix B.2.2.

                                                        11
for all (θ, θ0 ) ∈ Θ2 . The cases σ = 1 and σ = 0 correspond respectively to the Cobb-
Douglas and Leontieff production functions, and σ = ∞ is the partial equilibrium
case where wages are exogenous.

   Our second main example is the Translog production function, which can be used
as a second-order approximation to any production function (see details in Chris-
tensen, Jorgenson, and Lau (1973)).

Example 2. (Translog technology.) The production function is transcendental
logarithmic (Translog) if
                                          ˆ
         ln F {L (θ)}θ∈Θ = a0 +
                             
                                          a (θ) ln L (θ) dθ + . . .
              ˆ                         Θ    ˆ                                                                 (16)
            1    ¯                  2      1
                β̄ (θ, θ) (ln L (θ)) dθ +           β̄ (θ, θ0 ) (ln L (θ)) (ln L (θ0 )) dθdθ0 ,
            2 Θ                            2 Θ×Θ
                       ´                                                              ´
where for all θ, θ0 , Θ a (θ0 ) dθ0 = 1, β̄ (θ, θ0 ) = β̄ (θ0 , θ), and β̄¯ (θ, θ) = − Θ β̄ (θ, θ0 ) dθ0 .
These restrictions ensure that the technology has constant returns to scale. When
β̄ (θ, θ0 ) = 0 for all θ, θ0 , the production function is Cobb-Douglas. The wage schedule
is given by
                                                                 ˆ
                  F (L )
                                                                                                      
          w (θ) =                a (θ) + β̄¯ (θ, θ) ln L (θ) +                  0         0
                                                                         β̄ (θ, θ ) ln L (θ ) dθ   0
                                                                                                           .   (17)
                   L (θ)                                             Θ


The cross- and own-wage elasticities are given by

                                             β̄ (θ, θ0 )                         β̄¯ (θ, θ)
                   γ̄ (θ, θ0 ) = χ (θ0 ) +               , and γ̄¯ (θ, θ) = −1 +            ,                  (18)
                                               χ (θ)                                χ (θ)

where χ (θ) = w(θ)L(θ)
               F (L )
                       denotes the type-θ labor share of output. Whenever we specify
a Translog technology in the sequel, we assume the functional form:
                                                                                      
                                                           1          2
                       β̄ (θ, θ ) = α (θ) α (θ ) c − exp − 2 (θ − θ0 )
                              0                   0
                                                                                              ,                (19)
                                                          2s

where c, s are constants and α is a given function. Formula (18) then shows that the
cross-wage elasticities γ̄ (θ, θ0 ) are increasing in the distance between the types θ and
θ0 . This captures the economic intuition that two individuals are stronger substitutes
the closer their productivity.14
   14
        The expression for σ (θ, θ0 ) is derived in Appendix B.2.2. Teulings (1995) obtains this property

                                                          12
2     General tax incidence analysis
In this section we derive the first-order effects of arbitrary local perturbations (“tax
reforms”) of a given baseline, potentially suboptimal, tax schedule on: (i) individual
labor supplies, wages, and utilities; and (ii) government revenue and social welfare.
We analyze this incidence problem for a general production function in Sections 2.1
and 2.2, and for specific technologies (CES and Translog) in Sections 2.3 and 2.4.


2.1     Effects of tax reforms on labor supply
As in partial equilibrium (Saez, 2001), analyzing the incidence effects of tax reforms
relies crucially on solving for each individual’s change in labor supply in terms of
behavioral elasticities. This problem is, however, much more involved in general
equilibrium. In the former setting, without income effects, a change in the tax rate
of a given individual, say θ, induces only a change in the labor effort of that type
(measured by the elasticity (7)). In the latter setting, instead, this labor supply
response of type θ affects the wage, and hence the labor supply, of every other agent
θ0 6= θ. This in turn feeds back into the wage of θ, which further impacts her labor
supply, and so on. Representing the total effect of this infinite chain reaction triggered
by arbitrarily non-linear tax reforms is thus a priori a complex task.15
     The key step towards the general characterization of the economic incidence of
taxes, and our first main theoretical contribution, consists of showing that this prob-
lem can be mathematically formulated as solving an integral equation.16 Formally,

in an assignment model. More generally, the results of this paper go through if we interpret our
production function as the outcome of an task-assignment model, in which the assignment is invariant
to taxes. See Ales, Kurnaz, and Sleet (2015) and Scheuer and Werning (2015).
   15
      One way to side-step this problem would be to define, for each specific tax reform, a “policy
elasticity” (as in Hendren (2015), Piketty and Saez (2013)), equal to each individual’s total labor
supply response to the corresponding reform. It would then be straightforward to derive the effects
of a particular tax reform on, say, social welfare, as a function of its policy elasticity variable (see
Section 2.2). However, the key difficulty of the incidence problem consists precisely of expressing this
total labor supply response in terms of the structural elasticity parameters introduced in Section
1.3. Doing so allows us to uncover the fundamental economic forces underlying the incidence of
taxation. It also allows us to represent the effects of any tax reform in terms of a common set of
structural elasticity parameters, without requiring the case-by-case evaluation of the policy elasticity
associated with each specific reform that one might consider implementing in practice.
   16
      The general theory of linear integral equations is exposed in, e.g., Tricomi (1985), Kress (2014),
and, for a concise introduction, Zemyan (2012). Moreover, simple closed-form solutions can be
derived in many cases (see Polyanin and Manzhirov (2008)). Finally, numerical techniques are
widely available and can be easily implemented (see, e.g., Press (2007) and Section 2.6 in Zemyan

                                                  13
consider an arbitrary non-linear tax reform of a baseline tax schedule T (·). This tax
reform can be represented by a continuously differentiable function h (·) on R+ , so
that the perturbed tax schedule is T (·) + µh (·), where µ ∈ R. Our aim is to com-
pute the first-order effect of this perturbation h on individual labor supply, when the
magnitude of the tax change is small, i.e., as µ → 0. This is formally expressed by
the Gateaux derivative of the labor supply functional T 7→ l (θ; T ) in the direction h,
that is,17
                                     1
                    dˆl (θ, h) = lim {ln l (θ; T + µh) − ln l (θ; T )} .            (20)
                                 µ→0 µ

This expression captures the total change in the labor supply of type θ in response
to the tax reform h, taking into account all of the general equilibrium effects due to
the endogeneity of wages.

Lemma 1. The impact of a perturbation h of the baseline tax schedule T on individual
labor supplies, dˆl (·, h), is the solution to the integral equation
                                                                 ˆ
                                     h0 (y (θ))
       dˆl (θ, h) = −Ẽl,1−τ (θ)                   + Ẽl,w (θ)       γ̄ (θ, θ0 ) dˆl (θ0 , h) dθ0 ,   (21)
                                   1 − T 0 (y (θ))               Θ


for all θ ∈ Θ.

Proof. See Appendix B.3.1.

    Formula (21) is a Fredholm integral equation of the second kind. Its unknown,
which appears under the integral sign, is the function θ 7→ dˆl (θ, h). Its kernel is
K1 (θ, θ0 ) = Ẽl,w (θ) γ̄ (θ, θ0 ). We now provide its intuition.
    Due to the reform the net-of-tax rate of individual θ changes, in percentage terms,
       h0 (y(θ))
by − 1−T   0 (y(θ)) . By definition of the elasticity (7), this tax reform induces a direct
                                                                    h0
percentage change in labor supply l (θ) equal to −ε̃l,1−τ (θ) 1−T      0 . This is the expression

we would obtain in partial equilibrium.18 In general equilibrium, type-θ labor supply
is also impacted indirectly by the change in all other individuals’ labor supplies.
Specifically, the change in labor supply of each type θ0 , dˆl (θ0 , h), triggers a change in
the wage of type θ equal to γ (θ, θ0 ) × dˆl (θ0 , h), and thus a further adjustment in her
labor supply equal to ε̃l,w (θ) γ (θ, θ0 ) dˆl (θ0 , h). Summing these effects over θ0 ∈ Θ, and
(2012)), leading to straightforward quantitative evaluations of the incidence of arbitrary tax reforms
(see Section 4).
   17
      The notation dˆl (θ, h) ignores for simplicity the dependence of the Gateaux derivative on the
baseline tax schedule T .
   18
      See, e.g., p. 217 in Saez (2001).

                                                  14
using equation (11) to disentangle the own- and cross-wage effects in the resulting
integral, leads to formula (21).19
    The next step of our analysis of tax incidence consists of characterizing the solution
to (21).
                                                   ´
Proposition 1. Assume that the condition Θ2 |K1 (θ, θ0 )|2 dθdθ0 < 1 holds, where
K1 (θ, θ0 ) = Ẽl,w (θ) γ̄ (θ, θ0 ).20 The unique solution to the integral equation (21) is
given by
                                                  ˆ
                                h0 (y (θ))                                           h0 (y (θ0 ))
  dˆl (θ, h) = −Ẽl,1−τ (θ)                   −         R (θ, θ0 ) Ẽl,1−τ (θ0 )                     dθ0 , (22)
                              1 − T 0 (y (θ))       Θ                              1 − T 0 (y (θ0 ))

where for all θ, θ0 ∈ Θ, the resolvent R (θ, θ0 ) is given by the Neumann series of
iterated kernels {Kn (θ, θ0 )}n≥1 ,

                  ∞
                  X                                             ˆ
            0                   0                         0
    R (θ, θ ) =         Kn (θ, θ ) , with Kn+1 (θ, θ ) =              Kn (θ, θ00 ) K1 (θ00 , θ0 ) dθ00 .   (23)
                  n=1                                             Θ


Proof. See Appendix B.3.2.

    We now show that the abstract mathematical representation (22) of the general
solution to the integral equation (21) has a clear economic interpretation. The first
                                                       h0
term in the right hand side of (22), −Ẽl,1−τ 1−T         0 , is the direct (partial equilibrium)

effect of the reform on labor supply l (θ), weighted by the own-wage general equilib-
rium effects, as already described for equation (21). The second term, that depends
on the series (23), accounts for the infinite sequence of cross-wage effects in general
equilibrium.
    Specifically, consider the first iterated kernel (n = 1) in the series (23), which
writes                  ˆ
                                                        h0 (y (θ0 ))
                            K1 (θ, θ0 ) Ẽl,1−τ (θ0 )         0 (y (θ 0 ))
                                                                           dθ0 .              (24)
                          Θ                           1 −   T
This integral expresses the fact that for any θ0 , the percentage change in the labor
supply of θ0 due to the tax reform (including the own-wage effects), d ln l (θ0 ) =
   19
       This last step ensures that the kernel of the integral equation features only the cross-wage effects
γ̄ (θ, θ0 ), and is thus smooth. The labor supply elasticities ε̃l,1−τ (θ) and ε̃l,w (θ) are then weighted
by the own-wage effects γ̄¯ (θ, θ) ε̃l,w (θ), to yield Ẽl,1−τ (θ) and Ẽl,w (θ) defined in (11).
    20
       We discuss this technical condition in the Appendix, and it can be verified numerically. It
ensures that the infinite series (23) converges. When it is not satisfied, we can more generally
express the solution to (21) with the same representation (22) but with a more complex resolvent
(see Section 2.4 in Zemyan (2012)).

                                                    15
                0    0
               h (y(θ ))
Ẽl,1−τ (θ0 ) 1−T                                                                            0      0
                  0 (y(θ 0 )) , induces a change in the wage of type θ equal to γ̄ (θ, θ ) d ln l (θ ),

and hence a labor supply change Ẽl,w (θ) γ̄ (θ, θ0 ) d ln l (θ0 ) = K1 (θ, θ0 ) d ln l (θ0 ). The
integral (24) thus accounts for the effects of each type θ0 on the labor supply of θ
through direct cross-wage effects.
     The second iterated kernel (n = 2) in (23) accounts for the effects of each type
θ on the labor supply of θ, indirectly through the behavior of third parties θ00 . This
 0

term writes
                ˆ ˆ
                                                                         h0 (y (θ0 ))
                                                           
                               K1 (θ, θ ) K1 (θ , θ ) dθ Ẽl,1−τ (θ0 )
                                       00      00 0     00
                                                                             0       0
                                                                                       dθ0 .      (25)
                  Θ         Θ                                          1 − T (y (θ ))

For any θ0 , the percentage change in the labor supply of θ0 due to the tax reform,
                                 h0 (y(θ0 ))
d ln l (θ0 ) = Ẽl,1−τ (θ0 ) 1−T     0 (y(θ 0 )) , induces a change in the wage of any other type θ
                                                                                                               00

given by γ̄ (θ00 , θ0 ) d ln l (θ0 ), and hence a change in the labor supply of θ00 given by
d ln l (θ00 ) = Ẽl,w (θ00 ) γ̄ (θ00 , θ0 ) d ln l (θ0 ) = K1 (θ00 , θ0 ) d ln l (θ0 ). This in turn affects the
labor supply of type θ by the amount Ẽl,w (θ) γ̄ (θ, θ00 ) d ln l (θ00 ) = K1 (θ, θ00 ) d ln l (θ00 ).
Summing over types θ0 and θ00 leads to the expression (25).
    An inductive reasoning shows similarly that the terms n ≥ 3 account for the effects
of each θ0 on the labor supply of θ through n successive stages of cross-wage effects,
e.g., for n = 3, θ0 → θ00 → θ000 → θ.


2.2      Effects of tax reforms on wages and welfare
Once the labor supply response dˆl (θ, h) is characterized (Lemma 1 and Proposition
1), we can easily derive the incidence of a tax reform h on individual wages and
utilities, and on government revenue and social welfare. Corollaries 1 and 2 express
the effects of h as a function of this labor supply response. The corresponding Gateaux
derivatives dŵ (θ, h), dU (θ, h), dR (T, h), dW (T, h) are defined similarly to dˆl (θ, h)
in (20).

Corollary 1. The first-order effects of a perturbation h of the baseline tax schedule
T on wages are given by

                                        ε̃l,1−τ (θ) h0 (y (θ))        dˆl (θ, h)
                         dŵ (θ, h) =                               +            .                         (26)
                                          ε̃l,w (θ) 1 − T 0 (y (θ))   ε̃l,w (θ)




                                                      16
The effects on individual utilities are given by

             dU (θ, h) = [−h (y (θ)) + (1 − T 0 (y (θ))) y (θ) dŵ (θ, h)] u0 (θ) .          (27)

Proof. See Appendix B.3.3.

    Multiplying both sides of equation (26) by ε̃l,w (θ) simply gives the adjustment
of type-θ labor supply, dˆl (θ, h), as the sum of the partial equilibrium response,
          h0
−ε̃l,1−τ 1−T 0 , and the general equilibrium effect induced by the wage change, ε̃l,w dŵ (θ, h).

In equation (27), the first term on the right hand side, −u0 (θ)h(y(θ)), is due to the
fact that the tax increase h (y (θ)) makes the individual poorer and hence reduces her
utility. The second term accounts for the change in consumption, and hence welfare,
due to the wage adjustment dŵ (θ, h).21
Corollary 2. The first-order effect of a perturbation h of the baseline tax schedule T
on tax revenue is given by
               ˆ                  ˆ         h                    i
   dR (T, h) = h (y) fy (y) dy + T 0 (y) dˆl (y, h) + dŵ (y, h) yfy (y) dy.      (28)
                   R                     R

The effect on social welfare, measured in terms of public funds, is given by
                           ˆ
 dW (T, h) =dR (T, h) + [−h (y) + (1 − T 0 (y)) ydŵ (y, h)] gy (y) fy (y) dy.               (29)
                                R

Proof. See Appendix B.3.3.

    The first term in the right hand side of (28) is the mechanical (or statutory) effect
of the tax reform h (·), i.e., the change in government revenue if individual behavior
remained constant. The second term is the behavioral effect of the reform. The
labor supply and wage adjustments dˆl (y, h) and dŵ (y, h) both induce a change in
government revenue proportional to the marginal tax rate T 0 (y). Summing these
effects over all individuals using the density of incomes fy (y) yields (28). Finally,
equation (29) expresses the effect of the tax reform on social welfare as the change in
tax revenue dR (T, h), plus the sum of changes in individual utilities (27), weighted
by the Pareto weights f˜y (y) and normalized by the shadow value of public funds λ,
leading to the marginal social welfare weights gy (y) defined in (5).
  21
      Note that by the envelope theorem, the change in labor supply induced directly by the tax
reform and indirectly by the implied wage change has a zero first-order impact on the individual’s
utility.

                                               17
2.3      CES production function
The solution to the integral equation (22), and hence the incidence effects of tax
reforms, can be simplified by specifying functional forms for the production func-
tion. We obtain the simplest expressions when the kernel of the integral equation,
K1 (θ, θ0 ) = Ẽl,w (θ) γ̄ (θ, θ0 ), is multiplicatively separable between θ and θ0 , i.e., of the
form κ1 (θ) κ2 (θ0 ). This occurs in particular for a CES technology (Example 1), since
in this case the cross-wage effects γ̄ (θ, θ0 ) ≡ κ2 (θ0 ) depend only on θ0 .

Proposition 2. Suppose that the production function is CES. The solution to the
integral equation (21) is then given by:
                                                              ´                              0
                                                                                        h (y(θ ))0
                              h0 (y (θ))                   Θ
                                                             γ̄ (θ, θ0 ) Ẽl,1−τ (θ0 ) 1−T 0 (y(θ 0 )) dθ
                                                                                                          0
 dˆl (θ, h) = − Ẽl,1−τ (θ)                 − Ẽl,w (θ)            ´                                        .
                            1 − T 0 (y (θ))                  1 − Θ Ẽl,w (θ0 ) γ̄ (θ0 , θ0 ) dθ0
                                                                                                           (30)
                                                                           ´
Proof. See Appendix B.3.4. Note that equation (30) requires Θ Ẽl,w (θ0 ) γ̄ (θ0 , θ0 ) dθ0 6=
1, which is generically satisfied. In fact, suppose for simplicity that the baseline tax
schedule T is linear and the disutility of labor is isoelastic, so that Ẽl,w (θ0 ) = 1+ε/σ                 ε
                                                                                                              .
We then have       ˆ
                                                         ε         1          ε
                      Ẽl,w (θ0 ) γ̄ (θ0 , θ0 ) dθ0 =           × =               ,
                    Θ                                 1 + ε/σ σ            σ+ε
which is always strictly below 1 (unless the production function is Leontieff, i.e.,
σ = 0).

    Equation (30) shows that in the CES case, the integral term in (21), or the cumu-
lative sum in (22), which accounts for all of the general equilibrium effects on type-θ
labor supply, reduces to the first iterated kernel (24), i.e., the direct impact of type-θ0
labor supply on l (θ), appropriately discounted by the denominator in (30). To see
this, note that we can express the integral in (21) by multiplying each side of this
equation by κ2 (θ) and integrating:
          ˆ                               ˆ
                                                                h0 (y (θ))
               κ2 (θ) dˆl (θ, h) dθ = −       κ2 (θ) Ẽl,1−τ (θ)             dθ
                                                             1 − T 0 (y (θ))
           Θ
                                         ˆ
                                          Θ
                                                              ˆ                          
                                       +    κ1 (θ) κ2 (θ) dθ              0  ˆ   0       0
                                                                    κ2 (θ ) dl (θ , h) dθ .
                                              Θ                         Θ

                ´
Solving for         Θ
                        κ2 (θ) dˆl (θ, h) dθ and substituting in equation (21) yields expression
(30).

                                                     18
    One benefit of the tax incidence analysis of Proposition 2 over the more restrictive
optimal taxation approach (see Section 3) is that it gives us in simple closed form the
general equilibrium welfare effects of any local tax reform, around any, potentially
suboptimal, baseline tax system. A particularly interesting baseline tax system is
the CRP (“constant rate of progressivity”) tax schedule (see, e.g., Bénabou (2002);
Heathcote, Storesletten, and Violante (2014); Antras, de Gortari, and Itskhoki (2016))
defined as:
                                             1 − τ 1−p
                                T (y) = y −        y ,                              (31)
                                             1−p
for p < 1. Formally, the parameter p is the elasticity of the net-of-tax rate 1 − T 0 (y)
with respect to income y. The tax schedule is linear (resp., progressive, regressive),
i.e., the marginal tax rates T 0 (y) and the average tax rates T (y) /y are constant
(resp., increasing, decreasing), if p = 0 (resp., p > 0, p < 0). In addition to being
particularly tractable,22 the CRP tax schedule approximates very closely the U.S tax
and transfer system, thus allowing us to obtain sharp and policy-relevant insights.23
      The following corollary provides a theoretical formula that characterizes the effects
of any nonlinear tax reform of the U.S tax code in general equilibrium. We focus
without loss of generality on the most natural class of nonlinear tax reforms, which
consists of perturbing the marginal tax rate at only one income level y ∗ ∈ R+ .24
Formally, the perturbation is represented by the Dirac delta function h0 (y) = δy∗ (y),
so that the total tax liability increases by a uniform lump-sum amount above income
y ∗ , i.e., h (y) is the step function I{y≥y∗ } .25

Corollary 3. Suppose that the production function is CES with elasticity of substi-
tution σ, that the disutility of labor is isoelastic, and that the baseline tax schedule is

   22
       In particular, what allows to simplify (30) to derive (32) is that, assuming that the disutility of
labor is isoelastic with parameter ε, the elasticities ε̃l,1−τ (y) and ε̃l,w (y) (as well as Ẽl,1−τ (y)) are
then constant, respectively equal to 1+pεε
                                             and (1−p)ε
                                                   1+pε .
    23
       Note in particular that all of the formulas derived in this section, including equation (32),
are closed-form expressions in which all of the variables (taxes, elasticities, density of incomes) are
empirically observable, since they are evaluated given the current tax system.
    24
       This class of tax reforms has been introduced by Saez (2001). Any other perturbation can be
expressed as an appropriately weighted sum of such elementary perturbations. For instance, the
effect of a linear tax reform, which consists of an equal change in the marginal tax rate of every
individual, is equal to the sum of the effects of identical such perturbations at each income level.
See Golosov, Tsyvinski, and Werquin (2014) for details.
    25
       Note that the function I{y≥y∗ } is not differentiable. We can nevertheless use our theory to
analyze this reform by applying (30) to a sequence of perturbations {h0n }n≥1 that converges to δy∗ ,
which we formally do in the Appendix.

                                                     19
CRP. The effect on social welfare of the perturbation h (y) = I{y≥y∗ } is then given by:
                           ˆ   ∞
    dW (T, h)                              fy (y)            y ∗ fy (y ∗ )              T 0 (y ∗ )
                  =1 −             gy (y)             dy −                 ε̃ l,1−τ
    1 − Fy (y ∗ )          y∗           1 − Fy (y ∗ )       1 − Fy (y ∗ )           1 − T 0 (y ∗ )
                                                      ˆ                                                    (32)
                           y ∗ fy (y ∗ ) −1               η (y) − η (y ∗ )          yfy (y)
                        −                σ   Ẽ l,1−τ                        ´                       dy,
                          1 − Fy (y ∗ )                            0
                                                       R+ 1 − T (y )
                                                                        ∗
                                                                                R+
                                                                                   y 0 f (y 0 ) dy 0
                                                                                        y


where we denote η (y) ≡ T 0 (y) (1 + ε̃l,w ) + (1 − T 0 (y)) gy (y).
   In particular, if the baseline tax schedule is linear, the effect of any nonlinear
perturbation on government revenue is the same as in partial equilibrium.

Proof. See Appendix B.3.5.

    The first line of formula (32) is the partial equilibrium effect of the perturbation on
social welfare (see Saez (2001)) that one would compute if one assumed that the wage
distribution is exogenous. The mechanical effect of the tax increase is normalized
to 1. The second term on the right hand side is the welfare effect, equal to the
sum of the marginal social welfare weights gy (y) of individuals with income y ≥ y ∗ ,
whose consumption is reduced because their tax liability is higher. The third term
is the behavioral effect, which reduces government revenue due to the individual
labor supply adjustments, by dT (y ∗ ) = T 0 (y ∗ ) dy ∗ ∝ T 0 (y ∗ ) ε̃l,1−τ . This term is
multiplied by the hazard rate of the income distribution, which measures the fraction
of individuals whose labor supply is distorted, fy (y ∗ ), relative to those who pay the
higher absolute tax, 1 − Fy (y ∗ ).
    The second line of (32) describes the additional effects of the tax reform generated
by the endogeneity of wages. First consider only the tax revenue change, i.e., set
gy (y) = 0 for all y. We can show that this novel term is equal to26
                                                    ˆ
                0   ∗   −1                                 T 0 (y)                 yfy (y)
           − (y (θ ))        Ẽl,1−τ (1 + ε̃l,w )               0  ∗
                                                                     γ (y, y ∗ )               dy.
                                                    R+   1 − T (y )              1 − Fy (y ∗ )

This expression is intuitive. A change in the net-of tax rate at y ∗ induces a labor
supply change at y ∗ equal to the (constant) elasticity Ẽl,1−τ (y ∗ ). This in turn alters

   26
     We obtain (32) from this expression by separating the cross- and own-wage effects using (11)
and the facts that γ̄¯ (y ∗ , y ∗ ) = σ −1 and γ̄ (y, y ∗ ) does not depend on y. In the Appendix we derive
yet another way of writing this equation:        using
                                                     (31), we easily obtain that the integral in (32) (with
                                             Ec/c∗
                                       
gy (y) = 0) is equal to (1 + ε̃l,w ) 1 − Ey/y     ∗  , where c (y) ≡ y − T (y) denotes individual disposable
income.

                                                         20
the wage of individuals with income y by γ (y, y ∗ ) Ẽl,1−τ (y ∗ ).27 This finally induces a
change in income y given by (1 + ε̃l,w (y)) γ (y, y ∗ ) Ẽl,1−τ (y ∗ ), of which a share T 0 (y)
goes to the government. Thus, under the assumptions of Corollary 3, the general
equilibrium effects boil down to only one round of feedback effects (the first iterated
kernel in (23)). Moreover, this expression shows that if the baseline tax schedule is
linear, the impact of any nonlinear tax reform on government revenue is identical to
that in partial equilibrium. This is a consequence of Euler’s homogeneous function
                        ´
theorem, which reads R+ γ (y, y ∗ ) yfy (y) dy = 0, implying that the general equilib-
rium effects cancel out in the aggregate. Finally, the social welfare effects of the
perturbation are accounted for by the marginal social welfare weights gy (y) in the
definition of η (y), multiplied by the share 1 − T 0 (y) of the wage change that accrues
to individual consumption.
    To understand the direction in which these novel forces drive the effects of tax
reforms when the baseline tax schedule is nonlinear, consider the key term in the
second line of equation (32), still focusing on government revenue:
                                      ˆ
                                          T 0 (y) − T 0 (y ∗ )
                                  −                            yfy (y) dy.
                                      R      1 − T 0 (y ∗ )

Given that T 0 (y) = 1 − (1 − τ ) y −p , this term is strictly increasing in y ∗ , first negative
(for y < y ∗ ) then positive (for y > y ∗ ) for a progressive baseline tax schedule (p > 0).
This implies that the tax revenue gains of raising the marginal tax rate at a given
income level y ∗ are lower than in partial equilibrium for low y ∗ , and higher for high y ∗ .
In other words, starting from the U.S. tax code (represented by the CRP tax schedule
(31)), general equilibrium forces raise the benefits of increasing the progressivity of
the tax schedule. We illustrate this “trickle-up” effect on government revenue (or
Rawlsian welfare) in Figure 2 in Section 4.
    At first sight this result may seem to be at odds with the familiar insight of Stiglitz
(1982) in the two-income model, which we generalize to a continuum of incomes in
Section 3. Indeed, these results say that the optimal tax rates should be lower at
the top, and higher at the bottom, of the income distribution, relative to the partial
equilibrium benchmark. That is, the optimal tax schedule should be more regressive
when the general equilibrium forces are taken into account. We explain in greater
detail this difference in Section 4, but we can already understand its reason. This

  27
       The term y 0 (θ∗ ) comes from changing variables from types to incomes in the integrals.

                                                     21
is because we consider here reforms of the current (suboptimal) U.S. tax code, with
low marginal tax rates at the bottom. Instead, the results about the optimum tax
schedule use as a benchmark the optimal partial equilibrium tax schedule, which
features high marginal tax rates at the bottom (see Diamond (1998), Saez (2001)).
Thus, starting from a regressive tax code (at the bottom at least) leads to the opposite
signs for T 0 (y) − T 0 (y ∗ ) in (32), implying gains from raising tax rates at the bottom
and lowering them at the top. Intuitively, raising the marginal tax rates at the top
increases (resp., decreases) wages for high (resp., low) incomes. Since a fraction T 0 (y)
of this income change accrues to the government, and a fraction (1 − T 0 (y)) accrues
to the individuals, it follows that tax revenue (and Rawlsian welfare) increases by a
larger amount when the tax rates are low at the bottom and high at the top. The
key take-away from this section is thus that insights about the optimum tax schedule
may actually be reversed when considering reforms of the current U.S. tax code.


2.4    Translog production function
Suppose now that the production function is Translog, as defined in Example 2, with
the specific functional form (19). We use the fact that simple closed-forms for the
solution dˆl (θ, h) to the integral equation (21) can be obtained when its kernel is
the sum of functions that are multiplicatively separable in θ and θ0 , i.e., of the form
K1 (θ, θ0 ) = ni=1 κi,1 (θ) κi,2 (θ0 ). In the Appendix, we show that a Taylor expansion
              P

at any order of the right hand side of (19) as θ → θ0 yields this property, and hence
a simple approximate solution for dˆl (θ, h) at an arbitrary degree of precision. Here,
we focus on the second order approximation.

Proposition 3. Suppose that the production function is Translog with β̄ (θ, θ0 ) given
by (19). A second-order Taylor approximation of the kernel of the integral equation
(21) implies that its solution can be approximated by
                                 0
                                                                            
                                h  (y (θ))                      c 2
   dˆl (θ, h) ≈ − Ẽl,1−τ (θ)                 − Ẽl,w (θ) c1 +       + c3 γ̄ θ, θ̃ ,   (33)
                              1 − T 0 (y (θ))                  χ (θ)

where the constants (cn )n≥3 and θ̃, as well as a bound on the error in the approxima-
tion, are given in the Appendix.

Proof. See Appendix B.3.6, where we derive more generally an approximation of the
solution at any order N .

                                             22
    In equation (33), the general equilibrium term is the product of the labor supply
elasticity Ẽl,w (θ) with an affine function oftwovariables: the inverse of the labor
share χ (θ), and the cross-wage elasticity γ̄ θ, θ̃ with an “average” type θ̃. In the
Cobb-Douglas case where β̄ (θ, θ0 ) = 0 for all θ, θ0 , we already
                                                               showed in (30) that the
corresponding term is given by c1 Ẽl,w (θ). The term γ̄ θ, θ̃ shows that, when the
distance between types affects their substitutability, the whole sequence of general
equilibrium effects on θ can be summarized by a single round of cross-wage effects
from one average type θ̃. This simple and a priori surprising aggregation result is
due to our Taylor approximation which implies that in this case β̄ (θ, θ0 ) is linearly
increasing in the distance (θ − θ0 )2 .


3     Optimal income taxation
In this section, we study the optimal taxation problem. The government maximizes
social welfare subject to a resource constraint and the condition that wages and labor
supply form an equilibrium:
                       ˆ
                max       u [w (θ) l (θ) − T (w (θ) l (θ)) − v (l (θ))] f˜θ (θ) dθ (34)
                 T (·)
                       ˆΘ

                s.t.      [w (θ) l (θ) − T (w (θ) l (θ))] fθ (θ) dθ ≤ F (L )       (35)
                        Θ
               and     (1) , (2) .                                                   (36)

We characterize the solution to this problem using a mechanism design approach in
Section 3.1, and a variational approach in Section 3.2.


3.1    Mechanism design approach
We first study the government problem (34)-(36) using mechanism-design arguments
to derive the optimal informationally-constrained efficient consumption and labor
supply allocations {c (θ) , l (θ)}θ∈Θ , subject to feasibility and incentive compatibility
of these allocations.




                                           23
3.1.1     Government’s problem

It is useful to change variables and optimize over {V (θ), l(θ)}θ∈Θ , where V (θ) ≡
c(θ) − v (l(θ)). The mechanism design problem then reads
                          ˆ
              max              u(V (θ))f˜θ (θ)dθ                                                     (37)
             V (·),l(·)
                          ˆΘ

              s.t.           [V (θ) + v(l(θ))] fθ (θ)dθ ≤ F (L )                                     (38)
                           Θ
                                                                  0
                                                                   
                                      0           0         0 w(θ )
              and         V (θ) ≥ V (θ ) + v (l(θ )) − v l(θ )        , ∀ (θ, θ0 ) ∈ Θ2 .            (39)
                                                               w(θ)

The incentive compatibility constraint (39) of type θ can be expressed as a standard
                                               0 (θ)
envelope condition V 0 (θ) = v 0 (l(θ)) l(θ) ww(θ)   , along with the monotonicity constraints
w (θ) > 0 and y (θ) ≥ 0. An issue with this envelope condition is that w0 (θ) is not
  0               0       28

only a function of the control variable l(θ), but also of its derivative l0 (θ).29 We thus
define b(θ) = l0 (θ) and maximize (37) subject to (38), the envelope condition

                              ω1 [θ, l(θ)fθ (θ), L ] + [l(θ)fθ0 (θ) + b(θ)fθ (θ)] ω2 [θ, l(θ)fθ (θ), L ]
 V 0 (θ) = v 0 (l(θ)) l(θ)                                                                               ,
                                                                 w(θ)
                                                                                                     (40)
and
                                                l0 (θ) = b(θ).                                       (41)

This is now a well-defined optimal control problem with two state variables, V (θ) and
l(θ), and one control variable, b(θ) (see Seierstad and Sydsaeter (1986)).

3.1.2     Optimal tax schedule

We now characterize the solution to the government problem (37), (38), (40), (41).

Proposition 4. For any θ ∈ Θ, the optimal marginal tax rate τ (θ) of type θ satisfies
                                             ´
                                                [µ(x)v 0 (l(x))l(x)]0 γ (x, θ) dx
                          
    τ (θ)            1          µ(θ)          Θ
            = 1+                           −                                      , (42)
  1 − τ (θ)      εl,1−τ (θ) λw(θ)fw (w(θ))        λ(1 − τ (θ))y(θ)fθ (θ)


   28
       As is standard in the literature, we assume that these monotonicity conditions are satisfied and
verify them ex-post in our numerical simulations.
    29
       From (3), we have w0 (θ) = ω1 (θ, L(θ), L ) + ω2 (θ, L(θ), L )L0 (θ), where L0 (θ) = l0 (θ) fθ (θ) +
l (θ) fθ0 (θ).

                                                     24
                ´ θ̄
where µ(θ) = λ θ (1 − gθ (x)) fθ (x)dx is the Lagrange multiplier on the envelope con-
dition (40) of type θ.

Proof. See Appendix B.4.1.

    The first term on the right hand side of (42) is the formula for optimal taxes we
would obtain in partial equilibrium (see Diamond (1998)). The second term captures
the effect of a variation in type-θ labor supply on each incentive constraint.
    To gain intuition, consider first a model with two types, as in Stiglitz (1982). In
this case, a decrease in the tax on the high type increases her labor supply, which in
turn decreases her wage rate; conversely a higher tax on the low type raises her wage.
This compression of the pre-tax wage distribution in general equilibrium is beneficial
as it relaxes the downward incentive constraint (39) of the high type. Therefore,
optimal taxes are more regressive in general equilibrium: the optimal marginal tax
rate on the high type is negative (rather than zero) and it is higher for the low type
than in partial equilibrium.
    Now suppose that there is a discrete set of types, Θ = {θi }i=1,..,N . An increase in
the wage w(θi ) reduces the gap between w(θi+1 ) and w(θi ), and therefore relaxes the
downward incentive constraint (39) of type θi+1 . Denoting by µ(θi+1 ) the Lagrange
multiplier on this constraint, this perturbation has a welfare impact equal to
                                              
                               0        w(θi )   l(θi )
                      µ(θi+1 )v l(θi )                   dw(θi ) > 0.                   (43)
                                       w(θi+1 ) w(θi+1 )

On the other hand, the perturbation increases the gap between w(θi ) and w(θi−1 ), and
therefore tightens the downward incentive constraint of type θi , which has a welfare
impact equal to
                                            
                           0        w(θi−1 )            w(θi−1 )
                 − µ(θi )v l(θi−1 )            l(θi−1 )          dw(θi ) < 0.           (44)
                                     w(θi )             w(θi )2

Whether the perturbation increases or decreases welfare depends on whether (43)
or (44) is larger in magnitude. First, this depends on the relative size of the La-
grange multipliers, µ(θi+1 ) − µ(θi ), that is, on which incentive constraint binds more
strongly. In the continuous-type limit Θ = θ, θ̄ , this yields the term µ0 (x) in (42).
                                                  

Second, it depends onthe relative change
                                             in the values ofdeviating, captured
                                                                                      by the
                     0         w(θi−1 )         w(θi−1 )    0       w(θi )   l(θi )
difference between v l(θi−1 ) w(θi ) l(θi−1 ) w(θi )2 and v l(θi ) w(θi+1 ) w(θi+1 ) . In the
continuous-type limit, this yields the term [v 0 (l(x))l(x)]0 in (42).

                                             25
    The optimal tax formula (42) is similar to those derived by Rothschild and Scheuer
(2013, 2014) and Ales, Kurnaz, and Sleet (2015). Rothschild and Scheuer (2013)
provide a condition in a two-sector model under which general equilibrium forces lead
to a more regressive tax schedule. As we show in Section 3.3, we can also derive
results about the shape of marginal tax rates if the production function is CES. In
the next section, we characterize the solution to the government problem using a
variational approach, i.e., by optimizing directly over tax schedules. This allows us
to shed a new light on the economic forces underlying the design of optimal taxes.


3.2     Variational approach
In this section we propose an alternative characterization of the optimal tax schedule,
using the variational techniques introduced in Section 2. Consider as in Saez (2001)
a tax reform h1 (y) that consists of an increase in the marginal tax rate at income
level y ∗ . This raises the tax bill of incomes y ≥ y ∗ by a uniform lump-sum amount.
Formally, this perturbation is the step function h1 (y) = I{y≥y∗ } , so that h01 (y) =
δy∗ (y) is the Dirac delta function at y ∗ . Denote by θ∗ the type that earns y (θ∗ ) = y ∗
in the baseline equilibrium.
     Now, consider a counteracting perturbation h2 (y) such that the general equilib-
rium effects of h1 + h2 on labor supply (given by (22)) are the same as the partial
equilibrium effects of h1 . This implies in particular that the labor supply of all types
θ 6= θ∗ stays constant.30 An optimality condition is then obtained by imposing that
the tax reform h1 + h2 has no first-order effect on social welfare.31
     The key step consists in using our key integral equation (21) to derive the coun-
teracting perturbation h2 that cancels out the general equilibrium effects on labor
supply. We do so formally in Appendix B.4.2. Here we provide a sketch of the
derivation. In order to leave the labor supply of individual θ 6= θ∗ unchanged, i.e.,
dˆl (θ, h1 + h2 ) = 0, we must ensure that the net-of-tax-wage (1 − T 0 (y (θ))) w (θ) re-

   30                                                                            ε̃
                                                                                 l,1−τ(y ∗ )
      The labor supply response to this perturbation is given by d ln l (θ) = − 1−T  0 (y ∗ ) I{θ=θ ∗ } .
   31
      Note that our tax reform approach in Section 2 immediately delivers a characterization of the
optimum tax schedule, by equating the welfare effects of any tax reform h to zero in (29). The
reason we analyze instead a combination of two perturbations in this section is that, setting to zero
the sum of the effects of h1 and h2 leads to a substantially simpler formula for the optimum than
we would obtain from the simple analysis of h1 , as all of the general equilibrium effects on labor
supply that we analyzed in Section 2.1 are by construction equal to zero. This also implies that
the numerical computation of the optimum is much simpler, as we do not have to solve the integral
equation (21) for each h1 -reform at each iteration.

                                                   26
mains unchanged, i.e., that the tax change exactly compensates the wage change:

                                 d ln (1 − T 0 (y (θ))) = −d ln w (θ) .                                      (45)

To find the reform h2 that satisfies (45), we first compute the right hand side. The
combination of perturbations h1 + h2 induces a change in ln w (θ) given by
                  ˆ
                                                                     −1                  ε̃l,1−τ (θ∗ )
   d ln w (θ) =        γ (θ, θ0 ) d ln l (θ0 ) dθ0 = − (y 0 (θ∗ ))        γ (θ, θ∗ )                     ,   (46)
                   Θ                                                                   1 − T 0 (y (θ∗ ))

where the second equality follows from the fact that, by construction, the labor supply
of all agents θ0 6= θ∗ remains unchanged.32 If the baseline tax schedule T were linear,
the exogenous perturbation h2 would impact the net-of-tax rate at y (θ) simply by
                                             h0 (y(θ))                               ε̃l,1−τ (θ∗ )
−h02 (y (θ)), so that (45) would require 1−T2 0 (y(θ)) = − (y 0 (θ∗ ))−1 γ (θ, θ∗ ) 1−T   0 (y(θ ∗ )) .

Instead, for a nonlinear tax schedule, the change in income l (θ) dw (θ) induced by
the perturbation h2 also triggers an indirect endogenous marginal tax rate adjustment.
The relation between d ln (1 − T 0 ) and h02 is thus given by

                                                 h02 (y (θ)) + T 00 (y (θ)) l (θ) dw (θ)
                d ln (1 − T 0 (y (θ))) = −                                               .                   (47)
                                                             1 − T 0 (y (θ))

Equations (45), (46), and (47) then imply that the counteracting perturbation is given
by:33
                      ε̃l,1−τ (y ∗ ) 0 ∗ −1
         h02 (y) = −                (y (θ )) (1 − T 0 (y) − yT 00 (y)) γ (y, y ∗ ) . (48)
                     1 − T 0 (y ∗ )
We can now derive the welfare effect of h1 + h2 and equate it to zero to characterize
the optimal tax schedule.




                         −1
   32
      The term (y 0 (θ∗ )) results from a change of variables, from incomes to types, in the integral.
   33
      This counteracting tax perturbation is able to undo all of the general equilibrium effects on
labor supply thanks to Assumption 1, i.e., agents who earn the same income y have the same wage
and identical wage elasticities γ̄ (y, y ∗ ). In a multidimensional screening model with heterogeneity
conditional on income, as in Rothschild and Scheuer (2014), the perturbation h2 would not be a
flexible enough tool to cancel out everyone’s labor supply response to h1 .

                                                     27
Proposition 5. The optimal tax schedule satisfies34

    T 0 (y ∗ )                                    1 − Fy (y ∗ )
                                                                
                       1                   ∗
                =               (1 − ḡy (y ))
  1 − T 0 (y ∗ ) ε̃l,1−τ (y ∗ )                    y ∗ fy (y ∗ )
                      ˆ                                                         0                 (49)
                                                                 1 − T 0 (y)         γ (y, y ∗ )
                                                           
                                             1 − Fy (y)
                  −         (1 − ḡy (y))                                        y               dy,
                       R+                     y ∗ fy (y ∗ )      1 − T 0 (y ∗ )       y 0 (θ∗ )
                  ´∞               0
                                  fy (y )
where ḡy (y) ≡    y
                       gy (y 0 ) 1−F  y (y)
                                            dy 0 is the average marginal social welfare weight above
income y.

Proof. See Appendix B.4.2 and B.4.3. In Appendix B.4.4, we prove that formula (49)
is equivalent to the expression (42) derived in the mechanism design problem.

    The first line of (49) is the partial equilibrium formula for optimal tax rates (Saez
(2001)): the marginal tax rate at income y ∗ is proportional to the inverse elasticity
                                                                                         ∗
of labor supply ε̃l,1−τ (y ∗ ) and to the hazard rate of the income distribution 1−F
                                                                                  ∗
                                                                                     y (y )
                                                                                         ∗
                                                                                 y fy (y )
                                                                                            ,
                                                                       ∗ 35
and is decreasing in the average marginal social welfare weight ḡ(y ).
    We now provide a heuristic proof of the second line of (49). Recall that the
perturbation h1 + h2 has two distinct effects on individuals θ 6= θ∗ : first, their wage
changes by (46); second, the labor supply effects of this wage change are neutralized
by raising their marginal tax rate by (48).

Effects of the wage change. The change (say, the decrease) in θ’s wage by dw (θ)
induces a change in income y (θ) by l (θ) dw (θ), which in turn impacts individual
welfare and government revenue. First, individual θ loses a share 1 − T 0 (y (θ)) of
her income change w (θ) l (θ) d ln w (θ), which affects her utility and hence aggregate
welfare by
           ˆ
              gy (y (θ)) [(1 − T 0 (y (θ))) y (θ)] × d ln w (θ) fθ (θ) dθ
            Θ
                                       ˆ
              ε̃l,1−τ (y ∗ ) 0 ∗ −1
         =−                  (y (θ ))       gy (y) (1 − T 0 (y)) γ (y, y ∗ ) yfy (y) dy,
              1 − T 0 (y ∗ )             R+



  34
      We show in Appendix B.4.5 that a simple transformation of this equation allows us to rewrite it
as an integral equation in 1 − T 0 (·) that can be analyzed, both theoretically and numerically, using
the same techniques as in Section 2.
   35
      The intuition for each of these terms is the same as in formula (32). Note that the density of
incomes fy (as well as the labor supply elasticity) in formula (49) is now evaluated at the optimum
tax code.

                                                  28
by construction of the marginal social welfare weights and equation (46). The other
share T 0 (y (θ)) accrues to the government, whose revenue changes by
                                                 ˆ
                   ε̃l,1−τ (y ∗ ) 0 ∗ −1
                 −                (y (θ ))                 T 0 (y) γ (y, y ∗ ) yfy (y) dy.
                   1 − T 0 (y ∗ )                     R+




Since the production function has constant returns to scale, Euler’s homogeneous
                            ´
function theorem reads R+ γ (y, y ∗ ) yfy (y) dy = 0 for all y ∗ . We can thus replace
T 0 (y) by 1 − T 0 (y) in the integrand of the previous equation. Summing the welfare
and revenue effects, we obtain that social welfare changes by
                                    ˆ
         ε̃l,1−τ (y ∗ ) 0 ∗ −1
                        (y (θ ))           (1 − gy (y)) (1 − T 0 (y)) γ (y, y ∗ ) yfy (y) dy.   (50)
         1 − T 0 (y ∗ )              R+


Effects of the counteracting marginal tax rate change. The compensating
marginal tax rate decrease at income y (θ), h02 (y (θ)), which ensures that the labor
supply of individual θ does not change, uniformly decreases the tax bill of individuals
with income above y (θ). This lowers government revenue by

      h02 (y (θ)) (1 − F (y (θ)))
         ε̃l,1−τ (y ∗ ) 0 ∗ −1                                                                  (51)
    =−                  (y (θ )) (1 − T 0 (y) − yT 00 (y)) γ (y, y ∗ ) (1 − F (y (θ))) .
         1 − T 0 (y ∗ )

This revenue gain is valued (1 − ḡ (y (θ))) h02 (y (θ)) (1 − F (y (θ))) by the planner,
where ḡ (y) is the average marginal social welfare weight on individuals with income
above y. Summing over incomes y (θ) gives the change in social welfare from the
counteracting perturbation.
   Collecting (50) and (51) implies that the general equilibrium forces impact social
welfare by
                                ˆ
      ε̃l,1−τ (y ∗ ) 0 ∗ −1
                                     
                     (y (θ ))            (1 − gy (y)) (1 − T 0 (y)) yfy (y)
      1 − T 0 (y ∗ )            R+
                                                                                       
                     − (1 − ḡy (y)) (1 − T (y) − yT (y)) (1 − F (y)) γ (y, y ∗ ) dy.
                                                  0               00




Note finally that the term in brackets is the derivative of the function (1 − ḡy (y)) ×
(1 − T 0 (y)) y × (1 − F (y)), leading to formula (49).

                                                      29
    We end this section by discussing the relationship between our paper and Scheuer
and Werning (2015, 2016). They analyze a general equilibrium extension of Mirrlees
(1971) and prove a neutrality result: in their model, the optimal tax formula is the
same as in partial equilibrium, even though they consider a more general production
function than Mirrlees (1971).36 The key modeling difference between our framework
and theirs is the following. In theirs, all the agents produce the same input with
different productivities θ. Denoting by λ (θ) = θl (θ) the agent’s production of that
input (i.e., her efficiency units of labor), the aggregate production function then
maps the distribution of λ into output. In equilibrium, a nonlinear price (earnings)
schedule p (·) emerges such that an agent who produces λ units earns income p (λ),
irrespective of her underlying productivity θ. Hence, when an (atomistic) individual
θ provides more effort l (θ), her income moves along the non-linear schedule l 7→
p (θ × l); e.g., in their superstars model with a convex equilibrium earnings schedule,
her income increases faster than linearly. By contrast, in our framework, different
values of θ index different inputs in the aggregate production function; for each of
these inputs, there is one specific price (wage) w (θ), and hence a linear earnings
schedule l 7→ w (θ) × l. Therefore, when an individual θ provides more effort l (θ), her
income increases linearly, as her wage remains constant (since her sector θ doesn’t
change). In their framework, Scheuer and Werning (2015, 2016) show that the general
equilibrium effects exactly cancel out at the optimum tax schedule, even though they
would of course be non-zero in the characterization of the incidence effects of tax
reforms around a suboptimal tax code. In our framework, as in those of Stiglitz
(1982); Rothschild and Scheuer (2014); Ales et al. (2015), these general equilibrium
forces are also present at the optimum.


3.3     CES production function
3.3.1    Optimal marginal tax rates

We show in the Appendix that formula (49) dramatically simplifies in the case of a
CES production function. Using definition (11) to disentangle the own-wage effects
γ̄¯ (y ∗ , y ∗ ) and the cross-wage effects γ̄ (y, y ∗ ) in the integrand, we prove the following
corollary:

  36
     The policy implications can nevertheless be different. For instance, in Scheuer and Werning
(2015), the relevant earnings elasticity in the formula written in terms of the observed income
distribution is higher due to the superstar effects.

                                               30
Corollary 4. Assume that the production function is CES with elasticity of substi-
tution σ > 0. Then the optimal marginal tax rate at income y ∗ is given by

            T 0 (y ∗ )                                     1 − Fy (y ∗ )            gy (y ∗ ) − 1
                                                                           
                           1
                 0     ∗
                         =          (1 − ḡy (y ∗ ))                            +                 .   (52)
          1 − T (y ) Ẽl,1−τ (y ∗ )                         y ∗ fy (y ∗ )                σ

Proof. See Appendix B.4.5.

    Equation (52) highlights the two main differences between the partial equilibrium
and the general equilibrium optimal taxes. The first novel effect is driven by the
own-wage effects γ̄¯ (y ∗ , y ∗ ), and is captured by the inverse of the elasticity Ẽl,1−τ (y ∗ ),
replacing ε̃l,1−τ (y ∗ ) in the partial equilibrium formula. This general equilibrium cor-
rection satisfies Ẽl,1−τ (y ∗ ) < ε̃l,1−τ (y ∗ ) and hence tends to raise optimal marginal tax
rates. This is because increasing the marginal tax rate at y ∗ leads individuals θ∗ to
lower their own labor supply, which raises their wage and thus dampens the initial
behavioral response.
    The second novel effect, which works in the opposite direction, is driven by the
                                                                          ∗)
cross-wage effects γ̄ (y, y ∗ ), and is captured by the term 1−g(y     σ
                                                                             in (52). The lower
                            ∗
labor supply at type θ lowers the wage, and hence the labor supply, of all the other
types θ 6= θ∗ . Suppose that the government values the welfare of individuals θ∗
less than average, i.e., g (y ∗ ) < 1.37 This negative externality on θ induced by the
behavior of θ∗ implies that the cost of raising the marginal tax rate at y ∗ is higher
than in partial equilibrium, which tends to lower the optimal tax rate. Conversely,
the government gains by raising the optimal tax rates of individuals y ∗ whose welfare
is valued more than average, i.e., g (y ∗ ) > 1. This induces these agents to work less
and earn a higher wage, which makes them strictly better off, at the expense of the
other individuals in the economy, whose wage decreases.
    Formula (52) generalizes the partial equilibrium optimal tax formula of Diamond
(1998) and Saez (2001) to a CES production function, and the general equilibrium
analysis of Stiglitz (1982) to the workhorse framework of taxation, with a continuum of
types and arbitrary nonlinear taxes. It allows us to go beyond the purely qualitative
insights obtained in the two-type framework and make operational the theory of
optimal tax design in general equilibrium. In particular, we show in the next two
subsections how the key results obtained in partial equilibrium are affected, namely,

  37
    Since lump-sum transfers are available to the government, the average marginal social welfare
weight in the economy is equal to 1.

                                                31
the characterization of the optimal top tax rate and the U-shape of marginal tax
rates.

3.3.2    Top tax rate

In this subsection we derive the implications of equation (52) for the optimal top tax
rate.

Corollary 5. Assume that the production function is CES with elasticity of substitu-
tion σ > 0 and that the elasticity of labor supply is constant and equal to ε. Assume
moreover that in the data, incomes are Pareto distributed at the tail with coefficient α,
and that the top marginal tax rate that applies to these incomes is constant. Assume
finally that the marginal social welfare weights at the top converge to ḡ. Then the
optimal top tax rate satisfies

                                τtop     1 − ḡ 1 − ḡ 1 − ḡ
                                       =       +      −       .                                     (53)
                              1 − τtop    αε     ασ      σ
                           τtop        1−ḡ             1−ḡ
In particular, we have    1−τtop
                                   <    αε
                                            ,   where    αε
                                                               is the optimal top tax rate in the partial
equilibrium model.

Proof. See Appendix B.4.6. The non-trivial part of the proof consists in showing
that for a CES production function, if the income distribution has a Pareto tail in
the data, then it has the same Pareto tail at the optimum, even though the wage
distribution is endogenous.

    Formula (53) generalizes the familiar top tax rate result of Saez (2001) to a CES
production function. There is one new sufficient statistic, the elasticity of substitu-
tion between skills in production σ, that is no longer restricted to be infinite. This
proposition implies a strictly lower top marginal tax rate than in partial equilibrium.38
Back-of-the envelope calculations of the optimal top tax rate illustrate the power of
this formula. Suppose that ḡ = 0, α = 2, ε = 1/2, and σ = 1.5.39 We immediately
  38
      Note that perhaps surprisingly, the own-wage effects imply that the general equilibrium cor-
rection is stronger (so that the top tax rate should be reduced by a larger amount, relative to the
partial equilibrium benchmark) when inequality at the top is lower, i.e. when α is higher, and when
the average welfare weight ḡ at the top is lower. Moreover, since the solution for τtop is concavely
increasing in the right hand side of (53), this formula implies that the optimal top tax rate is more
sensitive to the labor supply elasticity ε than in partial equilibrium.
   39
      These values are meant to be only illustrative, but they are in the ballpark of those estimated
in the empirical literature. See our calibration in Section 4 below.

                                                    32
obtain that the optimal tax rate on top incomes is equal to τtop,P E = 50% in partial
equilibrium, and falls to τtop = 40% once general equilibrium forces are taken into
account. Figure 1 shows more comprehensive comparative statics.40

           Figure 1: Top tax rate: σ = 1.4 (left panel) and ε = 0.33 (right panel)
   0.8                                                                                    0.8
                          PE Top Tax Rate with alpha=1.5
  0.75                    GE Top Tax Rate with alpha=1.5                                 0.75
                          PE Top Tax Rate with alpha=2
   0.7                    GE Top Tax Rate with alpha=2                                    0.7
  0.65                                                                                   0.65




                                                                          Top Tax Rate
   0.6                                                                                    0.6
  0.55                                                                                   0.55
   0.5                                                                                    0.5               PE Top Tax Rate with alpha=1.5
                                                                                                            GE Top Tax Rate with alpha=1.5
  0.45                                                                                   0.45               PE Top Tax Rate with alpha=2
                                                                                                            GE Top Tax Rate with alpha=2
   0.4                                                                                    0.4
  0.35                                                                                   0.35
   0.3                                                                                    0.3
     0.2       0.3          0.4           0.5              0.6                              0.5   1   1.5      2        2.5       3          3.5
             Structural Labor Supply Elasticity                                                             Sigma




3.3.3      U-shape of optimal marginal tax rates

We finally analyze the impact of general equilibrium on the familiar U-shape of opti-
mal tax rates derived by Diamond (1998) in the partial equilibrium framework.
Corollary 6. Assume that the production function is CES with elasticity of substi-
tution σ > 0 and that the social planner is Rawlsian, i.e. gy (y(θ)) = 0 for all θ > θ.
If the partial equilibrium optimal tax formula41

                                                                1 − Fy (y(θ))
                                                                 1
                                                    Ẽl,1−τ (θ) y(θ)fy (y(θ))

implies a U-shaped pattern of marginal tax rates, then the additional term −1/σ leads
to a general equilibrium correction for T 0 (·) that is also U-shaped.
Proof. In this case the cross wage term (gy (y ∗ ) − 1) /σ in (52) is constant and negative
for all θ > θ. Given that the marginal tax rate is concavely increasing in the right
hand side of ((52)), the result immediately follows.

   Corollary 6 follows straightforwardly from equation (52) and is a simple but eco-
nomically important result as it implies that the general equilibrium forces tend to
  40
      See also Green and Phillips (2015) who study quantitatively the size of the optimal top tax rate
in a two-sector model.
   41
      Note that this “partial equilibrium” formula is computed given the wage distribution at the
optimum general equilibrium tax schedule.

                                                                     33
reinforce the U-shape of the optimal marginal tax rates. This implies in particular
a more pronounced dip, so that the marginal tax rate on intermediate incomes falls
by more than that on top incomes. Therefore, while the two-type model of Stiglitz
(1982) suggests that optimal tax rates should be more regressive (i.e., higher at the
bottom and lower at the top) than in partial equilibrium, we see here that this insight
must be qualified once we extend it to an environment with a continuum of incomes:
taxes should be more regressive for incomes below the bottom of the U, but more
progressive in the region where optimal marginal tax rates were already increasing.
We illustrate this result quantitatively in Section 4.3.


4        Numerical simulations
In this section we provide a quantitative analysis of our results. We parametrize our
model in Section 4.1. We then analyze the incidence of tax reforms around the U.S.
tax code in Section 4.2, and compute the optimal tax schedule in Section 4.3. We
reconcile these two sets of results in Section 4.4 and show how our results extend to
a Translog production function in Section 4.5.


4.1      Calibration
We assume that preferences are quasilinear with isoelastic disutility of labor, U (c, l) =
        1
c−l1+ ε / 1 + 1ε , with ε = 0.33 in our benchmark calibration (Chetty, Guren, Manoli,
                 

and Weber, 2011). To match the U.S. yearly earnings distribution, we assume that
fy (·) is log-normal with mean 10 and variance 0.95 up to income y = $150, 000, above
which we append a Pareto distribution with coefficient α = 1.5 (Diamond and Saez,
2011) (see Appendix C.1 for details). We take a CRP tax schedule defined in (31)
with p = 0.151 and τ = −3 (Heathcote, Storesletten, and Violante, 2014). We can
then calibrate the resulting wage distribution from the agents’ first-order conditions
(1) (Saez, 2001). Assuming a CES production function as a benchmark with values for
the elasticity of substitution σ ∈ {0.6, 1.4, 3.1}, taken respectively from Dustmann,
Frattini, and Preston (2013), Katz and Murphy (1992) and Borjas (2003), and Card
and Lemieux (2001),42 we finally obtain the values of a(θ) in (13) using the values of

    42
    Dustmann, Frattini, and Preston (2013) is the most relevant study for our analysis, as they
do not classify workers according to their education level (as opposed to Katz and Murphy (1992),
Card and Lemieux (2001), Borjas (2003)) but according to their position in the wage distribution,

                                               34
l(θ) and w(θ) at each income level.


4.2           Tax incidence
We first study the incidence of tax reforms on government revenue, based on the
theoretical analysis of Section 2. The reforms that we consider are those that increase
the marginal tax rate at a single income level y ∗ (Saez, 2001). We thus plot the values
of dR(y ∗ )/(1 − Fy (y ∗ )), as defined in (28), as a function of the income y ∗ where tax
rates are perturbed.43 Figure 2 illustrates the result for σ = 0.6 and σ = 3.1 (blacked
dashed curves), and for the partial equilibrium case σ = ∞ (red bold curves). In
line with the result of Corollary 3, we observe that raising the marginal tax rates
for intermediate and high incomes (starting from about $100,000) is more desirable,
in terms of government revenue, when the general equilibrium effects are taken into
account, while the opposite holds for low income levels. Hence the partial equilibrium
model significantly underestimates the revenue benefits (i.e., Rawlsian welfare with
θ = 0) of increasing the progressivity of the tax code.44


Figure 2: Tax incidence: σ = 0.6 (Dustmann, Frattini, and Preston (2013), left
panel) and σ = 3.1 (Card and Lemieux (2001), right panel)
      1                                                                1
                                      δRpe /(1 − Fy (y ∗ ))                                           δRpe /(1 − Fy (y ∗ ))
  0.95                                δRge /(1 − Fy (y ∗ ))          0.95                             δRge /(1 − Fy (y ∗ ))


   0.9                                                                0.9

  0.85                                                               0.85

   0.8                                                                0.8

  0.75                                                               0.75

   0.7                                                                0.7

  0.65                                                               0.65

   0.6                                                                0.6
          0     100   200       300       400             500               0   100   200       300       400             500
                       y∗ in $1,000                                                    y∗ in $1,000




i.e., by type θ.
    43
       A value of 0.7, say, at a given income level y ∗ , means that for each additional dollar of tax
revenue mechanically levied by the statutory increase in the marginal tax rate at y ∗ , the government
effectively gains only 70 cents, while 30 cents are lost through the behavioral responses of indviduals
to the tax reform. That is, the marginal excess burden of this tax reform is 30%.
    44
       In Appendix C.3 we extend this analysis to the welfare effects for a utilitirian planner.

                                                                35
4.3     Optimal taxation
Throughout this section we consider a Rawlsian social objective, which consists of
maximizing the utility of agents with zero income, i.e., the lump-sum component of
the tax schedule. In Appendix C.3 we consider the case of a utilitarian planner; the
results are very similar.

4.3.1    Partial equilibrium benchmark

We start by constructing a policy-relevant partial equilibrium benchmark to analyze
how the normative prescriptions for optimal taxes are affected by the general equi-
librium effects. We define the marginal tax rates that a partial equilibrium planner
would set from Diamond (1998), using the same data to calibrate the model, and
making the same assumptions about the utility function, but wrongly assuming that
the wage distribution is exogenous:

                                               1 1 − Fwd (wd (θ))
                                               
                            τP E (θ)
                                       =    1+                      ,                          (54)
                          1 − τP E (θ)         ε fwd (wd (θ))wd (θ)

where Fwd (wd (θ)) is the wage distribution in the data, i.e., obtained from the observed
income distribution and the first-order conditions (1).45

4.3.2    Simulation results

The role of the elasticity of substitution. The right panel of Figure 3 plots
the optimal marginal tax rates as a function of types46 for three different values of
the elasticity of substitution, and for the partial equilibrium planner defined in (54).
The latter schedule has a familiar U-shape (Diamond, 1998; Saez, 2001). In line with
our theoretical results of Section 3.3, the top tax rate is lower in general equilibrium
and decreasing with σ. Moreover, the optimal marginal tax rates are reduced by an
even larger amount at income levels close to the bottom of the U (around $100,000),

  45
      An alternative would consist of defining a self-confirming policy equilibrium as suggested by
Rothschild and Scheuer (2013, 2016), where the resulting wage distribution would be consistent with
the planner’s beliefs.
   46
      The scale on the horizontal axis on the left panel is measured in income; e.g., the value of
the optimal marginal tax rate at the notch $100,000 is that of a type θ who earns an income
y (θ) = $100, 000 in the calibration to the U.S data. The income that this type earns in the optimal
allocation is generally different (see the right panel). In Appendix C.2, we plot the optimal tax
schedules as a function of income at the optimum.

                                                36
and are higher at low income levels (below $40,000).47 This implies that the U-shape
obtained in partial equilibrium is reinforced by the general equilibrium considerations.

                                       Figure 3: Optimal marginal tax rates as a function of σ and ε
                       1                                                                                           1
                                                     Partial Equilibrium Planner                                                                              ε = .2   GE
                      0.9                            Elasticity of Substitution 3.1                               0.9                                         ε = .2   PE
                                                     Elasticity of Substitution 1.4                                                                           ε = .6   GE
                                                     Elasticity of Substitution .6
                      0.8                                                                                         0.8                                         ε = .6   PE
 Marginal Tax Rates




                                                                                             Marginal Tax Rates
                      0.7                                                                                         0.7

                      0.6                                                                                         0.6

                      0.5                                                                                         0.5

                      0.4                                                                                         0.4

                      0.3                                                                                         0.3

                      0.2                                                                                         0.2
                            0        100      200       300          400          500                                   0        100      200      300       400         500
                                Type Expressed by Current Income in $1,000                                                  Type Expressed by Current Income in $1,000




The role of the elasticity of labor supply. The right panel of Figure 3 plots the
optimal marginal tax rates for two different values of the elasticity of labor supply
ε with σ = 1.4, and compares them with the partial equilibrium optimum (54). In
line with our theoretical results of Section 3.3, we observe that (i) the magnitude of
the correction due to general equilibrium forces is increasing in the structural labor
supply elasticity; and (ii) optimal marginal tax rates in general equilibrium are more
sensitive to the value of the elasticity.

Welfare gains. The left panel of Figure 4 plots the welfare gains of moving from
the optimal partial equilibrium taxes to the optimal general equilibrium taxes, as a
function of the elasticity of substitution σ. These gains are expressed in consumption
equivalent, which (given our welfare criterion) corresponds to a uniform increase in
the lump sum transfer. Naturally these gains are decreasing in σ and converge to
zero as σ → ∞. For low values of σ, they can be as high as 3.5 percent, and they
remain nontrivial for the whole range of plausible values of the elasticity.48




                 47
      Since the partial equilibrium tax rates are already very high at those low income levels, the
general equilibrium corrections are quantitatively very small (at most 1.8 percentage points).
   48
      For our specifications of the Translog production function, these gains are in the same ballpark,
see Appendix C.5.

                                                                                        37
Figure 4: Welfare gains (left panel) and Tax incidence for PE optimum (right panel)
                                             4                                                                              0.8
  Welfare Gain in Consumption Equivalents



                                                              Rawlsian Welfare Gain in Consumption Equivalents                                               dRpe /(1 − Fy (y ∗ ))
                                                              Dustmann et al. (2013)                                                                         dRge /(1 − Fy (y ∗ ))
                                            3.5               Katz and Murphy (1992)
                                                              Upper Bound in Lemieux and Card (2002)
                                                                                                                            0.6
                                             3
                                                                                                                            0.4
                                            2.5

                                             2                                                                              0.2

                                            1.5
                                                                                                                              0
                                             1
                                                                                                                            -0.2
                                            0.5

                                             0                                                                              -0.4
                                                  0.5     1          1.5         2        2.5         3          3.5               0   100   200       300       400             500
                                                                  Elasticity of Substitution                                                  y∗ in $1,000




    Proposition 6 and Figure 10 in Appendix B.4.7 propose a theoretical and quantita-
tive “general equilibrium wedge accounting” decomposition of the difference between
the partial equilibrium benchmark (54) and the general equilibrium optimum (52). It
highlights the roles of the three key general equilibrium corrections coming from the
own-wage effects, the cross-wage effects, and the endogeneity of the hazard rates of
the wage distribution.


4.4                                                     Reconciling the tax incidence and optimal taxation results
As we already discussed in Section 2.3, the results of Sections 4.2 and 4.3 may seem
contradictory at first sight. On the one hand, Corollary 3 and Figure 2 show that the
general equilibrium forces make it desirable, for a Rawlsian planner, to increase the
marginal tax rates on high incomes, relative to the partial equilibrium benchmark,
if we start from the current U.S. tax system. On the other hand, Corollary 5 and
Figure 3 implies that the optimal tax rates on high incomes are strictly lower, for
high incomes, than in the partial equilibrium optimum (54).
    To reconcile these two sets of results, we compute in the right panel of Figure 4
the incidence of the tax reforms h (·) = δy∗ (·), starting from the optimal partial
equilibrium tax schedule (54).49 This graph shows that when the low-income marginal
tax rates are high (as in the partial equilibrium optimum) rather than low (as in the
U.S. tax code), the general equilibrium forces call for lower tax rates for intermediate
and high incomes, and higher marginal tax rates for low incomes. Importantly, this
                              49
     In this figure, we set σ = 1.4 and ε = 0.33. The red bold line plots the effects of the tax reform
on government revenue in partial equilibrium (see (54)). These effects are uniformly equal to zero
by construction.

                                                                                                                       38
graph helps understanding the more pronounced U-shaped in the optimum through
the lens of the tax incidence analysis. Starting from the partial equilibrium optimum,
the gains from perturbing the marginal tax rates are U-shaped and negative, except
at the very bottom of the income distribution.


4.5                             Translog Production Function
We now consider the case of a Translog production function, where the elasticities
of substitution are distance-dependent (see Section 1.4). Our primary goal is to
compare the policy implications of this production function50 to those obtained with
a CES technology. We start by plotting in Figure 5 the values of the wage elasticities
γ̄(y, y ∗ ) for y ∗ = $250, 000. The dashed-dotted black line is the benchmark Cobb-
Douglas case, for which β̄(θ, θ∗ ) = 0 for all θ: it shows that a change in the labor
supply of θ∗ has the same impact, in percentage terms, on the wage of every agent
θ 6= θ∗ . The bold red and dashed blue curves show the wage elasticities γ̄(y, y ∗ )
for two different Translog specifications (19). We chose the function α(θ) such that
for all y ∗ , γ̄(y ∗ , y ∗ ) is equal to 50% (resp., -10%) of its value in the Cobb Douglas
case in Case 1 (resp., Case 2). For both cases we choose the parameter s such that
γ̄¯ (y ∗ , y ∗ ) = −1 for y ∗ = $250, 000, which implies that the cross-wage effects from a
labor supply change of an individual who earns $250,000 are the same on average as
in the Cobb-Douglas case.51


Figure 5: γ̄(θ, θ∗ ) with y(θ∗ ) = $250, 000 (left panel) and tax incidence (right panel)
                            ×10-4
                                                                                                             1
                                                          Cobb Douglas                                                                       Parital Equilibrium
                       16                                 Translog Case 1                                                                    Cobb Douglas
                                                                                                           0.95
                                                          Translog Case 2                                                                    Translog Case 1
                       14                                                                                                                    Translog Case 2
                                                                                                            0.9
                       12                                                                                  0.85
                                                                                       δR/(1 − Fy (y∗ ))
  γ̄(y∗ , $250, 000)




                       10                                                                                   0.8

                        8                                                                                  0.75

                        6                                                                                   0.7

                        4                                                                                  0.65

                                                                                                            0.6
                        2
                                                                                                           0.55
                        0
                                                                                                            0.5
                            0       100   200       300     400             500                                   0   100   200        300        400              500
                                           y∗ in $1,000                                                                           y∗




           50
     Here we show two such examples, and two more in Appendix C.5.
     In Appendix C.5, we consider cases where s is chosen such that γ̄¯ (y ∗ , y ∗ ) = −1 for y ∗ = $80, 000
           51

as an alternative specification. In all cases, we set the parameter c to 0.5. Varying this parameter
only slightly influences the results.

                                                                                  39
    In the right panel of Figure 5 we evaluate the incidence of the tax reforms δy∗ (·)
starting from a CRP tax schedule, as we did in Figure 2 for a CES technology. This
graph not only confirms, but actually reinforces, the results obtained in Proposition 3
and Figure 2 regarding the benefits on government revenue of increasing the progres-
sivity of the tax schedule. The ideal comparison here is the value at y ∗ = $250, 000
(represented by a vertical line), for which the average wage effects are the same as
in the Cobb Douglas case,52 which allows us to isolate the effects of the distance-
dependence. We see that the revenue gains from raising the marginal tax rate at
this income level are higher when the production function is Translog. Moreover, the
stronger the distance-dependence of the cross-wage effects (i.e., going from the bold
red to the dashed blue curves), the higher the revenue gains from raising the progres-
sivity, relative to the partial equilibrium benchmark. For incomes y ∗ > $250, 000, the
difference between the Translog and CES cases is even larger. In Appendix C.5, we
confirm these insights for different specifications of the Translog production function.
We moreover plot the optimal tax rates and show that the U-shape pattern is again
more pronounced than in partial equilibrium, confirming our results of Section 4.3.


5        Conclusion
In this paper we jointly study the incidence and the optimal design of nonlinear income
taxes in general equilibrium with a continuum of endogenous wages. Our method-
ological contribution is to characterize this problem using the variational approach
and the theory of integral equations. The analysis of tax incidence delivers novel
economic insights about the optimum, and reveals that the implications of general
equilibrium can be reversed when considering reforms of suboptimal tax codes. The
revenue gains from increasing the progressivity of the U.S. tax schedule are larger,
and the U-shape of optimal marginal tax rates is more pronounced, than in partial
equilibrium.




    52
     That is, the own-wage
                  ´            effect is γ̄¯ (θ∗ , θ∗ ) = −1, and hence, by Euler’s theorem, the average
                             ∗
cross-wage effects Θ γ̄ (θ, θ ) y (θ) fθ (θ) dθ is the same as in the CES case.

                                                  40
References
Ales, L., M. Kurnaz, and C. Sleet (2015): “Technical change, wage inequality,
 and taxes,” The American Economic Review, 105, 3061–3101.

Ales, L. and C. Sleet (2016): “Taxing Top CEO Incomes,” American Economic
 Review (forthcoming).

Allen, F. (1982): “Optimal linear income taxation with general equilibrium effects
 on wages,” Journal of Public Economics, 17, 135–143.

Antras, P., A. de Gortari, and O. Itskhoki (2016): “Globalization, Inequality
 and Welfare,” Working Paper.

Bénabou, R. (2002): “Tax and Education Policy in a Heterogenous-Agent Economy:
 What of Levels of Redistribution Maximize Growth and Efficiency?” Econometrica,
 70, 481–517.

Borjas, G. J. (2003): “The Labor Demand Curve Is Downward Sloping: Reexam-
 ining the Impact of Immigration on the Labor Market,” The Quarterly Journal of
 Economics, 118, 1335–1374.

Bucci, A. and P. Ushchev (2014): “The Sources of Sharing Externalities: Spe-
 cialization versus Competition,” Working Paper.

Card, D. and T. Lemieux (2001): “Can Falling Supply Explain the Rising Return
 to College for Younger Men? A Cohort-Based Analysis,” Quarterly Journal of
 Economics, 116, 705–746.

Chen, L. and C. Rothschild (2015): “Screening with endogenous preferences,”
 Working Paper.

Chetty, R., A. Guren, D. Manoli, and A. Weber (2011): “Are micro and
 macro labor supply elasticities consistent? A review of evidence on the intensive
 and extensive margins,” The American Economic Review, 101, 471–475.

Christensen, L. R., D. W. Jorgenson, and L. J. Lau (1973): “Transcendental
 logarithmic production frontiers,” The Review of Economics and Statistics, 28–45.



                                       41
Diamond, P. A. (1998): “Optimal Income Taxation: An Example with a U-Shaped
  Pattern of Optimal Marginal Tax Rates,” American Economic Review, 88, 83–95.

Diamond, P. A. and E. Saez (2011): “The Case for a Progressive Tax: From
  Basic Research to Policy Recommendations,” Journal of Economic Perspectives,
  25, 165–90.

Dustmann, C., T. Frattini, and I. P. Preston (2013): “The effect of immi-
 gration along the distribution of wages,” The Review of Economic Studies, 80,
 145–173.

Feldstein, M. (1973): “On the optimal progressivity of the income tax,” Journal of
  Public Economics, 2, 357–376.

Fradera, I. (1986): “Perfect competition with product differentiation,” Interna-
 tional Economic Review, 529–538.

Fullerton, D. and G. E. Metcalf (2002): “Tax incidence,” Handbook of public
 economics, 4, 1787–1872.

Golosov, M., A. Tsyvinski, and N. Werquin (2014): “A Variational Approach
 to the Analysis of Tax Systems,” Working Paper.

Green, R. K. and M. D. Phillips (2015): “Demand for’The 1%’: Tax Incidence
 and Implications for Optimal Income Tax Rates,” Working Paper.

Guner, N., R. Kaygusuz, and G. Ventura (2014): “Income taxation of US
 households: Facts and parametric estimates,” Review of Economic Dynamics, 17,
 559–581.

Harberger, A. C. (1962): “The incidence of the corporation income tax,” The
 Journal of Political Economy, 215–240.

Hart, O. D. (1979): “Monopolistic competition in a large economy with differenti-
 ated commodities,” The Review of Economic Studies, 46, 1–30.

Heathcote, J., K. Storesletten, and G. L. Violante (2014): “Optimal tax
 progressivity: An analytical framework,” NBER Working Paper No. 19899.

Heathcote, J. and H. Tsujiyama (2016): “Optimal Income Taxation: Mirrlees
 Meets Ramsey,” Working Paper.

                                       42
Hendren, N. (2015): “The Policy Elasticity,” in Tax Policy and the Economy, Vol-
 ume 30, University of Chicago Press.

Hines, J. R. (2009): “Peter Mieszkowski and the General Equilibrium Revolution in
  Public Finance,” in Proceedings. Annual Conference on Taxation and Minutes of
  the Annual Meeting of the National Tax Association, JSTOR, vol. 102, 213–216.

Itskhoki, O. (2008): “Optimal redistribution in an open economy,” Working Paper.

Jacquet, L. and E. Lehmann (2016): “Optimal Taxation with Heterogeneous
  Skills and Elasticities: Structural and Sufficient Statistics Approaches,” THEMA
  Working Paper 2016-04.

Katz, L. F. and K. M. Murphy (1992): “Changes in Relative Wages, 1963-1987:
 Supply and Demand Factors,” The Quarterly Journal of Economics, 107, 35–78.

Kleven, H., C. Kreiner, and E. Saez (2009): “The Optimal Income Taxation of
 Couples,” Econometrica, 77, 537–560.

Kotlikoff, L. J. and L. H. Summers (1987): “Tax incidence,” Handbook of public
 economics, 2, 1043–1092.

Kress, R. (2014): Linear integral equations (Third Edition), Springer.

Mirrlees, J. A. (1971): “An Exploration in the Theory of Optimum Income Taxa-
 tion,” The Review of Economic Studies, 38, 175–208.

Parenti, M., J.-F. Thisse, and P. Ushchev (2014): “Toward a theory of monop-
  olistic competition,” CEPR Discussion Paper No. DP10014.

Piketty, T. (1997): “La redistribution fiscale face au chomage,” Revue française
  d’économie, 12, 157–201.

Piketty, T. and E. Saez (2013): “A Theory of Optimal Inheritance Taxation,”
  Econometrica, 81, 1851–1886.

Piketty, T., E. Saez, and S. Stantcheva (2014): “Optimal taxation of top
  labor incomes: A tale of three elasticities,” American Economic Journal: Economic
  Policy, 6, 230–271.



                                        43
Polyanin, A. D. and A. V. Manzhirov (2008): Handbook of integral equations,
 CRC press.

Press, W. H. (2007): Numerical recipes 3rd edition: The art of scientific computing,
 Cambridge university press.

Rothschild, C. and F. Scheuer (2013): “Redistributive Taxation in the Roy
 Model,” The Quarterly Journal of Economics, 128, 623–668.

——— (2014): “A theory of income taxation under multidimensional skill heterogene-
 ity,” NBER Working Paper No. 19822.

——— (2016): “Optimal Taxation with Rent-Seeking,” Review of Economic Studies
 (forthcoming).

Rothstein, J. (2010): “Is the EITC as good as an NIT? Conditional cash transfers
 and tax incidence,” American Economic Journal: Economic Policy, 2, 177–208.

Saez, E. (2001): “Using Elasticities to Derive Optimal Income Tax Rates,” Review
  of Economic Studies, 68, 205–229.

Saez, E. and S. Stantcheva (2016): “Generalized Social Marginal Welfare Weights
  for Optimal Tax Theory,” American Economic Review, 106, 24–45.

Salanie, B. (2011): The economics of taxation, MIT press.

Scheuer, F. (2014): “Entrepreneurial Taxation with Endogenous Entry,” American
  Economic Journal: Economic Policy, 6, 126–163.

Scheuer, F. and I. Werning (2015): “The taxation of superstars,” Tech. rep.,
  National Bureau of Economic Research.

——— (2016): “Mirrlees meets Diamond-Mirrlees,” NBER Working Paper No. 22076.

Seierstad, A. and K. Sydsaeter (1986): Optimal control theory with economic
  applications, Elsevier North-Holland, Inc.

Shoven, J. B. and J. Whalley (1984): “Applied general-equilibrium models of
  taxation and international trade: an introduction and survey,” Journal of Economic
  Literature, 22, 1007–1051.


                                        44
Stiglitz, J. E. (1982): “Self-selection and Pareto efficient taxation,” Journal of
  Public Economics, 17, 213–240.

Teulings, C. N. (1995): “The wage distribution in a model of the assignment of
 skills to jobs,” Journal of Political Economy, 280–315.

Tricomi, F. (1985): “Integral equations, Interscience, London, 1957, New edition,” .

Zemyan, S. M. (2012): The classical theory of integral equations: a concise treat-
  ment, Springer Science & Business Media.




                                        45
Appendix

A      A primer on tax incidence
In this section we summarize some of the classical results on tax incidence in a framework with one
good, two factors of production (typically labor and capital, see e.g. (Kotlikoff and Summers, 1987;
Salanie, 2011)), and linear taxation of these two factors. We consider instead the case where the
two factors are high-skilled and low-skilled labor, as our primary goal is to study a model with a
continuum of labor inputs. The proofs of this section are gathered in Section B.1.


A.1      Equilibrium
Individuals have preferences over consumption c and labor supply l given by U (c, l) = u (c − v (l)),
where the functions u and v are twice continuously differentiable and strictly increasing, u is concave,
and v is strictly convex. In particular, note that there are no income effects on labor supply. There
are two skill levels θ1 < θ2 , with respective masses F1 and F2 = 1 − F1 .
    An individual of type θi earns a wage w(θi ), which she takes as given. She chooses her labor
supply l(θi ) and earns taxable income y(θi ) = w(θi )l(θi ). The government levies linear income taxes
τi on income of type i ∈ {1, 2}. Individual θi therefore solves the following problem:

                             l (θi ) = arg max u [(1 − τi ) w (θi ) l − v (l)] .
                                            l∈R+


The optimal labor supply l (θi ) chosen by an individual θi is thus the solution to the first-order
condition:
                                                  v 0 (l (θi ))
                                        w (θi ) =               .                              (55)
                                                   (1 − τi )
We denote by U (θi ) the indirect utility function attained by individual θi . Finally, the total amount
of labor supplied by individuals of type θi is denoted by L (θi ) ≡ l (θi ) Fi . Equation (55) defines a
decreasing “supply curve” in the plane (w, l).
     There is a continuum of identical firms that produce output using both types of labor θ1 , θ2 .
The resulting aggregate production function F is defined as:

                                          Y = F (L (θ1 ) , L (θ2 )) .

We assume that the production function has constant returns to scale. The representative firm
chooses the (relative) demand of inputs (labor of each type), taking as given the wages w (θi ), to
maximize its profit                  "                            #
                                                    X2
                               max F (L1 , L2 ) −       w (θi ) Li .
                                 L1 ,L2
                                                           i=1

As a result, in equilibrium the firm earns no profits and the wage w (θ) is equal to the marginal



                                                     46
productivity of the type-θ labor, i.e.,

                                              w (θi ) = Fi0 (L (θ1 ) , L (θ2 )) ,                             (56)

for all i ∈ {1, 2}, where Fi0 denotes the partial derivative of the production function with respect to
its ith variable.
     The equilibrium wages and quantities are derived by equating (56), which are infinitely elastic
demand curves and (55) which are increasing supply curves.


A.2       Elasticity concepts
We first define the structural labor supply elasticity εi = εl,1−τ (θi ) as the change in the labor supply
of individuals of type θi when the tax rate on their income, τi , is increased.53 We let, for i ∈ {1, 2},

                                           ∂ ln l (θi )                     v 0 (l (θi ))
                                   εi =                             =                          .              (57)
                                          ∂ ln (1 − τi )    w(θ)        l (θi ) v 00 (l (θi ))

Note that this is a elasticity in partial equilibrium, since the change in labor supply is computed for
a constant individual wage.
    Next, we define the wage elasticity γij = γ (θi , θj ) as the effect of a marginal increase in the
labor supply of type θj , L (θj ), on the wage of type θi , w (θi ), keeping the labor supply of type k 6= j,
                                               2
L (θk ), constant. That is, for (i, j) ∈ {1, 2} ,

                                       ∂ ln w (θi )   L (θj ) Fi,j
                                                                00
                                                                   (L (θ1 ) , L (θ2 ))
                               γij =                =                                  .
                                       ∂ ln L (θj )       Fi (L (θ1 ) , L (θ2 ))
                                                              0




A.3       Tax incidence
To analyze the tax incidence problem in the simple two-type model laid out in this section, we start
by deriving the general effects of arbitrary infinitesimal perturbations (“tax reforms”) (dτ1 , dτ2 ) of
the baseline tax system (τ1 , τ2 ). Denote by dˆli = dllii and dŵi = dw
                                                                       wi the implied percentage changes
                                                                         i


in labor supplies and wages induced by the tax reform. We show in the Appendix that we can
express the labor supply effects as
                               !          "                 !                          !#−1               !
                        dˆl1                     1
                                                 ε1    0                γ11     γ12                 dτ1
                                                                                                   1−τ1
                                   =−                           −                                             (58)
                        dˆl2                     0     1
                                                       ε2               γ21     γ22                 dτ2
                                                                                                   1−τ2


and the wage effects as                           !                         !              !
                                          dŵ1              γ11      γ12            dˆl1
                                                      =                                        .              (59)
                                          dŵ2              γ21      γ22            dˆl2



   53
    Note that with the utility function U that we consider, the Marshallian (uncompensated) and
Hicksian (compensated) elasticities are identical.

                                                                47
The impact on individual welfare is given by
                                                                       
                                                            dτi
                                  dUi = (1 − τi ) yi Ui0 −        + dŵi .                                  (60)
                                                           1 − τi

Finally the impact on government revenue is given by

                               2
                               X                      2
                                                      X                          2
                                                                                 X
                        dR =         (Fi yi ) dτi +         (Fi τi yi ) dˆli +         (Fi τi yi ) dŵi .   (61)
                               i=1                    i=1                        i=1

                                                                                
     Equation (58) shows that the changes in labor supplies dˆl1 , dˆl2 , induced by the changes in
marginal tax rates (dτ1 , dτ2 ), are given by the sum of: (i) the partial equilibrium effects, captured
by the diagonal matrix of labor supply elasticities ε1 and ε2 in equation (58); and (ii) the general
equilibrium effects, coming from the fact that the initial labor supply changes trigger own- and
cross-changes in wages, which in turn affect labor supplies, etc. This infinite sequence of feedback
effects between equilibrium wages and labor supplies is captured by the inverse of the matrix of wage
elasticities (γij )i,j∈{1,2} in equations (58) and (59).54
     Equation (60) shows that individual utilities are affected in two ways. First, their income (and
hence utility) is directly affected by the changes in taxes dτi , holding wages and labor supply fixed.
Second, their income is indirectly affected, holding labor supply fixed. Note that the endogenous
change in labor supply has no first-order impact on utility by the envelope theorem.
     The first term in (61) is the mechanical effect of the perturbation, i.e. the change in government
revenue due to the change in tax rates, assuming that both labor supply behavior and wages remain
constant. The second term is the behavioral effect, due to the change in labor supplies which
induces a change in government revenue proportional to the marginal tax rate τi . The third term is
the general equilibrium effect, coming from the fact that perturbing the marginal tax rates impacts
individual wages and hence government revenue directly. The analysis so far thus shows that the size
and the sign of the impacts of a particular tax reform (dτ1 , dτ2 ) depends generally on the baseline tax
rates (τ1 , τ2 ), individual preferences (through the elasticities (ε1 , ε2 )), and the production technology
(through the elasticities (γ11 , γ12 , γ21 , γ22 )).
     We now focus on the particularly simple case where one of the factors, say the labor supply
of type θ2 , is in fixed supply, i.e. ε2 = 0. More precisely, we consider the limit of the previous
expression as the elasticity of labor supply of type θ2 is positive but small, so that l2 is always paid
its marginal productivity. Suppose in addition that we perturb only the tax on the elastic factor,
l (θ1 ). This amounts to reducing the model we have analyzed so far to its partial equilibrium limit,
where the effects of the tax on θ1 affect only the quantity of that factor (since θ2 is in fixed supply).
In this case, we show in the Appendix by directly inverting the matrix in (58) and letting ε2 → 0
that we obtain the following familiar result (see equation (2.6) in Kotlikoff and Summers (1987) and
                                              −1       P∞
   54
        Using the matrix equality (I − A)          = An (assuming
                                                            n=0    that the norm of the matrix is
smaller than 1), we can solve equation (58) to express dˆl1 , dˆl2 as an infinite sum, the economic
interpretation of which is the sequence of feedback effects on labor supply coming from the general
equilibrium wage effects. This expression parallels (22) in Section 2 for the case of a continuum of
labor inputs and general nonlinear tax reforms.

                                                            48
Section 1.1.1 in Salanie (2011)): the impact on the wage of types θ1 and θ2 is given by

                                            ε1     dτ1                              w1
                                dŵ1 =         −1 1 − τ         and dŵ2 = −           dŵ1 .             (62)
                                         ε1 − γ11      1                            w2

Moreover, the impact on the labor supply of type θ1 is given by
                                                            −1
                                                        ε1 γ11    dτ1
                                              dˆl1 =          −1 1 − τ
                                                                            .                             (63)
                                                       ε1 − γ11       1


Formula (62) shows that the effect on the own wage w1 of an increase in the tax rate τ1 on factor
θ1 , depends on the elasticity of supply of factor 1, ε1 , and the elasticity of the demand of factor 1,
−1/γ11 > 0.55 This expression implies that the gross wage increases all the more that demand is less
elastic relative to supply. In other words, when labor supply of a given type is much less elastic than
                         −1
labor demand (ε1  γ11       ), the cost of labor hardly changes and workers of type θ1 bear almost the
full burden.



B       Proofs
B.1      Proofs of Section A
We start by evaluating the incidence effects of a general perturbation (dτ1 , dτ2 ) of the baseline tax
system.

Proof of equations (58) to (61). The perturbed individual first-order condition of individual θi writes

                                          (1 − τi − dτi ) w̃i = v 0 (li + dli ) ,

where the perturbed wage rate w̃i satisfies, to a first-order in (dτ1 , dτ2 ),

                   w̃i ((l1 + dl1 ) F1 , (l2 + dl2 ) F2 ) − wi (l1 F1 , l2 F2 )
                 =Fi0 ((l1 + dl1 ) F1 , (l2 + dl2 ) F2 ) − Fi0 (l1 F1 , l2 F2 )
                     2                                       2
                     X                                      X   ln Fn Fi,n
                                                                        00
                                                                             0 dln
                                                                                     X2
                 =         Fi,n
                            00
                                (l1 F1 , l2 F2 ) Fn dln =                  F       =     wi γi,n dˆln .
                     n=1                                    n=1
                                                                    F 0
                                                                      i
                                                                             i
                                                                               l n   n=1


Denoting by dŵi ≡ w̃iw−wi
                           i
                             , this is a linear system of two equations (indexed by i ∈ {1, 2}) with two
unknowns (dŵ1 , dŵ2 ), which can be rewritten as

                                      dŵi = γi,1 dˆl1 + γi,2 dˆl2 , ∀i ∈ {1, 2} ,



   55
       1/γ11 is the standard elasticity of demand when the supply of factor θ2 is fixed, as it is con-
structed as the change in the labor supply l (θ1 ) induced by a change in the wage w (θ1 ), keeping
l (θ2 ) fixed.

                                                             49
which immediately leads to the matrix form (59).
   We thus get, to a first order in (dτ1 , dτ2 ),

                      (1 − τi ) wi + (1 − τi ) (w̃i − wi ) − wi dτi = v 0 (li ) + v 00 (li ) dli ,

i.e., using the first-order condition at the baseline tax system,

                                                                                  2
                                                                                  X
             wi dτi = (1 − τi ) (w̃i − wi ) − v 00 (li ) dli = (1 − τi )                wi γi,n dˆln − li v 00 (li ) dˆli
                                                                                  n=1
                         2
                         X
                                (1 − τi ) wi γi,n − li v 00 (li ) I{n=i} dˆln .
                                                                       
                     =
                         n=1


Using the formula (57) for the labor supply elasticity, we can rewrite this equation as

                      2                                      2 
                                  li v 00 (li )                        li v 00 (li )
                                                                                          
              dτi    X
                                                        ˆ
                                                             X
                   =     γi,n −                 I{n=i} dln =     γi,n − 0            I{n=i} dˆln
             1 − τi n=1         (1 − τi ) wi                 n=1
                                                                        v    (l i )
                      2                      
                     X          1
                   =     γi,n − I{n=i} dˆln .
                     n=1
                                εi


This is a linear system of two equations (indexed by i ∈ {1, 2}) with two unknowns (dˆl1 , dˆl2 ), which
can be rewritten as                          
                                           1                         dτ1
                                   γ1,1 −       dˆl1 + γ1,2 dˆl2 =
                                           ε1                      1 − τ1
                                                        
                                       ˆ              1             dτ2
                                 γ2,1 dl1 + γ2,2 −         dˆl2 =         ,
                                                      ε2           1 − τ2
and hence, in matrix form, as
                         "                   !                    !#              !                    !
                                γ11    γ12             1
                                                       ε1    0             dˆl1                 dτ1
                                                                                               1−τ1
                                                 −                                    =                    .
                                γ21    γ22             0     1
                                                             ε2            dˆl2                 dτ2
                                                                                               1−τ2


Assuming that the matrix in square brackets on the left hand side is invertible, we immediately
obtain (58).
    The utility of individual θi changes, to a first-order in (dτ1 , dτ2 ), by

     dUi ≡U ((1 − τi − dτi ) w̃i (li + dli ) − v (li + dli )) − U ((1 − τi ) wi li − v (li ))
         = [−wi li dτi + (1 − τi ) li (w̃i − wi ) + (1 − τi ) wi dli − v 0 (li ) dli ] U 0 ((1 − τi ) wi li − v (li ))
                                                          v 0 (li )
                                                                      
                              dτi                 ˆ                  ˆ
         = (1 − τi ) wi li −          + dŵi + dli −                dli U 0 ((1 − τi ) wi li − v (li )) .
                             1 − τi                    (1 − τi ) wi

                                                                         v 0 (li )
But the individual’s first order condition (55) implies                (1−τi )wi     = 1, so that we obtain (60).




                                                              50
    Government revenue changes, to a first-order in (dτ1 , dτ2 ), by

                     2
                     X                                                                2
                                                                                      X
       dR ≡                [(τi + dτi ) w̃i (li + dli ) − τi wi li ] Fi =                   [wi li dτi + τi li (w̃i − wi ) + τi wi dli ] Fi
                     i=1                                                              i=1
                     2                                    
                     X                    dτi
                 =         τi wi li           + dŵi + dˆli Fi ,
                     i=1
                                          τi

which implies (61).



    Next we focus on the partial equilibrium case.

Proof of equations (62) and (63). With two types, we can easily invert explicitly the matrix in equa-
tion (58) to obtain
                                                                                                                       !          !
                                                                                                                            dτ1
                                                                                                 γ22 − ε12     −γ12        1−τ1
                 !                                             !−1                    !                                     dτ2
          dˆl1                 γ11 − ε11          γ12                          dτ1                 −γ21      γ11 − ε11     1−τ2
                      =                                                       1−τ1
                                                                                            =                                       .
          dˆl2                                                                 dτ2
                                                                                                                    
                                 γ21            γ22 − ε12                     1−τ2                γ11 − ε11   γ22 − ε12 − γ12 γ21

Consider a perturbation of τ2 only, i.e., dτ2 = 0. Then the previous expression implies that the
changes in labor supplies are given by
                                                               !                                             !
                                     γ22 − ε12                        dτ1                         ε2 γ22 − 1    dτ1
                                                                     1−τ1                                      1−τ1
                        !
                 dˆl1                  −γ21                                                        −ε2 γ21
                          =                                                          =                                     .
                 dˆl2
                                                                                               
                                   1                            1
                             γ11 − ε1    γ22 −                  ε2       − γ12 γ21       γ11 − ε11 (ε2 γ22 − 1) − ε2 γ12 γ21

Now take the limit as type-θ2 labor supply becomes inelastic, i.e., ε2 → 0. We get
                                                                                            
                                                                                            dˆl1 = −             1     dτ1
                                           !             dτ1
                                                                              !
                                  dˆl1                  1−τ1             −1                                   1
                                                                                                                  −γ11 1−τ1
                                                                                                                            ,
                                               →                                  , i.e.,                    ε1

                                  dˆl2             1
                                                   ε1   − γ11            0                  dˆl =
                                                                                                2       0,

which shows (63). Finally, (59) implies that

                                                                                          γ1,1   dτ1
                                                   dŵ1 = γ1,1 dˆl1 = −              1
                                                                                     ε1   − γ11 1 − τ1

                                 γ2,1
and dŵ2 = γ2,1 dˆl1 =           γ1,1 dŵ1 .    The Euler’s homogeneous equation theorem states that

                                                          w1 L1 + w2 L2 = F (L1 , L2 )

so that
                                                                                   ∂w1      ∂w2
                                               w1 γ1,1 + w2 γ2,1 = L1                  + L2     = 0,
                                                                                   ∂L1      ∂L1
and hence dŵ2 = − w
                   w2 dŵ1 .
                     1




                                                                              51
B.2           Proofs of Section 1
B.2.1          Proof of equations (6), (7), and (8)
We first derive the expressions for the labor supply elasticities.

Proof. We first derive the labor supply elasticity along the linear budget constraint (6). Rewrite
the first-order condition (1) as
                                                v 0 (l (θ)) = (1 − τ (θ)) w (θ) ,

where τ (θ) = T 0 (w (θ) l (θ)) is the marginal tax rate of agent θ. The first-order effect of perturbing
the marginal tax rate τ (θ) by dτθ on the labor supply l (θ), in partial equilibrium (i.e., keeping
w (θ) constant), is obtained by a Taylor approximation of the first-order condition characterizing
the perturbed equilibrium,

                                        v 0 (l (θ) + dlθ ) = (1 − τ (θ) − dτθ ) w (θ) ,

around the baseline equilibrium. We obtain

                                                                                              v 0 (l (θ))
             v 0 (l (θ)) + v 00 (l (θ)) dlθ = (1 − τ (θ)) w (θ) − w (θ) dτθ = v 0 (l (θ)) −               dτθ ,
                                                                                              1 − τ (θ)

and thus
                                             dlθ        v 0 (l (θ))     dτθ
                                                  =−         00
                                                                               ,
                                            l (θ)    l (θ) v (l (θ)) 1 − τ (θ)
which immediately leads equation (6).
    Next we derive the labor supply elasticity along the non-linear budget constraint (6), keeping
the wage constant. The perturbed individual first-order condition writes

                             v 0 (l (θ) + dlθ ) = [1 − T 0 (w (θ) (l (θ) + dlθ )) − dτθ ] w (θ) .

A first-order Taylor expansion implies

                                                                                                    2
        v 0 (l (θ)) + v 00 (l (θ)) dlθ = (1 − T 0 (w (θ) l (θ))) w (θ) − T 00 (w (θ) l (θ)) (w (θ)) dlθ − w (θ) dτθ ,

i.e.,
               dlθ       1                  w (θ)
                    =−                                             dτθ
              l (θ)    l (θ) v 00 (l (θ)) + T 00 (w (θ) l (θ)) wθ2
                                                              v 0 (l(θ))
                                                                 l(θ)
                    =−                                                                            dτθ
                          (1 −   T 0 (w (θ) l (θ))) v 00 (l (θ)) + v 0
                                                                 (l (θ)) w (θ) T 00 (w (θ) l (θ))
                                    εl,1−τ (θ) (1 − T 0 (w (θ) l (θ)))                     d (1 − τ (θ))
                    =                                                                                         ,
                      1 − T 0 (w (θ) l (θ)) + εl,1−τ (θ) w (θ) l (θ) T 00 (w (θ) l (θ)) 1 − T 0 (w (θ) l (θ))
which yields equation (7).


                                                                  52
    Finally, we derive the partial equilibrium labor supply elasticity with respect to the wage along
the non-linear budget constraint (8). The perturbed individual first-order condition writes

                   v 0 (l (θ) + dlθ ) = [1 − T 0 ((w (θ) + dwθ ) (l (θ) + dlθ ))] (w (θ) + dwθ ) .

A first-order Taylor expansion then implies

                                                                                                     2
        v 0 (l (θ)) + v 00 (l (θ)) dlθ = (1 − T 0 (w (θ) l (θ))) w (θ) − T 00 (w (θ) l (θ)) (w (θ)) dlθ
                                          − T 00 (w (θ) l (θ)) w (θ) l (θ) dwθ + (1 − T 0 (w (θ) l (θ))) dwθ ,

i.e.,
                 dlθ    (1 − T 0 (w (θ) l (θ)) − w (θ) l (θ) T 00 (w (θ) l (θ))) w (θ) dwθ
                      =                                 2
                l (θ)             v 00 (l (θ)) + (w (θ)) T 00 (w (θ) l (θ))           w (θ) l (θ)
                                                                                            0
                                                                                    v (l(θ))
                         (1 − T 0 (w (θ) l (θ)) − w (θ) l (θ) T 00 (w (θ) l (θ))) l(θ)v 00 (l(θ)) dwθ
                       =                                           v 0 (l(θ))
                                                                                                      ,
                                0
                         (1 − T (w (θ) l (θ))) + w (θ) l (θ)            00    T (w (θ) l (θ)) w (θ)
                                                                               00
                                                                      l(θ)v (l(θ))

which implies (8).




B.2.2     Proofs for Examples 1 and 2
We first provide algebra details for the CES technology. It is straightforward to show that the
cross-wage elasticities are given by (15). We have
                                                                                 ρ
                                                                   a (θ∗ ) L (θ∗ )
                                       γ̄ (θ, θ∗ ) = (1 − ρ) ´                   ρ ,
                                                                  Θ
                                                                    a (x) L (x) dx

which implies, for all θ ∈ Θ,               ˆ
                                                                               1
                                                   γ̄ (θ, θ∗ ) dθ∗ = 1 − ρ =     .
                                               Θ                               σ
Moreover, denoting interchangeably by γ̄ (y, y ∗ ) ≡ γ̄ (θ, θ∗ ) where y = y (θ) and y ∗ = y (θ∗ ), Euler’s
homogeneous function theorem writes
                                           ˆ
                                                   γ (θ, θ∗ ) y (θ) fθ (θ) dθ = 0,
                                             Θ

which can be rewritten as
                      ˆ
                                γ̄ (θ, θ∗ ) y (θ) fθ (θ) dθ + γ̄¯ (θ∗ , θ∗ ) y (θ∗ ) fθ (θ∗ ) = 0,
                            Θ

or equivalently,          ˆ
                                                                                     dy (θ∗ )
                                 γ̄ (y, y ∗ ) yfy (y) dy − (1 − ρ) y ∗ fy (y ∗ )              = 0.
                            R+                                                         dθ




                                                               53
Since γ̄ (y, y ∗ ) = γ̄ (θ, θ∗ ) does not depend on y (or θ), this implies
                                               ρ   ˆ
                               a (θ∗ ) L (θ∗ )                                                  dy (θ∗ )
                    (1 − ρ) ´                ρ             yfy (y) dy − (1 − ρ) y ∗ fy (y ∗ )            = 0,
                              Θ
                                a (x) L (x) dx       R+                                           dθ

i.e.,
                                                       ρ
                                          a (θ∗ ) L (θ∗ )     y ∗ fy (y ∗ ) dy (θ∗ )
                                     ´                  ρ =´                         .
                                         Θ
                                           a (x) L (x) dx    R+
                                                                 yfy (y) dy dθ

Substituting in expression (15), we hence get

                                                            y (θ∗ ) fy (y (θ∗ )) dy (θ∗ )
                                   γ̄ (y, y (θ∗ )) = (1 − ρ) ´                            .                          (64)
                                                               R+
                                                                   yfy (y) dy      dθ

        We now provide the algebra details for the Translog production function.
                                                                 ´
Proof. First, we show that if the conditions θ, θ0 ,       a (θ0 ) dθ0 = 1, β̄ (θ, θ0 ) = β̄ (θ0 , θ), and β̄¯ (θ, θ) =
   ´                                                                 Θ
− Θ β̄ (θ, θ0 ) dθ0 hold, then the production function (16) has constant returns to scale. Indeed, we
can then write
                                     ˆ                              ˆ                ˆ                   
                                                          1
                                                                          β̄¯θ,θ dθ +
                                                                    2
        ln F (λL ) = ln F (L ) +          αθ dθ ln λ + (ln λ)                                  β̄θ,θ0 dθdθ0
                                        Θ                 2             Θ                Θ×Θ
                                ˆ          ˆ                         ˆ                             
                         + ln λ     αθ dθ +     ¯
                                               β̄θ,θ ln L (θ) dθ +           β̄θ,θ0 ln L (θ) dθdθ0
                                          Θ            Θ                        Θ×Θ


which is equal to ln F (L ) + ln λ.
   Second, we derive expression (17) for the wage. We have

          ln F (L + µδθ∗ ) − ln F (L )
          ˆ                                                  ˆ
                                                           1
                                                                β̄¯θ,θ ln2 (L (θ) + µδθ∗ (θ)) − ln2 L (θ) dθ
                                                                                                          
        =    αθ [ln (L (θ) + µδθ (θ)) − ln L (θ)] dθ +
                                  ∗
                                                           2
           Θ
               ˆ                                              Θ
             1
          +          β̄θ,θ0 [ln (L (θ) + µδθ∗ (θ)) ln (L (θ ) + µδθ∗ (θ0 )) − ln (L (θ)) ln (L (θ0 ))] dθdθ0 .
                                                           0
             2 Θ×Θ

A first-order Taylor approximation of the right-hand side as µ → 0 yields

           ln F (L + µδθ∗ ) − ln F (L )
             ˆ                              ˆ
                       1                               ln L (θ)
        = µ      αθ        δθ∗ (θ) dθ + µ       β̄¯θ,θ            δθ∗ (θ) dθ
       µ→0    Θ      L (θ)                   Θ          L (θ)
                   ˆ
                                          ln (L (θ0 ))
                                                                                 
               1                                                     0 ln (L (θ))
           + µ            β̄θ,θ0 δθ∗ (θ)                  + δθ∗ (θ )                dθdθ0 + o (µ)
               2 Θ×Θ                         L (θ)                       L (θ0 )
                                                    ˆ                                 ˆ
                                   ln L (θ∗ ) 1                   ln (L (θ0 )) 0 1
                                                                                                            
                 αθ∗       ¯                                                                    ln (L (θ))
         =µ             + β̄θ∗ ,θ∗            +          β̄θ∗ ,θ0             dθ +       β̄θ,θ∗            dθ + o (µ) ,
                L (θ∗ )             L (θ∗ )       2 Θ               L (θ∗ )         2 Θ           L (θ∗ )




                                                                54
Thus the wage of type θ∗ is equal to

                                         1
                       w (θ∗ ) = lim         [F (L + µδθ∗ ) − F (L )]
                                     µ→0 µ
                                                                          ˆ
                                     F (L )
                                                                                                       
                                   =                  ¯              ∗
                                               αθ∗ + β̄θ∗ ,θ∗ ln L (θ ) +                      00    00
                                                                             β̄θ∗ ,θ00 ln (L (θ )) dθ ,
                                     L (θ∗ )                               Θ
                                                         
where the second equality follows from the symmetry of β̄θ,θ0 (θ,θ0 )∈Θ2 . Note that the same expres-
sion can be obtained heuristically by computing the derivative of F {L (θ00 )}θ00 ∈Θ with respect to
                                                                                     

L (θ∗ ):
                                       F (L ) ∂ ln F {L (θ00 )}θ00 ∈Θ
                                                                      
                                  ∗
                              w (θ ) =                                  .
                                       L (θ∗ )      ∂ ln L (θ∗ )
    Third, we derive the cross-wage elasticities and own-wage elasticities (18). For simplicity we
derive these formulas heuristically by directly evaluating the derivatives; they can be easily obtained
rigorously following the same steps as above for the wages. For the cross-wage elasticities, suppose
that θ 6= θ0 . We have
                                                              n                      ´                           o
                  ∂ ln (F (L ) /L (θ))                    ∂ ln αθ + β̄¯θ,θ ln L (θ) + Θ β̄θ,θ00 ln L (θ00 ) dθ00
    γ̄ (θ, θ0 ) =                          +
                        ∂ ln L (θ0 )                                             ∂ ln L (θ0 )
                                 ˆ                            
                                                                                                   β̄θ,θ0
   = αθ0 + β̄¯θ0 ,θ0 ln L (θ0 ) +    β̄θ0 ,θ00 ln L (θ00 ) dθ00 +                    ¯               ´
                                                 Θ                             αθ + β̄θ,θ ln L (θ) + Θ β̄θ,θ00 ln L (θ00 ) dθ00
               0          0
                                                       −1
           w (θ ) L (θ )                   w (θ) L (θ)
   =                               +                           β̄θ,θ0 .
             F (L )                         F (L )

Similarly, the own wage elasticities are given by:
                                                    n
                                                          ¯               ´             00   00
                                                                                                o
                    ∂ ln (Y (L ) /L (θ)) ∂ ln αθ + β̄θ,θ ln L (θ) + Θ β̄θ,θ00 ln L (θ ) dθ
       γ̄¯ (θ, θ) =                        +                                                      − γ̄ (θ, θ)
                          ∂ ln L (θ)                              ∂ ln L (θ)
                                                 β̄¯θ,θ
                                                                                               −1
                                                                                    w (θ) L (θ)
                  =−1+                              ´                      = −1 +                    β̄¯θ,θ .
                                   ¯                             00
                            αθ + β̄θ,θ ln L (θ) + Θ β̄θ,θ ln L (θ ) dθ
                                                         00            00            F   (L )

Finally, note that
                                                                       ´
                                             αθ + β̄¯θ,θ ln L (θ) + Θ β̄θ,θ00 ln L (θ00 ) dθ00
                                       L (θ0 )
                                              
             w (θ)
     ln             = ln           + ln                                  ´
             w (θ0 )                       αθ∗ + β̄¯θ0 ,θ0 ln L (θ0 ) + Θ β̄θ0 ,θ00 ln L (θ00 ) dθ00
                                       L (θ)
                                            n         ´               o ´
        
          L (θ0 )
                          αθ + ln L (θ) β̄¯θ,θ + Θ β̄θ,θ00 dθ00 + Θ β̄θ,θ00 {ln L (θ00 ) − ln L (θ)} dθ00
   = ln             + ln                  n            ´               o ´
          L (θ)          αθ∗ + ln L (θ0 ) β̄¯θ0 ,θ0 + Θ β̄θ0 ,θ00 dθ00 + Θ β̄θ0 ,θ00 {ln L (θ00 ) − ln L (θ0 )} dθ00
                               ´
          L (θ0 )         αθ + Θ β̄θ,θ00 ln (L (θ00 ) /L (θ)) dθ00
                 
   = ln             + ln      ´                                        ,
          L (θ)          αθ0 + Θ β̄θ0 ,θ00 ln (L (θ00 ) /L (θ0 )) dθ00




                                                                          55
so that the elasticities of substitution are given by:

       1        ∂ ln (w (θ) /w (θ0 ))
    −      0
              =
    σ (θ, θ )   ∂ ln (L (θ) /L (θ0 ))
                      β̄θ,θ0                             β̄θ0 ,θ
  =−1−        ´               00       −      ´                 00 
                              L(θ )
        αθ + Θ β̄θ,θ00 ln L(θ) dθ     00   αθ0 + Θ β̄θ0 ,θ00 ln L(θ     )
                                                                  L(θ 0 ) dθ
                                                                             00


                           β̄θ,θ0                                                 β̄θ0 ,θ
  =−1−       ¯               ´                            −         ¯                 ´
       αθ + β̄θ,θ ln L (θ) + Θ β̄θ,θ ln L (θ ) dθ
                                      00         00   00     αθ + β̄θ ,θ ln L (θ ) + Θ β̄θ0 ,θ00 ln L (θ00 ) dθ00
                                                                  0   0 0       0
       "              −1                       −1 #
          w (θ) L (θ)             w (θ0 ) L (θ0 )
  =−1−                      +                            β̄θ,θ0 .
           F (L )                   F (L )

This concludes the derivations of the wage elasticities for a general Translog production function.




B.3       Proofs of Section 2
B.3.1      Proof of Lemma 1
Proof. Denote the perturbed tax function by T̃ (y) = T (y) + µh (y) (later we let µ → 0). Denote
by dl (θ, h) the Gateaux derivative of the labor supply of type θ in response to this perturbation, and
let dL (θ, h) ≡ dl (θ, h) fθ (θ). The labor supply response dl (θ, h) of type θ is given by the solution
to the perturbed first-order condition:



          0 =v 0 (l (θ) + µdl (θ, h))
              − {1 − T 0 [w̃ (θ) × (l (θ) + µdl (θ, h))] − µh0 [w̃ (θ) × (l (θ) + µdl (θ, h))]} w̃ (θ) ,          (65)

    where w̃ (θ) is the perturbed wage schedule. Heuristically, w̃ (θ) satisfies

    w̃ (θ) − w (θ) = FL(θ)0
                                {(l (θ0 ) + µdl (θ0 , h)) fθ (θ0 )}θ0 ∈Θ − FL(θ)
                                                                              0
                                                                                   {l (θ0 ) fθ (θ0 )}θ0 ∈Θ
                                                                                                          
     ˆ                                                              ˆ L (θ0 ) F 00
                                                                                L(θ),L(θ 0 ) ˆ 0
   =     FL(θ),L(θ0 ) µdl (θ , h) fθ (θ ) dθ + o (µ) = µFL(θ)
           00               0          0    0                  0
                                                                                            dl (θ , h) dθ0 + o (µ) ,
      Θ                                                                Θ     FL(θ)
                                                                                0



so that, to a first order as µ → 0,
                                                          ˆ
                               w̃ (θ) − w (θ) = µw (θ)          γ (θ, θ0 ) dˆl (θ0 , h) dθ0 .                     (66)
                                                            Θ

To derive this equation formally, denote by dL (h) ∈ M the measure on Θ defined by the Gateaux
                                                                   ´
derivative of the measure L in the direction h. We have dL (h) = Θ dL (θ0 , h) δθ0 dθ0 . We then
have
             w̃ (θ) − w (θ) = ω {θ, L (θ) + µdL (θ, h) , L + µdL (h)} − ω (θ, L (θ) , L ) .




                                                         56
The right hand side of this equation is equal to
                                         ˆ
        ω2 (θ, L (θ) , L ) µdL (θ, h) +       {ω (θ, L (θ) , L + µdL (θ0 , h) δθ0 ) − ω (θ, L (θ) , L )} dθ0
                                           Θ
                                      ˆ
                   w (θ)                             w (θ)
       =γ̄¯ (θ, θ)       µdL (θ, h) +    γ̄ (θ, θ0 )         µdL (θ0 , h) dθ0 + o (µ)
                   L (θ)               Θ             L (θ0 )
                                      ˆ                            
                            ˆ
       =µw (θ) γ̄¯ (θ, θ) dl (θ, h) +              0  ˆ    0      0
                                          γ̄ (θ, θ ) dl (θ , h) dθ + o (µ) ,
                                                Θ


which leads to expression (66).
   Next, for any function g, we have, to a first order as µ → 0,

                          g [w̃ (θ) (l (θ) + µdl (θ, h))] − g [w (θ) l (θ)]
                       = {[w̃ (θ) − w (θ)] l (θ) + w (θ) µdl (θ, h)} g 0 (w (θ) l (θ))
                          ˆ                                            
                       =µ       γ (θ, θ0 ) dˆl (θ0 , h) dθ0 + dˆl (θ, h) w (θ) l (θ) g 0 (w (θ) l (θ)) .
                                Θ


    A first-order Taylor expansion of the perturbed first-order conditions (65) around the baseline
allocation then yields:

 0 =v 00 (l (θ)) µdl (θ, h) + µh0 (w (θ) l (θ)) w (θ)
      − {[w̃ (θ) − w (θ)] (1 − T 0 (w (θ) l (θ))) − [T 0 (w̃ (θ) (l (θ) + µdl (θ, h))) − T 0 (w (θ) l (θ))] w (θ)} .

Using (66), we obtain

        l (θ) v 00 (l (θ)) ˆ
                                                                  ˆ                               
   0=                      µdl (θ, h) + µh0 (w (θ) l (θ)) − µ           γ (θ, θ0 ) dˆl (θ0 , h) dθ0 (1 − T 0 (w (θ) l (θ)))
             w (θ)                                                    Θ
              ˆ                                             
        +µ           γ (θ, θ0 ) dˆl (θ0 , h) dθ0 + dˆl (θ, h) w (θ) l (θ) T 00 (w (θ) l (θ)) .
                  Θ


Solving for dˆl (θ, h),
                                                                          ´
                             [1 − T 0 (y (θ)) − y (θ) T 00 (y (θ))]            γ̄ (θ, θ0 ) dˆl (θ0 , h) dθ0 − h0 (y (θ))
 dˆl (θ, h) = h                                                            Θ
                                                                           i
                                      l(θ)v 00 (l(θ))
                  (1 − T 0 (y (θ)))     v 0 (l(θ))      + y (θ) T 00 (y (θ)) − [1 − T 0 (y (θ)) − y (θ) T 00 (y (θ))] γ̄¯ (θ, θ)
                             1−T 0 (y(θ))−y(θ)T 00 (y(θ))                            ˆ
                       1−T 0 (y(θ))+εl,1−τ (θ)y(θ)T 00 (y(θ)) εl,1−τ (θ)
           =              1−T 0 (y(θ))−y(θ)T 00 (y(θ))
                                                                                           γ̄ (θ, θ0 ) dˆl (θ0 , h) dθ0
               1−                                                       ¯
                      1−T 0 (y(θ))+εl,1−τ (θ)y(θ)T 00 (y(θ)) εl,1−τ (θ) γ̄ (θ, θ)      Θ

                                              εl,1−τ (θ)
                                 1−T 0 (y(θ))+εl,1−τ (θ)y(θ)T 00 (y(θ))
               −             1−T 0 (y(θ))−y(θ)T 00 (y(θ))
                                                                                      h0     (y (θ)) ,
                   1−                                          ε
                         1−T 0 (y(θ))+εl,1−τ (θ)y(θ)T 00 (y(θ)) l,1−τ   (θ) ¯
                                                                            γ̄ (θ, θ)

which leads to equation (21).




                                                                   57
B.3.2      Proof of Proposition 1
We now derive the general solution (22) of the integral equation (21). Assume that the condition
´                 2
  Θ2
     |K1 (θ, θ0 )| dθdθ0 < 1 holds.
                                                                         h0 (y(θ))
Proof. For ease of exposition, denote by ĥ0 (θ) =                      1−T 0 (y(θ)) ,   and g (θ) ≡ dˆl (θ, h). The integral
equation writes                                                     ˆ
                                   g (θ) = − Ẽl,1−τ (θ) ĥ (θ) +         K1 (θ, θ0 ) g (θ0 ) dθ0 ,
                                                                    Θ

where K1 (θ, θ0 ) = Ẽl,w (θ) γ̄ (θ, θ0 ). Substituting for g (θ0 ) in the integral using the r.h.s. of the
integral equation yields:
                                           ˆ                                    ˆ                          
                                    0                  0            0   0   0
    g (θ) = − Ẽl,1−τ (θ) ĥ (θ) +    K1 (θ, θ ) −Ẽl,1−τ (θ ) ĥ (θ ) +            K1 (θ , θ ) g (θ ) dθ dθ0
                                                                                         0 00       00   00
                                    Θ                                             Θ
                                   ˆ                                           
                              0                      0           0    0   0   0
          = − Ẽl,1−τ (θ) ĥ (θ) +      K1 (θ, θ ) Ẽl,1−τ (θ ) ĥ (θ ) dθ
                                      Θ
              ˆ ˆ                                             
            +          K1 (θ, θ0 ) K1 (θ0 , θ00 ) g (θ00 ) dθ00 dθ0 .
                 Θ        Θ

Applying Fubini’s theorem yields
                                     ˆ                                          
      g (θ) = − Ẽl,1−τ (θ) ĥ0 (θ) +    K1 (θ, θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (θ0 ) dθ0
                                       Θ
                ˆ ˆ                                
              +        K1 (θ, θ ) K1 (θ0 , θ00 ) dθ0 g (θ00 ) dθ00
                                  0

                Θ   Θ
                                      ˆ                                           ˆ
            ≡ − Ẽl,1−τ (θ) ĥ0 (θ) +    K1 (θ, θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (θ0 ) dθ0 +   K2 (θ, θ0 ) g (θ0 ) dθ0 ,
                                                Θ                                                     Θ
                      ´
where K2 (θ, θ0 ) =       Θ
                              K (θ, θ00 ) K (θ00 , θ0 ) dθ00 . A second substitution yields:
                                            ˆ                                       
                                      0                 0            0    0  0     0
              g (θ) = − Ẽl,1−τ (θ) ĥ (θ) +    K1 (θ, θ ) Ẽl,1−τ (θ ) ĥ (θ ) dθ
                                              Θ
                        ˆ                                     ˆ                           
                                  0              0   0    0
                      +   K2 (θ, θ ) −Ẽl,1−τ (θ ) ĥ (θ ) +      K1 (θ , θ ) g (θ ) dθ dθ0 ,
                                                                         0 00        00 00
                                  Θ                                             Θ

which can be rewritten, following the same steps as above, as
                               ˆ                                             ˆ                                          
g (θ) = − Ẽl,1−τ (θ) ĥ0 (θ) +      K (θ, θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (θ0 ) dθ0 +    K2 (θ, θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (θ0 ) dθ0
          ˆ                        Θ                                           Θ
                    0       0    0
        +   K3 (θ, θ ) g (θ ) dθ ,
             Θ
                          ´
where K3 (θ, θ0 ) =           Θ
                                  K2 (θ, θ00 ) K (θ00 , θ0 ) dθ00 . By repeated substitution, we thus obtain: for all




                                                              58
n ≥ 1,
                                                                               n ˆ
                                   (                                                                                                                                    )
                                                                               X
                                                                 0                                           0                    0            0       0            0
                    g (θ) = −          Ẽl,1−τ (θ) ĥ (θ) +                                  Ki (θ, θ ) Ẽl,1−τ (θ ) ĥ (θ ) dθ
                                                                               i=1       Θ
                                   ˆ
                               +            Kn+1 (θ, θ0 ) g (θ0 ) dθ0 ,
                                       Θ
                                     ´
where for all n, Kn+1 (θ, θ0 ) = Θ Kn (θ, θ00 ) K1 (θ00 , θ0 ) dθ00 . Now the last step is to show that that
´
  Θ
    Kn+1 (θ, θ0 ) g (θ0 ) dθ0 converges to zero as n → ∞.
     Now, applying the Cauchy-Schwartz inequality to the interated kernel yields
                                                       ˆ                                            ˆ                                                        
                                        0     2                                    00    2     00                            00       0        2           00
                      |Kn+1 (θ, θ )| ≤                               |Kn (θ, θ )| dθ                                 |K1 (θ , θ )| dθ                               .
                                                             Θ                                                   Θ


Integrating this inequality with respect to θ0 implies
               ˆ                                        ˆ                                             ˆ ˆ                                                                     
                                   0    2         0                                 00   2       00                                       00       0       2            00   0
                    |Kn+1 (θ, θ )| dθ ≤                      |Kn (θ, θ )| dθ               |K1 (θ , θ )| dθ dθ
                Θ
                                                                 ˆ
                                                                 Θ                   Θ Θ
                                                              2                    2
                                                      = kK1 k2 ×     |Kn (θ, θ00 )| dθ00 .
                                                                               Θ

By induction, we obtain
                           ˆ                                                                        ˆ
                                                         0       2     0          2n                                              2
                                   |Kn+1 (θ, θ )| dθ                       ≤ kK1 k2          ×              |K1 (θ, θ00 )| dθ00 .
                             Θ                                                                        Θ

We thus have, using the Cauchy-Schwartz inequality again,
                               ˆ                                                                             2
                               Kn+1 (θ, θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (θ0 ) dθ0
                             Θ
                            ˆ                          ˆ                                 
                                                                                      2
                                             00 2   00                     0    0  0     00
                          ≤      |Kn+1 (θ, θ )| dθ               Ẽl,1−τ (θ ) ĥ (θ ) dθ
                              Θ                               Θ
                                     ˆ                          
                                                          2                         2
                                  2n
                          ≤ kK1 k2 ×        |K1 (θ, θ00 )| dθ00 × Ẽl,1−τ ĥ0
                                                             Θ                                                                    2


Thus, for all θ ∈ Θ,

         ˆ                                                                    "                             sˆ                                                  #
                                                                                                                                                   2                                 i
               Ki (θ, θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (θ0 ) dθ0 ≤                           Ẽl,1−τ ĥ0                           |K1 (θ, θ00 )| dθ00 × kK1 k2 .
           Θ                                                                                            2            Θ


Denote by
                                                        n ˆ
                                                        X
                                       κn (θ) ≡                            Ki (θ, θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (θ0 ) dθ0 .
                                                        i=1           Θ

Since kK1 k2 < 1, the previous arguments imply that the sequence {κn (θ)}n≥1 is dominated by a
convergent geometric series of positive terms, and therefore it converges absolutely and uniformly




                                                                                    59
to a unique limit κ (θ) on Θ. Similarly, we have
                                                  ˆ
                                        lim            Kn+1 (θ, θ0 ) g (θ0 ) dθ0 = 0.
                                     n→∞           Θ

Therefore, we can write
                                                             ∞ ˆ
                                                             X
                                              0
                 g (θ) = − Ẽl,1−τ (θ) ĥ (θ) −                         Ki (θ, θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (θ0 ) dθ0 ,
                                                             i=1   Θ


which proves equation (22).
   To show the uniqueness of the solution, suppose that g1 (θ) and g2 (θ) are two solutions to (22).
Then ∆ (θ) ≡ g2 (θ) − g1 (θ) satisfies the homogeneous integral equation
                                                       ˆ
                                        ∆ (θ) =              K1 (θ, θ0 ) ∆ (θ0 ) dθ0 .
                                                         Θ

The Cauchy-Schwartz inequality reads
                                        ˆ                                   ˆ                    
                                2                                  2                            2
                         |∆ (θ)| ≤                |K1 (θ, θ0 )| dθ0                    |∆ (θ0 )| dθ0 .
                                              Θ                                    Θ

Integrating with respect to θ yields
                                ˆ                                           ˆ
                                                   2                    2                2
                                        |∆ (θ)| dθ ≤ kK1 k                      |∆ (θ0 )| dθ0 ,
                                    Θ                                       Θ

                   2                          ´                2
Assumption kK1 k < 1 then implies                 Θ
                                                      |∆ (θ)| dθ, i.e., ∆ (θ) = 0 for all θ ∈ Θ.


                                 2
     In case the condition kK1 k2 < 1 does not hold, there exist methods to express the solution to the
integral equation (21). Schmidt’s method consists of showing that the kernel of the integral equation
(21) can be written as the sum of two kernels, K1 (θ, θ0 ) = K̄ (θ, θ0 ) + Kε (θ, θ0 ), where K̄ (θ, θ0 ) is
                                                         2
separable and Kε (θ, θ0 ) satisfies the condition kKε k2 < 1. This decomposition is allowed by the
Weierstrass theorem: by appropriately choosing a separable polynomial in θ and θ0 for K̄ (θ, θ0 ),
we can make the norm of Kε (θ, θ0 ) arbitrarily small. It is then easy to see that the solution to
(21) satisfies an integral equation with kernel Kε (θ, θ0 ), where the exogenous function on the right
hand side (outside of the integral) is itself the solution to an integral equation with separable kernel
K̄ (θ, θ0 ). The former integral equation can be analyzed using the same arguments as in the proof
of Proposition 1. The latter integral equation can be analyzed using the arguments of the proof of
Proposition 3. We can then derive a solution to (21) of the same form as (22), with a more general
resolvent. This technique is detailed in Section 2.4 of Zemyan (2012).


B.3.3     Proof of Corollaries 1 and 2
We now derive the incidence of tax reforms on wages, utilities, government revenue, and social


                                                                   60
welfare.

Proof. First note that we can also write this equation as
                                                                             ´
        ˆ          [1 − T 0 (w (θ) l (θ)) − y (θ) T 00 (w (θ) l (θ))] Θ γ (θ, θ0 ) dˆl (θ0 , h) dθ0 − h0 (y (θ))
       dl (θ, h) =                                                00 (l(θ))
                                    (1 − T 0 (y (θ))) l(θ)v  v 0 (l(θ))     + y (θ) T 00 (w (θ) l (θ))
                          0                       00                         ˆ
                   [1 − T (y (θ)) − y (θ) T (y (θ))] εl,1−τ (θ)
                 =                                                               γ (θ, θ0 ) dˆl (θ0 , h) dθ0
                    1 − T 0 (y (θ)) + εl,1−τ (θ) y (θ) T 00 (y (θ)) Θ
                                           εl,1−τ (θ)
                   −                                                           h0 (y (θ))
                       1 − T (y (θ)) + εl,1−τ (θ) y (θ) T 00 (y (θ))
                              0
                            ˆ
                                                                                 h0 (y (θ))
                 =ε̃l,w (θ)     γ (θ, θ0 ) dˆl (θ0 , h) dθ0 − ε̃l,1−τ (θ)                        ,
                             Θ                                                1 − T 0 (y (θ))

which, along with (66), proves equation (26).
   Next, the first-order effects of the tax reform h on individual θ’s tax liability are given by:

        dh T (w (θ) l (θ))
                                                                                                          
                 1
       ≡ lim       [T (w̃ (θ) (l (θ) + µdl (θ, h))) − T (w (θ) l (θ))] + h (w̃ (θ) (l (θ) + µdl (θ, h)))
         µ→0 µ
                                         ˆ                              
       =T 0 (y (θ)) y (θ) dˆl (θ, h) +       γ (θ, θ0 ) dˆl (θ0 , h) dθ0 + h (y (θ))
                                           Θ
                                                              ε̃l,1−τ (θ) h0 (y (θ))
                                                                                        
                                        1
       =T 0 (y (θ)) y (θ) 1 +                  dˆl (θ, h) +                                  + h (y (θ)) .
                                   ε̃l,w (θ)                     ε̃l,w (θ) 1 − T 0 (y (θ))

The first-order effects of the tax reform h on individual welfare are given by

      dh u (y (θ) − T (y (θ)) − v (l (θ))) = [dh y (θ) − dh T (y (θ)) − h (y (θ)) − dh v (l (θ))] u0 (θ)
       h                                                                                    i
     = (1 − T 0 (y (θ))) y (θ) dŷ (θ, h) − l (θ) v 0 (l (θ)) dˆl (θ, h) − h (y (θ)) u0 (θ)
                                                                        ε̃l,1−τ (θ) h0 (y (θ))
                                                                                                 
                                                 1
     = (1 − T 0 (y (θ))) y (θ) 1 +                      dˆl (θ, h) +                                  u0 (θ)
                                            ε̃l,w (θ)                     ε̃l,w (θ) 1 − T 0 (y (θ))
       − l (θ) v 0 (l (θ)) dˆl (θ, h) u0 (θ) − h (y (θ)) u0 (θ)
                                                             ε̃l,1−τ (θ) h0 (y (θ))
                                                                                         
              0                          1       ˆ
     = (1 − T (y (θ))) y (θ)                   dl (θ, h) +                                   u0 (θ) − h (y (θ)) u0 (θ) .
                                    ε̃l,w (θ)                  ε̃l,w (θ) 1 − T 0 (y (θ))

The first-order effects of the tax reform h on government revenue are given by
                         ˆ                         
     dR (T, h) = dh            T (y (θ)) fθ (θ) dθ
      ˆ                     Θ

    =    h (y (θ)) fθ (θ) dθ
       Θ
        ˆ
                          ε̃l,1−τ (y (θ)) h0 (y (θ))
                                                                                                 
                                                                              1           ˆl (θ, h) y (θ) fθ (θ) dθ
      +     T 0 (y (θ))                                      +   1  +                   d
          Θ                 ε̃l,w (y (θ)) 1 − T 0 (y (θ))              ε̃l,w (y (θ))
      ˆ                          ˆ                            0
                                                                                                         
                                                ε̃l,1−τ (y) h (y)                       1         ˆl (y, h) yfy (y) dy.
    =     h (y) fy (y) dy +           T 0 (y)                            +    1 +                d
       R+                         R+              ε̃l,w (y) 1 − T 0 (y)            ε̃l,w (y)



                                                            61
The first-order effects of the tax reform h on the social objective are given by
                                ˆ
      λ−1 dG (T, h) = λ−1 dh         u (y (θ) − T (y (θ)) − v (l (θ))) f˜θ (θ) dθ
                                  Θ
       ˆ 
           1 − T 0 (y (θ))
                                                                                         
                                                ε̃l,1−τ (θ)
     =                     y (θ) dˆl (θ, h) +                y (θ) h0 (y (θ)) − h (y (θ)) λ−1 u0 (θ) f˜θ (θ) dθ
        Θ     ε̃l,w (θ)                           ε̃l,w (θ)
       ˆ 
           1 − T 0 (y (θ))
                                                                                         
                                                ε̃ l,1−τ (θ)
     =                     y (θ) dˆl (θ, h) +                y (θ) h0 (y (θ)) − h (y (θ)) gθ (θ) fθ (θ) dθ
        Θ     ε̃l,w (θ)                           ε̃l,w (θ)
       ˆ                                                                         ˆ
            1 − T 0 (y) ˆ
                                                           
                                      ε̃l,1−τ (y) 0
     =                  dl (y, h) +                  h (y) ygy (y) fy (y) dy −         h (y) gy (y) fy (y) dy.
        R+   ε̃l,w (y)                  ε̃l,w (y)                                   R+


The first-order effects of the tax reform h on social welfare are finally given by

               dW (T, h) = dR (T, h) + λ−1 dG (T, h)
                ˆ
              =    (1 − gy (y)) h (y) fy (y) dy
                  R+
                   ˆ
                                ε̃l,1−τ (y) h0 (y)
                                                                                    
                            0                                          1       ˆ
                 +     T (y)                              + 1+                dl (y, h) yfy (y) dy
                    R+            ε̃l,w (y) 1 − T 0 (y)           ε̃l,w (y)
                   ˆ 
                        1 − T 0 (y) ˆ
                                                                    
                                                  ε̃l,1−τ (y) 0
                 +                    dl (y, h) +             h (y) ygy (y) fy (y) dy.
                    R+   ε̃l,w (y)                  ε̃l,w (y)

This concludes the proof of equations (28) and (29).




B.3.4     Proof of Proposition 2
We now specialize the production function to be CES. In this case the integral equation (21) has a
simple solution.

Proof. If the production function is CES, the cross wage elasticities γ̄ (θ, θ0 ) do not depend on
θ (see equation (15)). Hence the kernel of the integral equation, K1 (θ, θ0 ) = Ẽl,w (θ) γ̄ (θ, θ0 ), is
multiplicatively separable, i.e., the product of a function of θ only and a function of θ0 only:

                                ε̃l,w (θ)
            K1 (θ, θ0 ) =                         γ̄ (θ, θ0 )
                             ¯
                         1 − γ̄ (θ, θ) ε̃l,w (θ)
                                                                                     ρ
                                                             (1 − ρ) a (θ0 ) L (θ0 )
                                                     
                                   ε̃l,w (θ)
                       =                               × ´                    ρ         ≡ κ1 (θ) × κ2 (θ0 ) .
                           1 − γ̄¯ (θ, θ) ε̃l,w (θ)            Θ
                                                                 a (x) L (x)    dx

                                                                    h0 (y)
The integral equation (21) then writes, letting ĥ0 (y) =          1−T 0 (y) ,

                                                                      ˆ
                   dˆl (θ, h) = − Ẽl,1−τ (θ) ĥ0 (y (θ)) + κ1 (θ)          κ2 (θ0 ) dˆl (θ0 , h) dθ0
                                                                        Θ

and can be solved as follows. Multiplying by κ2 (θ0 ) both sides of the integral equation evaluated at




                                                         62
θ0 yields
                             κ2 (θ0 ) dˆl (θ0 , h) = − κ2 (θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (y (θ0 ))
                                                                        ˆ
                                                            0
                                                     + κ1 (θ ) κ2 (θ )0
                                                                             κ2 (θ00 ) dˆl (θ00 , h) dθ00 .
                                                                                                 Θ
                                           0
Integrating with respect to θ gives
              ˆ                                              ˆ
                   κ2 (θ0 ) dˆl (θ0 , h) dθ0 = −              κ2 (θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (y (θ0 )) dθ0
               Θ                                                  Θ
                                                           ˆ                           ˆ                             
                                                         +            0        0
                                                               κ1 (θ ) κ2 (θ ) dθ    0                00 ˆ   00      00
                                                                                                κ2 (θ ) dl (θ , h) dθ ,
                                                                          Θ                                     Θ

i.e.,                                                                         ´
                        ˆ
                                                                                  κ2 (θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (y (θ0 )) dθ0
                             κ2 (θ ) dˆl (θ , h) dθ = −
                                   0               0              0           Θ          ´                                 .
                         Θ                                                          1 − Θ κ1 (θ0 ) κ2 (θ0 ) dθ0
Substituting into the right hand side of the integral equation (21) leads to
                                                                                        ´
                                                                                                κ2 (θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (y (θ0 )) dθ0
              dˆl (θ, h) = − Ẽl,1−τ (θ) ĥ0 (y (θ)) − κ1 (θ)                               Θ          ´                                 ,
                                                                                                  1 − Θ κ1 (θ0 ) κ2 (θ0 ) dθ0

which implies equation (30).
    Suppose in particular, as in Saez (2001), that the tax reform h is the step function h (y) =
I{y≥y∗ } , so that h0 (y) = δy∗ (y) is the Dirac delta function (i.e., marginal tax rates are perturbed at
income y ∗ only). To apply this equality to this non-differentiable perturbation, construct a sequence
of smooth funtions ϕy∗ ,ε (y) such that

                                                                 δy∗ (y) = lim ϕy∗ ,ε (y) ,
                                                                                  ε→0

in the sense that for all continuous functions ψ with compact support,
                                                             ˆ
                                                       lim            ϕy∗ ,ε (y) ψ (y) dy = ψ (y ∗ ) ,
                                                   ε→0       R

i.e., changing variables in the integral,
                                       ˆ
                                                                             dy (θ0 )
                                                                                     
                                                                      0  0
                                lim            ϕ
                                               y ∗ ,ε    (y (θ )) ψ (y (θ ))            dθ0 = ψ (y ∗ ) .
                               ε→0     Θ                                       dθ

This can be obtained by defining an absolutely integrable and smooth function ϕy∗ (y) with compact
             ´
support and R ϕy∗ (y) dy = 1, and letting ϕy∗ ,ε (y) = ε−1 ϕy∗ yε . We then have, for all ε > 0,
                                                                 

                                                                                                 ´                              ϕy∗ ,ε (y (θ 0 ))
                                          ϕy∗ ,ε (y (θ))                                                 κ2 (θ0 ) Ẽl,1−τ (θ0 ) 1−T   0 (y(θ 0 )) dθ
                                                                                                                                                     0
        dˆl (θ, Φy∗ ,ε ) = − Ẽl,1−τ (θ)                   − κ1 (θ)
                                                                                                     Θ
                                                                                                                  ´                                    .
                                         1 − T 0 (y (θ∗ ))                                                  1 − Θ κ1 (θ0 ) κ2 (θ0 ) dθ0




                                                                                  63
Letting ε → 0, we get
                                                                                      −1
                                                                           dy(θ ∗ )
                                                                       
                                δy∗ (y (θ))                                κ2 (θ∗ ) Ẽl,1−τ (θ∗ ) 1−T 0 (y(θ
                                                                             dθ
                                                                                                           1
                                                                                                             ∗ ))
      dˆl (θ, h) = − Ẽl,1−τ (θ)                  − κ 1 (θ)                 ´                                     ,
                              1 − T 0 (y (θ∗ ))                        1 − Θ κ1 (θ0 ) κ2 (θ0 ) dθ0
                                    "                                                                    #                                  (67)
                  Ẽl,1−τ (y (θ∗ ))                        1          Ẽl,w (y (θ)) γ̄ (θ, θ∗ )
               =−                     δ y ∗ (y (θ)) +               ´                                      .
                  1 − T 0 (y (θ∗ ))                    y 0 (θ∗ ) 1 − Θ Ẽl,w (y (θ0 )) γ̄ (θ0 , θ0 ) dθ0

This formula will be useful for the proof of Corollary 3.




B.3.5       Proof of Corollary 3
Next, assume that the production function is CES and the baseline tax schedule is CRP, given by
(31) for p ∈ (−∞, 1), so that in particular, 1 − T 0 (y) = (1 − τ ) y −p and T 00 (y) = p (1 − τ ) y −p−1 .
We start by deriving prelimilary properties of the labor supply and wage elasticities.
    The labor supply elasticities (7), (7), and (12) are given by

                              1 − T 0 (y)                         (1 − τ ) y −p                ε
           ε̃l,1−τ (y) =      0            00
                                                 ε =            −p                  −p−1
                                                                                         ε=        ,
                         1 − T (y) + εyT (y)         (1 − τ ) y + εyp (1 − τ ) y            1 + pε
                         1 − T 0 (y) − yT 00 (y)      (1 − τ ) y −p − yp (1 − τ ) y −p−1    (1 − p) ε
             ε̃l,w (y) =      0            00
                                                 ε =            −p                  −p−1
                                                                                         ε=           ,
                         1 − T (y) + εyT (y)         (1 − τ ) y + εyp (1 − τ ) y             1 + pε

and                                                                              ε
                                             ε̃l,1−τ (θ)             1+pε               ε
                   Ẽl,1−τ (y) =                                =             =                     ,
                                       1 − γ̄¯ (θ, θ) ε̃l,w (θ)        (1−p)ε
                                                                  1 + (1+pε)σ   1 + pε + (1 − p) σε
                                                                            (1−p)ε
                                            ε̃l,w (θ)             1+pε            (1 − p) ε
                        Ẽl,w (y) =                          =             =                     .
                                    1 − γ̄¯ (θ, θ) ε̃l,w (θ)        (1−p)ε
                                                               1 + (1+pε)σ   1 + pε + (1 − p) σε

Note that all of these elasticities are constant. This is because the curvature of the CRP tax schedule
(captured by the parameter p) is constant. This feature allows us to simplify further equation (29)
to obtain (32), respectively.
    We can now prove Corollary 3.

Proof. Suppose first that the baseline tax schedule is linear, i.e., p = 0 in (31). In this case we have
                    ˆ                                                       ˆ
                                                                   ε                                        ε           1
                            Ẽl,w (y (θ0 )) γ̄ (θ0 , θ0 ) dθ0 =        ε             γ̄ (θ0 , θ0 ) dθ0 =        ε   ×     ,
                        Θ                                         1+   σ      Θ                            1+   σ       σ

where the last equality follows from expression (15) for the cross-wage elasticities γ̄ (θ0 , θ0 ). Thus
the integral equation (30) becomes
                                                                                2              ˆ
                         1   ε                            1            ε                  σ+ε
       dˆl (θ, h) = −                     0
                                       ε h (y (θ)) −                         ε                             γ̄ (θ, θ0 ) h0 (y (θ0 )) dθ0 .
                        1−τ 1+        σ                  1−τ          1+     σ             σ          Θ




                                                                  64
Note that the first term in this expression for individual θ is proportional to the exogenous marginal
tax rate perturbation at income y (θ), and the second term is a constant independent of θ.
    Now integrate this equation to get the effect of the perturbation on government revenue. Formula
(28) writes

     dR (T, h)
      ˆ                    ˆ
                                          ε̃l,1−τ (y) h0 (y)
                                                                                                  
                                                                                  1         ˆl (y, h) yfy (y) dy
    =    h (y) fy (y) dy +               T 0 (y)                    +   1 +                d
       R+                    R+             ε̃l,w (y) 1 − T 0 (y)            ε̃l,w (y)
      ˆ                           ˆ                                     ˆ
                              τ                                       1
    =     h (y) fy (y) dy +             h0 (y) yfy (y) dy + 1 +           τ        dˆl (y, h) yfy (y) dy
       R+                   1 − τ  R+                                 ε       R+
      ˆ                                          ˆ
                            (σ − 1) ε τ
    =     h (y) fy (y) dy −                          h0 (y) yfy (y) dy
       R+                     σ + ε 1 − τ R+
                           ˆ "ˆ                                     −1     #
                                                           dy (θ0 )
                                                         
        σ (1 + ε) ε τ                          0   0  0                   0
      −                              γ̄ (y, y ) h (y )                  dy yfy (y) dy,
           σ + ε 1 − τ R+ R+                                 dθ
                                                                                                  ´
where the last equality uses a change of variables to rewrite the integral                            Θ
                                                                                                          γ̄ (θ, θ0 ) h0 (y (θ0 )) dθ0 .
But using expression (64) to substitute for γ̄ (y, y 0 ), we obtain
                 ˆ    "ˆ                                          −1            #
                                                       dy (θ0 )
                                                   
                                     0     0   0                             0
                              γ̄ (y, y ) h (y )                         dy           yfy (y) dy
                 R+      R+                              dθ
                 "ˆ                                         #              ˆ
                                   y 0 fy (y 0 )
             =          (1 − ρ) ´                 0  0    0
                                                 h (y ) dy E [y] = (1 − ρ)     h0 (y) yfy (y) dy.
                     R+           R+
                                     yfy (y) dy                             R+


Hence we obtain

     dR (T, h)
     ˆ                               ˆ                                  ˆ
                        (σ − 1) ε τ                         (1 + ε) ε τ
    = h (y) fy (y) dy −                 h0 (y) yfy (y) dy −               h0 (y) yfy (y) dy
                          σ+ε 1−τ R                           σ+ε 1−τ R
     ˆR
                               ˆ
                          τ
    = h (y) fy (y) dy −      ε h0 (y) yfy (y) dy,
      R                 1−τ R

which is exactly the partial equilibrium formula.
    Now suppose more generally that the baseline tax schedule is CRP with p ∈ (−∞, 1). Consider
the Saez perturbation at income y ∗ , i.e. h (y) = I{y≥y∗ } and h0 (y) = δy∗ (y). Substituting for
the labor supply elasticities and using the fact that the elasticities Ẽl,1−τ (θ) , Ẽl,w (θ) are constant,
equation (67) can be rewritten as
                                            "                      −1                                         #
                         Ẽl,1−τ (y (θ∗ ))                dy (θ∗ )            Ẽl,w (y (θ∗ )) γ̄ (θ, θ∗ )
                                                        
       ˆ
      dl (y (θ) , h) = −                      δy∗ (y) +                     ´
                         1 − T 0 (y (θ∗ ))                  dθ         1 − Θ Ẽl,w (y (θ0 )) γ̄ (θ0 , θ0 ) dθ0
                                        "                      −1                          #
                                                      dy (θ∗ )
                                                    
                            Ẽl,1−τ                                    Ẽl,w              ∗
                     =−                   δy∗ (y) +                               γ̄ (y, y ) .
                         1 − T 0 (y ∗ )                 dθ          1 − Ẽl,w /σ




                                                                  65
Substituting in the expression (28) that gives the revenue effects of the tax reform, we obtain:

           dR (T, h)
            ˆ                       ˆ                                                                    
                                                        ε̃l,1−τ δy∗ (y)                     1      ˆl (y, h) yfy (y) dy
          =    I{y≥y∗ } fy (y) dy +                    T 0 (y)                  +    1 +          d
             R+                        R+                 ε̃l,w 1 − T 0 (y)               ε̃l,w
                            ˆ       0
                                                                                     
                                  T (y)          ε̃l,1−τ                 1
          =1 − Fy (y ∗ ) +            0 (y ∗ )
                                                             − 1+               Ẽl,1−τ yfy (y) δy∗ (y) dy
                             R+ 1 − T              ε̃ l,w             ε̃ l,w
              ˆ                                                                           −1
                      T 0 (y)                                                    dy (θ∗ )
                                                                             
                                         1       Ẽl,1−τ Ẽl,w             ∗
           −              0   ∗
                                  1 +                            γ̄ (y, y    )                  yfy (y) dy,
                R+ 1 − T (y )          ε̃l,w 1 − Ẽl,w /σ                           dθ

i.e.,

                                              T 0 (y ∗ )
        dR (T, h) =1 − Fy (y ∗ ) − ε̃l,1−τ                 y ∗ fy (y ∗ )
                                            1 − T 0 (y ∗ )
                      
                              1
                                                          T 0 (y ∗ )
                   + 1+                ε̃l,1−τ − Ẽl,1−τ                      y ∗ fy (y ∗ )
                            ε̃l,w                              1 − T 0 (y ∗ )
                                                                 ε̃l,w
                                                                            ˆ                                                  −1
                                                                  ε̃l,w
                                                                                    T 0 (y)                         dy (θ∗ )
                                                                                                              
                                       1                     1+
                          − 1+                    Ẽl,1−τ            σ
                                                                                                 γ̄ (y, y ∗ )                        yfy (y) dy
                                      ε̃l,w                 1−
                                                                   ε̃l,w
                                                                             R+   1 − T 0 (y ∗ )                      dθ
                                                                  σ+ε̃l,w
                                                   T 0 (y )        ∗
                        =1 − Fy (y ∗ ) − ε̃l,1−τ                y ∗ fy (y ∗ ) − Ẽl,1−τ (1 + ε̃l,w ) × . . .
                                                 1 − T 0 (y ∗ )
                         (                                                −1 ˆ                                         )
                             1 T 0 (y ∗ )                       dy (θ∗ )                T 0 (y)
                                                            
                                               ∗       ∗                                                    ∗
                           −                  y fy (y ) +                                          γ̄ (y, y ) yfy (y) dy .
                             σ 1 − T 0 (y ∗ )                       dθ                      0
                                                                                  R+ 1 − T (y )
                                                                                                ∗



The terms in curly brackets are equal to
                        −1 (ˆ                                                                                                                )
             dy (θ∗ )                   T 0 (y)                               T 0 (y ∗ )                                  dy (θ∗ )
         
                                            0   ∗
                                                  γ̄ (y, y ∗ ) yfy (y) dy +        0     ∗
                                                                                           γ̄¯ (y ∗ , y ∗ ) y ∗ fy (y ∗ )
               dθ                R+   1 − T (y )                            1 − T (y )                                      dθ
                  ∗
                        −1 ˆ
                            T 0 (y (θ))
         
             dy (θ )
    =                            0      ∗
                                            γ̄ (y (θ) , y (θ∗ )) y (θ) fθ (θ) dθ
               dθ       Θ 1 − T (y (θ ))
                              T 0 (y (θ∗ ))
                                                                                     
                                               ¯         ∗         ∗       ∗       ∗
                          +                    γ̄ (y (θ ) , y (θ )) y (θ ) fθ (θ )
                            1 − T 0 (y (θ∗ ))
                 −1 ˆ
        dy (θ∗ )            T 0 (y (θ))
                                                                                  
                                                              ∗
    =                                       γ  (y  (θ) , y (θ   )) y (θ) fθ (θ) dθ
          dθ              1 − T 0 (y (θ∗ ))
                      (ˆΘ                                           )
                   −1
        dy (θ∗ )              T 0 (y)
                
    =                              0  ∗
                                          γ (y, y ∗ ) yfy (y) dy .
          dθ            R+ 1 − T (y )


Thus we obtain

                                                           T 0 (y ∗ )
                dR (T, h) =1 − Fy (y ∗ ) − ε̃l,1−τ                      y ∗ fy (y ∗ )
                                                         1 − T 0 (y ∗ )
                                                                     −1 ˆ
                                                           dy (θ∗ )                   T 0 (y)
                                                         
                                  − Ẽl,1−τ (1 + ε̃l,w )                                  0   ∗
                                                                                                γ (y, y ∗ ) yfy (y) dy.
                                                             dθ              R+ 1 − T (y )




                                                                            66
Another way to write this formula is as follows: using the expression (64) derived above for the cross
wage elasticities and the fact that γ̄ (y, y ∗ ) depends only on y ∗ (so that it can be taken out of the
integral), we get
                           −1                   ˆ
                dy (θ∗ )                                T 0 (y)                  T 0 (y ∗ )
            
                                  γ̄ (y, y ∗ )              0   ∗
                                                                  yfy (y) dy +                γ̄¯ (y ∗ , y ∗ ) y ∗ fy (y ∗ )
                  dθ                             R+   1 − T (y )               1 − T 0 (y ∗ )
                                       ˆ
           1 y ∗ fy (y ∗ )       T 0 (y)                     1 T 0 (y ∗ )
          = ´                         0  ∗
                                            yf y  (y)  dy −                  y ∗ fy (y ∗ )
           σ R+ yfy (y) dy  R+ 1 − T (y )                   σ 1 − T 0 (y ∗ )
                           (ˆ                                   )
           1 y ∗ fy (y ∗ )       T 0 (y) − T 0 (y ∗ )
          = ´                                         yfy (y) dy ,
           σ R+ yfy (y) dy    R+    1 − T 0 (y ∗ )

so that we can write

                                                        T 0 (y ∗ )
            dR (T, h) =1 − Fy (y ∗ ) − ε̃l,1−τ                      y ∗ fy (y ∗ )
                                                     1 − T 0 (y ∗ )
                                                                           ˆ
                                  1                        y ∗ fy (y ∗ )          T 0 (y) − T 0 (y ∗ )
                                 − Ẽl,1−τ (1 + ε̃l,w ) ´                                              yfy (y) dy.
                                  σ                       R+
                                                              yfy (y) dy R+ 1 − T 0 (y ∗ )

We can rewrite this more concisely as

                                     1
   dR (T, h) =1 − Fy (y ∗ ) −                  y ∗ fy (y ∗ ) . . .
                                1 − T 0 (y ∗ )
                 "                                                 ˆ                                                   #
                                       1                                                          yf     (y)
                                                                       (T 0 (y) − T 0 (y ∗ )) ´
                                                                                                       y
              × T 0 (y ∗ ) ε̃l,1−τ + Ẽl,1−τ (1 + ε̃l,w )                                                            dy .
                                       σ                            R+                         R+
                                                                                                  y 0 fy (y 0 ) dy 0

Finally, the integral in the last expression can be easily calculated since the tax schedule is CRP.
We have
                           ˆ                                                                     ˆ             −p
             1                     T 0 (y) − T 0 (y ∗ )                    1                              (y ∗ )        − y −p
      ´                                                 yfy (y) dy = ´                                                  −p       yfy (y) dy
        R+
           yfy (y) dy        R+       1 − T 0 (y ∗ )                  R+
                                                                         yfy (y) dy              R+            (y ∗ )
                           "ˆ                                   ˆ                        #           ´         1−p
                                                                                                               y
           1                                                                                                   y∗            dFy (y)
    =´                                                    ∗ p               1−p                          R+
                                      yfy (y) dy − (y )                 y         fy (y) dy = 1 −        ´             
      R+
         yfy (y) dy              R+                                R+                                              y
                                                                                                                            dFy (y)
                                                                                                          R+       y∗
           ´       1−τ 1−p
                   1−p y                                  ´
                  1−τ   ∗ 1−p
                                  fy (y) dy                      (c (y) /c (y ∗ )) fy (y) dy
                  1−p (y )
             R+
    =1 −          ´       y                      =1−
                                                              R+
                                                                ´                            ,
                            f
                      R+ y ∗ y
                                 (y) dy                          R+
                                                                     (y/y ∗ ) fy (y) dy

where c ≡ c (y) and c∗ ≡ c (y ∗ ) are the consumptions (disposable incomes) of types θ and θ∗
respectively. Therefore

                                                            T 0 (y ∗ )
                           dR (T, h) =1 − Fy (y ∗ ) −                    ε̃l,1−τ y ∗ fy (y ∗ )
                                                          1 − T 0 (y ∗ )
                                                                                         E [c/c∗ ]
                                                                                                   
                                              1
                                             − Ẽl,1−τ (1 + ε̃l,w ) y ∗ fy (y ∗ ) 1 −                 .
                                              σ                                          E [y/y ∗ ]




                                                                        67
    Finally, we derive the effects of the perturbation on social welfare. We have

      λ−1 dG (T, h)
        ˆ                                ˆ
                                                                                1 − T 0 (y) ˆ
                                                                                                     
                                                           ε̃l,1−τ
     =−      gy (y) I{y≥y∗ } fy (y) dy +             gy (y)          δy∗ (y) +               dl (y, h) yfy (y) dy
         R+                                 R+               ε̃l,w                  ε̃l,w
        ˆ ∞                       ˆ           "                                        #
                                                ε̃l,1−τ         1 − T 0 (y) Ẽl,1−τ
     =−     gy (y) fy (y) dy +        gy (y)               −                             yfy (y) δy∗ (y) dy
         y∗                        R+             ε̃l,w        1 − T 0 (y ∗ ) ε̃l,w
        ˆ                                                                       −1
                   1 − T 0 (y) Ẽl,1−τ Ẽl,w                           dy (θ∗ )
                                                                     
                                                                 ∗
      −     gy (y)                                     γ̄ (y,  y   )                 yfy (y) dy.
         R+        1 − T 0 (y ∗ ) 1 − Ẽl,w /σ ε̃l,w                     dθ

The second and third integrals of this expression are equal to
                     −1 (
          dy (θ∗ )
      
                       ε̃l,1−τ − Ẽl,1−τ
                                           gy (y ∗ ) y ∗ fθ (θ∗ )
            dθ                ε̃l,w
                                                    ˆ                                                      )
                                 Ẽl,1−τ Ẽl,w                     1 − T 0 (y)
                            −                             gy (y)                  γ̄ (y, y ∗ ) yfy (y) dy
                              1 − Ẽl,w /σ ε̃l,w R+                1 − T 0 (y ∗ )
                −1 (                                                ˆ                                                   )
       dy (θ∗ )                                                                      1 − T 0 (y)
     
                                      ∗ 1 ∗         ∗                                                      ∗
   =                   Ẽl,1−τ gy (y ) y fθ (θ ) − Ẽl,1−τ                  gy (y)                 γ̄ (y, y ) yfy (y) dy
         dθ                              σ                             R+           1 − T 0 (y ∗ )
                           −1 ˆ
                  dy (θ∗ )                    1 − T 0 (y)
                
   = − Ẽl,1−τ                         gy (y)         0 (y ∗ )
                                                               γ (y, y ∗ ) yfy (y) dy.
                    dθ            R+          1 −   T

Using the fact that γ̄ (y, y ∗ ) depends only on y ∗ and equation (64), we obtain another way of writing
these terms:
                                                                   −1                  ˆ
                                                        dy (θ∗ )                                      1 − T 0 (y)
                                                    
               1
        Ẽl,1−τ gy (y ∗ ) y ∗ fy (y ∗ ) − Ẽl,1−τ                        γ̄ (y, y ∗ )        gy (y)                  yfy (y) dy
               σ                                          dθ                            R+            1 − T 0 (y ∗ )
                                                             ˆ
               1                           1 y ∗ fy (y ∗ )                  1 − T 0 (y)
                     ∗    ∗     ∗
      =Ẽl,1−τ gy (y ) y fy (y ) − Ẽl,1−τ  ´                     gy (y)                  yfy (y) dy
               σ                           σ R+ yfy (y) dy R+              1 − T 0 (y ∗ )
                                       ˆ 
        Ẽl,1−τ y ∗ fy (y ∗ )                  (1 − T 0 (y)) gy (y)
                                                                         
      =        ´                    ∗
                               gy (y )     1−                              yfy (y) dy.
           σ     R+
                    yfy (y) dy          R+    (1 − T 0 (y ∗ )) gy (y ∗ )

Therefore,

  λ−1 dG (T, h)
    ˆ ∞                                        −1 ˆ
                                      dy (θ∗ )                 1 − T 0 (y)
                                    
 =−      gy (y) fy (y) dy − Ẽl,1−τ                     gy (y)                γ (y, y ∗ ) yfy (y) dy
      y∗                                 dθ         R+         1 − T 0 (y ∗ )
    ˆ ∞                                                     ˆ 
                            Ẽl,1−τ y ∗ fy (y ∗ )                        (1 − T 0 (y)) gy (y)
                                                                                                   
 =−      gy (y) fy (y) dy +         ´                    ∗
                                                    gy (y )       1−                                 yfy (y) dy.
      y∗                        σ     R+
                                         yfy (y) dy          R+         (1 − T 0 (y ∗ )) gy (y ∗ )

Finally, the effect of the perturbation on social welfare is given by

                                     dW (T, h) = dR (T, h) + λ−1 dG (T, h) .



                                                              68
We thus obtain
                              ∞   ˆ
                            ∗                         T 0 (y ∗ )                                       1
dW (T, h) =1 − Fy (y ) −        g (y) fy (y) dy −           0    ∗
                                                                    ε̃l,1−τ y ∗ fy (y ∗ ) −                      y ∗ fy (y ∗ ) . . .
                             y∗                     1 − T (y )                                  1 − T 0 (y ∗ )
              "                        ˆ
                1                                                        yfy (y)
           ×      Ẽl,1−τ (1 + ε̃l,w )     (T 0 (y) − T 0 (y ∗ )) ´                         dy . . .
                σ                       R+                          R+
                                                                         y 0 fy (y 0 ) dy 0
                           ˆ                                                                                           #
                 1                                                                                yfy (y)
              + Ẽl,1−τ         ((1 − T (y)) gy (y) − (1 − T (y )) gy (y )) ´
                                         0                         0     ∗            ∗
                                                                                                                    dy .
                 σ          R+                                                               R+
                                                                                                 y 0 fy (y 0 ) dy 0

Reorganizing the terms easily leads to formula (32).




B.3.6       Proof of Proposition 3
Suppose that the production function is Translog, as defined in Example 2, with the functional form
specification (19).

Proof. A Taylor expansion of the right hand side of (19) as θ → θ0 writes
                                              N                     n
                            1          2
                                                 X   1      1          2                  2N +1
   β̄ (θ, θ0 ) =α 1 − exp − 2 (θ − θ0 )     = −α          − 2 (θ − θ0 )     + o (θ − θ0 )       .
                           2s                    n=1
                                                     n!    2s

                                                       2N +1
Ignoring for now the error term o (θ − θ0 )                    and denoting by β̄N (θ, θ0 ) the first N terms of the
Taylor expansion, we get

                                                                      N       n+1
                                 1                               α X (−1)                                   2n
       γ̄N (θ, θ0 ) =χ (θ0 ) +       β̄N (θ, θ0 ) = χ (θ0 ) +                       ((θ − µθ ) − (θ0 − µθ ))
                               χ (θ)                           χ (θ) n=1 2n s2n n!
                                       N
                                                     ( 2n            !                           )
                                                 n+1    X 2n
                                 α    X   (−1)                                  k          2n−k
                    =χ (θ0 ) +                                         (θ − µθ ) (θ0 − µθ )
                               χ (θ) n=1 2n s2n n!               k
                                                        k=0
                                      2N          N
                                                                             !
                                                                 n+1
                         0       α    X          X          (−1)         2n              k           2n−k
                    =χ (θ ) +                                n s2n n!
                                                                                (θ − µθ ) (θ0 − µθ )
                               χ (θ)                        2             k
                                      k=0 n=max{1,d k e}
                                                      2

                                         2N
                           0    α X                   k
                    =χ (θ ) +       Ak (θ0 ) (θ − µθ ) ,
                              χ (θ)
                                         k=0

               ´∞
where µθ =      0
                    θfθ (θ) dθ and

                                                N
                                                                                !
                                                                  n+1
                                   0
                                                X           (−1)           2n                    2n−k
                            Ak (θ ) ≡                                               (θ0 − µθ )          .
                                                            2n s2n n!       k
                                         n=max{1,d k
                                                   2 e}



We therefore obtain that γ̄N (θ, θ0 ), and hence the approximate kernel K1 (θ, θ0 ) = Ẽl,w (θ) γ̄N (θ, θ0 )
of the integral equation (21), can be written as the sum of multiplicatively separable functions, which


                                                               69
allows us to derive a simple closed-form solution for dˆl (θ, h) at an arbitrary degree of precision.
                   h0 (y)
Letting ĥ0 (y) ≡ 1−T  0 (y) , we can write the approximate solution to the integral equation (21) as



                                                          ˆ (2N
                                                              X +1
                                                                                                     )
           dˆlN (θ, h) = − Ẽl,1−τ (θ) ĥ0 (y (θ)) +                       κi,1 (θ) κi,2 (θ ) dˆlN (θ0 , h) dθ0 ,
                                                                                                 0
                                                                                                                    (68)
                                                            Θ       i=0


where
                                       κ0,1 (θ) = Ẽl,w (θ) , κ0,2 (θ0 ) = χ (θ0 ) ,

and for all i ∈ {1, . . . , 2N + 1},

                                          Ẽl,w (θ)          i−1
                             κi,1 (θ) =             (θ − µθ )    , κi,2 (θ0 ) = Ai−1 (θ0 ) .
                                            χ (θ)

This equation can thus be rewritten as

                                                                                   2N
                                                                                    X +1
                             dˆlN (θ, h) = − Ẽl,1−τ (θ) ĥ0 (y (θ)) +                     ai κi,1 (θ) ,
                                                                                   i=0


where the constants (ai )i≥0 are given by
                                                   ˆ
                                            ai =       κi,2 (θ0 ) dˆl (θ0 , h) dθ0 .
                                                   Θ

We thus obtain immediately that the solution to (21) is of the form
                                                                       "   N
                                                                                              #
                                                                      1   X                 n
           dˆlN (θ, h) = − Ẽl,1−τ (θ) ĥ0 (y (θ)) + Ẽl,w (θ) a0 +           an+1 (θ − µθ ) .
                                                                    χ (θ) n=0

To characterize the constants (ai )i≥0 in closed form, integrate over Θ both sides of (68) evaluated
at θ0 and multiplied by κi,2 (θ0 ):
                        ˆ                                       ˆ
                 ai =        κi,2 (θ0 ) dˆlN (θ0 , h) dθ0 = −      κi,2    (θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (y (θ0 )) dθ0
                         Θ                                       Θ
                                                                2N
                                                                 X +1          ˆ
                                                            +             aj        κj,1 (θ0 ) κi,2 (θ0 ) dθ0 ,
                                                                 j=0           Θ


so that the vector a = (ai )0≤i≤2N +1 is the solution to the linear system

                                                 [I2N +2 − A] a =h,

where I2N +2 is the (2N + 2) × (2N + 2)-identity matrix, and the matrix A = (Ai,j )0≤i,j≤2N +1 and




                                                             70
the vector h = (hi )0≤i≤2N +1 are given by:
                                                ˆ
                                    Ai,j =           κj,1 (θ) κi,2 (θ) dθ,
                                                ˆΘ
                                        hi =         κi,2 (θ) Ẽl,1−τ (θ) ĥ0 (y (θ)) dθ.
                                                 Θ

We assume that the determinant det (I2N +2 − A) 6= 0, so that this system can be inverted. The
                           −1
inverse matrix [I2N +2 − A]   can be expressed as the transpose of the matrix of cofactors from
[I2N +2 − A], which we denote by C, normalized by the Fredholm determinant det (I2N +2 − A).
Thus we have
                                                    2N +1
                                            1        X
                               ai =                       Cj,i hj ,
                                    det (I2N +2 − A) j=0

so that the solution to the integral equation writes
                                                                                                      
                                                     2N +1                             2N +1
                                                      X                    1            X
    dˆlN (θ, h) = − Ẽl,1−τ (θ) ĥ0 (y (θ)) +                                                  Cj,i hj  κi,1 (θ)
                                                     i=0
                                                                 det (I2N +2 − A)         j=0
                                    0
               = − Ẽl,1−τ (θ) ĥ (y (θ))
                   ˆ
                                                                               
                                            2N +1 2N +1
                                  1          X     X
                 +                                     Cj,i κi,1 (θ) κj,2 (θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (y (θ0 )) dθ0 ,
                     Θ   det (I 2N +2 −  A)  i=0 j=0


or, denoting by RN (θ, θ0 ) the term in square brackets in the previous equation, or the resolvent
kernel of the integral equation,
                                                                 ˆ
             dˆlN (θ, h) = − Ẽl,1−τ (θ) ĥ0 (y (θ)) +                 RN (θ, θ0 ) Ẽl,1−τ (θ0 ) ĥ0 (y (θ0 )) dθ0 .
                                                                   Θ

Finally, we can show that

                             2N
                              X +1 2N
                                    X +1
                                               Cj,i κi,1 (θ) κj,2 (θ0 ) = − det (D (θ, θ0 ))
                              i=0       j=0


with D1,1 (θ, θ0 ) = 0, Di,1 (θ, θ0 ) = κi−2,2 (θ0 ) for i ≥ 2, D1,j (θ, θ0 ) = κj−2,1 (θ0 ) for j ≥ 2, and
(Di,j (θ, θ0 ))2≤i,j≤2N +3 = I2N +2 − A, so that

                                                                     det (D (θ, θ0 ))
                                              RN (θ, θ0 ) = −                         .
                                                                      det (I2 − A)

This proves the first Fredholm theorem with a separable kernel.
     We now compute a bound on the error in the approximation of the true solution dˆl (θ, h) by
dˆlN (θ, h). We have
                                                                       2N +1
                                                            α |θ − θ0 |
                          |γ̄ (θ, θ0 ) − γ̄N (θ, θ0 )| ≤ N +1 2(N +1)            ,
                                                        2    s          (N + 1)!



                                                                  71
which implies, denoting K1,N (θ, θ0 ) = Ẽl,w (θ) γ̄N (θ, θ0 ),
               ˆ                                                ˆ                                2N +1
                                                                                        α |θ − θ0 |
                     |K1 (θ, θ0 ) − K1,N (θ, θ0 )| dθ0 ≤               Ẽl,w (θ)     N +1
                                                                                                            dθ0
                 Θ                                               Θ                 2      s2(N +1) (N + 1)!
                                                                            2(N +1)
                                                                α θ̄ − θ               supΘ Ẽl,w (θ)
                                                           ≤                                             ≡ εN ,
                                                                       2N +1 s2(N +1) (N + 1)!

which converges to zero as N → ∞. Assume that εN (1 + MN ) < 1, where
                                                            ˆ
                                             MN = sup               |RN (θ, θ0 )| dθ0 .
                                                     θ∈Θ    Θ


We then have (see Theorem 2.6.1 in Zemyan (2012) and Section 13.14 in Polyanin and Manzhirov
(2008)):
                                                       2
                                              (1 + MN ) supΘ Ẽl,1−τ (θ) ĥ0 (y (θ))
                dˆl (θ, h) − dˆlN (θ, h) ≤ εN                                        .
                                                       1 − εN (1 + MN )

     Now consider the approximation of dˆl (θ, h) obtained from the third-order Taylor expansion of
β̄ (θ, θ0 ):
                                                        "        2
                                                                                     #
                                                            1   X                  n
  dˆl (θ, h) ≈ − Ẽl,1−τ (θ) ĥ (y (θ)) + Ẽl,w (θ) a0 +
                                0
                                                                    an+1 (θ − µθ )
                                                          χ (θ) n=0
                                                                                                  
                               0                           a1       a3              2   a2
             = − Ẽl,1−τ (θ) ĥ (y (θ)) + Ẽl,w (θ) a0 +        +         (θ − µθ ) +      (θ − µθ )
                                                          χ (θ) χ (θ)                   a3
                                                    "                                                  2 #
                                                                         2
                                                                                     
                                                            1           a        a  3               a2
             = − Ẽl,1−τ (θ) ĥ0 (y (θ)) + Ẽl,w (θ) a0 +         a1 − 2 +               θ − µθ +           .
                                                          χ (θ)        4a3      χ (θ)             2a3

                                                                                                        0   2
                      a2                                                                          α (θ−θ )
Letting θ̃ = µθ −    2a3   and recalling the approximation γ̄ (θ, θ0 ) = χ (θ0 ) +               2s2 χ(θ)       , we get

     dˆl (θ, h) ≈ − Ẽl,1−τ (θ) ĥ0 (y (θ)) + Ẽl,w (θ) × . . .
                         2s2 a3                         a22        2s2
                                                                                                 2 
                                             1                                          α 1 
                   a0 −         χ θ̃ +              a1 −          +      a3 χ θ̃ + 2            θ − θ̃
                           α               χ (θ)          4a3         α                2s χ (θ)
                                                                                   
                                                                  c2           
                = − Ẽl,1−τ (θ) ĥ0 (y (θ)) + Ẽl,w (θ) c1 +           + c3 γ̄ θ, θ̃ ,
                                                                 χ (θ)

which proves equation (33).
   We can obtain (33) by computing the second-order approximation directly. We find

                                        1                  2          1                          2
                       β̄ (θ, θ0 ) ≈      2
                                            α (θ) (θ − µθ ) α (θ0 ) + 2 α (θ) α (θ0 ) (θ0 − µθ )
                                       4s                            4s
                                            1
                                       − 2 α (θ) (θ − µθ ) α (θ ) (θ0 − µθ ) ,
                                                                   0
                                           2s




                                                                72
so that
                                                        ˆ (X
                                                           4
                                                                                        )
            dˆl (θ, h) ≈ − Ẽl,1−τ (θ) ĥ0 (y (θ)) +                 κi,1 (θ) κi,2 (θ0 ) dˆl (θ0 , h) dθ0 ,
                                                        Θ      i=1

with
                                     κ1,1 (θ) =Ẽl,w (θ)
                                                         α (θ)
                                     κ2,1 (θ) =Ẽl,w (θ)
                                                         χ (θ)
                                                         α (θ)
                                     κ3,1 (θ) =Ẽl,w (θ)       (θ − µθ )
                                                         χ (θ)
                                                         α (θ)           2
                                     κ4,1 (θ) =Ẽl,w (θ)       (θ − µθ ) ,
                                                         χ (θ)
and
                                         κ1,2 (θ0 ) =χ (θ0 )
                                                      α (θ0 ) 0        2
                                         κ2,2 (θ0 ) =         (θ − µθ )
                                                       4s2
                                                         α (θ0 ) 0
                                         κ3,2 (θ0 ) = −          (θ − µθ )
                                                          2s2
                                                          0
                                                      α (θ )
                                         κ4,2 (θ0 ) =        .
                                                       4s2
Thus
                                                                         4
                                                                         X
                            dˆl (θ, h) = − Ẽl,1−τ (θ) ĥ0 (y (θ)) +           ai κi,1 (θ) ,
                                                                         i=1

with                                        ´
                                                κ (θ) Ẽl,1−τ (θ) ĥ0 (y (θ)) dθ
                                                                                              
                       a1                      Θ 1,2
                                             ´
                      a2                 
                                        −1     κ2,2 (θ) Ẽl,1−τ (θ) ĥ0 (y (θ)) dθ             
                             = [I4 − A]  ´Θ                                                   ,
                                                                                              
                                            Θ κ3,2 (θ) Ẽl,1−τ (θ) ĥ0 (y (θ)) dθ
                  
                       a3
                                             ´
                                                                                              
                       a4                       κ (θ) Ẽl,1−τ (θ) ĥ0 (y (θ)) dθ
                                              Θ 4,2

where the 4 × 4 matrix A is defined by
                                                ˆ
                                       Ai,j =        κj,1 (θ) κi,2 (θ) dθ.
                                                 Θ

We can finally write
                                                                                                
  ˆ                          0                         α (θ)                                  2
 dl (θ, h) ≈ − Ẽl,1−τ (θ) ĥ (y (θ)) + Ẽl,w (θ) a1 +         a2 + a3 (θ − µθ ) + a4 (θ − µθ )
                                                       χ (θ)
                                                                                                    
                             0                         α (θ)         α (θ)            2   a3
           = − Ẽl,1−τ (θ) ĥ (y (θ)) + Ẽl,w (θ) a1 +       a2 + a4         (θ − µθ ) +     (θ − µθ ) .
                                                       χ (θ)         χ (θ)                a4




                                                        73
The term in square brackets can be rewritten as
                                                    2          2 !
                α (θ)         α (θ)               a3           a3
           a1 +       a2 + a4          θ − µθ +            −
                χ (θ)         χ (θ)              2a4          2a4
                          2
                           
                         a    α (θ)      α (θ)         2
          =a1 + a2 − 3              + a4        θ − θ̃
                        4a4 χ (θ)        χ (θ)
                                      a2 α (θ)
                                                                                   2 
                                                                       α (θ) 
          = a1 − 2s2 a4 χ θ̃ + a2 − 3                  + 2s2 a4 χ θ̃ + 2        θ − θ̃      ,
                                         4a4 χ (θ)                     2s χ (θ)

so that                                                                                 
                                                                           α (θ)
                dˆl (θ, h) ≈ − Ẽl,1−τ (θ) ĥ0 (y (θ)) + Ẽl,w (θ) c1 + c2       + c3 γ̄ θ, θ̃ ,
                                                                           χ (θ)
where
                                                               a3
                                                   θ̃ =µθ −       ,
                                                              2a4
                                                                   
                                                 c1 =a1 − 2s2 a4 χ θ̃ ,
                                                               a23
                                                 c2 =a2 −          ,
                                                              4a4
                                                 c3 =2s2 a4 .
This concludes the proof.




B.4       Proofs of Sections 3 and 4
B.4.1         Proof of Proposition 4
We start by deriving the formula (42) for optimal taxes using mechanism design tools, i.e., by solving
the optimal control problem (37, 38, 40, 41).

Proof. The Lagrangian writes:
          ˆ                                     ˆ                                 
    L=               ˜
          u (V (θ)) fθ (θ)dθ + λ F (L ) −            [V (θ) + v (l(θ))] fθ (θ)dθ
        Θ                                         Θ
         ˆ
                                 ω1 [θ, l(θ)fθ (θ), L ] + [l(θ)fθ0 (θ) + b(θ)fθ (θ)] ω2 [θ, l(θ)fθ (θ), L ]
       −     µ(θ)v 0 (l(θ)) l(θ)                                                                            dθ
                                                             ω [θ, l(θ)fθ (θ), L ]
         ˆΘ                    ˆ                   ˆ
       −     µ0 (θ)V (θ)dθ −      η(θ)b(θ)dθ −         η 0 (θ) l(θ)dθ.
               Θ                       Θ                  Θ

For simplicity of notation we denote

                   ŵ(θ) ≡ω̂ [θ, l(θ)fθ (θ), L ]
                             ω1 [θ, l(θ)fθ (θ), L ] + [l(θ)fθ0 (θ) + b(θ)fθ (θ)] ω2 [θ, l(θ)fθ (θ), L ]          (69)
                         ≡                                                                              .
                                                       ω [θ, l(θ)fθ (θ), L ]




                                                              74
The first-order condition for V (θ) writes:

                                         u0 (V (θ)) f˜θ (θ) − λfθ (θ) − µ0 (θ) = 0.                                       (70)

The first-order conditions for b(θ) writes:

                                                                   ∂ ŵ(θ)
                                          − µ(θ)v 0 (l(θ)) l(θ)            − η(θ) = 0.                                    (71)
                                                                   ∂b(θ)

The first-order conditions for l(θ) is obtained by perturbing L in the Dirac direction δθ and evalu-
                                                           ∂L
ating the Gateaux derivative of L (i.e., heuristically, “ ∂l(θ) ”):

         dL (L , δθ ) =λw(θ)fθ (θ) − λv 0 (l(θ))fθ (θ) − µ(θ)v 00 (l(θ)) l(θ)ŵ(θ) − µ(θ)v 0 (l(θ))ŵ(θ)
                         ˆ
                       −    µ(θ0 )v 0 (l(θ0 ))l(θ0 )dω̂ (θ0 , δθ ) dθ0 − η 0 (θ) = 0,                                     (72)
                                 Θ

                                                       0
where dω̂ (θ0 , δθ ) (or, heuristically, “ ∂∂l(θ)
                                            ŵ(θ )
                                                   ”) is defined as:

                            1
    dω̂ (θ0 , δθ ) ≡ lim      {ω̂ [θ0 , (l (θ0 ) + µδθ (θ0 )) fθ (θ0 ) , L + µδθ ] − ω̂ [θ0 , l (θ0 ) fθ (θ0 ) , L ]} .   (73)
                      µ→0   µ

    Now, note that
                                     ∂ ŵ(θ)   ω2 [θ, l(θ)fθ (θ), L ] fθ (θ)   γ̄¯ (θ, θ)
                                             =                               =            ,
                                     ∂b(θ)        ω(θ, l(θ)fθ (θ), L )             l(θ)
where the second equality comes from the fact that, by definition of the own-wage elasticity,

                                                       ω2 [θ, l(θ)fθ (θ), L ] fθ (θ)
                                        γ̄¯ (θ, θ) =                                 l (θ)                                (74)
                                                                  w (θ)

(intuitively, γ̄¯ =   l ∂w
                      w ∂l ,   keeping L constant). Thus, we can rewrite (71) as:

                                                              γ̄¯ (θ, θ)
                            η(θ) = −µ(θ)v 0 (l(θ)) l(θ)                  = −µ(θ)v 0 (l(θ)) γ̄¯ (θ, θ) ,                   (75)
                                                                  l(θ)

which implies

           η 0 (θ) = − µ0 (θ)v 0 (l(θ)) γ̄¯ (θ, θ) − µ(θ)v 00 (l(θ)) l0 (θ)γ̄¯ (θ, θ) − µ(θ)v 0 (l(θ)) γ̄¯ 0 (θ, θ) .

Using this expression to substitute for η 0 (θ) into (72) yields

              0 =λw(θ)fθ (θ) − λv 0 (l(θ))fθ (θ) − µ(θ)v 00 (l(θ)) l(θ)ŵ(θ) − µ(θ)v 0 (l(θ))ŵ(θ)
                   + µ0 (θ)v 0 (l(θ)) γ̄¯ (θ, θ) + µ(θ)v 00 (l(θ)) b (θ) γ̄¯ (θ, θ) + µ(θ)v 0 (l(θ)) γ̄¯ 0 (θ, θ)
                     ˆ
                                                  ∂ ŵ(θ0 ) 0
                   −     µ(θ0 )v 0 (l(θ0 ))l(θ0 )          dθ .                                                           (76)
                      Θ                            ∂l(θ)




                                                                75
    We now analyze the last line of this equation. From (73), we have

              dω̂ (θ0 , δθ ) =ω̂2 (θ0 , l (θ0 ) fθ (θ0 ) , L ) fθ (θ0 ) δθ (θ0 )
                                          1
                               + lim {ω̂ [θ0 , l (θ0 ) fθ (θ0 ) , L + µδθ ] − ω̂ [θ0 , l (θ0 ) fθ (θ0 ) , L ]}
                                  µ→0 µ

                                    ≡ω̂2 (θ0 , l (θ0 ) fθ (θ0 ) , L ) fθ (θ0 ) δθ (θ0 ) + ω̂3,θ [θ0 , l (θ0 ) fθ (θ0 ) , L ] ,

where we introduce the short-hand notation ω̂3,θ in the last line for simplicity of exposition. Denote
by ω̂13,θ and ω̂23,θ the derivatives of ω̂3,θ with respect to its first and second variables, respectively.
    Now recall the notation (69) and note that

                                                  [fθ (θ) ω12 + fθ0 (θ)ω2 + (l(θ)fθ0 (θ) + b(θ)fθ (θ)) fθ (θ) ω22 ] w(θ)
      ω̂2 (θ, l(θ)fθ (θ) , L )fθ (θ) =
                                                                                 w2 (θ)
                                                     [ω1 + (l(θ)fθ0 (θ) + b(θ)fθ (θ)) ω2 ] fθ (θ) ω2
                                                  −                                                  ,
                                                                         w2 (θ)

so that, using the definition of ŵ(θ) and equation (74),

                                                            fθ0 (θ)
                                                 ω12 +      fθ (θ) ω2   + [l(θ)fθ0 (θ) + b(θ)fθ (θ)] ω22                       ŵ(θ)
    ω̂2 [θ, l(θ)fθ (θ) , L ] fθ (θ) =                                                                              fθ (θ) −          γ̄¯ (θ, θ) .
                                                                             w(θ)                                              l (θ)

Now, we have
                               0
                  γ̄¯ (θ, θ)            {[ω21 + (l(θ)fθ0 (θ) + b(θ)fθ (θ)) ω22 ] fθ (θ) + ω2 fθ0 (θ)} w (θ)
              
                                    =
                     l (θ)                                           w2 (θ)
                                                                  0
                                           ω2 fθ (θ) [ω1 + (l(θ)fθ (θ) + b(θ)fθ (θ)) ω2 ]
                                        −
                                                              w2 (θ)
                                                fθ0 (θ)
                                        ω12 +   fθ (θ) ω2   + [l(θ)fθ0 (θ) + b(θ)fθ (θ)] ω22                         ŵ(θ)
                                    =                                                                   fθ (θ) −           γ̄¯ (θ, θ) .
                                                                  w (θ)                                              l (θ)

Therefore, the previous two equalities imply
                                                                                  0
                                                                     γ̄¯ (θ, θ)            γ̄¯ 0 (θ, θ) l (θ) − γ̄¯ (θ, θ) b (θ)
                                                                 
                    ω̂2 [θ, l(θ)fθ (θ) , L ] fθ (θ) =                                  =                                         .              (77)
                                                                        l (θ)                               l2 (θ)

    Next, from definition (69) we have (omitting the arguments (θ0 , L(θ0 ), L ) on the right hand
side)

            ω̂3,θ [θ0 , l (θ0 ) fθ (θ0 ) , L ]
            ω13,θ + (l(θ0 )fθ0 (θ0 ) + b(θ0 )fθ (θ0 )) ω23,θ   [ω1 + (l(θ0 )fθ0 (θ0 ) + b(θ0 )fθ (θ0 )) ω2 ] ω3,θ
          =                           0
                                                             −                                                                                  (78)
                                w (θ )                                                w2 (θ0 )
            ω13,θ + (l(θ0 )fθ0 (θ0 ) + b(θ0 )fθ (θ0 )) ω23,θ   ŵ (θ0 )
          =                           0
                                                             −          γ̄ (θ0 , θ) ,
                                w (θ )                          l (θ)




                                                                          76
where the second equality follows from the definition of ŵ (θ0 ) and of the cross-wage elasticities

                             l (θ)             1
             γ̄ (θ0 , θ) =           × lim {ω [θ0 , l (θ0 ) fθ (θ0 ) , L + µδθ ] − ω [θ0 , l (θ0 ) fθ (θ0 ) , L ]}
                             w (θ0 ) µ→0 µ
                             l (θ)
                           =         ω3,θ (θ0 , l (θ0 ) fθ (θ0 ) , L ) .
                             w (θ0 )

Note moreover that this equality implies

   ∂γ̄ (θ0 , θ)        ω13,θ (θ0 , l (θ0 ) fθ (θ0 ) , L ) + (l(θ0 )fθ0 (θ0 ) + b(θ0 )fθ (θ0 )) ω23,θ (θ0 , l (θ0 ) fθ (θ0 ) , L )
                =l (θ)
       ∂θ0                                                              w (θ0 )
                          ω3,θ (θ , l (θ ) fθ (θ ) , L )
                                   0       0        0
                  − l (θ)                                   × ...
                                      w2 (θ0 )
                           [ω1 (θ0 , l (θ0 ) fθ (θ0 ) , L ) + (l(θ0 )fθ0 (θ0 ) + b(θ0 )fθ (θ0 )) ω2 (θ0 , l (θ0 ) fθ (θ0 ) , L )]
                           ω13,θ + (l(θ0 )fθ0 (θ0 ) + b(θ0 )fθ (θ0 )) ω23,θ
                  =l (θ)                                                    − ŵ (θ0 ) γ̄ (θ0 , θ) ,
                                               w (θ0 )

and thus, from (78)
                                                                                1 ∂γ̄ (θ0 , θ)
                                       ω̂3,θ [θ0 , l (θ0 ) fθ (θ0 ) , L ] =                    .                                    (79)
                                                                              l (θ) ∂θ0
    Substitute equations (77) and (79) in (76) to get:

   0 =λw(θ)fθ (θ) − λv 0 (l(θ))fθ (θ) − µ(θ)v 00 (l(θ)) l(θ)ŵ(θ) − µ(θ)v 0 (l(θ))ŵ(θ)
         + µ0 (θ)v 0 (l(θ)) γ̄¯ (θ, θ) + µ(θ)v 00 (l(θ)) l0 (θ)γ̄¯ (θ, θ) + µ(θ)v 0 (l(θ)) γ̄¯ 0 (θ, θ)
           ˆ
         −     µ(θ0 )v 0 (l(θ0 ))l(θ0 ) × . . .
              Θ

         {ω̂2 (θ0 , l (θ0 ) fθ (θ0 ) , L ) fθ (θ0 ) δθ (θ0 ) + ω̂3,θ [θ0 , l (θ0 ) fθ (θ0 ) , L ]} dθ0
      =λw(θ)fθ (θ) − λv 0 (l(θ))fθ (θ) − µ(θ)v 00 (l(θ)) l(θ)ŵ(θ) − µ(θ)v 0 (l(θ))ŵ(θ)
         + µ0 (θ)v 0 (l(θ)) γ̄¯ (θ, θ) + µ(θ)v 00 (l(θ)) b (θ) γ̄¯ (θ, θ)
                                                                                 
                               b (θ)
         + µ(θ)v 0 (l(θ))             γ̄¯ (θ, θ) + µ(θ)v 0 (l(θ)) l (θ) ω̂2 fθ (θ)
                                l (θ)
                                                                         ˆ
                                                                                                         1 ∂γ̄ (θ0 , θ) 0
                                                                                                                         
         − µ(θ)v 0 (l(θ))l(θ)ω̂2 (θ, l (θ) fθ (θ) , L ) fθ (θ) +              µ(θ0 )v 0 (l(θ0 ))l(θ0 )                 dθ   ,
                                                                           Θ                           l (θ) ∂θ0

and hence,

            0 =λw(θ)fθ (θ) − λv 0 (l(θ))fθ (θ) − µ(θ)v 00 (l(θ)) l(θ)ŵ(θ) − µ(θ)v 0 (l(θ))ŵ(θ)
                                                                                                     b (θ)
                   + µ0 (θ)v 0 (l(θ)) γ̄¯ (θ, θ) + µ(θ)v 00 (l(θ)) b (θ) γ̄¯ (θ, θ) + µ(θ)v 0 (l(θ))       γ̄¯ (θ, θ)
                                                                                                     l (θ)
                     ˆ
                                            l(θ0 ) ∂γ̄ (θ0 , θ) 0
                   −     µ(θ0 )v 0 (l(θ0 ))                    dθ .                                                                 (80)
                      Θ                     l (θ)      ∂θ0




                                                                  77
Using the definition of the labor supply elasticity (6), we finally obtain

              0 =λw(θ)fθ (θ) − λv 0 (l(θ))fθ (θ) − µ(θ)v 00 (l(θ)) l(θ)ŵ(θ) − µ(θ)v 0 (l(θ))ŵ(θ)
                                                                          
                                                                    1                   b (θ)
                 + µ0 (θ)v 0 (l(θ)) γ̄¯ (θ, θ) + µ(θ) 1 +                    v 0 (l(θ))       γ̄¯ (θ, θ)
                                                                εl,1−τ (θ)              l (θ)
                   ˆ
                                          l(θ0 ) ∂γ̄ (θ0 , θ) 0
                 −     µ(θ0 )v 0 (l(θ0 ))                    dθ .                                                         (81)
                    Θ                     l (θ)      ∂θ0

Moreover, defining the wedge (1 − τ (θ))w(θ) = v 0 (l(θ)) and noting that
                                                                                                     
                                                                                              1
                        v 0 (l(θ)) + v 00 (l(θ)) l(θ) = (1 − τ (θ))w(θ) 1 +                               ,
                                                                                         εl,1−τ (θ)

we can rewrite (81) as
                                                                                                     
                                                                                                1
        0 =λw(θ)fθ (θ) − λ(1 − τ (θ))w(θ)fθ (θ) − µ(θ)(1 − τ (θ))w(θ) 1 +                                  ŵ(θ)
                                                                                           εl,1−τ (θ)
                                                                         
                                                                    1                             b (θ)
           + µ0 (θ)(1 − τ (θ))w(θ)γ̄¯ (θ, θ) + µ(θ) 1 +                      (1 − τ (θ))w(θ)            γ̄¯ (θ, θ)
                                                               εl,1−τ (θ)                         l (θ)
                    ˆ
                 1                               ∂γ̄ (θ0 , θ) 0
           −           µ(θ0 )(1 − τ (θ0 ))y(θ0 )             dθ
               l (θ) Θ                               ∂θ0
                                                                           0                              
                                                                     1           l (θ)
          =λτ (θ)w(θ)fθ (θ) + µ(θ)(1 − τ (θ))w(θ) 1 +                                  γ̄¯ (θ, θ) − ŵ(θ)
                                                                εl,1−τ (θ)       l (θ)
                                                        ˆ
                                                   1                                   ∂γ̄ (θ0 , θ) 0
           + µ0 (θ)(1 − τ (θ))w(θ)γ̄¯ (θ, θ) −               µ(θ0 )(1 − τ (θ0 ))y(θ0 )              dθ .
                                                 l (θ) Θ                                    ∂θ0

                                 w0 (θ)
Using the fact that ŵ(θ) =      w(θ)     and dividing through by λ(1 − τ (θ))w(θ)fθ (θ) yields
                                                     0
                                                                           w0 (θ)
                                                                                 
              τ (θ)         µ(θ)             1          l (θ)
         0=            +             1+                       γ̄¯ (θ, θ) −
            1 − τ (θ) λfθ (θ)            εl,1−τ (θ)     l (θ)              w(θ)
                                                            ˆ
                µ0 (θ)                        1                                            ∂γ̄ (θ0 , θ) 0
            +          γ̄¯ (θ, θ) −                              µ(θ0 )(1 − τ (θ0 ))y(θ0 )             dθ ,
               λfθ (θ)              λ(1 − τ (θ))y(θ)fθ (θ) Θ                                   ∂θ0

and hence, using the relationship between the densities of productivities and wages:

                                                                         l0 (θ)
                                                                               
                                                                                       µ0 (θ)
                                  
           τ (θ)             1             µ(θ)        1 − γ̄¯ (θ, θ) l(θ)
                   = 1+                                                 w0 (θ)
                                                                                  −          γ̄¯ (θ, θ)
         1 − τ (θ)       εl,1−τ (θ) λw(θ)fw (w(θ))                                    λfθ (θ)
                                                                        w(θ)                                              (82)
                                            ˆ
                                 1                                        ∂γ̄ (θ0 , θ) 0
                    +                           µ(θ0 )(1 − τ (θ0 ))y(θ0 )             dθ .
                      λ(1 − τ (θ))y(θ)fθ (θ) Θ                                 ∂θ0

                                                      ∂ γ̄ (θ 0 ,θ )
Note that for a CES production function, we have ∂θ0 = 0.
    Finally, an alternative optimal tax formula is given by integrating the previous equation by parts
(with the appropriate boundary conditions on µ (θ0 )):
         ˆ                                                     ˆ
                                          ∂γ̄ (θ0 , θ) 0                           d
              µ(θ0 )(1 − τ (θ0 ))y(θ0 )               dθ = −        γ̄ (θ0 , θ)       [µ(θ0 )(1 − τ (θ0 ))y(θ0 )] dθ0 .
          Θ                                   ∂θ0               Θ                 dθ0

                                                           78
We therefore obtain
                                                                                       l0 (θ)
                                                                                               
                                                 
              τ (θ)                      1         µ(θ)          1 − γ̄¯ (θ, θ)        l(θ)
                        = 1+                                                               
                                                                                       w0 (θ)
            1 − τ (θ)                εl,1−τ (θ)λw(θ)fw (w(θ))
                                                                                       w(θ)
                                                ´                       0
                            µ0 (θ)                 [µ(x)v 0 (l(x))l(x)] γ̄ (x, θ) dx
                         −          γ̄¯ (θ, θ) − Θ
                           λfθ (θ)                     λ(1 − τ (θ))y(θ)fθ (θ)
                                                                                    l0 (θ)
                                                                                          
                                            
                                    1              µ(θ)          1 − γ̄¯ (θ, θ) 0  l(θ)
                        = 1+                                                       w (θ)
                                εl,1−τ (θ) λw(θ)fw (w(θ))
                                                                                   w(θ)
                           ´             0          0
                               [µ(x)v (l(x))l(x)] γ (x, θ) dx          0
                                                                      µ (θ)
                         − Θ                                      −           γ̄¯ (θ, θ)
                                   λ(1 − τ (θ))y(θ)fθ (θ)            λfθ (θ)
                           [µ0 (θ)v 0 (l(θ))l(θ) + µ(θ)v 00 (l(θ))l(θ) + µ(θ)v 0 (l(θ))l0 (θ)] γ̄¯ (θ, θ)
                         +                                                                                ,
                                                      λ(1 − τ (θ))y(θ)fθ (θ)

where the second equality uses the definition (11) of γ (x, θ). This implies
                                                            ´                      0
                                                               [µ(x)v 0 (l(x))l(x)] γ (x, θ) dx
                                    
          τ (θ)                 1              µ(θ)
                  = 1+                                  − Θ
        1 − τ (θ)          εl,1−τ (θ) λw(θ)fw (w(θ))              λ(1 − τ (θ))y(θ)fθ (θ)
                                (
                                        00                      0
                                                                          µ0 (θ)
                                                     
                                       v (l(θ))l(θ)     µ(θ) l (θ)
                   − γ̄¯ (θ, θ)     1+                               +           − ...
                                          v 0 (l(θ))   λfθ (θ) l (θ)     λfθ (θ)
                                                                                                                 )
                                         µ0 (θ)v 0 (l(θ))l(θ) + µ(θ)v 00 (l(θ))l0 (θ)l(θ) + µ(θ)v 0 (l(θ))l0 (θ)
                                                                                                                  .
                                                                 λv 0 (l(θ))l(θ)fθ (θ)

The terms in the curly brackets in the second and third lines cancel each other out, therefore
                                                     ´                      0
                                                        [µ(x)v 0 (l(x))l(x)] γ (x, θ) dx
                                   
             τ (θ)            1          µ(θ)
                     = 1+                           − Θ                                  .
           1 − τ (θ)      εl,1−τ (θ) λw(θ)fw (w(θ))       λ(1 − τ (θ))y(θ)fθ (θ)

Note finally that the first-order condition (70) implies

                                           µ0 (θ) = u0 (V (θ)) f˜θ (θ) − λfθ (θ),

so that, using µ(θ̄) = 0,
                            ˆ   θ̄   h                      i
               µ(θ) = −       u0 (V (x)) f˜θ (x) − λfθ (x) dx
                          θ
                       ˆ θ̄ "                        #              ˆ θ̄
                                  u0 (V (x)) f˜θ (x)
                    =λ        1−                       fθ (x)dx = λ      (1 − gθ (x)) fθ (x)dx.
                        θ              λfθ (x)                       θ


This concludes the proof.



    We now derive optimal taxes using the variational tools introduced in Section 2, i.e., we tackle
problem (34, 35, 36) directly. We start by deriving the expression (48) for the counteracting pertur-


                                                             79
bation h2 .


B.4.2        Proof of equation (48)
Proof. Consider the perturbation h1 defined by h1 (y) = I{y≥y∗ } and h01 (y) = δy∗ (y). As usual,
denote by θ∗ the type such that y (θ∗ ) = y ∗ . We impose that h1 + h2 has the same effects on
labor supply as those that h1 induces in the partial equilibrium framework. The general equilibrium
response to h1 + h2 is given by the solution to the following integral equation: for all θ ∈ Θ,

                                                                             h01 (y (θ)) + h02 (y (θ))
                                                                                                         
                                                    ε̃l,1−τ (θ)
                    dˆl (θ, h1 + h2 ) = −
                                              1 − γ̄¯ (θ, θ) ε̃l,w (θ)            1 − T 0 (y (θ))
                                                                         ˆ                                                   (83)
                                                      ε̃l,w (θ)
                                          +                                   γ̄ (θ, θ0 ) dˆl (θ0 , h1 + h2 ) dθ0 .
                                              1 − γ̄¯ (θ, θ) ε̃l,w (θ)   Θ

The partial equilibrium effect of h1 , on the other hand, is given by: for all θ ∈ Θ,

                                                 h01 (y (θ))
                                                              
                  dˆlP E (θ, h1 ) = − ε̃l,1−τ (θ)
                                               1 − T 0 (y (θ))
                                                                                                                             (84)
                                                      εl,1−τ (θ∗ )
                                 =−                                                      δy∗ (y (θ)) .
                                    1 − T (y (θ )) + εl,1−τ (θ∗ ) y (θ∗ ) T 00 (y (θ∗ ))
                                         0     ∗


In particular, note that in partial equilibrium, we have dˆlP E (θ, h1 ) = 0 for all θ 6= θ∗ , i.e., the only
individuals who respond to a change in the marginal tax rate at income y ∗ are those whose type is
θ∗ (and hence whose income is y ∗ ). Substituting for (84) in the left hand side and under the integral
sign of (83) yields:

            ε̃l,1−τ (θ)                            1              ε̃l,1−τ (θ)
      −                   δy∗ (y (θ)) = −                                             {δy∗ (y (θ)) + h02 (y (θ))}
          1 − T 0 (y (θ))                 1 − T 0 (y (θ)) 1 − γ̄¯ (θ, θ) ε̃l,w (θ)
                                                                   ˆ
                                                  ε̃l,w (θ)                           ε̃l,1−τ (θ0 )
                                        −                               γ̄ (θ, θ0 )                   δy∗ (y (θ0 )) dθ0 ,
                                          1 − γ̄¯ (θ, θ) ε̃l,w (θ) Θ                1 − T 0 (y (θ0 ))

i.e., after changing variables in the integral in the second line of the previous expression,

                              h02 (y (θ))
                                                                                        
         ε̃l,1−τ (θ)                                                   ε̃l,1−τ (θ)            δy∗ (y (θ))
                                            =   ε̃l,1−τ  (θ)   −
   1 − γ̄¯ (θ, θ) ε̃l,w (θ) 1 − T 0 (y (θ))                      1 − γ̄¯ (θ, θ) ε̃l,w (θ) 1 − T 0 (y (θ))
                                                                                        −1
                                                                              dy (θ∗ )                    ε̃l,1−τ (θ∗ )
                                                                            
                                                          ε̃l,w (θ)
                                              −                                             γ̄ (θ, θ∗ )                   .
                                                  1 − γ̄¯ (θ, θ) ε̃l,w (θ)       dθ                     1 − T 0 (y (θ∗ ))

This implies

                   h02 (y (θ))                              δy∗ (y (θ))
                                 = − γ̄¯ (θ, θ) ε̃l,w (θ)
                 1 − T 0 (y (θ))                          1 − T 0 (y (θ))
                                                                                                       −1
                                                        ε̃l,w (θ) ε̃l,1−τ (θ∗ )             dy (θ∗ )
                                                                                        
                                                1
                                     −        0     ∗
                                                                                                             γ̄ (θ, θ∗ ) ,
                                         1 − T (y (θ ))       ε̃l,1−τ (θ)                     dθ




                                                               80
which can be rewritten as
                                                                 "                                                −1             #
   h02 (y (θ))                        ε̃l,w (θ) ε̃l,1−τ (θ∗ )                                                 ∗
                                                                                                     
                            1                                                                           dy (θ   )
                 =−                                                 γ̄¯ (θ∗ , θ∗ ) δy∗ (y (θ)) +                      γ̄ (θ, θ∗ )
 1 − T 0 (y (θ))    1 − T 0 (y (θ∗ ))        ε̃l,1−τ (θ)                                                   dθ
                                                                                −1
                                      ε̃l,w (θ) ε̃l,1−τ (θ∗ ) dy (θ∗ )
                                                                 
                            1
                 =−                                                                   [γ̄¯ (θ∗ , θ∗ ) δθ∗ (θ) + γ̄ (θ, θ∗ )]
                    1 − T 0 (y (θ∗ ))        ε̃l,1−τ (θ)                 dθ
                                                                                   −1
                                                                         dy (θ∗ )
                                                                    
                            1           ε̃l,w (θ)               ∗
                 =−                                 ε̃ l,1−τ (θ   )                       γ (θ, θ∗ ) ,
                    1 − T 0 (y (θ∗ )) ε̃l,1−τ (θ)                          dθ

or

                                        (1 − T 0 (y (θ)) − y (θ) T 00 (y (θ))) εl,1−τ (θ)
     h02 (y (θ)) = − (1 − T 0 (y (θ)))
                                         1 − T 0 (y (θ)) + εl,1−τ (θ) y (θ) T 00 (y (θ))
                                                                                                   −1
                     1 − T 0 (y (θ)) + εl,1−τ (θ) y (θ) T 00 (y (θ)) ε̃l,1−τ (θ∗ )        dy (θ∗ )
                                                                                        
                   ×                                                                                   γ (θ, θ∗ )
                               (1 − T 0 (y (θ))) εl,1−τ (θ)           1 − T 0 (y (θ∗ ))     dθ
                                                   −1
                       ε̃l,1−τ (θ∗ )      dy (θ∗ )
                                       
                  =−                                   × (1 − T 0 (y (θ)) − y (θ) T 00 (y (θ))) γ (θ, θ∗ ) .
                     1 − T 0 (y (θ∗ ))      dθ

This proves equation (48). Note that h02 (y (θ)) is a smooth function, except for a jump (formally,
a Dirac term) at θ = θ∗ , which adds to the jump in marginal tax rates defined by the tax reform
h1 at θ∗ so that the total response of labor supply of individuals with income y ∗ is equal to their
response to h1 in the partial equilibrium environment.
    Now, integrate this expression from 0 to y (letting h2 (0) = 0) to get h2 (y):
                                                                           −1 ˆ        y
                              ε̃l,1−τ (θ∗ )                     dy (θ∗ )
                                                            
        h2 (y (θ)) = −                                                                      (1 − T 0 (y 0 ) − y 0 T 00 (y 0 )) γ (y 0 , y ∗ ) dy 0 .
                            1 − T 0 (y (θ∗ ))                     dθ                0

The integral in this expression can be rewritten as
                           ˆ     y
                                                                                                      dy (θ∗ )
                                                                                                                
                                                   0    0         0   00   0            0     ∗
                                     (1 − T (y ) − y T (y )) γ̄¯ (y , y )                                            δy∗ (y) dy 0
                             0                                                                          dθ
                                 ˆ       y
                           +                 (1 − T 0 (y 0 ) − y 0 T 00 (y 0 )) γ̄ (y 0 , y ∗ ) dy 0 ,
                                     0

and hence

                            ε̃l,1−τ (θ∗ )
                                            
      h2 (y (θ)) = −                         (1 − T 0 (y ∗ ) − y ∗ T 00 (y ∗ )) γ̄¯ (y ∗ , y ∗ ) I{y≥y∗ }
                          1 − T 0 (y (θ∗ ))
                                                           −1 ˆ y
                                                 dy (θ∗ )
                                                                                                               
                                                                                   0   0         0 00  0  0 ∗ 0
                                             +                         (1 − T (y ) − y T (y )) γ̄ (y , y ) dy .
                                                   dθ              0


(Note that we could have obtained this expression by integrating over θ ∈ Θ rather than y ∈ R+ ,




                                                                               81
the expression
                                                                               −1
                                   ε̃l,1−τ (θ∗ )                    dy (θ∗ )
                                                                
                  dh2 (y (θ))
                              =−                                          (1 − T 0 (y (θ)) − y (θ) T 00 (y (θ)))
                      dθ         1 − T 0 (y (θ∗ ))                    dθ
                                                                                        
                                                  ∗          ∗   ∗               dy (θ)
                                       × (γ̄ (θ, θ ) + γ̄¯ (θ , θ ) δθ∗ (θ)) ×             ,
                                                                                    dθ

and and using a change of variables in the integral.) This concludes the proof.



        We now derive the effects of the combination of perturbations h1 + h2 on social welfare.


B.4.3           Proof of Proposition 5
Proof. We start by deriving the effect of the perturbation h ≡ h1 + h2 on the tax liability of any
individual θ. We have, to a first order as µ → 0,

 dh T (w (θ) l (θ)) ∼ µ−1 {T (w̃ (θ) (l (θ) + µdl (θ, h))) − T (w (θ) l (θ))} + h1 (w̃ (θ) (l (θ) + µdlθ ))
                   µ→0
                       ˆ                                     
                     =            0   ˆ   0       0   ˆ
                           γ (θ, θ ) dl (θ , h) dθ + dl (θ, h) y (θ) T 0 (y (θ)) + h1 (y (θ)) + µh2 (y (θ)) .
                                   Θ

This can be rewritten as

                                      ε̃l,1−τ (θ∗ )
                                                     ˆ                                                      
        dh T (y (θ)) =I{y(θ)≥y∗ } −                        γ (θ, θ ) δy∗ (y (θ )) dθ + δy∗ (y (θ)) y (θ) T 0 (y (θ))
                                                                  0                0       0
                                      1 − T 0 (y ∗ )    Θ
                            ε̃l,1−τ (θ∗ )
                                            
                       −                      (1 − T 0 (y ∗ ) − y ∗ T 00 (y ∗ )) γ̄¯ (y ∗ , y ∗ ) I{y(θ)≥y∗ }
                         1 − T 0 (y (θ∗ ))
                                                             −1 ˆ y
                                                    dy (θ∗ )
                                                                                                                              
                                              +                         (1 − T 0 (y 0 ) − y 0 T 00 (y 0 )) γ̄ (y 0 , y ∗ ) dy 0 ,
                                                      dθ            0

i.e.,
                                                   T 0 (y (θ))
                  dh T (y (θ)) =I{y(θ)≥y∗ } −                    ε̃l,1−τ (θ∗ ) y (θ) δy∗ (y (θ))
                                                  1 − T 0 (y ∗ )
                                                        (                           −1
                                        ε̃l,1−τ (θ∗ )                   dy (θ∗ )
                                                                      
                                                                    ∗
                                    −                      γ (θ, θ )                        y (θ) T 0 (y (θ)) . . .
                                      1 − T 0 (y (θ∗ ))                    dθ
                                                                                                            dy (θ∗ )
                                                                                                                    
                                        + (1 − T 0 (y ∗ ) − y ∗ T 00 (y ∗ )) γ̄¯ (y ∗ , y ∗ ) I{y(θ)≥y∗ }
                                                                                                                dθ
                                            ˆ      y
                                                                                                    )
                                          +            (1 − T 0 (y 0 ) − y 0 T 00 (y 0 )) γ̄ (y 0 , y ∗ ) dy 0 ,
                                               0




                                                                        82
i.e.,
                                                            T 0 (y (θ))
                         dh T (y (θ)) =I{y(θ)≥y∗ } −                      ε̃l,1−τ (θ∗ ) y (θ) δy∗ (y (θ))
                                                           1 − T 0 (y ∗ )
                                                                                −1 
                                                 ε̃l,1−τ (θ∗ )      dy (θ∗ )
                                                                  
                                             −                                         γ (θ, θ∗ ) y (θ) T 0 (y (θ)) . . .
                                               1 − T 0 (y (θ∗ ))       dθ
                                                     ˆ y                                                  
                                                                 0   0         0 00  0        0 ∗       0
                                                 +       (1 − T (y ) − y T (y )) γ (y , y ) dy .
                                                         0

    Next, we derive the effect of the perturbation h1 + h2 on the aggregate tax liability. We have,
to a first order as µ → 0,
                "ˆ                           #
         dh              T (y) fy (y) dy
                    R+
            ˆ                                                                                                                 −1
                                     T 0 (y)                                                       ε̃l,1−τ (θ∗ )     dy (θ∗ )
                                                                                                                
                                                           ∗
        =            I{y≥y∗ } −                  ε̃l,1−τ (y ) yδy∗ (y) fy (y) dy −                                                ...
             R+                   1 − T 0 (y ∗ )                                                1 − T 0 (y (θ∗ ))      dθ
                ˆ                              ˆ y                                                         
            ×           T 0 (y) γ (y, y ∗ ) y +       (1 − T 0 (y 0 ) − y 0 T 00 (y 0 )) γ (y 0 , y ∗ ) dy 0 fy (y) dy
                  R+                                 0
                                     0   ∗
                              T (y )
        =1 − Fy (y ∗ ) −                  ε̃l,1−τ (y ∗ ) y ∗ fy (y ∗ )
                           1 − T 0 (y ∗ )
                                             −1 ˆ
                ε̃l,1−τ (θ∗ )     dy (θ∗ )
                                
            −                                            T 0 (y) γ (y, y ∗ ) yfy (y) dy
              1 − T 0 (y (θ∗ ))     dθ              R+
                                             −1 ˆ ∞ ˆ ∞
                ε̃l,1−τ (θ∗ )     dy (θ∗ )
                                
            −                                                      (1 − T 0 (y 0 ) − y 0 T 00 (y 0 )) γ (y 0 , y ∗ ) fy (y) dydy 0 ,
              1 − T 0 (y (θ∗ ))     dθ              y 0 =0 y=y 0


where we obtained the expression in the last line by switching the two integrals. Hence we get

                dR (T, h)
                                T 0 (y ∗ )
            =1 − Fy (y ∗ ) −                ε̃l,1−τ (y ∗ ) y ∗ fy (y ∗ )
                             1 − T 0 (y ∗ )
                                                −1 ˆ
                  ε̃l,1−τ (θ∗ )      dy (θ∗ )
                                  
             −                                               T 0 (y) γ (y, y ∗ ) yfy (y) dy
                1 − T 0 (y (θ∗ ))        dθ            R+
                                                −1 ˆ ∞
                  ε̃l,1−τ (θ∗ )      dy (θ∗ )
                                  
             −                                                 (1 − T 0 (y 0 ) − y 0 T 00 (y 0 )) γ (y 0 , y ∗ ) (1 − Fy (y 0 )) dy 0
                1 − T 0 (y (θ∗ ))        dθ            y 0 =0
                                                                                                                  −1
                                T 0 (y ∗ )                                      ε̃l,1−τ (θ∗ )         dy (θ∗ )
                                                                                                   
            =1 − Fy (y ∗ ) −                ε̃ l,1−τ (y ∗
                                                           ) y ∗
                                                                 fy (y ∗
                                                                         ) −                                           ...
                             1 − T 0 (y ∗ )                                  1 − T 0 (y (θ∗ ))             dθ
                ˆ ∞
             ×        {(1 − T 0 (y) − yT 00 (y)) (1 − Fy (y)) + T 0 (y) yfy (y)} γ (y, y ∗ ) dy.
                     0

But by Euler’s homogeneous function theorem, we have
                                                                            −1 ˆ     ∞
                                       ε̃l,1−τ (θ∗ )             dy (θ∗ )
                                                             
                                 −                                                        γ (y, y ∗ ) yfy (y) dy = 0,
                                     1 − T 0 (y (θ∗ ))             dθ             0




                                                                             83
so that substracting this (zero) term from the previous equation, we can write
                                                                                                           −1
                                 T 0 (y ∗ )                                     ε̃l,1−τ (θ∗ )     dy (θ∗ )
                                                                                                
    dR (T, h) =1 − Fy (y ∗ ) −                ε̃ l,1−τ (y ∗
                                                            ) y ∗
                                                                  fy (y ∗
                                                                          ) −                                  ...
                               1 − T 0 (y ∗ )                                 1 − T 0 (y (θ∗ ))     dθ
                  ˆ ∞
               ×       {(1 − T 0 (y) − yT 00 (y)) (1 − Fy (y)) − (1 − T 0 (y)) yfy (y)} γ (y, y ∗ ) dy.
                        0

Now note that

                                                                                                                 0
      (1 − T 0 (y) − yT 00 (y)) (1 − Fy (y)) − (1 − T 0 (y)) yfy (y) = [(1 − T 0 (y)) y (1 − Fy (y))] ,

so that we finally obtain

                                        T 0 (y ∗ )
       dR (T, h) =1 − Fy (y ∗ ) −                   ε̃l,1−τ (y ∗ ) y ∗ fy (y ∗ )
                                     1 − T 0 (y ∗ )
                                                       −1 ˆ
                          ε̃l,1−τ (θ∗ )      dy (θ∗ )
                                          
                                                                                                 0
                      −                                            [(1 − T 0 (y)) y (1 − Fy (y))] γ (y, y ∗ ) dy.
                        1 − T 0 (y (θ∗ ))        dθ           R+


Note that using (11), this equation can also be expressed as

                                                T 0 (y ∗ )
              dR (T, h) =1 − Fy (y ∗ ) −                    ε̃l,1−τ (y ∗ ) y ∗ fy (y ∗ )
                                             1 − T 0 (y ∗ )
                                                  (                             ˆ                      )
                                  ε̃l,1−τ (θ∗ )        0   ∗ ¯     ∗ ∗                  0 γ̄ (y, y ∗ )
                              −                      ψ (y ) γ̄ (y , y ) +            ψ (y) 0 ∗ dy ,
                                1 − T 0 (y (θ∗ ))                                R+        y (θ )

where we denote ψ (y) ≡ (1 − T 0 (y)) y (1 − Fy (y)) and y 0 (θ) ≡ dy(θ)
                                                                    dθ .
    Next, we derive the effect of the perturbation h = h1 + h2 on the utility of any individual θ.
First, the change in individual consumption due to the perturbation is

      dh [y (θ) − T (y (θ))] = dh [y (θ)] − dh [T (y (θ))]
            ε̃l,1−τ (θ∗ )
                           ˆ                                       
     =−                        γ (θ, θ ) δy (y (θ )) dθ + δy (y (θ)) y (θ) (1 − T 0 (y (θ)))
                                      0
                                           ∗
                                                 0     0
                                                            ∗
         1 − T 0 (y (θ∗ ))   Θ

       − h1 (y (θ)) − h2 (y (θ))
                                                                                                               −1
                       1 − T 0 (y (θ))                                         ε̃l,1−τ (θ∗ )          dy (θ∗ )
                                                                                                    
                                                 ∗
     = − I{y(θ)≥y∗ } −                 ε̃l,1−τ (θ ) y (θ) δy∗ (y (θ)) −                                            ...
                        1 − T 0 (y ∗ )                                      1 − T 0 (y (θ∗ ))            dθ
                                              ˆ y                                                       
       × (1 − T 0 (y (θ))) y (θ) γ (θ, θ∗ ) −      (1 − T 0 (y 0 ) − y 0 T 00 (y 0 )) γ (y 0 , y ∗ ) dy 0 ,
                                                     0


where the last equality follows from the same steps as those of the derivation of dh T (y (θ)) above.




                                                           84
Thus the change in individual utility due to the perturbation is

          dh [u (y (θ) − T (y (θ)) − v (l (θ)))]
        = (dh [y (θ)] − dh [T (y (θ))] − v 0 (l (θ)) dh l (θ)) u0 (y (θ) − T (y (θ)) − v (l (θ)))
                             ε̃l,1−τ (θ∗ )
                                                                                                       
                                                    0                           0
        = −I{y(θ)≥y∗ } −                    [(1 − T   (y (θ))) y (θ)  − l (θ) v   (l (θ))] δ y ∗ (y (θ))   u0 (θ)
                             1 − T 0 (y ∗ )
                                      −1
             ε̃l,1−τ (θ∗ ) dy (θ∗ )
                                                 
          −                                 u (θ) (1 − T 0 (y (θ))) y (θ) γ (θ, θ∗ ) . . .
                                              0
            1 − T 0 (y ∗ )      dθ
                                                    ˆ y                                                   
                                                                 0   0      0 00     0         0 ∗      0
                                                 −       (1 − T (y ) − y T (y )) γ (y , y ) dy .
                                                           0


Using the individual first-order condition (1), this can be rewritten as

         dh [u (y (θ) − T (y (θ)) − v (l (θ)))]
                                                         −1
                                  ε̃l,1−τ (θ∗ ) dy (θ∗ )
                                                
        = − u0 (θ) I{y(θ)≥y∗ } −                                × ...
                                 1 − T 0 (y ∗ )     dθ
                                               ˆ y                                                       
           (1 − T 0 (y (θ))) y (θ) γ (θ, θ∗ ) −     (1 − T 0 (y 0 ) − y 0 T 00 (y 0 )) γ (y 0 , y ∗ ) dy 0 u0 (θ) ,
                                                       0

which is a manifestation of the envelope theorem. The first term in this expression is the PE term,
the second is the GE welfare effect.
    Finally we derive the effect of the perturbation h1 + h2 on the social welfare. Summing the
previous expression over all individuals using the density function f˜θ (θ) = f˜y (y) dy(θ)
                                                                                       dθ , and defining
                                                         y          u0 (θ)f˜ (y(θ))
the marginal social welfare weights as gy (y (θ)) = λfy (y(θ)) , we obtain that the change in the
government objective due to the perturbation h (·) = h1 (·) + h2 (·) is
                                                  ˆ                                                    
                   −1
              − λ dG (T, h) = −λ dh        −1                                                 ˜
                                                     u (y (θ) − T (y (θ)) − v (l (θ))) fθ (θ) dθ
                                                  Θ
              ˆ  (                                             −1 "
                                ε̃l,1−τ (θ∗ ) dy (θ∗ )
                                                  
            =     I{y(θ)≥y∗ } +          0 (y ∗ )
                                                                         (1 − T 0 (y (θ))) y (θ) γ (θ, θ∗ ) . . .
               Θ                1 −  T                 dθ
                     ˆ y                                                         #)
                   −       (1 − T 0 (y 0 ) − y 0 T 00 (y 0 )) γ (y 0 , y ∗ ) dy 0 λ−1 u0 (θ) f˜θ (θ) dθ.
                         y 0 =0




                                                               85
Switching the two integrals in the last line of this expression implies that −λ−1 dG (T, h) is equal to
               ˆ
                        I{y≥y∗ } λ−1 u0 (y) f˜y (y) dy
                R+
                                         −1 (ˆ
                 ε̃l,1−τ (y ∗ ) dy (θ∗ )
                                
               +                                    (1 − T 0 (y)) yγ (y, y ∗ ) λ−1 u0 (y) f˜y (y) dy . . .
                 1 − T 0 (y ∗ )     dθ           R+
                 ˆ ∞ ˆ ∞                                                                        )
               −                      0  0     0 00  0        0 ∗    −1 0       ˜
                                (1 − T (y ) − y T (y )) γ (y , y ) λ u (y) fy (y) dydy        0
                     y 0 =0        y=y 0
               ˆ   ∞                                                                              −1
                                                           ε̃l,1−τ (y ∗ )           dy (θ∗ )
                                                                                
           =            gy (y) fy (y) dy +                                                               ...
                y∗                                         1 − T 0 (y ∗ )             dθ
                   (ˆ
               ×                  (1 − T 0 (y)) yγ (y, y ∗ ) gy (y) fy (y) dy
                         R+
                   ˆ    ∞                                                                     ˆ    ∞                                   )
                                           0       0           0    00    0           0   ∗                                          0
               −              (1 − T (y ) − y T (y )) γ (y , y )                                          gy (y) fy (y) dy dy                ,
                     y 0 =0                                                                       y=y 0


But note that
                                                                                                               ˆ   ∞                                
                              0                                                   0                 00                       0           0       0
                (1 − T (y)) ygy (y) fy (y) − (1 − T (y) − yT (y))                                                       gy (y ) fy (y ) dy
                                                                                                                y
                               ˆ                             ∞                              0
            = − (1 − T 0 (y)) y                                    gy (y 0 ) fy (y 0 ) dy 0         .
                                                           y


Thus, we obtain
                                               ˆ       ∞                                 −1
                                                             ε̃l,1−τ (y ∗ ) dy (θ∗ )
                                                                             
                   −1
            −λ          dG (T, h) =     gy (y) fy (y) dy −                                     ...
                                     y∗                     1 − T 0 (y ∗ )        dθ
                                      ˆ                    ˆ ∞                             0
                                    ×       (1 − T 0 (y)) y         gy (y 0 ) fy (y 0 ) dy 0     γ (y, y ∗ ) dy.
                                                       R+                                     y


Therefore, the normalized effect of the perturbation on social welfare is finally given by:

       dW (T, h) = dR (T, h) + λ−1 dG (T, h)
                        ˆ ∞
                   ∗                                T 0 (y ∗ )
      =1 − Fy (y ) −         gy (y) fy (y) dy −                  ε̃l,1−τ (y ∗ ) y ∗ fy (y ∗ )
                          y∗                     1 − T 0 (y ∗ )
                                        −1 ˆ
             ε̃l,1−τ (θ∗ )     dy (θ∗ )
                             
                                                                                       0
       −                                         [(1 − T 0 (y)) y (1 − Fy (y))] γ (y, y ∗ ) dy
          1 − T 0 (y (θ∗ ))       dθ         R+
                     ∗
                                ∗
                                   −1 ˆ                        ˆ ∞                               0
          ε̃l,1−τ (y ) dy (θ )                         0                        0          0      0
       +                                      (1  − T    (y))  y         gy  (y   ) fy  (y   ) dy       γ (y, y ∗ ) dy.
          1 − T 0 (y ∗ )      dθ          R+                          y




                                                                                    86
But note that
                                                                   ˆ                       ∞                              0
                                                 0
                   [(1 − T 0 (y)) y (1 − Fy (y))] − (1 − T 0 (y)) y                              gy (y 0 ) fy (y 0 ) dy 0
                                                                                         y
                                                 ˆ                      ∞                                 0
                                                                                        fy (y 0 )
                                           
                        0
                = (1 − T (y)) y (1 − Fy (y)) 1 −                            gy (y 0 )             dy 0          ,
                                                                    y                 1 − Fy (y)

so that, using the definition of ḡy (y), we get
                                         ˆ     ∞
                                                                                T 0 (y ∗ )
       dW (T, h) = 1 − Fy (y ∗ ) −                 gy (y) fy (y) dy −                        ε̃l,1−τ (y ∗ ) y ∗ fy (y ∗ ) ×
                                              y∗                              1 − T 0 (y ∗ )
                          ∗
                                         ∗
                                               −1 ˆ
              ε̃l,1−τ (θ )          dy (θ )                                                                            0
          −                                                  [(1 − T 0 (y)) y (1 − Fy (y)) (1 − ḡy (y))] γ (y, y ∗ ) dy.
            1 − T 0 (y (θ∗ ))         dθ                R+

                                                   dW (T,h)
Now, at the optimum we must have                   1−F (y ∗ )   = 0, therefore

                                         T 0 (y ∗ )                    y ∗ fy (y ∗ )
               0 =1 − ḡy (y ∗ ) −                    ε̃ l,1−τ (y ∗
                                                                    )
                                       1 − T 0 (y ∗ )                 1 − Fy (y ∗ )
                                       ˆ     d                              0
                                            dy [(1 − ḡy (y)) (1 − T (y)) y (1 − Fy (y))]
                     − ε̃l,1−τ (θ∗ )                                                                          γ (y, y ∗ ) dy,
                                        R+         (1 − T 0 (y (θ∗ ))) (1 − Fy (y ∗ )) y 0 (θ∗ )

which leads to the optimal tax formula (49).



    We now prove that the optimal tax formula obtained by the variational approach coincides with
the formula obtained by solving the mechanism design problem.


B.4.4       Proof of the equivalence of (42) and (49)
                                         ´θ
Proof. Substitute for µ(θ) = λ            θ
                                               (1 − g(x))dFθ (x) in the optimal tax formula (42) evaluated at θ∗
to get:

   T 0 (y (θ∗ ))          τ (θ∗ )
                     ≡
 1 − T 0 (y (θ∗ ))      1 − τ (θ∗ )
                       ´θ                               ´ h 0                  ´
                                                                                   θ
                                                                                                            i0
 
              1             ∗ (1 − g θ (x))fθ (x)dx        Θ
                                                              v (l(x))l(x) x (1 − gθ (x0 ))fθ (x0 )dx0          γ(x, θ∗ )dx
                          θ
= 1+                                                  −
        εl,1−τ (θ∗ )          fw (w(θ∗ ))w(θ∗ )                                (1 − τ (θ∗ )) y(θ∗ )fθ (θ∗ )
                                                ˆ  θ
                                                                                       !
                             1 − Fθ (θ∗ )
                     
              1                                                        fθ (x)
= 1+                                                 (1 − gθ (x))                  dx
        εl,1−τ (θ∗ ) fw (w(θ∗ ))w(θ∗ )            θ∗              1 − Fθ (θ∗ )
    ´ h           0
                                                  ´
                                                      θ            0     fθ (x0 )    0
                                                                                       i0
     Θ
         (1 −   T   (y (x)))  y(x)  (1  − Fθ (x))     x
                                                        (1 − gθ (x   )) 1−Fθ (x)  dx       γ(x, θ∗ )dx
 −                                                                                                     ,
                                    (1 − T 0 (y (θ∗ ))) y(θ∗ )fθ (θ∗ )

where the last equality uses individual x’s first order condition (1). Using the definition of the
                                         ´θ          fθ (x)
average marginal welfare weight ḡθ (θ) = θ gθ (x)) 1−F  θ (θ)
                                                               dx, and multiplying and dividing the first


                                                                   87
term on the right hand side by w0 (θ∗ )/w(θ∗ ), we can rewrite this expression as

             T 0 (y (θ∗ ))
                                              0 ∗
                                                                           1 − Fθ (θ∗ )
                            
                                     1         w (θ )
                  0      ∗
                           = 1+           ∗         ∗
                                                       (1 − ḡθ (θ∗ ))
           1 − T (y (θ ))       εl,1−τ (θ ) w(θ )                      fw (w(θ∗ ))w0 (θ∗ )
                              ´                                                    0
                                [(1 − T 0 (y (θ))) y(θ) (1 − Fθ (θ)) (1 − ḡθ (θ))] γ(θ, θ∗ )dθ
                            − Θ                                                                 .
                                              (1 − T 0 (y (θ∗ ))) y(θ∗ )fθ (θ∗ )

    We now change variables from types and wages to incomes in each of the terms of this equation.
First, recall that Fθ (θ∗ ) = Fw (w (θ∗ )) = Fy (y (θ∗ )), and

                                                                  dy (θ)
                                      fθ (θ∗ ) = fy (y (θ∗ )) ×                    .
                                                                   dθ      θ=θ ∗

Second, we can rewrite the integral as
              ˆ
                 d
                    [(1 − T 0 (y (θ))) y(θ) (1 − Fθ (θ)) (1 − ḡθ (θ))] × γ (θ, θ∗ ) dθ
                dθ
            ˆΘ 
                                                                                   dy (θ)
          =      (1 − T 0 (y (θ)) − y (θ) T 00 (y (θ))) (1 − Fθ (θ)) (1 − ḡθ (θ))
             Θ                                                                       dθ
                                                                
                  − (1 − T 0 (y (θ))) y (θ) (1 − gθ (θ)) fθ (θ) γ (θ, θ∗ ) dθ
            ˆ 
          =      (1 − T 0 (y (θ)) − y (θ) T 00 (y (θ))) (1 − Fθ (θ)) (1 − ḡy (y (θ)))
             Θ
                                                                        
                                                                          dy (θ)
                  − (1 − T 0 (y (θ))) y (θ) (1 − gy (y (θ))) fy (y (θ))           γ (y (θ) , y (θ∗ )) dθ
                                                                            dθ
            ˆ 
          =       (1 − T 0 (y) − yT 00 (y)) (1 − Fy (y)) (1 − ḡy (y))
              R+
                                                         
                    − (1 − T 0 (y)) y (1 − gy (y)) fy (y) γ (y, y ∗ ) dy
              ˆ
                     d
          =            [(1 − T 0 (y)) y (1 − Fy (y)) (1 − ḡy (y))] × γ (y, y ∗ ) dy,
              R+    dy

where the second equality uses
                                                                        −1
                                  1 0     f˜y (y (θ))  1       (y 0 (θ)) × f˜θ (θ)
                   gy (y (θ)) =     u (θ)             = u0 (θ)          −1         = gθ (θ) ,
                                  λ       fy (y (θ))   λ       (y 0 (θ)) × fθ (θ)

and γ (θ, θ∗ ) = γ (y (θ) , y (θ∗ )), and the third equality follows from a change of variables in the
integral. Third, we have

                                                                            w0 (θ ∗ )
                  w0 (θ∗ )  1 − Fθ (θ∗ )       w0 (θ∗ ) 1 − Fθ (θ∗ )        w(θ ∗ )      1 − Fy (y(θ∗ ))
                                             =                       =      y 0 (θ ∗ )
                                                                                                           .
                  w(θ∗ ) fw (w(θ∗ ))w0 (θ∗ )   w(θ∗ ) fθ (θ∗ )                           y(θ∗ )fy (y(θ∗ ))
                                                                            y(θ ∗ )




                                                        88
                   y 0 (θ) w0 (θ)                                                                              ε
    To compute     y(θ) / w(θ) ,    note that the first order condition l(θ) = w(θ)ε (1 − T 0 (y(θ))) implies

                                       l0 (θ)           w0 (θ) y 0 (θ)T 00 (y(θ))
                                                                                     
                                              =ε              −                           .
                                       l(θ)             w(θ)    1 − T 0 (y(θ))

Using (8), we can write
                                                          1
                                                   l(θ) ε − w(θ)y(θ)T 00 (y(θ))
                                     ε̃l,w (θ) =         1                                ε.
                                                   l(θ) ε + εw(θ)y(θ)T 00 (y(θ))
                                        l0 (θ) w0 (θ)
These two equations imply that           l(θ) / w(θ)    is equal to
                                                                                 (
            w(θ) y 0 (θ)T 00 (y(θ))
                                   
                                                            ε                       h      1
                                                                                                                  i
       1− 0                           ε =                                             l(θ) ε − w(θ)y(θ)T 00 (y(θ)) . . .
                                               1
            w (θ) 1 − T 0 (y(θ))          l(θ) ε + εw(θ)y(θ)T 00 (y(θ))
                                                                                                             )
                                          w(θ) y 0 (θ)T 00 (y(θ)) 
                                                                                                        
                                                                               1
                               00                                                                00
    + (1 + ε) w(θ)y(θ)T (y(θ)) − 0                                        l(θ) ε + εw(θ)y(θ)T (y(θ))
                                          w (θ) 1 − T 0 (y(θ))
                                                             y 0 (θ)T 00 (y(θ))
                                                                                     1
                                                                                                                
                 (1 + ε) w(θ)y(θ)T 00 (y(θ)) − ww(θ)   0 (θ) 1−T 0 (y(θ))        l(θ) ε + εw(θ)y(θ)T 00 (y(θ)) 
  =ε̃l,w (θ) 1 +                                      1                                                             .
                                                l(θ) ε − w(θ)y(θ)T 00 (y(θ))                                     

But the second term in the curly brackets is equal to zero; to see this, note that its numerator is
proportional to

                                             y 0 (θ)                1
                                                                                             
                      (1 + ε) y(θ) −                            l(θ) ε + εw(θ)y(θ)T 00 (y(θ))
                                    (1 − T 0 (y(θ))) w0 (θ)
                                                         T 00 (y(θ))
                                                                      
                              0
                   ∝ (1 + ε) w (θ)l(θ) − 1 + εy(θ)                        y 0 (θ) = 0,
                                                      1 − T 0 (y(θ))

where the last equality follows from the fact that y 0 (θ) = w0 (θ)l(θ) + w(θ)l0 (θ) and the expression
           0
above for ll(θ)
             (θ)
                 . Therefore, we finally obtain

                      y 0 (θ)         l0 (θ)                            −1
                      y(θ)             l(θ)                  d ln w(θ)         d ln l(θ)
                      w0 (θ)
                                =1+   w0 (θ)
                                               =1+                                       = 1 + ε̃l,w (θ).
                                                                 dθ               dθ
                      w(θ)            w(θ)


This implies
                                1 − Fw (w(θ∗ ))         1        1 − Fy (y(θ∗ ))
                                   ∗        ∗
                                                =                                  .
                                w(θ )fw (w(θ ))   1 + ε̃l,w (θ ) y(θ∗ )fy (y(θ∗ ))
                                                              ∗

Finally, note that
                                          0
                                  1−T (θ)
           1           1−T 0 (θ)+εl,1−τ (θ)y(θ)T 00 (θ) εl,1−τ (θ)          1         εl,1−τ (θ)           1
                   =           1−T 0 (θ)−y(θ)T 00 (θ)
                                                                                  =                              .
     1 + ε̃l,w (θ)   1 + 1−T 0 (θ)+εl,1−τ (θ)y(θ)T 00 (θ) εl,1−τ (θ) ε̃ l,1−τ (θ)   1 +  ε l,1−τ (θ) ε̃l,1−τ (θ)




                                                                89
Collecting all the terms, we obtain

      T 0 (y (θ∗ ))                                                               εl,1−τ (θ∗ )     1 − Fy (y(θ∗ ))
                                                                                              
                                     1                      ∗            1
           0      ∗
                    =    1  +            ∗
                                               (1 −  ḡθ (θ   ))
    1 − T (y (θ ))             εl,1−τ (θ )                         ε̃l,1−τ (θ ) 1 + εl,1−τ (θ ) y(θ∗ )fy (y(θ∗ ))
                                                                             ∗                 ∗
                           ´
                             R dy
                                 d
                                    [(1 − T 0 (y)) y (1 − Fy (y)) (1 − ḡy (y))] × γ (y, y ∗ ) dy
                      + +
                                      (1 − T 0 (y (θ∗ ))) y (θ∗ ) fy (y (θ∗ )) × y 0 (θ∗ )
                             1                        1 − Fy (y(θ∗ ))
                    =             ∗
                                     (1 − ḡθ (θ∗ ))
                      ε̃l,1−τ (θ )                    y(θ∗ )fy (y(θ∗ ))
                           ´
                             R dy
                                 d
                                    [(1 − T 0 (y)) y (1 − Fy (y)) (1 − ḡy (y))] × γ (y, y ∗ ) dy
                      − +                                                                          ,
                                      (1 − T 0 (y (θ∗ ))) y (θ∗ ) fy (y (θ∗ )) × y 0 (θ∗ )

which is exactly formula (49).




B.4.5      Optimum Characterization and Proof of Corollary 4
Here we show how to rewrite formula (49) as an integral equation.

Proof. The idea is to integrate by parts the last term in equation (49). Let
                                            (1 − ḡy (y)) (1 − T 0 (y)) y (1 − Fy (y))
                                 ψ (y) =                                               ,
                                                   (1 − T 0 (y ∗ )) (1 − F (y ∗ ))

so that optimal taxes satisfy
                                                                                              ˆ
                              T 0 (y ∗ )                   y ∗ fy (y ∗ )   ε̃l,1−τ (θ∗ )
      0 =1 − ḡy (y ∗ ) −          0     ∗
                                           ε̃l,1−τ (y ∗ )              ∗
                                                                         −                          ψ 0 (y) γ (y, y ∗ ) dy.
                            1 − T (y )                    1 − Fy (y )         y 0 (θ∗ )        R+


Disentangle the Dirac and the smooth part of γ (y, y ∗ ), i.e., the own- and cross-wage elasticities. We
get:
                                      T 0 (y ∗ )                    y ∗ fy (y ∗ )
               0 =1 − ḡy (y ∗ ) −         0     ∗
                                                   ε̃l,1−τ (y ∗ )
                                    1 − T (y )                    1 − Fy (y ∗ )
                                    ˆ
                      ε̃l,1−τ (θ∗ )
                   −                     ψ 0 (y) [γ̄ (y, y ∗ ) + γ̄¯ (y ∗ , y ∗ ) y 0 (θ∗ ) δy∗ (y)] dy
                         y 0 (θ∗ )    R+
                                           T 0 (y ∗ )                       y ∗ fy (y ∗ )
                    =1 − ḡy (y ∗ ) −           0     ∗
                                                          ε̃l,1−τ (y ∗ )
                                       1 − T (y )                         1 − Fy (y ∗ )
                                                                                     ˆ
                                                                     ε̃l,1−τ (θ∗ )
                       − ε̃l,1−τ (θ∗ ) ψ 0 (y ∗ ) γ̄¯ (y ∗ , y ∗ ) −                      ψ 0 (y) γ̄ (y, y ∗ ) dy.
                                                                        y 0 (θ∗ )      R+

Assuming that y 7→ γ̄ (y, y ∗ ) is continuously differentiable for each y ∗ , we can integrate by parts the
last term of this equation. Using ψ (0) = 0 and ψ (ȳ) = 0 yields

                                 T 0 (y ∗ )                   y ∗ fy (y ∗ )
           0 =1 − ḡy (y ∗ ) −        0     ∗
                                              ε̃l,1−τ (y ∗ )                  − ε̃l,1−τ (θ∗ ) ψ 0 (y ∗ ) γ̄¯ (y ∗ , y ∗ )
                               1 − T (y )                    1 − Fy (y ∗ )
                               ˆ            "            −1                 #                                               (85)
                            ∗                    dy (θ∗ )       dγ̄ (y, y ∗ )
                + ε̃l,1−τ (θ )     ψ (y)                                        dy.
                                R+                 dθ                dy


                                                               90
Now, since the marginal social welfare weights gy (y) sum to 1, we have
                                                                         ˆ   ∞
                (1 − ḡy (y)) (1 − Fy (y)) =1 − Fy (y) −                         gy (y 0 ) fy (y 0 ) dy 0
                                                                         y
                                                     ˆ    y
                                                 =            gy (y 0 ) fy (y 0 ) dy 0 − Fy (y) ≡ Gy (y) − Fy (y) ,
                                                      0

                                           0
so that [(1 − ḡy (y)) (1 − Fy (y))] = (gy (y) − 1) fy (y) and thus

                   (1 − T 0 (y)) y (gy (y) − 1) fy (y) + (1 − T 0 (y) − yT 00 (y)) (1 − ḡy (y)) (1 − Fy (y))
      ψ 0 (y) =                                                                                               .
                                                  (1 − T 0 (y ∗ )) (1 − F (y ∗ ))

Hence (85) can be rewritten as

         T 0 (y ∗ )            1       1 − Fy (y ∗ )
                      =                               (1 − ḡy (y ∗ )) . . .
       1 − T 0 (y ∗ )    ε̃l,1−τ (y ∗ ) y ∗ fy (y ∗ )
             1 − Fy (y ∗ ) (1 − T 0 (y ∗ ) − y ∗ T 00 (y ∗ )) (1 − ḡy (y ∗ )) (1 − Fy (y ∗ ))
         − ∗                                                                                       γ̄¯ (y ∗ , y ∗ )
               y fy (y ∗ )                   (1 − T 0 (y ∗ )) (1 − F (y ∗ ))
             1 − Fy (y ∗ ) (1 − T 0 (y ∗ )) y ∗ (gy (y ∗ ) − 1) fy (y ∗ )
         − ∗                                                                γ̄¯ (y ∗ , y ∗ )
               y fy (y ∗ )        (1 − T 0 (y ∗ )) (1 − F (y ∗ ))
                             ˆ                                                          "            −1                   #
             1 − Fy (y ∗ )        (1 − ḡy (y)) (1 − T 0 (y)) y (1 − Fy (y))                 dy (θ∗ )         dγ̄ (y, y ∗ )
         + ∗                                                                                                                  dy.
               y fy (y ∗ ) R+             (1 − T 0 (y ∗ )) (1 − F (y ∗ ))                      dθ                   dy

The right hand side of this expression is equal to

  1 − Fy (y ∗ )                                           (1 − T 0 (y ∗ ) − y ∗ T 00 (y ∗ )) ε̃l,1−τ (y ∗ )
                                                                                                                       
                             ∗          1                                                                         ∗ ∗
                 (1 − ḡy (y   ))                 1   −                                                     ¯
                                                                                                            γ̄ (y  , y )
   y ∗ fy (y ∗ )                  ε̃l,1−τ (y ∗ )                          1 − T 0 (y ∗ )
                                      ˆ                                                                        −1
                                            (1 − ḡy (y)) (1 − T 0 (y)) y (1 − Fy (y)) dy (θ∗ )                      dγ̄ (y, y ∗ )
                                                                                                   
             ∗       ¯    ∗ ∗
  − (gy (y ) − 1) γ̄ (y , y ) +                                                                                                    dy
                                       R+              (1 − T 0 (y ∗ )) y ∗ fy (y ∗ )                  dθ                 dy
  1 − Fy (y ∗ )              ∗    1 − ε̃l,w (y ∗ ) γ̄¯ (y ∗ , y ∗ )
 = ∗             (1 − ḡy (y   ))                                   + (1 − gy (y ∗ )) γ̄¯ (y ∗ , y ∗ )
   y fy (y ∗ )                            ε̃l,1−τ (y ∗ )
     ˆ                                                                     −1
                           (1 − T 0 (y)) y 1 − Fy (y) dy (θ∗ )                   dγ̄ (y, y ∗ )
                                                                 
  +        (1 − ḡy (y))           0   ∗      ∗          ∗
                                                                                                 dy.
       R+                 (1 − T (y )) y fy (y )                      dθ              dy

We thus get

                 T 0 (y ∗ )                                    1 − Fy (y ∗ )
                                                                             
                                    1                   ∗
                             =               (1 − ḡy (y ))                     − (g (y ∗ ) − 1) γ̄¯ (y ∗ , y ∗ )
               1 − T 0 (y ∗ ) Ẽl,1−τ (y ∗ )                    y ∗ fy (y ∗ )
                                 ˆ                                                         0
                                                                            1 − T 0 (y)      γ̄y (y, y ∗ )
                                                                     
                                                        1 − Fy (y)
                               +      (1 − ḡy (y))                                        y               dy.
                                   R+                   y ∗ fy (y ∗ )      1 − T 0 (y ∗ )      y 0 (θ∗ )

                   T̄ 0 (y ∗ )
Denoting by       1−T̄ 0 (y ∗ )
                                  the first line in the right hand side of the previous equation, and changing
                                                                                                  ∗
variables from incomes y to types θ (using the identities fy (y ∗ ) dy(θ
                                                                      dθ
                                                                                                      )
                                                                                                          = fθ (θ∗ ), Fy (y (θ)) = Fθ (θ),




                                                                    91
                                                   −1
      dγ̄(y,y ∗ )        dγ̄(θ,θ ∗ )
                                       
                                           dy(θ)
and       dy        =        dθ             dθ           ), we obtain

                                                            ˆ
    T 0 (y (θ∗ ))     T̄ 0 (y (θ∗ ))                                                (1 − T 0 (y (θ))) y (θ) 1 − Fθ (θ) dγ̄ (θ, θ∗ )
                   =                   +                           (1 − ḡθ (θ))                                                    dθ.
  1 − T 0 (y (θ∗ )) 1 − T̄ 0 (y (θ∗ ))                        Θ                    (1 − T 0 (y (θ∗ ))) y (θ∗ ) fθ (θ∗ )     dθ
                                                                                                        ∗
Equation (52) follows immediately from this expression since dγ̄(y,ydy
                                                                          )
                                                                            = 0 when the production
function is CES.
    Multiplying both sides of the previous equation by 1 − T 0 (y (θ∗ )), we then get

                                              T̄ 0 (y (θ∗ ))
                    T 0 (y (θ∗ )) =                            (1 − T 0 (y (θ∗ )))
                                            1 − T̄ 0 (y (θ∗ ))
                                               ˆ
                                                                            (1 − ḡθ (θ)) (1 − Fθ (θ)) dγ̄ (θ, θ∗ )
                                            +       (1 − T 0 (y (θ))) y (θ)                                         dθ,
                                                 Θ                                 y (θ∗ ) fθ (θ∗ )         dθ

which leads to the following formula for the optimal net-of-tax rate 1 − τ (θ∗ ) ≡ 1 − T 0 (y (θ∗ )):
                                                 ˆ
                                                                 y (θ) (1 − ḡθ (θ)) (1 − Fθ (θ)) γ̄ 0 (θ, θ∗ )
                                                                                                                     
                                   1
  (1 − τ (θ∗ )) =               τ̄ (θ ∗ )
                                             1 −    (1 − τ (θ))                                                    dθ
                          1 + 1−τ̄                Θ                             y (θ∗ ) fθ (θ∗ )
                                     (θ ∗ )
                                                ˆ                                                                         
                                                                        1 − Fθ (θ)
                        = (1 − τ̄ (θ∗ )) 1 −          (1 − ḡθ (θ))                      y (θ) γ̄ 0
                                                                                                    (θ, θ ∗
                                                                                                            )   (1 − τ (θ)) dθ   .
                                                   Θ                  y (θ∗ ) fθ (θ∗ )

This is now a well-defined integral equation in (1 − T 0 (y (θ))), so that we can use the mathematical
apparatus introduced in Section 2 to characterize its solution, i.e., the optimal tax schedule. Similar
to the integral equation (21), it can be solved in closed form if γ̄ 0 (θ, θ∗ ) is the sum of multiplicatively
separable terms. We can use the same techniques as in Section xx in the Translog case to get a
separable kernel.




B.4.6         Proof of Corollary 5
We now derive the formula for the optimal top tax rate when the production function is CES.

Proof. Assume that in the data (i.e., given the current tax schedule with a constant top tax rate,
assuming that the aggregate production function is CES), the income distribution has a Pareto tail,
                                                           1−F d (y ∗ )
so that the (observed) hazard rate yf dy(y∗ ) converges to a constant 1/α. We show that under these
                                       y
assumption, the income distribution at the optimum tax schedule is also Pareto distributed at the
tail with the same Pareto coefficient 1/α. That is, the hazard rate of the income distribution at the
top is independent of the level of the top tax rate. At the optimum, we have

                              1 − Fy (y(θ))   1 − Fθ (θ)    1 − Fθ (θ) θy 0 (θ)   1 − Fθ (θ)
                                            = y(θ)        =                     =            εy,θ ,                                   (86)
                                y(θ)fy (θ)     0   fθ (θ)     θfθ (θ)   y(θ)        θfθ (θ)
                                                           y (θ)


where we define the income elasticity εy,θ ≡ d ln y (θ) /d ln θ. To compute this elasticity, use the
                                                                                                  ε
individual first order condition (1) with isoelastic disutility of labor to get l(θ) = (1 − τ (θ)) w(θ)ε .



                                                                             92
Thus we have

                                                                                    θw0 (θ)    θτ 0 (θ)
                                                                                                         
                       d ln l (θ)    d ln (1 − τ (θ))    d ln w(θ)
              εl,θ   ≡            =ε                  +ε           =ε                       −                 .
                         d ln θ            d ln θ          d ln θ                    w(θ)     1 − τ (θ)

But since the production function is CES, we have, from equation (14),

           d ln w(θ) d ln a (θ)             d ln L (θ)
                    =            + (ρ − 1)
             d ln θ     d ln θ                d ln θ
                      d ln a (θ)   1 d ln l (θ)    1 d ln fθ (θ)   θa0 (θ)  1       1 θfθ0 (θ)
                    =            −              −                =         − εl,θ −            .
                        d ln θ     σ d ln θ        σ d ln θ         a (θ)   σ       σ fθ (θ)

                                                θw0 (θ)
Thus, substituting this expression for           w(θ)      in the previous equation, we obtain

                                           θa0 (θ)          1 θfθ0 (θ)    θτ 0 (θ)
                                                                                          
                                                    1
                             εl,θ =ε               − εl,θ −            −                       .
                                            a (θ)   σ       σ fθ (θ)     1 − τ (θ)

Moreover, since we assume that the second derivative of the optimal marginal tax rate, T 00 (y),
converges to zero for high incomes, we have limθ→∞ τ 0 (θ). Therefore, the previous equation yields

                                                          θa0 (θ)          θfθ0 (θ)
                                                                                          
                                             ε                      1
                             lim εl,θ =          ε         lim    −    lim                     .
                            θ→∞             1+   σ
                                                       θ→∞ a (θ)    σ θ→∞ fθ (θ)
                               0
                                            θf 0 (θ)
Note that the variables θaa(θ)
                            (θ)
                                and fθθ(θ) are primitive parameters that do not depend on the tax
rate. Assuming that they converge to constants as θ → ∞, we obtain that limθ→∞ εl,θ is a constant
independent of the tax rates, and hence
                                                                           
                                                                          1
                                       εy,θ = εl,θ + εw,θ =            1+     εl,θ
                                                                          ε

converges to a constant as θ → ∞. Therefore, the hazard rate of the income distribution at the
optimum tax schedule, given by (86), converges to the same constant 1/α as the hazard rate of
incomes observed in the data.
     Now let y ∗ → ∞ in equation (52), to obtain an expression for the optimal top tax rate τtop =
limy∗ →∞ T 0 (y ∗ ). Since the production function is CES with parameter σ, and the disutility of labor
is isoelastic with parameter ε, we have

                                                                           ε
                                             lim Ẽl,1−τ (y ∗ ) =               .
                                            y ∗ →∞                      1 + ε/σ

Furthermore assume that limy∗ →∞ gy (y ∗ ) = ḡ, so that limy∗ →∞ ḡy (y ∗ ) = ḡ. Therefore (52) implies

                       τtop     1 + ε/σ         1  ḡ − 1   1 − ḡ 1 − ḡ ḡ − 1
                              =         (1 − ḡ) +        =       +      +       .
                     1 − τtop      ε            α     σ      αε     ασ       σ

This concludes the proof.




                                                                 93
B.4.7      General equilibrium wedge accounting
We finally propose a decomposition into several components of the difference between the partial
and general equilibrium optimal taxes, respectively given by formulas (54) and (52).

Proposition 6. The optimal marginal tax rate of type θ in general equilibrium can be expressed
as a function of τP E (θ) and three additional terms:

                 τ (θ)     τP E (θ)      gθ (θ) − 1
                        =              +
               1 − τ (θ) 1 − τP E (θ)         σ
                                                                                     !
                            1 − Fw (w(θ))            1                 ε̃l,1−τ (θ)
                          +                    1+        (1 − ḡθ (θ))             −1
                            fw (w(θ))w(θ)            ε                 Ẽl,1−τ (θ)
                                                                           1 − Fwd (wd (θ))
                                                                                         
                                   1                   1 − Fw (w(θ))
                          + 1+         (1 − ḡθ (θ))                   − d                    .               (87)
                                   ε                   fw (w(θ))w(θ) fw (wd (θ))wd (θ)

                                                                               τP E (θ)
Proof. Adding and substracting from equation (52) the partial equilibrium tax 1−τ P E (θ)
                                                                                          constructed
in (54), we find

                 τ (θ)     τP E (θ)       gθ (θ) − 1
                        =             +
               1 − τ (θ) 1 − τP E (θ)          σ
                                                            1 − Fy (y(θ∗ ))
                                                                             
                                  1                                                 τP E (θ)
                          +               (1 − ḡ (θ∗ ))                        −              .
                            Ẽl,1−τ (θ∗ )                  y(θ∗ ))fy (y(θ∗ ))     1 − τP E (θ)

                    τP E (θ)
Substituting for   1−τP E (θ)   in the second line of this expression using the definition (54), we obtain
                                              
    τ (θ)           τP E (θ)        gθ (θ) − 1
             −                   +
  1 − τ (θ)       1 − τP E (θ)           σ
                                               ∗
                                                              1 1 − Fwd (wd (θ))
                                                            
        1                         1 −  F y (y(θ ))
=               (1 − ḡ (θ∗ ))                        −   1 +                      (1 − ḡ(θ))
  Ẽl,1−τ (θ∗ )                  y(θ∗ ))fy (y(θ∗ ))           ε fwd (wd (θ))wd (θ)
                                                   1 − Fw (w(θ∗ ))           1 1 − Fwd (wd (θ))
                                                                            
        1                 ∗                 ∗
=               (1 − ḡ (θ )) (1 + ε̃l,w (θ ))                       − 1+                         (1 − ḡ(θ)) ,
  Ẽl,1−τ (θ∗ )                                  w(θ∗ ))fw (w(θ∗ ))          ε fwd (wd (θ))wd (θ)

where the second equality follows from a change of variables from incomes to wages in the hazard
rate, and the fact that

             1 − Fy (y(θ∗ ))   y 0 (θ∗ )) 1 − Fy (y(θ∗ ))   y 0 (θ∗ )) 1 − Fw (w(θ∗ ))
               ∗         ∗
                             =       ∗    0  ∗         ∗
                                                          =
            y(θ ))fy (y(θ )) y(θ )) y (θ ))fy (y(θ ))       y(θ∗ )) w0 (θ∗ ))fw (w(θ∗ ))
                                      y 0 (θ ∗ ))
                                      y(θ ∗ ))       1 − Fw (w(θ∗ ))                      1 − Fw (w(θ∗ ))
                                  =   w0 (θ ∗ ))
                                                                       = (1 + ε̃l,w (θ))
                                                    w(θ∗ ))fw (w(θ∗ ))                   w(θ∗ ))fw (w(θ∗ ))
                                      w(θ ∗ ))


(we showed the last equality above). Now, note that

                                                             1−τ (θ)−y(θ)τ 0 (θ)
                                 1 + ε̃l,w (θ)   1+          1−τ (θ)+εy(θ)τ 0 (θ) ε       1+ε
                                               =                 1−τ (θ)
                                                                                      =       ,
                                  ε̃l,1−τ (θ)                                              ε
                                                           1−τ (θ)+εy(θ)τ 0 (θ) ε




                                                                94
so that

       τ (θ)         τP E (θ)    gθ (θ) − 1
               −               +
    1 − τ (θ) 1 − τP E (θ)            σ
                                            1 − Fw (w(θ∗ ))        1 1 − Fwd (wd (θ))
                                                               
     ε̃l,1−τ (θ)            ∗       1
  =               (1 − ḡ (θ )) 1 +                           − 1+                      (1 − ḡ(θ)) .
    Ẽl,1−τ (θ∗ )                   ε     w(θ∗ ))fw (w(θ∗ ))       ε fwd (wd (θ))wd (θ)

Adding and subtracting                                      
                                  1 − Fw (w(θ))          1
                                                      1+         (1 − ḡ(θ))
                                  fw (w(θ))w(θ)          ε
yields the result.



     The first correction in formula (87) is the cross-wage effect (g(y ∗ ) − 1)/σ (see (52)). It is
always negative for a Rawlsian planner, and hence pushes in the direction of lower tax rates. The
second correction is due to the own-wage effect, and is captured by the adjusted elasticity Ẽl,1−τ
vs. ε̃l,1−τ . It is always positive, and hence pushes in the direction of higher tax rates. Finally the
third correction is due to the fact that (54) and (52) are evaluated at different wage distributions. In
(87), this is accounted for by the difference between the hazard rate of the wage distribution at the
general equilibrium optimum, fw (w(θ)), and that of the wage distribution inferred from the data,
fwd (wd (θ)).56 Figure 10 decomposes quantitatively the relative importance of each of these three
forces.



C         Numerical Simulations: Details and Robustness
C.1       Details on Calibration of Income Distribution
We assume that incomes are log-normally distributed apart from the top, where we append a Pareto
                                                                                          1−F (y)
distribution for incomes above $150,000. To obtain a smooth resulting hazard ratio yfyy(y) , we
decrease the thinness parameter of the Pareto distribution linearly between $150,000 and $350,000
and let it be constant at 1.5 afterwards (Diamond and Saez, 2011). In the last step we use a standard
kernel smoother to ensure differentiability of the hazard ratios at $150,000 and $350,000. We set the
mean and variance of the lognormal distribution at 10 and 0.95, respectively. The mean parameter
is chosen such that the resulting income distribution has a mean of $64,000, i.e., approximately the
average US yearly earnings. The variance parameter was chosen such that the hazard ratio at level
$150,000 is equal to that reported by Diamond and Saez (2011, Fig.2). The resulting hazard ratio
is illustrated in Figure 6.




   56
     With endogenous marginal social welfare weights, there would be an additional correction term
to account for the fact that the welfare weights are endogenous to the tax schedule.

                                                  95
                                                    2
                                                                                                   1−Fy (y ∗ )
                                                  1.8                                              y ∗ ×fy (y ∗ )

                                                  1.6

                                                  1.4

                                                  1.2

                                                    1

                                                  0.8

                                                  0.6

                                                  0.4

                                                  0.2

                                                    0
                                                        0   100     200           300          400                  500
                                                                    y^* in $1,000



                 Figure 6: Calibrated Hazard Ratios of the Income Distribution

C.2      Additional Graphs for Benchmark Specification
Figure 7 illustrates optimal marginal tax rates as a function of income in the optimal allocation.
Marginal tax rates in this graph reflect the policy recommendations of the optimal tax exercise which
is to set marginal tax rates at each income (rather than unobservable productivity) level. A general
pattern is that the marginal tax rate schedule is shifted to the left because individuals work less for
optimal taxes than current taxes. This is visible most clearly for the top bracket and the bottom of
the U that start earlier.

                                                   1
                                                                               Partial Equilibrium Planner
                                                  0.9                          Elasticity of Substitution 3.1
                                                                               Elasticity of Substitution 1.4
                                                                               Elasticity of Substitution .6
                                                  0.8
                             Marginal Tax Rates




                                                  0.7

                                                  0.6

                                                  0.5

                                                  0.4

                                                  0.3

                                                  0.2
                                                        0   100    200            300          400              500
                                                                  Income in $1,000


                 Figure 7: Optimal Marginal Tax Rates as a Function of Income



C.3      Utilitarian Welfare Function
We here consider another often used social welfare function, namely the utilitarian welfare function.
This implies we set f˜(θ) = f (θ). To obtain a desire for redistribution, we assume the utility function
        1
                    1          1−κ
to be 1−κ    c − l1+ ε / 1 + 1ε       . Thus, κ determines the concavity of utility and therefore the
desire for redistribution. Figure 8 illustrates optimal Utilitarian marginal tax rates for two values

                                                                          96
of κ (1 and 3). As in the Rawlsian case, the optimal U-shape of marginal tax rates is reinforced.
Given that low income levels now also have positive welfare weights, the cross wage effect here is a
force for higher marginal tax rates for low income levels. Thus, the result that marginal tax rates
should be higher for low income levels is stronger than in the Rawlsian case in two ways: (i) the size
of these effects is larger and (ii) it holds for a broader range (up to $50,000).


Figure 8: Optimal Utilitarian Marginal Tax Rates (CRRA = 1 in left panel and CRRA = 3 in
right panel)
                      0.8                                                                                            0.8

                      0.7                                                                                            0.7
 Marginal Tax Rates




                                                                                                Marginal Tax Rates
                      0.6                                                                                            0.6

                      0.5                                                                                            0.5

                      0.4                                                                                            0.4                           Partial Equilibrium Planner
                                                                                                                                                   Elasticity of Substitution 3.1
                                                    Partial Equilibrium Planner                                                                    Elasticity of Substitution 1.4
                      0.3                                                                                            0.3                           Elasticity of Substitution .6
                                                    Elasticity of Substitution 3.1
                                                    Elasticity of Substitution 1.4
                      0.2                           Elasticity of Substitution .6                                    0.2

                      0.1                                                                                            0.1
                            0        100      200         300          400           500                                   0        100      200        300          400            500
                                Type Expressed by Current Income in $1,000                                                     Type Expressed by Current Income in $1,000



    Next we ask how the results about tax incidence are differ in the Utilitarian case. In contrast to
the Rawlsian case, the policy implications of the optimal tax schedule are not necessarily overturned.
For a relatively low desire to redistribute (κ = 1, see the left panel of Figure 9), the welfare gains
of raising tax rates on high incomes are muted due to general equilibrium. For a stronger desire to
redistribute (κ = 3, see the right panel of Figure 9), general equilibrium effects make raising top tax
rates more desirable. How can that be explained? General equilibrium effects make rising top tax
rates more desirable because the tax revenue increase is higher. At the same time the implied wage
decreases for the working poor make them worse of. In case of very strong redistributive tastes, the
tax revenue get a stronger weight (as they are used for lump-sum redistribution at the margin). In
case where relatively richer workers (for whom the lump-transfer is less important relative to the
very poor) still have significant welfare weights, the wage effects dominates.




                                                                                           97
Figure 9: Tax Incidence Utilitarian for σ = 1.4 (CRRA = 1 in left panel and CRRA = 3 in right
panel)
   1.2                                                                                          1.2
                                       δWpe /(1 − Fy (y ∗ ))                                                                                 δWpe /(1 − Fy (y ∗ ))
   1.1                                 δWge /(1 − Fy (y ∗ ))                                                                                 δWge /(1 − Fy (y ∗ ))
                                                                                                1.1

    1
                                                                                                   1
   0.9
                                                                                                0.9
   0.8
                                                                                                0.8
   0.7

   0.6                                                                                          0.7


   0.5                                                                                          0.6
         0    100   200       300                          400           500                           0         100         200       300         400           500
                    y ∗ in $1,000                                                                                            y ∗ in $1,000




C.4          General Equilibrium Wedge Accounting
Figure 10 decomposes quantitatively the relative importance of each of the three forces highlighted
in Proposition 6, for ε = 0.33 and σ = 1.4. The partial (resp., general) equilibrium optimum is
represented by the black dashed (resp., red bold) curve. The black dotted, blue dashed-dotted, and
diamond-marked curves illustrate suboptimal tax schedules where each of the three elements of the
decomposition (87) (respectively, the cross-wage term, the elasticity correction term, and the hazard
rate correction term) are ignored. This graph shows that the hazard rate correction term (iii) has a
minor quantitative importance.

                                                          1
                                                                           Partial Equilibrium Planner
                                                                           GE Optimum
                                                         0.9               GE Optimum without Cross Wage Effect
                                                                           GE Optimum without Elasticity Correction
                                                                           GE Optimum without Hazard Rate Correction
                                    Marginal Tax Rates




                                                         0.8


                                                         0.7


                                                         0.6


                                                         0.5


                                                         0.4
                                                               0        100       200        300           400         500
                                                                   Type Expressed by Current Income in $1,000


                          Figure 10: General Equilibrium Wedge Accounting



C.5          Translog Production Function
First we again look at tax incidence but change the parameterization of the Translog production
function such that γ̄¯ (y ∗ , y ∗ ) = −1 for y ∗ = $80, 000 instead of $250,000.


                                                                                        98
Figure 11: γ̄(θ, θ∗ ) with y(θ∗ ) = $250, 000 (left panel) and the implied tax incidence
(right panel)
                             ×10-3
                                                                                                                                        1
                                                                                                                                                                                  Parital Equilibrium
                                                                                                                              0.95                                                Cobb Douglas
                        2                                                                                                                                                         Translog Case 1
                                                                                                                                                                                  Translog Case 2
                                                                                                                                       0.9

                                                                                                                              0.85




                                                                                                         δR/(1 − Fy (y∗ ))
                       1.5
 γ̄(y∗ , $250, 000)




                                                                                                                                       0.8

                                                                                                                              0.75
                        1
                                                                                                                                       0.7

                                     Cobb Douglas
                                                                                                                              0.65
                       0.5
                                     Translog Case 3
                                     Translog Case 4                                                                                   0.6

                                                                                                                              0.55
                        0
                                                                                                                                       0.5
                             0         100         200          300           400             500                                            0       100       200        300           400             500
                                                       y∗ in $1,000                                                                                                  y∗




    Figure 11 illustrates the distance dependent wage effects for these Cases 3 and 4. The tax
incidence results are illustrated in the right panel. Here the best comparison level for y ∗ to under-
stand the effects of distance dependence is $80,000. In line with the results in the main body of the
text, the general equilibrium effects on tax incidence are increased in magnitude through distance
dependence.


                                     Figure 12: Optimal Marginal Tax Rates for Translog Production Functions
                        1                                                                                                               1
                                                                Parital Equilibrium Planner                                                                               Parital Equilibrium Planner
                                                                Cobb Douglas                                                                                              Cobb Douglas
                                                                Translog Case 1                                                                                           Translog Case 3
                       0.8                                      Translog Case 2                                                        0.8                                Translog Case 4
  Marginal Tax Rates




                                                                                                                  Marginal Tax Rates




                       0.6                                                                                                             0.6


                       0.4                                                                                                             0.4


                       0.2                                                                                                             0.2


                        0                                                                                                               0

                             0         100         200          300           400             500                                            0       100       200        300           400             500
                                 Type Expressed by Current Income in $1,000                                                                      Type Expressed by Current Income in $1,000




     Figure 12 illustrates the resulting optimal marginal tax rates for all 4 cases. As cases 1 and 3
are more similar to Cobb Douglas than cases 2 and 4, not surprisingly, marginal tax rates are closer
to the Cobb Douglas counterpart. These results can be best interpreted by looking at Figure 13
where the own-wage effects are illustrated.57 For Cases 1 and 3, γ̄¯ (y, y) is relatively flat and close
to -1 (as in Cobb Douglas). For Case 4, the wage effects are generally a bit larger in magnitude and
still relatively flat (magnitude varies by a factor 2), which explains why the CES effects are mainly
increased in magnitude. For Case 2, the magnitude of the wage effects strongly increases and varies

              57
    They are illustrated for the current tax system but do look very similar for the respective
optimal tax system.

                                                                                                    99
by a factor of up to 6, which explains why the shape of marginal tax rates is more different from
CES than in the other 3 cases. Finally, welfare gains in consumption equivalents are 1.09%, 0.31%,
1.85% and 2.53% respectively for these cases.

                                     -0.2
                                                                                Translog Case 1
                                     -0.4                                       Translog Case 2
                                                                                Translog Case 3
                                     -0.6                                       Translog Case 4

                                     -0.8

                                      -1
                            γ̄¯(y)   -1.2

                                     -1.4

                                     -1.6

                                     -1.8

                                      -2

                                     -2.2
                                            0       100       200       300       400             500
                                                Type Expressed by Current Income in $1,000



                Figure 13: Illustration of the own-wage effect for current policies




                                                                 100
