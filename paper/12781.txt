                                NBER WORKING PAPER SERIES




                HETEROGENEOUS EXPECTATIONS AND BOND MARKETS

                                             Wei Xiong
                                            Hongjun Yan

                                        Working Paper 12781
                                http://www.nber.org/papers/w12781


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    December 2006




We are grateful to Markus Brunnermeier, Bernard Dumas, Nicolae Garleanu, Jon Ingersoll, Arvind
Krishnamurthy, Owen Lamont, Debbie Lucas, Lin Peng, Monika Piazzesi, Chris Sims, Hyun Shin,
Stijn Van Nieuwerburgh, Neng Wang, Moto Yogo, and seminar participants at Bank of Italy, Federal
Reserve Bank of New York, NBER Summer Institute, New York University, Northwestern University,
Princeton University, University of Chicago, University of Illinois-Chicago, Wharton School, and
Yale University for their helpful discussions and comments. The views expressed herein are those
of the author(s) and do not necessarily reflect the views of the National Bureau of Economic Research.

© 2006 by Wei Xiong and Hongjun Yan. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
Heterogeneous Expectations and Bond Markets
Wei Xiong and Hongjun Yan
NBER Working Paper No. 12781
December 2006
JEL No. E43,G12

                                              ABSTRACT

This paper presents a dynamic equilibrium model of bond markets, in which two groups of agents
hold heterogeneous expectations about future economic conditions. Our model shows that heterogeneous
expectations can not only lead to speculative trading, but can also help resolve several challenges to
standard representative-agent models of the yield curve. First, the relative wealth fluctuation between
the two groups of agents caused by their speculative positions amplifies bond yield volatility, thus
providing an explanation for the "excessive volatility puzzle" of bond yields. In addition, the fluctuation
in the two groups' expectations and relative wealth also generates time-varying risk premia, which
in turn can help explain the failure of the expectation hypothesis. These implications, essentially induced
by trading between agents, highlight the importance of incorporating heterogeneous expectations into
economic analysis of bond markets.

Wei Xiong
Princeton University
Department of Economics
Bendheim Center for Finance
Princeton, NJ 08450
and NBER
wxiong@princeton.edu

Hongjun Yan
Yale School of Management
135 Prospect Street
Box 208200
New Haven, CT 06520-8200
hongjun.yan@yale.edu
1        Introduction

Following the seminal work of Vasicek (1977) and Cox, Ingersoll and Ross (1985), most
academic studies in the economics and finance literature use representative-agent models to
analyze yield curve dynamics. These models typically derive bond pricing formulas based on
a representative agent’s risk preferences and belief processes. This approach leads to tractable
parametric yield curve models that researchers can directly apply to data, e.g., Duffie and
Kan (1996) and Dai and Singleton (2001). Despite their recent success in capturing certain
dynamics of the yield curve,1 representative-agent models have limitations that prevent them
from addressing several other aspects of bond markets, such as trading and liquidity, because
these models do not involve interactions among heterogeneous agents. In this paper, we aim
to provide an equilibrium model of bond markets, in which heterogeneous agents trade with
each other.
        We allow agents to hold heterogeneous expectations of future economic conditions,2 and
then study the bond market dynamics resulting from the trading among these agents. Our
model builds on the equilibrium framework of Cox, Ingersoll and Ross (1985) with log-utility
agents and a constant-return-to-scale risky investment technology. Unlike their model, we
assume that there are two groups of agents using different learning models to infer the values
of an unobservable variable that determines the long-run returns of the risky technology. Be-
cause of the difference in the learning processes, the two groups of agents hold heterogeneous
expectations about future interest rates. Heterogeneous expectations motivate agents to take
speculative positions against each other in the bond markets, and market clearing conditions
determine equilibrium bond prices. We manage to solve this equilibrium in a closed form.
In particular, we derive that the price of a bond is a wealth weighted average of bond prices
in homogeneous economies, in each of which only one type of agent is present. We also
    1
    See Dai and Singleton (2003) and Piazzesi (2003) for recent reviews of this literature.
    2
    There is ample evidence supporting the existence of heterogeneous expectations among agents. Mankiw,
Reis and Wolfers (2004) find that the interquartile range among professional economists’ inflation expectations,
as shown in the Livingston Survey and the Survey of Professional Forecasters, varies from above 2% in the
early 1980s to around 0.5% in the early 2000s. Swanson (2005) finds that in the Blue Chip Economic Indicators
survey of major U.S. corporations and financial institutions between 1991 and 2004, the difference between
the 90th and 10th percentile forecasts of next-quarter real US GDP growth rate fluctuates between 1.5% and
5%, and the 90th and 10th percentile forecasts of four-quarter-behind 3-month Treasury bill rate fluctuates
between 0.8% and 2.2%.



                                                       1
obtain similar results for nominal bond pricing when we extend the model to incorporate
heterogeneous expectations about future inflation. By analyzing this equilibrium, our model
shows that agents’ heterogeneous expectations provide implications for the joint dynamics
of trading volume, bond yield volatility, market liquidity, time-varying risk premia, and the
yield curve.
   A direct implication of our model is that trading volume increases as the difference be-
tween agents’ beliefs widens. A higher belief dispersion causes agents to take larger speculative
positions against each other. As a result, they are more exposed to random shocks and have
to trade more to rebalance their portfolios after a shock.
   Incorporating heterogeneous expectations and the resulting speculative trading into our
model helps resolve several challenges encountered by standard representative-agent mod-
els. Because aggregate consumption is rather smooth, standard representative-agent models
have difficulties in generating the large bond yield volatility and highly variable risk premia
observed in actual data. To this end, our model shows that the relative wealth fluctuation
caused by agents’ speculative positions against each other amplifies bond yield volatility.
Since agents who are more optimistic about future interest rates bet on rates rising against
more pessimistic agents, any positive news about future rates would cause wealth to flow from
the pessimistic agents to the optimistic agents, giving the optimistic belief a larger weight
in determining equilibrium bond yields. The relative-wealth fluctuation thus amplifies the
effect of the initial news on bond yields. Our calibration exercise shows that this mechanism
can cause a significant amount of volatility amplification even with a modest amount of belief
dispersion. This volatility amplification effect thus helps explain the “excess volatility puz-
zle” documented by Shiller (1979), Gurkaynak, Sack and Swanson (2005), and Piazzesi and
Schneider (2006a). These studies find that long-term yields appear to be too volatile relative
to the levels implied by standard representative-agent models.
   Agents’ belief and wealth fluctuation can also cause the equilibrium risk premia to change
over time. From the view point of an econometrician who uses an objective learning pro-
cess to evaluate this equilibrium, the market price of risk (risk premium per unit of risk)
associated with the information shocks about future interest rates is proportional to the
difference between agents’ wealth weighted average belief and the econometrician’s belief.


                                               2
While agents’ belief fluctuation directly affects these risk premia, it is important to note
that agents’ relative wealth fluctuation can lead to time-varying risk premia even without
any belief fluctuation. The intuition is as follows. Suppose that the beliefs of the optimistic
group and the pessimistic group both stay constant over time and their average is exactly
that of the econometrician, which also stays constant. If the two groups have equal wealth
and so the wealth weighted average belief is the same as the econometrician’s belief, then the
current risk premia associated with the information shocks are exactly zero. However, after a
positive shock hits the market, the optimistic group would profit from the pessimistic group
through their existing positions against each other. As a result, the optimistic group’s belief
would carry a greater weight in the market, causing the two groups’ wealth weighted average
belief to rise above the econometrician’s belief and the risk premia to fluctuate.
   The time-varying risk premia generated by our model shed some light on the failure of
the expectations hypothesis, one of the classic theories of the yield curve dating at least back
as Fisher (1896), Hicks (1939), and Lutz (1940). According to Lutz (1940, pp. 37), “An
owner of funds will go into the long (term bond) market if he thinks the return he can make
there over the time for which he has funds available will be above the return he can make
in the short (rate) market over the same time, and vice versa.” To make the fund owner,
a representative agent in the bond market, indifferent about investing in a long-term bond
or the short rate, this argument implies that when the spread between the long rate and
short rate is large, the long rate tends to rise further (or the long bond price tends to fall).
However, empirical studies, e.g., Fama and Bliss (1987), Campbell and Shiller (1991), and
Cochrane and Piazzesi (2005), reject this prediction by finding that long rates tend to fall
when their spreads relative to the short rate are high. This finding is often attributed to
time-varying risk premia, but their sources remain elusive. Our model proposes a mechanism
through agents’ belief and wealth fluctuation, as the resulting risk premia are negatively
correlated with the yield spread between long and short rates. Our calibration exercise also
demonstrates that, with reasonable parameters, this mechanism is able to generate enough
time variation in risk premia to explain the observed empirical finding.
   By highlighting the effects caused by trading among agents with heterogeneous expecta-
tions, our analysis also cautions against a widespread practice of interpreting a representative


                                               3
agent’s belief process as the outcome of an actual agent’s learning process. In fact, we could
replicate the equilibrium price dynamics in our model by constructing a representative agent
who always holds the wealth weighted average belief of the two groups. This exercise sug-
gests that the change in the representative agent’s belief not only responds to the two groups’
belief fluctuation, but also to their relative wealth fluctuation. As a result, the constructed
representative agent’s belief process is inconsistent with a realistic Bayesian learning process,
because the former compromises the effects caused by trading between the two groups of
agents with heterogeneous expectations.
   In summary, our model provides a tractable but non-affine yield curve structure, which
simultaneously embeds stochastic volatility and time-varying risk premia. These features, as
emphasized by Dai and Singleton (2003) and Duffee (2002), are crucial for capturing the yield
curve dynamics. Our model also generates several testable predictions. First, higher belief
dispersion increases bond market trading volume. Second, higher belief dispersion increases
bond yield volatility and reduces bond market liquidity. Third, in an economy or a time
period with more belief dispersion among agents, spread between long-term bond yield and
short rate has a stronger predictive power for future yield changes. Finally, higher belief
dispersion reduces bond yields, especially for bonds with longer maturities.
   Our model complements the earlier equilibrium models with heterogeneous beliefs, e.g.,
Detemple and Murthy (1994) and Basak (2000, 2005). These models study the effects of
heterogeneous beliefs on stock returns and short rates, but not on the yield curve dynamics.
In addition, they do not analyze the effects of heterogeneous beliefs on volatility amplification
and time-varying risk premia. Our model differs in emphasis from Dumas (1989) and Wang
(1996), which provide models to analyze the effects of agents’ preference heterogeneity on
their wealth distribution and the yield curve. These papers also do not address volatility am-
plification and time-varying risk premia generated by trading between heterogeneous agents.
Finally, Dumas, Kurshev and Uppal (2005) analyze the effects of some agents’ irrational be-
liefs on market volatility and equity premium. Their study especially focuses on the rational
investors’ optimal responses to the presence of irrational investors in a general equilibrium
set-up. In contrast, our model focuses on the impacts of agents’ belief dispersion on the yield
curve dynamics, especially highlighting the role of agents’ relative wealth fluctuation.


                                               4
    The rest of the paper is organized as follows. Section 2 presents the model and derives
the equilibrium. Section 3 analyzes the effects of agents’ heterogeneous expectations on bond
market dynamics. Section 4 reconciles our model with standard representative-agent models
and Section 5 provides a calibration exercise of our model. Finally, Section 6 concludes the
paper. We provide all the technical proofs in Appendix A and an extension of our model in
Appendix B.


2     The Model

Our model adopts the equilibrium framework of Cox, Ingersoll and Ross (1985) with log-
utility agents and a constant-return-to-scale risky investment technology. Unlike their model,
ours assumes that agents cannot directly observe a random variable that determines future
returns of the risky technology, and that agents have to infer its value. There are two groups
of agents holding heterogeneous expectations regarding this variable. Because of this belief
dispersion, agents speculate in capital markets. We study a competitive equilibrium, in which
each agent optimizes consumption and investment decisions based on his own expectation.
Market clearing conditions determine the equilibrium short rate and bond prices. In the main
text of the paper, we focus on a model without inflation. In Appendix B, we obtain similar
results by extending the model to price nominal bonds.

2.1   The economy

We consider an economy with only one constant-return-to-scale technology. The return of
the technology follows a diffusion process:

                                    dIt
                                        = ft dt + σI dZI (t),                             (1)
                                     It

where ft is the expected instantaneous return, σI is a volatility parameter, and ZI (t) is a
standard Brownian motion.
    The expected instantaneous return from the risky technology, ft , follows another linear
diffusion process:
                              dft = −λf (ft − lt )dt + σf dZf (t),                        (2)



                                               5
where λf is a constant governing the mean reverting speed of ft , lt represents a moving long-
run mean of the risky technology’s expected return, σf is a volatility parameter, and Zf (t)
is a standard Brownian motion independent of ZI (t). As we will show later, the expected
instantaneous return of the technology ft , after adjusted for risk, determines the equilibrium
short rate, because this risky technology represents an alternative investment to investing in
the short term bond.
   The long-run mean lt is unobservable and follows an Ornstein-Uhlenbeck process:

                                dlt = −λl (lt − ¯l)dt + σl dZl (t),                         (3)

where λl is a parameter governing the mean-reverting speed of lt , ¯l the long-run mean of lt ,
σl a volatility parameter, and Zl (t) a standard Brownian motion independent of ZI (t) and
Zf (t). Since lt is the level, to which ft mean-reverts, it determines future short rates. As we
will later show, agents’ disagreement about lt thus leads to heterogeneous expectations about
future short rates.

2.2   Agents’ heterogeneous expectations

The existing economics and finance literature has pointed out several sources of heteroge-
neous expectations. First, Harris and Raviv (1993), Detemple and Murthy (1994), Morris
(1996) and Basak (2000) assume that agents hold heterogeneous prior beliefs about unobserv-
able economic variables. In these models, agents continue to disagree with each other even
after they update their beliefs using identical information and the difference in their beliefs
deterministically converges to zero. Second, Kurz (1994) argues that limited data make it
difficult for rational agents to identify the correct model of the economy from alternative
ones. As a result, model uncertainty could cause agents to use different learning models and
therefore to possess heterogeneous beliefs. Third, consistent with a broader interpretation
of heterogeneous priors and the model uncertainty argument, Scheinkman and Xiong (2003)
and Dumas, Kurshev and Uppal (2005) assume that agents use different model parameters in
their learning processes. As a result, agents could react differently to the same information,
and the difference in their posterior beliefs follows stationary processes.
   Following the last approach, we also assume that agents use different model parameters
in their learning processes. Since these parameters are part of their model for the whole

                                                6
economy, they do not update these parameters, instead they use them as the basis for their
learning processes about unobservable economic variables such as the long-run mean of risky
technology returns. This approach is tractable and generates stationary processes for differ-
ences in agents’ expectations.
    We now discuss agents’ expectations about future risky technology returns. In addition
to observing ft , agents also receive two public signals, S1 and S2 , about the unobservable
long-run mean of the risky technology’s return lt . These two signals follow the following
processes:

                                     dS1 (t) = lt dt + σs dZs1 (t),                                     (4)

                                     dS2 (t) = lt dt + σs dZs2 (t),                                     (5)

where Zs1 (t) and Zs2 (t) are standard Brownian motions that are independent of each other
and all other Brownian motions. For symmetry, we assume that these two signals share the
same noise volatility parameter σs .
    We assume that agents are divided in two groups and differ in their perceptions of the
signal processes. Specifically, agents in group 1 believe that S1 evolves according to
                                           ·           q               ¸
                                                              2
                      dS1 (t) = lt dt + σs φl dZl (t) + 1 − φl dZs1 (t) .                               (6)

Although this process has the same instantaneous volatility as the actual process in equation
(4), group-1 agents believe that φl ∈ [0, 1] fraction of the innovations to dS1 comes from dZl ,
the fundamental innovation to dlt itself. Thus, group-1 agents under-estimate the noise in S1 .
The parameter φl measures the degree of this noise under-estimation.3 On the other hand,
group-1 agents perceive that S2 evolves according to the actual process in equation (5).
    Similarly, we assume that group-2 agents perceive S1 in the actual process in equation
(4) and that they believe that S2 evolves according to
                                          ·            q               ¸
                                                             2
                      dS2 (t) = lt dt + σs φl dZl (t) + 1 − φl dZs2 (t) .                               (7)

In the same way that group-1 agents perceive S1 , group-2 agents incorrectly believe that φl
fraction of the innovation to S2 comes from dZl , and thus under-estimate the noise in S2 . For
   3
     Since group-1 agents have the correct volatility parameter of dS1 itself and the fundamental innovation
dZl is not observable, the value of φl cannot be directly inferred from the quadratic variation of dS1 and a
precise estimation would require a long series of data.


                                                     7
the sake of symmetry, the degree of group-2 agents’ noise under-estimation, φl , is the same
as that of group-1 agents.
   In summary, group-1 agents believe that these signals evolve according to equations (6)
and (5); while group-2 agents believe that these signals evolve according to equations (4)
and (7). Agents in each group make their economic decisions based on their own model
about the signals. We further assume that although agents in one group are aware of the
model used by the other group, they agree to disagree about the differences between their
models. The market equilibrium is thus determined by the interaction of the two groups of
agents. To evaluate the dynamics of this equilibrium, we will stand from the perspective of
an econometrician who believes the signals follow the actual processes in equations (4) and
(5). We will focus on the learning processes of the two groups in this section and derive the
econometrician’s in a later section.
   Agents’ information set at time t about lt includes {fτ , S1 (τ ), S2 (τ )}tτ =0 . We assume
that agents’ prior beliefs about lt have a Gaussian distribution. Since their information
flow also follows Gaussian processes, their posterior beliefs must likewise be Gaussian. The
difference in agents’ perceptions about the signal processes would cause the mean of their
posterior beliefs to differ; however, because of their symmetry, they would still share the same
posterior variance. According to the standard results in linear filtering, e.g., Theorem 12.7
of Liptser and Shiryaev (1977), agents’ belief variance converges to a stationary level at an
exponential rate. For our analysis, we will focus on the stationary equilibrium, in which the
belief variance of agents in both groups has already reached its stationary level γ̄l , which is
the positive root to the following quadratic equation of γ:
                     Ã           !      µ            ¶
                       λ2f    2    2           φl σl      ¡       ¢
                         2 + 2 γ + 2 λl +              γ − 1 − φ2l σl2 = 0.
                       σf     σs                σs

We denote group-i agents’ posterior distribution about lt at time t by
                                                          ³           ´
                     lt | {fτ , S1 (τ ), S2 (τ )}tτ =0 ∼ N ˆlti , γ̄ l ,   i ∈ {1, 2},

where ˆlti is the mean of group-i agents’ posterior distribution. We will refer to ˆlti as their
belief hereafter.



                                                      8
   Theorem 12.7 of Liptser and Shiryaev (1977) also provides that ˆlti is determined by

       dˆlti = −λl (ˆlti − ¯l)dt + λf σf−1 γ̄l dZbfi (t) + σs−1 (γ̄l + φl σs σl ) dZ
                                                                                   bsi
                                                                                     i                 bsj
                                                                                       (t) + σs−1 γ̄l dZ i
                                                                                                           (t)    (8)

where j ∈ {1, 2} and j 6= i. dZbfi , dZ
                                      bi and dZbi are “surprises” in the three sources of
                                       si       sj

information to group-i agents:

                                                 1    h                       i
                                     bi
                                    dZ f   =           dft + λf (ft − ˆlti )dt ,                                  (9)
                                                 σf
                                                 1    h                 i
                                    bsi
                                   dZ i
                                        =              dSi (t) − ˆlti dt ,                                       (10)
                                                 σs
                                                 1    h                 i
                                    bi
                                   dZsj    =           dSj (t) − ˆlti dt .                                       (11)
                                                 σs
          bi , Z
Note that Z    bi and Z
                      bi are independent standard Brownian motions in group-i agents’
            f    si    sj

probability measure. Equation (8) shows that under-estimation of noise in signal S1 causes
                                   b1 (t), the surprise in dS1 . Similarly, group-2 agents
group-1 agents to “over-react” to dZ s1

over-react to the surprise in dS2 . As a result, these two groups hold different beliefs about lt .
   In group-i agents’ probability measure, ft , S1 (t) and S2 (t) follow

                                   dft = −λf (ft − ˆlti )dt + σf dẐfi (t),                                      (12)

                                  dS1 = ˆlti dt + σs dẐs1
                                                        i
                                                           (t),                                                  (13)

                                  dS2 = ˆlti dt + σs dẐs2
                                                        i
                                                           (t).                                                  (14)

Thus, the difference in agents’ beliefs about lt translates into different views about the dy-
namics of these variables and, subsequently, into different expectations of future short rates.

2.3   Capital markets

The difference in agents’ beliefs causes speculative trading among them. Agents who are more
optimistic about lt would bet on interest rates going up against more pessimistic agents. Note
that, in each group’s measure, there are four types of random shocks. For group-i agents,
                                i , and dẐ i . Thus, the markets are complete if agents can
the shocks are dZI , dẐfi , dẐs1         s2

trade a risk free asset and four risky assets that span these four sources of random shocks.
In reality, bond markets offer many securities, such as bonds with different maturities, for
agents to construct their bets and to complete the markets. As a result, we analyze agents’

                                                          9
investment and consumption decisions, as well as their valuations of financial securities, in a
complete-markets equilibrium.
    We introduce a zero-net-supply risk free asset and three zero-net-supply risky financial
securities in the capital markets, in addition to the risky production technology.4 At time
t, the risk free asset offers a short rate rt . The rate is determined endogenously in the
equilibrium. The three risky financial securities offer the following return processes:

                                      dpf
                                             = µf (t)dt + dft ,                                          (15)
                                       pf
                                     dps1
                                             = µs1 (t)dt + dS1 (t) ,                                     (16)
                                      ps1
                                     dps2
                                             = µs2 (t)dt + dS2 (t) .                                     (17)
                                      ps2

We refer to these securities as security f , security S1 , and security S2 , respectively. Like
futures contracts, these securities are continuously marked to the fluctuations of dft , dS1 (t) ,
and dS2 (t) , respectively. Since agents hold different views about the underlying innovation
processes of these securities, they disagree about their expected returns. As a result, some
agents want to take long positions, while others want to take short positions. Through
trading, the contract terms µf (t), µs1 (t), and µs2 (t) are continuously determined so that
the aggregate demand for each of the securities is zero at any instant. We could also view
these financial securities as synthetic positions constructed by dynamically trading bonds.
We choose to introduce these securities instead of specific bonds to simplify notation, and
our specific choice of securities does not affect the equilibrium in complete markets.
    To further simplify notation, we put the return processes of securities f , S1 , and S2 in a
column vector:                                µ                    ¶0
                                       ~t =       dpf dps1 dps2
                                      dR             ,    ,              ,
                                                   pf ps1 ps2
where   0   is the transpose operator. By substituting equations (12), (13), and (14) into the
return processes of the risky securities, we can rewrite them in group-i agents’ probability
measure as
                                         ~t = µ
                                        dR                   ~ i (t) ,
                                              ~ it dt + Σ · dZ
   4
     We also allow agents to short-sell the risky technology. This can be implemented by offering a derivative
contract on the return of the technology. The market clearing conditions, however, require that agents in
aggregate hold a long position in the risky technology.


                                                     10
where the vector of expected returns is given by
                               i                                      
                                µ̂f (t)         µf (t) − λf (ft − ˆlti )
                       ~ it =  µ̂is1 (t)  = 
                       µ                             µs1 (t) + ˆlti      ,                        (18)
                                  i
                                µ̂s2 (t)                       ˆ
                                                     µs2 (t) + lt i


and the volatility matrix Σ and the diffusion vector dZ ~ i (t) are given           by
                                                                                 
                           σf                                     dẐfi (t)
                                                               
                                                   ~ i (t) =  dẐ i (t)            
                    Σ=        σs       and dZ
                                                                     s1             .
                                   σs                                i (t)
                                                                  dẐs2

    We assume that all agents have an identical logarithmic preference. Agents in group
i maximize their lifetime utility from consumption by investing in all available securities
according to their beliefs:                               Z   ∞
                                      max            Ei           e−βt u(cit )dt,
                                              ~ i}
                                   {cit ,xiI ,X           0

where E i is the expectation operator under their probability measure, β is their time-
preference parameter, and
                                               u(cit ) = log(cit )

is their utility function from consumption. Agents can choose their consumption cit , the
fraction of their wealth invested in the risky technology xiI , and the fractions of their wealth
invested in the three financial securities:
                                                ¡                ¢
                                           ~ i = xi , xis1 , xis2 0
                                           X      f

                       ~ i corresponding to the fraction of wealth invested in securities f ,
with each component of X
S1 , and S2 .
    Given group-i agents’ investment and consumption strategies, their wealth process follows

   dWti h       i    i    i
                                             ¡ i
                                         ~i · µ
                                                       ¢i
                                                               ~ i · Σ · dZ
                                                                          ~ i (t) + xiI dZI (t).
        = rt − ct /Wt  + xI (ft − rt ) + X    ~ t − rt    dt + X                                   (19)
    Wti
We can solve these agents’ consumption and investment problems using the standard dynamic
programming approach developed by Merton (1971). The results for logarithmic utility are
well known. Agents always consume wealth at a constant rate equal to their time preference
parameter:
                                                     cit = βW it ,

                                                          11
and they invest in risky assets according to the assets’ instantaneous risk-return tradeoff –
the ratio between expected excess return and return variance:

                                  ft − rt         ¡ i       ¢0 −2
                          xiI =           and ~i = µ
                                              X    ~ t − rt   ·Σ .                          (20)
                                    σI2

2.4   Equilibrium asset prices

We adopt a standard definition of competitive equilibrium. In the equilibrium, each agent
chooses optimal consumption and investment decisions in accordance with his expectations
and all markets clear. Market clearing conditions ensure: 1) the aggregate investment to the
risk free asset is zero; 2) the aggregate investment to each of the risky securities f , S1 , and
S2 is also zero; and 3) the aggregate investment to the risky technology is equal to the total
wealth in the economy. We describe the equilibrium in the following theorem, and provide
the proof in Appendix A.1.

Theorem 1 In equilibrium, the real short rate is

                                             rt = ft − σI2 .                                (21)

Let ωti is the wealth share of group-i agents in the economy:
                                                                      2
                                                                      X
                                           Wti
                                   ωti ≡       ,     Wt ≡                   Wti .
                                           Wt
                                                                      i=1

Then, the contract terms µf (t), µs1 (t), and µs2 (t) of the risky securities are determined by
                                                                       2
                                                                       X
                                  µf   = rt + λf ft − λf                     ωti ˆlti ,     (22)
                                                                       i=1
                                                   2
                                                   X
                               µs1 = rt −                ωti ˆlti ,                         (23)
                                                   i=1
                                                   X2
                               µs2 = rt −                ωti ˆlti .                         (24)
                                                   i=1

The aggregate wealth in the economy fluctuates according to

                                  dWt
                                      = (ft − β) dt + σI dZI (t).                           (25)
                                   Wt


                                                    12
   This theorem shows that the short rate is the expected instantaneous return of the risky
technology adjusted for risk (equation (21)) This is because agents would demand a higher
return from lending out capital when the expected return from the alternative option of
investing in the risky technology is higher. Equations (22)-(24) provide the contract terms
of the three financial securities. Each of these terms is determined by the short rate, rt ,
minus the wealth weighted average of agents’ beliefs about the drift rate of the corresponding
security’s underlying factor. Equation (25) shows that the aggregate wealth in the economy
grows at a rate determined by the return from the risky technology, ft dt + σI dZI (t), minus
agents’ consumption rate, βdt. This is because the risky technology is the only storage
technology in the economy.
                                                                                     Wt1
   We denote the wealth ratio between agents in groups 1 and 2 by ηt ≡               Wt2
                                                                                         ,   and the
difference in beliefs by gl (t) ≡ ˆlt1 − ˆlt2 . Then we will refer to the absolute value of gl (t),
|gl (t) |, as the belief dispersion. The following proposition characterizes the dynamics of the
wealth ratio, with the proof in Appendix A.2.

Proposition 1 The wealth ratio process ηt evolves in group-2 agents’ probability measure
according to                     ·                                   ¸
                        dηt        λf    2     1   2       1   2
                            = gl      dẐ (t) + dẐs1 (t) + dẐs2 (t) .                         (26)
                        ηt         σf f        σs          σs
Moreover, if XT is a random variable to be realized at time T > t and E 1 [XT ] < ∞, then
group-1 agents’ expectation of XT at time t can be transformed into group-2 agents’ expecta-
tion through the wealth ratio process between the two groups:
                                                 ·      ¸
                                     1          2 ηT
                                   Et [XT ] = Et      XT .
                                                   ηt

   Equation (26) shows that the volatility of the wealth ratio is proportional to belief dis-
persion |gl (t) |. Intuitively, higher belief dispersion induce agents to take more aggressive
speculative and so their wealth ratio becomes more volatile. Proposition 1 also shows that
the wealth ratio process between agents in groups 1 and 2 acts as the Randon-Nikodyn
derivative of group-1 agents’ probability measure with respect to group-2 agents’ measure.
The intuition is as follows. If group-1 agents assign a higher probability to a future state
than group-2 agents, it is natural for these agents to trade in such a way that the wealth


                                                13
ratio between them, W 1 /W 2 , is also higher in that state. Proposition 1 implies that, as a
consequence of logarithmic preference, the ratio of probabilities assigned by these groups to
different states is perfectly correlated with their wealth ratio. This result allows us to derive a
simple asset pricing formula in the heterogeneous economy. It is also important to note that
no single group would be able to drive out the other one and eventually dominate the market.
Due to the symmetric structure in the two groups’ learning models, the wealth distribution
is stationary.5
      The property of the two groups’ wealth ratio process in Proposition 1 leads to a simple
expression of asset prices in the heterogeneous economy, as shown in the following theorem.
We provide the proof in Appendix A.3.

Theorem 2 In a heterogeneous economy with two groups of agents, the price of an asset,
which provides a single payoff XT at time T , is given by

                                         Pt = ωt1 Pt1 + ωt2 Pt2 ,

where Pti is the value of the asset in a homogeneous economy, whereby only group-i agents
are present.

      Theorem 2 shows that the price of an asset is the wealth weighted average of each group’s
valuation of the asset in a corresponding homogeneous economy. This result allows us to
derive asset prices in a heterogeneous economy using prices in homogeneous economies. Thus,
asset pricing is remarkably simple even in a complex environment with heterogeneous agents.
While this result depends on agents’ logarithmic preference and linear risky technology, it is
independent of the specific information structure in our model. Detemple and Murthy (1994)
provide a similar result in a model with heterogeneous prior beliefs.

2.5     Bond pricing with homogeneous agents

Theorem 2 allows us to express the price of a bond as the wealth weighted average of each
group’s bond valuation in a homogeneous economy. Thus, before analyzing the effects of
  5
    See Kogan, Ross, Wang, Westerfield (2004) and Yan (2005) for more discussions on the possibility that
one group might dominate in the long run when it has a more accurate belief process than the other group.



                                                   14
agents’ heterogeneous expectations on bond markets, we first derive bond prices in homoge-
neous economies in the following proposition 2, with a proof in Appendix A.4.

Proposition 2 In a homogeneous economy with only group-i agents, the price of a zero-
coupon bond with a maturity τ is determined by
                                ³            ´                        i
                             B H τ, ft , ˆlti = e−af (τ )ft −al (τ )l̂t −b(τ ) ,

where

              1 ³              ´
   af (τ ) =       1 − e−λf τ ,                                                               (27)
             λf
              1 ³             ´      1    ³               ´
   al (τ ) =      1 − e−λl τ +             e−λf τ − e−λl τ ,                                  (28)
             λl                   λf − λl
             Zτ ·                                                                           ¸
                     ¯         1 2      2   1¡ 2          ¢     2                         2
    b(τ ) =       λl lal (s) − σf af (s) −    σ − 2λl γ̄l al (s) − λf γ̄l af (s)al (s) − σI ds.
                               2            2 l
               0

   Proposition 2 implies that the yield of a τ -year bond in a homogeneous economy
                      ³            ´   1   ¡   ¢ af (τ )      al (τ ) ˆi b(τ )
                   Y H τ, ft , ˆlti = − log B H =        ft +         l+
                                       τ           τ             τ t      τ

is a linear function of two fundamental factors: ft and ˆlti . This specific form belongs to the
general affine structure proposed by Duffie and Kan (1996).
   The loading on ft , af (τ )/τ , has a value of 1 when the bond maturity τ is zero and
monotonically decreases to zero as the maturity increases, suggesting that short-term yields
are more exposed to fluctuations in ft . The intuition of this pattern is as follows. ft is the
expected instantaneous return from the risky technology, which can serve as a close substitute
for investing in short-term bonds. As a result, the fluctuation in ft has a greater impact on
short-term yields. As bond maturity increases, the impact of ft becomes smaller.
   Agents’ belief about lt determines their expectation of future returns from the risky
technology, because lt is the level to which ft mean-reverts. In the case with mean-reversion
(λl > 0 ), the loading of the bond yield on ˆlti , al (τ )/τ , has a humped shape. As the bond
maturity increases from 0 to an intermediate value, al (τ )/τ increases, suggesting that agents’
expectation has a greater impact on longer term yields. As the bond maturity increases
further, al (τ )/τ drops. This is caused by the mean reversion of lt , which causes any shock

                                                    15
to lt to eventually die out. This force causes the yields of very long-term bonds to have low
exposure to agents’ belief about lt . In the case where mean reversion is no present (λl = 0 ),
the factor loading al (τ )/τ is a monotonically increasing function of bond maturity.


3     Effects of Heterogeneous Expectations

In this section, we discuss the effects of agents’ heterogeneous expectations on bond markets.
We combine Proposition 2 with Theorem 2 to express the price of a τ -year zero-coupon bond
at time t as
                                        ³            ´         ³            ´
                            Bt = ωt1 B H τ, ft , ˆlt1 + ωt2 B H τ, ft , ˆlt2 ,                  (29)
                                                                           ³            ´
where ωt1 and ωt2 are the two groups’ wealth shares in the economy, and B H τ, ft , ˆlti , given
in Proposition 2, is the bond price in a homogeneous economy wherein only group-i agents
are present. The implied bond yield is

                             1
                 Yt (τ ) = − log (Bt )
                             τ
                           af (τ )      b(τ ) 1   h               1                  2
                                                                                       i
                         =         ft +      − log ωt1 e−al (τ )l̂t + ωt2 e−al (τ )l̂t .
                             τ           τ    τ

Note that Yt is not a linear function of agents’ beliefs ˆlt1 and ˆlt2 . That is, bond yields in this
heterogeneous economy have a non-affine structure. This structure derives from the market
aggregation of agents’ heterogeneous valuations of the bond. This structure serves as the
basis for our analysis of the effects of heterogeneous expectations. Note that this structure
still holds for nominal bond pricing, as illustrated in Appendix B.

3.1    Trading volume

Heterogeneous expectations cause agents to take speculative positions against each other in
bond markets. These speculative positions can cause fluctuations in agents’ wealth upon
the arrivals of random shocks. As a result, agents trade with each other to rebalance their
positions. Intuitively, when belief dispersion increases, the size of their speculative positions
becomes larger. This in turn leads to a higher volatility of agents’ wealth and therefore
a larger trading volume in the bond markets. We use the volatility of one group’s position
changes as a measure of trading volume. This measure corresponds to the conventional volume


                                                   16
measure in a discrete-time set up. We summarize the effect of agents’ belief dispersion on
trading volume in Proposition 3, and provide a formal derivation and further discussion on
our volume measure in Appendix A.5.

Proposition 3 Trading volume (fluctuation in agents’ speculative positions) increases with
the belief dispersion between the two groups of investors.

   There is now a growing literature analyzing trading volume caused by heterogeneous
beliefs, e.g., Harris and Raviv (1993) and Scheinkman and Xiong (2003). While these models
demonstrate that heterogeneous beliefs lead to trading, trading typically occurs when agents’
beliefs flip, that is, gl changes its sign. Thus, trading volume of this type only increases with
the frequency that agents’ beliefs flip. Our model adds to this literature by showing that even
without agents’ beliefs flipping, the wealth fluctuation caused by their speculative positions
already leads to trading.

3.2   Volatility amplification

The wealth fluctuation caused by agents’ speculative positions against each other not only
leads to trading in bond markets, but also amplifies bond yield volatility. Loosely speaking,
bond yields are determined by agents’ wealth weighted average belief about future interest
rates. Since agents who are more optimistic about future rates bet on these rates rising
against more pessimistic agents, any positive news about future rates would cause wealth
to flow from pessimistic agents to optimistic agents, making the optimistic belief carry a
greater weight in bond yields. The relative-wealth fluctuation thus amplifies the impact of
the initial news on bond yields. As a result, a higher belief dispersion increases the relative-
wealth fluctuation and so increases bond yield volatility. We summarize this intuition in the
following proposition, and provide a formal proof in Appendix A.6.

Proposition 4 Bond yield volatility increases with belief dispersion.

   This volatility amplification mechanism can help explain the “excess volatility puzzle”
for bond yields. Shiller (1979) shows that the observed bond yield volatility exceeds the
upper limits implied by the expectations hypothesis and the observed persistence in short

                                               17
rates. Gurkaynak, Sack and Swanson (2005) also document that bond yields exhibit ex-
cess sensitivity to particular shocks, such as macroeconomic announcements. Furthermore,
Piazzesi and Schneider (2006a) find that by estimating a representative agent asset pricing
model with recursive utility preferences and exogenous consumption growth and inflation,
the model predicts less volatility for long yields relative to short yields. Relating to this
literature, Proposition 4 shows that extending standard representative-agent models with
heterogeneous expectations can help account for the observed high bond yield volatility. In
Section 5, we provide a calibration exercise to illustrate the magnitude of this mechanism.
    Through the volatility amplification effect, heterogeneous expectations could also shed
some light on the time variation of market liquidity in bond markets. Let’s consider the
following thought experiment. Suppose that agents in one group suffer a liquidity shock and
need to sell a fraction of their positions. The resulting price impact is a commonly used
measure of liquidity. Since this selling would suppress prices and reduce these agents’ wealth,
the initial price impact of these sales would be further amplified by the change in these agents’
wealth relative the other group. As a result, if there exists a larger belief dispersion among
the two groups (or if agents’ existing positions are larger), the amplification effect is stronger
and the net price impact of one group’s liquidity selling will be larger, causing the market
liquidity to be lower.6

3.3    Time-varying risk premia

Fluctuations in agents’ belief dispersion and relative wealth also cause risk premia in the
economy to vary over time. To examine risk premia, we analyze the dynamics of the stochastic
discount factor from the perspective of an econometrician who uses the actual signal processes
in forming his expectations. We derive this econometrician’s learning process and stochastic
discount factor in Appendix A.7 and summarize the result in the following Proposition.

   6
     A similar wealth amplification mechanism has been employed by Xiong (2001) to explain the observed
high volatility and low liquidity during the crisis period of the hedge fund Long-Term Capital Management
in the late summer of 1998. His model shows that the wealth fluctuation of some highly leveraged market
participants can lead to large price reactions to liquidity shocks. By explicitly relating the magnitude of this
wealth amplification effect to agents’ belief dispersion, our model demonstrates fluctuation in agents’ belief
dispersion as a source of time-varying volatility and liquidity.




                                                      18
Proposition 5 From the view point of an econometrician who holds the objective probability
measure, the stochastic discount factor has the following process
                                      Ã        2
                                                        !µ                      ¶
     dMt                                      X            λf R    1      1
           = −(ft − σI )dt − σI dZI − ˆlt −
                       2                 R
                                                 ωt ˆlt
                                                   i  i               R
                                                              dZf + dZs1     R
                                                                         + dZs2   ,
      Mt                                                   σf      σs     σs
                                                 i=1

where ˆltR is the econometrician’s belief about lt , and dZfR , dZs1
                                                                  R , and dZ R , defined in equations
                                                                            s2

(39)-(41), are independent information shocks in the econometrician’s probability measure.

   Proposition 5 shows that from the view point of the econometrician the market price
of risk (risk premium per unit of risk) for the aggregate production shock dZI is σI . The
market prices of risk for the three information shocks related to lt (dZfR , dZs1
                                                                                R , and dZ R ) are
                                                                                           s2
                     P
proportional to ˆlt − i=1 ωt ˆlt , the difference between the econometrician’s belief about lt and
                  R    2    i  i

the wealth weighted average belief of group-1 and group-2 agents. If the two groups’ wealth
weighted average belief about lt happens to equal the econometrician’s, the instantaneous
risk premia for the information shocks are zero. However, as the two groups’ beliefs and their
relative wealth change over time, these risk premia also fluctuate.
   It is simple to see how agents’ belief fluctuation affects risk premia. When all agents
become more optimistic about lt than the econometrician, the current bond price would
appear low to the econometrician. As a result, the econometrician expects a high bond
return going forward, or equivalently, he perceives positive risk premia associated with the
information shocks about lt . It is important to note that agents’ relative wealth fluctuation
could lead to time-varying risk premia even without any belief fluctuation. The intuition
works as follows. Suppose that the beliefs of the optimistic group and the pessimistic group
both stay constant over time and their average is exactly that of the econometrician, which
also stays constant. If the two groups have equal wealth, and therefore the difference between
their wealth weighted average belief and the econometrician’s belief is zero, then the current
risk premia associated with the information shocks are exactly zero. However, after a positive
shock hits the market, the optimistic group would profit from the pessimistic group through
their existing positions against each other. As a result, the optimistic group’s belief would
carry a greater weight in the market, causing the two groups’ wealth weighted average belief
to rise above the econometrician’s belief and the risk premia to become positive. Thus,


                                                 19
as long as the two groups hold heterogeneous expectations, the relative wealth fluctuation
caused by their speculative positions could generate time-varying risk premia even without
any fluctuation in their beliefs.
   The time variation of risk premia in our model can help explain the failure of the ex-
pectations hypothesis. The expectations hypothesis posits that a representative agent in the
bond market should be indifferent about the choice to invest his money in a long-term bond
or in the short rate over the same period. A direct implication of this argument is that when
the spread between the long rate and short rate is large, the long rate tends to rise further
(or the long bond price tends to fall), because otherwise the representative agent could not
be indifferent about the investment choice between the long-term bond and the short rate.
Despite its intuitive appeal, this prediction is rejected by many empirical studies, e.g., Fama
and Bliss (1987), Campbell and Shiller (1991) and, more recently, Cochrane and Piazzesi
(2005). By regressing the monthly change of the yield of a zero coupon bond onto the spread
between the bond yield and one-month short rate, Campbell and Shiller (1991) find negative
coefficients for bonds with maturities ranging from 3 months to 10 years.
   The literature often attributes the failure of the expectations hypothesis to time-varying
risk premia. Dai and Singleton (2002) find that certain classes of affine term structure models
with time-varying risk premia are able to match the aforementioned bond yield regression
results. However, the economic determinants of the time-varying risk premia still remain
elusive. Some studies, e.g., Wachter (2006) and Dai (2003), argue for the time-varying risk
preference of the representative agent, while our model proposes a new mechanism based
on agents’ heterogeneous expectations. The intuition is quite simple. When agents’ wealth
weighted belief about lt is high relative to the econometrician’s, the yield spread between a
long-term bond yield and the short rate tends to be large. Proposition 5 provides that the risk
premia associated with the information shocks on lt are negative in this case. Since the long-
term bond price loads negatively on these shocks (bond prices are inversely related to lt ), the
expected bond return from the econometrician’s view point is high, or equivalently, the bond
yield is expected to fall. Thus, the time-varying risk premia in our model lead to a negative
relationship between the yield spread and future bond yield changes. In Section 5, we provide
a simulation exercise to show that, with reasonable parameter values, this mechanism can


                                              20
generate bond yield regression coefficients close to those obtained in empirical studies.

3.4      Convex price aggregation

Aggregating agents’ heterogeneous bond valuations also directly affects the levels of equilib-
rium bond prices. Proposition 2 shows that the price of a bond in a homogeneous economy
is a convex function of agents’ beliefs about lt :
                                           ³            ´             i
                                        B H τ, ft , ˆlti ∼ e−al (τ )l̂t .

This property is a natural outcome of the fact that the bond price is a convex function of
the bond yield. Since the price of the bond in a heterogeneous economy is a wealth weighted
average of each group’s bond valuation in the corresponding homogeneous economy, Jensen’s
inequality implies that agents’ belief dispersion would increase the bond price.7 We state this
effect in Proposition 6, with the proof in Appendix A.8.

Proposition 6 Bond prices increase in belief dispersion. Furthermore, the price increases
are larger for bonds with longer maturities.

       It is important to note that the effect of belief dispersion on bond prices does not rely
on short-sales constraints. The existing literature, e.g., Miller (1977), Harrison and Kreps
(1978), Morris (1996), Chen, Hong and Stein (2002) and Scheinkman and Xiong (2003),
has shown that when short-sales of assets are prohibited or costly, investors’ heterogeneous
beliefs would cause asset overvaluation because asset prices are determined by optimists’
beliefs with pessimists sitting on the sideline. Our model shows that even without short-sales
constraints, heterogeneous beliefs could still increase bond prices through the aggregation
of agents’ (convex) bond valuations.8 We have also examined various numerical examples
and find that, while this effect is small when agents’ beliefs are close to each other, it could
become large when agents’ belief dispersion is great.9
   7
     Note that even though agents’ belief dispersion increases bond prices, shorting bonds does not provide an
arbitrage profit. This is because that bond prices fluctuate randomly before maturities and the interim price
volatility is particularly high when belief dispersion is larger, as shown in Proposition 4.
   8
     Yan (2006) analyzes a similar mechanism on the aggregation of noise trading.
   9
     To save space, we do not report these examples in the paper, but they are available upon request.




                                                      21
    There is some evidence supporting the effect of heterogeneous expectations on bond prices.
Bomberger and Frazer (1981) examine the relationship between long-term interest rates and
dispersion of inflation forecasts in the Livingston survey data. They find that the 3 to 5-year
rate and 10-year rate are both negatively related to the dispersion in inflation forecasts. Their
result implies that belief dispersion increases bond prices, thus is consistent with our model.


4    Reconciling with Representative-Agent Models

Standard results suggest that we can construct a representative agent to replicate price dy-
namics in a complete-markets equilibrium with heterogeneous agents. Does this mean that
we can simply focus on the representative agent’s belief process and ignore the heterogeneity
between agents? This section explains why the answer is no.
    We could construct a representative agent model to replicate the above equilibrium.10 If
we restrict the representative agent to having the same logarithmic preference as the group-1
and group-2 agents, we obtain the same equilibrium as before by “twisting” the representative
agent’s belief, as summarized in the following proposition with a proof in Appendix A.9.

Proposition 7 Suppose that we want to construct a representative agent model to replicate
the equilibrium in Section 2, and that the representative agent has the same logarithmic pref-
erence as agents in the heterogeneous economy. Then, at any point of time, the representative
agent’s belief about lt , ˆltA , has to be the wealth weighted average belief of group-1 and group-2
agents:
                                          ˆlA = ω 1 ˆl1 + ω 2 ˆl2 .                                (30)
                                            t    t t       t t


    It is important to stress that the representative agent’s belief must equal the wealth
weighted average belief not only at one point of time, but also at all future points. Thus,
over time, the representative agent’s belief would change in response to not only the belief
fluctuation of each group, but also to the relative wealth fluctuation caused by trading between
the two groups. Note that the relative wealth fluctuation can be affected by some factors,
which are unrelated to lt . In this case, although any rational Bayesian investor’s belief
  10
     See Jouini and Napp (2005) for a recent discussion on the existence of a “consensus” belief for the
representative agent in markets with agents holding heterogeneous beliefs.



                                                    22
about lt should not respond to these factors, Proposition 7 suggests that the representative
agent’s belief would respond to these unrelated factors because they affect the relative wealth
distribution.11
     Another issue concerns the interpretation of the uncertainty faced by this constructed
representative agent. Intuitively, in the presence of agents with heterogeneous expectations,
there are two distinct concepts: belief dispersion and uncertainty. Belief dispersion captures
the interpersonal variation in expectations, while uncertainty represents the intrapersonal
variation.12 However, these two concepts collapse into one when we construct the represen-
tative agent. We illustrate this point by applying Ito’s lemma to equation (30) to derive the
representative agents’ belief dynamics from the econometrician’s view point:
                                    "    Ã              !µ                      ¶        #
                  ³        ´                λ 2
                                                    2                    g 2η
                                                                                    φ σ     ³          ´
                                              f                           l t        l l
    dˆltA = −λl ˆltR − ¯l dt − λl +             +            γ̄ l +               +          ˆ
                                                                                             l A
                                                                                               t − ˆ
                                                                                                   lt
                                                                                                     R
                                                                                                         dt
                                            σf2     σs2              (ηt + 1)2       σs
                   µ                  ¶               µ                                      ¶
                λf            gl2 ηt       R      1                gl2 ηt        ηt                R
             +       γ̄l +              dẐf +          γ̄l +                 +      φl σl σs dẐs1
                σf         (ηt + 1)2             σs             (ηt + 1)2 ηt + 1
                   µ                                     ¶
                1            gl2 ηt        1                     R
             +      γ̄l +             +         φl σl σs dẐs2                                             (31)
                σs         (η + 1)2 ηt + 1

where dẐfR , dẐs1
                 R , and dẐ R are independent information shocks to the econometrician.
                            s2

     One fact we extract from the above formula is that the uncertainty faced by this represen-
tative agent reflects both individual investors’ uncertainty and the belief dispersion among
them. More precisely, we can compare the representative agent’s belief process with that of
an individual agent in equation (8). The representative agent’s response coefficient to the
                               ³                 ´
                            λ           g 2 ηt
information shock in dft is σff γ̄l + (η l+1)  2   , while a group-i agent’s response coefficient is
                                               t
λf                                                                                            t    g2 η
σf γ̄l .   The difference in these two coefficients suggests that we can interpret γ̄l + (η l+1)2 as the
                                                                                                    t

   11
      For example, when we extend our model to incorporate price inflation and agents’ speculation about
future inflation rates in Appendix B, the two groups’ relative wealth also fluctuates with shocks related to
future inflation rates. In this case, the representative agent’s belief about future technology returns would also
respond to these inflation related shocks, even though they contain no information about future technology
returns.
   12
      Belief dispersion is often taken for granted as a symptom of greater uncertainty. However, these are two
distinct concepts. However, Zarnowitz and Lambros (1987) clarify this conceptual difference, and empirically
examine it using survey data from the Survey of Professional Forecasters. Since this survey also asks re-
spondents to supplement their point estimates with estimates of the probability that GDP and the implicit
price deflator will fall into various ranges, Zarnowitz and Lambros measure uncertainty from these probability
estimates. By comparing the uncertainty measure with measures of interpersonal forecast dispersion, they
find only weak evidence that uncertainty and belief dispersion are positively correlated.


                                                       23
representative agent’s uncertainty level. Hence, the representative agent’s uncertainty reflects
both individual investors’ uncertainty γ̄, and the belief dispersion among them |gl |. When
the belief dispersion increases, the representative agent would act as if there was greater
uncertainty even though the uncertainty faced by each agent remains unchanged. The same
effect also exists in the representative agents’ response coefficients to the information shocks
in dS1 and dS2 .
    In summary, we could construct a representative agent model to replicate the model with
heterogeneous expectations. However, this does not mean that the effects of heterogeneous
expectations are not important. First, one has to be cautious when interpreting the con-
structed representative agent’s belief process as representing a realistic learning process. In
the presence of heterogenous beliefs, the representative agent’s belief about a fundamental
variable has to respond to informationally irrelevant factors. Moreover, the “uncertainty”
faced by this representative agent reflects both individual investors’ uncertainty and the belief
dispersion among them. Second, incorporating agents’ heterogeneous expectations and the
resulting speculation and wealth fluctuation can help resolve several challenges to standard
representative-agent models, such as large bond yield volatility and time-varying risk premia,
as we discussed in the previous section.


5    Calibration

In this section, we illustrate the impact of agents’ heterogeneous expectations on bond mar-
kets by simulating 50 years of monthly bond yield data based on a set of calibrated model
parameters. In particular, we highlight the magnitudes of the volatility amplification effect
and of the bond-yield regression result.
    In our model, the short rate process is independent of agents’ heterogeneous expectations
of future rates. Applying Ito’s lemma to the short rate (rt = ft − σI2 ) provides that

                             drt = −λf [rt − (lt − σI2 )]dt + σf dZf .

The short rate mean-reverts to a time-varying long-run mean lt − σI2 . Baldduzzi, Das and
Foresi (1998) and Fama (2006) estimate two-factor interest rate models with the same struc-
ture as described above. Baldduzzi, Das and Foresi find that the long-run mean of the short

                                                24
rate moves slowly with a mean-reversion parameter as low as 0.03. Fama argues that this
long-run mean process might be nonstationary or have a mean reversion parameter close to
zero. Since the mean-reversion parameter of this long-run mean process corresponds to λl ,
we choose λl to be 0.02, as a compromise between these two studies. This number implies
that it takes log(2)/λl = 34.66 years for the effect of a shock to the long-run mean of the
short rate to die out by half. Baldduzzi, Das and Foresi also show that the mean-reversion
parameter of the short rate (λf in our model) ranges from 0.2 to 3 in different sample periods
between 1952 and 1993. Thus, we choose a value of 1.5 for λf . This number implies that it
takes log(2)/λf = 0.46 year for the difference between the short rate and its long-run mean
to converge by half.13
       We choose σf = 1.2% to match the short rate volatility in the data, and set σl = 1.5% so
that the implied volatility of each agent’s belief about lt is 0.44% per month, in the middle
of the range from 0.1% to 0.6% estimated by Balduzzi, Das, and Foresi (1998). Furthermore,
since σI measures agents’ aggregate consumption volatility (Theorem 1), we choose σI = 2%
to match the aggregate consumption volatility in the data.14
       Parameters φ and σs directly affect the amount of belief dispersion between the two
groups. We choose φl = 0.7 and σs = 5% to generate some modest belief dispersion: In
our simulated data, the average dispersion between the two groups, |gl |, is only 0.67%. This
amount is rather modest compared with the typical dispersion in survey forecasts of future
inflation and GDP growth rates (see footnote 2 for examples). We choose the following
initial conditions for our simulation. The two groups have an equal wealth share at t = 0,
i.e., η0 = 1; Both f0 and l0 start with their steady state value ¯l and the two groups also
share an identical prior belief equal to the steady value ¯l: f0 = l0 = ˆl01 = ˆl02 = ¯l = 5%. All the
model parameters are summarized below:

                         λl = 0.02, λf = 1.5, σf = 1.2%, σl = 1.5%, σI = 2%,

                         φl = 0.7, σs = 5%, η0 = 1, f0 = l0 = ˆl01 = ˆl02 = ¯l = 5%.                        (32)
  13
      Note that these two mean-reversion parameters are important for agents’ belief dispersion effect. Intu-
itively, a larger λl parameter causes lt to revert faster to its mean, therefore making agents’ belief dispersion
about lt less important for bond prices; while a larger λf parameter causes ft to revert faster to lt , therefore
making agents’ belief dispersion about lt more important for bond prices.
   14
      One could also choose σI to match the volatility of the aggregate production. This would have little or
no impact on the volatility amplification effect and the bond-yield regression result.


                                                       25
                                         41


                                         40
              Monthly Yield Volatility

                                         39


                                         38
                                                                Heterogeneous case
                                                                Homogeneous case
                                         37


                                         36


                                         35


                                         34
                                              0   2    4        6           8             10
                                                      Bond Maturity

Figure 1: The term structure of bond yield volatility. This figure is based on a simulation
exercise using 50 years of bond yields, using parameters specified in equation (32). The
volatility is monthly volatility measured in basis points. The solid line plots the volatility
curve in a heterogeneous economy with two groups of agents holding different beliefs, while
the dash line plots the volatility curve in a homogeneous economy with a representative agent
holding the equal weighted average belief of the two groups in the heterogeneous economy.

       Based on these model parameters, we simulate a heterogeneous economy with two groups
of agents, as described in our model, for 50 years at a daily interval.15 The length of 50 years
roughly matches the sample duration used in most empirical studies of the yield curve. We
extract bond yields for various maturities at the end of each month. The solid line in Figure
1 plots the monthly bond yield volatility for different maturities from zero to 10 years. As the
maturity increases from zero to five year, the yield volatility increases from 37 to above 40
basis points. As the maturity further increases, the yield volatility then starts to fall slightly.
The magnitude and shape of this volatility curve is similar to those estimated in Piassezi
(2005) and Dai and Singleton (2003).
  15
    We also perform the simulation 1000 times and the average results across the 1000 paths are similar those
reported here.



                                                           26
   To further illustrate the volatility amplification effect discussed in Section 3.2, we compute
the volatility curve in a homogeneous economy in which the representative agent holds the
equal weighted average belief of the two groups in the simulated heterogeneous economy.
Note that the representative agent’s belief reflect the changes in the two groups’ beliefs, but
not their relative wealth fluctuation. As a result, the volatility curve in the homogeneous
economy does not capture the volatility amplification effect caused by the two groups’ relative
wealth fluctuation. The dashed line in Figure 1 plots the volatility curve in the homogeneous
economy. While this line maintains a similar shape as the solid line, it is always below
the solid line. The difference between the solid and dashed lines measures the volatility
amplification effect. This effect is small at short maturities, but increases dramatically from
zero to near 5 basis points per month as maturity increases from zero to 5 years. This number
shows that the volatility amplification caused by agents’ relative wealth fluctuation could be
economically meaningful even for a modest amount of belief dispersion.
   Based on the simulated bond yield data in both the heterogeneous and homogeneous
economies, we further regress the change over the next month in the yield of a n−month zero
coupon bond onto the yield spread between the yield and 1-month rate:

                                                                  Yt (n) − Yt (1)
                                Yt+1 (n − 1) − Yt (n) = αn + βn                   ,            (33)
                                                                       n−1

where Yt (n) is the n-month yield at month t, αn is the regression constant, and βn is the
regression coefficient. This regression is directly motivated by the expectations hypothesis
and has been examined by numerous empirical studies, e.g., Campbell and Shiller (1991).
               Yt (n)−Yt (1)
Intuitively,        n−1        represents the excess yield from holding the n-month bond over the 1-
month rate each month. The expectations hypothesis suggests that a representative investor
in the bond markets must be indifferent about investing in the bond or in the short rate, thus
he must expect the bond price to fall or the bond yield to rise by the same amount over the
next month:
                                  Yt (n) − Yt (1)
                                                  = Et [Yt+1 (n − 1) − Yt (n)].
                                       n−1
Hence, the expectations hypothesis provides a null hypothesis for the regression exercise:

                                                    βn = 1.


                                                       27
              n       2         3         6          12      24        48       120

                           A. Results from Campbell-Lo-MacKinlay
             βn    0.003 −0.145 −0.835 −1.435 −1.448 −2.262 −4.226
             s.e. (0.191) (0.282) (0.442) (0.599) (1.004) (1.458) (2.076)

                     B. Results from our simulation (heterogeneous economy)
             βn −0.644 −0.678 −0.786 −1.028 −1.574 −2.693 −4.644
             s.e. (0.359) (0.372) (0.417) (0.524) (0.777) (1.321) (2.764)

                     C. Results from our simulation (homogeneous economy)
             βn −0.325 −0.344 −0.406 −0.546 −0.859 −1.440 −1.932
             s.e. (0.416) (0.429) (0.473) (0.577) (0.820) (1.336) (2.595)

Table 1: The coefficients of yield change regressions. This table reports the βn coefficients
and their standard errors of regressions in equation (33) for bond maturities of 2 months, 3
months, 6 months, 12 months, 24 months, 48 months and 120 months. Panel A is taken from
Table 10.3 of Campbell, Lo and MacKinlay (1997), which uses U.S. treasury bond yield data
from 1952-1991. Panel B uses the 50-year bond yield data extracted from our simulation of
a heterogeneous economy with two groups of agents holding different beliefs. Panel C uses
the yield data constructed from a homogeneous economy with a representative agent holding
the equal weighted average belief of the two groups in the heterogeneous economy.


   Table 1 reports the regression coefficients. Panel A takes the empirical results from Table
10.3 of Campbell, Lo and MacKinlay (1997), which uses 40 years of U.S. treasury bond yield
data from 1952-1991. The panel shows that βn starts with a value of 0.003 for 2-month yield,
and then monotonically decreases as the bond maturity increases to 3 months, 6 months, 1
year, 2 years, 4 years and 10 years. βn eventually takes a value of -4.226 for 10-year yield.
All these coefficients are significantly different from 1 (the null), and the coefficient of 10-year
yield is significantly negative. Taken together, these regression coefficients clearly reject the
expectations hypothesis. Panel B reports the regression results using the 50-year bond yield
data from our simulation of the heterogeneous economy. The regression coefficient decreases
monotonically from -0.644 to -4.644 as the bond maturity increases from 2 months to 10 years,
with a similar trend and magnitude to that in Panel A. Therefore, extending a standard asset
pricing model with heterogeneous expectations offers a potential explanation for the failure
of the expectations hypothesis in actual data.
   To further examine the source of this result, in Panel C, we report the regression results


                                                28
using bond yield data constructed from the homogeneous economy in which the represen-
tative agent holds the equal weighted average belief. In this case, the regression coefficient
ranges from -0.325 to -1.932 when the bond maturity increases from 2 months to 10 years.
The magnitude of the difference in the corresponding coefficients in Panels B and C is sub-
stantial. This difference also becomes statistically significant when we increase the length
of the simulation period. As we discussed before, the simulated homogeneous economy fails
to account for the relative wealth fluctuation between the two groups in the simulated het-
erogeneous economy. The difference in the regression coefficients between the two economies
shows that the relative wealth fluctuation between the two groups plays an important role in
generating the regression result in Panel B.


6    Conclusion and Further Discussion

This paper provides a dynamic equilibrium model of bond markets, in which two groups of
agents hold heterogeneous expectations about future economic conditions. Heterogeneous
expectations motivate agents to take speculative positions against each other. We are able
to solve the equilibrium in a closed form. In particular, the price of a bond equals the
wealth weighted average of bond prices in homogeneous economies, in each of which only
one group of agents is present. Our model shows that heterogeneous expectations can not
only lead to speculative trading, but can also help resolve several challenges facing standard
representative-agent models of the yield curve. First, the relative wealth fluctuation between
the two groups of agents caused by their speculative positions amplifies bond yield volatility,
thus providing an explanation to the “excessive volatility puzzle” in the bond markets. In
addition, the fluctuation in the two groups’ expectations and relative wealth also generates
time-varying risk premia, which in turn helps explain the failure of the expectation hypothesis.
These implications, essentially induced by trading between agents, highlight the importance
of incorporating heterogeneous expectations into economic analysis of bond markets.
    Our model also provides a tractable but non-affine yield curve structure, which is ready
for econometric estimation. This structure simultaneously embeds stochastic volatility and
time-varying risk premia. Both features, as emphasized by Dai and Singleton (2003) and
Duffee (2002), are crucial for capturing the actual yield curve dynamics. Our model provides

                                               29
several testable implications of belief dispersion. First, higher belief dispersion increases bond
market trading volume. Second, higher belief dispersion increases bond yield volatility and
reduces bond market liquidity. Third, in an economy or a time period with greater belief
dispersion among agents, the spread between long-term bond yield and short rate has a
stronger predictive power for future yield changes. Finally, higher belief dispersion reduces
bond yields, especially for bonds with longer maturities and when belief dispersion is large.
   There is now a burgeoning empirical literature analyzing the effects of agents’ heteroge-
neous beliefs on stock markets (see Hong and Stein (2006) for a recent survey of these studies).
There is, however, little effort analyzing the effects on bond markets. As we discussed in the
introduction, a substantial amount of belief dispersion exists in various surveys of agents’
expectations of future economic conditions. These survey data invite future studies of the
impacts of belief dispersion on bond markets.
   The existence of heterogeneous expectations also has potential implications for monetary
policies. Usually, a monetary authority only directly controls the overnight interest rate.
For the overnight interest rate to affect long term interest rates and other prices, the links
rely almost entirely on market expectations for the future course of short-term rates. Many
monetary economists have pointed out the importance of managing market expectations in
monetary policies, e.g., Blinder (1998) and Bernanke (2004). Consistent with this view, our
model highlights that dispersion in market expectations can directly affect long-term interest
rates and increase their volatility. Heterogeneous expectations could also affect the broad
economy. For instance, a recent study by Piazzesi and Schneider (2006b) argues that, due
to collateral constraints, households’ heterogeneous expectations about future inflation rates
can lead to housing booms. Thus, if the objective of monetary authorities is to stabilize
prices, our model suggests that they should pay close attention to the dispersion in market
expectations, and reduce this dispersion in their capacity.




                                               30
A       Some Proofs
A.1     Proof of Theorem 1

The market clearing conditions require that the aggregate investment to the risky technology
is equal to the total wealth in the economy:
                                                      2
                                                      X
                                                            xiI (t)Wti = Wt .
                                                      i=1

By substituting agents’ investment strategy in equation (20) and dividing both sides by Wt ,
we obtain that
                                                              2
                                                      ft − rt X i
                                                                ω = 1.
                                                        σI2 i=1 t
        P2    i
Since    i=1 ωt   = 1, we have that rt = ft − σI2 .
    The market clearing conditions also require that the aggregate investment to the security
f is zero:
                                                      2
                                                      X
                                                            xif (t)Wti = 0.
                                                      i=1

By substituting agents’ investment strategy in equation (20) and dividing both sides by Wt ,
we obtain that
                        2                             2
                        X           µ̂if − rt         X           µf (t) − λf (ft − ˆlti ) − rt
                              ωti                 =         ωti                                 = 0.
                        i=1
                                      σf2             i=1
                                                                             σf2
Thus,
                                            2
                                            X                                                     2
                                                                                                  X
                      µf (t) = rt +               ωti λf (ft      − ˆlti ) = rt + λf ft − λf            ωti ˆlti .
                                            i=1                                                   i=1

Following a similar procedure, we can also derive µs1 (t) and µs2 (t).
    Since the risky technology is the only storage tool in the economy and every agent con-
sumes a fraction β of his wealth, the aggregate wealth fluctuates according to
                           dWt
                               = dIt /It − βdt = (ft − β) dt + σI dZI (t).
                            Wt

A.2     Proof of Proposition 1

Under group-2 agents’ probability measure, applying Ito’s lemma to ηt we obtain
                                                             µ           ¶2       µ          ¶µ           ¶
                       dηt   dWt1 dWt2                            dWt2                dWt1        dWt2
                           =      −     +                                     −                                .     (34)
                        ηt    Wt1   Wt2                            Wt2                 Wt1         Wt2


                                                                    31
By substituting group-2 agents’ consumption and investment strategies into equation (19),
we obtain their wealth process:
         "         µ        ¶                             #
 dWt2                ft − rt 2 ¡ 2        ¢0 −2 ¡ 2      ¢    ¡ 2      ¢0
                                                                                 ~ 2 (t) .
    2 = rt − β +                + µ
                                  ~ t − rt · Σ · µ             ~ t − rt · Σ−1 · dZ
                                                 ~ t − rt dt + µ
  Wt                   σI

By substituting group-1 agents’ consumption and investment strategies into equation (19)
and expressing the security returns in group-2 agents’ probability measure, we obtain group-
1 agents’ wealth process as
          "        µ        ¶                           #
 dWt1                ft − rt 2 ¡ 1      ¢0 −2 ¡ 2      ¢    ¡ 1      ¢0
                                                                               ~ 2 (t) .
    1  = rt − β +             + µ
                                ~ t − rt · Σ · µ             ~ t − rt · Σ−1 · dZ
                                               ~ t − rt dt + µ
  Wt                   σI

                  dWt2         dWt1
By substituting    Wt2
                         and   Wt1
                                      into equation (34), we obtain

            dηt      h¡              ¢0       ¡ 2       ¢i    ¡ 1        ¢0
                   =   µ~ 1t − µ ~ 2t · Σ−2 · µ~ t − rt dt + µ ~t − µ~ 2t · Σ−1 · dZ~ 2 (t)
             ηt
                        h¡              ¢0    ¡ 2       ¢ ¡ 1      ¢0       ¡ 2      ¢i
                     + µ    ~ 2t − rt · Σ2 · µ ~ t − rt − µ~ t − rt · Σ2 · µ ~ t − rt dt
                     ¡ 1            ¢0
                   = µ~t − µ                  ~ 2 (t) .
                                ~ 2t · Σ−1 · dZ

Equation (18) implies that
                                        ¡ 1       ¢0
                                         µ    ~ 2t = (λf gl , gl , gl ) .
                                         ~t − µ
                     ¡ 1       ¢0                           dηt
Then, by substituting µ    ~ 2t and Σ−1 into
                      ~t − µ                                 ηt   above, we obtain equation (26).
                                                                                         WT1
   For any random variable XT with E 1 [XT ] < ∞, we can define YT =                         X .
                                                                                         Wt1 T
                                                                                                    Suppose
there is a financial security which is a claim to the cash flow YT . Then group-1 agents’
valuation for this security is
                      · 0 1      ¸    · 1 ¸      · 1 ¸
                     1 u (cT )       1 ct      1 Wt
                   Et    0  1  YT = Et 1 YT = Et   1 YT = Et1 [XT ] ,
                       u (cT )         cT         WT

where the second equality follows from these agents’ consumption rule c1t = βWt1 . Similarly,
investor 2’s valuation for this security is
                    · 0 2        ¸     · 2 ¸     · 2 ¸        ·      ¸
                  2 u (cT )           2 ct     2 Wt         2 ηT
                 Et            YT = Et 2 YT = Et      YT = Et      XT .
                     u0 (c2T )           cT       WT2           ηt

In the absence of arbitrage, group-1 and group-2 agents should have the same valuation:
                                                ·      ¸
                                    1         2 ηT
                                  Et [XT ] = Et      XT .
                                                  ηt


                                                       32
A.3     Proof of Theorem 2

To derive asset prices, we start with agents’ stochastic discount factor. When agents are
homogeneous, they share the same stochastic discount factor, which is determined by their
marginal utility of consumption. With a logarithmic preference, agents consume a fixed
fraction of their wealth and the stochastic discount factor is inversely related to their aggregate
wealth. More specifically, the stochastic discount factor, which we denote by MtH , is

                              MtH          0
                                      −βt u (ct )        c0      W0
                                  = e              = e−βt = e−βt    .                         (35)
                              M0H         u0 (c0 )       ct      Wt
   When agents have heterogeneous beliefs about the probabilities of future states, they have
different stochastic discount factors. However, in the absence of arbitrage, they have to share
the same security valuations. For our derivation, we will use the probability measure and the
stochastic discount factor of group-2 agents. Group-2 agents’ consumption is
                                             ω2                  1
                              c2t = βWt2 = P2 t       βWt =          βWt .
                                                    2
                                               i=1 ωt
                                                              ηt + 1

The implied stochastic discount factor is
                         Mt             u0 (c2t )           2
                                                       −βt c0         W0 ηt + 1
                                = e−βt   0   2    =  e      2  = e−βt
                         M0             u (c0 )            ct         Wt η0 + 1
                                              µ                    ¶
                                        W0         ηt           1
                                = e−βt                   +
                                        Wt η0 + 1 η0 + 1
                                              µ                ¶
                                    −βt W0        1 ηt       2
                                = e              ω0 + ω0
                                        Wt          η0
                                  µ                ¶ H
                                        ηt            Mt
                                =   ω01 + ω02               .
                                        η0            M0H
   Thus, at time t, the price of a financial security that pays off XT at time T is
                          ·         ¸
                         2 MT
              Pt = Et           XT
                            Mt
                          ·              µ             ¶    ¸
                                      Wt       ηT
                  = Et2 e−β(T −t)          ωt1    + ωt2 XT
                                     WT        ηt
                             ·                    ¸         ·                ¸
                        1 2    −β(T −t) Wt ηT           2 2   −β(T −t) Wt
                  = ωt Et e                     XT + ωt Et e              XT .
                                        WT ηt                          WT
        ηT
Since   ηt   is the Randon-Nikodyn derivative of group-1 agents’ probability measure with re-
spect to the measure of group-2 agents (Proposition 1),
                         ·                  ¸       ·               ¸
                       2   −β(T −t) Wt ηT         1   −β(T −t) Wt
                     Et e                 XT = Et e               XT .
                                    WT ηt                      WT

                                                   33
Thus,
                             ·                  ¸       ·                ¸
                                        Wt                         Wt
               Pt = ωt1 Et1 e−β(T −t)       XT + ωt2 Et2 e−β(T −t)    XT
                                        WT                         WT
                             · H       ¸          · H     ¸
                               MT                  MT
                   = ωt1 Et1      H
                                    XT + ωt2 Et2       XT ,
                               Mt                  MtH
         h H    i
          M
where Eti MTH XT is the price of the security in a homogeneous economy where only group-i
             t
agents are present.

A.4     Proof of Proposition 2

The price of the bond in a homogeneous economy has the following function form:
                                                    ³           ´
                                           Bti = B H τ,ft , ˆlti .                                (36)

The bond’s return has to satisfy the following relationship with the stochastic discount factor
in the homogeneous economy:
                      µ H¶       µ   H
                                       ¶      µ H    H
                                                       ¶
                     i dB      i dMt        i dB dMt
                   Et       + Et         + Et            = 0.                                     (37)
                        BH         MtH         B H MtH

Applying Ito’s lemma to equations (35) and (36) provides

                                   dMtH   ¡        2
                                                     ¢
                                        =  −ft + σ I   dt − σI dZI ,
                                    MtH

and
                 (
      dB H          BτH                     BH                   H       BH
             =       −  −  λ f (ft −   ˆli ) f − λl (ˆli − ¯l) Bl + 1 σ 2 f f
                                         t               t
       BH           BH                      BH                 BH   2 f BH
                                                          )      ·                    ¸
                  1£ 2            ¤ BllH            BfHl             BθH          BπH
                 + σl − 2λl γ̄l             + λf γ̄l H dt + ρθ σθ H + ρπ σπ H dZI (t)
                  2                 BH              B                B            B
                  Ã                          !              µ         ¶
                       BfH      λf γ̄l BlH                                H
                                                                                    γ̄l BlH bi
                 + σf H +                      d bi (t) + γ̄l + φl σl Bl dZ
                                                 Z                            bs1
                                                                               i
                                                                                  +        dZ .
                       B         σf B H            f
                                                              σs         BH         σs B H s2

                      dB H         dMtH
   By substituting    BH
                             and    MtH
                                          into equation (37), we obtain the following equation:

      BτH                BfH                          H
                                             BlH 1 2 Bf f 1 ¡ 2          ¢BllH        BfHl
0=−       − λ (f
             f t − ˆ
                   l i
                       )     − λ  (ˆ
                                 l tl i
                                        − ¯
                                          l)    + σ      +   σ  − 2λ  γ̄
                                                                     l l       + λ              2
                                                                                  f l H − ft + σI
                                                                                   γ̄
                    t
      BH                 BH                  BH 2 f BH 2 l                BH          B
                                                                                             (38)



                                                     34
We conjecture the following solution
                               ³           ´                        i
                           B H τ, ft , ˆlti = e−af (τ )ft −al (τ )l̂t −b(τ ) .

By substituting the conjectured solution into the differential equation in (38) and collecting
common terms, we obtain the following algebra equation:
            £ 0                        ¤      £                              ¤
    0 =      af (τ ) + λf af (τ ) − 1 ft + a0l (τ ) − λf af (τ ) + λl al (τ ) ˆlti
                                      1               1¡ 2          ¢
            +[b0 (τ ) − λl ¯lal (τ ) + σf2 af (τ )2 +   σl − 2λl γ̄l al (τ )2 + λf γ̄l af (τ )al (τ ) + σI2 ].
                                      2               2

Since this equation has to hold for any values of ft and ˆlti , their coefficients must be zero.
Thus, af (τ ), al (τ ), and b (τ ) satisfy the following differential equations

          a0f (τ ) + λf af (τ ) − 1 = 0,
          a0l (τ ) − λf af (τ ) + λl al (τ ) = 0,
                                  1               1¡ 2          ¢
          b0 (τ ) − λl ¯lal (τ ) + σf2 af (τ )2 +   σl − 2λl γ̄l al (τ )2 + λf γ̄l af (τ )al (τ ) + σI2 = 0,
                                  2               2
subject to the boundary conditions

                                           af (0) = al (0) = b (0) = 0.

Solving these equations provides the bond price formula given in Proposition 2.

A.5     Proof of Proposition 3

Agents’ belief dispersion about lt leads to speculative positions in risky securities f , S1 and
S2 . We can directly compute group-2 agents’ positions in these securities. Equation (20)
shows that their position in security f is
                                                                            ³         ´
                                    µ̂2f   (t) − rt              µf (t) − λf ft − ˆlt2 − rt
                     nf (t) =   Wt2                   = Wt ωt2                                .
                                            σf2                               σf2

By substituting in µf (t) from Theorem 1, we obtain that

                                                      λf         ηt
                                       nf (t) =           Wt           gl (t) .
                                                      σf2    (ηt + 1)2

Similarly, we can derive group-2 agents’ positions in securities S1 and S2 :
                                                            1          ηt
                                ns1 (t) = ns2 (t) =             Wt           gl (t) .
                                                            σs2    (ηt + 1)2

                                                           35
Note that group-2 agents’ positions in all these securities are proportional to the same ran-
dom variable Wt (η η+1)
                     t
                       2 gl (t). This implies that these positions have the same time-series
                     t
properties. As the belief dispersion |gl (t)| widens, group-2 agents take larger positions in
securities f , S1 and S2 .
   Since group-2 agents have to trade with group-1 agents to change their positions, the
absolute values of the changes in group-2 agents’ positions determine trading volume in the
bond markets. In our model, the changes in agents’ positions follow diffusion processes. It is
well known that diffusion processes have infinite variation over a given time interval. However,
since actual trading occurs in discrete time, it is reasonable to analyze trading volume through
the change in agents’ positions across a finite time interval. Since the absolute value of a
realized position change across a finite but small interval is finite and on average increases
with the volatility of the position change, this motivates us to use the volatility as a measure
of trading volume.
   Here, we examine the change in group-2 agents’ position in security f , dnf (t), whose
diffusion terms are
                ·                                                                     ¸
             λf      ηt                            ηt − 1                ηt
                           gl (t) dWt − Wt gl (t)           dηt + Wt           dgl (t) .
             σf2 (ηt + 1)2                        (ηt + 1)3          (ηt + 1)2

The fluctuation in the position is determined by the fluctuations in the aggregate wealth, in
the wealth ratio between the two groups, and in the difference in agents’ beliefs.
   By deriving the diffusion processes of dWt , dηt and dgl (t), and substituting them into the
equation above, we can derive the variance of the position change as
                        "
                          λ2f σI2      2     ηt2     2
                                                             λ4f                2
                                                                      2 (ηt − 1) 4
      V ar [dnf (t)] =            (Wt )            gl  (t) +     (Wt )            gl (t)
                           σf4           (ηt + 1)4           σf6        (ηt + 1)6
                                                                                             #
                                2λ2f      (η t − 1) 2           2λ 2 φ2 σ 2
                                                                   f   l l             η 2
                             + 2 4 (Wt )2             gl4 (t) +             (Wt )2       t
                                                                                               dt
                              σs σf       (ηt + 1)6                 σf4            (ηt + 1)4

It is direct to see that the variance of the position change increases with gl2 (t). Thus, trading
volume of security f increases with agents’ belief dispersion.

A.6    Proof of Proposition 4

By the definition of bond yield Yt (τ ) = − τ1 log(Bt ), its volatility is proportional to that of
the bond return:
                                                      1
                                  V ol[dY (τ )t ] =     V ol(dBt /Bt ).
                                                      τ

                                                  36
Applying Ito’s lemma to equation (29) provides the following diffusion terms of dB                               Bt :
                                                                                                                   t


      "                                                                                                     #
                                    −1      λf         ηt            e−al (τ )gl (t)/2 − eal (τ )gl (t)/2
   − af (τ )σf + al (τ )λf σf γ̄l −                          gl (t)                                           dẐfR
                                            σf (ηt + 1)             ηt e−al (τ )gl (t)/2 + eal (τ )gl (t)/2
      "       µ                     ¶                                                                    #
                  −1         φl σl        1       ηt               e−al (τ )gl (t)/2 − eal (τ )gl (t)/2 ³ R                 R
                                                                                                                              ´
   − al (τ ) σs γ̄l +                  −                  gl (t)                                             d Ẑs1  + d Ẑs2
                               2         σs (ηt + 1)             ηt e−al (τ )gl (t)/2 + eal (τ )gl (t)/2
          al (τ ) ηt e−al (τ )gl (t)/2 − eal (τ )gl (t)/2 ³ bR          b R
                                                                             ´
   −φl σl                                                   d Z s1 − d Z  s2 .
             2 ηt e−al (τ )gl (t)/2 + eal (τ )gl (t)/2
Since the diffusion term in each row is independent to each other, we obtain
   µ     ¶        ·                                                 ¸2
     dBt 2                             −1       λf    ηt
              = af (τ )σf + al (τ )λf σf γ̄l +              K1 (gl ) dt
      Bt                                        σf (ηt + 1)
                     ·      µ                ¶                       ¸2
                               −1      φl σl      1    ηt                 φ2 σ 2
                  +2 al (τ ) σs γ̄l +          +             K1 (gl ) dt + l l a2l (τ )K2 (gl )dt
                                        2        σs (ηt + 1)                2
where
                                                         e−al (τ )gl (t)/2 − eal (τ )gl (t)/2
                                K1 (gl ) = −gl (t)                                              ,
                                                        ηt e−al (τ )gl (t)/2 + eal (τ )gl (t)/2
and                                                "                                     #2
                                             ηt e−al (τ )gl (t)/2 − eal (τ )gl (t)/2
                                  K2 (gl ) =                                                  .
                                             ηt e−al (τ )gl (t)/2 + eal (τ )gl (t)/2
Direct derivations of K1 and K2 provide that both of them increase as |gl | increases. Thus,
the conditional variance of the bond return increases in the belief dispersion.

A.7      Proof of Proposition 5

We first derive the learning processes of an econometrician who uses the objective probabil-
ity measure. We assume that the econometrician’s belief distribution about lt at time t is
Gaussian and denote it by
                                                                          ³          R
                                                                                       ´
                                     lt | {fτ , S1 (τ ), S2 (τ )}tτ =0 ∼ N ˆltR , γ̄ l ,

where ˆltR is the mean and γ̄lR is the stationary variance level. Since the econometrician knows
the objective signal processes in equations (4) and (5), γ̄lR is the positive root to the following
quadratic equation of γ:                 Ã              !
                                             λ2f   2
                                                 + 2        γ 2 + 2λl γ − σl2 = 0,
                                             σf2  σs
and the mean of his belief distribution follows

                   dˆltR = −λl (ˆltR − ¯l)dt + λf σf−1   R bR     −1 R bR       −1 R bR
                                                     l γ̄l dZf + σs γ̄l dZs1 + σs γ̄l dZs2 ,


                                                              37
where
                                           1     h                       i
                              dZbfR =             dft + λf (ft − ˆltR )dt ,                                (39)
                                           σf
                                           1     h                 i
                               bs1
                              dZ R
                                   =              dS1 (t) − ˆltR dt ,                                      (40)
                                           σs
                                           1     h                 i
                               bR =
                              dZ s2               dS2 (t) − ˆltR dt ,                                      (41)
                                           σs
are the surprises in the three corresponding sources of information. These surprises are
independent standard Brownian motions in the econometrician’s probability measure.
   Standard results in asset pricing, e.g., Duffie (1996) and Cochrane (2001), state that the
stochastic discount factor’s drift rate is the negative of the risk free rate and its loading on
each source of shock is the negative of the corresponding risk premium term in the equi-
librium. Thus, to derive the stochastic discount factor process from the view point of the
econometrician, we only need to compute the Shape ratios of the risky technology and the
three financial securities in his probability measure.
   According to equation (1), the Sharpe ratio corresponding to dZI is σI . To compute the
Sharpe ratio of security f, we first express the ft process in the econometrician’s measure,
using equation (39):
                                        ³         ´
                               dft = −λf ft − ˆltR dt + σf dZfR .

By substituting this equation and equation (22) into equation (15), we obtain that
                       Ã                               !
              dpf                         X  2                   ³       ´
                    =    rt + λf ft − λf       ωti ˆlti dt − λf ft − ˆltR dt + σf dZfR
              pf
                                           i=1
                       "         Ã 2             !#
                                   X
                                         i ˆi ˆR
                    = rt − λf          ω l −l
                                           t t     t    dt + σf dZ R .  f
                                   i=1
                                                                            ³P                ´
                                                                        λ     2    i ˆi ˆR
Thus, the Sharpe ratio corresponding to shock dZfR is − σff                   i=1 ωt lt −lt       . Following a
                                                                               R and dZ R
similar procedure as above, we can derive the Sharpe ratios corresponding to dZs1
        ³P              ´                                                              s2
as −  1    2    i ˆi ˆR
              ω l −l . By combining these risk premium terms, we obtain the process of
      σs      i=1   t t   t
the stochastic discount factor given in Proposition 5.

A.8        Proof of Proposition 6

We define agents’ wealth weighted average belief about lt as

                                   ˆlA =     ηt ˆ1        1 ˆ2
                                     t            lt +       l .
                                           ηt + 1      ηt + 1 t

                                                       38
Then, we can rewrite the bond price of a τ -year zero-coupon bond as
                                              ·                                                    ¸
                                     A            ηt − η+1
                                                         1
                                                           al (τ )gl (t)     1       η
                                                                                       a (τ )g (t)
          Bt = e−af (τ )ft −al (τ )l̂t −b(τ )          e                 +        e η+1 l l          .
                                                ηt + 1                     1 + ηt

We define the expression in the bracket above as
                                           ηt − η+1
                                                  1
                                                    al (τ )gl     1       η
                                                                            a (τ )g
                             K (gl ) =          e             +        e η+1 l l
                                         ηt + 1                 1 + ηt
Direct differentiation provides that
                                             ηt            h    1                 η          i
                                                             − η+1 al (τ )gl        a (τ )gl
                         K 0 (gt ) = −             al (τ )  e                − e η+1 l
                                         (ηt + 1)2

which is positive for gl > 0 and is negative for gl < 0. Thus, K (gl ) increases as the difference
in agents’ beliefs widens. This result in turn provides that after controlling for agents’ wealth
weighted average belief ˆlA , the bond price increases with agents’ belief dispersion.
                              t
    Furthermore, it is direct to see that the magnitude of K 0 (gt ) increases monotonically with
respect to al (τ ). In addition, al (τ ) increases with the bond maturity τ . Thus, the increase in
bond price in response to the widening in gl is larger for bonds with longer maturities.

A.9     Proof of Proposition 7

To replicate the price dynamics in the heterogeneous-agent economy, we need to make the
representative agent’s stochastic discount factor is the same as group-2 agents’ after adjusting
for the difference in their probability measures. That is, the representative agent’s marginal
utility have the following property in any future state:

                                               u0 (c2t ) = ηtA u0 (cA
                                                                    t ),


where u0 (c2t ) is group-2 agents’ marginal utility from consumption, u0 (cA
                                                                           t ) is the representative
agent’s marginal utility, and ηtA is the change of measure from the representative agent’s
measure to group-2 agents’ measure. Therefore, ηtA has the following property

                                       dηtA ¡ A       ¢0
                                                            ~ 2 (t) ,
                                         A
                                           = µ    ~ 2t Σ−1 dZ
                                             ~t − µ                                                      (42)
                                        ηt

      ~A
where µt is the representative agent’s expected returns
                                                                    
                                            µf (t) − λf (ft − ˆltA )
                                     ~A
                                     µt =
                                                µs1 (t) + ˆltA      .
                                                 µs2 (t) + ˆltA



                                                          39
    Note that agents with a logarithmic preference always consume a fixed fraction of their
wealth over time: c2 = βWt2 and cA = β(Wt1 + Wt2 ). Thus, we can derive the difference in
the probability measures of group-2 agents and the representative agents:

                                              cA
                                               t    Wt1 + Wt2
                                     ηtA =        =           = ηt + 1.
                                              c2t      Wt2

This further implies that
                                                   dηtA = dηt ,

and
                                       dηtA   ηt dηt     ηt dηt
                                         A
                                            = A      =           .
                                        ηt   ηt ηt     1 + ηt ηt
                                        dηt
Substituting in the dynamics of          ηt   (Proposition 1), we obtain

                         dηtA ³    η                 ηt          ηt
                                                                            ´
                                                                                     ~ 2 (t) .
                           A
                             = λf 1+ηt t gl         1+ηt gl     1+ηt gl .       Σ−1 dZ           (43)
                          ηt

Comparing (42) and (43), we obtain

                                ˆlA = ˆl2 +     ηt          ηt ˆ1     1 ˆ2
                                  t     t            gl =       l +       l .
                                              1 + ηt      1 + ηt t  1 + ηt t
             ηt           1
Note that   1+ηt   and   1+ηt   are the wealth shares of group-1 and group-2 agents.


B     An Extension with Price Inflation

The model presented in the main context has only the real side of the economy, i.e., agents’
consumptions and wealth are all measured in units of consumption good. In this section,
we extend the model with price inflation and agents’ heterogeneous expectations of future
inflation rates. In particular, we assume that the dollar price of one unit of consumption
good, pt , changes over time according to an exogenous process:
                                                  dpt
                                                      = πt dt,                                   (44)
                                                   pt
where πt is the inflation rate.

B.1     Time-varying inflation rate

The inflation rate πt fluctuates according to a linear diffusion process:
                                                       hp                                 i
                    dπt = −λπ (πt − θt )dt + σπ               1 − ρ2π dZπ (t) + ρπ dZI (t) ,     (45)

                                                       40
where λπ is a parameter governing the speed that πt reverts to its long-run mean θt , and σπ
is the volatility of πt . The innovation to πt has a correlation of ρπ with dZI (t), the innovation
to the production growth. Zπ (t) is a standard Brownian motion independent of other shocks
in the economy. The long-run mean of the inflation rate, θt , is unobservable and follows an
Ornstein-Uhlenbeck process:
                                               ·q                           ¸
                    dθt = −λθ (θt − θ̄)dt + σθ        2
                                                 1 − ρθ dZθ (t) + ρθ dZI (t) ,                (46)

where λθ is a parameter governing the speed at which θt reverts to its long-run mean θ̄, and
σθ is the volatility of θt . The innovation to θt has a correlation of ρθ with the innovation to
the production growth. Zθ (t) is a standard Brownian motion independent of other shocks
in the economy. Note that θt determines future inflation rates. Intuitively, we can interpret
θt as the central bank’s inflation target, which is not directly observable. We introduce
correlations between the innovations to the inflation related variables and the innovation to
the production growth because such correlations are useful in capturing a positive slope of
the yield curve, as suggested by Piazzesi and Schneider (2006a).

B.2     Agents’ expectation of future inflation rates

Next, we discuss agents’ expectations about future inflation rates. In addition to observing
πt , we assume that agents also receive two public signals Ψ1 (t) and Ψ2 (t) about the long-run
mean of inflation rates θt . These signals have the following processes:

                                 dΨ1 (t) = θt dt + σΨ dZΨ1 (t),                               (47)
                                 dΨ2 (t) = θt dt + σΨ dZΨ2 (t).                               (48)

These two signals have the same noise volatility parameter σΨ , but are subjective to inde-
pendent noise, ZΨ1 (t) and ZΨ2 (t).
   Similar to the setup of the real side, we assume that agents in the two groups have different
perceptions about these two signal processes. Agents in group 1 believe that the innovation
to dΨ1 (t) is partially correlated with the shock to dθt , thus under-estimate the amount of
noise in the signal. More specifically, they believe that Ψ1 (t) has the following process:
                                           ·           q                 ¸
                      dΨ1 (t) = θt dt + σΨ φθ dZθ (t) + 1 − φ2θ dZΨ1 (t) ,                  (49)

where parameter φθ ∈ [0, 1] measures the fraction of the innovation to dΨ1 (t) that comes
from dZθ (t). Symmetrically, group-2 agents under-estimate the noise in signal Ψ2 (t), i.e.,

                                                41
they believe that φθ fraction of the innovation to dΨ2 (t) comes from dZθ (t):
                                         ·            q               ¸
                                                              2
                     dΨ2 (t) = θt dt + σΨ φθ dZθ (t) + 1 − φθ dZΨ2 (t) .                   (50)

In summary, while the two signals Ψ1 (t) and Ψ2 (t) follow processes (47) and (48) in the
econometrician’s mind, group-1 agents use equations (49) and (48), and group-2 agents use
equations (47) and (50).
   Agents’ information set at time t about θt includes {πτ , Ψ1 (τ ), Ψ2 (τ )}tτ =0 . Again, we
assume that agents have Gaussian prior distributions about θt . As a result, their posterior
distributions are also Gaussian. We focus on the stationary equilibrium, in which agents’
belief variance has already reached its stationary level γ̄θ , which is the positive root to the
following quadratic equation of γ:
                                             q       
       ·       2
                          ¸             φ  σ   1 − ρ2
             λπ         2                θ  θ       θ      ¡       ¢¡      ¢
                2   2
                      + 2 γ 2 + 2 λθ +                γ − 1 − ρ2θ 1 − φ2θ σθ2 = 0.
         (1 − ρπ ) σπ  σΨ                     σΨ

We denote θ̂ti as the mean of group-i agents’ posterior distribution about θt at time t (i ∈
{1, 2}). The mean is determined by
                                                         1                      bi
         dθ̂ti = −λθ (θ̂ti −θ̄)dt + ρθ σθ dZI + p                  λπ σπ−1 γ̄θ dZ π
                                                 1−          ρ2π
                                         µ              q       ¶
                                      −1
                                    +σΨ                           bΨi
                                          γ̄θ + φθ σΨ σθ 1 − ρ2θ dZ i    −1
                                                                      + σΨ  γ̄θ dZbΨj
                                                                                   i
                                                                                           (51)

                              bπi , dZ
where j ∈ {0, 1} and j 6= i. dZ      bi and dZ
                                             bi are “surprises” in the three sources of
                                       Ψi      Ψj
information:
                                   1        h                                       i
                  dZbπi =      p             dπt − ρπ σπ dZI (t) + λπ (πt − θ̂ti )dt ,
                             σπ     1 − ρ2π
                              1   h                 i
                 dZbΨi
                    i
                       =           dΨi (t) − θ̂ti dt ,
                             σΨ
                              1   h                 i
                 dZbΨj
                    i
                         =         dΨj (t) − θ̂ti dt .
                             σΨ
Note that Zbi , Z
                bi and Z
                       bi are independent standard Brownian motions in group-i agents’
            π    Ψ1     Ψ2
                                                     bi , the surprise in signal Ψi , and thus
probability measure. Group-i agents “over-react” to dZ               Ψi
have a different belief from group-j agents.
   In group-i agents’ probability measure, variables πt , Ψ1 (t) and Ψ2 (t) follow
                                                               p
                 dπt = −λπ (πt − θ̂ti )dt + ρπ σπ dZI (t) + σπ 1 − ρ2π dZ bi ,             (52)
                                                                           π

                  dΨ1 = θ̂ti dt + σΨ dẐΨ1
                                        i
                                           (t),                                            (53)
                  dΨ2 = θ̂ti dt + σΨ dẐΨ2
                                        i
                                           (t),                                            (54)

                                                   42
Thus, the difference in agents’ beliefs about θt translates into different views about the
dynamics of these variables and, subsequently, into different expectations of future inflation
rates.

B.3      Speculation about future inflation

Agents’ disagreement about future inflation rates would lead agents to additional speculative
positions against each other. To complete the markets, we introduce three more financial
securities to facilitate agents’ trading need. For our analysis, we first derive the price processes
and agents’ wealth processes in units of real consumption good, and then derive prices of
nominal bonds by adjusting for price inflation. The price processes of the three additional
financial securities are
                               dpπ
                                     = µπ (t)dt + (dπt − ρπ σπ dZI ) ,                         (55)
                                pπ
                             dpΨ1
                                     = µΨ1 (t)dt + dΨ1 (t) ,                                   (56)
                              pΨ1
                             dpΨ2
                                     = µΨ2 (t)dt + dΨ2 (t) .                                   (57)
                              pΨ2
These securities are continuously marked to the fluctuations of dπt − ρπ σπ dZI , dΨ1 (t) and
dΨ2 (t), respectively. We call them security π, security Ψ1 , and security Ψ2 , respectively.
Their contract terms µπ (t), µΨ1 (t), and µΨ2 (t) are continuously determined so that the ag-
gregate demand for each of the securities is zero at any instant. Now agents can trade in six
securities instead of three. We can repeat our derivation of the equilibrium in Section 2.4, by
solving each agent’s optimal position in each security and then imposing the market clearing
condition for each security. To save space, we skip the proof and summarize the results in
the following theorem.

Theorem 3 In equilibrium, the real short rate is the same as the short rate provided in
Theorem 1. The contract terms µf (t), µs1 (t), µs2 (t) of securities f, S1 and S2 remain the
same as the corresponding ones in Theorem 1, while the contract terms µπ (t), µΨ1 (t), and




                                                43
µΨ2 (t) of securities π, Ψ1 , and Ψ2 are determined by
                                                     2
                                                     X
                                  µπ = rt +                    ωti λπ (πt − θ̂ti ),               (58)
                                                     i=1
                                                     X2
                                µΨ1 = rt −                     ωti θ̂ti ,                         (59)
                                                     i=1
                                                     X2
                                µΨ2 = rt −                     ωti θ̂ti .                         (60)
                                                         i=1

The aggregate wealth in the economy fluctuates in the same way as given in Theorem 1.

   We also repeat our derivation of the wealth ratio process between agents in groups 1 and
2, as in the following proposition.

Proposition 8 If we denote the belief dispersion between agents in groups 1 and 2 about lt
and θt by
                                gl (t) ≡ ˆlt1 − ˆlt2 ,     gθ (t) ≡ θ̂t1 − θ̂t2 ,

then the wealth ratio process ηt evolves in group-2 agents’ probability measure according to
                           ·                                          ¸
               dηt           λf    2       1      2        1     2
                     = gl       dẐ (t) + dẐs1 (t) + dẐs2 (t)
                ηt           σf f         σs              σs
                              "                                                     #
                                    λπ                   1               1
                         +gθ      p         dẐπ2 (t) +     dẐ 2 (t) +    dẐ 2 (t)      (61)
                                σπ 1 − ρ2π              σΨ Ψ1           σΨ Ψ2

   Given agents’ disagreement about future inflation rates, their wealth ratio now also fluc-
tuates with shocks to the monetary side of the economy, such as dẐπ2 (t), dẐΨ1
                                                                              2 (t) and dẐ 2 (t).
                                                                                           Ψ2
More importantly, Proposition 8 shows that both agents’ belief dispersion about future tech-
nology returns (|gl |) and inflation rates (|gθ |) increase the volatility of the wealth ratio.
   With the updated wealth ratio process in Proposition 8, we can show that the wealth
ratio can still serve as the Randon-Nikodyn derivative of group-1 agents’ probability measure
with respect to group-2 agents’ measure. Furthermore, we can also show that Theorem 2 still
holds for asset prices measured in units of real consumption good.

B.4    Pricing nominal bonds

Proposition 9 At time t, the dollar price of a nominal bond, which pays off one dollar at
time T , is given by
                                         Bt = ωt1 Bt1 + ωt2 Bt2 ,

                                                         44
where                                                       ·            ¸
                                                                MTH pt
                                             Bti = Eti
                                                                MtH pT
is the dollar value of the bond in a homogeneous economy, whereby only group-i agents are
present.

                                                        1
   Proof. One dollar at time T can buy          units of real consumption. Thus, its value in
                                                       pT          h      i
real term at time t, from the perspective of group-2 agents, is Et2 M T 1
                                                                     Mt pT , which corresponds
         h      i
to pt Et2 M T 1
           Mt pT in dollars. Although this value is derived from group-2 agents’ perspective,
group-1 agents must share the same valuation to avoid arbitrage. Therefore, the dollar price
of the nominal bond is                                    ·           ¸
                                                                MT pt
                                            Bt =    Et2                 .
                                                                Mt pT
Using the expansion of group-2 agents’ stochastic discount factor given in Theorem 2, we
obtain that
                                      · ¸       ·µ            ¶ H       ¸
                                 MT pt              1 ηT     2 MT pt
                    Bt    =     Et2       = Et2
                                                  ωt     + ωt
                                  Mt pT               ηt         MtH pT
                                  ·      H    ¸          ·   H     ¸
                             1 2 ηT MT pt           2 2 MT pt
                          = ωt Et               + ωt Et
                                    ηt MtH pT              MtH pT
                                  · H      ¸         · H       ¸
                             1 1 M T pt          2 2 MT pt
                          = ωt Et            + ωt Et             .
                                    MtH pT             MtH pT
                                                                                      ηT
Note that in deriving the last equation, we use the fact that                         ηt    is the Randon-Nikodyn
derivative of group-1 agents’ probability measure with respect to the measure of group-2
agents.
   Proposition 9 allows us to express the dollar price of a nominal bond as a wealth weighted
average of each group’s bond valuation in a homogeneous economy, just like how we analyzed
prices of real bonds in the main text. The following proposition provides the price of a
nominal bond in a homogeneous economy.

Proposition 10 In a homogeneous economy with only group-i agents, the dollar price of a
nominal bond with a maturity τ is determined by
                     ³                      ´                        i                      i
                  B H τ, ft , ˆlti ,πt ,θ̂ti = e−af (τ )ft −al (τ )l̂t −aπ (τ )πt −aθ (τ )θ̂t −b(τ )




                                                          45
where af (τ ) and al (τ ) are given in equations 27 and 28, and
                                  1 ³           ´
                   aπ (τ ) =          1 − e−λπ τ ,                                                                   (62)
                                 λπ
                                  1 ³           ´     1    ³               ´
                   aθ (τ ) =          1 − e−λθ τ +          e−λπ τ − e−λθ τ ,                                        (63)
                                 λθ                λπ − λθ
                                 Zτ
                      b(τ ) =       F (s)ds,                                                                         (64)
                                        0

with
                                1              1¡ 2            ¢
           F (s) = λl ¯lal (s) − σf2 af (s)2 −    σl − 2λl γ̄l al (s)2 − λf γ̄l af (s)al (s) + λθ θ̄aθ (s)
                                2              2
                         1 2      2     1¡ 2           ¢
                    − σπ aπ (s) −          σθ − 2λθ γ̄θ aθ (s)2 − (λπ γ̄θ + ρθ ρπ σθ σπ ) aπ (s)aθ (s)
                         2              2
                    −ρθ σθ σI aθ (s) − ρπ σπ σI aπ (s) − σI2 .

    Proof. Here we provide a sketch of the proof. The dollar price of the nominal bond in a
homogeneous economy has the following function form:
                                        ³                       ´
                              Bti = B H τ,ft , ˆlti , π t , θ̂ti .

                                                                                                   Bti
To derive this function, we first convert the price into real term: yt =                           pt .   Thus, dyt /yt is
the bond’s real return. The real return has to satisfy the following relationship with the
stochastic discount factor in the homogeneous economy:
                         µ     ¶      µ   H
                                            ¶      µ      H
                                                            ¶
                        i dyt       i dMt         i dyt dMt
                      Et         + Et         + Et     .      = 0.
                            yt          MtH          yt MtH

                                      dyt     dMtH
By applying Ito’s lemma to             yt and MtH
                                          and substituting these terms back into the equation
                                                             ³                       ´
above, we obtain the following differential equation for B H τ,ft , ˆlti , π t , θ̂ti :

     BτH                BfH              BlH           i Bπ
                                                            H               BθH
                                                                                     H
                                                                                1 2 Bf f
                     ˆi            ˆi  ¯                             i
0 = − H − λf (ft − lt ) H − λl (lt − l) H − λπ (πt − θ̂t ) H − λθ (θ̂t − θ̄) H + σf H
     B                  B                B                B                 B   2 B
     1¡ 2          ¢ BllH         BfHl        H
                                         1 2 Bππ                         H
                                                                       Bπθ
    + σl − 2λl γ̄l        + λf γ̄l H + σπ H + (λπ γ̄θ + ρθ ρπ σθ σπ ) H
     2               BH           B      2 B                           B
                        H                      µ      H              ¶
     1¡ 2           ¢ Bθθ                           B          B H
    + σθ − 2λθ γ̄θ        − πt − ft + σI2 − σI ρθ σθ θH + ρπ σπ πH .
     2                BH                            B          B
Then, by conjecturing the following solution
                     ³                     ´                        i                      i
                 B H τ, ft , ˆlti ,πt ,θ̂ti = e−af (τ )ft −al (τ )l̂t −aπ (τ )πt −aθ (τ )θ̂t −b(τ ) ,

                                                             46
and substituting this function back into the differential equation, we obtain the following
ordinary differential equations for af (τ ), al (τ ), aπ (τ ), aθ (τ ), and b (τ ):

         a0f (τ ) + λf af (τ ) − 1 = 0,
         a0l (τ ) − λf af (τ ) + λl al (τ ) = 0,
         a0π (τ ) + λπ aπ (τ ) − 1 = 0,
         a0θ (τ ) − λπ aπ (τ ) + λθ aθ (τ ) = 0,
                                                  1               1¡ 2           ¢
         b0 (τ ) − λl ¯lal (τ ) − λθ θ̄aθ (τ ) + σf2 af (τ )2 +      σl − 2λl γ̄l al (τ )2 + λf γ̄l af (τ )al (τ )
                                                  2               2
                       1 2               1 ¡              ¢
                   + σπ aπ (τ )2 +           σ 2 − 2λθ γ̄θ aθ (τ )2 + (λπ γ̄θ + ρθ ρπ σθ σπ ) aπ (τ )aθ (τ )
                       2                 2 θ
                   +σI2 + ρθ σθ σI aθ (τ ) + ρπ σπ σI aπ (τ ) = 0.

By further imposing the boundary conditions

                               af (0) = al (0) = aπ (0) = aθ (0) = b (0) = 0,

we obtain the bond price formula given in Proposition 10.
    By combining Propositions 9 and 10, we can expand the price of a nominal bond in a
similar way as in equation (29). The only difference is that there are now two sources of belief
dispersion, one about future technology returns and the other about future inflation rates.
Other than this feature, the basic structure of the bond pricing formula is the same. We are
also able to derive, based on the extended model, similar effects of agents’ belief dispersion
as those discussed in Section 3.




                                                         47
  References
Balduzzi, Pierluigi, Danjiv Das, and Silverio Foresi (1998), The Central tendency: a second
    factor in bond yields, Review of Economics and Statistics 80, 62-72.

Basak, Suleyman (2000), A model of dynamic equilibrium asset pricing with heterogeneous
    beliefs and extraneous risk, Journal of Economic Dynamics and Control 24, 63-95.

Basak, Suleyman (2005), Asset pricing with heterogeneous beliefs, Journal of Banking and
    Finance 29, 2849-2881.

Bernanke, Ben (2004), Central bank talk and monetary policy, speech on October 7, 2004,
    http://www.federalreserve.gov/.

Blinder, Alan (1998), Central Banking in Theory and Practice, MIT Press, Cambridge.

Bomberger, William and William Frazer (1981), Interest rates, uncertainty and the Liv-
   ingston data, Journal of Finance 36, 661-675.

Campbell, John and Robert Shiller (1991), Yield spreads and interest rate movements: a
   bird’s eye view, Review of Economic Studies 58, 495-514.

Campbell, John, Andrew Lo and Craig MacKinlay (1997), The Econometrics of Financial
   Markets, Princeton University Press, Princeton, NJ.

Chen, Joseph, Harrison Hong and Jeremy Stein (2002), Breadth of ownership and stock
    returns, Journal of Financial Economics 66, 171-205.

Cochrane, John (2001), Asset Pricing, Princeton University Press, Princeton, NJ.

Cochrane, John and Monika Piazzesi (2005), Bond risk premia, American Economic Review
    95, 138-160.

Cox, John, Jonathan Ingersoll and Stephen Ross (1985), A theory of the term structure of
    interest rates, Econometrica 53, 385-408.

Dai, Qiang and Kenneth Singleton (2000), Specification analysis of affine term structure
    models, Journal of Finance 55, 1943-1978.

Dai, Qiang and Kenneth Singleton (2002), Expectation puzzles, time-varying risk premia,
    and affine models of the term structure, Journal of Financial Economics 63, 415-441.

Dai, Qiang and Kenneth Singleton (2003), Term Structure Dynamics in Theory and Reality,
     Review of Financial Studies 16, 631-678.

Dai, Qiang (2003), Term structure dynamics in a model with stochastic internal habit,
    Working paper, University of North Carolina.

Detemple, Jerome and Shashidhar Murthy (1994), Intertemporal asset pricing with hetero-
    geneous beliefs, Journal of Economic Theory 62, 294-320.



                                           48
Duffee, Gregory (2002), Term premia and interest rate forecasts in affine models, Journal
    of Finance 57, 405-443.

Duffie, Darrell (1996), Dynamic Asset Pricing, Princeton University Press, Princeton, NJ.

Duffie, Darrell and Rui Kan (1996), A yield-factor model of interest rates, Mathematical
    Finance 4, 379-406.

Dumas, Bernard (1989), Two-person dynamic equilibrium in the capital market, Review of
   Financial Studies 2, 157-188.

Dumas, Bernard, A. Kurshev and Raman Uppal (2005), What can rational investors do
   about excessive volatility and sentiment fluctuations? Working Paper, INSEAD.

Fama, Eugene and Robert Bliss (1987), The information in long-maturity forward rates,
   American Economic Review 77, 680-92.

Fama, Eugene (2006) The behavior of interest rates, Review of Financial Studies 19, 359-
   379.

Fisher, Irving (1896), Appreciation and interest, Publications of the American Economic
    Association, 23-92.

Gurkaynak, Refet, Brian Sack and Eric Swanson (2005), The excess sensitivity of long-
    term interest rates: evidence and implications for macroeconomic models, American
    Economic Review 95, 425-436.

Harris, Milton and Arthur Raviv (1993), Differences of opinion make a horse race, Review
    of Financial Studies 6, 473-506.

Harrison, Michael and David Kreps (1978), Speculative investor behavior in a stock market
    with heterogeneous expectations, Quarterly Journal of Economics 92, 323-336.

Hicks, J. (1939), Value and Capital, Oxford University Press, London.

Hong, Harrison and Jeremy Stein (2006), Disagreement and the stock market, Journal of
   Economic Perspectives, forthcoming.

Jouini, E. and C. Napp (2005), Consensus consumer and intertemporal asset pricing with
    heterogeneous beliefs, Working paper.

Kogan, Leonid, Stephen Ross, Jiang Wang, and Mark Westerfield (2006), The price impact
   and survival of irrational traders, Journal of Finance, 61, 195–229.

Kurz, Mordecai (1994), On the structure and diversity of rational beliefs, Economic Theory
    4, 877-900.

Liptser, Robert and Albert Shiryaev (1977), Statistics of Random Processes, 2 vols., Springer-
    Verlag, New York.

Lutz, F. (1940), The structure of interest rates, Quarterly Journal of Economics 55, 36-63.


                                             49
Mankiw, Gregory, Ricardo Reis and Justin Wolfers (2004), Disagreement about inflation
   expectations, NBER Macroeconomics Annual 2003, MIT Press, Cambridge.

Miller, Edward (1977), Risk, uncertainty and divergence of opinion, Journal of Finance 32,
     1151-1168.

Morris, Stephen (1996), Speculative investor behavior and learning, Quarterly Journal of
   Economics 111, 1111-1133.

Piazzesi, Monika (2003), Affine term structure models, Handbook of Financial Economet-
    rics, forthcoming.

Piazzesi, Monika (2005), Bond yields and the Federal Reserve, Journal of Political Economy
    113, 311-344.

Piazzesi, Monika and Martin Schneider (2006a), Equilibrium yield curve, NBER Macroeco-
    nomics Annual, forthcoming.

Piazzesi, Monika and Martin Schneider (2006b), Inflation Illusion, Credit, and Asset Pricing,
    in John Y. Campbell (ed.) Asset Prices and Monetary Policy, forthcoming.

Scheinkman, Jose and Wei Xiong (2003), Overconfidence and Speculative Bubbles, Journal
    of Political Economy 111, 1183-1219.

Shiller, Robert (1979), The volatility of long-term interest rates and expectations models of
     the term structure, Journal of Political Economy 87, 1190-1219.

Swanson, Eric (2005), Have increases in federal reserve transparency improved private sector
   forecasts of short-term interest rates? Journal of Money, Credit and Banking, forth-
   coming.

Wachter, Jessica A. (2006), A consumption-based model of the term structure of interest
   rates, Journal of Financial Economics 79, 365-399.

Wang, Jiang (1996), The term structure of interest rates in a pure exchange economy with
   heterogeneous investors, Journal of Financial Economics 41, 75-110.

Xiong, Wei (2001), Convergence trading with wealth effects: an amplification mechanism in
    financial markets, Journal of Financial Economics 62, 247-292.

Yan, Hongjun (2005), On the market selection hypothesis, Working paper, Yale University.

Yan, Hongjun (2006), Is noise trading cancelled out by aggregation? Working Paper, Yale
    University.

Zarnowitz, Victor and Louis Lambros (1987), Concensus and uncertainty in economic pre-
    diction, Journal of Political Economy 95, 591-621.




                                            50
