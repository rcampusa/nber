                                 NBER WORKING PAPER SERIES




                                        KIDNEY EXCHANGE

                                              Alvin E. Roth
                                             Tayfun Sönmez
                                             M. Utku Ünver

                                         Working Paper 10002
                                 http://www.nber.org/papers/w10002


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                     September 2003




We would like to thank Erhan Sönmez, Stefanos Zenios, and the participants of SITE 2003 Workshop
on Matching Markets for their insightful comments. All errors are our own responsibility. The views
expressed herein are those of the authors and are not necessarily those of the National Bureau of Economic
Research.

©2003 by Alvin E. Roth, Tayfun Sönmez, and M. Utku Ünver. All rights reserved. Short sections of text,
not to exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
Kidney Exchange
Alvin E. Roth, Tayfun Sönmez, and M. Utku Ünver
NBER Working Paper No. 10002
September 2003
JEL No. I11, C78

                                           ABSTRACT

Most transplanted kidneys are from cadavers, but there are also substantial numbers of transplants
from live donors. Recently, there have started to be kidney exchanges involving two donor-patient
pairs such that each donor cannot give a kidney to the intended recipient because of immunological
incompatibility, but each patient can receive a kidney from the other donor. Exchanges are also
made in which a donor-patient pair makes a donation to someone on the queue for a cadaver kidney,
in return for the patient in the pair receiving the highest priority for a compatible cadaver kidney
when one becomes available. We explore how such exchanges can be arranged efficiently and
incentive compatibly. The problem resembles some of the “housing” problems studied in the
mechanism design literature for indivisible goods, with the novel feature that while live donor
kidneys can be assigned simultaneously, the cadaver kidneys must be transplanted immediately upon
becoming available. In addition to studying the theoretical properties of the design we propose for
a kidney exchange, we present simulation results suggesting that the welfare gains would be
substantial, both in increased number of feasible live donation transplants, and in improved match
quality of transplanted kidneys.

Alvin E. Roth                                        M. Utku Ünver
Harvard University                                   Koç University
Department of Economics                              Department of Economics
308 Littauer Hall                                    College of Administrative Sciences and
Cambridge, MA 02138-3001                             Economics
                                                     Rumeli Feneri Yolu
Tayfun Sönmez                                        Sariyer, Istanbul, 34450
Koç University                                       Turkey
Department of Economics
College of Administrative Sciences and
Economics
Rumeli Feneri Yolu
Sariyer, Istanbul, 34450
Turkey
1       Introduction
Transplantation is the preferred treatment for the most serious forms of kidney disease.
As of this writing there are over 55,000 patients on the waiting list for cadaver kidneys in
the United States, of whom almost 15,000 have been waiting more than three years. By
way of comparison, in 2002 there were over 8,000 transplants of cadaver kidneys performed
in the United States. In the same year, about 3,400 patients died while on the waiting
list, and another 900 became too ill to be eligible for transplantation. See Table 1.1
     As these numbers make clear, there is a considerable shortage of cadaveric kidneys,
compared to the demand. (We note in passing that the substantial consensus in the
medical community remains Þrmly opposed to allowing organs—even cadaveric organs—to
be bought and sold, and in most states this is a felony under the Uniform Anatomical
Gift Act of 1987.2 ) Congress views cadaveric kidneys oﬀered for transplantation as
a national resource, and the National Organ Transplant Act of 1984 established the
Organ Procurement and Transplantation Network (OPTN). Run by the United Network
for Organ Sharing (UNOS), it has developed a centralized priority mechanism for the
allocation of cadaveric kidneys.
     In addition to transplants of cadaver kidneys, in 2002 there were also somewhat over
6,000 transplants of kidneys from living donors, a number that has been increasing steadily
from year to year. Transplants from live donors generally have a higher chance of success
than those from cadavers. The way such transplants are typically arranged is that a
patient identiÞes a healthy willing donor (a spouse, for example) and, if the transplant
is feasible on medical grounds (i.e. appropriate blood types, and absence of “positive
crossmatch” antibodies), it is carried out. If the transplant from the willing donor is not
feasible, the patient typically enters (or remains on) the queue for a cadaver kidney, while
the donor returns home.
     Recently, however, in a relatively small number of cases, additional possibilities have
been utilized when a transplant from a live donor and the intended recipient is infeasible.
One of these, called a paired exchange, involves two patient-donor couples, for each of
whom a transplant from donor to intended recipient is infeasible, but such that the
patient in each couple could feasibly receive a transplant from the donor in the other

    1
    http://www.optn.org/, accessed 7/31/01 and annual report of UNOS/OPTN.
    2
    There is, however, a steady stream of literature both by doctors and by economists, considering how
the shortage of organs might be alleviated by allowing their purchase and sale, and what eﬀects this
might have. See e.g. Nelson et al. (1993) for an argument in favor of the status quo, and e.g. Becker and
Elias [2002] for an argument in favor of a market. Recent Congressional testimony endorsing the status
quo but suggesting that empirical investigation of Þnancial incentives might be in order can be found in
Slade [2003]. In the present paper we will consider how welfare can be improved in the existing legal
environment.


                                                   2
Table 1: US Kidney Transplants. The data for years 1992-2001 are constructed from
the annual report of UNOS-OPTN, the data for 2002 are constructed from the national
database of UNOS-OPTN. Number of registrations may have multiple counts of patients
since one patient may have registered in multiple centers for the waitlist.
                                                                     Year
                     1992    1993     1994     1995         1996     1997     1998     1999     2000     2001     2002
    Cadaveric
                     4,276   4,609    4,797    5,003        5,038    5,083    5,339    5,386    5,490    5,528    5,630
    Donors
   Cadaveric
                     7,202   7,509    7,638    7,690        7,726    7,769    8,017    8,023    8,089    8,202    8,534
   Transplants
     Live
                     2,535   2,851    3,009    3,377        3,649    3,912    4,361    4,552    5,324    5,974    6,233
     Donors
   Live Donor
                     2,535   2,850    3,007    3,370        3,638    3,906    4,359    4,547    5,315    5,969    6,236
   Transplants
  Total Waitlist
                    22,063   24,765   27,258   30,590       34,000   37,438   40,931   43,867   47,596   51,144   54,844
  Patients
  New Waitlist
                    15,224   16,090   16,538   17,903       18,328   19,067   20,191   20,986   22,269   22,349   23,494
  Registrations



couple (Rapaport [1986], Ross et al. [1997]). This pair of couples can then exchange
donated kidneys. Compared to receiving cadaver kidneys at an unknown future time,
this improves the welfare of the transplant recipients (and therefore accomplishes the
aim of each patient’s donor). In addition, it relieves the demand on the supply of cadaver
kidneys, and thus potentially improves the welfare of those patients on the cadaver queue.
A small number of these two-couple operations have been done, and the transplantation
community has issued a consensus statement declaring them to be ethically acceptable
(Abecassis et al. [2000]).
    Another possibility is an indirect exchange involving an exchange between one
immunologically infeasible patient-donor couple, and the cadaver queue (Ross and Woodle
[2000]). In this kind of exchange, the patient in the couple becomes the highest priority
person on the cadaver queue, in return for the donation of his donor’s kidney to someone
on the queue.3 This improves the welfare of the patient in the couple, compared to having
a long wait for a suitable cadaver kidney, and it clearly beneÞts the recipient of the live
kidney, and others on the queue who beneÞt from the increase in kidney supply due to
an additional living donor. However Ross and Woodle note that his may have a negative
impact on type O patients already on the cadaver queue, an issue studied by Zenios,
Woodle, and Ross [2001], to which we shall return.
    In contrast to the system for cadaveric organs, and despite the growing interest in
at least small scale exchanges involving living donors, there is no national system, or
even an organized system at any level, for managing exchanges of kidneys from live

   3
    Priority on the cadaver queue (which will be discussed later) is actually a bit complex, as queues are
organized regionally, and actually consist of multiple queues, on which priority has to do with how well
matched the available kidney is to each patient.


                                                        3
donors. However, individual hospitals are beginning to think about larger scale living
donor exchanges. As this paper was being written, the Þrst three-couple kidney transplant
exchange in the United States was reported at Johns Hopkins Comprehensive Transplant
Center in Baltimore, among three couples for whom no two-couple transfer was feasible
(Olson, August 2, 2003).4 In the present paper we will consider how such a system of
exchanges might be organized, from the point of view of achieving eﬃciency, and providing
consistent incentives to patients, donors, and doctors, and what it’s welfare implications
might be.5
    Our proposals build on the literature of discrete allocation, starting from the “housing
market” of Shapley and Scarf [1974]. They studied a model in which individuals are each
endowed with an indivisible good (a “house”) and have preferences over all the houses
in the market. They considered a “top trading cycles” mechanism, proposed by David
Gale, and observed that for any preferences it always exhausted the gains from trade and
produced an outcome in the core of the market. It was subsequently shown that this
outcome is unique when preferences are strict (Roth and Postlewaite [1977], and that the
top trading cycles mechanism makes it a dominant strategy for every agent to state his
true preferences (Roth [1982]). In what follows, it will sometimes be helpful to think of the
traders and houses being analogous to transplant patients and their potential live donors.
Of course we will have to be careful to remember that donors are not houses, they are
agents with preferences, and any individually rational, incentive compatible mechanism
for kidney exchange will have to accommodate their preferences also.6
    Abdulkadiroùglu and Sönmez [1999] considered the more general problem of allocating
dormitory rooms to students. In their model, some students already occupy a room, other
(new) students do not have a room, and some rooms are unoccupied. They observed
that the allocation schemes used in practice on many campuses do not achieve eﬃcient
allocations, because they do not allow students who already have a room to attempt to
trade it for a room they prefer, without running the risk of receiving a less preferred room.

   4
     Earlier multiple couple exchanges in Romania were reported by Lucan et al. [2003].
   5
     While we know of no other research investigating the design of eﬃcient live donor exchange as
contemplated here, the management of the cadaver queue has inspired a substantial literature, including
consideration of how it will interact with indirect exchanges. Some notable contributions are Votruba
[2001], Wujciak and Opelz [1993, 1997], Zenios, Wein, and Chertow [1999] and, particularly, Zenios,
Woodle and Ross [2001].
   6
     It may not at Þrst glance be obvious why strategic misrepresentation of preferences is a potentially
serious problem in medical applications, since no one chooses to be ill. However existing cadaver queue
procedures are frequently gamed, by physicians acting as advocates for their patients. Thus for example,
on July 29, 2003 two Chicago hospitals settled a Federal lawsuit alleging that some patients had been
fraudulently certiÞed as sicker than they were to move them up on the liver transplant queue (Warmbir,
2003), while Scanlon et al. (2003) report evidence of similar “gaming” behavior on the waiting list for
cadaver hearts.



                                                   4
Abdulkadiroùglu and Sönmez proposed a mechanism that generalizes the top trading cycles
mechanism to this more general environment, and retains its desirable properties. In what
follows it will be helpful to think of the students with rooms as analogous to transplant
patients with potential live donors, the students without rooms as analogous to transplant
patients who are on the cadaver waiting list, and the unoccupied rooms as analogous to
cadaver kidneys. Once again, these analogies will not be precise. The biggest diﬀerence is
that (unlike vacant rooms) cadaver kidneys cannot be placed in inventory and allocated
at the same time as live donor kidneys. The supply of cadaver donors is a stochastic
process (and each kidney must be transplanted within hours). But as in the case of
campus housing, in order to achieve all possible gains from trade, we will have to consider
not only trade among patients with donors, and not only allocation of cadaver kidneys to
patients without donors, but also indirect exchanges that link the two groups of patients
and sources of kidneys.
    The design we propose here is intended to build on and complement the existing
practices in kidney transplantation. In this respect and others it is in the modern tradition
of engineering economics as applied to other problems of allocation, such as labor market
clearinghouses (e.g. in medicine7 ), or auctions.8
    This paper is organized as follows. Sections 2-4 give some necessary background on
kidney disease and transplantation, including description of existing live kidney exchange
programs. Section 5 reviews the most relevant economics literature on discrete allocation.
Section 6 formally models the kidney exchange environment, and section 7 presents some
closely related alternative designs for kidney exchange, and proves some theorems about
their eﬃciency and incentive compatibility, which are extended in section 8 to the case
in which patients may have multiple willing donors. These theoretical results make clear
that there are potential welfare gains from considering such exchange, but they do not
give any indication of the magnitude of such gains. For this we turn, in section 9, to the
results of preliminary simulations, which suggest that the potential gains are substantial,
both in increased number of feasible live-donor transplants, and in quality of kidney to
patient match. Section 10 concludes. (All proofs are in the Appendix.)


2       Kidney Matching for Transplantation
End Stage Renal Disease (ESRD), also known as chronic kidney disorder, is a fatal disease
unless treated with dialysis or kidney transplantation. Transplantation is the preferred

    7
    Roth and Peranson [1999].
    8
    See e.g. Roth [2002] and Milgrom [forthcoming] for discussions of recent practical experience in the
design of mechanisms for exchange and allocation.


                                                   5
treatment because it enables the patients to resume normal activities.
    Two genetic characteristics play key roles in the possibility and success of a kidney
transplant. The Þrst of these is the ABO blood-type: There are four blood types A, B, AB
and O, representing which of two proteins, A and/or B are present. (Type O, pronounced
“oh,” stands for zero, i.e. neither of the proteins A or B is present.) In the absence of
other complications, kidneys can be successfully transplanted if they do not contain blood
proteins that are foreign to the patient. So type O kidneys can be transplanted into any
patient; type A kidneys can be transplanted into type A or type AB patients; type B
kidneys can be transplanted into type B or type AB patients; and type AB kidneys can
only be transplanted into type AB patients.
    The second genetic characteristic that aﬀects the success of a kidney transplant is
the tissue type, also known as human leukocyte antigens (HLA) type: HLA type is
a combination of six proteins, two of type A, two of type B, and two of type DR.
Empirical evidence shows that as the HLA mismatch between the donor and the recipient
increases, the likelihood of graft survival decreases (see Opelz [1997]).9 HLA plays
another key role in transplantation through the pre-transplant “crossmatch” test. Prior to
transplantation, the potential recipient is tested for the presence of preformed antibodies
against HLA in the donor kidney. The presence of antibodies, also known as a positive
crossmatch, signiÞcantly increases the likelihood of graft rejection by the recipient. Hence
the transplantation is not carried out if there is a positive crossmatch.


3         The Supply of Kidneys for ESRD Patients
As we have already mentioned, kidney transplantation is the treatment of choice for
patients suﬀering from ESRD. There are two main sources of kidneys for transplantation:

    1. Cadaveric kidney donations, and

    2. living kidney donations by families, spouses, and unrelated donors.

   Since the gap between the demand and supply is large and increasing and since several
thousand patients die every year waiting for transplantation, the importance of eﬃcient
and equitable allocation of donated kidneys is apparent. When a cadaveric kidney becomes
available for transplantation, the priority of each patient on the waiting list is determined
by a point system based on factors including the ABO blood-type, HLA antigen-match,
time spent on the waiting list, the region the kidney is harvested, etc. and the kidney is
oﬀered to the patient with the highest priority. If the patient declines the oﬀer, the kidney

    9
        The number of HLA-mismatches is the number of donor HLA proteins that are absent in the recipient.

                                                      6
is oﬀered to the patient with the second highest priority, and so on. The median waiting
time for a cadaveric kidney exceeds three years and it is increasing. This, together with
the superior survival rates of kidney grafts donated by living donors and the decreased
risk for the donor (less than 2% major complications including a mortality rate of 3 in
10,000 transplants, see Ross et al. [1997]) have signiÞcantly increased the number of
patient families, spouses and even friends who are eager to donate a kidney for their
loved ones. However a signiÞcant number of donors are eliminated from consideration
due to the incompatibility of the potential donor kidney with the intended recipient. The
size of such incompatibilities has especially risen in recent years due to an increase in
intended donations by non-blood related but emotionally related donors such as spouses
and close friends. For example at the University of Chicago, between 10 and 20 percent of
patients with available living donors cannot receive transplants from them because of ABO
blood-type incompatibility (Ross et al. [1997]). In addition 15 percent of all potential
donors are rejected based on a positive crossmatch and this rate is even higher between
spouses (because wives can develop antibodies to their husbands’ foreign proteins during
pregnancies) (Ross and Woodle [2000]). Based on these diﬃculties, researchers in the
transplantation community have been developing innovative kidney exchange programs
to increase the utilization rate of intended donations from living donors.


4    Existing Kidney Exchange Programs
To minimize the elimination of physically eligible volunteer kidney donors on the basis of
immunologic incompatibilities, Rapaport [1986] proposed the creation of a living donor
pool so that kidneys obtained from the pool of intrafamilial incompatible donors can be
used on an interfamilial basis. Rapaport states

     “The continued elimination of so many physically eligible and willing volunteer
     kidney donors on the basis of immunologic grounds is no longer acceptable,
     in view of the current acute need for organs. One feasible approach to this
     problem could be an international living-related donor and recipient exchange,
     whereby kidneys obtained from such a pool of intrafamilial incompatible
     donors would used on an interfamilial basis, following the same moral and
     ethical guidelines and medical criteria that currently govern living-related
     intrafamilial kidney donor transplantation. Such an international registry
     would permit the recipients with ESRD in each family, and their related
     volunteer donors who are incompatible with them, to be placed on a central
     organ-sharing registry, which would implement a direct exchange of kidneys
     between two given families, where the donor A, who is not compatible with

                                            7
      his own recipient A, but is compatible with recipient B from family B, would
      be the source of a kidney for recipient B, while donor B, who is incompatible
      with his own recipient B, but is compatible with recipient A, would give a
      kidney to recipient A.”

    Building on Rapaport’s [1986] proposal, Ross et al. [1997] again proposed to increase
the supply of living kidney donations by using kidneys from living ABO-incompatible
donors through an exchange arrangement between two living kidney donor-recipient
pairs. In year 2000, UNOS initiated pilot testing of the Rapaport [1986]-Ross et
al. [1997] proposal, currently known as the paired-kidney-exchange program. The
same year the transplantation community issued a consensus statement indicating that
paired-kidney-exchange program is considered to be “ethically acceptable” (Abecassis et
al. [2000]).
    Ross et al. [1997] initially proposed paired-exchange among donor-recipient pairs who
are ABO blood-type incompatible. Terasaki, Gjertson and Cecka [1998] indicate that
while 36% of all non-blood related donor-recipient pairs are ABO-incompatible, only a
sixth of this rate, i.e. 6% of all non-blood related donor recipient pairs can potentially
beneÞt from such an exchange. This is because, the majority of ABO-incompatible
donor-recipient pairs have an O type recipient (who is in need of an O type kidney),
and these pairs never beneÞt from a paired exchange, since an O type donor is never
ABO-incompatible with his intended recipient. Hence the only potential pairs are blood
type A and B mismatches. Ross and Woodle [2000] indicate that positive crossmatches
between potential donor and recipients will add to the pool of incompatible pairs that
are eligible for paired-kidney-exchange programs and also propose additional kidney
exchange programs that have potentially great clinical relevance. One of the exchange
programs they have proposed is the indirect exchange program: Under this program a
potential donor who is immunologically incompatible with his potential recipient donates
his kidney to the cadaveric waiting list and his paired recipient will receive priority for the
next ABO-compatible crossmatch-negative cadaveric kidney. Ross and Woodle carefully
diﬀerentiate between two types of indirect exchanges depending on the nature of the
incompatibility between the pair:

   1. The incompatibility may be due to a positive crossmatch, or

   2. it may be due to ABO blood-type incompatibility.

   The welfare implications of the two cases are quite diﬀerent, since in the Þrst case
an indirect exchange can create a Pareto improvement, while in the second an exchange
that helps some patients may impose a negative externality on others . Ross and Woodle
[2000] state:

                                              8
     “One type of living-cadaveric donor exchange involves a living donor and
     recipient who are ABO compatible but have a positive crossmatch. The person
     on the waiting list who is oﬀered the living kidney is the person who would
     otherwise receive the cadaveric kidney. For this person, the choice is between
     a cadaveric kidney or a living kidney. The decision of the potential recipient
     on the waiting list who is oﬀered the choice between a cadaveric or a living
     kidney is relatively simple: given the greater likelihood of graft survival, it is
     rational and reasonable that the individual will accept the exchange.
                             ..                              ..
                              .                               .


     The more likely indirect exchange, however, involves an ABO-incompatible
     donor recipient pair such that the person who would receive the living donor’s
     kidney is not the individual who would get the cadaveric kidney now to be
     transplanted into the paired recipient. This is because the most likely living
     donor who cannot donate directly will be an A, B, or AB donor who cannot
     donate to the potential O recipient. As such, the individual on the waiting list
     who beneÞts from the exchange will have the same blood type as the living
     donor and individuals on the waiting list with the same blood type as the
     paired recipient may have longer waiting times because the paired recipient
     gets priority for the next cadaveric kidney of that blood type. The problem is
     that although the number of kidneys available for individuals on the cadaveric
     waiting list could be numerically increased by ABO-incompatible indirect
     exchanges, and the quality of kidneys for cadaveric waiting list recipients
     improved, changes in beneÞciaries will occur.”

   There is widespread agreement in the transplantation community that indirect
ABO-incompatible exchange can harm those O blood-type patients who have no
opportunity to receive a live donation. This is because,

   • on the one hand they will be losing their priority to O blood-type patients whose
     ABO-incompatible donors donate to the cadaveric pool, and

   • on the other hand very few O blood-type living kidneys will be oﬀered to their pool
     since an O blood-type donor can directly donate to his intended recipient unless
     there is a positive crossmatch.

Despite this widespread concern, many transplant centers have started pilot indirect
exchange programs since 2000. Some examples include Johns Hopkins Comprehensive

                                             9
Transplant Center, Washington Regional Voluntary Living Donor Program, Center for
Organ Recovery and Education (Pittsburgh), and New England Medical Center (Boston).
   The present paper explores the design and potential beneÞts of a more comprehensive
kidney exchange mechanism that will

    1. allow not only for paired-kidney-exchange and indirect exchange but also many other
       forms of exchange such as a three-way exchange, more elaborate forms of indirect
       exchange, etc.,

    2. beneÞt not only the incompatible pairs but also the compatible ones,

    3. eliminate or at least reduce the adverse aﬀect to O blood-type patients with no
       living donors, and

    4. organize the live kidney exchange in a way that is compatible with the existing
       system of cadaveric kidney allocation.

As mentioned in the introduction, we will extend recent developments in the mechanism
design literature, motivated by housing allocation problems. We Þrst quickly review these.


5     House Allocation
Shapley and Scarf modeled a “housing market” as consisting of n agents each of whom
is endowed with an indivisible good, a “house.” Each agent has preferences over all the
houses (including his own), and there is no money in the market, trade is feasible only
in houses. They attribute to David Gale the “top trading cycle” algorithm that, for any
preferences, produces an allocation of houses to agents in the core of the market. The
algorithm can be described as follows: Each agent points to her most preferred house (and
each house points to its owner). Since the number of agents is Þnite and since each house
has an owner, there is at least one cycle in the resulting directed graph. In each such
cycle, the corresponding trades are carried out, i.e. each agent in the cycle receives the
house she is pointing to, and these agents and houses are removed from the market. (A
cycle may of course consist of an agent pointing to her own house.) The process continues
(with each agent pointing to her most preferred house that remains on the market) until
no agents and houses remain, and the Þnal allocation is the one in which each agent
receives the house with which she left the market.
    The proof that this allocation is in the core is straightforward: no blocking coalition can
contain members of the Þrst cycles to leave the market, since those agents each already
received their Þrst choice house. But then no blocking coalition can form containing

                                              10
members of the second set of cycles to leave the market, since the only houses they might
prefer to those they received are those that left in the Þrst set of cycles, and the owners of
these houses are not in any blocking coalition. Hence there exists no coalition of agents
who could have traded among themselves to achieve an outcome they prefer. It can further
be shown that, when the method of top trading cycles is used to allocate houses, it is a
dominant strategy for each agent to reveal his true preferences (Roth [1982]). And when
all preferences are strict, the procedure yields a unique outcome (Roth and Postlewaite
[1977]). 10
    Note that paired kidney exchanges similarly seek the gains from trade among patients
with willing donors, but (with the recent Johns Hopkins 3-pair exchange being a notable
exception) mostly among just two pairs. In the kidney exchange to be considered below,
we will argue that, if we consider exchange only among patients with donors, the properties
of the housing market model essentially carry over unchanged, if we assume that donors’
preferences are aligned with those of their intended recipient (e.g. if both patients and
their donors are primarily concerned with the probability that the intended recipient
will have a successful transplant). We will also assume, as is the current practice, that
all surgeries in a given cycle are carried out simultaneously, since a donor’s willingness
to donate a kidney might change once her intended recipient has received a successful
transplant. Of course, some of the desirable incentive and eﬃciency properties would be
lost if the cycle size were restricted. (In practice, there will be limitations on the number
of simultaneous surgeries that can be conducted, and so we will keep track of cycle sizes
in the simulations we report.)
    However the kidney transplant environment consists not just of patients with donors,
but also patients without donors, and cadaver kidneys that are not tied to any speciÞc
patient. Abdulkadiroùglu and Sönmez [1999] studied the housing allocation problems on
college campuses, which are in some respects similar. In particular, Abdulkadiroùglu and
Sönmez [1999] analyze what they call house allocation problems with existing tenants: A
set of houses must be allocated to a set of students by a centralized housing oﬃce. Some
of the students are existing tenants each of whom already occupies a house and the rest
of the students are newcomers. In addition to occupied houses, there are vacant houses.
Existing tenants are not only entitled to keep their current houses but also apply for other
houses.
    The mechanism known as random serial-dictatorship with squatting rights (RSD-SR)

   10
      Abdulkadiroùglu and Sönmez [1998] consider a housing allocation model in which the houses are not
initially owned, and prove the surprising result that the same probability distribution over the set of
eﬃcient allocations can be achieved by either of two allocations methods: either randomly assign the
houses and Þnd the unique core outcome, or randomly order the agents and let them choose sequentially
from the stock of houses.


                                                  11
is common in housing allocation on college campuses.11 This mechanism works as follows:

   1. Each existing tenant decides whether he will enter the housing lottery or keep his
      current house. Those who prefer keeping their houses are assigned their houses. All
      other houses become available for re-allocation together with the vacant houses.

   2. An ordering of participating students (i.e. newcomers and existing tenants who
      decide to go ahead with the lottery) is randomly chosen.

   3. Once the agents are ordered, available houses are allocated using the induced serial
      dictatorship: The Þrst student is assigned his top choice, the next student is assigned
      his top choice among the remaining houses, and so on.

    While this mechanism is common in applications, it suﬀers from a major deÞciency.
Since it does not guarantee each existing tenant a house that is as good as his own,
some existing tenants may choose to keep their houses even though they wish to move,
and this may result in loss of potentially large gains from trade.12 In the context of
kidney transplantation, the counterpart of an existing tenant and his current house is
a recipient-donor pair. Just as an occupied house may be unavailable for re-allocation
unless its current owner is assured a better house, a potential donor will in most cases
be unavailable for donation unless his intended recipient is assured a better kidney. The
apparent similarity between the two problems suggests that the solution oﬀered in the
context of on-campus housing may be of use in the context of kidney transplantation as
well.
    The ineﬃciency of the RSD-SR is caused by the mechanism’s failure to guarantee each
existing tenant a house at least as good as the one he already holds. To achieve eﬃciency
this deÞciency needs to be addressed.13 This is the motivation for the generalization of
the top trading cycles (TTC) mechanism proposed by Abdulkadiroùglu and Sönmez [1999],
which they called you request my house-I get your turn (YRMH-IGYT):

   1. Each student (existing tenant or newcomer) reports his strict preferences over all
      houses.

   2. An ordering of agents is randomly chosen.

  11
     Some examples include undergraduate housing at Carnegie-Mellon, Duke, Michigan, Northwestern
and Pennsylvania.
  12
     See Chen and Sönmez [2002] for experimental evidence of this ineﬃciency.
  13
     Formally speaking, one must incorporate individual rationality constraints into an implementation
problem to assure voluntary participation. See Jackson and Palfrey [2001] for a general treatment of
“voluntary implementation.”



                                                 12
  3. For any given preference list and ordering, the outcome is obtained using the
     following (YRMH-IGYT) algorithm:

       (a) Assign the Þrst student his top choice, the second student his top choice among
           the remaining houses, and so on, until someone requests the house of an existing
           tenant.
      (b) If at that point the existing tenant whose house is requested is already assigned
          another house, then do not disturb the procedure. Otherwise modify the
          remainder of the ordering by moving the existing tenant to the beginning of
          the line and proceed with the procedure.
       (c) Similarly, move any existing tenant who has not already been assigned a house
           to the beginning of the line once his house is requested.
      (d) If at any point a cycle forms, it is formed by exclusively existing tenants and
          each of them requests the house of the tenant who is next in the cycle. (A
          cycle is an ordered list of students (i1, i2 , . . . , ik ) where student i1 requests the
          house of student i2, student i2 requests the house of student i3,. . ., student ik
          requests the house of student i1 .) In such cases remove all students in the cycle
          by assigning them the houses they request and proceed with the procedure.

    The key innovation in the YRMH-IGYT mechanism is that an existing tenant whose
current house is requested is upgraded to the Þrst place in the line of agents remaining
unassigned, before his house is allocated. As a result the YRMH-IGYT mechanism
assures every existing tenant a house that is at least as good as his own (since the tenant
is always free to point to his own house if all houses he prefers have already left the
market). Therefore existing tenants do not have any reason to hesitate entering the
market and consequently the eventual house allocation is Pareto eﬃcient. Note that the
idea of upgrading an existing tenant whose current house is requested to the top of the line
was also invented by the transplantation community in the form of an indirect exchange
program: When a potential donor donates his kidney to the highest priority patient in
the waiting list, his intended recipient is upgraded to the top of the waiting list. Hence an
indirect exchange is one of several possible types of exchanges that can be realized under
the YRMH-IGYT mechanism, in addition to the more straightforward exchanges among
couples each of whom has a donor.
    By way of analogy, note once again that what prompted the need for the introduction
of simple kidney exchange programs by researchers and clinicians in the transplantation
community was the loss of many physically eligible volunteer kidney donors because
of immunologic incompatibilities. Under these exchange programs, a potential donor


                                               13
who is incompatible with his intended recipient is given the incentive to go ahead with
the donation, because his donation makes it possible for his intended recipient to be
transplanted a compatible kidney. Similarly, the potential eﬃciency loss in the campus
housing problem is that some rooms might fail to be traded, even when welfare enhancing
trades are possible. The YRMH-IGYT is an attempt to address that problem in the
housing context. In the following sections, we will consider how it must be adapted
to the problems of kidney exchange, and study its properties in the context of kidney
transplantation.


6     Kidney Exchange Problem
While there are clear similarities between house allocation and kidney exchange, there are
also important diﬀerences.
    As already mentioned, the counterpart of an existing tenant and his house is a
donor-recipient pair in the context of kidney exchange. We denote a donor-recipient
pair by (ki , ti ). We will often refer to donor ki as kidney ki , and recipient ti as patient ti .
    In the context of house allocation with existing tenants, there are newcomers none
of whom owns a speciÞc house and vacant houses none of which is owned by a speciÞc
student. The counterpart of newcomers in the context of kidney exchange are patients
who have no living donors and the counterpart of vacant houses are cadaveric kidneys
which are not targeted for speciÞc patients. This analogy reveals one important diﬀerence
between the two models: The house allocation model is static and in particular the set
of vacant houses is Þxed. The kidney exchange problem, on the other hand, is dynamic
and in particular it is not clear which cadaveric kidneys will be available, when they will
be available, etc. Therefore while occupied houses as well as vacant houses are jointly
allocated under the YRMH-IGYT mechanism, this is not possible in the context of kidney
exchange. Instead, patients with live donors who are not themselves allocated a live
donor kidney will be assigned to the cadaver queue (with a priority reßecting whether
their donor’s kidney was donated to someone on the queue).
    Let K denote the set of living donor kidneys at a speciÞc point in time. While patients
and their doctors may deÞne their preferences over possible kidneys as they wish, we will
consider here, for speciÞcity, the preferences that come from maximizing the probability
of a successful transplant. Given any patient t, part of K is outside the consumption
set due to ABO blood-type incompatibility or a positive crossmatch. Among feasible
kidneys, HLA match plays a signiÞcant role in the graft survival. Using data from 1,585
transplants from non-spousal non-blood related living donors from 1986 to 1995 at 198
transplant centers, Opelz [1997] shows that the 3-year graft survival rate is 87±2% when


                                                14
there is no HLA-DR mismatch between the recipient and the donor, the same rate is
81±2% when there is 1 HLA-DR mismatch, and it is 75±4% when there are 2 HLA-DR
mismatches.14 Therefore the graft failure rate in three years almost doubles from 13% to
25% when the HLA-DR mismatch increases from 0 to 2. These results are statistically
highly signiÞcant. There are similar conclusive results correlating overall HLA match
with graft survival (see for example Opelz [1997], Opelz [1998]). It is also known that
as the donor age increases, the rate of graft survival Þrst increases and then decreases.
Therefore patients have heterogenous preferences over compatible kidneys although there
are correlations based on age and the health of the donor . So, although current pilot
kidney exchange programs do not rely on patient preferences, there are very good medical
reasons to do so. Indeed Opelz [1997] states:

        “A potential implication of the results presented herein is that the
        transplantation of kidneys from unrelated live donors should be done more
        selectively so that poor HLA matches may be avoided. One could speculate
        that an exchange of live-donor organs might be advantageous in certain
        situations. For example, if a potential live donor were willing to donate a
        kidney to a recipient with whom he/she was a poor HLA match, that kidney
        could conceivably be given to another patient whose HLA antigen proÞle
        closely matched that of the donor. In return, the recipient who did not receive
        the designated live-donor kidney would be given priority for receiving another
        well-matched live-donor graft. Similar exchanges of live-donor kidneys for the
        purpose of obtaining ABO compatibility were proposed by Rapaport [1986]
        and recently again by Ross et al. [1997].”

    In what follows we will consider all preferences to be strict. One appealing possibility
is breaking the indiﬀerences based on the time spent in the system, parallel to the
tie-breaking rule for UNOS cadaveric kidney priority mechanism.
    If only direct exchanges among donor-recipient pairs are considered, one can directly
use Gale’s Top Trading Cycles mechanism. However this will not allow for indirect
exchanges. Other things being equal, graft survival rates of kidneys from living donors
is superior to the graft survival rates of cadaveric kidneys. However a cadaveric kidney
with good HLA match may be preferred by some patients to a living donor kidney with
poor HLA match. Opelz [1997] states:

        “Even well-matched cadaver donor kidneys would provide an advantage over
        those from poorly matched live donors. For instance, for the study period from

 14
      Each of these rates is 2% lower when spousal living donors are considered.

                                                    15
      1986 to 1995, the Collaborative Transplant Study shows a 5-year graft survival
      rate of 77±1% for 2392 cadaver kidney grafts from donors below the age of
      50 with no HLA-A, -B,-DR mismatch. This success rate compares favorably
      with that of poorly matched grafts from unrelated live donors.”

    In a very recent article, Mandal et al. [2003] provide a more detailed comparison
of graft survival rates for cadaveric kidneys and living donor kidneys. They show that
as patient age increases, it gets harder for cadaveric kidneys to outperform living donor
kidneys and for patients older than 60 years of age cadaveric kidneys never outperform
living donor kidneys based on graft survival rates.
    Since the supply of speciÞc cadaveric donor kidneys is not predictable, patients do not
know which cadaveric kidneys will be available and when they will be available. Therefore
a patient who wishes to trade his donor’s kidney in return for a priority in the cadaveric
kidney waiting list is receiving a lottery instead of a speciÞc kidney. Taking this into
consideration the patient, his doctor, and his donor shall decide whether this option is
acceptable and if so, where it ranks in patient’s preferences. Based on Mandal et al.
[2003], this option will be increasingly less appealing as the patient’s age increases.
    Given a patient ti , let Ki ⊂ K denote the set of living donor kidneys that are
compatible with patient ti . Note that kidney ki may or may not be in Ki . Let w denote
the option of entering the waiting list with priority reßecting the donation of his donor’s
kidney ki , and Pi denote his strict preferences over Ki ∪ {ki , w}. For our purposes the
relevant part of Pi is the ranking up to kidney ki or w, whichever ranks higher. If patient
ti ranks kidney ki at the top of his preferences that means he does not wish to participate
in an exchange. If patient ti ranks ki on top of w that means he (or his donor) does not
consider exchanging kidney ki with a priority in the cadaveric kidney waiting list.
    We are Þnally ready to formalize a (static) kidney exchange problem. A kidney
exchange problem consists of

   1. a set of donor-recipient pairs {(k1 , t1), . . . , (kn , tn )},

   2. a set of compatible kidneys Ki ⊂ K = {k1 , . . . , kn } for each patient ti , and

   3. a strict preference relation Pi over Ki ∪ {ki , w} for each patient ti .

     Let Ri denote the weak preference relation associated with the strict preference relation
Pi . Note that, since the preferences are strict, given two kidneys k, k 0 if kRi k 0 and k 6= k 0
then kPi k 0 .
     The outcome of a kidney exchange problem is a matching µ of kidneys/waitlist option
to patients such that


                                                    16
    1. each patient ti is either assigned a kidney in Ki ∪ {ki } or the waitlist option w, and

    2. no kidney can be assigned to more than one patient although the waitlist option
       w can be assigned to several patients. (This latter possibility makes the kidney
       exchange problem diﬀerent from the housing problems formulated above.)

Let µ(ti ) denote the assignment of patient ti under matching µ.
    Patients who have no living donors, but are on the queue for cadaver kidneys, are
not explicitly included as agents in the kidney exchange problem as we model it here,
although they will be aﬀected by the kidney exchange mechanism we introduce. The
main source of kidney grafts is cadaveric donors for these patients although, as in the
case of an indirect exchange program, occasionally cadaveric kidneys will be traded with
living donor kidneys. On the other hand, each patient who is transplanted a kidney
through the exchange mechanism is dropped from the waiting list for cadaveric kidneys
and therefore it is also beneÞtting patients with no living donors. (We will discuss this in
more detail when we report simulation results.)
    We also do not explicitly model the priority rules by which the cadaveric queue is
managed, although these will aﬀect the desirability of joining the queue, with and without
the high priority that is obtained by donating a kidney to someone in the queue. That
is, we consider the cadaver queue to be a separate process, whose eﬀect on the kidney
exchange among live donors will be reßected in where each agent ranks the alternative
“w” compared to other alternatives. (A patient who ranks his own donor higher than w
may be choosing to enter the cadaver queue without special priority, when his own donor
has a kidney that is infeasible for him.)


7     Top Trading Cycles and Chains Mechanism for
      Kidney Exchange
A kidney exchange mechanism is a systematic procedure to select a matching for each
kidney exchange problem. We are almost ready to introduce the Top Trading Cycles
and Chains (TTCC) mechanism, a variant of TTC mechanisms, for kidney exchange.
Before that we give a few deÞnitions and observations to facilitate the description of the
mechanism.


7.1     Cycles and w-Chains
The mechanism relies on an algorithm consisting of several rounds (no more than the
number of the agents). In each round

                                              17
    • each patient ti points either towards a kidney in Ki ∪ {ki } or towards w, and

    • each kidney ki points to its paired recipient ti .

    A cycle is an ordered list of kidneys and patients (k10 , t01 , k20 , t02 , . . . , km
                                                                                         0
                                                                                           , t0m ) such that

    • kidney k10 points to patient t01 ,

    • patient t01 points to kidney k20 ,
                 ..           ..
                  .            .
              0
    • kidney km points to patient t0m , and

    • patient t0m points to kidney k10 .

   Cycles larger than a single pair are associated with direct exchanges, very much like
the paired-kidney-exchange programs, but may involve more than two pairs. Whenever a
cycle is formed the corresponding trade is carried out, so that

    • patient t01 is assigned kidney k20 ,

    • patient t02 is assigned kidney k30 ,
                 ..            ..
                  .             .

    • patient t0m is assigned kidney k10 .

   Note that each cycle is of even size and in our algorithm each kidney or patient can be
part of at most one cycle. In other words no two cycles can intersect. That is because,
each patient points to a unique kidney/waitlist option and each kidney points to a unique
patient.
   A w-chain is an ordered list of kidneys and patients (k10 , t01 , k20 , t02 , . . . , km
                                                                                          0
                                                                                            , t0m ) starting
with a kidney, ending with a patient such that

    • kidney k10 points to patient t01 ,

    • patient t01 points to kidney k20 ,
                 ..           ..
                  .            .
              0
    • kidney km points to patient t0m , and

    • patient t0m points to w.


                                                     18
                                                 ª
                                    t1 ¾        k1 ¾        t2 ¾        k2                          t3
                                      @                                  KAA                        6
                                          @
                                           @                                   A
                                    k7         @                                   A                k3
                                  ¸             @                                   A
                                                    @                                   A
                                      ?              @                                      A
                                                      -@
                                                       Rω                                       A
                                    t7                                                              t4
                                                                                                    6

                                    k6      - t6            k5      - t5                    - k4




                                                 Figure 1: Example 1

                                       0
    We refer the last pair (km            , t0m ) in a w-chain (k10 , t01 , k20 , t02, . . . , km
                                                                                                0
                                                                                                    , t0m ) as the head and
the Þrst pair (k10 , t01 ) as the tail of the w-chain. A w-chain is also of even size but, unlike
in a cycle, a kidney or a patient can be part of several w-chains. In particular, note
that, whenever (k10 , t01 , k20 , t02 , . . . , km
                                                 0
                                                   , t0m ) is a w-chain, (k20 , t02 , . . . , km  0
                                                                                                     , t0m ) is a w-chain as
well. This motivates the deÞnition of a maximal w-chain. A w-chain (k10 , t01 , . . . , km                             0
                                                                                                                          , t0m )
is maximal if there is no donor-recipient pair (k00 , t00 ) such that (k00 , t00 , k10 , t01, . . . , km            0
                                                                                                                      , t0m ) is
also a w-chain.
    It is easy to see that w-chains are associated with indirect exchanges. The current
pilot indirect exchange programs in the U.S. use only minimal w-chains that consist of a
single donor-recipient pair.
    The notion of a maximal w-chain does not resolve the potential conßict between
w-chains; a kidney or a patient may even be part of several maximal w-chains. Therefore
the selection process of w-chains in the algorithm is not as straightforward as cycles.
Example 1:                  Consider the patient-kidney graph in Figure 1 with 7 pairs
(k1 , t1), . . . , (k7 , t7 ):




                                                              19
   In this graph, each kidney-patient pair initiates (i.e. is the tail of) a w-chain:

       W1 = (k1 , t1 ) , W2 = (k2, t2 , k1 , t1 ) , W3 = (k3, t3 , k1, t1 ) , W4 = (k4 , t4, k2, t2, k1, t1 ) ,
       W5 = (k5 , t5 , k4 , t4 , k2 , t2 , k1 , t1) , W6 = (k6 , t6, k7, t7) , and W7 = (k7 , t7) .

There are two minimal w-chains W1 and W7 : All other w-chains contain either W1 or
W7 . There are three maximal w-chains W3 (which contains W1 ), W5 (which contains
W1 ,W2 , and W4 ) and, W6 (which contains W7 ). Note that w-chains W1 ,W2,W3 , W4, and
W5 intersect, since they all contain W1. Similarly w-chains W6 and W7 intersect since
they both contain W7 .                                                               ¤
    One practical possibility is choosing among w-chains with a well-deÞned chain selection
rule, very much like the rules that establish priorities on the cadaveric waiting list.
Existing indirect exchange programs choose the minimal w-chains, but this may not be
eﬃcient. Selection of longer w-chains will beneÞt other patients as well and therefore
the choice of a chains selection rule has eﬃciency implications (see Theorem 1). Chain
selection rules may be also used for speciÞc policy objectives such as increasing the inßow
of blood-type O living donor kidneys to the cadaveric waiting list.
    Whenever w-chain (k10 , t01 , . . . , km
                                           0
                                             , t0m ) is selected in the algorithm, the following
elaborate indirect exchange will be carried out:
   • patient t01 is assigned kidney k20 ,

   • patient t02 is assigned kidney k30 ,
                ..            ..
                 .             .

   • patient t0m−1 is assigned kidney km
                                       0
                                         ,

   • patient t0m receives high priority for the next compatible kidney in the cadaveric
     waiting list, and

   • kidney k10 is either oﬀered to the cadaveric waiting list or to another patient with a
     paired donor.
   The following lemma will be a key element of our algorithm.

Lemma 1 Consider a graph in which both the patient and the kidney of each pair are
distinct nodes as is the waitlist option w. Suppose each patient points either towards a
kidney or w, and each kidney points to its paired recipient.15 Then either there exists a
cycle or each pair initiates a w-chain.
  15
    Using graph theory terminology, there is a directed link from each patient to a kidney or w, and a
directed link from each kidney to its paired recipient.

                                                         20
    We are Þnally ready to introduce the top trading cycles and chains mechanism.
    Because the exchange mechanism interacts with many parts of the kidney transplant
environment, it will clarify the discussion which follows to start by indicating which parts
of the environment we take as Þxed for our present purpose.
    First, we take the operation of the cadaver queue as Þxed, both in how it gives priority
to candidates without donors, and (higher priority) to candidates who come to the queue
from the kidney exchange mechanism and whose donor makes a donation to someone on
the queue. The cadaver queue can be thought of as a stochastic arrival process of cadavers
and patients, interacting with a scoring rule that determines which patients are oﬀered
which cadaver kidneys.
    We also take as given the size of the live kidney exchange, i.e. the set of patient-donor
pairs is taken to be Þxed. In practice, the set of patient-donor pairs will grow as the
geographic area served by the kidney exchange is increased, or as the time between
exchanges is increased. A larger pool of possible exchanges will increase the potential
eﬃciency gains that can be realized by exchange, but will also increase the size of the
trading cycles that might be needed to achieve these eﬃciencies. We will keep track of
both of these when we report simulations.
    Both the operation of the cadaver queue, and the frequency and scope of the kidney
exchange will inßuence patients’ “reservation utility,” i.e. how they compare various
opportunities for direct or indirect exchange to the option of not making any exchange
now, but waiting for a future opportunity. Patients can express this reservation utility by
where they put their own donor in their preferences.


7.2     The Exchange Mechanism
For the mechanism deÞned below, we assume that when one among multiple chains must
be selected, a Þxed chain selection rule is invoked to make the choice. We will consider a
number of such chain selection rules, and their implications for incentives, eﬃciency, and
equity.
    Throughout the procedure kidneys are assigned to patients through a series of
exchanges. Some patients and their assigned kidneys will be immediately removed from
the procedure and play no further role in exchange, while others will remain with their
assignments but they will assume a passive role. So at any given point in the procedure,
some agents may no longer be participants, while of the remaining participants, some will
be active and the others passive.
    At a given time and for a given kidney exchange problem h{(ki , ti )}ni=1 , (Ki )ni=1, (Pi )ni=1 i,
the TTCC mechanism determines the exchanges as follows:



                                                  21
1. Initially all kidneys are available and all agents are active. At each stage of the
   procedure

     • each remaining active patient ti points to the best remaining unassigned kidney
       or to the waitlist option w, whichever is more preferred, based on his preferences
       Pi ,
     • each remaining passive patient continues to point to his assignment, and
     • each remaining kidney ki points to its paired recipient ti .

2. By Lemma 1, there is either a cycle, or a w-chain, or both. By deÞnition, a cycle
   can neither intersect with another cycle nor with a w-chain.

   (a) Proceed to Step 3 if there are no cycles. Otherwise locate each cycle and carry
       out the corresponding exchange. Remove all patients in a cycle together with
       their assignments. Note that patient ti is removed if and only if kidney ki is
       removed.
   (b) Each remaining patient points to its top choice among remaining kidneys and
       each kidney points to its paired recipient. By Lemma 1, there is either a cycle,
       or a w-chain, or both. Proceed to Step 3 if there are no cycles. Otherwise
       locate all cycles, carry out the corresponding exchanges, and remove them.
   (c) Repeat Step 2b until no cycle exists.

3. If there are no pairs left, then we are done. Otherwise by Lemma 1, each remaining
   pair initiates a w-chain. Some of these w-chains may intersect and others may not.

   (a) If each remaining w-chain is minimal, then each remaining patient points to
       the wait list option w. In this case carry our the basic indirect exchanges and
       we are done.
   (b) Otherwise select only one of the chains with the chain selection rule. The
       assignment is Þnal for the patients in the selected w-chain. In addition to
       selecting a w-chain, the chain selection rule also determines
         i. whether the selected w-chain is removed and the associated exchange is
            immediately carried out, or
         ii. the selected w-chain remains in the procedure although each patient in it
             is passive henceforth.




                                         22
           The relevance of the last point is the following: Whenever a w-chain
           (k10 , t01, . . . , km
                                0
                                  , t0m ) is selected, even though the assignments of all patients in the
           w-chain are Þnalized, the kidney k10 at the tail of the w-chain can be utilized
           in two possible ways: It can be immediately oﬀered to the waiting list (in
           which case the w-chain shall be removed) or it may be made available for the
           remaining patients as the process continues and hence the selected w-chain may
           possibly grow later on, although the patients already in it are not aﬀected.

   4. Each time a w-chain is selected, a new series of cycles may form. Repeat Steps 2
      and 3 with the remaining active patients and unassigned kidneys until no patient
      is left.


    At the end of the procedure, each patient with a living donor is assigned a kidney (or
a high priority place on the waiting list). However that does not necessarily mean each
of these patients receives a transplant. In particular cycles (ki , ti ) that consist of a single
patient-donor pair (i.e. a cycle in which the patient points to his own donor) may mean
a number of things:

   1. The patient ti may be transplanted the kidney of his paired donor ki if there is no
      incompatibility.

   2. The cycle (ki , ti ) may form “late” in the algorithm as a result of the lack of demand
      on kidney ki and thus all preferred kidneys might have been assigned to other
      patients via direct or indirect exchanges. If kidney ki is not a good match for
      patient ti , he can either wait for other pairs to enter the system or consider an
      indirect exchange and rank the cadaveric waitlist option w before kidney ki . (Note
      that this cannot be the case under the preference Pi for otherwise patient ti would
      be at the head of a chain).
      It is also possible that a patient ti with donor ki , who is in no rush, might have a
      high reservation utility and have ranked ki high with the hope of trading it with a
      high quality living donor kidney the next time the exchange is run, after new donors
      have entered the system.

   We next give a detailed example in order to illustrate the dynamics of the TTCC
mechanism.
Example 2: Consider a kidney exchange problem with 12 pairs (k1 , t1 ), . . . , (k12 , t12 )
where


                                                  23
   • patients t1 , t10 each has blood-type AB,

   • patients t3 , t5, t8 each has blood-type A,

   • patients t4 ,t7 , t12 each has blood-type B,

   • patients t2 , t6, t9 , t11 each has blood-type O, and

   • donors k2, k4, k7, k12 each has blood-type A,

   • donors k1, k9, k10 each has blood-type B,

   • donors k3,k5 ,k6 ,k8, k11 each has blood-type O.

   Note that pairs (k2 , t2 ), (k4, t4 ), (k7 , t7), (k9 , t9 ) , (k12 , t12 ) are ABO-incompatible.
Preferences of patients over compatible kidneys and the waitlist option are given as follows:

                t1     t2    t3    t4   t5     t6     t7   t8     t9   t10   t11   t12
                k9    k11   k2    k5    k3     k3    k6    k6    k3    k11   k3    k11
                k10   k3    k4    k9    k7     k5    k11   k4    k11   k1    k6    k3
                k1    k5    k5    k1    k11    k8    k1    k11    ω    k4    k5    k5
                      k6    k6    k8    k4     k6    k3    k2          k5    k11   k9
                      k2    k7    k10   k5           k9    k3          k6          k8
                            k8    k3                 k10   k8          k7          k10
                            k11   k6                 k1                k2          k12
                            k12    ω                  ω                 ω
                             ω

     Suppose that patients are ordered in a priority-list based on their indices starting
with the patient with the smallest index. We will implement the TTCC mechanism using
the following chain selection rule: Choose the longest w-chain. In case the longest w-chain
is not unique, choose the w-chain with the highest priority patient; if the highest priority
patient is part of more than one, choose the w-chain with the second highest priority
patient, and so on. Keep the selected w-chains until the termination.
    We next execute the TTCC mechanism:
    Round 1. There is a single cycle C1 = (k11 , t11, k3, t3 , k2, t2 ). Remove the cycle by
assigning k11 to t2 , k3 to t11 , and k2 to t3 .

                                              [Figure 2]

  Round 2. Upon removing cycle C1 , a new cycle C2 = (k7 , t7, k6, t6 , k5, t5 ) forms.
Remove it by assigning k7 to t5 , k6 to t7 , and k5 to t6 .

                                                    24
 t1 ¾                     k1           t2 ¾     k2 ¾                 t3 ¾
                                                                       t4 ¾   k3 +    k4
                      ­                                     3
                                                          # J ]          A
                    ­                                 # ¸¯¯ J              A
                                                  # ¯           J
                   ­                           #                  J          A
  k12            ­                         #              ¯                   A       t5
                                                                    J
               ­                       #                ¯            J          A      6
              ­                    #                   ¯                          A
   ?                           #                                       J           AU
            ­                #                       ¯                   J
  t12     ­                 #                       ¯                     J           k5
         ­                #                       ¯                          J
       ­                 #                      ¯
                      #                  ω ¯                                   J
   ?­À              #                                                            J
  k11            #                            ¯                                       t6
               #                             ¯
±           #                              ¯                                           6
          #                              ¯
   ? #
                                        ¯
  t11#                                                                           * k6
                                      ¯
                                                                           ©   ©©
                                     ¯                                  ©              6
                                   ¯                               ©  ©
          -                 -
                                 ¯
                                                          -   ©©                 - t7
  k10        t10        k     t9               k8            t8        k7
                    3 9




                              Figure 2: Example 2, Round 1

                    R
 t1 ¾                     k1                                                         t4 ¾                    k4
   L                                                                                  A
       L                                                                                  A
        L                                                                                     A
 k12 L                                                                                         A             t5
            L                                                                                      A          6
                L                                                                                      A
  ?                 L                                                                                   AU
 t12                 L                                                                                       k5
  J                      L
                          L                                                                                   6
      J
          J                   L
           J                      L                                  ω                                       t6
                J                  L
                     J L                                        ¢̧                                            6
                                                               ¢
                      J L                                     ¢
                        J L                               ¢
                          J L                                                              * k6
                                                                                          ©©
                                                      ¢                                 ©
                           J L                    ¢                                 ©©
                                                                                              6
                            JL                   ¢                               © ©
                    - t10     ^UL
                              J               - t9                          - t8©          - t7
 k10                             k9                                  k8              k7
                                                                                      I




                              Figure 3: Example 2, Round 2


                                               25
                                        R
                      t1 ¾                   k1                                              t4 ¾                          k4
                       L                                                               ¿                                  ±̄
                           L                                                          ¿                               ¯
                            L                                                        ¿                            ¯
                      k12 L                                                         ¿                            ¯
                                L                                             ¿                              ¯
                                    L                                        ¿                           ¯
                       ?                L                                   ¿                           ¯
                      t12                L                                 ¿                        ¯
                               L                                         ¿                      ¯
                      J                                                ¿                       ¯
                        J       L
                                  L                                   ¿                      ¯
                          J                                        ¿                        ¯
                           J        L
                                     L                          ¿ ω                       ¯
                             J                               ¿                          ¯
                               J       L                           ¢̧
                                                          ¿ ¢                          ¯
                                 J L                    ¿        ¢                   ¯
                                   J     L
                                                       ¿       ¢                    ¯
                                      J L             ¿      ¢                    ¯
                                         J  L
                                                    ¿      ¢                    ¯
                                           JL ¿          ¢                    ¯
                                             ^
                                             JL
                                              U   ª
                                                  ¿
                      k10 - t10                 k9    - t9            k8   - t8




                                              Figure 4: Example 2, Round 3

                                                       [Figure 3]

   Round 3. No new cycle forms and hence each kidney-patient pair starts an w-chain.
The longest w-chains are W1 =(k8 , t8 , k4 , t4, k9 , t9) and W2 = (k10 , t10, k1, t1 , k9 , t9 ), each
with three pairs. Since t1 , the highest priority patient, is in W2 but not in W1 , choose
and Þx W2. Assign w to t9 , k9 to t1, and k1 to t10 but do not remove them. Kidney k10 ,
the kidney at the tail of W2 , remains available for the next round.

                                                       [Figure 4]

  Round 4. Upon removing the w-chain W2 , a new cycle C3 = (k4 , t4 , k8 , t8 ) forms.
Remove it by assigning k4 to t8 and k8 to t4 .

                                                       [Figure 5]

   Round 5. No new cycles form and the pair (k12 , t12 ) “joins” W2 from its tail to form
the longest w-chain W3 = (k12 , t12 , k10, t10 , k1 , t1, k9 , t9). Fix W3 and assign k10 to t12 .
Since no patient is left, w-chain W3 shall be removed and kidney k12 at its tail shall be
oﬀered to the highest priority patient at the cadaveric waiting list.

                                                       [Figure 6]

                                                          26
                  R
t1 ¾                    k1                                                                                                                    t4 ¾                            k4
 L                                                                                                                                            ¯                              ±̄
     L                                                                                                                                    ¯                              ¯
      L                                                                                                                                  ¯                           ¯
k12 L                                                                                                                                ¯                              ¯
          L                                                                                                                      ¯                              ¯
              L                                                                                                                 ¯                           ¯
?                 L                                                                                                         ¯                              ¯
t12                L                                                                                                       ¯                           ¯
                       L                                                                                               ¯                           ¯
                        L                                                                                          ¯                              ¯
                            L                                                                                     ¯                           ¯
                                L                                                                             ¯                              ¯
                                                                                     ω                       ¯                           ¯
                                 L
                                     L                                          ¢̧                       ¯                           ¯
                                      L                                        ¢                     ¯                              ¯
                                          L                                   ¢                     ¯                           ¯
                                              L                           ¢                     ¯                              ¯
                                               L                      ¢                     ¯                              ¯
                                                   L              ¢                        ¯                        ¯
                                                    UL           ¢                    °̄                           ¯
k10               - t10                                  k9   - t9                   k8                  - t8
                                                                                µ



                            Figure 5: Example 2, Round 4

                  R
t1 ¾                    k1
 L
     L
      L
k12 L
          L
              L
?                 L
t12                L
                       L
                        L
                            L
                                L                                                    ω
                                 L
                                     L                                          ¢̧
                                      L                                        ¢
                                          L                                   ¢
                                              L                           ¢
                                               L                      ¢
                                                   L              ¢
?                                                                ¢
                                                    UL
k10               - t10                                  k9   - t9




                            Figure 6: Example 2, Round 5


                                                               27
   The Þnal matching is
                 Ã                                                       !
                     t1 t2 t3 t4 t5 t6 t7 t8 t9 t10 t11 t12
                                                                             .
                     k9 k11 k2 k8 k7 k5 k6 k4 ω k1 k3 k10
                                                                                      ¤
    It is worth emphasizing that the chain selection policy does not aﬀect a patient who
is at the head of a chain: Since he points to the waitlist option, he will eventually be
selected regardless of the chain selection rule. However whether his intended donor’s
kidney is oﬀered to the cadaveric waiting list or another patient with a living donor
depends on the rule.


7.3    Examples of Plausible Chain Selection Rules
Depending on policy priorities, one may consider adopting a number of alternative chain
selection rules. We next give several examples:

  a. Choose minimal w-chains and remove them.
      For this simplest chain selection rule the outcome is not aﬀected whether all minimal
      w-chains are removed simultaneously or they are removed one at a time.

  b. Choose the longest w-chain and remove it. If the longest w-chain is not unique
     then use a tie-breaker to choose among them. One possibility is priority ordering
     patient-donor pairs based on factors such as waiting time and breaking the ties
     based on this priority order.

  c. Choose the longest w-chain and keep it. If the longest w-chain is not unique, choose
     one based on a tie-breaker.

  d. Prioritize patient-donor pairs in a single list. Choose the w-chain starting with the
     highest priority pair and remove it.
      This chain selection rule may be used to increase the inßow of O blood-type living
      kidneys to the cadaveric waiting list by giving higher priorities to pairs with O
      blood-type donors.

  e. Prioritize patient-donor pairs in a single list. Choose the w-chain starting with the
     highest priority pair and keep it.
      This chain selection rule may be especially appealing: the TTCC mechanism with
      this chain selection rule is not only eﬃcient but also strategy-proof (see Section 7.4).


                                             28
   A w-chain that is formed at an interim step of the procedure may grow at following
steps unless it is removed; hence the immediate removal of w-chains has a potential
eﬃciency cost. Therefore the following “hybrid” of the last two chain selection rules may
appeal to those who wish to “minimize” the eﬃciency loss while increasing the inßow of
O blood-type living kidneys to the cadaveric waiting list.

   f. Prioritize the patient-donor pairs so that pairs with O blood-type donor have higher
      priorities than those who do not. Choose the w-chain starting with the highest
      priority pair; remove it in case the pair has an O blood-type donor but keep it
      otherwise.


7.4       Eﬃciency and Incentives
In what follows, we will speak of Pareto eﬃciency in terms of the agents in the kidney
exchange problem, namely the paired patients and donors who are available to participate
in the kidney exchange.16
    Given a kidney exchange problem h{(ki , ti )}ni=1 , (Ki )ni=1, (Pi )ni=1 i, a matching µ is
Pareto eﬃcient if there is no other matching ν which is weakly preferred by all patients
and strictly preferred by at least one patient. A kidney exchange mechanism is eﬃcient if
it always selects a Pareto eﬃcient matching at any given time. A natural question at this
point is whether the TTCC mechanism is eﬃcient. The answer depends on the choice of
the chain selection rule.


Theorem 1 Consider a chain selection rule such that any w-chain selected at a
non-terminal round remains in the procedure and thus the kidney at its tail remains
available for the next round. The TTCC mechanism, implemented with any such chain
selection rule, is eﬃcient.

       Two examples of such chain selection rules are

   1. the rule that chooses the longest w-chain and keeps it, and

   2. the priority based rule that selects the w-chain starting with the highest priority
      pair and keeps it.

  16
    A Pareto eﬃcient outcome with respect to this population of agents will remain Pareto eﬃcient if
we enlarge the set of agents to include those on the cadaver queue, but may not if we enlarge the set of
agents to include more patient-donor pairs.




                                                  29
   Chain selection rules that remove a selected w-chain before termination of the
algorithm, on the contrary, may yield Pareto ineﬃcient outcomes. Consider the following
example.
Example 3: Suppose the TTCC mechanism is implemented with the chain selection rule
that selects the longest w-chain and removes it. Suppose there are Þve donor-patient pairs
(k1 , t1), . . . , (k5 , t5 ) and the patients have the following preferences:

                                         t1   t2   t3   t4   t5
                                         ω    k1   k2   k1   k4
                                              ω    k1   k3   k5
                                                   ω    k4   ω
                                                        ω


There is no cycle at Round 1 and the longest w-chain is (k3 , t3 , k2 , t2 , k1 , t1). Upon removal
of this w-chain, there are two cycles (k4 , t4 ), (k5 , t5) and therefore the outcome is matching
                                         Ã                         !
                                              t1 t2 t3 t4 t5
                                    µ=
                                              ω k1 k2 k4 k5

although it is Pareto dominated by the matching
                                 Ã                 !
                                    t1 t2 t3 t4 t5
                             ν=                      .
                                    ω k1 k2 k3 k4

                                                                                         ¤
   Roth [1982] showed that the TTC mechanism is strategy-proof (i.e., dominant strategy
incentive compatible) in the context of housing markets.17 That is, truthful preference
revelation is a dominant strategy of the preference revelation game induced by the TTC
mechanism and hence an agent can never proÞt by misrepresenting his preferences. Recall
that, in the absence of indirect exchanges, the static kidney exchange problem is a housing
market model, and therefore the Roth [1982] result immediately applies. 18

  17
      See Abdulkadiroùglu and Sönmez [1999,2003] and Papai [2000] for extensions of Roth [1982] in
economic and abstract domains.
   18
      That is, at any speciÞc point in time, a patient cannot receive a more preferred kidney by
misrepresenting his preferences. However, given the dynamic aspect of the problem, a patient may
have a high likelihood of a favorable trade in the future and thus he may be unwilling to trade his paired
donor’s kidney at this time unless he receives a well-matched kidney. Therefore a kidney has an option
value for its intended recipient and this will be reßected in the stated preferences. We emphasize that
of course we speak of strategy proofness in the limited strategy space—the space of stated preferences—we


                                                   30
    What happens when indirect changes are allowed? Is the TTCC mechanism
strategy-proof? As in the case of eﬃciency, the answer depends on the choice of the
chain selection rule.

Theorem 2 Consider the following chain selection rules:

   1. Choose minimal w-chains and remove them.

   2. Prioritize patient-donor pairs in a single list. Choose the w-chain starting with the
      highest priority pair and remove it.

   3. Prioritize patient-donor pairs in a single list. Choose the w-chain starting with the
      highest priority pair and keep it.

   4. Prioritize the patient-donor pairs so that pairs with O blood-type donor have higher
      priorities than those who do not. Choose the w-chain starting with the highest
      priority pair; remove it in case the pair has an O blood-type donor but keep it
      otherwise.

The TTCC mechanism, implemented with any of these chain selection rules is
strategy-proof.

    Among these four chain selection rules, the last two are especially plausible: The
third rule yields an eﬃcient and strategy-proof mechanism whereas the fourth one gives
up eﬃciency in order to increase the inßow of blood-type O kidneys to the cadaveric
waiting list.
    On the negative side, strategy-proofness of TTCC is lost if one adopts a chain selection
rule that chooses among the longest w-chains. The following example makes this point.
Example 4: Consider the problem in Example 2, but suppose patient t4 misrepresents
his preferences as P40 = k5 , k1 , k9 , . . . improving the ranking of kidney k1 . While Round 1,
Round 2 remain as in Example 2, Round 3 changes and this time the longest w-chain at
Round 3 is W4 = (k8, t8, k4, t4 , k1 , t1 , k9 , t9 ) (see Figure 7). Therefore patient t4 is assigned
kidney k1 instead of kidney k8 , proÞting form his preference misrepresentation.                    ¤
   A chain selection rule which chooses among longest w-chains upsets strategy-proofness
because it allows a patient to inßuence his assignment by inßuencing the lengths of
w-chains via a preference misrepresentation.

have modeled for the kidney exchange problem.




                                                 31
                                      R
                   t1 ¾                     k1 ¾                                                                     t4 ¾                            k4
                     L                                                                                                                              ±̄
                         L                                                                                                                      ¯
                          L                                                                                                                 ¯
                   k12 L                                                                                                                   ¯
                              L                                                                                                        ¯
                                  L                                                                                                ¯
                    ?                 L                                                                                           ¯
                   t12                 L                                                                                      ¯
                                           L                                                                              ¯
                    J                                                                                                    ¯
                        J                   L
                                                L                                                                    ¯
                            J                                                                                       ¯
                             J                      L                                ω
                                                     L                                                          ¯
                                  J                                                                         ¯
                                       J L                                      ¢̧
                                                                               ¢                           ¯
                                        J L                                   ¢                        ¯
                                         J L                              ¢                           ¯
                                          J L                         ¢                           ¯
                                           J L                    ¢                           ¯
                                            JL                   ¢                           ¯
                                      -       ^UL
                                              J               - t9                        - t8
                   k10                      t10          k9                          k8




                                                Figure 7: Example 4, Round 3

7.5    Sequencing of Transplantations, Donor Incentives, and Size
       of Exchange Cycles
Each potential donor is an agent with his own incentives. Clearly it will cause serious
complications if a donor withdraws his consent after his intended recipient is transplanted
a kidney through an exchange arrangement. In the context of paired-kidney-exchange,
Ross et al. [1997] propose to perform the two transplantations simultaneously to avoid
such complications, and their proposal is reiterated by the consensus statement of the
transplantation community (Abecassis et al. [2000]). A similar practice should be adopted
to carry out the exchanges under TTCC, and, following the Þnal assignment of kidneys,
all transplantations associated with a given cycle of the TTCC algorithm that produced
the assignment should be performed simultaneously.
    A similar, but slightly diﬀerent, practice needs to be adopted to perform the
transplantations associated with w-chains that are selected and (eventually) removed by
the algorithm. The diﬀerence concerns the patient who is upgraded at the top of the
cadaveric waiting list. Since the time between the procurement and the transplantation
of a graft is key for the success of a cadaveric transplantation, coordinating a cadaveric
transplantation with several other living-donor transplantations is essentially impossible.
Therefore when a w-chain is selected by the algorithm, all the transplantations indicated


                                                               32
by that chain, with the exception of the cadaveric transplantation, should be performed
simultaneously, and the cadaveric transplantation can be performed later on, when the
cadaver kidney becomes available, without any need for coordination with the remaining
transplantations. Ross and Woodle [2000] propose a similar timing of transplantations in
the context of indirect exchange.
    There is one last constraint on the timing of transplantations. Whenever the
transplantations associated with a cycle/w-chain fails to be performed due to a last-minute
diﬃculty, this not only aﬀects the patients in this cycle/w-chain but potentially
other patients whose assignments were Þnalized by the algorithm in the subsequent
rounds. Therefore transplantations of a cycle/w-chain should be performed only after
all transplantations called for in previous rounds are performed. There are, however,
no additional timing constraints imposed by two or more distinct cycles/w-chains that
formed in the same round.
    Given the need for the elaborate timing of transplantations, the choice of the size of a
kidney exchange “organization” is not a straightforward task. On one hand, as the number
of participating pairs grows not only superior HLA matches is obtained but also more
patients receive a transplant on average (see Tables 4, 5, and 6). On the other hand, as the
number of participating pairs grows the average number and more importantly the average
size of cycles/w-chains increase (see Tables 10, 11, and 12) making the coordination
of transplantations increasingly more diﬃcult. Moreover, since last minute changes are
costly, all positive crossmatches should be determined when preferences are determined
and not when a cycle/w-chain is selected. Therefore preference construction also gets
increasingly diﬃcult as the number of participating pairs grows. The simulations in
section 9 explore the implications of diﬀerent numbers of participating pairs.
    There are currently 59 organ procurement organizations (OPOs) in the U.S., organized
into 11 UNOS regions. When a cadaveric kidney becomes available, it is Þrst oﬀered to the
highest priority patient within the OPO the kidney is harvested.19 If the kidney cannot
be allocated within the OPO, it is oﬀered to the regional waiting list; and if it cannot
be allocated within the region, it is oﬀered to the national waiting list. One possibility
may be to consider a similar structure in the context of kidney exchange. Exchanges may
be carried out within an OPO; pairs who cannot be accommodated within a reasonable
time may be included in a regional list; and if this does not work either the pair may be
included in a national list.

   19
      There is an important exception: If there is a patient with a perfect HLA match within the U.S., he
is oﬀered the kidney and in case the kidney is accepted his OPO pays back with the next kidney procured
which is of the same ABO blood-type.




                                                   33
8      Kidney Exchange with Multiple Donors
It is not unusual for some patients to have more than one potential living donor. In this
section we extend the kidney exchange problem to allow for this possibility. To simplify
the presentation and avoid repeating ourselves, we only consider direct exchanges (i.e.
exchanges exclusively involving live donors) and hence study the TTC mechanism. An
extension allowing for indirect exchanges would involve the TTCC mechanism in a manner
parallel to the discussion above.
     Given a patient ti , let mi ≥ 1 denote the number of his potential donors and let
ki1 , . . . , kimi denote his potential donors. Following the terminology in the basic model,
we often refer donor ki` as kidney ki` . Given patient ti , let Ki denote the set of all
kidneys that are compatible with patient ti and let Pi denote his strict preferences over
Ki ∪ {ki1 , . . . , kimi }.
     A (static) kidney exchange problem with (possibly) multiple donors consists of

    1. a set of patients {t1, . . . , tn },

    2. a set of kidneys {ki1 , . . . , kimi } attached to each patient ti ,

    3. a set of compatible kidneys Ki for each patient ti , and

    4. a strict preference relation Pi over Ki ∪ {ki1 , . . . , kimi } for each patient ti .

    Following the tradition in paired-kidney-exchange, we restrict ourselves to exchanges
in which only one of the donors attached to a patient donates his kidney in exchange for a
kidney transplanted to patient ti . Equivalently there is no free kidney: Each patient has
to provide a kidney in order to receive one. Therefore the outcome of a kidney exchange
problem with multiple donors is a matching µ of kidneys to patients such that

    1. each patient ti is assigned a kidney in Ki ∪ {ki1 , . . . , kimi }, and

    2. only one of the kidneys in {ki1 , . . . , kimi } is assigned to a patient, for any patient ti .

    Let µ(ti ) denote the assignment of patient ti under matching µ.
    DeÞnitions of a cycle, a mechanism, Pareto eﬃciency, eﬃciency, and
strategy-proofness directly carry over to the present model. A matching is individually
rational if it assigns each patient a kidney that is at least as good as any of his attached
kidneys. A mechanism is individually rational , if it always selects an individually rational
matching.
    The following lemma will be of use to extend the TTC mechanism to the present
context.

                                                  34
Lemma 2 Consider a graph which consists of patients and kidneys. Suppose each patient
points to a kidney and each kidney points to a patient. Then there exists a cycle.

  At a given time, and for a given kidney exchange problem with multiple donors, the
TTC mechanism determines the exchanges in several rounds as follows:
Round 1: Initially all kidneys are available. Each patient points to his most preferred
kidney and each kidney points to its attached patient. By Lemma 2, there exists a cycle.
Locate each cycle and carry out the corresponding exchange. Remove all patients in a
cycle together with their assignments and with their unassigned attached kidneys. If there
are any remaining patients, proceed to Round 2.
     In general, at
Round s: Each patient points to his most preferred remaining kidney and each kidney
points to its attached patient. By Lemma 2, there exists a cycle. Locate each cycle
and carry out the corresponding exchange. Remove all patients in a cycle together with
their assignments and with their unassigned attached kidneys. If there are any remaining
patients, proceed to Round (s+1).
    This extension of the top trading cycles mechanisms inherits the appealing properties
of the basic version for housing markets. We summarize some of these properties as a
theorem.

Theorem 3 The TTC mechanism is individually rational, eﬃcient, and strategy-proof.
Moreover it is the only mechanism which satisÞes each of these properties.20


9        Simulations
The theoretical treatment of the TTCC mechanism makes clear that larger exchanges
may yield welfare gains, but it gives us no idea of their magnitude, i.e. whether they are
worth pursuing. The following simulations are meant as a Þrst step in that direction. We
use data where it exists, e.g. on the likelihood of mismatches and positive crossmatches.
Where no data exists—on the willingness of patients and donors to trade a live donation
for priority on the cadaver queue—we do robustness checks by simulating a wide range of
preferences.21

    20
     The original uniqueness result is due to Ma [1994] in the context of housing markets. See also Sönmez
[1999] and Svensson [1999].
  21
     For a discussion of how computation similarly complements theory in other practical problems of
economic design, see Roth [2002].




                                                    35
Table 2: ABO Blood-type, gender, and age ditributions for new patients used in the
simulations.
                               A. Patient Blood type        Frequency
                                         O                    45.6%
                                         A                    39.5%
                                         B                    11.1%
                                        AB                     3.8%

                                  B. Patient Gender       Frequency
                                        Female              40.9%
                                         Male               59.1%

                                    C. Patient Age      Frequency
                                         <18               5.6%
                                        18—34              13%
                                        35—49             34.9%
                                        50—64             38.9%
                                         >64               7.6%


9.1     Patient and Donor Characteristics
We run our simulations using the Caucasian ESRD patient population between 18 and
79 years of age in the United States Renal Data System (USRDS). For the population
blood-type and age distribution, we use the respective distributions for new ESRD waitlist
patients recorded between January 1995 and April 2003 in the USRDS database. For the
gender distribution we use data recorded between 1992 and 2001.22 The blood-type,
gender and age distributions are reported in Table 2. We construct the conditional
distribution of patient ages given that the patient is adult (i.e. of age 18-79) using this
table.
    For the HLA protein characteristics of the population, we use the distribution reported
in Zenios [1996] using the USRDS registration data for years between 1988 and 1991. We
assume that all HLA proteins and blood-type are independently distributed following
Zenios [1996].
    In our simulations, for a demonstration of “possible eﬃciency gains” by the TTCC
mechanism, we consider a scenario with unrelated donor-patient pairs. About 25.3% all
living-donor transplants were in this category in 2001.23 UNOS database distinguishes two

  22
     Based on web UNOS/OPTN data and annual report as of 7/14/2003 retrieved from
http://www.OPTN.org.
  23
     In the medical literature, focus on living-donor transplants has been on unrelated living-donor
transplants. Although superior HLA matches with related recipients are assumed to make them relatively
good matches, there is no formal data analysis in this respect. Moreover, the real increase in the number
of living-donor transplants has come from unrelated donors in the recent years. Hence, we focus our


                                                   36
Table 3: Relation among Unrelated Donors, Age, and Positive Crossmatch Distributions
for Living Donors.
                           A. Unrelated Living Donors         Frequency
                                     Spouse                     53.5%
                                      Other                     46.5%

                               B. Living Donor Age        Frequency
                                        <18                  5.6%
                                       18—34                 13%
                                       35—49                34.9%
                                       50—64                38.9%
                                        >64                  7.6%

                               C. Positive Crossmatch       Frequency
                               Female Patient - Husband       33.3%
                                        Other                 11.1%


types of unrelated donors: spouses and others. The distribution of unrelated living-donor
transplants based on the donor relation and donor age are given in Table 3 for the time
spell 1992-2001. We assume that unrelated donors are also adults. Hence, we use this
table to Þnd the conditional distribution of the age of a non-spousal unrelated donor given
that he is an adult. We assume that HLA and blood-type characteristics of the donor
have the same distribution as the patients’. The characteristics of a non-spousal unrelated
donor is independently distributed with the patient. The characteristics of a spouse is
independently distributed with the patient except his or her age. We assume that the
spouse age is the same as the patient age.
   The positive crossmatch probabilities are assumed to be 0.333 between a female patient
and her donor husband, and 0.111 for every other patient-donor pair following Zenios,
Woodle and Ross [2001]. Wives, who have previously been pregnant, are documented to
have more frequent positive crossmatches with their husbands than other donors.


9.2     Preference Construction
The preferences of patients over available kidneys (or equivalently living-donors) in the
sample are determined using the survival analysis of grafts reported in Mandal et al.
[2003]. This analysis uses data obtained from Þrst-time kidney-only transplants between
1995 and 1998 in the USRDS database. We assume that the utility function of each patient

simulation analysis on unrelated living-donor transplants to make it comparable with relevant medical
studies. In related living-donor transplants, compatibility problems with regard to ABO-incompatibility
and positive crossmatch still continue to exist. Hence, implementation of the TTCC mechanism will
beneÞt these patients, as well.


                                                  37
depends on the donor age and the number of HLA mismatches throughout our simulations.
Mandal et al. [2003] derive the conditional risk of graft failure for several factors such as
patient race, patient age, patient health condition (more speciÞcally previous history of
diabetes), patient gender, donor type (cadaver or live), donor age, HLA mismatches, and
cadaveric organ cold waiting time by taking a baseline patient’s graft failure risk to be 1
(a baseline patient is a non-diabetic white female patient receiving a perfectly matched
organ from a live donor). Due to their estimation technique, the relative risks of failure
for each transplant type is constant at each time t after graft transplant with respect
to this baseline patient given that both organs survived until time t (i.e., using a Cox
proportional hazards estimation).24
    Using this analysis, and assuming that a patient’s utility from a graft is a monotone
decreasing function of its relative risk of failure determined by

   1. the age of the living-donor and

   2. the HLA mismatch number,

we derive the preferences of patients. Following Mandal et al. [2003], we assume that
                                                                                             y
the graft failure risk of a patient from a live organ transplant is in functional form ax b 10
where x is the number of HLA proteins in A, B and DR loci of the donor that do not
exist in the recipient, also known as the HLA mismatch number (changes in the range
{0, 1, 2..., 6}), y is the age of the living-donor (changing in the open interval (18, 80)), a
is the relative graft failure risk per HLA mismatch, and b is the relative graft failure risk
per 10 years of increase in the donor age. Therefore, since a patient’s utility over grafts
is a monotone decreasing function of its relative risk of failure, the utility function
                                                                  y
                                  u(x, y) = − ln (a) x − ln (b)
                                                                  10

represents patient preferences. Marginal rate of substitution, − 10ln(b)
                                                                    ln(a)
                                                                          , is determined as

       • 5.14 years of younger donor age per each additional HLA mismatch for patients
         younger than 60, and

       • 5.10 years of younger donor age per each additional HLA mismatch for patients
         older than 59.

  24
    Although we use statistics derived in diﬀerent studies using data from diﬀerent time spells, it is
natural to assume that distributions of new patient characteristics are the same and independent across
years for the same population, nemely the Caucasian ESRD patients in the United States.




                                                  38
using the Mandal et al. [2003] estimation. Using this utility function, we construct
patient preferences over compatible donors. We use the index of the donor as a tie-breaker
whenever a patient receives the same utility from two kidneys. Hence, given a sample of
compatible donors who are randomly drawn, we construct a strict preference ordering for
each patient.
    We also consider an alternative preference construction in subsequent simulations.
Under this alternative treatment, we assume that patient ti prefers another donor kj to
his own donor ki if and only if

   a. kidney ki is not compatible with him, or

  b. although kidney ki is compatible with him, it has more than an equivalent of one
     additional HLA mismatch than kidney kj has.

Hence, this preference construction illustrates a scenario in which patients are rather
“cautious” towards other donors’ kidneys. This assumption may be realistic especially
when patients do not know much about the previous health conditions of other donors.
    Under both preference scenarios, waitlist option may or may not be considered
acceptable by a patient. Indirect exchanges are rare in the United States and are still
considered to be experimental procedures. Currently very few transplant centers oﬀer
this option. Hence national data on the number of indirect exchanges is uninformative.
When a patient participates in an indirect exchange and is given priority at the cadaveric
waiting list, the expected HLA match quality is very low. Moreover cadaveric grafts are
documented to have higher graft failure risks than living-donor kidneys. Mandal et al.
[2003] report that this risk is 1.49 times higher than living donor grafts for patients younger
than 60 and 1.67 times higher for patients older than 59. Therefore many patients, who can
continue their lives with dialyses, may not consider the waitlist option acceptable, even if
they are incompatible with their paired donor. Instead, they may want to keep their own
donor for his option value for potential future exchanges with future donor-patient pairs.
On the other hand, waitlist option may be considered acceptable by patients who have
urgency for a kidney transplant. Since the median waiting time in the waitlist exceeds 3
years (it was 1134 days for a female and 1023 days for a male in 1998), the life quality is
quite low for many patients who go through continuous dialysis.
    Since the expected quality of HLA match is very low when a patient is given priority
in the waiting list and since the graft failure rates are signiÞcantly higher for cadaveric
kidneys than living-donor kidneys, we assume that a patient considers the waitlist option
acceptable only if his donor is not compatible with him. We also assume that the patients
who consider this option acceptable prefer any compatible living-donor kidney to this
option. Because there is no reliable data available on the rate of patients who consider

                                              39
this option acceptable, we use diﬀerent assumptions in our simulations. We consider four
treatments, in which respectively 0%, 10%, 20% and 40% of the patients with incompatible
donors prefer the waitlist option to their own donors.


9.3    Outline of the Simulations
We consider Þve diﬀerent regimes of kidney exchange mechanisms to contrast with the
no-exchange regime. The no-exchange regime is a mechanism where patients can only
receive kidneys from their own donors if they are compatible. Otherwise, they wait in
the waiting list for a cadaveric kidney and they cannot trade their donor’s kidney with
another patient or with a priority in the waitlist. This is the traditional system that is
currently in use in many countries.
    We consider the following Þve alternative exchange mechanisms:

   • The Þrst exchange regime is the paired-kidney-exchange mechanism. Under this
     mechanism, each patient is assigned his paired donor’s kidney whenever they
     are compatible. Incompatible pairs are considered for paired-kidney-exchange.
     An incompatible pair is randomly selected and randomly matched with another
     incompatible pair such that each of the two patients are compatible with the other
     one’s paired donor. The same matching process is repeated until no additional
     paired-kidney exchanges are possible. This is meant to roughly approximate the
     paired exchange program in use in several regional transplantation centers.

   • The second exchange regime is the top trading cycles mechanism.

   • The third exchange regime is the paired and indirect exchange mechanism. Under
     this regime, we Þrst run the paired-kidney-exchange mechanism. At the end of the
     algorithm, patients who have listed the waitlist option to be acceptable and who
     have not been matched with a living-donor kidney, are upgraded to the top of the
     waiting list, and make their donors’ kidneys available for the waitlist patients.

   • The fourth and Þfth exchange regimes are two variants of the top trading cycles and
     chains mechanism. As the chain selection rules of the TTCC mechanism, we use
     Rule e and Rule f (introduced in Section 7.3). In Rule e, we prioritize patient-donor
     pairs in a single list; we choose the w-chain with the highest priority pair and keep
     it. In Rule f , we prioritize the patient-donor pairs so that pairs with O blood-type
     donor have higher priorities than those who do not; we choose the w-chain starting
     with the highest priority pair; we remove it in case the pair has an O blood-type
     donor but keep it otherwise.


                                           40
    In our simulations, we randomly simulate a sample of n donor-patient pairs using
the population characteristics explained above. Then, we determine the preferences of
patients over kidneys in the sample: For each patient ti , we Þrst check whether a donor kj
is ABO-compatible. If kj is ABO-compatible, then we check whether there is a positive
crossmatch between ti and kj . If they test negative for crossmatch, then kj is in the
compatible donor set Ki of patient ti . After Þnding the set of compatible kidneys for each
patient, we obtain a preference ordering on this set, using the utility functions described
above. We construct 8 sets of preferences for each patient using the rational or cautious
preference construction methods discussed above and assuming that 0%, 10%, 20%, or
40% of patients with incompatible donors consider the waitlist option acceptable. We
simulate each of the six mechanisms under these eight preference scenarios. We use a
Monte-Carlo simulation size of 100 trials for three diﬀerent population sizes of 30, 100,
and 300 pairs.
    Note that no-exchange regime yields the same outcome for all 8 preference proÞles,
and the same is true for the paired-kidney-exchange mechanism as well. Moreover the
TTC regime yields the same outcome for the rational preferences regardless of the rate of
patients considering the waitlist option acceptable and the same is also true for cautious
preferences. Finally note that when no patient considers the waitlist option acceptable,
each version of the TTCC mechanism reduces to the TTC mechanism, and paired and
indirect exchange mechanism reduces to the paired-kidney-exchange mechanism.


9.4    Discussion of Results
The simulation results suggest that very substantial gains in the number and match
quality of transplanted kidneys might result from adoption of the TTCC mechanism.
    We report the details of this analysis in 9 tables, 3 for each population size. The rows
of the tables refer to diﬀerent regimes under diﬀerent preference proÞles constructed: the
top four rows refer to the outcomes under mechanisms without the waitlist option (and
to their counterparts, which permit the waitlist option in preferences, when nobody lists
the waitlist option). The other rows are divided into three groups, where each group
reports outcomes of mechanisms with the waitlist option when 10%, 20%, or 40% of the
patients with incompatible donors list the waitlist option over their donors in their stated
preferences. We also report outcomes of the mechanisms under cautious and rational
preference statements separately when two outcomes diﬀer from each other.
    The Þrst table of each population size (Table 4 for n=30, Table 5 for n=100, and Table
6 for n=300) reports the general patient statistics under each regime in the columns.
The Þrst column in these tables reports the total live donor transplants as percentage
of the population size, which is the sum of next two columns, transplants from own

                                            41
compatible donor (i.e., by cycles of 1 pair length involving a compatible donor-patient
pair) and transplants from trades (i.e., by cycles and w-chains with multiple pairs). The
third column is the percentage of patients upgraded to the top of the waitlist as heads of
w-chains. The fourth and Þfth columns report the quality of matches in the live donor
transplants: the risk of graft failure relative to the risk under no-exchange mechanism with
population size 30 is reported in the fourth column and the number of HLA mismatches
for an average transplant is reported in the Þfth column. The relative risk is calculated
for each transplant using the Mandal et al. [2003] analysis: the failure risk of a transplant
                 y
is given as ax b 10 where a = 1.06 for younger patients (i.e., younger than 60) and 1.05 for
older patients (i.e., older than 59) is the risk associated with each HLA mismatch and x
is the HLA mismatch number; b = 1.12 for younger patients and 1.10 for older patients is
the risk associated with each 10 year increase in the donor age;25 then we Þnd the average
risk in the population; Þnally, we normalize the average risk associated with one regime
with the risk associated with the baseline, no-exchange regime for population size 30.26
Standard errors of the estimates are reported in parentheses below them.
    In the next set of tables, we report the eﬀect of each regime on the waitlist additions for
each blood type for each population size (Table 7 for n=30, Table 8 for n=100, and Table
9 for n=300). The columns are separated into two main groups. The Þrst group reports
the net percentage of patients sent to the top of the waitlist using the waitlist option for
each blood type (the percentages are taken with respect to the population size). This is
a net upgrade burden, because it considers the diﬀerence between the patients added at
the top of the list and the kidneys made available for the waitlist patients. The second
part of the columns in these tables, for each blood type we report the percentage (of the
population size) that do not receive any transplants and do not trade their donors for
a spot at the top of the waitlist. The total percentage is also reported. These patients
continue to remain in the waitlist with their current priorities.
    In the Þnal set of tables, we report the sizes of cycles and w-chains under the
mechanisms for each population size (Table 10 for n=30, Table 11 for n=100, and
Table 12 for n=300). The columns of these tables are divided into two for cycles and
w-chains, respectively. Each part reports the number, the average length, the maximum
length of cycles/w-chains. The last column of each part reports the length of the longest
cycle/ w-chain encountered in 100 trials that we simulated. The lengths of cycles/w-chains

  25
      Mandal et. al. do not Þnd that patient gender and patient age have signiÞcant eﬀects on risk of
failure.
   26
      For example in the third row of Table 4, under the TTC mechanism with rational preferences, the
relative graft failure risk is 0.95, meaning that for every 100 grafts allocated by the no-exchange regime
that fail at any time t after the transplant, we expect only 95 grafts allocated by the TTC regime to fail
(conditional on their survival until time t).



                                                   42
are measured in pairs. Standard errors of the estimates are reported in parentheses below
them.
    Next we highlight a number of these results:

   1. A transition to TTCC mechanism will signiÞcantly improve the utilization rate
      of potential unrelated living-donor kidneys: Assuming a population size of 100
      pairs (see Table 5), while approximately 55% of potential living-donor kidneys
      are utilized under the no-exchange regime, this rate increases to 73.5% under
      the paired-kidney-exchange, and to 88-89.5% under the TTCC mechanism. The
      eﬃciency gain gets larger as the population size grows further: For example, for a
      population of 300 pairs the utilization rate increases to 91-92% under the TTCC
      mechanism.27

   2. A transition to TTCC signiÞcantly decreases the HLA mismatch (and hence
      signiÞcantly increases the HLA match quality), especially for the large populations:
      Assuming a population size of 100 pairs (see Table 5), the average HLA mismatch
      is 4.8 under the no-exchange regime as well as the paired-kidney-exchange regime,
      but it reduces to 3.7-3.9 under the TTCC mechanism. The average HLA mismatch
      remains the same for the former two regimes even when the population grows, but
      it further reduces under the TTCC mechanism. For example it reduces to 3.3-3.4
      for a population size of 300.28 With the increase in HLA match quality, the risk of
      graft failure decreases substantially by a transition to the TTCC mechanism.

   3. Under the TTCC mechanism, average/maximal sizes of cycles/w-chains increase
      as the population grows. However the increase is less than proportional: For a
      population size of 30 pairs, the average cycle size is 2.5-3 pairs, average size of
      the longest cycle is 5.4-5.7 pairs, and the longest cycle ever observed is 10 pairs.
      The same statistics are 1.8-2 pairs, 2-2.5 pairs, 7 pairs respectively for w-chains.
      For a population size of 300 pairs, the corresponding statistics are 4.9-6.3 pairs,

  27
      We test whether the medians of the distributions of average percentage of live donor transplantations
under diﬀerent regimes are signiÞcantly diﬀerent from each other using a (paired-sample) Wilcoxen
signed rank test for population size 100: between paired-kidney-exchange regime and no-exchange regime
the diﬀerence is highly signiÞcant with a p-value less than 10−17 ; between various TTCC regimes and
paired-kidney-exchange regime the diﬀerence is highly signiÞcant with p-values less than 10−17 . Similar
signiÞcance results apply for population sizes 30 and 300, as well.
   28
      We test whether the medians of the average HLA mismatch distributions under diﬀerent regimes are
signiÞcantly diﬀerent from each other using a (paired-sample) Wilcoxen signed rank test for population
size 100: between paired-kidney-exchange regime and no-exchange regime the diﬀerence is not signiÞcant
with a p-value 0.87; between various TTCC regimes and paired-kidney-exchange regime the diﬀerence is
highly signiÞcant with p-values less than 10−17 . Similar signiÞcance results apply for population sizes 30
and 300, as well.


                                                    43
       16-17 pairs, 26 pairs respectively for cycles, and 3.3-4.3 pairs, 5.7-6.5 pairs, 16 pairs
       respectively for w-chains (see Table 10 for n=30, Table 11 for n=100, and Table 12
       for n=300).

   4. O blood-type patients without living donors beneÞt from a transition to TTCC
      mechanism. That is achieved by signiÞcantly reducing the rate of O blood-type
      patients with potential donors who are forced to rely on the cadaveric waiting list
      because of an incompatibility. Consider population size of 100 pairs (see Table
      8): The O blood type patients, who join the cadaveric waiting list under the
      no-exchange regime, are 27.6% of all patients with living donors. This rate reduces
      to 21.9% under the paired-kidney-exchange and further to 5.5-8.7% under the TTCC
      mechanism. That means out of 100 patients with living donors, 13.2-16.4 patients
      with O blood types drop from “competition” at the waiting list from a transition
      from paired-kidney-exchange to TTCC mechanism. The cost of the transition to O
      blood-type patients with no living donors is the priority upgrade for a number of O
      blood-type patients, who are only 0.9-4.2% of all patients with living donors, in the
      cadaveric waiting list. This is a very plausible tradeoﬀ given the very high weight
      given to HLA match in cadaveric kidney allocation: Any O blood-type patient
      who joins the waiting list is a real “competitor” regardless of when he joins the
      waitlist.29 The beneÞt to O blood-type patients with no living donors increases as
      the population further grows.



10       TTCC vs. Current Kidney Exchange Programs,
         and Some Concluding Remarks
TTCC mechanism is motivated by the present kidney exchange programs but it has
a number of major advantages over them. In this section we discuss some of these
advantages:

   1. Only the incompatible pairs can beneÞt from the current kidney exchange programs
      whereas all pairs can potentially beneÞt from the TTCC mechanism: Current kidney
  29
     We test whether the medians of the distributions of average percentage of all patients joining the
O blood type queue (i.e. the sum of net waitlist upgrades from Þrst part of the table and other
waitlist additions from the second part of the table) under diﬀerent regimes are signiÞcantly diﬀerent
from each other using a (paired-sample) Wilcoxen signed rank test for population size 100: between
paired-kidney-exchange regime and no-exchange regime the diﬀerence is highly signiÞcant with a p-value
less than 10−17 ; between various TTCC regimes and paired-kidney-exchange regime the diﬀerence is
highly signiÞcant with p-values less than 10−17 . Similar signiÞcance results apply for population sizes 30
and 300, as well.

                                                    44
       exchange programs are designed for pairs for which the donor kidney is incompatible
       with the intended recipient. Part of such incompatibilities are overcome by these
       exchange programs and the loss of physically eligible and willing volunteer kidney
       donors is reduced. However even if a kidney is compatible with a patient it
       may not be a good match. The TTCC mechanism takes patient preferences into
       consideration and hence its implementation improves the match quality between
       patients and kidneys, consistent with the suggestions of Opelz [1997].30

   2. The current paired-kidney-exchange programs almost exclusively utilize exchanges
      between only two donor-recipient pairs whereas the TTCC mechanism utilizes
      exchanges among three or more pairs as well : The current paired-kidney-exchange
      programs are designed to avoid the potential donor loss arising from immunologic
      incompatibilities between donors and their intended recipients. If one only considers
      ABO blood-type incompatibilities, basic exchanges involving only two pairs is
      without loss of generality because, as Terasaki, Gjertson and Cecka [1998] indicate,
      the only eligible pairs are

         • blood-type A patients with blood-type B donors, and
         • blood-type B patients with blood-type A donors.

       However there are two major reasons why basic exchanges involving only two pairs
       will not be suﬃcient in general:

       (a) The incompatibility may also be due to a positive crossmatch and hence
           additional pairs may be needed even if the only objective is merely obtaining a
           compatible match. Lucan et al. [2003] indicate that this recently was the case
           at a transplant center in Romania.31 They state
            “In the transplant session involving three pairs, two displayed ABO
            incompatibility (A vs B in the Þrst pair and B vs A in the second pair).
            Although regarding ABO matching between the two pairs, transplantation
            was feasible, the direct exchange was not possible because the A donor had a
            positive cross-match with the A recipient of the other pair. A third pair with
            A blood group but a positive cross-match was used to solve the problem. The

  30
      Gerhard Opelz, along with Thomas Wujciak are the designers of X-COMB mechanism for the
allocation of cadaveric kidneys and since 1996 this mechanism is used in the Eurotransplant (current
members: Belgium, Germany, Luxembourg, the Netherlands, Austria, and Slovenia) region. The HLA
match plays a key role in X-COMB mechanism.
   31
      And recall the recent three-pair exchange at Johns Hopkins.



                                                45
             kidney from the Þrst pair went to the second pair; the second, to the third,
             and the Þrst pair received the kidney from the third.”
        (b) Moreover when one considers patient preferences and tries to obtain not only
            compatible but also good matches, it is no longer clear that exchanges between
            merely two pairs account for a majority of desired exchanges. In addition to
            the three-way exchange mentioned above, Lucan et al. [2003] also directed an
            exchange between four pairs, and one of the participating pairs were compatible
            but a poor match; they state
             “In the transplant session with four pairs: the Þrst pair had an O blood group
             donor with an A blood group recipient and a positive crossmatch. In the second
             pair, both donor-recipient had A blood group but six mismatches. The third
             pair had an A blood group donor with a B blood group recipient, and the
             forth pair a B blood group donor and O blood group recipient. The exchange
             of kidneys among these for pairs, was performed as follows: Þrst to second,
             second to third, third to forth, and fourth to Þrst.”32
             It is worthwhile to emphasize that the above mentioned exchange is not the
             only one that results in the assignment of a compatible kidney for each of the
             four patients. Donor two could have directly donated to its paired recipient and
             a three-way exchange is feasible among the remaining three pairs. Nevertheless
             the more elaborate exchange was preferred by the transplant team presumably
             to assure a superior match.33

   3. Under the TTCC mechanism, not only the patient who is willing to exchange his
      donor’s kidney with a priority in the cadaveric waiting list beneÞts, but other patients
      with paired donors also beneÞt from his presence; this is not the case under the
      present indirect exchange programs: Under the current indirect exchange programs
      the minimal w-chains are selected. Whenever a patient ti is willing to exchange his
      donor’s kidney ki for a priority at the waiting list, his donor’s kidney is oﬀered to
      the waiting list and only patient ti beneÞts from this arrangement among patients
      with living donors. However the presence of such a patient might also beneÞt other
      pairs as in the case of the TTCC mechanism. For example when patient ti agrees
      to exchange kidney ki for a priority at the waiting list, kidney ki may be oﬀered
      for another patient tj (instead of the waiting list) and the paired donor of patient

  32
      There is a minor mistake in the last sentence of this statement. Clearly what is intended is “Þrst to
forth, forth to third, third to second, and second to Þrst.”
   33
      Lucan et al. [2003] indicate that their experience with multiple pairs (three and four) kidney exchange
is unique in Europe.



                                                     46
  tj might in return oﬀer his kidney kj to the cadaveric pool. In this way two pairs
  beneÞt from the indirect exchange instead of one. In general several pairs, depending
  on the size of the eventually selected w-chain, may beneÞt from the presence of just
  one patient who is willing to accept a cadaveric kidney in exchange for his donor’s
  kidney. Therefore the TTCC mechanism is a more eﬃcient way of implementing
  indirect exchanges.

4. The adverse aﬀect of the present indirect exchange programs on blood-type O patients
   with no living donors will deÞnitely be reduced and probably reversed under the TTCC
   mechanism: While O blood-type donors are ABO-compatible with all patients, O
   blood-type patients are ABO-compatible with only O blood-type donors. That is,
   using the basic microeconomics jargon, while O blood-type kidneys are potentially
   demanded by all patients they are supplied by only O blood-type donors. This
   asymmetry on ABO-compatibility is behind the vulnerability of O blood type
   patients with no living donors under the current indirect exchange programs. Zenios,
   Woodle and Ross [2001] state
  “One of the major concerns is that ABO-incompatible indirect exchanges will tend
  to involve living donors with blood types A, B and AB but not O whereas a large
  proportion of their paired recipients will be of blood type O. If so, the waiting
  time for potential blood type O recipients on the cadaveric list who do not have
  a living donor may increase despite the increased number of kidneys transplanted.
  Since blood type O individuals already have the longest mean waiting time on the
  cadaveric list, such an exchange would not be justiÞable as it harms an already
  vulnerable population.”
  This vulnerability will be diminished and probably reversed under our proposed
  TTCC mechanism for a number of reasons:

   (a) More O blood-type patients with living donors will be matched with living
       donors and thus dropped from the cadaveric waiting list.
   (b) The current indirect exchange programs are designed for patients who are
       immunologically incompatible with their living donors, and based on the
       asymmetry on ABO-compatibility the recipient of a participating pair is much
       more likely to be blood-type O than the donor of the pair. The main idea
       underlying the TTCC mechanism is quite diﬀerent: Since it strives to increase
       the match quality based on the preferences, the extreme asymmetry dictating
       the choice of qualiÞed pairs is greatly reduced. That is because, pairs with O
       blood-type donors can still trade under the TTCC mechanism, even if they are
       compatible, in order to achieve a superior match.

                                        47
        (c) Under the present indirect exchange programs, whenever a patient with an
            incompatible donor participates, the priority list is adjusted. Hence the priority
            for one cadaveric kidney is modiÞed, in order to increase the total kidney
            supply by one. The TTCC mechanism, on the other hand, utilizes larger
            w-chains as well. For example if an eventually selected w-chain involves three
            donor-recipient pairs, then the priority for one cadaveric kidney is modiÞed,
            in order to increase the total kidney supply by three. Therefore the average
            number of kidneys gained per indirect exchange is higher under the TTCC
            mechanism than the present indirect exchange programs and hence the average
            number of modiÞcations in the cadaveric waiting list is smaller under TTCC
            for each gained kidney.
       (d) The ßexibility on chain selection can be used to increase the inßow of O
           blood-type living kidneys to the cadaveric kidney waiting list. For example
           if (k1 , t1 , k2 , t2 ) is an w-chain where kidney k1 is blood-type A and kidney k2 is
           blood-type O, the smaller chain (k2 , t2) may be selected and removed so that
           the living kidney oﬀered to the waiting list is of type O.34 This, however, will
           have an eﬃciency cost since it beneÞts fewer patients.

       Ross and Woodle [2000], inventors of the indirect exchange program, state
       “If mechanisms can be developed to avoid increasing the waiting time for
       blood group O recipients, we would support the implementation of the indirect
       ABO-incompatible exchange.”
       The TTCC mechanism is a likely solution for this challenging task.


A       Appendix: Proofs
Proof of Lemma 1 : Consider a graph where each patient points either towards a
kidney or w, and each kidney points to its paired recipient. Suppose there is no cycle.
Consider an arbitrary pair (ki , ti ). Start with kidney ki and follow the path in the graph.

  34
    In order to eliminate or reduce the adverse aﬀect of indirect exchange programs on patients with
no living donors, Zenios, Woodle and Ross [2001] propose preferential selection of O blood-type paired
donors for patients with multiple potential donors who wish to participate in indirect exchange programs.
Their proposal is consistent with a direct extension of the TTCC mechanism to the model with multiple
potential donors discussed in Section 8 when the ßexibility on chain selection is used to increase the
inßow of O blood-type kidneys to the cadaveric waiting list: Suppose at any stage of the algorithm
patient t points to w and he has two potential donors k (of blood-type O) and k0 (of blood-type A). Two
intersecting chains are (k, t), (k0 , t) and selecting the former based on the potential donor blood-type is
consistent with Zenios, Woodle and Ross [2001] proposal.



                                                    48
Since there are no cycles, no kidney or patient can be encountered twice. Hence by the
Þniteness of pairs, the path shall terminate at w. This is the w-chain initiated by pair
(ki , ti ) completing the proof.                                                      ♦
Proof of Lemma 2 : Consider a graph where each patient points towards a kidney
and each kidney points to a patient. Consider an arbitrary pair (k, t) such that kidney
k points to patient t. Start with kidney k and follow the path in the graph. Since each
node points to another, the path never terminates and since there are Þnite number of
kidneys, a kidney shall be encountered twice. Let kidney k 0 be any such kidney and let
t0 be the patient on the path who points to kidney k 0 . The path starting with kidney k 0
and ending with patient t0 is a cycle.                                                 ♦
Proof of Theorem 1 : Let TTCC mechanism be implemented with a chain selection
rule where any w-chain selected at a non-terminal round remains in the procedure and
the kidney at its tail remains available for the next round. Fix the time and consider
the algorithm. Any patient whose assignment is Þnalized in Round 1 has received his
top choice and cannot be made better oﬀ. Any patient whose assignment is Þnalized in
Round 2 has received his top choice among remaining choices and cannot be made better
oﬀ without hurting a patient whose assignment is Þnalized in Round 1. Proceeding in a
similar way, no patient can be made better oﬀ without hurting a patient whose assignment
is Þnalized in an earlier round. Therefore TTCC mechanism selects a Pareto eﬃcient
matching at any given time provided that w-chains are removed at the termination. ♦
    Before proving Theorem 2, we show that the three priority based chain selection rules
described in its statement are members of a wider class of chain selection rules. Under
this class each ordering of patient-donor pairs together with a Þxed pair deÞnes a chain
selection rule, and it is given as follows: Priority order donor-patient pairs in a single list.
Fix a pair (kj , tj ). Whenever an w-chain is to be selected,

   • select the w-chain starting with the highest priority pair (ki , ti ), and

   • remove the w-chain if the pair (ki , ti ) has strictly higher priority than the Þxed pair
     (kj , tj ) and keep it until termination otherwise.

   This class covers the following three smaller classes of chain selection rules:

   1. Priority order donor-patient pairs in a single list and let pair (kj , tj ) be the lowest
      priority pair. Then by deÞnition any selected w-chain is immediately removed unless
      it starts with the pair (kj , tj ). But only at the Þnal round the selected w-chain
      can possibly start with (kj , tj ), because it is the lowest priority pair, and hence in
      this case as well the selected w-chain is removed. Therefore this case corresponds

                                              49
      to priority based chain selection rules which immediately remove w-chains upon
      selection.

   2. Priority order donor-patient pairs in a single list and let pair (kj , tj ) be the highest
      priority pair. Then by deÞnition any selected w-chain remains until termination and
      hence it corresponds to priority based chain selection rules which keep the selected
      w-chains until termination.

   3. Finally if each pair with an O blood-type donor is given higher priority than each
      of the other pairs, and if (kj , tj ) is Þxed to be the highest priority pair among pairs
      which do not have an O blood-type donor , then

       (a) a selected w-chain is removed if it has an O blood-type donor, and
       (b) it is kept until termination otherwise.

   First, we prove the following lemma which will be useful for the proof of Theorem 2.

Lemma 3 Consider the TTCC mechanism implemented with a priority based chain
selection rule. Fix the stated preferences of all patients except patient ti at P−i . Suppose
that in the algorithm the assignment of patient ti is Þnalized at Round s under Pi and at
Round s0 under Pi0 . Suppose s ≤ s0 . Then the remaining active patients and unassigned
kidneys at the beginning of Round s are the same, whether patient ti announces Pi or Pi0 .

Proof of Lemma 3 : Patient ti fails to participate in a cycle or a selected w-chain prior
to Round s under either preferences. Therefore at any round prior to Round s

   1. not only the highest priority active patient is the same, whether patient ti announces
      Pi or Pi0 ,

   2. but also the same cycles/w-chains form, and in case there are no cycles, the same
      w-chain is selected, whether patient ti announces Pi or Pi0 .

   Hence the remaining active patients and unassigned kidneys at the beginning of Round
s are the same, whether patient ti announces Pi or Pi0 .                             ♦
   We are ready to prove Theorem 2.
Proof of Theorem 2 : We Þrst consider the chain selection rule that chooses the minimal
w-chains and removes them. Recall that for each patient ti , the relevant part of preference
Pi is the ranking up to ki or w, whichever is more preferred. Given the preference proÞle
(Pi )ni=1 , construct a new preference proÞle (Pi0 )ni=1 as follows: For each patient ti with
ki Pi w, let Pi0 = Pi . For each patient ti with wPi ki , construct Pi0 from Pi by swapping the

                                              50
ranking of ki and w. Note that ki Pi0 w for each patient ti and because the relevant part of
preferences are the more preferred of ki and w, h{(ki , ti )}ni=1, (Pi0 )ni=1 i, is a housing market.
Let µ denote the outcome of TTC mechanism for this housing market and construct
matching ν from matching µ as follows: If Pi0 6= Pi and µ(ti ) = ki then ν(ti ) = w,
otherwise ν(ti ) = µ(ti ). The key observation is that ν is the outcome of the TTCC
mechanism when it is implemented with the minimal w-chain selecting chain selection
rule. Therefore by Roth [1982], a patient can never receive a more preferred kidney by a
preference misrepresentation. He can receive the waitlist option w by a misrepresentation
but cannot proÞt from it. That is because, TTCC mechanism never assigns a patient,
a kidney that is inferior to w. Hence TTCC is strategy-proof with this choice of chain
selection rule.
    Next consider any of the priority based chain selection rules. Consider a patient ti
with true preferences Pi . Fix an announced preference proÞle P−i for all other patients.
We want to show that revealing his true preferences Pi is at least as good as announcing
any other preferences Pi0 under the TTCC mechanism. Let s and s0 be the rounds at
which patient ti leaves the algorithm under Pi and Pi0 respectively. We have two cases to
consider.
Case 1 : s < s0 .
    By Lemma 3, the same kidneys remain in the algorithm at the beginning of Round
s whether patient ti announces Pi or Pi0 . Moreover, patient ti is assigned his top choice
remaining at Round s under Pi . Therefore his assignment under Pi is at least as good as
his assignment under Pi0 .
Case 2 : s ≥ s0 .
    Upon announcing Pi0 , the assignment of patient ti is Þnalized either by joining a cycle,
or by joining a selected w-chain. We will consider the two cases separately.
Case 2a: The assignment of patient ti is Þnalized by joining a cycle under Pi0 .
    Let (k 1 , t1 , k 2, . . . , k r , ti ) be the cycle patient ti joins, and thus k 1 be the kidney he is
assigned under Pi0 . Next suppose he reveals his true preferences Pi . Consider Round s0 .
By Lemma 3, the same active patients and available kidneys remain at the beginning of
this round whether patient ti announces Pi0 or Pi . Therefore at Round s0 , kidney k 1 points
to patient t1 , patient t1 points to kidney k 2, . . ., kidney k r points to patient ti . Moreover,
they keep on doing so as long as patient ti remains. Since patient ti truthfully points to
his best remaining choice at each round, he either receives a kidney better than kidney k 1
or eventually points to kidney k 1 , completes the formation of cycle (k 1 , t1 , k 2, . . . , k r , ti ),
and gets assigned kidney k 1.
Case 2b: The assignment of patient ti is Þnalized by joining a selected w-chain under Pi0 .
   Let (k 1 , t1 , k 2, . . . , k r , ti = tr , k r+1 , . . . , k r+m , tr+m ) be the selected w-chain patient ti

                                                       51
joins, where r ≥ 1 and m ≥ 0, under Pi0 . Therefore, under Pi0 , patient ti is assigned
the kidney k r+1 if m ≥ 1 and the waitlist option w if m = 0. Also note that, given the
considered class of priority based chain selection rules, pair (k 1 , t1) is the highest priority
pair in Round s0 . Next suppose patient ti reveals his true preferences Pi . Consider Round
s0 . By Lemma 3, the same active patients and available kidneys remain at the beginning of
this round whether patient ti announces Pi0 or Pi . We will complete the proof by showing
that, upon announcing his truthful preferences Pi , the assignment of patient ti is Þnalized
in Round s0 and thus he is assigned his top choice available at the beginning of Round
s0 : Recall that for this case there is no cycle in Round s0 when patient ti announces Pi0 .
Therefore when he announces his true preferences Pi , either there is no cycle in Round s0
or there is one cycle which includes him. If it is the latter, then his assignment is Þnalized
in Round s0 and we are done. Otherwise, each pair initiates an w-chain by Lemma 1 and
one of these w-chains has to be selected. By the choice of a priority based chain selection
rule, this will be the w-chain that starts with the highest priority pair (k 1 , t1 ). But the
path starting with kidney k 1 passes through patient ti and therefore the selected w-chain
includes patient ti . Hence in this case as well his assignment is Þnalized in Round s0
completing the proof.                                                                         ♦
   The following lemma will be useful for the proof of Theorem 3.

Lemma 4 Fix the stated preferences of all patients except patient ti at P−i . Suppose that
in the algorithm patient ti is removed at Round s under Pi and at Round s0 under Pi0 .
Suppose s ≤ s0 . Then the remaining patients and kidneys at the beginning of Round s are
the same whether patient ti announces Pi or Pi0 .

Proof of Lemma 4 : Since patient ti fails to participate in a cycle prior to Round s in
either case, the same cycles form and therefore the same patients and kidneys are removed
before Round s.                                                                        ♦
Proof of Theorem 3 : We will Þrst show that TTC mechanism satisÞes individual
rationality, eﬃciency, and strategy-proofness , and conclude the proof by showing that
TTC is the only mechanism to satisfy each of these properties. Relabel the kidneys so
that patient ti prefers kidney ki1 to any other kidney attached to him.
Individual rationality : Consider any patient ti and relabel the kidneys so that kidney
ki1 is his most preferred kidney attached to him. As the algorithm proceeds, patient ti will
either be assigned a better kidney or eventually form the cycle (ki1 , ti ) and be assigned
kidney ki1.
Eﬃciency : Proof of eﬃciency is similar to the proof of Theorem 1. Fix the time and
consider the algorithm. Any patient whose assignment is Þnalized in Round 1 has received

                                               52
his top choice and cannot be made better oﬀ. Any patient whose assignment is Þnalized
in Round 2 has received his top choice among remaining choices and cannot be made
better oﬀ without hurting a patient whose assignment is Þnalized in Round 1. Proceeding
in a similar way, no patient can be made better oﬀ without hurting a patient whose
assignment is Þnalized in an earlier round. Therefore TTC mechanism selects a Pareto
eﬃcient matching at any given time.
Strategy-Proofness:35 Consider a patient ti with true preferences Pi . Fix an announced
preference proÞle P−i for all other patients. We want to show that revealing his true
preferences Pi is at least as good as announcing any other preferences Pi0 under TTC
mechanism. Let s0 be the round at which patient ti leaves the algorithm under Pi0 ,
(k 1 , t1 , k 2 , . . . , k r , ti ) be the cycle he joins, and thus k 1 be the kidney he is assigned. Let
s be the round at which he leaves under his true preferences Pi . We want show that his
assignment under Pi is at least as good as kidney k 1 . We have two cases to consider.
Case 1 : s ≥ s0 .
     Suppose patient ti announces her true preferences Pi . Consider Round s0 . By Lemma
4, the same patients and kidneys remain at the beginning of this round whether patient
ti announces Pi0 or Pi . Therefore at Round s0 , kidney k 1 points to patient t1 , patient t1
points to kidney k 2 , . . ., kidney k r points to patient ti . Moreover, they keep doing so as
long as patient ti remains. Since patient ti truthfully points to his best remaining choice
at each round, he either receives a kidney better than kidney k 1 or eventually points to
kidney k 1 , completes the formation of cycle (k 1 , t1 , k 2 , . . . , k r , ti ) and gets assigned kidney
k1 .
Case 2 : s < s0 .
    By Lemma 4, the same kidneys remain in the algorithm at the beginning of Round
s whether patient ti announces Pi0 or Pi . Moreover, patient ti is assigned his top choice
remaining at Round s under Pi . Therefore in this case as well his assignment is at least
as good as kidney k 1 .
Uniqueness: Fix the time, the set of patients {t1,..., tn } and the set of kidneys K. Let ϕ
be a mechanism that is individually rational, eﬃcient, and strategy-proof . By deÞnition,
mechanism ϕ selects a Pareto eﬃcient matching at each given time. We shall show that
ϕ(P ) = T T C(P ), for any preference proÞle P . Given any preference proÞle P , let ϕi (P )
denote the assignment of patient ti under mechanism ϕ for the preference proÞle P .
   Fix a preference proÞle P and let µ = T T C(P ). Consider the algorithm and let Ts
denote the set of patients whose assignments are Þnalized in Round s. For any patient

  35
    Proof of strategy-proofness is similar to proofs of analogous results in Roth [1982], Abdulkadiroùglu
and Sönmez [1999,2003].



                                                    53
         Pi
                        k               µ(ti )               k0    k 00      ki1   k 000
                                                                             ´
                                                                            ´
                                                                        ´
                                                                       ´
                                                                   ´
                                                                  ´
                                                              ´
                                                             ´
                                                         ´
                                                     ´
         Pi0                                       +́
                                                   ´

                        k               µ(ti )   ki1         k0    k 00            k 000


                            Figure 8: Construction of Preference Pi0 .

ti , relabel the kidneys so that kidney ki1 is his most preferred kidney attached to him.
By individual rationality, µ(ti )Ri ki1 for any patient ti . For any patient ti , construct a
(possibly) new preference relation Pi0 as follows:

   1. If µ(ti ) = ki1 then Pi0 = Pi ,

   2. otherwise µ(ti )Pi ki1 and construct Pi0 from Pi by simply inserting kidney ki1 right
      after kidney µ(ti ) and keeping the relative ranking of all other kidneys in Ki exactly
      the same (see Figure 8).

   Let P 0 = (Pi0 )ni=1 . We will show that ϕ(P ) = µ via two claims.
Claim 1: ϕ(P 0 ) = µ.
Proof of Claim 1 : We will show that ϕi (P 0 ) = µ(ti ) for any patient ti by induction on the
round patient ti leaves the algorithm under P .
    Consider the set of patients in T1 . Each patient ti ∈ T1 is assigned his top choice
under Pi by matching µ. Therefore by construction of Pi0 and individual rationality of ϕ,
either ϕ(P 0 ) = µ(ti ) or ϕ(P 0 ) = ki1 . Hence, under matching ϕ(P 0 ) each patient ti ∈ T1 is
assigned a kidney who is attached to a patient in T1 and since only one kidney attached
to each patient is eventually assigned to any patient, no patient outside T1 is assigned a
kidney that is attached to a patient in T1. Moreover, since µ(ti )Ri ki1 for any patient ti ,
Pareto eﬃciency of ϕ(P 0 ) implies ϕi (P 0 ) = µ(ti ) for any patient ti ∈ T1 .
    Next suppose that for any patient ti who has left the algorithm before Round s,
ϕi (P 0 ) = µ(ti ); we will show that ϕi (P 0 ) = µ(ti ) for any patient ti ∈ Ts as well. For
any Round u, let K u denote the the set of kidneys each of which is attached to a patient
who has left the algorithm at Round u under P . Recall that only one kidney attached

                                                 54
                               0
                         ϕi (P−i , Pi )
                  z           }|                  {
            Pi
                           k              ϕi (P 0 ) = µ(ti )           k0        k 00        ki1    k 000

                                                                                  0
                                                                            ϕi (P−i , Pi )
                                                  z                              }|                         {
            Pi0
                           k              ϕi (P 0 ) = µ(ti ) ki1       k0        k 00               k 000



                                      0
                         Figure 9: ϕ(P−i , Pi ) = µ(ti ) by strategy-proofness.

to each patient is eventually assigned to any patient; therefore ϕi (P 0 ) 6∈ ∪s−1   u
                                                                                u=1 K for any
patient ti ∈ Ts by the induction hypothesis. Moreover each patient ti ∈ Ts is assigned his
top choice in K \ ∪s−1     u                                                  0
                     u=1 K under ϕ(P ). Therefore by construction of Pi and individual
rationality of ϕ, either ϕi (P 0 ) = µ(ti ) or ϕi (P 0 ) = ki1. Hence only patients in Ts are
assigned kidneys that are attached to patients in Ts under ϕ(P 0 ) and therefore, since
ϕ(P 0 ) is Pareto eﬃcient, ϕi (P 0 ) = µ(ti ) for any patient ti ∈ Ts .
     By induction ϕ(P 0 ) = µ completing the proof of Claim 1. Note that we have also
shown that µ is the only matching that is Pareto eﬃcient and individually rational under
P 0.
Claim 2: ϕ(P ) = µ.
Proof of Claim 2 :36 We will show that

                                  0
                               ϕ(P−T , PT ) = µ                for all T ⊆ {t1,..., tn }

by induction on the cardinality of T .
                                                                                    0
   First show this for |T | = 1. Fix a patient ti. Consider the preference proÞle (P−i , Pi ).
By strategy-proofness

                        ϕi (P 0 )R0i ϕ(P−i
                                        0
                                           , Pi )        and               0
                                                                      ϕi (P−i , Pi )Ri ϕi (P 0 ),

                      0
and therefore ϕi (P−i    , Pi ) = ϕi (P 0 ) = µ(ti ) by Claim 1 together with the construction of
Pi0 . (See Figure 9.) But µ is the only matching that is Pareto eﬃcient and individually
                    0                            0
rational under (P−i     , Pi ) such that ϕi (P−i    , Pi ) = µ(ti ) (for otherwise µ cannot be the

  36
       Proof of Claim 2 is similar to the proof of Lemma 5.1 in Sönmez [1995].


                                                           55
unique Pareto eﬃcient and individually rational matching under P 0 ); therefore

                                       0
                                    ϕ(P−i , Pi ) = µ        for any ti ∈ T.

Next suppose

                      0
                   ϕ(P−T , PT ) = µ           for all T ⊂ {t1,..., tn } with |T | = ` < n.

                          0
We will show that ϕ(P−T     , PT ) = µ for all T ⊆ {t1,..., tn } with |T | = ` + 1 as well. Let
T ⊆ {t1,..., tn } be such that |T | = ` + 1. Let ti ∈ T . Consider the preference proÞle
  0
(P−T , PT ). By strategy-proofness we have

       0                         0      0                            0                0
  ϕi (P−(T \{ti }) , PT \{ti } )Ri ϕi (P−T , PT )    and        ϕi (P−T , PT )Ri ϕi (P−(T \{ti }) , PT \{ti } ),


                     0                0
and therefore ϕi (P−T   , PT ) = ϕi (P−(T \{ti }) , PT \{ti } ) = µ(ti ) by the induction hypothesis
(note that |T \ {ti }| = `) and the construction of Pi0 . Since ti ∈ T is arbitrary

                                     0
                                ϕi (P−T , PT ) = µ(ti )        for all ti ∈ T.

But µ is the only matching that is Pareto eﬃcient and individually rational under
  0
(P−T , PT ) such that this relation holds (for otherwise µ cannot be the unique Pareto
eﬃcient and individually rational matching under P 0 ); therefore

                      0
                   ϕ(P−T , PT ) = µ            for all T ⊆ {t1,..., tn } with |T | = ` + 1.

Hence ϕ(P ) = µ by induction completing the proofs of Claim 2, the uniqueness and
Theorem 3.                                                                      ♦


References
[1] M. Abecassis, M. Adams, P. Adams, R. M. Arnold, C. R. Atkins, M. L. Barr, W. M.
    Bennett, M. Bia, D. M. Briscoe, J. Burdick, R. J. Corry, J. Davis, F. L. Delmonico,
    R. S. Gaston, W. Harmon, C. L. Jacobs, J. Kahn, A. Leichtman, C. Miller, D. Moss,
    J. M. Newmann, L. S. Rosen, L. Siminoﬀ, A Spital, V. A. Starnes, C. Thomas, L. S.
    Tyler, L. Williams, F. H. Wright, and S. Youngner [2000] Consensus statement on the
    live organ donor. The Journal of the American Medical Association 284, 2919-2926.

[2] A. Abdulkadiroùglu and T. Sönmez [1998] Random Serial Dictatorship and the Core
    from Random Endowments in House Allocation Problems. Econometrica, 66, 3,


                                                       56
   689-701.

[3] A. Abdulkadiroùglu and T. Sönmez [1999] House allocation with existing tenants.
    Journal of Economic Theory 88, 233-260.

[4] A. Abdulkadiroùglu and T. Sönmez [2003] School choice: A mechanism design approach.
    American Economic Review 93, 729-747.

[5] G. S. Becker and J. J. Elias [2002] Introducing Incentives in the Market for Living
    Organ Donations. Working paper, University of Chicago.

[6] Y. Chen and T. Sönmez [2002] Improving eﬃciency of on-campus housing: an
    experimental study. American Economic Review 92, 1669-1689.

[7] M. Jackson and T. Palfrey [2001] Voluntary implementation, Journal of Economic
    Theory 98, 1-25.

[8] M. Lucan, P. Rotariu, D. Neculoiu, and G. Iacob [2003] Kidney exchange program:
    A viable alternative in countries with low rate of cadaver harvesting. Transplantation
    Proceedings 35, 933-934.

[9] J. Ma [1994] Strategy-proofness and strict core in a market with indivisibilities.
    International Journal of Game Theory 23, 75-83.

[10] A. K. Mandal, J. J. Snyder, D. T. Gilbertson, A. J. Collins, and J. R. Silkensen
    [2003] Does cadavaric donor renal transplantation ever provide better outcomes than
    live-donor renal transplantation? Transplantation 75, 494-500.

[11] P. Milgrom [forthcoming] Putting Auction Theory to Work, Cambridge University
    Press.

[12] E. W. Nelson, J. E. Childress, J. Perryman, V. Robards, A. Rowan, M. S. Seely,
    S. Sterioﬀ, M. R. Swanson, [1993] Financial incentives for organ donation: A report
    of the payment subcommittee, United Network for Organ Sharing Ethics Committee,
    http://www.unos.org/Resources/bioethics.asp?index=3

[13] E. Olson [2003] A Tale of 6 Kidneys, or She Gave Him Her Love, He Gave Her His
    Kidney. New York Times Saturday, August 2, A7.

[14] S. Papai [2000] Strategyproof assignment by hierarchical exchange. Econometrica 68,
    1403-1433.

[15] F. T. Rapaport [1986] The case for a living emotionally related international kidney
    donor exchange registry. Transplantation Proceedings 18, 5-9.

                                           57
[16] L. F. Ross, D. T. Rubin, M. Siegler, M. A. Josephson, J. R. Thistlethwaite, Jr., and
    E S. Woodle [1997] Ethics of a paired-kidney-exchange program. The New England
    Journal of Medicine 336, 1752-1755.

[17] L. F. Ross and E. S. Woodle [2000].Ethical issues in increasing living kidney donations
    by expanding kidney paired exchange programs. Transplantation 69, 1539-1543.

[18] A.E. Roth [1982] Incentive compatibility in a market with indivisibilities. Economics
    Letters 9, 127-132.

[19] A. E. Roth [2002] The Economist as Engineer: Game Theory, Experimentation, and
    Computation as Tools for Design Economics. Econometrica 70, 1341-1378.

[20] A. E. Roth and E. Peranson [1999] The Redesign of the Matching Market for
    American Physicians: Some Engineering Aspects of Economic Design. American
    Economic Review 89, 748-780.

[21] A.E. Roth and A. Postlewaite [1977] Weak versus strong domination in a market
    with indivisible goods. Journal of Mathematical Economics 4, 131-137.

[22] G. Opelz [1997] Impact of HLA compatibility on survival of kidney transplants from
    unrelated live donors. Transplantation 64, 1473-1475.

[23] G. Opelz, for the Collaborative Transplant Study [1998] HLA compatibility and
    kidney grafts from unrelated live donors. Transplantation Proceedings 30, 704-705.

[24] R. M. Sade [2003] Assessing Initiatives to Increase Organ Donations, Prepared
    Witness Testimony, The House Committee on Energy and Commerce, W.J.
    “Billy” Tauzin, Chairman, Subcommittee on Oversight and Investigations, June 3,
    http://energycommerce.house.gov/108/Hearings/06032003hearing946/Sade1500.htm

[25] D. P. Scanlon, C. S. Hollenbeak, W. Lee, E. Loh, P. A. Ubel [2003] Does Competition
    for Transplantable Hearts Encourage Gaming of the Waiting List? Presented at the
    8th Northeast Regional Health Economics Research Symposium, Boston University,
    http://world.std.com/˜mgtsci/conferences/downloads/NEHE Rsrch Symp 2002/
    Scanlon Hollenbeak Lee ppr.pdf

[26] L. Shapley and H. Scarf [1974] On cores and indivisibility. Journal of Mathematical
    Economics 1, 23-28.

[27] T. Sönmez [1995] Strategy-proofness and implementation in matching problems.
    Ph.D. Thesis, University of Rochester.


                                            58
[28] T. Sönmez [1999] Strategy-proofness          and   essentially   single-valued   cores.
    Econometrica 67, 677-689.

[29] L.-G. Svensson [1999], Strategy-proof allocation of indivisible goods. Social Choice
    and Welfare 16, 557-567.

[30] P. I. Terasaki, D. W. Gjertson, and J. M. Cecka [1998] Paired kidney exchange is not
    a solution to ABO incompatibility. Transplantation 65, 291.

[31] M. E. Votruba [2001] Eﬃciency-equity tradeoﬀs in the allocation of cadaveric kidneys.
    Working paper, Princeton University.

[32] S. Warmbir [2003] UIC hospital sued for Medicare fraud, Chicago Sun Times, July
    29, http://www.suntimes.com/output/news/cst-nws-hosps29.html

[33] T. Wujciak and G. Opelz [1993] Computer analysis of cadaver kidney allocation
    procedures. Transplantation 55, 516-521.

[34] T. Wujciak and G. Opelz [1997] Matchability as an important factor for kidney
    allocation according to the HLA match. Transplantation Proceedings 29, 1403-1405.

[35] S. Zenios [1996] Health care applications of optimal control theory. Ph.D. Thesis,
    Massachusetts Institute of Technology.

[36] S. Zenios, L. M. Wein, and G. M. Chertow [1999] Evidence-based organ allocation.
    The American Journal of Medicine107, 52-61.

[37] S. Zenios, E. S. Woodle, and L. F. Ross [2001] Primum non nocere: avoiding increased
    waiting times for individual racial and blood-type subsets of kidney wait list candidates
    in a living donor/cadaveric donor exchange program. Transplantation 66, 406-407.




                                             59
               Table 4: Number of Transplants and Quality of Match for n=30
                                             Own
                                   Total                         Waitlist
                                             Donor                            Rel. Risk    HLA
   Pref.           Mechanism       Trans.              Trade%    Upgrade
                                             Trans.                           of Failure   Mis.
                                   %                             %
                                             %
    All           No Exchange       54.83     54.83        0        0              1        4.79
                                    (8.96)    (8.96)     (0)       (0)          (0.04)     (0.25)
    All              Paired         68.50     54.83     13.67       0            1.00       4.78
                                    (9.90)    (8.96)    (9.40)     (0)          (0.03)     (0.24)
  Rational            TTC           82.47     23.03     59.43       0            0.95       4.16
                                   (10.14)    (9.44)   (13.57)     (0)          (0.03)     (0.22)
 Cautious             TTC           81.07     34.17     46.90       0            0.96       4.29
                                   (10.02)   (11.27)   (13.96)     (0)          (0.03)     (0.23)
Waitlist 10%
    All          Paired/Indirect   68.50      54.83     13.67      2.80          1.00       4.78
                                   (9.90)     (8.96)    (9.40)    (3.31)        (0.03)     (0.24)
  Rational          TTCC e         82.97      22.63     60.33      1.30          0.95       4.16
                                   (9.75)     (9.40)   (13.20)    (2.11)        (0.03)     (0.22)
  Rational          TTCC f         82.97      22.73     60.23      1.30          0.95       4.16
                                   (9.75)     (9.38)   (13.09)    (2.11)        (0.03)     (0.22)
 Cautious           TTCC e         81.63      33.73     47.90      1.53          0.96       4.28
                                   (9.60)    (11.33)   (13.52)    (2.29)        (0.03)     (0.22)
 Cautious           TTCC f         81.63      33.73     47.90      1.53          0.96       4.28
                                   (9.60)    (11.33)   (13.52)    (2.29)        (0.03)     (0.22)
Waitlist 20%
    All          Paired/Indirect   68.50      54.83     13.67      6.17          1.00       4.78
                                   (9.90)     (8.96)    (9.40)    (4.30)        (0.03)     (0.24)
  Rational          TTCC e         83.60      22.13     61.47      3.23          0.95       4.16
                                   (9.65)     (9.30)   (13.02)    (3.09)        (0.03)     (0.22)
  Rational          TTCC f         83.57      22.23     61.33      3.23          0.95       4.16
                                   (9.65)     (9.30)   (12.91)    (3.09)        (0.03)     (0.22)
 Cautious           TTCC e         82.43      33.40     49.03      3.10          0.96       4.29
                                   (9.28)    (11.15)   (13.06)    (3.42)        (0.03)     (0.23)
 Cautious           TTCC f         82.30      33.40     48.90      3.10          0.96       4.28
                                   (9.32)    (11.15)   (12.99)    (3.42)        (0.03)     (0.23)
Waitlist 40%
    All          Paired/Indirect   68.50      54.83     13.67     13.20          1.00       4.78
                                   (9.90)     (8.96)    (9.40)    (6.73)        (0.03)     (0.24)
  Rational          TTCC e         84.70      21.23     63.47      6.37          0.95       4.17
                                    (8.49      9.60)   (12.39)    (4.88)        (0.03)     (0.22)
  Rational          TTCC f         84.43      21.43     63.00      6.40          0.95       4.17
                                   (8.81)     (9.61)   (12.58)    (4.89)        (0.03)     (0.22)
 Cautious           TTCC e         83.57      32.93     50.63      6.13          0.96       4.29
                                   (8.53)    (10.98)   (12.54)    (4.39)        (0.03)     (0.22)
 Cautious           TTCC f         83.30      32.93     50.37      6.27          0.96       4.29
                                   (8.70)    (10.98)   (12.53)    (4.43)        (0.03)     (0.22)




                                             60
             Table 5: Number of Transplants and Quality of Match for n=100
                                           Own
                                 Total                        Waitlist
                                           Donor                             Rel. Risk    HLA
   Pref.         Mechanism       Trans.             Trade%    Upgrade
                                           Trans.                            of Failure   Mis.
                                 %                            %
                                           %
    All         No-Exchange      54.79      54.79       0         0             1.00       4.83
                                 (4.48)    (4.48)     (0)        (0)           (0.02)     (0.14)
    All            Paired        73.59      54.79    18.80        0             1.00       4.82
                                 (4.97)    (4.48)    (3.81)      (0)           (0.02)     (0.11)
  Rational          TTC          87.85      11.51    76.34        0             0.93       3.72
                                 (4.54)    (3.44)    (5.45)      (0)           (0.01)     (0.10)
 Cautious           TTC          87.23      24.01    63.22        0             0.93       3.86
                                 (4.73)    (4.48)    (5.46)      (0)           (0.01)     (0.11)
Waitlist 10%
    All        Paired/Indirect   73.59     54.79     18.80       2.31           1.00       4.82
                                 (4.97)    (4.48)    (3.81)     (1.38)         (0.02)     (0.11)
  Rational        TTCC e         88.47     11.04     77.43       1.05           0.93       3.72
                                 (4.23)    (3.30)    (4.77)     (0.99)         (0.01)     (0.10)
  Rational        TTCC f         88.42     11.04     77.38       1.05           0.93       3.72
                                 (4.21)    (3.30)    (4.73)     (0.99)         (0.01)     (0.10)
 Cautious         TTCC e         87.86     23.68     64.18       1.22           0.94       3.87
                                 (4.49)    (4.56)    (5.23)     (1.03)         (0.01)     (0.11)
 Cautious         TTCC f         87.83     23.69     64.14       1.22           0.94       3.87
                                 (4.49)    (4.56)    (5.23)     (1.03)         (0.01)     (0.11)
Waitlist 20%
    All        Paired/Indirect   73.59     54.79     18.80       4.94           1.00       4.82
                                 (4.97)    (4.48)    (3.81)     (2.22)         (0.02)     (0.11)
  Rational        TTCC e         88.81     10.69     78.12       2.05           0.93       3.72
                                 (4.05)    (3.22)    (4.50)     (1.30)         (0.01)     (0.10)
  Rational        TTCC f         88.72     10.70     78.02       2.06           0.93       3.71
                                 (4.02)    (3.21)    (4.43)     (1.32)         (0.01)     (0.10)
 Cautious         TTCC e         88.37     23.13     65.24       2.56           0.93       3.86
                                 (4.23)    (4.80)    (4.87)     (1.77)         (0.02)     (0.11)
 Cautious         TTCC f         88.31     23.14     65.17       2.57           0.93       3.86
                                 (4.23)    (4.80)    (4.87)     (1.77)         (0.02)     (0.11)
Waitlist 40%
    All        Paired/Indirect   73.59     54.79     18.80      10.24           1.00       4.82
                                 (4.97)    (4.48)    (3.81)     (3.07)         (0.02)     (0.11)
  Rational        TTCC e         89.44     10.29     79.15       3.96           0.93       3.71
                                 (3.85)    (3.26)    (4.40)     (1.97)         (0.01)     (0.10)
  Rational        TTCC f         89.28     10.29     78.99       4.07           0.93       3.71
                                 (3.88)    (3.23)    (4.42)     (2.04)         (0.01)     (0.10)
 Cautious         TTCC e         88.97     22.81     66.16       4.72           0.93       3.85
                                 (4.17)    (4.83)    (4.79)     (2.60)         (0.02)     (0.11)
 Cautious         TTCC f         88.87     22.83     66.04       4.75           0.93       3.85
                                 (4.18)    (4.84)    (4.83)     (2.62)         (0.02)     (0.11)




                                          61
             Table 6: Number of Transplants and Quality of Match for n=300
                                           Own
                                 Total                        Waitlist
                                           Donor                             Rel. Risk    HLA
   Pref.         Mechanism       Trans.             Trade%    Upgrade
                                           Trans.                            of Failure   Mis.
                                 %                            %
                                           %
    All         No-Exchange      53.92      53.92       0         0             1.00       4.81
                                 (2.82)    (2.82)     (0)        (0)           (0.01)     (0.08)
    All            Paired        75.03      53.92    21.11        0             1.00       4.81
                                 (2.72)    (2.82)    (2.51)      (0)           (0.01)     (0.07)
  Rational          TTC          91.05       5.72    85.32        0             0.91       3.29
                                 (3.35)    (1.28)    (3.61)      (0)           (0.01)     (0.06)
 Cautious           TTC          90.86      15.36    75.51        0             0.91       3.40
                                 (3.31)    (2.20)    (4.07)      (0)           (0.01)     (0.06)
Waitlist 10%
    All        Paired/Indirect   75.03     53.92     21.11       2.49           1.00       4.81
                                 (2.72)    (2.82)    (2.51)     (0.88)         (0.01)     (0.07)
  Rational        TTCC e         91.57      5.42     86.15       0.79           0.91       3.29
                                 (3.16)    (1.32)    (3.33)     (0.46)         (0.01)     (0.06)
  Rational        TTCC f         91.57      5.42     86.15       0.79           0.91       3.29
                                 (3.16)    (1.32)    (3.33)     (0.46)         (0.01)     (0.06)
 Cautious         TTCC e         91.43     15.07     76.36       0.84           0.92       3.40
                                 (3.12)    (2.13)    (3.78)     (0.65)         (0.01)     (0.06)
 Cautious         TTCC f         91.41     15.08     76.33       0.84           0.92       3.40
                                 (3.11)    (2.13)    (3.76)     (0.65)         (0.01)     (0.06)
Waitlist 20%
    All        Paired/Indirect   75.03     53.92     21.11       4.96           1.00       4.81
                                 (2.72)    (2.82)    (2.51)     (1.22)         (0.01)     (0.07)
  Rational        TTCC e         91.92      5.29     86.63       1.52           0.91       3.29
                                 (3.05)    (1.29)    (3.18)     (0.76)         (0.01)     (0.06)
  Rational        TTCC f         91.91      5.29     86.62       1.52           0.91       3.29
                                 (3.04)    (1.29)    (3.17)     (0.76)         (0.01)     (0.06)
 Cautious         TTCC e         91.76     14.84     76.92       1.62           0.91       3.40
                                 (2.98)    (2.12)    (3.51)     (0.93)         (0.01)     (0.06)
 Cautious         TTCC f         91.74     14.85     76.89       1.62           0.91       3.40
                                 (2.98)    (2.12)    (3.49)     (0.93)         (0.01)     (0.06)
Waitlist 40%
    All        Paired/Indirect   75.03     53.92     21.11       9.77           1.00       4.81
                                 (2.72)    (2.82)    (2.51)     (1.73)         (0.01)     (0.07)
  Rational        TTCC e         92.29      5.00     87.29       3.02           0.91       3.29
                                 (2.98)    (1.29)    (3.05)     (1.36)         (0.01)     (0.06)
  Rational        TTCC f         92.26      5.01     87.25       3.02           0.91       3.29
                                 (2.96)    (1.29)    (3.01)     (1.35)         (0.01)     (0.06)
 Cautious         TTCC e         92.17     14.42     77.75       3.19           0.91       3.39
                                 (2.93)    (2.10)    (3.26)     (1.40)         (0.01)     (0.06)
 Cautious         TTCC f         92.15     14.43     77.72       3.19           0.91       3.39
                                 (2.93)    (2.10)    (3.24)     (1.40)         (0.01)     (0.06)




                                          62
Table 7: ABO Composition of Net Waitlist Upgrades and Other Waitlist Patients as
Percentage of n=30. Net Waitlist Upgrades is the diﬀerence between the number of
upgraded patients of certain blood type and the number of live donor kidneys sent to the
waitlist of the same blood type.
                                         Net Waitlist Upgrades%          Other Waitlist Additions%
   Pref.          Mechanism        O       A       B     AB Total     O       A      B    AB Total
     All         No-Exchange       0       0       0      0     0    28.83 10.13 5.77 0.43 45.17
     All            Paired         0       0       0      0     0    24.50 4.07 2.80 0.13 31.50
  Rational           TTC           0       0       0      0     0    12.47 3.17 1.77 0.13 17.53
  Cautious           TTC           0       0       0      0     0    13.77 3.17 1.87 0.13 18.93
 Waitlist 10%
     All        Paired/Indirect   2.23   -1.60   -0.50   -0.13   0   22.17   3.83   2.57   0.13   28.70
  Rational         TTCC e         1.13   -0.50   -0.33   -0.30   0   11.33   2.73   1.53   0.13   15.73
  Rational         TTCC f         1.10   -0.47   -0.33   -0.30   0   11.33   2.73   1.53   0.13   15.73
  Cautious         TTCC e         1.07   -0.17   -0.43   -0.47   0   12.70   2.40   1.63   0.10   16.83
  Cautious         TTCC f         1.07   -0.17   -0.43   -0.47   0   12.70   2.40   1.63   0.10   16.83
 Waitlist 20%
     All        Paired/Indirect   4.60   -3.27   -0.83   -0.50   0   19.53   3.50   2.17   0.13   25.33
  Rational         TTCC e         2.50   -1.07   -0.53   -0.90   0   9.93    2.10   1.03   0.10   13.17
  Rational         TTCC f         2.43   -1.00   -0.53   -0.90   0   9.97    2.10   1.03   0.10   13.20
  Cautious         TTCC e         2.37   -1.00   -0.67   -0.70   0   11.30   1.87   1.23   0.07   14.47
  Cautious         TTCC f         2.27   -0.97   -0.60   -0.70   0   11.40   1.90   1.23   0.07   14.60
 Waitlist 40%
     All        Paired/Indirect   9.10   -6.33   -1.23   -1.53   0   14.67   2.20   1.37   0.07   18.30
  Rational         TTCC e         5.13   -2.47   -1.07   -1.60   0   7.13    1.17   0.63   0.00   8.93
  Rational         TTCC f         4.90   -2.27   -1.03   -1.60   0   7.33    1.17   0.67   0.00   9.17
  Cautious         TTCC e         4.90   -2.23   -1.23   -1.43   0   8.70    0.83   0.77   0.00   10.30
  Cautious         TTCC f         4.77   -2.13   -1.23   -1.40   0   8.80    0.87   0.77   0.00   10.43




                                                 63
Table 8: ABO Composition of Net Waitlist Upgrades and Other Waitlist Patients as
Percentage of n=100. Net Waitlist Upgrades is the diﬀerence between the number of
upgraded patients of certain blood type and the number of live donor kidneys sent to the
waitlist of the same blood type.
                                         Net Waitlist Upgrades%          Other Waitlist Additions%
   Pref.          Mechanism        O       A       B     AB Total     O       A      B    AB Total
     All         No-Exchange       0       0       0      0     0    27.64 11.18 5.86 0.53 45.21
     All            Paired         0       0       0      0     0    21.89 2.90 1.57 0.05 26.41
  Rational           TTC           0       0       0      0     0    9.30    1.90 0.91 0.04 12.15
  Cautious           TTC           0       0       0      0     0    9.78    2.00 0.95 0.04 12.77
 Waitlist 10%
     All        Paired/Indirect   2.02   -1.27   -0.45   -0.30   0   19.83   2.71   1.51   0.05   24.10
  Rational         TTCC e         0.90   -0.23   -0.22   -0.45   0   8.37    1.36   0.72   0.03   10.48
  Rational         TTCC f         0.86   -0.23   -0.21   -0.42   0   8.41    1.37   0.72   0.03   10.53
  Cautious         TTCC e         1.05   -0.21   -0.24   -0.60   0   8.72    1.39   0.80   0.01   10.92
  Cautious         TTCC f         1.03   -0.21   -0.24   -0.58   0   8.74    1.40   0.80   0.01   10.95
 Waitlist 20%
     All        Paired/Indirect   4.10   -2.51   -0.98   -0.61   0   17.70   2.33   1.39   0.05   21.47
  Rational         TTCC e         1.74   -0.47   -0.44   -0.83   0   7.53    1.01   0.58   0.02   9.14
  Rational         TTCC f         1.69   -0.47   -0.42   -0.80   0   7.58    1.04   0.58   0.02   9.22
  Cautious         TTCC e         2.24   -0.67   -0.58   -0.99   0   7.51    0.94   0.61   0.01   9.07
  Cautious         TTCC f         2.20   -0.65   -0.58   -0.97   0   7.55    0.95   0.61   0.01   9.12
 Waitlist 40%
     All        Paired/Indirect   8.25   -5.27   -1.70   -1.28   0   13.42   1.62   1.08   0.05   16.17
  Rational         TTCC e         3.49   -1.17   -1.07   -1.25   0   5.71    0.46   0.42   0.01   6.60
  Rational         TTCC f         3.45   -1.16   -1.05   -1.24   0   5.75    0.47   0.42   0.01   6.65
  Cautious         TTCC e         4.21   -1.56   -1.12   -1.53   0   5.50    0.41   0.40   0.00   6.31
  Cautious         TTCC f         4.14   -1.52   -1.11   -1.51   0   5.57    0.41   0.40   0.00   6.38




                                                 64
Table 9: ABO Composition of Net Waitlist Upgrades and Other Waitlist Patients as
Percentage of n=300. Net Waitlist Upgrades is the diﬀerence between the number of
upgraded patients of certain blood type and the number of live donor kidneys sent to the
waitlist of the same blood type.
                                         Net Waitlist Upgrades%          Other Waitlist Additions%
   Pref.          Mechanism        O       A       B     AB Total     O       A      B    AB Total
     All         No-Exchange       0       0       0      0     0    28.32 11.42 5.79 0.55 46.08
     All            Paired         0       0       0      0     0    21.70 2.19 1.06 0.02 24.97
  Rational           TTC           0       0       0      0     0    7.07    1.34 0.52 0.01       8.95
  Cautious           TTC           0       0       0      0     0    7.23    1.37 0.52 0.01       9.14
 Waitlist 10%
     All        Paired/Indirect   2.10   -1.37   -0.41   -0.32   0   19.59   1.93   0.94   0.02   22.48
  Rational         TTCC e         0.64    0.02   -0.16   -0.50   0   6.43    0.83   0.37   0.01   7.63
  Rational         TTCC f         0.64    0.02   -0.16   -0.50   0   6.43    0.83   0.37   0.01   7.63
  Cautious         TTCC e         0.72   -0.02   -0.21   -0.50   0   6.50    0.84   0.38   0.00   7.73
  Cautious         TTCC f         0.72   -0.02   -0.21   -0.49   0   6.51    0.85   0.38   0.00   7.75
 Waitlist 20%
     All        Paired/Indirect   4.24   -2.92   -0.73   -0.59   0   17.41   1.76   0.83   0.02   20.01
  Rational         TTCC e         1.34   -0.22   -0.31   -0.81   0   5.73    0.55   0.27   0.00   6.56
  Rational         TTCC f         1.33   -0.22   -0.30   -0.81   0   5.74    0.55   0.27   0.00   6.57
  Cautious         TTCC e         1.41   -0.22   -0.38   -0.82   0   5.81    0.52   0.29   0.00   6.62
  Cautious         TTCC f         1.41   -0.22   -0.38   -0.81   0   5.82    0.53   0.29   0.00   6.64
 Waitlist 40%
     All        Paired/Indirect   8.40   -5.65   -1.42   -1.32   0   13.21   1.36   0.63   0.01   15.21
  Rational         TTCC e         2.77   -0.87   -0.63   -1.27   0   4.28    0.23   0.18   0.00   4.69
  Rational         TTCC f         2.75   -0.87   -0.63   -1.26   0   4.30    0.24   0.18   0.00   4.72
  Cautious         TTCC e         2.94   -0.96   -0.63   -1.34   0   4.28    0.21   0.15   0.00   4.64
  Cautious         TTCC f         2.93   -0.96   -0.63   -1.34   0   4.29    0.22   0.15   0.00   4.66




                                                 65
Table 10: Properties of Cycles and W-chains for n=30. Cycles of 1 pair length with an
incompatible donor-patient pair are not counted.
                                  Cycle         Cycle Length      W-chain     W-chain Length
    Pref.         Mechanism
                                  No            (as pairs)        No          (as pairs)
                                           Mean Max. Longest                Mean   Max Longest
     All         No-Exchange      16.45      1        1      1       0       -       -     -
                                  (2.69)    (0)      (0)            (0)
     All            Paired        18.50     1.11    1.90     2       0        -        -      -
                                  (2.46)   (0.08) (0.30)            (0)
   Rational          TTC          14.65     2.95    5.65     9       0        -        -      -
                                  (2.22)   (0.43) (1.15)            (0)
  Cautious           TTC          16.79     2.59    5.42    10       0        -        -      -
                                  (2.71)   (0.41) (1.17)            (0)
 Waitlist 10%
     All        Paired/Indirect   18.50     1.11     1.90    2      0.84       1        1     1
                                  (2.46)   (0.08)   (0.30)         (0.99)     (0)      (0)
   Rational        TTCC e         14.35     2.96     5.65    9      0.39     2.05     2.16    6
                                  (2.21)   (0.43)   (1.15)         (0.63)   (1.35)   (1.37)
   Rational        TTCC f         14.37     2.96     5.65    9      0.39     2.02     2.13    6
                                  (2.21)   (0.43)   (1.15)         (0.63)   (1.29)   (1.31)
  Cautious         TTCC e         16.50     2.60     5.42    10     0.46     1.82     2.00    4
                                  (2.85)   (0.42)   (1.17)         (0.69)   (0.88)   (1.01)
  Cautious         TTCC f         16.50     2.60     5.42    10     0.46     1.82     2.00    4
                                  (2.85)   (0.42)   (1.17)         (0.69)   (0.88)   (1.01)
 Waitlist 20%
     All        Paired/Indirect   18.50     1.11     1.90    2      1.85       1        1     1
                                  (2.46)   (0.08)   (0.30)         (1.29)     (0)      (0)
   Rational        TTCC e         14.05     2.98     5.65    9      0.97     1.83     2.13    5
                                  (2.31)   (0.43)   (1.15)         (0.93)   (0.94)   (1.13)
   Rational        TTCC f         14.07     2.98     5.65    9      0.97     1.80     2.09    5
                                  (2.31)   (0.44)   (1.15)         (0.93)   (0.90)   (1.09)
  Cautious         TTCC e         16.25     2.61     5.42    10     0.93     1.89     2.19    6
                                  (2.82)   (0.42)   (1.17)         (1.03)   (0.90)   (1.12)
  Cautious         TTCC f         16.25     2.61     5.42    10     0.93     1.85     2.12    6
                                  (2.82)   (0.42)   (1.17)         (1.03)   (0.92)   (1.15)
 Waitlist 40%
     All        Paired/Indirect   18.50     1.11     1.90    2      3.96       1        1     1
                                  (2.46)   (0.08)   (0.30)         (2.02)     (0)      (0)
   Rational        TTCC e         13.37     3.04     5.65    9      1.91     1.86     2.55    7
                                  (2.50)   (0.47)   (1.15)         (1.46)   (0.83)   (1.35)
   Rational        TTCC f         13.47     3.04     5.65    9      1.92     1.78     2.40    5
                                  (2.48)   (0.47)   (1.15)         (1.47)   (0.76)   (1.17)
  Cautious         TTCC e         15.74     2.62     5.42    10     1.84     1.81     2.26    6
                                  (2.75)   (0.44)   (1.17)         (1.32)   (0.68)   (1.01)
  Cautious         TTCC f         15.76     2.62     5.42    10     1.88     1.75     2.17    6
                                  (2.72)   (0.44)   (1.17)         (1.33)   (0.67)   (0.97)




                                            66
Table 11: Properties of Cycles and W-chains for n=100. Cycles of 1 pair length with an
incompatible donor-patient pair are not counted.
                                  Cycle         Cycle Length      W-chain     W-chain Length
    Pref.         Mechanism
                                  No            (as pairs)        No          (as pairs)
                                           Mean Max. Longest                Mean Max. Longest
     All         No-Exchange      54.79      1        1      1       0       -       -     -
                                  (4.48)    (0)      (0)            (0)
     All            Paired        64.19     1.15     2.00    2       0        -        -      -
                                  (4.33)   (0.03) (0.00)            (0)
   Rational          TTC          36.53     4.22    10.14   15       0        -        -      -
                                  (3.44)   (0.41) (1.65)            (0)
  Cautious           TTC          45.53     3.51     9.82   17       0        -        -      -
                                  (4.29)   (0.33) (1.81)            (0)
 Waitlist 10%
     All        Paired/Indirect   64.19     1.15     2.00    2      2.31       1        1     1
                                  (4.33)   (0.03)   (0.00)         (1.38)     (0)      (0)
   Rational        TTCC e         35.20     4.28    10.14    15     1.05     3.02     3.54    14
                                  (3.85)   (0.41)   (1.65)         (0.99)   (1.51)   (2.15)
   Rational        TTCC f         35.21     4.28    10.14    15     1.05     2.95     3.47    14
                                  (3.84)   (0.41)   (1.65)         (0.99)   (1.56)   (2.20)
  Cautious         TTCC e         44.38     3.54     9.82    17     1.22     2.64     3.24    10
                                  (4.84)   (0.34)   (1.81)         (1.03)   (1.38)   (1.96)
  Cautious         TTCC f         44.39     3.54     9.82    17     1.22     2.64     3.26    10
                                  (4.84)   (0.35)   (1.81)         (1.03)   (1.38)   (1.96)
 Waitlist 20%
     All        Paired/Indirect   64.19     1.15     2.00    2      4.94       1        1     1
                                  (4.33)   (0.03)   (0.00)         (2.22)     (0)      (0)
   Rational        TTCC e         34.18     4.34    10.14    15     2.05     2.74     3.85    14
                                  (4.02)   (0.43)   (1.65)         (1.30)   (1.26)   (2.28)
   Rational        TTCC f         34.22     4.33    10.14    15     2.06     2.68     3.73    14
                                  (3.99)   (0.43)   (1.65)         (1.32)   (1.28)   (2.25)
  Cautious         TTCC e         43.07     3.58     9.82    17     2.56     2.71     3.71    10
                                  (5.31)   (0.37)   (1.81)         (1.77)   (1.34)   (1.84)
  Cautious         TTCC f         43.11     3.58     9.82    17     2.57     2.65     3.67    10
                                  (5.37)   (0.38)   (1.81)         (1.77)   (1.26)   (1.85)
 Waitlist 40%
     All        Paired/Indirect   64.19     1.15     2.00    2     10.24       1        1     1
                                  (4.33)   (0.03)   (0.00)         (3.07)     (0)      (0)
   Rational        TTCC e         32.91     4.41    10.14    15     3.96     2.40     3.96    11
                                  (4.16)   (0.43)   (1.65)         (1.97)   (0.93)   (1.97)
   Rational        TTCC f         32.92     4.41    10.14    15     4.07     2.29     3.78    10
                                  (4.09)   (0.44)   (1.65)         (2.04)   (0.82)   (1.79)
  Cautious         TTCC e         42.00     3.61     9.82    17     4.72     2.17     3.76    10
                                  (5.43)   (0.39)   (1.81)         (2.60)   (0.65)   (1.64)
  Cautious         TTCC f         42.07     3.61     9.82    17     4.75     2.14     3.71    10
                                  (5.47)   (0.39)   (1.81)         (2.62)   (0.64)   (1.61)




                                            67
Table 12: Properties of Cycles and W-chains for n=300. Cycles of 1 pair length with an
incompatible donor-patient pair are not counted.
                                  Cycle         Cycle Length      W-chain     W-chain Length
    Pref.         Mechanism
                                  No            (as pairs)        No          (as pairs)
                                           Mean Max. Longest                Mean Max. Longest
     All         No-Exchange      161.76     1        1      1       0       -       -     -
                                  (8.47)    (0)      (0)            (0)
     All            Paired        193.42    1.16     2.00    2       0        -        -      -
                                  (7.42)   (0.02) (0.00)            (0)
   Rational          TTC           79.54    5.98    16.84   26       0        -        -      -
                                  (4.91)   (0.43) (2.41)            (0)
  Cautious           TTC          102.14    4.89    16.00   22       0        -        -      -
                                  (7.00)   (0.33) (2.00)            (0)
 Waitlist 10%
     All        Paired/Indirect   193.42    1.16     2.00    2      7.48       1        1     1
                                  (7.42)   (0.02)   (0.00)         (2.63)     (0)      (0)
   Rational        TTCC e          76.11    6.10    16.84    26     2.38     4.26     6.01    16
                                  (5.52)   (0.44)   (2.41)         (1.38)   (2.27)   (3.06)
   Rational        TTCC f          76.11    6.10    16.84    26     2.38     4.26     6.01    16
                                  (5.52)   (0.44)   (2.41)         (1.38)   (2.27)   (3.06)
  Cautious         TTCC e          99.02    4.94    16.00    22     2.53     3.82     5.69    16
                                  (6.92)   (0.32)   (2.00)         (1.95)   (1.98)   (2.95)
  Cautious         TTCC f          99.07    4.94    16.00    22     2.53     3.78     5.58    16
                                  (6.86)   (0.32)   (2.00)         (1.95)   (1.98)   (2.89)
 Waitlist 20%
     All        Paired/Indirect   193.42    1.16     2.00    2     14.88       1        1     1
                                  (7.42)   (0.02)   (0.00)         (3.66)     (0)      (0)
   Rational        TTCC e          74.42    6.15    16.84    26     4.56     3.46     6.32    16
                                  (5.38)   (0.44)   (2.41)         (2.27)   (1.25)   (2.89)
   Rational        TTCC f          74.44    6.15    16.84    26     4.57     3.44     6.27    16
                                  (5.37)   (0.44)   (2.41)         (2.27)   (1.24)   (2.91)
  Cautious         TTCC e          97.00    4.98    16.00    22     4.85     3.28     6.07    13
                                  (7.23)   (0.33)   (2.00)         (2.79)   (1.31)   (2.64)
  Cautious         TTCC f          97.04    4.98    16.00    22     4.86     3.26     6.01    13
                                  (7.17)   (0.33)   (2.00)         (2.80)   (1.32)   (2.63)
 Waitlist 40%
     All        Paired/Indirect   193.42    1.16     2.00    2     29.30       1        1     1
                                  (7.42)   (0.02)   (0.00)         (5.18)     (0)      (0)
   Rational        TTCC e          71.17    6.30    16.84    26     9.05     2.88     6.47    15
                                  (5.88)   (0.46)   (2.41)         (4.07)   (0.78)   (2.40)
   Rational        TTCC f          71.21    6.30    16.84    26     9.06     2.86     6.46    15
                                  (5.85)   (0.46)   (2.41)         (4.06)   (0.79)   (2.50)
  Cautious         TTCC e          93.76    5.05    16.00    22     9.57     2.65     5.99    12
                                  (7.51)   (0.33)   (2.00)         (4.20)   (0.72)   (2.23)
  Cautious         TTCC f          93.81    5.05    16.00    22     9.58     2.64     5.96    12
                                  (7.48)   (0.33)   (2.00)         (4.20)   (0.73)   (2.23)




                                            68
