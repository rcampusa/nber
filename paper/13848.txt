                                NBER WORKING PAPER SERIES




    ARBITRAGE-FREE LIMIT ORDER BOOKS AND THE PRICING OF ORDER FLOW
                                 RISK

                                           Bruce Lehmann

                                        Working Paper 13848
                                http://www.nber.org/papers/w13848


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     March 2008




This research is part of the NBER's program on Asset Pricing and was supported in part by a Morgan
Stanley Equity Microstructure Research Grant for which I am quite grateful. The views expressed
herein are solely my own and not those of any other person or entity including Morgan Stanley and
the National Bureau of Economic Research. I am grateful to Joel Hasbrouck and, especially, to Shmuel
Baruch for helpful comments. I have also benefited from the comments of participants at the conferences
in Honor of David K. Whitcomb at Rutgers University, on the Econometrics of the Microstructure
of Financial Markets at Tilburg University, on the Analysis of High-Frequency Financial Data and
Market Microstructure at Academia Sinica, and on the Workshop on Microstucture of Financial Markets
at the Bolsa Madrid, and at the Morgan Stanley Equity Market Microstructure Research Conference.
I am also indebted to seminar participants at Northwestern University, the Securities and Exchange
Commission, and the University of Utah. All errors that remain are my own responsibility. The views
expressed herein are those of the author(s) and do not necessarily reflect the views of the National
Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2008 by Bruce Lehmann. All rights reserved. Short sections of text, not to exceed two paragraphs,
may be quoted without explicit permission provided that full credit, including © notice, is given to
the source.
Arbitrage-free Limit Order Books and the Pricing of Order Flow Risk
Bruce Lehmann
NBER Working Paper No. 13848
March 2008
JEL No. G1,G12,G13

                                             ABSTRACT

This paper builds on the landmark contribution of Glosten (1994) by treating the determination of
limit order supply schedules as an exercise in asset pricing theory with the possible sizes of incoming
market orders as the value-relevant states of nature, yielding an analogue of the Fundamental Theorem
of Asset Pricing. State prices and price impact prove to be proportional to the slope of the book and
simple nonparametric and semiparametric models for limit order book dynamics arise when the price
of order flow risk is constant over time, providing a comprehensive and coherent framework for organizing
limit order book data.


Bruce Lehmann
University of California, San Diego
IR/PS
1415 Robinson Building Complex
La Jolla, CA 92093-0519
and NBER
blehmann@ucsd.edu
1. Introduction

       In a landmark paper, Glosten (1994) showed that bid and offer prices in limit order books

prior to the arrival of a market order are lower and upper expectations, respectively, conditional

on trade size because limit order traders confront the winner’s curse. His reasoning is deceptively

simple. The marginal share of an order that walks up (down) the book is worth more (less) to that

market order trader than the inferior offers (bids) behind it (Glosten’s Assumption 1). The

marginal valuations of uninformed traders imply nothing about asset values per se, making for

no relation between their trades and asset values. However, if asset values are increasing in the

marginal valuations of traders with value relevant private information (Glosten’s Assumption 2),

asset values are increasing in the sizes of their market orders. If there is adverse selection risk in

all market orders (Glosten’s Assumption 3), uninformed competitive risk neutral limit order

traders will post bids and offers at prices below and above, respectively, their estimates of asset

values as a function of trade size. The upper and lower tail expectation formulas then obtain.

       Glosten is careful not to simply assume that asset values are increasing in order size so as

not to make assumptions about the endogenous choices of traders confronting an endogenous

limit order supply schedule. Yet it is clearly a plausible assumption if there is adverse selection

risk in all market orders or, put differently, there would appear to be relatively little distance

between Glosten’s Assumptions 1 and 2 and this hypothesis in some sense.1 Even so, this view

would represent, at most, a minor semantic distinction or a matter of taste were it not for the fact

that there is a substantial analytical benefit to be derived from making a primitive assumption of

the hypothesis that asset values are an increasing function of market order size.

       The benefit is that the economics of liquidity supply in limit order markets becomes an

asset pricing exercise. Market orders subject limit order traders to order flow risk – the value
                                                 2

implications of market orders that blow through their bids and offers – making the possible sizes

of incoming market orders the relevant states of nature with asset values potentially differing

state by state. Since the exchange of given share quantities at given prices is triggered by the

market order state that eventuates, limit orders can be viewed as contingent claims written on

order flow – in particular as digital option portfolios – as was argued in Lehmann (2006).2

Hence, the entire apparatus of arbitrage-free contingent claims pricing can be brought to bear on

the problem of determining limit order supply schedules and their properties.

         The basic assumptions associated with the no-arbitrage approach to valuation must be

adopted to invoke these tools. The definition of arbitrage itself is problematic because limit

orders cannot be sold short but this problem can be finessed by replacing infeasible arbitrage

with feasible limit order substitution. The required absence of frictions is more challenging: no

impediments to free trade in limit orders involves the freedom to cancel and replace them before

the next market order arrives until all limit traders are satisfied with their positions or, put

simply, there are no stale limit orders. The final requirement is a deterministic mapping between

asset payoffs and states of nature, the link between market order flow states and asset values.

         The assumption that limit order traders can freely cancel and replace all orders prior to

the arrival of the next market order is not an inconsequential one: stale limit orders pervade

theories of limit order market dynamics. Traders arrive sequentially in such models and face

different trading constraints and market conditions: see, for example, Foucault, Kadan, and

Kandel (2005), Goettler, Parlour, and Rajan (2004, 2005, 2006a,b), Hollifield, Miller, and

Sandås (1999, 2004), Hollifield, Miller, Sandås, and Slive (2002, 2006), Large (2006), Parlour

(1998), Parlour and Seppi (2003), Rosu (2004), and Wei (2006). All but one – Goettler, Parlour,




1   See Rock (1990) and note 12 of Back and Baruch (2006) but see also note 6 of Glosten (1994).
                                                  3

and Rajan (2004) – assume that no trader possesses value relevant private information. All but

one – Hollifield, Miller, and Sandås (2004) – restrict trade sizes to unity. All but one – Rosu

(2004) – assume either infinite or nontrivial cancellation costs (and the equilibrium in his model

is such that no cancellations take place).3 In all of these models, limit orders become stale and

confront a nontrivial risk of being picked off for reasons not related to asymmetric information.

       As Glosten noted, the assumption of a market order state/asset value mapping is awkward

due to its endogeneity, involving the strategies of market order traders and the constraints placed

on them by the economic environment. The characterization of such strategies and the resulting

marginal asset valuations implicit in market order states is the heavy lifting in microstructure

models. This situation is akin to using pure endowment economies to approximate general

equilibria with production: they can only approximate production economies that produce that

sequence of endowments, which might require implausible constraints on production. By the

same token, the constraints on market order placement implicit in a given schedule linking asset

values and order flow states might rule out economically relevant trading rules. That said, the

relations assumed below are essentially arbitrary upward sloping ones, although restrictions are

placed on their evolution over time in the analysis in Section 3.

       In my view, the benefits associated with making this assumption far outweigh the costs

because of the economic insights garnered by so doing. The first such reward is an easy analogue

of the Fundamental Theorem of Asset Pricing, which delivers state prices for order flow states

that define the price of order flow risk.4 State prices and price impact prove to be proportional to


2 Treating bids and offers as options originated with Copeland and Galai (1983). They reasoned
that the best bids and offers are like call and put options, respectively, with strike prices equal to
the associated quotes, an analogy quite different from that in Lehmann (2006).
3 Foucault (1999) is a model of a limit order book with price dynamics but each trader can only

submit one market order or one limit order that will be cancelled at the end of the period.
4 See Lehmann (2006) for an informal analysis that shows when the prices in a market for betting

on market order sizes are the appropriate state prices implicit in a limit order book.
                                                  4

the slope of the book for economically intelligible reasons. Market completion via limit orders is

like market completion with options in asset pricing theory as is the fact that any upward sloping

limit order schedule can always be rationalized as an arbitrage-free limit order book.

       When the price of order flow risk is constant, limit order book dynamics have a simple

structure. If all information arrives via order flow, state prices along with the asset value/order

flow state and limit order schedules do not change over time but rather are recentered around

cumulative net order flow after a trade. Alternatively, if there are zero (conditional risk neutral)

mean shifts in the mapping between asset values and order flow states, limit order books and

their slopes change unpredictably (in a risk neutral sense) for economically plausible reasons,

save for a mechanical adjustment for the replenishment of the book. Moreover, the books in

these settings prove to be somewhat bluff-proof in the sense of Black (1990) and can have

nonlinear price impact functions, in contrast to the linearity of price impact in the arbitrage-free

batch auction markets studied by Huberman and Stanzl (2004).5

       The result is a comprehensive and coherent framework for organizing limit order book

data. Price impact is such that the midquote after a trade is roughly equal to the asset value in

that order flow state when all information arrives via order flow, permitting recovery of the asset

value/order flow state relation without functional form assumptions. In contrast, both published

analyses of the Glosten model, Sandås (2001) and de Jong et al. (1996), assume that this relation

is linear and that the distribution of market order sizes is exponential. If, instead, this schedule

shifts unpredictably in the risk neutral measure, the price of order flow risk follows an otherwise

unconstrained (save for smoothness assumptions) semiparametric regression model when certain

risk neutral expectations can be replaced by ones in the empirical measure. In either setting, the

theoretical structure of arbitrage-free limit order books closely parallels its empirical counterpart.
                                                   5

        The remainder of the paper is organized as follows. The next section proves an analogue

of the Fundamental Theorem of Asset Pricing for limit order markets and discusses a number of

its implications.    The two subsequent sections are devoted to theoretical and empirical

implications, respectively, of the hypotheses that all information does or does not arrive via order

flow when the price of order flow risk is constant. The last section provides a brief conclusion.

        2. The Nature of Arbitrage-Free Limit Order Books

        The hypothesis that a market is arbitrage-free has proven to be a powerful source of

restrictions on asset prices. There are five elements associated with the no-arbitrage approach to

valuation: (1) the mapping between asset payoffs and underlying states of nature, (2) agreement

on the possible, (3) the absence of frictions, (4) the definition of arbitrage, and (5) the resulting

set of state prices compatible with asset prices and payoffs. In its usual formulation, the absence

of both frictions and zero net investment portfolios that have no risk of loss and a positive

probability of a positive payoff insures the existence of strictly positive state prices, not

necessarily unique, that correctly value all assets in a given market.

        This formulation of the no-arbitrage framework cannot be translated directly to the limit

order market setting for obvious reasons. The concept of arbitrage must be amended to deal with

the inability to sell limit buy and sell orders short and, hence, to potentially earn arbitrage profits.

Market frictions that may be unimportant on the time scales of asset pricing tend are much more

important on microstructure time scales. The states of nature in question are asset values in

different order flow states, which are hardly observable quantities.

        Fortunately, these difficulties prove to be far from insuperable. This section is devoted to

the explication of a theory of arbitrage in limit order markets predicated on order substitution by



5Price impact is linear in Glosten (1994) only in special cases, although curvature need not be
pronounced. Nonlinear price impact also arises in the model studied by Rosu (2004).
                                                  6

limit order traders. The analysis yields analogues of the main implications of the absence of

arbitrage in asset pricing theory: the existence of strictly positive state prices on which valuation

can be based, which occupies the next subsection, and the incentive to create contingent claims

that complete markets, which may be found in the second subsection.

       A. The Pricing of Order Flow Risk in Arbitrage-Free Limit Order Books

       A key ingredient of the analysis is the presumption that some market participants – the

ones who determine the marginal behavior of the book – are active, perfectly competitive limit

order traders. In order for their actual and potential trades to be marginal ones, their ability to

earn arbitrage profits must not be affected by taxes, transactions costs, indivisibilities, and

related market frictions.    Taxes need not be a major issue if potential pre-tax arbitrage

opportunities also represent after-tax arbitrages. For professional traders, transactions costs are

largely a fixed cost of market participation amortized over many trades in many securities.

Finally, indivisibilities are not important if a round lot represents a “small” trade, which is the

case in liquid markets almost by definition. These frictions can probably be safely ignored.6

       The related problems of short sales constraints and the nature of arbitrage opportunities

are more nettlesome. Limit orders cannot be sold short, leaving no natural analogues of zero net

investment portfolios or arbitrage profits. However, the payoff of a zero net investment portfolio

always has a second interpretation: the payoff from a marginal change in an existing portfolio

that is long all of the assets under consideration. The analogue in a limit order market involves

the substitution possibilities available to traders: the ability to cancel and replace limit orders on

the supply side and the possibility of breaking up market orders on the demand side. How these

prospects affect the pricing of order flow risk depends, in turn, on the precise details of how and



6In addition, the riskless rate is set to zero since it is a second order concern over (most)
microstructure time scales. Alternatively, the numeraire can be taken to be a savings account.
                                                  7

when market participants can access the limit order book. That is, the set of allowable trading

strategies is a crucial element of the analysis of arbitrage-free limit order books.

       The mapping between order flow states and the value of the asset is the other problematic

aspect of the analysis of arbitrage-free limit order books. In the usual setting, one can always

distinguish states of nature by payoff patterns, with two states being different if the payoff on at

least one asset differs across the two states. There might be thorny analytical issues arising from

the treatment of endogenous quantities like future prices as states of the world but asset payoffs

are observables and can be treated as defining the relevant states of nature for many purposes

despite their endogeneity. In contradistinction, the value of an asset in a given order flow state is

not observable, making the identification of asset values with order flow states problematic.

       Nevertheless, the first assumption is that traders perceive a link between the size of an

incoming market order and the value of the asset in question, the reasonableness of which will be

discussed in different information environments in the next section. In particular:

       Assumption 1: Let Vt (q) denote the asset value if a market order of size q arrives at

time t. Vt (q) is strictly increasing in q and is common knowledge among market participants.

This combination of Assumption 2 and Lemma 2 of Glosten (1994) is stronger than necessary:

most of the results obtain if Vt (q) is non-decreasing in q and if Vt (q )   Vt (q) for some q    q.

There is no presumption that these values are objective or rational ones, although their evolution

must follow Bayes’ rule or else arbitrage opportunities will crop up.           Finally, it is worth

emphasizing that such mappings pervade market microstructure theory: no expectation of future

asset values given current market conditions can be computed without them.

       Now consider a limit order market for a single asset in which market orders of size Qt

are executed against standing limit orders. Market order sizes are random variables taking
                                                            8


values in some set  t                   \ 0 , a countable set if there is a minimum lot size, where Q t is

positive for market buy and limit sell orders and negative for market sell and limit buy orders.

The book has no minimum tick and has a marginal price schedule Pt (q) t                       where q is the

cumulative volume up to that quantity. Due to the absence of a minimum tick and the presence

of adverse selection at all tiers of the book, there will be an order for at most one lot at any price

in a minimum lot size market and no “atoms” – that is, there are orders for only infinitesimal

quantities – if there is no minimum lot size. The absence of a minimum tick also obviates the

need for secondary priority rules, about which a bit more will be said at the end of this subsection.

                                                                                Qt
             Hence, the overall cost of a market order for Q t shares is             Pt (q)dq . That is, it walks
                                                                                0


up or down the book unless it exhausts the depth in the book, which is a summation in a

minimum lot size market. Put differently, dq is Lebesgue notation, making it equal to 1 (–1) for

market buy (sell) orders in a minimum lot size market. Limit orders are placed before time t and

so Pt (q)       Ft   1   where Ft   1   is public information available before time t. More formally, Pt (q)

and Q t are defined on a common probability space (Ω, F, P) with Pt (q),Q t                       1   Ft   1   where

 F1 , F2 ,     , Ft 1 , Ft is a sequence of –fields belonging to F such that Ft        1   Ft .

             The analysis requires a second assumption, one that is almost, but not quite, an

implication of Assumption 1: Pt (q) Vt (q) for q > 0 and Pt (q) Vt (q) for q < 0. Such a

condition is unnecessary if limit order traders are unwilling to lose money on limit orders but

nothing in Assumption 1 prevents a liquidity trader from choosing to incur such a loss. Such

private sources of value in limit orders are assumed away in:

             Assumption 2: sgnq [Pt (q) Vt (q)] 0 q t , where sgn x is the sign of its argument.
                                                    9

The structure of the inequality serves to accommodate buy and sell orders in one expression.7

       Sufficiently free trade in this limit order market arises when limit order traders have

preferential access to the book. In particular, suppose they can “lock” the market, preventing the

arrival of market orders while they cancel and replace their limit orders. In other words:

       Assumption 3: A market order can only arrive and be executed against the book after all

limit order traders are satisfied with their order placements.

This possibility arises, for example, if market orders arrive according to a continuous time jump

process, giving limit order traders time to refresh the book.8 The ability of traders to swap limit

orders is a de facto substitute for the absence of de jure arbitrage trading in this setting.

       There is one trade size that is not in  t that merits special mention: Q t     0 . It is natural

to interpret this “null trade” as the arrival of non-trade-related information.9 In the present

setting, information arrival restarts the tatônnement-like process during which limit order traders

can freely cancel and submit orders, making it possible for their orders to dynamically complete

the market for order flow contingent claims. This issue will occupy the next subsection.

       Now consider swapping an order at tier q of the book for one at the next tier – that is, at

q sgnq dq , again to accommodate both purchases and sales in one expression. Vt (q) is strictly

increasing at q and price priority insures that the book is upward sloping, which, taken together,

imply that Pt (q sgnq dq) Pt (q) and Pt (q sgnq dq) Vt (q) have the same sign and so:

        Pt (q sgnq dq) Pt (q)       t   (q)[Pt (q sgnq dq) Vt (q)]   q t                           (1)


7 I am grateful to Shmuel Baruch for insisting on the need for some such assumption. It can be
dispensed with if other limit order traders can submit marketable limit orders to exploit any
overpriced buy orders or underpriced sell orders (i.e., those for which sgnq [Pt (q) Vt (q)] 0 ).
8 Back and Baruch (2004) take this approach in their comparison of limit order books with their

continuous time version of the Glosten-Milgrom model. Most purely statistical limit order book
models assume that market order arrivals follow a continuous time jump process.
9 See Lehmann (2006) for a detailed analysis of the role of null trades in this setting.
                                                                                              10


with          t   (q) 0 . Rearranging this expression bounds                                               t   (q) from above since:

                  Pt (q)          t   (q)Vt (q) [1              t   (q)]Pt (q sgn q dq)                                                               (2)

implies that:

                  Pt (q) Vt (q) [ t (q) 1]Vt (q) [1                                       t   (q)]Pt (q sgn q dq)
                                                                                                                                                      (3)
                                           [1        t   (q)][Pt (q sgn q dq) Vt (q)]

and, with it,                t   (q) 1 since both differences have the same sign.

                  By the same token, suppose that limit order prices satisfy the linear pricing rule (2) with

0         t   (q) 1 . Then (3) and                        t   (q) 1 imply that the limit order book is upward sloping and that

Pt (q) Vt (q) and Pt (q sgnq dq) Vt (q) have the same sign.                                                                   Similarly, (1) coupled with

    t   (q) 0 imply that Pt (q sgnq dq) Pt (q) and Pt (q sgnq dq) Vt (q) also have the same sign

and thus Pt (q) Vt (q) for q > 0 while Pt (q) Vt (q) for q < 0. That is, there are no arbitrage

opportunities if and only if limit order prices satisfy the linear pricing rule (2).

                  The constants { t (q) : 1                          t   (q) 0, t (q)                  Ft 1 ,q  t } are, in turn, supported by risk

neutral probabilities                      t   (q)       Pr Qt             q Ft   1           for each possible market order size conditional

only on Ft–1, which are state prices due to the riskless rate normalization. There are two possible

states at tier q of the book: the market order is for exactly q shares or for more than q shares.

Hence, these constants are conditional probabilities that are given by:

                                                                                                                   (q)
                   t   (q)       Pr Q t        q sgn q Q t                | q |, Ft   1
                                                                                                               t
                                                                                                                                                      (4)
                                                                                                                    t (u)du
                                                                                                   sgn q u |q|



which are termed hazard functions in survival analysis.

                  Iterating (2) forward using (4) reveals that arbitrage-free marginal price schedules satisfy:
                                                                  11



                           t   (q)                                      t   (q)
        Pt (q)                              Vt (q)     1                                    Pt (q sgn q dq)
                                t   (u)du                                     t   (u)du
                 sgn q u |q|                                 sgn q u |q|
                                                                                                                               (5)
                                t (u)Vt (u)du           
                                                      E[V1                    | Ft 1 ]
                 sgn q u |q|                              sgn q Q t     |q|
                                                                                                | sgn Q | q |, F ]
                                                                                            E [V      q t        t 1
                                      t (u)du
                                                       E[1sgnq Qt     |q|   | Ft 1 ]
                      sgn q u |q|



as in Glosten (1994) with risk neutral probabilities                               t   (q) replacing the actual ones in his paper

           is the random value of the asset on some future date. That is, offers are upper tail
and where V

                 |Q
expectations E [V                                                                        |Q
                                    q 0, Ft 1 ] and bids are lower tail expectations E [V                          q 0, Ft 1 ] .10
                     t                                                                       t



       Accordingly, arbitrage-free limit order books satisfy the following proposition.

       Proposition 1: If Assumptions 1 – 3 hold, there is a positive pricing rule supported by a

set of unique state prices            t   (q) 0      q  t if and only if there are no arbitrage opportunities.11

       Implicit in this theorem is a striking observation, one with an exact parallel in the usual

analysis of arbitrage-free markets: any upward sloping marginal price schedule can always be

rationalized as being arbitrage-free in the sense of Proposition 1.12 Ross (1976) showed that

arbitrage-free asset prices can always be rationalized as the outcome of utility maximization by a



10 As Glosten emphasizes, the form of (5) reflects the discriminatory nature of the book. In
                       | Q q, F ] is the schedule in a nondiscriminatory book. Most markets
contrast, Pt (q) = E [V    t      t 1

open with a single price auction in which market orders are aggregated into a single net order
and executed against the book at the same price. The next auction price can be treated as the
“liquidating” asset value V embedded in the expectations Vt (q) E [V       | Q q, F ] .
                                                                                t     t 1
11 Uniqueness follows from the self-referential definition of states; see recursions (8) – (10)

below. See the next subsection for economic reasons to expect dynamic spanning to obtain.
12 Both are versions of the Sonnenschein, Debreu, Mantel Theorem (see Greene, Mas-Collell,

and Whinston (1995)), the notion that the hypothesis that an economy is in competitive
equilibrium is vacuous in a particular sense: any set of downward sloping aggregate excess
demand curves is consistent with utility maximization by a consumer whose utility function
satisfies the weak axiom of revealed preference. Ross noted that the version for arbitrage-free
markets need only hold at the point of zero excess demand, not over entire excess demand
schedules, where state prices per unit probability equal indirect marginal utilities of wealth.
Fictitious state dependent preferences can always be fabricated to produce any such numbers.
                                                                         12

hypothetical investor with rational expectations and state dependent preferences. As long as the

book is upward sloping, the analysis leading from (1) to (5) makes it clear that any marginal

price schedule can be produced by a suitably fabricated asset value/order flow state relation. Just

as a positive asset pricing theory is really a theory of the functional form of investor preferences

in this sense, so is a positive theory of limit order prices a theory of the functional form of the

Vt (q) mapping. There is no need to leave this framework unless one finds any implications for

this mapping or the values of the associated state prices to be economically implausible.

       The idea that limit orders are order flow derivatives explains why Proposition 1 is a close

cousin of the Fundamental Theorem of Asset Pricing. Lehmann (2006) noted that a limit buy

(sell) order for Xt shares involves receipt (expenditure) of PtXt dollars in exchange for (delivery

of) Xt shares. In the language of exotic options markets, the first payoff is that of Xt cash-or-

nothing digital calls struck at Pt and the second is that on Xt asset-or-nothing digital calls struck

at Pt as well. Since a transaction only occurs at price Pt (q) when a market order is large enough

(i.e., when sgnq Qt | q | ), one can view these implicit derivatives as digital options on order flow.

       Moreover, the values of these implicit cash-or-nothing and asset-or-nothing digital call

options must be equal since limit order transactions are voluntary. The value of the cash-or-

nothing digital option that pays a dollar when sgnq Qt | q | is:

        E [1sgnq Qt   |q|   Pt (q) | Ft 1 ] Pt (q)                   t   (u)du                     (6)
                                                     sgnq u |q|



while that of the asset-or-nothing digital option for one share that pays off in the same states is:

        E [            1Qt u Vt (u)du | Ft 1 ]                           t   (u)Vt (u)du           (7)
              sgnq u |q|                                sgnq u |q|



Equating the values of these implicit options yields (5).

       Now the replicating portfolio for a digital call (put) is a bull (bear) spread in conventional
                                                                 13

calls (puts) with an infinitesimal spread between the strike prices. The replicating portfolio for a

spread in digital calls (puts) is a spread in bull (bear) spreads in conventional calls (puts), that is,

a butterfly spread. Breeden and Litzenberger (1978) showed that the payoff on a butterfly is

proportional to that of a pure Arrow-Debreu claim that pays off only when the asset price on

expiration equals the intermediate strike price. By this reasoning, the slope of the book is a

spread in the digital options implicit in limit orders and, hence, its payoff is proportional to the

relevant state price or risk neutral probability. Treating limit orders as portfolios of order flow

derivatives delivers new insights into the role of the slope of the limit order book.

        More precisely, rearranging (4) and (5) reveals that the risk neutral probabilities                     t   (q)

can be recovered via the recursion:

                    Pt (q sgn q dq) Pt (q)
          t   (q)                                                t   (u)du
                        Pt (q) Vt (q)             sgn q u |q|


                    Pt (q sgn q dq) Pt (q)
                                                 {1q   0    t   (q) 1q 0 [1          t   (q)]}                      (8)
                        Pt (q) Vt (q)
                         Pt (q)
                                  {1q   0   t   (q) 1q 0 [1              t   (q)]}
                    Pt (q) Vt (q)

in the no-minimum lot size limit where                           t   (q) is the cumulative risk neutral distribution

function evaluated at q.13 It will be convenient in what follows to abuse notation slightly and let

Pt (q) also denote the first difference Pt (q sgnq dq) Pt (q) when there is a minimum lot size

since (8) then covers both limit buy and sell orders in both discrete and continuous order size

markets. Note also that state prices can be recovered from risk neutral hazard functions via:




13 The first line of (8) on the offer side of the book is identical to the expression for state prices
in Banz and Miller (1978) for conventional options with the option price set to zero, the
underlying asset value set to Vt(q), and the strike price set to Pt(q). This makes sense since the
limit order is a portfolio of two options that requires no initial investment. Note that the last line
of (8) can be obtained by differentiating (5) and applying Leibniz’s rule.
                                                                                                         14

                                                  q sgn q
            t   (q)                t   (q)        u sgn q
                                                            [1           t   (u)]{1q     0       t   ( dq) 1q 0 [1                           t   ( dq)]}
                                                                 q
                                                                                                                                                                                 (9)
                  t   (q)                t   (q)exp                      t   (u)du {1q           0        t   (0) 1q 0 [1                    t   (0)]}
                                                                 0



in the no minimum lot size limit, this last being familiar from survival analysis as well, where the

risk neutral expected price must equal the corresponding expected asset value, implying that:

        0              t   (u)[Pt (u) Vt (u)]du                                  {1q         0       t   ( dq) 1q 0 [1                           t   ( dq)]} t (u)[Pt (u) Vt (u)]du

                                                                                     t   (u)[Pt (u) Vt (u)]du                                                                         (10)
                                                                               u 0
                      t ( dq)
                                                      t   (u)[Pt (u) Vt (u)]du                                            t   (u)[Pt (u) Vt (u)]du
                                               u 0                                                              u 0


                                              q sgn q                                                                 q
where   t   (q)            t   (q)            u sgn q
                                                          [1         t   (u)]            t   (q)exp                           t   (u)du .14
                                                                                                                  0



        The slope of the book at the marginal trade of a market order plays a crucial role in its

price impact. The value of the asset immediately after the arrival of a market order of size Qt–1 is

given by Vt 1 (Q t 1 ) while the asset value immediately before the arrival of the next one is:

        Pt (0)                 | F ] E [V
                           E [V           | F ] E [V
                                                     | Q , F ] E [V
                                                                    |Q , F ]
                                   t 1        t 1        t 1 t 2       t 1 t 2

                                             | F ] E [V
                           Vt 1 (Q t 1 ) E [V           |Q , F ]                                                                                                               (11)
                                                 t 1       t 1 t 2

                           Vt 1 (Q t 1 ) υt (0); E [υt (0) | Q t 1 , Ft 2 ] 0

since υt (0) is a risk neutral martingale increment by the law of iterated expectations and Pt (0) is

the midquote if the small trade spread is small and a risk-neutral-probability-weighted average of

the best bid and offer in general (see 3A below). The slope of the book is given by:

        Pt (q)                 t   (q)[Pt (q sgnq dq) Vt (q)]                                                                                                                   (12)

after manipulation of (8) which, coupled with (11), yields the risk neutral regression relation:

                                                                                 Pt 1 (Qt 1 )
        Pt (0)             Pt 1 (Q t          1      sgn Qt 1 dq)                                              υt (0)                                                           (13)
                                                                                  t 1 (Q t 1 )



in which the inverse of the risk neutral hazard function                                                                          t 1   (Q t 1 ) is the slope coefficient.
                                                  15

          In the parlance of Huberman and Stanzl’s (2004) analysis of batch auction markets, (13)

combines a price update and impact function, equations (2) in their paper. They are generally

distinct in their setting because orders are submitted before the demands of other traders and,

hence, market clearing prices are known. The price impact function is Pt(q) in a limit order

market, a known function of the size of the next market order. More will be said about the links

between equations (11) and (13) and their batch auction relatives in Section 3D below.

          Finally, a comment is in order regarding the impact of secondary priority rules on (5)

when there is a binding minimum tick. In one sense, the answer is “not much”: the Appendix

shows that the form of the pricing relation is unchanged. Limit order substitution insures that

depth at each tier is governed by the priority rule: the marginal order earns no rents under strict

priority rules while the marginal order insures that no order earns rents under symmetric rules.15

          The problem is that the implicitness of depth determination makes for no clear relation

between the fraction of depth exhausted in the marginal tier and state prices or price impact as

codified in (8) through (13). One cannot answer the most basic question about the book: how

would it be refreshed if no information arrived except for that implicit in a given trade? The

answer to such questions is central to the analysis of price dynamics in the next section and so

minimum price variation will be assumed away in what follows. One fig leaf for such an

assumption is the fact that tick sizes have become quite small in most but not all markets.16

          B. Spanning and Completeness in Arbitrage-Free Limit Order Books

          One natural question is whether this market should be thought of as one in which all

possible order flow states are spanned. Put differently, might limit order traders leave “holes” in

arbitrage-free limit order books? Clearly, limit order traders might be unwilling to incur the



14   See part i of Proposition 3 of Glosten (1994).
15   The reasoning in the Appendix applies in both the discrete and continuous order size cases.
                                                  16

adverse selection risk in very large orders – one reason why block trading markets are not

completely anonymous – but such considerations merely make  t bounded. Should we expect

traders to post limit orders at all possible market order sizes within any such bounds?

        Limit order books cannot have holes given unfettered limit order substitution.17 To be

precise, a hole between q″ and q′ with Vt(q″) < Vt(q′) when a marginal price function jumps from

Pt(q″) to Pt(q′) when there are feasible trade sizes q with q″ < q < q′ at which no orders are

posted. The trader with the last order in the queue at Pt(q″) in front of the hole has every reason

to cancel it and replace it with one at any price between Pt(q″) and Pt(q′) as long as the execution

probability is unchanged.18 If there were no further changes in the book, the revised order

dominates the original one due to its unambiguously higher price and identical execution

probability, making this trader better off if the order executes and no worse off if it doesn’t. If

one trader wants to swap positions in this fashion, all will want to do so until they are satisfied at

the margin with their positions between tiers q″ and q′ of the book. This tatônnement-like

process would continue until the hole in the book was filled in. Once again, the ability to cancel

and replace limit orders is a perfect substitute for explicit arbitrage.

        A related question is whether Pt(q) will be continuous between q″ and q′ if orders can be

broken up arbitrarily finely. Clearly, continuity cannot obtain if Vt(q) is discontinuous so

assume it is continuous between q″ and q′. If there was a jump at q between Pt(q″) and Pt(q′), the

trader with the order at Pt(q) could cancel and repost at a slightly higher price, which would once

again yield a higher payoff with the same execution probability if the book was opened up right

after the new order was submitted. Since the book is closed during the tatônnement-like


16 A counterexample is the Tokyo Stock Exchange with a minimum tick as high as 1%.
17 See Rosu (2004) for an analysis in a related setting in which traders arrive sequentially and
choose both the hole and the price point in which to place a single limit order for a single share.
18 This argument requires the existence of only one such price and quantity.
                                                  17

adjustment process, the book would be filled in until Pt(q) was continuous between q″ and q′.

       More formally, limit order markets are complete in the following sense.

       Proposition 2: Under the assumptions of Proposition 1, the limit order book spans  t if

there are no arbitrage opportunities. Moreover, the marginal price schedule is continuous in q at

any q ≠ 0 if Vt(q) is continuous and if there are no indivisibilities in market order sizes.

       This implication is clearly counterfactual: actual limit order books typically have holes

and spreads are often wider than the minimum tick. It is hard to decide whether the assumption

of a tatônnement-like process that ensures rapid replenishment of the book or of the existence of

the Vt(q) schedule is the most likely culprit. It is equally hard to assess a priori what manner of

deviations from the theory would be sufficiently significant economically so as to affect limit

order valuation. This issue will be addressed to some extent in the penultimate section.

       All of these results illustrate both the strengths and weaknesses of the present approach.

The great strength is the simple arithmetic of natural cancel-and-replace strategies along the

slope of the book. The great weakness is the stringent requirement that no market order can

arrive while traders adjust their limit order portfolios, an assumption that flies in the face of the

common concern that limit orders require costly monitoring. This assumption would appear to

be particularly implausible with respect to spanning in a market with no (or with a small)

minimum tick since we do observe holes in real world limit order books. Fortunately, these

market access assumptions, at least, prove to be far more reasonable than it would at first appear.

       3. Limit Order Book Dynamics

       The analysis in the previous section established that arbitrage-free limit order books are a

lot like arbitrage-free markets in general. That is, there is a positive linear pricing operator

underlying the marginal price schedule that is supported by strictly positive state prices.

Moreover, the economic incentive to complete markets with options in conventional markets
                                                    18

provides the same motive for posting orders that span possible market order states. All of this is

reasonably straightforward once one equates states of nature in limit order markets with the

possible sizes of incoming market orders and arbitrage with unfettered limit order substitution.

        This section is devoted to a search for additional restrictions on the evolution of limit

order books over time. To be sure, the analysis in the last section involved dynamics due to the

conditioning of risk neutral probabilities on the generic public information set Ft and in light of

the updating relations (13). More can be had, however, by imposing natural assumptions that

yield market settings that are perhaps best described as ones in which the price of order flow risk

provides market order traders with a clear disincentive to engage the practice of order splitting.19

        The four subsections that follow are devoted to some of the economics of such market

environments and some of their implications. The next two subsections describe two such

settings: one in which both order-flow-dependent asset values and state prices depend only on

cumulative signed order flow and another in which only state prices have this property. The

penultimate subsection discusses whether bluffing – what Black (1990) termed intentional noise

trading – will be undertaken by rational risk-averse uninformed traders in these settings. The

last subsection briefly compares and contrasts the arbitrage-free limit order markets studied here

with Huberman and Stanzl’s (2004) analysis of arbitrage-free batch auction markets.

        A. Limit Order Book Sequences When All Information Is Trade-related

        Consider a continuous order size market and suppose a market order to buy Qt–1 shares

arrives at time t–1. If the order does not exhaust the depth on the buy side, it will walk up the

marginal price schedule until it reaches Pt 1 (Q t 1 ) . The post-trade asset value will be Vt 1 (Q t 1 ) .

        What will the new marginal price schedule Pt (q) be if no additional information arrives?


19 Alternatively, all price impact is permanent in these settings. Obizhaeva and Wang (2006)
study order splitting with mean-reverting books and (mostly) linear price impact functions.
                                                               19


The largest unexecuted offer – the one at Pt 1 (Q t 1 ) – will be the new best ask Pt (0 )                 lim P (q)
                                                                                                           q 0   t



while the original best bid Pt 1 (0 )                 lim P (q) will be Q         shares from the new best bid since
                                                      q 0 t 1            t   1



it would take a market order that size to reach it. In fact, this reasoning applies to all of the

unexecuted orders in the time t–1 book and so:

          Pt (q) Pt 1 (q Qt 1 )1q         BF(Qt 1 )                                                               (14)

for q BF(Q t 1 ) where BF(Q t 1 ) (0,Q t 1 ] is the portion of the book that is backfilled.20

          This is so because order flow state prices and values are essentially unchanged when no

additional information hits the market save for the arrival and execution of this market order.

The word essentially reflects the fact that the new state prices and values for q BF(Q t 1 ) are:

          Vt (q)      Vt 1 (q Q t 1 )
                                                                                                                  (15)
            t   (q)    t 1   (q Q t 1 )

or, in other words, they are translated by the size of the market order Qt–1. The reason why is

straightforward: from the perspective of limit order traders, the risk that a market order for Qt–1

shares at time t–1 will be followed by one for q lots at time t is identical to the risk that a market

order of size q + Qt–1 will arrive at time t–1 under this restriction on market information flows.

          The only remaining question is how limit order traders will backfill the portion of the

book that was cleared out by the market order, the new bid prices at which they will be willing to

buy up to Qt–1 shares,. The order flow risk confronting these orders has changed: the original

risk came from a market buy order but the new risk is that a market sell order will arrive. A

straightforward calculation in the Appendix shows that these new best bids are given by:




20   Glosten (1994) observed that such orders need not be cancelled after a market order execution.
                                                                     20


                     t 1   (0)Pt 1 (0 ) [1               t 1   (0)]Pt 1 (0 ) [1            t 1   (q Q t 1 )]Pt 1 (q Q t 1 )
        Pt (q)
                                                                    t 1 (q  Qt 1 )
                                                                                                                                         (16)
                   Pt 1 (0) [1            t 1 (q  Q t 1 )]Pt 1 (q Qt 1 )
                                                                         q                  BF(Q t 1 )
                                           t 1 (q Qt 1 )

where Pt–1 (0) will be close to the midquote if the small trade spread is small.21

       As is readily apparent, the backfilled best bids are weighted averages of the prior best

bids and offers along with the prior offer at q + Qt–1 shares.                                         This makes perfect sense:
                                      −
appropriately scaled, Pt–1 (0 ) inserts the portion of the lower tail expectation below −Qt–1 into
                                  +
these new best bids, Pt–1 (0 ) puts the entire upper tail expectation into them, and subtraction of

[1    t 1   (q Q t 1 )]Pt 1 (q Q t 1 ) completes the conversion of prior best offers into new best bids.

That is, the new best bids equal the unconditional expected asset value before the next market

order arrives less the right amount of the appropriate prior best offer.

       Taken together, (14) and (16) paint a simple picture of the impact of this trade in these

circumstances. Combining them and adding and subtracting Pt 1 (q Qt 1 )1q                                       BF(Qt 1 )    yields:

        Pt (q)     Pt 1 (q Q t 1 )1q      BF(Q t 1 )     Pt 1 (q Q t 1 )1q   BF(Q t 1 )

                   Pt 1 (0) [1            t 1  (q Q t 1 )]Pt 1 (q Q t 1 )
                                                                          1q         BF(Q t 1 )      Pt 1 (q Q t 1 )1q      BF(Q t 1 )   (17)
                                          t   1 (q Qt 1 )
                                          Pt 1 (0) Pt 1 (q Q t 1 )
                   Pt 1 (q Q t 1 )                                 1q         BF(Q t 1 )
                                                  t 1 (q Qt 1 )

and the obvious symmetry implies that Pt (q) is given by:

                                                            Pt 1 (0) Pt 1 (q Qt 1 )
        Pt (q)     Pt 1 (q Qt 1 )                                                                  1q               BF(Qt 1 )            (18)
                                                t   1 (q Qt 1 )1Qt 1 0 [1    t 1 (q Qt 1 )]1Qt 1 0

after either a market buy or sell order. That is, the new marginal price equals the translated old

one plus a simple backfilling adjustment for the part of the book cleared out by the market order.
                                                                      21

       While the basic structure is the same, the minimum lot size case is a bit messier because a

discontinuity at zero arises when order flow states go from –1 lot to 1 lot. A tedious calculation

in the Appendix shows that the variant of (18) that applies to both purchases and sales in both the

absence and presence of a minimum lot size is given by:

        Pt (q)     Pt 1 (q Q t      1   1q     BF(Q t 1 )   sgn Qt 1 dq)
                       Pt 1 (0) Pt 1 (q Q t                 1   sgn Qt 1 dq)                                                          (19)
                                                                                   1q   BF(Q t 1 )   (q,Q t 1 )1q   BF(Q t 1 )
                   1Qt 1   0   sgn Qt 1        t 1   (q Q t     1   sgn Qt 1 dq)

where BF(Qt 1 ) [sgnQt 1 ,Qt 1 ] in the discrete case. The first two terms are identical to (18) if

there is no minimum lot size while the discontinuity at zero requires both incrementing the

indices in the second term by sgnQt 1 dq and the endpoint adjustment in the last term in the

minimum lot size case. Note also that the corresponding state prices and values are given by:

        Vt (q)     Vt 1 (q Q t      1     1q   BF(Q t 1 )   sgn Qt 1 dq)
                                                                                                                                      (20)
         t   (q)     t 1   (q Q t   1     1q   BF(Q t 1 )   sgn Qt 1 dq)

which incorporates the required adjustment in the backfilling region in the discrete lot size case.

       There is a stronger conclusion to be drawn here. The market order for Q t                                            1    lots could

just as easily have been net order flow from some earlier time to time t–1 with the proviso that

information in this market arrived only via market orders with (20) governing the evolution of

state prices and valuations.                   These considerations suggest the following definition of an

information regime, an epoch within which information arrives only via order flow:

       Definition 1: An information regime or epoch is a period during which it is common

knowledge that asset values and state prices in different order flow states satisfy:




21As Glosten (1994) emphasized, the small trade spread will be positive because prices are tail
expectations. That is, Pt (0 ) Vt (0 ) and Pt (0 ) Vt (0 ) implies that Pt (0 ) Pt (0 ) .
                                                                                22


              Vt 1 (q q )                  |Q
                                       E [V                                     |Q
                                                               q q , Ft 2 ] E [V                       q ,Q t                q, Ft 2 ] Vt (q | Q t             q)
                                               t         1                          t                            1                                        1
                                                                                                                                                                    (21)
                  t 1   (q q )         E [1Qt 1        q q   | Ft 2 ] E [1Qt     q   | Qt   1       q, Ft 2 ]            t   (q | Q t    1      q)

where Ft 2 = Qt 2 ,,Q2 ,Q1 , F0 and {q,q ,q q }  t                                            1       t .22

The pairwise restrictions (21) imply that trade-related valuations, state prices, and risk neutral

hazard functions across a sequence of market orders within an information regime must satisfy:

              Vt (q)        Vt 1 (q Q t            1    1q   BF(Q t 1 )   sgn Qt 1 dq)  V1 (q Q1t                   1
                                                                                                                              1q   BF(Q1t 1 )
                                                                                                                                                sgn Qt 1 dq)
                                                                                                                                                     1
                                                                                                                                                                (22)
                  t (q)      t    1 (q Qt          1    1q   BF(Q t 1 ) sgn Q t 1 dq)               1 (q Q     t 1
                                                                                                                1             1q   BF(Q t 1 ) sgn Qt 1 dq)
                                                                                                                                                     1



                            t 1
where Q1t          1
                            s 1
                                  Qs      Ft   1       is cumulative signed volume since time 1 with Q1t 1 t and the

backfilling adjustment is only required in the discrete lot size case.23 This constraint on Bayes’

formula for updating asset values between trades within an information regime makes valuations

path independent and dependent only on cumulative signed order flow.

              How should arbitrage-free limit order books evolve when it is common (and correct)

knowledge that the market is in an information epoch? The answer is that relations (22) connect

the sequence of books between times 0 and t while (19) adds the required backfilling adjustment,

so that a sequence of arbitrage-free limit order books within an information regime satisfies:

              Proposition 3: Under the assumptions of Proposition 1, the marginal price schedule

Pt (q) is related to its time one counterpart by:




22   If  t   1          t , Pt 1 (q Q t 1 ) is simply a construct, not an actual price schedule for any q  t
for which q Q t              1      t 1 . Fear of adverse selection might make t bounded for each t,
permitting the uninformed to partially separate themselves by trading patiently and thus forcing
informed traders to partially reveal their information by trading over time. See note 36.
23 Definition 1 guarantees Q t
                              1  1 t via  t 1  t . It can be dispensed with if the book spans
 t for each t, the analogue of dynamically complete markets in this setting.
                                                                    23


        Pt (q)   P1 (q Q1t    1
                                  1q    BF(Q1t 1 )
                                                     sgn Qt 1 dq)
                                                          1

                                               t 1
                         P1 (0) P1 (q Q        1        sgn Qt 1 dq)                                                       (23)
                                                       t 1
                                                              1
                                                                             1q   BF(Q1t 1 )
                                                                                               (q,Q1t 1 )1q   BF(Q1t 1 )
                 1Qt 1   0
                             sgn Qt 1     1   (q Q     1      sgn Qt 1 dq)
                   1              1                                  1




when the market is in an information regime as defined in Definition 1.

        It is as though time does not elapse during an information epoch but rather that there is

instead a single market order in the amount of cumulative signed volume that walks up or down

the time one limit order book. That is, movement up and down the book at a point in time is

isomorphic to trading over time for the purpose of determining prices when all information

arrives via trades. Of course, this observation is a direct consequence of the discriminatory

nature of the book and the structure of information arrival within an information regime.

Alternatively, it is a result of the fact that all price impact is permanent.

        It is quite reasonable to assume that limit order traders act as if they can freely cancel and

replace limit orders prior to the arrival of the next market order since it is easy to automate the

limit order management process over time in an information epoch. Moreover, there is no risk of

being picked off when the information regime changes so long as this event is common

knowledge. Traders can simply cancel all limit orders at that time and resubmit new ones when

they figure out the appropriate new marginal price schedule, a condition weaker than assuming

that they can cancel and replace arbitrarily quickly. The assumption of a tatônnement-like limit

order adjustment process is much more plausible when it is easy to program appropriate dynamic

limit order trading strategies ex ante as it is in these circumstances.

        Expected cumulative signed order flow within an information regime is zero under the

risk neutral measure, an observation with a sharp implication for market order trading strategies.

In particular, it does not pay for rational, risk averse, uninformed market order traders to split up
                                                24

their orders unless there is insufficient depth in the book.24 The reasoning is straightforward.

There is no benefit to splitting up an order if it simply marches up or down the book. However,

the trades of others might disrupt its execution and, while their expected price impact is zero in a

risk neutral sense, the actual price impact of any intervening trades will be positive or negative

ex post. Since unexpected signed order flow adds Rothschild-Stiglitz noise to the revenues or

costs of a fragmented order, no uninformed risk averse market order trader who understands the

costs of order splitting will engage in this practice unless market order trader preferences are

order flow state dependent.25 More will be said on this topic in the subsection on bluffing.

       Finally, the assumption that all information is trade-related is the norm in dynamic

market microstructure models. For example, the Kyle (1985) sequential batch auction model and

the Easley, Kiefer, and O’Hara (1996) and Easley, Kiefer, O’Hara, and Paperman (1997)

versions of the Glosten-Milgrom (1985) model and their descendants such as Back and Baruch’s

(2004) synthesis assume that all information arrives via trading. Hence, it seems obvious that

this special case should be taken seriously. Moreover, Proposition 3 makes predictions about the

link between observed prices and cumulative signed order flow in contrast to sequential trade

models in which signed order flow is assumed counterfactually to be equal to the net buy/sell

trade imbalance. That is, the time one book would appear to be a more empirically relevant

“likelihood function” than that found in the various Easley et al. papers and their progeny.

       B. Limit Order Book Sequences within Pricing Regimes

       All information arrives via trades in an information regime and the price of order flow

risk is constant. The R2 = 1 prediction of Proposition 3 – the absence of an error term in (23) –



24A trader with an order that exceeds the depth in the book will generally want to fill the
unexecuted portion as quickly as possible for these reasons, although there are doubtless
mechanisms governing market order submissions that vitiate this intuition. In fact, the remainder
of a market order is automatically converted into a limit order in many markets.
                                                                                                     25

vanishes if the former assumption is relaxed.26 This subsection introduces a different sort of

epoch – a pricing regime – in which changes in the book are risk neutral martingale increments.

          If state prices but not asset values satisfy (22), the marginal price schedule (5) is given by:

                                     t   (u)Vt (u)du                                                  t 1   (u Q t         1     1q    BF(Q t 1 )   sgn Qt 1 dq)Vt (u)du
                    sgn q u |q|                                                     sgn q u |q|
          Pt (q)
                                               t   (u)du                                                    t 1   (u Q t         1     1q   BF(Q t 1 )   sgn Qt 1 dq)du
                         sgn q u |q|                                                         sgn q u |q|


                                     t 1   (u Q t                 1        1q       BF(Q t 1 )      sgn Qt 1 dq)Vt 1 (u Q t                   1      1q   BF(Q t 1 )   sgn Qt 1 dq)du
                    sgn q u |q|
                                                                                                                                                                                          (24)
                                                                                        t 1   (u Q t         1       1q   BF(Q t 1 )   sgn Qt 1 dq)du
                                                                 sgn q u |q|


                                         t 1   (u Q t              1       1q          BF(Q t 1 )   sgn Qt 1 dq) t (u)du
                    sgn q u |q|


                                               t 1         (u Q t          1        1q       BF(Q t 1 )    sgn Qt 1 dq)du
                           sgn q u |q|



where Vt (u) Vt 1 (u Qt                        1           1u   BF(Qt 1 )          sgnQt 1 dq)                   t   (u) . The integrands in the first term are the

determinants of tier q Qt                              1    1q    BF(Qt 1 )            sgnQt 1 dq of the time t–1 book: that is, Pt 1 (q Q t 1 )

outside the backfilling region and the unconditional (on order size) expected time t–1 asset value

less an appropriate backfilling adjustment. By definition, the second term is the change in the

book given the new information contained in the order flow state specific innovations υt (q) .

          This relation is an orthogonal decomposition if υt (q) is a risk neutral martingale

increment. After incorporating the backfilling adjustment from (19) in (24), it is given by:

          Pt (q)   Pt 1 (q Q t                 1           1q   BF(Q t 1 )         sgn Qt 1 dq)
                         Pt 1 (0) Pt 1 (q Q t                                      1       sgn Qt 1 dq)
                                                                                                                          1q   BF(Q t 1 )           (q,Q t 1 )1q       BF(Q t 1 )   t   (q) (25)
                   1Qt 1    0        sgn Qt 1                   t 1   (q Q t                 1      sgn Qt 1 dq)

                                         t 1       (u Q t              1       1q       BF(Q t 1 )   sgn Qt 1 dq) t (u)du
                    sgn q Q t |q |
           t (q)                                                                                                                            ; E [ t (q) | Ft 1 ] 0
                                                   t   1 (u Qt                 1        1q       BF(Q t 1 ) sgn Q t 1 dq)du
                         sgn q Q t |q|




25   For example, this observation applies when preferences depend only on end-of-regime wealth.
                                                              26


where     t 1   (q Qt   1   sgnQt 1 dq) can be replaced with                  1   (q Q1t      1
                                                                                                     sgn Qt 1 dq) . The martingale
                                                                                                          1




increments εt(q) eliminate the mechanical linkages across limit order books over time and, with

them, the nettlesome R2 = 1 prediction of Proposition 3.

        These considerations motivate the following definition of a pricing regime:

        Definition 2:        A pricing regime or epoch is a period during which it is common

knowledge that state prices satisfy             t   (q)     t 1   (q Qt   1       1q   BF(Qt 1 )   sgnQt 1 dq) across order flow

states with  t   1      t while order-flow-dependent asset valuations are given by:

        Vt (q) Vt 1 (q Qt       1   1q   BF(Qt 1 )   sgnQt 1 dq) υt (q); E [υt (q) | Ft 1 ] 0                                (26)

where Vt (q) 0 and Vt (q) 0 for all t and q.

All new information in pricing epochs is about asset values and not about the price of order flow

risk.   As is readily apparent, (26) is definitional:                     innovations in asset values are always

martingale increments under the risk neutral measure in asset pricing so (26) simply serves to

define the conditional mean of Vt (q) to be Vt 1 (q Qt                    1       1q   BF(Qt 1 )   sgnQt 1 dq) .27

        This would appear to be natural given the order splitting and limit order substitution

arguments that have populated these pages. All price impact is permanent in pricing regimes

because expected increments to signed order flow are zero. Accordingly, no rational, risk

averse, uninformed market order trader will engage in order splitting in pricing epochs either, an

observation that figures prominently in the next subsection.

        Moreover, the slope of the limit order book is an (appropriately translated and backfill-


26  Changes in state prices can be permitted as well but innovations in state prices from
   t (q)   t 1 (q Qt 1 1q BF(Qt 1 ) sgnQt 1 dq) t (q) would have to satisfy E [υt (q) t (q) | Ft 1 ] 0
in order for the results of this subsection to hold without additional nontrivial assumptions.
27 This was trivially true in information epochs since V (q) V (q Q             1q BF(Qt 1 ) sgnQt 1 dq) .
                                                          t        t 1     t 1

Exact equality would hold sometimes if, for example, asset values followed pure jump processes.
                                                                                27


adjusted) risk neutral martingale in a pricing epoch as well. Since                                                       t   (q) can be replaced by

 t 1   (q Qt   1    1q   BF(Qt 1 )   sgnQt 1 dq) in (12), the translated change in the slope of the book is:

           Pt (q)        Pt (q) Pt 1 (q              Qt     1     1q    BF(Q t 1 )   sgn Qt 1 dq)
                          t 1   (q Q t      1       1q   BF(Q t 1 )   sgn Qt 1 dq){[Pt (q ) Vt (q)]
                         [Pt 1 (q       Qt      1    1q    BF(Q t 1 )   sgn Qt 1 dq) Vt 1 (q Q t 1 )]}
                                                                                                                                                                 (27)
                          1   (q Q1t    1
                                                1q   BF(Q1t 1 )
                                                                  sgn Qt 1 dq)[Pt (q ) Pt 1 (q               Qt      1    1q      BF(Q t 1 )   sgn Qt 1 dq)]
                                                                         1


                          1   (q Q1t    1
                                                1q   BF(Q1t 1 )
                                                                  sgn Qt 1 dq)[Vt (q) Vt 1 (q Q t                    1    1q     BF(Q t 1 )   sgn Qt 1 dq)]
                                                                         1


                          1   (q Q1t    1
                                                1q   BF(Q1t 1 )
                                                                  sgn Qt 1 dq) Pt (q )              1   (q Q1t   1
                                                                                                                         1q    BF(Q1t 1 )
                                                                                                                                            sgn Qt 1 dq)υt (q)
                                                                         1                                                                        1




where q        q sgnq dq . The regressor                                Pt (q ) Pt (q ) Pt 1 (q              Qt      1    1q     BF(Qt 1 )     sgn Qt 1 dq) is a

risk neutral martingale increment outside the backfilling region as is the residual υt (q) .

         These restrictions make economic sense: the slope of the book cannot change rapidly

without a nontrivial unexpected change in market conditions. Otherwise, limit order traders

would have no incentive to post orders when the slope was shallow because they would know

that they would be picked off by traders who split market or marketable limit orders in

succession. Similarly, limit order traders would have a strong incentive to post orders when the

slope was too steep since they would earn arbitrage profits via order substitution toward the

steeply sloped portion of the book, eventually altering the slope back to the no-arbitrage level.

         Hence, in pricing epochs, limit order books satisfy:

         Proposition 4:                 Under the assumptions of Proposition 1, the innovations in the

(appropriately translated) marginal price schedule and in its slope are martingale increments

under the risk neutral measure save for appropriate backfilling adjustments when it is common

knowledge that the limit order market is in a pricing regime in the sense of Definition 2.

         When might a limit order market experience a pricing regime? One generic setting arises

when there are market order traders who can gain preferential access to the book when its level
                                                                                           28

and slope fail to be martingale increments.                                                   Natural candidates include limit order traders

themselves or the virtual trading crowd comprised of traders who peruse limit order books for

profitable trading opportunities. Both have an incentive to transport liquidity over time when it

is expected to be cheaper or more dear in the future than in the present.

       In particular, suppose a market or marketable limit order trader can temporarily “lock”

others out of the market at any time, essentially giving that trader a free option to split an order

into smaller trades and to submit each of them after the book is refreshed. Both standing limit

orders and those that have replenished the book can then be “picked off” if they are mispriced in

the sense codified in Proposition 4. This putative ability to split orders over time on the demand

side within pricing epochs is a perfect substitute for arbitrage trading. That said, this mechanism

is much less plausible than that underlying information regimes.28

       Finally, it is worth noting a simple corollary of Proposition 4 that broadens the basic

framework to accommodate linear changes in the mapping from order flow states to asset values

in pricing epochs. Suppose the mapping from order flow states to asset values changes to:

        Vt (q |   t   ,   t   )      t        t   Vt (q);         t   ,   t       Ft   1                                                (28)

at time t–1. If state prices do not change when the asset value/order flow state mapping changes,

the marginal price schedule experiences an alteration in location and scale as well since:

                                                      t    (u)Vt (q |         t   ,    t   )du
                                    sgn q Q t |q|
        Pt (q |   t   ,   t   )
                                                                  t   (u)du
                                                  sgn q Q t |q|
                                                                                                                                        (29)
                                                    t (u) t du                                      t (u) t Vt (u)du
                                  sgn q Q t |q|                               sgn q Q t |q|
                                                                                                                       t   P (q)
                                                                                                                           t t
                                                       t   (u)du                                           t   (u)du
                                    sgn q Q t |q|                                          sgn q Q t |q|



which is yet another example of the value additivity proposition that pervades financial economics.
                                                 29

       This simple observation adds considerable flexibility to this framework by permitting the

economic significance of a market order of a given size to change without altering the basic

economics of the underlying marginal price schedule. Diurnal effects – the well-documented

time-of-day effects in liquidity in virtually all markets – can be handled easily by modeling them

as deterministic shifts in price impact. Price impact that changes mechanically with market

conditions can be accommodated as well, making it easy, for example, to allow for a distinction

between fast and slow markets or for links between the marginal price schedules of different

securities. Moreover, (28) can be augmented with multiple value factors and their associated

scale coefficients. These simple modifications greatly enrich the structure of pricing epochs.

       C. Bluffing in Information or Pricing Epochs

       Early versions of Black (1995) (see, for example, Black (1990)) were largely concerned

with the circumstances in which bluffing distorted trading and the price of immediacy under

different market structures, perhaps even causing market breakdowns.            In Black’s lexicon,

bluffers are traders who place orders, the sole information content of which is that the trader in

question does not possess value-relevant private information and knows it.29 The circumstances

in which bluffing works are intimately related to the notion of arbitrage in limit order books: a

market will break down if zero net supply bluffing strategies represent arbitrage opportunities.

       The role of zero expected future signed order flow in information and pricing regimes or,

equivalently, the permanence of price impact, suggests that this analysis might have something

to say about bluffing in limit order markets. In fact, any arbitrage opportunities arising from

bluffing were implicitly assumed away in Assumption 1. The purpose of this subsection is to

make the implications of bluffing in information or pricing epochs a bit more explicit.



28Limit order substitution is even more implausible since it involves swapping time t for time
t+1 limit orders, straining credulity in one direction and violating the arrow of time in the other.
                                                  30

          Bluffing with limit orders within an information or pricing regime has no effect almost

by definition since Pt (q) and Vt (q) are common knowledge among market participants. That

is, any bid or offer that is not on the Pt(q) schedule signals that the epoch is over, that the former

mapping between order flow states and asset valuation is no longer operative. Put differently, a

rational limit order trader cannot simultaneously believe that a market is in an information or

pricing epoch and that there is a limit order posted off of the Pt(q) schedule.

          To be sure, informed traders will naturally submit limit orders when their real or illusory

value-relevant information indicates that these orders are overvalued or undervalued. Unless

they want to signal the end of an information or pricing regime, they will post sell orders only

when their information suggests that Pt (q)         |Q
                                                E [V                        |Q
                                                            q, Ft 1 ] E I [V        q, Ft I1 ] , where   I
                                                        t                       t



denotes the personal state prices – the product of informed investor beliefs and the corresponding

indirect marginal utilities in most models – and Ft I1 denotes the corresponding private

information of a generic informed investor I. Similarly, informed traders will only submit the

corresponding limit buy orders when this inequality is reversed. However, these orders do not

represent bluffing and the possibility that informed investors might submit orders on Pt(q)

schedule is implicitly embedded in the order-flow-dependent asset values Vt(q), again by

assumption. Put differently, the analysis will fail unless there is a well-defined mapping from

order flow states to asset values in the presence of this adverse selection problem.

          Bluffing with market orders is also not profitable when it is common knowledge that a

market is in an information or pricing epoch. Clearly, bluffing exactly breaks even when a

market buy order is immediately reversed with a sale if there is no information arrival in the

meanwhile. More generally, the discriminatory nature of the book forces the bluffer to expect to


29   Bluffing by informed traders is probably more properly thought of as manipulation.
                                                 31

pay (receive) the same average price when buying (selling) as that received (paid) when selling

(buying). Just as there is a disincentive to split up orders in information or pricing regimes, there

is no incentive to “split up” a zero net order flow trade into market buy and sell orders within

such epochs as well. In an information regime, the price at any time depends entirely on net

order flow since it began and bluffing does not affect net order flow by design. The same holds

for pricing epochs in a forward looking sense: the risk neutral expectation of net order flow is

zero and the associated expected price change is zero as well.

       This reasoning suggests that a “rational” bluffer – that is, an expected-utility-maximizing

bluffer with rational beliefs – will choose not to bluff within a given regime. Any sequence of

transactions that generates zero net order flow is subject to price risk from the intervening trades

of others. Hence, any such trading strategy has an uncertain payoff with an expectation of zero,

increasing the volatility of the indirect marginal utility of wealth of such an investor and thus

reducing expected utility.     That is, the payoff to bluffing is expected-utility-decreasing

Rothschild-Stiglitz noise if preferences are not directly order-flow-state dependent. Any trader

who understands these costs will not bluff with market orders within an epoch.

       Of course, there might be “irrational” bluffers – those who fail to realize that bluffing

lowers expected utility – who can survive in equilibrium and their trades will look those of other

traders who think they possess value relevant private information but who do not.30 The only

difference between their behavior and that of other similar noise traders is that their trades will

have no net effect on prices during an epoch since they generate zero net order flow. However,

bluffing transactions will generally have a temporary effect on signed volume and price volatility

within a regime. Hence, an arbitrage-free limit order book functions well in the sense that

bluffing has no permanent effect on the price of immediacy within an epoch but any such trading
                                                 32

can add noise to prices, suggesting that it can have an effect on the welfare of traders.31

       Of course, the assumption that traders know that they are in a given regime is crucial. As

noted earlier, it is a commonly made assumption and it is an internally consistent one as well:

the notion that traders perceive a deterministic mapping between market order states and security

values in those states makes little sense otherwise. A less charitable interpretation is that said

deterministic mapping merely pushes the bluffing problem down one level.                 Hence, the

application of arbitrage reasoning is intimately tied to the question of whether bluffers can cause

limit order traders to perceive changes in epochs when they have not, in fact, occurred or to miss

changes that have happened. It is hard to think of a variable that would signal to uninformed

limit order traders that a change in the marginal price schedule or in order flow represents a

bluff, not a change in regime, save, perhaps, for expected or unexpected market closures.

       Not much more can be said at this level of generality as is often the case with arbitrage

arguments. Much more must be known about the determinants of equilibrium in order to say

something substantive about market behavior around regime changes.                 For example, a

sufficiently great risk of a “true” regime shift that depreciated the value of private information

might be enough to make informed traders forego bluffing. Similarly, the risk of such a regime

shift or that the bluff will not be believed might deter rational bluffers who might otherwise trade

to distort beliefs about market conditions. One simply cannot identify any such circumstances

without endogenizing trading strategies in a more fully explicated model of market conditions.

       Finally, it is perhaps worth emphasizing once again that the end of regimes of these sorts

is an observable event in most dynamic microstructure models.             That is, the risk neutral



30 Traders who mistakenly think they have value relevant private might well behave in every
way like informed traders and, hence, would likely forego irrational bluffing.
31 It is not easy to design regulations that mitigate the impact of welfare-decreasing noise traders.

For example, a wash sale (or purchase) tax or regulation would penalize welfare-increasing de
                                                  33

probability laws that are relevant for assessing the extent of adverse selection present in the

marketplace in mainstream market microstructure models is assumed to be known by market

makers and other suppliers of immediacy ex ante as is the case in most rational expectations

models. At the very least, the bluff-proof nature of limit order books within information and

pricing regimes coupled with the observation that rational traders will forego bluffing in these

circumstances has broadened the class of market settings within which such results obtain.

        D. A Comparison with Batch Auction Markets

        It is interesting to compare and contrast these results with Huberman and Stanzl’s (2004)

characterization of batch auction markets that do not permit statistical arbitrage. To be sure, the

setting is different: they study the profits of risk neutral traders who place market orders before

the demands of other traders – whose behavior is modeled as independently and identically

distributed zero mean noise – and public information, also in the form of iid noise, is revealed.

There is also a difference in nomenclature: their price impact functions correspond to marginal

price schedules while their price update functions correspond to the shifts in these schedules

generated by market orders. Finally, the very notion of arbitrage itself is necessarily different as

well because traders place orders before prices are revealed in their market setting.

        That said, the major difference would appear to be the market mechanism: a single price

auction as opposed to the discriminatory auction implicit in a limit order market. Their main

conclusion is that price update functions must be linear in expectation (given that their slopes

and intercepts are iid) or statistical arbitrage – that is, limiting infinite Sharpe ratios for feasible

zero net investment trading strategies – opportunities will arise. As is well known, the market

price in a uniform price auction is the expectation of the asset value.



facto market makers who generically sought to be flat at the end of the trading day along with
any such noise traders, with an ambiguous effect on the welfare of other market participants.
                                                                   34

       As Huberman and Stanzl (2004) note, the economics of their price updating result was

described well in Black (1995): “If we could hold market conditions fixed, the price impact of a

limit order at a given level of urgency would be proportional to order size…A 10,000-share

order would move the price ten times as much as a 1,000-share order.” They show that the

permanent price impact has to be proportional to the size of the market order or traders could

reliably profit over time through manipulation when the mechanism is a batch auction.32

       The economics here is that emphasized in Glosten (1994) – permanent price impact is

governed by the marginal trade, not the average trade, in a limit order market. That is, linearity

of market impact is not necessary because of the discriminatory nature of the book. In an

information epoch, one 10,000-share order moves prices by the same amount as a sequence of

ten 1,000-share orders when market conditions are held constant at F0 but the marginal price

schedule itself need not be linear. In a pricing regime, the large market order moves prices by the

same amount as the expected (risk neutral) price impact of the ten smaller orders, again with no

linearity requirement. This is merely a restatement of the idea arbitrage-free limit order books

do not permit traders to reliably profit by splitting up orders over time in the settings discussed in

the preceding subsection. Black’s intuition works very differently in a limit order market.

       More specifically, consider the updating equation that determines the post-trade market

value Pt(0) defined in (11) above. In an information regime, it is the value of the asset at the

marginal share – that is, Pt(0) = Vt-1(Q t-1) – but, according to Definition 1 and (22), this is equal

to V1 (Qt   1   Q1t   2
                          1Q         BF(Q1t 2 )
                                                  sgn Qt 2 dq) . Hence, repackaging any set of trades between times 1
                               t 1                    1




32Back and Baruch (2004) show that uniform price auctions are equivalent to limit order
markets in their version of the Glosten-Milgrom model because informed traders endogenously
choose the smallest feasible order size in batch auction markets, making the price update
function proportional to size and, thus, linear. Note also that the notion that order splitting
generically destroys the ability of single price auctions to clear continuous markets is not a new
one; see, for example, Section 6.4.2 of Harris (2003).
                                                                                 35


and t–1 in a way that does not alter net order flow Q1t 1 leaves the cumulative impact of that set

of trades unchanged. Similarly, the time t–1 value of the asset in a pricing regime is:

        Vt 1 (Q t 1 )   Vt 2 (Q t     1     Qt      2    1Qt 1         BF(Q t   2)
                                                                                      sgn Qt 2 dq)              t 1   (Q t 1 )
                        Vt 3 (Q t     1    Qt       2    Qt        3     1Q           BF(Q tt   2    sgn Qt 2 dq)             t 1   (Q t 1 )   t 2   (Q t 1 )   (30)
                                                                                t 1             3)        t 3

                                                                                                                t 1
                        V1 (Q t   1       Q1t   2
                                                        1Q         BF(Q1t 2 )
                                                                                 sgn Qt 2 dq)                   j 1    t j   (Q t 1 )
                                                             t 1                          1




according to Definition 2 and (26) and so the expected market impact of any trade during a

pricing epoch is identical irrespective of how the trade is broken up over time since the residuals

are risk neutral martingale differences. This outcome need not occur in an otherwise identical

batch auction market because of the discriminatory nature of the book.

       This is an observation of some importance for a couple of reasons. First, Obizhaeva and

Wang (2006) use the Huberman and Stanzl results to support the assumption of linear price

impact functions in limit order markets. Price impact might well be linear in limit order markets

but its source does not lie in quasi-arbitrage reasoning. It must instead be an empirically relevant

approximation – as in Sandås (2001) and de Jong et al. (1996) – or the result of a more tightly

parameterized model of the behavior of market and limit order traders. Second, it suggests that

Huberman and Stanzl are a bit hasty in suggesting that the nonlinear price-update functions that

have been documented in empirical work by Hasbrouck (1991), Hausman, Lo, and MacKinlay

(1992), and Kempf and Korn (1999) imply the feasibility of profitable manipulation. The New

York Stock Exchange is a hybrid market that functions, in part, as a limit order market while the

DAX futures market is a pure limit order market. There is no a priori reason to think that these

markets should behave like sequences of batch auction markets.

       4. Empirical Implications

       Perhaps the most interesting aspect of this analysis is its implications for empirical work

on limit order books. To be sure, there is a major stumbling block to its straightforward
                                                     36

application: the absence of a direct measure of Vt(q). While this problem can be solved by

specifying a parametric model for asset values in different order flow states as is done, for

example, in Sandås (2001) and de Jong et al. (1996), the economic settings studied in the

previous section provide a semiparametric framework for learning about the price of order flow

risk under much weaker assumptions. Accordingly, the next two subsections briefly sketch the

empirical implications of information and pricing epochs, respectively.33

        A. Information Regimes

        The most restrictive assumptions given earlier are those codified in Definition 1, the

hypothesis that observations come from a limit order market in an information regime. Since it

is an R2 = 1 theory, it provides sharp potentially falsifiable restrictions that make it testable even

with limited data. It also is a useful framework for organizing data from limit order books.

        For example, a limited data set containing only total trade sizes and subsequent

midquotes can reveal a great deal about marginal valuations. The reason is quite simple: the

post-trade asset value Pt (0) – the subsequent midquote to a first approximation – is equal to the

marginal valuation Vt 1 (Q t 1 ) on the last part of the market order of size Q t 1 , which, in turn, is

             ˆ t 1 ) in an information regime where Q̂ t
equal to V1 (Q                                              1
                                                                Q1t   1
                                                                          1Q                          sgn Qt 2 dq . Moreover,
               1                                      1                        t 1   BF(Q1t   2
                                                                                                  )       1




realized net order flow Q̂1t   1
                                   will span  1 in large samples under weak regularity conditions.

        Perhaps surprisingly, these limited data alone can be used to test the hypothesis that they


33 The relevant regularity conditions are reasonably straightforward. A number of empirical
issues are not addressed here, including the presence of binding minimum ticks. One strategy for
dealing with minimum price variation is to smooth the order flow state/asset value mapping at
each tier of the book, an interpolation that can be rigorously justified under symmetric priority
rules such as pro rata or random allocation which are analyzed in the Appendix. The relevant
premiums under strict priority might be negligible if the tick size is sufficiently small compared
with price levels and order flow volatility so that traders with high priority orders in different
queues expect to cancel them before they are filled. In this case, the sequence of orders in the
queue is typically random ex post, resulting in an ex ante time priority premium close to zero.
                                                              37

are from a single information regime. There is nothing in these calculations that insures that

translated time t midquotes will result in marginal valuations that are ordered correctly. That is,

                           ˆ t 1 ) is strictly increasing in Q̂ t
the model implies that V1 (Q                                                       1
                                                                                       and, hence, it is rejected if the rank
                             1                                 1


correlation between the two is less than one.34

              While the information regime hypothesis can be rejected easily from these data, estimates

of V1 (q) alone are not sufficient to estimate the price of order flow risk or to test hypotheses

about it. However, knowledge of at least one book permits the estimation of state prices and

risk-neutral hazard ratios from (8) and (12), respectively, via:

                                         ˆ t 1)
                                     P1 (Q
                  ˆ t 1)
              ˆ1 (Q                         1
                                                          [1 ˆ t 1       sgn Qˆ t 1 ˆ 1 (Q
                                                                                         ˆt   1
                                                                                                       sgn Qˆ t 1 dq)]
                    1
                               ˆ
                               t 1
                           P1 (Q     sgn Qˆ t 1 dq) Pt (0) Q1        0         1
                                                                                          1                    1
                               1          1
                                                                                                                                (31)
                  ˆ t 1)
              P1 (Q        ˆ (Q
                              ˆ t 1 )[P (Q
                                         ˆt   1
                                                  sgn Qˆ t 1 dq) Pt (0)]
                    1       1   1      1  1             1




if the book has no holes (i.e., satisfies Proposition 2).35 If asset values inferred from midquotes

span the book in large samples, these estimates converge pointwise to their population analogs.36

They can also be smoothed to fill in holes in the time one book created by sampling.37




34 V (Qˆ t 1 ) is also strictly increasing in Q̂ t 1 and has a rank correlation of one s t [2,T] too.
     s   s                                      s
35 Note that (8) and (10) can be used to link risk neutral probabilities and hazard ratios.

36 Another issue concerns cumulative order flows Q̂ t 1 for which there is no time one quote
                                                            1
    ˆ t 1
 P (Q ) . In this eventuality, observations on a time s book with a quote at P (Q      ˆ t 1 ) will provide
 1       1                                                                                                         s   s

the relevant information. This ability to splice together parts of books at different times makes
the assumption that  t 1  t in Definition 1 of negligible importance empirically.
37 Other data can facilitate estimation of the price of order flow risk. For example, overall order

prices (i.e., quantity times average price) are related to the time one marginal price schedule via:
                   1 Qt             1 Qt                         1       Qˆt
         Pt (Q t )        Pt (q)dq        P1 (q Q ˆ t 1 )dq                 1
                                                                                   ˆ t 1 )dq
                                                                              P (q Q
                   Qt 0            Qt 0
                                                    1
                                                             ˆ t
                                                             Q1 Q1 ˆ t 1 ˆ
                                                                         Q t 1 1
                                                                           1
                                                                                     1


and P1(q) can be estimated via step functions such as the left or right endpoints P (Q     ˆ t k 1 ) or
                                                                                                                        1   1

    ˆ ) , respectively, for q (Q
P1 (Q    tk                    ˆ 1 ,Q
                                    ˆ ) with Q̂ ordered so that {Q
                                          tk       tk           tk    ˆ :Q ˆ    Qˆ 1 , k 2,,T}   tk      tk           tk
         1                                1        1            1                                 1       1            1

or the averages can be smoothed. This is a bit like estimating a distribution function, save for the
                                                                 38

        Of course, the hypothesis that the market was in a single information epoch will seldom

survive the presence of data on two or more limit order books or on the overlapping range of

parts of two or more books because they must imply the same time one book. This situation is

like that arising in the analysis of conventional options: two options on the same underlying

asset must have the same implied volatility if the Black-Scholes model is true. As with all R2 =

1 theories, one cannot speak of a distribution theory under either the null or a vague alternative

hypothesis, only that empirical violations of the model reject the joint hypotheses that these data

are from a sufficiently frictionless, arbitrage-free market in a single information epoch.

        However, even if the data do not line up perfectly, it can be reasonable to organize limit

order book data in this fashion under the alternative hypothesis that the data come from a pricing

regime. In this case, the difference between (31) and its population analogue:

                                          Pt 1 (Q t 1 )
          1   (Q1t 1 )                                             [1Q         0    sgn Qt 1   1   (Q t   1   sgn Qt 1 dq)]
                         Pt 1 (Q t   1   sgn Qt 1 dq) Vt 1 (Q t 1 ) t 1                                                           (32)
        Pt 1 (Q t 1 )      t 1   (Q t 1 )[Pt 1 (Q t   1   sgn Q t 1 dq) Vt 1 (Q t 1 )]

                                                ˆ t 1 ) , P (Q
depends on three differences: Pt 1 (Q t 1 ) P1 (Q                                                         ˆt
                                                                                         sgn Qt 1 dq) P1 (Q        1
                                                                                                                       sgn Qt 1 dq) ,
                                                  1        t 1 t                    1                      1                  1




and υt 1 (0)      Pt 1 (0) Vt (Q t ) . The first two are observable and the third has conditional mean

zero in the risk neutral measure even if the information and pricing epoch hypotheses are false.

If υt 1 (0) is taken to have conditional mean zero in the empirical measure as well, any gaps

between the time t–1 and time 1 translated slopes and marginal price schedules can be examined

to see if they are economically significant for the purposes of estimating order flow state specific

asset values and the price of order flow risk. More observations on marginal price schedules

further sharpen the assessment of the economic significance of any violations of the information



                                         ˆ t k 1 ,Q
presence of additional information when (Q        ˆ tk )                   ˆ t j 1 ,Q
                                                                          (Q        ˆ tj )   Ø for one or more dates tj
                                           1        1                        1        1
                                                  39

regime hypothesis. They can also serve to identify transitions between information epochs.

       Of course, there is another alternative hypothesis that is of interest: the possibility that

market traders trade sufficiently quickly so as to violate Assumption 3. In principle, there might

be two senses in which market order traders might be trading too quickly: they might be too

impatient to let limit order traders backfill the book or they might be exploiting stale orders in

the book due to slow backfilling over several trades. However, the latter cannot occur in an

information epoch so long as the decision calculus of limit order traders is not altered – that is, as

long as the mapping from order flow states to value are not affected by slow backfilling – for the

same reason that standing limit orders outside of the backfilling region would naturally remain

posted in (14): the discriminatory nature of the book and the fact that bids and offers are lower

and upper tail expectations insures that no order left standing is stale.

       As a consequence, data on several limit order books can be used to splice together a time

one limit order book. If the market was truly in an information regime, this time one book will

be unique and it can be used to backfill any book in the sample, thus permitting recovery of the

midquotes necessary to estimate the order flow state/asset value mapping and the price of order

flow risk via (31). If it is not, there will be no unique upward sloping time one book but one can

still be cobbled together via averaging. In this case, the economic significance of any departures

from the information regime hypothesis can be assessed via the comparison of (31) with (32).

       B. Pricing Regimes

       Of course, another way to proceed if the information regime hypothesis fails empirically

is to impose the weaker assumption that a given sample is drawn from a pricing epoch. The

pricing regime hypothesis, in conjunction with (12), implies that Vt (q) and Vt (q) are given by:




and tk. Pt (q) is overdetermined with overlapping data which makes for testing possibilities.
                                                                     40


                                        Pt (q)
        Vt (q)         Pt (q)
                                     1 (q   Q1t 1 )
                                                                                                        (33)
                                        Pt (q)               Pt (q)                    t 1
        Vt (q)         Pt (q)                                                1   (q Q )1
                                     1 (q   Q1t 1 )      1 (q    Q1t 1 ) 2

for all q and t where, for simplicity, Vt (q) is calculated only for the no minimum lot size case.

The first equality can be solved for risk neutral hazard ratios if Pt (q) Vt (q) or Pt (q) Vt (q) is a

known function of observables. The second is a Bernoulli differential equation that can be

solved explicitly for                  ˆ t 1 ) if P (q) V (q) or P (q) V (q) can be written solely in terms
                                    (q Q
                                1        1         t     t        t     t



of observables. In the absence of such restrictions, the fact that Vt (q) and Vt (q) are both

positive implies that risk neutral hazard ratios satisfy:

                        ˆ t 1)          Pt (q)
        1        1   (q Q 1
                                        Pt (q)
                                                                                                        (34)
                   ˆ ) t 1 2               ˆ )   t 1   Pt (q)      ˆ t 1)
            1   (q Q   1            1   (q Q     1            1 (q Q 1             0
                                                       Pt (q)

which depend on the semi-elasticity Pt (q) Pt (q) and the curvature coefficient Pt (q) Pt (q) .

       Of course, these constraints will not suffice to estimate the price of order flow risk

without additional information.                        Pt (0) – roughly speaking, the midquote – is equal to

Vt 1 (Q t 1 ) υt (0) by (11) but cannot be translated back to a common date under the pricing

epoch hypothesis. Instead, the estimation of the price of order flow risk is an econometric

problem, one that can be solved by exploiting the moment conditions underlying Proposition 4.

Of course, econometric use of said moment conditions requires a model of the link between the

risk neutral and empirical measures.

       The pricing regime hypothesis makes it possible to learn about risk neutral hazard

functions from the updating equations (13) when the risk neutral martingale increment υt (0) is
                                                             41

unpredictable in the empirical measure as well. In this case, the updating equations are given by:

                                                  Pt 1 (Qt 1 )
          Pt (0)   Pt 1 (Q t   1   sgn Qt 1 dq)          t 1
                                                                  υt (0)                                 (35)
                                                    1 (Q1 )


which is in the form of the semiparametric smooth coefficient regression model studied by Li et

al. (2002) with two main differences: there is no intercept and the regressors Pt 1 (Q t 1 ) and Q1t 1

are risk-neutral martingales which will require amendment of the relevant regularity conditions.

Methods developed for such models – ones that exploit the fact that observations t and s for

which Q1t is close to Q1s should have similar hazard rates – can, in principle, deliver estimates of

the inverse hazard function, which, in turn, can be used to estimate state prices. The usual

nonparametric suspects are natural candidates for the functional form of               1   (Q1t 1 ) 1 : kernel

functions, piecewise polynomials, neural networks, and the like. Tests of the pricing regime

hypothesis can be based on the residuals, which are martingale differences in a pricing regime

but which will generally be correlated with information available prior to time t–1 since

Pt 1 (Q t 1 )   Pt 1 (Q t 1 )
       t 1
                              is present in the residuals when the pricing regime hypothesis fails.
  1 (Q1 )        t 1 (Q t 1 )


         Another place to look for moment conditions is in the dynamic asset valuation relation

(26) in Definition 2. Since these dynamics are on market microstructure time scales, it is

reasonable to hypothesize that the risk neutral martingale increments υt (q) are not predictable in

the empirical measure as well. Proposition 4 provides two ways to test this hypothesis. The

conditional mean of Pt (q) is Pt 1 (q Q t 1 ) outside of the backfilling region according to (25)

and so the associated innovations εt(q) are unpredictable. Similarly, the translated change in the

slope of the limit order book as given in (27) is a martingale increment outside the backfilling

region in these circumstances as well. It is worth emphasizing that these martingale hypotheses

can be tested without estimating the price of order flow risk.
                                                       42


         The conditional mean of Pt (q) inside the backfilling region is given explicitly in (25),

making it possible to estimate the cumulative distribution function of state prices in a pricing

epoch when εt(q) is unpredictable. In particular, (25) can be conveniently rewritten as:

                                                   Pt 1 (0) Pt 1 (q Qt         1   sgn Qt 1 dq)
         Pt (q) Pt 1 (q Qt     1   sgn Qt 1 dq)                                                        (q,Q t 1 )    t   (q) (36)
                                                     1Qt 1   0     sgnQt 1   1   (q Q1t 1 )

inside the backfilling region. This too is a version of the semiparametric smooth coefficient

regression model studied by Li et al. (2002) with the regression coefficient given by the inverse

or one minus the inverse of the cumulative distribution function of state prices. Accordingly, the

recovery of state prices will require inversion of this regression coefficient.38

         One final approach builds on this martingale increment hypothesis by assuming that a

pricing regime mimics an information epoch in a particular sense. Imagine that the transaction

record separately reports the execution of each share of a market order without a time stamp,

making the record a sequence of 1’s or –1’s, with each sequence ending at “time” Qt–1 = q. A

market order will look like it was a sequence of trades in a market with one share bid and offered

with runs of buys and sells as it walked up or down the book.

         The pricing epoch analogue arises when changes in asset values are martingale

increments up and down the book. Under this hypothesis, the risk neutral martingale increments

υt (q)    are   unpredictable,       not    only    over         time,   but       over   q       as   well     so       that

E[υt (q) | υt (r),sgnq r | q |; Pt (0), Ft 1 ] 0   q  as information “evolves” in anticipation of a

market order walking the book. Hence, (27) is yet another semiparametric smooth coefficient

regression model given by:


38Alternatively, (36) can be converted into a normal equation by multiplying both sides by
1Qt 1 0 sgn Qt 1 1 (q Q1t 1 ) . Generalized method of moments analogues of the methods given in
Li et al. (2002) will produce consistent estimates under suitable regularity conditions.
                                                                  43


          Pt (q)   1   (q Q1t 1 1q        BF(Q1t 1 )
                                                       sgn Qt 1 dq) Pt (q )           1   (q Q1t 1 1q            BF(Q1t 1 )
                                                                                                                              sgn Qt 1 dq)υt (q) (37)
                                                             1                                                                     1




where q      q sgnq dq , which is a well-posed regression outside of the backfilling region

because υt (q) is uncorrelated with                     Pt (q ) Pt (q ) Pt 1 (q                Qt   1       1q   BF(Qt 1 )    sgn Qt 1 dq) in the

discrete lot size case while it is negligible when  is uncountable. It has the virtue that it has

the risk neutral hazard ratio and not its inverse or 1Qt 1                   0    sgn Qt 1           1   (q Q1t 1 ) as the coefficient.

Moreover, there are two natural specification tests implicit in this model: the absence of an

intercept and the presence of the explicit backfilling relation given in (25) as a function of the

risk neutral CDF that can be recovered from                          1   (q Q1t   1
                                                                                          1q   BF(Q1t 1 )
                                                                                                            sgn Qt 1 dq) . Note that the
                                                                                                                   1




composite residual       1   (q Q1t   1
                                           1q   BF(Q1t 1 )
                                                             sgn Qt 1 dq)υt (q) will exhibit heteroskedasticity related
                                                                 1




to the time one hazard unless changes in the variance of υt (q) offset it.

       Finally, one hypothesis will nearly always be of interest in this setting: the hypothesis

that the risk neutral and empirical measures are the same in a pricing regime. Sandås (2002)

concluded that the book was too steep on average to be consistent with the Glosten (1994)

model, a conclusion that could be taken to be evidence that risk aversion is implicit in bids and

offers and not as evidence of model failure. Differences between the cumulative distribution

function of state prices and the empirical distribution of cumulative net order flow in the sample

can potentially provide an economic interpretation of the “excessive” steepness of the book.39

       5. Conclusion

       This paper has barely scratched the surface of the applicability of the idea that limit

orders can be viewed as contingent claims – more precisely, digital options – written on order

flow. It has established a basic framework for the theoretical and empirical analysis of limit
                                                  44

order markets when it is reasonable to treat them as sufficiently frictionless with an underlying

mapping from market order size to asset value from the perspective of uninformed limit order

traders. Much can be said about the supply of immediacy in limit order markets in these

circumstances taking these features of the market for immediacy as given.

          The economics and econometrics of limit order markets prove to be tightly linked in

these circumstances because the analysis is an exercise in asset pricing theory. The economics is

that of risk neutral valuation based on state prices associated with order flow states. Just as a

menu of options can complete the market and facilitate the calculation of the state prices, so can

a limit order book facilitate the calculation of state prices for order flow states. When the price

of order flow risk is constant, signed volume plays a central role in limit order market dynamics

due to the economics of order splitting and the discriminatory nature of the book.               The

econometrics is that arising from the associated moment conditions, which link state prices, the

slope of the book, and price impact. In the general environment and in both types of regimes,

price impact is not mechanical but rather is an integral part of price discovery.

          I will close with two observations on the prospects for future research in this framework,

one empirical and one theoretical. On the empirical side, the analogy with asset pricing can be

further explored – and, for that matter, exploited – by formulating models for limit order price

schedules in terms of stochastic discount factors, which will permit the importation of the

numerous methods developed for their analysis. On the theoretical side, equilibrium models for

limit order markets can be based on the observation that, like conventional derivatives, order

flow derivatives are in zero net supply – that is, trading is in zero net supply – as opposed to

models that tightly parameterize the economic environment, especially with regard to

preferences (i.e., constant absolute risk aversion or risk neutrality) and beliefs (i.e., rational


39   The relevant regularity conditions for the empirical distribution of cumulative net order flow
                                                45

expectations coupled with normally distributed signals). These developments can only serve to

improve our understanding of a market structure that has become ubiquitous.




are those that apply to time series data. See, for example, Bosq (1998) and Györfi et al. (1989).
                                                                                 46


                                                                         Appendix

       Strict priority rules and minimum price variation: Suppose there is no minimum

order size, since accounting for one will just make for bounds instead of equalities in what

follows, and consider first the case of a strict priority rule like time priority. In this case, limit

order substitution at a point in time can only go in one direction: from an order in the queue at

one tier to the end of the queue at that or any other tier. Hence, limit order substitution among

the lowest priority orders across tiers of the book characterizes implicit state prices.

       Accordingly, consider two adjacent tiers of the book k and k sgn k with prices

Pk    q (qk      sgn k   ,qk ] and Pk           sgn k     q (qk ,qk           sgn k   ] , respectively, where q k is the quantity posted

at the lowest priority of tier k and where the tick size ck                                          Pk    sgn k         Pk         0 can vary with the price

level. Since Pk           Vt (qk ) and c k                0 , depth is implicitly determined at each tier via:40


                                                                                             j |k|    t   (q j     sgn k   )Vt (q j        sgn k   )
        Pk       t (q k )Vt (q k ) [1                   t (q k )]Pk   sgn k           Pk
                                                                                                          j |k|     t   (q j   sgn k   )

by iterating the first expression forward. The analogue of (12) in this case implies that:

                               Pk   sgn k     Pk                        ck                                                          ck
         t   (qk )                                                                            t   (qk )                                                j |k|   t   (q j sgnk )
                         [Pk   sgn k        Vt (qk )]       Pk    ck          Vt (q k )                            Pk          ck        Vt (q k )

which is similar to the solution of (12) when c k is small in percentage terms but can be quite

different when it is not. Note that risk neutral probabilities within the queue are not determined

in the absence of a model for the rents generated by strict priority.


40 This characterization of depth is at a point in time, begging the question of how the order
sequence in the queue was determined in the first place. Black (1995) argued that there can be
no equilibrium in a limit order market with time priority and no cancellation costs: all traders
would try to place all orders that they might like to make at the beginning of the day and later
cancel any limit order that they did not want executed but there can be only one order at the front
of the queue and, hence, there can be no equilibrium. Frictions of various sorts can be invoked
to circumvent this problem.
                                                                                             47


          Pro rata priority rules and minimum price variation:                                                                 Glosten (1994) analyzed

minimum price variation with a pro rata secondary priority rule with an infinite number of

perfectly competitive risk neutral limit order traders so what follows will be brief. In tier k,

min(Qt ,qk ) qk                      1
                                          percent of each order is executed when a market order for Qt                                           qk   1   0
     qk        qk   1



shares arrives. The analogue of the risk neutral benefit (6) in this case is:

                        qk       q qk            1
          Pk                                              t   (q)dq              t   (q)dq
                    qk       1   qk        qk     1
                                                                          q qk




while the corresponding analogue of the risk neutral cost (7) is:

           qk            q qk                 sgn k
                                                          t   (q)Vt (q)dq                    t   (q)Vt (q)dq
           qk   sgn k    qk              qk    sgn k
                                                                                     q qk



where the second integral in both expressions is unweighted because each limit order is fully

executed if the market order exhausts the depth at tier q. Hence, the tier k price is given by:

                         qk          q qk             1
                                                    t (q)Vt (q)dq                                t   (q)Vt (q)dq
                         qk      1   qk       qk 1                                    q qk
          Pk
                                          qk q     qk 1
                                                          t (q)dq                                t   (q)dq
                                          qk 1 q   qk 1                               q qk
                                                 k



                                                                                        q qk              1
under the pro rata priority rule. Note that                                                                   is also the cumulative uniform distribution
                                                                                       qk            qk   1



function over the range qk                                      qk   1   so random allocation has the same pricing implications as pro

rata execution. The marginal order in tier k is placed such that limit order traders do not earn

rents and, hence, the right derivative of this expression at q k is equal to zero:
                                                                                                         48


                          qk            q qk                1                                                                      qk             q qk        1
                                                                 2        t (q)Vt (q)dq                                                                           2   t   (q)dq
                          qk                                                                                                       qk
                               1
                                       qk             qk    1
                                                                                                                                        1
                                                                                                                                              qk         qk   1
        0                                                                                                     Pk
                 qk       q qk                1                                                                     qk       q qk             1
                                                        t   (q)dq                            t   (q)dq                                               t   (q)dq                   t   (q)dq
             qk       1   qk            qk     1
                                                                                q qk                                qk   1   qk         qk     1
                                                                                                                                                                          q qk




which can be solved for the numerator of the first term in the revised upper tail expectation.

Substitution of the solution into the numerator yields the simple upper tail expectation:

                                   t   (q)Vt (q)dq
        Pk
                  q qk
                                                                                |Q
                                                                            E [V                     q k , Ft 1 ]
                                                                                    t
                                             t (q)dq
                           q qk



which is identical to the valuation formula for the unfettered limit order book. As Glosten

(1998) emphasized, free entry coupled with perfect competition insures that the orders at tier k

exactly break even, which is equivalent to the force of arbitrage in this context.

       Derivation of (16): The combination of (5) and (15) yields:

                                         t   (u)Vt (u)du                                     t 1   (u Q t 1 )Vt 1 (u Q t 1 )du
                           u q                                                   u q
        Pt (q)
                                                  t   (u)du                                              t 1   (u Q t 1 )du
                                       u q                                                         u q


                                         t 1   (u Q t 1 )Vt 1 (u Q t 1 )du                                                   t 1   (u Q t 1 )Vt 1 (u Q t 1 )du
                           u q                                                                                     u q

                                                            t 1   (u Q t 1 )du                                                                t 1   (u Q t 1 )du
                                               u q                                                                                 u q


                                         t 1      (u Q t 1 )Vt 1 (u Q t 1 )du
                           u q

                                                                t 1   (u Q t 1 )du
                                                  u q


                               t 1     (0)Pt 1 (0 ) [1                                 t 1   (0)]Pt 1 (0 ) [1                           t 1   (q Q t 1 )]Pt 1 (q Q t 1 )
                                                                                                  t 1 (q  Qt 1 )
                          Pt 1 (0) [1                                 t 1 (q Q t 1 )]Pt 1 (q Q t 1 )
                                                                      t   1 (q Qt 1 )

       Derivation of (19): It is easy to analyze the discrete case separately and to insure that

the end result is compatible with that for the continuous case given in (18).                                                                                                                For

q   BF(Q t 1 )            [ 1, Q t 1 ] for Q t                              1    0 we have:
                                                                                                      49


                                           u q     t   (u)Vt (u)
                      Pt (q)
                                                 u q           t   (u)

                                           u q     t 1     (u Q t                    1       1q      BF(Q t 1 )   sgn Qt 1 dq)Vt 1 (u Q t                                1       1q   BF(Q t 1 )   sgn Q t 1 dq)

                                                                                             u q      t 1   (u Q t             1        1q       BF(Q t 1 )   sgn Qt 1 dq)

                                           u q     t 1     (u Q t 1 )Vt 1 (u Q t 1 )
                                                                                                                        1q         BF(Q t 1 )
                                                           u q               t   1 (u Qt 1 )

                                           u q     t 1     (u Q t                    1        sgn Qt 1 dq)Vt 1 (u Q t                                1        sgn Qt 1 dq)
                                                                                                                                                                                      1q   BF(Q t 1 )
                                                                                     t 1     (q Q t          1       sgn Qt 1 dq)


                    u q dq     t 1   (u Qt         1               sgn Qt 1 dq)Vt 1 (u Q t                             1           sgn Qt 1 dq)
to which                                                                                                                                                      1q   BF(Qt 1 )        can be added and
                                                 t 1   (q Qt                     1       sgn Qt 1 dq)

subtracted, yielding:

          Pt (q)      Pt 1 (q Q t           1     1q       BF(Q t 1 )            sgn Qt 1 dq)1q                  BF(Q t 1 )


                             u q     t 1   (u Q t                  1     sgn Qt 1 dq)Vt 1 (u Q t                                   1     sgn Qt 1 dq)
                                                                                                                                                                    1q       BF(Q t 1 )
                                                               t       1 (q Qt               1       sgn Qt 1 dq)

                             u q dq        t 1   (u Q t                  1       sgn Qt 1 dq)Vt 1 (u Q t                                 1        sgn Qt 1 dq)
                                                                                                                                                                         1q      BF(Q t 1 )
                                                                       t 1   (q Q t              1     sgn Qt 1 dq)

                             u q dq        t 1   (u Q t                 1        sgn Qt 1 dq)Vt 1 (u Q t                                1         sgn Qt 1 dq)
                                                                                                                                                                         1q      BF(Q t 1 )
                                                                       t 1   (q Q t              1     sgn Qt 1 dq)
                                                                                                                                                      Pt 1 (0)
                      Pt 1 (q Q t           1     1q       BF(Q t 1 )            sgn Qt 1 dq)1q                  BF(Q t 1 )                                              1q                             BF(Q t 1 )
                                                                                                                                             t   1 (q Q t 1 sgn Qt 1 dq)
                       [1          t 1   (q Q t            1            2sgn Qt 1 )]Pt 1 (q Q t                            1           2sgn Qt 1 )
                                                                                                                                                          1q       BF(Q t 1 )
                                                       t       1 (q Qt                   1       sgn Qt 1 dq)

where the last term arises only in the minimum lot size case for which dq = 1. The backfilling

terms are completed by adding and subtracting                                                                                  Pt 1 (q Qt                     1     sgnQt 1 dq)1q               BF(Qt 1 )       and

 Pt 1 (q Qt     1     sgnQt 1 dq)
                                           1q    BF(Qt 1 )               which results in:
  t 1   (q Qt   1      sgnQt 1 dq)
                                                                                                     50


            Pt (q)      Pt 1 (q Q t         1           1q       BF(Q t 1 )      sgn Qt 1 dq)1q             BF(Q t 1 )

                        Pt 1 (q Q t            1         1q      BF(Q t 1 )      sgn Qt 1 dq)1q             BF(Q t 1 )

                                      Pt 1 (0)                                                                  Pt 1 (q Q t              1           sgn Qt 1 dq)
                                                         1q                                    BF(Q t 1 )                                                                  1q   BF(Q t 1 )
                             t   1 (q Q t 1 sgn Qt 1 dq)                                                            t 1     (q Q t           1        sgn Qt 1 dq)
                        [1          t 1   (q Q t                 1         2sgn Qt 1 )]Pt 1 (q Q t                      1         2sgn Qt 1 )
                                                                                                                                                      1q     BF(Q t 1 )
                                                             t       1 (q Qt          1        sgn Qt 1 dq)
                         Pt 1 (q Q t               1         sgn Qt 1 dq)
                                                                                          1q   BF(Q t 1 )       Pt 1 (q Q t             1        1q        BF(Q t 1 )   sgn Q t 1 dq)1q       BF(Q t 1 )
                             t 1   (q Q t           1        sgn Qt 1 dq)
                                                                                                            Pt 1 (0) Pt 1 (q Q t                             1     sgn Qt 1 dq)
                        Pt 1 (q Q t         1           1q       BF(Q t 1 )      sgn Qt 1 dq)                                                                                         1q     BF(Q t 1 )
                                                                                                                            t 1   (q Q t          1         sgn Qt 1 dq)
                        [1          t 1   (q Q t                 1         sgn Qt 1 )]Pt 1 (q Q t                   1           sgn Qt 1 )
                                                                                                                                             1q       BF(Q t 1 )
                                                         t 1     (q Q t           1        sgn Qt 1 dq)
                        [1          t 1   (q Q t                 1         2sgn Qt 1 )]Pt 1 (q Q t                      1         2sgn Qt 1 )
                                                                                                                                                      1q     BF(Q t 1 )
                                                             t       1 (q Qt          1        sgn Qt 1 dq)

which is identical to (17) in the continuous case since dq is then equal to zero. Following a

market sell order, the expression has the same structure except the denominator is equal to

1         t 1   (q Qt   1        sgnQt 1 dq) and the numerators in the second and third lines include

    t 1   (q Qt    1    2sgnQt 1 dq) and                                   t 1   (q Qt           1     sgnQt 1 dq) , respectively. These modifications

yield the pricing relation:

                                                                                                          Pt 1 (0) Pt 1 (q Q t                         1         sgn Qt 1 dq)
            Pt (q)      Pt 1 (q Q t        1            1q    BF(Q t 1 )     sgn Qt 1 dq)                                                                                        1q   BF(Q t 1 )
                                                                                                            1               t    1 (q Qt         1         sgn Qt 1 dq)
                             t 1   (q Q t      1         2sgn Qt 1 dq)Pt 1 (q dQ t                              1           2sgn Qt 1 dq)
                                                                                                                                                      1q    BF(Q t 1 )
                                                   1                 t 1   (q Q t          1     sgn Qt 1 dq)
                             t 1   (q Q t       1        sgn Qt 1 dq)Pt 1 (q Q t                            1    sgn Qt 1 dq)
                                                                                                                                        1q       BF(Q t 1 )
                                           1                 t 1     (q Q t           1        sgn Qt 1 dq)

Combining the two expressions produces (19):
                                                                                    51


Pt (q)   Pt 1 (q Q t              1        1q   BF(Q t 1 )   sgn Q t 1 dq)
                                                  Pt 1 (0) Pt 1 (q Q t                        1     sgn Qt 1 dq)
                                                                                                                                                        1q   BF(Q t 1 )
            t 1   (q Q t               1    sgn Qt 1 dq)1Qt 1                   0    [1           t 1   (q Q t        1   sgn Qt 1 dq)]1Qt 1        0

           [1Qt 1          0      sgn Qt 1            t 1   (q Q t          1       sgn Qt 1 dq)]Pt 1 (q Q t                1      sgn Q t 1 dq)
                                                                                                                                                        1q   BF(Q t 1 )
            t 1   (q Q t               1    sgn Qt 1 dq)1Qt 1                   0    [1           t 1   (q Q t        1   sgn Qt 1 dq)]1Qt 1        0

         [1Qt 1       0         sgn Qt 1         t 1   (q Q t           1        2sgn Q t 1 dq)]Pt 1 (q Q t                 1      2sgn Q t 1 dq)
                                                                                                                                                        1q   BF(Q t 1 )
            t 1   (q Q t               1    sgn Qt 1 dq)1Qt 1                   0    [1           t 1   (q Q t        1   sgn Q t 1 dq)]1Qt 1       0

         Pt 1 (q Q t              1        1q   BF(Q t 1 )   sgn Q t 1 dq)
             Pt 1 (0) Pt 1 (q Q t                            1      sgn Qt 1 dq)
                                                                                                   1q    BF(Q t 1 )
         1Qt 1    0            sgn Qt 1         t 1   (q Q t        1           sgn Q t 1 dq)
           t 1   (q Q t                1    sgn Qt 1 dq)Vt 1 (q Q t                       1       sgn Qt 1 dq)dq
                                                                                                                          1q    BF(Q t 1 )
                          1Qt 1    0       sgn Qt 1          t 1   (q Q t            1    sgn Qt 1 dq)
         Pt 1 (q Q t              1        1q   BF(Q t 1 )   sgn Q t 1 dq)
             Pt 1 (0) Pt 1 (q Q t                            1      sgn Qt 1 dq)
                                                                                                   1q    BF(Q t 1 )       (q,Q t 1 )1q       BF(Q t 1 )
         1Qt 1    0            sgn Qt 1         t 1   (q Q t        1           sgn Q t 1 dq)
                                              52


                                          References


Back, K., and S. Baruch, 2004, “Information in securities markets: Kyle meets Glosten and
      Milgrom,” Econometrica 72, pp. 433–465.

––––––, 2006, “Working orders in limit-order markets and floor exchanges,” working paper,
      Eccles School of Business, University of Utah.

Black, F., 1990, “Bluffing,” working paper, Goldman Sachs Asset Management.

––––––, 1995, “Equilibrium exchanges,” Financial Analysts Journal 51, pp. 23-29.

Banz, R. and M. H. Miller, 1978, “Prices for state-contingent claims: Some estimates and
      applications,” Journal of Business 51, pp. 653-672.

Bosq, D., 1998, Nonparametric statistics for stochastic processes: Estimation and prediction,
      second edition, Lecture Notes in Statistics, 110, Springer-Verlag, New York.

Breeden, D. T., and R. H. Litzenberger, 1978, “The prices of state-contingent claims implicit in
      option prices,” Journal of Business 51, pp. 621-651.

De Jong, F., T. Nijman, and A. Röell, 1996, “Price Effects of Trading and Components of the
      Bid-Ask Spread on the Paris Bourse,” Journal of Empirical Finance 3, pp. 193-213.

Easley, D., N. M. Kiefer and M. O'Hara, 1997, One day in the life of a very common stock.
       Review of Financial Studies 10, pp. 805-835.

–––––– and J. Paperman, 1996, Liquidity, information and infrequently traded stocks. Journal of
      Finance 51, pp.1405-1436.

Foucault, T., 1999, “Order flow composition and trading costs in a dynamic limit order market,”
      Journal of Financial Markets 2, pp. 99-134.

Foucault, T., O. Kadan, and E. Kandel, 2005, “Limit order book as a market for liquidity,”
      Review of Financial Studies 18, pp. 1171-1217.

Glosten, L. R., 1994, “Is the Electronic Limit Order Book Inevitable?” Journal of Finance 49,
       pp. 1127-1161.

––––––, 1998, “Competition, Design of Exchanges, and Welfare,” working paper, Graduate
      School of Business, Columbia University.

–––––– and Paul R. Milgrom, 1985, “Bid, ask, and transaction prices in a specialist market with
      heterogeneously informed traders,” Journal of Financial Economics 13, pp. 71–100.

Goettler, R. L., C. A. Parlour, and U. Rajan, 2004, Information acquisition in a dynamic limit
       order market, working paper, Tepper School of Business, Carnegie Mellon University.
                                               53



––––––, 2005, “Equilibrium in a dynamic limit order market,” Journal of Finance 60, pp. 2149-
      2192.

––––––, 2006a, “Limit order markets and microstructure noise,” working paper, Tepper School
      of Business, Carnegie Mellon University.

––––––, 2006b, “Microstructure effects and asset pricing,” working paper, Tepper School of
      Business, Carnegie Mellon University.

Györfi, L., Härdle, W., Sarda, P., and Vieu, P., 1989, Nonparametric curve estimation for time
       series. Lecture Notes in Statistics, 60, Springer-Verlag, New York.

Hasbrouck, Joel, 1991, “Measuring the information content of stock trades,” Journal of Finance
      46, pp. 179-207.

Hausman, Jerry A., Andrew W. Lo, and A. Craig MacKinlay, 1992, “An ordered probit analysis
     of transaction stock prices,” Journal of Financial Economics 31, pp. 319-379.

Hollifield, B. R., R. A. Miller, and P. Sandås, 1999, “Empirical analysis of limit order markets,”
        working paper, Tepper School of Business, Carnegie Mellon University.

––––––, 2004, “Empirical analysis of limit order markets,” Review of Economic Studies 71, pp.
      1027-1063.

––––––, and Slive, 2002, “Liquidity supply and demand in limit order markets,” working paper,
      Tepper School of Business, Carnegie Mellon University.

––––––, 2006, “Estimating the gains from trade in limit order markets,” working paper, Tepper
      School of Business, Carnegie Mellon University.

Huberman, G. and W. Stanzl, 2004, “Quasi-arbitrage and price manipulation,” Econometrica 72,
      pp. 1247-1275.

Ingersoll, J. E., Jr., 1987, “Digital contracts: Simple tools for pricing complex derivatives,”
       Journal of Business 73, pp. 67-88.

Kempf, Alexander, and Olaf Korn, 1999, “Market depth and order size,” Journal of Financial
      Markets 2, pp. 29-48.

Kyle, A. S., 1985, “Continuous Auctions and Insider Trading,” Econometrica 53, pp. 1315-1335.

Large, J., 2006, “A market clearing role for inefficiency on a limit order book,” working paper,
       All Souls College, University of Oxford.

Lehmann, B. N., 2006, “Notes for a contingent claims theory of limit order markets” in I. E.
     Brick, T. Ronen, and C.-F. Lee (eds.), Advances in quantitative analysis of finance and
     accounting: Essays in microstructure in honor of David K. Whitcomb, World Science,
                                              54

       Hackensack, NJ.

Li, Q., C. Huang, D. Li, and T. Fu, 2002. “Semiparametric smooth coefficient models,” Journal
        of Business and Economic Statistics 20, pp. 412–422.

Mas-Collell, A., M. Whinston, and J. R. Green, 1995, Microeconomic Theory, New York,
      Oxford University Press.

Obizhaeva, A. A. and J. Wang, “Optimal trading strategy and supply/demand dynamics,”
      working paper, Sloan School of Management, Massachusetts Institute of Technology.

Parlour, C. A., 1998, “Price dynamics in limit order markets,” Review of Financial Studies 11,
       pp. 789-816.

Rock, K., 1990, “The specialist’s order book and price anomalies,” working paper, Harvard
      Business School, Harvard University.

Ross, S.A., 1976, “Options and efficiency,” Quarterly Journal of Economics 90, pp. 75-89.

Rosu, I., 2004, A dynamic model of the limit order book, working paper, Graduate School of
       Business, University of Chicago.

Sandås, P., 2001, “Adverse Selection and Competitive Market Making: Empirical Evidence from
       a Limit Order Market,” Review of Financial Studies 14, pp. 705-734.

Wei, Bin, 2006, “Picking-off risk and liquidity in a dynamic limit order market,” working paper,
       Fuqua School of Business, Duke University.
