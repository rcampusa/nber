                                NBER WORKING PAPER SERIES




                   INSURANCE AND TAXATION OVER THE LIFE CYCLE

                                           Emmanuel Farhi
                                            Iván Werning

                                        Working Paper 16749
                                http://www.nber.org/papers/w16749


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     January 2011




The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2011 by Emmanuel Farhi and Iván Werning. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
Insurance and Taxation over the Life Cycle
Emmanuel Farhi and Iván Werning
NBER Working Paper No. 16749
January 2011
JEL No. H21

                                              ABSTRACT

We consider a dynamic Mirrlees economy in a life cycle context and study the op- timal insurance
arrangement. Individual productivity evolves as a Markov process and is private information. We use
a first order approach in discrete and continuous time and obtain novel theoretical and numerical results.
Our main contribution is a formula describing the dynamics for the labor-income tax rate. When productivity
is an AR(1) our formula resembles an AR(1) with a trend where: (i) the auto-regressive coefficient
equals that of productivity; (ii) the trend term equals the covariance pro- ductivity with consumption
growth divided by the Frisch elasticity of labor; and (iii) the innovations in the tax rate are the negative
of consumption growth. The last prop- erty implies a form of short-run regressivity. Our simulations
illustrate these results and deliver some novel insights. The average labor tax rises from 0% to 46%
over 40 years, while the average tax on savings falls from 17% to 0% at retirement. We com- pare
the second best solution to simple history independent tax systems, calibrated to mimic these average
tax rates. We find that age dependent taxes capture a sizable fraction of the welfare gains. In this way,
our theoretical results provide insights into simple tax systems.


Emmanuel Farhi
Harvard University
Department of Economics
Littauer Center
Cambridge, MA 02138
and NBER
efarhi@harvard.edu

Iván Werning
Department of Economics
MIT
50 Memorial Drive, E51-251a
Cambridge, MA 02142-1347
and NBER
iwerning@mit.edu
      Insurance and Taxation over the Life Cycle
                       Emmanuel Farhi                     Iván Werning
                     Harvard University                         MIT

                                           July 2010


                                            Abstract

        We consider a dynamic Mirrlees economy in a life cycle context and study the op-
     timal insurance arrangement. Individual productivity evolves as a Markov process
     and is private information. We use a first order approach in discrete and continuous
     time and obtain novel theoretical and numerical results. Our main contribution is a
     formula describing the dynamics for the labor-income tax rate. When productivity is
     an AR(1) our formula resembles an AR(1) with a trend where: (i) the auto-regressive
     coefficient equals that of productivity; (ii) the trend term equals the covariance pro-
     ductivity with consumption growth divided by the Frisch elasticity of labor; and (iii)
     the innovations in the tax rate are the negative of consumption growth. The last prop-
     erty implies a form of short-run regressivity. Our simulations illustrate these results
     and deliver some novel insights. The average labor tax rises from 0% to 46% over 40
     years, while the average tax on savings falls from 17% to 0% at retirement. We com-
     pare the second best solution to simple history independent tax systems, calibrated
     to mimic these average tax rates. We find that age dependent taxes capture a sizable
     fraction of the welfare gains. In this way, our theoretical results provide insights into
     simple tax systems.



1    Introduction
To a twenty five year old entering the labor market, the landscape must feel full of un-
certainties. Will they land a good job relatively quickly or will they initially bounce from
one job to another in search of a good match? What opportunities for on-the-job training
and other forms of skill accumulation be they find? How well will they take advantage
of these opportunities? Just how good are they? How high will they rise? Will they ad-
vance steadily within a firm or industry, or be laid off and have to reinvent themselves

                                                1
elsewhere? For all these reasons, young workers must find it challenging to predict how
much they will be making at, say, age fifty. More generally, they face significant uncer-
tainty in their lifetime earnings.
    This paper investigates the optimal design of a tax system that efficiently shares these
risks. With a few notable exceptions, since Mirrlees (1971), optimal tax theory has mostly
worked with a static model that treats heterogeneity and uncertainty symmetrically, since
redistribution can be seen as insurance behind the “veil of ignorance”. More recently,
there has been growing interest in the special role of uncertainty and insurance. To date,
this more dynamic approach has focused on savings distortions, or considered special
cases, such as two periods or i.i.d. shocks.1 Little is known in more realistic settings about
the pattern of labor income taxes when uncertainty is gradually revealed over time.
    This paper aims to fill this gap and address the following questions. How are the
lessons for labor income taxes from the static models (e.g. Mirrlees (1971), Diamond
(1998), Saez (2001), Werning (2007b)) altered in a dynamic context? How is taxation with
an insurance motive different from the redistributive motive? How does the optimal tax
system compare to simpler systems? Are the welfare gains from a more elaborate system
large? What lessons can we draw from the optimal tax structure for simpler tax systems?
    We adapt the standard dynamic Mirrleesian framework to a life cycle context. Agents
live for T years. They work and consume for TE years and then retire, just consuming,
for the remaining TR = T − TE periods. During their working years, labor supply in
efficiency units is the product of work effort and productivity. An agent’s productivity
evolves as a persistent Markov process. Both effort and productivity are privately ob-
served by the agent. The planner controls consumption and output, but cannot observe
productivity nor work effort. Due to this private information, allocations must be incen-
tive compatible. We study constrained efficient allocations and characterize the implicit
marginal taxes or wedges implied by the allocation.
    A direct attack on this problem is largely intractable, but we show that both theoretical
and numerical progress can be made by using a first-order approach. A similar approach
has proven useful in moral-hazard contexts with unobservable savings (see for example
Werning (2002)). Kapicka (2008) spells out the first-order approach for a Mirrleesian set-
ting, which we implement here. The basic idea is to relax the problem by imposing only
local incentive constraints. Unlike the original problem, the relaxed problem has a re-
cursive structure that makes it tractable. One can then check whether the solution to the
relaxed problem is incentive compatible, and, hence, a solution to the original problem.
  1 Seefor example Diamond and Mirrlees (1978); Farhi and Werning (2008b); Golosov, Kocherlakota, and
Tsyvinski (2003); Golosov, Tsyvinski, and Werning (2006); Albanesi and Sleet (2006).


                                                 2
We find it useful to work in both discrete and continuous time (and relate the two by
limiting arguments).
    Our theoretical results are summarized by a novel formula for the dynamics of the
labor wedge τL,t . Although we derive the formula for a general stochastic process for
productivity, it is most easily explained in the case where the logarithm of productivity
follows an AR(1) with coefficient of mean-reversion ρ:

                              log θt+1 = ρ log θt + (1 − ρ) log θ̄ + ε t+1 .

We require utility to be additively separable between consumption and labor and an isoe-
lastic disutility function for labor. We then obtain

                            1                       1         1                        1
                                                                                           
               τL,t+1                     τL,t
    Et                               =ρ                   +     + 1 Covt log θt+1 , 0             .
             1 − τL,t+1 u0 (ct+1 )      1 − τL,t u0 (ct )     e                    u ( c t +1 )

The first term captures mean-reversion and is simply the past labor wedge weighted by
the coefficient of mean-reversion ρ in productivity. In this sense, the labor wedge inherits
its degree of mean reversion from the stochastic process for productivity. The second
term is zero if productivity or consumption are predictable. In this case, if ρ = 1, the
formula specializes to a case of perfect tax-smoothing: the labor wedge remains constant
between periods t and t + 1. If instead ρ < 1, then the labor wedge reverts to zero at rate
ρ. When productivity and consumption are not predictable and are positively correlated,
the second term on the right hand side is positive, contributing to higher average taxes.
Intuitively, uncertainty in consumption creates a role for insurance, delivered by larger
taxes. The covariance captures the marginal benefit of more insurance. The marginal cost
depends on the elasticity of labor, which explains the role of the Frisch elasticity e.
    We also show that there is a sense in which our conditional expectation formula accu-
rately describes the realized path. To do so, we consider a continuous time limit where
productivity is a Brownian diffusion: d log θt = −(1 − ρ)(log θt − log θ̄ )dt + σt dWt , so that
ρ controls the degree of mean reversion as above. We study this continuous time model
directly and also approach it by taking the limit in the discrete time model. We show that

                                      1                    1
                                                                 
                                              τL,t+τ
                                 lim Vart                           = 0.
                                 τ ↓0 τ     1 − τL,t+τ u0 (ct+τ )

                                                                                             τt     1
Thus, the conditional expectation above completely describes changes in                     1−τt u0 (ct )   over
small intervals of time. In the limit, the process          { 1−τLτL u01(c) }   is a diffusion that has no
instantaneous volatility (it is of bounded variation):


                                                    3
                    1                                1                1                            1
                                                                                                  
          τL,t                             τ
d                              = −(1 − ρ) L,t             +             + 1 Covt d log θt , d                dt.
        1 − τL,t u (ct )
                  0                      1 − τL,t u (ct )
                                                   0                  e                         u0 (ct )

The drift in the continuous time is essentially the counterpart of our conditional expec-
tation formula. Thus, this equation states that there are no errors around the conditional
expectation. Of course, this does not mean that the entire process for { 1−τLτL u01(c) } is de-
terministic, since the drift itself may vary stochastically. It does imply that over short
                  τ         1
                    τL,t u0 (ct ) varies a lot less than productivity θt .
periods of time 1−L,t
    Economically, this result is important because it describes a form of regressivity. When
productivity rises, consumption rises, so the marginal utility of consumption falls. The
labor wedge must then fall by the same amount, at least in the short run. This induces
a negative short-run relation between productivity and the labor wedge. This force for
regressive taxation is novel and due to the dynamic aspects of our model.
    Finally, we extend the well-known zero taxation result at the top and bottom of the
productivity distribution.2 If the conditional distribution for productivity has a fixed sup-
port, then the labor wedge is zero at both extremes, just as in the static Mirrlees model.
However, in our dynamic model, a moving support may be more natural, with the top
and bottom, θ t (θt−1 ) and θ t (θt−1 ), being functions of the previous period’s productiv-
ity, θt−1 . With a moving support, we establish that the labor wedge is no longer zero
at the top and bottom. An interesting example is when productivity is a geometric ran-
dom walk, and innovations have a bounded support, the extremes θ t (θt−1 ) and θ t (θt−1 )
move proportionally with θt−1 . In this case, the labor wedge at the top must be below
the previous period’s labor wedge. The reverse is true at the bottom: the labor wedge
must be higher than in the previous period. This result is consistent with the short-run
regressivity discussed in the previous paragraph. Note, however, that no limit argument
is required.
    For our numerical exploration, we adopt a random walk for productivity. This choice
is motivated by two considerations. First, the evidence in Storesletten, Telmer, and Yaron
(2004) points to a near random walk for labor earnings, which requires a near random
walk for productivity. Second, by focusing on a random walk we are considering the
opposite end of the spectrum of the well explored i.i.d. case (Albanesi and Sleet, 2006).
    Our findings both serve to illustrate our theoretical results and provide novel insights.
Indeed, although our numerical work is based the discrete time version of the model, with
a period modeled as a year, the simulations show that the continuous time provides an
    2 The   result at the bottom requires labor to be positive.


                                                          4
excellent explanations of our findings.
    We find that the average labor wedge starts near zero and increases over time, asymp-
toting to around 40% precisely at retirement. The intertemporal wedge displays the op-
posite pattern, with its average starting around 0.9%, corresponding to a 17% tax on net
interest, and falling to zero at retirement. Both results are easily explained by our theoret-
ical formula. As retirement approaches the variance of consumption growth falls to zero,
for standard consumption smoothing reasons. Our formulas then indicate that the labor
wedge will rise over time and asymptote at retirement and that the intertemporal wedge
will reach zero at retirement.
    Our tax system comes out to be slightly regressive in the sense that marginal tax rates
are higher for agents with currently low productivity shocks. Our short-run regressivity
result seems to explain at least part of this regressivity. However, it should be noted
that the tax system is progressive in the sense that average tax rates are increasing in
productivity.
    The second-best allocation we have characterized can be implemented with taxes, but,
as is well known, it requires relatively elaborate, history-dependent tax instruments. We
wish to investigate how our results translate to simpler systems, restricted to being his-
tory independent. Do our theoretical results provide guidance for such real-world tax
systems? We find that they do: the second best turns out to be unexpectedly informative
in the design of simpler policies.
    Specifically, we compute the equilibrium with history-independent linear taxes on la-
bor and capital income, and consider both age-dependent and age-independent taxes.
When age-dependent taxes are allowed, we set the tax rate on labor or capital at a given
age equal to the average for that given age of the corresponding wedge in the simu-
lated second best. Surprisingly, the welfare loss of such a system, relative to the second
best, is minuscule—around 0.1% of lifetime consumption. By implication, the pattern
of tax rate we chose must be very close to optimal. In this way, our theoretical results
do provide guidance for more restrictive tax systems. When we solve the model with
age-independent tax rates, we optimize over the value of these tax rates. The results are
as follows. First, we find a more significant loss in welfare, of around 0.7% of lifetime
consumption. Age dependent tax rates are important in approaching the second best.
Second, when taxes are age independent, the optimal tax rate on capital comes out to be
essentially zero. This can be explained by the fact that a subsidy on capital helps imitate
the missing age-dependent taxes on labor. This new effect cancels the desire for a positive
tax on capital, obtained when more sophisticated taxes are allowed.



                                              5
Related literature. Our paper contributes to the is the optimal taxation literature based
on models with private information (see Golosov, Tsyvinski, and Werning, 2006, and the
references therein). The case where shocks are i.i.d. has been extensively studied [see for
example Albanesi and Sleet (2006) and more recently Ales and Maziero (2009)]. Outside
of the i.i.d. case few undertake a quantitative analysis. Persistent shocks significantly
complicate the analysis. As emphasized by Fernandes and Phelan (2000), the efficient
allocations have a recursive structure, but the dimensionality of the state is proportional
to the number of possible shock values, severely limiting the possibilities for realistic
numerical analyses.34
    This paper continues our efforts to quantify dynamic Mirrleesian models using more
realistic assumptions about uncertainty. In Farhi and Werning (2008a) and Farhi and
Werning (2009), our strategy was to focus on the welfare gains from savings distortions.
We presented a simple method to do so, which allowed us to consider rich stochastic pro-
cesses and was tractable enough to apply in general equilibrium settings, which proved
to be important. However, these papers do not attempt anything regarding labor wedges,
which are the main focus of the present paper.
    Versions of the first-order approach on which we rely in this paper have been stud-
ied in other papers. Werning (2002) introduced this approach in a moral-hazard setting
with unobservable savings to study optimal unemployment insurance with free-savings.
Pavan, Segal, and Toikka (2009) characterize necessary and sufficient conditions for the
first-order approach in very general dynamic environment. Williams (2008) studies a
continuous-time economy with hidden income that follows a Brownian motion. Garrett
and Pavan (2010) use a first-order approach to study managerial compensation. Kapicka
(2008) spells out the first-order approach for a general Mirrleesian setting with persistent
productivity shocks. He also simulates a simple example to illustrate the approach.5
    Fukushima (2010) performs a numerical study of an overlapping generations econ-
omy, where each generation looks much like the ones in our model. He considers a special
class of Markov chains with two discrete shocks that allow for a low dimensional repre-
sentation of the state space. For a planning problem that seeks to maximize steady-state
utility, he reports substantial welfare gains of the optimal tax system over a system com-
bining a flat tax and an exemption. Golosov, Troshkin, and Tsyvinski (2010) use a first-
   3 Two   exceptions are Golosov and Tsyvinski (2006) for disability insurance and Shimer and Werning
(2008) for unemployment insurance. In both cases, the nature of the stochastic process for shocks allows for
a low dimensional recursive formulation that is numerically tractable.
    4 See also Battaglini and Coate (2008). See as well Tchistyi (2006) and Battaglini (2005) for applications in

a non-taxation context.
    5 See also Abraham and Pavoni (2008) and Jarque (2008).




                                                       6
order approach to study a life-cycle economy with two periods and persistent shocks.
The goal of their paper is to calibrate the distribution of shocks in both periods using the
observed distribution of incomes, as Saez (2001) did for a single period in a static setting.6
     An important implication of our results is that with persistent productivity shocks,
labor taxes should on average increase with age. Our theoretical formula provides the
underpinnings for this observation as well as insights into its origin; our numerical simu-
lation explores its quantitative importance. This aspect of our contribution connects with
a prior contributions focusing on the benefits of age-dependent taxes.7 Most closely re-
lated to our paper are Kremer (2002) and Weinzierl (2008). Kremer (2002) emphasized
the potential benefits of age-dependent labor taxation, noting that the wage distribution
is likely to become more dispersed with age and conjectured that labor taxes should gen-
erally rise depend on age. Weinzierl (2008) provides a more comprehensive treatment.
He calibrates two- and three-period Mirrlees models. Like us, he finds important welfare
gains from age dependent taxes.


2     The Insurance Problem
This section first describes the economic environment and its planning problem. We then
explain our first order approach to solving this problem.


2.1     The Environment and Planning Problem
Preferences, Uncertainty and Information. The economy is populated by a continuum
of agents who live for T periods. Their ex ante utility is

                                               T
                                         E0   ∑ β t −1 u t ( c t , y t ; θ t ).
                                              t =1


Here ct represents consumption, yt represents efficiency units of labor, and θt ∈ Θ = [θ, θ̄ ]
is a state variable with conditional density f t (θt |θt−1 ). This state affects preferences over
consumption and labor in efficiency units and can capture both taste and productivity
fluctuations. In particular, an important case is when ut (c, y; θ ) = ũt (c, y/θ ), for some
    6 Both Kapicka (2008) and Golosov, Troshkin, and Tsyvinski (2010) rely on exponential utility and special
shock specifications to make the problem tractable, by reducing the number of state variables.
   7 Erosa and Gervais (2002) analyze age-dependent linear labor taxation in Ramsey setting. In their model,

optimal linear labor income taxes are indexed on age because the elasticity of labor supply varies, endoge-
nously, with age.



                                                          7
utility function ũt (c, n), defined over consumption and labor effort; then y = θn and θ
can be interpreted as productivity.
     We allow the utility function and the density to depend on the period t to be able to
incorporate life-cycle considerations. For example, an economy where agents work for TE
periods and then retire for TR periods can be captured by setting ũ(c, y/θ ) for t ≤ TE and
ũ(c, 0) for TE < t ≤ T.
     We make several smoothness assumptions. The utility function is twice continuously
differentiable and the density is continuously differentiable in its second argument. To
simplify the exposition, we start with the full support assumption that f t (θ 0 |θ ) > 0 for all
θ, θ 0 ∈ Θ.
     The realization of the state θt for all t = 1, 2, ..., T is privately observed by the agent. To
simplify and focus on the insurance motive, we assume that the initial state θ−1 is publicly
known. It is easy to introduce initial heterogeneity and private information with respect
to θ−1 , together with a redistributive motive.
     More explicitly, an allocation is {c, y} ≡ {c(θ t ), y(θ t )} and utility is

                T            ˆ
U ({c, y}) ≡   ∑β     t −1
                                 ut (c(θ t ), y(θ t ); θt ) f t (θt |θt−1 ) f t−1 (θt−1 |θt−2 ) · · · f 1 (θ1 |θ0 )dθt dθt−1 · · · dθ1
               t =1


Incentive Compatibility. By the revelation principle, without loss of generality, we can
focus on direct mechanisms, where agents make reports rt ∈ Θ regarding θt . For any
reporting strategy σ = {σt (θ t )} we have a history of reports σt (θ t ) = (σ1 (θ0 ), . . . , σt (θ t ))
and a corresponding path {cσ , yσ } = {c(σt (θ t )), y(σt (θ t )}. Let Σ denote the set of all
reporting strategies σ.
   An allocation {c, y} is incentive compatible if and only if

                                     U ({c, y}) ≥ U ({cσ , yσ })              ∀σ ∈ Σ,

so that truth telling σ∗ = {σt∗ (θ t )} with σt∗ (θt ) = θt , is optimal.


Planning Problem.       To keep things simple, we work in partial equilibrium, that is,
assuming a linear technology that converts labor into consumption goods one for one
and a linear storage technology with gross rate of return q−1 (and a net rate of return
equal to q−1 − 1). This allows us to study the contracting problem for a single cohort in




                                                              8
isolation. The relevant cost of an allocation is then its expected net present value:

                             T                   ˆ
          Ψ({c, y}) ≡       ∑q          t −1
                                                     (c(θ t ) − y(θ t )) f t (θt |θt−1 ) · · · f 1 (θ1 |θ0 )dθt · · · dθ1 .
                            t =1

An allocation {c∗ , y∗ } is efficient if there is no other incentive compatible allocation {c, y}
with U ({c, y}) ≥ U ({c∗ , y∗ }) and Ψ({c, y}) ≤ Ψ({c∗ , y∗ }), with at least one strict in-
equality. Efficient allocations solve the following program.
Program IC.

                            K0 (v) ≡ min Ψ({c, y})
                                                 {c,y}

                                                 s.t. U ({c, y}) ≥ v
                                                         U ({c, y}) ≥ U ({cσ , yσ })             ∀σ ∈ Σ


2.2   A Recursive First-Order Approach
In this section, we lay down our first-order approach, and explain how it leads to a relaxed
version of Program IC. Previous papers using a similar approach include Werning (2002),
Kapicka (2008), Williams (2008), and Pavan, Segal, and Toikka (2009).
    Let w(θ t ) denote the equilibrium continuation utility after history θ t . That is, w is the
unique solution solution to
                                                                       ˆ
                    t           t            t
               w ( θ ) = u ( c ( θ ), y ( θ ), θ t ) + β t
                                                                               w(θ t , θt+1 ) f t+1 (θt+1 |θt )dθt+1          (1)


for all t = 1, . . . , T with w(θ T +1 ) ≡ 0. Incentive compatibility can be represented with
this notation as follows. For any strategy σ ∈ Σ, let continuation utility wσ (θ t ) solve
                                                                                ˆ
           σ   t        t           t    t
         w (θ ) = u (c(σ (θ )), y(σ (θ )), θt ) + β      t   t
                                                                                    wσ (θ t , θt+1 ) f t+1 (θt+1 |θt )dθt+1


with wσ (θ T +1 ) ≡ 0. Then incentive compatibility is equivalent to
                            ˆ                                              ˆ
                                                     1
                                    w(θ1 ) f (θ1 |θ0 )dθ1 ≥                     wσ (θ1 ) f 1 (θ1 |θ0 )dθ1

for all σ ∈ Σ. This condition requires

                                                             w(θ t ) ≥ wσ (θ t )


                                                                      9
for almost all θ t .


A Necessary Condition.      We now use this representation to sketch a derivation of a
necessary condition for incentive compatibility. We omit the full details of the argument
which have been derived by Pavan, Segal, and Toikka (2009).
   For any incentive compatible allocation, consider the following one-shot deviation
from truth telling:

                                                   σs (θ s ) = θs                 θ s 6= θ t
                                                   σt (θ t ) = r

Thus, the agent reports truthfully until θ t , then reports r and reverts back to truth telling
thereafter. Denote this strategy by σr . Continuation utility solves
                                                                                      ˆ
                                   t −1                   t −1
              r    t
             w (θ ) = u (c(θ  t
                                           , r ), y ( θ          , r ), θ t ) + β          wr (θ t+1 ) f t+1 (θt+1 |θt )dθt+1

Since truth telling is employed from t + 1 onwards we have that

                                               wr (θ t+1 ) = w(θ t−1 , r, θt+1 ).

Incentive compatibility requires

                                                        w(θ t ) = max wr (θ t ).
                                                                          r

Putting the three conditions together yields
                                                                                  ˆ
                                  t −1                  t −1
         t
    w(θ ) = max{u (c(θ    t
                                         , r ), y ( θ          , r ), θ t ) + β           w(θ t−1 , r, θt+1 ) f t+1 (θt+1 |θt )dθt+1 }
                   r


Differentiating and applying an envelope condition implies:
                                                                              ˆ
                   ∂
                      w(θ t ) = utθ (c(θ t ), y(θ t ), θt ) + β                       w(θ t+1 ) f θtt+1 (θt+1 |θt )dθt+1                 (2)
                  ∂θt

Equations (1)–(2) provide a set of necessary conditions for an allocation to be incentive
compatible. Pavan, Segal, and Toikka (2009) derive these conditions rigorously in a more
general setting.




                                                                        10
   It will be useful to collect these conditions and rewrite them as

                                          w(θ t ) = ut ( x (θ t ), θt ) + βv(θ t )
                                    ∂
                                       w(θ t ) = utθ ( x (θ t )), θt ) + β∆(θ t )
                                   ∂θt

where
                                               ˆ
                                      t
                                 v(θ ) ≡           w(θ t+1 ) f t+1 (θt+1 |θt )dθt+1
                                               ˆ
                                      t
                                 ∆(θ ) ≡           w(θ t+1 ) f θtt+1 (θt+1 |θt )dθt+1


The Relaxed Planning Problem. Define C t (y, u, θ ) denote the expenditure function—
the inverse of the utility function for consumption ut (·, y, θ ). Let K denote the minimized
cost for the relaxed program that only imposes the necessary conditions derived above.
This function satisfies the following Bellman equation:
Program FOA.
                           ˆ
  K (v, ∆, θ− , t) = min       {C t (y(θ ), w(θ ) − βv(θ ), θ ) − y(θ )
                                                 ˆ
                                            + q K (v(θ ), ∆(θ ), θ 0 , t + 1) f t+1 (θ 0 |θ )dθ } f t (θ |θ− )dθ


                                                   ˆ
                                             v=        w(θ ) f t (θ |θ− )dθ
                                                   ˆ
                                            ∆=         w(θ ) f θt− (θ |θ− )dθ



                   ẇ(θ ) = utθ (C t (y(θ ), w(θ ) − βv(θ ), θ ), y(θ ), θ ) + β∆(θ )


Verifying IC. Suppose that a solution to Program FOA has been computed. Then it is
a solution to Program IC if and only if the proposed allocation is incentive compatible.
One approach is to seek sufficient conditions on primitives that a priori guarantee that
this will be the case. A practical alternative, is to verify the incentive compatibility of any
candidate optimum. It turns out that doing so is relatively straightforward.
    The solution to Program FOA yields policy functions that determine the allocation




                                                           11
recursively as a function of reports as follows

                                                  c t = g c ( v t , ∆ t , r t −1 , r t , t )
                                                  y t = g y ( v t , ∆ t , r t −1 , r t , t )
                                              v t +1 = g v ( v t , ∆ t , r t −1 , r t , t )
                                              ∆ t +1 = g ∆ ( v t , ∆ t , r t −1 , r t , t )

An agent takes these functions as a constraints in his optimal reporting problem, repre-
sented by the Bellman equation:

  V (v, ∆, r− , θ, t) = max{ut ( gc (v, ∆, r− , r, t), gy (v, ∆, r− , r, t), θ )
                         r
                            ˆ
                         + β V ( gv (v, ∆, r− , r, t), g∆ (v, ∆, r− , r, t), r, θ 0 , t + 1) f t+1 (θ 0 |θ )dθ 0 }

Let

gw (vt , ∆t , rt−1 , rt , t) = ut ( gc (vt , ∆t , rt−1 , rt , t), gy (vt , ∆t , rt−1 , rt , t), rt ) + βgv (vt , ∆t , rt−1 , rt , t)

represent the optimal value of w in the planning problem given states (vt , ∆t , rt−1 , rt t).
The proposed allocation is incentive compatible if and only if

                                         V (v, ∆, r− , θ, t) = gw (v, ∆, r− , θ, t)

Plugging this condition into into the Bellman equation we obtain



  θ ∈ arg max{ut ( gc (v, ∆, r− , r, t), gy (v, ∆, r− , r, t), θ )
           r
                          ˆ
                    + β gw (θ 0 , gv (v, ∆, r− , r, t), g∆ (v, ∆, r− , r, t), r, t + 1) f t+1 (θ 0 |θ )dθ (3)

    Interestingly, because we have the guess for the agent’s value function, this verifica-
tion does not require solving a dynamic optimization problem.


Initial Heterogeneity. We have interpreted the planning problem as confronting a sin-
gle agent. However, it is simple to add heterogeneity to the analysis. Indeed, we can
interpret the first shock θ1 as initial heterogeneity—recall that we allow the conditional
density to depend flexibly on the period t. If the social welfare function is Utilitarian,


                                                                  12
then the analysis requires no change: insurance behind the veil of ignorance and utilitar-
ian redistribution are equivalent. It is also possible to allow for a different social welfare
function, or to characterize the entire set of constrained Pareto-efficient allocations, by
treating the initial period in the planning problem differently.


3     Optimalityx Conditions
Given an allocation {c, y} , and a history θ t , define the intertemporal wedge

                                              utc c θ t , y θ t , θt
                                                                   
                   t          q
                         = 1 − ´ t +1
                     
            τK θ
                              β uc (c (θ t+1 ) , y (θ t+1 ) , θt+1 ) f t+1 (θt+1 |θt ) dθt+1

and the labor wedge
                                                               uty c θ t , y θ t , θt
                                                                                
                                         t
                                                 ≡ 1+                                             .
                                             
                                  τL θ
                                                                utc (c (θ t ) , y (θ t ) , θt )
In this section, we characterize these wedges for allocations that solve Programs IC and
FOA.


3.1   A Positive Intertemporal Wedge
Our first result restates the well-known inverse Euler condition. This result requires util-
ity from consumption to be separable from the disutility of labor.

Assumption 1 For every t ≥ 0, the utility function ut (c, y, θ ) is separable so that there exists
functions ût and ĥt such that ut (c, y, θ ) = ût (c) − ĥt (y, θ ).

Proposition 1 Suppose that Assumption 1 holds and that {c, y} solves Program IC or Program
FOA. Then for every t ≥ 1 and history θ t−1 , the following Inverse Euler equation holds
                                                               ˆ
                                       1          q                           1
                                 1            1
                                                =                                      f t (θt |θt−1 ) dθt
                          û t −   0      t −
                                     (c (θ ))     β                  ût0   (c (θ t ))

and the intertemporal wedge satisfies
                                                 h´                        −1                          i −1
                                                        ût0     c    θt            ft   (θt |θt−1 ) dθt
                     τK (θ t−1 ) = 1 −                   ´                                                        .   (4)
                                                               ût0 (c (θ t )) f t (θt |θt−1 ) dθt

  Note that this result holds for any allocation that solves both Program IC or Program
FOA and for any stochastic process for idiosyncratic shocks {θ }. Applying Jensen’s in-

                                                                     13
equality to the second equation implies that the intertemporal wedge τK θ t−1 is positive.
                                                                              

In other words, positive savings distortions are present at the constrained optimum.


3.2    Labor Wedge Dynamics: Tax Smoothing and Mean Reversion
We now seek an optimality condition for the labor wedge. The following isoelastic as-
sumption is useful for this purpose. It has been used to prove perfect tax-smoothing
results by Werning (2007a).

Assumption 2 Assumption 1 holds and the disutility of work is isoelastic ĥt (y, θ ) = (κ/α) (y/θ )α
with κ > 0 and α > 1.

   For any function Π, define
                                                    ˆ
                               φtΠ   ( θ t −1 ) ≡       Π (θt ) f t (θt |θt−1 ) dθt .

We then have the following proposition.

Proposition 2 Suppose that Assumptions 1 and 2 hold, and that {c, y} solves Program FOA.
Consider a function π (θ ) and let Π (θ ) be a primitive of π (θ ) /θ. Then the labor wedge satisfies
the following equation for every t ≥ 1 and history θ t−1

  ˆ
      τL θ t      q ût−10 c θ t−1
                                    
                                        π (θt ) f t (θt |θt−1 ) dθt
    1 − τL (θ t ) β ût0 (c (θ t ))
                                           ˆ
     τL θ t−1             dφtΠ (θt−1 )                     q ût−10 c θ t−1
                                                        "                       #
 =                 θ t −1              + α Π (θt )                              − 1 f t (θt |θt−1 ) dθt . (5)
   1 − τL (θ t−1 )           dθt−1                         β ût0 (c (θ t ))


   nThe fact that
             o equation (5) holds for all possible π (θt ) imposes restrictions on the stochas-
      τL 1
tic 1−τL ût0 . We shall come back to this point later, especially in its continuous time
counterpart. For now, the case where π (θ ) = 1 and Π (θ ) = log (θ ) is of particular
interest.

Corollary 1 Suppose that Assumptions 1 and 2 hold, and that {c, y} solves Program FOA. Then




                                                          14
the labor wedge satisfies the following equation for every t ≥ 1 and history θ t−1

  ˆ
       τL θ t      q ût−10 c θ t−1
                                    
                                        f t (θt |θt−1 ) dθt
     1 − τL (θ t ) β ût0 (c (θ t ))
                             log              ˆ
      τL θ t−1                                                q ût−10 c θ t−1
                                                           "                       #
                           dφt (θt−1 )
  =                 θ t −1               + α log (θt )                             − 1 f t (θt |θt−1 ) dθt .
    1 − τL (θ t−1 )           dθt−1                           β ût0 (c (θ t ))
                                                                                                           (6)

                                            log
   To understand the role of θt−1 dφt              (θt−1 ) /dθt−1 in equation (6), consider the general-
ized geometric AR(1) process:

                                    log (θt ) = ρ log (θt−1 ) + θ̄t + ε t ,

where {θ̄t } is a deterministic sequence for the unconditional mean of θt , and ε t are inde-
                                                                       ´
pendent draws from a distribution gt (ε t , θ t−1 ), normalized so that ε t gt (ε t , θ t−1 )dε t = 0.
      log
Then φt (θt−1 ) = ρ log (θt−1 ) + θ̄t so that

                                                     log
                                                   dφt     ( θ t −1 )
                                          θ t −1                        = ρ.
                                                         dθt−1

For this AR(1) specification, equation (6) can be written more compactly as

                    τL,t q ût−10 (ct−1 )                                     q ût−10 (ct−1 )
                                                                                            
                                                 τL,t−1
      Et −1                                 =ρ            + αCovt−1 log(θt ),                              (7)
                  1 − τL,t β ût0 (ct )        1 − τL,t−1                     β ût0 (ct )

Proposition 1 implies that
                                                   q ût−10 (ct−1 )
                                                                   
                                       Et −1                          =1
                                                   β ût0 (ct )
so the term (q/β) ût−10 (ct−1 ) /ût0 (ct ) on the left hand side of equation (7) represents a
change of measure.
    Thus, we have a formula for the conditional expectation of τL,t /(1 − τL,t ) under a risk-
adjusted probability measure. On the right hand side, τL,t−1 /(1 − τL,t−1 ) is weighted by
the coefficient of mean-reversion ρ. In this sense, {τL /(1 − τL )} inherits its degree of
mean reversion from the stochastic process for productivity. The second term provides a
drift for {τL /(1 − τL )}.
    It is useful to first consider the special cases where the drift is zero, which occurs when
consumption at t is predictable at t − 1, so that Vart−1 (ct ) = 0. This would be the case if
the productivity level θt were predictable at t − 1, so that Vart−1 (θt ) = 0. In this case, if


                                                           15
ρ = 1 equation (7) implies that the labor wedge remains constant between periods t − 1
and t, a form of perfect tax-smoothing. When ρ < 1 the labor wedge reverts to zero at
rate ρ.8
    The drift is positive whenever Vart−1 (θt ) > 0 provided that consumption is increasing
in productivity. Compared to the case with Vart−1 (θt ) = 0, the additional shocks to
productivity create an additional motive for insurance. This pushes the labor wedge up.
Interestingly, the size of the drift is precisely the covariance of the log of productivity
with the inverse growth rate in marginal utility, divided by 1/α = e/(1 + e), where
e is the Frisch elasticity of labor supply. The covariance captures the benefit of added
insurance, since it depends on the variability of consumption as well as on the degree
of risk aversion. Insurance comes at the cost of lower incentives for work. This effect is
stronger the more elastic is labor supply, explaining the role of the Frisch elasticity.
    Returning to the more general statement in Proposition 2, equation (5) shares many
ingredients with equation (6). Note however that, in general,
                              ˆ
                                  q ût−10 c θ t−1
                                                      
                                                           π (θt ) f t (θt |θt−1 ) dθt
                                  β ût0 (c (θ t ))

will not equal one, so that by contrast with equation (6), the right-hand side cannot be
interpreted as a risk-adjusted conditional expectation of the labor wedge in period t. An-
other important case is π (θt ) = ( β/q)ût0 c θ t /ût−10 c θ t−1 , so that equation (5)
                                                                 

provides a formula for the unadjusted conditional expectation for τL,t /(1 − τL,t ). The
corresponding expression is somewhat more involved than equations (6) and (7). Rather
than develop the expression here, we present its neater continuous time counterpart in
Section 4.
    Equations (5) and (6) hold for any allocation that solves Program FOA. They do not
necessarily hold for an allocation that solves Program IC when the two programs do not
coincide. Nevertheless, we are able to show that Proposition 2 applies with a particular
function π to any allocation that solves Program IC under the following assumption.

Assumption 3 The process {θ } is a geometric random walk. That is, the growth rate θt /θt−1 is
independent of the history θ t−1 .

   8 These   special cases are consistent with the results in Werning (2007a), who studied a model where
agent’s private types are fixed (similar to Vart−1 (θt ) = 0 here). Productivity may still vary for each type,
due to changes in inequality or aggregate shocks. At the optimum, the tax rate is constant with respect
to aggregate shocks to productivity, but is an increasing function of the current degree of inequality. This
relates to the analysis here, since when ρ < 1 and Vart−1 (θt ) = 0 we have a decreasing pattern for inequality
and the tax rate.


                                                       16
Proposition 3 Suppose that Assumptions 1, 2, and 3 hold, and that {c, y} solves Program IC.
Then the labor wedge satisfies equation (5) for every t ≥ 1 and history θ t−1 with π (θ ) = θ −α .


3.3    Labor Wedge at the Top and Bottom
We now look at the labor wedge for the two extreme realizations of θt , top and bottom.
As we shall see, when the support for current productivity is independent of previous
productivity then standard zero-distortion results apply. However, it is important to con-
sider the more general case of a moving support, where the upper and lower bounds,
θ t (θt−1 ) and θ t (θt−1 ) vary with θt−1 . We assume θ t (θt−1 ) and θ t (θt−1 ) are differentiable.
For short, we often simply write θ t and θ t leaving the dependence on θt−1 implicit.
     The only modification to Program FOA is that ∆ now incorporates two terms to cap-
ture the movements in the support:

           ˆ    θ t (θ− )
                                                          dθ t                     dθ t
      ∆=                    w (θ ) f θt− (θ, θ− ) dθ +         w θ t f t θ t |θ− −      w (θ t ) f t (θ t |θ− ) .
                                                                               
               θ t (θ− )                                  dθ−                      dθ−

Propositions 1, 2 and 3 extend without modification to the case of moving support.

Proposition 4 Consider an interior allocation that solves Program FOA:

   i. if for a history θ t−1 , dθ t /dθt−1 = dθ t /dθt−1 = 0, then

                                             τL θ t−1 , θ t            τL θ t−1 , θ t
                                                                                     
                                                                  =                       = 0;
                                        1 − τL      θ t −1 , θ t     1 − τL (θ t−1 , θ t )


   ii. suppose that Assumptions 1 and 2 hold, then for every history θ t−1

                            τL θ t−1 , θ t       τL θ t−1      β ût0 c θ t−1 , θ t θ− dθ t
                                                                                 
                                           =                                                  ,
                       1 − τL θ t−1 , θ t      1 − τL (θ t−1 ) q ût−10 (c (θ t−1 )) θ t dθt−1
                         τL θ t−1 , θ t          τL θ t−1      β ût0 c θ t−1 , θ t θ− dθ t
                                                                                 
                                             =                                                 .
                       1 − τL (θ t−1 , θ t )   1 − τL (θ t−1 ) q ût−10 (c (θ t−1 )) θ t dθt−1

    With a fixed support, the no-distortion results from the static model extend to our dy-
namic setting. However, when the support is not fixed the labor wedge after an extreme
realization is the product of the labor wedge in the previous period times the growth
rate of marginal utility, and the elasticity of the corresponding bound of the support with
respect to θt−1 . For example, in the case where {θ } is a geometric random walk with
bounded innovations, the elasticity of the bounds with respect to θt−1 is equal to one.

                                                                  17
In this case, provided that consumption c(θ t−1 , θt ) is increasing in θt , the Inverse Euler
equation implies: τL θ t−1 , θ t ≤ τL θ t−1 ≤ τL θ t−1 , θ t . The fact that the tax rate may
                                                          

go both up or down illustrates a form of tax smoothing.


3.4   A Regressivity Result
In Section 4, we develop a continuous time formulation of Program FOA when the stochas-
tic process for productivity follows a Brownian diffusion, and we use continuous time
stochastic control to analyze this program. In this section, instead, we perform an anal-
ysis in discrete time, but taking the limit as the period length shrinks to zero. We show
that, in the limit, the quantity (1/ût0 (ct ))(τL,t /(1 − τL,t )) does not vary unpredictably,
in response to productivity shocks. In this sense, the conditional expectation formula in
equation (6) provides a very accurate prediction for this variable over short intervals of
time.
    Let τ be the length of a period. Instead of indexing periods by t = 1, 2, 3 . . . we now
take t = τ, 2τ, 3τ, . . . We assume that θt+τ is log normally distributed so that

                                                                 log
                              log θt+τ ∼ N (log θt + µt (θt ), σt2 )                          (8)

We set the parameters of our model to scale as follows with τ:

                                                                      1 2               √
                                                                            
                    −ρτ           −ρτ        log
              β=e         , q=e         ,   µt (θt )   = τ µ̂t (θt ) − θt σ̂t , σt = σ̂t τ    (9)
                                                                      2

for some constants ρ > 0, some function of time and productivity µ̂t (θt ) and some func-
tion of time σ̂t . To simplify, we assume here that q = β.
                                 log
     The definition for µt contains an adjustment term −τ 21 θt σ̂t2 to ensure that Et [θt+τ ] =
θt eτ µ̂t (θt ) . Thus, µ̂t (θt ) can be interpreted as the (instantaneous) conditional expected
growth rate in productivity, per unit of time. In the limit as τ → 0, it is well known
that there exists a Brownian motion Wt such that the stochastic process {θ } converges to
the continuous time diffusion dθt /θt = µ̂t (θt ) dθt + σ̂t dWt . This is the limit that we study
directly in Section 4.

Assumption 4 The stochastic process {θ } satisfies (8)–(9).

Proposition 5 Suppose that Assumptions 1, 2, and 4 hold, and that {c, y} solves Program FOA.




                                                        18
Then for every t and history θ t , then, conditional (on θ t )
                                                                                  !
                                        τL θ t , θt+τ                1
                                                      
                             ∂
                      plim                                                          = 0,
                      τ →0 ∂θt+τ      1 − τL (θ t , θt+τ ) ût0 (c (θ t , θt+τ ))

where plimτ →0 denotes the probability limit (conditional on θ t ).

                                                                                             τ     1
   For short period lengths, this result implies that the unpredictable changes in 1−L,t τL,t ût0 (ct )
are small
       h relative to ithose in θt . As a result, the conditional variance per unit of time
1         τL,t+τ     1
τ Vart 1−τL,t+τ u0 (ct+τ ) is small and vanishes as τ → 0. Another implication is that unpre-
dictable changes in τL,t /(1 − τL,t ) must mirror those in the marginal utility ût0 (ct ). This
induces a negative conditional covariance between productivity and the labor wedge.
Economically, this represents a form of regressivity: good productivity shocks lower both
the marginal utility of consumption and the current labor wedge by the same amount, at
least in the short run.
   To make this result more palatable, note that

                           τL θ t          1           1
                                  
                                                                  θt
                                                 = t0        −  t .
                         1 − τL (θ ) û (c (θ ))
                                    t  t 0   t            t
                                                  û (c (θ )) ĥ0 y(θ )
                                                                   θt


The first-best allocation has both terms, 1/ût0 (ct ) and θt /ĥ0 (yt /θt ), constant over time.
This is not possible at the constrained-efficient allocation. However, although 1/ût0 (ct ) is
not constant, the Inverse Euler equation implies that its changes are unpredictable. Some-
what intuitively, our result implies that changes in θt / ĥ0 (yt /θt ) should track changes in
1/ût0 (ct ) in an attempt to stabilize the difference.
      Why should this be the case? Consider an allocation {c, y} that satisfies the constraints
of Program FOA, a history θ t , and two numbers ε and ε. Consider the following perturbed
allocation cδ,τ , yδ,τ , which differs from the original allocation {c, y} only at histories
               
             √                  √ 
 θ t , θt + ε τ and θ t , θt + ε τ :


                                    √                   √        √ α
                 ĥ yδ,τ θ t , θt + ε τ = ĥ y θ t , θt + ε τ − θt + ε τ δ,
                  t
                    
                      δ,τ
                                     √                   √ 
                û c      θ , θt + ε τ = ût c θ t , θt + ε τ − δ,
                           t




                                                    19
and
                 
                     δ,τ
                                       √                   √      √ α
                ĥ y       θ , θt + ε τ = ĥ y θ t , θt + ε τ + θ + ε τ δ,
                            t
                                      √                    √ 
               ût cδ,τ    θ t , θt + ε τ = ût c θ t , θt + ε τ + δ.

The change in the cost of the allocation Ψ cδ,τ , yδ,τ − Ψ ({c, y}) from this perturba-
                                                         

tion is proportional to δ. Using the identity ût01(c) − 1 01 y = 1−τLτL ût01(c) , the constant of
                                                            θ ĥ   (θ)
proportionality can be expressed as
                  √                                               √ 
   τL θ t , θt + ε τ                1               τL θ t , θt + ε τ                1
                    √                     √   −                    √                     √  .
 1 − τL θ t , θt + ε τ ût0 c θ t , θt + ε τ      1 − τL θ t , θt + ε τ ût0 c θ t , θt + ε τ
                                                                      


If this perturbation were feasible, then we should set this expression to zero and conclude
that a stronger form of Proposition 5 holds.
    This argument is heuristic and incomplete, because the perturbed allocation {cδ,τ , yδ,τ }
is not feasible: it delivers the same utility as {c, y}, but does not preserve the local incen-
tive constraints of Program FOA. However, this basic perturbation can be modified to
preserve these constraints. The key to our result is that the corrections are of order τ,
                                                                   √             √
while the distance between the two productivity levels θt + ε τ and θt + ε τ at which
                                       √
we perturb the allocation is of order τ, so we obtain


                     √ 
      τL θ t , θt + ε τ          1
                      √  t0           √ 
    1 − τL θ , θt + ε τ û c θ , θt + ε τ
               t              t
                                                         √ 
                                          τL θ t , θt + ε τ          1
                                      =                   √  t0           √  + O(τ ),
                                        1 − τL θ , θt + ε τ û c θ , θt + ε τ
                                                   t              t


which implies our result. In addition to a proof based on optimal control, the appendix
contains a rigorous version of this more constructive perturbation argument, which pro-
vides a second proof to Proposition 5.


4     A Continuous Time Approach
In this section, we formulate Program FOA in continuous time and tackle this program
using continuous time stochastic control. We assume that the stochastic process for pro-




                                                20
ductivity is a Brownian diffusion with deterministic volatility:

                                         dθt
                                             = µ̂t (θt )dθt + σ̂t dWt                                      (10)
                                         θt

or equivalently that

                                                     log
                                     d log θt = µ̂t (θt )dθt + σ̂t dWt ,

where {W } is a Brownian motion, µ̂t is a function of current productivity θt which con-
trols the drift of productivity, σ̂t is deterministic function of time which determines the
                                     log
volatility of productivity, and µ̂t (θ− ) = µ̂t (θ− ) − 12 θ− σ̂t2 . We assume that the rate of
time preferences and the instantaneous interest rates are both equal to ρ > 0 (this can be
easily generalized to separate the two).
    To formulate Program FOA in continuous time, we need to determine the laws of
motions for ∆t and vt . Our approach here is to work with Assumption 4 and take the
continuous time limit of the discrete time model.9
                                          ´
    We start with ∆t . Integrate ∆t = wt+τ f θtt (θt+τ |θt ) dθt+τ by parts, using Lemma 2 in
the appendix, to obtain an expression for f θtt (θt+τ |θt ). Using µt (θt ) = τ (µ̂t (θt ) − 21 θt σ̂t2 )
we obtain
                  ˆ                                               log
                                                                      !
                                                             d µ̂
          θt ∆t =      θt+τ utθ+τ + e−ρτ θt+τ ∆t+τ 1 + θt τ t           f t (θt+τ |θt ) dθt+τ .
                                                 
                                                              dθt

This implies that in the continuous time limit, we can write

                                                 log
                                    "                  #
                                          dµ̂
                       d (θt ∆t ) = ρ − θt t               (θt ∆t ) − θt utθ + σ̃∆,t σ̂t θt dWt
                                           dθ

for some function σ̃∆,t of the state variables (vt , ∆t , θt , t). Applying Ito’s lemma, we infer
that {∆} solves the following stochastic differential equation:

                                               log
                          "                          !                         #
                                          dµ̂
                  d∆t =       ρ − µ̂t − θt t             ∆t − utθ − σ∆,t σ̂t dt + σt∆ σ̂t dWt ,            (11)
                                           dθ

where σ∆,t = σ̃∆,t − ∆t .
  Turning now to vt , note that the definition of vt as the net present value of utility
implies that {v} solves a differential equation of the form dvt = ρvt dt − ut dt + σv,t σt dWt
   9 It is also possible to start with the model in continuous time and derive the relevant first order approach

versions of the incentive constraints from scratch.


                                                           21
for some function σv,t of the state variables (vt , ∆t , θt , t). Finally, in the continuous time
limit, the constraint ẇ (θ ) = θutθ + βθ∆ (θ ) simply amounts to the requirement that the
sensitivity of continuation utility to productivity changes be σv,t = θt ∆t . Therefore, {v}
solves the following differential equation:

                                        dvt = ρvt dt − ut dt + θt ∆t σ̂t dWt .                              (12)

    Having re-expressed the constraints in Program FOA as stochastic differential equa-
tions for the state variables, we can now write down the Hamilton-Jacobi-Bellman (HJB)
equation for the cost function K (vt , ∆t , θt , t). The states are (vt , ∆t , θt , t) with laws of mo-
tion given by equations (12), (11), and (10). The controls are (ct , yt , σ∆,t ). The HJB equation
is
                                                                         log
                                                    h                 dµ̂                       i
  ρK = max            [ct − yt ] + Kv ρvt − ut + K∆ ρ − µ̂t − θt t ∆t − σ∆,t σ̂t − utθ
                                              
         ct ,yt ,σ∆,t                                                   dθ
                                  1              1              1                   1
           + Kθ θt µ̂t + Kt + Kvv θt2 ∆2t σ̂t2 + K∆∆ σ∆,t
                                                      2
                                                          σ̂t2 + Kvv θt2 ∆2t σ̂t2 + K∆∆ σ∆,t
                                                                                          2
                                                                                             σ̂t2
                                  2              2              2                   2
                                        1
                                                                                                        
                                               2 2                   2         2    2                 2
                                      + Kθθ θ σ̂t + Kv∆ θt ∆t σ∆,t σ̂t + Kvθ θt ∆t σθ + K∆θ θt σ∆,t σ̂t .
                                        2

    It will prove convenient to introduce the dual variables of (vt , ∆t ) : λ(vt , ∆t , θt , t) =
Kv (vt , ∆t , θt , t) and γ(vt , ∆t , θt , t) = K∆ (vt , ∆t , θt , t).

Proposition 6 Suppose that Assumptions 1 and 2 hold, and that productivity evolves according
to equation (10). Then:

   i. There exists a function σλ (vt , ∆t , θt , t) such that the stochastic processes for {λ} and {γ}
      verify the following stochastic differential equations

                         dλt
                             = σλ,t σ̂t dWt                                                                 (13)
                          λt
                                                                      log
                               "                                            !        #
                                                                  dµ̂
                         dγt = −θt λt σλ,t σ̂t2 +         µ̂t + θt t             γt dt + γt σ̂t dWt ,       (14)
                                                                   dθ

      with γ0 = 0.

   ii. Consumption ct and output yt can be computed as follows:

                     1                                               1                    θt           γt
                                 = λt             and                            −                 = −α .
                  ût0 (c   t)                                    ût0 (c   t)       ht0 (yt /θt )     θt


                                                         22
  iii. The labor and intertemporal wedges, τL,t and τK,t , can be computed as follows:

                              τL,t        γt 1                                                2 2
                                     = −α                         and                 τK,t = σλ,t σ̂t .
                            1 − τL,t      λt θt

    Part (i) may be used as follows. If the functions λ(vt , ∆t , θt , t) and γ(vt , ∆t , θt , t) can
be inverted for (vt , ∆t ), then an alternative state space is (λt , γt , θt , t). In this case, we can
write σλ (λt , γt , θt , t). Equations (13)–(14) then provide the evolution of these alternative
state variables. Part (ii) and (iii) then offer a way to compute the allocation and wedges
as a function of (λt , γt , θt , t).
    Combining parts (i) and (iii) leads to the following corollary.

Corollary 2 Suppose that Assumptions 1 and 2 hold, and that productivity evolves according to
equation 10. Then the labor wedge verifies the following stochastic differential equation

                                                                                      log
                                                  "                                       #
                                     τL,t                                  τL,t    dµ̂t
                            d λt                  = αλt σλ,t σ̂t2 + λt            θt            dt.           (15)
                                   1 − τL,t                              1 − τL,t    dθt

    This result is the continuous time extension n of Proposition
                                                          o        5. A bit more can be said
                                                      τL
here, because in continuous time the process λ 1−τL is a diffusion. The fact that it has
zero instantaneous volatility implies that the realized paths will vary much less than those
for productivity {θ }, in the sense that they are (a.s.) of bounded variation.
    Combining (5) with (15) and applying Ito’s lemma, yields the following formula:

                                                        log
                         "                                                 #
            τL,t                          τ        d µ̂       τ                      τL,t
  d                      = ασλ,t σ̂t2 +    L,t
                                                 θt t +
                                                               L,t    2 2
                                                                     σλ,t σ̂t dt −         σ σ̂t dWt . (16)
          1 − τL,t                      1 − τL,t     dθ     1 − τL,t               1 − τL,t λ,t

This is the continuous time counterpart of equation (5) with the particular weighting func-
tion π (θt ) = ( β/q)ût0 c θ t /ût−10 c θ t−1 .10 It describes the dynamics for { 1−τLτL }
                                                  

with the original, unadjusted probability. Unlike equation (5) which focuses on the con-
ditional expectation, this equation describes not only the drift, but also the volatility of
{ 1−τLτL }.
     The drift of { 1−τLτL } contains the elements discussed after Proposition 2 (the covariance
                                                          τ       2 2
and auto-regressive term) and a new term given by 1−L,t     τL,t σλ,t σt . One can interpret the term
              2 σ̂2 as an instantaneous mean reversion coefficient. In this sense, this stochas-
−θt ddθµ̂t − σλ,t t

  10 Corollary 2 also sheds light on the general discrete time formula in equation (5). Indeed, for any twice
                                                                                        τ
differentiable function π (θt ), one can apply Ito’s lemma to infer the drift of πt λt 1−L,t
                                                                                          τL,t and obtain a contin-
uous time counterpart of equation (5).


                                                            23
tic process features less mean-reversion than productivity. The higher is the variance of
consumption growth, the larger is the discrepancy.
    It is also possible to rearrange this equation as

                                                               log
                                      "                              #
                                                                                                  1
                                                                                                    
                       τL,t                          τL,t     dµ̂               τL,t
             d                      = ασλ,t σ̂t2 +          θt t         dt +          λt d                .
                     1 − τL,t                      1 − τL,t    dθ             1 − τL,t            λt

This version shows explicitly how the innovations in the labor wedge must be perfectly
                                                                                  1
mirrored by those in the marginal utility of consumption ût0 (ct ) = λ−         t . This formulation
neatly highlights the regressivity result alluded to in subsection 3.4.
    It may seem surprising that we obtain a regressivity result in our dynamic model,
especially in light of the absence of such a result in a static setting. As is well understood,
the skill distribution is key in shaping the tax schedule in the static model (Mirrlees (1971);
Diamond (1998); Saez (2001)). In contrast, in our dynamic model, the regressivity result
holds for a large class of productivity processes.
    It is important to stress what this regressivity result does and does not say. Over
short horizons, it induces a negative conditional correlation between consumption and
the labor wedge. However, whether or not this translates into a negative correlation over
longer horizons depends on the evolution of the drift term. In particular, the endogenous
volatility term σλ,t may play a central role. We investigate these dynamics more explicitly
in Section 6.
    Using part (iii) in Proposition√
                                         6, we can solve for the volatility σλ,t in terms of the
                                     τK,t
intertemporal wedge: σλ,t = σ̂t to rewrite these last three equations in terms of the
labor and intertemporal wedges. In this way, optimality can be seen as imposing a joint
restriction on the labor and intertemporal distortions.
    We close by noting the key role played by the endogenous volatility process {σλ } in all
these equations. Firstly, it represents the loading of consumption changes on productivity
innovations. Higher values for σλ,t provide more incentives at the expense of insurance.
Secondly, by part (i) in Proposition 6, it essentially summarizes the entire allocation by de-
termining the evolution of the alternative endogenous states (λt , γt ). Finally, it is featured
prominently in the equations describing the labor and savings wedges. It pins down the
         2 σ̂2 of the savings wedge τ
value σλ,t                                                                    2         τL
             t                            K,t and scales the drift αλt σλ,t σ̂t of { λ 1−τL }. Section 6
exploits the fundamental role of {σλ } to interpret our numerical findings.




                                                        24
5       General Preferences
In this section, we investigate what can be said for general utility functions ut (c, y, θ ). It
is well known that when consumption and labor are not additively separable, the Inverse
Euler condition does not necessarily hold—we lose Proposition 1 . However, as we show
next, we still can make progress generalizing Corollary 1 .
    Recall that the expenditure function C t (y, u, θ ) is the inverse of ut (·, y, θ ). Define

                                                                  t ( y, w, θ )
                                                               −θCyθ
                                         ηt (y, w, θ ) ≡                              .
                                                                  Cyt (y, w, θ )

Since Cyt = −uty /utc = | MRSt | = 1 − τL,t is the marginal rate of substitution, ηt represents
                      d log | MRS |
the elastiticity − d log θt t . It plays a key role below. Note that in the separable isoelas-
tic utility case (Assumptions 1–2) that we studied above, this elasticity is constant with
ηt (y, w, θ ) = α.

Discrete Time. In order to generalize equation (6), we need to introduce the dual of the
variable v(θ t ) defined by

                                      λ ( θ t ) ≡ K v ( v ( θ t ), ∆ ( θ t ), θ t , t + 1).

At an optimum, we have the martingale relation
                                                       ˆ
                                        t −1      q
                                                            λ θ t f t (θt |θt−1 ) dθt .
                                                                 
                                  λ(θ          )=
                                                  β

Below we adopt the shorthand notation of writing xt (θt ) for any function xt (c(θ t ), y(θ t ), θt )
(see ηt and utc below).

Proposition 7 Suppose that {c, y} solves Program FOA. Then the labor wedge satisfies the fol-
lowing equation for every t ≥ 1 and history θ t−1

    ˆ                                                                                                     log
           1        τL θ t      q utc θ t−1 t                           1           τL θ t−1
                                                                                           
                                                                                                        dφt (θt−1 )
                                               f (θt |θt−1 ) dθt =                               θ t −1
        ηt (θ t ) 1 − τL (θ t ) β utc (θ t )                       ηt−1 (θ t−1 ) 1 − τL (θ t−1 )           dθt−1
                                                        ˆ          "
                                                                               t
                                                                                      #
                                                                     q λ θ
                                + utc (θ t−1 )λ(θ t−1 ) log (θt )                   − 1 f t (θt |θt−1 ) dθt . (17)
                                                                     β λ ( θ t −1 )

  This proposition generalizes equation (6). The martingale relation satisfied by λ(θ t )
implies that we can rewrite the second term on the right-hand side of equation (17) as a

                                                              25
                                   q
covariance: Covt−1 (log(θt ), β λλt−t 1 ). Note that we could also generalize equation (5) along
the exact same lines.
   There are two important differences between equations (6) and (17). First, note that
unless utility is separable—Assumption 1 holds—we no longer have β λ(θ t ) = ut (1θ t ) . As a
                                                                            q
                                                                                                        c
                                                                                            t   t −1
            1                                                                            q u (θ )
result,       is no longer a martingale and, by contrast with equation (6), the term β cut (θ t )
        utc (θ t )                                                                            c
cannot be interpreted as a change of measure.
                                 τ (θ t )             τ (θ t )
    Second, note that η (1θ t ) 1−Lτ (θ t ) replaces 1−Lτ (θ t ) . When Assumptions 1 and 5 hold,
                          t         L                    L
ηt = α, we can multiply through by α, as in equation (6). Otherwise, the general equation
indicates that changes in the elasticity should affect the labor wedge. To elaborate on
this point, it will prove convenient to specialize the discussion to a class of generalized
isoelastic preferences for which equation (17) takes a simpler form.

Assumption 5 For every        t ≥ 0, there exists
                                                  functions ũt , ût , and constants κt > 0, αt > 1, such
                                        y α
that ut (c, y, θ ) = ũt ût (c) − ακtt θ t .
                                         


    For this class of preferences, we have ηt (y, w, θ ) = αt .

Corollary 3 Suppose that Assumption 5 holds and that {c, y} solves Program FOA. Then the
labor wedge satisfies the following equation for every t ≥ 1 and history θ t−1

  ˆ                                                                                    log
        τL θ t      q utc θ t−1 t                             τL θ t−1
                                                                       
                                                        αt                           dφt (θt−1 )
                                   f (θt |θt−1 ) dθt =                        θ t −1
      1 − τL (θ t ) β utc (θ t )                       αt−1 1 − τL (θ t−1 )             dθ
                                                     ˆ         "                      # t −1
                                                                 q λ θt
                                                                            
                          + αt utc (θ t−1 )λ(θ t−1 ) log (θt )                   − 1 f t (θt |θt−1 ) dθt . (18)
                                                                 β λ ( θ t −1 )

    Other things being equal, we see that increases in αt (decreases in the Frisch elastic-
                                                                                         log
                                                                                    dφ         (θ   )
ity of labor supply) increase the autoeregressive coefficient ααt−t 1 θt−1 tdθ t−1 of the labor
                                                                              t −1
wedge. In other words, a decrease in the Frisch elasticity of labor supply tends to increase
the labor wedge. This is a manifestation of a standard inverse elasticity principle: other
things equal, labor is taxed more in periods in which it is less elastic.


Continuous Time. Our continuous time analysis can also be extended to general pref-
erences. In particular, we can generalize equation (19).

Proposition 8 Suppose that productivity evolves according to equation (10). Then the labor
wedge satisfies the following stochastic differential equation



                                                     26
                                                                                              log
                                                           "                                        #
                                     τL,t 1 1                               τL,t 1 1 dµ̂t
                                                    
                           d                             = λt σλ,t σ̂t2 +                 θt            dt.             (19)
                                   1 − τL,t utc ηt                        1 − τL,t utc ηt    dθt

    This expression is the continuous time analogue of equation (17). Note that our no-
                                                       τ      1 1
volatility result generalizes: the stochastic process 1−L,t
                                                         τL,t utc ηt has zero instantaneous volatil-
ity so that its realized paths will vary much less than those for productivity {θ }, in the
sense that they are (a.s.) of bounded variation. Equation (19) takes a simple and illuminat-
ing form when preferences are in the generalized isoelastic class defined by Assumption
5.

Corollary 4 Suppose that Assumption 5 holds and that productivity evolves according to equa-
tion (10). Then the labor wedge satisfies the following stochastic differential equation

                                                                                       log
                                                "                                                        !#
                           τL,t 1                                  τL,t 1                 1 dαt
                                        
                                                                                     dµ̂
                 d                           = αt λt σλ,t σ̂t2 +                   θt t +                     dt.       (20)
                         1 − τL,t utc                            1 − τL,t utc         dθt αt dt

    Equation (20) clearly shows how a time-varying Frisch elasticity of labor supply im-
                                          τ      1
                                            τL,t utc . Increases in αt (decreases in the Frisch elas-
pacts the autoregressive coefficient of 1−L,t
ticity of labor supply) tend to increase the labor wedge.
    We can also derive a generalization of equation (16)

                                                                           log
                               "                                                        !#
                                                 τL,t 1                       1 dαt                   τL,t 1
                      
              τL,t                                                       dµ̂
                           = αt λt σλ,t σ̂t2 +                         θt t +                                        t
                                                                                                                         .
                                                                                                                       
    d                                                                                        dt +                d u c
            1 − τL,t                           1 − τL,t utc               dθt αt dt                 1 − τL,t utc

This shows explicitly how innovations in the labor wedge must be perfectly mirrored by
those in the marginal utility of consumption utc .


6       The Model At Work: A Numerical Solution
In this section we parametrize the model and solve it numerically. This serves to illustrate
some of our theoretical results, but also leads to some new insights.


A Life Cycle Economy. Agents live for T = 60 years, working for 40 years and then
retiring for 20 years. Their period utility function is

                                                                       κ  yt α
                                                          log(ct ) −
                                                                       α θ


                                                                   27
with α > 1 and κ > 0 during working years t = 1, 2, . . . 40 and

                                                   log(ct )

during retirement t = 41, 42, . . . , 60. We set α = 3 implying a Frisch elasticity for labor of
0.5, and κ = 1. We set the agent’s and planner’s discount factors equal to each other at
q = β = 0.95.
    For productivity, we follow Storesletten, Telmer, and Yaron (2004). They estimate earn-
ings to fit an AR(1) plus white noise.11 The coefficient of auto correlation is very close to
one, leading them to adopt a geometric random walk:

                                                θ t = ε t θ t −1 ,

                         2
with log ε ∼ N (− σ̂2 , σ̂2 ). We truncate the normal distribution: the density of log ε is
proportional to the density of the normal over a finite interval [ε, ε̄]. We adjust σ̂2 so that
Var(log ε) = 0.0161 the value reported in Storesletten, Telmer, and Yaron (2004) for the
variance of the log changes in earnings.
   Under these conditions, the value function satisfies

                 K (v, ∆, θ− , t) = θ− K (v − (1 + β + · · · + β T −t ) log θ− , θ− ∆, 1, t).

This holds because if {ct , yt } is feasible given (v, ∆, θ− ) and has cost k, then, due to bal-
anced growth preferences, it follows that {φct , φyt } is feasible given (v + (1 + β + · · · +
β T −t ) log φ, φ−1 ∆, φθ− ) and costs φk. Setting φ = 1/θ− then yields the desired property
for K. A similar homogeneity condition holds for the policy functions. These properties
reduce the dimensionality of our problem.
     After computing policy functions, we iterate on them to produce a Montecarlo simu-
lation with 1 million agents evolving through periods t = 1, 2, . . . , T. For any given v1 ,
we initialize ∆1 at t = 1 to minimize cost

                                      ∆1 ∈ arg min K (v1 , ∆, 1, 1).
                                                    ∆

We set the initial value for utility v1 so that the resulting cost is zero, K (v1 , ∆1 , 1, 1) = 0.
  11 Storesletten,Telmer, and Yaron (2004) estimate earnings, not wages or productivity. calibrating the
productivity process with the earnings process is an approximation. Ass we discuss below, in logs, earnings
are linear in productivity at the first best solution as well as in autarky.




                                                        28
Two Benchmarks. Before discussing the results of our simulations, it is useful to con-
sider two benchmark allocations, those corresponding to autarky and the first best.
    Consider first an autarkic situation, where there are no taxes. Agents can consume
their own production. They can neither borrow nor save. Thus, they solve the static
maximization: maxy u(y, y; θ ). With logarithmic utility, or more generally with balanced
growth preferences, this implies ct = yt = θt n̄ for some constant level of work effort, de-
fined by the solution to uc (n̄, n̄; 1) = −uy (n̄, n̄; 1). Consumption and output are geometric
random walks: ct = εct−1 and yt = εyt−1 . The labor wedge is zero and the inter-temporal
wedge is a positive constant equal to 1 − Rq = 1 − Rβ > 0, where R ≡ β−1 (E 1ε )−1 .12
    Consider next the first-best planning problem given by:

                                T                                  T
                      max E0
                      {c,y}
                               ∑ u(ct , yt ; θt )   s.t.     E0   ∑ qt (ct − yt ) ≤ e,
                               t =1                               t =1

for some constant e ∈ R, representing outside resources available to the planner. The opti-
mum features perfect insurance, with constant consumption ct = c̄ and constant marginal
disutility of work, implying
                                          α  1
                                                   α −1
                                    yt =        θt      .
                                           κ c̄
Output is increasing in productivity, with Frisch elasticity 1/(α − 1) > 0. Both the labor
and intertemporal wedges are zero.


Findings from Simulation. Within each period t, we compute the average in the cross
section for a number of variables of interest, such as consumption, output, and the la-
bor and intertemporal wedges. During retirement each agent’s consumption is constant,
while output and wedges are zero. Thus, we focus on the working periods t = 1, 2, . . . , 40.
   Although our simulations are for the discrete time model, with a period represent-
ing a year, our results from the continuous time version turn out to provide an excel-
lent explanation for our findings. In particular, Proposition 6 shows that the optimum is
summarized by the volatility process {σλ }, since this determines the laws of motion for
wedges, consumption and output. With logarithmic utility, the instantaneous variance of
consumption growth is given by σλ,t 2 σ̂2 . Figure 1 panel (b) plots the average variance of

  12 Alternatively,  in the case with no retirement, this allocation can also be sustained as an equilibrium
where q = R−1 (instead of q = β) and agents can freely save and borrow. The intertemporal wedge in
this latter case is zero. This serves to make the point that the sign of the intertemporal wedge is somewhat
uninteresting, because it depends on the value of various parameters, including q. Another way to proceed
is to define autarky as allowing agents to borrow and save at rate q, in which case all wedges are zero by
definition, but, unless there is no retirement and q = R−1 , we would be unable to solve the equilibrium in
closed form.


                                                    29
                                                                 0.01
    0.4                                                         0.008
                                                                0.006
    0.2                                                         0.004
                                                                0.002
      0                                                             0
                10         20         30         40                            10        20         30         40
              (a) Average labor wedge                         (b) Intertemporal wedge (blue) and variance of
                                                              consumption growth (green)

                                   Figure 1: Average wedges over time


consumption growth in our simulation Vart [ct+1 /ct ]. This is the discrete time counterpart
     2 σ̂2 .
of σλ,t
    As the figure shows, the average variance of consumption growth falls over time and
reaches zero at retirement. There are two key forces at play. First, as retirement nears,
productivity shocks have a smaller effect on the present value of earnings, since they
affect earnings for fewer periods. Since consumption is smoothed over the entire lifetime,
including retirement, the impact of shocks on consumption falls and approaches zero at
retirement. This is the usual permanent income mechanism. Indeed, this property would
be present at an equilibrium with no taxes and free savings. Second, as we show below,
the labor wedge is increasing over time. This provides increased insurance, in the sense
of lowering the effect of productivity shocks on net earnings.
    The decreasing pattern towards zero in the average variance of consumption growth
will be key in understanding a number of results presented below.
    Turning to the wedges, panel (a) in Figure 1 shows that the labor wedge starts near
zero and increases over time, asymptoting around 46% at retirement. Panel (b) displays
the intertemporal wedge, which displays the reverse pattern. It is decreasing over time,
starting around 1%—which represents an implicit tax on net interest of around 17%—
and falling to zero at retirement.13 Both of these findings are easily explained by our
theoretical results, together with the behavior of the average variance of consumption
growth.
    As shown in equations (7) and (16), when ρ = 1, the expected change in the labor
  13 To  put these magnitudes in perspective, recall that the intertemporal wedge represents an implicit tax
on the gross rate of return to savings. In this interpretation, agents perceive a gross interest of (1 − τK,t )(1 +
r ) instead of (1 + r ), where 1 + r = q−1 . An equivalent reduction in the gross interest rate can be obtained
by an implicit tax τ̂K,t on net interest r given by 1 + (1 − τ̂K,t )r. Setting, 1 + (1 − τ̂K,t )r = (1 − τK,t )(1 + r )
gives τ̂K,t = 1+r r τK,t . In our case, q = 0.95, so that 1+r r ≈ 1r ≈ 20.


                                                         30
     1.1                                                    1
                                                          0.8
       1
                                                          0.6
     0.9                                                  0.4
                                                          0.2
     0.8
                                                            0
                 10        20        30        40                     10        20        30        40
    (a) Average for output (blue) and consump-            (b) Variance of output (green), productivity
    tion (green)                                          (blue) and consumption (red)

                       Figure 2: Statistics for optimal allocation over time


tax is proportional to the covariance of consumption growth with the log of productivity,
which is positive, in order to provide incentives. This explains the increasing pattern in
the average wedge. The covariance equals σλ,t σ̂2 in the continuous time limit. Then, since
  2 σ̂2 decreases over time to zero, so does σ σ̂2 , explaining the asymptote in the labor
σλ,t                                           λ,t
wedge at retirement.
     As for the intertemporal wedge, equation (4) implies that it is increasing in the un-
certainty of consumption growth, in the sense that a mean-preserving spread leads to an
increase in the wedge. In the continuous time limit the intertemporal wedge equals the
variance of consumption growth: τK,t = σλ,t   2 σ̂2 . Indeed, although panel (b) plots both

the variance of consumption growth and the intertemporal wedge, the two are indistin-
guishable to the naked eye. More generally, while we simulate the discrete time version
of the model, with a period representing a year, the continuous time formulas turn out to
provide excellent approximations for our findings.
     Figure 2 shows the evolution over time for the cross-sectional means and variances of
the allocation. Panel (a) shows that average consumption is perfectly flat. This is expected
given the Inverse Euler condition, which with logarithmic utility is (q/β)Et−1 [ct ] = ct−1 .
Output, on the other hand, is mostly decreasing, consistent with the increasing pattern in
the labor wedge.14
     Panel (b) shows the cross-sectional variance for consumption, productivity and out-
put. The variance of productivity grows, by assumption, linearly. The variance of output
  14 Note that average output can also be affected by the increasing dispersion in productivity.  For example,
in a first best solution, output would be proportional to θtα−1 . When α < 2 this function is concave inducing
a decreasing pattern. The reverse is true when α > 2. In our case α = 2 so the increasing dispersion in
productivity would not have an effect on average output at the first best solution. An autarkic solution,
without taxes and where agents consume their current output (i.e. with no savings or with q set at a level
that induces no savings), would feature constant output regardless of the value of α.



                                                     31
        0.5
                                                          0.5
        0.4
                                                          0.4
  τ20




                                                    τ40
        0.3                                               0.3

        0.2                                               0.2
           0.2    0.3         0.4        0.5                 0.2     0.3     0.4    0.5
                        τ19                                                τ39

                              Figure 3: Scatter of τL,t vs. τL,t−1


is higher and grows in a convex manner. The variance of consumption, on the other hand,
it lower than the variance of productivity and grows in a concave manner. For reference,
note that in autarky, with no taxes and no savings, since c = y ∼ θ, the variance for
consumption, output and productivity are equal to each other. At the other end of the
                                                                                           1
spectrum, the first best solution has zero variance in consumption and since yt ∼ θtα−1 .
the variance for output is higher than that of productivity and grows in a convex manner.
The planner’s solution, in contrast, partially insures productivity shocks and lies between
these two benchmarks.
    The degree of insurance is nicely illustrated by the lower variance of consumption,
relative to that of output and productivity. Over time, the variance for consumption rises,
and does so in a concave fashion. Recall that consumption is a martingale, which implies
that inequality must rise. As we discussed above, over time the variance in consumption
growth falls and reaches zero at retirement, explaining the concave shape.
    Figure 3 illustrates the intertemporal labor wedge formula by showing scatter plots of
the current labor wedge against the previous period’s labor wedge. In period t = 20, the
average relationship is close to linear with a slope near one and lies above the 45 degree
line. Both of these properties are consistent with our formula in equation (7). The average
tax in the current period lies slightly above the previous period’s, illustrating the positive
drift in taxes.
    In the last working period, t = 40, the scatter plot shows an almost perfect relationship
between the previous tax and the current one, with a slope of one. Taxes on labor are al-
most perfectly smoothed near retirement. Recall that the variance of consumption growth
drops to zero as retirement approaches. This explains why the average relationship is
essentially the 45 degree line. The reason there is no dispersion around the average rela-
tionship is an implication of the results in Sections 4 and 3.4 that show that unpredictable
changes in the labor wedge are related to unpredictable changes in marginal utility. Near

                                               32
                               0.8
                               0.7
                               0.6
                               0.5
                               0.4
                               0.3
                               0.2
                               0.1
                                  0.1    0.2   0.3   0.4       0.5   0.6   0.7   0.8
                                         τL,t   0                     τL,t−1   0
              Figure 4: Scatter of      1−τL,t u ( ct )   against    1−τL,t−1 u ( ct−1 )   for t = 20.


retirement, consumption becomes almost perfectly predictable, so the labor wedge does
as well.
                                                        τ       0                τL,t−1   0
                                                          τL,t u ( ct ) against 1−τL,t−1 u ( ct−1 ) for t =
     To illustrate this point further, Figure 4 plots 1−L,t
20. The average relationship is slightly above the 45 degree line and the dispersion around
this relationship is minimal. This illustrates the results in Sections 3.4 and 4, that there is
no instantaneous volatility in { 1−τLτL u01(c) }. In other words, unpredictable changes in the
labor wedge { 1−τLτL } are entirely explained by unpredictable changes in the reciprocal of
marginal utility { u01(c) }.
     Figure 5 panel (a) plots the current period’s labor wedge τL,t against the productivity
θt for period t = 20. On average, tax rates are higher for agents with low productivity.
In this sense, the tax system is regressive. What accounts for this finding? In a static
setting, it is well known that the pattern of taxes is dependent, among other things, on
the distribution of productivity shocks (Diamond, 1998; Saez, 2001). We have assumed
a log-normal distribution for the productivity shocks. In our dynamic context, however,
it is less obvious whether this particular choices is responsible for the regressive pattern
we find. Indeed, the results in Sections 3.4 and 4 point towards a negative correlation
between the labor wedge and productivity, at least in the short run.
     The figure also shows that, for any given level of current productivity, there is signif-
icant dispersion in the labor wedge. If the labor wedge were solely a function of current
productivity, then there would be no dispersion. Thus, this dispersion illustrates the his-
tory dependence in the labor wedge. Recall that the allocation and wedges depend on the
history of shocks as summarized by our two state variables v and ∆.
     It is important to keep in mind, that a history independent tax system, with a fixed
non-linear tax schedule that allows for savings, can also produces a history dependent la-
bor wedge. The history of productivity shocks affects savings decisions. The accumulated
wealth, in turn, affects the current labor choice, determining the position, and marginal
tax rate, along the fixed non-linear tax schedule.

                                                          33
     0.5                                                         30
                                                                 25
     0.4
                                                                 20
                                                                 15
     0.3
                                                                 10
     0.2                                                         5
           0       0.5      1       1.5      2        2.5             5        10          15       20           25          30
               (a) Scatter of τL,t vs. θt at t = 20                       (b) Scatter of   ∑tT=1 qt ct   vs.   ∑tT=1 qt yt

                                Figure 5: History dependence and Insurance


    Figure 5 panel (b) gets at a measure of the overall degree of insurance by plotting
the realized present value of consumption ∑tT=1 qt−1 ct against the present value of output
∑tT=1 qt−1 yt in the simulation. Without taxes there is no insurance and ∑tT=1 qt−1 ct would
vary one for one with ∑tT=1 qt−1 yt . Insurance makes the present value of consumption
∑tT=1 qt−1 ct vary less than one for one with the present value of income ∑tT=1 qt−1 yt . The
scatter shows that at the optimum there is a near linear relationship, with a slope around
0.67. For reference, a linear tax with a rate of 33% would produce an exact linear relation-
ship with this slope.
    We have performed some comparative statics and welfare analysis which we report
briefly now.
    A fundamental parameter in our exercise is the degree of uncertainty. Unfortunately,
empirical estimates for the earnings process vary quite substantially, due to differences
in methodologies, econometric specifications and data sets. In addition, an important
consideration is the degree to which agents have better information than the econometri-
cian, allowing them to forecast future earnings and productivity better. This suggests that
agents face lower uncertainty than what is implied by the available empirical estimates.
    Motivated by these considerations, we solved for an economy with lower uncertainty,
with the same parameters as our baseline, but with the standard deviation σ̂2 = 0.0061.
The results show the same qualitative patterns as the benchmark. Quantitatively, both
the labor and intertemporal wedges are lower, with the labor wedge peaking at 30% and
the intertemporal wedge starting at 0.45%—which represents an implicit tax on net in-
terest of around 9%. With lower uncertainty the optimum features lower insurance and
distortions. These results are consistent with our formulas, which stress the role that the
degree of uncertainty, captured by σ̂, has in determining both the labor and intertemporal
wedges.


                                                            34
                                                     0.01
    0.4                                             0.008
                                                    0.006
    0.2                                             0.004
                                                    0.002
     0                                                 0
              10         20          30   40                   10       20       30       40
                   (a) Labor wedge                           (b) Intertemporal wedge

                         Figure 6: Impulse response to shock at t = 20.

Labor Wedge Dynamics: An Impulse Response. The scatter of the labor wedge at t
against the labor wedge at t − 1 shown above illustrates the average short-run dynamics
implied by our formula. Here, we wish to zoom in more and see how these dynamics play
out over longer horizons. To this end, we follow an agent with a productivity realization
given by ε t = F −1 (1/2) for t 6= 20 and ε 20 = F −1 (0.95). We compare this to an agent with
ε t = F −1 (1/2) for all t = 1, 2, . . . , 40. We plot the evolution of the labor wedge, and other
variables, for these two agents. The difference can be interpreted as the impulse response
to a shock at t = 20.
     Figure 6 shows the evolution of the wedges for these two realizations. Without a
shock, the wedges behaves similarly to the averages shown in Figure 1. In contrast, with
the shock, we see a downward jump on impact in the labor wedge (consumption, not
shown, jumps upward). After the shock, the labor wedge displays a higher rate of growth.
In the figure, the labor wedge remains below the path for the no-shock scenario. This fea-
ture is not general: we have found that for other values of λ0 , the path with a shock
may jump below but eventually cross and overtake the path without a shock. The higher
growth rate in the labor wedge may be enough to over come the initial jump downward.
But why does the labor wedge grow faster after a shock? Panel (b) displays a partial an-
swer: the intertemporal wedge jumps up on impact, due to an increase in the variance of
consumption growth. Our formulas indicate that this increases the drift term in the labor
wedge. Why does the variance of consumption growth rise? Intuitively, due to partial
insurance, the shock raises consumption by less than productivity. As a result, the agent
becomes poorer, relatively speaking, and, hence, more susceptible to the fluctuations in
productivity.


Welfare. We now compute the welfare gains relative to a situation with no taxes. Our
baseline is a market equilibrium without taxes, where agents can save and borrow freely

                                               35
                                        σ̂2 = 0.0161   σ̂2 = 0.0061
                         second-best          3.43%          0.86%
                         first-best          13.04%          5.20%

              Table 1: Welfare gains over free-savings, no-tax equilibrium.


in a risk-free asset with rate of return q−1 . This allocation is easily solved backwards
starting at retirement by using the agent’s first-order conditions, with zero wedges, and
the budget constraints.
      In Table 1 , we report the welfare gains for the second best, the solution to Program
FOA, and the first-best, the optimum with publicly observable productivity. The num-
bers represent the constant percentage increase, at all dates and histories, in the baseline
consumption required to achieve the same utility as the alternative allocation. The first
column corresponds to our benchmark value for the conditional variance of productivity
σ̂2 , while the second reports a simulation with half this value. As expected, the welfare
gains increase with σ̂2 .


Comparison with Simple Policies.           The second best requires sophisticated history-
dependent taxes. If these are not available, how do our results inform us about simpler,
history-independent ones? In welfare terms, how well can simpler policies do? These are
the questions we explore next.
    To this end, we consider history-independent taxes. To simplify the analysis and aid
the interpretation, we further restrict taxes to be linear. Since the second best features an
important age pattern for taxes, we consider both age-dependent and age-independent
taxes.
    Optimizing over age dependent taxes is not very tractable numerically, due to the
large number of tax variables and the cost of computing the equilibrium for each tax
arrangement. In this case, instead of optimizing, we take a hint from the second-best
to formulate a sensible choice: we set the tax rates at each age to their cross-sectional
averages in the second-best. In contrast, with age-independent taxes there are just two
variables, so the problem is numerically tractable. In this case, we compute the optimal
age-independent tax rates. There are also intermediate cases, such as age-dependent taxes
on labor combined with an age-independent capital tax. In this case, we set the labor tax
rates to the corresponding cross-sectional averages in the second-best, but optimize over
the constant capital tax rate.
    Table 2 below reports the welfare gains over the zero-tax allocation of various simple
policies. These are comparable to the numbers in Table 1 . Although we perform the


                                             36
                                                               σ̂2 = 0.0161     σ̂2 = 0.0061
              age-dependent τL and τK                              3.30%            0.71%
              age-dependent τL , and τK = 0                        3.16%            0.66%
              age-dependent τL , age-independent τK                3.29%            0.70%
              age-independent τL and τK                            2.71%            0.54%

                              Table 2: Welfare from simple tax policies.


exercises for two values of σ̂, since the findings are qualitatively similar in both cases, we
will focus our discussion on our benchmark reported in the first column.
     The first row reports welfare for an age-dependent linear tax system, where tax rates at
each age are set to the cross-sectional average obtained from the second-best simulation.
It is surprising just how well this relatively simple policy performs. It delivers a welfare
gain of 3.30% in lifetime consumption, compared to the 3.43% obtained by the second
best. Remarkably, age-dependent linear taxes deliver 96% of the welfare gains of the
second-best.
     It is is worth repeating that we have not optimized over the age-dependent tax rates.
Instead, the tax rates are taken to be the cross-sectional average from the second-best sim-
ulation, as in Figure 2 . Of course, the fact that welfare comes out to be very close to that
of the second best, suggests that this policy is very close to being optimal within the set
of simple age-dependent tax policies.15 We think this illustrates that our characterization
of the second best, theoretical and numerical, provides not only useful insights, but can
also deliver detailed and surprisingly accurate guidance for simplertax systems.
     Although our age-dependent policy is constructed to mimic the second best as much
as possible, it lacks history dependence. In particular, it cannot implement the short-
term regressivity property which we found to be optimal. At least for this simulation, it
appears that history dependence is not crucial for welfare. At present, we do not know
how robust this conclusion is.
     As the second row indicates, preserving age-dependent linear labor taxes but setting
capital taxes to zero delivers a welfare gain of 3.16%. The difference of 0.14% represents
the gains from taxing capital. This magnitude is in line with Farhi and Werning (2008a,b),
who find relatively modest gains, especially when incorporating general equilibrium ef-
fects which are absent here.
     The third row maintains the same age-dependent labor tax, but allows for a non-zero,
age-independent tax on capital. This improves welfare to 3.29%, very close to the welfare
obtained by age dependent labor and capital taxes of 2.30% from the first row. The op-
 15 Other   findings discussed below imply that the shape of the age-dependent tax does affect welfare.



                                                     37
timal age-independent intertemporal wedge is 0.33% (corresponding to tax rate of 6.60%
on the net interest). Interestingly, this is close to the average wedge across ages from the
second-best simulation, as displayed in Figure 1 .
    The last row reports welfare for the simplest tax system we consider: age-independent
linear labor and capital taxes. The optimal age-independent linear tax on labor is equal
to 27.43%, quite close to the average across ages found in the second best simulation,
or the calculation behind panel (b) in Figure 5 . This simplest of tax systems delivers
welfare of 2.71%. Comparing this to the first row, we see that the cost of imposing an
age-independent tax system is roughly 0.60% of lifetime consumption.
    Not reported in the table is the fact that the optimal age-independent tax on capital
comes out to be minuscule: an intertemporal wedge of 0.0138%, corresponding to a tax
rate of around 0.28% on net interest. Given this, the cost of imposing a zero tax on capital
constraint are minuscule, below 0.001% of lifetime consumption. Interestingly, taxing
capital does not appear to be optimal unless the labor tax is somewhat sophisticated and
features either age-dependence or the richer history-dependence of the second best.
    With an age-dependent labor tax, an age-independent tax on capital provides modest
but non-negligible benefits, equal to 0.13%. However, the addition of an age-dependent
capital tax provides little extra benefit, equal to 0.01% of lifetime consumption. In con-
trast, age-dependent taxes on labor provide a sizable improvement of 0.60% over the
completely age-independent tax system. Allowing for age-dependent labor taxes is more
important in this simulation than allowing for age-dependent capital taxes.
    Why is the optimal age-independent tax on capital significant when labor taxes are
age-dependent, yet minuscule when labor taxes are age independent? There are two
forces at play. The first pushes for a positive tax on capital to get closer to the Inverse Euler
condition. This force is clearly at play in the second best, but also appears to be present
in the simpler tax systems (rows 1–3 in the table). The second force occurs only when
when labor taxes cannot be age-dependent (row 4). The reason is that a capital subsidy
could help mimic an increasing age profile of labor taxes. Intuitively, labor income earned
earlier in life, while taxed at the same rate as later in life, has the benefit that, when saved,
it accrues a higher interest rate from the capital subsidy. This sort of mimicking effect is
explained in Erosa and Gervais (2002) for a Ramsey framework.16 When we allow for
  16 They  assume no uncertainty, so that the age-dependence of the desire path of labor taxes is entirely
driven by the age-dependence of the Frisch elasticity of labor supply. In our simulation, instead, the Frisch
elasticity of labor supply is constant, and it is the information structure that is responsible for the age-
dependence of desired labor taxes, which is increasing. Restricting labor taxes to be age-independent calls
for a mimicking capital subsidy. Instead, they focus on a specification where the elasticity of the disutility
of labor varies, with a functional form that can lead to the reverse case, with decreasing labor taxes or a
positive tax on capital to mimic them.


                                                     38
age-dependent labor taxes, the second force is absent leading to a positive tax on capital.
When the labor tax cannot depend on age, both forces are present and roughly cancel
each other out, resulting in a practically zero tax on capital.


Gains From the Inverse Euler Equation. We conclude our numerical investigations by
linking our results to Farhi and Werning (2008a,b). In these papers, we propose a method
to assess the importance of savings distortions from a welfare perspective. Starting with
any incentive-compatible allocation, we consider the class of all allocations that share the
same labor allocation, are incentive compatible, and deliver the same utility to agents.
We show how these allocations can be obtained from the original allocation through a
simple set of perturbations. In this class of allocations, the one with the least cost is
the only one that satisfied the Inverse Euler equation. The corresponding cost-savings
represent the gains from optimal savings distortions. In Table 3, we report the welfare
gains from allowing for optimal savings distortions for the different allocations discussed
above. Overall, our findings are supportive of the results in Farhi and Werning (2008a,b).
    We report the corresponding numbers both for the high and low volatility case. The
gains from optimal savings distortions decrease with the volatility of productivity. For
example, they decrease from 0.449% to 0.086% for the allocation with zero taxes. This is
intuitive. Starting with an allocation that satisfies the Euler equation, the gains from opti-
mal savings distortions are linked to the amount of precautionary savings. With log pref-
erences, the strength of this motive is measured by the variance of consumption growth,
which is an increasing function of the variance of productivity. In the rest of the discus-
sion, we focus on the high volatility case.
    Consistent with Farhi and Werning (2008a,b), we find that the gains from optimal sav-
ings distortions are never very large. The maximum number that we compute is 0.449%.
Starting from the allocation with zero taxes, the gains from optimal savings distortions
only contribute to a relatively small fraction (about 13%) of the gains from moving to an
optimal tax system (3.43%).
    That the the gains from optimal savings distortions are largest (0.449%) for the allo-
cation with zero taxes is intuitive for two reasons. First, this allocation has no savings
distortions to start with (it satisfies the Euler equation). Second, this allocation features
the least insurance among the allocations that we consider. As a result, the variance of
consumption growth is high, and so are the welfare gains from optimal savings distor-
tions. The same reasons explain why the gains from optimal savings distortions for the
allocation with age-independent labor and capital taxes are also larger (at 0.180%) than
for the other allocations that we consider. Regarding this allocation, it is interesting to


                                             39
                                                      σ̂2 = 0.0161   σ̂2 = 0.0061
           zero taxes                                    0.449%         0.086%
           age-dependent τL and τK                       0.005%         0.000%
           age-dependent τL , and τK = 0                 0.095%         0.036%
           age-dependent τL , age-independent τK         0.011%         0.026%
           age-independent τL and τK                     0.180%         0.056%

                   Table 3: Welfare from Optimal Savings Distortions.


note that the optimal age-independent capital tax is basically equal to zero (correspond-
ing to zero savings distortions): the gains from savings distortions cannot be achieved by
simply introducing a linear tax on capital.
   The gains from optimal savings distortions for the allocation with age-dependent la-
bor and capital taxes are absolutely minuscule (much less than the gains from moving to
the second best). This allocation approximates the second best very well. Our exercise
informs us that the small gains from the second best over this allocation (of the order of
0.1%) do not originate in better savings distortions.
   The allocation with age-dependent labor taxes but zero capital taxes offers greater
gains from optimal savings distortions (0.095%). Note also that the gains from optimal
savings distortions are only about a third of the gains from moving to the second best al-
location (0.270%): the bulk of these gains does not originate in savings distortions per se.
The gains from optimal savings distortions for the allocation with age-dependent labor
taxes but age-independent capital taxes are lower (0.011%): this allocation already fea-
tures some savings distortions that partially replicate the savings distortions prescribed
by the Inverse Euler equation.


References
A BRAHAM , A., AND N. PAVONI (2008): “Efficient Allocations with Moral Hazard and
  Hidden Borrowing and Lending: A Recursive Formulation,” Review of Economic Dy-
  namics, 11(4), 781–803.

A LBANESI , S., AND C. S LEET (2006): “Dynamic Optimal Taxation with Private Informa-
  tion,” Review of Economic Studies, 73(1), 1–30.

A LES , L., AND P. M AZIERO (2009): “Accounting for Private Information,” mimeo.

B ATTAGLINI , M. (2005): “Long-Term Contracting with Markovian Consumers,” American
  Economic Review, 95(3), 637–658.

                                            40
B ATTAGLINI , M., AND S. C OATE (2008): “Pareto efficient income taxation with stochastic
  abilities,” Journal of Public Economics, 92(3-4), 844–868.

D IAMOND , P. A. (1998): “Optimal Income Taxation: An Example with a U-Shaped Pat-
  tern of Optimal Marginal Tax Rates,” American Economic Review, 88(1), 83–95.

D IAMOND , P. A., AND J. A. M IRRLEES (1978): “A model of social insurance with variable
  retirement,” Journal of Public Economics, 10(3), 295–336.

E ROSA , A., AND M. G ERVAIS (2002): “Optimal Taxation in Life-Cycle Economies,” Journal
   of Economic Theory, 105(2), 338–369.

FARHI , E., AND I. W ERNING (2008a): “Optimal savings distortions with recursive prefer-
  ences,” Journal of Monetary Economics, 55(1), 21–42.

       (2008b): “The Political Economy of Non-Linear Capital Taxation,” mimeo.

         (2009): “Capital Taxation: Quantitative Explorations of the Inverse Euler Equa-
  tion,” mimeo.

F ERNANDES , A., AND C. P HELAN (2000): “A Recursive Formulation for Repeated Agency
   with History Dependence,” Journal of Economic Theory, 91(2), 223–247.

F UKUSHIMA , K. (2010): “Quantifying the Welfare Gains from SImple Tax Systems,”
   mimeo.

G ARRETT, D., AND A. PAVAN (2010): “Dynamic Managerial Compensation: a Mechanism
  Design Approach,” mimeo.

G OLOSOV, M., N. K OCHERLAKOTA , AND A. T SYVINSKI (2003): “Optimal Indirect and
  Capital Taxation,” Review of Economic Studies, 70(3), 569–587.

G OLOSOV, M., M. T ROSHKIN ,    AND   A. T SYVINSKI (2010): “Optimal Dynamic Taxes,”
  mimeo.

G OLOSOV, M., AND A. T SYVINSKI (2006): “Designing Optimal Disability Insurance: A
  Case for Asset Testing,” Journal of Political Economy, 114(2), 257–279.

G OLOSOV, M., A. T SYVINSKI , AND I. W ERNING (2006): “New Dynamic Public Finance:
  A User’s Guide,” forthcoming in NBER Macroeconomics Annual 2006.

J ARQUE , A. (2008): “Repeated Moral Hazard with Effort Persistence,” mimeo.


                                           41
K APICKA , M. (2008): “Efficient Allocation in Dynamic Private Information Economies
  with Persistent Shocks: A First-Order Approach,” mimeo.

K REMER , M. (2002): “Should Taxes be Independent of Age,” mimeo.

M IRRLEES , J. (1971): “An Exploration in the Theory of Optimum Income Taxation,” Re-
 view of Economic Studies, 38(2), 175–208.

PAVAN , A., I. S EGAL , AND J. T OIKKA (2009): “Dynamic Mechanism Design: Incentive
  Compatibility, Profit Maximization, and Infomation Disclosure,” mimeo.

S AEZ , E. (2001): “Using Elasticities to Derive Optimal Income Tax Rates,” Review of Eco-
   nomic Studies, 68(1), 205–29.

S HIMER , R., AND I. W ERNING (2008): “Liquidity and Insurance for the Unemployed,”
   American Economic Review, 98(5), 1922–42.

S TORESLETTEN , K., C. I. T ELMER , AND A. YARON (2004): “Consumption and risk sharing
   over the life cycle,” Journal of Monetary Economics, 51(3), 609–633.

T CHISTYI , A. (2006): “Security Design with Correlated Hidden Cash-Flows: The Opti-
  mality of Performance Pricing,” mimeo.

W EINZIERL , M. (2008): “The Surprising Power of Age-Dependent Taxes,” mimeo.

W ERNING , I. (2002): “Optimal Unemployment Insurance with Unobservable Savings,”
 Mimeo.

          (2007a): “Optimal Fiscal Policy with Redistribution,” Quarterly Journal of Eco-
    nomics, 122(3), 925–967.

         (2007b): “Pareto Efficient Income Taxation,” mimeo.

W ILLIAMS , N. (2008): “Persistent Private Information,” mimeo.



7     Appendix
Proof of Proposition 1. Consider an allocation {c, y} that solves Program IC or Program
FOA. Then consider a history θ t−1 and a neighborhood |θ̃ t−1 − θ t−1 | ≤ ε of this history




                                            42
where | · | is the sup norm. Consider the following perturbed allocation c̃δ , ỹδ . Define
                                                                        

for every θ̃ t−1 such that |θ̃ t−1 − θ t−1 | ≤ ε,
                                                  
                                       ût c̃δ θ̃ t = ût c θ̃ t − δ,
                                                                

                                                             
                               ût−1 c̃δ θ̃ t−1    = ût−1 c θ̃ t−1 + βδ,

and for every other θ s                                            
                                         ûs cδ (θ s ) = ûs cδ (θ s ) .

Finally for every θ s , define
                                                 ỹδ (θ s ) = y (θ s )

    The perturbed allocation {c̃, ỹ} satisfies all the constraints (of either Program IC or
Program FOA). A necessary condition for the inital allocation {c, y} to be optimal is that
it be the least cost allocation among the class of allocations c̃δ , ỹδ indexed by δ. This
                                                                 

implies that
                                       dΨ c̃δ , ỹδ
                                           
                                                     =0
                                            dδ
which can be rewritten as
      ˆ
                                 1
                                         f t−1 θ̃t−1 |θ̃t−2 ... f 0 θ̃0 |θ̃−1 dθ̃t−1 ...dθ̃0
                                                                                
  β                       t−10 c θ̃ t−1
   |θ̃ t−1 −θ t−1 |≤ε û
       ˆ                    ˆ
                                     1
                                            f t θ̃t |θ̃t−1 dθt f t−1 θ̃t−1 |θ̃t−2 ... f 0 θ̃0 |θ̃−1 dθ̃t−1 ...dθ̃0 .
                                                                                                   
  =q
         |θ̃ t−1 −θ t−1 |≤ε    ût0 c θ̃ t
             ´
Dividing by |θ̃ t−1 −θ t−1 |≤ε f t−1 θ̃t−1 |θ̃t−2 ... f 0 θ̃0 |θ̃−1 dθ̃t−1 ...dθ̃0 and taking the limit when
                                                                  

ε → 0 yields the result.
    Proof of Proposition 2. We tackle Program FOA using optimal control. To clarify the
origins of the results, we first only make Assumption 1. Then we introduce Assumption 2
in the proof only when it is needed. We attach multipliers λ and γ on the first and second
constraints. We denote by µ (θ ) the co-state variable associated with w (θ ). We then form
the corresponding Hamiltonian. The Envelope conditions can be written as

                              Kv (v, ∆, θ− , t) = λ and K∆ (v, ∆, θ− , t) = γ.

In line with these identities, we write

           Kv (v (θ ) , ∆ (θ ) , θ, t + 1) = λ (θ ) and K∆ (v (θ ) , ∆ (θ ) , θ, t + 1) = γ (θ ) .


                                                          43
The boundary conditions are

                                    lim µ (θ ) = 0 and lim µ (θ ) = 0.                                             (21)
                                    θ →θ                          θ →θ


The law of motion for the co-state µ (θ ) is

                                                  f θt− (θ |θ− ) t
                                "                               #
                     dµ (θ )          1
                             = − t0           −λ−γ t              f (θ |θ− )                                       (22)
                      dθ          û (c (θ ))      f (θ |θ− )

The first order conditions for ∆ (θ ), v (θ ) and y (θ ) can be rearranged as follows

                                               µ (θ )       q γ (θ )
                                                         =−          ,                                             (23)
                                            θft (θ |θ− )    β θ

                                                     1        q
                                                             = λ (θ ) ,                                            (24)
                                             ût0   (c (θ ))  β
and                                                  !
                             ĥy (y (θ ) , θ ) µ (θ ) 
                          1 − t0                                        ,       .      (25)
                                                                              
                                                         =
                                                         h yθ ( y ( θ )   θ )
                               û (c (θ ))  f t (θ |θ− )

Using equation (24) to replace λ by ( β/q) 1/ût−10 (c− ) in equation (22), and integrating
                                                          

and using equation (21) we get
                                   ˆ 
                                               1              1
                                                                      
                                                        β
                          0=                          −                 f t (θ |θ− )
                                         ût0 (c (θ )) q ût−10 (c− )
which provides another proof of Proposition 1 .
  Let us now make Assumption 2. We can then simplify equation (25) as follows

                                 y ( θ ) α −1                                                   y ( θ ) α −1
                                                                                                  
                        1                                                              1
                        θκ         θ                         µ (θ )                    θκ         θ
                1 −                        =α                        ût0 (c (θ ))                           .   (26)
                                             
                          ût0   (c (θ ))                θft  (θ |θ− )                  ût0 (c (θ ))


Replacing the expression for the labor wedge in this last condition, we get

                        τL (θ )         1                 t                        π (θ )
                                                π ( θ ) f   ( θ | θ − ) = αµ ( θ )        .
                      1 − τL (θ ) ût0 (c (θ ))                                      θ

Integrating by parts this equality, we get
               ˆ                                                                 ˆ
                      τL (θ )         1                                                           π (θ )
                                            π (θ ) f t (θ |θ− ) dθ = α                 µ (θ )            dθ
                    1 − τL (θ ) û (c (θ ))
                                  t 0                                                               θ


                                                             44
                = α [µ (θ ) Π (θ )]θθ
                      ˆ          "
                                                         f θt− (θ |θ− ) t
                                                                       #
                                        1
                  + α Π (θ ) t0                −λ−γ t                     f (θ |θ− ) dθ
                                   û (c (θ ))            f (θ |θ− )
                    ˆ
                                      1                                        dφΠ (θ− )
                                               
                                                                         γ
                = α Π (θ ) t0                − λ f t (θ |θ− ) dθ − α θ−
                                û (c (θ ))                             θ−        dθ−

where we have used the fact that
                                                ˆ
                                dφΠ (θ− )
                                          =         Π (θ ) f θt− (θ |θ− ) dθ.
                                  dθ−

Now note that
                         τL (θ )         1          µ (θ )         q γ (θ )
                                               =α t           = −α
                       1 − τL (θ ) û (c (θ ))
                                     t 0         θ f (θ |θ− )      β θ
so that we also have
                                    τL−            1            q γ
                                                 1
                                                           = −α      .
                                  1 − τL− û t −   0 (c− )      β θ−
Similarly we have
                                                 β      1
                                          λ=                    .
                                                 q ût−10 (c− )
This implies that
                 ˆ
                   τL (θ ) q ût−10 (c− )
                                             π (θ ) f t (θ |θ− ) dθ
                 1 − τL (θ ) β ût0 (c (θ ))
                ˆ
                                                                                   dφΠ (θ− )
                           t −10               
                           q û      (c− )          t                    τL−
             = α Π (θ )                     − 1   f   ( θ | θ − ) dθ +         θ −           .
                           β ût0 (c (θ ))                             1 − τL−       dθ−

This proves Proposition 2.
   Proof of Proposition 3. The proof is very similar to that of Proposition 1. Define
                                      ˆ
                                χ≡        (θt−1 /θt )α f t (θt |θt−1 ) dθt .

The idea is to consider a history θ t−1 , a neighborhood |θ̃ t−1 − θ t−1 | ≤ ε of this history, and
the following perturbed allocation c̃δ , ỹδ . Define for every θ̃ t−1 such that |θ̃ t−1 − θ t−1 | ≤
                                      

ε,
                                           α          α δ
                                   ỹδ θ̃ t     = y θ̃ t    − ,
                                                               χ
                                       α             α
                              ỹδ θ̃ t−1        = y θ̃ t−1     + βδ,



                                                    45
and for every other θ s
                                            ỹδ (θ s ) = yδ (θ s ) .

Finally for every θ s , define
                                             c̃δ (θ s ) = c (θ s ) .

It is easy to see that the perturbed allocation is incentive compatible and delivers the same
utility as the original allocation. As in the proof of Proposition 1, a necessary condition for
the inital allocation {c, y} to solve Program IC is that it be the least cost allocation among
the class of allocations c̃δ , ỹδ indexed by δ. The limit of the corresponding first-order
                           

condition when ε goes to zero delivers

  ˆ
        τL θ t      q ût−10 c θ t−1         θt α t
                                              
                                                    f (θt |θt−1 ) dθt
      1 − τL (θ t ) β ût0 (c (θ t ))      θ t +1
                                             ˆ 
                                   τL θ t−1            θt α t
                                                            
                             =                                f (θt |θt−1 ) dθt
                               1 − τL (θ t−1 )       θ t +1
                                            ˆ "
                                                     q ût−10 c θ t−1
                                                                        # 
                                                                                θt α t
                                                                                     
                                         +        1−                                   f (θt |θt−1 ) dθt .
                                                     β ût0 (c (θ t ))        θ t +1

This completes the proof.


Proof of Proposition 4.    We use optimal control to analyze this program: we attach
multipliers λ and γ on the first and second constraints; we denote by µ (θ ) the co-state
variable associated with w (θ ); and we then form the corresponding Hamiltonian. The
Envelope conditions can be written as

                           Kv (v, ∆, θ− , t) = λ and K∆ (v, ∆, θ− , t) = γ.

In line with these identities, we write

          Kv (v (θ ) , ∆ (θ ) , θ, t + 1) = λ (θ ) and K∆ (v (θ ) , ∆ (θ ) , θ, t + 1) = γ (θ ) .

The boundary conditions for the co-state variable are
                                                   
                                            µ θt                   γ θ− dθ t
                                 lim                    = −                 ,
                                 θ →θ  θ t f t θ t |θ−
                                        t                         θ− θ t dθ−
                                             µ (θ t )        γ θ− dθ t
                                 lim         t
                                                        = −            .
                                 θ →θ θ t f (θ t | θ− )     θ− θ t dθ−
                                     t




                                                       46
The first-order condition for y (θ ) can be rearranged as follows

                                 τL (θ )        µ (θ )    1 θCnθ
                                           =− t                  ,
                               1 − τL (θ )   θ f (θ |θ− ) Cu Cn

where for short, the argument (y (θ ) , w (θ ) − βv (θ ) , θ ) of the function C1u θC
                                                                                    Cn is omitted.
                                                                                     nθ


Combining the last three equations immediately yields part (i) of the proposition.
    Turning to part (ii), we now make Assumptions 1 and 2. We can then simplify the
first-order condition for y (θ ) as

                              τL (θ )      β 0             µ (θ )
                                        = α ût (c (θ )) t           .
                            1 − τL (θ )    q            θ f (θ |θ− )

Combining this with the first-order condition for ∆ (θ )

                                          µ (θ )       q γ (θ )
                                                    =−
                                        θft(θ |θ− )    β θ

yields
                                  τL (θ )        γ ( θ ) t0
                                            = −α        û (c (θ )) .
                                1 − τL (θ )        θ
These conditions also hold in the previous period

                                      τL−        γ    0
                                            = −α ût−1 (c− ) .
                                    1 − τL−     θ−

Together with the boudary conditions, this yields
                                                                      
                           τL θ t           β t0             µ θt
                                        = α û c θ t
                         1 − τL
                                                                          
                                    θt       q            θ t f t θ t |θ−
                                                γ β t0         θ− dθ t
                                         = −α       û c θ t
                                               θ− q               θ t dθ−
                                                        0
                                              τL− β ût c θ t θ− dθ t
                                                                 
                                         =                                  .
                                           1 − τL− q ût−10 (c− ) θ t dθ−

A similar calculation yields
                                                         0
                            τL (θ t )       τL− β ût (c (θ t )) θ− dθ t
                                        =
                          1 − τL (θ t )   1 − τL− q ût−10 (c− ) θ t dθ−




                                                  47
Proof of Proposition 5. The proof follows immediately, by combining the following two
lemmas.

Lemma 1 Suppose that Assumptions 1 and 2 hold, and that {c, y} solves Program FOA. Then
the labor wedge satisfies the following equation for every t ≥ 1, history θ t−1 and shock θt :

              τL θ t−1 , θt
        "                                                 #
                                             1
                            
   ∂                             q
                                                            =
  dθt       1 − τL (θ t−1 , θt ) β ût0 (c (θ t−1 , θt ))
                                   τL θ t−1                 1         θt−1 f θtt−1 (θt |θt−1 )
                                               
                              −
                                 1 − τL (θ t−1 ) ût−10 (c (θ t−1 )) θt f t (θt |θt−1 )
                       τL θ t−1 , θt                     1        − f t (θt |θt−1 ) − θt f θtt (θt |θt−1 )
                                       
                                            q
                 +
                    1 − τL (θ t−1 , θt ) β ût0 (c (θ t−1 , θt ))            θ t f t ( θ t | θ t −1 )
                                                                                  1                        1
                                                                                                               
                                                                α q
                                                             −                                     −              .
                                                                θt β ût0 (c (θ t−1 , θt )) ût−10 (c (θ t−1 ))

    We build on the proof of Proposition 4. We use the same notations and definitions. We
start with the following equation

                                       τ (θ ) q
                                                  θλ (θ ) f (θ |θ− ) = αµ (θ ) .
                                     1 − τ (θ ) β

Using the law of motion for µ and the boundary condition for µ at θ t , we can transform
this equation as follows

    τL (θ ) q
                θλ (θ ) f t (θ |θ− )
  1 − τL (θ ) β
                                          ˆ θ"                      f θt− θ̂ |θ−
                                                                                 #
                   dθ t t                            q
                                                                                 f t θ̂ |θ− dθ̂
                                                                                           
          = −αγ         f (θ t |θ− ) − α               λ θ̂ − λ − γ
                  dθ−                       θt       β                 f θ̂ |θ−
                                       ˆ θ                        ˆ θ                
           dθ L (θ− )                                                    q
                                                                            λ θ̂ − λ f t θ̂ |θ− dθ̂
                                                                                               
      − αγ            f (θ |θ− ) + αγ         f θ− θ̂ |θ− dθ̂ − α
              dθ−                        θt                              β
                  "                      ˆ θ                    #      ˆ θ               
       τL−           dθ t t                        t                          q
                                                                                λ θ̂ − λ f t θ̂ |θ− dθ̂.
                                                                                                 
             θ− λ         f (θ t |θ− ) −         f θ− θ̂ |θ− dθ̂ − α
     1 − τL−        dθ−                     θt                                β

where
                                      1       q         1        q
                                             = λ and t0         = λ (θ ) .
                                 ût−10(c− )  β     û (c (θ ))  β




                                                          48
This implies that
      h                        i
           τL (θ ) q
  d       1−τL (θ ) β
                      λ (θ )            τL−     θ− f θt− (θ |θ− )
                                   =−         λ
                dθ                    1 − τL− θ f t (θ |θ− )
                                                               − f t (θ |θ− ) − θ f θt (θ |θ− ) α q
                                                                                                             
                                            τ (θ ) q                                                     
                                        +               λ (θ )                                 −     λ θ̂ − λ
                                          1 − τ (θ ) β                  θ f t (θ |θ− )           θ β

which proves the lemma.

Lemma 2 Suppose that
                                                                                              2

                                                                           log
                                                                                        θ      
                                                                                         log
                                                                                                 
                                                                                               
                                                                                        µt (θ− )
                                                                                   θ− e
                                                            1          −
                                                                                        2σt2
                                         f t (θ |θ− ) =     √      e                                              (27)
                                                          θσt 2π

where µt (θ− ) is an arbitrary function of θ− and σt is a constant. Then

                                                                log
                                                                       !
                                                    dµ
                        θ− f θt− (θ |θ− ) = − 1 + θ− t                         θ f θt (θ |θ− ) + f t (θ |θ− ) .
                                                                                                             
                                                     dθ−

Alternative Proof of Proposition 5 based on a perturbation argument.        Consider an
allocation {c, y} that satisfies the constraints of Program FOA, and a history θ t−1 . We
construct a sequence cn,δ , yn,δ of perturbed allocations as follows. Let
                      


                      π n (θ ) = − θ̂ − ε δn θ − θ̂ − ε + θ̂ + ε δn θ − θ̂ + ε
                                                                           

where δn is a sequence of functions that converges to the Dirac distribution δdistr at 0
where we write δdistr to differentiate the notation for the Dirac distribution and the nota-
tion for the number δ. The sequence of functions π n converges to the following distribu-
tion
                                                                          
             π (θ ) = − θ̂ − ε δdistr θ − θ̂ − ε + θ̂ + ε δdistr θ − θ̂ + ε

    Let Πn (θ ) be a primitive of π n (θ ) /θ. The sequences of functions Πn converges to the
following function Π

                                          Π (θ ) = 0 if θ < θ̂ − ε or θ > θ̂ + ε
                                          Π (θ ) = −1 otherwise.

      Denote by ĥ ( x ) the function κ/αx α . The allocation cn,δ , yn,δ differs from {c, y} only
                                                             


                                                                49
at histories θ t−1 and θ t−1 , θt (for all possible θt ). Define
                                 

                                                                                                                          
                                                                           t −1                                    t −1
                                                 ĥ y      n,δ
                                                                       θ                      = ĥ y(θ                    ) + θ̂tα−1 γn,δ

and                                                                                 δ
                                    ĥ yn,δ θ t−1 , θt    = ĥ y θ t−1 , θt − θtα π n (θt )
                                                                                            β
and define

                       t
                           
                                   n,δ
                                         
                                                 t −1
                                                               
                                                                                  t
                                                                                      
                                                                                              n,δ
                                                                                                    
                                                                                                            t −1
                                                                                                                                                             δ
                  û           c             θ          , θt            = û              c             θ          , θt            + ζ n,δ (θt ) − π n (θt )
                                                                                                                                                               β
where
                                                                                δ
                                                                 ζ n,δ (θt ) = α Πn (θt ) + ζ̄ n,δ .
                                                                                β
   The perturbed allocations satisfy the constraints of Program FOA as long as

                                                                                                      dφΠ
                                                                                                                           n
                                                                                  n,δ
                                                                             γ                = δθt−1       ,
                                                                                                      dθt−1

                                                                                                 dφΠ
                                                                                                                   n
                                                                                                                                       !
                                                                           δ
                                                                                                       − αφΠ
                                                                                                             n
                                                               ζ̄ n,δ    =                θ t −1                                           .
                                                                           β                     dθt−1

    Note that the perturbed allocation incorporates the necessary corrections to the per-
turbation constructed in the text.
    The first-order condition
                                     dΨ cn,δ , yn,δ
                                        
                                                    =0
                                           dδ
can be rewritten as equation (5) for π = π n and Π = Πn . Taking the limit when n goes to
infinity, and then taking the limit when ε goes to zero delivers Proposition 1.
    Note that under Assumption 4, we can rewrite
                                                                                      ˆ
                                                                   n,δ
                                                               γ           =δ                 π n,δ (θt ) f t (θt |θt−1 )

and                                 ˆ                                                                                 ˆ                                           
                n,δ     δ                            n,δ                 t                                                          n,δ         t
           ζ̄         =                          π         (θt ) f (θt |θt−1 ) dθt − α                                         Π          (θt ) f (θt |θt−1 ) dθt .
                        β
We can then take the continuous time limit and derive Proposition 5.




                                                                                                    50
Proof of Proposition 6. The first-order conditions for ct , yt ,and σ∆,t in the HJB equation
can be written as
                                               1
                                     λt = 0          ,
                                           ût (ct )
                                           τL,t        γt 1
                                                  = −α       ,
                                         1 − τL,t      λt θt
                                            K∆ − Kv∆ θt ∆t − θt K∆θ
                                   σ∆,t =                           .
                                                    K∆∆
    Applying Ito’s lemma to λt = Kv (vt , ∆t , θt , t), and differentiating the HJB equation
with respect to vt (using the Envelope theorem) immediately yields that the drift term of
λt is equal to zero. Hence, λt is a martingale. We can therefore write

                             dλt = (Kvv θt ∆t + Kv∆ σ∆,t + Kvθ θt ) σ̂t dWt .

Using the first-order condition for σ∆,t , we obtain

                                            dλt
                                                = σλ,t σ̂t dWt ,
                                            λt

where
                                           2
                                                                                           !
                        1       Kvv K∆∆ − Kv∆            K − θt K∆θ
               σλ,t   =                       θt ∆t + Kv∆ ∆         + Kvθ θt                   .
                        Kv           K∆∆                    K∆∆

Applying Ito’s lemma to γt = K∆ (vt , ∆t , θt , t), and differentiating the HJB equation with
respect to ∆t (using the Envelope theorem) yields that the drift term of γt is equal to

                                                                                log
                                                                                      !        !
                                                                            dµ̂
            − Kvv θt2 ∆t σ̂t2 + Kv∆ θt σ∆,t σ̂t2 + Kvθ θt2 σ̂t2 −   µ̂t + θt t            K∆       dt
                                                                             dθ

which using the definition of γt , the first-order condition for σ∆,t and the expression for
σλ,t , we get
                                                           log
                                                               !
                                                      d µ̂
                          −θλt σλ,t σ̂t2 dt + µ̂t + θt t         γt dt.
                                                        dθ

Similarly, the volatility term of γt is given by

                                (K∆v θt ∆t + K∆∆ σ∆,t + K∆θ θt ) σ̂t dWt




                                                    51
which using the first order condition for σ∆,t , we can rewrite this as

                                             γt σ̂t dWt .

Hence we have
                                                            log
                        "                                         !     #
                                                      dµ̂
                 dγt = −θt λt σλ,t σ̂t2 +     µ̂t + θt t              γt dt + γt σ̂t dWt .
                                                       dθ

Applying Ito’s lemma to the first order condition for yt then yields

                                                                                log
                                       "                                            #
                          τL,t                               τ      dµ̂
                   d λt                = αλt σλ,t σ̂t2 + λt L,t θt t                      dt.
                        1 − τL,t                           1 − τL,t  dθ




                                                 52
